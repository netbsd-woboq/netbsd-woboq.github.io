<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>xmss_fast.h source code [netbsd/crypto/external/bsd/openssh/dist/xmss_fast.h] - Woboq Code Browser</title>
<link rel="stylesheet" href="https://code.woboq.org/data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="https://code.woboq.org/data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="https://code.woboq.org/data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="https://code.woboq.org/data/jquery/jquery-ui.min.js"></script>
<script>var file = 'netbsd/crypto/external/bsd/openssh/dist/xmss_fast.h'; var root_path = '../../../../../..'; var data_path = 'https://code.woboq.org/data'; var ecma_script_api_version = 2;</script>
<script src='https://code.woboq.org/data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='../../../../..'>netbsd</a>/<a href='../../../..'>crypto</a>/<a href='../../..'>external</a>/<a href='../..'>bsd</a>/<a href='..'>openssh</a>/<a href='./'>dist</a>/<a href='xmss_fast.h.html'>xmss_fast.h</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>/*	$NetBSD: xmss_fast.h,v 1.2 2018/04/06 18:59:00 christos Exp $	*/</i></td></tr>
<tr><th id="2">2</th><td><i>/* $OpenBSD: xmss_fast.h,v 1.2 2018/02/26 03:56:44 dtucker Exp $ */</i></td></tr>
<tr><th id="3">3</th><td><i>/*</i></td></tr>
<tr><th id="4">4</th><td><i>xmss_fast.h version 20160722</i></td></tr>
<tr><th id="5">5</th><td><i>Andreas HÃ¼lsing</i></td></tr>
<tr><th id="6">6</th><td><i>Joost Rijneveld</i></td></tr>
<tr><th id="7">7</th><td><i>Public domain.</i></td></tr>
<tr><th id="8">8</th><td><i>*/</i></td></tr>
<tr><th id="9">9</th><td></td></tr>
<tr><th id="10">10</th><td><u>#include <a href="xmss_wots.h.html">"xmss_wots.h"</a></u></td></tr>
<tr><th id="11">11</th><td></td></tr>
<tr><th id="12">12</th><td><u>#<span data-ppcond="12">ifndef</span> <span class="macro" data-ref="_M/XMSS_H">XMSS_H</span></u></td></tr>
<tr><th id="13">13</th><td><u>#define <dfn class="macro" id="_M/XMSS_H" data-ref="_M/XMSS_H">XMSS_H</dfn></u></td></tr>
<tr><th id="14">14</th><td><b>typedef</b> <b>struct</b>{</td></tr>
<tr><th id="15">15</th><td>  <em>unsigned</em> <em>int</em> <dfn class="decl field" id="(anonymous)::level" title='(anonymous struct)::level' data-ref="(anonymous)::level" data-ref-filename="(anonymous)..level">level</dfn>;</td></tr>
<tr><th id="16">16</th><td>  <em>unsigned</em> <em>long</em> <em>long</em> <dfn class="decl field" id="(anonymous)::subtree" title='(anonymous struct)::subtree' data-ref="(anonymous)::subtree" data-ref-filename="(anonymous)..subtree">subtree</dfn>;</td></tr>
<tr><th id="17">17</th><td>  <em>unsigned</em> <em>int</em> <dfn class="decl field" id="(anonymous)::subleaf" title='(anonymous struct)::subleaf' data-ref="(anonymous)::subleaf" data-ref-filename="(anonymous)..subleaf">subleaf</dfn>;</td></tr>
<tr><th id="18">18</th><td>} <dfn class="typedef" id="leafaddr" title='leafaddr' data-type='struct leafaddr' data-ref="leafaddr" data-ref-filename="leafaddr">leafaddr</dfn>;</td></tr>
<tr><th id="19">19</th><td></td></tr>
<tr><th id="20">20</th><td><b>typedef</b> <b>struct</b>{</td></tr>
<tr><th id="21">21</th><td>  <a class="typedef" href="xmss_wots.h.html#wots_params" title='wots_params' data-type='struct wots_params' data-ref="wots_params" data-ref-filename="wots_params">wots_params</a> <dfn class="decl field" id="(anonymous)::wots_par" title='(anonymous struct)::wots_par' data-ref="(anonymous)::wots_par" data-ref-filename="(anonymous)..wots_par">wots_par</dfn>;</td></tr>
<tr><th id="22">22</th><td>  <em>unsigned</em> <em>int</em> <dfn class="decl field" id="(anonymous)::n" title='(anonymous struct)::n' data-ref="(anonymous)::n" data-ref-filename="(anonymous)..n">n</dfn>;</td></tr>
<tr><th id="23">23</th><td>  <em>unsigned</em> <em>int</em> <dfn class="decl field" id="(anonymous)::h" title='(anonymous struct)::h' data-ref="(anonymous)::h" data-ref-filename="(anonymous)..h">h</dfn>;</td></tr>
<tr><th id="24">24</th><td>  <em>unsigned</em> <em>int</em> <dfn class="decl field" id="(anonymous)::k" title='(anonymous struct)::k' data-ref="(anonymous)::k" data-ref-filename="(anonymous)..k">k</dfn>;</td></tr>
<tr><th id="25">25</th><td>} <dfn class="typedef" id="xmss_params" title='xmss_params' data-type='struct xmss_params' data-ref="xmss_params" data-ref-filename="xmss_params">xmss_params</dfn>;</td></tr>
<tr><th id="26">26</th><td></td></tr>
<tr><th id="27">27</th><td><b>typedef</b> <b>struct</b>{</td></tr>
<tr><th id="28">28</th><td>  <a class="typedef" href="#xmss_params" title='xmss_params' data-type='struct xmss_params' data-ref="xmss_params" data-ref-filename="xmss_params">xmss_params</a> <dfn class="decl field" id="(anonymous)::xmss_par" title='(anonymous struct)::xmss_par' data-ref="(anonymous)::xmss_par" data-ref-filename="(anonymous)..xmss_par">xmss_par</dfn>;</td></tr>
<tr><th id="29">29</th><td>  <em>unsigned</em> <em>int</em> <dfn class="decl field" id="(anonymous)::n" title='(anonymous struct)::n' data-ref="(anonymous)::n" data-ref-filename="(anonymous)..n">n</dfn>;</td></tr>
<tr><th id="30">30</th><td>  <em>unsigned</em> <em>int</em> <dfn class="decl field" id="(anonymous)::h" title='(anonymous struct)::h' data-ref="(anonymous)::h" data-ref-filename="(anonymous)..h">h</dfn>;</td></tr>
<tr><th id="31">31</th><td>  <em>unsigned</em> <em>int</em> <dfn class="decl field" id="(anonymous)::d" title='(anonymous struct)::d' data-ref="(anonymous)::d" data-ref-filename="(anonymous)..d">d</dfn>;</td></tr>
<tr><th id="32">32</th><td>  <em>unsigned</em> <em>int</em> <dfn class="decl field" id="(anonymous)::index_len" title='(anonymous struct)::index_len' data-ref="(anonymous)::index_len" data-ref-filename="(anonymous)..index_len">index_len</dfn>;</td></tr>
<tr><th id="33">33</th><td>} <dfn class="typedef" id="xmssmt_params" title='xmssmt_params' data-type='struct xmssmt_params' data-ref="xmssmt_params" data-ref-filename="xmssmt_params">xmssmt_params</dfn>;</td></tr>
<tr><th id="34">34</th><td></td></tr>
<tr><th id="35">35</th><td><b>typedef</b> <b>struct</b>{</td></tr>
<tr><th id="36">36</th><td>  <em>unsigned</em> <em>int</em> <dfn class="decl field" id="(anonymous)::h" title='(anonymous struct)::h' data-ref="(anonymous)::h" data-ref-filename="(anonymous)..h">h</dfn>;</td></tr>
<tr><th id="37">37</th><td>  <em>unsigned</em> <em>int</em> <dfn class="decl field" id="(anonymous)::next_idx" title='(anonymous struct)::next_idx' data-ref="(anonymous)::next_idx" data-ref-filename="(anonymous)..next_idx">next_idx</dfn>;</td></tr>
<tr><th id="38">38</th><td>  <em>unsigned</em> <em>int</em> <dfn class="decl field" id="(anonymous)::stackusage" title='(anonymous struct)::stackusage' data-ref="(anonymous)::stackusage" data-ref-filename="(anonymous)..stackusage">stackusage</dfn>;</td></tr>
<tr><th id="39">39</th><td>  <em>unsigned</em> <em>char</em> <dfn class="decl field" id="(anonymous)::completed" title='(anonymous struct)::completed' data-ref="(anonymous)::completed" data-ref-filename="(anonymous)..completed">completed</dfn>;</td></tr>
<tr><th id="40">40</th><td>  <em>unsigned</em> <em>char</em> *<dfn class="decl field" id="(anonymous)::node" title='(anonymous struct)::node' data-ref="(anonymous)::node" data-ref-filename="(anonymous)..node">node</dfn>;</td></tr>
<tr><th id="41">41</th><td>} <dfn class="typedef" id="treehash_inst" title='treehash_inst' data-type='struct treehash_inst' data-ref="treehash_inst" data-ref-filename="treehash_inst">treehash_inst</dfn>;</td></tr>
<tr><th id="42">42</th><td></td></tr>
<tr><th id="43">43</th><td><b>typedef</b> <b>struct</b> {</td></tr>
<tr><th id="44">44</th><td>  <em>unsigned</em> <em>char</em> *<dfn class="decl field" id="(anonymous)::stack" title='(anonymous struct)::stack' data-ref="(anonymous)::stack" data-ref-filename="(anonymous)..stack">stack</dfn>;</td></tr>
<tr><th id="45">45</th><td>  <em>unsigned</em> <em>int</em> <dfn class="decl field" id="(anonymous)::stackoffset" title='(anonymous struct)::stackoffset' data-ref="(anonymous)::stackoffset" data-ref-filename="(anonymous)..stackoffset">stackoffset</dfn>;</td></tr>
<tr><th id="46">46</th><td>  <em>unsigned</em> <em>char</em> *<dfn class="decl field" id="(anonymous)::stacklevels" title='(anonymous struct)::stacklevels' data-ref="(anonymous)::stacklevels" data-ref-filename="(anonymous)..stacklevels">stacklevels</dfn>;</td></tr>
<tr><th id="47">47</th><td>  <em>unsigned</em> <em>char</em> *<dfn class="decl field" id="(anonymous)::auth" title='(anonymous struct)::auth' data-ref="(anonymous)::auth" data-ref-filename="(anonymous)..auth">auth</dfn>;</td></tr>
<tr><th id="48">48</th><td>  <em>unsigned</em> <em>char</em> *<dfn class="decl field" id="(anonymous)::keep" title='(anonymous struct)::keep' data-ref="(anonymous)::keep" data-ref-filename="(anonymous)..keep">keep</dfn>;</td></tr>
<tr><th id="49">49</th><td>  <a class="typedef" href="#treehash_inst" title='treehash_inst' data-type='struct treehash_inst' data-ref="treehash_inst" data-ref-filename="treehash_inst">treehash_inst</a> *<dfn class="decl field" id="(anonymous)::treehash" title='(anonymous struct)::treehash' data-ref="(anonymous)::treehash" data-ref-filename="(anonymous)..treehash">treehash</dfn>;</td></tr>
<tr><th id="50">50</th><td>  <em>unsigned</em> <em>char</em> *<dfn class="decl field" id="(anonymous)::retain" title='(anonymous struct)::retain' data-ref="(anonymous)::retain" data-ref-filename="(anonymous)..retain">retain</dfn>;</td></tr>
<tr><th id="51">51</th><td>  <em>unsigned</em> <em>int</em> <dfn class="decl field" id="(anonymous)::next_leaf" title='(anonymous struct)::next_leaf' data-ref="(anonymous)::next_leaf" data-ref-filename="(anonymous)..next_leaf">next_leaf</dfn>;</td></tr>
<tr><th id="52">52</th><td>} <dfn class="typedef" id="bds_state" title='bds_state' data-type='struct bds_state' data-ref="bds_state" data-ref-filename="bds_state">bds_state</dfn>;</td></tr>
<tr><th id="53">53</th><td></td></tr>
<tr><th id="54">54</th><td><i class="doc">/**</i></td></tr>
<tr><th id="55">55</th><td><i class="doc"> * Initialize BDS state struct</i></td></tr>
<tr><th id="56">56</th><td><i class="doc"> * parameter names are the same as used in the description of the BDS traversal</i></td></tr>
<tr><th id="57">57</th><td><i class="doc"> */</i></td></tr>
<tr><th id="58">58</th><td><em>void</em> <dfn class="decl fn" id="xmss_set_bds_state" title='xmss_set_bds_state' data-ref="xmss_set_bds_state" data-ref-filename="xmss_set_bds_state">xmss_set_bds_state</dfn>(<a class="typedef" href="#bds_state" title='bds_state' data-type='struct bds_state' data-ref="bds_state" data-ref-filename="bds_state">bds_state</a> *<dfn class="local col1 decl" id="21state" title='state' data-type='bds_state *' data-ref="21state" data-ref-filename="21state">state</dfn>, <em>unsigned</em> <em>char</em> *<dfn class="local col2 decl" id="22stack" title='stack' data-type='unsigned char *' data-ref="22stack" data-ref-filename="22stack">stack</dfn>, <em>int</em> <dfn class="local col3 decl" id="23stackoffset" title='stackoffset' data-type='int' data-ref="23stackoffset" data-ref-filename="23stackoffset">stackoffset</dfn>, <em>unsigned</em> <em>char</em> *<dfn class="local col4 decl" id="24stacklevels" title='stacklevels' data-type='unsigned char *' data-ref="24stacklevels" data-ref-filename="24stacklevels">stacklevels</dfn>, <em>unsigned</em> <em>char</em> *<dfn class="local col5 decl" id="25auth" title='auth' data-type='unsigned char *' data-ref="25auth" data-ref-filename="25auth">auth</dfn>, <em>unsigned</em> <em>char</em> *<dfn class="local col6 decl" id="26keep" title='keep' data-type='unsigned char *' data-ref="26keep" data-ref-filename="26keep">keep</dfn>, <a class="typedef" href="#treehash_inst" title='treehash_inst' data-type='struct treehash_inst' data-ref="treehash_inst" data-ref-filename="treehash_inst">treehash_inst</a> *<dfn class="local col7 decl" id="27treehash" title='treehash' data-type='treehash_inst *' data-ref="27treehash" data-ref-filename="27treehash">treehash</dfn>, <em>unsigned</em> <em>char</em> *<dfn class="local col8 decl" id="28retain" title='retain' data-type='unsigned char *' data-ref="28retain" data-ref-filename="28retain">retain</dfn>, <em>int</em> <dfn class="local col9 decl" id="29next_leaf" title='next_leaf' data-type='int' data-ref="29next_leaf" data-ref-filename="29next_leaf">next_leaf</dfn>);</td></tr>
<tr><th id="59">59</th><td><i class="doc">/**</i></td></tr>
<tr><th id="60">60</th><td><i class="doc"> * Initializes parameter set.</i></td></tr>
<tr><th id="61">61</th><td><i class="doc"> * Needed, for any of the other methods.</i></td></tr>
<tr><th id="62">62</th><td><i class="doc"> */</i></td></tr>
<tr><th id="63">63</th><td><em>int</em> <dfn class="decl fn" id="xmss_set_params" title='xmss_set_params' data-ref="xmss_set_params" data-ref-filename="xmss_set_params">xmss_set_params</dfn>(<a class="typedef" href="#xmss_params" title='xmss_params' data-type='struct xmss_params' data-ref="xmss_params" data-ref-filename="xmss_params">xmss_params</a> *<dfn class="local col0 decl" id="30params" title='params' data-type='xmss_params *' data-ref="30params" data-ref-filename="30params">params</dfn>, <em>int</em> <dfn class="local col1 decl" id="31n" title='n' data-type='int' data-ref="31n" data-ref-filename="31n">n</dfn>, <em>int</em> <dfn class="local col2 decl" id="32h" title='h' data-type='int' data-ref="32h" data-ref-filename="32h">h</dfn>, <em>int</em> <dfn class="local col3 decl" id="33w" title='w' data-type='int' data-ref="33w" data-ref-filename="33w">w</dfn>, <em>int</em> <dfn class="local col4 decl" id="34k" title='k' data-type='int' data-ref="34k" data-ref-filename="34k">k</dfn>);</td></tr>
<tr><th id="64">64</th><td><i class="doc">/**</i></td></tr>
<tr><th id="65">65</th><td><i class="doc"> * Initialize xmssmt_params struct</i></td></tr>
<tr><th id="66">66</th><td><i class="doc"> * parameter names are the same as in the draft</i></td></tr>
<tr><th id="67">67</th><td><i class="doc"> * </i></td></tr>
<tr><th id="68">68</th><td><i class="doc"> * Especially h is the total tree height, i.e. the XMSS trees have height h/d</i></td></tr>
<tr><th id="69">69</th><td><i class="doc"> */</i></td></tr>
<tr><th id="70">70</th><td><em>int</em> <dfn class="decl fn" id="xmssmt_set_params" title='xmssmt_set_params' data-ref="xmssmt_set_params" data-ref-filename="xmssmt_set_params">xmssmt_set_params</dfn>(<a class="typedef" href="#xmssmt_params" title='xmssmt_params' data-type='struct xmssmt_params' data-ref="xmssmt_params" data-ref-filename="xmssmt_params">xmssmt_params</a> *<dfn class="local col5 decl" id="35params" title='params' data-type='xmssmt_params *' data-ref="35params" data-ref-filename="35params">params</dfn>, <em>int</em> <dfn class="local col6 decl" id="36n" title='n' data-type='int' data-ref="36n" data-ref-filename="36n">n</dfn>, <em>int</em> <dfn class="local col7 decl" id="37h" title='h' data-type='int' data-ref="37h" data-ref-filename="37h">h</dfn>, <em>int</em> <dfn class="local col8 decl" id="38d" title='d' data-type='int' data-ref="38d" data-ref-filename="38d">d</dfn>, <em>int</em> <dfn class="local col9 decl" id="39w" title='w' data-type='int' data-ref="39w" data-ref-filename="39w">w</dfn>, <em>int</em> <dfn class="local col0 decl" id="40k" title='k' data-type='int' data-ref="40k" data-ref-filename="40k">k</dfn>);</td></tr>
<tr><th id="71">71</th><td><i class="doc">/**</i></td></tr>
<tr><th id="72">72</th><td><i class="doc"> * Generates a XMSS key pair for a given parameter set.</i></td></tr>
<tr><th id="73">73</th><td><i class="doc"> * Format sk: [(32bit) idx || SK_SEED || SK_PRF || PUB_SEED || root]</i></td></tr>
<tr><th id="74">74</th><td><i class="doc"> * Format pk: [root || PUB_SEED] omitting algo oid.</i></td></tr>
<tr><th id="75">75</th><td><i class="doc"> */</i></td></tr>
<tr><th id="76">76</th><td><em>int</em> <dfn class="decl fn" id="xmss_keypair" title='xmss_keypair' data-ref="xmss_keypair" data-ref-filename="xmss_keypair">xmss_keypair</dfn>(<em>unsigned</em> <em>char</em> *<dfn class="local col1 decl" id="41pk" title='pk' data-type='unsigned char *' data-ref="41pk" data-ref-filename="41pk">pk</dfn>, <em>unsigned</em> <em>char</em> *<dfn class="local col2 decl" id="42sk" title='sk' data-type='unsigned char *' data-ref="42sk" data-ref-filename="42sk">sk</dfn>, <a class="typedef" href="#bds_state" title='bds_state' data-type='struct bds_state' data-ref="bds_state" data-ref-filename="bds_state">bds_state</a> *<dfn class="local col3 decl" id="43state" title='state' data-type='bds_state *' data-ref="43state" data-ref-filename="43state">state</dfn>, <a class="typedef" href="#xmss_params" title='xmss_params' data-type='struct xmss_params' data-ref="xmss_params" data-ref-filename="xmss_params">xmss_params</a> *<dfn class="local col4 decl" id="44params" title='params' data-type='xmss_params *' data-ref="44params" data-ref-filename="44params">params</dfn>);</td></tr>
<tr><th id="77">77</th><td><i class="doc">/**</i></td></tr>
<tr><th id="78">78</th><td><i class="doc"> * Signs a message.</i></td></tr>
<tr><th id="79">79</th><td><i class="doc"> * Returns </i></td></tr>
<tr><th id="80">80</th><td><i class="doc"> * 1. an array containing the signature followed by the message AND</i></td></tr>
<tr><th id="81">81</th><td><i class="doc"> * 2. an updated secret key!</i></td></tr>
<tr><th id="82">82</th><td><i class="doc"> * </i></td></tr>
<tr><th id="83">83</th><td><i class="doc"> */</i></td></tr>
<tr><th id="84">84</th><td><em>int</em> <dfn class="decl fn" id="xmss_sign" title='xmss_sign' data-ref="xmss_sign" data-ref-filename="xmss_sign">xmss_sign</dfn>(<em>unsigned</em> <em>char</em> *<dfn class="local col5 decl" id="45sk" title='sk' data-type='unsigned char *' data-ref="45sk" data-ref-filename="45sk">sk</dfn>, <a class="typedef" href="#bds_state" title='bds_state' data-type='struct bds_state' data-ref="bds_state" data-ref-filename="bds_state">bds_state</a> *<dfn class="local col6 decl" id="46state" title='state' data-type='bds_state *' data-ref="46state" data-ref-filename="46state">state</dfn>, <em>unsigned</em> <em>char</em> *<dfn class="local col7 decl" id="47sig_msg" title='sig_msg' data-type='unsigned char *' data-ref="47sig_msg" data-ref-filename="47sig_msg">sig_msg</dfn>, <em>unsigned</em> <em>long</em> <em>long</em> *<dfn class="local col8 decl" id="48sig_msg_len" title='sig_msg_len' data-type='unsigned long long *' data-ref="48sig_msg_len" data-ref-filename="48sig_msg_len">sig_msg_len</dfn>, <em>const</em> <em>unsigned</em> <em>char</em> *<dfn class="local col9 decl" id="49msg" title='msg' data-type='const unsigned char *' data-ref="49msg" data-ref-filename="49msg">msg</dfn>,<em>unsigned</em> <em>long</em> <em>long</em> <dfn class="local col0 decl" id="50msglen" title='msglen' data-type='unsigned long long' data-ref="50msglen" data-ref-filename="50msglen">msglen</dfn>, <em>const</em> <a class="typedef" href="#xmss_params" title='xmss_params' data-type='struct xmss_params' data-ref="xmss_params" data-ref-filename="xmss_params">xmss_params</a> *<dfn class="local col1 decl" id="51params" title='params' data-type='const xmss_params *' data-ref="51params" data-ref-filename="51params">params</dfn>);</td></tr>
<tr><th id="85">85</th><td><i class="doc">/**</i></td></tr>
<tr><th id="86">86</th><td><i class="doc"> * Verifies a given message signature pair under a given public key.</i></td></tr>
<tr><th id="87">87</th><td><i class="doc"> * </i></td></tr>
<tr><th id="88">88</th><td><i class="doc"> * Note: msg and msglen are pure outputs which carry the message in case verification succeeds. The (input) message is assumed to be within sig_msg which has the form (sig||msg). </i></td></tr>
<tr><th id="89">89</th><td><i class="doc"> */</i></td></tr>
<tr><th id="90">90</th><td><em>int</em> <dfn class="decl fn" id="xmss_sign_open" title='xmss_sign_open' data-ref="xmss_sign_open" data-ref-filename="xmss_sign_open">xmss_sign_open</dfn>(<em>unsigned</em> <em>char</em> *<dfn class="local col2 decl" id="52msg" title='msg' data-type='unsigned char *' data-ref="52msg" data-ref-filename="52msg">msg</dfn>,<em>unsigned</em> <em>long</em> <em>long</em> *<dfn class="local col3 decl" id="53msglen" title='msglen' data-type='unsigned long long *' data-ref="53msglen" data-ref-filename="53msglen">msglen</dfn>, <em>const</em> <em>unsigned</em> <em>char</em> *<dfn class="local col4 decl" id="54sig_msg" title='sig_msg' data-type='const unsigned char *' data-ref="54sig_msg" data-ref-filename="54sig_msg">sig_msg</dfn>,<em>unsigned</em> <em>long</em> <em>long</em> <dfn class="local col5 decl" id="55sig_msg_len" title='sig_msg_len' data-type='unsigned long long' data-ref="55sig_msg_len" data-ref-filename="55sig_msg_len">sig_msg_len</dfn>, <em>const</em> <em>unsigned</em> <em>char</em> *<dfn class="local col6 decl" id="56pk" title='pk' data-type='const unsigned char *' data-ref="56pk" data-ref-filename="56pk">pk</dfn>, <em>const</em> <a class="typedef" href="#xmss_params" title='xmss_params' data-type='struct xmss_params' data-ref="xmss_params" data-ref-filename="xmss_params">xmss_params</a> *<dfn class="local col7 decl" id="57params" title='params' data-type='const xmss_params *' data-ref="57params" data-ref-filename="57params">params</dfn>);</td></tr>
<tr><th id="91">91</th><td></td></tr>
<tr><th id="92">92</th><td><i>/*</i></td></tr>
<tr><th id="93">93</th><td><i> * Generates a XMSSMT key pair for a given parameter set.</i></td></tr>
<tr><th id="94">94</th><td><i> * Format sk: [(ceil(h/8) bit) idx || SK_SEED || SK_PRF || PUB_SEED || root]</i></td></tr>
<tr><th id="95">95</th><td><i> * Format pk: [root || PUB_SEED] omitting algo oid.</i></td></tr>
<tr><th id="96">96</th><td><i> */</i></td></tr>
<tr><th id="97">97</th><td><em>int</em> <dfn class="decl fn" id="xmssmt_keypair" title='xmssmt_keypair' data-ref="xmssmt_keypair" data-ref-filename="xmssmt_keypair">xmssmt_keypair</dfn>(<em>unsigned</em> <em>char</em> *<dfn class="local col8 decl" id="58pk" title='pk' data-type='unsigned char *' data-ref="58pk" data-ref-filename="58pk">pk</dfn>, <em>unsigned</em> <em>char</em> *<dfn class="local col9 decl" id="59sk" title='sk' data-type='unsigned char *' data-ref="59sk" data-ref-filename="59sk">sk</dfn>, <a class="typedef" href="#bds_state" title='bds_state' data-type='struct bds_state' data-ref="bds_state" data-ref-filename="bds_state">bds_state</a> *<dfn class="local col0 decl" id="60states" title='states' data-type='bds_state *' data-ref="60states" data-ref-filename="60states">states</dfn>, <em>unsigned</em> <em>char</em> *<dfn class="local col1 decl" id="61wots_sigs" title='wots_sigs' data-type='unsigned char *' data-ref="61wots_sigs" data-ref-filename="61wots_sigs">wots_sigs</dfn>, <a class="typedef" href="#xmssmt_params" title='xmssmt_params' data-type='struct xmssmt_params' data-ref="xmssmt_params" data-ref-filename="xmssmt_params">xmssmt_params</a> *<dfn class="local col2 decl" id="62params" title='params' data-type='xmssmt_params *' data-ref="62params" data-ref-filename="62params">params</dfn>);</td></tr>
<tr><th id="98">98</th><td><i class="doc">/**</i></td></tr>
<tr><th id="99">99</th><td><i class="doc"> * Signs a message.</i></td></tr>
<tr><th id="100">100</th><td><i class="doc"> * Returns </i></td></tr>
<tr><th id="101">101</th><td><i class="doc"> * 1. an array containing the signature followed by the message AND</i></td></tr>
<tr><th id="102">102</th><td><i class="doc"> * 2. an updated secret key!</i></td></tr>
<tr><th id="103">103</th><td><i class="doc"> * </i></td></tr>
<tr><th id="104">104</th><td><i class="doc"> */</i></td></tr>
<tr><th id="105">105</th><td><em>int</em> <dfn class="decl fn" id="xmssmt_sign" title='xmssmt_sign' data-ref="xmssmt_sign" data-ref-filename="xmssmt_sign">xmssmt_sign</dfn>(<em>unsigned</em> <em>char</em> *<dfn class="local col3 decl" id="63sk" title='sk' data-type='unsigned char *' data-ref="63sk" data-ref-filename="63sk">sk</dfn>, <a class="typedef" href="#bds_state" title='bds_state' data-type='struct bds_state' data-ref="bds_state" data-ref-filename="bds_state">bds_state</a> *<dfn class="local col4 decl" id="64state" title='state' data-type='bds_state *' data-ref="64state" data-ref-filename="64state">state</dfn>, <em>unsigned</em> <em>char</em> *<dfn class="local col5 decl" id="65wots_sigs" title='wots_sigs' data-type='unsigned char *' data-ref="65wots_sigs" data-ref-filename="65wots_sigs">wots_sigs</dfn>, <em>unsigned</em> <em>char</em> *<dfn class="local col6 decl" id="66sig_msg" title='sig_msg' data-type='unsigned char *' data-ref="66sig_msg" data-ref-filename="66sig_msg">sig_msg</dfn>, <em>unsigned</em> <em>long</em> <em>long</em> *<dfn class="local col7 decl" id="67sig_msg_len" title='sig_msg_len' data-type='unsigned long long *' data-ref="67sig_msg_len" data-ref-filename="67sig_msg_len">sig_msg_len</dfn>, <em>const</em> <em>unsigned</em> <em>char</em> *<dfn class="local col8 decl" id="68msg" title='msg' data-type='const unsigned char *' data-ref="68msg" data-ref-filename="68msg">msg</dfn>, <em>unsigned</em> <em>long</em> <em>long</em> <dfn class="local col9 decl" id="69msglen" title='msglen' data-type='unsigned long long' data-ref="69msglen" data-ref-filename="69msglen">msglen</dfn>, <em>const</em> <a class="typedef" href="#xmssmt_params" title='xmssmt_params' data-type='struct xmssmt_params' data-ref="xmssmt_params" data-ref-filename="xmssmt_params">xmssmt_params</a> *<dfn class="local col0 decl" id="70params" title='params' data-type='const xmssmt_params *' data-ref="70params" data-ref-filename="70params">params</dfn>);</td></tr>
<tr><th id="106">106</th><td><i class="doc">/**</i></td></tr>
<tr><th id="107">107</th><td><i class="doc"> * Verifies a given message signature pair under a given public key.</i></td></tr>
<tr><th id="108">108</th><td><i class="doc"> */</i></td></tr>
<tr><th id="109">109</th><td><em>int</em> <dfn class="decl fn" id="xmssmt_sign_open" title='xmssmt_sign_open' data-ref="xmssmt_sign_open" data-ref-filename="xmssmt_sign_open">xmssmt_sign_open</dfn>(<em>unsigned</em> <em>char</em> *<dfn class="local col1 decl" id="71msg" title='msg' data-type='unsigned char *' data-ref="71msg" data-ref-filename="71msg">msg</dfn>, <em>unsigned</em> <em>long</em> <em>long</em> *<dfn class="local col2 decl" id="72msglen" title='msglen' data-type='unsigned long long *' data-ref="72msglen" data-ref-filename="72msglen">msglen</dfn>, <em>const</em> <em>unsigned</em> <em>char</em> *<dfn class="local col3 decl" id="73sig_msg" title='sig_msg' data-type='const unsigned char *' data-ref="73sig_msg" data-ref-filename="73sig_msg">sig_msg</dfn>, <em>unsigned</em> <em>long</em> <em>long</em> <dfn class="local col4 decl" id="74sig_msg_len" title='sig_msg_len' data-type='unsigned long long' data-ref="74sig_msg_len" data-ref-filename="74sig_msg_len">sig_msg_len</dfn>, <em>const</em> <em>unsigned</em> <em>char</em> *<dfn class="local col5 decl" id="75pk" title='pk' data-type='const unsigned char *' data-ref="75pk" data-ref-filename="75pk">pk</dfn>, <em>const</em> <a class="typedef" href="#xmssmt_params" title='xmssmt_params' data-type='struct xmssmt_params' data-ref="xmssmt_params" data-ref-filename="xmssmt_params">xmssmt_params</a> *<dfn class="local col6 decl" id="76params" title='params' data-type='const xmssmt_params *' data-ref="76params" data-ref-filename="76params">params</dfn>);</td></tr>
<tr><th id="110">110</th><td><u>#<span data-ppcond="12">endif</span></u></td></tr>
<tr><th id="111">111</th><td></td></tr>
<tr><th id="112">112</th><td></td></tr>
</table><hr/><p id='footer'>
Generated while processing <a href='ssh-xmss.c.html'>netbsd/crypto/external/bsd/openssh/dist/ssh-xmss.c</a><br/>Generated on <em>2019-Jul-19</em> from project netbsd revision <em>f9da89e0d</em><br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 2.1
<br/>Generator usage only permitted with license.</p>
</div></body></html>
