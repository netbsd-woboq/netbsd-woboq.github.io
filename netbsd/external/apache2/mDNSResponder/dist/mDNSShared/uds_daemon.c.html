<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>uds_daemon.c source code [netbsd/external/apache2/mDNSResponder/dist/mDNSShared/uds_daemon.c] - Woboq Code Browser</title>
<meta name="woboq:interestingDefinitions" content="CompileTimeAssertionChecks_uds_daemon "/>
<link rel="stylesheet" href="https://code.woboq.org/data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="https://code.woboq.org/data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="https://code.woboq.org/data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="https://code.woboq.org/data/jquery/jquery-ui.min.js"></script>
<script>var file = 'netbsd/external/apache2/mDNSResponder/dist/mDNSShared/uds_daemon.c'; var root_path = '../../../../../..'; var data_path = 'https://code.woboq.org/data'; var ecma_script_api_version = 2;</script>
<script src='https://code.woboq.org/data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='../../../../..'>netbsd</a>/<a href='../../../..'>external</a>/<a href='../../..'>apache2</a>/<a href='../..'>mDNSResponder</a>/<a href='..'>dist</a>/<a href='./'>mDNSShared</a>/<a href='uds_daemon.c.html'>uds_daemon.c</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>/* -*- Mode: C; tab-width: 4 -*-</i></td></tr>
<tr><th id="2">2</th><td><i> *</i></td></tr>
<tr><th id="3">3</th><td><i> * Copyright (c) 2003-2015 Apple Inc. All rights reserved.</i></td></tr>
<tr><th id="4">4</th><td><i> *</i></td></tr>
<tr><th id="5">5</th><td><i> * Licensed under the Apache License, Version 2.0 (the "License");</i></td></tr>
<tr><th id="6">6</th><td><i> * you may not use this file except in compliance with the License.</i></td></tr>
<tr><th id="7">7</th><td><i> * You may obtain a copy of the License at</i></td></tr>
<tr><th id="8">8</th><td><i> *</i></td></tr>
<tr><th id="9">9</th><td><i> *     <a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></i></td></tr>
<tr><th id="10">10</th><td><i> *</i></td></tr>
<tr><th id="11">11</th><td><i> * Unless required by applicable law or agreed to in writing, software</i></td></tr>
<tr><th id="12">12</th><td><i> * distributed under the License is distributed on an "AS IS" BASIS,</i></td></tr>
<tr><th id="13">13</th><td><i> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</i></td></tr>
<tr><th id="14">14</th><td><i> * See the License for the specific language governing permissions and</i></td></tr>
<tr><th id="15">15</th><td><i> * limitations under the License.</i></td></tr>
<tr><th id="16">16</th><td><i> */</i></td></tr>
<tr><th id="17">17</th><td></td></tr>
<tr><th id="18">18</th><td><u>#<span data-ppcond="18">if</span> defined(<span class="macro" data-ref="_M/_WIN32">_WIN32</span>)</u></td></tr>
<tr><th id="19">19</th><td><u>#include &lt;process.h&gt;</u></td></tr>
<tr><th id="20">20</th><td><u>#define usleep(X) Sleep(((X)+999)/1000)</u></td></tr>
<tr><th id="21">21</th><td><u>#<span data-ppcond="18">else</span></u></td></tr>
<tr><th id="22">22</th><td><u>#include <a href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/fcntl.h.html">&lt;fcntl.h&gt;</a></u></td></tr>
<tr><th id="23">23</th><td><u>#include <a href="../../../../../objdir.amd64/destdir.amd64/usr/include/errno.h.html">&lt;errno.h&gt;</a></u></td></tr>
<tr><th id="24">24</th><td><u>#include <a href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/ioctl.h.html">&lt;sys/ioctl.h&gt;</a></u></td></tr>
<tr><th id="25">25</th><td><u>#include <a href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html">&lt;sys/types.h&gt;</a></u></td></tr>
<tr><th id="26">26</th><td><u>#include <a href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/time.h.html">&lt;sys/time.h&gt;</a></u></td></tr>
<tr><th id="27">27</th><td><u>#include <a href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/resource.h.html">&lt;sys/resource.h&gt;</a></u></td></tr>
<tr><th id="28">28</th><td><u>#<span data-ppcond="18">endif</span></u></td></tr>
<tr><th id="29">29</th><td></td></tr>
<tr><th id="30">30</th><td><u>#include <a href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html">&lt;stdlib.h&gt;</a></u></td></tr>
<tr><th id="31">31</th><td><u>#include <a href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html">&lt;stdio.h&gt;</a></u></td></tr>
<tr><th id="32">32</th><td></td></tr>
<tr><th id="33">33</th><td><u>#include <a href="../mDNSCore/mDNSEmbeddedAPI.h.html">"mDNSEmbeddedAPI.h"</a></u></td></tr>
<tr><th id="34">34</th><td><u>#include <a href="../mDNSCore/DNSCommon.h.html">"DNSCommon.h"</a></u></td></tr>
<tr><th id="35">35</th><td><u>#include <a href="../mDNSCore/uDNS.h.html">"uDNS.h"</a></u></td></tr>
<tr><th id="36">36</th><td><u>#include <a href="uds_daemon.h.html">"uds_daemon.h"</a></u></td></tr>
<tr><th id="37">37</th><td><u>#include <a href="dns_sd_internal.h.html">"dns_sd_internal.h"</a></u></td></tr>
<tr><th id="38">38</th><td></td></tr>
<tr><th id="39">39</th><td><i>// Normally we append search domains only for queries with a single label that are not</i></td></tr>
<tr><th id="40">40</th><td><i>// fully qualified. This can be overridden to apply search domains for queries (that are</i></td></tr>
<tr><th id="41">41</th><td><i>// not fully qualified) with any number of labels e.g., moon, moon.cs, moon.cs.be, etc.</i></td></tr>
<tr><th id="42">42</th><td><a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSBool" title='mDNSBool' data-type='unsigned char' data-ref="mDNSBool" data-ref-filename="mDNSBool">mDNSBool</a> <dfn class="decl def" id="AlwaysAppendSearchDomains" title='AlwaysAppendSearchDomains' data-ref="AlwaysAppendSearchDomains" data-ref-filename="AlwaysAppendSearchDomains">AlwaysAppendSearchDomains</dfn> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>;</td></tr>
<tr><th id="43">43</th><td></td></tr>
<tr><th id="44">44</th><td><i>// Apple-specific functionality, not required for other platforms</i></td></tr>
<tr><th id="45">45</th><td><u>#<span data-ppcond="45">if</span> APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="46">46</th><td><u>#include &lt;sys/ucred.h&gt;</u></td></tr>
<tr><th id="47">47</th><td><u>#ifndef PID_FILE</u></td></tr>
<tr><th id="48">48</th><td><u>#define PID_FILE ""</u></td></tr>
<tr><th id="49">49</th><td><u>#endif</u></td></tr>
<tr><th id="50">50</th><td><u>#<span data-ppcond="45">endif</span></u></td></tr>
<tr><th id="51">51</th><td></td></tr>
<tr><th id="52">52</th><td><u>#<span data-ppcond="52">ifdef</span> <span class="macro" data-ref="_M/LOCAL_PEEREPID">LOCAL_PEEREPID</span></u></td></tr>
<tr><th id="53">53</th><td><u>#include &lt;sys/un.h&gt;         // for LOCAL_PEEREPID</u></td></tr>
<tr><th id="54">54</th><td><u>#include &lt;sys/socket.h&gt;     // for getsockopt</u></td></tr>
<tr><th id="55">55</th><td><u>#include &lt;sys/proc_info.h&gt;  // for struct proc_bsdshortinfo</u></td></tr>
<tr><th id="56">56</th><td><u>#include &lt;libproc.h&gt;        // for proc_pidinfo()</u></td></tr>
<tr><th id="57">57</th><td><u>#<span data-ppcond="52">endif</span> //LOCAL_PEEREPID</u></td></tr>
<tr><th id="58">58</th><td></td></tr>
<tr><th id="59">59</th><td><u>#<span data-ppcond="59">ifdef</span> <span class="macro" data-ref="_M/UNIT_TEST">UNIT_TEST</span></u></td></tr>
<tr><th id="60">60</th><td><u>#include "unittest.h"</u></td></tr>
<tr><th id="61">61</th><td><u>#<span data-ppcond="59">endif</span></u></td></tr>
<tr><th id="62">62</th><td></td></tr>
<tr><th id="63">63</th><td><u>#<span data-ppcond="63">if</span> APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="64">64</th><td><u>#include &lt;WebFilterDNS/WebFilterDNS.h&gt;</u></td></tr>
<tr><th id="65">65</th><td><u>#include "BLE.h"</u></td></tr>
<tr><th id="66">66</th><td></td></tr>
<tr><th id="67">67</th><td><u>#if !NO_WCF</u></td></tr>
<tr><th id="68">68</th><td></td></tr>
<tr><th id="69">69</th><td><em>int</em> WCFIsServerRunning(WCFConnection *conn) <b>__attribute__</b>((weak_import));</td></tr>
<tr><th id="70">70</th><td><em>int</em> WCFNameResolvesToAddr(WCFConnection *conn, <em>char</em>* domainName, <b>struct</b> sockaddr* address, uid_t userid) <b>__attribute__</b>((weak_import));</td></tr>
<tr><th id="71">71</th><td><em>int</em> WCFNameResolvesToName(WCFConnection *conn, <em>char</em>* fromName, <em>char</em>* toName, uid_t userid) <b>__attribute__</b>((weak_import));</td></tr>
<tr><th id="72">72</th><td></td></tr>
<tr><th id="73">73</th><td><i>// Do we really need to define a macro for "if"?</i></td></tr>
<tr><th id="74">74</th><td><u>#define CHECK_WCF_FUNCTION(X) if (X)</u></td></tr>
<tr><th id="75">75</th><td><u>#endif // ! NO_WCF</u></td></tr>
<tr><th id="76">76</th><td></td></tr>
<tr><th id="77">77</th><td><u>#<span data-ppcond="63">else</span></u></td></tr>
<tr><th id="78">78</th><td><u>#define <dfn class="macro" id="_M/NO_WCF" data-ref="_M/NO_WCF">NO_WCF</dfn> 1</u></td></tr>
<tr><th id="79">79</th><td><u>#<span data-ppcond="63">endif</span> // APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="80">80</th><td></td></tr>
<tr><th id="81">81</th><td><i>// User IDs 0-500 are system-wide processes, not actual users in the usual sense</i></td></tr>
<tr><th id="82">82</th><td><i>// User IDs for real user accounts start at 501 and count up from there</i></td></tr>
<tr><th id="83">83</th><td><u>#define <dfn class="macro" id="_M/SystemUID" data-ref="_M/SystemUID">SystemUID</dfn>(X) ((X) &lt;= 500)</u></td></tr>
<tr><th id="84">84</th><td></td></tr>
<tr><th id="85">85</th><td><u>#define <dfn class="macro" id="_M/MAX_ANONYMOUS_DATA" data-ref="_M/MAX_ANONYMOUS_DATA">MAX_ANONYMOUS_DATA</dfn>      256</u></td></tr>
<tr><th id="86">86</th><td></td></tr>
<tr><th id="87">87</th><td><i>// ***************************************************************************</i></td></tr>
<tr><th id="88">88</th><td><u>#<span data-ppcond="88">if</span> COMPILER_LIKES_PRAGMA_MARK</u></td></tr>
<tr><th id="89">89</th><td><u>#pragma mark -</u></td></tr>
<tr><th id="90">90</th><td><u>#pragma mark - Globals</u></td></tr>
<tr><th id="91">91</th><td><u>#<span data-ppcond="88">endif</span></u></td></tr>
<tr><th id="92">92</th><td></td></tr>
<tr><th id="93">93</th><td><i>// globals</i></td></tr>
<tr><th id="94">94</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#116" title="" data-ref="_M/mDNSexport">mDNSexport</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS" title='mDNS' data-type='struct mDNS_struct' data-ref="mDNS" data-ref-filename="mDNS">mDNS</a> <dfn class="decl def" id="mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</dfn>;</td></tr>
<tr><th id="95">95</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#116" title="" data-ref="_M/mDNSexport">mDNSexport</a> <em>const</em> <em>char</em> <dfn class="decl def" id="ProgramName" title='ProgramName' data-ref="ProgramName" data-ref-filename="ProgramName">ProgramName</dfn>[] = <q>"mDNSResponder"</q>;</td></tr>
<tr><th id="96">96</th><td></td></tr>
<tr><th id="97">97</th><td><u>#<span data-ppcond="97">if</span> defined(<span class="macro" data-ref="_M/USE_TCP_LOOPBACK">USE_TCP_LOOPBACK</span>)</u></td></tr>
<tr><th id="98">98</th><td><em>static</em> <em>char</em>* boundPath = NULL;</td></tr>
<tr><th id="99">99</th><td><u>#<span data-ppcond="97">else</span></u></td></tr>
<tr><th id="100">100</th><td><em>static</em> <em>char</em>* <dfn class="tu decl def" id="boundPath" title='boundPath' data-type='char *' data-ref="boundPath" data-ref-filename="boundPath">boundPath</dfn> = <span class="macro" title="&quot;/var/run/mdnsd/mdnsd&quot;" data-ref="_M/MDNS_UDS_SERVERPATH">MDNS_UDS_SERVERPATH</span>;</td></tr>
<tr><th id="101">101</th><td><u>#<span data-ppcond="97">endif</span></u></td></tr>
<tr><th id="102">102</th><td><u>#<span data-ppcond="102">if</span> DEBUG</u></td></tr>
<tr><th id="103">103</th><td><u>#define MDNS_UDS_SERVERPATH_DEBUG "/var/tmp/mDNSResponder"</u></td></tr>
<tr><th id="104">104</th><td><u>#<span data-ppcond="102">endif</span></u></td></tr>
<tr><th id="105">105</th><td><em>static</em> <a class="typedef" href="dns_sd.h.html#dnssd_sock_t" title='dnssd_sock_t' data-type='int' data-ref="dnssd_sock_t" data-ref-filename="dnssd_sock_t">dnssd_sock_t</a> <dfn class="tu decl def" id="listenfd" title='listenfd' data-type='dnssd_sock_t' data-ref="listenfd" data-ref-filename="listenfd">listenfd</dfn> = <a class="macro" href="dnssd_ipc.h.html#63" title="-1" data-ref="_M/dnssd_InvalidSocket">dnssd_InvalidSocket</a>;</td></tr>
<tr><th id="106">106</th><td><em>static</em> <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="tu decl def" id="all_requests" title='all_requests' data-type='request_state *' data-ref="all_requests" data-ref-filename="all_requests">all_requests</dfn> = <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="107">107</th><td><u>#<span data-ppcond="107">ifdef</span> <span class="macro" data-ref="_M/LOCAL_PEEREPID">LOCAL_PEEREPID</span></u></td></tr>
<tr><th id="108">108</th><td><b>struct</b> proc_bsdshortinfo proc;</td></tr>
<tr><th id="109">109</th><td><u>#<span data-ppcond="107">endif</span> //LOCAL_PEEREPID</u></td></tr>
<tr><th id="110">110</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <a class="decl fn" href="#set_peer_pid" title='set_peer_pid' data-ref="set_peer_pid" data-ref-filename="set_peer_pid">set_peer_pid</a>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col1 decl" id="1request" title='request' data-type='request_state *' data-ref="1request" data-ref-filename="1request">request</dfn>);</td></tr>
<tr><th id="111">111</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <a class="decl fn" href="#LogMcastClientInfo" title='LogMcastClientInfo' data-ref="LogMcastClientInfo" data-ref-filename="LogMcastClientInfo">LogMcastClientInfo</a>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col2 decl" id="2req" title='req' data-type='request_state *' data-ref="2req" data-ref-filename="2req">req</dfn>);</td></tr>
<tr><th id="112">112</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <a class="decl fn" href="#GetMcastClients" title='GetMcastClients' data-ref="GetMcastClients" data-ref-filename="GetMcastClients">GetMcastClients</a>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col3 decl" id="3req" title='req' data-type='request_state *' data-ref="3req" data-ref-filename="3req">req</dfn>);</td></tr>
<tr><th id="113">113</th><td><em>static</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="tu decl def" id="mcount" title='mcount' data-type='mDNSu32' data-ref="mcount" data-ref-filename="mcount">mcount</dfn>;     <i  data-doc="mcount">// tracks the current active mcast operations for McastLogging</i></td></tr>
<tr><th id="114">114</th><td><em>static</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="tu decl def" id="i_mcount" title='i_mcount' data-type='mDNSu32' data-ref="i_mcount" data-ref-filename="i_mcount">i_mcount</dfn>;   <i  data-doc="i_mcount">// sets mcount when McastLogging is enabled(PROF signal is sent)</i></td></tr>
<tr><th id="115">115</th><td><em>static</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="tu decl def" id="n_mrecords" title='n_mrecords' data-type='mDNSu32' data-ref="n_mrecords" data-ref-filename="n_mrecords">n_mrecords</dfn>; <i  data-doc="n_mrecords">// tracks the current active mcast records for McastLogging</i></td></tr>
<tr><th id="116">116</th><td><em>static</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="tu decl def" id="n_mquests" title='n_mquests' data-type='mDNSu32' data-ref="n_mquests" data-ref-filename="n_mquests">n_mquests</dfn>;  <i  data-doc="n_mquests">// tracks the current active mcast questions for McastLogging</i></td></tr>
<tr><th id="117">117</th><td></td></tr>
<tr><th id="118">118</th><td></td></tr>
<tr><th id="119">119</th><td><u>#<span data-ppcond="119">if</span> TARGET_OS_EMBEDDED</u></td></tr>
<tr><th id="120">120</th><td>mDNSu32 curr_num_regservices = <var>0</var>;</td></tr>
<tr><th id="121">121</th><td>mDNSu32 max_num_regservices = <var>0</var>;</td></tr>
<tr><th id="122">122</th><td><u>#<span data-ppcond="119">endif</span></u></td></tr>
<tr><th id="123">123</th><td></td></tr>
<tr><th id="124">124</th><td></td></tr>
<tr><th id="125">125</th><td><i>// Note asymmetry here between registration and browsing.</i></td></tr>
<tr><th id="126">126</th><td><i>// For service registrations we only automatically register in domains that explicitly appear in local configuration data</i></td></tr>
<tr><th id="127">127</th><td><i>// (so AutoRegistrationDomains could equally well be called SCPrefRegDomains)</i></td></tr>
<tr><th id="128">128</th><td><i>// For service browsing we also learn automatic browsing domains from the network, so for that case we have:</i></td></tr>
<tr><th id="129">129</th><td><i>// 1. SCPrefBrowseDomains (local configuration data)</i></td></tr>
<tr><th id="130">130</th><td><i>// 2. LocalDomainEnumRecords (locally-generated local-only PTR records -- equivalent to slElem-&gt;AuthRecs in uDNS.c)</i></td></tr>
<tr><th id="131">131</th><td><i>// 3. AutoBrowseDomains, which is populated by tracking add/rmv events in AutomaticBrowseDomainChange, the callback function for our mDNS_GetDomains call.</i></td></tr>
<tr><th id="132">132</th><td><i>// By creating and removing our own LocalDomainEnumRecords, we trigger AutomaticBrowseDomainChange callbacks just like domains learned from the network would.</i></td></tr>
<tr><th id="133">133</th><td></td></tr>
<tr><th id="134">134</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#116" title="" data-ref="_M/mDNSexport">mDNSexport</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem" title='DNameListElem' data-type='struct DNameListElem' data-ref="DNameListElem" data-ref-filename="DNameListElem">DNameListElem</a> *<dfn class="decl def" id="AutoRegistrationDomains" title='AutoRegistrationDomains' data-ref="AutoRegistrationDomains" data-ref-filename="AutoRegistrationDomains">AutoRegistrationDomains</dfn>;  <i>// Domains where we automatically register for empty-string registrations</i></td></tr>
<tr><th id="135">135</th><td></td></tr>
<tr><th id="136">136</th><td><em>static</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem" title='DNameListElem' data-type='struct DNameListElem' data-ref="DNameListElem" data-ref-filename="DNameListElem">DNameListElem</a> *<dfn class="tu decl def" id="SCPrefBrowseDomains" title='SCPrefBrowseDomains' data-type='DNameListElem *' data-ref="SCPrefBrowseDomains" data-ref-filename="SCPrefBrowseDomains">SCPrefBrowseDomains</dfn>;          <i  data-doc="SCPrefBrowseDomains">// List of automatic browsing domains read from SCPreferences for "empty string" browsing</i></td></tr>
<tr><th id="137">137</th><td><em>static</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ARListElem" title='ARListElem' data-type='struct ARListElem' data-ref="ARListElem" data-ref-filename="ARListElem">ARListElem</a>    *<dfn class="tu decl def" id="LocalDomainEnumRecords" title='LocalDomainEnumRecords' data-type='ARListElem *' data-ref="LocalDomainEnumRecords" data-ref-filename="LocalDomainEnumRecords">LocalDomainEnumRecords</dfn>;       <i  data-doc="LocalDomainEnumRecords">// List of locally-generated PTR records to augment those we learn from the network</i></td></tr>
<tr><th id="138">138</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#116" title="" data-ref="_M/mDNSexport">mDNSexport</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem" title='DNameListElem' data-type='struct DNameListElem' data-ref="DNameListElem" data-ref-filename="DNameListElem">DNameListElem</a> *<dfn class="decl def" id="AutoBrowseDomains" title='AutoBrowseDomains' data-ref="AutoBrowseDomains" data-ref-filename="AutoBrowseDomains">AutoBrowseDomains</dfn>;        <i>// List created from those local-only PTR records plus records we get from the network</i></td></tr>
<tr><th id="139">139</th><td></td></tr>
<tr><th id="140">140</th><td><u>#define <dfn class="macro" id="_M/MSG_PAD_BYTES" data-ref="_M/MSG_PAD_BYTES">MSG_PAD_BYTES</dfn> 5     // pad message buffer (read from client) with n zero'd bytes to guarantee</u></td></tr>
<tr><th id="141">141</th><td>                            <i>// n get_string() calls w/o buffer overrun</i></td></tr>
<tr><th id="142">142</th><td><i>// initialization, setup/teardown functions</i></td></tr>
<tr><th id="143">143</th><td><i></i></td></tr>
<tr><th id="144">144</th><td><i>// If a platform specifies its own PID file name, we use that</i></td></tr>
<tr><th id="145">145</th><td><u>#<span data-ppcond="145">ifndef</span> <span class="macro" data-ref="_M/PID_FILE">PID_FILE</span></u></td></tr>
<tr><th id="146">146</th><td><u>#define PID_FILE "/var/run/mDNSResponder.pid"</u></td></tr>
<tr><th id="147">147</th><td><u>#<span data-ppcond="145">endif</span></u></td></tr>
<tr><th id="148">148</th><td></td></tr>
<tr><th id="149">149</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>char</em> *<a class="decl fn" href="#AnonDataToString" title='AnonDataToString' data-ref="AnonDataToString" data-ref-filename="AnonDataToString">AnonDataToString</a>(<em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu8" title='mDNSu8' data-type='unsigned char' data-ref="mDNSu8" data-ref-filename="mDNSu8">mDNSu8</a> *<dfn class="local col4 decl" id="4ad" title='ad' data-type='const mDNSu8 *' data-ref="4ad" data-ref-filename="4ad">ad</dfn>, <em>int</em> <dfn class="local col5 decl" id="5adlen" title='adlen' data-type='int' data-ref="5adlen" data-ref-filename="5adlen">adlen</dfn>, <em>char</em> *<dfn class="local col6 decl" id="6adstr" title='adstr' data-type='char *' data-ref="6adstr" data-ref-filename="6adstr">adstr</dfn>, <em>int</em> <dfn class="local col7 decl" id="7adstrlen" title='adstrlen' data-type='int' data-ref="7adstrlen" data-ref-filename="7adstrlen">adstrlen</dfn>);</td></tr>
<tr><th id="150">150</th><td></td></tr>
<tr><th id="151">151</th><td><i>// ***************************************************************************</i></td></tr>
<tr><th id="152">152</th><td><u>#<span data-ppcond="152">if</span> COMPILER_LIKES_PRAGMA_MARK</u></td></tr>
<tr><th id="153">153</th><td><u>#pragma mark -</u></td></tr>
<tr><th id="154">154</th><td><u>#pragma mark - General Utility Functions</u></td></tr>
<tr><th id="155">155</th><td><u>#<span data-ppcond="152">endif</span></u></td></tr>
<tr><th id="156">156</th><td></td></tr>
<tr><th id="157">157</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="FatalError" title='FatalError' data-ref="FatalError" data-ref-filename="FatalError">FatalError</dfn>(<em>char</em> *<dfn class="local col8 decl" id="8errmsg" title='errmsg' data-type='char *' data-ref="8errmsg" data-ref-filename="8errmsg">errmsg</dfn>)</td></tr>
<tr><th id="158">158</th><td>{</td></tr>
<tr><th id="159">159</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%s: %s&quot;, errmsg, strerror((*__errno())))" data-ref="_M/LogMsg">LogMsg</a>(<q>"%s: %s"</q>, <a class="local col8 ref" href="#8errmsg" title='errmsg' data-ref="8errmsg" data-ref-filename="8errmsg">errmsg</a>, <a class="macro" href="dnssd_ipc.h.html#72" title="strerror((*__errno()))" data-ref="_M/dnssd_strerror">dnssd_strerror</a>(<a class="macro" href="dnssd_ipc.h.html#71" title="(*__errno())" data-ref="_M/dnssd_errno">dnssd_errno</a>));</td></tr>
<tr><th id="160">160</th><td>    <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#abort" title='abort' data-ref="abort" data-ref-filename="abort">abort</a>();</td></tr>
<tr><th id="161">161</th><td>}</td></tr>
<tr><th id="162">162</th><td></td></tr>
<tr><th id="163">163</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="decl def fn" id="dnssd_htonl" title='dnssd_htonl' data-ref="dnssd_htonl" data-ref-filename="dnssd_htonl">dnssd_htonl</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col9 decl" id="9l" title='l' data-type='mDNSu32' data-ref="9l" data-ref-filename="9l">l</dfn>)</td></tr>
<tr><th id="164">164</th><td>{</td></tr>
<tr><th id="165">165</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col0 decl" id="10ret" title='ret' data-type='mDNSu32' data-ref="10ret" data-ref-filename="10ret">ret</dfn>;</td></tr>
<tr><th id="166">166</th><td>    <em>char</em> *<dfn class="local col1 decl" id="11data" title='data' data-type='char *' data-ref="11data" data-ref-filename="11data">data</dfn> = (<em>char</em>*) &amp;<a class="local col0 ref" href="#10ret" title='ret' data-ref="10ret" data-ref-filename="10ret">ret</a>;</td></tr>
<tr><th id="167">167</th><td>    <a class="macro" href="dnssd_ipc.h.html#193" title="__dnssd_ipc_put_uint32" data-ref="_M/put_uint32">put_uint32</a>(<a class="local col9 ref" href="#9l" title='l' data-ref="9l" data-ref-filename="9l">l</a>, &amp;<a class="local col1 ref" href="#11data" title='data' data-ref="11data" data-ref-filename="11data">data</a>);</td></tr>
<tr><th id="168">168</th><td>    <b>return</b> <a class="local col0 ref" href="#10ret" title='ret' data-ref="10ret" data-ref-filename="10ret">ret</a>;</td></tr>
<tr><th id="169">169</th><td>}</td></tr>
<tr><th id="170">170</th><td></td></tr>
<tr><th id="171">171</th><td><i>// hack to search-replace perror's to LogMsg's</i></td></tr>
<tr><th id="172">172</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="my_perror" title='my_perror' data-ref="my_perror" data-ref-filename="my_perror">my_perror</dfn>(<em>char</em> *<dfn class="local col2 decl" id="12errmsg" title='errmsg' data-type='char *' data-ref="12errmsg" data-ref-filename="12errmsg">errmsg</dfn>)</td></tr>
<tr><th id="173">173</th><td>{</td></tr>
<tr><th id="174">174</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%s: %d (%s)&quot;, errmsg, (*__errno()), strerror((*__errno())))" data-ref="_M/LogMsg">LogMsg</a>(<q>"%s: %d (%s)"</q>, <a class="local col2 ref" href="#12errmsg" title='errmsg' data-ref="12errmsg" data-ref-filename="12errmsg">errmsg</a>, <a class="macro" href="dnssd_ipc.h.html#71" title="(*__errno())" data-ref="_M/dnssd_errno">dnssd_errno</a>, <a class="macro" href="dnssd_ipc.h.html#72" title="strerror((*__errno()))" data-ref="_M/dnssd_strerror">dnssd_strerror</a>(<a class="macro" href="dnssd_ipc.h.html#71" title="(*__errno())" data-ref="_M/dnssd_errno">dnssd_errno</a>));</td></tr>
<tr><th id="175">175</th><td>}</td></tr>
<tr><th id="176">176</th><td></td></tr>
<tr><th id="177">177</th><td><i>// Throttled version of my_perror: Logs once every 250 msgs</i></td></tr>
<tr><th id="178">178</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="my_throttled_perror" title='my_throttled_perror' data-ref="my_throttled_perror" data-ref-filename="my_throttled_perror">my_throttled_perror</dfn>(<em>char</em> *<dfn class="local col3 decl" id="13err_msg" title='err_msg' data-type='char *' data-ref="13err_msg" data-ref-filename="13err_msg">err_msg</dfn>)</td></tr>
<tr><th id="179">179</th><td>{</td></tr>
<tr><th id="180">180</th><td>    <em>static</em> <em>int</em> <dfn class="local col4 decl" id="14uds_throttle_count" title='uds_throttle_count' data-type='int' data-ref="14uds_throttle_count" data-ref-filename="14uds_throttle_count">uds_throttle_count</dfn> = <var>0</var>;</td></tr>
<tr><th id="181">181</th><td>    <b>if</b> ((<a class="local col4 ref" href="#14uds_throttle_count" title='uds_throttle_count' data-ref="14uds_throttle_count" data-ref-filename="14uds_throttle_count">uds_throttle_count</a>++ % <var>250</var>) == <var>0</var>)</td></tr>
<tr><th id="182">182</th><td>        <a class="ref fn" href="#my_perror" title='my_perror' data-ref="my_perror" data-ref-filename="my_perror">my_perror</a>(<a class="local col3 ref" href="#13err_msg" title='err_msg' data-ref="13err_msg" data-ref-filename="13err_msg">err_msg</a>);</td></tr>
<tr><th id="183">183</th><td>}</td></tr>
<tr><th id="184">184</th><td></td></tr>
<tr><th id="185">185</th><td><i>// LogMcastQuestion/LogMcastQ should be called after the DNSQuestion struct is initialized(especially for q-&gt;TargetQID)</i></td></tr>
<tr><th id="186">186</th><td><i>// Hence all calls are made after mDNS_StartQuery()/mDNS_StopQuery()/mDNS_StopBrowse() is called.</i></td></tr>
<tr><th id="187">187</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="LogMcastQuestion" title='LogMcastQuestion' data-ref="LogMcastQuestion" data-ref-filename="LogMcastQuestion">LogMcastQuestion</dfn>(<em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion" title='DNSQuestion' data-type='struct DNSQuestion_struct' data-ref="DNSQuestion" data-ref-filename="DNSQuestion">DNSQuestion</a> *<em>const</em> <dfn class="local col5 decl" id="15q" title='q' data-type='const DNSQuestion *const' data-ref="15q" data-ref-filename="15q">q</dfn>, <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col6 decl" id="16req" title='req' data-type='request_state *' data-ref="16req" data-ref-filename="16req">req</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#q_state" title='q_state' data-type='enum q_state' data-ref="q_state" data-ref-filename="q_state">q_state</a> <dfn class="local col7 decl" id="17status" title='status' data-type='q_state' data-ref="17status" data-ref-filename="17status">status</dfn>)</td></tr>
<tr><th id="188">188</th><td>{</td></tr>
<tr><th id="189">189</th><td>    <b>if</b> (<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2964" title="((q-&gt;TargetQID).NotAnInteger == 0)" data-ref="_M/mDNSOpaque16IsZero">mDNSOpaque16IsZero</a>(<a class="local col5 ref" href="#15q" title='q' data-ref="15q" data-ref-filename="15q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::TargetQID" title='DNSQuestion_struct::TargetQID' data-ref="DNSQuestion_struct::TargetQID" data-ref-filename="DNSQuestion_struct..TargetQID">TargetQID</a>)) <i>// Check for Mcast Query</i></td></tr>
<tr><th id="190">190</th><td>    {</td></tr>
<tr><th id="191">191</th><td>        <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSBool" title='mDNSBool' data-type='unsigned char' data-ref="mDNSBool" data-ref-filename="mDNSBool">mDNSBool</a> <dfn class="local col8 decl" id="18mflag" title='mflag' data-type='mDNSBool' data-ref="18mflag" data-ref-filename="18mflag">mflag</dfn> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>;</td></tr>
<tr><th id="192">192</th><td>        <b>if</b> (<a class="local col7 ref" href="#17status" title='status' data-ref="17status" data-ref-filename="17status">status</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#q_start" title='q_start' data-ref="q_start" data-ref-filename="q_start">q_start</a>)</td></tr>
<tr><th id="193">193</th><td>        {</td></tr>
<tr><th id="194">194</th><td>            <b>if</b> (++<a class="tu ref" href="#mcount" title='mcount' data-use='w' data-ref="mcount" data-ref-filename="mcount">mcount</a> == <var>1</var>)</td></tr>
<tr><th id="195">195</th><td>                <a class="local col8 ref" href="#18mflag" title='mflag' data-ref="18mflag" data-ref-filename="18mflag">mflag</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>;</td></tr>
<tr><th id="196">196</th><td>        }</td></tr>
<tr><th id="197">197</th><td>        <b>else</b></td></tr>
<tr><th id="198">198</th><td>        {</td></tr>
<tr><th id="199">199</th><td>            <a class="tu ref" href="#mcount" title='mcount' data-use='w' data-ref="mcount" data-ref-filename="mcount">mcount</a>--;</td></tr>
<tr><th id="200">200</th><td>        }</td></tr>
<tr><th id="201">201</th><td>        <a class="macro" href="uds_daemon.h.html#226" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMsg" data-ref="_M/LogMcast">LogMcast</a>(<q>"%s: %##s  (%s) (%s)  Client(%d)[%s]"</q>, <a class="local col7 ref" href="#17status" title='status' data-ref="17status" data-ref-filename="17status">status</a> ? <q>"+Question"</q> : <q>"-Question"</q>, <a class="local col5 ref" href="#15q" title='q' data-ref="15q" data-ref-filename="15q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col5 ref" href="#15q" title='q' data-ref="15q" data-ref-filename="15q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a>),</td></tr>
<tr><th id="202">202</th><td>                 <a class="local col5 ref" href="#15q" title='q' data-ref="15q" data-ref-filename="15q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::InterfaceID" title='DNSQuestion_struct::InterfaceID' data-ref="DNSQuestion_struct::InterfaceID" data-ref-filename="DNSQuestion_struct..InterfaceID">InterfaceID</a> == <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterface_LocalOnly" title='mDNSInterface_LocalOnly' data-ref="mDNSInterface_LocalOnly" data-ref-filename="mDNSInterface_LocalOnly">mDNSInterface_LocalOnly</a> ? <q>"lo"</q> :</td></tr>
<tr><th id="203">203</th><td>                 <a class="local col5 ref" href="#15q" title='q' data-ref="15q" data-ref-filename="15q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::InterfaceID" title='DNSQuestion_struct::InterfaceID' data-ref="DNSQuestion_struct::InterfaceID" data-ref-filename="DNSQuestion_struct..InterfaceID">InterfaceID</a> == <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterface_P2P" title='mDNSInterface_P2P' data-ref="mDNSInterface_P2P" data-ref-filename="mDNSInterface_P2P">mDNSInterface_P2P</a> ? <q>"p2p"</q> :</td></tr>
<tr><th id="204">204</th><td>                 <a class="local col5 ref" href="#15q" title='q' data-ref="15q" data-ref-filename="15q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::InterfaceID" title='DNSQuestion_struct::InterfaceID' data-ref="DNSQuestion_struct::InterfaceID" data-ref-filename="DNSQuestion_struct..InterfaceID">InterfaceID</a> == <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterface_BLE" title='mDNSInterface_BLE' data-ref="mDNSInterface_BLE" data-ref-filename="mDNSInterface_BLE">mDNSInterface_BLE</a> ? <q>"BLE"</q> :</td></tr>
<tr><th id="205">205</th><td>                 <a class="local col5 ref" href="#15q" title='q' data-ref="15q" data-ref-filename="15q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::InterfaceID" title='DNSQuestion_struct::InterfaceID' data-ref="DNSQuestion_struct::InterfaceID" data-ref-filename="DNSQuestion_struct..InterfaceID">InterfaceID</a> == <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterface_Any" title='mDNSInterface_Any' data-ref="mDNSInterface_Any" data-ref-filename="mDNSInterface_Any">mDNSInterface_Any</a> ? <q>"any"</q> : <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#InterfaceNameForID" title='InterfaceNameForID' data-ref="InterfaceNameForID" data-ref-filename="InterfaceNameForID">InterfaceNameForID</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col5 ref" href="#15q" title='q' data-ref="15q" data-ref-filename="15q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::InterfaceID" title='DNSQuestion_struct::InterfaceID' data-ref="DNSQuestion_struct::InterfaceID" data-ref-filename="DNSQuestion_struct..InterfaceID">InterfaceID</a>),</td></tr>
<tr><th id="206">206</th><td>                 <a class="local col6 ref" href="#16req" title='req' data-ref="16req" data-ref-filename="16req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col6 ref" href="#16req" title='req' data-ref="16req" data-ref-filename="16req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="207">207</th><td>        <a class="ref fn" href="#LogMcastStateInfo" title='LogMcastStateInfo' data-ref="LogMcastStateInfo" data-ref-filename="LogMcastStateInfo">LogMcastStateInfo</a>(<a class="local col8 ref" href="#18mflag" title='mflag' data-ref="18mflag" data-ref-filename="18mflag">mflag</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>);</td></tr>
<tr><th id="208">208</th><td>    }</td></tr>
<tr><th id="209">209</th><td>    <b>return</b>;</td></tr>
<tr><th id="210">210</th><td>}</td></tr>
<tr><th id="211">211</th><td></td></tr>
<tr><th id="212">212</th><td><i>// LogMcastService/LogMcastS should be called after the AuthRecord struct is initialized</i></td></tr>
<tr><th id="213">213</th><td><i>// Hence all calls are made after mDNS_Register()/ just before mDNS_Deregister()</i></td></tr>
<tr><th id="214">214</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="LogMcastService" title='LogMcastService' data-ref="LogMcastService" data-ref-filename="LogMcastService">LogMcastService</dfn>(<em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord" title='AuthRecord' data-type='struct AuthRecord_struct' data-ref="AuthRecord" data-ref-filename="AuthRecord">AuthRecord</a> *<em>const</em> <dfn class="local col9 decl" id="19ar" title='ar' data-type='const AuthRecord *const' data-ref="19ar" data-ref-filename="19ar">ar</dfn>, <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col0 decl" id="20req" title='req' data-type='request_state *' data-ref="20req" data-ref-filename="20req">req</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#reg_state" title='reg_state' data-type='enum reg_state' data-ref="reg_state" data-ref-filename="reg_state">reg_state</a> <dfn class="local col1 decl" id="21status" title='status' data-type='reg_state' data-ref="21status" data-ref-filename="21status">status</dfn>)</td></tr>
<tr><th id="215">215</th><td>{</td></tr>
<tr><th id="216">216</th><td>    <b>if</b> (!<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#1601" title="((ar)-&gt;resrec.InterfaceID == mDNSInterface_Any &amp;&amp; !(ar)-&gt;ForceMCast &amp;&amp; !IsLocalDomain((ar)-&gt;resrec.name))" data-ref="_M/AuthRecord_uDNS">AuthRecord_uDNS</a>(<a class="local col9 ref" href="#19ar" title='ar' data-ref="19ar" data-ref-filename="19ar">ar</a>)) <i>// Check for Mcast Service</i></td></tr>
<tr><th id="217">217</th><td>    {</td></tr>
<tr><th id="218">218</th><td>        <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSBool" title='mDNSBool' data-type='unsigned char' data-ref="mDNSBool" data-ref-filename="mDNSBool">mDNSBool</a> <dfn class="local col2 decl" id="22mflag" title='mflag' data-type='mDNSBool' data-ref="22mflag" data-ref-filename="22mflag">mflag</dfn> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>;</td></tr>
<tr><th id="219">219</th><td>        <b>if</b> (<a class="local col1 ref" href="#21status" title='status' data-ref="21status" data-ref-filename="21status">status</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#reg_start" title='reg_start' data-ref="reg_start" data-ref-filename="reg_start">reg_start</a>)</td></tr>
<tr><th id="220">220</th><td>        {</td></tr>
<tr><th id="221">221</th><td>            <b>if</b> (++<a class="tu ref" href="#mcount" title='mcount' data-use='w' data-ref="mcount" data-ref-filename="mcount">mcount</a> == <var>1</var>)</td></tr>
<tr><th id="222">222</th><td>                <a class="local col2 ref" href="#22mflag" title='mflag' data-ref="22mflag" data-ref-filename="22mflag">mflag</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>;</td></tr>
<tr><th id="223">223</th><td>        }</td></tr>
<tr><th id="224">224</th><td>        <b>else</b></td></tr>
<tr><th id="225">225</th><td>        {</td></tr>
<tr><th id="226">226</th><td>            <a class="tu ref" href="#mcount" title='mcount' data-use='w' data-ref="mcount" data-ref-filename="mcount">mcount</a>--;</td></tr>
<tr><th id="227">227</th><td>        }</td></tr>
<tr><th id="228">228</th><td>        <a class="macro" href="uds_daemon.h.html#226" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMsg" data-ref="_M/LogMcast">LogMcast</a>(<q>"%s: %##s  (%s)  (%s)  Client(%d)[%s]"</q>, <a class="local col1 ref" href="#21status" title='status' data-ref="21status" data-ref-filename="21status">status</a> ? <q>"+Service"</q> : <q>"-Service"</q>, <a class="local col9 ref" href="#19ar" title='ar' data-ref="19ar" data-ref-filename="19ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::name" title='ResourceRecord_struct::name' data-ref="ResourceRecord_struct::name" data-ref-filename="ResourceRecord_struct..name">name</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col9 ref" href="#19ar" title='ar' data-ref="19ar" data-ref-filename="19ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rrtype" title='ResourceRecord_struct::rrtype' data-ref="ResourceRecord_struct::rrtype" data-ref-filename="ResourceRecord_struct..rrtype">rrtype</a>),</td></tr>
<tr><th id="229">229</th><td>                 <a class="local col9 ref" href="#19ar" title='ar' data-ref="19ar" data-ref-filename="19ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::InterfaceID" title='ResourceRecord_struct::InterfaceID' data-ref="ResourceRecord_struct::InterfaceID" data-ref-filename="ResourceRecord_struct..InterfaceID">InterfaceID</a> == <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterface_LocalOnly" title='mDNSInterface_LocalOnly' data-ref="mDNSInterface_LocalOnly" data-ref-filename="mDNSInterface_LocalOnly">mDNSInterface_LocalOnly</a> ? <q>"lo"</q> :</td></tr>
<tr><th id="230">230</th><td>                 <a class="local col9 ref" href="#19ar" title='ar' data-ref="19ar" data-ref-filename="19ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::InterfaceID" title='ResourceRecord_struct::InterfaceID' data-ref="ResourceRecord_struct::InterfaceID" data-ref-filename="ResourceRecord_struct..InterfaceID">InterfaceID</a> == <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterface_P2P" title='mDNSInterface_P2P' data-ref="mDNSInterface_P2P" data-ref-filename="mDNSInterface_P2P">mDNSInterface_P2P</a> ? <q>"p2p"</q> :</td></tr>
<tr><th id="231">231</th><td>                 <a class="local col9 ref" href="#19ar" title='ar' data-ref="19ar" data-ref-filename="19ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::InterfaceID" title='ResourceRecord_struct::InterfaceID' data-ref="ResourceRecord_struct::InterfaceID" data-ref-filename="ResourceRecord_struct..InterfaceID">InterfaceID</a> == <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterface_BLE" title='mDNSInterface_BLE' data-ref="mDNSInterface_BLE" data-ref-filename="mDNSInterface_BLE">mDNSInterface_BLE</a> ? <q>"BLE"</q> :</td></tr>
<tr><th id="232">232</th><td>                 <a class="local col9 ref" href="#19ar" title='ar' data-ref="19ar" data-ref-filename="19ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::InterfaceID" title='ResourceRecord_struct::InterfaceID' data-ref="ResourceRecord_struct::InterfaceID" data-ref-filename="ResourceRecord_struct..InterfaceID">InterfaceID</a> == <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterface_Any" title='mDNSInterface_Any' data-ref="mDNSInterface_Any" data-ref-filename="mDNSInterface_Any">mDNSInterface_Any</a> ? <q>"all"</q> : <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#InterfaceNameForID" title='InterfaceNameForID' data-ref="InterfaceNameForID" data-ref-filename="InterfaceNameForID">InterfaceNameForID</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col9 ref" href="#19ar" title='ar' data-ref="19ar" data-ref-filename="19ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::InterfaceID" title='ResourceRecord_struct::InterfaceID' data-ref="ResourceRecord_struct::InterfaceID" data-ref-filename="ResourceRecord_struct..InterfaceID">InterfaceID</a>),</td></tr>
<tr><th id="233">233</th><td>                 <a class="local col0 ref" href="#20req" title='req' data-ref="20req" data-ref-filename="20req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col0 ref" href="#20req" title='req' data-ref="20req" data-ref-filename="20req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="234">234</th><td>        <a class="ref fn" href="#LogMcastStateInfo" title='LogMcastStateInfo' data-ref="LogMcastStateInfo" data-ref-filename="LogMcastStateInfo">LogMcastStateInfo</a>(<a class="local col2 ref" href="#22mflag" title='mflag' data-ref="22mflag" data-ref-filename="22mflag">mflag</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>);</td></tr>
<tr><th id="235">235</th><td>    }</td></tr>
<tr><th id="236">236</th><td>    <b>return</b>;</td></tr>
<tr><th id="237">237</th><td>}</td></tr>
<tr><th id="238">238</th><td></td></tr>
<tr><th id="239">239</th><td><i>// For complete Mcast State Log, pass mDNStrue to mstatelog in LogMcastStateInfo()</i></td></tr>
<tr><th id="240">240</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#116" title="" data-ref="_M/mDNSexport">mDNSexport</a> <em>void</em> <dfn class="decl def fn" id="LogMcastStateInfo" title='LogMcastStateInfo' data-ref="LogMcastStateInfo" data-ref-filename="LogMcastStateInfo">LogMcastStateInfo</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSBool" title='mDNSBool' data-type='unsigned char' data-ref="mDNSBool" data-ref-filename="mDNSBool">mDNSBool</a> <dfn class="local col3 decl" id="23mflag" title='mflag' data-type='mDNSBool' data-ref="23mflag" data-ref-filename="23mflag">mflag</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSBool" title='mDNSBool' data-type='unsigned char' data-ref="mDNSBool" data-ref-filename="mDNSBool">mDNSBool</a> <dfn class="local col4 decl" id="24start" title='start' data-type='mDNSBool' data-ref="24start" data-ref-filename="24start">start</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSBool" title='mDNSBool' data-type='unsigned char' data-ref="mDNSBool" data-ref-filename="mDNSBool">mDNSBool</a> <dfn class="local col5 decl" id="25mstatelog" title='mstatelog' data-type='mDNSBool' data-ref="25mstatelog" data-ref-filename="25mstatelog">mstatelog</dfn>)</td></tr>
<tr><th id="241">241</th><td>{</td></tr>
<tr><th id="242">242</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS" title='mDNS' data-type='struct mDNS_struct' data-ref="mDNS" data-ref-filename="mDNS">mDNS</a> *<em>const</em> <dfn class="local col6 decl" id="26m" title='m' data-type='mDNS *const' data-ref="26m" data-ref-filename="26m">m</dfn> = &amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>;</td></tr>
<tr><th id="243">243</th><td>    <b>if</b> (!<a class="local col5 ref" href="#25mstatelog" title='mstatelog' data-ref="25mstatelog" data-ref-filename="25mstatelog">mstatelog</a>)</td></tr>
<tr><th id="244">244</th><td>    {</td></tr>
<tr><th id="245">245</th><td>        <b>if</b> (!<a class="tu ref" href="#all_requests" title='all_requests' data-use='r' data-ref="all_requests" data-ref-filename="all_requests">all_requests</a>)</td></tr>
<tr><th id="246">246</th><td>        {</td></tr>
<tr><th id="247">247</th><td>            <a class="macro" href="uds_daemon.h.html#227" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMsg" data-ref="_M/LogMcastNoIdent">LogMcastNoIdent</a>(<q>"&lt;None&gt;"</q>);</td></tr>
<tr><th id="248">248</th><td>        }</td></tr>
<tr><th id="249">249</th><td>        <b>else</b></td></tr>
<tr><th id="250">250</th><td>        {</td></tr>
<tr><th id="251">251</th><td>            <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col7 decl" id="27req" title='req' data-type='request_state *' data-ref="27req" data-ref-filename="27req">req</dfn>, *<dfn class="local col8 decl" id="28r" title='r' data-type='request_state *' data-ref="28r" data-ref-filename="28r">r</dfn>;</td></tr>
<tr><th id="252">252</th><td>            <b>for</b> (<a class="local col7 ref" href="#27req" title='req' data-ref="27req" data-ref-filename="27req">req</a> = <a class="tu ref" href="#all_requests" title='all_requests' data-use='r' data-ref="all_requests" data-ref-filename="all_requests">all_requests</a>; <a class="local col7 ref" href="#27req" title='req' data-ref="27req" data-ref-filename="27req">req</a>; <a class="local col7 ref" href="#27req" title='req' data-ref="27req" data-ref-filename="27req">req</a>=<a class="local col7 ref" href="#27req" title='req' data-ref="27req" data-ref-filename="27req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::next" title='request_state::next' data-ref="request_state::next" data-ref-filename="request_state..next">next</a>)</td></tr>
<tr><th id="253">253</th><td>            {</td></tr>
<tr><th id="254">254</th><td>                <b>if</b> (<a class="local col7 ref" href="#27req" title='req' data-ref="27req" data-ref-filename="27req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::primary" title='request_state::primary' data-ref="request_state::primary" data-ref-filename="request_state..primary">primary</a>) <i>// If this is a subbordinate operation, check that the parent is in the list</i></td></tr>
<tr><th id="255">255</th><td>                {</td></tr>
<tr><th id="256">256</th><td>                    <b>for</b> (<a class="local col8 ref" href="#28r" title='r' data-ref="28r" data-ref-filename="28r">r</a> = <a class="tu ref" href="#all_requests" title='all_requests' data-use='r' data-ref="all_requests" data-ref-filename="all_requests">all_requests</a>; <a class="local col8 ref" href="#28r" title='r' data-ref="28r" data-ref-filename="28r">r</a> &amp;&amp; <a class="local col8 ref" href="#28r" title='r' data-ref="28r" data-ref-filename="28r">r</a> != <a class="local col7 ref" href="#27req" title='req' data-ref="27req" data-ref-filename="27req">req</a>; <a class="local col8 ref" href="#28r" title='r' data-ref="28r" data-ref-filename="28r">r</a>=<a class="local col8 ref" href="#28r" title='r' data-ref="28r" data-ref-filename="28r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::next" title='request_state::next' data-ref="request_state::next" data-ref-filename="request_state..next">next</a>)</td></tr>
<tr><th id="257">257</th><td>                        <b>if</b> (<a class="local col8 ref" href="#28r" title='r' data-ref="28r" data-ref-filename="28r">r</a> == <a class="local col7 ref" href="#27req" title='req' data-ref="27req" data-ref-filename="27req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::primary" title='request_state::primary' data-ref="request_state::primary" data-ref-filename="request_state..primary">primary</a>)</td></tr>
<tr><th id="258">258</th><td>                            <b>goto</b> <a class="lbl" href="#29foundpar" data-ref="29foundpar" data-ref-filename="29foundpar">foundpar</a>;</td></tr>
<tr><th id="259">259</th><td>                }</td></tr>
<tr><th id="260">260</th><td>                <i>// For non-subbordinate operations, and subbordinate operations that have lost their parent, write out their info</i></td></tr>
<tr><th id="261">261</th><td>                <a class="ref fn" href="#GetMcastClients" title='GetMcastClients' data-ref="GetMcastClients" data-ref-filename="GetMcastClients">GetMcastClients</a>(<a class="local col7 ref" href="#27req" title='req' data-ref="27req" data-ref-filename="27req">req</a>);</td></tr>
<tr><th id="262">262</th><td>    <dfn class="lbl" id="29foundpar" data-ref="29foundpar" data-ref-filename="29foundpar">foundpar</dfn>:;</td></tr>
<tr><th id="263">263</th><td>            }</td></tr>
<tr><th id="264">264</th><td>            <a class="macro" href="uds_daemon.h.html#227" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMsg" data-ref="_M/LogMcastNoIdent">LogMcastNoIdent</a>(<q>"--- MCAST RECORDS COUNT[%d] MCAST QUESTIONS COUNT[%d] ---"</q>, <a class="tu ref" href="#n_mrecords" title='n_mrecords' data-use='r' data-ref="n_mrecords" data-ref-filename="n_mrecords">n_mrecords</a>, <a class="tu ref" href="#n_mquests" title='n_mquests' data-use='r' data-ref="n_mquests" data-ref-filename="n_mquests">n_mquests</a>);</td></tr>
<tr><th id="265">265</th><td>            <a class="tu ref" href="#n_mrecords" title='n_mrecords' data-use='w' data-ref="n_mrecords" data-ref-filename="n_mrecords">n_mrecords</a> = <a class="tu ref" href="#n_mquests" title='n_mquests' data-use='w' data-ref="n_mquests" data-ref-filename="n_mquests">n_mquests</a> = <var>0</var>; <i>// Reset the values</i></td></tr>
<tr><th id="266">266</th><td>        }</td></tr>
<tr><th id="267">267</th><td>    }</td></tr>
<tr><th id="268">268</th><td>    <b>else</b></td></tr>
<tr><th id="269">269</th><td>    {</td></tr>
<tr><th id="270">270</th><td>        <em>static</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col0 decl" id="30i_mpktnum" title='i_mpktnum' data-type='mDNSu32' data-ref="30i_mpktnum" data-ref-filename="30i_mpktnum">i_mpktnum</dfn>;</td></tr>
<tr><th id="271">271</th><td>        <a class="tu ref" href="#i_mcount" title='i_mcount' data-use='w' data-ref="i_mcount" data-ref-filename="i_mcount">i_mcount</a> = <var>0</var>;</td></tr>
<tr><th id="272">272</th><td>        <b>if</b> (<a class="local col4 ref" href="#24start" title='start' data-ref="24start" data-ref-filename="24start">start</a>)</td></tr>
<tr><th id="273">273</th><td>            <a class="tu ref" href="#mcount" title='mcount' data-use='w' data-ref="mcount" data-ref-filename="mcount">mcount</a> = <var>0</var>;</td></tr>
<tr><th id="274">274</th><td>        <i>// mcount is initialized to 0 when the PROF signal is sent since mcount could have</i></td></tr>
<tr><th id="275">275</th><td><i>        // wrong value if MulticastLogging is disabled and then re-enabled</i></td></tr>
<tr><th id="276">276</th><td>        <a class="macro" href="uds_daemon.h.html#227" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMsg" data-ref="_M/LogMcastNoIdent">LogMcastNoIdent</a>(<q>"--- START MCAST STATE LOG ---"</q>);</td></tr>
<tr><th id="277">277</th><td>        <b>if</b> (!<a class="tu ref" href="#all_requests" title='all_requests' data-use='r' data-ref="all_requests" data-ref-filename="all_requests">all_requests</a>)</td></tr>
<tr><th id="278">278</th><td>        {</td></tr>
<tr><th id="279">279</th><td>            <a class="tu ref" href="#mcount" title='mcount' data-use='w' data-ref="mcount" data-ref-filename="mcount">mcount</a> = <var>0</var>;</td></tr>
<tr><th id="280">280</th><td>            <a class="macro" href="uds_daemon.h.html#227" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMsg" data-ref="_M/LogMcastNoIdent">LogMcastNoIdent</a>(<q>"&lt;None&gt;"</q>);</td></tr>
<tr><th id="281">281</th><td>        }</td></tr>
<tr><th id="282">282</th><td>        <b>else</b></td></tr>
<tr><th id="283">283</th><td>        {</td></tr>
<tr><th id="284">284</th><td>            <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col1 decl" id="31req" title='req' data-type='request_state *' data-ref="31req" data-ref-filename="31req">req</dfn>, *<dfn class="local col2 decl" id="32r" title='r' data-type='request_state *' data-ref="32r" data-ref-filename="32r">r</dfn>;</td></tr>
<tr><th id="285">285</th><td>            <b>for</b> (<a class="local col1 ref" href="#31req" title='req' data-ref="31req" data-ref-filename="31req">req</a> = <a class="tu ref" href="#all_requests" title='all_requests' data-use='r' data-ref="all_requests" data-ref-filename="all_requests">all_requests</a>; <a class="local col1 ref" href="#31req" title='req' data-ref="31req" data-ref-filename="31req">req</a>; <a class="local col1 ref" href="#31req" title='req' data-ref="31req" data-ref-filename="31req">req</a>=<a class="local col1 ref" href="#31req" title='req' data-ref="31req" data-ref-filename="31req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::next" title='request_state::next' data-ref="request_state::next" data-ref-filename="request_state..next">next</a>)</td></tr>
<tr><th id="286">286</th><td>            {</td></tr>
<tr><th id="287">287</th><td>                <b>if</b> (<a class="local col1 ref" href="#31req" title='req' data-ref="31req" data-ref-filename="31req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::primary" title='request_state::primary' data-ref="request_state::primary" data-ref-filename="request_state..primary">primary</a>) <i>// If this is a subbordinate operation, check that the parent is in the list</i></td></tr>
<tr><th id="288">288</th><td>                {</td></tr>
<tr><th id="289">289</th><td>                    <b>for</b> (<a class="local col2 ref" href="#32r" title='r' data-ref="32r" data-ref-filename="32r">r</a> = <a class="tu ref" href="#all_requests" title='all_requests' data-use='r' data-ref="all_requests" data-ref-filename="all_requests">all_requests</a>; <a class="local col2 ref" href="#32r" title='r' data-ref="32r" data-ref-filename="32r">r</a> &amp;&amp; <a class="local col2 ref" href="#32r" title='r' data-ref="32r" data-ref-filename="32r">r</a> != <a class="local col1 ref" href="#31req" title='req' data-ref="31req" data-ref-filename="31req">req</a>; <a class="local col2 ref" href="#32r" title='r' data-ref="32r" data-ref-filename="32r">r</a>=<a class="local col2 ref" href="#32r" title='r' data-ref="32r" data-ref-filename="32r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::next" title='request_state::next' data-ref="request_state::next" data-ref-filename="request_state..next">next</a>)</td></tr>
<tr><th id="290">290</th><td>                        <b>if</b> (<a class="local col2 ref" href="#32r" title='r' data-ref="32r" data-ref-filename="32r">r</a> == <a class="local col1 ref" href="#31req" title='req' data-ref="31req" data-ref-filename="31req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::primary" title='request_state::primary' data-ref="request_state::primary" data-ref-filename="request_state..primary">primary</a>)</td></tr>
<tr><th id="291">291</th><td>                            <b>goto</b> <a class="lbl" href="#33foundparent" data-ref="33foundparent" data-ref-filename="33foundparent">foundparent</a>;</td></tr>
<tr><th id="292">292</th><td>                    <a class="macro" href="uds_daemon.h.html#227" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMsg" data-ref="_M/LogMcastNoIdent">LogMcastNoIdent</a>(<q>"%3d: Orphan operation; parent not found in request list"</q>, <a class="local col1 ref" href="#31req" title='req' data-ref="31req" data-ref-filename="31req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>);</td></tr>
<tr><th id="293">293</th><td>                }</td></tr>
<tr><th id="294">294</th><td>                <i>// For non-subbordinate operations, and subbordinate operations that have lost their parent, write out their info</i></td></tr>
<tr><th id="295">295</th><td>                <a class="ref fn" href="#LogMcastClientInfo" title='LogMcastClientInfo' data-ref="LogMcastClientInfo" data-ref-filename="LogMcastClientInfo">LogMcastClientInfo</a>(<a class="local col1 ref" href="#31req" title='req' data-ref="31req" data-ref-filename="31req">req</a>);</td></tr>
<tr><th id="296">296</th><td>    <dfn class="lbl" id="33foundparent" data-ref="33foundparent" data-ref-filename="33foundparent">foundparent</dfn>:;</td></tr>
<tr><th id="297">297</th><td>            }</td></tr>
<tr><th id="298">298</th><td>            <b>if</b>(!<a class="tu ref" href="#mcount" title='mcount' data-use='r' data-ref="mcount" data-ref-filename="mcount">mcount</a>) <i>// To initially set mcount</i></td></tr>
<tr><th id="299">299</th><td>                <a class="tu ref" href="#mcount" title='mcount' data-use='w' data-ref="mcount" data-ref-filename="mcount">mcount</a> = <a class="tu ref" href="#i_mcount" title='i_mcount' data-use='r' data-ref="i_mcount" data-ref-filename="i_mcount">i_mcount</a>;</td></tr>
<tr><th id="300">300</th><td>        }</td></tr>
<tr><th id="301">301</th><td>        <b>if</b> (<a class="tu ref" href="#mcount" title='mcount' data-use='r' data-ref="mcount" data-ref-filename="mcount">mcount</a> == <var>0</var>)</td></tr>
<tr><th id="302">302</th><td>        {</td></tr>
<tr><th id="303">303</th><td>            <a class="local col0 ref" href="#30i_mpktnum" title='i_mpktnum' data-ref="30i_mpktnum" data-ref-filename="30i_mpktnum">i_mpktnum</a> = <a class="local col6 ref" href="#26m" title='m' data-ref="26m" data-ref-filename="26m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::MPktNum" title='mDNS_struct::MPktNum' data-ref="mDNS_struct::MPktNum" data-ref-filename="mDNS_struct..MPktNum">MPktNum</a>;</td></tr>
<tr><th id="304">304</th><td>            <a class="macro" href="uds_daemon.h.html#227" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMsg" data-ref="_M/LogMcastNoIdent">LogMcastNoIdent</a>(<q>"--- MCOUNT[%d]: IMPKTNUM[%d] ---"</q>, <a class="tu ref" href="#mcount" title='mcount' data-use='r' data-ref="mcount" data-ref-filename="mcount">mcount</a>, <a class="local col0 ref" href="#30i_mpktnum" title='i_mpktnum' data-ref="30i_mpktnum" data-ref-filename="30i_mpktnum">i_mpktnum</a>);</td></tr>
<tr><th id="305">305</th><td>        }</td></tr>
<tr><th id="306">306</th><td>        <b>if</b> (<a class="local col3 ref" href="#23mflag" title='mflag' data-ref="23mflag" data-ref-filename="23mflag">mflag</a>)</td></tr>
<tr><th id="307">307</th><td>            <a class="macro" href="uds_daemon.h.html#227" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMsg" data-ref="_M/LogMcastNoIdent">LogMcastNoIdent</a>(<q>"--- MCOUNT[%d]: CMPKTNUM[%d] - IMPKTNUM[%d] = [%d]PKTS ---"</q>, <a class="tu ref" href="#mcount" title='mcount' data-use='r' data-ref="mcount" data-ref-filename="mcount">mcount</a>, <a class="local col6 ref" href="#26m" title='m' data-ref="26m" data-ref-filename="26m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::MPktNum" title='mDNS_struct::MPktNum' data-ref="mDNS_struct::MPktNum" data-ref-filename="mDNS_struct..MPktNum">MPktNum</a>, <a class="local col0 ref" href="#30i_mpktnum" title='i_mpktnum' data-ref="30i_mpktnum" data-ref-filename="30i_mpktnum">i_mpktnum</a>, (<a class="local col6 ref" href="#26m" title='m' data-ref="26m" data-ref-filename="26m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::MPktNum" title='mDNS_struct::MPktNum' data-ref="mDNS_struct::MPktNum" data-ref-filename="mDNS_struct..MPktNum">MPktNum</a> - <a class="local col0 ref" href="#30i_mpktnum" title='i_mpktnum' data-ref="30i_mpktnum" data-ref-filename="30i_mpktnum">i_mpktnum</a>));</td></tr>
<tr><th id="308">308</th><td>        <a class="macro" href="uds_daemon.h.html#227" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMsg" data-ref="_M/LogMcastNoIdent">LogMcastNoIdent</a>(<q>"--- END MCAST STATE LOG ---"</q>);</td></tr>
<tr><th id="309">309</th><td>    }</td></tr>
<tr><th id="310">310</th><td>}</td></tr>
<tr><th id="311">311</th><td></td></tr>
<tr><th id="312">312</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="abort_request" title='abort_request' data-ref="abort_request" data-ref-filename="abort_request">abort_request</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col4 decl" id="34req" title='req' data-type='request_state *' data-ref="34req" data-ref-filename="34req">req</dfn>)</td></tr>
<tr><th id="313">313</th><td>{</td></tr>
<tr><th id="314">314</th><td>    <b>if</b> (<a class="local col4 ref" href="#34req" title='req' data-ref="34req" data-ref-filename="34req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> == (<a class="typedef" href="uds_daemon.h.html#req_termination_fn" title='req_termination_fn' data-type='void (*)(request_state *)' data-ref="req_termination_fn" data-ref-filename="req_termination_fn">req_termination_fn</a>) ~<var>0</var>)</td></tr>
<tr><th id="315">315</th><td>    { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;abort_request: ERROR: Attempt to abort operation %p with req-&gt;terminate %p&quot;, req, req-&gt;terminate)" data-ref="_M/LogMsg">LogMsg</a>(<q>"abort_request: ERROR: Attempt to abort operation %p with req-&gt;terminate %p"</q>, <a class="local col4 ref" href="#34req" title='req' data-ref="34req" data-ref-filename="34req">req</a>, <a class="local col4 ref" href="#34req" title='req' data-ref="34req" data-ref-filename="34req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a>); <b>return</b>; }</td></tr>
<tr><th id="316">316</th><td></td></tr>
<tr><th id="317">317</th><td>    <i>// First stop whatever mDNSCore operation we were doing</i></td></tr>
<tr><th id="318">318</th><td><i>    // If this is actually a shared connection operation, then its req-&gt;terminate function will scan</i></td></tr>
<tr><th id="319">319</th><td><i>    // the all_requests list and terminate any subbordinate operations sharing this file descriptor</i></td></tr>
<tr><th id="320">320</th><td>    <b>if</b> (<a class="local col4 ref" href="#34req" title='req' data-ref="34req" data-ref-filename="34req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a>) <a class="local col4 ref" href="#34req" title='req' data-ref="34req" data-ref-filename="34req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a>(<a class="local col4 ref" href="#34req" title='req' data-ref="34req" data-ref-filename="34req">req</a>);</td></tr>
<tr><th id="321">321</th><td></td></tr>
<tr><th id="322">322</th><td>    <b>if</b> (!<a class="macro" href="dnssd_ipc.h.html#64" title="((req-&gt;sd) &gt;= 0)" data-ref="_M/dnssd_SocketValid">dnssd_SocketValid</a>(<a class="local col4 ref" href="#34req" title='req' data-ref="34req" data-ref-filename="34req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>))</td></tr>
<tr><th id="323">323</th><td>    { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;abort_request: ERROR: Attempt to abort operation %p with invalid fd %d&quot;, req, req-&gt;sd)" data-ref="_M/LogMsg">LogMsg</a>(<q>"abort_request: ERROR: Attempt to abort operation %p with invalid fd %d"</q>,     <a class="local col4 ref" href="#34req" title='req' data-ref="34req" data-ref-filename="34req">req</a>, <a class="local col4 ref" href="#34req" title='req' data-ref="34req" data-ref-filename="34req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>);        <b>return</b>; }</td></tr>
<tr><th id="324">324</th><td></td></tr>
<tr><th id="325">325</th><td>    <i>// Now, if this request_state is not subordinate to some other primary, close file descriptor and discard replies</i></td></tr>
<tr><th id="326">326</th><td>    <b>if</b> (!<a class="local col4 ref" href="#34req" title='req' data-ref="34req" data-ref-filename="34req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::primary" title='request_state::primary' data-ref="request_state::primary" data-ref-filename="request_state..primary">primary</a>)</td></tr>
<tr><th id="327">327</th><td>    {</td></tr>
<tr><th id="328">328</th><td>        <b>if</b> (<a class="local col4 ref" href="#34req" title='req' data-ref="34req" data-ref-filename="34req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::errsd" title='request_state::errsd' data-ref="request_state::errsd" data-ref-filename="request_state..errsd">errsd</a> != <a class="local col4 ref" href="#34req" title='req' data-ref="34req" data-ref-filename="34req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>) <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: Removing FD and closing errsd %d&quot;, req-&gt;sd, req-&gt;errsd);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: Removing FD and closing errsd %d"</q>, <a class="local col4 ref" href="#34req" title='req' data-ref="34req" data-ref-filename="34req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col4 ref" href="#34req" title='req' data-ref="34req" data-ref-filename="34req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::errsd" title='request_state::errsd' data-ref="request_state::errsd" data-ref-filename="request_state..errsd">errsd</a>);</td></tr>
<tr><th id="329">329</th><td>        <b>else</b> <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: Removing FD&quot;, req-&gt;sd);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: Removing FD"</q>, <a class="local col4 ref" href="#34req" title='req' data-ref="34req" data-ref-filename="34req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>);</td></tr>
<tr><th id="330">330</th><td>        <a class="ref fn" href="uds_daemon.h.html#udsSupportRemoveFDFromEventLoop" title='udsSupportRemoveFDFromEventLoop' data-ref="udsSupportRemoveFDFromEventLoop" data-ref-filename="udsSupportRemoveFDFromEventLoop">udsSupportRemoveFDFromEventLoop</a>(<a class="local col4 ref" href="#34req" title='req' data-ref="34req" data-ref-filename="34req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col4 ref" href="#34req" title='req' data-ref="34req" data-ref-filename="34req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::platform_data" title='request_state::platform_data' data-ref="request_state::platform_data" data-ref-filename="request_state..platform_data">platform_data</a>);       <i>// Note: This also closes file descriptor req-&gt;sd for us</i></td></tr>
<tr><th id="331">331</th><td>        <b>if</b> (<a class="local col4 ref" href="#34req" title='req' data-ref="34req" data-ref-filename="34req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::errsd" title='request_state::errsd' data-ref="request_state::errsd" data-ref-filename="request_state..errsd">errsd</a> != <a class="local col4 ref" href="#34req" title='req' data-ref="34req" data-ref-filename="34req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>) { <a class="macro" href="dnssd_ipc.h.html#70" title="close(req-&gt;errsd)" data-ref="_M/dnssd_close">dnssd_close</a>(<a class="local col4 ref" href="#34req" title='req' data-ref="34req" data-ref-filename="34req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::errsd" title='request_state::errsd' data-ref="request_state::errsd" data-ref-filename="request_state..errsd">errsd</a>); <a class="local col4 ref" href="#34req" title='req' data-ref="34req" data-ref-filename="34req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::errsd" title='request_state::errsd' data-ref="request_state::errsd" data-ref-filename="request_state..errsd">errsd</a> = <a class="local col4 ref" href="#34req" title='req' data-ref="34req" data-ref-filename="34req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>; }</td></tr>
<tr><th id="332">332</th><td></td></tr>
<tr><th id="333">333</th><td>        <b>while</b> (<a class="local col4 ref" href="#34req" title='req' data-ref="34req" data-ref-filename="34req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::replies" title='request_state::replies' data-ref="request_state::replies" data-ref-filename="request_state..replies">replies</a>)    <i>// free pending replies</i></td></tr>
<tr><th id="334">334</th><td>        {</td></tr>
<tr><th id="335">335</th><td>            <a class="typedef" href="uds_daemon.h.html#reply_state" title='reply_state' data-type='struct reply_state' data-ref="reply_state" data-ref-filename="reply_state">reply_state</a> *<dfn class="local col5 decl" id="35ptr" title='ptr' data-type='reply_state *' data-ref="35ptr" data-ref-filename="35ptr">ptr</dfn> = <a class="local col4 ref" href="#34req" title='req' data-ref="34req" data-ref-filename="34req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::replies" title='request_state::replies' data-ref="request_state::replies" data-ref-filename="request_state..replies">replies</a>;</td></tr>
<tr><th id="336">336</th><td>            <a class="local col4 ref" href="#34req" title='req' data-ref="34req" data-ref-filename="34req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::replies" title='request_state::replies' data-ref="request_state::replies" data-ref-filename="request_state..replies">replies</a> = <a class="local col4 ref" href="#34req" title='req' data-ref="34req" data-ref-filename="34req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::replies" title='request_state::replies' data-ref="request_state::replies" data-ref-filename="request_state..replies">replies</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::next" title='reply_state::next' data-ref="reply_state::next" data-ref-filename="reply_state..next">next</a>;</td></tr>
<tr><th id="337">337</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(ptr)" data-ref="_M/freeL">freeL</a>(<q>"reply_state (abort)"</q>, <a class="local col5 ref" href="#35ptr" title='ptr' data-ref="35ptr" data-ref-filename="35ptr">ptr</a>);</td></tr>
<tr><th id="338">338</th><td>        }</td></tr>
<tr><th id="339">339</th><td>    }</td></tr>
<tr><th id="340">340</th><td></td></tr>
<tr><th id="341">341</th><td>    <i>// Set req-&gt;sd to something invalid, so that udsserver_idle knows to unlink and free this structure</i></td></tr>
<tr><th id="342">342</th><td><u>#<span data-ppcond="342">if</span> APPLE_OSX_mDNSResponder &amp;&amp; MACOSX_MDNS_MALLOC_DEBUGGING</u></td></tr>
<tr><th id="343">343</th><td>    <i>// Don't use dnssd_InvalidSocket (-1) because that's the sentinel value MACOSX_MDNS_MALLOC_DEBUGGING uses</i></td></tr>
<tr><th id="344">344</th><td><i>    // for detecting when the memory for an object is inadvertently freed while the object is still on some list</i></td></tr>
<tr><th id="345">345</th><td>    req-&gt;sd = req-&gt;errsd = -<var>2</var>;</td></tr>
<tr><th id="346">346</th><td><u>#<span data-ppcond="342">else</span></u></td></tr>
<tr><th id="347">347</th><td>    <a class="local col4 ref" href="#34req" title='req' data-ref="34req" data-ref-filename="34req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a> = <a class="local col4 ref" href="#34req" title='req' data-ref="34req" data-ref-filename="34req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::errsd" title='request_state::errsd' data-ref="request_state::errsd" data-ref-filename="request_state..errsd">errsd</a> = <a class="macro" href="dnssd_ipc.h.html#63" title="-1" data-ref="_M/dnssd_InvalidSocket">dnssd_InvalidSocket</a>;</td></tr>
<tr><th id="348">348</th><td><u>#<span data-ppcond="342">endif</span></u></td></tr>
<tr><th id="349">349</th><td>    <i>// We also set req-&gt;terminate to a bogus value so we know if abort_request() gets called again for this request</i></td></tr>
<tr><th id="350">350</th><td>    <a class="local col4 ref" href="#34req" title='req' data-ref="34req" data-ref-filename="34req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> = (<a class="typedef" href="uds_daemon.h.html#req_termination_fn" title='req_termination_fn' data-type='void (*)(request_state *)' data-ref="req_termination_fn" data-ref-filename="req_termination_fn">req_termination_fn</a>) ~<var>0</var>;</td></tr>
<tr><th id="351">351</th><td>}</td></tr>
<tr><th id="352">352</th><td></td></tr>
<tr><th id="353">353</th><td><u>#<span data-ppcond="353">if</span> DEBUG</u></td></tr>
<tr><th id="354">354</th><td>mDNSexport <em>void</em> SetDebugBoundPath(<em>void</em>)</td></tr>
<tr><th id="355">355</th><td>{</td></tr>
<tr><th id="356">356</th><td><u>#if !defined(USE_TCP_LOOPBACK)</u></td></tr>
<tr><th id="357">357</th><td>    boundPath = MDNS_UDS_SERVERPATH_DEBUG;</td></tr>
<tr><th id="358">358</th><td><u>#endif</u></td></tr>
<tr><th id="359">359</th><td>}</td></tr>
<tr><th id="360">360</th><td></td></tr>
<tr><th id="361">361</th><td>mDNSexport <em>int</em> IsDebugSocketInUse(<em>void</em>)</td></tr>
<tr><th id="362">362</th><td>{</td></tr>
<tr><th id="363">363</th><td><u>#if !defined(USE_TCP_LOOPBACK)</u></td></tr>
<tr><th id="364">364</th><td>    <b>return</b> !strcmp(boundPath, MDNS_UDS_SERVERPATH_DEBUG);</td></tr>
<tr><th id="365">365</th><td><u>#else</u></td></tr>
<tr><th id="366">366</th><td>    <b>return</b> mDNSfalse;</td></tr>
<tr><th id="367">367</th><td><u>#endif</u></td></tr>
<tr><th id="368">368</th><td>}</td></tr>
<tr><th id="369">369</th><td><u>#<span data-ppcond="353">endif</span></u></td></tr>
<tr><th id="370">370</th><td></td></tr>
<tr><th id="371">371</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="AbortUnlinkAndFree" title='AbortUnlinkAndFree' data-ref="AbortUnlinkAndFree" data-ref-filename="AbortUnlinkAndFree">AbortUnlinkAndFree</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col6 decl" id="36req" title='req' data-type='request_state *' data-ref="36req" data-ref-filename="36req">req</dfn>)</td></tr>
<tr><th id="372">372</th><td>{</td></tr>
<tr><th id="373">373</th><td>    <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> **<dfn class="local col7 decl" id="37p" title='p' data-type='request_state **' data-ref="37p" data-ref-filename="37p">p</dfn> = &amp;<a class="tu ref" href="#all_requests" title='all_requests' data-use='a' data-ref="all_requests" data-ref-filename="all_requests">all_requests</a>;</td></tr>
<tr><th id="374">374</th><td>    <a class="ref fn" href="#abort_request" title='abort_request' data-ref="abort_request" data-ref-filename="abort_request">abort_request</a>(<a class="local col6 ref" href="#36req" title='req' data-ref="36req" data-ref-filename="36req">req</a>);</td></tr>
<tr><th id="375">375</th><td>    <b>while</b> (*<a class="local col7 ref" href="#37p" title='p' data-ref="37p" data-ref-filename="37p">p</a> &amp;&amp; *<a class="local col7 ref" href="#37p" title='p' data-ref="37p" data-ref-filename="37p">p</a> != <a class="local col6 ref" href="#36req" title='req' data-ref="36req" data-ref-filename="36req">req</a>) <a class="local col7 ref" href="#37p" title='p' data-ref="37p" data-ref-filename="37p">p</a>=&amp;(*<a class="local col7 ref" href="#37p" title='p' data-ref="37p" data-ref-filename="37p">p</a>)-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::next" title='request_state::next' data-ref="request_state::next" data-ref-filename="request_state..next">next</a>;</td></tr>
<tr><th id="376">376</th><td>    <b>if</b> (*<a class="local col7 ref" href="#37p" title='p' data-ref="37p" data-ref-filename="37p">p</a>) { *<a class="local col7 ref" href="#37p" title='p' data-ref="37p" data-ref-filename="37p">p</a> = <a class="local col6 ref" href="#36req" title='req' data-ref="36req" data-ref-filename="36req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::next" title='request_state::next' data-ref="request_state::next" data-ref-filename="request_state..next">next</a>; <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(req)" data-ref="_M/freeL">freeL</a>(<q>"request_state/AbortUnlinkAndFree"</q>, <a class="local col6 ref" href="#36req" title='req' data-ref="36req" data-ref-filename="36req">req</a>); }</td></tr>
<tr><th id="377">377</th><td>    <b>else</b> <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;AbortUnlinkAndFree: ERROR: Attempt to abort operation %p not in list&quot;, req)" data-ref="_M/LogMsg">LogMsg</a>(<q>"AbortUnlinkAndFree: ERROR: Attempt to abort operation %p not in list"</q>, <a class="local col6 ref" href="#36req" title='req' data-ref="36req" data-ref-filename="36req">req</a>);</td></tr>
<tr><th id="378">378</th><td>}</td></tr>
<tr><th id="379">379</th><td></td></tr>
<tr><th id="380">380</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <a class="typedef" href="uds_daemon.h.html#reply_state" title='reply_state' data-type='struct reply_state' data-ref="reply_state" data-ref-filename="reply_state">reply_state</a> *<dfn class="decl def fn" id="create_reply" title='create_reply' data-ref="create_reply" data-ref-filename="create_reply">create_reply</dfn>(<em>const</em> <a class="typedef" href="dnssd_ipc.h.html#reply_op_t" title='reply_op_t' data-type='enum reply_op_t' data-ref="reply_op_t" data-ref-filename="reply_op_t">reply_op_t</a> <dfn class="local col8 decl" id="38op" title='op' data-type='const reply_op_t' data-ref="38op" data-ref-filename="38op">op</dfn>, <em>const</em> <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#size_t" title='size_t' data-type='unsigned long' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col9 decl" id="39datalen" title='datalen' data-type='const size_t' data-ref="39datalen" data-ref-filename="39datalen">datalen</dfn>, <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<em>const</em> <dfn class="local col0 decl" id="40request" title='request' data-type='request_state *const' data-ref="40request" data-ref-filename="40request">request</dfn>)</td></tr>
<tr><th id="381">381</th><td>{</td></tr>
<tr><th id="382">382</th><td>    <a class="typedef" href="uds_daemon.h.html#reply_state" title='reply_state' data-type='struct reply_state' data-ref="reply_state" data-ref-filename="reply_state">reply_state</a> *<dfn class="local col1 decl" id="41reply" title='reply' data-type='reply_state *' data-ref="41reply" data-ref-filename="41reply">reply</dfn>;</td></tr>
<tr><th id="383">383</th><td></td></tr>
<tr><th id="384">384</th><td>    <b>if</b> ((<em>unsigned</em>)<a class="local col9 ref" href="#39datalen" title='datalen' data-ref="39datalen" data-ref-filename="39datalen">datalen</a> &lt; <b>sizeof</b>(<a class="typedef" href="uds_daemon.h.html#reply_hdr" title='reply_hdr' data-type='struct reply_hdr' data-ref="reply_hdr" data-ref-filename="reply_hdr">reply_hdr</a>))</td></tr>
<tr><th id="385">385</th><td>    {</td></tr>
<tr><th id="386">386</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;ERROR: create_reply - data length less than length of required fields&quot;)" data-ref="_M/LogMsg">LogMsg</a>(<q>"ERROR: create_reply - data length less than length of required fields"</q>);</td></tr>
<tr><th id="387">387</th><td>        <b>return</b> <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="388">388</th><td>    }</td></tr>
<tr><th id="389">389</th><td></td></tr>
<tr><th id="390">390</th><td>    <a class="local col1 ref" href="#41reply" title='reply' data-ref="41reply" data-ref-filename="41reply">reply</a> = <a class="macro" href="../mDNSCore/mDNSDebug.h.html#166" title="malloc(sizeof(reply_state) + datalen - sizeof(reply_hdr))" data-ref="_M/mallocL">mallocL</a>(<q>"reply_state"</q>, <b>sizeof</b>(<a class="typedef" href="uds_daemon.h.html#reply_state" title='reply_state' data-type='struct reply_state' data-ref="reply_state" data-ref-filename="reply_state">reply_state</a>) + <a class="local col9 ref" href="#39datalen" title='datalen' data-ref="39datalen" data-ref-filename="39datalen">datalen</a> - <b>sizeof</b>(<a class="typedef" href="uds_daemon.h.html#reply_hdr" title='reply_hdr' data-type='struct reply_hdr' data-ref="reply_hdr" data-ref-filename="reply_hdr">reply_hdr</a>));</td></tr>
<tr><th id="391">391</th><td>    <b>if</b> (!<a class="local col1 ref" href="#41reply" title='reply' data-ref="41reply" data-ref-filename="41reply">reply</a>) <a class="ref fn" href="#FatalError" title='FatalError' data-ref="FatalError" data-ref-filename="FatalError">FatalError</a>(<q>"ERROR: malloc"</q>);</td></tr>
<tr><th id="392">392</th><td></td></tr>
<tr><th id="393">393</th><td>    <a class="local col1 ref" href="#41reply" title='reply' data-ref="41reply" data-ref-filename="41reply">reply</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::next" title='reply_state::next' data-ref="reply_state::next" data-ref-filename="reply_state..next">next</a>     = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="394">394</th><td>    <a class="local col1 ref" href="#41reply" title='reply' data-ref="41reply" data-ref-filename="41reply">reply</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::totallen" title='reply_state::totallen' data-ref="reply_state::totallen" data-ref-filename="reply_state..totallen">totallen</a> = (<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a>)<a class="local col9 ref" href="#39datalen" title='datalen' data-ref="39datalen" data-ref-filename="39datalen">datalen</a> + <b>sizeof</b>(<a class="typedef" href="dnssd_ipc.h.html#ipc_msg_hdr" title='ipc_msg_hdr' data-type='struct ipc_msg_hdr' data-ref="ipc_msg_hdr" data-ref-filename="ipc_msg_hdr">ipc_msg_hdr</a>);</td></tr>
<tr><th id="395">395</th><td>    <a class="local col1 ref" href="#41reply" title='reply' data-ref="41reply" data-ref-filename="41reply">reply</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::nwriten" title='reply_state::nwriten' data-ref="reply_state::nwriten" data-ref-filename="reply_state..nwriten">nwriten</a>  = <var>0</var>;</td></tr>
<tr><th id="396">396</th><td></td></tr>
<tr><th id="397">397</th><td>    <a class="local col1 ref" href="#41reply" title='reply' data-ref="41reply" data-ref-filename="41reply">reply</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::mhdr" title='reply_state::mhdr' data-ref="reply_state::mhdr" data-ref-filename="reply_state..mhdr">mhdr</a>-&gt;<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::version" title='(anonymous struct)::version' data-ref="(anonymous)::version" data-ref-filename="(anonymous)..version">version</a>        = <a class="macro" href="dnssd_ipc.h.html#102" title="1" data-ref="_M/VERSION">VERSION</a>;</td></tr>
<tr><th id="398">398</th><td>    <a class="local col1 ref" href="#41reply" title='reply' data-ref="41reply" data-ref-filename="41reply">reply</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::mhdr" title='reply_state::mhdr' data-ref="reply_state::mhdr" data-ref-filename="reply_state..mhdr">mhdr</a>-&gt;<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::datalen" title='(anonymous struct)::datalen' data-ref="(anonymous)::datalen" data-ref-filename="(anonymous)..datalen">datalen</a>        = (<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a>)<a class="local col9 ref" href="#39datalen" title='datalen' data-ref="39datalen" data-ref-filename="39datalen">datalen</a>;</td></tr>
<tr><th id="399">399</th><td>    <a class="local col1 ref" href="#41reply" title='reply' data-ref="41reply" data-ref-filename="41reply">reply</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::mhdr" title='reply_state::mhdr' data-ref="reply_state::mhdr" data-ref-filename="reply_state..mhdr">mhdr</a>-&gt;<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::ipc_flags" title='(anonymous struct)::ipc_flags' data-ref="(anonymous)::ipc_flags" data-ref-filename="(anonymous)..ipc_flags">ipc_flags</a>      = <var>0</var>;</td></tr>
<tr><th id="400">400</th><td>    <a class="local col1 ref" href="#41reply" title='reply' data-ref="41reply" data-ref-filename="41reply">reply</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::mhdr" title='reply_state::mhdr' data-ref="reply_state::mhdr" data-ref-filename="reply_state..mhdr">mhdr</a>-&gt;<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::op" title='(anonymous struct)::op' data-ref="(anonymous)::op" data-ref-filename="(anonymous)..op">op</a>             = <a class="local col8 ref" href="#38op" title='op' data-ref="38op" data-ref-filename="38op">op</a>;</td></tr>
<tr><th id="401">401</th><td>    <a class="local col1 ref" href="#41reply" title='reply' data-ref="41reply" data-ref-filename="41reply">reply</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::mhdr" title='reply_state::mhdr' data-ref="reply_state::mhdr" data-ref-filename="reply_state..mhdr">mhdr</a>-&gt;<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::client_context" title='(anonymous struct)::client_context' data-ref="(anonymous)::client_context" data-ref-filename="(anonymous)..client_context">client_context</a> = <a class="local col0 ref" href="#40request" title='request' data-ref="40request" data-ref-filename="40request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::client_context" title='(anonymous struct)::client_context' data-ref="(anonymous)::client_context" data-ref-filename="(anonymous)..client_context">client_context</a>;</td></tr>
<tr><th id="402">402</th><td>    <a class="local col1 ref" href="#41reply" title='reply' data-ref="41reply" data-ref-filename="41reply">reply</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::mhdr" title='reply_state::mhdr' data-ref="reply_state::mhdr" data-ref-filename="reply_state..mhdr">mhdr</a>-&gt;<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::reg_index" title='(anonymous struct)::reg_index' data-ref="(anonymous)::reg_index" data-ref-filename="(anonymous)..reg_index">reg_index</a>      = <var>0</var>;</td></tr>
<tr><th id="403">403</th><td></td></tr>
<tr><th id="404">404</th><td>    <b>return</b> <a class="local col1 ref" href="#41reply" title='reply' data-ref="41reply" data-ref-filename="41reply">reply</a>;</td></tr>
<tr><th id="405">405</th><td>}</td></tr>
<tr><th id="406">406</th><td></td></tr>
<tr><th id="407">407</th><td><i>// Append a reply to the list in a request object</i></td></tr>
<tr><th id="408">408</th><td><i>// If our request is sharing a connection, then we append our reply_state onto the primary's list</i></td></tr>
<tr><th id="409">409</th><td><i>// If the request does not want asynchronous replies, then the reply is freed instead of being appended to any list.</i></td></tr>
<tr><th id="410">410</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="append_reply" title='append_reply' data-ref="append_reply" data-ref-filename="append_reply">append_reply</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col2 decl" id="42req" title='req' data-type='request_state *' data-ref="42req" data-ref-filename="42req">req</dfn>, <a class="typedef" href="uds_daemon.h.html#reply_state" title='reply_state' data-type='struct reply_state' data-ref="reply_state" data-ref-filename="reply_state">reply_state</a> *<dfn class="local col3 decl" id="43rep" title='rep' data-type='reply_state *' data-ref="43rep" data-ref-filename="43rep">rep</dfn>)</td></tr>
<tr><th id="411">411</th><td>{</td></tr>
<tr><th id="412">412</th><td>    <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col4 decl" id="44r" title='r' data-type='request_state *' data-ref="44r" data-ref-filename="44r">r</dfn>;</td></tr>
<tr><th id="413">413</th><td>    <a class="typedef" href="uds_daemon.h.html#reply_state" title='reply_state' data-type='struct reply_state' data-ref="reply_state" data-ref-filename="reply_state">reply_state</a> **<dfn class="local col5 decl" id="45ptr" title='ptr' data-type='reply_state **' data-ref="45ptr" data-ref-filename="45ptr">ptr</dfn>;</td></tr>
<tr><th id="414">414</th><td></td></tr>
<tr><th id="415">415</th><td>    <b>if</b> (<a class="local col2 ref" href="#42req" title='req' data-ref="42req" data-ref-filename="42req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::no_reply" title='request_state::no_reply' data-ref="request_state::no_reply" data-ref-filename="request_state..no_reply">no_reply</a>)</td></tr>
<tr><th id="416">416</th><td>    {</td></tr>
<tr><th id="417">417</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(rep)" data-ref="_M/freeL">freeL</a>(<q>"reply_state/append_reply"</q>, <a class="local col3 ref" href="#43rep" title='rep' data-ref="43rep" data-ref-filename="43rep">rep</a>);</td></tr>
<tr><th id="418">418</th><td>        <b>return</b>;</td></tr>
<tr><th id="419">419</th><td>    }</td></tr>
<tr><th id="420">420</th><td></td></tr>
<tr><th id="421">421</th><td>    <a class="local col4 ref" href="#44r" title='r' data-ref="44r" data-ref-filename="44r">r</a> = <a class="local col2 ref" href="#42req" title='req' data-ref="42req" data-ref-filename="42req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::primary" title='request_state::primary' data-ref="request_state::primary" data-ref-filename="request_state..primary">primary</a> ? <a class="local col2 ref" href="#42req" title='req' data-ref="42req" data-ref-filename="42req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::primary" title='request_state::primary' data-ref="request_state::primary" data-ref-filename="request_state..primary">primary</a> : <a class="local col2 ref" href="#42req" title='req' data-ref="42req" data-ref-filename="42req">req</a>;</td></tr>
<tr><th id="422">422</th><td>    <a class="local col5 ref" href="#45ptr" title='ptr' data-ref="45ptr" data-ref-filename="45ptr">ptr</a> = &amp;<a class="local col4 ref" href="#44r" title='r' data-ref="44r" data-ref-filename="44r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::replies" title='request_state::replies' data-ref="request_state::replies" data-ref-filename="request_state..replies">replies</a>;</td></tr>
<tr><th id="423">423</th><td>    <b>while</b> (*<a class="local col5 ref" href="#45ptr" title='ptr' data-ref="45ptr" data-ref-filename="45ptr">ptr</a>) <a class="local col5 ref" href="#45ptr" title='ptr' data-ref="45ptr" data-ref-filename="45ptr">ptr</a> = &amp;(*<a class="local col5 ref" href="#45ptr" title='ptr' data-ref="45ptr" data-ref-filename="45ptr">ptr</a>)-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::next" title='reply_state::next' data-ref="reply_state::next" data-ref-filename="reply_state..next">next</a>;</td></tr>
<tr><th id="424">424</th><td>    *<a class="local col5 ref" href="#45ptr" title='ptr' data-ref="45ptr" data-ref-filename="45ptr">ptr</a> = <a class="local col3 ref" href="#43rep" title='rep' data-ref="43rep" data-ref-filename="43rep">rep</a>;</td></tr>
<tr><th id="425">425</th><td>    <a class="local col3 ref" href="#43rep" title='rep' data-ref="43rep" data-ref-filename="43rep">rep</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::next" title='reply_state::next' data-ref="reply_state::next" data-ref-filename="reply_state..next">next</a> = <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="426">426</th><td>}</td></tr>
<tr><th id="427">427</th><td></td></tr>
<tr><th id="428">428</th><td><i>// Generates a response message giving name, type, domain, plus interface index,</i></td></tr>
<tr><th id="429">429</th><td><i>// suitable for a browse result or service registration result.</i></td></tr>
<tr><th id="430">430</th><td><i>// On successful completion rep is set to point to a malloc'd reply_state struct</i></td></tr>
<tr><th id="431">431</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="decl def fn" id="GenerateNTDResponse" title='GenerateNTDResponse' data-ref="GenerateNTDResponse" data-ref-filename="GenerateNTDResponse">GenerateNTDResponse</dfn>(<em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#domainname" title='domainname' data-type='struct domainname' data-ref="domainname" data-ref-filename="domainname">domainname</a> *<em>const</em> <dfn class="local col6 decl" id="46servicename" title='servicename' data-type='const domainname *const' data-ref="46servicename" data-ref-filename="46servicename">servicename</dfn>, <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterfaceID" title='mDNSInterfaceID' data-type='struct mDNSInterfaceID_dummystruct *' data-ref="mDNSInterfaceID" data-ref-filename="mDNSInterfaceID">mDNSInterfaceID</a> <dfn class="local col7 decl" id="47id" title='id' data-type='const mDNSInterfaceID' data-ref="47id" data-ref-filename="47id">id</dfn>,</td></tr>
<tr><th id="432">432</th><td>                                      <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<em>const</em> <dfn class="local col8 decl" id="48request" title='request' data-type='request_state *const' data-ref="48request" data-ref-filename="48request">request</dfn>, <a class="typedef" href="uds_daemon.h.html#reply_state" title='reply_state' data-type='struct reply_state' data-ref="reply_state" data-ref-filename="reply_state">reply_state</a> **<em>const</em> <dfn class="local col9 decl" id="49rep" title='rep' data-type='reply_state **const' data-ref="49rep" data-ref-filename="49rep">rep</dfn>, <a class="typedef" href="dnssd_ipc.h.html#reply_op_t" title='reply_op_t' data-type='enum reply_op_t' data-ref="reply_op_t" data-ref-filename="reply_op_t">reply_op_t</a> <dfn class="local col0 decl" id="50op" title='op' data-type='reply_op_t' data-ref="50op" data-ref-filename="50op">op</dfn>, <a class="typedef" href="dns_sd.h.html#DNSServiceFlags" title='DNSServiceFlags' data-type='uint32_t' data-ref="DNSServiceFlags" data-ref-filename="DNSServiceFlags">DNSServiceFlags</a> <dfn class="local col1 decl" id="51flags" title='flags' data-type='DNSServiceFlags' data-ref="51flags" data-ref-filename="51flags">flags</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="local col2 decl" id="52err" title='err' data-type='mStatus' data-ref="52err" data-ref-filename="52err">err</dfn>)</td></tr>
<tr><th id="433">433</th><td>{</td></tr>
<tr><th id="434">434</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#domainlabel" title='domainlabel' data-type='struct domainlabel' data-ref="domainlabel" data-ref-filename="domainlabel">domainlabel</a> <dfn class="local col3 decl" id="53name" title='name' data-type='domainlabel' data-ref="53name" data-ref-filename="53name">name</dfn>;</td></tr>
<tr><th id="435">435</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#domainname" title='domainname' data-type='struct domainname' data-ref="domainname" data-ref-filename="domainname">domainname</a> <dfn class="local col4 decl" id="54type" title='type' data-type='domainname' data-ref="54type" data-ref-filename="54type">type</dfn>, <dfn class="local col5 decl" id="55dom" title='dom' data-type='domainname' data-ref="55dom" data-ref-filename="55dom">dom</dfn>;</td></tr>
<tr><th id="436">436</th><td>    *<a class="local col9 ref" href="#49rep" title='rep' data-ref="49rep" data-ref-filename="49rep">rep</a> = <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="437">437</th><td>    <b>if</b> (!<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DeconstructServiceName" title='DeconstructServiceName' data-ref="DeconstructServiceName" data-ref-filename="DeconstructServiceName">DeconstructServiceName</a>(<a class="local col6 ref" href="#46servicename" title='servicename' data-ref="46servicename" data-ref-filename="46servicename">servicename</a>, &amp;<a class="local col3 ref" href="#53name" title='name' data-ref="53name" data-ref-filename="53name">name</a>, &amp;<a class="local col4 ref" href="#54type" title='type' data-ref="54type" data-ref-filename="54type">type</a>, &amp;<a class="local col5 ref" href="#55dom" title='dom' data-ref="55dom" data-ref-filename="55dom">dom</a>))</td></tr>
<tr><th id="438">438</th><td>        <b>return</b> <a class="enum" href="dns_sd.h.html#kDNSServiceErr_Invalid" title='kDNSServiceErr_Invalid' data-ref="kDNSServiceErr_Invalid" data-ref-filename="kDNSServiceErr_Invalid">kDNSServiceErr_Invalid</a>;</td></tr>
<tr><th id="439">439</th><td>    <b>else</b></td></tr>
<tr><th id="440">440</th><td>    {</td></tr>
<tr><th id="441">441</th><td>        <em>char</em> <dfn class="local col6 decl" id="56namestr" title='namestr' data-type='char [64]' data-ref="56namestr" data-ref-filename="56namestr">namestr</dfn>[<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#394" title="63" data-ref="_M/MAX_DOMAIN_LABEL">MAX_DOMAIN_LABEL</a>+<var>1</var>];</td></tr>
<tr><th id="442">442</th><td>        <em>char</em> <dfn class="local col7 decl" id="57typestr" title='typestr' data-type='char [1009]' data-ref="57typestr" data-ref-filename="57typestr">typestr</dfn>[<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#417" title="1009" data-ref="_M/MAX_ESCAPED_DOMAIN_NAME">MAX_ESCAPED_DOMAIN_NAME</a>];</td></tr>
<tr><th id="443">443</th><td>        <em>char</em> <dfn class="local col8 decl" id="58domstr" title='domstr' data-type='char [1009]' data-ref="58domstr" data-ref-filename="58domstr">domstr</dfn> [<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#417" title="1009" data-ref="_M/MAX_ESCAPED_DOMAIN_NAME">MAX_ESCAPED_DOMAIN_NAME</a>];</td></tr>
<tr><th id="444">444</th><td>        <em>int</em> <dfn class="local col9 decl" id="59len" title='len' data-type='int' data-ref="59len" data-ref-filename="59len">len</dfn>;</td></tr>
<tr><th id="445">445</th><td>        <em>char</em> *<dfn class="local col0 decl" id="60data" title='data' data-type='char *' data-ref="60data" data-ref-filename="60data">data</dfn>;</td></tr>
<tr><th id="446">446</th><td></td></tr>
<tr><th id="447">447</th><td>        <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2899" title="ConvertDomainLabelToCString_withescape((&amp;name), (namestr), 0)" data-ref="_M/ConvertDomainLabelToCString_unescaped">ConvertDomainLabelToCString_unescaped</a>(&amp;<a class="local col3 ref" href="#53name" title='name' data-ref="53name" data-ref-filename="53name">name</a>, <a class="local col6 ref" href="#56namestr" title='namestr' data-ref="56namestr" data-ref-filename="56namestr">namestr</a>);</td></tr>
<tr><th id="448">448</th><td>        <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2903" title="ConvertDomainNameToCString_withescape((&amp;type), (typestr), &apos;\\&apos;)" data-ref="_M/ConvertDomainNameToCString">ConvertDomainNameToCString</a>(&amp;<a class="local col4 ref" href="#54type" title='type' data-ref="54type" data-ref-filename="54type">type</a>, <a class="local col7 ref" href="#57typestr" title='typestr' data-ref="57typestr" data-ref-filename="57typestr">typestr</a>);</td></tr>
<tr><th id="449">449</th><td>        <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2903" title="ConvertDomainNameToCString_withescape((&amp;dom), (domstr), &apos;\\&apos;)" data-ref="_M/ConvertDomainNameToCString">ConvertDomainNameToCString</a>(&amp;<a class="local col5 ref" href="#55dom" title='dom' data-ref="55dom" data-ref-filename="55dom">dom</a>, <a class="local col8 ref" href="#58domstr" title='domstr' data-ref="58domstr" data-ref-filename="58domstr">domstr</a>);</td></tr>
<tr><th id="450">450</th><td></td></tr>
<tr><th id="451">451</th><td>        <i>// Calculate reply data length</i></td></tr>
<tr><th id="452">452</th><td>        <a class="local col9 ref" href="#59len" title='len' data-ref="59len" data-ref-filename="59len">len</a> = <b>sizeof</b>(<a class="typedef" href="dns_sd.h.html#DNSServiceFlags" title='DNSServiceFlags' data-type='uint32_t' data-ref="DNSServiceFlags" data-ref-filename="DNSServiceFlags">DNSServiceFlags</a>);</td></tr>
<tr><th id="453">453</th><td>        <a class="local col9 ref" href="#59len" title='len' data-ref="59len" data-ref-filename="59len">len</a> += <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a>);  <i>// if index</i></td></tr>
<tr><th id="454">454</th><td>        <a class="local col9 ref" href="#59len" title='len' data-ref="59len" data-ref-filename="59len">len</a> += <b>sizeof</b>(<a class="typedef" href="dns_sd.h.html#DNSServiceErrorType" title='DNSServiceErrorType' data-type='int32_t' data-ref="DNSServiceErrorType" data-ref-filename="DNSServiceErrorType">DNSServiceErrorType</a>);</td></tr>
<tr><th id="455">455</th><td>        <a class="local col9 ref" href="#59len" title='len' data-ref="59len" data-ref-filename="59len">len</a> += (<em>int</em>) (<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strlen" title='strlen' data-ref="strlen" data-ref-filename="strlen">strlen</a>(<a class="local col6 ref" href="#56namestr" title='namestr' data-ref="56namestr" data-ref-filename="56namestr">namestr</a>) + <var>1</var>);</td></tr>
<tr><th id="456">456</th><td>        <a class="local col9 ref" href="#59len" title='len' data-ref="59len" data-ref-filename="59len">len</a> += (<em>int</em>) (<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strlen" title='strlen' data-ref="strlen" data-ref-filename="strlen">strlen</a>(<a class="local col7 ref" href="#57typestr" title='typestr' data-ref="57typestr" data-ref-filename="57typestr">typestr</a>) + <var>1</var>);</td></tr>
<tr><th id="457">457</th><td>        <a class="local col9 ref" href="#59len" title='len' data-ref="59len" data-ref-filename="59len">len</a> += (<em>int</em>) (<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strlen" title='strlen' data-ref="strlen" data-ref-filename="strlen">strlen</a>(<a class="local col8 ref" href="#58domstr" title='domstr' data-ref="58domstr" data-ref-filename="58domstr">domstr</a>) + <var>1</var>);</td></tr>
<tr><th id="458">458</th><td></td></tr>
<tr><th id="459">459</th><td>        <i>// Build reply header</i></td></tr>
<tr><th id="460">460</th><td>        *<a class="local col9 ref" href="#49rep" title='rep' data-ref="49rep" data-ref-filename="49rep">rep</a> = <a class="ref fn" href="#create_reply" title='create_reply' data-ref="create_reply" data-ref-filename="create_reply">create_reply</a>(<a class="local col0 ref" href="#50op" title='op' data-ref="50op" data-ref-filename="50op">op</a>, <a class="local col9 ref" href="#59len" title='len' data-ref="59len" data-ref-filename="59len">len</a>, <a class="local col8 ref" href="#48request" title='request' data-ref="48request" data-ref-filename="48request">request</a>);</td></tr>
<tr><th id="461">461</th><td>        (*<a class="local col9 ref" href="#49rep" title='rep' data-ref="49rep" data-ref-filename="49rep">rep</a>)-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::rhdr" title='reply_state::rhdr' data-ref="reply_state::rhdr" data-ref-filename="reply_state..rhdr">rhdr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#(anonymous)::flags" title='(anonymous struct)::flags' data-ref="(anonymous)::flags" data-ref-filename="(anonymous)..flags">flags</a> = <a class="ref fn" href="#dnssd_htonl" title='dnssd_htonl' data-ref="dnssd_htonl" data-ref-filename="dnssd_htonl">dnssd_htonl</a>(<a class="local col1 ref" href="#51flags" title='flags' data-ref="51flags" data-ref-filename="51flags">flags</a>);</td></tr>
<tr><th id="462">462</th><td>        (*<a class="local col9 ref" href="#49rep" title='rep' data-ref="49rep" data-ref-filename="49rep">rep</a>)-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::rhdr" title='reply_state::rhdr' data-ref="reply_state::rhdr" data-ref-filename="reply_state..rhdr">rhdr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#(anonymous)::ifi" title='(anonymous struct)::ifi' data-ref="(anonymous)::ifi" data-ref-filename="(anonymous)..ifi">ifi</a>   = <a class="ref fn" href="#dnssd_htonl" title='dnssd_htonl' data-ref="dnssd_htonl" data-ref-filename="dnssd_htonl">dnssd_htonl</a>(<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformInterfaceIndexfromInterfaceID" title='mDNSPlatformInterfaceIndexfromInterfaceID' data-ref="mDNSPlatformInterfaceIndexfromInterfaceID" data-ref-filename="mDNSPlatformInterfaceIndexfromInterfaceID">mDNSPlatformInterfaceIndexfromInterfaceID</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col7 ref" href="#47id" title='id' data-ref="47id" data-ref-filename="47id">id</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>));</td></tr>
<tr><th id="463">463</th><td>        (*<a class="local col9 ref" href="#49rep" title='rep' data-ref="49rep" data-ref-filename="49rep">rep</a>)-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::rhdr" title='reply_state::rhdr' data-ref="reply_state::rhdr" data-ref-filename="reply_state..rhdr">rhdr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#(anonymous)::error" title='(anonymous struct)::error' data-ref="(anonymous)::error" data-ref-filename="(anonymous)..error">error</a> = <a class="ref fn" href="#dnssd_htonl" title='dnssd_htonl' data-ref="dnssd_htonl" data-ref-filename="dnssd_htonl">dnssd_htonl</a>(<a class="local col2 ref" href="#52err" title='err' data-ref="52err" data-ref-filename="52err">err</a>);</td></tr>
<tr><th id="464">464</th><td></td></tr>
<tr><th id="465">465</th><td>        <i>// Build reply body</i></td></tr>
<tr><th id="466">466</th><td>        <a class="local col0 ref" href="#60data" title='data' data-ref="60data" data-ref-filename="60data">data</a> = (<em>char</em> *)&amp;(*<a class="local col9 ref" href="#49rep" title='rep' data-ref="49rep" data-ref-filename="49rep">rep</a>)-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::rhdr" title='reply_state::rhdr' data-ref="reply_state::rhdr" data-ref-filename="reply_state..rhdr">rhdr</a>[<var>1</var>];</td></tr>
<tr><th id="467">467</th><td>        <a class="macro" href="dnssd_ipc.h.html#197" title="__dnssd_ipc_put_string" data-ref="_M/put_string">put_string</a>(<a class="local col6 ref" href="#56namestr" title='namestr' data-ref="56namestr" data-ref-filename="56namestr">namestr</a>, &amp;<a class="local col0 ref" href="#60data" title='data' data-ref="60data" data-ref-filename="60data">data</a>);</td></tr>
<tr><th id="468">468</th><td>        <a class="macro" href="dnssd_ipc.h.html#197" title="__dnssd_ipc_put_string" data-ref="_M/put_string">put_string</a>(<a class="local col7 ref" href="#57typestr" title='typestr' data-ref="57typestr" data-ref-filename="57typestr">typestr</a>, &amp;<a class="local col0 ref" href="#60data" title='data' data-ref="60data" data-ref-filename="60data">data</a>);</td></tr>
<tr><th id="469">469</th><td>        <a class="macro" href="dnssd_ipc.h.html#197" title="__dnssd_ipc_put_string" data-ref="_M/put_string">put_string</a>(<a class="local col8 ref" href="#58domstr" title='domstr' data-ref="58domstr" data-ref-filename="58domstr">domstr</a>, &amp;<a class="local col0 ref" href="#60data" title='data' data-ref="60data" data-ref-filename="60data">data</a>);</td></tr>
<tr><th id="470">470</th><td></td></tr>
<tr><th id="471">471</th><td>        <b>return</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_NoError" title='mStatus_NoError' data-ref="mStatus_NoError" data-ref-filename="mStatus_NoError">mStatus_NoError</a>;</td></tr>
<tr><th id="472">472</th><td>    }</td></tr>
<tr><th id="473">473</th><td>}</td></tr>
<tr><th id="474">474</th><td></td></tr>
<tr><th id="475">475</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="GenerateBrowseReply" title='GenerateBrowseReply' data-ref="GenerateBrowseReply" data-ref-filename="GenerateBrowseReply">GenerateBrowseReply</dfn>(<em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#domainname" title='domainname' data-type='struct domainname' data-ref="domainname" data-ref-filename="domainname">domainname</a> *<em>const</em> <dfn class="local col1 decl" id="61servicename" title='servicename' data-type='const domainname *const' data-ref="61servicename" data-ref-filename="61servicename">servicename</dfn>, <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterfaceID" title='mDNSInterfaceID' data-type='struct mDNSInterfaceID_dummystruct *' data-ref="mDNSInterfaceID" data-ref-filename="mDNSInterfaceID">mDNSInterfaceID</a> <dfn class="local col2 decl" id="62id" title='id' data-type='const mDNSInterfaceID' data-ref="62id" data-ref-filename="62id">id</dfn>,</td></tr>
<tr><th id="476">476</th><td>                                              <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<em>const</em> <dfn class="local col3 decl" id="63request" title='request' data-type='request_state *const' data-ref="63request" data-ref-filename="63request">request</dfn>, <a class="typedef" href="uds_daemon.h.html#reply_state" title='reply_state' data-type='struct reply_state' data-ref="reply_state" data-ref-filename="reply_state">reply_state</a> **<em>const</em> <dfn class="local col4 decl" id="64rep" title='rep' data-type='reply_state **const' data-ref="64rep" data-ref-filename="64rep">rep</dfn>, <a class="typedef" href="dnssd_ipc.h.html#reply_op_t" title='reply_op_t' data-type='enum reply_op_t' data-ref="reply_op_t" data-ref-filename="reply_op_t">reply_op_t</a> <dfn class="local col5 decl" id="65op" title='op' data-type='reply_op_t' data-ref="65op" data-ref-filename="65op">op</dfn>, <a class="typedef" href="dns_sd.h.html#DNSServiceFlags" title='DNSServiceFlags' data-type='uint32_t' data-ref="DNSServiceFlags" data-ref-filename="DNSServiceFlags">DNSServiceFlags</a> <dfn class="local col6 decl" id="66flags" title='flags' data-type='DNSServiceFlags' data-ref="66flags" data-ref-filename="66flags">flags</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="local col7 decl" id="67err" title='err' data-type='mStatus' data-ref="67err" data-ref-filename="67err">err</dfn>)</td></tr>
<tr><th id="477">477</th><td>{</td></tr>
<tr><th id="478">478</th><td>    <em>char</em> <dfn class="local col8 decl" id="68namestr" title='namestr' data-type='char [64]' data-ref="68namestr" data-ref-filename="68namestr">namestr</dfn>[<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#394" title="63" data-ref="_M/MAX_DOMAIN_LABEL">MAX_DOMAIN_LABEL</a>+<var>1</var>];</td></tr>
<tr><th id="479">479</th><td>    <em>char</em> <dfn class="local col9 decl" id="69typestr" title='typestr' data-type='char [1009]' data-ref="69typestr" data-ref-filename="69typestr">typestr</dfn>[<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#417" title="1009" data-ref="_M/MAX_ESCAPED_DOMAIN_NAME">MAX_ESCAPED_DOMAIN_NAME</a>];</td></tr>
<tr><th id="480">480</th><td>    <em>static</em> <em>const</em> <em>char</em> <dfn class="local col0 decl" id="70domstr" title='domstr' data-type='const char [2]' data-ref="70domstr" data-ref-filename="70domstr">domstr</dfn>[] = <q>"."</q>;</td></tr>
<tr><th id="481">481</th><td>    <em>int</em> <dfn class="local col1 decl" id="71len" title='len' data-type='int' data-ref="71len" data-ref-filename="71len">len</dfn>;</td></tr>
<tr><th id="482">482</th><td>    <em>char</em> *<dfn class="local col2 decl" id="72data" title='data' data-type='char *' data-ref="72data" data-ref-filename="72data">data</dfn>;</td></tr>
<tr><th id="483">483</th><td></td></tr>
<tr><th id="484">484</th><td>    *<a class="local col4 ref" href="#64rep" title='rep' data-ref="64rep" data-ref-filename="64rep">rep</a> = <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="485">485</th><td></td></tr>
<tr><th id="486">486</th><td>    <i>// 1. Put first label in namestr</i></td></tr>
<tr><th id="487">487</th><td>    <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2899" title="ConvertDomainLabelToCString_withescape(((const domainlabel *)servicename), (namestr), 0)" data-ref="_M/ConvertDomainLabelToCString_unescaped">ConvertDomainLabelToCString_unescaped</a>((<em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#domainlabel" title='domainlabel' data-type='struct domainlabel' data-ref="domainlabel" data-ref-filename="domainlabel">domainlabel</a> *)<a class="local col1 ref" href="#61servicename" title='servicename' data-ref="61servicename" data-ref-filename="61servicename">servicename</a>, <a class="local col8 ref" href="#68namestr" title='namestr' data-ref="68namestr" data-ref-filename="68namestr">namestr</a>);</td></tr>
<tr><th id="488">488</th><td></td></tr>
<tr><th id="489">489</th><td>    <i>// 2. Put second label and "local" into typestr</i></td></tr>
<tr><th id="490">490</th><td>    <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_snprintf" title='mDNS_snprintf' data-ref="mDNS_snprintf" data-ref-filename="mDNS_snprintf">mDNS_snprintf</a>(<a class="local col9 ref" href="#69typestr" title='typestr' data-ref="69typestr" data-ref-filename="69typestr">typestr</a>, <b>sizeof</b>(<a class="local col9 ref" href="#69typestr" title='typestr' data-ref="69typestr" data-ref-filename="69typestr">typestr</a>), <q>"%#s.local."</q>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2863" title="((const domainlabel *)((const domainname *)&amp; (servicename)-&gt;c[(servicename)-&gt;c[0] ? 1 + (servicename)-&gt;c[0] : 0]))" data-ref="_M/SecondLabel">SecondLabel</a>(<a class="local col1 ref" href="#61servicename" title='servicename' data-ref="61servicename" data-ref-filename="61servicename">servicename</a>));</td></tr>
<tr><th id="491">491</th><td></td></tr>
<tr><th id="492">492</th><td>    <i>// Calculate reply data length</i></td></tr>
<tr><th id="493">493</th><td>    <a class="local col1 ref" href="#71len" title='len' data-ref="71len" data-ref-filename="71len">len</a> = <b>sizeof</b>(<a class="typedef" href="dns_sd.h.html#DNSServiceFlags" title='DNSServiceFlags' data-type='uint32_t' data-ref="DNSServiceFlags" data-ref-filename="DNSServiceFlags">DNSServiceFlags</a>);</td></tr>
<tr><th id="494">494</th><td>    <a class="local col1 ref" href="#71len" title='len' data-ref="71len" data-ref-filename="71len">len</a> += <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a>);  <i>// if index</i></td></tr>
<tr><th id="495">495</th><td>    <a class="local col1 ref" href="#71len" title='len' data-ref="71len" data-ref-filename="71len">len</a> += <b>sizeof</b>(<a class="typedef" href="dns_sd.h.html#DNSServiceErrorType" title='DNSServiceErrorType' data-type='int32_t' data-ref="DNSServiceErrorType" data-ref-filename="DNSServiceErrorType">DNSServiceErrorType</a>);</td></tr>
<tr><th id="496">496</th><td>    <a class="local col1 ref" href="#71len" title='len' data-ref="71len" data-ref-filename="71len">len</a> += (<em>int</em>) (<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strlen" title='strlen' data-ref="strlen" data-ref-filename="strlen">strlen</a>(<a class="local col8 ref" href="#68namestr" title='namestr' data-ref="68namestr" data-ref-filename="68namestr">namestr</a>) + <var>1</var>);</td></tr>
<tr><th id="497">497</th><td>    <a class="local col1 ref" href="#71len" title='len' data-ref="71len" data-ref-filename="71len">len</a> += (<em>int</em>) (<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strlen" title='strlen' data-ref="strlen" data-ref-filename="strlen">strlen</a>(<a class="local col9 ref" href="#69typestr" title='typestr' data-ref="69typestr" data-ref-filename="69typestr">typestr</a>) + <var>1</var>);</td></tr>
<tr><th id="498">498</th><td>    <a class="local col1 ref" href="#71len" title='len' data-ref="71len" data-ref-filename="71len">len</a> += (<em>int</em>) (<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strlen" title='strlen' data-ref="strlen" data-ref-filename="strlen">strlen</a>(<a class="local col0 ref" href="#70domstr" title='domstr' data-ref="70domstr" data-ref-filename="70domstr">domstr</a>) + <var>1</var>);</td></tr>
<tr><th id="499">499</th><td></td></tr>
<tr><th id="500">500</th><td>    <i>// Build reply header</i></td></tr>
<tr><th id="501">501</th><td>    *<a class="local col4 ref" href="#64rep" title='rep' data-ref="64rep" data-ref-filename="64rep">rep</a> = <a class="ref fn" href="#create_reply" title='create_reply' data-ref="create_reply" data-ref-filename="create_reply">create_reply</a>(<a class="local col5 ref" href="#65op" title='op' data-ref="65op" data-ref-filename="65op">op</a>, <a class="local col1 ref" href="#71len" title='len' data-ref="71len" data-ref-filename="71len">len</a>, <a class="local col3 ref" href="#63request" title='request' data-ref="63request" data-ref-filename="63request">request</a>);</td></tr>
<tr><th id="502">502</th><td>    (*<a class="local col4 ref" href="#64rep" title='rep' data-ref="64rep" data-ref-filename="64rep">rep</a>)-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::rhdr" title='reply_state::rhdr' data-ref="reply_state::rhdr" data-ref-filename="reply_state..rhdr">rhdr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#(anonymous)::flags" title='(anonymous struct)::flags' data-ref="(anonymous)::flags" data-ref-filename="(anonymous)..flags">flags</a> = <a class="ref fn" href="#dnssd_htonl" title='dnssd_htonl' data-ref="dnssd_htonl" data-ref-filename="dnssd_htonl">dnssd_htonl</a>(<a class="local col6 ref" href="#66flags" title='flags' data-ref="66flags" data-ref-filename="66flags">flags</a>);</td></tr>
<tr><th id="503">503</th><td>    (*<a class="local col4 ref" href="#64rep" title='rep' data-ref="64rep" data-ref-filename="64rep">rep</a>)-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::rhdr" title='reply_state::rhdr' data-ref="reply_state::rhdr" data-ref-filename="reply_state..rhdr">rhdr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#(anonymous)::ifi" title='(anonymous struct)::ifi' data-ref="(anonymous)::ifi" data-ref-filename="(anonymous)..ifi">ifi</a>   = <a class="ref fn" href="#dnssd_htonl" title='dnssd_htonl' data-ref="dnssd_htonl" data-ref-filename="dnssd_htonl">dnssd_htonl</a>(<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformInterfaceIndexfromInterfaceID" title='mDNSPlatformInterfaceIndexfromInterfaceID' data-ref="mDNSPlatformInterfaceIndexfromInterfaceID" data-ref-filename="mDNSPlatformInterfaceIndexfromInterfaceID">mDNSPlatformInterfaceIndexfromInterfaceID</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col2 ref" href="#62id" title='id' data-ref="62id" data-ref-filename="62id">id</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>));</td></tr>
<tr><th id="504">504</th><td>    (*<a class="local col4 ref" href="#64rep" title='rep' data-ref="64rep" data-ref-filename="64rep">rep</a>)-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::rhdr" title='reply_state::rhdr' data-ref="reply_state::rhdr" data-ref-filename="reply_state..rhdr">rhdr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#(anonymous)::error" title='(anonymous struct)::error' data-ref="(anonymous)::error" data-ref-filename="(anonymous)..error">error</a> = <a class="ref fn" href="#dnssd_htonl" title='dnssd_htonl' data-ref="dnssd_htonl" data-ref-filename="dnssd_htonl">dnssd_htonl</a>(<a class="local col7 ref" href="#67err" title='err' data-ref="67err" data-ref-filename="67err">err</a>);</td></tr>
<tr><th id="505">505</th><td></td></tr>
<tr><th id="506">506</th><td>    <i>// Build reply body</i></td></tr>
<tr><th id="507">507</th><td>    <a class="local col2 ref" href="#72data" title='data' data-ref="72data" data-ref-filename="72data">data</a> = (<em>char</em> *)&amp;(*<a class="local col4 ref" href="#64rep" title='rep' data-ref="64rep" data-ref-filename="64rep">rep</a>)-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::rhdr" title='reply_state::rhdr' data-ref="reply_state::rhdr" data-ref-filename="reply_state..rhdr">rhdr</a>[<var>1</var>];</td></tr>
<tr><th id="508">508</th><td>    <a class="macro" href="dnssd_ipc.h.html#197" title="__dnssd_ipc_put_string" data-ref="_M/put_string">put_string</a>(<a class="local col8 ref" href="#68namestr" title='namestr' data-ref="68namestr" data-ref-filename="68namestr">namestr</a>, &amp;<a class="local col2 ref" href="#72data" title='data' data-ref="72data" data-ref-filename="72data">data</a>);</td></tr>
<tr><th id="509">509</th><td>    <a class="macro" href="dnssd_ipc.h.html#197" title="__dnssd_ipc_put_string" data-ref="_M/put_string">put_string</a>(<a class="local col9 ref" href="#69typestr" title='typestr' data-ref="69typestr" data-ref-filename="69typestr">typestr</a>, &amp;<a class="local col2 ref" href="#72data" title='data' data-ref="72data" data-ref-filename="72data">data</a>);</td></tr>
<tr><th id="510">510</th><td>    <a class="macro" href="dnssd_ipc.h.html#197" title="__dnssd_ipc_put_string" data-ref="_M/put_string">put_string</a>(<a class="local col0 ref" href="#70domstr" title='domstr' data-ref="70domstr" data-ref-filename="70domstr">domstr</a>, &amp;<a class="local col2 ref" href="#72data" title='data' data-ref="72data" data-ref-filename="72data">data</a>);</td></tr>
<tr><th id="511">511</th><td>}</td></tr>
<tr><th id="512">512</th><td></td></tr>
<tr><th id="513">513</th><td><i>// Returns a resource record (allocated w/ malloc) containing the data found in an IPC message</i></td></tr>
<tr><th id="514">514</th><td><i>// Data must be in the following format: flags, interfaceIndex, name, rrtype, rrclass, rdlen, rdata, (optional) ttl</i></td></tr>
<tr><th id="515">515</th><td><i>// (ttl only extracted/set if ttl argument is non-zero). Returns NULL for a bad-parameter error</i></td></tr>
<tr><th id="516">516</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord" title='AuthRecord' data-type='struct AuthRecord_struct' data-ref="AuthRecord" data-ref-filename="AuthRecord">AuthRecord</a> *<dfn class="decl def fn" id="read_rr_from_ipc_msg" title='read_rr_from_ipc_msg' data-ref="read_rr_from_ipc_msg" data-ref-filename="read_rr_from_ipc_msg">read_rr_from_ipc_msg</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col3 decl" id="73request" title='request' data-type='request_state *' data-ref="73request" data-ref-filename="73request">request</dfn>, <em>int</em> <dfn class="local col4 decl" id="74GetTTL" title='GetTTL' data-type='int' data-ref="74GetTTL" data-ref-filename="74GetTTL">GetTTL</dfn>, <em>int</em> <dfn class="local col5 decl" id="75validate_flags" title='validate_flags' data-type='int' data-ref="75validate_flags" data-ref-filename="75validate_flags">validate_flags</dfn>)</td></tr>
<tr><th id="517">517</th><td>{</td></tr>
<tr><th id="518">518</th><td>    <a class="typedef" href="dns_sd.h.html#DNSServiceFlags" title='DNSServiceFlags' data-type='uint32_t' data-ref="DNSServiceFlags" data-ref-filename="DNSServiceFlags">DNSServiceFlags</a> <dfn class="local col6 decl" id="76flags" title='flags' data-type='DNSServiceFlags' data-ref="76flags" data-ref-filename="76flags">flags</dfn>  = <a class="macro" href="dnssd_ipc.h.html#210" title="__dnssd_ipc_get_uint32" data-ref="_M/get_flags">get_flags</a>(&amp;<a class="local col3 ref" href="#73request" title='request' data-ref="73request" data-ref-filename="73request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col3 ref" href="#73request" title='request' data-ref="73request" data-ref-filename="73request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);</td></tr>
<tr><th id="519">519</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col7 decl" id="77interfaceIndex" title='interfaceIndex' data-type='mDNSu32' data-ref="77interfaceIndex" data-ref-filename="77interfaceIndex">interfaceIndex</dfn> = <a class="macro" href="dnssd_ipc.h.html#194" title="__dnssd_ipc_get_uint32" data-ref="_M/get_uint32">get_uint32</a>(&amp;<a class="local col3 ref" href="#73request" title='request' data-ref="73request" data-ref-filename="73request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col3 ref" href="#73request" title='request' data-ref="73request" data-ref-filename="73request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);</td></tr>
<tr><th id="520">520</th><td>    <em>char</em> <dfn class="local col8 decl" id="78name" title='name' data-type='char [256]' data-ref="78name" data-ref-filename="78name">name</dfn>[<var>256</var>];</td></tr>
<tr><th id="521">521</th><td>    <em>int</em> <dfn class="local col9 decl" id="79str_err" title='str_err' data-type='int' data-ref="79str_err" data-ref-filename="79str_err">str_err</dfn> = <a class="macro" href="dnssd_ipc.h.html#198" title="__dnssd_ipc_get_string" data-ref="_M/get_string">get_string</a>(&amp;<a class="local col3 ref" href="#73request" title='request' data-ref="73request" data-ref-filename="73request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col3 ref" href="#73request" title='request' data-ref="73request" data-ref-filename="73request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>, <a class="local col8 ref" href="#78name" title='name' data-ref="78name" data-ref-filename="78name">name</a>, <b>sizeof</b>(<a class="local col8 ref" href="#78name" title='name' data-ref="78name" data-ref-filename="78name">name</a>));</td></tr>
<tr><th id="522">522</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu16" title='mDNSu16' data-type='unsigned short' data-ref="mDNSu16" data-ref-filename="mDNSu16">mDNSu16</a> <dfn class="local col0 decl" id="80type" title='type' data-type='mDNSu16' data-ref="80type" data-ref-filename="80type">type</dfn>    = <a class="macro" href="dnssd_ipc.h.html#196" title="__dnssd_ipc_get_uint16" data-ref="_M/get_uint16">get_uint16</a>(&amp;<a class="local col3 ref" href="#73request" title='request' data-ref="73request" data-ref-filename="73request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col3 ref" href="#73request" title='request' data-ref="73request" data-ref-filename="73request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);</td></tr>
<tr><th id="523">523</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu16" title='mDNSu16' data-type='unsigned short' data-ref="mDNSu16" data-ref-filename="mDNSu16">mDNSu16</a>     <dfn class="local col1 decl" id="81class" title='class' data-type='mDNSu16' data-ref="81class" data-ref-filename="81class">class</dfn>   = <a class="macro" href="dnssd_ipc.h.html#196" title="__dnssd_ipc_get_uint16" data-ref="_M/get_uint16">get_uint16</a>(&amp;<a class="local col3 ref" href="#73request" title='request' data-ref="73request" data-ref-filename="73request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col3 ref" href="#73request" title='request' data-ref="73request" data-ref-filename="73request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);</td></tr>
<tr><th id="524">524</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu16" title='mDNSu16' data-type='unsigned short' data-ref="mDNSu16" data-ref-filename="mDNSu16">mDNSu16</a> <dfn class="local col2 decl" id="82rdlen" title='rdlen' data-type='mDNSu16' data-ref="82rdlen" data-ref-filename="82rdlen">rdlen</dfn>   = <a class="macro" href="dnssd_ipc.h.html#196" title="__dnssd_ipc_get_uint16" data-ref="_M/get_uint16">get_uint16</a>(&amp;<a class="local col3 ref" href="#73request" title='request' data-ref="73request" data-ref-filename="73request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col3 ref" href="#73request" title='request' data-ref="73request" data-ref-filename="73request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);</td></tr>
<tr><th id="525">525</th><td>    <em>const</em> <em>char</em> *<dfn class="local col3 decl" id="83rdata" title='rdata' data-type='const char *' data-ref="83rdata" data-ref-filename="83rdata">rdata</dfn>   = <a class="macro" href="dnssd_ipc.h.html#200" title="__dnssd_ipc_get_rdata" data-ref="_M/get_rdata">get_rdata</a> (&amp;<a class="local col3 ref" href="#73request" title='request' data-ref="73request" data-ref-filename="73request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col3 ref" href="#73request" title='request' data-ref="73request" data-ref-filename="73request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>, <a class="local col2 ref" href="#82rdlen" title='rdlen' data-ref="82rdlen" data-ref-filename="82rdlen">rdlen</a>);</td></tr>
<tr><th id="526">526</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col4 decl" id="84ttl" title='ttl' data-type='mDNSu32' data-ref="84ttl" data-ref-filename="84ttl">ttl</dfn>   = <a class="local col4 ref" href="#74GetTTL" title='GetTTL' data-ref="74GetTTL" data-ref-filename="74GetTTL">GetTTL</a> ? <a class="macro" href="dnssd_ipc.h.html#194" title="__dnssd_ipc_get_uint32" data-ref="_M/get_uint32">get_uint32</a>(&amp;<a class="local col3 ref" href="#73request" title='request' data-ref="73request" data-ref-filename="73request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col3 ref" href="#73request" title='request' data-ref="73request" data-ref-filename="73request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>) : <var>0</var>;</td></tr>
<tr><th id="527">527</th><td>    <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#size_t" title='size_t' data-type='unsigned long' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col5 decl" id="85storage_size" title='storage_size' data-type='size_t' data-ref="85storage_size" data-ref-filename="85storage_size">storage_size</dfn> = <a class="local col2 ref" href="#82rdlen" title='rdlen' data-ref="82rdlen" data-ref-filename="82rdlen">rdlen</a> &gt; <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#RDataBody" title='RDataBody' data-type='union RDataBody' data-ref="RDataBody" data-ref-filename="RDataBody">RDataBody</a>) ? <a class="local col2 ref" href="#82rdlen" title='rdlen' data-ref="82rdlen" data-ref-filename="82rdlen">rdlen</a> : <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#RDataBody" title='RDataBody' data-type='union RDataBody' data-ref="RDataBody" data-ref-filename="RDataBody">RDataBody</a>);</td></tr>
<tr><th id="528">528</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord" title='AuthRecord' data-type='struct AuthRecord_struct' data-ref="AuthRecord" data-ref-filename="AuthRecord">AuthRecord</a> *<dfn class="local col6 decl" id="86rr" title='rr' data-type='AuthRecord *' data-ref="86rr" data-ref-filename="86rr">rr</dfn>;</td></tr>
<tr><th id="529">529</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterfaceID" title='mDNSInterfaceID' data-type='struct mDNSInterfaceID_dummystruct *' data-ref="mDNSInterfaceID" data-ref-filename="mDNSInterfaceID">mDNSInterfaceID</a> <dfn class="local col7 decl" id="87InterfaceID" title='InterfaceID' data-type='mDNSInterfaceID' data-ref="87InterfaceID" data-ref-filename="87InterfaceID">InterfaceID</dfn>;</td></tr>
<tr><th id="530">530</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecType" title='AuthRecType' data-type='enum AuthRecType' data-ref="AuthRecType" data-ref-filename="AuthRecType">AuthRecType</a> <dfn class="local col8 decl" id="88artype" title='artype' data-type='AuthRecType' data-ref="88artype" data-ref-filename="88artype">artype</dfn>;</td></tr>
<tr><th id="531">531</th><td></td></tr>
<tr><th id="532">532</th><td>    <a class="local col3 ref" href="#73request" title='request' data-ref="73request" data-ref-filename="73request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a> = <a class="local col6 ref" href="#76flags" title='flags' data-ref="76flags" data-ref-filename="76flags">flags</a>;</td></tr>
<tr><th id="533">533</th><td>    <a class="local col3 ref" href="#73request" title='request' data-ref="73request" data-ref-filename="73request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::interfaceIndex" title='request_state::interfaceIndex' data-ref="request_state::interfaceIndex" data-ref-filename="request_state..interfaceIndex">interfaceIndex</a> = <a class="local col7 ref" href="#77interfaceIndex" title='interfaceIndex' data-ref="77interfaceIndex" data-ref-filename="77interfaceIndex">interfaceIndex</a>;</td></tr>
<tr><th id="534">534</th><td></td></tr>
<tr><th id="535">535</th><td>    <b>if</b> (<a class="local col9 ref" href="#79str_err" title='str_err' data-ref="79str_err" data-ref-filename="79str_err">str_err</a>) { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;ERROR: read_rr_from_ipc_msg - get_string&quot;)" data-ref="_M/LogMsg">LogMsg</a>(<q>"ERROR: read_rr_from_ipc_msg - get_string"</q>); <b>return</b> <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>; }</td></tr>
<tr><th id="536">536</th><td></td></tr>
<tr><th id="537">537</th><td>    <b>if</b> (!<a class="local col3 ref" href="#73request" title='request' data-ref="73request" data-ref-filename="73request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>) { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;Error reading Resource Record from client&quot;)" data-ref="_M/LogMsg">LogMsg</a>(<q>"Error reading Resource Record from client"</q>); <b>return</b> <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>; }</td></tr>
<tr><th id="538">538</th><td></td></tr>
<tr><th id="539">539</th><td>    <b>if</b> (<a class="local col5 ref" href="#75validate_flags" title='validate_flags' data-ref="75validate_flags" data-ref-filename="75validate_flags">validate_flags</a> &amp;&amp;</td></tr>
<tr><th id="540">540</th><td>        !((<a class="local col6 ref" href="#76flags" title='flags' data-ref="76flags" data-ref-filename="76flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsShared" title='kDNSServiceFlagsShared' data-ref="kDNSServiceFlagsShared" data-ref-filename="kDNSServiceFlagsShared">kDNSServiceFlagsShared</a>) == <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsShared" title='kDNSServiceFlagsShared' data-ref="kDNSServiceFlagsShared" data-ref-filename="kDNSServiceFlagsShared">kDNSServiceFlagsShared</a>) &amp;&amp;</td></tr>
<tr><th id="541">541</th><td>        !((<a class="local col6 ref" href="#76flags" title='flags' data-ref="76flags" data-ref-filename="76flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsUnique" title='kDNSServiceFlagsUnique' data-ref="kDNSServiceFlagsUnique" data-ref-filename="kDNSServiceFlagsUnique">kDNSServiceFlagsUnique</a>) == <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsUnique" title='kDNSServiceFlagsUnique' data-ref="kDNSServiceFlagsUnique" data-ref-filename="kDNSServiceFlagsUnique">kDNSServiceFlagsUnique</a>))</td></tr>
<tr><th id="542">542</th><td>    {</td></tr>
<tr><th id="543">543</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;ERROR: Bad resource record flags (must be kDNSServiceFlagsShared or kDNSServiceFlagsUnique)&quot;)" data-ref="_M/LogMsg">LogMsg</a>(<q>"ERROR: Bad resource record flags (must be kDNSServiceFlagsShared or kDNSServiceFlagsUnique)"</q>);</td></tr>
<tr><th id="544">544</th><td>        <b>return</b> <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="545">545</th><td>    }</td></tr>
<tr><th id="546">546</th><td></td></tr>
<tr><th id="547">547</th><td>    <a class="local col6 ref" href="#86rr" title='rr' data-ref="86rr" data-ref-filename="86rr">rr</a> = <a class="macro" href="../mDNSCore/mDNSDebug.h.html#166" title="malloc(sizeof(AuthRecord) - sizeof(RDataBody) + storage_size)" data-ref="_M/mallocL">mallocL</a>(<q>"AuthRecord/read_rr_from_ipc_msg"</q>, <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord" title='AuthRecord' data-type='struct AuthRecord_struct' data-ref="AuthRecord" data-ref-filename="AuthRecord">AuthRecord</a>) - <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#RDataBody" title='RDataBody' data-type='union RDataBody' data-ref="RDataBody" data-ref-filename="RDataBody">RDataBody</a>) + <a class="local col5 ref" href="#85storage_size" title='storage_size' data-ref="85storage_size" data-ref-filename="85storage_size">storage_size</a>);</td></tr>
<tr><th id="548">548</th><td>    <b>if</b> (!<a class="local col6 ref" href="#86rr" title='rr' data-ref="86rr" data-ref-filename="86rr">rr</a>) <a class="ref fn" href="#FatalError" title='FatalError' data-ref="FatalError" data-ref-filename="FatalError">FatalError</a>(<q>"ERROR: malloc"</q>);</td></tr>
<tr><th id="549">549</th><td></td></tr>
<tr><th id="550">550</th><td>    <a class="local col7 ref" href="#87InterfaceID" title='InterfaceID' data-ref="87InterfaceID" data-ref-filename="87InterfaceID">InterfaceID</a> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformInterfaceIDfromInterfaceIndex" title='mDNSPlatformInterfaceIDfromInterfaceIndex' data-ref="mDNSPlatformInterfaceIDfromInterfaceIndex" data-ref-filename="mDNSPlatformInterfaceIDfromInterfaceIndex">mDNSPlatformInterfaceIDfromInterfaceIndex</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col7 ref" href="#77interfaceIndex" title='interfaceIndex' data-ref="77interfaceIndex" data-ref-filename="77interfaceIndex">interfaceIndex</a>);</td></tr>
<tr><th id="551">551</th><td>    <b>if</b> (<a class="local col7 ref" href="#87InterfaceID" title='InterfaceID' data-ref="87InterfaceID" data-ref-filename="87InterfaceID">InterfaceID</a> == <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterface_LocalOnly" title='mDNSInterface_LocalOnly' data-ref="mDNSInterface_LocalOnly" data-ref-filename="mDNSInterface_LocalOnly">mDNSInterface_LocalOnly</a>)</td></tr>
<tr><th id="552">552</th><td>        <a class="local col8 ref" href="#88artype" title='artype' data-ref="88artype" data-ref-filename="88artype">artype</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecordLocalOnly" title='AuthRecordLocalOnly' data-ref="AuthRecordLocalOnly" data-ref-filename="AuthRecordLocalOnly">AuthRecordLocalOnly</a>;</td></tr>
<tr><th id="553">553</th><td>    <b>else</b> <b>if</b> (<a class="local col7 ref" href="#87InterfaceID" title='InterfaceID' data-ref="87InterfaceID" data-ref-filename="87InterfaceID">InterfaceID</a> == <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterface_P2P" title='mDNSInterface_P2P' data-ref="mDNSInterface_P2P" data-ref-filename="mDNSInterface_P2P">mDNSInterface_P2P</a> || <a class="local col7 ref" href="#87InterfaceID" title='InterfaceID' data-ref="87InterfaceID" data-ref-filename="87InterfaceID">InterfaceID</a> == <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterface_BLE" title='mDNSInterface_BLE' data-ref="mDNSInterface_BLE" data-ref-filename="mDNSInterface_BLE">mDNSInterface_BLE</a>)</td></tr>
<tr><th id="554">554</th><td>        <a class="local col8 ref" href="#88artype" title='artype' data-ref="88artype" data-ref-filename="88artype">artype</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecordP2P" title='AuthRecordP2P' data-ref="AuthRecordP2P" data-ref-filename="AuthRecordP2P">AuthRecordP2P</a>;</td></tr>
<tr><th id="555">555</th><td>    <b>else</b> <b>if</b> ((<a class="local col7 ref" href="#87InterfaceID" title='InterfaceID' data-ref="87InterfaceID" data-ref-filename="87InterfaceID">InterfaceID</a> == <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterface_Any" title='mDNSInterface_Any' data-ref="mDNSInterface_Any" data-ref-filename="mDNSInterface_Any">mDNSInterface_Any</a>) &amp;&amp; (<a class="local col6 ref" href="#76flags" title='flags' data-ref="76flags" data-ref-filename="76flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsIncludeP2P" title='kDNSServiceFlagsIncludeP2P' data-ref="kDNSServiceFlagsIncludeP2P" data-ref-filename="kDNSServiceFlagsIncludeP2P">kDNSServiceFlagsIncludeP2P</a>)</td></tr>
<tr><th id="556">556</th><td>            &amp;&amp; (<a class="local col6 ref" href="#76flags" title='flags' data-ref="76flags" data-ref-filename="76flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsIncludeAWDL" title='kDNSServiceFlagsIncludeAWDL' data-ref="kDNSServiceFlagsIncludeAWDL" data-ref-filename="kDNSServiceFlagsIncludeAWDL">kDNSServiceFlagsIncludeAWDL</a>))</td></tr>
<tr><th id="557">557</th><td>        <a class="local col8 ref" href="#88artype" title='artype' data-ref="88artype" data-ref-filename="88artype">artype</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecordAnyIncludeAWDLandP2P" title='AuthRecordAnyIncludeAWDLandP2P' data-ref="AuthRecordAnyIncludeAWDLandP2P" data-ref-filename="AuthRecordAnyIncludeAWDLandP2P">AuthRecordAnyIncludeAWDLandP2P</a>;</td></tr>
<tr><th id="558">558</th><td>    <b>else</b> <b>if</b> ((<a class="local col7 ref" href="#87InterfaceID" title='InterfaceID' data-ref="87InterfaceID" data-ref-filename="87InterfaceID">InterfaceID</a> == <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterface_Any" title='mDNSInterface_Any' data-ref="mDNSInterface_Any" data-ref-filename="mDNSInterface_Any">mDNSInterface_Any</a>) &amp;&amp; (<a class="local col6 ref" href="#76flags" title='flags' data-ref="76flags" data-ref-filename="76flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsIncludeP2P" title='kDNSServiceFlagsIncludeP2P' data-ref="kDNSServiceFlagsIncludeP2P" data-ref-filename="kDNSServiceFlagsIncludeP2P">kDNSServiceFlagsIncludeP2P</a>))</td></tr>
<tr><th id="559">559</th><td>        <a class="local col8 ref" href="#88artype" title='artype' data-ref="88artype" data-ref-filename="88artype">artype</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecordAnyIncludeP2P" title='AuthRecordAnyIncludeP2P' data-ref="AuthRecordAnyIncludeP2P" data-ref-filename="AuthRecordAnyIncludeP2P">AuthRecordAnyIncludeP2P</a>;</td></tr>
<tr><th id="560">560</th><td>    <b>else</b> <b>if</b> ((<a class="local col7 ref" href="#87InterfaceID" title='InterfaceID' data-ref="87InterfaceID" data-ref-filename="87InterfaceID">InterfaceID</a> == <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterface_Any" title='mDNSInterface_Any' data-ref="mDNSInterface_Any" data-ref-filename="mDNSInterface_Any">mDNSInterface_Any</a>) &amp;&amp; (<a class="local col6 ref" href="#76flags" title='flags' data-ref="76flags" data-ref-filename="76flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsIncludeAWDL" title='kDNSServiceFlagsIncludeAWDL' data-ref="kDNSServiceFlagsIncludeAWDL" data-ref-filename="kDNSServiceFlagsIncludeAWDL">kDNSServiceFlagsIncludeAWDL</a>))</td></tr>
<tr><th id="561">561</th><td>        <a class="local col8 ref" href="#88artype" title='artype' data-ref="88artype" data-ref-filename="88artype">artype</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecordAnyIncludeAWDL" title='AuthRecordAnyIncludeAWDL' data-ref="AuthRecordAnyIncludeAWDL" data-ref-filename="AuthRecordAnyIncludeAWDL">AuthRecordAnyIncludeAWDL</a>;</td></tr>
<tr><th id="562">562</th><td>    <b>else</b></td></tr>
<tr><th id="563">563</th><td>        <a class="local col8 ref" href="#88artype" title='artype' data-ref="88artype" data-ref-filename="88artype">artype</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecordAny" title='AuthRecordAny' data-ref="AuthRecordAny" data-ref-filename="AuthRecordAny">AuthRecordAny</a>;</td></tr>
<tr><th id="564">564</th><td></td></tr>
<tr><th id="565">565</th><td>    <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_SetupResourceRecord" title='mDNS_SetupResourceRecord' data-ref="mDNS_SetupResourceRecord" data-ref-filename="mDNS_SetupResourceRecord">mDNS_SetupResourceRecord</a>(<a class="local col6 ref" href="#86rr" title='rr' data-ref="86rr" data-ref-filename="86rr">rr</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>, <a class="local col7 ref" href="#87InterfaceID" title='InterfaceID' data-ref="87InterfaceID" data-ref-filename="87InterfaceID">InterfaceID</a>, <a class="local col0 ref" href="#80type" title='type' data-ref="80type" data-ref-filename="80type">type</a>, <var>0</var>,</td></tr>
<tr><th id="566">566</th><td>                             (<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu8" title='mDNSu8' data-type='unsigned char' data-ref="mDNSu8" data-ref-filename="mDNSu8">mDNSu8</a>) ((<a class="local col6 ref" href="#76flags" title='flags' data-ref="76flags" data-ref-filename="76flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsShared" title='kDNSServiceFlagsShared' data-ref="kDNSServiceFlagsShared" data-ref-filename="kDNSServiceFlagsShared">kDNSServiceFlagsShared</a>) ? <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSRecordTypeShared" title='kDNSRecordTypeShared' data-ref="kDNSRecordTypeShared" data-ref-filename="kDNSRecordTypeShared">kDNSRecordTypeShared</a> : <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSRecordTypeUnique" title='kDNSRecordTypeUnique' data-ref="kDNSRecordTypeUnique" data-ref-filename="kDNSRecordTypeUnique">kDNSRecordTypeUnique</a>), <a class="local col8 ref" href="#88artype" title='artype' data-ref="88artype" data-ref-filename="88artype">artype</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>);</td></tr>
<tr><th id="567">567</th><td></td></tr>
<tr><th id="568">568</th><td>    <b>if</b> (!<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#MakeDomainNameFromDNSNameString" title='MakeDomainNameFromDNSNameString' data-ref="MakeDomainNameFromDNSNameString" data-ref-filename="MakeDomainNameFromDNSNameString">MakeDomainNameFromDNSNameString</a>(&amp;<a class="local col6 ref" href="#86rr" title='rr' data-ref="86rr" data-ref-filename="86rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::namestorage" title='AuthRecord_struct::namestorage' data-ref="AuthRecord_struct::namestorage" data-ref-filename="AuthRecord_struct..namestorage">namestorage</a>, <a class="local col8 ref" href="#78name" title='name' data-ref="78name" data-ref-filename="78name">name</a>))</td></tr>
<tr><th id="569">569</th><td>    {</td></tr>
<tr><th id="570">570</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;ERROR: bad name: %s&quot;, name)" data-ref="_M/LogMsg">LogMsg</a>(<q>"ERROR: bad name: %s"</q>, <a class="local col8 ref" href="#78name" title='name' data-ref="78name" data-ref-filename="78name">name</a>);</td></tr>
<tr><th id="571">571</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(rr)" data-ref="_M/freeL">freeL</a>(<q>"AuthRecord/read_rr_from_ipc_msg"</q>, <a class="local col6 ref" href="#86rr" title='rr' data-ref="86rr" data-ref-filename="86rr">rr</a>);</td></tr>
<tr><th id="572">572</th><td>        <b>return</b> <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="573">573</th><td>    }</td></tr>
<tr><th id="574">574</th><td></td></tr>
<tr><th id="575">575</th><td>    <b>if</b> (<a class="local col6 ref" href="#76flags" title='flags' data-ref="76flags" data-ref-filename="76flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsAllowRemoteQuery" title='kDNSServiceFlagsAllowRemoteQuery' data-ref="kDNSServiceFlagsAllowRemoteQuery" data-ref-filename="kDNSServiceFlagsAllowRemoteQuery">kDNSServiceFlagsAllowRemoteQuery</a>) <a class="local col6 ref" href="#86rr" title='rr' data-ref="86rr" data-ref-filename="86rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::AllowRemoteQuery" title='AuthRecord_struct::AllowRemoteQuery' data-ref="AuthRecord_struct::AllowRemoteQuery" data-ref-filename="AuthRecord_struct..AllowRemoteQuery">AllowRemoteQuery</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>;</td></tr>
<tr><th id="576">576</th><td>    <a class="local col6 ref" href="#86rr" title='rr' data-ref="86rr" data-ref-filename="86rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rrclass" title='ResourceRecord_struct::rrclass' data-ref="ResourceRecord_struct::rrclass" data-ref-filename="ResourceRecord_struct..rrclass">rrclass</a> = <a class="local col1 ref" href="#81class" title='class' data-ref="81class" data-ref-filename="81class">class</a>;</td></tr>
<tr><th id="577">577</th><td>    <a class="local col6 ref" href="#86rr" title='rr' data-ref="86rr" data-ref-filename="86rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdlength" title='ResourceRecord_struct::rdlength' data-ref="ResourceRecord_struct::rdlength" data-ref-filename="ResourceRecord_struct..rdlength">rdlength</a> = <a class="local col2 ref" href="#82rdlen" title='rdlen' data-ref="82rdlen" data-ref-filename="82rdlen">rdlen</a>;</td></tr>
<tr><th id="578">578</th><td>    <a class="local col6 ref" href="#86rr" title='rr' data-ref="86rr" data-ref-filename="86rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdata" title='ResourceRecord_struct::rdata' data-ref="ResourceRecord_struct::rdata" data-ref-filename="ResourceRecord_struct..rdata">rdata</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::MaxRDLength" title='(anonymous struct)::MaxRDLength' data-ref="(anonymous)::MaxRDLength" data-ref-filename="(anonymous)..MaxRDLength">MaxRDLength</a> = <a class="local col2 ref" href="#82rdlen" title='rdlen' data-ref="82rdlen" data-ref-filename="82rdlen">rdlen</a>;</td></tr>
<tr><th id="579">579</th><td>    <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformMemCopy" title='mDNSPlatformMemCopy' data-ref="mDNSPlatformMemCopy" data-ref-filename="mDNSPlatformMemCopy">mDNSPlatformMemCopy</a>(<a class="local col6 ref" href="#86rr" title='rr' data-ref="86rr" data-ref-filename="86rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdata" title='ResourceRecord_struct::rdata' data-ref="ResourceRecord_struct::rdata" data-ref-filename="ResourceRecord_struct..rdata">rdata</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::u" title='(anonymous struct)::u' data-ref="(anonymous)::u" data-ref-filename="(anonymous)..u">u</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::data" title='(anonymous union)::data' data-ref="(anonymous)::data" data-ref-filename="(anonymous)..data">data</a>, <a class="local col3 ref" href="#83rdata" title='rdata' data-ref="83rdata" data-ref-filename="83rdata">rdata</a>, <a class="local col2 ref" href="#82rdlen" title='rdlen' data-ref="82rdlen" data-ref-filename="82rdlen">rdlen</a>);</td></tr>
<tr><th id="580">580</th><td>    <b>if</b> (<a class="local col4 ref" href="#74GetTTL" title='GetTTL' data-ref="74GetTTL" data-ref-filename="74GetTTL">GetTTL</a>) <a class="local col6 ref" href="#86rr" title='rr' data-ref="86rr" data-ref-filename="86rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rroriginalttl" title='ResourceRecord_struct::rroriginalttl' data-ref="ResourceRecord_struct::rroriginalttl" data-ref-filename="ResourceRecord_struct..rroriginalttl">rroriginalttl</a> = <a class="local col4 ref" href="#84ttl" title='ttl' data-ref="84ttl" data-ref-filename="84ttl">ttl</a>;</td></tr>
<tr><th id="581">581</th><td>    <a class="local col6 ref" href="#86rr" title='rr' data-ref="86rr" data-ref-filename="86rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::namehash" title='ResourceRecord_struct::namehash' data-ref="ResourceRecord_struct::namehash" data-ref-filename="ResourceRecord_struct..namehash">namehash</a> = <a class="ref fn" href="../mDNSCore/DNSCommon.h.html#DomainNameHashValue" title='DomainNameHashValue' data-ref="DomainNameHashValue" data-ref-filename="DomainNameHashValue">DomainNameHashValue</a>(<a class="local col6 ref" href="#86rr" title='rr' data-ref="86rr" data-ref-filename="86rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::name" title='ResourceRecord_struct::name' data-ref="ResourceRecord_struct::name" data-ref-filename="ResourceRecord_struct..name">name</a>);</td></tr>
<tr><th id="582">582</th><td>    <a class="ref fn" href="../mDNSCore/DNSCommon.h.html#SetNewRData" title='SetNewRData' data-ref="SetNewRData" data-ref-filename="SetNewRData">SetNewRData</a>(&amp;<a class="local col6 ref" href="#86rr" title='rr' data-ref="86rr" data-ref-filename="86rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>, <var>0</var>);  <i>// Sets rr-&gt;rdatahash for us</i></td></tr>
<tr><th id="583">583</th><td>    <b>return</b> <a class="local col6 ref" href="#86rr" title='rr' data-ref="86rr" data-ref-filename="86rr">rr</a>;</td></tr>
<tr><th id="584">584</th><td>}</td></tr>
<tr><th id="585">585</th><td></td></tr>
<tr><th id="586">586</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>int</em> <dfn class="decl def fn" id="build_domainname_from_strings" title='build_domainname_from_strings' data-ref="build_domainname_from_strings" data-ref-filename="build_domainname_from_strings">build_domainname_from_strings</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#domainname" title='domainname' data-type='struct domainname' data-ref="domainname" data-ref-filename="domainname">domainname</a> *<dfn class="local col9 decl" id="89srv" title='srv' data-type='domainname *' data-ref="89srv" data-ref-filename="89srv">srv</dfn>, <em>char</em> *<dfn class="local col0 decl" id="90name" title='name' data-type='char *' data-ref="90name" data-ref-filename="90name">name</dfn>, <em>char</em> *<dfn class="local col1 decl" id="91regtype" title='regtype' data-type='char *' data-ref="91regtype" data-ref-filename="91regtype">regtype</dfn>, <em>char</em> *<dfn class="local col2 decl" id="92domain" title='domain' data-type='char *' data-ref="92domain" data-ref-filename="92domain">domain</dfn>)</td></tr>
<tr><th id="587">587</th><td>{</td></tr>
<tr><th id="588">588</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#domainlabel" title='domainlabel' data-type='struct domainlabel' data-ref="domainlabel" data-ref-filename="domainlabel">domainlabel</a> <dfn class="local col3 decl" id="93n" title='n' data-type='domainlabel' data-ref="93n" data-ref-filename="93n">n</dfn>;</td></tr>
<tr><th id="589">589</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#domainname" title='domainname' data-type='struct domainname' data-ref="domainname" data-ref-filename="domainname">domainname</a> <dfn class="local col4 decl" id="94d" title='d' data-type='domainname' data-ref="94d" data-ref-filename="94d">d</dfn>, <dfn class="local col5 decl" id="95t" title='t' data-type='domainname' data-ref="95t" data-ref-filename="95t">t</dfn>;</td></tr>
<tr><th id="590">590</th><td></td></tr>
<tr><th id="591">591</th><td>    <b>if</b> (!<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#MakeDomainLabelFromLiteralString" title='MakeDomainLabelFromLiteralString' data-ref="MakeDomainLabelFromLiteralString" data-ref-filename="MakeDomainLabelFromLiteralString">MakeDomainLabelFromLiteralString</a>(&amp;<a class="local col3 ref" href="#93n" title='n' data-ref="93n" data-ref-filename="93n">n</a>, <a class="local col0 ref" href="#90name" title='name' data-ref="90name" data-ref-filename="90name">name</a>)) <b>return</b> -<var>1</var>;</td></tr>
<tr><th id="592">592</th><td>    <b>if</b> (!<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#MakeDomainNameFromDNSNameString" title='MakeDomainNameFromDNSNameString' data-ref="MakeDomainNameFromDNSNameString" data-ref-filename="MakeDomainNameFromDNSNameString">MakeDomainNameFromDNSNameString</a>(&amp;<a class="local col5 ref" href="#95t" title='t' data-ref="95t" data-ref-filename="95t">t</a>, <a class="local col1 ref" href="#91regtype" title='regtype' data-ref="91regtype" data-ref-filename="91regtype">regtype</a>)) <b>return</b> -<var>1</var>;</td></tr>
<tr><th id="593">593</th><td>    <b>if</b> (!<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#MakeDomainNameFromDNSNameString" title='MakeDomainNameFromDNSNameString' data-ref="MakeDomainNameFromDNSNameString" data-ref-filename="MakeDomainNameFromDNSNameString">MakeDomainNameFromDNSNameString</a>(&amp;<a class="local col4 ref" href="#94d" title='d' data-ref="94d" data-ref-filename="94d">d</a>, <a class="local col2 ref" href="#92domain" title='domain' data-ref="92domain" data-ref-filename="92domain">domain</a>)) <b>return</b> -<var>1</var>;</td></tr>
<tr><th id="594">594</th><td>    <b>if</b> (!<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ConstructServiceName" title='ConstructServiceName' data-ref="ConstructServiceName" data-ref-filename="ConstructServiceName">ConstructServiceName</a>(<a class="local col9 ref" href="#89srv" title='srv' data-ref="89srv" data-ref-filename="89srv">srv</a>, &amp;<a class="local col3 ref" href="#93n" title='n' data-ref="93n" data-ref-filename="93n">n</a>, &amp;<a class="local col5 ref" href="#95t" title='t' data-ref="95t" data-ref-filename="95t">t</a>, &amp;<a class="local col4 ref" href="#94d" title='d' data-ref="94d" data-ref-filename="94d">d</a>)) <b>return</b> -<var>1</var>;</td></tr>
<tr><th id="595">595</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="596">596</th><td>}</td></tr>
<tr><th id="597">597</th><td></td></tr>
<tr><th id="598">598</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="send_all" title='send_all' data-ref="send_all" data-ref-filename="send_all">send_all</dfn>(<a class="typedef" href="dns_sd.h.html#dnssd_sock_t" title='dnssd_sock_t' data-type='int' data-ref="dnssd_sock_t" data-ref-filename="dnssd_sock_t">dnssd_sock_t</a> <dfn class="local col6 decl" id="96s" title='s' data-type='dnssd_sock_t' data-ref="96s" data-ref-filename="96s">s</dfn>, <em>const</em> <em>char</em> *<dfn class="local col7 decl" id="97ptr" title='ptr' data-type='const char *' data-ref="97ptr" data-ref-filename="97ptr">ptr</dfn>, <em>int</em> <dfn class="local col8 decl" id="98len" title='len' data-type='int' data-ref="98len" data-ref-filename="98len">len</dfn>)</td></tr>
<tr><th id="599">599</th><td>{</td></tr>
<tr><th id="600">600</th><td>    <em>int</em> <dfn class="local col9 decl" id="99n" title='n' data-type='int' data-ref="99n" data-ref-filename="99n">n</dfn> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#send" title='send' data-ref="send" data-ref-filename="send">send</a>(<a class="local col6 ref" href="#96s" title='s' data-ref="96s" data-ref-filename="96s">s</a>, <a class="local col7 ref" href="#97ptr" title='ptr' data-ref="97ptr" data-ref-filename="97ptr">ptr</a>, <a class="local col8 ref" href="#98len" title='len' data-ref="98len" data-ref-filename="98len">len</a>, <var>0</var>);</td></tr>
<tr><th id="601">601</th><td>    <i>// On a freshly-created Unix Domain Socket, the kernel should *never* fail to buffer a small write for us</i></td></tr>
<tr><th id="602">602</th><td><i>    // (four bytes for a typical error code return, 12 bytes for DNSServiceGetProperty(DaemonVersion)).</i></td></tr>
<tr><th id="603">603</th><td><i>    // If it does fail, we don't attempt to handle this failure, but we do log it so we know something is wrong.</i></td></tr>
<tr><th id="604">604</th><td>    <b>if</b> (<a class="local col9 ref" href="#99n" title='n' data-ref="99n" data-ref-filename="99n">n</a> &lt; <a class="local col8 ref" href="#98len" title='len' data-ref="98len" data-ref-filename="98len">len</a>)</td></tr>
<tr><th id="605">605</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;ERROR: send_all(%d) wrote %d of %d errno %d (%s)&quot;, s, n, len, (*__errno()), strerror((*__errno())))" data-ref="_M/LogMsg">LogMsg</a>(<q>"ERROR: send_all(%d) wrote %d of %d errno %d (%s)"</q>,</td></tr>
<tr><th id="606">606</th><td>               <a class="local col6 ref" href="#96s" title='s' data-ref="96s" data-ref-filename="96s">s</a>, <a class="local col9 ref" href="#99n" title='n' data-ref="99n" data-ref-filename="99n">n</a>, <a class="local col8 ref" href="#98len" title='len' data-ref="98len" data-ref-filename="98len">len</a>, <a class="macro" href="dnssd_ipc.h.html#71" title="(*__errno())" data-ref="_M/dnssd_errno">dnssd_errno</a>, <a class="macro" href="dnssd_ipc.h.html#72" title="strerror((*__errno()))" data-ref="_M/dnssd_strerror">dnssd_strerror</a>(<a class="macro" href="dnssd_ipc.h.html#71" title="(*__errno())" data-ref="_M/dnssd_errno">dnssd_errno</a>));</td></tr>
<tr><th id="607">607</th><td>}</td></tr>
<tr><th id="608">608</th><td></td></tr>
<tr><th id="609">609</th><td><u>#<span data-ppcond="609">if</span> 0</u></td></tr>
<tr><th id="610">610</th><td>mDNSlocal mDNSBool AuthorizedDomain(<em>const</em> request_state * <em>const</em> request, <em>const</em> domainname * <em>const</em> d, <em>const</em> DNameListElem * <em>const</em> doms)</td></tr>
<tr><th id="611">611</th><td>{</td></tr>
<tr><th id="612">612</th><td>    <em>const</em> DNameListElem   *delem = mDNSNULL;</td></tr>
<tr><th id="613">613</th><td>    <em>int</em> bestDelta   = -<var>1</var>;                           <i>// the delta of the best match, lower is better</i></td></tr>
<tr><th id="614">614</th><td>    <em>int</em> dLabels     = <var>0</var>;</td></tr>
<tr><th id="615">615</th><td>    mDNSBool allow       = mDNSfalse;</td></tr>
<tr><th id="616">616</th><td></td></tr>
<tr><th id="617">617</th><td>    <b>if</b> (SystemUID(request-&gt;uid)) <b>return</b> mDNStrue;</td></tr>
<tr><th id="618">618</th><td></td></tr>
<tr><th id="619">619</th><td>    dLabels = CountLabels(d);</td></tr>
<tr><th id="620">620</th><td>    <b>for</b> (delem = doms; delem; delem = delem-&gt;next)</td></tr>
<tr><th id="621">621</th><td>    {</td></tr>
<tr><th id="622">622</th><td>        <b>if</b> (delem-&gt;uid)</td></tr>
<tr><th id="623">623</th><td>        {</td></tr>
<tr><th id="624">624</th><td>            <em>int</em> delemLabels = CountLabels(&amp;delem-&gt;name);</td></tr>
<tr><th id="625">625</th><td>            <em>int</em> delta       = dLabels - delemLabels;</td></tr>
<tr><th id="626">626</th><td>            <b>if</b> ((bestDelta == -<var>1</var> || delta &lt;= bestDelta) &amp;&amp; SameDomainName(&amp;delem-&gt;name, SkipLeadingLabels(d, delta)))</td></tr>
<tr><th id="627">627</th><td>            {</td></tr>
<tr><th id="628">628</th><td>                bestDelta = delta;</td></tr>
<tr><th id="629">629</th><td>                allow = (allow || (delem-&gt;uid == request-&gt;uid));</td></tr>
<tr><th id="630">630</th><td>            }</td></tr>
<tr><th id="631">631</th><td>        }</td></tr>
<tr><th id="632">632</th><td>    }</td></tr>
<tr><th id="633">633</th><td></td></tr>
<tr><th id="634">634</th><td>    <b>return</b> bestDelta == -<var>1</var> ? mDNStrue : allow;</td></tr>
<tr><th id="635">635</th><td>}</td></tr>
<tr><th id="636">636</th><td><u>#<span data-ppcond="609">endif</span></u></td></tr>
<tr><th id="637">637</th><td></td></tr>
<tr><th id="638">638</th><td><i>// ***************************************************************************</i></td></tr>
<tr><th id="639">639</th><td><u>#<span data-ppcond="639">if</span> COMPILER_LIKES_PRAGMA_MARK</u></td></tr>
<tr><th id="640">640</th><td><u>#pragma mark -</u></td></tr>
<tr><th id="641">641</th><td><u>#pragma mark - external helpers</u></td></tr>
<tr><th id="642">642</th><td><u>#<span data-ppcond="639">endif</span></u></td></tr>
<tr><th id="643">643</th><td></td></tr>
<tr><th id="644">644</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#116" title="" data-ref="_M/mDNSexport">mDNSexport</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSBool" title='mDNSBool' data-type='unsigned char' data-ref="mDNSBool" data-ref-filename="mDNSBool">mDNSBool</a> <dfn class="decl def fn" id="callExternalHelpers" title='callExternalHelpers' data-ref="callExternalHelpers" data-ref-filename="callExternalHelpers">callExternalHelpers</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterfaceID" title='mDNSInterfaceID' data-type='struct mDNSInterfaceID_dummystruct *' data-ref="mDNSInterfaceID" data-ref-filename="mDNSInterfaceID">mDNSInterfaceID</a> <dfn class="local col0 decl" id="100InterfaceID" title='InterfaceID' data-type='mDNSInterfaceID' data-ref="100InterfaceID" data-ref-filename="100InterfaceID">InterfaceID</dfn>, <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#domainname" title='domainname' data-type='struct domainname' data-ref="domainname" data-ref-filename="domainname">domainname</a> *<em>const</em> <dfn class="local col1 decl" id="101domain" title='domain' data-type='const domainname *const' data-ref="101domain" data-ref-filename="101domain">domain</dfn>, <a class="typedef" href="dns_sd.h.html#DNSServiceFlags" title='DNSServiceFlags' data-type='uint32_t' data-ref="DNSServiceFlags" data-ref-filename="DNSServiceFlags">DNSServiceFlags</a> <dfn class="local col2 decl" id="102flags" title='flags' data-type='DNSServiceFlags' data-ref="102flags" data-ref-filename="102flags">flags</dfn>)</td></tr>
<tr><th id="645">645</th><td>{</td></tr>
<tr><th id="646">646</th><td><u>#<span data-ppcond="646">if</span> APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="647">647</th><td></td></tr>
<tr><th id="648">648</th><td>    <i>// Only call D2D layer routines if request applies to a D2D interface and the domain is "local".</i></td></tr>
<tr><th id="649">649</th><td>    <b>if</b> (    (((InterfaceID == mDNSInterface_Any) &amp;&amp; (flags &amp; (kDNSServiceFlagsIncludeP2P | kDNSServiceFlagsIncludeAWDL | kDNSServiceFlagsAutoTrigger)))</td></tr>
<tr><th id="650">650</th><td>            || mDNSPlatformInterfaceIsD2D(InterfaceID) || (InterfaceID == mDNSInterface_BLE))</td></tr>
<tr><th id="651">651</th><td>        &amp;&amp; IsLocalDomain(domain))</td></tr>
<tr><th id="652">652</th><td>    {</td></tr>
<tr><th id="653">653</th><td>        <b>return</b> mDNStrue;</td></tr>
<tr><th id="654">654</th><td>    }</td></tr>
<tr><th id="655">655</th><td>    <b>else</b></td></tr>
<tr><th id="656">656</th><td>        <b>return</b> mDNSfalse;</td></tr>
<tr><th id="657">657</th><td></td></tr>
<tr><th id="658">658</th><td><u>#<span data-ppcond="646">else</span></u></td></tr>
<tr><th id="659">659</th><td>    (<em>void</em>) <a class="local col0 ref" href="#100InterfaceID" title='InterfaceID' data-ref="100InterfaceID" data-ref-filename="100InterfaceID">InterfaceID</a>;</td></tr>
<tr><th id="660">660</th><td>    (<em>void</em>) <a class="local col1 ref" href="#101domain" title='domain' data-ref="101domain" data-ref-filename="101domain">domain</a>;</td></tr>
<tr><th id="661">661</th><td>    (<em>void</em>) <a class="local col2 ref" href="#102flags" title='flags' data-ref="102flags" data-ref-filename="102flags">flags</a>;</td></tr>
<tr><th id="662">662</th><td></td></tr>
<tr><th id="663">663</th><td>    <b>return</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>;</td></tr>
<tr><th id="664">664</th><td><u>#<span data-ppcond="646">endif</span>  // APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="665">665</th><td>}</td></tr>
<tr><th id="666">666</th><td></td></tr>
<tr><th id="667">667</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="external_start_advertising_helper" title='external_start_advertising_helper' data-ref="external_start_advertising_helper" data-ref-filename="external_start_advertising_helper">external_start_advertising_helper</dfn>(<a class="typedef" href="uds_daemon.h.html#service_instance" title='service_instance' data-type='struct service_instance' data-ref="service_instance" data-ref-filename="service_instance">service_instance</a> *<em>const</em> <dfn class="local col3 decl" id="103instance" title='instance' data-type='service_instance *const' data-ref="103instance" data-ref-filename="103instance">instance</dfn>)</td></tr>
<tr><th id="668">668</th><td>{</td></tr>
<tr><th id="669">669</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord" title='AuthRecord' data-type='struct AuthRecord_struct' data-ref="AuthRecord" data-ref-filename="AuthRecord">AuthRecord</a> *<dfn class="local col4 decl" id="104st" title='st' data-type='AuthRecord *' data-ref="104st" data-ref-filename="104st">st</dfn> = <a class="local col3 ref" href="#103instance" title='instance' data-ref="103instance" data-ref-filename="103instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::subtypes" title='service_instance::subtypes' data-ref="service_instance::subtypes" data-ref-filename="service_instance..subtypes">subtypes</a>;</td></tr>
<tr><th id="670">670</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord" title='ExtraResourceRecord' data-type='struct ExtraResourceRecord_struct' data-ref="ExtraResourceRecord" data-ref-filename="ExtraResourceRecord">ExtraResourceRecord</a> *<dfn class="local col5 decl" id="105e" title='e' data-type='ExtraResourceRecord *' data-ref="105e" data-ref-filename="105e">e</dfn>;</td></tr>
<tr><th id="671">671</th><td>    <em>int</em> <dfn class="local col6 decl" id="106i" title='i' data-type='int' data-ref="106i" data-ref-filename="106i">i</dfn>;</td></tr>
<tr><th id="672">672</th><td></td></tr>
<tr><th id="673">673</th><td>    <b>if</b> (<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2963" title="((instance-&gt;request-&gt;u.servicereg.port).NotAnInteger == 0)" data-ref="_M/mDNSIPPortIsZero">mDNSIPPortIsZero</a>(<a class="local col3 ref" href="#103instance" title='instance' data-ref="103instance" data-ref-filename="103instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::port" title='request_state::(anonymous union)::(anonymous struct)::port' data-ref="request_state::(anonymousunion)::(anonymous)::port" data-ref-filename="request_state..(anonymousunion)..(anonymous)..port">port</a>))</td></tr>
<tr><th id="674">674</th><td>    {</td></tr>
<tr><th id="675">675</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;external_start_advertising_helper: Not registering service with port number zero&quot;);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"external_start_advertising_helper: Not registering service with port number zero"</q>);</td></tr>
<tr><th id="676">676</th><td>        <b>return</b>;</td></tr>
<tr><th id="677">677</th><td>    }</td></tr>
<tr><th id="678">678</th><td></td></tr>
<tr><th id="679">679</th><td>    <b>if</b> (<a class="local col3 ref" href="#103instance" title='instance' data-ref="103instance" data-ref-filename="103instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::external_advertise" title='service_instance::external_advertise' data-ref="service_instance::external_advertise" data-ref-filename="service_instance..external_advertise">external_advertise</a>) <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;external_start_advertising_helper: external_advertise already set!&quot;)" data-ref="_M/LogMsg">LogMsg</a>(<q>"external_start_advertising_helper: external_advertise already set!"</q>);</td></tr>
<tr><th id="680">680</th><td></td></tr>
<tr><th id="681">681</th><td>    <b>for</b> ( <a class="local col6 ref" href="#106i" title='i' data-ref="106i" data-ref-filename="106i">i</a> = <var>0</var>; <a class="local col6 ref" href="#106i" title='i' data-ref="106i" data-ref-filename="106i">i</a> &lt; <a class="local col3 ref" href="#103instance" title='instance' data-ref="103instance" data-ref-filename="103instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::num_subtypes" title='request_state::(anonymous union)::(anonymous struct)::num_subtypes' data-ref="request_state::(anonymousunion)::(anonymous)::num_subtypes" data-ref-filename="request_state..(anonymousunion)..(anonymous)..num_subtypes">num_subtypes</a>; <a class="local col6 ref" href="#106i" title='i' data-ref="106i" data-ref-filename="106i">i</a>++)</td></tr>
<tr><th id="682">682</th><td>        <a class="macro" href="uds_daemon.h.html#266" title="(void)(&amp;st[i].resrec)" data-ref="_M/external_start_advertising_service">external_start_advertising_service</a>(&amp;<a class="local col4 ref" href="#104st" title='st' data-ref="104st" data-ref-filename="104st">st</a>[<a class="local col6 ref" href="#106i" title='i' data-ref="106i" data-ref-filename="106i">i</a>].<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>, instance-&gt;request-&gt;flags);</td></tr>
<tr><th id="683">683</th><td></td></tr>
<tr><th id="684">684</th><td>    <a class="macro" href="uds_daemon.h.html#266" title="(void)(&amp;instance-&gt;srs.RR_PTR.resrec)" data-ref="_M/external_start_advertising_service">external_start_advertising_service</a>(&amp;<a class="local col3 ref" href="#103instance" title='instance' data-ref="103instance" data-ref-filename="103instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_PTR" title='ServiceRecordSet_struct::RR_PTR' data-ref="ServiceRecordSet_struct::RR_PTR" data-ref-filename="ServiceRecordSet_struct..RR_PTR">RR_PTR</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>, instance-&gt;request-&gt;flags);</td></tr>
<tr><th id="685">685</th><td>    <a class="macro" href="uds_daemon.h.html#266" title="(void)(&amp;instance-&gt;srs.RR_SRV.resrec)" data-ref="_M/external_start_advertising_service">external_start_advertising_service</a>(&amp;<a class="local col3 ref" href="#103instance" title='instance' data-ref="103instance" data-ref-filename="103instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_SRV" title='ServiceRecordSet_struct::RR_SRV' data-ref="ServiceRecordSet_struct::RR_SRV" data-ref-filename="ServiceRecordSet_struct..RR_SRV">RR_SRV</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>, instance-&gt;request-&gt;flags);</td></tr>
<tr><th id="686">686</th><td></td></tr>
<tr><th id="687">687</th><td>    <a class="macro" href="uds_daemon.h.html#266" title="(void)(&amp;instance-&gt;srs.RR_TXT.resrec)" data-ref="_M/external_start_advertising_service">external_start_advertising_service</a>(&amp;<a class="local col3 ref" href="#103instance" title='instance' data-ref="103instance" data-ref-filename="103instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_TXT" title='ServiceRecordSet_struct::RR_TXT' data-ref="ServiceRecordSet_struct::RR_TXT" data-ref-filename="ServiceRecordSet_struct..RR_TXT">RR_TXT</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>, instance-&gt;request-&gt;flags);</td></tr>
<tr><th id="688">688</th><td></td></tr>
<tr><th id="689">689</th><td>    <b>for</b> (<a class="local col5 ref" href="#105e" title='e' data-ref="105e" data-ref-filename="105e">e</a> = <a class="local col3 ref" href="#103instance" title='instance' data-ref="103instance" data-ref-filename="103instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::Extras" title='ServiceRecordSet_struct::Extras' data-ref="ServiceRecordSet_struct::Extras" data-ref-filename="ServiceRecordSet_struct..Extras">Extras</a>; <a class="local col5 ref" href="#105e" title='e' data-ref="105e" data-ref-filename="105e">e</a>; <a class="local col5 ref" href="#105e" title='e' data-ref="105e" data-ref-filename="105e">e</a> = <a class="local col5 ref" href="#105e" title='e' data-ref="105e" data-ref-filename="105e">e</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord_struct::next" title='ExtraResourceRecord_struct::next' data-ref="ExtraResourceRecord_struct::next" data-ref-filename="ExtraResourceRecord_struct..next">next</a>)</td></tr>
<tr><th id="690">690</th><td>        <a class="macro" href="uds_daemon.h.html#266" title="(void)(&amp;e-&gt;r.resrec)" data-ref="_M/external_start_advertising_service">external_start_advertising_service</a>(&amp;<a class="local col5 ref" href="#105e" title='e' data-ref="105e" data-ref-filename="105e">e</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord_struct::r" title='ExtraResourceRecord_struct::r' data-ref="ExtraResourceRecord_struct::r" data-ref-filename="ExtraResourceRecord_struct..r">r</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>, instance-&gt;request-&gt;flags);</td></tr>
<tr><th id="691">691</th><td></td></tr>
<tr><th id="692">692</th><td>    <a class="local col3 ref" href="#103instance" title='instance' data-ref="103instance" data-ref-filename="103instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::external_advertise" title='service_instance::external_advertise' data-ref="service_instance::external_advertise" data-ref-filename="service_instance..external_advertise">external_advertise</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>;</td></tr>
<tr><th id="693">693</th><td>}</td></tr>
<tr><th id="694">694</th><td></td></tr>
<tr><th id="695">695</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="external_stop_advertising_helper" title='external_stop_advertising_helper' data-ref="external_stop_advertising_helper" data-ref-filename="external_stop_advertising_helper">external_stop_advertising_helper</dfn>(<a class="typedef" href="uds_daemon.h.html#service_instance" title='service_instance' data-type='struct service_instance' data-ref="service_instance" data-ref-filename="service_instance">service_instance</a> *<em>const</em> <dfn class="local col7 decl" id="107instance" title='instance' data-type='service_instance *const' data-ref="107instance" data-ref-filename="107instance">instance</dfn>)</td></tr>
<tr><th id="696">696</th><td>{</td></tr>
<tr><th id="697">697</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord" title='AuthRecord' data-type='struct AuthRecord_struct' data-ref="AuthRecord" data-ref-filename="AuthRecord">AuthRecord</a> *<dfn class="local col8 decl" id="108st" title='st' data-type='AuthRecord *' data-ref="108st" data-ref-filename="108st">st</dfn> = <a class="local col7 ref" href="#107instance" title='instance' data-ref="107instance" data-ref-filename="107instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::subtypes" title='service_instance::subtypes' data-ref="service_instance::subtypes" data-ref-filename="service_instance..subtypes">subtypes</a>;</td></tr>
<tr><th id="698">698</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord" title='ExtraResourceRecord' data-type='struct ExtraResourceRecord_struct' data-ref="ExtraResourceRecord" data-ref-filename="ExtraResourceRecord">ExtraResourceRecord</a> *<dfn class="local col9 decl" id="109e" title='e' data-type='ExtraResourceRecord *' data-ref="109e" data-ref-filename="109e">e</dfn>;</td></tr>
<tr><th id="699">699</th><td>    <em>int</em> <dfn class="local col0 decl" id="110i" title='i' data-type='int' data-ref="110i" data-ref-filename="110i">i</dfn>;</td></tr>
<tr><th id="700">700</th><td></td></tr>
<tr><th id="701">701</th><td>    <b>if</b> (!<a class="local col7 ref" href="#107instance" title='instance' data-ref="107instance" data-ref-filename="107instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::external_advertise" title='service_instance::external_advertise' data-ref="service_instance::external_advertise" data-ref-filename="service_instance..external_advertise">external_advertise</a>) <b>return</b>;</td></tr>
<tr><th id="702">702</th><td></td></tr>
<tr><th id="703">703</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;external_stop_advertising_helper: calling external_stop_advertising_service&quot;);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"external_stop_advertising_helper: calling external_stop_advertising_service"</q>);</td></tr>
<tr><th id="704">704</th><td></td></tr>
<tr><th id="705">705</th><td>    <b>for</b> ( <a class="local col0 ref" href="#110i" title='i' data-ref="110i" data-ref-filename="110i">i</a> = <var>0</var>; <a class="local col0 ref" href="#110i" title='i' data-ref="110i" data-ref-filename="110i">i</a> &lt; <a class="local col7 ref" href="#107instance" title='instance' data-ref="107instance" data-ref-filename="107instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::num_subtypes" title='request_state::(anonymous union)::(anonymous struct)::num_subtypes' data-ref="request_state::(anonymousunion)::(anonymous)::num_subtypes" data-ref-filename="request_state..(anonymousunion)..(anonymous)..num_subtypes">num_subtypes</a>; <a class="local col0 ref" href="#110i" title='i' data-ref="110i" data-ref-filename="110i">i</a>++)</td></tr>
<tr><th id="706">706</th><td>        <a class="macro" href="uds_daemon.h.html#267" title="do { (void)(&amp;st[i].resrec); (void)(instance-&gt;request-&gt;flags); } while (0)" data-ref="_M/external_stop_advertising_service">external_stop_advertising_service</a>(&amp;<a class="local col8 ref" href="#108st" title='st' data-ref="108st" data-ref-filename="108st">st</a>[<a class="local col0 ref" href="#110i" title='i' data-ref="110i" data-ref-filename="110i">i</a>].<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>, <a class="local col7 ref" href="#107instance" title='instance' data-ref="107instance" data-ref-filename="107instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a>);</td></tr>
<tr><th id="707">707</th><td></td></tr>
<tr><th id="708">708</th><td>    <a class="macro" href="uds_daemon.h.html#267" title="do { (void)(&amp;instance-&gt;srs.RR_PTR.resrec); (void)(instance-&gt;request-&gt;flags); } while (0)" data-ref="_M/external_stop_advertising_service">external_stop_advertising_service</a>(&amp;<a class="local col7 ref" href="#107instance" title='instance' data-ref="107instance" data-ref-filename="107instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_PTR" title='ServiceRecordSet_struct::RR_PTR' data-ref="ServiceRecordSet_struct::RR_PTR" data-ref-filename="ServiceRecordSet_struct..RR_PTR">RR_PTR</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>, <a class="local col7 ref" href="#107instance" title='instance' data-ref="107instance" data-ref-filename="107instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a>);</td></tr>
<tr><th id="709">709</th><td>    <a class="macro" href="uds_daemon.h.html#267" title="do { (void)(&amp;instance-&gt;srs.RR_SRV.resrec); (void)(instance-&gt;request-&gt;flags); } while (0)" data-ref="_M/external_stop_advertising_service">external_stop_advertising_service</a>(&amp;<a class="local col7 ref" href="#107instance" title='instance' data-ref="107instance" data-ref-filename="107instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_SRV" title='ServiceRecordSet_struct::RR_SRV' data-ref="ServiceRecordSet_struct::RR_SRV" data-ref-filename="ServiceRecordSet_struct..RR_SRV">RR_SRV</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>, <a class="local col7 ref" href="#107instance" title='instance' data-ref="107instance" data-ref-filename="107instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a>);</td></tr>
<tr><th id="710">710</th><td>    <a class="macro" href="uds_daemon.h.html#267" title="do { (void)(&amp;instance-&gt;srs.RR_TXT.resrec); (void)(instance-&gt;request-&gt;flags); } while (0)" data-ref="_M/external_stop_advertising_service">external_stop_advertising_service</a>(&amp;<a class="local col7 ref" href="#107instance" title='instance' data-ref="107instance" data-ref-filename="107instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_TXT" title='ServiceRecordSet_struct::RR_TXT' data-ref="ServiceRecordSet_struct::RR_TXT" data-ref-filename="ServiceRecordSet_struct..RR_TXT">RR_TXT</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>, <a class="local col7 ref" href="#107instance" title='instance' data-ref="107instance" data-ref-filename="107instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a>);</td></tr>
<tr><th id="711">711</th><td></td></tr>
<tr><th id="712">712</th><td>    <b>for</b> (<a class="local col9 ref" href="#109e" title='e' data-ref="109e" data-ref-filename="109e">e</a> = <a class="local col7 ref" href="#107instance" title='instance' data-ref="107instance" data-ref-filename="107instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::Extras" title='ServiceRecordSet_struct::Extras' data-ref="ServiceRecordSet_struct::Extras" data-ref-filename="ServiceRecordSet_struct..Extras">Extras</a>; <a class="local col9 ref" href="#109e" title='e' data-ref="109e" data-ref-filename="109e">e</a>; <a class="local col9 ref" href="#109e" title='e' data-ref="109e" data-ref-filename="109e">e</a> = <a class="local col9 ref" href="#109e" title='e' data-ref="109e" data-ref-filename="109e">e</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord_struct::next" title='ExtraResourceRecord_struct::next' data-ref="ExtraResourceRecord_struct::next" data-ref-filename="ExtraResourceRecord_struct..next">next</a>)</td></tr>
<tr><th id="713">713</th><td>        <a class="macro" href="uds_daemon.h.html#267" title="do { (void)(&amp;e-&gt;r.resrec); (void)(instance-&gt;request-&gt;flags); } while (0)" data-ref="_M/external_stop_advertising_service">external_stop_advertising_service</a>(&amp;<a class="local col9 ref" href="#109e" title='e' data-ref="109e" data-ref-filename="109e">e</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord_struct::r" title='ExtraResourceRecord_struct::r' data-ref="ExtraResourceRecord_struct::r" data-ref-filename="ExtraResourceRecord_struct..r">r</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>, <a class="local col7 ref" href="#107instance" title='instance' data-ref="107instance" data-ref-filename="107instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a>);</td></tr>
<tr><th id="714">714</th><td></td></tr>
<tr><th id="715">715</th><td>    <a class="local col7 ref" href="#107instance" title='instance' data-ref="107instance" data-ref-filename="107instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::external_advertise" title='service_instance::external_advertise' data-ref="service_instance::external_advertise" data-ref-filename="service_instance..external_advertise">external_advertise</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>;</td></tr>
<tr><th id="716">716</th><td>}</td></tr>
<tr><th id="717">717</th><td></td></tr>
<tr><th id="718">718</th><td><i>// ***************************************************************************</i></td></tr>
<tr><th id="719">719</th><td><u>#<span data-ppcond="719">if</span> COMPILER_LIKES_PRAGMA_MARK</u></td></tr>
<tr><th id="720">720</th><td><u>#pragma mark -</u></td></tr>
<tr><th id="721">721</th><td><u>#pragma mark - DNSServiceRegister</u></td></tr>
<tr><th id="722">722</th><td><u>#<span data-ppcond="719">endif</span></u></td></tr>
<tr><th id="723">723</th><td></td></tr>
<tr><th id="724">724</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#116" title="" data-ref="_M/mDNSexport">mDNSexport</a> <em>void</em> <dfn class="decl def fn" id="FreeExtraRR" title='FreeExtraRR' data-ref="FreeExtraRR" data-ref-filename="FreeExtraRR">FreeExtraRR</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS" title='mDNS' data-type='struct mDNS_struct' data-ref="mDNS" data-ref-filename="mDNS">mDNS</a> *<em>const</em> <dfn class="local col1 decl" id="111m" title='m' data-type='mDNS *const' data-ref="111m" data-ref-filename="111m">m</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord" title='AuthRecord' data-type='struct AuthRecord_struct' data-ref="AuthRecord" data-ref-filename="AuthRecord">AuthRecord</a> *<em>const</em> <dfn class="local col2 decl" id="112rr" title='rr' data-type='AuthRecord *const' data-ref="112rr" data-ref-filename="112rr">rr</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="local col3 decl" id="113result" title='result' data-type='mStatus' data-ref="113result" data-ref-filename="113result">result</dfn>)</td></tr>
<tr><th id="725">725</th><td>{</td></tr>
<tr><th id="726">726</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord" title='ExtraResourceRecord' data-type='struct ExtraResourceRecord_struct' data-ref="ExtraResourceRecord" data-ref-filename="ExtraResourceRecord">ExtraResourceRecord</a> *<dfn class="local col4 decl" id="114extra" title='extra' data-type='ExtraResourceRecord *' data-ref="114extra" data-ref-filename="114extra">extra</dfn> = (<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord" title='ExtraResourceRecord' data-type='struct ExtraResourceRecord_struct' data-ref="ExtraResourceRecord" data-ref-filename="ExtraResourceRecord">ExtraResourceRecord</a> *)<a class="local col2 ref" href="#112rr" title='rr' data-ref="112rr" data-ref-filename="112rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::RecordContext" title='AuthRecord_struct::RecordContext' data-ref="AuthRecord_struct::RecordContext" data-ref-filename="AuthRecord_struct..RecordContext">RecordContext</a>;</td></tr>
<tr><th id="727">727</th><td>    (<em>void</em>)<a class="local col1 ref" href="#111m" title='m' data-ref="111m" data-ref-filename="111m">m</a>;  <i>// Unused</i></td></tr>
<tr><th id="728">728</th><td></td></tr>
<tr><th id="729">729</th><td>    <b>if</b> (<a class="local col3 ref" href="#113result" title='result' data-ref="113result" data-ref-filename="113result">result</a> != <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_MemFree" title='mStatus_MemFree' data-ref="mStatus_MemFree" data-ref-filename="mStatus_MemFree">mStatus_MemFree</a>) { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;Error: FreeExtraRR invoked with unexpected error %d&quot;, result)" data-ref="_M/LogMsg">LogMsg</a>(<q>"Error: FreeExtraRR invoked with unexpected error %d"</q>, <a class="local col3 ref" href="#113result" title='result' data-ref="113result" data-ref-filename="113result">result</a>); <b>return</b>; }</td></tr>
<tr><th id="730">730</th><td></td></tr>
<tr><th id="731">731</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;     FreeExtraRR %s&quot;, GetRRDisplayString_rdb(&amp;rr-&gt;resrec, &amp;(&amp;rr-&gt;resrec)-&gt;rdata-&gt;u, (m)-&gt;MsgBuffer));} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"     FreeExtraRR %s"</q>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2941" title="GetRRDisplayString_rdb(&amp;rr-&gt;resrec, &amp;(&amp;rr-&gt;resrec)-&gt;rdata-&gt;u, (m)-&gt;MsgBuffer)" data-ref="_M/RRDisplayString">RRDisplayString</a>(<a class="local col1 ref" href="#111m" title='m' data-ref="111m" data-ref-filename="111m">m</a>, &amp;<a class="local col2 ref" href="#112rr" title='rr' data-ref="112rr" data-ref-filename="112rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>));</td></tr>
<tr><th id="732">732</th><td></td></tr>
<tr><th id="733">733</th><td>    <b>if</b> (<a class="local col2 ref" href="#112rr" title='rr' data-ref="112rr" data-ref-filename="112rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdata" title='ResourceRecord_struct::rdata' data-ref="ResourceRecord_struct::rdata" data-ref-filename="ResourceRecord_struct..rdata">rdata</a> != &amp;<a class="local col2 ref" href="#112rr" title='rr' data-ref="112rr" data-ref-filename="112rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::rdatastorage" title='AuthRecord_struct::rdatastorage' data-ref="AuthRecord_struct::rdatastorage" data-ref-filename="AuthRecord_struct..rdatastorage">rdatastorage</a>)</td></tr>
<tr><th id="734">734</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(rr-&gt;resrec.rdata)" data-ref="_M/freeL">freeL</a>(<q>"Extra RData"</q>, <a class="local col2 ref" href="#112rr" title='rr' data-ref="112rr" data-ref-filename="112rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdata" title='ResourceRecord_struct::rdata' data-ref="ResourceRecord_struct::rdata" data-ref-filename="ResourceRecord_struct..rdata">rdata</a>);</td></tr>
<tr><th id="735">735</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(extra)" data-ref="_M/freeL">freeL</a>(<q>"ExtraResourceRecord/FreeExtraRR"</q>, <a class="local col4 ref" href="#114extra" title='extra' data-ref="114extra" data-ref-filename="114extra">extra</a>);</td></tr>
<tr><th id="736">736</th><td>}</td></tr>
<tr><th id="737">737</th><td></td></tr>
<tr><th id="738">738</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="unlink_and_free_service_instance" title='unlink_and_free_service_instance' data-ref="unlink_and_free_service_instance" data-ref-filename="unlink_and_free_service_instance">unlink_and_free_service_instance</dfn>(<a class="typedef" href="uds_daemon.h.html#service_instance" title='service_instance' data-type='struct service_instance' data-ref="service_instance" data-ref-filename="service_instance">service_instance</a> *<dfn class="local col5 decl" id="115srv" title='srv' data-type='service_instance *' data-ref="115srv" data-ref-filename="115srv">srv</dfn>)</td></tr>
<tr><th id="739">739</th><td>{</td></tr>
<tr><th id="740">740</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord" title='ExtraResourceRecord' data-type='struct ExtraResourceRecord_struct' data-ref="ExtraResourceRecord" data-ref-filename="ExtraResourceRecord">ExtraResourceRecord</a> *<dfn class="local col6 decl" id="116e" title='e' data-type='ExtraResourceRecord *' data-ref="116e" data-ref-filename="116e">e</dfn> = <a class="local col5 ref" href="#115srv" title='srv' data-ref="115srv" data-ref-filename="115srv">srv</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::Extras" title='ServiceRecordSet_struct::Extras' data-ref="ServiceRecordSet_struct::Extras" data-ref-filename="ServiceRecordSet_struct..Extras">Extras</a>, *<dfn class="local col7 decl" id="117tmp" title='tmp' data-type='ExtraResourceRecord *' data-ref="117tmp" data-ref-filename="117tmp">tmp</dfn>;</td></tr>
<tr><th id="741">741</th><td></td></tr>
<tr><th id="742">742</th><td>    <a class="ref fn" href="#external_stop_advertising_helper" title='external_stop_advertising_helper' data-ref="external_stop_advertising_helper" data-ref-filename="external_stop_advertising_helper">external_stop_advertising_helper</a>(<a class="local col5 ref" href="#115srv" title='srv' data-ref="115srv" data-ref-filename="115srv">srv</a>);</td></tr>
<tr><th id="743">743</th><td></td></tr>
<tr><th id="744">744</th><td>    <i>// clear pointers from parent struct</i></td></tr>
<tr><th id="745">745</th><td>    <b>if</b> (<a class="local col5 ref" href="#115srv" title='srv' data-ref="115srv" data-ref-filename="115srv">srv</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>)</td></tr>
<tr><th id="746">746</th><td>    {</td></tr>
<tr><th id="747">747</th><td>        <a class="typedef" href="uds_daemon.h.html#service_instance" title='service_instance' data-type='struct service_instance' data-ref="service_instance" data-ref-filename="service_instance">service_instance</a> **<dfn class="local col8 decl" id="118p" title='p' data-type='service_instance **' data-ref="118p" data-ref-filename="118p">p</dfn> = &amp;<a class="local col5 ref" href="#115srv" title='srv' data-ref="115srv" data-ref-filename="115srv">srv</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::instances" title='request_state::(anonymous union)::(anonymous struct)::instances' data-ref="request_state::(anonymousunion)::(anonymous)::instances" data-ref-filename="request_state..(anonymousunion)..(anonymous)..instances">instances</a>;</td></tr>
<tr><th id="748">748</th><td>        <b>while</b> (*<a class="local col8 ref" href="#118p" title='p' data-ref="118p" data-ref-filename="118p">p</a>)</td></tr>
<tr><th id="749">749</th><td>        {</td></tr>
<tr><th id="750">750</th><td>            <b>if</b> (*<a class="local col8 ref" href="#118p" title='p' data-ref="118p" data-ref-filename="118p">p</a> == <a class="local col5 ref" href="#115srv" title='srv' data-ref="115srv" data-ref-filename="115srv">srv</a>) { *<a class="local col8 ref" href="#118p" title='p' data-ref="118p" data-ref-filename="118p">p</a> = (*<a class="local col8 ref" href="#118p" title='p' data-ref="118p" data-ref-filename="118p">p</a>)-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::next" title='service_instance::next' data-ref="service_instance::next" data-ref-filename="service_instance..next">next</a>; <b>break</b>; }</td></tr>
<tr><th id="751">751</th><td>            <a class="local col8 ref" href="#118p" title='p' data-ref="118p" data-ref-filename="118p">p</a> = &amp;(*<a class="local col8 ref" href="#118p" title='p' data-ref="118p" data-ref-filename="118p">p</a>)-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::next" title='service_instance::next' data-ref="service_instance::next" data-ref-filename="service_instance..next">next</a>;</td></tr>
<tr><th id="752">752</th><td>        }</td></tr>
<tr><th id="753">753</th><td>    }</td></tr>
<tr><th id="754">754</th><td></td></tr>
<tr><th id="755">755</th><td>    <b>while</b> (<a class="local col6 ref" href="#116e" title='e' data-ref="116e" data-ref-filename="116e">e</a>)</td></tr>
<tr><th id="756">756</th><td>    {</td></tr>
<tr><th id="757">757</th><td>        <a class="local col6 ref" href="#116e" title='e' data-ref="116e" data-ref-filename="116e">e</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord_struct::r" title='ExtraResourceRecord_struct::r' data-ref="ExtraResourceRecord_struct::r" data-ref-filename="ExtraResourceRecord_struct..r">r</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::RecordContext" title='AuthRecord_struct::RecordContext' data-ref="AuthRecord_struct::RecordContext" data-ref-filename="AuthRecord_struct..RecordContext">RecordContext</a> = <a class="local col6 ref" href="#116e" title='e' data-ref="116e" data-ref-filename="116e">e</a>;</td></tr>
<tr><th id="758">758</th><td>        <a class="local col7 ref" href="#117tmp" title='tmp' data-ref="117tmp" data-ref-filename="117tmp">tmp</a> = <a class="local col6 ref" href="#116e" title='e' data-ref="116e" data-ref-filename="116e">e</a>;</td></tr>
<tr><th id="759">759</th><td>        <a class="local col6 ref" href="#116e" title='e' data-ref="116e" data-ref-filename="116e">e</a> = <a class="local col6 ref" href="#116e" title='e' data-ref="116e" data-ref-filename="116e">e</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord_struct::next" title='ExtraResourceRecord_struct::next' data-ref="ExtraResourceRecord_struct::next" data-ref-filename="ExtraResourceRecord_struct..next">next</a>;</td></tr>
<tr><th id="760">760</th><td>        <a class="ref fn" href="#FreeExtraRR" title='FreeExtraRR' data-ref="FreeExtraRR" data-ref-filename="FreeExtraRR">FreeExtraRR</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col7 ref" href="#117tmp" title='tmp' data-ref="117tmp" data-ref-filename="117tmp">tmp</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord_struct::r" title='ExtraResourceRecord_struct::r' data-ref="ExtraResourceRecord_struct::r" data-ref-filename="ExtraResourceRecord_struct..r">r</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_MemFree" title='mStatus_MemFree' data-ref="mStatus_MemFree" data-ref-filename="mStatus_MemFree">mStatus_MemFree</a>);</td></tr>
<tr><th id="761">761</th><td>    }</td></tr>
<tr><th id="762">762</th><td></td></tr>
<tr><th id="763">763</th><td>    <b>if</b> (<a class="local col5 ref" href="#115srv" title='srv' data-ref="115srv" data-ref-filename="115srv">srv</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_TXT" title='ServiceRecordSet_struct::RR_TXT' data-ref="ServiceRecordSet_struct::RR_TXT" data-ref-filename="ServiceRecordSet_struct..RR_TXT">RR_TXT</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdata" title='ResourceRecord_struct::rdata' data-ref="ResourceRecord_struct::rdata" data-ref-filename="ResourceRecord_struct..rdata">rdata</a> != &amp;<a class="local col5 ref" href="#115srv" title='srv' data-ref="115srv" data-ref-filename="115srv">srv</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_TXT" title='ServiceRecordSet_struct::RR_TXT' data-ref="ServiceRecordSet_struct::RR_TXT" data-ref-filename="ServiceRecordSet_struct..RR_TXT">RR_TXT</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::rdatastorage" title='AuthRecord_struct::rdatastorage' data-ref="AuthRecord_struct::rdatastorage" data-ref-filename="AuthRecord_struct..rdatastorage">rdatastorage</a>)</td></tr>
<tr><th id="764">764</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(srv-&gt;srs.RR_TXT.resrec.rdata)" data-ref="_M/freeL">freeL</a>(<q>"TXT RData"</q>, <a class="local col5 ref" href="#115srv" title='srv' data-ref="115srv" data-ref-filename="115srv">srv</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_TXT" title='ServiceRecordSet_struct::RR_TXT' data-ref="ServiceRecordSet_struct::RR_TXT" data-ref-filename="ServiceRecordSet_struct..RR_TXT">RR_TXT</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdata" title='ResourceRecord_struct::rdata' data-ref="ResourceRecord_struct::rdata" data-ref-filename="ResourceRecord_struct..rdata">rdata</a>);</td></tr>
<tr><th id="765">765</th><td></td></tr>
<tr><th id="766">766</th><td>    <b>if</b> (<a class="local col5 ref" href="#115srv" title='srv' data-ref="115srv" data-ref-filename="115srv">srv</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::subtypes" title='service_instance::subtypes' data-ref="service_instance::subtypes" data-ref-filename="service_instance..subtypes">subtypes</a>)</td></tr>
<tr><th id="767">767</th><td>    {</td></tr>
<tr><th id="768">768</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(srv-&gt;subtypes)" data-ref="_M/freeL">freeL</a>(<q>"ServiceSubTypes"</q>, <a class="local col5 ref" href="#115srv" title='srv' data-ref="115srv" data-ref-filename="115srv">srv</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::subtypes" title='service_instance::subtypes' data-ref="service_instance::subtypes" data-ref-filename="service_instance..subtypes">subtypes</a>);</td></tr>
<tr><th id="769">769</th><td>        <a class="local col5 ref" href="#115srv" title='srv' data-ref="115srv" data-ref-filename="115srv">srv</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::subtypes" title='service_instance::subtypes' data-ref="service_instance::subtypes" data-ref-filename="service_instance..subtypes">subtypes</a> = <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="770">770</th><td>    }</td></tr>
<tr><th id="771">771</th><td>    <b>if</b> (<a class="local col5 ref" href="#115srv" title='srv' data-ref="115srv" data-ref-filename="115srv">srv</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::AnonData" title='ServiceRecordSet_struct::AnonData' data-ref="ServiceRecordSet_struct::AnonData" data-ref-filename="ServiceRecordSet_struct..AnonData">AnonData</a>)</td></tr>
<tr><th id="772">772</th><td>    {</td></tr>
<tr><th id="773">773</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free((void *)srv-&gt;srs.AnonData)" data-ref="_M/freeL">freeL</a>(<q>"Anonymous"</q>, (<em>void</em> *)<a class="local col5 ref" href="#115srv" title='srv' data-ref="115srv" data-ref-filename="115srv">srv</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::AnonData" title='ServiceRecordSet_struct::AnonData' data-ref="ServiceRecordSet_struct::AnonData" data-ref-filename="ServiceRecordSet_struct..AnonData">AnonData</a>);</td></tr>
<tr><th id="774">774</th><td>        <a class="local col5 ref" href="#115srv" title='srv' data-ref="115srv" data-ref-filename="115srv">srv</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::AnonData" title='ServiceRecordSet_struct::AnonData' data-ref="ServiceRecordSet_struct::AnonData" data-ref-filename="ServiceRecordSet_struct..AnonData">AnonData</a> = <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="775">775</th><td>    }</td></tr>
<tr><th id="776">776</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(srv)" data-ref="_M/freeL">freeL</a>(<q>"service_instance"</q>, <a class="local col5 ref" href="#115srv" title='srv' data-ref="115srv" data-ref-filename="115srv">srv</a>);</td></tr>
<tr><th id="777">777</th><td>}</td></tr>
<tr><th id="778">778</th><td></td></tr>
<tr><th id="779">779</th><td><i>// Count how many other service records we have locally with the same name, but different rdata.</i></td></tr>
<tr><th id="780">780</th><td><i>// For auto-named services, we can have at most one per machine -- if we allowed two auto-named services of</i></td></tr>
<tr><th id="781">781</th><td><i>// the same type on the same machine, we'd get into an infinite autoimmune-response loop of continuous renaming.</i></td></tr>
<tr><th id="782">782</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#116" title="" data-ref="_M/mDNSexport">mDNSexport</a> <em>int</em> <dfn class="decl def fn" id="CountPeerRegistrations" title='CountPeerRegistrations' data-ref="CountPeerRegistrations" data-ref-filename="CountPeerRegistrations">CountPeerRegistrations</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet" title='ServiceRecordSet' data-type='struct ServiceRecordSet_struct' data-ref="ServiceRecordSet" data-ref-filename="ServiceRecordSet">ServiceRecordSet</a> *<em>const</em> <dfn class="local col9 decl" id="119srs" title='srs' data-type='ServiceRecordSet *const' data-ref="119srs" data-ref-filename="119srs">srs</dfn>)</td></tr>
<tr><th id="783">783</th><td>{</td></tr>
<tr><th id="784">784</th><td>    <em>int</em> <dfn class="local col0 decl" id="120count" title='count' data-type='int' data-ref="120count" data-ref-filename="120count">count</dfn> = <var>0</var>;</td></tr>
<tr><th id="785">785</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord" title='ResourceRecord' data-type='struct ResourceRecord_struct' data-ref="ResourceRecord" data-ref-filename="ResourceRecord">ResourceRecord</a> *<dfn class="local col1 decl" id="121r" title='r' data-type='ResourceRecord *' data-ref="121r" data-ref-filename="121r">r</dfn> = &amp;<a class="local col9 ref" href="#119srs" title='srs' data-ref="119srs" data-ref-filename="119srs">srs</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_SRV" title='ServiceRecordSet_struct::RR_SRV' data-ref="ServiceRecordSet_struct::RR_SRV" data-ref-filename="ServiceRecordSet_struct..RR_SRV">RR_SRV</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>;</td></tr>
<tr><th id="786">786</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord" title='AuthRecord' data-type='struct AuthRecord_struct' data-ref="AuthRecord" data-ref-filename="AuthRecord">AuthRecord</a> *<dfn class="local col2 decl" id="122rr" title='rr' data-type='AuthRecord *' data-ref="122rr" data-ref-filename="122rr">rr</dfn>;</td></tr>
<tr><th id="787">787</th><td></td></tr>
<tr><th id="788">788</th><td>    <b>for</b> (<a class="local col2 ref" href="#122rr" title='rr' data-ref="122rr" data-ref-filename="122rr">rr</a> = <a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::ResourceRecords" title='mDNS_struct::ResourceRecords' data-ref="mDNS_struct::ResourceRecords" data-ref-filename="mDNS_struct..ResourceRecords">ResourceRecords</a>; <a class="local col2 ref" href="#122rr" title='rr' data-ref="122rr" data-ref-filename="122rr">rr</a>; <a class="local col2 ref" href="#122rr" title='rr' data-ref="122rr" data-ref-filename="122rr">rr</a>=<a class="local col2 ref" href="#122rr" title='rr' data-ref="122rr" data-ref-filename="122rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::next" title='AuthRecord_struct::next' data-ref="AuthRecord_struct::next" data-ref-filename="AuthRecord_struct..next">next</a>)</td></tr>
<tr><th id="789">789</th><td>        <b>if</b> (<a class="local col2 ref" href="#122rr" title='rr' data-ref="122rr" data-ref-filename="122rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rrtype" title='ResourceRecord_struct::rrtype' data-ref="ResourceRecord_struct::rrtype" data-ref-filename="ResourceRecord_struct..rrtype">rrtype</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSType_SRV" title='kDNSType_SRV' data-ref="kDNSType_SRV" data-ref-filename="kDNSType_SRV">kDNSType_SRV</a> &amp;&amp; <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#SameDomainName" title='SameDomainName' data-ref="SameDomainName" data-ref-filename="SameDomainName">SameDomainName</a>(<a class="local col2 ref" href="#122rr" title='rr' data-ref="122rr" data-ref-filename="122rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::name" title='ResourceRecord_struct::name' data-ref="ResourceRecord_struct::name" data-ref-filename="ResourceRecord_struct..name">name</a>, <a class="local col1 ref" href="#121r" title='r' data-ref="121r" data-ref-filename="121r">r</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::name" title='ResourceRecord_struct::name' data-ref="ResourceRecord_struct::name" data-ref-filename="ResourceRecord_struct..name">name</a>) &amp;&amp; !<a class="macro" href="../mDNSCore/DNSCommon.h.html#155" title="( (&amp;rr-&gt;resrec)-&gt;rrtype == (r)-&gt;rrtype &amp;&amp; (&amp;rr-&gt;resrec)-&gt;rrclass == (r)-&gt;rrclass &amp;&amp; (&amp;rr-&gt;resrec)-&gt;rdlength == (r)-&gt;rdlength &amp;&amp; (&amp;rr-&gt;resrec)-&gt;rdatahash == (r)-&gt;rdatahash &amp;&amp; SameRDataBody((&amp;rr-&gt;resrec), &amp;(r)-&gt;rdata-&gt;u, SameDomainName))" data-ref="_M/IdenticalSameNameRecord">IdenticalSameNameRecord</a>(&amp;<a class="local col2 ref" href="#122rr" title='rr' data-ref="122rr" data-ref-filename="122rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>, <a class="local col1 ref" href="#121r" title='r' data-ref="121r" data-ref-filename="121r">r</a>))</td></tr>
<tr><th id="790">790</th><td>            <a class="local col0 ref" href="#120count" title='count' data-ref="120count" data-ref-filename="120count">count</a>++;</td></tr>
<tr><th id="791">791</th><td></td></tr>
<tr><th id="792">792</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#138" title="debug_noop" data-ref="_M/verbosedebugf">verbosedebugf</a>(<q>"%d peer registrations for %##s"</q>, count, r-&gt;name-&gt;c);</td></tr>
<tr><th id="793">793</th><td>    <b>return</b>(<a class="local col0 ref" href="#120count" title='count' data-ref="120count" data-ref-filename="120count">count</a>);</td></tr>
<tr><th id="794">794</th><td>}</td></tr>
<tr><th id="795">795</th><td></td></tr>
<tr><th id="796">796</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#116" title="" data-ref="_M/mDNSexport">mDNSexport</a> <em>int</em> <dfn class="decl def fn" id="CountExistingRegistrations" title='CountExistingRegistrations' data-ref="CountExistingRegistrations" data-ref-filename="CountExistingRegistrations">CountExistingRegistrations</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#domainname" title='domainname' data-type='struct domainname' data-ref="domainname" data-ref-filename="domainname">domainname</a> *<dfn class="local col3 decl" id="123srv" title='srv' data-type='domainname *' data-ref="123srv" data-ref-filename="123srv">srv</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSIPPort" title='mDNSIPPort' data-type='mDNSOpaque16' data-ref="mDNSIPPort" data-ref-filename="mDNSIPPort">mDNSIPPort</a> <dfn class="local col4 decl" id="124port" title='port' data-type='mDNSIPPort' data-ref="124port" data-ref-filename="124port">port</dfn>)</td></tr>
<tr><th id="797">797</th><td>{</td></tr>
<tr><th id="798">798</th><td>    <em>int</em> <dfn class="local col5 decl" id="125count" title='count' data-type='int' data-ref="125count" data-ref-filename="125count">count</dfn> = <var>0</var>;</td></tr>
<tr><th id="799">799</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord" title='AuthRecord' data-type='struct AuthRecord_struct' data-ref="AuthRecord" data-ref-filename="AuthRecord">AuthRecord</a> *<dfn class="local col6 decl" id="126rr" title='rr' data-type='AuthRecord *' data-ref="126rr" data-ref-filename="126rr">rr</dfn>;</td></tr>
<tr><th id="800">800</th><td>    <b>for</b> (<a class="local col6 ref" href="#126rr" title='rr' data-ref="126rr" data-ref-filename="126rr">rr</a> = <a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::ResourceRecords" title='mDNS_struct::ResourceRecords' data-ref="mDNS_struct::ResourceRecords" data-ref-filename="mDNS_struct..ResourceRecords">ResourceRecords</a>; <a class="local col6 ref" href="#126rr" title='rr' data-ref="126rr" data-ref-filename="126rr">rr</a>; <a class="local col6 ref" href="#126rr" title='rr' data-ref="126rr" data-ref-filename="126rr">rr</a>=<a class="local col6 ref" href="#126rr" title='rr' data-ref="126rr" data-ref-filename="126rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::next" title='AuthRecord_struct::next' data-ref="AuthRecord_struct::next" data-ref-filename="AuthRecord_struct..next">next</a>)</td></tr>
<tr><th id="801">801</th><td>        <b>if</b> (<a class="local col6 ref" href="#126rr" title='rr' data-ref="126rr" data-ref-filename="126rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rrtype" title='ResourceRecord_struct::rrtype' data-ref="ResourceRecord_struct::rrtype" data-ref-filename="ResourceRecord_struct..rrtype">rrtype</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSType_SRV" title='kDNSType_SRV' data-ref="kDNSType_SRV" data-ref-filename="kDNSType_SRV">kDNSType_SRV</a> &amp;&amp;</td></tr>
<tr><th id="802">802</th><td>            <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2953" title="((rr-&gt;resrec.rdata-&gt;u.srv.port).NotAnInteger == (port).NotAnInteger)" data-ref="_M/mDNSSameIPPort">mDNSSameIPPort</a>(<a class="local col6 ref" href="#126rr" title='rr' data-ref="126rr" data-ref-filename="126rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdata" title='ResourceRecord_struct::rdata' data-ref="ResourceRecord_struct::rdata" data-ref-filename="ResourceRecord_struct..rdata">rdata</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::u" title='(anonymous struct)::u' data-ref="(anonymous)::u" data-ref-filename="(anonymous)..u">u</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::srv" title='(anonymous union)::srv' data-ref="(anonymous)::srv" data-ref-filename="(anonymous)..srv">srv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::port" title='(anonymous struct)::port' data-ref="(anonymous)::port" data-ref-filename="(anonymous)..port">port</a>, <a class="local col4 ref" href="#124port" title='port' data-ref="124port" data-ref-filename="124port">port</a>) &amp;&amp;</td></tr>
<tr><th id="803">803</th><td>            <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#SameDomainName" title='SameDomainName' data-ref="SameDomainName" data-ref-filename="SameDomainName">SameDomainName</a>(<a class="local col6 ref" href="#126rr" title='rr' data-ref="126rr" data-ref-filename="126rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::name" title='ResourceRecord_struct::name' data-ref="ResourceRecord_struct::name" data-ref-filename="ResourceRecord_struct..name">name</a>, <a class="local col3 ref" href="#123srv" title='srv' data-ref="123srv" data-ref-filename="123srv">srv</a>))</td></tr>
<tr><th id="804">804</th><td>            <a class="local col5 ref" href="#125count" title='count' data-ref="125count" data-ref-filename="125count">count</a>++;</td></tr>
<tr><th id="805">805</th><td>    <b>return</b>(<a class="local col5 ref" href="#125count" title='count' data-ref="125count" data-ref-filename="125count">count</a>);</td></tr>
<tr><th id="806">806</th><td>}</td></tr>
<tr><th id="807">807</th><td></td></tr>
<tr><th id="808">808</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="SendServiceRemovalNotification" title='SendServiceRemovalNotification' data-ref="SendServiceRemovalNotification" data-ref-filename="SendServiceRemovalNotification">SendServiceRemovalNotification</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet" title='ServiceRecordSet' data-type='struct ServiceRecordSet_struct' data-ref="ServiceRecordSet" data-ref-filename="ServiceRecordSet">ServiceRecordSet</a> *<em>const</em> <dfn class="local col7 decl" id="127srs" title='srs' data-type='ServiceRecordSet *const' data-ref="127srs" data-ref-filename="127srs">srs</dfn>)</td></tr>
<tr><th id="809">809</th><td>{</td></tr>
<tr><th id="810">810</th><td>    <a class="typedef" href="uds_daemon.h.html#reply_state" title='reply_state' data-type='struct reply_state' data-ref="reply_state" data-ref-filename="reply_state">reply_state</a> *<dfn class="local col8 decl" id="128rep" title='rep' data-type='reply_state *' data-ref="128rep" data-ref-filename="128rep">rep</dfn>;</td></tr>
<tr><th id="811">811</th><td>    <a class="typedef" href="uds_daemon.h.html#service_instance" title='service_instance' data-type='struct service_instance' data-ref="service_instance" data-ref-filename="service_instance">service_instance</a> *<dfn class="local col9 decl" id="129instance" title='instance' data-type='service_instance *' data-ref="129instance" data-ref-filename="129instance">instance</dfn> = <a class="local col7 ref" href="#127srs" title='srs' data-ref="127srs" data-ref-filename="127srs">srs</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::ServiceContext" title='ServiceRecordSet_struct::ServiceContext' data-ref="ServiceRecordSet_struct::ServiceContext" data-ref-filename="ServiceRecordSet_struct..ServiceContext">ServiceContext</a>;</td></tr>
<tr><th id="812">812</th><td>    <b>if</b> (<a class="ref fn" href="#GenerateNTDResponse" title='GenerateNTDResponse' data-ref="GenerateNTDResponse" data-ref-filename="GenerateNTDResponse">GenerateNTDResponse</a>(<a class="local col7 ref" href="#127srs" title='srs' data-ref="127srs" data-ref-filename="127srs">srs</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_SRV" title='ServiceRecordSet_struct::RR_SRV' data-ref="ServiceRecordSet_struct::RR_SRV" data-ref-filename="ServiceRecordSet_struct..RR_SRV">RR_SRV</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::name" title='ResourceRecord_struct::name' data-ref="ResourceRecord_struct::name" data-ref-filename="ResourceRecord_struct..name">name</a>, <a class="local col7 ref" href="#127srs" title='srs' data-ref="127srs" data-ref-filename="127srs">srs</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_SRV" title='ServiceRecordSet_struct::RR_SRV' data-ref="ServiceRecordSet_struct::RR_SRV" data-ref-filename="ServiceRecordSet_struct..RR_SRV">RR_SRV</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::InterfaceID" title='ResourceRecord_struct::InterfaceID' data-ref="ResourceRecord_struct::InterfaceID" data-ref-filename="ResourceRecord_struct..InterfaceID">InterfaceID</a>, <a class="local col9 ref" href="#129instance" title='instance' data-ref="129instance" data-ref-filename="129instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>, &amp;<a class="local col8 ref" href="#128rep" title='rep' data-ref="128rep" data-ref-filename="128rep">rep</a>, <a class="enum" href="dnssd_ipc.h.html#reg_service_reply_op" title='reg_service_reply_op' data-ref="reg_service_reply_op" data-ref-filename="reg_service_reply_op">reg_service_reply_op</a>, <var>0</var>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_NoError" title='mStatus_NoError' data-ref="mStatus_NoError" data-ref-filename="mStatus_NoError">mStatus_NoError</a>) != <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_NoError" title='mStatus_NoError' data-ref="mStatus_NoError" data-ref-filename="mStatus_NoError">mStatus_NoError</a>)</td></tr>
<tr><th id="813">813</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: SendServiceRemovalNotification: %##s is not valid DNS-SD SRV name&quot;, instance-&gt;request-&gt;sd, srs-&gt;RR_SRV.resrec.name-&gt;c)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: SendServiceRemovalNotification: %##s is not valid DNS-SD SRV name"</q>, <a class="local col9 ref" href="#129instance" title='instance' data-ref="129instance" data-ref-filename="129instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col7 ref" href="#127srs" title='srs' data-ref="127srs" data-ref-filename="127srs">srs</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_SRV" title='ServiceRecordSet_struct::RR_SRV' data-ref="ServiceRecordSet_struct::RR_SRV" data-ref-filename="ServiceRecordSet_struct..RR_SRV">RR_SRV</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::name" title='ResourceRecord_struct::name' data-ref="ResourceRecord_struct::name" data-ref-filename="ResourceRecord_struct..name">name</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>);</td></tr>
<tr><th id="814">814</th><td>    <b>else</b> { <a class="ref fn" href="#append_reply" title='append_reply' data-ref="append_reply" data-ref-filename="append_reply">append_reply</a>(<a class="local col9 ref" href="#129instance" title='instance' data-ref="129instance" data-ref-filename="129instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>, <a class="local col8 ref" href="#128rep" title='rep' data-ref="128rep" data-ref-filename="128rep">rep</a>); <a class="local col9 ref" href="#129instance" title='instance' data-ref="129instance" data-ref-filename="129instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::clientnotified" title='service_instance::clientnotified' data-ref="service_instance::clientnotified" data-ref-filename="service_instance..clientnotified">clientnotified</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>; }</td></tr>
<tr><th id="815">815</th><td>}</td></tr>
<tr><th id="816">816</th><td></td></tr>
<tr><th id="817">817</th><td><i>// service registration callback performs three duties - frees memory for deregistered services,</i></td></tr>
<tr><th id="818">818</th><td><i>// handles name conflicts, and delivers completed registration information to the client</i></td></tr>
<tr><th id="819">819</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="regservice_callback" title='regservice_callback' data-ref="regservice_callback" data-ref-filename="regservice_callback">regservice_callback</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS" title='mDNS' data-type='struct mDNS_struct' data-ref="mDNS" data-ref-filename="mDNS">mDNS</a> *<em>const</em> <dfn class="local col0 decl" id="130m" title='m' data-type='mDNS *const' data-ref="130m" data-ref-filename="130m">m</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet" title='ServiceRecordSet' data-type='struct ServiceRecordSet_struct' data-ref="ServiceRecordSet" data-ref-filename="ServiceRecordSet">ServiceRecordSet</a> *<em>const</em> <dfn class="local col1 decl" id="131srs" title='srs' data-type='ServiceRecordSet *const' data-ref="131srs" data-ref-filename="131srs">srs</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="local col2 decl" id="132result" title='result' data-type='mStatus' data-ref="132result" data-ref-filename="132result">result</dfn>)</td></tr>
<tr><th id="820">820</th><td>{</td></tr>
<tr><th id="821">821</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="local col3 decl" id="133err" title='err' data-type='mStatus' data-ref="133err" data-ref-filename="133err">err</dfn>;</td></tr>
<tr><th id="822">822</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSBool" title='mDNSBool' data-type='unsigned char' data-ref="mDNSBool" data-ref-filename="mDNSBool">mDNSBool</a> <dfn class="local col4 decl" id="134SuppressError" title='SuppressError' data-type='mDNSBool' data-ref="134SuppressError" data-ref-filename="134SuppressError">SuppressError</dfn> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>;</td></tr>
<tr><th id="823">823</th><td>    <a class="typedef" href="uds_daemon.h.html#service_instance" title='service_instance' data-type='struct service_instance' data-ref="service_instance" data-ref-filename="service_instance">service_instance</a> *<dfn class="local col5 decl" id="135instance" title='instance' data-type='service_instance *' data-ref="135instance" data-ref-filename="135instance">instance</dfn>;</td></tr>
<tr><th id="824">824</th><td>    <a class="typedef" href="uds_daemon.h.html#reply_state" title='reply_state' data-type='struct reply_state' data-ref="reply_state" data-ref-filename="reply_state">reply_state</a>         *<dfn class="local col6 decl" id="136rep" title='rep' data-type='reply_state *' data-ref="136rep" data-ref-filename="136rep">rep</dfn>;</td></tr>
<tr><th id="825">825</th><td>    (<em>void</em>)<a class="local col0 ref" href="#130m" title='m' data-ref="130m" data-ref-filename="130m">m</a>; <i>// Unused</i></td></tr>
<tr><th id="826">826</th><td></td></tr>
<tr><th id="827">827</th><td>    <b>if</b> (!<a class="local col1 ref" href="#131srs" title='srs' data-ref="131srs" data-ref-filename="131srs">srs</a>)      { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;regservice_callback: srs is NULL %d&quot;, result)" data-ref="_M/LogMsg">LogMsg</a>(<q>"regservice_callback: srs is NULL %d"</q>,                 <a class="local col2 ref" href="#132result" title='result' data-ref="132result" data-ref-filename="132result">result</a>); <b>return</b>; }</td></tr>
<tr><th id="828">828</th><td></td></tr>
<tr><th id="829">829</th><td>    <a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a> = <a class="local col1 ref" href="#131srs" title='srs' data-ref="131srs" data-ref-filename="131srs">srs</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::ServiceContext" title='ServiceRecordSet_struct::ServiceContext' data-ref="ServiceRecordSet_struct::ServiceContext" data-ref-filename="ServiceRecordSet_struct..ServiceContext">ServiceContext</a>;</td></tr>
<tr><th id="830">830</th><td>    <b>if</b> (!<a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>) { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;regservice_callback: srs-&gt;ServiceContext is NULL %d&quot;, result)" data-ref="_M/LogMsg">LogMsg</a>(<q>"regservice_callback: srs-&gt;ServiceContext is NULL %d"</q>, <a class="local col2 ref" href="#132result" title='result' data-ref="132result" data-ref-filename="132result">result</a>); <b>return</b>; }</td></tr>
<tr><th id="831">831</th><td></td></tr>
<tr><th id="832">832</th><td>    <i>// don't send errors up to client for wide-area, empty-string registrations</i></td></tr>
<tr><th id="833">833</th><td>    <b>if</b> (<a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a> &amp;&amp;</td></tr>
<tr><th id="834">834</th><td>        <a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::default_domain" title='request_state::(anonymous union)::(anonymous struct)::default_domain' data-ref="request_state::(anonymousunion)::(anonymous)::default_domain" data-ref-filename="request_state..(anonymousunion)..(anonymous)..default_domain">default_domain</a> &amp;&amp;</td></tr>
<tr><th id="835">835</th><td>        !<a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::default_local" title='service_instance::default_local' data-ref="service_instance::default_local" data-ref-filename="service_instance..default_local">default_local</a>)</td></tr>
<tr><th id="836">836</th><td>        <a class="local col4 ref" href="#134SuppressError" title='SuppressError' data-ref="134SuppressError" data-ref-filename="134SuppressError">SuppressError</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>;</td></tr>
<tr><th id="837">837</th><td></td></tr>
<tr><th id="838">838</th><td>    <b>if</b> (<a class="ref" href="../mDNSCore/mDNSDebug.h.html#mDNS_LoggingEnabled" title='mDNS_LoggingEnabled' data-ref="mDNS_LoggingEnabled" data-ref-filename="mDNS_LoggingEnabled">mDNS_LoggingEnabled</a>)</td></tr>
<tr><th id="839">839</th><td>    {</td></tr>
<tr><th id="840">840</th><td>        <em>const</em> <em>char</em> *<em>const</em> <dfn class="local col7 decl" id="137fmt" title='fmt' data-type='const char *const' data-ref="137fmt" data-ref-filename="137fmt">fmt</dfn> =</td></tr>
<tr><th id="841">841</th><td>            (<a class="local col2 ref" href="#132result" title='result' data-ref="132result" data-ref-filename="132result">result</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_NoError" title='mStatus_NoError' data-ref="mStatus_NoError" data-ref-filename="mStatus_NoError">mStatus_NoError</a>)      ? <q>"%s DNSServiceRegister(%##s, %u) REGISTERED"</q>    :</td></tr>
<tr><th id="842">842</th><td>            (<a class="local col2 ref" href="#132result" title='result' data-ref="132result" data-ref-filename="132result">result</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_MemFree" title='mStatus_MemFree' data-ref="mStatus_MemFree" data-ref-filename="mStatus_MemFree">mStatus_MemFree</a>)      ? <q>"%s DNSServiceRegister(%##s, %u) DEREGISTERED"</q>  :</td></tr>
<tr><th id="843">843</th><td>            (<a class="local col2 ref" href="#132result" title='result' data-ref="132result" data-ref-filename="132result">result</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_NameConflict" title='mStatus_NameConflict' data-ref="mStatus_NameConflict" data-ref-filename="mStatus_NameConflict">mStatus_NameConflict</a>) ? <q>"%s DNSServiceRegister(%##s, %u) NAME CONFLICT"</q> :</td></tr>
<tr><th id="844">844</th><td>            <q>"%s DNSServiceRegister(%##s, %u) %s %d"</q>;</td></tr>
<tr><th id="845">845</th><td>        <em>char</em> <dfn class="local col8 decl" id="138prefix" title='prefix' data-type='char [16]' data-ref="138prefix" data-ref-filename="138prefix">prefix</dfn>[<var>16</var>] = <q>"---:"</q>;</td></tr>
<tr><th id="846">846</th><td>        <b>if</b> (<a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>) <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_snprintf" title='mDNS_snprintf' data-ref="mDNS_snprintf" data-ref-filename="mDNS_snprintf">mDNS_snprintf</a>(<a class="local col8 ref" href="#138prefix" title='prefix' data-ref="138prefix" data-ref-filename="138prefix">prefix</a>, <b>sizeof</b>(<a class="local col8 ref" href="#138prefix" title='prefix' data-ref="138prefix" data-ref-filename="138prefix">prefix</a>), <q>"%3d:"</q>, <a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>);</td></tr>
<tr><th id="847">847</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, fmt, prefix, srs-&gt;RR_SRV.resrec.name-&gt;c, mDNSVal16(srs-&gt;RR_SRV.resrec.rdata-&gt;u.srv.port), SuppressError ? &quot;suppressed error&quot; : &quot;CALLBACK&quot;, result);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<a class="local col7 ref" href="#137fmt" title='fmt' data-ref="137fmt" data-ref-filename="137fmt">fmt</a>, <a class="local col8 ref" href="#138prefix" title='prefix' data-ref="138prefix" data-ref-filename="138prefix">prefix</a>, <a class="local col1 ref" href="#131srs" title='srs' data-ref="131srs" data-ref-filename="131srs">srs</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_SRV" title='ServiceRecordSet_struct::RR_SRV' data-ref="ServiceRecordSet_struct::RR_SRV" data-ref-filename="ServiceRecordSet_struct..RR_SRV">RR_SRV</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::name" title='ResourceRecord_struct::name' data-ref="ResourceRecord_struct::name" data-ref-filename="ResourceRecord_struct..name">name</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSVal16" title='mDNSVal16' data-ref="mDNSVal16" data-ref-filename="mDNSVal16">mDNSVal16</a>(<a class="local col1 ref" href="#131srs" title='srs' data-ref="131srs" data-ref-filename="131srs">srs</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_SRV" title='ServiceRecordSet_struct::RR_SRV' data-ref="ServiceRecordSet_struct::RR_SRV" data-ref-filename="ServiceRecordSet_struct..RR_SRV">RR_SRV</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdata" title='ResourceRecord_struct::rdata' data-ref="ResourceRecord_struct::rdata" data-ref-filename="ResourceRecord_struct..rdata">rdata</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::u" title='(anonymous struct)::u' data-ref="(anonymous)::u" data-ref-filename="(anonymous)..u">u</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::srv" title='(anonymous union)::srv' data-ref="(anonymous)::srv" data-ref-filename="(anonymous)..srv">srv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::port" title='(anonymous struct)::port' data-ref="(anonymous)::port" data-ref-filename="(anonymous)..port">port</a>),</td></tr>
<tr><th id="848">848</th><td>                     <a class="local col4 ref" href="#134SuppressError" title='SuppressError' data-ref="134SuppressError" data-ref-filename="134SuppressError">SuppressError</a> ? <q>"suppressed error"</q> : <q>"CALLBACK"</q>, <a class="local col2 ref" href="#132result" title='result' data-ref="132result" data-ref-filename="132result">result</a>);</td></tr>
<tr><th id="849">849</th><td>    }</td></tr>
<tr><th id="850">850</th><td></td></tr>
<tr><th id="851">851</th><td>    <b>if</b> (!<a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a> &amp;&amp; <a class="local col2 ref" href="#132result" title='result' data-ref="132result" data-ref-filename="132result">result</a> != <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_MemFree" title='mStatus_MemFree' data-ref="mStatus_MemFree" data-ref-filename="mStatus_MemFree">mStatus_MemFree</a>) { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;regservice_callback: instance-&gt;request is NULL %d&quot;, result)" data-ref="_M/LogMsg">LogMsg</a>(<q>"regservice_callback: instance-&gt;request is NULL %d"</q>, <a class="local col2 ref" href="#132result" title='result' data-ref="132result" data-ref-filename="132result">result</a>); <b>return</b>; }</td></tr>
<tr><th id="852">852</th><td></td></tr>
<tr><th id="853">853</th><td>    <b>if</b> (<a class="local col2 ref" href="#132result" title='result' data-ref="132result" data-ref-filename="132result">result</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_NoError" title='mStatus_NoError' data-ref="mStatus_NoError" data-ref-filename="mStatus_NoError">mStatus_NoError</a>)</td></tr>
<tr><th id="854">854</th><td>    {</td></tr>
<tr><th id="855">855</th><td>        <b>if</b> (<a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::allowremotequery" title='request_state::(anonymous union)::(anonymous struct)::allowremotequery' data-ref="request_state::(anonymousunion)::(anonymous)::allowremotequery" data-ref-filename="request_state..(anonymousunion)..(anonymous)..allowremotequery">allowremotequery</a>)</td></tr>
<tr><th id="856">856</th><td>        {</td></tr>
<tr><th id="857">857</th><td>            <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord" title='ExtraResourceRecord' data-type='struct ExtraResourceRecord_struct' data-ref="ExtraResourceRecord" data-ref-filename="ExtraResourceRecord">ExtraResourceRecord</a> *<dfn class="local col9 decl" id="139e" title='e' data-type='ExtraResourceRecord *' data-ref="139e" data-ref-filename="139e">e</dfn>;</td></tr>
<tr><th id="858">858</th><td>            <a class="local col1 ref" href="#131srs" title='srs' data-ref="131srs" data-ref-filename="131srs">srs</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_ADV" title='ServiceRecordSet_struct::RR_ADV' data-ref="ServiceRecordSet_struct::RR_ADV" data-ref-filename="ServiceRecordSet_struct..RR_ADV">RR_ADV</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::AllowRemoteQuery" title='AuthRecord_struct::AllowRemoteQuery' data-ref="AuthRecord_struct::AllowRemoteQuery" data-ref-filename="AuthRecord_struct..AllowRemoteQuery">AllowRemoteQuery</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>;</td></tr>
<tr><th id="859">859</th><td>            <a class="local col1 ref" href="#131srs" title='srs' data-ref="131srs" data-ref-filename="131srs">srs</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_PTR" title='ServiceRecordSet_struct::RR_PTR' data-ref="ServiceRecordSet_struct::RR_PTR" data-ref-filename="ServiceRecordSet_struct..RR_PTR">RR_PTR</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::AllowRemoteQuery" title='AuthRecord_struct::AllowRemoteQuery' data-ref="AuthRecord_struct::AllowRemoteQuery" data-ref-filename="AuthRecord_struct..AllowRemoteQuery">AllowRemoteQuery</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>;</td></tr>
<tr><th id="860">860</th><td>            <a class="local col1 ref" href="#131srs" title='srs' data-ref="131srs" data-ref-filename="131srs">srs</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_SRV" title='ServiceRecordSet_struct::RR_SRV' data-ref="ServiceRecordSet_struct::RR_SRV" data-ref-filename="ServiceRecordSet_struct..RR_SRV">RR_SRV</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::AllowRemoteQuery" title='AuthRecord_struct::AllowRemoteQuery' data-ref="AuthRecord_struct::AllowRemoteQuery" data-ref-filename="AuthRecord_struct..AllowRemoteQuery">AllowRemoteQuery</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>;</td></tr>
<tr><th id="861">861</th><td>            <a class="local col1 ref" href="#131srs" title='srs' data-ref="131srs" data-ref-filename="131srs">srs</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_TXT" title='ServiceRecordSet_struct::RR_TXT' data-ref="ServiceRecordSet_struct::RR_TXT" data-ref-filename="ServiceRecordSet_struct..RR_TXT">RR_TXT</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::AllowRemoteQuery" title='AuthRecord_struct::AllowRemoteQuery' data-ref="AuthRecord_struct::AllowRemoteQuery" data-ref-filename="AuthRecord_struct..AllowRemoteQuery">AllowRemoteQuery</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>;</td></tr>
<tr><th id="862">862</th><td>            <b>for</b> (<a class="local col9 ref" href="#139e" title='e' data-ref="139e" data-ref-filename="139e">e</a> = <a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::Extras" title='ServiceRecordSet_struct::Extras' data-ref="ServiceRecordSet_struct::Extras" data-ref-filename="ServiceRecordSet_struct..Extras">Extras</a>; <a class="local col9 ref" href="#139e" title='e' data-ref="139e" data-ref-filename="139e">e</a>; <a class="local col9 ref" href="#139e" title='e' data-ref="139e" data-ref-filename="139e">e</a> = <a class="local col9 ref" href="#139e" title='e' data-ref="139e" data-ref-filename="139e">e</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord_struct::next" title='ExtraResourceRecord_struct::next' data-ref="ExtraResourceRecord_struct::next" data-ref-filename="ExtraResourceRecord_struct..next">next</a>) <a class="local col9 ref" href="#139e" title='e' data-ref="139e" data-ref-filename="139e">e</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord_struct::r" title='ExtraResourceRecord_struct::r' data-ref="ExtraResourceRecord_struct::r" data-ref-filename="ExtraResourceRecord_struct..r">r</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::AllowRemoteQuery" title='AuthRecord_struct::AllowRemoteQuery' data-ref="AuthRecord_struct::AllowRemoteQuery" data-ref-filename="AuthRecord_struct..AllowRemoteQuery">AllowRemoteQuery</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>;</td></tr>
<tr><th id="863">863</th><td>        }</td></tr>
<tr><th id="864">864</th><td></td></tr>
<tr><th id="865">865</th><td>        <b>if</b> (<a class="ref fn" href="#GenerateNTDResponse" title='GenerateNTDResponse' data-ref="GenerateNTDResponse" data-ref-filename="GenerateNTDResponse">GenerateNTDResponse</a>(<a class="local col1 ref" href="#131srs" title='srs' data-ref="131srs" data-ref-filename="131srs">srs</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_SRV" title='ServiceRecordSet_struct::RR_SRV' data-ref="ServiceRecordSet_struct::RR_SRV" data-ref-filename="ServiceRecordSet_struct..RR_SRV">RR_SRV</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::name" title='ResourceRecord_struct::name' data-ref="ResourceRecord_struct::name" data-ref-filename="ResourceRecord_struct..name">name</a>, <a class="local col1 ref" href="#131srs" title='srs' data-ref="131srs" data-ref-filename="131srs">srs</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_SRV" title='ServiceRecordSet_struct::RR_SRV' data-ref="ServiceRecordSet_struct::RR_SRV" data-ref-filename="ServiceRecordSet_struct..RR_SRV">RR_SRV</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::InterfaceID" title='ResourceRecord_struct::InterfaceID' data-ref="ResourceRecord_struct::InterfaceID" data-ref-filename="ResourceRecord_struct..InterfaceID">InterfaceID</a>, <a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>, &amp;<a class="local col6 ref" href="#136rep" title='rep' data-ref="136rep" data-ref-filename="136rep">rep</a>, <a class="enum" href="dnssd_ipc.h.html#reg_service_reply_op" title='reg_service_reply_op' data-ref="reg_service_reply_op" data-ref-filename="reg_service_reply_op">reg_service_reply_op</a>, <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsAdd" title='kDNSServiceFlagsAdd' data-ref="kDNSServiceFlagsAdd" data-ref-filename="kDNSServiceFlagsAdd">kDNSServiceFlagsAdd</a>, <a class="local col2 ref" href="#132result" title='result' data-ref="132result" data-ref-filename="132result">result</a>) != <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_NoError" title='mStatus_NoError' data-ref="mStatus_NoError" data-ref-filename="mStatus_NoError">mStatus_NoError</a>)</td></tr>
<tr><th id="866">866</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: regservice_callback: %##s is not valid DNS-SD SRV name&quot;, instance-&gt;request-&gt;sd, srs-&gt;RR_SRV.resrec.name-&gt;c)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: regservice_callback: %##s is not valid DNS-SD SRV name"</q>, <a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col1 ref" href="#131srs" title='srs' data-ref="131srs" data-ref-filename="131srs">srs</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_SRV" title='ServiceRecordSet_struct::RR_SRV' data-ref="ServiceRecordSet_struct::RR_SRV" data-ref-filename="ServiceRecordSet_struct..RR_SRV">RR_SRV</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::name" title='ResourceRecord_struct::name' data-ref="ResourceRecord_struct::name" data-ref-filename="ResourceRecord_struct..name">name</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>);</td></tr>
<tr><th id="867">867</th><td>        <b>else</b> { <a class="ref fn" href="#append_reply" title='append_reply' data-ref="append_reply" data-ref-filename="append_reply">append_reply</a>(<a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>, <a class="local col6 ref" href="#136rep" title='rep' data-ref="136rep" data-ref-filename="136rep">rep</a>); <a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::clientnotified" title='service_instance::clientnotified' data-ref="service_instance::clientnotified" data-ref-filename="service_instance..clientnotified">clientnotified</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>; }</td></tr>
<tr><th id="868">868</th><td></td></tr>
<tr><th id="869">869</th><td>        <b>if</b> (<a class="ref fn" href="#callExternalHelpers" title='callExternalHelpers' data-ref="callExternalHelpers" data-ref-filename="callExternalHelpers">callExternalHelpers</a>(<a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::InterfaceID" title='request_state::(anonymous union)::(anonymous struct)::InterfaceID' data-ref="request_state::(anonymousunion)::(anonymous)::InterfaceID" data-ref-filename="request_state..(anonymousunion)..(anonymous)..InterfaceID">InterfaceID</a>, &amp;<a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::domain" title='service_instance::domain' data-ref="service_instance::domain" data-ref-filename="service_instance..domain">domain</a>, <a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a>))</td></tr>
<tr><th id="870">870</th><td>        {</td></tr>
<tr><th id="871">871</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;regservice_callback: calling external_start_advertising_helper()&quot;);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"regservice_callback: calling external_start_advertising_helper()"</q>);</td></tr>
<tr><th id="872">872</th><td>            <a class="ref fn" href="#external_start_advertising_helper" title='external_start_advertising_helper' data-ref="external_start_advertising_helper" data-ref-filename="external_start_advertising_helper">external_start_advertising_helper</a>(<a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>);</td></tr>
<tr><th id="873">873</th><td>        }</td></tr>
<tr><th id="874">874</th><td>        <b>if</b> (<a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::autoname" title='request_state::(anonymous union)::(anonymous struct)::autoname' data-ref="request_state::(anonymousunion)::(anonymous)::autoname" data-ref-filename="request_state..(anonymousunion)..(anonymous)..autoname">autoname</a> &amp;&amp; <a class="ref fn" href="#CountPeerRegistrations" title='CountPeerRegistrations' data-ref="CountPeerRegistrations" data-ref-filename="CountPeerRegistrations">CountPeerRegistrations</a>(<a class="local col1 ref" href="#131srs" title='srs' data-ref="131srs" data-ref-filename="131srs">srs</a>) == <var>0</var>)</td></tr>
<tr><th id="875">875</th><td>            <a class="ref fn" href="uds_daemon.h.html#RecordUpdatedNiceLabel" title='RecordUpdatedNiceLabel' data-ref="RecordUpdatedNiceLabel" data-ref-filename="RecordUpdatedNiceLabel">RecordUpdatedNiceLabel</a>(<var>0</var>);   <i>// Successfully got new name, tell user immediately</i></td></tr>
<tr><th id="876">876</th><td>    }</td></tr>
<tr><th id="877">877</th><td>    <b>else</b> <b>if</b> (<a class="local col2 ref" href="#132result" title='result' data-ref="132result" data-ref-filename="132result">result</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_MemFree" title='mStatus_MemFree' data-ref="mStatus_MemFree" data-ref-filename="mStatus_MemFree">mStatus_MemFree</a>)</td></tr>
<tr><th id="878">878</th><td>    {</td></tr>
<tr><th id="879">879</th><td><u>#<span data-ppcond="879">if</span> TARGET_OS_EMBEDDED</u></td></tr>
<tr><th id="880">880</th><td>        curr_num_regservices--;</td></tr>
<tr><th id="881">881</th><td><u>#<span data-ppcond="879">endif</span></u></td></tr>
<tr><th id="882">882</th><td>        <b>if</b> (<a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a> &amp;&amp; <a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::renameonmemfree" title='service_instance::renameonmemfree' data-ref="service_instance::renameonmemfree" data-ref-filename="service_instance..renameonmemfree">renameonmemfree</a>)</td></tr>
<tr><th id="883">883</th><td>        {</td></tr>
<tr><th id="884">884</th><td>            <a class="ref fn" href="#external_stop_advertising_helper" title='external_stop_advertising_helper' data-ref="external_stop_advertising_helper" data-ref-filename="external_stop_advertising_helper">external_stop_advertising_helper</a>(<a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>);</td></tr>
<tr><th id="885">885</th><td>            <a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::renameonmemfree" title='service_instance::renameonmemfree' data-ref="service_instance::renameonmemfree" data-ref-filename="service_instance..renameonmemfree">renameonmemfree</a> = <var>0</var>;</td></tr>
<tr><th id="886">886</th><td>            <a class="local col3 ref" href="#133err" title='err' data-ref="133err" data-ref-filename="133err">err</a> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_RenameAndReregisterService" title='mDNS_RenameAndReregisterService' data-ref="mDNS_RenameAndReregisterService" data-ref-filename="mDNS_RenameAndReregisterService">mDNS_RenameAndReregisterService</a>(<a class="local col0 ref" href="#130m" title='m' data-ref="130m" data-ref-filename="130m">m</a>, <a class="local col1 ref" href="#131srs" title='srs' data-ref="131srs" data-ref-filename="131srs">srs</a>, &amp;<a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::name" title='request_state::(anonymous union)::(anonymous struct)::name' data-ref="request_state::(anonymousunion)::(anonymous)::name" data-ref-filename="request_state..(anonymousunion)..(anonymous)..name">name</a>);</td></tr>
<tr><th id="887">887</th><td>            <b>if</b> (<a class="local col3 ref" href="#133err" title='err' data-ref="133err" data-ref-filename="133err">err</a>) <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;ERROR: regservice_callback - RenameAndReregisterService returned %d&quot;, err)" data-ref="_M/LogMsg">LogMsg</a>(<q>"ERROR: regservice_callback - RenameAndReregisterService returned %d"</q>, <a class="local col3 ref" href="#133err" title='err' data-ref="133err" data-ref-filename="133err">err</a>);</td></tr>
<tr><th id="888">888</th><td>            <i>// error should never happen - safest to log and continue</i></td></tr>
<tr><th id="889">889</th><td>        }</td></tr>
<tr><th id="890">890</th><td>        <b>else</b></td></tr>
<tr><th id="891">891</th><td>            <a class="ref fn" href="#unlink_and_free_service_instance" title='unlink_and_free_service_instance' data-ref="unlink_and_free_service_instance" data-ref-filename="unlink_and_free_service_instance">unlink_and_free_service_instance</a>(<a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>);</td></tr>
<tr><th id="892">892</th><td>    }</td></tr>
<tr><th id="893">893</th><td>    <b>else</b> <b>if</b> (<a class="local col2 ref" href="#132result" title='result' data-ref="132result" data-ref-filename="132result">result</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_NameConflict" title='mStatus_NameConflict' data-ref="mStatus_NameConflict" data-ref-filename="mStatus_NameConflict">mStatus_NameConflict</a>)</td></tr>
<tr><th id="894">894</th><td>    {</td></tr>
<tr><th id="895">895</th><td>        <b>if</b> (<a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::autorename" title='request_state::(anonymous union)::(anonymous struct)::autorename' data-ref="request_state::(anonymousunion)::(anonymous)::autorename" data-ref-filename="request_state..(anonymousunion)..(anonymous)..autorename">autorename</a>)</td></tr>
<tr><th id="896">896</th><td>        {</td></tr>
<tr><th id="897">897</th><td>            <a class="ref fn" href="#external_stop_advertising_helper" title='external_stop_advertising_helper' data-ref="external_stop_advertising_helper" data-ref-filename="external_stop_advertising_helper">external_stop_advertising_helper</a>(<a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>);</td></tr>
<tr><th id="898">898</th><td>            <b>if</b> (<a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::autoname" title='request_state::(anonymous union)::(anonymous struct)::autoname' data-ref="request_state::(anonymousunion)::(anonymous)::autoname" data-ref-filename="request_state..(anonymousunion)..(anonymous)..autoname">autoname</a> &amp;&amp; <a class="ref fn" href="#CountPeerRegistrations" title='CountPeerRegistrations' data-ref="CountPeerRegistrations" data-ref-filename="CountPeerRegistrations">CountPeerRegistrations</a>(<a class="local col1 ref" href="#131srs" title='srs' data-ref="131srs" data-ref-filename="131srs">srs</a>) == <var>0</var>)</td></tr>
<tr><th id="899">899</th><td>            {</td></tr>
<tr><th id="900">900</th><td>                <i>// On conflict for an autoname service, rename and reregister *all* autoname services</i></td></tr>
<tr><th id="901">901</th><td>                <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#IncrementLabelSuffix" title='IncrementLabelSuffix' data-ref="IncrementLabelSuffix" data-ref-filename="IncrementLabelSuffix">IncrementLabelSuffix</a>(&amp;<a class="local col0 ref" href="#130m" title='m' data-ref="130m" data-ref-filename="130m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::nicelabel" title='mDNS_struct::nicelabel' data-ref="mDNS_struct::nicelabel" data-ref-filename="mDNS_struct..nicelabel">nicelabel</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>);</td></tr>
<tr><th id="902">902</th><td>                <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_ConfigChanged" title='mDNS_ConfigChanged' data-ref="mDNS_ConfigChanged" data-ref-filename="mDNS_ConfigChanged">mDNS_ConfigChanged</a>(<a class="local col0 ref" href="#130m" title='m' data-ref="130m" data-ref-filename="130m">m</a>);  <i>// Will call back into udsserver_handle_configchange()</i></td></tr>
<tr><th id="903">903</th><td>            }</td></tr>
<tr><th id="904">904</th><td>            <b>else</b>    <i>// On conflict for a non-autoname service, rename and reregister just that one service</i></td></tr>
<tr><th id="905">905</th><td>            {</td></tr>
<tr><th id="906">906</th><td>                <b>if</b> (<a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::clientnotified" title='service_instance::clientnotified' data-ref="service_instance::clientnotified" data-ref-filename="service_instance..clientnotified">clientnotified</a>) <a class="ref fn" href="#SendServiceRemovalNotification" title='SendServiceRemovalNotification' data-ref="SendServiceRemovalNotification" data-ref-filename="SendServiceRemovalNotification">SendServiceRemovalNotification</a>(<a class="local col1 ref" href="#131srs" title='srs' data-ref="131srs" data-ref-filename="131srs">srs</a>);</td></tr>
<tr><th id="907">907</th><td>                <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_RenameAndReregisterService" title='mDNS_RenameAndReregisterService' data-ref="mDNS_RenameAndReregisterService" data-ref-filename="mDNS_RenameAndReregisterService">mDNS_RenameAndReregisterService</a>(<a class="local col0 ref" href="#130m" title='m' data-ref="130m" data-ref-filename="130m">m</a>, <a class="local col1 ref" href="#131srs" title='srs' data-ref="131srs" data-ref-filename="131srs">srs</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>);</td></tr>
<tr><th id="908">908</th><td>            }</td></tr>
<tr><th id="909">909</th><td>        }</td></tr>
<tr><th id="910">910</th><td>        <b>else</b></td></tr>
<tr><th id="911">911</th><td>        {</td></tr>
<tr><th id="912">912</th><td>            <b>if</b> (!<a class="local col4 ref" href="#134SuppressError" title='SuppressError' data-ref="134SuppressError" data-ref-filename="134SuppressError">SuppressError</a>)</td></tr>
<tr><th id="913">913</th><td>            {</td></tr>
<tr><th id="914">914</th><td>                <b>if</b> (<a class="ref fn" href="#GenerateNTDResponse" title='GenerateNTDResponse' data-ref="GenerateNTDResponse" data-ref-filename="GenerateNTDResponse">GenerateNTDResponse</a>(<a class="local col1 ref" href="#131srs" title='srs' data-ref="131srs" data-ref-filename="131srs">srs</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_SRV" title='ServiceRecordSet_struct::RR_SRV' data-ref="ServiceRecordSet_struct::RR_SRV" data-ref-filename="ServiceRecordSet_struct..RR_SRV">RR_SRV</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::name" title='ResourceRecord_struct::name' data-ref="ResourceRecord_struct::name" data-ref-filename="ResourceRecord_struct..name">name</a>, <a class="local col1 ref" href="#131srs" title='srs' data-ref="131srs" data-ref-filename="131srs">srs</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_SRV" title='ServiceRecordSet_struct::RR_SRV' data-ref="ServiceRecordSet_struct::RR_SRV" data-ref-filename="ServiceRecordSet_struct..RR_SRV">RR_SRV</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::InterfaceID" title='ResourceRecord_struct::InterfaceID' data-ref="ResourceRecord_struct::InterfaceID" data-ref-filename="ResourceRecord_struct..InterfaceID">InterfaceID</a>, <a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>, &amp;<a class="local col6 ref" href="#136rep" title='rep' data-ref="136rep" data-ref-filename="136rep">rep</a>, <a class="enum" href="dnssd_ipc.h.html#reg_service_reply_op" title='reg_service_reply_op' data-ref="reg_service_reply_op" data-ref-filename="reg_service_reply_op">reg_service_reply_op</a>, <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsAdd" title='kDNSServiceFlagsAdd' data-ref="kDNSServiceFlagsAdd" data-ref-filename="kDNSServiceFlagsAdd">kDNSServiceFlagsAdd</a>, <a class="local col2 ref" href="#132result" title='result' data-ref="132result" data-ref-filename="132result">result</a>) != <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_NoError" title='mStatus_NoError' data-ref="mStatus_NoError" data-ref-filename="mStatus_NoError">mStatus_NoError</a>)</td></tr>
<tr><th id="915">915</th><td>                    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: regservice_callback: %##s is not valid DNS-SD SRV name&quot;, instance-&gt;request-&gt;sd, srs-&gt;RR_SRV.resrec.name-&gt;c)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: regservice_callback: %##s is not valid DNS-SD SRV name"</q>, <a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col1 ref" href="#131srs" title='srs' data-ref="131srs" data-ref-filename="131srs">srs</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_SRV" title='ServiceRecordSet_struct::RR_SRV' data-ref="ServiceRecordSet_struct::RR_SRV" data-ref-filename="ServiceRecordSet_struct..RR_SRV">RR_SRV</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::name" title='ResourceRecord_struct::name' data-ref="ResourceRecord_struct::name" data-ref-filename="ResourceRecord_struct..name">name</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>);</td></tr>
<tr><th id="916">916</th><td>                <b>else</b> { <a class="ref fn" href="#append_reply" title='append_reply' data-ref="append_reply" data-ref-filename="append_reply">append_reply</a>(<a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>, <a class="local col6 ref" href="#136rep" title='rep' data-ref="136rep" data-ref-filename="136rep">rep</a>); <a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::clientnotified" title='service_instance::clientnotified' data-ref="service_instance::clientnotified" data-ref-filename="service_instance..clientnotified">clientnotified</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>; }</td></tr>
<tr><th id="917">917</th><td>            }</td></tr>
<tr><th id="918">918</th><td>            <a class="ref fn" href="#unlink_and_free_service_instance" title='unlink_and_free_service_instance' data-ref="unlink_and_free_service_instance" data-ref-filename="unlink_and_free_service_instance">unlink_and_free_service_instance</a>(<a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>);</td></tr>
<tr><th id="919">919</th><td>        }</td></tr>
<tr><th id="920">920</th><td>    }</td></tr>
<tr><th id="921">921</th><td>    <b>else</b>        <i>// Not mStatus_NoError, mStatus_MemFree, or mStatus_NameConflict</i></td></tr>
<tr><th id="922">922</th><td>    {</td></tr>
<tr><th id="923">923</th><td>        <b>if</b> (!<a class="local col4 ref" href="#134SuppressError" title='SuppressError' data-ref="134SuppressError" data-ref-filename="134SuppressError">SuppressError</a>)</td></tr>
<tr><th id="924">924</th><td>        {</td></tr>
<tr><th id="925">925</th><td>            <b>if</b> (<a class="ref fn" href="#GenerateNTDResponse" title='GenerateNTDResponse' data-ref="GenerateNTDResponse" data-ref-filename="GenerateNTDResponse">GenerateNTDResponse</a>(<a class="local col1 ref" href="#131srs" title='srs' data-ref="131srs" data-ref-filename="131srs">srs</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_SRV" title='ServiceRecordSet_struct::RR_SRV' data-ref="ServiceRecordSet_struct::RR_SRV" data-ref-filename="ServiceRecordSet_struct..RR_SRV">RR_SRV</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::name" title='ResourceRecord_struct::name' data-ref="ResourceRecord_struct::name" data-ref-filename="ResourceRecord_struct..name">name</a>, <a class="local col1 ref" href="#131srs" title='srs' data-ref="131srs" data-ref-filename="131srs">srs</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_SRV" title='ServiceRecordSet_struct::RR_SRV' data-ref="ServiceRecordSet_struct::RR_SRV" data-ref-filename="ServiceRecordSet_struct..RR_SRV">RR_SRV</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::InterfaceID" title='ResourceRecord_struct::InterfaceID' data-ref="ResourceRecord_struct::InterfaceID" data-ref-filename="ResourceRecord_struct..InterfaceID">InterfaceID</a>, <a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>, &amp;<a class="local col6 ref" href="#136rep" title='rep' data-ref="136rep" data-ref-filename="136rep">rep</a>, <a class="enum" href="dnssd_ipc.h.html#reg_service_reply_op" title='reg_service_reply_op' data-ref="reg_service_reply_op" data-ref-filename="reg_service_reply_op">reg_service_reply_op</a>, <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsAdd" title='kDNSServiceFlagsAdd' data-ref="kDNSServiceFlagsAdd" data-ref-filename="kDNSServiceFlagsAdd">kDNSServiceFlagsAdd</a>, <a class="local col2 ref" href="#132result" title='result' data-ref="132result" data-ref-filename="132result">result</a>) != <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_NoError" title='mStatus_NoError' data-ref="mStatus_NoError" data-ref-filename="mStatus_NoError">mStatus_NoError</a>)</td></tr>
<tr><th id="926">926</th><td>                <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: regservice_callback: %##s is not valid DNS-SD SRV name&quot;, instance-&gt;request-&gt;sd, srs-&gt;RR_SRV.resrec.name-&gt;c)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: regservice_callback: %##s is not valid DNS-SD SRV name"</q>, <a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col1 ref" href="#131srs" title='srs' data-ref="131srs" data-ref-filename="131srs">srs</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_SRV" title='ServiceRecordSet_struct::RR_SRV' data-ref="ServiceRecordSet_struct::RR_SRV" data-ref-filename="ServiceRecordSet_struct..RR_SRV">RR_SRV</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::name" title='ResourceRecord_struct::name' data-ref="ResourceRecord_struct::name" data-ref-filename="ResourceRecord_struct..name">name</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>);</td></tr>
<tr><th id="927">927</th><td>            <b>else</b> { <a class="ref fn" href="#append_reply" title='append_reply' data-ref="append_reply" data-ref-filename="append_reply">append_reply</a>(<a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>, <a class="local col6 ref" href="#136rep" title='rep' data-ref="136rep" data-ref-filename="136rep">rep</a>); <a class="local col5 ref" href="#135instance" title='instance' data-ref="135instance" data-ref-filename="135instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::clientnotified" title='service_instance::clientnotified' data-ref="service_instance::clientnotified" data-ref-filename="service_instance..clientnotified">clientnotified</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>; }</td></tr>
<tr><th id="928">928</th><td>        }</td></tr>
<tr><th id="929">929</th><td>    }</td></tr>
<tr><th id="930">930</th><td>}</td></tr>
<tr><th id="931">931</th><td></td></tr>
<tr><th id="932">932</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="regrecord_callback" title='regrecord_callback' data-ref="regrecord_callback" data-ref-filename="regrecord_callback">regrecord_callback</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS" title='mDNS' data-type='struct mDNS_struct' data-ref="mDNS" data-ref-filename="mDNS">mDNS</a> *<em>const</em> <dfn class="local col0 decl" id="140m" title='m' data-type='mDNS *const' data-ref="140m" data-ref-filename="140m">m</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord" title='AuthRecord' data-type='struct AuthRecord_struct' data-ref="AuthRecord" data-ref-filename="AuthRecord">AuthRecord</a> *<dfn class="local col1 decl" id="141rr" title='rr' data-type='AuthRecord *' data-ref="141rr" data-ref-filename="141rr">rr</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="local col2 decl" id="142result" title='result' data-type='mStatus' data-ref="142result" data-ref-filename="142result">result</dfn>)</td></tr>
<tr><th id="933">933</th><td>{</td></tr>
<tr><th id="934">934</th><td>    (<em>void</em>)<a class="local col0 ref" href="#140m" title='m' data-ref="140m" data-ref-filename="140m">m</a>; <i>// Unused</i></td></tr>
<tr><th id="935">935</th><td>    <b>if</b> (!<a class="local col1 ref" href="#141rr" title='rr' data-ref="141rr" data-ref-filename="141rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::RecordContext" title='AuthRecord_struct::RecordContext' data-ref="AuthRecord_struct::RecordContext" data-ref-filename="AuthRecord_struct..RecordContext">RecordContext</a>)     <i>// parent struct already freed by termination callback</i></td></tr>
<tr><th id="936">936</th><td>    {</td></tr>
<tr><th id="937">937</th><td>        <b>if</b> (<a class="local col2 ref" href="#142result" title='result' data-ref="142result" data-ref-filename="142result">result</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_NoError" title='mStatus_NoError' data-ref="mStatus_NoError" data-ref-filename="mStatus_NoError">mStatus_NoError</a>)</td></tr>
<tr><th id="938">938</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;Error: regrecord_callback: successful registration of orphaned record %s&quot;, GetRRDisplayString_rdb(&amp;(rr)-&gt;resrec, &amp;(rr)-&gt;resrec.rdata-&gt;u, (m)-&gt;MsgBuffer))" data-ref="_M/LogMsg">LogMsg</a>(<q>"Error: regrecord_callback: successful registration of orphaned record %s"</q>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2942" title="GetRRDisplayString_rdb(&amp;(rr)-&gt;resrec, &amp;(rr)-&gt;resrec.rdata-&gt;u, (m)-&gt;MsgBuffer)" data-ref="_M/ARDisplayString">ARDisplayString</a>(<a class="local col0 ref" href="#140m" title='m' data-ref="140m" data-ref-filename="140m">m</a>, <a class="local col1 ref" href="#141rr" title='rr' data-ref="141rr" data-ref-filename="141rr">rr</a>));</td></tr>
<tr><th id="939">939</th><td>        <b>else</b></td></tr>
<tr><th id="940">940</th><td>        {</td></tr>
<tr><th id="941">941</th><td>            <b>if</b> (<a class="local col2 ref" href="#142result" title='result' data-ref="142result" data-ref-filename="142result">result</a> != <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_MemFree" title='mStatus_MemFree' data-ref="mStatus_MemFree" data-ref-filename="mStatus_MemFree">mStatus_MemFree</a>) <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;regrecord_callback: error %d received after parent termination&quot;, result)" data-ref="_M/LogMsg">LogMsg</a>(<q>"regrecord_callback: error %d received after parent termination"</q>, <a class="local col2 ref" href="#142result" title='result' data-ref="142result" data-ref-filename="142result">result</a>);</td></tr>
<tr><th id="942">942</th><td></td></tr>
<tr><th id="943">943</th><td>            <i>// We come here when the record is being deregistered either from DNSServiceRemoveRecord or connection_termination.</i></td></tr>
<tr><th id="944">944</th><td><i>            // If the record has been updated, we need to free the rdata. Every time we call mDNS_Update, it calls update_callback</i></td></tr>
<tr><th id="945">945</th><td><i>            // with the old rdata (so that we can free it) and stores the new rdata in "rr-&gt;resrec.rdata". This means, we need</i></td></tr>
<tr><th id="946">946</th><td><i>            // to free the latest rdata for which the update_callback was never called with.</i></td></tr>
<tr><th id="947">947</th><td>            <b>if</b> (<a class="local col1 ref" href="#141rr" title='rr' data-ref="141rr" data-ref-filename="141rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdata" title='ResourceRecord_struct::rdata' data-ref="ResourceRecord_struct::rdata" data-ref-filename="ResourceRecord_struct..rdata">rdata</a> != &amp;<a class="local col1 ref" href="#141rr" title='rr' data-ref="141rr" data-ref-filename="141rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::rdatastorage" title='AuthRecord_struct::rdatastorage' data-ref="AuthRecord_struct::rdatastorage" data-ref-filename="AuthRecord_struct..rdatastorage">rdatastorage</a>) <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(rr-&gt;resrec.rdata)" data-ref="_M/freeL">freeL</a>(<q>"RData/regrecord_callback"</q>, <a class="local col1 ref" href="#141rr" title='rr' data-ref="141rr" data-ref-filename="141rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdata" title='ResourceRecord_struct::rdata' data-ref="ResourceRecord_struct::rdata" data-ref-filename="ResourceRecord_struct..rdata">rdata</a>);</td></tr>
<tr><th id="948">948</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(rr)" data-ref="_M/freeL">freeL</a>(<q>"AuthRecord/regrecord_callback"</q>, <a class="local col1 ref" href="#141rr" title='rr' data-ref="141rr" data-ref-filename="141rr">rr</a>);</td></tr>
<tr><th id="949">949</th><td>        }</td></tr>
<tr><th id="950">950</th><td>    }</td></tr>
<tr><th id="951">951</th><td>    <b>else</b></td></tr>
<tr><th id="952">952</th><td>    {</td></tr>
<tr><th id="953">953</th><td>        <a class="typedef" href="uds_daemon.h.html#registered_record_entry" title='registered_record_entry' data-type='struct registered_record_entry' data-ref="registered_record_entry" data-ref-filename="registered_record_entry">registered_record_entry</a> *<dfn class="local col3 decl" id="143re" title='re' data-type='registered_record_entry *' data-ref="143re" data-ref-filename="143re">re</dfn> = <a class="local col1 ref" href="#141rr" title='rr' data-ref="141rr" data-ref-filename="141rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::RecordContext" title='AuthRecord_struct::RecordContext' data-ref="AuthRecord_struct::RecordContext" data-ref-filename="AuthRecord_struct..RecordContext">RecordContext</a>;</td></tr>
<tr><th id="954">954</th><td>        <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col4 decl" id="144request" title='request' data-type='request_state *' data-ref="144request" data-ref-filename="144request">request</dfn> = <a class="local col3 ref" href="#143re" title='re' data-ref="143re" data-ref-filename="143re">re</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::request" title='registered_record_entry::request' data-ref="registered_record_entry::request" data-ref-filename="registered_record_entry..request">request</a>;</td></tr>
<tr><th id="955">955</th><td></td></tr>
<tr><th id="956">956</th><td>        <b>if</b> (<a class="ref" href="../mDNSCore/mDNSDebug.h.html#mDNS_LoggingEnabled" title='mDNS_LoggingEnabled' data-ref="mDNS_LoggingEnabled" data-ref-filename="mDNS_LoggingEnabled">mDNS_LoggingEnabled</a>)</td></tr>
<tr><th id="957">957</th><td>        {</td></tr>
<tr><th id="958">958</th><td>            <em>char</em> *<dfn class="local col5 decl" id="145fmt" title='fmt' data-type='char *' data-ref="145fmt" data-ref-filename="145fmt">fmt</dfn> = (<a class="local col2 ref" href="#142result" title='result' data-ref="142result" data-ref-filename="142result">result</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_NoError" title='mStatus_NoError' data-ref="mStatus_NoError" data-ref-filename="mStatus_NoError">mStatus_NoError</a>)      ? <q>"%3d: DNSServiceRegisterRecord(%u %s) REGISTERED"</q>    :</td></tr>
<tr><th id="959">959</th><td>                        (<a class="local col2 ref" href="#142result" title='result' data-ref="142result" data-ref-filename="142result">result</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_MemFree" title='mStatus_MemFree' data-ref="mStatus_MemFree" data-ref-filename="mStatus_MemFree">mStatus_MemFree</a>)      ? <q>"%3d: DNSServiceRegisterRecord(%u %s) DEREGISTERED"</q>  :</td></tr>
<tr><th id="960">960</th><td>                        (<a class="local col2 ref" href="#142result" title='result' data-ref="142result" data-ref-filename="142result">result</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_NameConflict" title='mStatus_NameConflict' data-ref="mStatus_NameConflict" data-ref-filename="mStatus_NameConflict">mStatus_NameConflict</a>) ? <q>"%3d: DNSServiceRegisterRecord(%u %s) NAME CONFLICT"</q> :</td></tr>
<tr><th id="961">961</th><td>                        <q>"%3d: DNSServiceRegisterRecord(%u %s) %d"</q>;</td></tr>
<tr><th id="962">962</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, fmt, request-&gt;sd, re-&gt;key, GetRRDisplayString_rdb(&amp;rr-&gt;resrec, &amp;(&amp;rr-&gt;resrec)-&gt;rdata-&gt;u, (m)-&gt;MsgBuffer), result);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<a class="local col5 ref" href="#145fmt" title='fmt' data-ref="145fmt" data-ref-filename="145fmt">fmt</a>, <a class="local col4 ref" href="#144request" title='request' data-ref="144request" data-ref-filename="144request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col3 ref" href="#143re" title='re' data-ref="143re" data-ref-filename="143re">re</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::key" title='registered_record_entry::key' data-ref="registered_record_entry::key" data-ref-filename="registered_record_entry..key">key</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2941" title="GetRRDisplayString_rdb(&amp;rr-&gt;resrec, &amp;(&amp;rr-&gt;resrec)-&gt;rdata-&gt;u, (m)-&gt;MsgBuffer)" data-ref="_M/RRDisplayString">RRDisplayString</a>(<a class="local col0 ref" href="#140m" title='m' data-ref="140m" data-ref-filename="140m">m</a>, &amp;<a class="local col1 ref" href="#141rr" title='rr' data-ref="141rr" data-ref-filename="141rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>), <a class="local col2 ref" href="#142result" title='result' data-ref="142result" data-ref-filename="142result">result</a>);</td></tr>
<tr><th id="963">963</th><td>        }</td></tr>
<tr><th id="964">964</th><td></td></tr>
<tr><th id="965">965</th><td>        <b>if</b> (<a class="local col2 ref" href="#142result" title='result' data-ref="142result" data-ref-filename="142result">result</a> != <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_MemFree" title='mStatus_MemFree' data-ref="mStatus_MemFree" data-ref-filename="mStatus_MemFree">mStatus_MemFree</a>)</td></tr>
<tr><th id="966">966</th><td>        {</td></tr>
<tr><th id="967">967</th><td>            <em>int</em> <dfn class="local col6 decl" id="146len" title='len' data-type='int' data-ref="146len" data-ref-filename="146len">len</dfn> = <b>sizeof</b>(<a class="typedef" href="dns_sd.h.html#DNSServiceFlags" title='DNSServiceFlags' data-type='uint32_t' data-ref="DNSServiceFlags" data-ref-filename="DNSServiceFlags">DNSServiceFlags</a>) + <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a>) + <b>sizeof</b>(<a class="typedef" href="dns_sd.h.html#DNSServiceErrorType" title='DNSServiceErrorType' data-type='int32_t' data-ref="DNSServiceErrorType" data-ref-filename="DNSServiceErrorType">DNSServiceErrorType</a>);</td></tr>
<tr><th id="968">968</th><td>            <a class="typedef" href="uds_daemon.h.html#reply_state" title='reply_state' data-type='struct reply_state' data-ref="reply_state" data-ref-filename="reply_state">reply_state</a> *<dfn class="local col7 decl" id="147reply" title='reply' data-type='reply_state *' data-ref="147reply" data-ref-filename="147reply">reply</dfn> = <a class="ref fn" href="#create_reply" title='create_reply' data-ref="create_reply" data-ref-filename="create_reply">create_reply</a>(<a class="enum" href="dnssd_ipc.h.html#reg_record_reply_op" title='reg_record_reply_op' data-ref="reg_record_reply_op" data-ref-filename="reg_record_reply_op">reg_record_reply_op</a>, <a class="local col6 ref" href="#146len" title='len' data-ref="146len" data-ref-filename="146len">len</a>, <a class="local col4 ref" href="#144request" title='request' data-ref="144request" data-ref-filename="144request">request</a>);</td></tr>
<tr><th id="969">969</th><td>            <a class="local col7 ref" href="#147reply" title='reply' data-ref="147reply" data-ref-filename="147reply">reply</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::mhdr" title='reply_state::mhdr' data-ref="reply_state::mhdr" data-ref-filename="reply_state..mhdr">mhdr</a>-&gt;<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::client_context" title='(anonymous struct)::client_context' data-ref="(anonymous)::client_context" data-ref-filename="(anonymous)..client_context">client_context</a> = <a class="local col3 ref" href="#143re" title='re' data-ref="143re" data-ref-filename="143re">re</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::regrec_client_context" title='registered_record_entry::regrec_client_context' data-ref="registered_record_entry::regrec_client_context" data-ref-filename="registered_record_entry..regrec_client_context">regrec_client_context</a>;</td></tr>
<tr><th id="970">970</th><td>            <a class="local col7 ref" href="#147reply" title='reply' data-ref="147reply" data-ref-filename="147reply">reply</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::rhdr" title='reply_state::rhdr' data-ref="reply_state::rhdr" data-ref-filename="reply_state..rhdr">rhdr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#(anonymous)::flags" title='(anonymous struct)::flags' data-ref="(anonymous)::flags" data-ref-filename="(anonymous)..flags">flags</a> = <a class="ref fn" href="#dnssd_htonl" title='dnssd_htonl' data-ref="dnssd_htonl" data-ref-filename="dnssd_htonl">dnssd_htonl</a>(<var>0</var>);</td></tr>
<tr><th id="971">971</th><td>            <a class="local col7 ref" href="#147reply" title='reply' data-ref="147reply" data-ref-filename="147reply">reply</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::rhdr" title='reply_state::rhdr' data-ref="reply_state::rhdr" data-ref-filename="reply_state..rhdr">rhdr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#(anonymous)::ifi" title='(anonymous struct)::ifi' data-ref="(anonymous)::ifi" data-ref-filename="(anonymous)..ifi">ifi</a>   = <a class="ref fn" href="#dnssd_htonl" title='dnssd_htonl' data-ref="dnssd_htonl" data-ref-filename="dnssd_htonl">dnssd_htonl</a>(<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformInterfaceIndexfromInterfaceID" title='mDNSPlatformInterfaceIndexfromInterfaceID' data-ref="mDNSPlatformInterfaceIndexfromInterfaceID" data-ref-filename="mDNSPlatformInterfaceIndexfromInterfaceID">mDNSPlatformInterfaceIndexfromInterfaceID</a>(<a class="local col0 ref" href="#140m" title='m' data-ref="140m" data-ref-filename="140m">m</a>, <a class="local col1 ref" href="#141rr" title='rr' data-ref="141rr" data-ref-filename="141rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::InterfaceID" title='ResourceRecord_struct::InterfaceID' data-ref="ResourceRecord_struct::InterfaceID" data-ref-filename="ResourceRecord_struct..InterfaceID">InterfaceID</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>));</td></tr>
<tr><th id="972">972</th><td>            <a class="local col7 ref" href="#147reply" title='reply' data-ref="147reply" data-ref-filename="147reply">reply</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::rhdr" title='reply_state::rhdr' data-ref="reply_state::rhdr" data-ref-filename="reply_state..rhdr">rhdr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#(anonymous)::error" title='(anonymous struct)::error' data-ref="(anonymous)::error" data-ref-filename="(anonymous)..error">error</a> = <a class="ref fn" href="#dnssd_htonl" title='dnssd_htonl' data-ref="dnssd_htonl" data-ref-filename="dnssd_htonl">dnssd_htonl</a>(<a class="local col2 ref" href="#142result" title='result' data-ref="142result" data-ref-filename="142result">result</a>);</td></tr>
<tr><th id="973">973</th><td>            <a class="ref fn" href="#append_reply" title='append_reply' data-ref="append_reply" data-ref-filename="append_reply">append_reply</a>(<a class="local col4 ref" href="#144request" title='request' data-ref="144request" data-ref-filename="144request">request</a>, <a class="local col7 ref" href="#147reply" title='reply' data-ref="147reply" data-ref-filename="147reply">reply</a>);</td></tr>
<tr><th id="974">974</th><td>        }</td></tr>
<tr><th id="975">975</th><td></td></tr>
<tr><th id="976">976</th><td>        <b>if</b> (<a class="local col2 ref" href="#142result" title='result' data-ref="142result" data-ref-filename="142result">result</a>)</td></tr>
<tr><th id="977">977</th><td>        {</td></tr>
<tr><th id="978">978</th><td>            <i>// If this is a callback to a keepalive record, do not free it.</i></td></tr>
<tr><th id="979">979</th><td>            <b>if</b> (<a class="local col2 ref" href="#142result" title='result' data-ref="142result" data-ref-filename="142result">result</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadStateErr" title='mStatus_BadStateErr' data-ref="mStatus_BadStateErr" data-ref-filename="mStatus_BadStateErr">mStatus_BadStateErr</a>)</td></tr>
<tr><th id="980">980</th><td>            {</td></tr>
<tr><th id="981">981</th><td>                <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;regrecord_callback: Callback with error code mStatus_BadStateErr - not freeing the record.&quot;);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"regrecord_callback: Callback with error code mStatus_BadStateErr - not freeing the record."</q>);</td></tr>
<tr><th id="982">982</th><td>            }</td></tr>
<tr><th id="983">983</th><td>            <b>else</b></td></tr>
<tr><th id="984">984</th><td>            {</td></tr>
<tr><th id="985">985</th><td>                <i>// unlink from list, free memory</i></td></tr>
<tr><th id="986">986</th><td>                <a class="typedef" href="uds_daemon.h.html#registered_record_entry" title='registered_record_entry' data-type='struct registered_record_entry' data-ref="registered_record_entry" data-ref-filename="registered_record_entry">registered_record_entry</a> **<dfn class="local col8 decl" id="148ptr" title='ptr' data-type='registered_record_entry **' data-ref="148ptr" data-ref-filename="148ptr">ptr</dfn> = &amp;<a class="local col4 ref" href="#144request" title='request' data-ref="144request" data-ref-filename="144request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::reg_recs" title='request_state::(anonymous union)::reg_recs' data-ref="request_state::(anonymous)::reg_recs" data-ref-filename="request_state..(anonymous)..reg_recs">reg_recs</a>;</td></tr>
<tr><th id="987">987</th><td>                <b>while</b> (*<a class="local col8 ref" href="#148ptr" title='ptr' data-ref="148ptr" data-ref-filename="148ptr">ptr</a> &amp;&amp; (*<a class="local col8 ref" href="#148ptr" title='ptr' data-ref="148ptr" data-ref-filename="148ptr">ptr</a>) != <a class="local col3 ref" href="#143re" title='re' data-ref="143re" data-ref-filename="143re">re</a>) <a class="local col8 ref" href="#148ptr" title='ptr' data-ref="148ptr" data-ref-filename="148ptr">ptr</a> = &amp;(*<a class="local col8 ref" href="#148ptr" title='ptr' data-ref="148ptr" data-ref-filename="148ptr">ptr</a>)-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::next" title='registered_record_entry::next' data-ref="registered_record_entry::next" data-ref-filename="registered_record_entry..next">next</a>;</td></tr>
<tr><th id="988">988</th><td>                <b>if</b> (!*<a class="local col8 ref" href="#148ptr" title='ptr' data-ref="148ptr" data-ref-filename="148ptr">ptr</a>) { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;regrecord_callback - record not in list!&quot;)" data-ref="_M/LogMsg">LogMsg</a>(<q>"regrecord_callback - record not in list!"</q>); <b>return</b>; }</td></tr>
<tr><th id="989">989</th><td>                *<a class="local col8 ref" href="#148ptr" title='ptr' data-ref="148ptr" data-ref-filename="148ptr">ptr</a> = (*<a class="local col8 ref" href="#148ptr" title='ptr' data-ref="148ptr" data-ref-filename="148ptr">ptr</a>)-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::next" title='registered_record_entry::next' data-ref="registered_record_entry::next" data-ref-filename="registered_record_entry..next">next</a>;</td></tr>
<tr><th id="990">990</th><td>                <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(re-&gt;rr)" data-ref="_M/freeL">freeL</a>(<q>"registered_record_entry AuthRecord regrecord_callback"</q>, <a class="local col3 ref" href="#143re" title='re' data-ref="143re" data-ref-filename="143re">re</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::rr" title='registered_record_entry::rr' data-ref="registered_record_entry::rr" data-ref-filename="registered_record_entry..rr">rr</a>);</td></tr>
<tr><th id="991">991</th><td>                <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(re)" data-ref="_M/freeL">freeL</a>(<q>"registered_record_entry regrecord_callback"</q>, <a class="local col3 ref" href="#143re" title='re' data-ref="143re" data-ref-filename="143re">re</a>);</td></tr>
<tr><th id="992">992</th><td>             }</td></tr>
<tr><th id="993">993</th><td>        }</td></tr>
<tr><th id="994">994</th><td>        <b>else</b></td></tr>
<tr><th id="995">995</th><td>        {</td></tr>
<tr><th id="996">996</th><td>            <b>if</b> (<a class="local col3 ref" href="#143re" title='re' data-ref="143re" data-ref-filename="143re">re</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::external_advertise" title='registered_record_entry::external_advertise' data-ref="registered_record_entry::external_advertise" data-ref-filename="registered_record_entry..external_advertise">external_advertise</a>) <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;regrecord_callback: external_advertise already set!&quot;)" data-ref="_M/LogMsg">LogMsg</a>(<q>"regrecord_callback: external_advertise already set!"</q>);</td></tr>
<tr><th id="997">997</th><td></td></tr>
<tr><th id="998">998</th><td>            <b>if</b> (<a class="ref fn" href="#callExternalHelpers" title='callExternalHelpers' data-ref="callExternalHelpers" data-ref-filename="callExternalHelpers">callExternalHelpers</a>(<a class="local col3 ref" href="#143re" title='re' data-ref="143re" data-ref-filename="143re">re</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::origInterfaceID" title='registered_record_entry::origInterfaceID' data-ref="registered_record_entry::origInterfaceID" data-ref-filename="registered_record_entry..origInterfaceID">origInterfaceID</a>, &amp;<a class="local col1 ref" href="#141rr" title='rr' data-ref="141rr" data-ref-filename="141rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::namestorage" title='AuthRecord_struct::namestorage' data-ref="AuthRecord_struct::namestorage" data-ref-filename="AuthRecord_struct..namestorage">namestorage</a>, <a class="local col4 ref" href="#144request" title='request' data-ref="144request" data-ref-filename="144request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a>))</td></tr>
<tr><th id="999">999</th><td>            {</td></tr>
<tr><th id="1000">1000</th><td>                <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;regrecord_callback: calling external_start_advertising_service&quot;);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"regrecord_callback: calling external_start_advertising_service"</q>);</td></tr>
<tr><th id="1001">1001</th><td>                <a class="macro" href="uds_daemon.h.html#266" title="(void)(&amp;rr-&gt;resrec)" data-ref="_M/external_start_advertising_service">external_start_advertising_service</a>(&amp;<a class="local col1 ref" href="#141rr" title='rr' data-ref="141rr" data-ref-filename="141rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>, request-&gt;flags);</td></tr>
<tr><th id="1002">1002</th><td>                <a class="local col3 ref" href="#143re" title='re' data-ref="143re" data-ref-filename="143re">re</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::external_advertise" title='registered_record_entry::external_advertise' data-ref="registered_record_entry::external_advertise" data-ref-filename="registered_record_entry..external_advertise">external_advertise</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>;</td></tr>
<tr><th id="1003">1003</th><td>            }</td></tr>
<tr><th id="1004">1004</th><td>        }</td></tr>
<tr><th id="1005">1005</th><td>    }</td></tr>
<tr><th id="1006">1006</th><td>}</td></tr>
<tr><th id="1007">1007</th><td></td></tr>
<tr><th id="1008">1008</th><td><i>// set_peer_pid() is called after mem is allocated for each new request in NewRequest()</i></td></tr>
<tr><th id="1009">1009</th><td><i>// This accounts for 2 places (connect_callback, request_callback)</i></td></tr>
<tr><th id="1010">1010</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="set_peer_pid" title='set_peer_pid' data-ref="set_peer_pid" data-ref-filename="set_peer_pid">set_peer_pid</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col9 decl" id="149request" title='request' data-type='request_state *' data-ref="149request" data-ref-filename="149request">request</dfn>)</td></tr>
<tr><th id="1011">1011</th><td>{</td></tr>
<tr><th id="1012">1012</th><td>    <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#183" title="__pid_t" data-ref="_M/pid_t">pid_t</a>           <dfn class="local col0 decl" id="150p" title='p' data-type='__pid_t' data-ref="150p" data-ref-filename="150p">p</dfn>    = (<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#183" title="__pid_t" data-ref="_M/pid_t">pid_t</a>) -<var>1</var>;</td></tr>
<tr><th id="1013">1013</th><td>    <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#84" title="__socklen_t" data-ref="_M/socklen_t">socklen_t</a>       <dfn class="local col1 decl" id="151len" title='len' data-type='__socklen_t' data-ref="151len" data-ref-filename="151len">len</dfn>  = <b>sizeof</b>(<a class="local col0 ref" href="#150p" title='p' data-ref="150p" data-ref-filename="150p">p</a>);</td></tr>
<tr><th id="1014">1014</th><td>    <a class="local col9 ref" href="#149request" title='request' data-ref="149request" data-ref-filename="149request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>[<var>0</var>] = <kbd>'\0'</kbd>;</td></tr>
<tr><th id="1015">1015</th><td>    <a class="local col9 ref" href="#149request" title='request' data-ref="149request" data-ref-filename="149request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>  = -<var>1</var>;</td></tr>
<tr><th id="1016">1016</th><td><u>#<span data-ppcond="1016">ifdef</span> <span class="macro" data-ref="_M/LOCAL_PEEREPID">LOCAL_PEEREPID</span></u></td></tr>
<tr><th id="1017">1017</th><td>    <b>if</b> (request-&gt;sd &lt; <var>0</var>)</td></tr>
<tr><th id="1018">1018</th><td>        <b>return</b>;</td></tr>
<tr><th id="1019">1019</th><td>    <i>// to extract the effective pid value</i></td></tr>
<tr><th id="1020">1020</th><td>    <b>if</b> (getsockopt(request-&gt;sd, SOL_LOCAL, LOCAL_PEEREPID, &amp;p, &amp;len) != <var>0</var>)</td></tr>
<tr><th id="1021">1021</th><td>        <b>return</b>;</td></tr>
<tr><th id="1022">1022</th><td>    <i>// to extract the process name from the pid value</i></td></tr>
<tr><th id="1023">1023</th><td>    <b>if</b> (proc_pidinfo(p, PROC_PIDT_SHORTBSDINFO, <var>1</var>, &amp;proc, PROC_PIDT_SHORTBSDINFO_SIZE) == <var>0</var>)</td></tr>
<tr><th id="1024">1024</th><td>        <b>return</b>;</td></tr>
<tr><th id="1025">1025</th><td>    mDNSPlatformStrLCopy(request-&gt;pid_name, proc.pbsi_comm, <b>sizeof</b>(request-&gt;pid_name));</td></tr>
<tr><th id="1026">1026</th><td>    request-&gt;process_id = p;</td></tr>
<tr><th id="1027">1027</th><td>    debugf(<q>"set_peer_pid: Client PEEREPID is %d %s"</q>, p, request-&gt;pid_name);</td></tr>
<tr><th id="1028">1028</th><td><u>#<span data-ppcond="1016">else</span>   // !LOCAL_PEEREPID</u></td></tr>
<tr><th id="1029">1029</th><td>    <a class="local col1 ref" href="#151len" title='len' data-ref="151len" data-ref-filename="151len">len</a> = <var>0</var>;</td></tr>
<tr><th id="1030">1030</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;set_peer_pid: Not Supported on this version of OS&quot;);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"set_peer_pid: Not Supported on this version of OS"</q>);</td></tr>
<tr><th id="1031">1031</th><td>    <b>if</b> (<a class="local col9 ref" href="#149request" title='request' data-ref="149request" data-ref-filename="149request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a> &lt; <var>0</var>)</td></tr>
<tr><th id="1032">1032</th><td>        <b>return</b>;</td></tr>
<tr><th id="1033">1033</th><td><u>#<span data-ppcond="1016">endif</span>  // LOCAL_PEEREPID</u></td></tr>
<tr><th id="1034">1034</th><td>}</td></tr>
<tr><th id="1035">1035</th><td></td></tr>
<tr><th id="1036">1036</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="connection_termination" title='connection_termination' data-ref="connection_termination" data-ref-filename="connection_termination">connection_termination</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col2 decl" id="152request" title='request' data-type='request_state *' data-ref="152request" data-ref-filename="152request">request</dfn>)</td></tr>
<tr><th id="1037">1037</th><td>{</td></tr>
<tr><th id="1038">1038</th><td>    <i>// When terminating a shared connection, we need to scan the all_requests list</i></td></tr>
<tr><th id="1039">1039</th><td><i>    // and terminate any subbordinate operations sharing this file descriptor</i></td></tr>
<tr><th id="1040">1040</th><td>    <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> **<dfn class="local col3 decl" id="153req" title='req' data-type='request_state **' data-ref="153req" data-ref-filename="153req">req</dfn> = &amp;<a class="tu ref" href="#all_requests" title='all_requests' data-use='a' data-ref="all_requests" data-ref-filename="all_requests">all_requests</a>;</td></tr>
<tr><th id="1041">1041</th><td></td></tr>
<tr><th id="1042">1042</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: DNSServiceCreateConnection STOP PID[%d](%s)&quot;, request-&gt;sd, request-&gt;process_id, request-&gt;pid_name);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: DNSServiceCreateConnection STOP PID[%d](%s)"</q>, <a class="local col2 ref" href="#152request" title='request' data-ref="152request" data-ref-filename="152request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col2 ref" href="#152request" title='request' data-ref="152request" data-ref-filename="152request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col2 ref" href="#152request" title='request' data-ref="152request" data-ref-filename="152request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="1043">1043</th><td></td></tr>
<tr><th id="1044">1044</th><td>    <b>while</b> (*<a class="local col3 ref" href="#153req" title='req' data-ref="153req" data-ref-filename="153req">req</a>)</td></tr>
<tr><th id="1045">1045</th><td>    {</td></tr>
<tr><th id="1046">1046</th><td>        <b>if</b> ((*<a class="local col3 ref" href="#153req" title='req' data-ref="153req" data-ref-filename="153req">req</a>)-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::primary" title='request_state::primary' data-ref="request_state::primary" data-ref-filename="request_state..primary">primary</a> == <a class="local col2 ref" href="#152request" title='request' data-ref="152request" data-ref-filename="152request">request</a>)</td></tr>
<tr><th id="1047">1047</th><td>        {</td></tr>
<tr><th id="1048">1048</th><td>            <i>// Since we're already doing a list traversal, we unlink the request directly instead of using AbortUnlinkAndFree()</i></td></tr>
<tr><th id="1049">1049</th><td>            <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col4 decl" id="154tmp" title='tmp' data-type='request_state *' data-ref="154tmp" data-ref-filename="154tmp">tmp</dfn> = *<a class="local col3 ref" href="#153req" title='req' data-ref="153req" data-ref-filename="153req">req</a>;</td></tr>
<tr><th id="1050">1050</th><td>            <b>if</b> (<a class="local col4 ref" href="#154tmp" title='tmp' data-ref="154tmp" data-ref-filename="154tmp">tmp</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::primary" title='request_state::primary' data-ref="request_state::primary" data-ref-filename="request_state..primary">primary</a> == <a class="local col4 ref" href="#154tmp" title='tmp' data-ref="154tmp" data-ref-filename="154tmp">tmp</a>) <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;connection_termination ERROR (*req)-&gt;primary == *req for %p %d&quot;, tmp, tmp-&gt;sd)" data-ref="_M/LogMsg">LogMsg</a>(<q>"connection_termination ERROR (*req)-&gt;primary == *req for %p %d"</q>,                  <a class="local col4 ref" href="#154tmp" title='tmp' data-ref="154tmp" data-ref-filename="154tmp">tmp</a>, <a class="local col4 ref" href="#154tmp" title='tmp' data-ref="154tmp" data-ref-filename="154tmp">tmp</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>);</td></tr>
<tr><th id="1051">1051</th><td>            <b>if</b> (<a class="local col4 ref" href="#154tmp" title='tmp' data-ref="154tmp" data-ref-filename="154tmp">tmp</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::replies" title='request_state::replies' data-ref="request_state::replies" data-ref-filename="request_state..replies">replies</a>) <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;connection_termination ERROR How can subordinate req %p %d have replies queued?&quot;, tmp, tmp-&gt;sd)" data-ref="_M/LogMsg">LogMsg</a>(<q>"connection_termination ERROR How can subordinate req %p %d have replies queued?"</q>, <a class="local col4 ref" href="#154tmp" title='tmp' data-ref="154tmp" data-ref-filename="154tmp">tmp</a>, <a class="local col4 ref" href="#154tmp" title='tmp' data-ref="154tmp" data-ref-filename="154tmp">tmp</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>);</td></tr>
<tr><th id="1052">1052</th><td>            <a class="ref fn" href="#abort_request" title='abort_request' data-ref="abort_request" data-ref-filename="abort_request">abort_request</a>(<a class="local col4 ref" href="#154tmp" title='tmp' data-ref="154tmp" data-ref-filename="154tmp">tmp</a>);</td></tr>
<tr><th id="1053">1053</th><td>            *<a class="local col3 ref" href="#153req" title='req' data-ref="153req" data-ref-filename="153req">req</a> = <a class="local col4 ref" href="#154tmp" title='tmp' data-ref="154tmp" data-ref-filename="154tmp">tmp</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::next" title='request_state::next' data-ref="request_state::next" data-ref-filename="request_state..next">next</a>;</td></tr>
<tr><th id="1054">1054</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(tmp)" data-ref="_M/freeL">freeL</a>(<q>"request_state/connection_termination"</q>, <a class="local col4 ref" href="#154tmp" title='tmp' data-ref="154tmp" data-ref-filename="154tmp">tmp</a>);</td></tr>
<tr><th id="1055">1055</th><td>        }</td></tr>
<tr><th id="1056">1056</th><td>        <b>else</b></td></tr>
<tr><th id="1057">1057</th><td>            <a class="local col3 ref" href="#153req" title='req' data-ref="153req" data-ref-filename="153req">req</a> = &amp;(*<a class="local col3 ref" href="#153req" title='req' data-ref="153req" data-ref-filename="153req">req</a>)-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::next" title='request_state::next' data-ref="request_state::next" data-ref-filename="request_state..next">next</a>;</td></tr>
<tr><th id="1058">1058</th><td>    }</td></tr>
<tr><th id="1059">1059</th><td></td></tr>
<tr><th id="1060">1060</th><td>    <b>while</b> (<a class="local col2 ref" href="#152request" title='request' data-ref="152request" data-ref-filename="152request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::reg_recs" title='request_state::(anonymous union)::reg_recs' data-ref="request_state::(anonymous)::reg_recs" data-ref-filename="request_state..(anonymous)..reg_recs">reg_recs</a>)</td></tr>
<tr><th id="1061">1061</th><td>    {</td></tr>
<tr><th id="1062">1062</th><td>        <a class="typedef" href="uds_daemon.h.html#registered_record_entry" title='registered_record_entry' data-type='struct registered_record_entry' data-ref="registered_record_entry" data-ref-filename="registered_record_entry">registered_record_entry</a> *<dfn class="local col5 decl" id="155ptr" title='ptr' data-type='registered_record_entry *' data-ref="155ptr" data-ref-filename="155ptr">ptr</dfn> = <a class="local col2 ref" href="#152request" title='request' data-ref="152request" data-ref-filename="152request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::reg_recs" title='request_state::(anonymous union)::reg_recs' data-ref="request_state::(anonymous)::reg_recs" data-ref-filename="request_state..(anonymous)..reg_recs">reg_recs</a>;</td></tr>
<tr><th id="1063">1063</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: DNSServiceRegisterRecord(%u %s) STOP PID[%d](%s)&quot;, request-&gt;sd, ptr-&gt;key, GetRRDisplayString_rdb(&amp;ptr-&gt;rr-&gt;resrec, &amp;(&amp;ptr-&gt;rr-&gt;resrec)-&gt;rdata-&gt;u, (&amp;mDNSStorage)-&gt;MsgBuffer), request-&gt;process_id, request-&gt;pid_name);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: DNSServiceRegisterRecord(%u %s) STOP PID[%d](%s)"</q>, <a class="local col2 ref" href="#152request" title='request' data-ref="152request" data-ref-filename="152request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col5 ref" href="#155ptr" title='ptr' data-ref="155ptr" data-ref-filename="155ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::key" title='registered_record_entry::key' data-ref="registered_record_entry::key" data-ref-filename="registered_record_entry..key">key</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2941" title="GetRRDisplayString_rdb(&amp;ptr-&gt;rr-&gt;resrec, &amp;(&amp;ptr-&gt;rr-&gt;resrec)-&gt;rdata-&gt;u, (&amp;mDNSStorage)-&gt;MsgBuffer)" data-ref="_M/RRDisplayString">RRDisplayString</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col5 ref" href="#155ptr" title='ptr' data-ref="155ptr" data-ref-filename="155ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::rr" title='registered_record_entry::rr' data-ref="registered_record_entry::rr" data-ref-filename="registered_record_entry..rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>), <a class="local col2 ref" href="#152request" title='request' data-ref="152request" data-ref-filename="152request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col2 ref" href="#152request" title='request' data-ref="152request" data-ref-filename="152request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="1064">1064</th><td>        <a class="local col2 ref" href="#152request" title='request' data-ref="152request" data-ref-filename="152request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::reg_recs" title='request_state::(anonymous union)::reg_recs' data-ref="request_state::(anonymous)::reg_recs" data-ref-filename="request_state..(anonymous)..reg_recs">reg_recs</a> = <a class="local col2 ref" href="#152request" title='request' data-ref="152request" data-ref-filename="152request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::reg_recs" title='request_state::(anonymous union)::reg_recs' data-ref="request_state::(anonymous)::reg_recs" data-ref-filename="request_state..(anonymous)..reg_recs">reg_recs</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::next" title='registered_record_entry::next' data-ref="registered_record_entry::next" data-ref-filename="registered_record_entry..next">next</a>;</td></tr>
<tr><th id="1065">1065</th><td>        <a class="local col5 ref" href="#155ptr" title='ptr' data-ref="155ptr" data-ref-filename="155ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::rr" title='registered_record_entry::rr' data-ref="registered_record_entry::rr" data-ref-filename="registered_record_entry..rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::RecordContext" title='AuthRecord_struct::RecordContext' data-ref="AuthRecord_struct::RecordContext" data-ref-filename="AuthRecord_struct..RecordContext">RecordContext</a> = <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="1066">1066</th><td>        <b>if</b> (<a class="local col5 ref" href="#155ptr" title='ptr' data-ref="155ptr" data-ref-filename="155ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::external_advertise" title='registered_record_entry::external_advertise' data-ref="registered_record_entry::external_advertise" data-ref-filename="registered_record_entry..external_advertise">external_advertise</a>)</td></tr>
<tr><th id="1067">1067</th><td>        {</td></tr>
<tr><th id="1068">1068</th><td>            <a class="local col5 ref" href="#155ptr" title='ptr' data-ref="155ptr" data-ref-filename="155ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::external_advertise" title='registered_record_entry::external_advertise' data-ref="registered_record_entry::external_advertise" data-ref-filename="registered_record_entry..external_advertise">external_advertise</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>;</td></tr>
<tr><th id="1069">1069</th><td>            <a class="macro" href="uds_daemon.h.html#267" title="do { (void)(&amp;ptr-&gt;rr-&gt;resrec); (void)(request-&gt;flags); } while (0)" data-ref="_M/external_stop_advertising_service">external_stop_advertising_service</a>(&amp;<a class="local col5 ref" href="#155ptr" title='ptr' data-ref="155ptr" data-ref-filename="155ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::rr" title='registered_record_entry::rr' data-ref="registered_record_entry::rr" data-ref-filename="registered_record_entry..rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>, <a class="local col2 ref" href="#152request" title='request' data-ref="152request" data-ref-filename="152request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a>);</td></tr>
<tr><th id="1070">1070</th><td>        }</td></tr>
<tr><th id="1071">1071</th><td>        <a class="macro" href="uds_daemon.h.html#225" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMcastService" data-ref="_M/LogMcastS">LogMcastS</a>(<a class="local col5 ref" href="#155ptr" title='ptr' data-ref="155ptr" data-ref-filename="155ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::rr" title='registered_record_entry::rr' data-ref="registered_record_entry::rr" data-ref-filename="registered_record_entry..rr">rr</a>, <a class="local col2 ref" href="#152request" title='request' data-ref="152request" data-ref-filename="152request">request</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#reg_stop" title='reg_stop' data-ref="reg_stop" data-ref-filename="reg_stop">reg_stop</a>);</td></tr>
<tr><th id="1072">1072</th><td>        <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_Deregister" title='mDNS_Deregister' data-ref="mDNS_Deregister" data-ref-filename="mDNS_Deregister">mDNS_Deregister</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col5 ref" href="#155ptr" title='ptr' data-ref="155ptr" data-ref-filename="155ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::rr" title='registered_record_entry::rr' data-ref="registered_record_entry::rr" data-ref-filename="registered_record_entry..rr">rr</a>);     <i>// Will free ptr-&gt;rr for us</i></td></tr>
<tr><th id="1073">1073</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(ptr)" data-ref="_M/freeL">freeL</a>(<q>"registered_record_entry/connection_termination"</q>, <a class="local col5 ref" href="#155ptr" title='ptr' data-ref="155ptr" data-ref-filename="155ptr">ptr</a>);</td></tr>
<tr><th id="1074">1074</th><td>    }</td></tr>
<tr><th id="1075">1075</th><td>}</td></tr>
<tr><th id="1076">1076</th><td></td></tr>
<tr><th id="1077">1077</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="handle_cancel_request" title='handle_cancel_request' data-ref="handle_cancel_request" data-ref-filename="handle_cancel_request">handle_cancel_request</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col6 decl" id="156request" title='request' data-type='request_state *' data-ref="156request" data-ref-filename="156request">request</dfn>)</td></tr>
<tr><th id="1078">1078</th><td>{</td></tr>
<tr><th id="1079">1079</th><td>    <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> **<dfn class="local col7 decl" id="157req" title='req' data-type='request_state **' data-ref="157req" data-ref-filename="157req">req</dfn> = &amp;<a class="tu ref" href="#all_requests" title='all_requests' data-use='a' data-ref="all_requests" data-ref-filename="all_requests">all_requests</a>;</td></tr>
<tr><th id="1080">1080</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: Cancel %08X %08X&quot;, request-&gt;sd, request-&gt;hdr.client_context.u32[1], request-&gt;hdr.client_context.u32[0]);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: Cancel %08X %08X"</q>, <a class="local col6 ref" href="#156request" title='request' data-ref="156request" data-ref-filename="156request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col6 ref" href="#156request" title='request' data-ref="156request" data-ref-filename="156request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::client_context" title='(anonymous struct)::client_context' data-ref="(anonymous)::client_context" data-ref-filename="(anonymous)..client_context">client_context</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::u32" title='(anonymous union)::u32' data-ref="(anonymous)::u32" data-ref-filename="(anonymous)..u32">u32</a>[<var>1</var>], <a class="local col6 ref" href="#156request" title='request' data-ref="156request" data-ref-filename="156request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::client_context" title='(anonymous struct)::client_context' data-ref="(anonymous)::client_context" data-ref-filename="(anonymous)..client_context">client_context</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::u32" title='(anonymous union)::u32' data-ref="(anonymous)::u32" data-ref-filename="(anonymous)..u32">u32</a>[<var>0</var>]);</td></tr>
<tr><th id="1081">1081</th><td>    <b>while</b> (*<a class="local col7 ref" href="#157req" title='req' data-ref="157req" data-ref-filename="157req">req</a>)</td></tr>
<tr><th id="1082">1082</th><td>    {</td></tr>
<tr><th id="1083">1083</th><td>        <b>if</b> ((*<a class="local col7 ref" href="#157req" title='req' data-ref="157req" data-ref-filename="157req">req</a>)-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::primary" title='request_state::primary' data-ref="request_state::primary" data-ref-filename="request_state..primary">primary</a> == <a class="local col6 ref" href="#156request" title='request' data-ref="156request" data-ref-filename="156request">request</a> &amp;&amp;</td></tr>
<tr><th id="1084">1084</th><td>            (*<a class="local col7 ref" href="#157req" title='req' data-ref="157req" data-ref-filename="157req">req</a>)-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::client_context" title='(anonymous struct)::client_context' data-ref="(anonymous)::client_context" data-ref-filename="(anonymous)..client_context">client_context</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::u32" title='(anonymous union)::u32' data-ref="(anonymous)::u32" data-ref-filename="(anonymous)..u32">u32</a>[<var>0</var>] == <a class="local col6 ref" href="#156request" title='request' data-ref="156request" data-ref-filename="156request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::client_context" title='(anonymous struct)::client_context' data-ref="(anonymous)::client_context" data-ref-filename="(anonymous)..client_context">client_context</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::u32" title='(anonymous union)::u32' data-ref="(anonymous)::u32" data-ref-filename="(anonymous)..u32">u32</a>[<var>0</var>] &amp;&amp;</td></tr>
<tr><th id="1085">1085</th><td>            (*<a class="local col7 ref" href="#157req" title='req' data-ref="157req" data-ref-filename="157req">req</a>)-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::client_context" title='(anonymous struct)::client_context' data-ref="(anonymous)::client_context" data-ref-filename="(anonymous)..client_context">client_context</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::u32" title='(anonymous union)::u32' data-ref="(anonymous)::u32" data-ref-filename="(anonymous)..u32">u32</a>[<var>1</var>] == <a class="local col6 ref" href="#156request" title='request' data-ref="156request" data-ref-filename="156request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::client_context" title='(anonymous struct)::client_context' data-ref="(anonymous)::client_context" data-ref-filename="(anonymous)..client_context">client_context</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::u32" title='(anonymous union)::u32' data-ref="(anonymous)::u32" data-ref-filename="(anonymous)..u32">u32</a>[<var>1</var>])</td></tr>
<tr><th id="1086">1086</th><td>        {</td></tr>
<tr><th id="1087">1087</th><td>            <i>// Since we're already doing a list traversal, we unlink the request directly instead of using AbortUnlinkAndFree()</i></td></tr>
<tr><th id="1088">1088</th><td>            <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col8 decl" id="158tmp" title='tmp' data-type='request_state *' data-ref="158tmp" data-ref-filename="158tmp">tmp</dfn> = *<a class="local col7 ref" href="#157req" title='req' data-ref="157req" data-ref-filename="157req">req</a>;</td></tr>
<tr><th id="1089">1089</th><td>            <a class="ref fn" href="#abort_request" title='abort_request' data-ref="abort_request" data-ref-filename="abort_request">abort_request</a>(<a class="local col8 ref" href="#158tmp" title='tmp' data-ref="158tmp" data-ref-filename="158tmp">tmp</a>);</td></tr>
<tr><th id="1090">1090</th><td>            *<a class="local col7 ref" href="#157req" title='req' data-ref="157req" data-ref-filename="157req">req</a> = <a class="local col8 ref" href="#158tmp" title='tmp' data-ref="158tmp" data-ref-filename="158tmp">tmp</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::next" title='request_state::next' data-ref="request_state::next" data-ref-filename="request_state..next">next</a>;</td></tr>
<tr><th id="1091">1091</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(tmp)" data-ref="_M/freeL">freeL</a>(<q>"request_state/handle_cancel_request"</q>, <a class="local col8 ref" href="#158tmp" title='tmp' data-ref="158tmp" data-ref-filename="158tmp">tmp</a>);</td></tr>
<tr><th id="1092">1092</th><td>        }</td></tr>
<tr><th id="1093">1093</th><td>        <b>else</b></td></tr>
<tr><th id="1094">1094</th><td>            <a class="local col7 ref" href="#157req" title='req' data-ref="157req" data-ref-filename="157req">req</a> = &amp;(*<a class="local col7 ref" href="#157req" title='req' data-ref="157req" data-ref-filename="157req">req</a>)-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::next" title='request_state::next' data-ref="request_state::next" data-ref-filename="request_state..next">next</a>;</td></tr>
<tr><th id="1095">1095</th><td>    }</td></tr>
<tr><th id="1096">1096</th><td>}</td></tr>
<tr><th id="1097">1097</th><td></td></tr>
<tr><th id="1098">1098</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="decl def fn" id="handle_regrecord_request" title='handle_regrecord_request' data-ref="handle_regrecord_request" data-ref-filename="handle_regrecord_request">handle_regrecord_request</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col9 decl" id="159request" title='request' data-type='request_state *' data-ref="159request" data-ref-filename="159request">request</dfn>)</td></tr>
<tr><th id="1099">1099</th><td>{</td></tr>
<tr><th id="1100">1100</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="local col0 decl" id="160err" title='err' data-type='mStatus' data-ref="160err" data-ref-filename="160err">err</dfn> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>;</td></tr>
<tr><th id="1101">1101</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord" title='AuthRecord' data-type='struct AuthRecord_struct' data-ref="AuthRecord" data-ref-filename="AuthRecord">AuthRecord</a> *<dfn class="local col1 decl" id="161rr" title='rr' data-type='AuthRecord *' data-ref="161rr" data-ref-filename="161rr">rr</dfn>;</td></tr>
<tr><th id="1102">1102</th><td></td></tr>
<tr><th id="1103">1103</th><td>    <b>if</b> (<a class="local col9 ref" href="#159request" title='request' data-ref="159request" data-ref-filename="159request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> != <a class="ref fn" href="#connection_termination" title='connection_termination' data-ref="connection_termination" data-ref-filename="connection_termination">connection_termination</a>)</td></tr>
<tr><th id="1104">1104</th><td>    { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: DNSServiceRegisterRecord(not a shared connection ref)&quot;, request-&gt;sd)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: DNSServiceRegisterRecord(not a shared connection ref)"</q>, <a class="local col9 ref" href="#159request" title='request' data-ref="159request" data-ref-filename="159request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>); <b>return</b>(<a class="local col0 ref" href="#160err" title='err' data-ref="160err" data-ref-filename="160err">err</a>); }</td></tr>
<tr><th id="1105">1105</th><td></td></tr>
<tr><th id="1106">1106</th><td>    <a class="local col1 ref" href="#161rr" title='rr' data-ref="161rr" data-ref-filename="161rr">rr</a> = <a class="ref fn" href="#read_rr_from_ipc_msg" title='read_rr_from_ipc_msg' data-ref="read_rr_from_ipc_msg" data-ref-filename="read_rr_from_ipc_msg">read_rr_from_ipc_msg</a>(<a class="local col9 ref" href="#159request" title='request' data-ref="159request" data-ref-filename="159request">request</a>, <var>1</var>, <var>1</var>);</td></tr>
<tr><th id="1107">1107</th><td>    <b>if</b> (<a class="local col1 ref" href="#161rr" title='rr' data-ref="161rr" data-ref-filename="161rr">rr</a>)</td></tr>
<tr><th id="1108">1108</th><td>    {</td></tr>
<tr><th id="1109">1109</th><td>        <a class="typedef" href="uds_daemon.h.html#registered_record_entry" title='registered_record_entry' data-type='struct registered_record_entry' data-ref="registered_record_entry" data-ref-filename="registered_record_entry">registered_record_entry</a> *<dfn class="local col2 decl" id="162re" title='re' data-type='registered_record_entry *' data-ref="162re" data-ref-filename="162re">re</dfn>;</td></tr>
<tr><th id="1110">1110</th><td>        <i>// Don't allow non-local domains to be regsitered as LocalOnly. Allowing this would permit</i></td></tr>
<tr><th id="1111">1111</th><td><i>        // clients to register records such as www.bigbank.com A w.x.y.z to redirect Safari.</i></td></tr>
<tr><th id="1112">1112</th><td>        <b>if</b> (<a class="local col1 ref" href="#161rr" title='rr' data-ref="161rr" data-ref-filename="161rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::InterfaceID" title='ResourceRecord_struct::InterfaceID' data-ref="ResourceRecord_struct::InterfaceID" data-ref-filename="ResourceRecord_struct..InterfaceID">InterfaceID</a> == <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterface_LocalOnly" title='mDNSInterface_LocalOnly' data-ref="mDNSInterface_LocalOnly" data-ref-filename="mDNSInterface_LocalOnly">mDNSInterface_LocalOnly</a> &amp;&amp; !<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#IsLocalDomain" title='IsLocalDomain' data-ref="IsLocalDomain" data-ref-filename="IsLocalDomain">IsLocalDomain</a>(<a class="local col1 ref" href="#161rr" title='rr' data-ref="161rr" data-ref-filename="161rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::name" title='ResourceRecord_struct::name' data-ref="ResourceRecord_struct::name" data-ref-filename="ResourceRecord_struct..name">name</a>) &amp;&amp;</td></tr>
<tr><th id="1113">1113</th><td>            <a class="local col1 ref" href="#161rr" title='rr' data-ref="161rr" data-ref-filename="161rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rrclass" title='ResourceRecord_struct::rrclass' data-ref="ResourceRecord_struct::rrclass" data-ref-filename="ResourceRecord_struct..rrclass">rrclass</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSClass_IN" title='kDNSClass_IN' data-ref="kDNSClass_IN" data-ref-filename="kDNSClass_IN">kDNSClass_IN</a> &amp;&amp; (<a class="local col1 ref" href="#161rr" title='rr' data-ref="161rr" data-ref-filename="161rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rrtype" title='ResourceRecord_struct::rrtype' data-ref="ResourceRecord_struct::rrtype" data-ref-filename="ResourceRecord_struct..rrtype">rrtype</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSType_A" title='kDNSType_A' data-ref="kDNSType_A" data-ref-filename="kDNSType_A">kDNSType_A</a> || <a class="local col1 ref" href="#161rr" title='rr' data-ref="161rr" data-ref-filename="161rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rrtype" title='ResourceRecord_struct::rrtype' data-ref="ResourceRecord_struct::rrtype" data-ref-filename="ResourceRecord_struct..rrtype">rrtype</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSType_AAAA" title='kDNSType_AAAA' data-ref="kDNSType_AAAA" data-ref-filename="kDNSType_AAAA">kDNSType_AAAA</a> ||</td></tr>
<tr><th id="1114">1114</th><td>                                                   <a class="local col1 ref" href="#161rr" title='rr' data-ref="161rr" data-ref-filename="161rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rrtype" title='ResourceRecord_struct::rrtype' data-ref="ResourceRecord_struct::rrtype" data-ref-filename="ResourceRecord_struct..rrtype">rrtype</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSType_CNAME" title='kDNSType_CNAME' data-ref="kDNSType_CNAME" data-ref-filename="kDNSType_CNAME">kDNSType_CNAME</a>))</td></tr>
<tr><th id="1115">1115</th><td>        {</td></tr>
<tr><th id="1116">1116</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(rr)" data-ref="_M/freeL">freeL</a>(<q>"AuthRecord/handle_regrecord_request"</q>, <a class="local col1 ref" href="#161rr" title='rr' data-ref="161rr" data-ref-filename="161rr">rr</a>);</td></tr>
<tr><th id="1117">1117</th><td>            <b>return</b> (<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>);</td></tr>
<tr><th id="1118">1118</th><td>        }</td></tr>
<tr><th id="1119">1119</th><td>        <i>// allocate registration entry, link into list</i></td></tr>
<tr><th id="1120">1120</th><td>        <a class="local col2 ref" href="#162re" title='re' data-ref="162re" data-ref-filename="162re">re</a> = <a class="macro" href="../mDNSCore/mDNSDebug.h.html#166" title="malloc(sizeof(registered_record_entry))" data-ref="_M/mallocL">mallocL</a>(<q>"registered_record_entry"</q>, <b>sizeof</b>(<a class="typedef" href="uds_daemon.h.html#registered_record_entry" title='registered_record_entry' data-type='struct registered_record_entry' data-ref="registered_record_entry" data-ref-filename="registered_record_entry">registered_record_entry</a>));</td></tr>
<tr><th id="1121">1121</th><td>        <b>if</b> (!<a class="local col2 ref" href="#162re" title='re' data-ref="162re" data-ref-filename="162re">re</a>)</td></tr>
<tr><th id="1122">1122</th><td>            <a class="ref fn" href="#FatalError" title='FatalError' data-ref="FatalError" data-ref-filename="FatalError">FatalError</a>(<q>"ERROR: malloc"</q>);</td></tr>
<tr><th id="1123">1123</th><td>        <a class="local col2 ref" href="#162re" title='re' data-ref="162re" data-ref-filename="162re">re</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::key" title='registered_record_entry::key' data-ref="registered_record_entry::key" data-ref-filename="registered_record_entry..key">key</a>                   = <a class="local col9 ref" href="#159request" title='request' data-ref="159request" data-ref-filename="159request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::reg_index" title='(anonymous struct)::reg_index' data-ref="(anonymous)::reg_index" data-ref-filename="(anonymous)..reg_index">reg_index</a>;</td></tr>
<tr><th id="1124">1124</th><td>        <a class="local col2 ref" href="#162re" title='re' data-ref="162re" data-ref-filename="162re">re</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::rr" title='registered_record_entry::rr' data-ref="registered_record_entry::rr" data-ref-filename="registered_record_entry..rr">rr</a>                    = <a class="local col1 ref" href="#161rr" title='rr' data-ref="161rr" data-ref-filename="161rr">rr</a>;</td></tr>
<tr><th id="1125">1125</th><td>        <a class="local col2 ref" href="#162re" title='re' data-ref="162re" data-ref-filename="162re">re</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::regrec_client_context" title='registered_record_entry::regrec_client_context' data-ref="registered_record_entry::regrec_client_context" data-ref-filename="registered_record_entry..regrec_client_context">regrec_client_context</a> = <a class="local col9 ref" href="#159request" title='request' data-ref="159request" data-ref-filename="159request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::client_context" title='(anonymous struct)::client_context' data-ref="(anonymous)::client_context" data-ref-filename="(anonymous)..client_context">client_context</a>;</td></tr>
<tr><th id="1126">1126</th><td>        <a class="local col2 ref" href="#162re" title='re' data-ref="162re" data-ref-filename="162re">re</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::request" title='registered_record_entry::request' data-ref="registered_record_entry::request" data-ref-filename="registered_record_entry..request">request</a>               = <a class="local col9 ref" href="#159request" title='request' data-ref="159request" data-ref-filename="159request">request</a>;</td></tr>
<tr><th id="1127">1127</th><td>        <a class="local col2 ref" href="#162re" title='re' data-ref="162re" data-ref-filename="162re">re</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::external_advertise" title='registered_record_entry::external_advertise' data-ref="registered_record_entry::external_advertise" data-ref-filename="registered_record_entry..external_advertise">external_advertise</a>    = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>;</td></tr>
<tr><th id="1128">1128</th><td>        <a class="local col1 ref" href="#161rr" title='rr' data-ref="161rr" data-ref-filename="161rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::RecordContext" title='AuthRecord_struct::RecordContext' data-ref="AuthRecord_struct::RecordContext" data-ref-filename="AuthRecord_struct..RecordContext">RecordContext</a>         = <a class="local col2 ref" href="#162re" title='re' data-ref="162re" data-ref-filename="162re">re</a>;</td></tr>
<tr><th id="1129">1129</th><td>        <a class="local col1 ref" href="#161rr" title='rr' data-ref="161rr" data-ref-filename="161rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::RecordCallback" title='AuthRecord_struct::RecordCallback' data-ref="AuthRecord_struct::RecordCallback" data-ref-filename="AuthRecord_struct..RecordCallback">RecordCallback</a>        = <a class="ref fn" href="#regrecord_callback" title='regrecord_callback' data-ref="regrecord_callback" data-ref-filename="regrecord_callback">regrecord_callback</a>;</td></tr>
<tr><th id="1130">1130</th><td></td></tr>
<tr><th id="1131">1131</th><td>        <a class="local col2 ref" href="#162re" title='re' data-ref="162re" data-ref-filename="162re">re</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::origInterfaceID" title='registered_record_entry::origInterfaceID' data-ref="registered_record_entry::origInterfaceID" data-ref-filename="registered_record_entry..origInterfaceID">origInterfaceID</a> = <a class="local col1 ref" href="#161rr" title='rr' data-ref="161rr" data-ref-filename="161rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::InterfaceID" title='ResourceRecord_struct::InterfaceID' data-ref="ResourceRecord_struct::InterfaceID" data-ref-filename="ResourceRecord_struct..InterfaceID">InterfaceID</a>;</td></tr>
<tr><th id="1132">1132</th><td>        <b>if</b> (<a class="local col1 ref" href="#161rr" title='rr' data-ref="161rr" data-ref-filename="161rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::InterfaceID" title='ResourceRecord_struct::InterfaceID' data-ref="ResourceRecord_struct::InterfaceID" data-ref-filename="ResourceRecord_struct..InterfaceID">InterfaceID</a> == <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterface_P2P" title='mDNSInterface_P2P' data-ref="mDNSInterface_P2P" data-ref-filename="mDNSInterface_P2P">mDNSInterface_P2P</a>)</td></tr>
<tr><th id="1133">1133</th><td>            <a class="local col1 ref" href="#161rr" title='rr' data-ref="161rr" data-ref-filename="161rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::InterfaceID" title='ResourceRecord_struct::InterfaceID' data-ref="ResourceRecord_struct::InterfaceID" data-ref-filename="ResourceRecord_struct..InterfaceID">InterfaceID</a> = <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterface_Any" title='mDNSInterface_Any' data-ref="mDNSInterface_Any" data-ref-filename="mDNSInterface_Any">mDNSInterface_Any</a>;</td></tr>
<tr><th id="1134">1134</th><td><u>#<span data-ppcond="1134">if</span> 0</u></td></tr>
<tr><th id="1135">1135</th><td>        <b>if</b> (!AuthorizedDomain(request, rr-&gt;resrec.name, AutoRegistrationDomains)) <b>return</b> (mStatus_NoError);</td></tr>
<tr><th id="1136">1136</th><td><u>#<span data-ppcond="1134">endif</span></u></td></tr>
<tr><th id="1137">1137</th><td>        <b>if</b> (<a class="local col1 ref" href="#161rr" title='rr' data-ref="161rr" data-ref-filename="161rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rroriginalttl" title='ResourceRecord_struct::rroriginalttl' data-ref="ResourceRecord_struct::rroriginalttl" data-ref-filename="ResourceRecord_struct..rroriginalttl">rroriginalttl</a> == <var>0</var>)</td></tr>
<tr><th id="1138">1138</th><td>            <a class="local col1 ref" href="#161rr" title='rr' data-ref="161rr" data-ref-filename="161rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rroriginalttl" title='ResourceRecord_struct::rroriginalttl' data-ref="ResourceRecord_struct::rroriginalttl" data-ref-filename="ResourceRecord_struct..rroriginalttl">rroriginalttl</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#454" title="(((rr-&gt;resrec.rrtype) == kDNSType_A || (rr-&gt;resrec.rrtype) == kDNSType_AAAA || (rr-&gt;resrec.rrtype) == kDNSType_SRV) ? 120UL : (3600UL * 100 / 80))" data-ref="_M/DefaultTTLforRRType">DefaultTTLforRRType</a>(<a class="local col1 ref" href="#161rr" title='rr' data-ref="161rr" data-ref-filename="161rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rrtype" title='ResourceRecord_struct::rrtype' data-ref="ResourceRecord_struct::rrtype" data-ref-filename="ResourceRecord_struct..rrtype">rrtype</a>);</td></tr>
<tr><th id="1139">1139</th><td></td></tr>
<tr><th id="1140">1140</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: DNSServiceRegisterRecord(%u %s) START PID[%d](%s)&quot;, request-&gt;sd, re-&gt;key, GetRRDisplayString_rdb(&amp;rr-&gt;resrec, &amp;(&amp;rr-&gt;resrec)-&gt;rdata-&gt;u, (&amp;mDNSStorage)-&gt;MsgBuffer), request-&gt;process_id, request-&gt;pid_name);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: DNSServiceRegisterRecord(%u %s) START PID[%d](%s)"</q>, <a class="local col9 ref" href="#159request" title='request' data-ref="159request" data-ref-filename="159request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col2 ref" href="#162re" title='re' data-ref="162re" data-ref-filename="162re">re</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::key" title='registered_record_entry::key' data-ref="registered_record_entry::key" data-ref-filename="registered_record_entry..key">key</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2941" title="GetRRDisplayString_rdb(&amp;rr-&gt;resrec, &amp;(&amp;rr-&gt;resrec)-&gt;rdata-&gt;u, (&amp;mDNSStorage)-&gt;MsgBuffer)" data-ref="_M/RRDisplayString">RRDisplayString</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col1 ref" href="#161rr" title='rr' data-ref="161rr" data-ref-filename="161rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>),</td></tr>
<tr><th id="1141">1141</th><td>                     <a class="local col9 ref" href="#159request" title='request' data-ref="159request" data-ref-filename="159request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col9 ref" href="#159request" title='request' data-ref="159request" data-ref-filename="159request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="1142">1142</th><td></td></tr>
<tr><th id="1143">1143</th><td>        <a class="local col0 ref" href="#160err" title='err' data-ref="160err" data-ref-filename="160err">err</a> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_Register" title='mDNS_Register' data-ref="mDNS_Register" data-ref-filename="mDNS_Register">mDNS_Register</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col1 ref" href="#161rr" title='rr' data-ref="161rr" data-ref-filename="161rr">rr</a>);</td></tr>
<tr><th id="1144">1144</th><td>        <b>if</b> (<a class="local col0 ref" href="#160err" title='err' data-ref="160err" data-ref-filename="160err">err</a>)</td></tr>
<tr><th id="1145">1145</th><td>        {</td></tr>
<tr><th id="1146">1146</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: DNSServiceRegisterRecord(%u %s) ERROR (%d)&quot;, request-&gt;sd, re-&gt;key, GetRRDisplayString_rdb(&amp;rr-&gt;resrec, &amp;(&amp;rr-&gt;resrec)-&gt;rdata-&gt;u, (&amp;mDNSStorage)-&gt;MsgBuffer), err);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: DNSServiceRegisterRecord(%u %s) ERROR (%d)"</q>, <a class="local col9 ref" href="#159request" title='request' data-ref="159request" data-ref-filename="159request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col2 ref" href="#162re" title='re' data-ref="162re" data-ref-filename="162re">re</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::key" title='registered_record_entry::key' data-ref="registered_record_entry::key" data-ref-filename="registered_record_entry..key">key</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2941" title="GetRRDisplayString_rdb(&amp;rr-&gt;resrec, &amp;(&amp;rr-&gt;resrec)-&gt;rdata-&gt;u, (&amp;mDNSStorage)-&gt;MsgBuffer)" data-ref="_M/RRDisplayString">RRDisplayString</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col1 ref" href="#161rr" title='rr' data-ref="161rr" data-ref-filename="161rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>), <a class="local col0 ref" href="#160err" title='err' data-ref="160err" data-ref-filename="160err">err</a>);</td></tr>
<tr><th id="1147">1147</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(re)" data-ref="_M/freeL">freeL</a>(<q>"registered_record_entry"</q>, <a class="local col2 ref" href="#162re" title='re' data-ref="162re" data-ref-filename="162re">re</a>);</td></tr>
<tr><th id="1148">1148</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(rr)" data-ref="_M/freeL">freeL</a>(<q>"registered_record_entry/AuthRecord"</q>, <a class="local col1 ref" href="#161rr" title='rr' data-ref="161rr" data-ref-filename="161rr">rr</a>);</td></tr>
<tr><th id="1149">1149</th><td>        }</td></tr>
<tr><th id="1150">1150</th><td>        <b>else</b></td></tr>
<tr><th id="1151">1151</th><td>        {</td></tr>
<tr><th id="1152">1152</th><td>            <a class="macro" href="uds_daemon.h.html#225" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMcastService" data-ref="_M/LogMcastS">LogMcastS</a>(<a class="local col1 ref" href="#161rr" title='rr' data-ref="161rr" data-ref-filename="161rr">rr</a>, <a class="local col9 ref" href="#159request" title='request' data-ref="159request" data-ref-filename="159request">request</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#reg_start" title='reg_start' data-ref="reg_start" data-ref-filename="reg_start">reg_start</a>);</td></tr>
<tr><th id="1153">1153</th><td>            <a class="local col2 ref" href="#162re" title='re' data-ref="162re" data-ref-filename="162re">re</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::next" title='registered_record_entry::next' data-ref="registered_record_entry::next" data-ref-filename="registered_record_entry..next">next</a> = <a class="local col9 ref" href="#159request" title='request' data-ref="159request" data-ref-filename="159request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::reg_recs" title='request_state::(anonymous union)::reg_recs' data-ref="request_state::(anonymous)::reg_recs" data-ref-filename="request_state..(anonymous)..reg_recs">reg_recs</a>;</td></tr>
<tr><th id="1154">1154</th><td>            <a class="local col9 ref" href="#159request" title='request' data-ref="159request" data-ref-filename="159request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::reg_recs" title='request_state::(anonymous union)::reg_recs' data-ref="request_state::(anonymous)::reg_recs" data-ref-filename="request_state..(anonymous)..reg_recs">reg_recs</a> = <a class="local col2 ref" href="#162re" title='re' data-ref="162re" data-ref-filename="162re">re</a>;</td></tr>
<tr><th id="1155">1155</th><td>        }</td></tr>
<tr><th id="1156">1156</th><td>    }</td></tr>
<tr><th id="1157">1157</th><td>    <b>return</b>(<a class="local col0 ref" href="#160err" title='err' data-ref="160err" data-ref-filename="160err">err</a>);</td></tr>
<tr><th id="1158">1158</th><td>}</td></tr>
<tr><th id="1159">1159</th><td></td></tr>
<tr><th id="1160">1160</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <a class="decl fn" href="#UpdateDeviceInfoRecord" title='UpdateDeviceInfoRecord' data-ref="UpdateDeviceInfoRecord" data-ref-filename="UpdateDeviceInfoRecord">UpdateDeviceInfoRecord</a>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS" title='mDNS' data-type='struct mDNS_struct' data-ref="mDNS" data-ref-filename="mDNS">mDNS</a> *<em>const</em> <dfn class="local col3 decl" id="163m" title='m' data-type='mDNS *const' data-ref="163m" data-ref-filename="163m">m</dfn>);</td></tr>
<tr><th id="1161">1161</th><td></td></tr>
<tr><th id="1162">1162</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="regservice_termination_callback" title='regservice_termination_callback' data-ref="regservice_termination_callback" data-ref-filename="regservice_termination_callback">regservice_termination_callback</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col4 decl" id="164request" title='request' data-type='request_state *' data-ref="164request" data-ref-filename="164request">request</dfn>)</td></tr>
<tr><th id="1163">1163</th><td>{</td></tr>
<tr><th id="1164">1164</th><td>    <b>if</b> (!<a class="local col4 ref" href="#164request" title='request' data-ref="164request" data-ref-filename="164request">request</a>)</td></tr>
<tr><th id="1165">1165</th><td>    {</td></tr>
<tr><th id="1166">1166</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;regservice_termination_callback context is NULL&quot;)" data-ref="_M/LogMsg">LogMsg</a>(<q>"regservice_termination_callback context is NULL"</q>);</td></tr>
<tr><th id="1167">1167</th><td>        <b>return</b>;</td></tr>
<tr><th id="1168">1168</th><td>    }</td></tr>
<tr><th id="1169">1169</th><td>    <b>while</b> (<a class="local col4 ref" href="#164request" title='request' data-ref="164request" data-ref-filename="164request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::instances" title='request_state::(anonymous union)::(anonymous struct)::instances' data-ref="request_state::(anonymousunion)::(anonymous)::instances" data-ref-filename="request_state..(anonymousunion)..(anonymous)..instances">instances</a>)</td></tr>
<tr><th id="1170">1170</th><td>    {</td></tr>
<tr><th id="1171">1171</th><td>        <a class="typedef" href="uds_daemon.h.html#service_instance" title='service_instance' data-type='struct service_instance' data-ref="service_instance" data-ref-filename="service_instance">service_instance</a> *<dfn class="local col5 decl" id="165p" title='p' data-type='service_instance *' data-ref="165p" data-ref-filename="165p">p</dfn> = <a class="local col4 ref" href="#164request" title='request' data-ref="164request" data-ref-filename="164request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::instances" title='request_state::(anonymous union)::(anonymous struct)::instances' data-ref="request_state::(anonymousunion)::(anonymous)::instances" data-ref-filename="request_state..(anonymousunion)..(anonymous)..instances">instances</a>;</td></tr>
<tr><th id="1172">1172</th><td>        <a class="local col4 ref" href="#164request" title='request' data-ref="164request" data-ref-filename="164request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::instances" title='request_state::(anonymous union)::(anonymous struct)::instances' data-ref="request_state::(anonymousunion)::(anonymous)::instances" data-ref-filename="request_state..(anonymousunion)..(anonymous)..instances">instances</a> = <a class="local col4 ref" href="#164request" title='request' data-ref="164request" data-ref-filename="164request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::instances" title='request_state::(anonymous union)::(anonymous struct)::instances' data-ref="request_state::(anonymousunion)::(anonymous)::instances" data-ref-filename="request_state..(anonymousunion)..(anonymous)..instances">instances</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::next" title='service_instance::next' data-ref="service_instance::next" data-ref-filename="service_instance..next">next</a>;</td></tr>
<tr><th id="1173">1173</th><td>        <i>// only safe to free memory if registration is not valid, i.e. deregister fails (which invalidates p)</i></td></tr>
<tr><th id="1174">1174</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: DNSServiceRegister(%##s, %u) STOP PID[%d](%s)&quot;, request-&gt;sd, p-&gt;srs.RR_SRV.resrec.name-&gt;c, mDNSVal16(p-&gt;srs.RR_SRV.resrec.rdata-&gt;u.srv.port), request-&gt;process_id, request-&gt;pid_name);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: DNSServiceRegister(%##s, %u) STOP PID[%d](%s)"</q>, <a class="local col4 ref" href="#164request" title='request' data-ref="164request" data-ref-filename="164request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col5 ref" href="#165p" title='p' data-ref="165p" data-ref-filename="165p">p</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_SRV" title='ServiceRecordSet_struct::RR_SRV' data-ref="ServiceRecordSet_struct::RR_SRV" data-ref-filename="ServiceRecordSet_struct..RR_SRV">RR_SRV</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::name" title='ResourceRecord_struct::name' data-ref="ResourceRecord_struct::name" data-ref-filename="ResourceRecord_struct..name">name</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>,</td></tr>
<tr><th id="1175">1175</th><td>                     <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSVal16" title='mDNSVal16' data-ref="mDNSVal16" data-ref-filename="mDNSVal16">mDNSVal16</a>(<a class="local col5 ref" href="#165p" title='p' data-ref="165p" data-ref-filename="165p">p</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_SRV" title='ServiceRecordSet_struct::RR_SRV' data-ref="ServiceRecordSet_struct::RR_SRV" data-ref-filename="ServiceRecordSet_struct..RR_SRV">RR_SRV</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdata" title='ResourceRecord_struct::rdata' data-ref="ResourceRecord_struct::rdata" data-ref-filename="ResourceRecord_struct..rdata">rdata</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::u" title='(anonymous struct)::u' data-ref="(anonymous)::u" data-ref-filename="(anonymous)..u">u</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::srv" title='(anonymous union)::srv' data-ref="(anonymous)::srv" data-ref-filename="(anonymous)..srv">srv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::port" title='(anonymous struct)::port' data-ref="(anonymous)::port" data-ref-filename="(anonymous)..port">port</a>), <a class="local col4 ref" href="#164request" title='request' data-ref="164request" data-ref-filename="164request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col4 ref" href="#164request" title='request' data-ref="164request" data-ref-filename="164request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="1176">1176</th><td></td></tr>
<tr><th id="1177">1177</th><td>        <a class="ref fn" href="#external_stop_advertising_helper" title='external_stop_advertising_helper' data-ref="external_stop_advertising_helper" data-ref-filename="external_stop_advertising_helper">external_stop_advertising_helper</a>(<a class="local col5 ref" href="#165p" title='p' data-ref="165p" data-ref-filename="165p">p</a>);</td></tr>
<tr><th id="1178">1178</th><td></td></tr>
<tr><th id="1179">1179</th><td>        <i>// Clear backpointer *before* calling mDNS_DeregisterService/unlink_and_free_service_instance</i></td></tr>
<tr><th id="1180">1180</th><td><i>        // We don't need unlink_and_free_service_instance to cut its element from the list, because we're already advancing</i></td></tr>
<tr><th id="1181">1181</th><td><i>        // request-&gt;u.servicereg.instances as we work our way through the list, implicitly cutting one element at a time</i></td></tr>
<tr><th id="1182">1182</th><td><i>        // We can't clear p-&gt;request *after* the calling mDNS_DeregisterService/unlink_and_free_service_instance</i></td></tr>
<tr><th id="1183">1183</th><td><i>        // because by then we might have already freed p</i></td></tr>
<tr><th id="1184">1184</th><td>        <a class="local col5 ref" href="#165p" title='p' data-ref="165p" data-ref-filename="165p">p</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a> = <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="1185">1185</th><td>        <a class="macro" href="uds_daemon.h.html#225" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMcastService" data-ref="_M/LogMcastS">LogMcastS</a>(&amp;<a class="local col5 ref" href="#165p" title='p' data-ref="165p" data-ref-filename="165p">p</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_SRV" title='ServiceRecordSet_struct::RR_SRV' data-ref="ServiceRecordSet_struct::RR_SRV" data-ref-filename="ServiceRecordSet_struct..RR_SRV">RR_SRV</a>, <a class="local col4 ref" href="#164request" title='request' data-ref="164request" data-ref-filename="164request">request</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#reg_stop" title='reg_stop' data-ref="reg_stop" data-ref-filename="reg_stop">reg_stop</a>);</td></tr>
<tr><th id="1186">1186</th><td>        <b>if</b> (<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2790" title="mDNS_DeregisterService_drt((&amp;mDNSStorage), (&amp;p-&gt;srs), mDNS_Dereg_normal)" data-ref="_M/mDNS_DeregisterService">mDNS_DeregisterService</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col5 ref" href="#165p" title='p' data-ref="165p" data-ref-filename="165p">p</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>))</td></tr>
<tr><th id="1187">1187</th><td>        {</td></tr>
<tr><th id="1188">1188</th><td>            <a class="ref fn" href="#unlink_and_free_service_instance" title='unlink_and_free_service_instance' data-ref="unlink_and_free_service_instance" data-ref-filename="unlink_and_free_service_instance">unlink_and_free_service_instance</a>(<a class="local col5 ref" href="#165p" title='p' data-ref="165p" data-ref-filename="165p">p</a>);</td></tr>
<tr><th id="1189">1189</th><td>            <i>// Don't touch service_instance *p after this -- it's likely to have been freed already</i></td></tr>
<tr><th id="1190">1190</th><td>        }</td></tr>
<tr><th id="1191">1191</th><td>    }</td></tr>
<tr><th id="1192">1192</th><td>    <b>if</b> (<a class="local col4 ref" href="#164request" title='request' data-ref="164request" data-ref-filename="164request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txtdata" title='request_state::(anonymous union)::(anonymous struct)::txtdata' data-ref="request_state::(anonymousunion)::(anonymous)::txtdata" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txtdata">txtdata</a>)</td></tr>
<tr><th id="1193">1193</th><td>    {</td></tr>
<tr><th id="1194">1194</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(request-&gt;u.servicereg.txtdata)" data-ref="_M/freeL">freeL</a>(<q>"service_info txtdata"</q>, <a class="local col4 ref" href="#164request" title='request' data-ref="164request" data-ref-filename="164request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txtdata" title='request_state::(anonymous union)::(anonymous struct)::txtdata' data-ref="request_state::(anonymousunion)::(anonymous)::txtdata" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txtdata">txtdata</a>);</td></tr>
<tr><th id="1195">1195</th><td>        <a class="local col4 ref" href="#164request" title='request' data-ref="164request" data-ref-filename="164request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txtdata" title='request_state::(anonymous union)::(anonymous struct)::txtdata' data-ref="request_state::(anonymousunion)::(anonymous)::txtdata" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txtdata">txtdata</a> = <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="1196">1196</th><td>    }</td></tr>
<tr><th id="1197">1197</th><td>    <b>if</b> (<a class="local col4 ref" href="#164request" title='request' data-ref="164request" data-ref-filename="164request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::autoname" title='request_state::(anonymous union)::(anonymous struct)::autoname' data-ref="request_state::(anonymousunion)::(anonymous)::autoname" data-ref-filename="request_state..(anonymousunion)..(anonymous)..autoname">autoname</a>)</td></tr>
<tr><th id="1198">1198</th><td>    {</td></tr>
<tr><th id="1199">1199</th><td>        <i>// Clear autoname before calling UpdateDeviceInfoRecord() so it doesn't mistakenly include this in its count of active autoname registrations</i></td></tr>
<tr><th id="1200">1200</th><td>        <a class="local col4 ref" href="#164request" title='request' data-ref="164request" data-ref-filename="164request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::autoname" title='request_state::(anonymous union)::(anonymous struct)::autoname' data-ref="request_state::(anonymousunion)::(anonymous)::autoname" data-ref-filename="request_state..(anonymousunion)..(anonymous)..autoname">autoname</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>;</td></tr>
<tr><th id="1201">1201</th><td>        <a class="ref fn" href="#UpdateDeviceInfoRecord" title='UpdateDeviceInfoRecord' data-ref="UpdateDeviceInfoRecord" data-ref-filename="UpdateDeviceInfoRecord">UpdateDeviceInfoRecord</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>);</td></tr>
<tr><th id="1202">1202</th><td>    }</td></tr>
<tr><th id="1203">1203</th><td>}</td></tr>
<tr><th id="1204">1204</th><td></td></tr>
<tr><th id="1205">1205</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="decl def fn" id="LocateSubordinateRequest" title='LocateSubordinateRequest' data-ref="LocateSubordinateRequest" data-ref-filename="LocateSubordinateRequest">LocateSubordinateRequest</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col6 decl" id="166request" title='request' data-type='request_state *' data-ref="166request" data-ref-filename="166request">request</dfn>)</td></tr>
<tr><th id="1206">1206</th><td>{</td></tr>
<tr><th id="1207">1207</th><td>    <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col7 decl" id="167req" title='req' data-type='request_state *' data-ref="167req" data-ref-filename="167req">req</dfn>;</td></tr>
<tr><th id="1208">1208</th><td>    <b>for</b> (<a class="local col7 ref" href="#167req" title='req' data-ref="167req" data-ref-filename="167req">req</a> = <a class="tu ref" href="#all_requests" title='all_requests' data-use='r' data-ref="all_requests" data-ref-filename="all_requests">all_requests</a>; <a class="local col7 ref" href="#167req" title='req' data-ref="167req" data-ref-filename="167req">req</a>; <a class="local col7 ref" href="#167req" title='req' data-ref="167req" data-ref-filename="167req">req</a> = <a class="local col7 ref" href="#167req" title='req' data-ref="167req" data-ref-filename="167req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::next" title='request_state::next' data-ref="request_state::next" data-ref-filename="request_state..next">next</a>)</td></tr>
<tr><th id="1209">1209</th><td>        <b>if</b> (<a class="local col7 ref" href="#167req" title='req' data-ref="167req" data-ref-filename="167req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::primary" title='request_state::primary' data-ref="request_state::primary" data-ref-filename="request_state..primary">primary</a> == <a class="local col6 ref" href="#166request" title='request' data-ref="166request" data-ref-filename="166request">request</a> &amp;&amp;</td></tr>
<tr><th id="1210">1210</th><td>            <a class="local col7 ref" href="#167req" title='req' data-ref="167req" data-ref-filename="167req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::client_context" title='(anonymous struct)::client_context' data-ref="(anonymous)::client_context" data-ref-filename="(anonymous)..client_context">client_context</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::u32" title='(anonymous union)::u32' data-ref="(anonymous)::u32" data-ref-filename="(anonymous)..u32">u32</a>[<var>0</var>] == <a class="local col6 ref" href="#166request" title='request' data-ref="166request" data-ref-filename="166request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::client_context" title='(anonymous struct)::client_context' data-ref="(anonymous)::client_context" data-ref-filename="(anonymous)..client_context">client_context</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::u32" title='(anonymous union)::u32' data-ref="(anonymous)::u32" data-ref-filename="(anonymous)..u32">u32</a>[<var>0</var>] &amp;&amp;</td></tr>
<tr><th id="1211">1211</th><td>            <a class="local col7 ref" href="#167req" title='req' data-ref="167req" data-ref-filename="167req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::client_context" title='(anonymous struct)::client_context' data-ref="(anonymous)::client_context" data-ref-filename="(anonymous)..client_context">client_context</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::u32" title='(anonymous union)::u32' data-ref="(anonymous)::u32" data-ref-filename="(anonymous)..u32">u32</a>[<var>1</var>] == <a class="local col6 ref" href="#166request" title='request' data-ref="166request" data-ref-filename="166request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::client_context" title='(anonymous struct)::client_context' data-ref="(anonymous)::client_context" data-ref-filename="(anonymous)..client_context">client_context</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::u32" title='(anonymous union)::u32' data-ref="(anonymous)::u32" data-ref-filename="(anonymous)..u32">u32</a>[<var>1</var>]) <b>return</b>(<a class="local col7 ref" href="#167req" title='req' data-ref="167req" data-ref-filename="167req">req</a>);</td></tr>
<tr><th id="1212">1212</th><td>    <b>return</b>(<a class="local col6 ref" href="#166request" title='request' data-ref="166request" data-ref-filename="166request">request</a>);</td></tr>
<tr><th id="1213">1213</th><td>}</td></tr>
<tr><th id="1214">1214</th><td></td></tr>
<tr><th id="1215">1215</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="decl def fn" id="add_record_to_service" title='add_record_to_service' data-ref="add_record_to_service" data-ref-filename="add_record_to_service">add_record_to_service</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col8 decl" id="168request" title='request' data-type='request_state *' data-ref="168request" data-ref-filename="168request">request</dfn>, <a class="typedef" href="uds_daemon.h.html#service_instance" title='service_instance' data-type='struct service_instance' data-ref="service_instance" data-ref-filename="service_instance">service_instance</a> *<dfn class="local col9 decl" id="169instance" title='instance' data-type='service_instance *' data-ref="169instance" data-ref-filename="169instance">instance</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu16" title='mDNSu16' data-type='unsigned short' data-ref="mDNSu16" data-ref-filename="mDNSu16">mDNSu16</a> <dfn class="local col0 decl" id="170rrtype" title='rrtype' data-type='mDNSu16' data-ref="170rrtype" data-ref-filename="170rrtype">rrtype</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu16" title='mDNSu16' data-type='unsigned short' data-ref="mDNSu16" data-ref-filename="mDNSu16">mDNSu16</a> <dfn class="local col1 decl" id="171rdlen" title='rdlen' data-type='mDNSu16' data-ref="171rdlen" data-ref-filename="171rdlen">rdlen</dfn>, <em>const</em> <em>char</em> *<dfn class="local col2 decl" id="172rdata" title='rdata' data-type='const char *' data-ref="172rdata" data-ref-filename="172rdata">rdata</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col3 decl" id="173ttl" title='ttl' data-type='mDNSu32' data-ref="173ttl" data-ref-filename="173ttl">ttl</dfn>)</td></tr>
<tr><th id="1216">1216</th><td>{</td></tr>
<tr><th id="1217">1217</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet" title='ServiceRecordSet' data-type='struct ServiceRecordSet_struct' data-ref="ServiceRecordSet" data-ref-filename="ServiceRecordSet">ServiceRecordSet</a> *<dfn class="local col4 decl" id="174srs" title='srs' data-type='ServiceRecordSet *' data-ref="174srs" data-ref-filename="174srs">srs</dfn> = &amp;<a class="local col9 ref" href="#169instance" title='instance' data-ref="169instance" data-ref-filename="169instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>;</td></tr>
<tr><th id="1218">1218</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="local col5 decl" id="175result" title='result' data-type='mStatus' data-ref="175result" data-ref-filename="175result">result</dfn>;</td></tr>
<tr><th id="1219">1219</th><td>    <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#size_t" title='size_t' data-type='unsigned long' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col6 decl" id="176size" title='size' data-type='size_t' data-ref="176size" data-ref-filename="176size">size</dfn> = <a class="local col1 ref" href="#171rdlen" title='rdlen' data-ref="171rdlen" data-ref-filename="171rdlen">rdlen</a> &gt; <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#RDataBody" title='RDataBody' data-type='union RDataBody' data-ref="RDataBody" data-ref-filename="RDataBody">RDataBody</a>) ? <a class="local col1 ref" href="#171rdlen" title='rdlen' data-ref="171rdlen" data-ref-filename="171rdlen">rdlen</a> : <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#RDataBody" title='RDataBody' data-type='union RDataBody' data-ref="RDataBody" data-ref-filename="RDataBody">RDataBody</a>);</td></tr>
<tr><th id="1220">1220</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord" title='ExtraResourceRecord' data-type='struct ExtraResourceRecord_struct' data-ref="ExtraResourceRecord" data-ref-filename="ExtraResourceRecord">ExtraResourceRecord</a> *<dfn class="local col7 decl" id="177extra" title='extra' data-type='ExtraResourceRecord *' data-ref="177extra" data-ref-filename="177extra">extra</dfn> = <a class="macro" href="../mDNSCore/mDNSDebug.h.html#166" title="malloc(sizeof(*extra) - sizeof(RDataBody) + size)" data-ref="_M/mallocL">mallocL</a>(<q>"ExtraResourceRecord"</q>, <b>sizeof</b>(*<a class="local col7 ref" href="#177extra" title='extra' data-ref="177extra" data-ref-filename="177extra">extra</a>) - <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#RDataBody" title='RDataBody' data-type='union RDataBody' data-ref="RDataBody" data-ref-filename="RDataBody">RDataBody</a>) + <a class="local col6 ref" href="#176size" title='size' data-ref="176size" data-ref-filename="176size">size</a>);</td></tr>
<tr><th id="1221">1221</th><td>    <b>if</b> (!<a class="local col7 ref" href="#177extra" title='extra' data-ref="177extra" data-ref-filename="177extra">extra</a>) { <a class="ref fn" href="#my_perror" title='my_perror' data-ref="my_perror" data-ref-filename="my_perror">my_perror</a>(<q>"ERROR: malloc"</q>); <b>return</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_NoMemoryErr" title='mStatus_NoMemoryErr' data-ref="mStatus_NoMemoryErr" data-ref-filename="mStatus_NoMemoryErr">mStatus_NoMemoryErr</a>; }</td></tr>
<tr><th id="1222">1222</th><td></td></tr>
<tr><th id="1223">1223</th><td>    <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformMemZero" title='mDNSPlatformMemZero' data-ref="mDNSPlatformMemZero" data-ref-filename="mDNSPlatformMemZero">mDNSPlatformMemZero</a>(<a class="local col7 ref" href="#177extra" title='extra' data-ref="177extra" data-ref-filename="177extra">extra</a>, <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord" title='ExtraResourceRecord' data-type='struct ExtraResourceRecord_struct' data-ref="ExtraResourceRecord" data-ref-filename="ExtraResourceRecord">ExtraResourceRecord</a>));  <i>// OK if oversized rdata not zero'd</i></td></tr>
<tr><th id="1224">1224</th><td>    <a class="local col7 ref" href="#177extra" title='extra' data-ref="177extra" data-ref-filename="177extra">extra</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord_struct::r" title='ExtraResourceRecord_struct::r' data-ref="ExtraResourceRecord_struct::r" data-ref-filename="ExtraResourceRecord_struct..r">r</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rrtype" title='ResourceRecord_struct::rrtype' data-ref="ResourceRecord_struct::rrtype" data-ref-filename="ResourceRecord_struct..rrtype">rrtype</a> = <a class="local col0 ref" href="#170rrtype" title='rrtype' data-ref="170rrtype" data-ref-filename="170rrtype">rrtype</a>;</td></tr>
<tr><th id="1225">1225</th><td>    <a class="local col7 ref" href="#177extra" title='extra' data-ref="177extra" data-ref-filename="177extra">extra</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord_struct::r" title='ExtraResourceRecord_struct::r' data-ref="ExtraResourceRecord_struct::r" data-ref-filename="ExtraResourceRecord_struct..r">r</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::rdatastorage" title='AuthRecord_struct::rdatastorage' data-ref="AuthRecord_struct::rdatastorage" data-ref-filename="AuthRecord_struct..rdatastorage">rdatastorage</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::MaxRDLength" title='(anonymous struct)::MaxRDLength' data-ref="(anonymous)::MaxRDLength" data-ref-filename="(anonymous)..MaxRDLength">MaxRDLength</a> = (<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu16" title='mDNSu16' data-type='unsigned short' data-ref="mDNSu16" data-ref-filename="mDNSu16">mDNSu16</a>) <a class="local col6 ref" href="#176size" title='size' data-ref="176size" data-ref-filename="176size">size</a>;</td></tr>
<tr><th id="1226">1226</th><td>    <a class="local col7 ref" href="#177extra" title='extra' data-ref="177extra" data-ref-filename="177extra">extra</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord_struct::r" title='ExtraResourceRecord_struct::r' data-ref="ExtraResourceRecord_struct::r" data-ref-filename="ExtraResourceRecord_struct..r">r</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdlength" title='ResourceRecord_struct::rdlength' data-ref="ResourceRecord_struct::rdlength" data-ref-filename="ResourceRecord_struct..rdlength">rdlength</a> = <a class="local col1 ref" href="#171rdlen" title='rdlen' data-ref="171rdlen" data-ref-filename="171rdlen">rdlen</a>;</td></tr>
<tr><th id="1227">1227</th><td>    <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformMemCopy" title='mDNSPlatformMemCopy' data-ref="mDNSPlatformMemCopy" data-ref-filename="mDNSPlatformMemCopy">mDNSPlatformMemCopy</a>(&amp;<a class="local col7 ref" href="#177extra" title='extra' data-ref="177extra" data-ref-filename="177extra">extra</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord_struct::r" title='ExtraResourceRecord_struct::r' data-ref="ExtraResourceRecord_struct::r" data-ref-filename="ExtraResourceRecord_struct..r">r</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::rdatastorage" title='AuthRecord_struct::rdatastorage' data-ref="AuthRecord_struct::rdatastorage" data-ref-filename="AuthRecord_struct..rdatastorage">rdatastorage</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::u" title='(anonymous struct)::u' data-ref="(anonymous)::u" data-ref-filename="(anonymous)..u">u</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::data" title='(anonymous union)::data' data-ref="(anonymous)::data" data-ref-filename="(anonymous)..data">data</a>, <a class="local col2 ref" href="#172rdata" title='rdata' data-ref="172rdata" data-ref-filename="172rdata">rdata</a>, <a class="local col1 ref" href="#171rdlen" title='rdlen' data-ref="171rdlen" data-ref-filename="171rdlen">rdlen</a>);</td></tr>
<tr><th id="1228">1228</th><td>    <i>// use InterfaceID value from DNSServiceRegister() call that created the original service</i></td></tr>
<tr><th id="1229">1229</th><td>    <a class="local col7 ref" href="#177extra" title='extra' data-ref="177extra" data-ref-filename="177extra">extra</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord_struct::r" title='ExtraResourceRecord_struct::r' data-ref="ExtraResourceRecord_struct::r" data-ref-filename="ExtraResourceRecord_struct..r">r</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::InterfaceID" title='ResourceRecord_struct::InterfaceID' data-ref="ResourceRecord_struct::InterfaceID" data-ref-filename="ResourceRecord_struct..InterfaceID">InterfaceID</a> = <a class="local col8 ref" href="#168request" title='request' data-ref="168request" data-ref-filename="168request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::InterfaceID" title='request_state::(anonymous union)::(anonymous struct)::InterfaceID' data-ref="request_state::(anonymousunion)::(anonymous)::InterfaceID" data-ref-filename="request_state..(anonymousunion)..(anonymous)..InterfaceID">InterfaceID</a>;</td></tr>
<tr><th id="1230">1230</th><td></td></tr>
<tr><th id="1231">1231</th><td>    <a class="local col5 ref" href="#175result" title='result' data-ref="175result" data-ref-filename="175result">result</a> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_AddRecordToService" title='mDNS_AddRecordToService' data-ref="mDNS_AddRecordToService" data-ref-filename="mDNS_AddRecordToService">mDNS_AddRecordToService</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col4 ref" href="#174srs" title='srs' data-ref="174srs" data-ref-filename="174srs">srs</a>, <a class="local col7 ref" href="#177extra" title='extra' data-ref="177extra" data-ref-filename="177extra">extra</a>, &amp;<a class="local col7 ref" href="#177extra" title='extra' data-ref="177extra" data-ref-filename="177extra">extra</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord_struct::r" title='ExtraResourceRecord_struct::r' data-ref="ExtraResourceRecord_struct::r" data-ref-filename="ExtraResourceRecord_struct..r">r</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::rdatastorage" title='AuthRecord_struct::rdatastorage' data-ref="AuthRecord_struct::rdatastorage" data-ref-filename="AuthRecord_struct..rdatastorage">rdatastorage</a>, <a class="local col3 ref" href="#173ttl" title='ttl' data-ref="173ttl" data-ref-filename="173ttl">ttl</a>, <a class="local col8 ref" href="#168request" title='request' data-ref="168request" data-ref-filename="168request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a>);</td></tr>
<tr><th id="1232">1232</th><td>    <b>if</b> (<a class="local col5 ref" href="#175result" title='result' data-ref="175result" data-ref-filename="175result">result</a>)</td></tr>
<tr><th id="1233">1233</th><td>    {</td></tr>
<tr><th id="1234">1234</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(extra)" data-ref="_M/freeL">freeL</a>(<q>"ExtraResourceRecord/add_record_to_service"</q>, <a class="local col7 ref" href="#177extra" title='extra' data-ref="177extra" data-ref-filename="177extra">extra</a>);</td></tr>
<tr><th id="1235">1235</th><td>        <b>return</b> <a class="local col5 ref" href="#175result" title='result' data-ref="175result" data-ref-filename="175result">result</a>;</td></tr>
<tr><th id="1236">1236</th><td>    }</td></tr>
<tr><th id="1237">1237</th><td>    <a class="macro" href="uds_daemon.h.html#225" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMcastService" data-ref="_M/LogMcastS">LogMcastS</a>(&amp;<a class="local col4 ref" href="#174srs" title='srs' data-ref="174srs" data-ref-filename="174srs">srs</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_PTR" title='ServiceRecordSet_struct::RR_PTR' data-ref="ServiceRecordSet_struct::RR_PTR" data-ref-filename="ServiceRecordSet_struct..RR_PTR">RR_PTR</a>, <a class="local col8 ref" href="#168request" title='request' data-ref="168request" data-ref-filename="168request">request</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#reg_start" title='reg_start' data-ref="reg_start" data-ref-filename="reg_start">reg_start</a>);</td></tr>
<tr><th id="1238">1238</th><td></td></tr>
<tr><th id="1239">1239</th><td>    <a class="local col7 ref" href="#177extra" title='extra' data-ref="177extra" data-ref-filename="177extra">extra</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord_struct::ClientID" title='ExtraResourceRecord_struct::ClientID' data-ref="ExtraResourceRecord_struct::ClientID" data-ref-filename="ExtraResourceRecord_struct..ClientID">ClientID</a> = <a class="local col8 ref" href="#168request" title='request' data-ref="168request" data-ref-filename="168request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::reg_index" title='(anonymous struct)::reg_index' data-ref="(anonymous)::reg_index" data-ref-filename="(anonymous)..reg_index">reg_index</a>;</td></tr>
<tr><th id="1240">1240</th><td>    <b>if</b> (   <a class="local col9 ref" href="#169instance" title='instance' data-ref="169instance" data-ref-filename="169instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::external_advertise" title='service_instance::external_advertise' data-ref="service_instance::external_advertise" data-ref-filename="service_instance..external_advertise">external_advertise</a></td></tr>
<tr><th id="1241">1241</th><td>           &amp;&amp; <a class="ref fn" href="#callExternalHelpers" title='callExternalHelpers' data-ref="callExternalHelpers" data-ref-filename="callExternalHelpers">callExternalHelpers</a>(<a class="local col8 ref" href="#168request" title='request' data-ref="168request" data-ref-filename="168request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::InterfaceID" title='request_state::(anonymous union)::(anonymous struct)::InterfaceID' data-ref="request_state::(anonymousunion)::(anonymous)::InterfaceID" data-ref-filename="request_state..(anonymousunion)..(anonymous)..InterfaceID">InterfaceID</a>, &amp;<a class="local col9 ref" href="#169instance" title='instance' data-ref="169instance" data-ref-filename="169instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::domain" title='service_instance::domain' data-ref="service_instance::domain" data-ref-filename="service_instance..domain">domain</a>, <a class="local col8 ref" href="#168request" title='request' data-ref="168request" data-ref-filename="168request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a>))</td></tr>
<tr><th id="1242">1242</th><td>    {</td></tr>
<tr><th id="1243">1243</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;add_record_to_service: calling external_start_advertising_service&quot;);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"add_record_to_service: calling external_start_advertising_service"</q>);</td></tr>
<tr><th id="1244">1244</th><td>        <a class="macro" href="uds_daemon.h.html#266" title="(void)(&amp;extra-&gt;r.resrec)" data-ref="_M/external_start_advertising_service">external_start_advertising_service</a>(&amp;<a class="local col7 ref" href="#177extra" title='extra' data-ref="177extra" data-ref-filename="177extra">extra</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord_struct::r" title='ExtraResourceRecord_struct::r' data-ref="ExtraResourceRecord_struct::r" data-ref-filename="ExtraResourceRecord_struct..r">r</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>, request-&gt;flags);</td></tr>
<tr><th id="1245">1245</th><td>    }</td></tr>
<tr><th id="1246">1246</th><td>    <b>return</b> <a class="local col5 ref" href="#175result" title='result' data-ref="175result" data-ref-filename="175result">result</a>;</td></tr>
<tr><th id="1247">1247</th><td>}</td></tr>
<tr><th id="1248">1248</th><td></td></tr>
<tr><th id="1249">1249</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="decl def fn" id="handle_add_request" title='handle_add_request' data-ref="handle_add_request" data-ref-filename="handle_add_request">handle_add_request</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col8 decl" id="178request" title='request' data-type='request_state *' data-ref="178request" data-ref-filename="178request">request</dfn>)</td></tr>
<tr><th id="1250">1250</th><td>{</td></tr>
<tr><th id="1251">1251</th><td>    <a class="typedef" href="uds_daemon.h.html#service_instance" title='service_instance' data-type='struct service_instance' data-ref="service_instance" data-ref-filename="service_instance">service_instance</a> *<dfn class="local col9 decl" id="179i" title='i' data-type='service_instance *' data-ref="179i" data-ref-filename="179i">i</dfn>;</td></tr>
<tr><th id="1252">1252</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="local col0 decl" id="180result" title='result' data-type='mStatus' data-ref="180result" data-ref-filename="180result">result</dfn> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_UnknownErr" title='mStatus_UnknownErr' data-ref="mStatus_UnknownErr" data-ref-filename="mStatus_UnknownErr">mStatus_UnknownErr</a>;</td></tr>
<tr><th id="1253">1253</th><td>    <a class="typedef" href="dns_sd.h.html#DNSServiceFlags" title='DNSServiceFlags' data-type='uint32_t' data-ref="DNSServiceFlags" data-ref-filename="DNSServiceFlags">DNSServiceFlags</a> <dfn class="local col1 decl" id="181flags" title='flags' data-type='DNSServiceFlags' data-ref="181flags" data-ref-filename="181flags">flags</dfn>  = <a class="macro" href="dnssd_ipc.h.html#210" title="__dnssd_ipc_get_uint32" data-ref="_M/get_flags">get_flags</a> (&amp;<a class="local col8 ref" href="#178request" title='request' data-ref="178request" data-ref-filename="178request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col8 ref" href="#178request" title='request' data-ref="178request" data-ref-filename="178request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);</td></tr>
<tr><th id="1254">1254</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu16" title='mDNSu16' data-type='unsigned short' data-ref="mDNSu16" data-ref-filename="mDNSu16">mDNSu16</a> <dfn class="local col2 decl" id="182rrtype" title='rrtype' data-type='mDNSu16' data-ref="182rrtype" data-ref-filename="182rrtype">rrtype</dfn> = <a class="macro" href="dnssd_ipc.h.html#196" title="__dnssd_ipc_get_uint16" data-ref="_M/get_uint16">get_uint16</a>(&amp;<a class="local col8 ref" href="#178request" title='request' data-ref="178request" data-ref-filename="178request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col8 ref" href="#178request" title='request' data-ref="178request" data-ref-filename="178request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);</td></tr>
<tr><th id="1255">1255</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu16" title='mDNSu16' data-type='unsigned short' data-ref="mDNSu16" data-ref-filename="mDNSu16">mDNSu16</a> <dfn class="local col3 decl" id="183rdlen" title='rdlen' data-type='mDNSu16' data-ref="183rdlen" data-ref-filename="183rdlen">rdlen</dfn>  = <a class="macro" href="dnssd_ipc.h.html#196" title="__dnssd_ipc_get_uint16" data-ref="_M/get_uint16">get_uint16</a>(&amp;<a class="local col8 ref" href="#178request" title='request' data-ref="178request" data-ref-filename="178request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col8 ref" href="#178request" title='request' data-ref="178request" data-ref-filename="178request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);</td></tr>
<tr><th id="1256">1256</th><td>    <em>const</em> <em>char</em>     *<dfn class="local col4 decl" id="184rdata" title='rdata' data-type='const char *' data-ref="184rdata" data-ref-filename="184rdata">rdata</dfn>  = <a class="macro" href="dnssd_ipc.h.html#200" title="__dnssd_ipc_get_rdata" data-ref="_M/get_rdata">get_rdata</a> (&amp;<a class="local col8 ref" href="#178request" title='request' data-ref="178request" data-ref-filename="178request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col8 ref" href="#178request" title='request' data-ref="178request" data-ref-filename="178request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>, <a class="local col3 ref" href="#183rdlen" title='rdlen' data-ref="183rdlen" data-ref-filename="183rdlen">rdlen</a>);</td></tr>
<tr><th id="1257">1257</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col5 decl" id="185ttl" title='ttl' data-type='mDNSu32' data-ref="185ttl" data-ref-filename="185ttl">ttl</dfn>    = <a class="macro" href="dnssd_ipc.h.html#194" title="__dnssd_ipc_get_uint32" data-ref="_M/get_uint32">get_uint32</a>(&amp;<a class="local col8 ref" href="#178request" title='request' data-ref="178request" data-ref-filename="178request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col8 ref" href="#178request" title='request' data-ref="178request" data-ref-filename="178request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);</td></tr>
<tr><th id="1258">1258</th><td>    <b>if</b> (!<a class="local col5 ref" href="#185ttl" title='ttl' data-ref="185ttl" data-ref-filename="185ttl">ttl</a>) <a class="local col5 ref" href="#185ttl" title='ttl' data-ref="185ttl" data-ref-filename="185ttl">ttl</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#454" title="(((rrtype) == kDNSType_A || (rrtype) == kDNSType_AAAA || (rrtype) == kDNSType_SRV) ? 120UL : (3600UL * 100 / 80))" data-ref="_M/DefaultTTLforRRType">DefaultTTLforRRType</a>(<a class="local col2 ref" href="#182rrtype" title='rrtype' data-ref="182rrtype" data-ref-filename="182rrtype">rrtype</a>);</td></tr>
<tr><th id="1259">1259</th><td>    (<em>void</em>)<a class="local col1 ref" href="#181flags" title='flags' data-ref="181flags" data-ref-filename="181flags">flags</a>; <i>// Unused</i></td></tr>
<tr><th id="1260">1260</th><td></td></tr>
<tr><th id="1261">1261</th><td>    <b>if</b> (!<a class="local col8 ref" href="#178request" title='request' data-ref="178request" data-ref-filename="178request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>) { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: DNSServiceAddRecord(unreadable parameters)&quot;, request-&gt;sd)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: DNSServiceAddRecord(unreadable parameters)"</q>, <a class="local col8 ref" href="#178request" title='request' data-ref="178request" data-ref-filename="178request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>); <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>); }</td></tr>
<tr><th id="1262">1262</th><td></td></tr>
<tr><th id="1263">1263</th><td>    <i>// If this is a shared connection, check if the operation actually applies to a subordinate request_state object</i></td></tr>
<tr><th id="1264">1264</th><td>    <b>if</b> (<a class="local col8 ref" href="#178request" title='request' data-ref="178request" data-ref-filename="178request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> == <a class="ref fn" href="#connection_termination" title='connection_termination' data-ref="connection_termination" data-ref-filename="connection_termination">connection_termination</a>) <a class="local col8 ref" href="#178request" title='request' data-ref="178request" data-ref-filename="178request">request</a> = <a class="ref fn" href="#LocateSubordinateRequest" title='LocateSubordinateRequest' data-ref="LocateSubordinateRequest" data-ref-filename="LocateSubordinateRequest">LocateSubordinateRequest</a>(<a class="local col8 ref" href="#178request" title='request' data-ref="178request" data-ref-filename="178request">request</a>);</td></tr>
<tr><th id="1265">1265</th><td></td></tr>
<tr><th id="1266">1266</th><td>    <b>if</b> (<a class="local col8 ref" href="#178request" title='request' data-ref="178request" data-ref-filename="178request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> != <a class="ref fn" href="#regservice_termination_callback" title='regservice_termination_callback' data-ref="regservice_termination_callback" data-ref-filename="regservice_termination_callback">regservice_termination_callback</a>)</td></tr>
<tr><th id="1267">1267</th><td>    { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: DNSServiceAddRecord(not a registered service ref)&quot;, request-&gt;sd)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: DNSServiceAddRecord(not a registered service ref)"</q>, <a class="local col8 ref" href="#178request" title='request' data-ref="178request" data-ref-filename="178request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>); <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>); }</td></tr>
<tr><th id="1268">1268</th><td></td></tr>
<tr><th id="1269">1269</th><td>    <i>// For a service registered with zero port, don't allow adding records. This mostly happens due to a bug</i></td></tr>
<tr><th id="1270">1270</th><td><i>    // in the application. See radar://9165807.</i></td></tr>
<tr><th id="1271">1271</th><td>    <b>if</b> (<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2963" title="((request-&gt;u.servicereg.port).NotAnInteger == 0)" data-ref="_M/mDNSIPPortIsZero">mDNSIPPortIsZero</a>(<a class="local col8 ref" href="#178request" title='request' data-ref="178request" data-ref-filename="178request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::port" title='request_state::(anonymous union)::(anonymous struct)::port' data-ref="request_state::(anonymousunion)::(anonymous)::port" data-ref-filename="request_state..(anonymousunion)..(anonymous)..port">port</a>))</td></tr>
<tr><th id="1272">1272</th><td>    { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: DNSServiceAddRecord: adding record to a service registered with zero port&quot;, request-&gt;sd)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: DNSServiceAddRecord: adding record to a service registered with zero port"</q>, <a class="local col8 ref" href="#178request" title='request' data-ref="178request" data-ref-filename="178request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>); <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>); }</td></tr>
<tr><th id="1273">1273</th><td></td></tr>
<tr><th id="1274">1274</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: DNSServiceAddRecord(%X, %##s, %s, %d) PID[%d](%s)&quot;, request-&gt;sd, flags, (request-&gt;u.servicereg.instances) ? request-&gt;u.servicereg.instances-&gt;srs.RR_SRV.resrec.name-&gt;c : ((void *)0), DNSTypeName(rrtype), rdlen, request-&gt;process_id, request-&gt;pid_name);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: DNSServiceAddRecord(%X, %##s, %s, %d) PID[%d](%s)"</q>, <a class="local col8 ref" href="#178request" title='request' data-ref="178request" data-ref-filename="178request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col1 ref" href="#181flags" title='flags' data-ref="181flags" data-ref-filename="181flags">flags</a>,</td></tr>
<tr><th id="1275">1275</th><td>                 (<a class="local col8 ref" href="#178request" title='request' data-ref="178request" data-ref-filename="178request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::instances" title='request_state::(anonymous union)::(anonymous struct)::instances' data-ref="request_state::(anonymousunion)::(anonymous)::instances" data-ref-filename="request_state..(anonymousunion)..(anonymous)..instances">instances</a>) ? <a class="local col8 ref" href="#178request" title='request' data-ref="178request" data-ref-filename="178request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::instances" title='request_state::(anonymous union)::(anonymous struct)::instances' data-ref="request_state::(anonymousunion)::(anonymous)::instances" data-ref-filename="request_state..(anonymousunion)..(anonymous)..instances">instances</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_SRV" title='ServiceRecordSet_struct::RR_SRV' data-ref="ServiceRecordSet_struct::RR_SRV" data-ref-filename="ServiceRecordSet_struct..RR_SRV">RR_SRV</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::name" title='ResourceRecord_struct::name' data-ref="ResourceRecord_struct::name" data-ref-filename="ResourceRecord_struct..name">name</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a> : <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col2 ref" href="#182rrtype" title='rrtype' data-ref="182rrtype" data-ref-filename="182rrtype">rrtype</a>), <a class="local col3 ref" href="#183rdlen" title='rdlen' data-ref="183rdlen" data-ref-filename="183rdlen">rdlen</a>,</td></tr>
<tr><th id="1276">1276</th><td>                 <a class="local col8 ref" href="#178request" title='request' data-ref="178request" data-ref-filename="178request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col8 ref" href="#178request" title='request' data-ref="178request" data-ref-filename="178request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="1277">1277</th><td></td></tr>
<tr><th id="1278">1278</th><td>    <b>for</b> (<a class="local col9 ref" href="#179i" title='i' data-ref="179i" data-ref-filename="179i">i</a> = <a class="local col8 ref" href="#178request" title='request' data-ref="178request" data-ref-filename="178request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::instances" title='request_state::(anonymous union)::(anonymous struct)::instances' data-ref="request_state::(anonymousunion)::(anonymous)::instances" data-ref-filename="request_state..(anonymousunion)..(anonymous)..instances">instances</a>; <a class="local col9 ref" href="#179i" title='i' data-ref="179i" data-ref-filename="179i">i</a>; <a class="local col9 ref" href="#179i" title='i' data-ref="179i" data-ref-filename="179i">i</a> = <a class="local col9 ref" href="#179i" title='i' data-ref="179i" data-ref-filename="179i">i</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::next" title='service_instance::next' data-ref="service_instance::next" data-ref-filename="service_instance..next">next</a>)</td></tr>
<tr><th id="1279">1279</th><td>    {</td></tr>
<tr><th id="1280">1280</th><td>        <a class="local col0 ref" href="#180result" title='result' data-ref="180result" data-ref-filename="180result">result</a> = <a class="ref fn" href="#add_record_to_service" title='add_record_to_service' data-ref="add_record_to_service" data-ref-filename="add_record_to_service">add_record_to_service</a>(<a class="local col8 ref" href="#178request" title='request' data-ref="178request" data-ref-filename="178request">request</a>, <a class="local col9 ref" href="#179i" title='i' data-ref="179i" data-ref-filename="179i">i</a>, <a class="local col2 ref" href="#182rrtype" title='rrtype' data-ref="182rrtype" data-ref-filename="182rrtype">rrtype</a>, <a class="local col3 ref" href="#183rdlen" title='rdlen' data-ref="183rdlen" data-ref-filename="183rdlen">rdlen</a>, <a class="local col4 ref" href="#184rdata" title='rdata' data-ref="184rdata" data-ref-filename="184rdata">rdata</a>, <a class="local col5 ref" href="#185ttl" title='ttl' data-ref="185ttl" data-ref-filename="185ttl">ttl</a>);</td></tr>
<tr><th id="1281">1281</th><td>        <b>if</b> (<a class="local col0 ref" href="#180result" title='result' data-ref="180result" data-ref-filename="180result">result</a> &amp;&amp; <a class="local col9 ref" href="#179i" title='i' data-ref="179i" data-ref-filename="179i">i</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::default_local" title='service_instance::default_local' data-ref="service_instance::default_local" data-ref-filename="service_instance..default_local">default_local</a>) <b>break</b>;</td></tr>
<tr><th id="1282">1282</th><td>        <b>else</b> <a class="local col0 ref" href="#180result" title='result' data-ref="180result" data-ref-filename="180result">result</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_NoError" title='mStatus_NoError' data-ref="mStatus_NoError" data-ref-filename="mStatus_NoError">mStatus_NoError</a>;  <i>// suppress non-local default errors</i></td></tr>
<tr><th id="1283">1283</th><td>    }</td></tr>
<tr><th id="1284">1284</th><td></td></tr>
<tr><th id="1285">1285</th><td>    <b>return</b>(<a class="local col0 ref" href="#180result" title='result' data-ref="180result" data-ref-filename="180result">result</a>);</td></tr>
<tr><th id="1286">1286</th><td>}</td></tr>
<tr><th id="1287">1287</th><td></td></tr>
<tr><th id="1288">1288</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="update_callback" title='update_callback' data-ref="update_callback" data-ref-filename="update_callback">update_callback</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS" title='mDNS' data-type='struct mDNS_struct' data-ref="mDNS" data-ref-filename="mDNS">mDNS</a> *<em>const</em> <dfn class="local col6 decl" id="186m" title='m' data-type='mDNS *const' data-ref="186m" data-ref-filename="186m">m</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord" title='AuthRecord' data-type='struct AuthRecord_struct' data-ref="AuthRecord" data-ref-filename="AuthRecord">AuthRecord</a> *<em>const</em> <dfn class="local col7 decl" id="187rr" title='rr' data-type='AuthRecord *const' data-ref="187rr" data-ref-filename="187rr">rr</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#RData" title='RData' data-type='struct RData' data-ref="RData" data-ref-filename="RData">RData</a> *<dfn class="local col8 decl" id="188oldrd" title='oldrd' data-type='RData *' data-ref="188oldrd" data-ref-filename="188oldrd">oldrd</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu16" title='mDNSu16' data-type='unsigned short' data-ref="mDNSu16" data-ref-filename="mDNSu16">mDNSu16</a> <dfn class="local col9 decl" id="189oldrdlen" title='oldrdlen' data-type='mDNSu16' data-ref="189oldrdlen" data-ref-filename="189oldrdlen">oldrdlen</dfn>)</td></tr>
<tr><th id="1289">1289</th><td>{</td></tr>
<tr><th id="1290">1290</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSBool" title='mDNSBool' data-type='unsigned char' data-ref="mDNSBool" data-ref-filename="mDNSBool">mDNSBool</a> <dfn class="local col0 decl" id="190external_advertise" title='external_advertise' data-type='mDNSBool' data-ref="190external_advertise" data-ref-filename="190external_advertise">external_advertise</dfn> = (<a class="local col7 ref" href="#187rr" title='rr' data-ref="187rr" data-ref-filename="187rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::UpdateContext" title='AuthRecord_struct::UpdateContext' data-ref="AuthRecord_struct::UpdateContext" data-ref-filename="AuthRecord_struct..UpdateContext">UpdateContext</a>) ? *((<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSBool" title='mDNSBool' data-type='unsigned char' data-ref="mDNSBool" data-ref-filename="mDNSBool">mDNSBool</a> *)<a class="local col7 ref" href="#187rr" title='rr' data-ref="187rr" data-ref-filename="187rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::UpdateContext" title='AuthRecord_struct::UpdateContext' data-ref="AuthRecord_struct::UpdateContext" data-ref-filename="AuthRecord_struct..UpdateContext">UpdateContext</a>) : <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>;</td></tr>
<tr><th id="1291">1291</th><td>    (<em>void</em>)<a class="local col6 ref" href="#186m" title='m' data-ref="186m" data-ref-filename="186m">m</a>; <i>// Unused</i></td></tr>
<tr><th id="1292">1292</th><td></td></tr>
<tr><th id="1293">1293</th><td>    <i>// There are three cases.</i></td></tr>
<tr><th id="1294">1294</th><td><i>    //</i></td></tr>
<tr><th id="1295">1295</th><td><i>    // 1. We have updated the primary TXT record of the service</i></td></tr>
<tr><th id="1296">1296</th><td><i>    // 2. We have updated the TXT record that was added to the service using DNSServiceAddRecord</i></td></tr>
<tr><th id="1297">1297</th><td><i>    // 3. We have updated the TXT record that was registered using DNSServiceRegisterRecord</i></td></tr>
<tr><th id="1298">1298</th><td><i>    //</i></td></tr>
<tr><th id="1299">1299</th><td><i>    // external_advertise is set if we have advertised at least once during the initial addition</i></td></tr>
<tr><th id="1300">1300</th><td><i>    // of the record in all of the three cases above. We should have checked for InterfaceID/LocalDomain</i></td></tr>
<tr><th id="1301">1301</th><td><i>    // checks during the first time and hence we don't do any checks here</i></td></tr>
<tr><th id="1302">1302</th><td>    <b>if</b> (<a class="local col0 ref" href="#190external_advertise" title='external_advertise' data-ref="190external_advertise" data-ref-filename="190external_advertise">external_advertise</a>)</td></tr>
<tr><th id="1303">1303</th><td>    {</td></tr>
<tr><th id="1304">1304</th><td>        <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord" title='ResourceRecord' data-type='struct ResourceRecord_struct' data-ref="ResourceRecord" data-ref-filename="ResourceRecord">ResourceRecord</a> <dfn class="local col1 decl" id="191ext" title='ext' data-type='ResourceRecord' data-ref="191ext" data-ref-filename="191ext">ext</dfn> = <a class="local col7 ref" href="#187rr" title='rr' data-ref="187rr" data-ref-filename="187rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>;</td></tr>
<tr><th id="1305">1305</th><td>        <a class="typedef" href="dns_sd.h.html#DNSServiceFlags" title='DNSServiceFlags' data-type='uint32_t' data-ref="DNSServiceFlags" data-ref-filename="DNSServiceFlags">DNSServiceFlags</a> <dfn class="local col2 decl" id="192flags" title='flags' data-type='DNSServiceFlags' data-ref="192flags" data-ref-filename="192flags">flags</dfn> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#deriveD2DFlagsFromAuthRecType" title='deriveD2DFlagsFromAuthRecType' data-ref="deriveD2DFlagsFromAuthRecType" data-ref-filename="deriveD2DFlagsFromAuthRecType">deriveD2DFlagsFromAuthRecType</a>(<a class="local col7 ref" href="#187rr" title='rr' data-ref="187rr" data-ref-filename="187rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::ARType" title='AuthRecord_struct::ARType' data-ref="AuthRecord_struct::ARType" data-ref-filename="AuthRecord_struct..ARType">ARType</a>);</td></tr>
<tr><th id="1306">1306</th><td></td></tr>
<tr><th id="1307">1307</th><td>        <b>if</b> (<a class="local col1 ref" href="#191ext" title='ext' data-ref="191ext" data-ref-filename="191ext">ext</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdlength" title='ResourceRecord_struct::rdlength' data-ref="ResourceRecord_struct::rdlength" data-ref-filename="ResourceRecord_struct..rdlength">rdlength</a> == <a class="local col9 ref" href="#189oldrdlen" title='oldrdlen' data-ref="189oldrdlen" data-ref-filename="189oldrdlen">oldrdlen</a> &amp;&amp; <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformMemSame" title='mDNSPlatformMemSame' data-ref="mDNSPlatformMemSame" data-ref-filename="mDNSPlatformMemSame">mDNSPlatformMemSame</a>(&amp;<a class="local col1 ref" href="#191ext" title='ext' data-ref="191ext" data-ref-filename="191ext">ext</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdata" title='ResourceRecord_struct::rdata' data-ref="ResourceRecord_struct::rdata" data-ref-filename="ResourceRecord_struct..rdata">rdata</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::u" title='(anonymous struct)::u' data-ref="(anonymous)::u" data-ref-filename="(anonymous)..u">u</a>, &amp;<a class="local col8 ref" href="#188oldrd" title='oldrd' data-ref="188oldrd" data-ref-filename="188oldrd">oldrd</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::u" title='(anonymous struct)::u' data-ref="(anonymous)::u" data-ref-filename="(anonymous)..u">u</a>, <a class="local col9 ref" href="#189oldrdlen" title='oldrdlen' data-ref="189oldrdlen" data-ref-filename="189oldrdlen">oldrdlen</a>)) <b>goto</b> <a class="lbl" href="#193exit" data-ref="193exit" data-ref-filename="193exit">exit</a>;</td></tr>
<tr><th id="1308">1308</th><td>        <a class="ref fn" href="../mDNSCore/DNSCommon.h.html#SetNewRData" title='SetNewRData' data-ref="SetNewRData" data-ref-filename="SetNewRData">SetNewRData</a>(&amp;<a class="local col1 ref" href="#191ext" title='ext' data-ref="191ext" data-ref-filename="191ext">ext</a>, <a class="local col8 ref" href="#188oldrd" title='oldrd' data-ref="188oldrd" data-ref-filename="188oldrd">oldrd</a>, <a class="local col9 ref" href="#189oldrdlen" title='oldrdlen' data-ref="189oldrdlen" data-ref-filename="189oldrdlen">oldrdlen</a>);</td></tr>
<tr><th id="1309">1309</th><td>        <a class="macro" href="uds_daemon.h.html#267" title="do { (void)(&amp;ext); (void)(flags); } while (0)" data-ref="_M/external_stop_advertising_service">external_stop_advertising_service</a>(&amp;<a class="local col1 ref" href="#191ext" title='ext' data-ref="191ext" data-ref-filename="191ext">ext</a>, <a class="local col2 ref" href="#192flags" title='flags' data-ref="192flags" data-ref-filename="192flags">flags</a>);</td></tr>
<tr><th id="1310">1310</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;update_callback: calling external_start_advertising_service&quot;);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"update_callback: calling external_start_advertising_service"</q>);</td></tr>
<tr><th id="1311">1311</th><td>        <a class="macro" href="uds_daemon.h.html#266" title="(void)(&amp;rr-&gt;resrec)" data-ref="_M/external_start_advertising_service">external_start_advertising_service</a>(&amp;<a class="local col7 ref" href="#187rr" title='rr' data-ref="187rr" data-ref-filename="187rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>, flags);</td></tr>
<tr><th id="1312">1312</th><td>    }</td></tr>
<tr><th id="1313">1313</th><td><dfn class="lbl" id="193exit" data-ref="193exit" data-ref-filename="193exit">exit</dfn>:</td></tr>
<tr><th id="1314">1314</th><td>    <b>if</b> (<a class="local col8 ref" href="#188oldrd" title='oldrd' data-ref="188oldrd" data-ref-filename="188oldrd">oldrd</a> != &amp;<a class="local col7 ref" href="#187rr" title='rr' data-ref="187rr" data-ref-filename="187rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::rdatastorage" title='AuthRecord_struct::rdatastorage' data-ref="AuthRecord_struct::rdatastorage" data-ref-filename="AuthRecord_struct..rdatastorage">rdatastorage</a>) <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(oldrd)" data-ref="_M/freeL">freeL</a>(<q>"RData/update_callback"</q>, <a class="local col8 ref" href="#188oldrd" title='oldrd' data-ref="188oldrd" data-ref-filename="188oldrd">oldrd</a>);</td></tr>
<tr><th id="1315">1315</th><td>}</td></tr>
<tr><th id="1316">1316</th><td></td></tr>
<tr><th id="1317">1317</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="decl def fn" id="update_record" title='update_record' data-ref="update_record" data-ref-filename="update_record">update_record</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord" title='AuthRecord' data-type='struct AuthRecord_struct' data-ref="AuthRecord" data-ref-filename="AuthRecord">AuthRecord</a> *<dfn class="local col4 decl" id="194rr" title='rr' data-type='AuthRecord *' data-ref="194rr" data-ref-filename="194rr">rr</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu16" title='mDNSu16' data-type='unsigned short' data-ref="mDNSu16" data-ref-filename="mDNSu16">mDNSu16</a> <dfn class="local col5 decl" id="195rdlen" title='rdlen' data-type='mDNSu16' data-ref="195rdlen" data-ref-filename="195rdlen">rdlen</dfn>, <em>const</em> <em>char</em> *<dfn class="local col6 decl" id="196rdata" title='rdata' data-type='const char *' data-ref="196rdata" data-ref-filename="196rdata">rdata</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col7 decl" id="197ttl" title='ttl' data-type='mDNSu32' data-ref="197ttl" data-ref-filename="197ttl">ttl</dfn>, <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSBool" title='mDNSBool' data-type='unsigned char' data-ref="mDNSBool" data-ref-filename="mDNSBool">mDNSBool</a> *<em>const</em> <dfn class="local col8 decl" id="198external_advertise" title='external_advertise' data-type='const mDNSBool *const' data-ref="198external_advertise" data-ref-filename="198external_advertise">external_advertise</dfn>)</td></tr>
<tr><th id="1318">1318</th><td>{</td></tr>
<tr><th id="1319">1319</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="local col9 decl" id="199result" title='result' data-type='mStatus' data-ref="199result" data-ref-filename="199result">result</dfn>;</td></tr>
<tr><th id="1320">1320</th><td>    <em>const</em> <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#size_t" title='size_t' data-type='unsigned long' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col0 decl" id="200rdsize" title='rdsize' data-type='const size_t' data-ref="200rdsize" data-ref-filename="200rdsize">rdsize</dfn> = <a class="local col5 ref" href="#195rdlen" title='rdlen' data-ref="195rdlen" data-ref-filename="195rdlen">rdlen</a> &gt; <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#RDataBody" title='RDataBody' data-type='union RDataBody' data-ref="RDataBody" data-ref-filename="RDataBody">RDataBody</a>) ? <a class="local col5 ref" href="#195rdlen" title='rdlen' data-ref="195rdlen" data-ref-filename="195rdlen">rdlen</a> : <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#RDataBody" title='RDataBody' data-type='union RDataBody' data-ref="RDataBody" data-ref-filename="RDataBody">RDataBody</a>);</td></tr>
<tr><th id="1321">1321</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#RData" title='RData' data-type='struct RData' data-ref="RData" data-ref-filename="RData">RData</a> *<dfn class="local col1 decl" id="201newrd" title='newrd' data-type='RData *' data-ref="201newrd" data-ref-filename="201newrd">newrd</dfn> = <a class="macro" href="../mDNSCore/mDNSDebug.h.html#166" title="malloc(sizeof(RData) - sizeof(RDataBody) + rdsize)" data-ref="_M/mallocL">mallocL</a>(<q>"RData/update_record"</q>, <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#RData" title='RData' data-type='struct RData' data-ref="RData" data-ref-filename="RData">RData</a>) - <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#RDataBody" title='RDataBody' data-type='union RDataBody' data-ref="RDataBody" data-ref-filename="RDataBody">RDataBody</a>) + <a class="local col0 ref" href="#200rdsize" title='rdsize' data-ref="200rdsize" data-ref-filename="200rdsize">rdsize</a>);</td></tr>
<tr><th id="1322">1322</th><td>    <b>if</b> (!<a class="local col1 ref" href="#201newrd" title='newrd' data-ref="201newrd" data-ref-filename="201newrd">newrd</a>) <a class="ref fn" href="#FatalError" title='FatalError' data-ref="FatalError" data-ref-filename="FatalError">FatalError</a>(<q>"ERROR: malloc"</q>);</td></tr>
<tr><th id="1323">1323</th><td>    <a class="local col1 ref" href="#201newrd" title='newrd' data-ref="201newrd" data-ref-filename="201newrd">newrd</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::MaxRDLength" title='(anonymous struct)::MaxRDLength' data-ref="(anonymous)::MaxRDLength" data-ref-filename="(anonymous)..MaxRDLength">MaxRDLength</a> = (<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu16" title='mDNSu16' data-type='unsigned short' data-ref="mDNSu16" data-ref-filename="mDNSu16">mDNSu16</a>) <a class="local col0 ref" href="#200rdsize" title='rdsize' data-ref="200rdsize" data-ref-filename="200rdsize">rdsize</a>;</td></tr>
<tr><th id="1324">1324</th><td>    <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformMemCopy" title='mDNSPlatformMemCopy' data-ref="mDNSPlatformMemCopy" data-ref-filename="mDNSPlatformMemCopy">mDNSPlatformMemCopy</a>(&amp;<a class="local col1 ref" href="#201newrd" title='newrd' data-ref="201newrd" data-ref-filename="201newrd">newrd</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::u" title='(anonymous struct)::u' data-ref="(anonymous)::u" data-ref-filename="(anonymous)..u">u</a>, <a class="local col6 ref" href="#196rdata" title='rdata' data-ref="196rdata" data-ref-filename="196rdata">rdata</a>, <a class="local col5 ref" href="#195rdlen" title='rdlen' data-ref="195rdlen" data-ref-filename="195rdlen">rdlen</a>);</td></tr>
<tr><th id="1325">1325</th><td></td></tr>
<tr><th id="1326">1326</th><td>    <i>// BIND named (name daemon) doesn't allow TXT records with zero-length rdata. This is strictly speaking correct,</i></td></tr>
<tr><th id="1327">1327</th><td><i>    // since RFC 1035 specifies a TXT record as "One or more &lt;character-string&gt;s", not "Zero or more &lt;character-string&gt;s".</i></td></tr>
<tr><th id="1328">1328</th><td><i>    // Since some legacy apps try to create zero-length TXT records, we'll silently correct it here.</i></td></tr>
<tr><th id="1329">1329</th><td>    <b>if</b> (<a class="local col4 ref" href="#194rr" title='rr' data-ref="194rr" data-ref-filename="194rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rrtype" title='ResourceRecord_struct::rrtype' data-ref="ResourceRecord_struct::rrtype" data-ref-filename="ResourceRecord_struct..rrtype">rrtype</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSType_TXT" title='kDNSType_TXT' data-ref="kDNSType_TXT" data-ref-filename="kDNSType_TXT">kDNSType_TXT</a> &amp;&amp; <a class="local col5 ref" href="#195rdlen" title='rdlen' data-ref="195rdlen" data-ref-filename="195rdlen">rdlen</a> == <var>0</var>) { <a class="local col5 ref" href="#195rdlen" title='rdlen' data-ref="195rdlen" data-ref-filename="195rdlen">rdlen</a> = <var>1</var>; <a class="local col1 ref" href="#201newrd" title='newrd' data-ref="201newrd" data-ref-filename="201newrd">newrd</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::u" title='(anonymous struct)::u' data-ref="(anonymous)::u" data-ref-filename="(anonymous)..u">u</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::txt" title='(anonymous union)::txt' data-ref="(anonymous)::txt" data-ref-filename="(anonymous)..txt">txt</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>[<var>0</var>] = <var>0</var>; }</td></tr>
<tr><th id="1330">1330</th><td></td></tr>
<tr><th id="1331">1331</th><td>    <b>if</b> (<a class="local col8 ref" href="#198external_advertise" title='external_advertise' data-ref="198external_advertise" data-ref-filename="198external_advertise">external_advertise</a>) <a class="local col4 ref" href="#194rr" title='rr' data-ref="194rr" data-ref-filename="194rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::UpdateContext" title='AuthRecord_struct::UpdateContext' data-ref="AuthRecord_struct::UpdateContext" data-ref-filename="AuthRecord_struct..UpdateContext">UpdateContext</a> = (<em>void</em> *)<a class="local col8 ref" href="#198external_advertise" title='external_advertise' data-ref="198external_advertise" data-ref-filename="198external_advertise">external_advertise</a>;</td></tr>
<tr><th id="1332">1332</th><td></td></tr>
<tr><th id="1333">1333</th><td>    <a class="local col9 ref" href="#199result" title='result' data-ref="199result" data-ref-filename="199result">result</a> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_Update" title='mDNS_Update' data-ref="mDNS_Update" data-ref-filename="mDNS_Update">mDNS_Update</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col4 ref" href="#194rr" title='rr' data-ref="194rr" data-ref-filename="194rr">rr</a>, <a class="local col7 ref" href="#197ttl" title='ttl' data-ref="197ttl" data-ref-filename="197ttl">ttl</a>, <a class="local col5 ref" href="#195rdlen" title='rdlen' data-ref="195rdlen" data-ref-filename="195rdlen">rdlen</a>, <a class="local col1 ref" href="#201newrd" title='newrd' data-ref="201newrd" data-ref-filename="201newrd">newrd</a>, <a class="ref fn" href="#update_callback" title='update_callback' data-ref="update_callback" data-ref-filename="update_callback">update_callback</a>);</td></tr>
<tr><th id="1334">1334</th><td>    <b>if</b> (<a class="local col9 ref" href="#199result" title='result' data-ref="199result" data-ref-filename="199result">result</a>) { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;update_record: Error %d for %s&quot;, (int)result, GetRRDisplayString_rdb(&amp;(rr)-&gt;resrec, &amp;(rr)-&gt;resrec.rdata-&gt;u, (&amp;mDNSStorage)-&gt;MsgBuffer))" data-ref="_M/LogMsg">LogMsg</a>(<q>"update_record: Error %d for %s"</q>, (<em>int</em>)<a class="local col9 ref" href="#199result" title='result' data-ref="199result" data-ref-filename="199result">result</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2942" title="GetRRDisplayString_rdb(&amp;(rr)-&gt;resrec, &amp;(rr)-&gt;resrec.rdata-&gt;u, (&amp;mDNSStorage)-&gt;MsgBuffer)" data-ref="_M/ARDisplayString">ARDisplayString</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col4 ref" href="#194rr" title='rr' data-ref="194rr" data-ref-filename="194rr">rr</a>)); <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(newrd)" data-ref="_M/freeL">freeL</a>(<q>"RData/update_record"</q>, <a class="local col1 ref" href="#201newrd" title='newrd' data-ref="201newrd" data-ref-filename="201newrd">newrd</a>); }</td></tr>
<tr><th id="1335">1335</th><td>    <b>return</b> <a class="local col9 ref" href="#199result" title='result' data-ref="199result" data-ref-filename="199result">result</a>;</td></tr>
<tr><th id="1336">1336</th><td>}</td></tr>
<tr><th id="1337">1337</th><td></td></tr>
<tr><th id="1338">1338</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="decl def fn" id="handle_update_request" title='handle_update_request' data-ref="handle_update_request" data-ref-filename="handle_update_request">handle_update_request</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col2 decl" id="202request" title='request' data-type='request_state *' data-ref="202request" data-ref-filename="202request">request</dfn>)</td></tr>
<tr><th id="1339">1339</th><td>{</td></tr>
<tr><th id="1340">1340</th><td>    <em>const</em> <a class="typedef" href="dnssd_ipc.h.html#ipc_msg_hdr" title='ipc_msg_hdr' data-type='struct ipc_msg_hdr' data-ref="ipc_msg_hdr" data-ref-filename="ipc_msg_hdr">ipc_msg_hdr</a> *<em>const</em> <dfn class="local col3 decl" id="203hdr" title='hdr' data-type='const ipc_msg_hdr *const' data-ref="203hdr" data-ref-filename="203hdr">hdr</dfn> = &amp;<a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>;</td></tr>
<tr><th id="1341">1341</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="local col4 decl" id="204result" title='result' data-type='mStatus' data-ref="204result" data-ref-filename="204result">result</dfn> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadReferenceErr" title='mStatus_BadReferenceErr' data-ref="mStatus_BadReferenceErr" data-ref-filename="mStatus_BadReferenceErr">mStatus_BadReferenceErr</a>;</td></tr>
<tr><th id="1342">1342</th><td>    <a class="typedef" href="uds_daemon.h.html#service_instance" title='service_instance' data-type='struct service_instance' data-ref="service_instance" data-ref-filename="service_instance">service_instance</a> *<dfn class="local col5 decl" id="205i" title='i' data-type='service_instance *' data-ref="205i" data-ref-filename="205i">i</dfn>;</td></tr>
<tr><th id="1343">1343</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord" title='AuthRecord' data-type='struct AuthRecord_struct' data-ref="AuthRecord" data-ref-filename="AuthRecord">AuthRecord</a> *<dfn class="local col6 decl" id="206rr" title='rr' data-type='AuthRecord *' data-ref="206rr" data-ref-filename="206rr">rr</dfn> = <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="1344">1344</th><td></td></tr>
<tr><th id="1345">1345</th><td>    <i>// get the message data</i></td></tr>
<tr><th id="1346">1346</th><td>    <a class="typedef" href="dns_sd.h.html#DNSServiceFlags" title='DNSServiceFlags' data-type='uint32_t' data-ref="DNSServiceFlags" data-ref-filename="DNSServiceFlags">DNSServiceFlags</a> <dfn class="local col7 decl" id="207flags" title='flags' data-type='DNSServiceFlags' data-ref="207flags" data-ref-filename="207flags">flags</dfn> = <a class="macro" href="dnssd_ipc.h.html#210" title="__dnssd_ipc_get_uint32" data-ref="_M/get_flags">get_flags</a> (&amp;<a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);  <i>// flags unused</i></td></tr>
<tr><th id="1347">1347</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu16" title='mDNSu16' data-type='unsigned short' data-ref="mDNSu16" data-ref-filename="mDNSu16">mDNSu16</a> <dfn class="local col8 decl" id="208rdlen" title='rdlen' data-type='mDNSu16' data-ref="208rdlen" data-ref-filename="208rdlen">rdlen</dfn> = <a class="macro" href="dnssd_ipc.h.html#196" title="__dnssd_ipc_get_uint16" data-ref="_M/get_uint16">get_uint16</a>(&amp;<a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);</td></tr>
<tr><th id="1348">1348</th><td>    <em>const</em> <em>char</em>     *<dfn class="local col9 decl" id="209rdata" title='rdata' data-type='const char *' data-ref="209rdata" data-ref-filename="209rdata">rdata</dfn> = <a class="macro" href="dnssd_ipc.h.html#200" title="__dnssd_ipc_get_rdata" data-ref="_M/get_rdata">get_rdata</a> (&amp;<a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>, <a class="local col8 ref" href="#208rdlen" title='rdlen' data-ref="208rdlen" data-ref-filename="208rdlen">rdlen</a>);</td></tr>
<tr><th id="1349">1349</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col0 decl" id="210ttl" title='ttl' data-type='mDNSu32' data-ref="210ttl" data-ref-filename="210ttl">ttl</dfn>   = <a class="macro" href="dnssd_ipc.h.html#194" title="__dnssd_ipc_get_uint32" data-ref="_M/get_uint32">get_uint32</a>(&amp;<a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);</td></tr>
<tr><th id="1350">1350</th><td>    (<em>void</em>)<a class="local col7 ref" href="#207flags" title='flags' data-ref="207flags" data-ref-filename="207flags">flags</a>; <i>// Unused</i></td></tr>
<tr><th id="1351">1351</th><td></td></tr>
<tr><th id="1352">1352</th><td>    <b>if</b> (!<a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>) { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: DNSServiceUpdateRecord(unreadable parameters)&quot;, request-&gt;sd)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: DNSServiceUpdateRecord(unreadable parameters)"</q>, <a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>); <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>); }</td></tr>
<tr><th id="1353">1353</th><td></td></tr>
<tr><th id="1354">1354</th><td>    <i>// If this is a shared connection, check if the operation actually applies to a subordinate request_state object</i></td></tr>
<tr><th id="1355">1355</th><td>    <b>if</b> (<a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> == <a class="ref fn" href="#connection_termination" title='connection_termination' data-ref="connection_termination" data-ref-filename="connection_termination">connection_termination</a>) <a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a> = <a class="ref fn" href="#LocateSubordinateRequest" title='LocateSubordinateRequest' data-ref="LocateSubordinateRequest" data-ref-filename="LocateSubordinateRequest">LocateSubordinateRequest</a>(<a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>);</td></tr>
<tr><th id="1356">1356</th><td></td></tr>
<tr><th id="1357">1357</th><td>    <b>if</b> (<a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> == <a class="ref fn" href="#connection_termination" title='connection_termination' data-ref="connection_termination" data-ref-filename="connection_termination">connection_termination</a>)</td></tr>
<tr><th id="1358">1358</th><td>    {</td></tr>
<tr><th id="1359">1359</th><td>        <i>// update an individually registered record</i></td></tr>
<tr><th id="1360">1360</th><td>        <a class="typedef" href="uds_daemon.h.html#registered_record_entry" title='registered_record_entry' data-type='struct registered_record_entry' data-ref="registered_record_entry" data-ref-filename="registered_record_entry">registered_record_entry</a> *<dfn class="local col1 decl" id="211reptr" title='reptr' data-type='registered_record_entry *' data-ref="211reptr" data-ref-filename="211reptr">reptr</dfn>;</td></tr>
<tr><th id="1361">1361</th><td>        <b>for</b> (<a class="local col1 ref" href="#211reptr" title='reptr' data-ref="211reptr" data-ref-filename="211reptr">reptr</a> = <a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::reg_recs" title='request_state::(anonymous union)::reg_recs' data-ref="request_state::(anonymous)::reg_recs" data-ref-filename="request_state..(anonymous)..reg_recs">reg_recs</a>; <a class="local col1 ref" href="#211reptr" title='reptr' data-ref="211reptr" data-ref-filename="211reptr">reptr</a>; <a class="local col1 ref" href="#211reptr" title='reptr' data-ref="211reptr" data-ref-filename="211reptr">reptr</a> = <a class="local col1 ref" href="#211reptr" title='reptr' data-ref="211reptr" data-ref-filename="211reptr">reptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::next" title='registered_record_entry::next' data-ref="registered_record_entry::next" data-ref-filename="registered_record_entry..next">next</a>)</td></tr>
<tr><th id="1362">1362</th><td>        {</td></tr>
<tr><th id="1363">1363</th><td>            <b>if</b> (<a class="local col1 ref" href="#211reptr" title='reptr' data-ref="211reptr" data-ref-filename="211reptr">reptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::key" title='registered_record_entry::key' data-ref="registered_record_entry::key" data-ref-filename="registered_record_entry..key">key</a> == <a class="local col3 ref" href="#203hdr" title='hdr' data-ref="203hdr" data-ref-filename="203hdr">hdr</a>-&gt;<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::reg_index" title='(anonymous struct)::reg_index' data-ref="(anonymous)::reg_index" data-ref-filename="(anonymous)..reg_index">reg_index</a>)</td></tr>
<tr><th id="1364">1364</th><td>            {</td></tr>
<tr><th id="1365">1365</th><td>                <a class="local col4 ref" href="#204result" title='result' data-ref="204result" data-ref-filename="204result">result</a> = <a class="ref fn" href="#update_record" title='update_record' data-ref="update_record" data-ref-filename="update_record">update_record</a>(<a class="local col1 ref" href="#211reptr" title='reptr' data-ref="211reptr" data-ref-filename="211reptr">reptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::rr" title='registered_record_entry::rr' data-ref="registered_record_entry::rr" data-ref-filename="registered_record_entry..rr">rr</a>, <a class="local col8 ref" href="#208rdlen" title='rdlen' data-ref="208rdlen" data-ref-filename="208rdlen">rdlen</a>, <a class="local col9 ref" href="#209rdata" title='rdata' data-ref="209rdata" data-ref-filename="209rdata">rdata</a>, <a class="local col0 ref" href="#210ttl" title='ttl' data-ref="210ttl" data-ref-filename="210ttl">ttl</a>, &amp;<a class="local col1 ref" href="#211reptr" title='reptr' data-ref="211reptr" data-ref-filename="211reptr">reptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::external_advertise" title='registered_record_entry::external_advertise' data-ref="registered_record_entry::external_advertise" data-ref-filename="registered_record_entry..external_advertise">external_advertise</a>);</td></tr>
<tr><th id="1366">1366</th><td>                <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: DNSServiceUpdateRecord(%##s, %s) PID[%d](%s)&quot;, request-&gt;sd, reptr-&gt;rr-&gt;resrec.name-&gt;c, reptr-&gt;rr ? DNSTypeName(reptr-&gt;rr-&gt;resrec.rrtype) : &quot;&lt;NONE&gt;&quot;, request-&gt;process_id, request-&gt;pid_name);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: DNSServiceUpdateRecord(%##s, %s) PID[%d](%s)"</q>,</td></tr>
<tr><th id="1367">1367</th><td>                             <a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col1 ref" href="#211reptr" title='reptr' data-ref="211reptr" data-ref-filename="211reptr">reptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::rr" title='registered_record_entry::rr' data-ref="registered_record_entry::rr" data-ref-filename="registered_record_entry..rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::name" title='ResourceRecord_struct::name' data-ref="ResourceRecord_struct::name" data-ref-filename="ResourceRecord_struct..name">name</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="local col1 ref" href="#211reptr" title='reptr' data-ref="211reptr" data-ref-filename="211reptr">reptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::rr" title='registered_record_entry::rr' data-ref="registered_record_entry::rr" data-ref-filename="registered_record_entry..rr">rr</a> ? <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col1 ref" href="#211reptr" title='reptr' data-ref="211reptr" data-ref-filename="211reptr">reptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::rr" title='registered_record_entry::rr' data-ref="registered_record_entry::rr" data-ref-filename="registered_record_entry..rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rrtype" title='ResourceRecord_struct::rrtype' data-ref="ResourceRecord_struct::rrtype" data-ref-filename="ResourceRecord_struct..rrtype">rrtype</a>) : <q>"&lt;NONE&gt;"</q>,</td></tr>
<tr><th id="1368">1368</th><td>                             <a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="1369">1369</th><td>                <b>goto</b> <a class="lbl" href="#212end" data-ref="212end" data-ref-filename="212end">end</a>;</td></tr>
<tr><th id="1370">1370</th><td>            }</td></tr>
<tr><th id="1371">1371</th><td>        }</td></tr>
<tr><th id="1372">1372</th><td>        <a class="local col4 ref" href="#204result" title='result' data-ref="204result" data-ref-filename="204result">result</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadReferenceErr" title='mStatus_BadReferenceErr' data-ref="mStatus_BadReferenceErr" data-ref-filename="mStatus_BadReferenceErr">mStatus_BadReferenceErr</a>;</td></tr>
<tr><th id="1373">1373</th><td>        <b>goto</b> <a class="lbl" href="#212end" data-ref="212end" data-ref-filename="212end">end</a>;</td></tr>
<tr><th id="1374">1374</th><td>    }</td></tr>
<tr><th id="1375">1375</th><td></td></tr>
<tr><th id="1376">1376</th><td>    <b>if</b> (<a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> != <a class="ref fn" href="#regservice_termination_callback" title='regservice_termination_callback' data-ref="regservice_termination_callback" data-ref-filename="regservice_termination_callback">regservice_termination_callback</a>)</td></tr>
<tr><th id="1377">1377</th><td>    { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: DNSServiceUpdateRecord(not a registered service ref)&quot;, request-&gt;sd)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: DNSServiceUpdateRecord(not a registered service ref)"</q>, <a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>); <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>); }</td></tr>
<tr><th id="1378">1378</th><td></td></tr>
<tr><th id="1379">1379</th><td>    <i>// For a service registered with zero port, only SRV record is initialized. Don't allow any updates.</i></td></tr>
<tr><th id="1380">1380</th><td>    <b>if</b> (<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2963" title="((request-&gt;u.servicereg.port).NotAnInteger == 0)" data-ref="_M/mDNSIPPortIsZero">mDNSIPPortIsZero</a>(<a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::port" title='request_state::(anonymous union)::(anonymous struct)::port' data-ref="request_state::(anonymousunion)::(anonymous)::port" data-ref-filename="request_state..(anonymousunion)..(anonymous)..port">port</a>))</td></tr>
<tr><th id="1381">1381</th><td>    { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: DNSServiceUpdateRecord: updating the record of a service registered with zero port&quot;, request-&gt;sd)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: DNSServiceUpdateRecord: updating the record of a service registered with zero port"</q>, <a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>); <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>); }</td></tr>
<tr><th id="1382">1382</th><td></td></tr>
<tr><th id="1383">1383</th><td>    <i>// update the saved off TXT data for the service</i></td></tr>
<tr><th id="1384">1384</th><td>    <b>if</b> (<a class="local col3 ref" href="#203hdr" title='hdr' data-ref="203hdr" data-ref-filename="203hdr">hdr</a>-&gt;<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::reg_index" title='(anonymous struct)::reg_index' data-ref="(anonymous)::reg_index" data-ref-filename="(anonymous)..reg_index">reg_index</a> == <a class="macro" href="dnssd_ipc.h.html#99" title="((uint32_t)(-1))" data-ref="_M/TXT_RECORD_INDEX">TXT_RECORD_INDEX</a>)</td></tr>
<tr><th id="1385">1385</th><td>    {</td></tr>
<tr><th id="1386">1386</th><td>        <b>if</b> (<a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txtdata" title='request_state::(anonymous union)::(anonymous struct)::txtdata' data-ref="request_state::(anonymousunion)::(anonymous)::txtdata" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txtdata">txtdata</a>)</td></tr>
<tr><th id="1387">1387</th><td>        { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(request-&gt;u.servicereg.txtdata)" data-ref="_M/freeL">freeL</a>(<q>"service_info txtdata"</q>, <a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txtdata" title='request_state::(anonymous union)::(anonymous struct)::txtdata' data-ref="request_state::(anonymousunion)::(anonymous)::txtdata" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txtdata">txtdata</a>); <a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txtdata" title='request_state::(anonymous union)::(anonymous struct)::txtdata' data-ref="request_state::(anonymousunion)::(anonymous)::txtdata" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txtdata">txtdata</a> = <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>; }</td></tr>
<tr><th id="1388">1388</th><td>        <b>if</b> (<a class="local col8 ref" href="#208rdlen" title='rdlen' data-ref="208rdlen" data-ref-filename="208rdlen">rdlen</a> &gt; <var>0</var>)</td></tr>
<tr><th id="1389">1389</th><td>        {</td></tr>
<tr><th id="1390">1390</th><td>            <a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txtdata" title='request_state::(anonymous union)::(anonymous struct)::txtdata' data-ref="request_state::(anonymousunion)::(anonymous)::txtdata" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txtdata">txtdata</a> = <a class="macro" href="../mDNSCore/mDNSDebug.h.html#166" title="malloc(rdlen)" data-ref="_M/mallocL">mallocL</a>(<q>"service_info txtdata"</q>, <a class="local col8 ref" href="#208rdlen" title='rdlen' data-ref="208rdlen" data-ref-filename="208rdlen">rdlen</a>);</td></tr>
<tr><th id="1391">1391</th><td>            <b>if</b> (!<a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txtdata" title='request_state::(anonymous union)::(anonymous struct)::txtdata' data-ref="request_state::(anonymousunion)::(anonymous)::txtdata" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txtdata">txtdata</a>) <a class="ref fn" href="#FatalError" title='FatalError' data-ref="FatalError" data-ref-filename="FatalError">FatalError</a>(<q>"ERROR: handle_update_request - malloc"</q>);</td></tr>
<tr><th id="1392">1392</th><td>            <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformMemCopy" title='mDNSPlatformMemCopy' data-ref="mDNSPlatformMemCopy" data-ref-filename="mDNSPlatformMemCopy">mDNSPlatformMemCopy</a>(<a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txtdata" title='request_state::(anonymous union)::(anonymous struct)::txtdata' data-ref="request_state::(anonymousunion)::(anonymous)::txtdata" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txtdata">txtdata</a>, <a class="local col9 ref" href="#209rdata" title='rdata' data-ref="209rdata" data-ref-filename="209rdata">rdata</a>, <a class="local col8 ref" href="#208rdlen" title='rdlen' data-ref="208rdlen" data-ref-filename="208rdlen">rdlen</a>);</td></tr>
<tr><th id="1393">1393</th><td>        }</td></tr>
<tr><th id="1394">1394</th><td>        <a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txtlen" title='request_state::(anonymous union)::(anonymous struct)::txtlen' data-ref="request_state::(anonymousunion)::(anonymous)::txtlen" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txtlen">txtlen</a> = <a class="local col8 ref" href="#208rdlen" title='rdlen' data-ref="208rdlen" data-ref-filename="208rdlen">rdlen</a>;</td></tr>
<tr><th id="1395">1395</th><td>    }</td></tr>
<tr><th id="1396">1396</th><td></td></tr>
<tr><th id="1397">1397</th><td>    <i>// update a record from a service record set</i></td></tr>
<tr><th id="1398">1398</th><td>    <b>for</b> (<a class="local col5 ref" href="#205i" title='i' data-ref="205i" data-ref-filename="205i">i</a> = <a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::instances" title='request_state::(anonymous union)::(anonymous struct)::instances' data-ref="request_state::(anonymousunion)::(anonymous)::instances" data-ref-filename="request_state..(anonymousunion)..(anonymous)..instances">instances</a>; <a class="local col5 ref" href="#205i" title='i' data-ref="205i" data-ref-filename="205i">i</a>; <a class="local col5 ref" href="#205i" title='i' data-ref="205i" data-ref-filename="205i">i</a> = <a class="local col5 ref" href="#205i" title='i' data-ref="205i" data-ref-filename="205i">i</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::next" title='service_instance::next' data-ref="service_instance::next" data-ref-filename="service_instance..next">next</a>)</td></tr>
<tr><th id="1399">1399</th><td>    {</td></tr>
<tr><th id="1400">1400</th><td>        <b>if</b> (<a class="local col3 ref" href="#203hdr" title='hdr' data-ref="203hdr" data-ref-filename="203hdr">hdr</a>-&gt;<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::reg_index" title='(anonymous struct)::reg_index' data-ref="(anonymous)::reg_index" data-ref-filename="(anonymous)..reg_index">reg_index</a> == <a class="macro" href="dnssd_ipc.h.html#99" title="((uint32_t)(-1))" data-ref="_M/TXT_RECORD_INDEX">TXT_RECORD_INDEX</a>) <a class="local col6 ref" href="#206rr" title='rr' data-ref="206rr" data-ref-filename="206rr">rr</a> = &amp;<a class="local col5 ref" href="#205i" title='i' data-ref="205i" data-ref-filename="205i">i</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_TXT" title='ServiceRecordSet_struct::RR_TXT' data-ref="ServiceRecordSet_struct::RR_TXT" data-ref-filename="ServiceRecordSet_struct..RR_TXT">RR_TXT</a>;</td></tr>
<tr><th id="1401">1401</th><td>        <b>else</b></td></tr>
<tr><th id="1402">1402</th><td>        {</td></tr>
<tr><th id="1403">1403</th><td>            <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord" title='ExtraResourceRecord' data-type='struct ExtraResourceRecord_struct' data-ref="ExtraResourceRecord" data-ref-filename="ExtraResourceRecord">ExtraResourceRecord</a> *<dfn class="local col3 decl" id="213e" title='e' data-type='ExtraResourceRecord *' data-ref="213e" data-ref-filename="213e">e</dfn>;</td></tr>
<tr><th id="1404">1404</th><td>            <b>for</b> (<a class="local col3 ref" href="#213e" title='e' data-ref="213e" data-ref-filename="213e">e</a> = <a class="local col5 ref" href="#205i" title='i' data-ref="205i" data-ref-filename="205i">i</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::Extras" title='ServiceRecordSet_struct::Extras' data-ref="ServiceRecordSet_struct::Extras" data-ref-filename="ServiceRecordSet_struct..Extras">Extras</a>; <a class="local col3 ref" href="#213e" title='e' data-ref="213e" data-ref-filename="213e">e</a>; <a class="local col3 ref" href="#213e" title='e' data-ref="213e" data-ref-filename="213e">e</a> = <a class="local col3 ref" href="#213e" title='e' data-ref="213e" data-ref-filename="213e">e</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord_struct::next" title='ExtraResourceRecord_struct::next' data-ref="ExtraResourceRecord_struct::next" data-ref-filename="ExtraResourceRecord_struct..next">next</a>)</td></tr>
<tr><th id="1405">1405</th><td>                <b>if</b> (<a class="local col3 ref" href="#213e" title='e' data-ref="213e" data-ref-filename="213e">e</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord_struct::ClientID" title='ExtraResourceRecord_struct::ClientID' data-ref="ExtraResourceRecord_struct::ClientID" data-ref-filename="ExtraResourceRecord_struct..ClientID">ClientID</a> == <a class="local col3 ref" href="#203hdr" title='hdr' data-ref="203hdr" data-ref-filename="203hdr">hdr</a>-&gt;<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::reg_index" title='(anonymous struct)::reg_index' data-ref="(anonymous)::reg_index" data-ref-filename="(anonymous)..reg_index">reg_index</a>) { <a class="local col6 ref" href="#206rr" title='rr' data-ref="206rr" data-ref-filename="206rr">rr</a> = &amp;<a class="local col3 ref" href="#213e" title='e' data-ref="213e" data-ref-filename="213e">e</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord_struct::r" title='ExtraResourceRecord_struct::r' data-ref="ExtraResourceRecord_struct::r" data-ref-filename="ExtraResourceRecord_struct..r">r</a>; <b>break</b>; }</td></tr>
<tr><th id="1406">1406</th><td>        }</td></tr>
<tr><th id="1407">1407</th><td></td></tr>
<tr><th id="1408">1408</th><td>        <b>if</b> (!<a class="local col6 ref" href="#206rr" title='rr' data-ref="206rr" data-ref-filename="206rr">rr</a>) { <a class="local col4 ref" href="#204result" title='result' data-ref="204result" data-ref-filename="204result">result</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadReferenceErr" title='mStatus_BadReferenceErr' data-ref="mStatus_BadReferenceErr" data-ref-filename="mStatus_BadReferenceErr">mStatus_BadReferenceErr</a>; <b>goto</b> <a class="lbl" href="#212end" data-ref="212end" data-ref-filename="212end">end</a>; }</td></tr>
<tr><th id="1409">1409</th><td>        <a class="local col4 ref" href="#204result" title='result' data-ref="204result" data-ref-filename="204result">result</a> = <a class="ref fn" href="#update_record" title='update_record' data-ref="update_record" data-ref-filename="update_record">update_record</a>(<a class="local col6 ref" href="#206rr" title='rr' data-ref="206rr" data-ref-filename="206rr">rr</a>, <a class="local col8 ref" href="#208rdlen" title='rdlen' data-ref="208rdlen" data-ref-filename="208rdlen">rdlen</a>, <a class="local col9 ref" href="#209rdata" title='rdata' data-ref="209rdata" data-ref-filename="209rdata">rdata</a>, <a class="local col0 ref" href="#210ttl" title='ttl' data-ref="210ttl" data-ref-filename="210ttl">ttl</a>, &amp;<a class="local col5 ref" href="#205i" title='i' data-ref="205i" data-ref-filename="205i">i</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::external_advertise" title='service_instance::external_advertise' data-ref="service_instance::external_advertise" data-ref-filename="service_instance..external_advertise">external_advertise</a>);</td></tr>
<tr><th id="1410">1410</th><td>        <b>if</b> (<a class="local col4 ref" href="#204result" title='result' data-ref="204result" data-ref-filename="204result">result</a> &amp;&amp; <a class="local col5 ref" href="#205i" title='i' data-ref="205i" data-ref-filename="205i">i</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::default_local" title='service_instance::default_local' data-ref="service_instance::default_local" data-ref-filename="service_instance..default_local">default_local</a>) <b>goto</b> <a class="lbl" href="#212end" data-ref="212end" data-ref-filename="212end">end</a>;</td></tr>
<tr><th id="1411">1411</th><td>        <b>else</b> <a class="local col4 ref" href="#204result" title='result' data-ref="204result" data-ref-filename="204result">result</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_NoError" title='mStatus_NoError' data-ref="mStatus_NoError" data-ref-filename="mStatus_NoError">mStatus_NoError</a>;  <i>// suppress non-local default errors</i></td></tr>
<tr><th id="1412">1412</th><td>    }</td></tr>
<tr><th id="1413">1413</th><td></td></tr>
<tr><th id="1414">1414</th><td><dfn class="lbl" id="212end" data-ref="212end" data-ref-filename="212end">end</dfn>:</td></tr>
<tr><th id="1415">1415</th><td>    <b>if</b> (<a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> == <a class="ref fn" href="#regservice_termination_callback" title='regservice_termination_callback' data-ref="regservice_termination_callback" data-ref-filename="regservice_termination_callback">regservice_termination_callback</a>)</td></tr>
<tr><th id="1416">1416</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: DNSServiceUpdateRecord(%##s, %s)  PID[%d](%s)&quot;, request-&gt;sd, (request-&gt;u.servicereg.instances) ? request-&gt;u.servicereg.instances-&gt;srs.RR_SRV.resrec.name-&gt;c : ((void *)0), rr ? DNSTypeName(rr-&gt;resrec.rrtype) : &quot;&lt;NONE&gt;&quot;, request-&gt;process_id, request-&gt;pid_name);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: DNSServiceUpdateRecord(%##s, %s)  PID[%d](%s)"</q>, <a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>,</td></tr>
<tr><th id="1417">1417</th><td>                     (<a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::instances" title='request_state::(anonymous union)::(anonymous struct)::instances' data-ref="request_state::(anonymousunion)::(anonymous)::instances" data-ref-filename="request_state..(anonymousunion)..(anonymous)..instances">instances</a>) ? <a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::instances" title='request_state::(anonymous union)::(anonymous struct)::instances' data-ref="request_state::(anonymousunion)::(anonymous)::instances" data-ref-filename="request_state..(anonymousunion)..(anonymous)..instances">instances</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_SRV" title='ServiceRecordSet_struct::RR_SRV' data-ref="ServiceRecordSet_struct::RR_SRV" data-ref-filename="ServiceRecordSet_struct..RR_SRV">RR_SRV</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::name" title='ResourceRecord_struct::name' data-ref="ResourceRecord_struct::name" data-ref-filename="ResourceRecord_struct..name">name</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a> : <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>,</td></tr>
<tr><th id="1418">1418</th><td>                     <a class="local col6 ref" href="#206rr" title='rr' data-ref="206rr" data-ref-filename="206rr">rr</a> ? <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col6 ref" href="#206rr" title='rr' data-ref="206rr" data-ref-filename="206rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rrtype" title='ResourceRecord_struct::rrtype' data-ref="ResourceRecord_struct::rrtype" data-ref-filename="ResourceRecord_struct..rrtype">rrtype</a>) : <q>"&lt;NONE&gt;"</q>,</td></tr>
<tr><th id="1419">1419</th><td>                     <a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col2 ref" href="#202request" title='request' data-ref="202request" data-ref-filename="202request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="1420">1420</th><td></td></tr>
<tr><th id="1421">1421</th><td>    <b>return</b>(<a class="local col4 ref" href="#204result" title='result' data-ref="204result" data-ref-filename="204result">result</a>);</td></tr>
<tr><th id="1422">1422</th><td>}</td></tr>
<tr><th id="1423">1423</th><td></td></tr>
<tr><th id="1424">1424</th><td><i>// remove a resource record registered via DNSServiceRegisterRecord()</i></td></tr>
<tr><th id="1425">1425</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="decl def fn" id="remove_record" title='remove_record' data-ref="remove_record" data-ref-filename="remove_record">remove_record</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col4 decl" id="214request" title='request' data-type='request_state *' data-ref="214request" data-ref-filename="214request">request</dfn>)</td></tr>
<tr><th id="1426">1426</th><td>{</td></tr>
<tr><th id="1427">1427</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="local col5 decl" id="215err" title='err' data-type='mStatus' data-ref="215err" data-ref-filename="215err">err</dfn> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_UnknownErr" title='mStatus_UnknownErr' data-ref="mStatus_UnknownErr" data-ref-filename="mStatus_UnknownErr">mStatus_UnknownErr</a>;</td></tr>
<tr><th id="1428">1428</th><td>    <a class="typedef" href="uds_daemon.h.html#registered_record_entry" title='registered_record_entry' data-type='struct registered_record_entry' data-ref="registered_record_entry" data-ref-filename="registered_record_entry">registered_record_entry</a> *<dfn class="local col6 decl" id="216e" title='e' data-type='registered_record_entry *' data-ref="216e" data-ref-filename="216e">e</dfn>, **<dfn class="local col7 decl" id="217ptr" title='ptr' data-type='registered_record_entry **' data-ref="217ptr" data-ref-filename="217ptr">ptr</dfn> = &amp;<a class="local col4 ref" href="#214request" title='request' data-ref="214request" data-ref-filename="214request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::reg_recs" title='request_state::(anonymous union)::reg_recs' data-ref="request_state::(anonymous)::reg_recs" data-ref-filename="request_state..(anonymous)..reg_recs">reg_recs</a>;</td></tr>
<tr><th id="1429">1429</th><td></td></tr>
<tr><th id="1430">1430</th><td>    <b>while</b> (*<a class="local col7 ref" href="#217ptr" title='ptr' data-ref="217ptr" data-ref-filename="217ptr">ptr</a> &amp;&amp; (*<a class="local col7 ref" href="#217ptr" title='ptr' data-ref="217ptr" data-ref-filename="217ptr">ptr</a>)-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::key" title='registered_record_entry::key' data-ref="registered_record_entry::key" data-ref-filename="registered_record_entry..key">key</a> != <a class="local col4 ref" href="#214request" title='request' data-ref="214request" data-ref-filename="214request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::reg_index" title='(anonymous struct)::reg_index' data-ref="(anonymous)::reg_index" data-ref-filename="(anonymous)..reg_index">reg_index</a>) <a class="local col7 ref" href="#217ptr" title='ptr' data-ref="217ptr" data-ref-filename="217ptr">ptr</a> = &amp;(*<a class="local col7 ref" href="#217ptr" title='ptr' data-ref="217ptr" data-ref-filename="217ptr">ptr</a>)-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::next" title='registered_record_entry::next' data-ref="registered_record_entry::next" data-ref-filename="registered_record_entry..next">next</a>;</td></tr>
<tr><th id="1431">1431</th><td>    <b>if</b> (!*<a class="local col7 ref" href="#217ptr" title='ptr' data-ref="217ptr" data-ref-filename="217ptr">ptr</a>) { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: DNSServiceRemoveRecord(%u) not found&quot;, request-&gt;sd, request-&gt;hdr.reg_index)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: DNSServiceRemoveRecord(%u) not found"</q>, <a class="local col4 ref" href="#214request" title='request' data-ref="214request" data-ref-filename="214request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col4 ref" href="#214request" title='request' data-ref="214request" data-ref-filename="214request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::reg_index" title='(anonymous struct)::reg_index' data-ref="(anonymous)::reg_index" data-ref-filename="(anonymous)..reg_index">reg_index</a>); <b>return</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadReferenceErr" title='mStatus_BadReferenceErr' data-ref="mStatus_BadReferenceErr" data-ref-filename="mStatus_BadReferenceErr">mStatus_BadReferenceErr</a>; }</td></tr>
<tr><th id="1432">1432</th><td>    <a class="local col6 ref" href="#216e" title='e' data-ref="216e" data-ref-filename="216e">e</a> = *<a class="local col7 ref" href="#217ptr" title='ptr' data-ref="217ptr" data-ref-filename="217ptr">ptr</a>;</td></tr>
<tr><th id="1433">1433</th><td>    *<a class="local col7 ref" href="#217ptr" title='ptr' data-ref="217ptr" data-ref-filename="217ptr">ptr</a> = <a class="local col6 ref" href="#216e" title='e' data-ref="216e" data-ref-filename="216e">e</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::next" title='registered_record_entry::next' data-ref="registered_record_entry::next" data-ref-filename="registered_record_entry..next">next</a>; <i>// unlink</i></td></tr>
<tr><th id="1434">1434</th><td></td></tr>
<tr><th id="1435">1435</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: DNSServiceRemoveRecord(%u %s)  PID[%d](%s)&quot;, request-&gt;sd, e-&gt;key, GetRRDisplayString_rdb(&amp;e-&gt;rr-&gt;resrec, &amp;(&amp;e-&gt;rr-&gt;resrec)-&gt;rdata-&gt;u, (&amp;mDNSStorage)-&gt;MsgBuffer), request-&gt;process_id, request-&gt;pid_name);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: DNSServiceRemoveRecord(%u %s)  PID[%d](%s)"</q>,</td></tr>
<tr><th id="1436">1436</th><td>                <a class="local col4 ref" href="#214request" title='request' data-ref="214request" data-ref-filename="214request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col6 ref" href="#216e" title='e' data-ref="216e" data-ref-filename="216e">e</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::key" title='registered_record_entry::key' data-ref="registered_record_entry::key" data-ref-filename="registered_record_entry..key">key</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2941" title="GetRRDisplayString_rdb(&amp;e-&gt;rr-&gt;resrec, &amp;(&amp;e-&gt;rr-&gt;resrec)-&gt;rdata-&gt;u, (&amp;mDNSStorage)-&gt;MsgBuffer)" data-ref="_M/RRDisplayString">RRDisplayString</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col6 ref" href="#216e" title='e' data-ref="216e" data-ref-filename="216e">e</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::rr" title='registered_record_entry::rr' data-ref="registered_record_entry::rr" data-ref-filename="registered_record_entry..rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>), <a class="local col4 ref" href="#214request" title='request' data-ref="214request" data-ref-filename="214request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col4 ref" href="#214request" title='request' data-ref="214request" data-ref-filename="214request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="1437">1437</th><td>    <a class="local col6 ref" href="#216e" title='e' data-ref="216e" data-ref-filename="216e">e</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::rr" title='registered_record_entry::rr' data-ref="registered_record_entry::rr" data-ref-filename="registered_record_entry..rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::RecordContext" title='AuthRecord_struct::RecordContext' data-ref="AuthRecord_struct::RecordContext" data-ref-filename="AuthRecord_struct..RecordContext">RecordContext</a> = <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="1438">1438</th><td>    <b>if</b> (<a class="local col6 ref" href="#216e" title='e' data-ref="216e" data-ref-filename="216e">e</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::external_advertise" title='registered_record_entry::external_advertise' data-ref="registered_record_entry::external_advertise" data-ref-filename="registered_record_entry..external_advertise">external_advertise</a>)</td></tr>
<tr><th id="1439">1439</th><td>    {</td></tr>
<tr><th id="1440">1440</th><td>        <a class="macro" href="uds_daemon.h.html#267" title="do { (void)(&amp;e-&gt;rr-&gt;resrec); (void)(request-&gt;flags); } while (0)" data-ref="_M/external_stop_advertising_service">external_stop_advertising_service</a>(&amp;<a class="local col6 ref" href="#216e" title='e' data-ref="216e" data-ref-filename="216e">e</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::rr" title='registered_record_entry::rr' data-ref="registered_record_entry::rr" data-ref-filename="registered_record_entry..rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>, <a class="local col4 ref" href="#214request" title='request' data-ref="214request" data-ref-filename="214request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a>);</td></tr>
<tr><th id="1441">1441</th><td>        <a class="local col6 ref" href="#216e" title='e' data-ref="216e" data-ref-filename="216e">e</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::external_advertise" title='registered_record_entry::external_advertise' data-ref="registered_record_entry::external_advertise" data-ref-filename="registered_record_entry..external_advertise">external_advertise</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>;</td></tr>
<tr><th id="1442">1442</th><td>    }</td></tr>
<tr><th id="1443">1443</th><td>    <a class="macro" href="uds_daemon.h.html#225" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMcastService" data-ref="_M/LogMcastS">LogMcastS</a>(<a class="local col6 ref" href="#216e" title='e' data-ref="216e" data-ref-filename="216e">e</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::rr" title='registered_record_entry::rr' data-ref="registered_record_entry::rr" data-ref-filename="registered_record_entry..rr">rr</a>, <a class="local col4 ref" href="#214request" title='request' data-ref="214request" data-ref-filename="214request">request</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#reg_stop" title='reg_stop' data-ref="reg_stop" data-ref-filename="reg_stop">reg_stop</a>);</td></tr>
<tr><th id="1444">1444</th><td>    <a class="local col5 ref" href="#215err" title='err' data-ref="215err" data-ref-filename="215err">err</a> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_Deregister" title='mDNS_Deregister' data-ref="mDNS_Deregister" data-ref-filename="mDNS_Deregister">mDNS_Deregister</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col6 ref" href="#216e" title='e' data-ref="216e" data-ref-filename="216e">e</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::rr" title='registered_record_entry::rr' data-ref="registered_record_entry::rr" data-ref-filename="registered_record_entry..rr">rr</a>);     <i>// Will free e-&gt;rr for us; we're responsible for freeing e</i></td></tr>
<tr><th id="1445">1445</th><td>    <b>if</b> (<a class="local col5 ref" href="#215err" title='err' data-ref="215err" data-ref-filename="215err">err</a>)</td></tr>
<tr><th id="1446">1446</th><td>    {</td></tr>
<tr><th id="1447">1447</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;ERROR: remove_record, mDNS_Deregister: %d&quot;, err)" data-ref="_M/LogMsg">LogMsg</a>(<q>"ERROR: remove_record, mDNS_Deregister: %d"</q>, <a class="local col5 ref" href="#215err" title='err' data-ref="215err" data-ref-filename="215err">err</a>);</td></tr>
<tr><th id="1448">1448</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(e-&gt;rr)" data-ref="_M/freeL">freeL</a>(<q>"registered_record_entry AuthRecord remove_record"</q>, <a class="local col6 ref" href="#216e" title='e' data-ref="216e" data-ref-filename="216e">e</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::rr" title='registered_record_entry::rr' data-ref="registered_record_entry::rr" data-ref-filename="registered_record_entry..rr">rr</a>);</td></tr>
<tr><th id="1449">1449</th><td>    }</td></tr>
<tr><th id="1450">1450</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(e)" data-ref="_M/freeL">freeL</a>(<q>"registered_record_entry remove_record"</q>, <a class="local col6 ref" href="#216e" title='e' data-ref="216e" data-ref-filename="216e">e</a>);</td></tr>
<tr><th id="1451">1451</th><td>    <b>return</b> <a class="local col5 ref" href="#215err" title='err' data-ref="215err" data-ref-filename="215err">err</a>;</td></tr>
<tr><th id="1452">1452</th><td>}</td></tr>
<tr><th id="1453">1453</th><td></td></tr>
<tr><th id="1454">1454</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="decl def fn" id="remove_extra" title='remove_extra' data-ref="remove_extra" data-ref-filename="remove_extra">remove_extra</dfn>(<em>const</em> <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<em>const</em> <dfn class="local col8 decl" id="218request" title='request' data-type='const request_state *const' data-ref="218request" data-ref-filename="218request">request</dfn>, <a class="typedef" href="uds_daemon.h.html#service_instance" title='service_instance' data-type='struct service_instance' data-ref="service_instance" data-ref-filename="service_instance">service_instance</a> *<em>const</em> <dfn class="local col9 decl" id="219serv" title='serv' data-type='service_instance *const' data-ref="219serv" data-ref-filename="219serv">serv</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu16" title='mDNSu16' data-type='unsigned short' data-ref="mDNSu16" data-ref-filename="mDNSu16">mDNSu16</a> *<em>const</em> <dfn class="local col0 decl" id="220rrtype" title='rrtype' data-type='mDNSu16 *const' data-ref="220rrtype" data-ref-filename="220rrtype">rrtype</dfn>)</td></tr>
<tr><th id="1455">1455</th><td>{</td></tr>
<tr><th id="1456">1456</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="local col1 decl" id="221err" title='err' data-type='mStatus' data-ref="221err" data-ref-filename="221err">err</dfn> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadReferenceErr" title='mStatus_BadReferenceErr' data-ref="mStatus_BadReferenceErr" data-ref-filename="mStatus_BadReferenceErr">mStatus_BadReferenceErr</a>;</td></tr>
<tr><th id="1457">1457</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord" title='ExtraResourceRecord' data-type='struct ExtraResourceRecord_struct' data-ref="ExtraResourceRecord" data-ref-filename="ExtraResourceRecord">ExtraResourceRecord</a> *<dfn class="local col2 decl" id="222ptr" title='ptr' data-type='ExtraResourceRecord *' data-ref="222ptr" data-ref-filename="222ptr">ptr</dfn>;</td></tr>
<tr><th id="1458">1458</th><td></td></tr>
<tr><th id="1459">1459</th><td>    <b>for</b> (<a class="local col2 ref" href="#222ptr" title='ptr' data-ref="222ptr" data-ref-filename="222ptr">ptr</a> = <a class="local col9 ref" href="#219serv" title='serv' data-ref="219serv" data-ref-filename="219serv">serv</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::Extras" title='ServiceRecordSet_struct::Extras' data-ref="ServiceRecordSet_struct::Extras" data-ref-filename="ServiceRecordSet_struct..Extras">Extras</a>; <a class="local col2 ref" href="#222ptr" title='ptr' data-ref="222ptr" data-ref-filename="222ptr">ptr</a>; <a class="local col2 ref" href="#222ptr" title='ptr' data-ref="222ptr" data-ref-filename="222ptr">ptr</a> = <a class="local col2 ref" href="#222ptr" title='ptr' data-ref="222ptr" data-ref-filename="222ptr">ptr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord_struct::next" title='ExtraResourceRecord_struct::next' data-ref="ExtraResourceRecord_struct::next" data-ref-filename="ExtraResourceRecord_struct..next">next</a>)</td></tr>
<tr><th id="1460">1460</th><td>    {</td></tr>
<tr><th id="1461">1461</th><td>        <b>if</b> (<a class="local col2 ref" href="#222ptr" title='ptr' data-ref="222ptr" data-ref-filename="222ptr">ptr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord_struct::ClientID" title='ExtraResourceRecord_struct::ClientID' data-ref="ExtraResourceRecord_struct::ClientID" data-ref-filename="ExtraResourceRecord_struct..ClientID">ClientID</a> == <a class="local col8 ref" href="#218request" title='request' data-ref="218request" data-ref-filename="218request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::reg_index" title='(anonymous struct)::reg_index' data-ref="(anonymous)::reg_index" data-ref-filename="(anonymous)..reg_index">reg_index</a>) <i>// found match</i></td></tr>
<tr><th id="1462">1462</th><td>        {</td></tr>
<tr><th id="1463">1463</th><td>            *<a class="local col0 ref" href="#220rrtype" title='rrtype' data-ref="220rrtype" data-ref-filename="220rrtype">rrtype</a> = <a class="local col2 ref" href="#222ptr" title='ptr' data-ref="222ptr" data-ref-filename="222ptr">ptr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord_struct::r" title='ExtraResourceRecord_struct::r' data-ref="ExtraResourceRecord_struct::r" data-ref-filename="ExtraResourceRecord_struct..r">r</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rrtype" title='ResourceRecord_struct::rrtype' data-ref="ResourceRecord_struct::rrtype" data-ref-filename="ResourceRecord_struct..rrtype">rrtype</a>;</td></tr>
<tr><th id="1464">1464</th><td>            <b>if</b> (<a class="local col9 ref" href="#219serv" title='serv' data-ref="219serv" data-ref-filename="219serv">serv</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::external_advertise" title='service_instance::external_advertise' data-ref="service_instance::external_advertise" data-ref-filename="service_instance..external_advertise">external_advertise</a>) <a class="macro" href="uds_daemon.h.html#267" title="do { (void)(&amp;ptr-&gt;r.resrec); (void)(request-&gt;flags); } while (0)" data-ref="_M/external_stop_advertising_service">external_stop_advertising_service</a>(&amp;<a class="local col2 ref" href="#222ptr" title='ptr' data-ref="222ptr" data-ref-filename="222ptr">ptr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ExtraResourceRecord_struct::r" title='ExtraResourceRecord_struct::r' data-ref="ExtraResourceRecord_struct::r" data-ref-filename="ExtraResourceRecord_struct..r">r</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>, <a class="local col8 ref" href="#218request" title='request' data-ref="218request" data-ref-filename="218request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a>);</td></tr>
<tr><th id="1465">1465</th><td>            <a class="local col1 ref" href="#221err" title='err' data-ref="221err" data-ref-filename="221err">err</a> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_RemoveRecordFromService" title='mDNS_RemoveRecordFromService' data-ref="mDNS_RemoveRecordFromService" data-ref-filename="mDNS_RemoveRecordFromService">mDNS_RemoveRecordFromService</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col9 ref" href="#219serv" title='serv' data-ref="219serv" data-ref-filename="219serv">serv</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>, <a class="local col2 ref" href="#222ptr" title='ptr' data-ref="222ptr" data-ref-filename="222ptr">ptr</a>, <a class="ref fn" href="#FreeExtraRR" title='FreeExtraRR' data-ref="FreeExtraRR" data-ref-filename="FreeExtraRR">FreeExtraRR</a>, <a class="local col2 ref" href="#222ptr" title='ptr' data-ref="222ptr" data-ref-filename="222ptr">ptr</a>);</td></tr>
<tr><th id="1466">1466</th><td>            <b>break</b>;</td></tr>
<tr><th id="1467">1467</th><td>        }</td></tr>
<tr><th id="1468">1468</th><td>    }</td></tr>
<tr><th id="1469">1469</th><td>    <b>return</b> <a class="local col1 ref" href="#221err" title='err' data-ref="221err" data-ref-filename="221err">err</a>;</td></tr>
<tr><th id="1470">1470</th><td>}</td></tr>
<tr><th id="1471">1471</th><td></td></tr>
<tr><th id="1472">1472</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="decl def fn" id="handle_removerecord_request" title='handle_removerecord_request' data-ref="handle_removerecord_request" data-ref-filename="handle_removerecord_request">handle_removerecord_request</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col3 decl" id="223request" title='request' data-type='request_state *' data-ref="223request" data-ref-filename="223request">request</dfn>)</td></tr>
<tr><th id="1473">1473</th><td>{</td></tr>
<tr><th id="1474">1474</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="local col4 decl" id="224err" title='err' data-type='mStatus' data-ref="224err" data-ref-filename="224err">err</dfn> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadReferenceErr" title='mStatus_BadReferenceErr' data-ref="mStatus_BadReferenceErr" data-ref-filename="mStatus_BadReferenceErr">mStatus_BadReferenceErr</a>;</td></tr>
<tr><th id="1475">1475</th><td>    <a class="macro" href="dnssd_ipc.h.html#210" title="__dnssd_ipc_get_uint32" data-ref="_M/get_flags">get_flags</a>(&amp;<a class="local col3 ref" href="#223request" title='request' data-ref="223request" data-ref-filename="223request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col3 ref" href="#223request" title='request' data-ref="223request" data-ref-filename="223request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);   <i>// flags unused</i></td></tr>
<tr><th id="1476">1476</th><td></td></tr>
<tr><th id="1477">1477</th><td>    <b>if</b> (!<a class="local col3 ref" href="#223request" title='request' data-ref="223request" data-ref-filename="223request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>) { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: DNSServiceRemoveRecord(unreadable parameters)&quot;, request-&gt;sd)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: DNSServiceRemoveRecord(unreadable parameters)"</q>, <a class="local col3 ref" href="#223request" title='request' data-ref="223request" data-ref-filename="223request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>); <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>); }</td></tr>
<tr><th id="1478">1478</th><td></td></tr>
<tr><th id="1479">1479</th><td>    <i>// If this is a shared connection, check if the operation actually applies to a subordinate request_state object</i></td></tr>
<tr><th id="1480">1480</th><td>    <b>if</b> (<a class="local col3 ref" href="#223request" title='request' data-ref="223request" data-ref-filename="223request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> == <a class="ref fn" href="#connection_termination" title='connection_termination' data-ref="connection_termination" data-ref-filename="connection_termination">connection_termination</a>) <a class="local col3 ref" href="#223request" title='request' data-ref="223request" data-ref-filename="223request">request</a> = <a class="ref fn" href="#LocateSubordinateRequest" title='LocateSubordinateRequest' data-ref="LocateSubordinateRequest" data-ref-filename="LocateSubordinateRequest">LocateSubordinateRequest</a>(<a class="local col3 ref" href="#223request" title='request' data-ref="223request" data-ref-filename="223request">request</a>);</td></tr>
<tr><th id="1481">1481</th><td></td></tr>
<tr><th id="1482">1482</th><td>    <b>if</b> (<a class="local col3 ref" href="#223request" title='request' data-ref="223request" data-ref-filename="223request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> == <a class="ref fn" href="#connection_termination" title='connection_termination' data-ref="connection_termination" data-ref-filename="connection_termination">connection_termination</a>)</td></tr>
<tr><th id="1483">1483</th><td>        <a class="local col4 ref" href="#224err" title='err' data-ref="224err" data-ref-filename="224err">err</a> = <a class="ref fn" href="#remove_record" title='remove_record' data-ref="remove_record" data-ref-filename="remove_record">remove_record</a>(<a class="local col3 ref" href="#223request" title='request' data-ref="223request" data-ref-filename="223request">request</a>);  <i>// remove individually registered record</i></td></tr>
<tr><th id="1484">1484</th><td>    <b>else</b> <b>if</b> (<a class="local col3 ref" href="#223request" title='request' data-ref="223request" data-ref-filename="223request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> != <a class="ref fn" href="#regservice_termination_callback" title='regservice_termination_callback' data-ref="regservice_termination_callback" data-ref-filename="regservice_termination_callback">regservice_termination_callback</a>)</td></tr>
<tr><th id="1485">1485</th><td>    { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: DNSServiceRemoveRecord(not a registered service ref)&quot;, request-&gt;sd)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: DNSServiceRemoveRecord(not a registered service ref)"</q>, <a class="local col3 ref" href="#223request" title='request' data-ref="223request" data-ref-filename="223request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>); <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>); }</td></tr>
<tr><th id="1486">1486</th><td>    <b>else</b></td></tr>
<tr><th id="1487">1487</th><td>    {</td></tr>
<tr><th id="1488">1488</th><td>        <a class="typedef" href="uds_daemon.h.html#service_instance" title='service_instance' data-type='struct service_instance' data-ref="service_instance" data-ref-filename="service_instance">service_instance</a> *<dfn class="local col5 decl" id="225i" title='i' data-type='service_instance *' data-ref="225i" data-ref-filename="225i">i</dfn>;</td></tr>
<tr><th id="1489">1489</th><td>        <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu16" title='mDNSu16' data-type='unsigned short' data-ref="mDNSu16" data-ref-filename="mDNSu16">mDNSu16</a> <dfn class="local col6 decl" id="226rrtype" title='rrtype' data-type='mDNSu16' data-ref="226rrtype" data-ref-filename="226rrtype">rrtype</dfn> = <var>0</var>;</td></tr>
<tr><th id="1490">1490</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: DNSServiceRemoveRecord(%##s, %s) PID[%d](%s)&quot;, request-&gt;sd, (request-&gt;u.servicereg.instances) ? request-&gt;u.servicereg.instances-&gt;srs.RR_SRV.resrec.name-&gt;c : ((void *)0), rrtype ? DNSTypeName(rrtype) : &quot;&lt;NONE&gt;&quot;, request-&gt;process_id, request-&gt;pid_name);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: DNSServiceRemoveRecord(%##s, %s) PID[%d](%s)"</q>, <a class="local col3 ref" href="#223request" title='request' data-ref="223request" data-ref-filename="223request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>,</td></tr>
<tr><th id="1491">1491</th><td>                     (<a class="local col3 ref" href="#223request" title='request' data-ref="223request" data-ref-filename="223request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::instances" title='request_state::(anonymous union)::(anonymous struct)::instances' data-ref="request_state::(anonymousunion)::(anonymous)::instances" data-ref-filename="request_state..(anonymousunion)..(anonymous)..instances">instances</a>) ? <a class="local col3 ref" href="#223request" title='request' data-ref="223request" data-ref-filename="223request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::instances" title='request_state::(anonymous union)::(anonymous struct)::instances' data-ref="request_state::(anonymousunion)::(anonymous)::instances" data-ref-filename="request_state..(anonymousunion)..(anonymous)..instances">instances</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_SRV" title='ServiceRecordSet_struct::RR_SRV' data-ref="ServiceRecordSet_struct::RR_SRV" data-ref-filename="ServiceRecordSet_struct..RR_SRV">RR_SRV</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::name" title='ResourceRecord_struct::name' data-ref="ResourceRecord_struct::name" data-ref-filename="ResourceRecord_struct..name">name</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a> : <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>,</td></tr>
<tr><th id="1492">1492</th><td>                     <a class="local col6 ref" href="#226rrtype" title='rrtype' data-ref="226rrtype" data-ref-filename="226rrtype">rrtype</a> ? <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col6 ref" href="#226rrtype" title='rrtype' data-ref="226rrtype" data-ref-filename="226rrtype">rrtype</a>) : <q>"&lt;NONE&gt;"</q>, <a class="local col3 ref" href="#223request" title='request' data-ref="223request" data-ref-filename="223request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col3 ref" href="#223request" title='request' data-ref="223request" data-ref-filename="223request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="1493">1493</th><td>        <b>for</b> (<a class="local col5 ref" href="#225i" title='i' data-ref="225i" data-ref-filename="225i">i</a> = <a class="local col3 ref" href="#223request" title='request' data-ref="223request" data-ref-filename="223request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::instances" title='request_state::(anonymous union)::(anonymous struct)::instances' data-ref="request_state::(anonymousunion)::(anonymous)::instances" data-ref-filename="request_state..(anonymousunion)..(anonymous)..instances">instances</a>; <a class="local col5 ref" href="#225i" title='i' data-ref="225i" data-ref-filename="225i">i</a>; <a class="local col5 ref" href="#225i" title='i' data-ref="225i" data-ref-filename="225i">i</a> = <a class="local col5 ref" href="#225i" title='i' data-ref="225i" data-ref-filename="225i">i</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::next" title='service_instance::next' data-ref="service_instance::next" data-ref-filename="service_instance..next">next</a>)</td></tr>
<tr><th id="1494">1494</th><td>        {</td></tr>
<tr><th id="1495">1495</th><td>            <a class="local col4 ref" href="#224err" title='err' data-ref="224err" data-ref-filename="224err">err</a> = <a class="ref fn" href="#remove_extra" title='remove_extra' data-ref="remove_extra" data-ref-filename="remove_extra">remove_extra</a>(<a class="local col3 ref" href="#223request" title='request' data-ref="223request" data-ref-filename="223request">request</a>, <a class="local col5 ref" href="#225i" title='i' data-ref="225i" data-ref-filename="225i">i</a>, &amp;<a class="local col6 ref" href="#226rrtype" title='rrtype' data-ref="226rrtype" data-ref-filename="226rrtype">rrtype</a>);</td></tr>
<tr><th id="1496">1496</th><td>            <b>if</b> (<a class="local col4 ref" href="#224err" title='err' data-ref="224err" data-ref-filename="224err">err</a> &amp;&amp; <a class="local col5 ref" href="#225i" title='i' data-ref="225i" data-ref-filename="225i">i</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::default_local" title='service_instance::default_local' data-ref="service_instance::default_local" data-ref-filename="service_instance..default_local">default_local</a>) <b>break</b>;</td></tr>
<tr><th id="1497">1497</th><td>            <b>else</b> <a class="local col4 ref" href="#224err" title='err' data-ref="224err" data-ref-filename="224err">err</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_NoError" title='mStatus_NoError' data-ref="mStatus_NoError" data-ref-filename="mStatus_NoError">mStatus_NoError</a>;  <i>// suppress non-local default errors</i></td></tr>
<tr><th id="1498">1498</th><td>        }</td></tr>
<tr><th id="1499">1499</th><td>    }</td></tr>
<tr><th id="1500">1500</th><td></td></tr>
<tr><th id="1501">1501</th><td>    <b>return</b>(<a class="local col4 ref" href="#224err" title='err' data-ref="224err" data-ref-filename="224err">err</a>);</td></tr>
<tr><th id="1502">1502</th><td>}</td></tr>
<tr><th id="1503">1503</th><td></td></tr>
<tr><th id="1504">1504</th><td><i>// If there's a comma followed by another character,</i></td></tr>
<tr><th id="1505">1505</th><td><i>// FindFirstSubType overwrites the comma with a nul and returns the pointer to the next character.</i></td></tr>
<tr><th id="1506">1506</th><td><i>// Otherwise, it returns a pointer to the final nul at the end of the string</i></td></tr>
<tr><th id="1507">1507</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>char</em> *<dfn class="decl def fn" id="FindFirstSubType" title='FindFirstSubType' data-ref="FindFirstSubType" data-ref-filename="FindFirstSubType">FindFirstSubType</dfn>(<em>char</em> *<dfn class="local col7 decl" id="227p" title='p' data-type='char *' data-ref="227p" data-ref-filename="227p">p</dfn>, <em>char</em> **<dfn class="local col8 decl" id="228AnonData" title='AnonData' data-type='char **' data-ref="228AnonData" data-ref-filename="228AnonData">AnonData</dfn>)</td></tr>
<tr><th id="1508">1508</th><td>{</td></tr>
<tr><th id="1509">1509</th><td>    <b>while</b> (*<a class="local col7 ref" href="#227p" title='p' data-ref="227p" data-ref-filename="227p">p</a>)</td></tr>
<tr><th id="1510">1510</th><td>    {</td></tr>
<tr><th id="1511">1511</th><td>        <b>if</b> (<a class="local col7 ref" href="#227p" title='p' data-ref="227p" data-ref-filename="227p">p</a>[<var>0</var>] == <kbd>'\\'</kbd> &amp;&amp; <a class="local col7 ref" href="#227p" title='p' data-ref="227p" data-ref-filename="227p">p</a>[<var>1</var>])</td></tr>
<tr><th id="1512">1512</th><td>        {</td></tr>
<tr><th id="1513">1513</th><td>             <a class="local col7 ref" href="#227p" title='p' data-ref="227p" data-ref-filename="227p">p</a> += <var>2</var>;</td></tr>
<tr><th id="1514">1514</th><td>        }</td></tr>
<tr><th id="1515">1515</th><td>        <b>else</b> <b>if</b> (<a class="local col7 ref" href="#227p" title='p' data-ref="227p" data-ref-filename="227p">p</a>[<var>0</var>] == <kbd>','</kbd> &amp;&amp; <a class="local col7 ref" href="#227p" title='p' data-ref="227p" data-ref-filename="227p">p</a>[<var>1</var>])</td></tr>
<tr><th id="1516">1516</th><td>        {</td></tr>
<tr><th id="1517">1517</th><td>            *<a class="local col7 ref" href="#227p" title='p' data-ref="227p" data-ref-filename="227p">p</a>++ = <var>0</var>;</td></tr>
<tr><th id="1518">1518</th><td>            <b>return</b>(<a class="local col7 ref" href="#227p" title='p' data-ref="227p" data-ref-filename="227p">p</a>);</td></tr>
<tr><th id="1519">1519</th><td>        }</td></tr>
<tr><th id="1520">1520</th><td>        <b>else</b> <b>if</b> (<a class="local col7 ref" href="#227p" title='p' data-ref="227p" data-ref-filename="227p">p</a>[<var>0</var>] == <kbd>':'</kbd> &amp;&amp; <a class="local col7 ref" href="#227p" title='p' data-ref="227p" data-ref-filename="227p">p</a>[<var>1</var>])</td></tr>
<tr><th id="1521">1521</th><td>        {</td></tr>
<tr><th id="1522">1522</th><td>            *<a class="local col7 ref" href="#227p" title='p' data-ref="227p" data-ref-filename="227p">p</a>++ = <var>0</var>;</td></tr>
<tr><th id="1523">1523</th><td>            *<a class="local col8 ref" href="#228AnonData" title='AnonData' data-ref="228AnonData" data-ref-filename="228AnonData">AnonData</a> = <a class="local col7 ref" href="#227p" title='p' data-ref="227p" data-ref-filename="227p">p</a>;</td></tr>
<tr><th id="1524">1524</th><td>        }</td></tr>
<tr><th id="1525">1525</th><td>        <b>else</b></td></tr>
<tr><th id="1526">1526</th><td>        {</td></tr>
<tr><th id="1527">1527</th><td>            <a class="local col7 ref" href="#227p" title='p' data-ref="227p" data-ref-filename="227p">p</a>++;</td></tr>
<tr><th id="1528">1528</th><td>        }</td></tr>
<tr><th id="1529">1529</th><td>    }</td></tr>
<tr><th id="1530">1530</th><td>    <b>return</b>(<a class="local col7 ref" href="#227p" title='p' data-ref="227p" data-ref-filename="227p">p</a>);</td></tr>
<tr><th id="1531">1531</th><td>}</td></tr>
<tr><th id="1532">1532</th><td></td></tr>
<tr><th id="1533">1533</th><td><i>// If there's a comma followed by another character,</i></td></tr>
<tr><th id="1534">1534</th><td><i>// FindNextSubType overwrites the comma with a nul and returns the pointer to the next character.</i></td></tr>
<tr><th id="1535">1535</th><td><i>// If it finds an illegal unescaped dot in the subtype name, it returns mDNSNULL</i></td></tr>
<tr><th id="1536">1536</th><td><i>// Otherwise, it returns a pointer to the final nul at the end of the string</i></td></tr>
<tr><th id="1537">1537</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>char</em> *<dfn class="decl def fn" id="FindNextSubType" title='FindNextSubType' data-ref="FindNextSubType" data-ref-filename="FindNextSubType">FindNextSubType</dfn>(<em>char</em> *<dfn class="local col9 decl" id="229p" title='p' data-type='char *' data-ref="229p" data-ref-filename="229p">p</dfn>)</td></tr>
<tr><th id="1538">1538</th><td>{</td></tr>
<tr><th id="1539">1539</th><td>    <b>while</b> (*<a class="local col9 ref" href="#229p" title='p' data-ref="229p" data-ref-filename="229p">p</a>)</td></tr>
<tr><th id="1540">1540</th><td>    {</td></tr>
<tr><th id="1541">1541</th><td>        <b>if</b> (<a class="local col9 ref" href="#229p" title='p' data-ref="229p" data-ref-filename="229p">p</a>[<var>0</var>] == <kbd>'\\'</kbd> &amp;&amp; <a class="local col9 ref" href="#229p" title='p' data-ref="229p" data-ref-filename="229p">p</a>[<var>1</var>])       <i>// If escape character</i></td></tr>
<tr><th id="1542">1542</th><td>            <a class="local col9 ref" href="#229p" title='p' data-ref="229p" data-ref-filename="229p">p</a> += <var>2</var>;                     <i>// ignore following character</i></td></tr>
<tr><th id="1543">1543</th><td>        <b>else</b> <b>if</b> (<a class="local col9 ref" href="#229p" title='p' data-ref="229p" data-ref-filename="229p">p</a>[<var>0</var>] == <kbd>','</kbd>)           <i>// If we found a comma</i></td></tr>
<tr><th id="1544">1544</th><td>        {</td></tr>
<tr><th id="1545">1545</th><td>            <b>if</b> (<a class="local col9 ref" href="#229p" title='p' data-ref="229p" data-ref-filename="229p">p</a>[<var>1</var>]) *<a class="local col9 ref" href="#229p" title='p' data-ref="229p" data-ref-filename="229p">p</a>++ = <var>0</var>;</td></tr>
<tr><th id="1546">1546</th><td>            <b>return</b>(<a class="local col9 ref" href="#229p" title='p' data-ref="229p" data-ref-filename="229p">p</a>);</td></tr>
<tr><th id="1547">1547</th><td>        }</td></tr>
<tr><th id="1548">1548</th><td>        <b>else</b> <b>if</b> (<a class="local col9 ref" href="#229p" title='p' data-ref="229p" data-ref-filename="229p">p</a>[<var>0</var>] == <kbd>'.'</kbd>)</td></tr>
<tr><th id="1549">1549</th><td>            <b>return</b>(<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>);</td></tr>
<tr><th id="1550">1550</th><td>        <b>else</b> <a class="local col9 ref" href="#229p" title='p' data-ref="229p" data-ref-filename="229p">p</a>++;</td></tr>
<tr><th id="1551">1551</th><td>    }</td></tr>
<tr><th id="1552">1552</th><td>    <b>return</b>(<a class="local col9 ref" href="#229p" title='p' data-ref="229p" data-ref-filename="229p">p</a>);</td></tr>
<tr><th id="1553">1553</th><td>}</td></tr>
<tr><th id="1554">1554</th><td></td></tr>
<tr><th id="1555">1555</th><td><i>// Returns -1 if illegal subtype found</i></td></tr>
<tr><th id="1556">1556</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#116" title="" data-ref="_M/mDNSexport">mDNSexport</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSs32" title='mDNSs32' data-type='int' data-ref="mDNSs32" data-ref-filename="mDNSs32">mDNSs32</a> <dfn class="decl def fn" id="ChopSubTypes" title='ChopSubTypes' data-ref="ChopSubTypes" data-ref-filename="ChopSubTypes">ChopSubTypes</dfn>(<em>char</em> *<dfn class="local col0 decl" id="230regtype" title='regtype' data-type='char *' data-ref="230regtype" data-ref-filename="230regtype">regtype</dfn>, <em>char</em> **<dfn class="local col1 decl" id="231AnonData" title='AnonData' data-type='char **' data-ref="231AnonData" data-ref-filename="231AnonData">AnonData</dfn>)</td></tr>
<tr><th id="1557">1557</th><td>{</td></tr>
<tr><th id="1558">1558</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSs32" title='mDNSs32' data-type='int' data-ref="mDNSs32" data-ref-filename="mDNSs32">mDNSs32</a> <dfn class="local col2 decl" id="232NumSubTypes" title='NumSubTypes' data-type='mDNSs32' data-ref="232NumSubTypes" data-ref-filename="232NumSubTypes">NumSubTypes</dfn> = <var>0</var>;</td></tr>
<tr><th id="1559">1559</th><td>    <em>char</em> *<dfn class="local col3 decl" id="233stp" title='stp' data-type='char *' data-ref="233stp" data-ref-filename="233stp">stp</dfn> = <a class="ref fn" href="#FindFirstSubType" title='FindFirstSubType' data-ref="FindFirstSubType" data-ref-filename="FindFirstSubType">FindFirstSubType</a>(<a class="local col0 ref" href="#230regtype" title='regtype' data-ref="230regtype" data-ref-filename="230regtype">regtype</a>, <a class="local col1 ref" href="#231AnonData" title='AnonData' data-ref="231AnonData" data-ref-filename="231AnonData">AnonData</a>);</td></tr>
<tr><th id="1560">1560</th><td>    <b>while</b> (<a class="local col3 ref" href="#233stp" title='stp' data-ref="233stp" data-ref-filename="233stp">stp</a> &amp;&amp; *<a class="local col3 ref" href="#233stp" title='stp' data-ref="233stp" data-ref-filename="233stp">stp</a>)                 <i>// If we found a comma...</i></td></tr>
<tr><th id="1561">1561</th><td>    {</td></tr>
<tr><th id="1562">1562</th><td>        <b>if</b> (*<a class="local col3 ref" href="#233stp" title='stp' data-ref="233stp" data-ref-filename="233stp">stp</a> == <kbd>','</kbd>) <b>return</b>(-<var>1</var>);</td></tr>
<tr><th id="1563">1563</th><td>        <a class="local col2 ref" href="#232NumSubTypes" title='NumSubTypes' data-ref="232NumSubTypes" data-ref-filename="232NumSubTypes">NumSubTypes</a>++;</td></tr>
<tr><th id="1564">1564</th><td>        <a class="local col3 ref" href="#233stp" title='stp' data-ref="233stp" data-ref-filename="233stp">stp</a> = <a class="ref fn" href="#FindNextSubType" title='FindNextSubType' data-ref="FindNextSubType" data-ref-filename="FindNextSubType">FindNextSubType</a>(<a class="local col3 ref" href="#233stp" title='stp' data-ref="233stp" data-ref-filename="233stp">stp</a>);</td></tr>
<tr><th id="1565">1565</th><td>    }</td></tr>
<tr><th id="1566">1566</th><td>    <b>if</b> (!<a class="local col3 ref" href="#233stp" title='stp' data-ref="233stp" data-ref-filename="233stp">stp</a>) <b>return</b>(-<var>1</var>);</td></tr>
<tr><th id="1567">1567</th><td>    <b>return</b>(<a class="local col2 ref" href="#232NumSubTypes" title='NumSubTypes' data-ref="232NumSubTypes" data-ref-filename="232NumSubTypes">NumSubTypes</a>);</td></tr>
<tr><th id="1568">1568</th><td>}</td></tr>
<tr><th id="1569">1569</th><td></td></tr>
<tr><th id="1570">1570</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#116" title="" data-ref="_M/mDNSexport">mDNSexport</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord" title='AuthRecord' data-type='struct AuthRecord_struct' data-ref="AuthRecord" data-ref-filename="AuthRecord">AuthRecord</a> *<dfn class="decl def fn" id="AllocateSubTypes" title='AllocateSubTypes' data-ref="AllocateSubTypes" data-ref-filename="AllocateSubTypes">AllocateSubTypes</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSs32" title='mDNSs32' data-type='int' data-ref="mDNSs32" data-ref-filename="mDNSs32">mDNSs32</a> <dfn class="local col4 decl" id="234NumSubTypes" title='NumSubTypes' data-type='mDNSs32' data-ref="234NumSubTypes" data-ref-filename="234NumSubTypes">NumSubTypes</dfn>, <em>char</em> *<dfn class="local col5 decl" id="235p" title='p' data-type='char *' data-ref="235p" data-ref-filename="235p">p</dfn>, <em>char</em> **<dfn class="local col6 decl" id="236AnonData" title='AnonData' data-type='char **' data-ref="236AnonData" data-ref-filename="236AnonData">AnonData</dfn>)</td></tr>
<tr><th id="1571">1571</th><td>{</td></tr>
<tr><th id="1572">1572</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord" title='AuthRecord' data-type='struct AuthRecord_struct' data-ref="AuthRecord" data-ref-filename="AuthRecord">AuthRecord</a> *<dfn class="local col7 decl" id="237st" title='st' data-type='AuthRecord *' data-ref="237st" data-ref-filename="237st">st</dfn> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="1573">1573</th><td>    <i>//</i></td></tr>
<tr><th id="1574">1574</th><td><i>    // "p" is pointing at the regtype e.g., _http._tcp followed by ":&lt;AnonData&gt;" indicated</i></td></tr>
<tr><th id="1575">1575</th><td><i>    // by AnonData being non-NULL which is in turn follwed by ",&lt;SubTypes&gt;" indicated by</i></td></tr>
<tr><th id="1576">1576</th><td><i>    // NumSubTypes being non-zero. We need to skip the initial regtype to get to the actual</i></td></tr>
<tr><th id="1577">1577</th><td><i>    // data that we want. When we come here, ChopSubTypes has null terminated like this e.g.,</i></td></tr>
<tr><th id="1578">1578</th><td><i>    //</i></td></tr>
<tr><th id="1579">1579</th><td><i>    // _http._tcp&lt;NULL&gt;&lt;AnonData&gt;&lt;NULL&gt;&lt;SubType1&gt;&lt;NULL&gt;&lt;SubType2&gt;&lt;NULL&gt; etc.</i></td></tr>
<tr><th id="1580">1580</th><td><i>    //</i></td></tr>
<tr><th id="1581">1581</th><td><i>    // 1. If we have Anonymous data and subtypes, skip the regtype (e.g., "_http._tcp")</i></td></tr>
<tr><th id="1582">1582</th><td><i>    //    to get the AnonData and then skip the AnonData to get to the SubType.</i></td></tr>
<tr><th id="1583">1583</th><td><i>    //</i></td></tr>
<tr><th id="1584">1584</th><td><i>    // 2. If we have only SubTypes, skip the regtype to get to the SubType data.</i></td></tr>
<tr><th id="1585">1585</th><td><i>    //</i></td></tr>
<tr><th id="1586">1586</th><td><i>    // 3. If we have only AnonData, skip the regtype to get to the AnonData.</i></td></tr>
<tr><th id="1587">1587</th><td><i>    //</i></td></tr>
<tr><th id="1588">1588</th><td><i>    // 4. If we don't have AnonData or NumStypes, it is a noop.</i></td></tr>
<tr><th id="1589">1589</th><td><i>    //</i></td></tr>
<tr><th id="1590">1590</th><td>    <b>if</b> (<a class="local col6 ref" href="#236AnonData" title='AnonData' data-ref="236AnonData" data-ref-filename="236AnonData">AnonData</a>)</td></tr>
<tr><th id="1591">1591</th><td>    {</td></tr>
<tr><th id="1592">1592</th><td>        <em>int</em> <dfn class="local col8 decl" id="238len" title='len' data-type='int' data-ref="238len" data-ref-filename="238len">len</dfn>;</td></tr>
<tr><th id="1593">1593</th><td></td></tr>
<tr><th id="1594">1594</th><td>        <i>// Skip the regtype</i></td></tr>
<tr><th id="1595">1595</th><td>        <b>while</b> (*<a class="local col5 ref" href="#235p" title='p' data-ref="235p" data-ref-filename="235p">p</a>) <a class="local col5 ref" href="#235p" title='p' data-ref="235p" data-ref-filename="235p">p</a>++;</td></tr>
<tr><th id="1596">1596</th><td>        <a class="local col5 ref" href="#235p" title='p' data-ref="235p" data-ref-filename="235p">p</a>++;</td></tr>
<tr><th id="1597">1597</th><td></td></tr>
<tr><th id="1598">1598</th><td>        <a class="local col8 ref" href="#238len" title='len' data-ref="238len" data-ref-filename="238len">len</a> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strlen" title='strlen' data-ref="strlen" data-ref-filename="strlen">strlen</a>(<a class="local col5 ref" href="#235p" title='p' data-ref="235p" data-ref-filename="235p">p</a>) + <var>1</var>;</td></tr>
<tr><th id="1599">1599</th><td>        *<a class="local col6 ref" href="#236AnonData" title='AnonData' data-ref="236AnonData" data-ref-filename="236AnonData">AnonData</a> = <a class="macro" href="../mDNSCore/mDNSDebug.h.html#166" title="malloc(len)" data-ref="_M/mallocL">mallocL</a>(<q>"Anonymous"</q>, <a class="local col8 ref" href="#238len" title='len' data-ref="238len" data-ref-filename="238len">len</a>);</td></tr>
<tr><th id="1600">1600</th><td>        <b>if</b> (!(*<a class="local col6 ref" href="#236AnonData" title='AnonData' data-ref="236AnonData" data-ref-filename="236AnonData">AnonData</a>))</td></tr>
<tr><th id="1601">1601</th><td>        {</td></tr>
<tr><th id="1602">1602</th><td>           <b>return</b> (<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>);</td></tr>
<tr><th id="1603">1603</th><td>        }</td></tr>
<tr><th id="1604">1604</th><td>        <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformMemCopy" title='mDNSPlatformMemCopy' data-ref="mDNSPlatformMemCopy" data-ref-filename="mDNSPlatformMemCopy">mDNSPlatformMemCopy</a>(*<a class="local col6 ref" href="#236AnonData" title='AnonData' data-ref="236AnonData" data-ref-filename="236AnonData">AnonData</a>, <a class="local col5 ref" href="#235p" title='p' data-ref="235p" data-ref-filename="235p">p</a>, <a class="local col8 ref" href="#238len" title='len' data-ref="238len" data-ref-filename="238len">len</a>);</td></tr>
<tr><th id="1605">1605</th><td>    }</td></tr>
<tr><th id="1606">1606</th><td>    <b>if</b> (<a class="local col4 ref" href="#234NumSubTypes" title='NumSubTypes' data-ref="234NumSubTypes" data-ref-filename="234NumSubTypes">NumSubTypes</a>)</td></tr>
<tr><th id="1607">1607</th><td>    {</td></tr>
<tr><th id="1608">1608</th><td>        <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSs32" title='mDNSs32' data-type='int' data-ref="mDNSs32" data-ref-filename="mDNSs32">mDNSs32</a> <dfn class="local col9 decl" id="239i" title='i' data-type='mDNSs32' data-ref="239i" data-ref-filename="239i">i</dfn>;</td></tr>
<tr><th id="1609">1609</th><td>        <a class="local col7 ref" href="#237st" title='st' data-ref="237st" data-ref-filename="237st">st</a> = <a class="macro" href="../mDNSCore/mDNSDebug.h.html#166" title="malloc(NumSubTypes * sizeof(AuthRecord))" data-ref="_M/mallocL">mallocL</a>(<q>"ServiceSubTypes"</q>, <a class="local col4 ref" href="#234NumSubTypes" title='NumSubTypes' data-ref="234NumSubTypes" data-ref-filename="234NumSubTypes">NumSubTypes</a> * <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord" title='AuthRecord' data-type='struct AuthRecord_struct' data-ref="AuthRecord" data-ref-filename="AuthRecord">AuthRecord</a>));</td></tr>
<tr><th id="1610">1610</th><td>        <b>if</b> (!<a class="local col7 ref" href="#237st" title='st' data-ref="237st" data-ref-filename="237st">st</a>) <b>return</b>(<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>);</td></tr>
<tr><th id="1611">1611</th><td>        <b>for</b> (<a class="local col9 ref" href="#239i" title='i' data-ref="239i" data-ref-filename="239i">i</a> = <var>0</var>; <a class="local col9 ref" href="#239i" title='i' data-ref="239i" data-ref-filename="239i">i</a> &lt; <a class="local col4 ref" href="#234NumSubTypes" title='NumSubTypes' data-ref="234NumSubTypes" data-ref-filename="234NumSubTypes">NumSubTypes</a>; <a class="local col9 ref" href="#239i" title='i' data-ref="239i" data-ref-filename="239i">i</a>++)</td></tr>
<tr><th id="1612">1612</th><td>        {</td></tr>
<tr><th id="1613">1613</th><td>            <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_SetupResourceRecord" title='mDNS_SetupResourceRecord' data-ref="mDNS_SetupResourceRecord" data-ref-filename="mDNS_SetupResourceRecord">mDNS_SetupResourceRecord</a>(&amp;<a class="local col7 ref" href="#237st" title='st' data-ref="237st" data-ref-filename="237st">st</a>[<a class="local col9 ref" href="#239i" title='i' data-ref="239i" data-ref-filename="239i">i</a>], <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>, <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterface_Any" title='mDNSInterface_Any' data-ref="mDNSInterface_Any" data-ref-filename="mDNSInterface_Any">mDNSInterface_Any</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSQType_ANY" title='kDNSQType_ANY' data-ref="kDNSQType_ANY" data-ref-filename="kDNSQType_ANY">kDNSQType_ANY</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#432" title="(3600UL * 100 / 80)" data-ref="_M/kStandardTTL">kStandardTTL</a>, <var>0</var>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecordAny" title='AuthRecordAny' data-ref="AuthRecordAny" data-ref-filename="AuthRecordAny">AuthRecordAny</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>);</td></tr>
<tr><th id="1614">1614</th><td>            <i>// First time through we skip the regtype or AnonData. Subsequently, the</i></td></tr>
<tr><th id="1615">1615</th><td><i>            // previous subtype.</i></td></tr>
<tr><th id="1616">1616</th><td>            <b>while</b> (*<a class="local col5 ref" href="#235p" title='p' data-ref="235p" data-ref-filename="235p">p</a>) <a class="local col5 ref" href="#235p" title='p' data-ref="235p" data-ref-filename="235p">p</a>++;</td></tr>
<tr><th id="1617">1617</th><td>            <a class="local col5 ref" href="#235p" title='p' data-ref="235p" data-ref-filename="235p">p</a>++;</td></tr>
<tr><th id="1618">1618</th><td>            <b>if</b> (!<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#MakeDomainNameFromDNSNameString" title='MakeDomainNameFromDNSNameString' data-ref="MakeDomainNameFromDNSNameString" data-ref-filename="MakeDomainNameFromDNSNameString">MakeDomainNameFromDNSNameString</a>(&amp;<a class="local col7 ref" href="#237st" title='st' data-ref="237st" data-ref-filename="237st">st</a>[<a class="local col9 ref" href="#239i" title='i' data-ref="239i" data-ref-filename="239i">i</a>].<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::namestorage" title='AuthRecord_struct::namestorage' data-ref="AuthRecord_struct::namestorage" data-ref-filename="AuthRecord_struct..namestorage">namestorage</a>, <a class="local col5 ref" href="#235p" title='p' data-ref="235p" data-ref-filename="235p">p</a>))</td></tr>
<tr><th id="1619">1619</th><td>            {</td></tr>
<tr><th id="1620">1620</th><td>                <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(st)" data-ref="_M/freeL">freeL</a>(<q>"ServiceSubTypes"</q>, <a class="local col7 ref" href="#237st" title='st' data-ref="237st" data-ref-filename="237st">st</a>);</td></tr>
<tr><th id="1621">1621</th><td>                <b>if</b> (<a class="local col6 ref" href="#236AnonData" title='AnonData' data-ref="236AnonData" data-ref-filename="236AnonData">AnonData</a> &amp;&amp; *<a class="local col6 ref" href="#236AnonData" title='AnonData' data-ref="236AnonData" data-ref-filename="236AnonData">AnonData</a>)</td></tr>
<tr><th id="1622">1622</th><td>                    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(*AnonData)" data-ref="_M/freeL">freeL</a>(<q>"AnonymousData"</q>, *<a class="local col6 ref" href="#236AnonData" title='AnonData' data-ref="236AnonData" data-ref-filename="236AnonData">AnonData</a>);</td></tr>
<tr><th id="1623">1623</th><td>                <b>return</b>(<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>);</td></tr>
<tr><th id="1624">1624</th><td>            }</td></tr>
<tr><th id="1625">1625</th><td>        }</td></tr>
<tr><th id="1626">1626</th><td>    }</td></tr>
<tr><th id="1627">1627</th><td>    <i>// If NumSubTypes is zero and AnonData is non-NULL, we still return NULL but AnonData has been</i></td></tr>
<tr><th id="1628">1628</th><td><i>    // initialized. The caller knows how to handle this.</i></td></tr>
<tr><th id="1629">1629</th><td>    <b>return</b>(<a class="local col7 ref" href="#237st" title='st' data-ref="237st" data-ref-filename="237st">st</a>);</td></tr>
<tr><th id="1630">1630</th><td>}</td></tr>
<tr><th id="1631">1631</th><td></td></tr>
<tr><th id="1632">1632</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="decl def fn" id="register_service_instance" title='register_service_instance' data-ref="register_service_instance" data-ref-filename="register_service_instance">register_service_instance</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col0 decl" id="240request" title='request' data-type='request_state *' data-ref="240request" data-ref-filename="240request">request</dfn>, <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#domainname" title='domainname' data-type='struct domainname' data-ref="domainname" data-ref-filename="domainname">domainname</a> *<dfn class="local col1 decl" id="241domain" title='domain' data-type='const domainname *' data-ref="241domain" data-ref-filename="241domain">domain</dfn>)</td></tr>
<tr><th id="1633">1633</th><td>{</td></tr>
<tr><th id="1634">1634</th><td>    <a class="typedef" href="uds_daemon.h.html#service_instance" title='service_instance' data-type='struct service_instance' data-ref="service_instance" data-ref-filename="service_instance">service_instance</a> **<dfn class="local col2 decl" id="242ptr" title='ptr' data-type='service_instance **' data-ref="242ptr" data-ref-filename="242ptr">ptr</dfn>, *<dfn class="local col3 decl" id="243instance" title='instance' data-type='service_instance *' data-ref="243instance" data-ref-filename="243instance">instance</dfn>;</td></tr>
<tr><th id="1635">1635</th><td>    <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#size_t" title='size_t' data-type='unsigned long' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col4 decl" id="244extra_size" title='extra_size' data-type='size_t' data-ref="244extra_size" data-ref-filename="244extra_size">extra_size</dfn> = (<a class="local col0 ref" href="#240request" title='request' data-ref="240request" data-ref-filename="240request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txtlen" title='request_state::(anonymous union)::(anonymous struct)::txtlen' data-ref="request_state::(anonymousunion)::(anonymous)::txtlen" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txtlen">txtlen</a> &gt; <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#RDataBody" title='RDataBody' data-type='union RDataBody' data-ref="RDataBody" data-ref-filename="RDataBody">RDataBody</a>)) ? (<a class="local col0 ref" href="#240request" title='request' data-ref="240request" data-ref-filename="240request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txtlen" title='request_state::(anonymous union)::(anonymous struct)::txtlen' data-ref="request_state::(anonymousunion)::(anonymous)::txtlen" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txtlen">txtlen</a> - <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#RDataBody" title='RDataBody' data-type='union RDataBody' data-ref="RDataBody" data-ref-filename="RDataBody">RDataBody</a>)) : <var>0</var>;</td></tr>
<tr><th id="1636">1636</th><td>    <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSBool" title='mDNSBool' data-type='unsigned char' data-ref="mDNSBool" data-ref-filename="mDNSBool">mDNSBool</a> <dfn class="local col5 decl" id="245DomainIsLocal" title='DomainIsLocal' data-type='const mDNSBool' data-ref="245DomainIsLocal" data-ref-filename="245DomainIsLocal">DomainIsLocal</dfn> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#SameDomainName" title='SameDomainName' data-ref="SameDomainName" data-ref-filename="SameDomainName">SameDomainName</a>(<a class="local col1 ref" href="#241domain" title='domain' data-ref="241domain" data-ref-filename="241domain">domain</a>, &amp;<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2594" title="(*(const domainname *)&quot;\x5&quot; &quot;local&quot;)" data-ref="_M/localdomain">localdomain</a>);</td></tr>
<tr><th id="1637">1637</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="local col6 decl" id="246result" title='result' data-type='mStatus' data-ref="246result" data-ref-filename="246result">result</dfn>;</td></tr>
<tr><th id="1638">1638</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterfaceID" title='mDNSInterfaceID' data-type='struct mDNSInterfaceID_dummystruct *' data-ref="mDNSInterfaceID" data-ref-filename="mDNSInterfaceID">mDNSInterfaceID</a> <dfn class="local col7 decl" id="247interfaceID" title='interfaceID' data-type='mDNSInterfaceID' data-ref="247interfaceID" data-ref-filename="247interfaceID">interfaceID</dfn> = <a class="local col0 ref" href="#240request" title='request' data-ref="240request" data-ref-filename="240request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::InterfaceID" title='request_state::(anonymous union)::(anonymous struct)::InterfaceID' data-ref="request_state::(anonymousunion)::(anonymous)::InterfaceID" data-ref-filename="request_state..(anonymousunion)..(anonymous)..InterfaceID">InterfaceID</a>;</td></tr>
<tr><th id="1639">1639</th><td></td></tr>
<tr><th id="1640">1640</th><td>    <i>// If the client specified an interface, but no domain, then we honor the specified interface for the "local" (mDNS)</i></td></tr>
<tr><th id="1641">1641</th><td><i>    // registration but for the wide-area registrations we don't (currently) have any concept of a wide-area unicast</i></td></tr>
<tr><th id="1642">1642</th><td><i>    // registrations scoped to a specific interface, so for the automatic domains we add we must *not* specify an interface.</i></td></tr>
<tr><th id="1643">1643</th><td><i>    // (Specifying an interface with an apparently wide-area domain (i.e. something other than "local")</i></td></tr>
<tr><th id="1644">1644</th><td><i>    // currently forces the registration to use mDNS multicast despite the apparently wide-area domain.)</i></td></tr>
<tr><th id="1645">1645</th><td>    <b>if</b> (<a class="local col0 ref" href="#240request" title='request' data-ref="240request" data-ref-filename="240request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::default_domain" title='request_state::(anonymous union)::(anonymous struct)::default_domain' data-ref="request_state::(anonymousunion)::(anonymous)::default_domain" data-ref-filename="request_state..(anonymousunion)..(anonymous)..default_domain">default_domain</a> &amp;&amp; !<a class="local col5 ref" href="#245DomainIsLocal" title='DomainIsLocal' data-ref="245DomainIsLocal" data-ref-filename="245DomainIsLocal">DomainIsLocal</a>) <a class="local col7 ref" href="#247interfaceID" title='interfaceID' data-ref="247interfaceID" data-ref-filename="247interfaceID">interfaceID</a> = <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterface_Any" title='mDNSInterface_Any' data-ref="mDNSInterface_Any" data-ref-filename="mDNSInterface_Any">mDNSInterface_Any</a>;</td></tr>
<tr><th id="1646">1646</th><td></td></tr>
<tr><th id="1647">1647</th><td>    <b>for</b> (<a class="local col2 ref" href="#242ptr" title='ptr' data-ref="242ptr" data-ref-filename="242ptr">ptr</a> = &amp;<a class="local col0 ref" href="#240request" title='request' data-ref="240request" data-ref-filename="240request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::instances" title='request_state::(anonymous union)::(anonymous struct)::instances' data-ref="request_state::(anonymousunion)::(anonymous)::instances" data-ref-filename="request_state..(anonymousunion)..(anonymous)..instances">instances</a>; *<a class="local col2 ref" href="#242ptr" title='ptr' data-ref="242ptr" data-ref-filename="242ptr">ptr</a>; <a class="local col2 ref" href="#242ptr" title='ptr' data-ref="242ptr" data-ref-filename="242ptr">ptr</a> = &amp;(*<a class="local col2 ref" href="#242ptr" title='ptr' data-ref="242ptr" data-ref-filename="242ptr">ptr</a>)-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::next" title='service_instance::next' data-ref="service_instance::next" data-ref-filename="service_instance..next">next</a>)</td></tr>
<tr><th id="1648">1648</th><td>    {</td></tr>
<tr><th id="1649">1649</th><td>        <b>if</b> (<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#SameDomainName" title='SameDomainName' data-ref="SameDomainName" data-ref-filename="SameDomainName">SameDomainName</a>(&amp;(*<a class="local col2 ref" href="#242ptr" title='ptr' data-ref="242ptr" data-ref-filename="242ptr">ptr</a>)-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::domain" title='service_instance::domain' data-ref="service_instance::domain" data-ref-filename="service_instance..domain">domain</a>, <a class="local col1 ref" href="#241domain" title='domain' data-ref="241domain" data-ref-filename="241domain">domain</a>))</td></tr>
<tr><th id="1650">1650</th><td>        {</td></tr>
<tr><th id="1651">1651</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;register_service_instance: domain %##s already registered for %#s.%##s&quot;, domain-&gt;c, &amp;request-&gt;u.servicereg.name, &amp;request-&gt;u.servicereg.type)" data-ref="_M/LogMsg">LogMsg</a>(<q>"register_service_instance: domain %##s already registered for %#s.%##s"</q>,</td></tr>
<tr><th id="1652">1652</th><td>                   <a class="local col1 ref" href="#241domain" title='domain' data-ref="241domain" data-ref-filename="241domain">domain</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, &amp;<a class="local col0 ref" href="#240request" title='request' data-ref="240request" data-ref-filename="240request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::name" title='request_state::(anonymous union)::(anonymous struct)::name' data-ref="request_state::(anonymousunion)::(anonymous)::name" data-ref-filename="request_state..(anonymousunion)..(anonymous)..name">name</a>, &amp;<a class="local col0 ref" href="#240request" title='request' data-ref="240request" data-ref-filename="240request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::type" title='request_state::(anonymous union)::(anonymous struct)::type' data-ref="request_state::(anonymousunion)::(anonymous)::type" data-ref-filename="request_state..(anonymousunion)..(anonymous)..type">type</a>);</td></tr>
<tr><th id="1653">1653</th><td>            <b>return</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_AlreadyRegistered" title='mStatus_AlreadyRegistered' data-ref="mStatus_AlreadyRegistered" data-ref-filename="mStatus_AlreadyRegistered">mStatus_AlreadyRegistered</a>;</td></tr>
<tr><th id="1654">1654</th><td>        }</td></tr>
<tr><th id="1655">1655</th><td>    }</td></tr>
<tr><th id="1656">1656</th><td></td></tr>
<tr><th id="1657">1657</th><td>    <a class="local col3 ref" href="#243instance" title='instance' data-ref="243instance" data-ref-filename="243instance">instance</a> = <a class="macro" href="../mDNSCore/mDNSDebug.h.html#166" title="malloc(sizeof(*instance) + extra_size)" data-ref="_M/mallocL">mallocL</a>(<q>"service_instance"</q>, <b>sizeof</b>(*<a class="local col3 ref" href="#243instance" title='instance' data-ref="243instance" data-ref-filename="243instance">instance</a>) + <a class="local col4 ref" href="#244extra_size" title='extra_size' data-ref="244extra_size" data-ref-filename="244extra_size">extra_size</a>);</td></tr>
<tr><th id="1658">1658</th><td>    <b>if</b> (!<a class="local col3 ref" href="#243instance" title='instance' data-ref="243instance" data-ref-filename="243instance">instance</a>) { <a class="ref fn" href="#my_perror" title='my_perror' data-ref="my_perror" data-ref-filename="my_perror">my_perror</a>(<q>"ERROR: malloc"</q>); <b>return</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_NoMemoryErr" title='mStatus_NoMemoryErr' data-ref="mStatus_NoMemoryErr" data-ref-filename="mStatus_NoMemoryErr">mStatus_NoMemoryErr</a>; }</td></tr>
<tr><th id="1659">1659</th><td></td></tr>
<tr><th id="1660">1660</th><td>    <a class="local col3 ref" href="#243instance" title='instance' data-ref="243instance" data-ref-filename="243instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::next" title='service_instance::next' data-ref="service_instance::next" data-ref-filename="service_instance..next">next</a>                          = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="1661">1661</th><td>    <a class="local col3 ref" href="#243instance" title='instance' data-ref="243instance" data-ref-filename="243instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>                       = <a class="local col0 ref" href="#240request" title='request' data-ref="240request" data-ref-filename="240request">request</a>;</td></tr>
<tr><th id="1662">1662</th><td>    <a class="local col3 ref" href="#243instance" title='instance' data-ref="243instance" data-ref-filename="243instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::renameonmemfree" title='service_instance::renameonmemfree' data-ref="service_instance::renameonmemfree" data-ref-filename="service_instance..renameonmemfree">renameonmemfree</a>               = <var>0</var>;</td></tr>
<tr><th id="1663">1663</th><td>    <a class="local col3 ref" href="#243instance" title='instance' data-ref="243instance" data-ref-filename="243instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::clientnotified" title='service_instance::clientnotified' data-ref="service_instance::clientnotified" data-ref-filename="service_instance..clientnotified">clientnotified</a>                = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>;</td></tr>
<tr><th id="1664">1664</th><td>    <a class="local col3 ref" href="#243instance" title='instance' data-ref="243instance" data-ref-filename="243instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::default_local" title='service_instance::default_local' data-ref="service_instance::default_local" data-ref-filename="service_instance..default_local">default_local</a>                 = (<a class="local col0 ref" href="#240request" title='request' data-ref="240request" data-ref-filename="240request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::default_domain" title='request_state::(anonymous union)::(anonymous struct)::default_domain' data-ref="request_state::(anonymousunion)::(anonymous)::default_domain" data-ref-filename="request_state..(anonymousunion)..(anonymous)..default_domain">default_domain</a> &amp;&amp; <a class="local col5 ref" href="#245DomainIsLocal" title='DomainIsLocal' data-ref="245DomainIsLocal" data-ref-filename="245DomainIsLocal">DomainIsLocal</a>);</td></tr>
<tr><th id="1665">1665</th><td>    <a class="local col3 ref" href="#243instance" title='instance' data-ref="243instance" data-ref-filename="243instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::external_advertise" title='service_instance::external_advertise' data-ref="service_instance::external_advertise" data-ref-filename="service_instance..external_advertise">external_advertise</a>            = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>;</td></tr>
<tr><th id="1666">1666</th><td>    <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2849" title="do { mDNSu16 len__ = DomainNameLengthLimit(((domain)), ((domain))-&gt;c + 256); if (len__ &lt;= 256) mDNSPlatformMemCopy((&amp;instance-&gt;domain)-&gt;c, (domain)-&gt;c, len__); else (&amp;instance-&gt;domain)-&gt;c[0] = 0; } while(0)" data-ref="_M/AssignDomainName">AssignDomainName</a>(&amp;<a class="local col3 ref" href="#243instance" title='instance' data-ref="243instance" data-ref-filename="243instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::domain" title='service_instance::domain' data-ref="service_instance::domain" data-ref-filename="service_instance..domain">domain</a>, <a class="local col1 ref" href="#241domain" title='domain' data-ref="241domain" data-ref-filename="241domain">domain</a>);</td></tr>
<tr><th id="1667">1667</th><td></td></tr>
<tr><th id="1668">1668</th><td>    <a class="local col3 ref" href="#243instance" title='instance' data-ref="243instance" data-ref-filename="243instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::AnonData" title='ServiceRecordSet_struct::AnonData' data-ref="ServiceRecordSet_struct::AnonData" data-ref-filename="ServiceRecordSet_struct..AnonData">AnonData</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="1669">1669</th><td>    <b>if</b> (!<a class="local col0 ref" href="#240request" title='request' data-ref="240request" data-ref-filename="240request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::AnonData" title='request_state::(anonymous union)::(anonymous struct)::AnonData' data-ref="request_state::(anonymousunion)::(anonymous)::AnonData" data-ref-filename="request_state..(anonymousunion)..(anonymous)..AnonData">AnonData</a>)</td></tr>
<tr><th id="1670">1670</th><td>    {</td></tr>
<tr><th id="1671">1671</th><td>        <a class="local col3 ref" href="#243instance" title='instance' data-ref="243instance" data-ref-filename="243instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::subtypes" title='service_instance::subtypes' data-ref="service_instance::subtypes" data-ref-filename="service_instance..subtypes">subtypes</a> = <a class="ref fn" href="#AllocateSubTypes" title='AllocateSubTypes' data-ref="AllocateSubTypes" data-ref-filename="AllocateSubTypes">AllocateSubTypes</a>(<a class="local col0 ref" href="#240request" title='request' data-ref="240request" data-ref-filename="240request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::num_subtypes" title='request_state::(anonymous union)::(anonymous struct)::num_subtypes' data-ref="request_state::(anonymousunion)::(anonymous)::num_subtypes" data-ref-filename="request_state..(anonymousunion)..(anonymous)..num_subtypes">num_subtypes</a>, <a class="local col0 ref" href="#240request" title='request' data-ref="240request" data-ref-filename="240request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::type_as_string" title='request_state::(anonymous union)::(anonymous struct)::type_as_string' data-ref="request_state::(anonymousunion)::(anonymous)::type_as_string" data-ref-filename="request_state..(anonymousunion)..(anonymous)..type_as_string">type_as_string</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>);</td></tr>
<tr><th id="1672">1672</th><td>    }</td></tr>
<tr><th id="1673">1673</th><td>    <b>else</b></td></tr>
<tr><th id="1674">1674</th><td>    {</td></tr>
<tr><th id="1675">1675</th><td>        <em>char</em> *<dfn class="local col8 decl" id="248AnonData" title='AnonData' data-type='char *' data-ref="248AnonData" data-ref-filename="248AnonData">AnonData</dfn> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="1676">1676</th><td>        <a class="local col3 ref" href="#243instance" title='instance' data-ref="243instance" data-ref-filename="243instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::subtypes" title='service_instance::subtypes' data-ref="service_instance::subtypes" data-ref-filename="service_instance..subtypes">subtypes</a> = <a class="ref fn" href="#AllocateSubTypes" title='AllocateSubTypes' data-ref="AllocateSubTypes" data-ref-filename="AllocateSubTypes">AllocateSubTypes</a>(<a class="local col0 ref" href="#240request" title='request' data-ref="240request" data-ref-filename="240request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::num_subtypes" title='request_state::(anonymous union)::(anonymous struct)::num_subtypes' data-ref="request_state::(anonymousunion)::(anonymous)::num_subtypes" data-ref-filename="request_state..(anonymousunion)..(anonymous)..num_subtypes">num_subtypes</a>, <a class="local col0 ref" href="#240request" title='request' data-ref="240request" data-ref-filename="240request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::type_as_string" title='request_state::(anonymous union)::(anonymous struct)::type_as_string' data-ref="request_state::(anonymousunion)::(anonymous)::type_as_string" data-ref-filename="request_state..(anonymousunion)..(anonymous)..type_as_string">type_as_string</a>, &amp;<a class="local col8 ref" href="#248AnonData" title='AnonData' data-ref="248AnonData" data-ref-filename="248AnonData">AnonData</a>);</td></tr>
<tr><th id="1677">1677</th><td>        <b>if</b> (<a class="local col8 ref" href="#248AnonData" title='AnonData' data-ref="248AnonData" data-ref-filename="248AnonData">AnonData</a>)</td></tr>
<tr><th id="1678">1678</th><td>            <a class="local col3 ref" href="#243instance" title='instance' data-ref="243instance" data-ref-filename="243instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::AnonData" title='ServiceRecordSet_struct::AnonData' data-ref="ServiceRecordSet_struct::AnonData" data-ref-filename="ServiceRecordSet_struct..AnonData">AnonData</a> = (<em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu8" title='mDNSu8' data-type='unsigned char' data-ref="mDNSu8" data-ref-filename="mDNSu8">mDNSu8</a> *)<a class="local col8 ref" href="#248AnonData" title='AnonData' data-ref="248AnonData" data-ref-filename="248AnonData">AnonData</a>;</td></tr>
<tr><th id="1679">1679</th><td>    }</td></tr>
<tr><th id="1680">1680</th><td></td></tr>
<tr><th id="1681">1681</th><td>    <b>if</b> (<a class="local col0 ref" href="#240request" title='request' data-ref="240request" data-ref-filename="240request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::num_subtypes" title='request_state::(anonymous union)::(anonymous struct)::num_subtypes' data-ref="request_state::(anonymousunion)::(anonymous)::num_subtypes" data-ref-filename="request_state..(anonymousunion)..(anonymous)..num_subtypes">num_subtypes</a> &amp;&amp; !<a class="local col3 ref" href="#243instance" title='instance' data-ref="243instance" data-ref-filename="243instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::subtypes" title='service_instance::subtypes' data-ref="service_instance::subtypes" data-ref-filename="service_instance..subtypes">subtypes</a>)</td></tr>
<tr><th id="1682">1682</th><td>    {</td></tr>
<tr><th id="1683">1683</th><td>        <a class="ref fn" href="#unlink_and_free_service_instance" title='unlink_and_free_service_instance' data-ref="unlink_and_free_service_instance" data-ref-filename="unlink_and_free_service_instance">unlink_and_free_service_instance</a>(<a class="local col3 ref" href="#243instance" title='instance' data-ref="243instance" data-ref-filename="243instance">instance</a>);</td></tr>
<tr><th id="1684">1684</th><td>        <a class="local col3 ref" href="#243instance" title='instance' data-ref="243instance" data-ref-filename="243instance">instance</a> = <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="1685">1685</th><td>        <a class="ref fn" href="#FatalError" title='FatalError' data-ref="FatalError" data-ref-filename="FatalError">FatalError</a>(<q>"ERROR: malloc"</q>);</td></tr>
<tr><th id="1686">1686</th><td>    }</td></tr>
<tr><th id="1687">1687</th><td></td></tr>
<tr><th id="1688">1688</th><td>    <a class="local col6 ref" href="#246result" title='result' data-ref="246result" data-ref-filename="246result">result</a> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_RegisterService" title='mDNS_RegisterService' data-ref="mDNS_RegisterService" data-ref-filename="mDNS_RegisterService">mDNS_RegisterService</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col3 ref" href="#243instance" title='instance' data-ref="243instance" data-ref-filename="243instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>,</td></tr>
<tr><th id="1689">1689</th><td>                                  &amp;<a class="local col0 ref" href="#240request" title='request' data-ref="240request" data-ref-filename="240request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::name" title='request_state::(anonymous union)::(anonymous struct)::name' data-ref="request_state::(anonymousunion)::(anonymous)::name" data-ref-filename="request_state..(anonymousunion)..(anonymous)..name">name</a>, &amp;<a class="local col0 ref" href="#240request" title='request' data-ref="240request" data-ref-filename="240request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::type" title='request_state::(anonymous union)::(anonymous struct)::type' data-ref="request_state::(anonymousunion)::(anonymous)::type" data-ref-filename="request_state..(anonymousunion)..(anonymous)..type">type</a>, <a class="local col1 ref" href="#241domain" title='domain' data-ref="241domain" data-ref-filename="241domain">domain</a>,</td></tr>
<tr><th id="1690">1690</th><td>                                  <a class="local col0 ref" href="#240request" title='request' data-ref="240request" data-ref-filename="240request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::host" title='request_state::(anonymous union)::(anonymous struct)::host' data-ref="request_state::(anonymousunion)::(anonymous)::host" data-ref-filename="request_state..(anonymousunion)..(anonymous)..host">host</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>[<var>0</var>] ? &amp;<a class="local col0 ref" href="#240request" title='request' data-ref="240request" data-ref-filename="240request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::host" title='request_state::(anonymous union)::(anonymous struct)::host' data-ref="request_state::(anonymousunion)::(anonymous)::host" data-ref-filename="request_state..(anonymousunion)..(anonymous)..host">host</a> : <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>,</td></tr>
<tr><th id="1691">1691</th><td>                                  <a class="local col0 ref" href="#240request" title='request' data-ref="240request" data-ref-filename="240request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::port" title='request_state::(anonymous union)::(anonymous struct)::port' data-ref="request_state::(anonymousunion)::(anonymous)::port" data-ref-filename="request_state..(anonymousunion)..(anonymous)..port">port</a>,</td></tr>
<tr><th id="1692">1692</th><td>                                  <a class="local col0 ref" href="#240request" title='request' data-ref="240request" data-ref-filename="240request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txtdata" title='request_state::(anonymous union)::(anonymous struct)::txtdata' data-ref="request_state::(anonymousunion)::(anonymous)::txtdata" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txtdata">txtdata</a>, <a class="local col0 ref" href="#240request" title='request' data-ref="240request" data-ref-filename="240request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txtlen" title='request_state::(anonymous union)::(anonymous struct)::txtlen' data-ref="request_state::(anonymousunion)::(anonymous)::txtlen" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txtlen">txtlen</a>,</td></tr>
<tr><th id="1693">1693</th><td>                                  <a class="local col3 ref" href="#243instance" title='instance' data-ref="243instance" data-ref-filename="243instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::subtypes" title='service_instance::subtypes' data-ref="service_instance::subtypes" data-ref-filename="service_instance..subtypes">subtypes</a>, <a class="local col0 ref" href="#240request" title='request' data-ref="240request" data-ref-filename="240request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::num_subtypes" title='request_state::(anonymous union)::(anonymous struct)::num_subtypes' data-ref="request_state::(anonymousunion)::(anonymous)::num_subtypes" data-ref-filename="request_state..(anonymousunion)..(anonymous)..num_subtypes">num_subtypes</a>,</td></tr>
<tr><th id="1694">1694</th><td>                                  <a class="local col7 ref" href="#247interfaceID" title='interfaceID' data-ref="247interfaceID" data-ref-filename="247interfaceID">interfaceID</a>, <a class="ref fn" href="#regservice_callback" title='regservice_callback' data-ref="regservice_callback" data-ref-filename="regservice_callback">regservice_callback</a>, <a class="local col3 ref" href="#243instance" title='instance' data-ref="243instance" data-ref-filename="243instance">instance</a>, <a class="local col0 ref" href="#240request" title='request' data-ref="240request" data-ref-filename="240request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a>);</td></tr>
<tr><th id="1695">1695</th><td></td></tr>
<tr><th id="1696">1696</th><td>    <b>if</b> (!<a class="local col6 ref" href="#246result" title='result' data-ref="246result" data-ref-filename="246result">result</a>)</td></tr>
<tr><th id="1697">1697</th><td>    {</td></tr>
<tr><th id="1698">1698</th><td>        *<a class="local col2 ref" href="#242ptr" title='ptr' data-ref="242ptr" data-ref-filename="242ptr">ptr</a> = <a class="local col3 ref" href="#243instance" title='instance' data-ref="243instance" data-ref-filename="243instance">instance</a>;        <i>// Append this to the end of our request-&gt;u.servicereg.instances list</i></td></tr>
<tr><th id="1699">1699</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: DNSServiceRegister(%##s, %u) ADDED&quot;, instance-&gt;request-&gt;sd, instance-&gt;srs.RR_SRV.resrec.name-&gt;c, mDNSVal16(request-&gt;u.servicereg.port));} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: DNSServiceRegister(%##s, %u) ADDED"</q>, <a class="local col3 ref" href="#243instance" title='instance' data-ref="243instance" data-ref-filename="243instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>,</td></tr>
<tr><th id="1700">1700</th><td>                     <a class="local col3 ref" href="#243instance" title='instance' data-ref="243instance" data-ref-filename="243instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_SRV" title='ServiceRecordSet_struct::RR_SRV' data-ref="ServiceRecordSet_struct::RR_SRV" data-ref-filename="ServiceRecordSet_struct..RR_SRV">RR_SRV</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::name" title='ResourceRecord_struct::name' data-ref="ResourceRecord_struct::name" data-ref-filename="ResourceRecord_struct..name">name</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSVal16" title='mDNSVal16' data-ref="mDNSVal16" data-ref-filename="mDNSVal16">mDNSVal16</a>(<a class="local col0 ref" href="#240request" title='request' data-ref="240request" data-ref-filename="240request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::port" title='request_state::(anonymous union)::(anonymous struct)::port' data-ref="request_state::(anonymousunion)::(anonymous)::port" data-ref-filename="request_state..(anonymousunion)..(anonymous)..port">port</a>));</td></tr>
<tr><th id="1701">1701</th><td>        <a class="macro" href="uds_daemon.h.html#225" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMcastService" data-ref="_M/LogMcastS">LogMcastS</a>(&amp;<a class="local col3 ref" href="#243instance" title='instance' data-ref="243instance" data-ref-filename="243instance">instance</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_SRV" title='ServiceRecordSet_struct::RR_SRV' data-ref="ServiceRecordSet_struct::RR_SRV" data-ref-filename="ServiceRecordSet_struct..RR_SRV">RR_SRV</a>, <a class="local col0 ref" href="#240request" title='request' data-ref="240request" data-ref-filename="240request">request</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#reg_start" title='reg_start' data-ref="reg_start" data-ref-filename="reg_start">reg_start</a>);</td></tr>
<tr><th id="1702">1702</th><td>    }</td></tr>
<tr><th id="1703">1703</th><td>    <b>else</b></td></tr>
<tr><th id="1704">1704</th><td>    {</td></tr>
<tr><th id="1705">1705</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;register_service_instance %#s.%##s%##s error %d&quot;, &amp;request-&gt;u.servicereg.name, &amp;request-&gt;u.servicereg.type, domain-&gt;c, result)" data-ref="_M/LogMsg">LogMsg</a>(<q>"register_service_instance %#s.%##s%##s error %d"</q>,</td></tr>
<tr><th id="1706">1706</th><td>               &amp;<a class="local col0 ref" href="#240request" title='request' data-ref="240request" data-ref-filename="240request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::name" title='request_state::(anonymous union)::(anonymous struct)::name' data-ref="request_state::(anonymousunion)::(anonymous)::name" data-ref-filename="request_state..(anonymousunion)..(anonymous)..name">name</a>, &amp;<a class="local col0 ref" href="#240request" title='request' data-ref="240request" data-ref-filename="240request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::type" title='request_state::(anonymous union)::(anonymous struct)::type' data-ref="request_state::(anonymousunion)::(anonymous)::type" data-ref-filename="request_state..(anonymousunion)..(anonymous)..type">type</a>, <a class="local col1 ref" href="#241domain" title='domain' data-ref="241domain" data-ref-filename="241domain">domain</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="local col6 ref" href="#246result" title='result' data-ref="246result" data-ref-filename="246result">result</a>);</td></tr>
<tr><th id="1707">1707</th><td>        <a class="ref fn" href="#unlink_and_free_service_instance" title='unlink_and_free_service_instance' data-ref="unlink_and_free_service_instance" data-ref-filename="unlink_and_free_service_instance">unlink_and_free_service_instance</a>(<a class="local col3 ref" href="#243instance" title='instance' data-ref="243instance" data-ref-filename="243instance">instance</a>);</td></tr>
<tr><th id="1708">1708</th><td>    }</td></tr>
<tr><th id="1709">1709</th><td></td></tr>
<tr><th id="1710">1710</th><td>    <b>return</b> <a class="local col6 ref" href="#246result" title='result' data-ref="246result" data-ref-filename="246result">result</a>;</td></tr>
<tr><th id="1711">1711</th><td>}</td></tr>
<tr><th id="1712">1712</th><td></td></tr>
<tr><th id="1713">1713</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="udsserver_default_reg_domain_changed" title='udsserver_default_reg_domain_changed' data-ref="udsserver_default_reg_domain_changed" data-ref-filename="udsserver_default_reg_domain_changed">udsserver_default_reg_domain_changed</dfn>(<em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem" title='DNameListElem' data-type='struct DNameListElem' data-ref="DNameListElem" data-ref-filename="DNameListElem">DNameListElem</a> *<em>const</em> <dfn class="local col9 decl" id="249d" title='d' data-type='const DNameListElem *const' data-ref="249d" data-ref-filename="249d">d</dfn>, <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSBool" title='mDNSBool' data-type='unsigned char' data-ref="mDNSBool" data-ref-filename="mDNSBool">mDNSBool</a> <dfn class="local col0 decl" id="250add" title='add' data-type='const mDNSBool' data-ref="250add" data-ref-filename="250add">add</dfn>)</td></tr>
<tr><th id="1714">1714</th><td>{</td></tr>
<tr><th id="1715">1715</th><td>    <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col1 decl" id="251request" title='request' data-type='request_state *' data-ref="251request" data-ref-filename="251request">request</dfn>;</td></tr>
<tr><th id="1716">1716</th><td></td></tr>
<tr><th id="1717">1717</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%s registration domain %##s&quot;, add ? &quot;Adding&quot; : &quot;Removing&quot;, d-&gt;name.c)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%s registration domain %##s"</q>, <a class="local col0 ref" href="#250add" title='add' data-ref="250add" data-ref-filename="250add">add</a> ? <q>"Adding"</q> : <q>"Removing"</q>, <a class="local col9 ref" href="#249d" title='d' data-ref="249d" data-ref-filename="249d">d</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::name" title='DNameListElem::name' data-ref="DNameListElem::name" data-ref-filename="DNameListElem..name">name</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>);</td></tr>
<tr><th id="1718">1718</th><td>    <b>for</b> (<a class="local col1 ref" href="#251request" title='request' data-ref="251request" data-ref-filename="251request">request</a> = <a class="tu ref" href="#all_requests" title='all_requests' data-use='r' data-ref="all_requests" data-ref-filename="all_requests">all_requests</a>; <a class="local col1 ref" href="#251request" title='request' data-ref="251request" data-ref-filename="251request">request</a>; <a class="local col1 ref" href="#251request" title='request' data-ref="251request" data-ref-filename="251request">request</a> = <a class="local col1 ref" href="#251request" title='request' data-ref="251request" data-ref-filename="251request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::next" title='request_state::next' data-ref="request_state::next" data-ref-filename="request_state..next">next</a>)</td></tr>
<tr><th id="1719">1719</th><td>    {</td></tr>
<tr><th id="1720">1720</th><td>        <b>if</b> (<a class="local col1 ref" href="#251request" title='request' data-ref="251request" data-ref-filename="251request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> != <a class="ref fn" href="#regservice_termination_callback" title='regservice_termination_callback' data-ref="regservice_termination_callback" data-ref-filename="regservice_termination_callback">regservice_termination_callback</a>) <b>continue</b>;</td></tr>
<tr><th id="1721">1721</th><td>        <b>if</b> (!<a class="local col1 ref" href="#251request" title='request' data-ref="251request" data-ref-filename="251request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::default_domain" title='request_state::(anonymous union)::(anonymous struct)::default_domain' data-ref="request_state::(anonymousunion)::(anonymous)::default_domain" data-ref-filename="request_state..(anonymousunion)..(anonymous)..default_domain">default_domain</a>) <b>continue</b>;</td></tr>
<tr><th id="1722">1722</th><td>        <b>if</b> (!<a class="local col9 ref" href="#249d" title='d' data-ref="249d" data-ref-filename="249d">d</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::uid" title='DNameListElem::uid' data-ref="DNameListElem::uid" data-ref-filename="DNameListElem..uid">uid</a> || <a class="macro" href="#83" title="((request-&gt;uid) &lt;= 500)" data-ref="_M/SystemUID">SystemUID</a>(<a class="local col1 ref" href="#251request" title='request' data-ref="251request" data-ref-filename="251request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::uid" title='request_state::uid' data-ref="request_state::uid" data-ref-filename="request_state..uid">uid</a>) || <a class="local col1 ref" href="#251request" title='request' data-ref="251request" data-ref-filename="251request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::uid" title='request_state::uid' data-ref="request_state::uid" data-ref-filename="request_state..uid">uid</a> == <a class="local col9 ref" href="#249d" title='d' data-ref="249d" data-ref-filename="249d">d</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::uid" title='DNameListElem::uid' data-ref="DNameListElem::uid" data-ref-filename="DNameListElem..uid">uid</a>)</td></tr>
<tr><th id="1723">1723</th><td>        {</td></tr>
<tr><th id="1724">1724</th><td>            <a class="typedef" href="uds_daemon.h.html#service_instance" title='service_instance' data-type='struct service_instance' data-ref="service_instance" data-ref-filename="service_instance">service_instance</a> **<dfn class="local col2 decl" id="252ptr" title='ptr' data-type='service_instance **' data-ref="252ptr" data-ref-filename="252ptr">ptr</dfn> = &amp;<a class="local col1 ref" href="#251request" title='request' data-ref="251request" data-ref-filename="251request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::instances" title='request_state::(anonymous union)::(anonymous struct)::instances' data-ref="request_state::(anonymousunion)::(anonymous)::instances" data-ref-filename="request_state..(anonymousunion)..(anonymous)..instances">instances</a>;</td></tr>
<tr><th id="1725">1725</th><td>            <b>while</b> (*<a class="local col2 ref" href="#252ptr" title='ptr' data-ref="252ptr" data-ref-filename="252ptr">ptr</a> &amp;&amp; !<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#SameDomainName" title='SameDomainName' data-ref="SameDomainName" data-ref-filename="SameDomainName">SameDomainName</a>(&amp;(*<a class="local col2 ref" href="#252ptr" title='ptr' data-ref="252ptr" data-ref-filename="252ptr">ptr</a>)-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::domain" title='service_instance::domain' data-ref="service_instance::domain" data-ref-filename="service_instance..domain">domain</a>, &amp;<a class="local col9 ref" href="#249d" title='d' data-ref="249d" data-ref-filename="249d">d</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::name" title='DNameListElem::name' data-ref="DNameListElem::name" data-ref-filename="DNameListElem..name">name</a>)) <a class="local col2 ref" href="#252ptr" title='ptr' data-ref="252ptr" data-ref-filename="252ptr">ptr</a> = &amp;(*<a class="local col2 ref" href="#252ptr" title='ptr' data-ref="252ptr" data-ref-filename="252ptr">ptr</a>)-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::next" title='service_instance::next' data-ref="service_instance::next" data-ref-filename="service_instance..next">next</a>;</td></tr>
<tr><th id="1726">1726</th><td>            <b>if</b> (<a class="local col0 ref" href="#250add" title='add' data-ref="250add" data-ref-filename="250add">add</a>)</td></tr>
<tr><th id="1727">1727</th><td>            {</td></tr>
<tr><th id="1728">1728</th><td>                <i>// If we don't already have this domain in our list for this registration, add it now</i></td></tr>
<tr><th id="1729">1729</th><td>                <b>if</b> (!*<a class="local col2 ref" href="#252ptr" title='ptr' data-ref="252ptr" data-ref-filename="252ptr">ptr</a>) <a class="ref fn" href="#register_service_instance" title='register_service_instance' data-ref="register_service_instance" data-ref-filename="register_service_instance">register_service_instance</a>(<a class="local col1 ref" href="#251request" title='request' data-ref="251request" data-ref-filename="251request">request</a>, &amp;<a class="local col9 ref" href="#249d" title='d' data-ref="249d" data-ref-filename="249d">d</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::name" title='DNameListElem::name' data-ref="DNameListElem::name" data-ref-filename="DNameListElem..name">name</a>);</td></tr>
<tr><th id="1730">1730</th><td>                <b>else</b> <a class="macro" href="../mDNSCore/mDNSDebug.h.html#131" title="debug_noop" data-ref="_M/debugf">debugf</a>(<q>"udsserver_default_reg_domain_changed %##s already in list, not re-adding"</q>, &amp;d-&gt;name);</td></tr>
<tr><th id="1731">1731</th><td>            }</td></tr>
<tr><th id="1732">1732</th><td>            <b>else</b></td></tr>
<tr><th id="1733">1733</th><td>            {</td></tr>
<tr><th id="1734">1734</th><td>                <i>// Normally we should not fail to find the specified instance</i></td></tr>
<tr><th id="1735">1735</th><td><i>                // One case where this can happen is if a uDNS update fails for some reason,</i></td></tr>
<tr><th id="1736">1736</th><td><i>                // and regservice_callback then calls unlink_and_free_service_instance and disposes of that instance.</i></td></tr>
<tr><th id="1737">1737</th><td>                <b>if</b> (!*<a class="local col2 ref" href="#252ptr" title='ptr' data-ref="252ptr" data-ref-filename="252ptr">ptr</a>)</td></tr>
<tr><th id="1738">1738</th><td>                    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;udsserver_default_reg_domain_changed domain %##s not found for service %#s type %s&quot;, &amp;d-&gt;name, request-&gt;u.servicereg.name.c, request-&gt;u.servicereg.type_as_string)" data-ref="_M/LogMsg">LogMsg</a>(<q>"udsserver_default_reg_domain_changed domain %##s not found for service %#s type %s"</q>,</td></tr>
<tr><th id="1739">1739</th><td>                           &amp;<a class="local col9 ref" href="#249d" title='d' data-ref="249d" data-ref-filename="249d">d</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::name" title='DNameListElem::name' data-ref="DNameListElem::name" data-ref-filename="DNameListElem..name">name</a>, <a class="local col1 ref" href="#251request" title='request' data-ref="251request" data-ref-filename="251request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::name" title='request_state::(anonymous union)::(anonymous struct)::name' data-ref="request_state::(anonymousunion)::(anonymous)::name" data-ref-filename="request_state..(anonymousunion)..(anonymous)..name">name</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="local col1 ref" href="#251request" title='request' data-ref="251request" data-ref-filename="251request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::type_as_string" title='request_state::(anonymous union)::(anonymous struct)::type_as_string' data-ref="request_state::(anonymousunion)::(anonymous)::type_as_string" data-ref-filename="request_state..(anonymousunion)..(anonymous)..type_as_string">type_as_string</a>);</td></tr>
<tr><th id="1740">1740</th><td>                <b>else</b></td></tr>
<tr><th id="1741">1741</th><td>                {</td></tr>
<tr><th id="1742">1742</th><td>                    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem" title='DNameListElem' data-type='struct DNameListElem' data-ref="DNameListElem" data-ref-filename="DNameListElem">DNameListElem</a> *<dfn class="local col3 decl" id="253p" title='p' data-type='DNameListElem *' data-ref="253p" data-ref-filename="253p">p</dfn>;</td></tr>
<tr><th id="1743">1743</th><td>                    <b>for</b> (<a class="local col3 ref" href="#253p" title='p' data-ref="253p" data-ref-filename="253p">p</a> = <a class="ref" href="uds_daemon.h.html#AutoRegistrationDomains" title='AutoRegistrationDomains' data-ref="AutoRegistrationDomains" data-ref-filename="AutoRegistrationDomains">AutoRegistrationDomains</a>; <a class="local col3 ref" href="#253p" title='p' data-ref="253p" data-ref-filename="253p">p</a>; <a class="local col3 ref" href="#253p" title='p' data-ref="253p" data-ref-filename="253p">p</a>=<a class="local col3 ref" href="#253p" title='p' data-ref="253p" data-ref-filename="253p">p</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::next" title='DNameListElem::next' data-ref="DNameListElem::next" data-ref-filename="DNameListElem..next">next</a>)</td></tr>
<tr><th id="1744">1744</th><td>                        <b>if</b> (!<a class="local col3 ref" href="#253p" title='p' data-ref="253p" data-ref-filename="253p">p</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::uid" title='DNameListElem::uid' data-ref="DNameListElem::uid" data-ref-filename="DNameListElem..uid">uid</a> || <a class="macro" href="#83" title="((request-&gt;uid) &lt;= 500)" data-ref="_M/SystemUID">SystemUID</a>(<a class="local col1 ref" href="#251request" title='request' data-ref="251request" data-ref-filename="251request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::uid" title='request_state::uid' data-ref="request_state::uid" data-ref-filename="request_state..uid">uid</a>) || <a class="local col1 ref" href="#251request" title='request' data-ref="251request" data-ref-filename="251request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::uid" title='request_state::uid' data-ref="request_state::uid" data-ref-filename="request_state..uid">uid</a> == <a class="local col3 ref" href="#253p" title='p' data-ref="253p" data-ref-filename="253p">p</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::uid" title='DNameListElem::uid' data-ref="DNameListElem::uid" data-ref-filename="DNameListElem..uid">uid</a>)</td></tr>
<tr><th id="1745">1745</th><td>                            <b>if</b> (<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#SameDomainName" title='SameDomainName' data-ref="SameDomainName" data-ref-filename="SameDomainName">SameDomainName</a>(&amp;<a class="local col9 ref" href="#249d" title='d' data-ref="249d" data-ref-filename="249d">d</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::name" title='DNameListElem::name' data-ref="DNameListElem::name" data-ref-filename="DNameListElem..name">name</a>, &amp;<a class="local col3 ref" href="#253p" title='p' data-ref="253p" data-ref-filename="253p">p</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::name" title='DNameListElem::name' data-ref="DNameListElem::name" data-ref-filename="DNameListElem..name">name</a>)) <b>break</b>;</td></tr>
<tr><th id="1746">1746</th><td>                    <b>if</b> (<a class="local col3 ref" href="#253p" title='p' data-ref="253p" data-ref-filename="253p">p</a>) <a class="macro" href="../mDNSCore/mDNSDebug.h.html#131" title="debug_noop" data-ref="_M/debugf">debugf</a>(<q>"udsserver_default_reg_domain_changed %##s still in list, not removing"</q>, &amp;d-&gt;name);</td></tr>
<tr><th id="1747">1747</th><td>                    <b>else</b></td></tr>
<tr><th id="1748">1748</th><td>                    {</td></tr>
<tr><th id="1749">1749</th><td>                        <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="local col4 decl" id="254err" title='err' data-type='mStatus' data-ref="254err" data-ref-filename="254err">err</dfn>;</td></tr>
<tr><th id="1750">1750</th><td>                        <a class="typedef" href="uds_daemon.h.html#service_instance" title='service_instance' data-type='struct service_instance' data-ref="service_instance" data-ref-filename="service_instance">service_instance</a> *<dfn class="local col5 decl" id="255si" title='si' data-type='service_instance *' data-ref="255si" data-ref-filename="255si">si</dfn> = *<a class="local col2 ref" href="#252ptr" title='ptr' data-ref="252ptr" data-ref-filename="252ptr">ptr</a>;</td></tr>
<tr><th id="1751">1751</th><td>                        *<a class="local col2 ref" href="#252ptr" title='ptr' data-ref="252ptr" data-ref-filename="252ptr">ptr</a> = <a class="local col5 ref" href="#255si" title='si' data-ref="255si" data-ref-filename="255si">si</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::next" title='service_instance::next' data-ref="service_instance::next" data-ref-filename="service_instance..next">next</a>;</td></tr>
<tr><th id="1752">1752</th><td>                        <b>if</b> (<a class="local col5 ref" href="#255si" title='si' data-ref="255si" data-ref-filename="255si">si</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::clientnotified" title='service_instance::clientnotified' data-ref="service_instance::clientnotified" data-ref-filename="service_instance..clientnotified">clientnotified</a>) <a class="ref fn" href="#SendServiceRemovalNotification" title='SendServiceRemovalNotification' data-ref="SendServiceRemovalNotification" data-ref-filename="SendServiceRemovalNotification">SendServiceRemovalNotification</a>(&amp;<a class="local col5 ref" href="#255si" title='si' data-ref="255si" data-ref-filename="255si">si</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>); <i>// Do this *before* clearing si-&gt;request backpointer</i></td></tr>
<tr><th id="1753">1753</th><td>                        <i>// Now that we've cut this service_instance from the list, we MUST clear the si-&gt;request backpointer.</i></td></tr>
<tr><th id="1754">1754</th><td><i>                        // Otherwise what can happen is this: While our mDNS_DeregisterService is in the</i></td></tr>
<tr><th id="1755">1755</th><td><i>                        // process of completing asynchronously, the client cancels the entire operation, so</i></td></tr>
<tr><th id="1756">1756</th><td><i>                        // regservice_termination_callback then runs through the whole list deregistering each</i></td></tr>
<tr><th id="1757">1757</th><td><i>                        // instance, clearing the backpointers, and then disposing the parent request_state object.</i></td></tr>
<tr><th id="1758">1758</th><td><i>                        // However, because this service_instance isn't in the list any more, regservice_termination_callback</i></td></tr>
<tr><th id="1759">1759</th><td><i>                        // has no way to find it and clear its backpointer, and then when our mDNS_DeregisterService finally</i></td></tr>
<tr><th id="1760">1760</th><td><i>                        // completes later with a mStatus_MemFree message, it calls unlink_and_free_service_instance() with</i></td></tr>
<tr><th id="1761">1761</th><td><i>                        // a service_instance with a stale si-&gt;request backpointer pointing to memory that's already been freed.</i></td></tr>
<tr><th id="1762">1762</th><td>                        <a class="local col5 ref" href="#255si" title='si' data-ref="255si" data-ref-filename="255si">si</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::request" title='service_instance::request' data-ref="service_instance::request" data-ref-filename="service_instance..request">request</a> = <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="1763">1763</th><td>                        <a class="local col4 ref" href="#254err" title='err' data-ref="254err" data-ref-filename="254err">err</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2790" title="mDNS_DeregisterService_drt((&amp;mDNSStorage), (&amp;si-&gt;srs), mDNS_Dereg_normal)" data-ref="_M/mDNS_DeregisterService">mDNS_DeregisterService</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col5 ref" href="#255si" title='si' data-ref="255si" data-ref-filename="255si">si</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>);</td></tr>
<tr><th id="1764">1764</th><td>                        <b>if</b> (<a class="local col4 ref" href="#254err" title='err' data-ref="254err" data-ref-filename="254err">err</a>) { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;udsserver_default_reg_domain_changed err %d&quot;, err)" data-ref="_M/LogMsg">LogMsg</a>(<q>"udsserver_default_reg_domain_changed err %d"</q>, <a class="local col4 ref" href="#254err" title='err' data-ref="254err" data-ref-filename="254err">err</a>); <a class="ref fn" href="#unlink_and_free_service_instance" title='unlink_and_free_service_instance' data-ref="unlink_and_free_service_instance" data-ref-filename="unlink_and_free_service_instance">unlink_and_free_service_instance</a>(<a class="local col5 ref" href="#255si" title='si' data-ref="255si" data-ref-filename="255si">si</a>); }</td></tr>
<tr><th id="1765">1765</th><td>                    }</td></tr>
<tr><th id="1766">1766</th><td>                }</td></tr>
<tr><th id="1767">1767</th><td>            }</td></tr>
<tr><th id="1768">1768</th><td>        }</td></tr>
<tr><th id="1769">1769</th><td>    }</td></tr>
<tr><th id="1770">1770</th><td>}</td></tr>
<tr><th id="1771">1771</th><td></td></tr>
<tr><th id="1772">1772</th><td><i>// Don't allow normal and anonymous registration to coexist.</i></td></tr>
<tr><th id="1773">1773</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSBool" title='mDNSBool' data-type='unsigned char' data-ref="mDNSBool" data-ref-filename="mDNSBool">mDNSBool</a> <dfn class="decl def fn" id="CheckForMixedRegistrations" title='CheckForMixedRegistrations' data-ref="CheckForMixedRegistrations" data-ref-filename="CheckForMixedRegistrations">CheckForMixedRegistrations</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#domainname" title='domainname' data-type='struct domainname' data-ref="domainname" data-ref-filename="domainname">domainname</a> *<dfn class="local col6 decl" id="256regtype" title='regtype' data-type='domainname *' data-ref="256regtype" data-ref-filename="256regtype">regtype</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#domainname" title='domainname' data-type='struct domainname' data-ref="domainname" data-ref-filename="domainname">domainname</a> *<dfn class="local col7 decl" id="257domain" title='domain' data-type='domainname *' data-ref="257domain" data-ref-filename="257domain">domain</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSBool" title='mDNSBool' data-type='unsigned char' data-ref="mDNSBool" data-ref-filename="mDNSBool">mDNSBool</a> <dfn class="local col8 decl" id="258AnonData" title='AnonData' data-type='mDNSBool' data-ref="258AnonData" data-ref-filename="258AnonData">AnonData</dfn>)</td></tr>
<tr><th id="1774">1774</th><td>{</td></tr>
<tr><th id="1775">1775</th><td>    <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col9 decl" id="259request" title='request' data-type='request_state *' data-ref="259request" data-ref-filename="259request">request</dfn>;</td></tr>
<tr><th id="1776">1776</th><td></td></tr>
<tr><th id="1777">1777</th><td>    <i>// We only care about local domains where the anonymous extension is</i></td></tr>
<tr><th id="1778">1778</th><td><i>    // implemented.</i></td></tr>
<tr><th id="1779">1779</th><td>    <b>if</b> (!<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#SameDomainName" title='SameDomainName' data-ref="SameDomainName" data-ref-filename="SameDomainName">SameDomainName</a>(<a class="local col7 ref" href="#257domain" title='domain' data-ref="257domain" data-ref-filename="257domain">domain</a>, (<em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#domainname" title='domainname' data-type='struct domainname' data-ref="domainname" data-ref-filename="domainname">domainname</a> *) <q>"\x5"</q> <q>"local"</q>))</td></tr>
<tr><th id="1780">1780</th><td>    {</td></tr>
<tr><th id="1781">1781</th><td>        <b>return</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>;</td></tr>
<tr><th id="1782">1782</th><td>    }</td></tr>
<tr><th id="1783">1783</th><td></td></tr>
<tr><th id="1784">1784</th><td>    <b>for</b> (<a class="local col9 ref" href="#259request" title='request' data-ref="259request" data-ref-filename="259request">request</a> = <a class="tu ref" href="#all_requests" title='all_requests' data-use='r' data-ref="all_requests" data-ref-filename="all_requests">all_requests</a>; <a class="local col9 ref" href="#259request" title='request' data-ref="259request" data-ref-filename="259request">request</a>; <a class="local col9 ref" href="#259request" title='request' data-ref="259request" data-ref-filename="259request">request</a> = <a class="local col9 ref" href="#259request" title='request' data-ref="259request" data-ref-filename="259request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::next" title='request_state::next' data-ref="request_state::next" data-ref-filename="request_state..next">next</a>)</td></tr>
<tr><th id="1785">1785</th><td>    {</td></tr>
<tr><th id="1786">1786</th><td>        <a class="typedef" href="uds_daemon.h.html#service_instance" title='service_instance' data-type='struct service_instance' data-ref="service_instance" data-ref-filename="service_instance">service_instance</a> *<dfn class="local col0 decl" id="260ptr" title='ptr' data-type='service_instance *' data-ref="260ptr" data-ref-filename="260ptr">ptr</dfn>;</td></tr>
<tr><th id="1787">1787</th><td></td></tr>
<tr><th id="1788">1788</th><td>        <b>if</b> (<a class="local col9 ref" href="#259request" title='request' data-ref="259request" data-ref-filename="259request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> != <a class="ref fn" href="#regservice_termination_callback" title='regservice_termination_callback' data-ref="regservice_termination_callback" data-ref-filename="regservice_termination_callback">regservice_termination_callback</a>) <b>continue</b>;</td></tr>
<tr><th id="1789">1789</th><td>        <b>for</b> (<a class="local col0 ref" href="#260ptr" title='ptr' data-ref="260ptr" data-ref-filename="260ptr">ptr</a> = <a class="local col9 ref" href="#259request" title='request' data-ref="259request" data-ref-filename="259request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::instances" title='request_state::(anonymous union)::(anonymous struct)::instances' data-ref="request_state::(anonymousunion)::(anonymous)::instances" data-ref-filename="request_state..(anonymousunion)..(anonymous)..instances">instances</a>; <a class="local col0 ref" href="#260ptr" title='ptr' data-ref="260ptr" data-ref-filename="260ptr">ptr</a> ; <a class="local col0 ref" href="#260ptr" title='ptr' data-ref="260ptr" data-ref-filename="260ptr">ptr</a> = <a class="local col0 ref" href="#260ptr" title='ptr' data-ref="260ptr" data-ref-filename="260ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::next" title='service_instance::next' data-ref="service_instance::next" data-ref-filename="service_instance..next">next</a>)</td></tr>
<tr><th id="1790">1790</th><td>        {</td></tr>
<tr><th id="1791">1791</th><td>            <b>if</b> (!<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#SameDomainName" title='SameDomainName' data-ref="SameDomainName" data-ref-filename="SameDomainName">SameDomainName</a>(&amp;<a class="local col0 ref" href="#260ptr" title='ptr' data-ref="260ptr" data-ref-filename="260ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::domain" title='service_instance::domain' data-ref="service_instance::domain" data-ref-filename="service_instance..domain">domain</a>, (<em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#domainname" title='domainname' data-type='struct domainname' data-ref="domainname" data-ref-filename="domainname">domainname</a> *)<q>"\x5"</q> <q>"local"</q>) ||</td></tr>
<tr><th id="1792">1792</th><td>                !<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#SameDomainName" title='SameDomainName' data-ref="SameDomainName" data-ref-filename="SameDomainName">SameDomainName</a>(&amp;<a class="local col9 ref" href="#259request" title='request' data-ref="259request" data-ref-filename="259request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::type" title='request_state::(anonymous union)::(anonymous struct)::type' data-ref="request_state::(anonymousunion)::(anonymous)::type" data-ref-filename="request_state..(anonymousunion)..(anonymous)..type">type</a>, <a class="local col6 ref" href="#256regtype" title='regtype' data-ref="256regtype" data-ref-filename="256regtype">regtype</a>))</td></tr>
<tr><th id="1793">1793</th><td>            {</td></tr>
<tr><th id="1794">1794</th><td>                <b>continue</b>;</td></tr>
<tr><th id="1795">1795</th><td>            }</td></tr>
<tr><th id="1796">1796</th><td></td></tr>
<tr><th id="1797">1797</th><td>            <i>// If we are about to register a anonymous registraion, we dont't want to</i></td></tr>
<tr><th id="1798">1798</th><td><i>            // allow the regular ones and vice versa.</i></td></tr>
<tr><th id="1799">1799</th><td>            <b>if</b> (<a class="local col8 ref" href="#258AnonData" title='AnonData' data-ref="258AnonData" data-ref-filename="258AnonData">AnonData</a>)</td></tr>
<tr><th id="1800">1800</th><td>            {</td></tr>
<tr><th id="1801">1801</th><td>                <b>if</b> (!<a class="local col0 ref" href="#260ptr" title='ptr' data-ref="260ptr" data-ref-filename="260ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::AnonData" title='ServiceRecordSet_struct::AnonData' data-ref="ServiceRecordSet_struct::AnonData" data-ref-filename="ServiceRecordSet_struct..AnonData">AnonData</a>)</td></tr>
<tr><th id="1802">1802</th><td>                {</td></tr>
<tr><th id="1803">1803</th><td>                    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;CheckForMixedRegistrations: Normal registration already exists for %##s&quot;, regtype-&gt;c)" data-ref="_M/LogMsg">LogMsg</a>(<q>"CheckForMixedRegistrations: Normal registration already exists for %##s"</q>, <a class="local col6 ref" href="#256regtype" title='regtype' data-ref="256regtype" data-ref-filename="256regtype">regtype</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>);</td></tr>
<tr><th id="1804">1804</th><td>                    <b>return</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>;</td></tr>
<tr><th id="1805">1805</th><td>                }</td></tr>
<tr><th id="1806">1806</th><td>            }</td></tr>
<tr><th id="1807">1807</th><td>            <b>else</b></td></tr>
<tr><th id="1808">1808</th><td>            {</td></tr>
<tr><th id="1809">1809</th><td>                <i>// Allow multiple regular registrations</i></td></tr>
<tr><th id="1810">1810</th><td>                <b>if</b> (<a class="local col0 ref" href="#260ptr" title='ptr' data-ref="260ptr" data-ref-filename="260ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::AnonData" title='ServiceRecordSet_struct::AnonData' data-ref="ServiceRecordSet_struct::AnonData" data-ref-filename="ServiceRecordSet_struct..AnonData">AnonData</a>)</td></tr>
<tr><th id="1811">1811</th><td>                {</td></tr>
<tr><th id="1812">1812</th><td>                    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;CheckForMixedRegistrations: Anonymous registration already exists for %##s&quot;, regtype-&gt;c)" data-ref="_M/LogMsg">LogMsg</a>(<q>"CheckForMixedRegistrations: Anonymous registration already exists for %##s"</q>, <a class="local col6 ref" href="#256regtype" title='regtype' data-ref="256regtype" data-ref-filename="256regtype">regtype</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>);</td></tr>
<tr><th id="1813">1813</th><td>                    <b>return</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>;</td></tr>
<tr><th id="1814">1814</th><td>                }</td></tr>
<tr><th id="1815">1815</th><td>            }</td></tr>
<tr><th id="1816">1816</th><td>        }</td></tr>
<tr><th id="1817">1817</th><td>    }</td></tr>
<tr><th id="1818">1818</th><td>    <b>return</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>;</td></tr>
<tr><th id="1819">1819</th><td>}</td></tr>
<tr><th id="1820">1820</th><td></td></tr>
<tr><th id="1821">1821</th><td><i>// Returns true if the interfaceIndex value matches one of the pre-defined</i></td></tr>
<tr><th id="1822">1822</th><td><i>// special values listed in the switch statement below.</i></td></tr>
<tr><th id="1823">1823</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSBool" title='mDNSBool' data-type='unsigned char' data-ref="mDNSBool" data-ref-filename="mDNSBool">mDNSBool</a> <dfn class="decl def fn" id="PreDefinedInterfaceIndex" title='PreDefinedInterfaceIndex' data-ref="PreDefinedInterfaceIndex" data-ref-filename="PreDefinedInterfaceIndex">PreDefinedInterfaceIndex</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col1 decl" id="261interfaceIndex" title='interfaceIndex' data-type='mDNSu32' data-ref="261interfaceIndex" data-ref-filename="261interfaceIndex">interfaceIndex</dfn>)</td></tr>
<tr><th id="1824">1824</th><td>{</td></tr>
<tr><th id="1825">1825</th><td>    <b>switch</b>(<a class="local col1 ref" href="#261interfaceIndex" title='interfaceIndex' data-ref="261interfaceIndex" data-ref-filename="261interfaceIndex">interfaceIndex</a>)</td></tr>
<tr><th id="1826">1826</th><td>    {</td></tr>
<tr><th id="1827">1827</th><td>        <b>case</b> <a class="macro" href="dns_sd.h.html#839" title="0" data-ref="_M/kDNSServiceInterfaceIndexAny">kDNSServiceInterfaceIndexAny</a>:</td></tr>
<tr><th id="1828">1828</th><td>        <b>case</b> <a class="macro" href="dns_sd.h.html#840" title="((uint32_t)-1)" data-ref="_M/kDNSServiceInterfaceIndexLocalOnly">kDNSServiceInterfaceIndexLocalOnly</a>:</td></tr>
<tr><th id="1829">1829</th><td>        <b>case</b> <a class="macro" href="dns_sd.h.html#841" title="((uint32_t)-2)" data-ref="_M/kDNSServiceInterfaceIndexUnicast">kDNSServiceInterfaceIndexUnicast</a>:</td></tr>
<tr><th id="1830">1830</th><td>        <b>case</b> <a class="macro" href="dns_sd.h.html#842" title="((uint32_t)-3)" data-ref="_M/kDNSServiceInterfaceIndexP2P">kDNSServiceInterfaceIndexP2P</a>:</td></tr>
<tr><th id="1831">1831</th><td>        <b>case</b> <a class="macro" href="dns_sd.h.html#843" title="((uint32_t)-4)" data-ref="_M/kDNSServiceInterfaceIndexBLE">kDNSServiceInterfaceIndexBLE</a>:</td></tr>
<tr><th id="1832">1832</th><td>            <b>return</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>;</td></tr>
<tr><th id="1833">1833</th><td>        <b>default</b>:</td></tr>
<tr><th id="1834">1834</th><td>            <b>return</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>;</td></tr>
<tr><th id="1835">1835</th><td>    }</td></tr>
<tr><th id="1836">1836</th><td>}</td></tr>
<tr><th id="1837">1837</th><td></td></tr>
<tr><th id="1838">1838</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="decl def fn" id="handle_regservice_request" title='handle_regservice_request' data-ref="handle_regservice_request" data-ref-filename="handle_regservice_request">handle_regservice_request</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col2 decl" id="262request" title='request' data-type='request_state *' data-ref="262request" data-ref-filename="262request">request</dfn>)</td></tr>
<tr><th id="1839">1839</th><td>{</td></tr>
<tr><th id="1840">1840</th><td>    <em>char</em> <dfn class="local col3 decl" id="263name" title='name' data-type='char [256]' data-ref="263name" data-ref-filename="263name">name</dfn>[<var>256</var>]; <i>// Lots of spare space for extra-long names that we'll auto-truncate down to 63 bytes</i></td></tr>
<tr><th id="1841">1841</th><td>    <em>char</em> <dfn class="local col4 decl" id="264domain" title='domain' data-type='char [1009]' data-ref="264domain" data-ref-filename="264domain">domain</dfn>[<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#417" title="1009" data-ref="_M/MAX_ESCAPED_DOMAIN_NAME">MAX_ESCAPED_DOMAIN_NAME</a>], <dfn class="local col5 decl" id="265host" title='host' data-type='char [1009]' data-ref="265host" data-ref-filename="265host">host</dfn>[<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#417" title="1009" data-ref="_M/MAX_ESCAPED_DOMAIN_NAME">MAX_ESCAPED_DOMAIN_NAME</a>];</td></tr>
<tr><th id="1842">1842</th><td>    <em>char</em> <dfn class="local col6 decl" id="266type_as_string" title='type_as_string' data-type='char [1009]' data-ref="266type_as_string" data-ref-filename="266type_as_string">type_as_string</dfn>[<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#417" title="1009" data-ref="_M/MAX_ESCAPED_DOMAIN_NAME">MAX_ESCAPED_DOMAIN_NAME</a>];</td></tr>
<tr><th id="1843">1843</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#domainname" title='domainname' data-type='struct domainname' data-ref="domainname" data-ref-filename="domainname">domainname</a> <dfn class="local col7 decl" id="267d" title='d' data-type='domainname' data-ref="267d" data-ref-filename="267d">d</dfn>, <dfn class="local col8 decl" id="268srv" title='srv' data-type='domainname' data-ref="268srv" data-ref-filename="268srv">srv</dfn>;</td></tr>
<tr><th id="1844">1844</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="local col9 decl" id="269err" title='err' data-type='mStatus' data-ref="269err" data-ref-filename="269err">err</dfn>;</td></tr>
<tr><th id="1845">1845</th><td>    <em>char</em> *<dfn class="local col0 decl" id="270AnonData" title='AnonData' data-type='char *' data-ref="270AnonData" data-ref-filename="270AnonData">AnonData</dfn> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="1846">1846</th><td>    <em>const</em> <em>char</em> *<dfn class="local col1 decl" id="271msgTXTData" title='msgTXTData' data-type='const char *' data-ref="271msgTXTData" data-ref-filename="271msgTXTData">msgTXTData</dfn>;</td></tr>
<tr><th id="1847">1847</th><td></td></tr>
<tr><th id="1848">1848</th><td>    <a class="typedef" href="dns_sd.h.html#DNSServiceFlags" title='DNSServiceFlags' data-type='uint32_t' data-ref="DNSServiceFlags" data-ref-filename="DNSServiceFlags">DNSServiceFlags</a> <dfn class="local col2 decl" id="272flags" title='flags' data-type='DNSServiceFlags' data-ref="272flags" data-ref-filename="272flags">flags</dfn> = <a class="macro" href="dnssd_ipc.h.html#210" title="__dnssd_ipc_get_uint32" data-ref="_M/get_flags">get_flags</a>(&amp;<a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);</td></tr>
<tr><th id="1849">1849</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col3 decl" id="273interfaceIndex" title='interfaceIndex' data-type='mDNSu32' data-ref="273interfaceIndex" data-ref-filename="273interfaceIndex">interfaceIndex</dfn> = <a class="macro" href="dnssd_ipc.h.html#194" title="__dnssd_ipc_get_uint32" data-ref="_M/get_uint32">get_uint32</a>(&amp;<a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);</td></tr>
<tr><th id="1850">1850</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterfaceID" title='mDNSInterfaceID' data-type='struct mDNSInterfaceID_dummystruct *' data-ref="mDNSInterfaceID" data-ref-filename="mDNSInterfaceID">mDNSInterfaceID</a> <dfn class="local col4 decl" id="274InterfaceID" title='InterfaceID' data-type='mDNSInterfaceID' data-ref="274InterfaceID" data-ref-filename="274InterfaceID">InterfaceID</dfn>;</td></tr>
<tr><th id="1851">1851</th><td></td></tr>
<tr><th id="1852">1852</th><td>    <i>// Map kDNSServiceInterfaceIndexP2P to kDNSServiceInterfaceIndexAny with the </i></td></tr>
<tr><th id="1853">1853</th><td><i>    // kDNSServiceFlagsIncludeP2P flag set.</i></td></tr>
<tr><th id="1854">1854</th><td>    <b>if</b> (<a class="local col3 ref" href="#273interfaceIndex" title='interfaceIndex' data-ref="273interfaceIndex" data-ref-filename="273interfaceIndex">interfaceIndex</a> == <a class="macro" href="dns_sd.h.html#842" title="((uint32_t)-3)" data-ref="_M/kDNSServiceInterfaceIndexP2P">kDNSServiceInterfaceIndexP2P</a>)</td></tr>
<tr><th id="1855">1855</th><td>    {</td></tr>
<tr><th id="1856">1856</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;handle_regservice_request: mapping kDNSServiceInterfaceIndexP2P to kDNSServiceInterfaceIndexAny + kDNSServiceFlagsIncludeP2P&quot;);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"handle_regservice_request: mapping kDNSServiceInterfaceIndexP2P to kDNSServiceInterfaceIndexAny + kDNSServiceFlagsIncludeP2P"</q>);</td></tr>
<tr><th id="1857">1857</th><td>        <a class="local col2 ref" href="#272flags" title='flags' data-ref="272flags" data-ref-filename="272flags">flags</a> |= <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsIncludeP2P" title='kDNSServiceFlagsIncludeP2P' data-ref="kDNSServiceFlagsIncludeP2P" data-ref-filename="kDNSServiceFlagsIncludeP2P">kDNSServiceFlagsIncludeP2P</a>;</td></tr>
<tr><th id="1858">1858</th><td>        <a class="local col3 ref" href="#273interfaceIndex" title='interfaceIndex' data-ref="273interfaceIndex" data-ref-filename="273interfaceIndex">interfaceIndex</a> = <a class="macro" href="dns_sd.h.html#839" title="0" data-ref="_M/kDNSServiceInterfaceIndexAny">kDNSServiceInterfaceIndexAny</a>;</td></tr>
<tr><th id="1859">1859</th><td>    }</td></tr>
<tr><th id="1860">1860</th><td></td></tr>
<tr><th id="1861">1861</th><td>    <a class="local col4 ref" href="#274InterfaceID" title='InterfaceID' data-ref="274InterfaceID" data-ref-filename="274InterfaceID">InterfaceID</a> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformInterfaceIDfromInterfaceIndex" title='mDNSPlatformInterfaceIDfromInterfaceIndex' data-ref="mDNSPlatformInterfaceIDfromInterfaceIndex" data-ref-filename="mDNSPlatformInterfaceIDfromInterfaceIndex">mDNSPlatformInterfaceIDfromInterfaceIndex</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col3 ref" href="#273interfaceIndex" title='interfaceIndex' data-ref="273interfaceIndex" data-ref-filename="273interfaceIndex">interfaceIndex</a>);</td></tr>
<tr><th id="1862">1862</th><td></td></tr>
<tr><th id="1863">1863</th><td>    <i>// The registration is scoped to a specific interface index, but the </i></td></tr>
<tr><th id="1864">1864</th><td><i>    // interface is not currently in our list.</i></td></tr>
<tr><th id="1865">1865</th><td>    <b>if</b> (<a class="local col3 ref" href="#273interfaceIndex" title='interfaceIndex' data-ref="273interfaceIndex" data-ref-filename="273interfaceIndex">interfaceIndex</a> &amp;&amp; !<a class="local col4 ref" href="#274InterfaceID" title='InterfaceID' data-ref="274InterfaceID" data-ref-filename="274InterfaceID">InterfaceID</a>)</td></tr>
<tr><th id="1866">1866</th><td>    {</td></tr>
<tr><th id="1867">1867</th><td>        <i>// If it's one of the specially defined inteface index values, just return an error.</i></td></tr>
<tr><th id="1868">1868</th><td>        <b>if</b> (<a class="ref fn" href="#PreDefinedInterfaceIndex" title='PreDefinedInterfaceIndex' data-ref="PreDefinedInterfaceIndex" data-ref-filename="PreDefinedInterfaceIndex">PreDefinedInterfaceIndex</a>(<a class="local col3 ref" href="#273interfaceIndex" title='interfaceIndex' data-ref="273interfaceIndex" data-ref-filename="273interfaceIndex">interfaceIndex</a>))</td></tr>
<tr><th id="1869">1869</th><td>        {</td></tr>
<tr><th id="1870">1870</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;handle_regservice_request: bad interfaceIndex %d&quot;, interfaceIndex);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"handle_regservice_request: bad interfaceIndex %d"</q>, <a class="local col3 ref" href="#273interfaceIndex" title='interfaceIndex' data-ref="273interfaceIndex" data-ref-filename="273interfaceIndex">interfaceIndex</a>);</td></tr>
<tr><th id="1871">1871</th><td>            <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>);</td></tr>
<tr><th id="1872">1872</th><td>        }</td></tr>
<tr><th id="1873">1873</th><td></td></tr>
<tr><th id="1874">1874</th><td>        <i>// Otherwise, use the specified interface index value and the registration will</i></td></tr>
<tr><th id="1875">1875</th><td><i>        // be applied to that interface when it comes up.</i></td></tr>
<tr><th id="1876">1876</th><td>        <a class="local col4 ref" href="#274InterfaceID" title='InterfaceID' data-ref="274InterfaceID" data-ref-filename="274InterfaceID">InterfaceID</a> = (<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterfaceID" title='mDNSInterfaceID' data-type='struct mDNSInterfaceID_dummystruct *' data-ref="mDNSInterfaceID" data-ref-filename="mDNSInterfaceID">mDNSInterfaceID</a>)(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/stdint.h.html#uintptr_t" title='uintptr_t' data-type='__uintptr_t' data-ref="uintptr_t" data-ref-filename="uintptr_t">uintptr_t</a>)<a class="local col3 ref" href="#273interfaceIndex" title='interfaceIndex' data-ref="273interfaceIndex" data-ref-filename="273interfaceIndex">interfaceIndex</a>;</td></tr>
<tr><th id="1877">1877</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;handle_regservice_request: registration pending for interface index %d&quot;, interfaceIndex);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"handle_regservice_request: registration pending for interface index %d"</q>, <a class="local col3 ref" href="#273interfaceIndex" title='interfaceIndex' data-ref="273interfaceIndex" data-ref-filename="273interfaceIndex">interfaceIndex</a>);</td></tr>
<tr><th id="1878">1878</th><td>    }</td></tr>
<tr><th id="1879">1879</th><td></td></tr>
<tr><th id="1880">1880</th><td>    <b>if</b> (<a class="macro" href="dnssd_ipc.h.html#198" title="__dnssd_ipc_get_string" data-ref="_M/get_string">get_string</a>(&amp;<a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>, <a class="local col3 ref" href="#263name" title='name' data-ref="263name" data-ref-filename="263name">name</a>, <b>sizeof</b>(<a class="local col3 ref" href="#263name" title='name' data-ref="263name" data-ref-filename="263name">name</a>)) &lt; <var>0</var> ||</td></tr>
<tr><th id="1881">1881</th><td>        <a class="macro" href="dnssd_ipc.h.html#198" title="__dnssd_ipc_get_string" data-ref="_M/get_string">get_string</a>(&amp;<a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>, <a class="local col6 ref" href="#266type_as_string" title='type_as_string' data-ref="266type_as_string" data-ref-filename="266type_as_string">type_as_string</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#417" title="1009" data-ref="_M/MAX_ESCAPED_DOMAIN_NAME">MAX_ESCAPED_DOMAIN_NAME</a>) &lt; <var>0</var> ||</td></tr>
<tr><th id="1882">1882</th><td>        <a class="macro" href="dnssd_ipc.h.html#198" title="__dnssd_ipc_get_string" data-ref="_M/get_string">get_string</a>(&amp;<a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>, <a class="local col4 ref" href="#264domain" title='domain' data-ref="264domain" data-ref-filename="264domain">domain</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#417" title="1009" data-ref="_M/MAX_ESCAPED_DOMAIN_NAME">MAX_ESCAPED_DOMAIN_NAME</a>) &lt; <var>0</var> ||</td></tr>
<tr><th id="1883">1883</th><td>        <a class="macro" href="dnssd_ipc.h.html#198" title="__dnssd_ipc_get_string" data-ref="_M/get_string">get_string</a>(&amp;<a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>, <a class="local col5 ref" href="#265host" title='host' data-ref="265host" data-ref-filename="265host">host</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#417" title="1009" data-ref="_M/MAX_ESCAPED_DOMAIN_NAME">MAX_ESCAPED_DOMAIN_NAME</a>) &lt; <var>0</var>)</td></tr>
<tr><th id="1884">1884</th><td>    { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;ERROR: handle_regservice_request - Couldn&apos;t read name/regtype/domain&quot;)" data-ref="_M/LogMsg">LogMsg</a>(<q>"ERROR: handle_regservice_request - Couldn't read name/regtype/domain"</q>); <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>); }</td></tr>
<tr><th id="1885">1885</th><td></td></tr>
<tr><th id="1886">1886</th><td>    <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a> = <a class="local col2 ref" href="#272flags" title='flags' data-ref="272flags" data-ref-filename="272flags">flags</a>;</td></tr>
<tr><th id="1887">1887</th><td>    <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::interfaceIndex" title='request_state::interfaceIndex' data-ref="request_state::interfaceIndex" data-ref-filename="request_state..interfaceIndex">interfaceIndex</a> = <a class="local col3 ref" href="#273interfaceIndex" title='interfaceIndex' data-ref="273interfaceIndex" data-ref-filename="273interfaceIndex">interfaceIndex</a>;</td></tr>
<tr><th id="1888">1888</th><td>    <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::InterfaceID" title='request_state::(anonymous union)::(anonymous struct)::InterfaceID' data-ref="request_state::(anonymousunion)::(anonymous)::InterfaceID" data-ref-filename="request_state..(anonymousunion)..(anonymous)..InterfaceID">InterfaceID</a> = <a class="local col4 ref" href="#274InterfaceID" title='InterfaceID' data-ref="274InterfaceID" data-ref-filename="274InterfaceID">InterfaceID</a>;</td></tr>
<tr><th id="1889">1889</th><td>    <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::instances" title='request_state::(anonymous union)::(anonymous struct)::instances' data-ref="request_state::(anonymousunion)::(anonymous)::instances" data-ref-filename="request_state..(anonymousunion)..(anonymous)..instances">instances</a> = <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="1890">1890</th><td>    <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txtlen" title='request_state::(anonymous union)::(anonymous struct)::txtlen' data-ref="request_state::(anonymousunion)::(anonymous)::txtlen" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txtlen">txtlen</a>  = <var>0</var>;</td></tr>
<tr><th id="1891">1891</th><td>    <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txtdata" title='request_state::(anonymous union)::(anonymous struct)::txtdata' data-ref="request_state::(anonymousunion)::(anonymous)::txtdata" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txtdata">txtdata</a> = <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="1892">1892</th><td>    <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformStrLCopy" title='mDNSPlatformStrLCopy' data-ref="mDNSPlatformStrLCopy" data-ref-filename="mDNSPlatformStrLCopy">mDNSPlatformStrLCopy</a>(<a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::type_as_string" title='request_state::(anonymous union)::(anonymous struct)::type_as_string' data-ref="request_state::(anonymousunion)::(anonymous)::type_as_string" data-ref-filename="request_state..(anonymousunion)..(anonymous)..type_as_string">type_as_string</a>, <a class="local col6 ref" href="#266type_as_string" title='type_as_string' data-ref="266type_as_string" data-ref-filename="266type_as_string">type_as_string</a>, <b>sizeof</b>(<a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::type_as_string" title='request_state::(anonymous union)::(anonymous struct)::type_as_string' data-ref="request_state::(anonymousunion)::(anonymous)::type_as_string" data-ref-filename="request_state..(anonymousunion)..(anonymous)..type_as_string">type_as_string</a>));</td></tr>
<tr><th id="1893">1893</th><td></td></tr>
<tr><th id="1894">1894</th><td>    <b>if</b> (<a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a> + <var>2</var> &gt; <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>) <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a> = <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="1895">1895</th><td>    <b>else</b></td></tr>
<tr><th id="1896">1896</th><td>    {</td></tr>
<tr><th id="1897">1897</th><td>        <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::port" title='request_state::(anonymous union)::(anonymous struct)::port' data-ref="request_state::(anonymousunion)::(anonymous)::port" data-ref-filename="request_state..(anonymousunion)..(anonymous)..port">port</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::b" title='(anonymous union)::b' data-ref="(anonymous)::b" data-ref-filename="(anonymous)..b">b</a>[<var>0</var>] = *<a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>++;</td></tr>
<tr><th id="1898">1898</th><td>        <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::port" title='request_state::(anonymous union)::(anonymous struct)::port' data-ref="request_state::(anonymousunion)::(anonymous)::port" data-ref-filename="request_state..(anonymousunion)..(anonymous)..port">port</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::b" title='(anonymous union)::b' data-ref="(anonymous)::b" data-ref-filename="(anonymous)..b">b</a>[<var>1</var>] = *<a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>++;</td></tr>
<tr><th id="1899">1899</th><td>    }</td></tr>
<tr><th id="1900">1900</th><td></td></tr>
<tr><th id="1901">1901</th><td>    <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txtlen" title='request_state::(anonymous union)::(anonymous struct)::txtlen' data-ref="request_state::(anonymousunion)::(anonymous)::txtlen" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txtlen">txtlen</a> = <a class="macro" href="dnssd_ipc.h.html#196" title="__dnssd_ipc_get_uint16" data-ref="_M/get_uint16">get_uint16</a>(&amp;<a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);</td></tr>
<tr><th id="1902">1902</th><td>    <a class="local col1 ref" href="#271msgTXTData" title='msgTXTData' data-ref="271msgTXTData" data-ref-filename="271msgTXTData">msgTXTData</a> = <a class="macro" href="dnssd_ipc.h.html#200" title="__dnssd_ipc_get_rdata" data-ref="_M/get_rdata">get_rdata</a>(&amp;<a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>, <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txtlen" title='request_state::(anonymous union)::(anonymous struct)::txtlen' data-ref="request_state::(anonymousunion)::(anonymous)::txtlen" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txtlen">txtlen</a>);</td></tr>
<tr><th id="1903">1903</th><td></td></tr>
<tr><th id="1904">1904</th><td>    <b>if</b> (!<a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>) { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: DNSServiceRegister(unreadable parameters)&quot;, request-&gt;sd)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: DNSServiceRegister(unreadable parameters)"</q>, <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>); <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>); }</td></tr>
<tr><th id="1905">1905</th><td></td></tr>
<tr><th id="1906">1906</th><td>    <b>if</b> (<a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txtlen" title='request_state::(anonymous union)::(anonymous struct)::txtlen' data-ref="request_state::(anonymousunion)::(anonymous)::txtlen" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txtlen">txtlen</a>)</td></tr>
<tr><th id="1907">1907</th><td>    {</td></tr>
<tr><th id="1908">1908</th><td>        <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txtdata" title='request_state::(anonymous union)::(anonymous struct)::txtdata' data-ref="request_state::(anonymousunion)::(anonymous)::txtdata" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txtdata">txtdata</a> = <a class="macro" href="../mDNSCore/mDNSDebug.h.html#166" title="malloc(request-&gt;u.servicereg.txtlen)" data-ref="_M/mallocL">mallocL</a>(<q>"service_info txtdata"</q>, <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txtlen" title='request_state::(anonymous union)::(anonymous struct)::txtlen' data-ref="request_state::(anonymousunion)::(anonymous)::txtlen" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txtlen">txtlen</a>);</td></tr>
<tr><th id="1909">1909</th><td>        <b>if</b> (!<a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txtdata" title='request_state::(anonymous union)::(anonymous struct)::txtdata' data-ref="request_state::(anonymousunion)::(anonymous)::txtdata" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txtdata">txtdata</a>) <a class="ref fn" href="#FatalError" title='FatalError' data-ref="FatalError" data-ref-filename="FatalError">FatalError</a>(<q>"ERROR: handle_regservice_request - malloc"</q>);</td></tr>
<tr><th id="1910">1910</th><td>        <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformMemCopy" title='mDNSPlatformMemCopy' data-ref="mDNSPlatformMemCopy" data-ref-filename="mDNSPlatformMemCopy">mDNSPlatformMemCopy</a>(<a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txtdata" title='request_state::(anonymous union)::(anonymous struct)::txtdata' data-ref="request_state::(anonymousunion)::(anonymous)::txtdata" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txtdata">txtdata</a>, <a class="local col1 ref" href="#271msgTXTData" title='msgTXTData' data-ref="271msgTXTData" data-ref-filename="271msgTXTData">msgTXTData</a>, <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txtlen" title='request_state::(anonymous union)::(anonymous struct)::txtlen' data-ref="request_state::(anonymousunion)::(anonymous)::txtlen" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txtlen">txtlen</a>);</td></tr>
<tr><th id="1911">1911</th><td>    }</td></tr>
<tr><th id="1912">1912</th><td></td></tr>
<tr><th id="1913">1913</th><td>    <i>// Check for sub-types after the service type</i></td></tr>
<tr><th id="1914">1914</th><td>    <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::num_subtypes" title='request_state::(anonymous union)::(anonymous struct)::num_subtypes' data-ref="request_state::(anonymousunion)::(anonymous)::num_subtypes" data-ref-filename="request_state..(anonymousunion)..(anonymous)..num_subtypes">num_subtypes</a> = <a class="ref fn" href="#ChopSubTypes" title='ChopSubTypes' data-ref="ChopSubTypes" data-ref-filename="ChopSubTypes">ChopSubTypes</a>(<a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::type_as_string" title='request_state::(anonymous union)::(anonymous struct)::type_as_string' data-ref="request_state::(anonymousunion)::(anonymous)::type_as_string" data-ref-filename="request_state..(anonymousunion)..(anonymous)..type_as_string">type_as_string</a>, &amp;<a class="local col0 ref" href="#270AnonData" title='AnonData' data-ref="270AnonData" data-ref-filename="270AnonData">AnonData</a>);    <i>// Note: Modifies regtype string to remove trailing subtypes</i></td></tr>
<tr><th id="1915">1915</th><td>    <b>if</b> (<a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::num_subtypes" title='request_state::(anonymous union)::(anonymous struct)::num_subtypes' data-ref="request_state::(anonymousunion)::(anonymous)::num_subtypes" data-ref-filename="request_state..(anonymousunion)..(anonymous)..num_subtypes">num_subtypes</a> &lt; <var>0</var>)</td></tr>
<tr><th id="1916">1916</th><td>    {</td></tr>
<tr><th id="1917">1917</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;ERROR: handle_regservice_request - ChopSubTypes failed %s&quot;, request-&gt;u.servicereg.type_as_string)" data-ref="_M/LogMsg">LogMsg</a>(<q>"ERROR: handle_regservice_request - ChopSubTypes failed %s"</q>, <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::type_as_string" title='request_state::(anonymous union)::(anonymous struct)::type_as_string' data-ref="request_state::(anonymousunion)::(anonymous)::type_as_string" data-ref-filename="request_state..(anonymousunion)..(anonymous)..type_as_string">type_as_string</a>);</td></tr>
<tr><th id="1918">1918</th><td>        <b>goto</b> <a class="lbl" href="#275bad_param" data-ref="275bad_param" data-ref-filename="275bad_param">bad_param</a>;</td></tr>
<tr><th id="1919">1919</th><td>    }</td></tr>
<tr><th id="1920">1920</th><td>    <b>if</b> (<a class="local col0 ref" href="#270AnonData" title='AnonData' data-ref="270AnonData" data-ref-filename="270AnonData">AnonData</a>)</td></tr>
<tr><th id="1921">1921</th><td>    {</td></tr>
<tr><th id="1922">1922</th><td>        <em>int</em> <dfn class="local col6 decl" id="276AnonDataLen" title='AnonDataLen' data-type='int' data-ref="276AnonDataLen" data-ref-filename="276AnonDataLen">AnonDataLen</dfn> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strlen" title='strlen' data-ref="strlen" data-ref-filename="strlen">strlen</a>(<a class="local col0 ref" href="#270AnonData" title='AnonData' data-ref="270AnonData" data-ref-filename="270AnonData">AnonData</a>);</td></tr>
<tr><th id="1923">1923</th><td>        <b>if</b> (<a class="local col6 ref" href="#276AnonDataLen" title='AnonDataLen' data-ref="276AnonDataLen" data-ref-filename="276AnonDataLen">AnonDataLen</a> &gt; <a class="macro" href="#85" title="256" data-ref="_M/MAX_ANONYMOUS_DATA">MAX_ANONYMOUS_DATA</a>)</td></tr>
<tr><th id="1924">1924</th><td>        {</td></tr>
<tr><th id="1925">1925</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;ERROR: handle_regservice_request: AnonDataLen %d&quot;, AnonDataLen)" data-ref="_M/LogMsg">LogMsg</a>(<q>"ERROR: handle_regservice_request: AnonDataLen %d"</q>, <a class="local col6 ref" href="#276AnonDataLen" title='AnonDataLen' data-ref="276AnonDataLen" data-ref-filename="276AnonDataLen">AnonDataLen</a>);</td></tr>
<tr><th id="1926">1926</th><td>            <b>goto</b> <a class="lbl" href="#275bad_param" data-ref="275bad_param" data-ref-filename="275bad_param">bad_param</a>;</td></tr>
<tr><th id="1927">1927</th><td>        }</td></tr>
<tr><th id="1928">1928</th><td>        <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::AnonData" title='request_state::(anonymous union)::(anonymous struct)::AnonData' data-ref="request_state::(anonymousunion)::(anonymous)::AnonData" data-ref-filename="request_state..(anonymousunion)..(anonymous)..AnonData">AnonData</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>;</td></tr>
<tr><th id="1929">1929</th><td>    }</td></tr>
<tr><th id="1930">1930</th><td>    <b>else</b></td></tr>
<tr><th id="1931">1931</th><td>    {</td></tr>
<tr><th id="1932">1932</th><td>        <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::AnonData" title='request_state::(anonymous union)::(anonymous struct)::AnonData' data-ref="request_state::(anonymousunion)::(anonymous)::AnonData" data-ref-filename="request_state..(anonymousunion)..(anonymous)..AnonData">AnonData</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>;</td></tr>
<tr><th id="1933">1933</th><td>    }</td></tr>
<tr><th id="1934">1934</th><td></td></tr>
<tr><th id="1935">1935</th><td>    <i>// Don't try to construct "domainname t" until *after* ChopSubTypes has worked its magic</i></td></tr>
<tr><th id="1936">1936</th><td>    <b>if</b> (!*<a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::type_as_string" title='request_state::(anonymous union)::(anonymous struct)::type_as_string' data-ref="request_state::(anonymousunion)::(anonymous)::type_as_string" data-ref-filename="request_state..(anonymousunion)..(anonymous)..type_as_string">type_as_string</a> || !<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#MakeDomainNameFromDNSNameString" title='MakeDomainNameFromDNSNameString' data-ref="MakeDomainNameFromDNSNameString" data-ref-filename="MakeDomainNameFromDNSNameString">MakeDomainNameFromDNSNameString</a>(&amp;<a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::type" title='request_state::(anonymous union)::(anonymous struct)::type' data-ref="request_state::(anonymousunion)::(anonymous)::type" data-ref-filename="request_state..(anonymousunion)..(anonymous)..type">type</a>, <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::type_as_string" title='request_state::(anonymous union)::(anonymous struct)::type_as_string' data-ref="request_state::(anonymousunion)::(anonymous)::type_as_string" data-ref-filename="request_state..(anonymousunion)..(anonymous)..type_as_string">type_as_string</a>))</td></tr>
<tr><th id="1937">1937</th><td>    { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;ERROR: handle_regservice_request - type_as_string bad %s&quot;, request-&gt;u.servicereg.type_as_string)" data-ref="_M/LogMsg">LogMsg</a>(<q>"ERROR: handle_regservice_request - type_as_string bad %s"</q>, <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::type_as_string" title='request_state::(anonymous union)::(anonymous struct)::type_as_string' data-ref="request_state::(anonymousunion)::(anonymous)::type_as_string" data-ref-filename="request_state..(anonymousunion)..(anonymous)..type_as_string">type_as_string</a>); <b>goto</b> <a class="lbl" href="#275bad_param" data-ref="275bad_param" data-ref-filename="275bad_param">bad_param</a>; }</td></tr>
<tr><th id="1938">1938</th><td></td></tr>
<tr><th id="1939">1939</th><td>    <b>if</b> (!<a class="local col3 ref" href="#263name" title='name' data-ref="263name" data-ref-filename="263name">name</a>[<var>0</var>])</td></tr>
<tr><th id="1940">1940</th><td>    {</td></tr>
<tr><th id="1941">1941</th><td>        <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::name" title='request_state::(anonymous union)::(anonymous struct)::name' data-ref="request_state::(anonymousunion)::(anonymous)::name" data-ref-filename="request_state..(anonymousunion)..(anonymous)..name">name</a> = <a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::nicelabel" title='mDNS_struct::nicelabel' data-ref="mDNS_struct::nicelabel" data-ref-filename="mDNS_struct..nicelabel">nicelabel</a>;</td></tr>
<tr><th id="1942">1942</th><td>        <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::autoname" title='request_state::(anonymous union)::(anonymous struct)::autoname' data-ref="request_state::(anonymousunion)::(anonymous)::autoname" data-ref-filename="request_state..(anonymousunion)..(anonymous)..autoname">autoname</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>;</td></tr>
<tr><th id="1943">1943</th><td>    }</td></tr>
<tr><th id="1944">1944</th><td>    <b>else</b></td></tr>
<tr><th id="1945">1945</th><td>    {</td></tr>
<tr><th id="1946">1946</th><td>        <i>// If the client is allowing AutoRename, then truncate name to legal length before converting it to a DomainLabel</i></td></tr>
<tr><th id="1947">1947</th><td>        <b>if</b> ((<a class="local col2 ref" href="#272flags" title='flags' data-ref="272flags" data-ref-filename="272flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsNoAutoRename" title='kDNSServiceFlagsNoAutoRename' data-ref="kDNSServiceFlagsNoAutoRename" data-ref-filename="kDNSServiceFlagsNoAutoRename">kDNSServiceFlagsNoAutoRename</a>) == <var>0</var>)</td></tr>
<tr><th id="1948">1948</th><td>        {</td></tr>
<tr><th id="1949">1949</th><td>            <em>int</em> <dfn class="local col7 decl" id="277newlen" title='newlen' data-type='int' data-ref="277newlen" data-ref-filename="277newlen">newlen</dfn> = <a class="ref fn" href="../mDNSCore/DNSCommon.h.html#TruncateUTF8ToLength" title='TruncateUTF8ToLength' data-ref="TruncateUTF8ToLength" data-ref-filename="TruncateUTF8ToLength">TruncateUTF8ToLength</a>((<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu8" title='mDNSu8' data-type='unsigned char' data-ref="mDNSu8" data-ref-filename="mDNSu8">mDNSu8</a>*)<a class="local col3 ref" href="#263name" title='name' data-ref="263name" data-ref-filename="263name">name</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformStrLen" title='mDNSPlatformStrLen' data-ref="mDNSPlatformStrLen" data-ref-filename="mDNSPlatformStrLen">mDNSPlatformStrLen</a>(<a class="local col3 ref" href="#263name" title='name' data-ref="263name" data-ref-filename="263name">name</a>), <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#394" title="63" data-ref="_M/MAX_DOMAIN_LABEL">MAX_DOMAIN_LABEL</a>);</td></tr>
<tr><th id="1950">1950</th><td>            <a class="local col3 ref" href="#263name" title='name' data-ref="263name" data-ref-filename="263name">name</a>[<a class="local col7 ref" href="#277newlen" title='newlen' data-ref="277newlen" data-ref-filename="277newlen">newlen</a>] = <var>0</var>;</td></tr>
<tr><th id="1951">1951</th><td>        }</td></tr>
<tr><th id="1952">1952</th><td>        <b>if</b> (!<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#MakeDomainLabelFromLiteralString" title='MakeDomainLabelFromLiteralString' data-ref="MakeDomainLabelFromLiteralString" data-ref-filename="MakeDomainLabelFromLiteralString">MakeDomainLabelFromLiteralString</a>(&amp;<a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::name" title='request_state::(anonymous union)::(anonymous struct)::name' data-ref="request_state::(anonymousunion)::(anonymous)::name" data-ref-filename="request_state..(anonymousunion)..(anonymous)..name">name</a>, <a class="local col3 ref" href="#263name" title='name' data-ref="263name" data-ref-filename="263name">name</a>))</td></tr>
<tr><th id="1953">1953</th><td>        { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;ERROR: handle_regservice_request - name bad %s&quot;, name)" data-ref="_M/LogMsg">LogMsg</a>(<q>"ERROR: handle_regservice_request - name bad %s"</q>, <a class="local col3 ref" href="#263name" title='name' data-ref="263name" data-ref-filename="263name">name</a>); <b>goto</b> <a class="lbl" href="#275bad_param" data-ref="275bad_param" data-ref-filename="275bad_param">bad_param</a>; }</td></tr>
<tr><th id="1954">1954</th><td>        <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::autoname" title='request_state::(anonymous union)::(anonymous struct)::autoname' data-ref="request_state::(anonymousunion)::(anonymous)::autoname" data-ref-filename="request_state..(anonymousunion)..(anonymous)..autoname">autoname</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>;</td></tr>
<tr><th id="1955">1955</th><td>    }</td></tr>
<tr><th id="1956">1956</th><td></td></tr>
<tr><th id="1957">1957</th><td>    <b>if</b> (*<a class="local col4 ref" href="#264domain" title='domain' data-ref="264domain" data-ref-filename="264domain">domain</a>)</td></tr>
<tr><th id="1958">1958</th><td>    {</td></tr>
<tr><th id="1959">1959</th><td>        <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::default_domain" title='request_state::(anonymous union)::(anonymous struct)::default_domain' data-ref="request_state::(anonymousunion)::(anonymous)::default_domain" data-ref-filename="request_state..(anonymousunion)..(anonymous)..default_domain">default_domain</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>;</td></tr>
<tr><th id="1960">1960</th><td>        <b>if</b> (!<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#MakeDomainNameFromDNSNameString" title='MakeDomainNameFromDNSNameString' data-ref="MakeDomainNameFromDNSNameString" data-ref-filename="MakeDomainNameFromDNSNameString">MakeDomainNameFromDNSNameString</a>(&amp;<a class="local col7 ref" href="#267d" title='d' data-ref="267d" data-ref-filename="267d">d</a>, <a class="local col4 ref" href="#264domain" title='domain' data-ref="264domain" data-ref-filename="264domain">domain</a>))</td></tr>
<tr><th id="1961">1961</th><td>        { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;ERROR: handle_regservice_request - domain bad %s&quot;, domain)" data-ref="_M/LogMsg">LogMsg</a>(<q>"ERROR: handle_regservice_request - domain bad %s"</q>, <a class="local col4 ref" href="#264domain" title='domain' data-ref="264domain" data-ref-filename="264domain">domain</a>); <b>goto</b> <a class="lbl" href="#275bad_param" data-ref="275bad_param" data-ref-filename="275bad_param">bad_param</a>; }</td></tr>
<tr><th id="1962">1962</th><td>    }</td></tr>
<tr><th id="1963">1963</th><td>    <b>else</b></td></tr>
<tr><th id="1964">1964</th><td>    {</td></tr>
<tr><th id="1965">1965</th><td>        <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::default_domain" title='request_state::(anonymous union)::(anonymous struct)::default_domain' data-ref="request_state::(anonymousunion)::(anonymous)::default_domain" data-ref-filename="request_state..(anonymousunion)..(anonymous)..default_domain">default_domain</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>;</td></tr>
<tr><th id="1966">1966</th><td>        <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#MakeDomainNameFromDNSNameString" title='MakeDomainNameFromDNSNameString' data-ref="MakeDomainNameFromDNSNameString" data-ref-filename="MakeDomainNameFromDNSNameString">MakeDomainNameFromDNSNameString</a>(&amp;<a class="local col7 ref" href="#267d" title='d' data-ref="267d" data-ref-filename="267d">d</a>, <q>"local."</q>);</td></tr>
<tr><th id="1967">1967</th><td>    }</td></tr>
<tr><th id="1968">1968</th><td></td></tr>
<tr><th id="1969">1969</th><td>    <i>// We don't allow the anonymous and the regular ones to coexist</i></td></tr>
<tr><th id="1970">1970</th><td>    <b>if</b> (!<a class="ref fn" href="#CheckForMixedRegistrations" title='CheckForMixedRegistrations' data-ref="CheckForMixedRegistrations" data-ref-filename="CheckForMixedRegistrations">CheckForMixedRegistrations</a>(&amp;<a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::type" title='request_state::(anonymous union)::(anonymous struct)::type' data-ref="request_state::(anonymousunion)::(anonymous)::type" data-ref-filename="request_state..(anonymousunion)..(anonymous)..type">type</a>, &amp;<a class="local col7 ref" href="#267d" title='d' data-ref="267d" data-ref-filename="267d">d</a>, <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::AnonData" title='request_state::(anonymous union)::(anonymous struct)::AnonData' data-ref="request_state::(anonymousunion)::(anonymous)::AnonData" data-ref-filename="request_state..(anonymousunion)..(anonymous)..AnonData">AnonData</a>)) { <b>goto</b> <a class="lbl" href="#275bad_param" data-ref="275bad_param" data-ref-filename="275bad_param">bad_param</a>; }</td></tr>
<tr><th id="1971">1971</th><td></td></tr>
<tr><th id="1972">1972</th><td>    <b>if</b> (!<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ConstructServiceName" title='ConstructServiceName' data-ref="ConstructServiceName" data-ref-filename="ConstructServiceName">ConstructServiceName</a>(&amp;<a class="local col8 ref" href="#268srv" title='srv' data-ref="268srv" data-ref-filename="268srv">srv</a>, &amp;<a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::name" title='request_state::(anonymous union)::(anonymous struct)::name' data-ref="request_state::(anonymousunion)::(anonymous)::name" data-ref-filename="request_state..(anonymousunion)..(anonymous)..name">name</a>, &amp;<a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::type" title='request_state::(anonymous union)::(anonymous struct)::type' data-ref="request_state::(anonymousunion)::(anonymous)::type" data-ref-filename="request_state..(anonymousunion)..(anonymous)..type">type</a>, &amp;<a class="local col7 ref" href="#267d" title='d' data-ref="267d" data-ref-filename="267d">d</a>))</td></tr>
<tr><th id="1973">1973</th><td>    {</td></tr>
<tr><th id="1974">1974</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;ERROR: handle_regservice_request - Couldn&apos;t ConstructServiceName from, “%#s” “%##s” “%##s”&quot;, request-&gt;u.servicereg.name.c, request-&gt;u.servicereg.type.c, d.c)" data-ref="_M/LogMsg">LogMsg</a>(<q>"ERROR: handle_regservice_request - Couldn't ConstructServiceName from, “%#s” “%##s” “%##s”"</q>,</td></tr>
<tr><th id="1975">1975</th><td>               <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::name" title='request_state::(anonymous union)::(anonymous struct)::name' data-ref="request_state::(anonymousunion)::(anonymous)::name" data-ref-filename="request_state..(anonymousunion)..(anonymous)..name">name</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::type" title='request_state::(anonymous union)::(anonymous struct)::type' data-ref="request_state::(anonymousunion)::(anonymous)::type" data-ref-filename="request_state..(anonymousunion)..(anonymous)..type">type</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="local col7 ref" href="#267d" title='d' data-ref="267d" data-ref-filename="267d">d</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>); <b>goto</b> <a class="lbl" href="#275bad_param" data-ref="275bad_param" data-ref-filename="275bad_param">bad_param</a>;</td></tr>
<tr><th id="1976">1976</th><td>    }</td></tr>
<tr><th id="1977">1977</th><td></td></tr>
<tr><th id="1978">1978</th><td>    <b>if</b> (!<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#MakeDomainNameFromDNSNameString" title='MakeDomainNameFromDNSNameString' data-ref="MakeDomainNameFromDNSNameString" data-ref-filename="MakeDomainNameFromDNSNameString">MakeDomainNameFromDNSNameString</a>(&amp;<a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::host" title='request_state::(anonymous union)::(anonymous struct)::host' data-ref="request_state::(anonymousunion)::(anonymous)::host" data-ref-filename="request_state..(anonymousunion)..(anonymous)..host">host</a>, <a class="local col5 ref" href="#265host" title='host' data-ref="265host" data-ref-filename="265host">host</a>))</td></tr>
<tr><th id="1979">1979</th><td>    { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;ERROR: handle_regservice_request - host bad %s&quot;, host)" data-ref="_M/LogMsg">LogMsg</a>(<q>"ERROR: handle_regservice_request - host bad %s"</q>, <a class="local col5 ref" href="#265host" title='host' data-ref="265host" data-ref-filename="265host">host</a>); <b>goto</b> <a class="lbl" href="#275bad_param" data-ref="275bad_param" data-ref-filename="275bad_param">bad_param</a>; }</td></tr>
<tr><th id="1980">1980</th><td>    <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::autorename" title='request_state::(anonymous union)::(anonymous struct)::autorename' data-ref="request_state::(anonymousunion)::(anonymous)::autorename" data-ref-filename="request_state..(anonymousunion)..(anonymous)..autorename">autorename</a>       = (<a class="local col2 ref" href="#272flags" title='flags' data-ref="272flags" data-ref-filename="272flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsNoAutoRename" title='kDNSServiceFlagsNoAutoRename' data-ref="kDNSServiceFlagsNoAutoRename" data-ref-filename="kDNSServiceFlagsNoAutoRename">kDNSServiceFlagsNoAutoRename</a>    ) == <var>0</var>;</td></tr>
<tr><th id="1981">1981</th><td>    <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::allowremotequery" title='request_state::(anonymous union)::(anonymous struct)::allowremotequery' data-ref="request_state::(anonymousunion)::(anonymous)::allowremotequery" data-ref-filename="request_state..(anonymousunion)..(anonymous)..allowremotequery">allowremotequery</a> = (<a class="local col2 ref" href="#272flags" title='flags' data-ref="272flags" data-ref-filename="272flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsAllowRemoteQuery" title='kDNSServiceFlagsAllowRemoteQuery' data-ref="kDNSServiceFlagsAllowRemoteQuery" data-ref-filename="kDNSServiceFlagsAllowRemoteQuery">kDNSServiceFlagsAllowRemoteQuery</a>) != <var>0</var>;</td></tr>
<tr><th id="1982">1982</th><td></td></tr>
<tr><th id="1983">1983</th><td>    <i>// Some clients use mDNS for lightweight copy protection, registering a pseudo-service with</i></td></tr>
<tr><th id="1984">1984</th><td><i>    // a port number of zero. When two instances of the protected client are allowed to run on one</i></td></tr>
<tr><th id="1985">1985</th><td><i>    // machine, we don't want to see misleading "Bogus client" messages in syslog and the console.</i></td></tr>
<tr><th id="1986">1986</th><td>    <b>if</b> (!<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2963" title="((request-&gt;u.servicereg.port).NotAnInteger == 0)" data-ref="_M/mDNSIPPortIsZero">mDNSIPPortIsZero</a>(<a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::port" title='request_state::(anonymous union)::(anonymous struct)::port' data-ref="request_state::(anonymousunion)::(anonymous)::port" data-ref-filename="request_state..(anonymousunion)..(anonymous)..port">port</a>))</td></tr>
<tr><th id="1987">1987</th><td>    {</td></tr>
<tr><th id="1988">1988</th><td>        <em>int</em> <dfn class="local col8 decl" id="278count" title='count' data-type='int' data-ref="278count" data-ref-filename="278count">count</dfn> = <a class="ref fn" href="#CountExistingRegistrations" title='CountExistingRegistrations' data-ref="CountExistingRegistrations" data-ref-filename="CountExistingRegistrations">CountExistingRegistrations</a>(&amp;<a class="local col8 ref" href="#268srv" title='srv' data-ref="268srv" data-ref-filename="268srv">srv</a>, <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::port" title='request_state::(anonymous union)::(anonymous struct)::port' data-ref="request_state::(anonymousunion)::(anonymous)::port" data-ref-filename="request_state..(anonymousunion)..(anonymous)..port">port</a>);</td></tr>
<tr><th id="1989">1989</th><td>        <b>if</b> (<a class="local col8 ref" href="#278count" title='count' data-ref="278count" data-ref-filename="278count">count</a>)</td></tr>
<tr><th id="1990">1990</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;Client application[%d](%s) registered %d identical instances of service %##s port %u.&quot;, request-&gt;process_id, request-&gt;pid_name, count+1, srv.c, mDNSVal16(request-&gt;u.servicereg.port))" data-ref="_M/LogMsg">LogMsg</a>(<q>"Client application[%d](%s) registered %d identical instances of service %##s port %u."</q>, <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>,</td></tr>
<tr><th id="1991">1991</th><td>                   <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>, <a class="local col8 ref" href="#278count" title='count' data-ref="278count" data-ref-filename="278count">count</a>+<var>1</var>, <a class="local col8 ref" href="#268srv" title='srv' data-ref="268srv" data-ref-filename="268srv">srv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSVal16" title='mDNSVal16' data-ref="mDNSVal16" data-ref-filename="mDNSVal16">mDNSVal16</a>(<a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::port" title='request_state::(anonymous union)::(anonymous struct)::port' data-ref="request_state::(anonymousunion)::(anonymous)::port" data-ref-filename="request_state..(anonymousunion)..(anonymous)..port">port</a>));</td></tr>
<tr><th id="1992">1992</th><td>    }</td></tr>
<tr><th id="1993">1993</th><td></td></tr>
<tr><th id="1994">1994</th><td><u>#<span data-ppcond="1994">if</span> APPLE_OSX_mDNSResponder &amp;&amp; ENABLE_BLE_TRIGGERED_BONJOUR</u></td></tr>
<tr><th id="1995">1995</th><td>    <i>// Determine if this request should be promoted to use BLE triggered feature.</i></td></tr>
<tr><th id="1996">1996</th><td>    <b>if</b> (shouldUseBLE(InterfaceID, <var>0</var>, &amp;request-&gt;u.servicereg.type, &amp;d))</td></tr>
<tr><th id="1997">1997</th><td>    {</td></tr>
<tr><th id="1998">1998</th><td>        request-&gt;flags |= (kDNSServiceFlagsAutoTrigger | kDNSServiceFlagsIncludeAWDL);</td></tr>
<tr><th id="1999">1999</th><td>        LogInfo(<q>"handle_regservice_request: registration promoted to use kDNSServiceFlagsAutoTrigger"</q>);</td></tr>
<tr><th id="2000">2000</th><td>    }</td></tr>
<tr><th id="2001">2001</th><td><u>#<span data-ppcond="1994">endif</span>  // APPLE_OSX_mDNSResponder &amp;&amp; ENABLE_BLE_TRIGGERED_BONJOUR</u></td></tr>
<tr><th id="2002">2002</th><td></td></tr>
<tr><th id="2003">2003</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: DNSServiceRegister(%X, %d, \&quot;%s\&quot;, \&quot;%s\&quot;, \&quot;%s\&quot;, \&quot;%s\&quot;, %u) START PID[%d](%s)&quot;, request-&gt;sd, request-&gt;flags, interfaceIndex, name, request-&gt;u.servicereg.type_as_string, domain, host, mDNSVal16(request-&gt;u.servicereg.port), request-&gt;process_id, request-&gt;pid_name);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: DNSServiceRegister(%X, %d, \"%s\", \"%s\", \"%s\", \"%s\", %u) START PID[%d](%s)"</q>,</td></tr>
<tr><th id="2004">2004</th><td>                 <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a>, <a class="local col3 ref" href="#273interfaceIndex" title='interfaceIndex' data-ref="273interfaceIndex" data-ref-filename="273interfaceIndex">interfaceIndex</a>, <a class="local col3 ref" href="#263name" title='name' data-ref="263name" data-ref-filename="263name">name</a>, <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::type_as_string" title='request_state::(anonymous union)::(anonymous struct)::type_as_string' data-ref="request_state::(anonymousunion)::(anonymous)::type_as_string" data-ref-filename="request_state..(anonymousunion)..(anonymous)..type_as_string">type_as_string</a>, <a class="local col4 ref" href="#264domain" title='domain' data-ref="264domain" data-ref-filename="264domain">domain</a>, <a class="local col5 ref" href="#265host" title='host' data-ref="265host" data-ref-filename="265host">host</a>,</td></tr>
<tr><th id="2005">2005</th><td>                 <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSVal16" title='mDNSVal16' data-ref="mDNSVal16" data-ref-filename="mDNSVal16">mDNSVal16</a>(<a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::port" title='request_state::(anonymous union)::(anonymous struct)::port' data-ref="request_state::(anonymousunion)::(anonymous)::port" data-ref-filename="request_state..(anonymousunion)..(anonymous)..port">port</a>), <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="2006">2006</th><td></td></tr>
<tr><th id="2007">2007</th><td>    <i>// We need to unconditionally set request-&gt;terminate, because even if we didn't successfully</i></td></tr>
<tr><th id="2008">2008</th><td><i>    // start any registrations right now, subsequent configuration changes may cause successful</i></td></tr>
<tr><th id="2009">2009</th><td><i>    // registrations to be added, and we'll need to cancel them before freeing this memory.</i></td></tr>
<tr><th id="2010">2010</th><td><i>    // We also need to set request-&gt;terminate first, before adding additional service instances,</i></td></tr>
<tr><th id="2011">2011</th><td><i>    // because the uds_validatelists uses the request-&gt;terminate function pointer to determine</i></td></tr>
<tr><th id="2012">2012</th><td><i>    // what kind of request this is, and therefore what kind of list validation is required.</i></td></tr>
<tr><th id="2013">2013</th><td>    <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> = <a class="ref fn" href="#regservice_termination_callback" title='regservice_termination_callback' data-ref="regservice_termination_callback" data-ref-filename="regservice_termination_callback">regservice_termination_callback</a>;</td></tr>
<tr><th id="2014">2014</th><td></td></tr>
<tr><th id="2015">2015</th><td>    <a class="local col9 ref" href="#269err" title='err' data-ref="269err" data-ref-filename="269err">err</a> = <a class="ref fn" href="#register_service_instance" title='register_service_instance' data-ref="register_service_instance" data-ref-filename="register_service_instance">register_service_instance</a>(<a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>, &amp;<a class="local col7 ref" href="#267d" title='d' data-ref="267d" data-ref-filename="267d">d</a>);</td></tr>
<tr><th id="2016">2016</th><td>    </td></tr>
<tr><th id="2017">2017</th><td><u>#<span data-ppcond="2017">if</span> TARGET_OS_EMBEDDED</u></td></tr>
<tr><th id="2018">2018</th><td>    ++curr_num_regservices;</td></tr>
<tr><th id="2019">2019</th><td>    <b>if</b> (curr_num_regservices &gt; max_num_regservices)</td></tr>
<tr><th id="2020">2020</th><td>        max_num_regservices = curr_num_regservices;</td></tr>
<tr><th id="2021">2021</th><td><u>#<span data-ppcond="2017">endif</span></u></td></tr>
<tr><th id="2022">2022</th><td></td></tr>
<tr><th id="2023">2023</th><td><u>#<span data-ppcond="2023">if</span> 0</u></td></tr>
<tr><th id="2024">2024</th><td>    err = AuthorizedDomain(request, &amp;d, AutoRegistrationDomains) ? register_service_instance(request, &amp;d) : mStatus_NoError;</td></tr>
<tr><th id="2025">2025</th><td><u>#<span data-ppcond="2023">endif</span></u></td></tr>
<tr><th id="2026">2026</th><td>    <b>if</b> (!<a class="local col9 ref" href="#269err" title='err' data-ref="269err" data-ref-filename="269err">err</a>)</td></tr>
<tr><th id="2027">2027</th><td>    {</td></tr>
<tr><th id="2028">2028</th><td>        <b>if</b> (<a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::autoname" title='request_state::(anonymous union)::(anonymous struct)::autoname' data-ref="request_state::(anonymousunion)::(anonymous)::autoname" data-ref-filename="request_state..(anonymousunion)..(anonymous)..autoname">autoname</a>) <a class="ref fn" href="#UpdateDeviceInfoRecord" title='UpdateDeviceInfoRecord' data-ref="UpdateDeviceInfoRecord" data-ref-filename="UpdateDeviceInfoRecord">UpdateDeviceInfoRecord</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>);</td></tr>
<tr><th id="2029">2029</th><td></td></tr>
<tr><th id="2030">2030</th><td>        <b>if</b> (!*<a class="local col4 ref" href="#264domain" title='domain' data-ref="264domain" data-ref-filename="264domain">domain</a>)</td></tr>
<tr><th id="2031">2031</th><td>        {</td></tr>
<tr><th id="2032">2032</th><td>            <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem" title='DNameListElem' data-type='struct DNameListElem' data-ref="DNameListElem" data-ref-filename="DNameListElem">DNameListElem</a> *<dfn class="local col9 decl" id="279ptr" title='ptr' data-type='DNameListElem *' data-ref="279ptr" data-ref-filename="279ptr">ptr</dfn>;</td></tr>
<tr><th id="2033">2033</th><td>            <i>// Note that we don't report errors for non-local, non-explicit domains</i></td></tr>
<tr><th id="2034">2034</th><td>            <b>for</b> (<a class="local col9 ref" href="#279ptr" title='ptr' data-ref="279ptr" data-ref-filename="279ptr">ptr</a> = <a class="ref" href="uds_daemon.h.html#AutoRegistrationDomains" title='AutoRegistrationDomains' data-ref="AutoRegistrationDomains" data-ref-filename="AutoRegistrationDomains">AutoRegistrationDomains</a>; <a class="local col9 ref" href="#279ptr" title='ptr' data-ref="279ptr" data-ref-filename="279ptr">ptr</a>; <a class="local col9 ref" href="#279ptr" title='ptr' data-ref="279ptr" data-ref-filename="279ptr">ptr</a> = <a class="local col9 ref" href="#279ptr" title='ptr' data-ref="279ptr" data-ref-filename="279ptr">ptr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::next" title='DNameListElem::next' data-ref="DNameListElem::next" data-ref-filename="DNameListElem..next">next</a>)</td></tr>
<tr><th id="2035">2035</th><td>                <b>if</b> (!<a class="local col9 ref" href="#279ptr" title='ptr' data-ref="279ptr" data-ref-filename="279ptr">ptr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::uid" title='DNameListElem::uid' data-ref="DNameListElem::uid" data-ref-filename="DNameListElem..uid">uid</a> || <a class="macro" href="#83" title="((request-&gt;uid) &lt;= 500)" data-ref="_M/SystemUID">SystemUID</a>(<a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::uid" title='request_state::uid' data-ref="request_state::uid" data-ref-filename="request_state..uid">uid</a>) || <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::uid" title='request_state::uid' data-ref="request_state::uid" data-ref-filename="request_state..uid">uid</a> == <a class="local col9 ref" href="#279ptr" title='ptr' data-ref="279ptr" data-ref-filename="279ptr">ptr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::uid" title='DNameListElem::uid' data-ref="DNameListElem::uid" data-ref-filename="DNameListElem..uid">uid</a>)</td></tr>
<tr><th id="2036">2036</th><td>                    <a class="ref fn" href="#register_service_instance" title='register_service_instance' data-ref="register_service_instance" data-ref-filename="register_service_instance">register_service_instance</a>(<a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>, &amp;<a class="local col9 ref" href="#279ptr" title='ptr' data-ref="279ptr" data-ref-filename="279ptr">ptr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::name" title='DNameListElem::name' data-ref="DNameListElem::name" data-ref-filename="DNameListElem..name">name</a>);</td></tr>
<tr><th id="2037">2037</th><td>        }</td></tr>
<tr><th id="2038">2038</th><td>    }</td></tr>
<tr><th id="2039">2039</th><td></td></tr>
<tr><th id="2040">2040</th><td>    <b>return</b>(<a class="local col9 ref" href="#269err" title='err' data-ref="269err" data-ref-filename="269err">err</a>);</td></tr>
<tr><th id="2041">2041</th><td></td></tr>
<tr><th id="2042">2042</th><td><dfn class="lbl" id="275bad_param" data-ref="275bad_param" data-ref-filename="275bad_param">bad_param</dfn>:</td></tr>
<tr><th id="2043">2043</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(request-&gt;u.servicereg.txtdata)" data-ref="_M/freeL">freeL</a>(<q>"handle_regservice_request (txtdata)"</q>, <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txtdata" title='request_state::(anonymous union)::(anonymous struct)::txtdata' data-ref="request_state::(anonymousunion)::(anonymous)::txtdata" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txtdata">txtdata</a>);</td></tr>
<tr><th id="2044">2044</th><td>    <a class="local col2 ref" href="#262request" title='request' data-ref="262request" data-ref-filename="262request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txtdata" title='request_state::(anonymous union)::(anonymous struct)::txtdata' data-ref="request_state::(anonymousunion)::(anonymous)::txtdata" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txtdata">txtdata</a> = <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="2045">2045</th><td>    <b>return</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>;</td></tr>
<tr><th id="2046">2046</th><td>}</td></tr>
<tr><th id="2047">2047</th><td></td></tr>
<tr><th id="2048">2048</th><td><i>// ***************************************************************************</i></td></tr>
<tr><th id="2049">2049</th><td><u>#<span data-ppcond="2049">if</span> COMPILER_LIKES_PRAGMA_MARK</u></td></tr>
<tr><th id="2050">2050</th><td><u>#pragma mark -</u></td></tr>
<tr><th id="2051">2051</th><td><u>#pragma mark - DNSServiceBrowse</u></td></tr>
<tr><th id="2052">2052</th><td><u>#<span data-ppcond="2049">endif</span></u></td></tr>
<tr><th id="2053">2053</th><td></td></tr>
<tr><th id="2054">2054</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="FoundInstance" title='FoundInstance' data-ref="FoundInstance" data-ref-filename="FoundInstance">FoundInstance</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS" title='mDNS' data-type='struct mDNS_struct' data-ref="mDNS" data-ref-filename="mDNS">mDNS</a> *<em>const</em> <dfn class="local col0 decl" id="280m" title='m' data-type='mDNS *const' data-ref="280m" data-ref-filename="280m">m</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion" title='DNSQuestion' data-type='struct DNSQuestion_struct' data-ref="DNSQuestion" data-ref-filename="DNSQuestion">DNSQuestion</a> *<dfn class="local col1 decl" id="281question" title='question' data-type='DNSQuestion *' data-ref="281question" data-ref-filename="281question">question</dfn>, <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord" title='ResourceRecord' data-type='struct ResourceRecord_struct' data-ref="ResourceRecord" data-ref-filename="ResourceRecord">ResourceRecord</a> *<em>const</em> <dfn class="local col2 decl" id="282answer" title='answer' data-type='const ResourceRecord *const' data-ref="282answer" data-ref-filename="282answer">answer</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#QC_result" title='QC_result' data-type='enum QC_result' data-ref="QC_result" data-ref-filename="QC_result">QC_result</a> <dfn class="local col3 decl" id="283AddRecord" title='AddRecord' data-type='QC_result' data-ref="283AddRecord" data-ref-filename="283AddRecord">AddRecord</dfn>)</td></tr>
<tr><th id="2055">2055</th><td>{</td></tr>
<tr><th id="2056">2056</th><td>    <a class="typedef" href="dns_sd.h.html#DNSServiceFlags" title='DNSServiceFlags' data-type='uint32_t' data-ref="DNSServiceFlags" data-ref-filename="DNSServiceFlags">DNSServiceFlags</a> <dfn class="local col4 decl" id="284flags" title='flags' data-type='DNSServiceFlags' data-ref="284flags" data-ref-filename="284flags">flags</dfn> = <a class="local col3 ref" href="#283AddRecord" title='AddRecord' data-ref="283AddRecord" data-ref-filename="283AddRecord">AddRecord</a> ? <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsAdd" title='kDNSServiceFlagsAdd' data-ref="kDNSServiceFlagsAdd" data-ref-filename="kDNSServiceFlagsAdd">kDNSServiceFlagsAdd</a> : <var>0</var>;</td></tr>
<tr><th id="2057">2057</th><td>    <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col5 decl" id="285req" title='req' data-type='request_state *' data-ref="285req" data-ref-filename="285req">req</dfn> = <a class="local col1 ref" href="#281question" title='question' data-ref="281question" data-ref-filename="281question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::QuestionContext" title='DNSQuestion_struct::QuestionContext' data-ref="DNSQuestion_struct::QuestionContext" data-ref-filename="DNSQuestion_struct..QuestionContext">QuestionContext</a>;</td></tr>
<tr><th id="2058">2058</th><td>    <a class="typedef" href="uds_daemon.h.html#reply_state" title='reply_state' data-type='struct reply_state' data-ref="reply_state" data-ref-filename="reply_state">reply_state</a> *<dfn class="local col6 decl" id="286rep" title='rep' data-type='reply_state *' data-ref="286rep" data-ref-filename="286rep">rep</dfn>;</td></tr>
<tr><th id="2059">2059</th><td>    (<em>void</em>)<a class="local col0 ref" href="#280m" title='m' data-ref="280m" data-ref-filename="280m">m</a>; <i>// Unused</i></td></tr>
<tr><th id="2060">2060</th><td></td></tr>
<tr><th id="2061">2061</th><td>    <b>if</b> (<a class="local col2 ref" href="#282answer" title='answer' data-ref="282answer" data-ref-filename="282answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rrtype" title='ResourceRecord_struct::rrtype' data-ref="ResourceRecord_struct::rrtype" data-ref-filename="ResourceRecord_struct..rrtype">rrtype</a> != <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSType_PTR" title='kDNSType_PTR' data-ref="kDNSType_PTR" data-ref-filename="kDNSType_PTR">kDNSType_PTR</a>)</td></tr>
<tr><th id="2062">2062</th><td>    { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: FoundInstance: Should not be called with rrtype %d (not a PTR record)&quot;, req-&gt;sd, answer-&gt;rrtype)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: FoundInstance: Should not be called with rrtype %d (not a PTR record)"</q>, <a class="local col5 ref" href="#285req" title='req' data-ref="285req" data-ref-filename="285req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col2 ref" href="#282answer" title='answer' data-ref="282answer" data-ref-filename="282answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rrtype" title='ResourceRecord_struct::rrtype' data-ref="ResourceRecord_struct::rrtype" data-ref-filename="ResourceRecord_struct..rrtype">rrtype</a>); <b>return</b>; }</td></tr>
<tr><th id="2063">2063</th><td></td></tr>
<tr><th id="2064">2064</th><td>    <b>if</b> (<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2964" title="((question-&gt;TargetQID).NotAnInteger == 0)" data-ref="_M/mDNSOpaque16IsZero">mDNSOpaque16IsZero</a>(<a class="local col1 ref" href="#281question" title='question' data-ref="281question" data-ref-filename="281question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::TargetQID" title='DNSQuestion_struct::TargetQID' data-ref="DNSQuestion_struct::TargetQID" data-ref-filename="DNSQuestion_struct..TargetQID">TargetQID</a>) &amp;&amp; (<a class="local col1 ref" href="#281question" title='question' data-ref="281question" data-ref-filename="281question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::BrowseThreshold" title='DNSQuestion_struct::BrowseThreshold' data-ref="DNSQuestion_struct::BrowseThreshold" data-ref-filename="DNSQuestion_struct..BrowseThreshold">BrowseThreshold</a> &gt; <var>0</var>) &amp;&amp; (<a class="local col1 ref" href="#281question" title='question' data-ref="281question" data-ref-filename="281question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::CurrentAnswers" title='DNSQuestion_struct::CurrentAnswers' data-ref="DNSQuestion_struct::CurrentAnswers" data-ref-filename="DNSQuestion_struct..CurrentAnswers">CurrentAnswers</a> &gt;= <a class="local col1 ref" href="#281question" title='question' data-ref="281question" data-ref-filename="281question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::BrowseThreshold" title='DNSQuestion_struct::BrowseThreshold' data-ref="DNSQuestion_struct::BrowseThreshold" data-ref-filename="DNSQuestion_struct..BrowseThreshold">BrowseThreshold</a>))</td></tr>
<tr><th id="2065">2065</th><td>    {</td></tr>
<tr><th id="2066">2066</th><td>        <a class="local col4 ref" href="#284flags" title='flags' data-ref="284flags" data-ref-filename="284flags">flags</a> |= <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsThresholdReached" title='kDNSServiceFlagsThresholdReached' data-ref="kDNSServiceFlagsThresholdReached" data-ref-filename="kDNSServiceFlagsThresholdReached">kDNSServiceFlagsThresholdReached</a>;</td></tr>
<tr><th id="2067">2067</th><td>    }</td></tr>
<tr><th id="2068">2068</th><td></td></tr>
<tr><th id="2069">2069</th><td>    <i>// if returning a negative answer, then use question's name in reply</i></td></tr>
<tr><th id="2070">2070</th><td>    <b>if</b> (<a class="local col2 ref" href="#282answer" title='answer' data-ref="282answer" data-ref-filename="282answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::RecordType" title='ResourceRecord_struct::RecordType' data-ref="ResourceRecord_struct::RecordType" data-ref-filename="ResourceRecord_struct..RecordType">RecordType</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSRecordTypePacketNegative" title='kDNSRecordTypePacketNegative' data-ref="kDNSRecordTypePacketNegative" data-ref-filename="kDNSRecordTypePacketNegative">kDNSRecordTypePacketNegative</a>)</td></tr>
<tr><th id="2071">2071</th><td>    {</td></tr>
<tr><th id="2072">2072</th><td>        <a class="ref fn" href="#GenerateBrowseReply" title='GenerateBrowseReply' data-ref="GenerateBrowseReply" data-ref-filename="GenerateBrowseReply">GenerateBrowseReply</a>(&amp;<a class="local col1 ref" href="#281question" title='question' data-ref="281question" data-ref-filename="281question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>, <a class="local col2 ref" href="#282answer" title='answer' data-ref="282answer" data-ref-filename="282answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::InterfaceID" title='ResourceRecord_struct::InterfaceID' data-ref="ResourceRecord_struct::InterfaceID" data-ref-filename="ResourceRecord_struct..InterfaceID">InterfaceID</a>, <a class="local col5 ref" href="#285req" title='req' data-ref="285req" data-ref-filename="285req">req</a>, &amp;<a class="local col6 ref" href="#286rep" title='rep' data-ref="286rep" data-ref-filename="286rep">rep</a>, <a class="enum" href="dnssd_ipc.h.html#browse_reply_op" title='browse_reply_op' data-ref="browse_reply_op" data-ref-filename="browse_reply_op">browse_reply_op</a>, <a class="local col4 ref" href="#284flags" title='flags' data-ref="284flags" data-ref-filename="284flags">flags</a>, <a class="enum" href="dns_sd.h.html#kDNSServiceErr_NoSuchRecord" title='kDNSServiceErr_NoSuchRecord' data-ref="kDNSServiceErr_NoSuchRecord" data-ref-filename="kDNSServiceErr_NoSuchRecord">kDNSServiceErr_NoSuchRecord</a>);</td></tr>
<tr><th id="2073">2073</th><td>        <b>goto</b> <a class="lbl" href="#287validReply" data-ref="287validReply" data-ref-filename="287validReply">validReply</a>;</td></tr>
<tr><th id="2074">2074</th><td>    }</td></tr>
<tr><th id="2075">2075</th><td></td></tr>
<tr><th id="2076">2076</th><td>    <b>if</b> (<a class="ref fn" href="#GenerateNTDResponse" title='GenerateNTDResponse' data-ref="GenerateNTDResponse" data-ref-filename="GenerateNTDResponse">GenerateNTDResponse</a>(&amp;<a class="local col2 ref" href="#282answer" title='answer' data-ref="282answer" data-ref-filename="282answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdata" title='ResourceRecord_struct::rdata' data-ref="ResourceRecord_struct::rdata" data-ref-filename="ResourceRecord_struct..rdata">rdata</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::u" title='(anonymous struct)::u' data-ref="(anonymous)::u" data-ref-filename="(anonymous)..u">u</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::name" title='(anonymous union)::name' data-ref="(anonymous)::name" data-ref-filename="(anonymous)..name">name</a>, <a class="local col2 ref" href="#282answer" title='answer' data-ref="282answer" data-ref-filename="282answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::InterfaceID" title='ResourceRecord_struct::InterfaceID' data-ref="ResourceRecord_struct::InterfaceID" data-ref-filename="ResourceRecord_struct..InterfaceID">InterfaceID</a>, <a class="local col5 ref" href="#285req" title='req' data-ref="285req" data-ref-filename="285req">req</a>, &amp;<a class="local col6 ref" href="#286rep" title='rep' data-ref="286rep" data-ref-filename="286rep">rep</a>, <a class="enum" href="dnssd_ipc.h.html#browse_reply_op" title='browse_reply_op' data-ref="browse_reply_op" data-ref-filename="browse_reply_op">browse_reply_op</a>, <a class="local col4 ref" href="#284flags" title='flags' data-ref="284flags" data-ref-filename="284flags">flags</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_NoError" title='mStatus_NoError' data-ref="mStatus_NoError" data-ref-filename="mStatus_NoError">mStatus_NoError</a>) != <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_NoError" title='mStatus_NoError' data-ref="mStatus_NoError" data-ref-filename="mStatus_NoError">mStatus_NoError</a>)</td></tr>
<tr><th id="2077">2077</th><td>    {</td></tr>
<tr><th id="2078">2078</th><td>        <b>if</b> (<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#SameDomainName" title='SameDomainName' data-ref="SameDomainName" data-ref-filename="SameDomainName">SameDomainName</a>(&amp;<a class="local col5 ref" href="#285req" title='req' data-ref="285req" data-ref-filename="285req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::regtype" title='request_state::(anonymous union)::(anonymous struct)::regtype' data-ref="request_state::(anonymousunion)::(anonymous)::regtype" data-ref-filename="request_state..(anonymousunion)..(anonymous)..regtype">regtype</a>, (<em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#domainname" title='domainname' data-type='struct domainname' data-ref="domainname" data-ref-filename="domainname">domainname</a>*)<q>"\x09_services\x07_dns-sd\x04_udp"</q>))</td></tr>
<tr><th id="2079">2079</th><td>        {</td></tr>
<tr><th id="2080">2080</th><td>            <i>// Special support to enable the DNSServiceBrowse call made by Bonjour Browser</i></td></tr>
<tr><th id="2081">2081</th><td><i>            // Remove after Bonjour Browser is updated to use DNSServiceQueryRecord instead of DNSServiceBrowse</i></td></tr>
<tr><th id="2082">2082</th><td>            <a class="ref fn" href="#GenerateBrowseReply" title='GenerateBrowseReply' data-ref="GenerateBrowseReply" data-ref-filename="GenerateBrowseReply">GenerateBrowseReply</a>(&amp;<a class="local col2 ref" href="#282answer" title='answer' data-ref="282answer" data-ref-filename="282answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdata" title='ResourceRecord_struct::rdata' data-ref="ResourceRecord_struct::rdata" data-ref-filename="ResourceRecord_struct..rdata">rdata</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::u" title='(anonymous struct)::u' data-ref="(anonymous)::u" data-ref-filename="(anonymous)..u">u</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::name" title='(anonymous union)::name' data-ref="(anonymous)::name" data-ref-filename="(anonymous)..name">name</a>, <a class="local col2 ref" href="#282answer" title='answer' data-ref="282answer" data-ref-filename="282answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::InterfaceID" title='ResourceRecord_struct::InterfaceID' data-ref="ResourceRecord_struct::InterfaceID" data-ref-filename="ResourceRecord_struct..InterfaceID">InterfaceID</a>, <a class="local col5 ref" href="#285req" title='req' data-ref="285req" data-ref-filename="285req">req</a>, &amp;<a class="local col6 ref" href="#286rep" title='rep' data-ref="286rep" data-ref-filename="286rep">rep</a>, <a class="enum" href="dnssd_ipc.h.html#browse_reply_op" title='browse_reply_op' data-ref="browse_reply_op" data-ref-filename="browse_reply_op">browse_reply_op</a>, <a class="local col4 ref" href="#284flags" title='flags' data-ref="284flags" data-ref-filename="284flags">flags</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_NoError" title='mStatus_NoError' data-ref="mStatus_NoError" data-ref-filename="mStatus_NoError">mStatus_NoError</a>);</td></tr>
<tr><th id="2083">2083</th><td>            <b>goto</b> <a class="lbl" href="#287validReply" data-ref="287validReply" data-ref-filename="287validReply">validReply</a>;</td></tr>
<tr><th id="2084">2084</th><td>        }</td></tr>
<tr><th id="2085">2085</th><td></td></tr>
<tr><th id="2086">2086</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: FoundInstance: %##s PTR %##s received from network is not valid DNS-SD service pointer&quot;, req-&gt;sd, answer-&gt;name-&gt;c, answer-&gt;rdata-&gt;u.name.c)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: FoundInstance: %##s PTR %##s received from network is not valid DNS-SD service pointer"</q>,</td></tr>
<tr><th id="2087">2087</th><td>               <a class="local col5 ref" href="#285req" title='req' data-ref="285req" data-ref-filename="285req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col2 ref" href="#282answer" title='answer' data-ref="282answer" data-ref-filename="282answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::name" title='ResourceRecord_struct::name' data-ref="ResourceRecord_struct::name" data-ref-filename="ResourceRecord_struct..name">name</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="local col2 ref" href="#282answer" title='answer' data-ref="282answer" data-ref-filename="282answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdata" title='ResourceRecord_struct::rdata' data-ref="ResourceRecord_struct::rdata" data-ref-filename="ResourceRecord_struct..rdata">rdata</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::u" title='(anonymous struct)::u' data-ref="(anonymous)::u" data-ref-filename="(anonymous)..u">u</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::name" title='(anonymous union)::name' data-ref="(anonymous)::name" data-ref-filename="(anonymous)..name">name</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>);</td></tr>
<tr><th id="2088">2088</th><td>        <b>return</b>;</td></tr>
<tr><th id="2089">2089</th><td>    }</td></tr>
<tr><th id="2090">2090</th><td></td></tr>
<tr><th id="2091">2091</th><td><dfn class="lbl" id="287validReply" data-ref="287validReply" data-ref-filename="287validReply">validReply</dfn>:</td></tr>
<tr><th id="2092">2092</th><td></td></tr>
<tr><th id="2093">2093</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: DNSServiceBrowse(%##s, %s) RESULT %s interface %d: %s&quot;, req-&gt;sd, question-&gt;qname.c, DNSTypeName(question-&gt;qtype), AddRecord ? &quot;ADD&quot; : &quot;RMV&quot;, mDNSPlatformInterfaceIndexfromInterfaceID(m, answer-&gt;InterfaceID, mDNSfalse), GetRRDisplayString_rdb(answer, &amp;(answer)-&gt;rdata-&gt;u, (m)-&gt;MsgBuffer));} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: DNSServiceBrowse(%##s, %s) RESULT %s interface %d: %s"</q>,</td></tr>
<tr><th id="2094">2094</th><td>                 <a class="local col5 ref" href="#285req" title='req' data-ref="285req" data-ref-filename="285req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col1 ref" href="#281question" title='question' data-ref="281question" data-ref-filename="281question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col1 ref" href="#281question" title='question' data-ref="281question" data-ref-filename="281question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a>), <a class="local col3 ref" href="#283AddRecord" title='AddRecord' data-ref="283AddRecord" data-ref-filename="283AddRecord">AddRecord</a> ? <q>"ADD"</q> : <q>"RMV"</q>,</td></tr>
<tr><th id="2095">2095</th><td>                 <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformInterfaceIndexfromInterfaceID" title='mDNSPlatformInterfaceIndexfromInterfaceID' data-ref="mDNSPlatformInterfaceIndexfromInterfaceID" data-ref-filename="mDNSPlatformInterfaceIndexfromInterfaceID">mDNSPlatformInterfaceIndexfromInterfaceID</a>(<a class="local col0 ref" href="#280m" title='m' data-ref="280m" data-ref-filename="280m">m</a>, <a class="local col2 ref" href="#282answer" title='answer' data-ref="282answer" data-ref-filename="282answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::InterfaceID" title='ResourceRecord_struct::InterfaceID' data-ref="ResourceRecord_struct::InterfaceID" data-ref-filename="ResourceRecord_struct..InterfaceID">InterfaceID</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>), <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2941" title="GetRRDisplayString_rdb(answer, &amp;(answer)-&gt;rdata-&gt;u, (m)-&gt;MsgBuffer)" data-ref="_M/RRDisplayString">RRDisplayString</a>(<a class="local col0 ref" href="#280m" title='m' data-ref="280m" data-ref-filename="280m">m</a>, <a class="local col2 ref" href="#282answer" title='answer' data-ref="282answer" data-ref-filename="282answer">answer</a>));</td></tr>
<tr><th id="2096">2096</th><td></td></tr>
<tr><th id="2097">2097</th><td>    <a class="ref fn" href="#append_reply" title='append_reply' data-ref="append_reply" data-ref-filename="append_reply">append_reply</a>(<a class="local col5 ref" href="#285req" title='req' data-ref="285req" data-ref-filename="285req">req</a>, <a class="local col6 ref" href="#286rep" title='rep' data-ref="286rep" data-ref-filename="286rep">rep</a>);</td></tr>
<tr><th id="2098">2098</th><td>}</td></tr>
<tr><th id="2099">2099</th><td></td></tr>
<tr><th id="2100">2100</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="SetQuestionPolicy" title='SetQuestionPolicy' data-ref="SetQuestionPolicy" data-ref-filename="SetQuestionPolicy">SetQuestionPolicy</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion" title='DNSQuestion' data-type='struct DNSQuestion_struct' data-ref="DNSQuestion" data-ref-filename="DNSQuestion">DNSQuestion</a> *<dfn class="local col8 decl" id="288q" title='q' data-type='DNSQuestion *' data-ref="288q" data-ref-filename="288q">q</dfn>, <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col9 decl" id="289req" title='req' data-type='request_state *' data-ref="289req" data-ref-filename="289req">req</dfn>)</td></tr>
<tr><th id="2101">2101</th><td>{</td></tr>
<tr><th id="2102">2102</th><td>    <a class="local col8 ref" href="#288q" title='q' data-ref="288q" data-ref-filename="288q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::euid" title='DNSQuestion_struct::euid' data-ref="DNSQuestion_struct::euid" data-ref-filename="DNSQuestion_struct..euid">euid</a> = <a class="local col9 ref" href="#289req" title='req' data-ref="289req" data-ref-filename="289req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::uid" title='request_state::uid' data-ref="request_state::uid" data-ref-filename="request_state..uid">uid</a>;</td></tr>
<tr><th id="2103">2103</th><td>    <i>// The policy is either based on pid or UUID. Pass a zero pid</i></td></tr>
<tr><th id="2104">2104</th><td><i>    // to the "core" if the UUID is valid. If we always pass the pid,</i></td></tr>
<tr><th id="2105">2105</th><td><i>    // then the "core" needs to determine whether the uuid is valid </i></td></tr>
<tr><th id="2106">2106</th><td><i>    // by examining all the 16 bytes at the time of the policy</i></td></tr>
<tr><th id="2107">2107</th><td><i>    // check and also when setting the delegate socket option. Also, it</i></td></tr>
<tr><th id="2108">2108</th><td><i>    // requires that we zero out the uuid wherever the question is</i></td></tr>
<tr><th id="2109">2109</th><td><i>    // initialized to make sure that it is not interpreted as valid.</i></td></tr>
<tr><th id="2110">2110</th><td><i>    // To prevent these intrusive changes, just pass a zero pid to indicate</i></td></tr>
<tr><th id="2111">2111</th><td><i>    // that pid is not valid when uuid is valid. In future if we need the</i></td></tr>
<tr><th id="2112">2112</th><td><i>    // pid in the question, we will reevaluate this strategy.</i></td></tr>
<tr><th id="2113">2113</th><td>    <b>if</b> (<a class="local col9 ref" href="#289req" title='req' data-ref="289req" data-ref-filename="289req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::validUUID" title='request_state::validUUID' data-ref="request_state::validUUID" data-ref-filename="request_state..validUUID">validUUID</a>)</td></tr>
<tr><th id="2114">2114</th><td>    {</td></tr>
<tr><th id="2115">2115</th><td>        <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformMemCopy" title='mDNSPlatformMemCopy' data-ref="mDNSPlatformMemCopy" data-ref-filename="mDNSPlatformMemCopy">mDNSPlatformMemCopy</a>(<a class="local col8 ref" href="#288q" title='q' data-ref="288q" data-ref-filename="288q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::uuid" title='DNSQuestion_struct::uuid' data-ref="DNSQuestion_struct::uuid" data-ref-filename="DNSQuestion_struct..uuid">uuid</a>, <a class="local col9 ref" href="#289req" title='req' data-ref="289req" data-ref-filename="289req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::uuid" title='request_state::uuid' data-ref="request_state::uuid" data-ref-filename="request_state..uuid">uuid</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#1897" title="16" data-ref="_M/UUID_SIZE">UUID_SIZE</a>);</td></tr>
<tr><th id="2116">2116</th><td>        <a class="local col8 ref" href="#288q" title='q' data-ref="288q" data-ref-filename="288q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::pid" title='DNSQuestion_struct::pid' data-ref="DNSQuestion_struct::pid" data-ref-filename="DNSQuestion_struct..pid">pid</a> = <var>0</var>;</td></tr>
<tr><th id="2117">2117</th><td>    }</td></tr>
<tr><th id="2118">2118</th><td>    <b>else</b></td></tr>
<tr><th id="2119">2119</th><td>    {</td></tr>
<tr><th id="2120">2120</th><td>        <a class="local col8 ref" href="#288q" title='q' data-ref="288q" data-ref-filename="288q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::pid" title='DNSQuestion_struct::pid' data-ref="DNSQuestion_struct::pid" data-ref-filename="DNSQuestion_struct..pid">pid</a> = <a class="local col9 ref" href="#289req" title='req' data-ref="289req" data-ref-filename="289req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>;</td></tr>
<tr><th id="2121">2121</th><td>    }</td></tr>
<tr><th id="2122">2122</th><td></td></tr>
<tr><th id="2123">2123</th><td>    <i>//debugf("SetQuestionPolicy: q-&gt;euid[%d] q-&gt;pid[%d] uuid is valid : %s", q-&gt;euid, q-&gt;pid, req-&gt;validUUID ? "true" : "false");</i></td></tr>
<tr><th id="2124">2124</th><td>}</td></tr>
<tr><th id="2125">2125</th><td></td></tr>
<tr><th id="2126">2126</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="decl def fn" id="add_domain_to_browser" title='add_domain_to_browser' data-ref="add_domain_to_browser" data-ref-filename="add_domain_to_browser">add_domain_to_browser</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col0 decl" id="290info" title='info' data-type='request_state *' data-ref="290info" data-ref-filename="290info">info</dfn>, <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#domainname" title='domainname' data-type='struct domainname' data-ref="domainname" data-ref-filename="domainname">domainname</a> *<dfn class="local col1 decl" id="291d" title='d' data-type='const domainname *' data-ref="291d" data-ref-filename="291d">d</dfn>)</td></tr>
<tr><th id="2127">2127</th><td>{</td></tr>
<tr><th id="2128">2128</th><td>    <a class="typedef" href="uds_daemon.h.html#browser_t" title='browser_t' data-type='struct browser_t' data-ref="browser_t" data-ref-filename="browser_t">browser_t</a> *<dfn class="local col2 decl" id="292b" title='b' data-type='browser_t *' data-ref="292b" data-ref-filename="292b">b</dfn>, *<dfn class="local col3 decl" id="293p" title='p' data-type='browser_t *' data-ref="293p" data-ref-filename="293p">p</dfn>;</td></tr>
<tr><th id="2129">2129</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="local col4 decl" id="294err" title='err' data-type='mStatus' data-ref="294err" data-ref-filename="294err">err</dfn>;</td></tr>
<tr><th id="2130">2130</th><td></td></tr>
<tr><th id="2131">2131</th><td>    <b>for</b> (<a class="local col3 ref" href="#293p" title='p' data-ref="293p" data-ref-filename="293p">p</a> = <a class="local col0 ref" href="#290info" title='info' data-ref="290info" data-ref-filename="290info">info</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::browsers" title='request_state::(anonymous union)::(anonymous struct)::browsers' data-ref="request_state::(anonymousunion)::(anonymous)::browsers" data-ref-filename="request_state..(anonymousunion)..(anonymous)..browsers">browsers</a>; <a class="local col3 ref" href="#293p" title='p' data-ref="293p" data-ref-filename="293p">p</a>; <a class="local col3 ref" href="#293p" title='p' data-ref="293p" data-ref-filename="293p">p</a> = <a class="local col3 ref" href="#293p" title='p' data-ref="293p" data-ref-filename="293p">p</a>-&gt;<a class="ref field" href="uds_daemon.h.html#browser_t::next" title='browser_t::next' data-ref="browser_t::next" data-ref-filename="browser_t..next">next</a>)</td></tr>
<tr><th id="2132">2132</th><td>    {</td></tr>
<tr><th id="2133">2133</th><td>        <b>if</b> (<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#SameDomainName" title='SameDomainName' data-ref="SameDomainName" data-ref-filename="SameDomainName">SameDomainName</a>(&amp;<a class="local col3 ref" href="#293p" title='p' data-ref="293p" data-ref-filename="293p">p</a>-&gt;<a class="ref field" href="uds_daemon.h.html#browser_t::domain" title='browser_t::domain' data-ref="browser_t::domain" data-ref-filename="browser_t..domain">domain</a>, <a class="local col1 ref" href="#291d" title='d' data-ref="291d" data-ref-filename="291d">d</a>))</td></tr>
<tr><th id="2134">2134</th><td>        { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#131" title="debug_noop" data-ref="_M/debugf">debugf</a>(<q>"add_domain_to_browser %##s already in list"</q>, d-&gt;c); <b>return</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_AlreadyRegistered" title='mStatus_AlreadyRegistered' data-ref="mStatus_AlreadyRegistered" data-ref-filename="mStatus_AlreadyRegistered">mStatus_AlreadyRegistered</a>; }</td></tr>
<tr><th id="2135">2135</th><td>    }</td></tr>
<tr><th id="2136">2136</th><td></td></tr>
<tr><th id="2137">2137</th><td>    <a class="local col2 ref" href="#292b" title='b' data-ref="292b" data-ref-filename="292b">b</a> = <a class="macro" href="../mDNSCore/mDNSDebug.h.html#166" title="malloc(sizeof(*b))" data-ref="_M/mallocL">mallocL</a>(<q>"browser_t"</q>, <b>sizeof</b>(*<a class="local col2 ref" href="#292b" title='b' data-ref="292b" data-ref-filename="292b">b</a>));</td></tr>
<tr><th id="2138">2138</th><td>    <b>if</b> (!<a class="local col2 ref" href="#292b" title='b' data-ref="292b" data-ref-filename="292b">b</a>) <b>return</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_NoMemoryErr" title='mStatus_NoMemoryErr' data-ref="mStatus_NoMemoryErr" data-ref-filename="mStatus_NoMemoryErr">mStatus_NoMemoryErr</a>;</td></tr>
<tr><th id="2139">2139</th><td>    <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformMemZero" title='mDNSPlatformMemZero' data-ref="mDNSPlatformMemZero" data-ref-filename="mDNSPlatformMemZero">mDNSPlatformMemZero</a>(<a class="local col2 ref" href="#292b" title='b' data-ref="292b" data-ref-filename="292b">b</a>, <b>sizeof</b>(*<a class="local col2 ref" href="#292b" title='b' data-ref="292b" data-ref-filename="292b">b</a>));</td></tr>
<tr><th id="2140">2140</th><td>    <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2849" title="do { mDNSu16 len__ = DomainNameLengthLimit(((d)), ((d))-&gt;c + 256); if (len__ &lt;= 256) mDNSPlatformMemCopy((&amp;b-&gt;domain)-&gt;c, (d)-&gt;c, len__); else (&amp;b-&gt;domain)-&gt;c[0] = 0; } while(0)" data-ref="_M/AssignDomainName">AssignDomainName</a>(&amp;<a class="local col2 ref" href="#292b" title='b' data-ref="292b" data-ref-filename="292b">b</a>-&gt;<a class="ref field" href="uds_daemon.h.html#browser_t::domain" title='browser_t::domain' data-ref="browser_t::domain" data-ref-filename="browser_t..domain">domain</a>, <a class="local col1 ref" href="#291d" title='d' data-ref="291d" data-ref-filename="291d">d</a>);</td></tr>
<tr><th id="2141">2141</th><td>    <a class="ref fn" href="#SetQuestionPolicy" title='SetQuestionPolicy' data-ref="SetQuestionPolicy" data-ref-filename="SetQuestionPolicy">SetQuestionPolicy</a>(&amp;<a class="local col2 ref" href="#292b" title='b' data-ref="292b" data-ref-filename="292b">b</a>-&gt;<a class="ref field" href="uds_daemon.h.html#browser_t::q" title='browser_t::q' data-ref="browser_t::q" data-ref-filename="browser_t..q">q</a>, <a class="local col0 ref" href="#290info" title='info' data-ref="290info" data-ref-filename="290info">info</a>);</td></tr>
<tr><th id="2142">2142</th><td>    <a class="local col4 ref" href="#294err" title='err' data-ref="294err" data-ref-filename="294err">err</a> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_StartBrowse" title='mDNS_StartBrowse' data-ref="mDNS_StartBrowse" data-ref-filename="mDNS_StartBrowse">mDNS_StartBrowse</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col2 ref" href="#292b" title='b' data-ref="292b" data-ref-filename="292b">b</a>-&gt;<a class="ref field" href="uds_daemon.h.html#browser_t::q" title='browser_t::q' data-ref="browser_t::q" data-ref-filename="browser_t..q">q</a>, &amp;<a class="local col0 ref" href="#290info" title='info' data-ref="290info" data-ref-filename="290info">info</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::regtype" title='request_state::(anonymous union)::(anonymous struct)::regtype' data-ref="request_state::(anonymousunion)::(anonymous)::regtype" data-ref-filename="request_state..(anonymousunion)..(anonymous)..regtype">regtype</a>, <a class="local col1 ref" href="#291d" title='d' data-ref="291d" data-ref-filename="291d">d</a>, <a class="local col0 ref" href="#290info" title='info' data-ref="290info" data-ref-filename="290info">info</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::AnonData" title='request_state::(anonymous union)::(anonymous struct)::AnonData' data-ref="request_state::(anonymousunion)::(anonymous)::AnonData" data-ref-filename="request_state..(anonymousunion)..(anonymous)..AnonData">AnonData</a>, <a class="local col0 ref" href="#290info" title='info' data-ref="290info" data-ref-filename="290info">info</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::interface_id" title='request_state::(anonymous union)::(anonymous struct)::interface_id' data-ref="request_state::(anonymousunion)::(anonymous)::interface_id" data-ref-filename="request_state..(anonymousunion)..(anonymous)..interface_id">interface_id</a>, <a class="local col0 ref" href="#290info" title='info' data-ref="290info" data-ref-filename="290info">info</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a>,</td></tr>
<tr><th id="2143">2143</th><td>                            <a class="local col0 ref" href="#290info" title='info' data-ref="290info" data-ref-filename="290info">info</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::ForceMCast" title='request_state::(anonymous union)::(anonymous struct)::ForceMCast' data-ref="request_state::(anonymousunion)::(anonymous)::ForceMCast" data-ref-filename="request_state..(anonymousunion)..(anonymous)..ForceMCast">ForceMCast</a>, (<a class="local col0 ref" href="#290info" title='info' data-ref="290info" data-ref-filename="290info">info</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsBackgroundTrafficClass" title='kDNSServiceFlagsBackgroundTrafficClass' data-ref="kDNSServiceFlagsBackgroundTrafficClass" data-ref-filename="kDNSServiceFlagsBackgroundTrafficClass">kDNSServiceFlagsBackgroundTrafficClass</a>) != <var>0</var>, <a class="ref fn" href="#FoundInstance" title='FoundInstance' data-ref="FoundInstance" data-ref-filename="FoundInstance">FoundInstance</a>, <a class="local col0 ref" href="#290info" title='info' data-ref="290info" data-ref-filename="290info">info</a>);</td></tr>
<tr><th id="2144">2144</th><td>    <b>if</b> (<a class="local col4 ref" href="#294err" title='err' data-ref="294err" data-ref-filename="294err">err</a>)</td></tr>
<tr><th id="2145">2145</th><td>    {</td></tr>
<tr><th id="2146">2146</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;mDNS_StartBrowse returned %d for type %##s domain %##s&quot;, err, info-&gt;u.browser.regtype.c, d-&gt;c)" data-ref="_M/LogMsg">LogMsg</a>(<q>"mDNS_StartBrowse returned %d for type %##s domain %##s"</q>, <a class="local col4 ref" href="#294err" title='err' data-ref="294err" data-ref-filename="294err">err</a>, <a class="local col0 ref" href="#290info" title='info' data-ref="290info" data-ref-filename="290info">info</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::regtype" title='request_state::(anonymous union)::(anonymous struct)::regtype' data-ref="request_state::(anonymousunion)::(anonymous)::regtype" data-ref-filename="request_state..(anonymousunion)..(anonymous)..regtype">regtype</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="local col1 ref" href="#291d" title='d' data-ref="291d" data-ref-filename="291d">d</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>);</td></tr>
<tr><th id="2147">2147</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(b)" data-ref="_M/freeL">freeL</a>(<q>"browser_t/add_domain_to_browser"</q>, <a class="local col2 ref" href="#292b" title='b' data-ref="292b" data-ref-filename="292b">b</a>);</td></tr>
<tr><th id="2148">2148</th><td>    }</td></tr>
<tr><th id="2149">2149</th><td>    <b>else</b></td></tr>
<tr><th id="2150">2150</th><td>    {</td></tr>
<tr><th id="2151">2151</th><td>        <a class="local col2 ref" href="#292b" title='b' data-ref="292b" data-ref-filename="292b">b</a>-&gt;<a class="ref field" href="uds_daemon.h.html#browser_t::next" title='browser_t::next' data-ref="browser_t::next" data-ref-filename="browser_t..next">next</a> = <a class="local col0 ref" href="#290info" title='info' data-ref="290info" data-ref-filename="290info">info</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::browsers" title='request_state::(anonymous union)::(anonymous struct)::browsers' data-ref="request_state::(anonymousunion)::(anonymous)::browsers" data-ref-filename="request_state..(anonymousunion)..(anonymous)..browsers">browsers</a>;</td></tr>
<tr><th id="2152">2152</th><td>        <a class="local col0 ref" href="#290info" title='info' data-ref="290info" data-ref-filename="290info">info</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::browsers" title='request_state::(anonymous union)::(anonymous struct)::browsers' data-ref="request_state::(anonymousunion)::(anonymous)::browsers" data-ref-filename="request_state..(anonymousunion)..(anonymous)..browsers">browsers</a> = <a class="local col2 ref" href="#292b" title='b' data-ref="292b" data-ref-filename="292b">b</a>;</td></tr>
<tr><th id="2153">2153</th><td></td></tr>
<tr><th id="2154">2154</th><td><u>#<span data-ppcond="2154">if</span> APPLE_OSX_mDNSResponder &amp;&amp; ENABLE_BLE_TRIGGERED_BONJOUR</u></td></tr>
<tr><th id="2155">2155</th><td>        <i>// Determine if this request should be promoted to use BLE triggered discovery.</i></td></tr>
<tr><th id="2156">2156</th><td>        <b>if</b> (shouldUseBLE(info-&gt;u.browser.interface_id, <var>0</var>, &amp;info-&gt;u.browser.regtype, (domainname *) d))</td></tr>
<tr><th id="2157">2157</th><td>        {</td></tr>
<tr><th id="2158">2158</th><td>            info-&gt;flags |= (kDNSServiceFlagsAutoTrigger | kDNSServiceFlagsIncludeAWDL);</td></tr>
<tr><th id="2159">2159</th><td>            b-&gt;q.flags |= (kDNSServiceFlagsAutoTrigger | kDNSServiceFlagsIncludeAWDL);</td></tr>
<tr><th id="2160">2160</th><td>            LogInfo(<q>"add_domain_to_browser: request promoted to use kDNSServiceFlagsAutoTrigger"</q>);</td></tr>
<tr><th id="2161">2161</th><td>        }</td></tr>
<tr><th id="2162">2162</th><td><u>#<span data-ppcond="2154">endif</span>  // APPLE_OSX_mDNSResponder &amp;&amp; ENABLE_BLE_TRIGGERED_BONJOUR</u></td></tr>
<tr><th id="2163">2163</th><td></td></tr>
<tr><th id="2164">2164</th><td>        <a class="macro" href="uds_daemon.h.html#224" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMcastQuestion" data-ref="_M/LogMcastQ">LogMcastQ</a>(&amp;<a class="local col2 ref" href="#292b" title='b' data-ref="292b" data-ref-filename="292b">b</a>-&gt;<a class="ref field" href="uds_daemon.h.html#browser_t::q" title='browser_t::q' data-ref="browser_t::q" data-ref-filename="browser_t..q">q</a>, <a class="local col0 ref" href="#290info" title='info' data-ref="290info" data-ref-filename="290info">info</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#q_start" title='q_start' data-ref="q_start" data-ref-filename="q_start">q_start</a>);</td></tr>
<tr><th id="2165">2165</th><td>        <b>if</b> (<a class="ref fn" href="#callExternalHelpers" title='callExternalHelpers' data-ref="callExternalHelpers" data-ref-filename="callExternalHelpers">callExternalHelpers</a>(<a class="local col0 ref" href="#290info" title='info' data-ref="290info" data-ref-filename="290info">info</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::interface_id" title='request_state::(anonymous union)::(anonymous struct)::interface_id' data-ref="request_state::(anonymousunion)::(anonymous)::interface_id" data-ref-filename="request_state..(anonymousunion)..(anonymous)..interface_id">interface_id</a>, &amp;<a class="local col2 ref" href="#292b" title='b' data-ref="292b" data-ref-filename="292b">b</a>-&gt;<a class="ref field" href="uds_daemon.h.html#browser_t::domain" title='browser_t::domain' data-ref="browser_t::domain" data-ref-filename="browser_t..domain">domain</a>, <a class="local col0 ref" href="#290info" title='info' data-ref="290info" data-ref-filename="290info">info</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a>))</td></tr>
<tr><th id="2166">2166</th><td>        {</td></tr>
<tr><th id="2167">2167</th><td>            <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#domainname" title='domainname' data-type='struct domainname' data-ref="domainname" data-ref-filename="domainname">domainname</a> <dfn class="local col5 decl" id="295tmp" title='tmp' data-type='domainname' data-ref="295tmp" data-ref-filename="295tmp">tmp</dfn>;</td></tr>
<tr><th id="2168">2168</th><td>            <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ConstructServiceName" title='ConstructServiceName' data-ref="ConstructServiceName" data-ref-filename="ConstructServiceName">ConstructServiceName</a>(&amp;<a class="local col5 ref" href="#295tmp" title='tmp' data-ref="295tmp" data-ref-filename="295tmp">tmp</a>, <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>, &amp;<a class="local col0 ref" href="#290info" title='info' data-ref="290info" data-ref-filename="290info">info</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::regtype" title='request_state::(anonymous union)::(anonymous struct)::regtype' data-ref="request_state::(anonymousunion)::(anonymous)::regtype" data-ref-filename="request_state..(anonymousunion)..(anonymous)..regtype">regtype</a>, &amp;<a class="local col2 ref" href="#292b" title='b' data-ref="292b" data-ref-filename="292b">b</a>-&gt;<a class="ref field" href="uds_daemon.h.html#browser_t::domain" title='browser_t::domain' data-ref="browser_t::domain" data-ref-filename="browser_t..domain">domain</a>);</td></tr>
<tr><th id="2169">2169</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;add_domain_to_browser: calling external_start_browsing_for_service()&quot;);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"add_domain_to_browser: calling external_start_browsing_for_service()"</q>);</td></tr>
<tr><th id="2170">2170</th><td>            <a class="macro" href="uds_daemon.h.html#264" title="(void)(info-&gt;u.browser.interface_id)" data-ref="_M/external_start_browsing_for_service">external_start_browsing_for_service</a>(<a class="local col0 ref" href="#290info" title='info' data-ref="290info" data-ref-filename="290info">info</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::interface_id" title='request_state::(anonymous union)::(anonymous struct)::interface_id' data-ref="request_state::(anonymousunion)::(anonymous)::interface_id" data-ref-filename="request_state..(anonymousunion)..(anonymous)..interface_id">interface_id</a>, &amp;tmp, kDNSType_PTR, info-&gt;flags);</td></tr>
<tr><th id="2171">2171</th><td>        }</td></tr>
<tr><th id="2172">2172</th><td>    }</td></tr>
<tr><th id="2173">2173</th><td>    <b>return</b> <a class="local col4 ref" href="#294err" title='err' data-ref="294err" data-ref-filename="294err">err</a>;</td></tr>
<tr><th id="2174">2174</th><td>}</td></tr>
<tr><th id="2175">2175</th><td></td></tr>
<tr><th id="2176">2176</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="browse_termination_callback" title='browse_termination_callback' data-ref="browse_termination_callback" data-ref-filename="browse_termination_callback">browse_termination_callback</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col6 decl" id="296info" title='info' data-type='request_state *' data-ref="296info" data-ref-filename="296info">info</dfn>)</td></tr>
<tr><th id="2177">2177</th><td>{</td></tr>
<tr><th id="2178">2178</th><td>    <b>if</b> (<a class="local col6 ref" href="#296info" title='info' data-ref="296info" data-ref-filename="296info">info</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::default_domain" title='request_state::(anonymous union)::(anonymous struct)::default_domain' data-ref="request_state::(anonymousunion)::(anonymous)::default_domain" data-ref-filename="request_state..(anonymousunion)..(anonymous)..default_domain">default_domain</a>)</td></tr>
<tr><th id="2179">2179</th><td>    {</td></tr>
<tr><th id="2180">2180</th><td>        <i>// Stop the domain enumeration queries to discover the WAB legacy browse domains</i></td></tr>
<tr><th id="2181">2181</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;%3d: DNSServiceBrowse Cancel WAB PID[%d](%s)&quot;, info-&gt;sd, info-&gt;process_id, info-&gt;pid_name);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"%3d: DNSServiceBrowse Cancel WAB PID[%d](%s)"</q>, <a class="local col6 ref" href="#296info" title='info' data-ref="296info" data-ref-filename="296info">info</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col6 ref" href="#296info" title='info' data-ref="296info" data-ref-filename="296info">info</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col6 ref" href="#296info" title='info' data-ref="296info" data-ref-filename="296info">info</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="2182">2182</th><td>        <a class="ref fn" href="../mDNSCore/uDNS.h.html#uDNS_StopWABQueries" title='uDNS_StopWABQueries' data-ref="uDNS_StopWABQueries" data-ref-filename="uDNS_StopWABQueries">uDNS_StopWABQueries</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="macro" href="../mDNSCore/uDNS.h.html#125" title="0x00000002" data-ref="_M/UDNS_WAB_LBROWSE_QUERY">UDNS_WAB_LBROWSE_QUERY</a>);</td></tr>
<tr><th id="2183">2183</th><td>    }</td></tr>
<tr><th id="2184">2184</th><td>    <b>if</b> (<a class="local col6 ref" href="#296info" title='info' data-ref="296info" data-ref-filename="296info">info</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::AnonData" title='request_state::(anonymous union)::(anonymous struct)::AnonData' data-ref="request_state::(anonymousunion)::(anonymous)::AnonData" data-ref-filename="request_state..(anonymousunion)..(anonymous)..AnonData">AnonData</a>)</td></tr>
<tr><th id="2185">2185</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free((void *)info-&gt;u.browser.AnonData)" data-ref="_M/freeL">freeL</a>(<q>"Anonymous"</q>, (<em>void</em> *)<a class="local col6 ref" href="#296info" title='info' data-ref="296info" data-ref-filename="296info">info</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::AnonData" title='request_state::(anonymous union)::(anonymous struct)::AnonData' data-ref="request_state::(anonymousunion)::(anonymous)::AnonData" data-ref-filename="request_state..(anonymousunion)..(anonymous)..AnonData">AnonData</a>);</td></tr>
<tr><th id="2186">2186</th><td>    <b>while</b> (<a class="local col6 ref" href="#296info" title='info' data-ref="296info" data-ref-filename="296info">info</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::browsers" title='request_state::(anonymous union)::(anonymous struct)::browsers' data-ref="request_state::(anonymousunion)::(anonymous)::browsers" data-ref-filename="request_state..(anonymousunion)..(anonymous)..browsers">browsers</a>)</td></tr>
<tr><th id="2187">2187</th><td>    {</td></tr>
<tr><th id="2188">2188</th><td>        <a class="typedef" href="uds_daemon.h.html#browser_t" title='browser_t' data-type='struct browser_t' data-ref="browser_t" data-ref-filename="browser_t">browser_t</a> *<dfn class="local col7 decl" id="297ptr" title='ptr' data-type='browser_t *' data-ref="297ptr" data-ref-filename="297ptr">ptr</dfn> = <a class="local col6 ref" href="#296info" title='info' data-ref="296info" data-ref-filename="296info">info</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::browsers" title='request_state::(anonymous union)::(anonymous struct)::browsers' data-ref="request_state::(anonymousunion)::(anonymous)::browsers" data-ref-filename="request_state..(anonymousunion)..(anonymous)..browsers">browsers</a>;</td></tr>
<tr><th id="2189">2189</th><td></td></tr>
<tr><th id="2190">2190</th><td>        <b>if</b> (<a class="ref fn" href="#callExternalHelpers" title='callExternalHelpers' data-ref="callExternalHelpers" data-ref-filename="callExternalHelpers">callExternalHelpers</a>(<a class="local col7 ref" href="#297ptr" title='ptr' data-ref="297ptr" data-ref-filename="297ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#browser_t::q" title='browser_t::q' data-ref="browser_t::q" data-ref-filename="browser_t..q">q</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::InterfaceID" title='DNSQuestion_struct::InterfaceID' data-ref="DNSQuestion_struct::InterfaceID" data-ref-filename="DNSQuestion_struct..InterfaceID">InterfaceID</a>, &amp;<a class="local col7 ref" href="#297ptr" title='ptr' data-ref="297ptr" data-ref-filename="297ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#browser_t::domain" title='browser_t::domain' data-ref="browser_t::domain" data-ref-filename="browser_t..domain">domain</a>, <a class="local col7 ref" href="#297ptr" title='ptr' data-ref="297ptr" data-ref-filename="297ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#browser_t::q" title='browser_t::q' data-ref="browser_t::q" data-ref-filename="browser_t..q">q</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::flags" title='DNSQuestion_struct::flags' data-ref="DNSQuestion_struct::flags" data-ref-filename="DNSQuestion_struct..flags">flags</a>))</td></tr>
<tr><th id="2191">2191</th><td>        {</td></tr>
<tr><th id="2192">2192</th><td>            <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#domainname" title='domainname' data-type='struct domainname' data-ref="domainname" data-ref-filename="domainname">domainname</a> <dfn class="local col8 decl" id="298tmp" title='tmp' data-type='domainname' data-ref="298tmp" data-ref-filename="298tmp">tmp</dfn>;</td></tr>
<tr><th id="2193">2193</th><td>            <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ConstructServiceName" title='ConstructServiceName' data-ref="ConstructServiceName" data-ref-filename="ConstructServiceName">ConstructServiceName</a>(&amp;<a class="local col8 ref" href="#298tmp" title='tmp' data-ref="298tmp" data-ref-filename="298tmp">tmp</a>, <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>, &amp;<a class="local col6 ref" href="#296info" title='info' data-ref="296info" data-ref-filename="296info">info</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::regtype" title='request_state::(anonymous union)::(anonymous struct)::regtype' data-ref="request_state::(anonymousunion)::(anonymous)::regtype" data-ref-filename="request_state..(anonymousunion)..(anonymous)..regtype">regtype</a>, &amp;<a class="local col7 ref" href="#297ptr" title='ptr' data-ref="297ptr" data-ref-filename="297ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#browser_t::domain" title='browser_t::domain' data-ref="browser_t::domain" data-ref-filename="browser_t..domain">domain</a>);</td></tr>
<tr><th id="2194">2194</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;browse_termination_callback: calling external_stop_browsing_for_service()&quot;);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"browse_termination_callback: calling external_stop_browsing_for_service()"</q>);</td></tr>
<tr><th id="2195">2195</th><td>            <a class="macro" href="uds_daemon.h.html#265" title="(void)(ptr-&gt;q.InterfaceID)" data-ref="_M/external_stop_browsing_for_service">external_stop_browsing_for_service</a>(<a class="local col7 ref" href="#297ptr" title='ptr' data-ref="297ptr" data-ref-filename="297ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#browser_t::q" title='browser_t::q' data-ref="browser_t::q" data-ref-filename="browser_t..q">q</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::InterfaceID" title='DNSQuestion_struct::InterfaceID' data-ref="DNSQuestion_struct::InterfaceID" data-ref-filename="DNSQuestion_struct..InterfaceID">InterfaceID</a>, &amp;tmp, kDNSType_PTR, ptr-&gt;q.flags);</td></tr>
<tr><th id="2196">2196</th><td>        }</td></tr>
<tr><th id="2197">2197</th><td></td></tr>
<tr><th id="2198">2198</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: DNSServiceBrowse(%X, %d, \&quot;%##s\&quot;) STOP PID[%d](%s)&quot;, info-&gt;sd, info-&gt;flags, info-&gt;interfaceIndex, ptr-&gt;q.qname.c, info-&gt;process_id, info-&gt;pid_name);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: DNSServiceBrowse(%X, %d, \"%##s\") STOP PID[%d](%s)"</q>,</td></tr>
<tr><th id="2199">2199</th><td>                     <a class="local col6 ref" href="#296info" title='info' data-ref="296info" data-ref-filename="296info">info</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col6 ref" href="#296info" title='info' data-ref="296info" data-ref-filename="296info">info</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a>, <a class="local col6 ref" href="#296info" title='info' data-ref="296info" data-ref-filename="296info">info</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::interfaceIndex" title='request_state::interfaceIndex' data-ref="request_state::interfaceIndex" data-ref-filename="request_state..interfaceIndex">interfaceIndex</a>, <a class="local col7 ref" href="#297ptr" title='ptr' data-ref="297ptr" data-ref-filename="297ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#browser_t::q" title='browser_t::q' data-ref="browser_t::q" data-ref-filename="browser_t..q">q</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="local col6 ref" href="#296info" title='info' data-ref="296info" data-ref-filename="296info">info</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col6 ref" href="#296info" title='info' data-ref="296info" data-ref-filename="296info">info</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="2200">2200</th><td></td></tr>
<tr><th id="2201">2201</th><td>        <a class="local col6 ref" href="#296info" title='info' data-ref="296info" data-ref-filename="296info">info</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::browsers" title='request_state::(anonymous union)::(anonymous struct)::browsers' data-ref="request_state::(anonymousunion)::(anonymous)::browsers" data-ref-filename="request_state..(anonymousunion)..(anonymous)..browsers">browsers</a> = <a class="local col7 ref" href="#297ptr" title='ptr' data-ref="297ptr" data-ref-filename="297ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#browser_t::next" title='browser_t::next' data-ref="browser_t::next" data-ref-filename="browser_t..next">next</a>;</td></tr>
<tr><th id="2202">2202</th><td>        <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2806" title="mDNS_StopQuery" data-ref="_M/mDNS_StopBrowse">mDNS_StopBrowse</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col7 ref" href="#297ptr" title='ptr' data-ref="297ptr" data-ref-filename="297ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#browser_t::q" title='browser_t::q' data-ref="browser_t::q" data-ref-filename="browser_t..q">q</a>);  <i>// no need to error-check result</i></td></tr>
<tr><th id="2203">2203</th><td>        <a class="macro" href="uds_daemon.h.html#224" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMcastQuestion" data-ref="_M/LogMcastQ">LogMcastQ</a>(&amp;<a class="local col7 ref" href="#297ptr" title='ptr' data-ref="297ptr" data-ref-filename="297ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#browser_t::q" title='browser_t::q' data-ref="browser_t::q" data-ref-filename="browser_t..q">q</a>, <a class="local col6 ref" href="#296info" title='info' data-ref="296info" data-ref-filename="296info">info</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#q_stop" title='q_stop' data-ref="q_stop" data-ref-filename="q_stop">q_stop</a>);</td></tr>
<tr><th id="2204">2204</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(ptr)" data-ref="_M/freeL">freeL</a>(<q>"browser_t/browse_termination_callback"</q>, <a class="local col7 ref" href="#297ptr" title='ptr' data-ref="297ptr" data-ref-filename="297ptr">ptr</a>);</td></tr>
<tr><th id="2205">2205</th><td>    }</td></tr>
<tr><th id="2206">2206</th><td>}</td></tr>
<tr><th id="2207">2207</th><td></td></tr>
<tr><th id="2208">2208</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="udsserver_automatic_browse_domain_changed" title='udsserver_automatic_browse_domain_changed' data-ref="udsserver_automatic_browse_domain_changed" data-ref-filename="udsserver_automatic_browse_domain_changed">udsserver_automatic_browse_domain_changed</dfn>(<em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem" title='DNameListElem' data-type='struct DNameListElem' data-ref="DNameListElem" data-ref-filename="DNameListElem">DNameListElem</a> *<em>const</em> <dfn class="local col9 decl" id="299d" title='d' data-type='const DNameListElem *const' data-ref="299d" data-ref-filename="299d">d</dfn>, <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSBool" title='mDNSBool' data-type='unsigned char' data-ref="mDNSBool" data-ref-filename="mDNSBool">mDNSBool</a> <dfn class="local col0 decl" id="300add" title='add' data-type='const mDNSBool' data-ref="300add" data-ref-filename="300add">add</dfn>)</td></tr>
<tr><th id="2209">2209</th><td>{</td></tr>
<tr><th id="2210">2210</th><td>    <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col1 decl" id="301request" title='request' data-type='request_state *' data-ref="301request" data-ref-filename="301request">request</dfn>;</td></tr>
<tr><th id="2211">2211</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#131" title="debug_noop" data-ref="_M/debugf">debugf</a>(<q>"udsserver_automatic_browse_domain_changed: %s default browse domain %##s"</q>, add ? <q>"Adding"</q> : <q>"Removing"</q>, d-&gt;name.c);</td></tr>
<tr><th id="2212">2212</th><td></td></tr>
<tr><th id="2213">2213</th><td>    <b>for</b> (<a class="local col1 ref" href="#301request" title='request' data-ref="301request" data-ref-filename="301request">request</a> = <a class="tu ref" href="#all_requests" title='all_requests' data-use='r' data-ref="all_requests" data-ref-filename="all_requests">all_requests</a>; <a class="local col1 ref" href="#301request" title='request' data-ref="301request" data-ref-filename="301request">request</a>; <a class="local col1 ref" href="#301request" title='request' data-ref="301request" data-ref-filename="301request">request</a> = <a class="local col1 ref" href="#301request" title='request' data-ref="301request" data-ref-filename="301request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::next" title='request_state::next' data-ref="request_state::next" data-ref-filename="request_state..next">next</a>)</td></tr>
<tr><th id="2214">2214</th><td>    {</td></tr>
<tr><th id="2215">2215</th><td>        <b>if</b> (<a class="local col1 ref" href="#301request" title='request' data-ref="301request" data-ref-filename="301request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> != <a class="ref fn" href="#browse_termination_callback" title='browse_termination_callback' data-ref="browse_termination_callback" data-ref-filename="browse_termination_callback">browse_termination_callback</a>) <b>continue</b>;    <i>// Not a browse operation</i></td></tr>
<tr><th id="2216">2216</th><td>        <b>if</b> (!<a class="local col1 ref" href="#301request" title='request' data-ref="301request" data-ref-filename="301request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::default_domain" title='request_state::(anonymous union)::(anonymous struct)::default_domain' data-ref="request_state::(anonymousunion)::(anonymous)::default_domain" data-ref-filename="request_state..(anonymousunion)..(anonymous)..default_domain">default_domain</a>) <b>continue</b>;                   <i>// Not an auto-browse operation</i></td></tr>
<tr><th id="2217">2217</th><td>        <b>if</b> (!<a class="local col9 ref" href="#299d" title='d' data-ref="299d" data-ref-filename="299d">d</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::uid" title='DNameListElem::uid' data-ref="DNameListElem::uid" data-ref-filename="DNameListElem..uid">uid</a> || <a class="macro" href="#83" title="((request-&gt;uid) &lt;= 500)" data-ref="_M/SystemUID">SystemUID</a>(<a class="local col1 ref" href="#301request" title='request' data-ref="301request" data-ref-filename="301request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::uid" title='request_state::uid' data-ref="request_state::uid" data-ref-filename="request_state..uid">uid</a>) || <a class="local col1 ref" href="#301request" title='request' data-ref="301request" data-ref-filename="301request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::uid" title='request_state::uid' data-ref="request_state::uid" data-ref-filename="request_state..uid">uid</a> == <a class="local col9 ref" href="#299d" title='d' data-ref="299d" data-ref-filename="299d">d</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::uid" title='DNameListElem::uid' data-ref="DNameListElem::uid" data-ref-filename="DNameListElem..uid">uid</a>)</td></tr>
<tr><th id="2218">2218</th><td>        {</td></tr>
<tr><th id="2219">2219</th><td>            <a class="typedef" href="uds_daemon.h.html#browser_t" title='browser_t' data-type='struct browser_t' data-ref="browser_t" data-ref-filename="browser_t">browser_t</a> **<dfn class="local col2 decl" id="302ptr" title='ptr' data-type='browser_t **' data-ref="302ptr" data-ref-filename="302ptr">ptr</dfn> = &amp;<a class="local col1 ref" href="#301request" title='request' data-ref="301request" data-ref-filename="301request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::browsers" title='request_state::(anonymous union)::(anonymous struct)::browsers' data-ref="request_state::(anonymousunion)::(anonymous)::browsers" data-ref-filename="request_state..(anonymousunion)..(anonymous)..browsers">browsers</a>;</td></tr>
<tr><th id="2220">2220</th><td>            <b>while</b> (*<a class="local col2 ref" href="#302ptr" title='ptr' data-ref="302ptr" data-ref-filename="302ptr">ptr</a> &amp;&amp; !<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#SameDomainName" title='SameDomainName' data-ref="SameDomainName" data-ref-filename="SameDomainName">SameDomainName</a>(&amp;(*<a class="local col2 ref" href="#302ptr" title='ptr' data-ref="302ptr" data-ref-filename="302ptr">ptr</a>)-&gt;<a class="ref field" href="uds_daemon.h.html#browser_t::domain" title='browser_t::domain' data-ref="browser_t::domain" data-ref-filename="browser_t..domain">domain</a>, &amp;<a class="local col9 ref" href="#299d" title='d' data-ref="299d" data-ref-filename="299d">d</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::name" title='DNameListElem::name' data-ref="DNameListElem::name" data-ref-filename="DNameListElem..name">name</a>)) <a class="local col2 ref" href="#302ptr" title='ptr' data-ref="302ptr" data-ref-filename="302ptr">ptr</a> = &amp;(*<a class="local col2 ref" href="#302ptr" title='ptr' data-ref="302ptr" data-ref-filename="302ptr">ptr</a>)-&gt;<a class="ref field" href="uds_daemon.h.html#browser_t::next" title='browser_t::next' data-ref="browser_t::next" data-ref-filename="browser_t..next">next</a>;</td></tr>
<tr><th id="2221">2221</th><td>            <b>if</b> (<a class="local col0 ref" href="#300add" title='add' data-ref="300add" data-ref-filename="300add">add</a>)</td></tr>
<tr><th id="2222">2222</th><td>            {</td></tr>
<tr><th id="2223">2223</th><td>                <i>// If we don't already have this domain in our list for this browse operation, add it now</i></td></tr>
<tr><th id="2224">2224</th><td>                <b>if</b> (!*<a class="local col2 ref" href="#302ptr" title='ptr' data-ref="302ptr" data-ref-filename="302ptr">ptr</a>) <a class="ref fn" href="#add_domain_to_browser" title='add_domain_to_browser' data-ref="add_domain_to_browser" data-ref-filename="add_domain_to_browser">add_domain_to_browser</a>(<a class="local col1 ref" href="#301request" title='request' data-ref="301request" data-ref-filename="301request">request</a>, &amp;<a class="local col9 ref" href="#299d" title='d' data-ref="299d" data-ref-filename="299d">d</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::name" title='DNameListElem::name' data-ref="DNameListElem::name" data-ref-filename="DNameListElem..name">name</a>);</td></tr>
<tr><th id="2225">2225</th><td>                <b>else</b> <a class="macro" href="../mDNSCore/mDNSDebug.h.html#131" title="debug_noop" data-ref="_M/debugf">debugf</a>(<q>"udsserver_automatic_browse_domain_changed %##s already in list, not re-adding"</q>, &amp;d-&gt;name);</td></tr>
<tr><th id="2226">2226</th><td>            }</td></tr>
<tr><th id="2227">2227</th><td>            <b>else</b></td></tr>
<tr><th id="2228">2228</th><td>            {</td></tr>
<tr><th id="2229">2229</th><td>                <b>if</b> (!*<a class="local col2 ref" href="#302ptr" title='ptr' data-ref="302ptr" data-ref-filename="302ptr">ptr</a>) <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;udsserver_automatic_browse_domain_changed ERROR %##s not found&quot;, &amp;d-&gt;name)" data-ref="_M/LogMsg">LogMsg</a>(<q>"udsserver_automatic_browse_domain_changed ERROR %##s not found"</q>, &amp;<a class="local col9 ref" href="#299d" title='d' data-ref="299d" data-ref-filename="299d">d</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::name" title='DNameListElem::name' data-ref="DNameListElem::name" data-ref-filename="DNameListElem..name">name</a>);</td></tr>
<tr><th id="2230">2230</th><td>                <b>else</b></td></tr>
<tr><th id="2231">2231</th><td>                {</td></tr>
<tr><th id="2232">2232</th><td>                    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem" title='DNameListElem' data-type='struct DNameListElem' data-ref="DNameListElem" data-ref-filename="DNameListElem">DNameListElem</a> *<dfn class="local col3 decl" id="303p" title='p' data-type='DNameListElem *' data-ref="303p" data-ref-filename="303p">p</dfn>;</td></tr>
<tr><th id="2233">2233</th><td>                    <b>for</b> (<a class="local col3 ref" href="#303p" title='p' data-ref="303p" data-ref-filename="303p">p</a> = <a class="ref" href="uds_daemon.h.html#AutoBrowseDomains" title='AutoBrowseDomains' data-ref="AutoBrowseDomains" data-ref-filename="AutoBrowseDomains">AutoBrowseDomains</a>; <a class="local col3 ref" href="#303p" title='p' data-ref="303p" data-ref-filename="303p">p</a>; <a class="local col3 ref" href="#303p" title='p' data-ref="303p" data-ref-filename="303p">p</a>=<a class="local col3 ref" href="#303p" title='p' data-ref="303p" data-ref-filename="303p">p</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::next" title='DNameListElem::next' data-ref="DNameListElem::next" data-ref-filename="DNameListElem..next">next</a>)</td></tr>
<tr><th id="2234">2234</th><td>                        <b>if</b> (!<a class="local col3 ref" href="#303p" title='p' data-ref="303p" data-ref-filename="303p">p</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::uid" title='DNameListElem::uid' data-ref="DNameListElem::uid" data-ref-filename="DNameListElem..uid">uid</a> || <a class="macro" href="#83" title="((request-&gt;uid) &lt;= 500)" data-ref="_M/SystemUID">SystemUID</a>(<a class="local col1 ref" href="#301request" title='request' data-ref="301request" data-ref-filename="301request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::uid" title='request_state::uid' data-ref="request_state::uid" data-ref-filename="request_state..uid">uid</a>) || <a class="local col1 ref" href="#301request" title='request' data-ref="301request" data-ref-filename="301request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::uid" title='request_state::uid' data-ref="request_state::uid" data-ref-filename="request_state..uid">uid</a> == <a class="local col3 ref" href="#303p" title='p' data-ref="303p" data-ref-filename="303p">p</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::uid" title='DNameListElem::uid' data-ref="DNameListElem::uid" data-ref-filename="DNameListElem..uid">uid</a>)</td></tr>
<tr><th id="2235">2235</th><td>                            <b>if</b> (<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#SameDomainName" title='SameDomainName' data-ref="SameDomainName" data-ref-filename="SameDomainName">SameDomainName</a>(&amp;<a class="local col9 ref" href="#299d" title='d' data-ref="299d" data-ref-filename="299d">d</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::name" title='DNameListElem::name' data-ref="DNameListElem::name" data-ref-filename="DNameListElem..name">name</a>, &amp;<a class="local col3 ref" href="#303p" title='p' data-ref="303p" data-ref-filename="303p">p</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::name" title='DNameListElem::name' data-ref="DNameListElem::name" data-ref-filename="DNameListElem..name">name</a>)) <b>break</b>;</td></tr>
<tr><th id="2236">2236</th><td>                    <b>if</b> (<a class="local col3 ref" href="#303p" title='p' data-ref="303p" data-ref-filename="303p">p</a>) <a class="macro" href="../mDNSCore/mDNSDebug.h.html#131" title="debug_noop" data-ref="_M/debugf">debugf</a>(<q>"udsserver_automatic_browse_domain_changed %##s still in list, not removing"</q>, &amp;d-&gt;name);</td></tr>
<tr><th id="2237">2237</th><td>                    <b>else</b></td></tr>
<tr><th id="2238">2238</th><td>                    {</td></tr>
<tr><th id="2239">2239</th><td>                        <a class="typedef" href="uds_daemon.h.html#browser_t" title='browser_t' data-type='struct browser_t' data-ref="browser_t" data-ref-filename="browser_t">browser_t</a> *<dfn class="local col4 decl" id="304rem" title='rem' data-type='browser_t *' data-ref="304rem" data-ref-filename="304rem">rem</dfn> = *<a class="local col2 ref" href="#302ptr" title='ptr' data-ref="302ptr" data-ref-filename="302ptr">ptr</a>;</td></tr>
<tr><th id="2240">2240</th><td>                        *<a class="local col2 ref" href="#302ptr" title='ptr' data-ref="302ptr" data-ref-filename="302ptr">ptr</a> = (*<a class="local col2 ref" href="#302ptr" title='ptr' data-ref="302ptr" data-ref-filename="302ptr">ptr</a>)-&gt;<a class="ref field" href="uds_daemon.h.html#browser_t::next" title='browser_t::next' data-ref="browser_t::next" data-ref-filename="browser_t..next">next</a>;</td></tr>
<tr><th id="2241">2241</th><td>                        <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_StopQueryWithRemoves" title='mDNS_StopQueryWithRemoves' data-ref="mDNS_StopQueryWithRemoves" data-ref-filename="mDNS_StopQueryWithRemoves">mDNS_StopQueryWithRemoves</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col4 ref" href="#304rem" title='rem' data-ref="304rem" data-ref-filename="304rem">rem</a>-&gt;<a class="ref field" href="uds_daemon.h.html#browser_t::q" title='browser_t::q' data-ref="browser_t::q" data-ref-filename="browser_t..q">q</a>);</td></tr>
<tr><th id="2242">2242</th><td>                        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(rem)" data-ref="_M/freeL">freeL</a>(<q>"browser_t/udsserver_automatic_browse_domain_changed"</q>, <a class="local col4 ref" href="#304rem" title='rem' data-ref="304rem" data-ref-filename="304rem">rem</a>);</td></tr>
<tr><th id="2243">2243</th><td>                    }</td></tr>
<tr><th id="2244">2244</th><td>                }</td></tr>
<tr><th id="2245">2245</th><td>            }</td></tr>
<tr><th id="2246">2246</th><td>        }</td></tr>
<tr><th id="2247">2247</th><td>    }</td></tr>
<tr><th id="2248">2248</th><td>}</td></tr>
<tr><th id="2249">2249</th><td></td></tr>
<tr><th id="2250">2250</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="FreeARElemCallback" title='FreeARElemCallback' data-ref="FreeARElemCallback" data-ref-filename="FreeARElemCallback">FreeARElemCallback</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS" title='mDNS' data-type='struct mDNS_struct' data-ref="mDNS" data-ref-filename="mDNS">mDNS</a> *<em>const</em> <dfn class="local col5 decl" id="305m" title='m' data-type='mDNS *const' data-ref="305m" data-ref-filename="305m">m</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord" title='AuthRecord' data-type='struct AuthRecord_struct' data-ref="AuthRecord" data-ref-filename="AuthRecord">AuthRecord</a> *<em>const</em> <dfn class="local col6 decl" id="306rr" title='rr' data-type='AuthRecord *const' data-ref="306rr" data-ref-filename="306rr">rr</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="local col7 decl" id="307result" title='result' data-type='mStatus' data-ref="307result" data-ref-filename="307result">result</dfn>)</td></tr>
<tr><th id="2251">2251</th><td>{</td></tr>
<tr><th id="2252">2252</th><td>    (<em>void</em>)<a class="local col5 ref" href="#305m" title='m' data-ref="305m" data-ref-filename="305m">m</a>;  <i>// unused</i></td></tr>
<tr><th id="2253">2253</th><td>    <b>if</b> (<a class="local col7 ref" href="#307result" title='result' data-ref="307result" data-ref-filename="307result">result</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_MemFree" title='mStatus_MemFree' data-ref="mStatus_MemFree" data-ref-filename="mStatus_MemFree">mStatus_MemFree</a>)</td></tr>
<tr><th id="2254">2254</th><td>    {</td></tr>
<tr><th id="2255">2255</th><td>        <i>// On shutdown, mDNS_Close automatically deregisters all records</i></td></tr>
<tr><th id="2256">2256</th><td><i>        // Since in this case no one has called DeregisterLocalOnlyDomainEnumPTR to cut the record</i></td></tr>
<tr><th id="2257">2257</th><td><i>        // from the LocalDomainEnumRecords list, we do this here before we free the memory.</i></td></tr>
<tr><th id="2258">2258</th><td><i>        // (This should actually no longer be necessary, now that we do the proper cleanup in</i></td></tr>
<tr><th id="2259">2259</th><td><i>        // udsserver_exit. To confirm this, we'll log an error message if we do find a record that</i></td></tr>
<tr><th id="2260">2260</th><td><i>        // hasn't been cut from the list yet. If these messages don't appear, we can delete this code.)</i></td></tr>
<tr><th id="2261">2261</th><td>        <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ARListElem" title='ARListElem' data-type='struct ARListElem' data-ref="ARListElem" data-ref-filename="ARListElem">ARListElem</a> **<dfn class="local col8 decl" id="308ptr" title='ptr' data-type='ARListElem **' data-ref="308ptr" data-ref-filename="308ptr">ptr</dfn> = &amp;<a class="tu ref" href="#LocalDomainEnumRecords" title='LocalDomainEnumRecords' data-use='a' data-ref="LocalDomainEnumRecords" data-ref-filename="LocalDomainEnumRecords">LocalDomainEnumRecords</a>;</td></tr>
<tr><th id="2262">2262</th><td>        <b>while</b> (*<a class="local col8 ref" href="#308ptr" title='ptr' data-ref="308ptr" data-ref-filename="308ptr">ptr</a> &amp;&amp; &amp;(*<a class="local col8 ref" href="#308ptr" title='ptr' data-ref="308ptr" data-ref-filename="308ptr">ptr</a>)-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ARListElem::ar" title='ARListElem::ar' data-ref="ARListElem::ar" data-ref-filename="ARListElem..ar">ar</a> != <a class="local col6 ref" href="#306rr" title='rr' data-ref="306rr" data-ref-filename="306rr">rr</a>) <a class="local col8 ref" href="#308ptr" title='ptr' data-ref="308ptr" data-ref-filename="308ptr">ptr</a> = &amp;(*<a class="local col8 ref" href="#308ptr" title='ptr' data-ref="308ptr" data-ref-filename="308ptr">ptr</a>)-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ARListElem::next" title='ARListElem::next' data-ref="ARListElem::next" data-ref-filename="ARListElem..next">next</a>;</td></tr>
<tr><th id="2263">2263</th><td>        <b>if</b> (*<a class="local col8 ref" href="#308ptr" title='ptr' data-ref="308ptr" data-ref-filename="308ptr">ptr</a>) { *<a class="local col8 ref" href="#308ptr" title='ptr' data-ref="308ptr" data-ref-filename="308ptr">ptr</a> = (*<a class="local col8 ref" href="#308ptr" title='ptr' data-ref="308ptr" data-ref-filename="308ptr">ptr</a>)-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ARListElem::next" title='ARListElem::next' data-ref="ARListElem::next" data-ref-filename="ARListElem..next">next</a>; <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;FreeARElemCallback: Have to cut %s&quot;, GetRRDisplayString_rdb(&amp;(rr)-&gt;resrec, &amp;(rr)-&gt;resrec.rdata-&gt;u, (m)-&gt;MsgBuffer))" data-ref="_M/LogMsg">LogMsg</a>(<q>"FreeARElemCallback: Have to cut %s"</q>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2942" title="GetRRDisplayString_rdb(&amp;(rr)-&gt;resrec, &amp;(rr)-&gt;resrec.rdata-&gt;u, (m)-&gt;MsgBuffer)" data-ref="_M/ARDisplayString">ARDisplayString</a>(<a class="local col5 ref" href="#305m" title='m' data-ref="305m" data-ref-filename="305m">m</a>, <a class="local col6 ref" href="#306rr" title='rr' data-ref="306rr" data-ref-filename="306rr">rr</a>)); }</td></tr>
<tr><th id="2264">2264</th><td>        <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformMemFree" title='mDNSPlatformMemFree' data-ref="mDNSPlatformMemFree" data-ref-filename="mDNSPlatformMemFree">mDNSPlatformMemFree</a>(<a class="local col6 ref" href="#306rr" title='rr' data-ref="306rr" data-ref-filename="306rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::RecordContext" title='AuthRecord_struct::RecordContext' data-ref="AuthRecord_struct::RecordContext" data-ref-filename="AuthRecord_struct..RecordContext">RecordContext</a>);</td></tr>
<tr><th id="2265">2265</th><td>    }</td></tr>
<tr><th id="2266">2266</th><td>}</td></tr>
<tr><th id="2267">2267</th><td></td></tr>
<tr><th id="2268">2268</th><td><i>// RegisterLocalOnlyDomainEnumPTR and DeregisterLocalOnlyDomainEnumPTR largely duplicate code in</i></td></tr>
<tr><th id="2269">2269</th><td><i>// "FoundDomain" in uDNS.c for creating and destroying these special mDNSInterface_LocalOnly records.</i></td></tr>
<tr><th id="2270">2270</th><td><i>// We may want to turn the common code into a subroutine.</i></td></tr>
<tr><th id="2271">2271</th><td></td></tr>
<tr><th id="2272">2272</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="RegisterLocalOnlyDomainEnumPTR" title='RegisterLocalOnlyDomainEnumPTR' data-ref="RegisterLocalOnlyDomainEnumPTR" data-ref-filename="RegisterLocalOnlyDomainEnumPTR">RegisterLocalOnlyDomainEnumPTR</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS" title='mDNS' data-type='struct mDNS_struct' data-ref="mDNS" data-ref-filename="mDNS">mDNS</a> *<dfn class="local col9 decl" id="309m" title='m' data-type='mDNS *' data-ref="309m" data-ref-filename="309m">m</dfn>, <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#domainname" title='domainname' data-type='struct domainname' data-ref="domainname" data-ref-filename="domainname">domainname</a> *<dfn class="local col0 decl" id="310d" title='d' data-type='const domainname *' data-ref="310d" data-ref-filename="310d">d</dfn>, <em>int</em> <dfn class="local col1 decl" id="311type" title='type' data-type='int' data-ref="311type" data-ref-filename="311type">type</dfn>)</td></tr>
<tr><th id="2273">2273</th><td>{</td></tr>
<tr><th id="2274">2274</th><td>    <i>// allocate/register legacy and non-legacy _browse PTR record</i></td></tr>
<tr><th id="2275">2275</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="local col2 decl" id="312err" title='err' data-type='mStatus' data-ref="312err" data-ref-filename="312err">err</dfn>;</td></tr>
<tr><th id="2276">2276</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ARListElem" title='ARListElem' data-type='struct ARListElem' data-ref="ARListElem" data-ref-filename="ARListElem">ARListElem</a> *<dfn class="local col3 decl" id="313ptr" title='ptr' data-type='ARListElem *' data-ref="313ptr" data-ref-filename="313ptr">ptr</dfn> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformMemAllocate" title='mDNSPlatformMemAllocate' data-ref="mDNSPlatformMemAllocate" data-ref-filename="mDNSPlatformMemAllocate">mDNSPlatformMemAllocate</a>(<b>sizeof</b>(*<a class="local col3 ref" href="#313ptr" title='ptr' data-ref="313ptr" data-ref-filename="313ptr">ptr</a>));</td></tr>
<tr><th id="2277">2277</th><td></td></tr>
<tr><th id="2278">2278</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#131" title="debug_noop" data-ref="_M/debugf">debugf</a>(<q>"Incrementing %s refcount for %##s"</q>,</td></tr>
<tr><th id="2279">2279</th><td>           (type == mDNS_DomainTypeBrowse         ) ? <q>"browse domain   "</q> :</td></tr>
<tr><th id="2280">2280</th><td>           (type == mDNS_DomainTypeRegistration   ) ? <q>"registration dom"</q> :</td></tr>
<tr><th id="2281">2281</th><td>           (type == mDNS_DomainTypeBrowseAutomatic) ? <q>"automatic browse"</q> : <q>"?"</q>, d-&gt;c);</td></tr>
<tr><th id="2282">2282</th><td></td></tr>
<tr><th id="2283">2283</th><td>    <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_SetupResourceRecord" title='mDNS_SetupResourceRecord' data-ref="mDNS_SetupResourceRecord" data-ref-filename="mDNS_SetupResourceRecord">mDNS_SetupResourceRecord</a>(&amp;<a class="local col3 ref" href="#313ptr" title='ptr' data-ref="313ptr" data-ref-filename="313ptr">ptr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ARListElem::ar" title='ARListElem::ar' data-ref="ARListElem::ar" data-ref-filename="ARListElem..ar">ar</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>, <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterface_LocalOnly" title='mDNSInterface_LocalOnly' data-ref="mDNSInterface_LocalOnly" data-ref-filename="mDNSInterface_LocalOnly">mDNSInterface_LocalOnly</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSType_PTR" title='kDNSType_PTR' data-ref="kDNSType_PTR" data-ref-filename="kDNSType_PTR">kDNSType_PTR</a>, <var>7200</var>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSRecordTypeShared" title='kDNSRecordTypeShared' data-ref="kDNSRecordTypeShared" data-ref-filename="kDNSRecordTypeShared">kDNSRecordTypeShared</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecordLocalOnly" title='AuthRecordLocalOnly' data-ref="AuthRecordLocalOnly" data-ref-filename="AuthRecordLocalOnly">AuthRecordLocalOnly</a>, <a class="ref fn" href="#FreeARElemCallback" title='FreeARElemCallback' data-ref="FreeARElemCallback" data-ref-filename="FreeARElemCallback">FreeARElemCallback</a>, <a class="local col3 ref" href="#313ptr" title='ptr' data-ref="313ptr" data-ref-filename="313ptr">ptr</a>);</td></tr>
<tr><th id="2284">2284</th><td>    <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#MakeDomainNameFromDNSNameString" title='MakeDomainNameFromDNSNameString' data-ref="MakeDomainNameFromDNSNameString" data-ref-filename="MakeDomainNameFromDNSNameString">MakeDomainNameFromDNSNameString</a>(&amp;<a class="local col3 ref" href="#313ptr" title='ptr' data-ref="313ptr" data-ref-filename="313ptr">ptr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ARListElem::ar" title='ARListElem::ar' data-ref="ARListElem::ar" data-ref-filename="ARListElem..ar">ar</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::namestorage" title='AuthRecord_struct::namestorage' data-ref="AuthRecord_struct::namestorage" data-ref-filename="AuthRecord_struct..namestorage">namestorage</a>, <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_DomainTypeNames" title='mDNS_DomainTypeNames' data-ref="mDNS_DomainTypeNames" data-ref-filename="mDNS_DomainTypeNames">mDNS_DomainTypeNames</a>[<a class="local col1 ref" href="#311type" title='type' data-ref="311type" data-ref-filename="311type">type</a>]);</td></tr>
<tr><th id="2285">2285</th><td>    <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AppendDNSNameString" title='AppendDNSNameString' data-ref="AppendDNSNameString" data-ref-filename="AppendDNSNameString">AppendDNSNameString</a>            (&amp;<a class="local col3 ref" href="#313ptr" title='ptr' data-ref="313ptr" data-ref-filename="313ptr">ptr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ARListElem::ar" title='ARListElem::ar' data-ref="ARListElem::ar" data-ref-filename="ARListElem..ar">ar</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::namestorage" title='AuthRecord_struct::namestorage' data-ref="AuthRecord_struct::namestorage" data-ref-filename="AuthRecord_struct..namestorage">namestorage</a>, <q>"local"</q>);</td></tr>
<tr><th id="2286">2286</th><td>    <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2849" title="do { mDNSu16 len__ = DomainNameLengthLimit(((d)), ((d))-&gt;c + 256); if (len__ &lt;= 256) mDNSPlatformMemCopy((&amp;ptr-&gt;ar.resrec.rdata-&gt;u.name)-&gt;c, (d)-&gt;c, len__); else (&amp;ptr-&gt;ar.resrec.rdata-&gt;u.name)-&gt;c[0] = 0; } while(0)" data-ref="_M/AssignDomainName">AssignDomainName</a>(&amp;<a class="local col3 ref" href="#313ptr" title='ptr' data-ref="313ptr" data-ref-filename="313ptr">ptr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ARListElem::ar" title='ARListElem::ar' data-ref="ARListElem::ar" data-ref-filename="ARListElem..ar">ar</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdata" title='ResourceRecord_struct::rdata' data-ref="ResourceRecord_struct::rdata" data-ref-filename="ResourceRecord_struct..rdata">rdata</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::u" title='(anonymous struct)::u' data-ref="(anonymous)::u" data-ref-filename="(anonymous)..u">u</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::name" title='(anonymous union)::name' data-ref="(anonymous)::name" data-ref-filename="(anonymous)..name">name</a>, <a class="local col0 ref" href="#310d" title='d' data-ref="310d" data-ref-filename="310d">d</a>);</td></tr>
<tr><th id="2287">2287</th><td>    <a class="local col2 ref" href="#312err" title='err' data-ref="312err" data-ref-filename="312err">err</a> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_Register" title='mDNS_Register' data-ref="mDNS_Register" data-ref-filename="mDNS_Register">mDNS_Register</a>(<a class="local col9 ref" href="#309m" title='m' data-ref="309m" data-ref-filename="309m">m</a>, &amp;<a class="local col3 ref" href="#313ptr" title='ptr' data-ref="313ptr" data-ref-filename="313ptr">ptr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ARListElem::ar" title='ARListElem::ar' data-ref="ARListElem::ar" data-ref-filename="ARListElem..ar">ar</a>);</td></tr>
<tr><th id="2288">2288</th><td>    <b>if</b> (<a class="local col2 ref" href="#312err" title='err' data-ref="312err" data-ref-filename="312err">err</a>)</td></tr>
<tr><th id="2289">2289</th><td>    {</td></tr>
<tr><th id="2290">2290</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;SetSCPrefsBrowseDomain: mDNS_Register returned error %d&quot;, err)" data-ref="_M/LogMsg">LogMsg</a>(<q>"SetSCPrefsBrowseDomain: mDNS_Register returned error %d"</q>, <a class="local col2 ref" href="#312err" title='err' data-ref="312err" data-ref-filename="312err">err</a>);</td></tr>
<tr><th id="2291">2291</th><td>        <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformMemFree" title='mDNSPlatformMemFree' data-ref="mDNSPlatformMemFree" data-ref-filename="mDNSPlatformMemFree">mDNSPlatformMemFree</a>(<a class="local col3 ref" href="#313ptr" title='ptr' data-ref="313ptr" data-ref-filename="313ptr">ptr</a>);</td></tr>
<tr><th id="2292">2292</th><td>    }</td></tr>
<tr><th id="2293">2293</th><td>    <b>else</b></td></tr>
<tr><th id="2294">2294</th><td>    {</td></tr>
<tr><th id="2295">2295</th><td>        <a class="local col3 ref" href="#313ptr" title='ptr' data-ref="313ptr" data-ref-filename="313ptr">ptr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ARListElem::next" title='ARListElem::next' data-ref="ARListElem::next" data-ref-filename="ARListElem..next">next</a> = <a class="tu ref" href="#LocalDomainEnumRecords" title='LocalDomainEnumRecords' data-use='r' data-ref="LocalDomainEnumRecords" data-ref-filename="LocalDomainEnumRecords">LocalDomainEnumRecords</a>;</td></tr>
<tr><th id="2296">2296</th><td>        <a class="tu ref" href="#LocalDomainEnumRecords" title='LocalDomainEnumRecords' data-use='w' data-ref="LocalDomainEnumRecords" data-ref-filename="LocalDomainEnumRecords">LocalDomainEnumRecords</a> = <a class="local col3 ref" href="#313ptr" title='ptr' data-ref="313ptr" data-ref-filename="313ptr">ptr</a>;</td></tr>
<tr><th id="2297">2297</th><td>    }</td></tr>
<tr><th id="2298">2298</th><td>}</td></tr>
<tr><th id="2299">2299</th><td></td></tr>
<tr><th id="2300">2300</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="DeregisterLocalOnlyDomainEnumPTR" title='DeregisterLocalOnlyDomainEnumPTR' data-ref="DeregisterLocalOnlyDomainEnumPTR" data-ref-filename="DeregisterLocalOnlyDomainEnumPTR">DeregisterLocalOnlyDomainEnumPTR</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS" title='mDNS' data-type='struct mDNS_struct' data-ref="mDNS" data-ref-filename="mDNS">mDNS</a> *<dfn class="local col4 decl" id="314m" title='m' data-type='mDNS *' data-ref="314m" data-ref-filename="314m">m</dfn>, <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#domainname" title='domainname' data-type='struct domainname' data-ref="domainname" data-ref-filename="domainname">domainname</a> *<dfn class="local col5 decl" id="315d" title='d' data-type='const domainname *' data-ref="315d" data-ref-filename="315d">d</dfn>, <em>int</em> <dfn class="local col6 decl" id="316type" title='type' data-type='int' data-ref="316type" data-ref-filename="316type">type</dfn>)</td></tr>
<tr><th id="2301">2301</th><td>{</td></tr>
<tr><th id="2302">2302</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ARListElem" title='ARListElem' data-type='struct ARListElem' data-ref="ARListElem" data-ref-filename="ARListElem">ARListElem</a> **<dfn class="local col7 decl" id="317ptr" title='ptr' data-type='ARListElem **' data-ref="317ptr" data-ref-filename="317ptr">ptr</dfn> = &amp;<a class="tu ref" href="#LocalDomainEnumRecords" title='LocalDomainEnumRecords' data-use='a' data-ref="LocalDomainEnumRecords" data-ref-filename="LocalDomainEnumRecords">LocalDomainEnumRecords</a>;</td></tr>
<tr><th id="2303">2303</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#domainname" title='domainname' data-type='struct domainname' data-ref="domainname" data-ref-filename="domainname">domainname</a> <dfn class="local col8 decl" id="318lhs" title='lhs' data-type='domainname' data-ref="318lhs" data-ref-filename="318lhs">lhs</dfn>; <i>// left-hand side of PTR, for comparison</i></td></tr>
<tr><th id="2304">2304</th><td></td></tr>
<tr><th id="2305">2305</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#131" title="debug_noop" data-ref="_M/debugf">debugf</a>(<q>"Decrementing %s refcount for %##s"</q>,</td></tr>
<tr><th id="2306">2306</th><td>           (type == mDNS_DomainTypeBrowse         ) ? <q>"browse domain   "</q> :</td></tr>
<tr><th id="2307">2307</th><td>           (type == mDNS_DomainTypeRegistration   ) ? <q>"registration dom"</q> :</td></tr>
<tr><th id="2308">2308</th><td>           (type == mDNS_DomainTypeBrowseAutomatic) ? <q>"automatic browse"</q> : <q>"?"</q>, d-&gt;c);</td></tr>
<tr><th id="2309">2309</th><td></td></tr>
<tr><th id="2310">2310</th><td>    <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#MakeDomainNameFromDNSNameString" title='MakeDomainNameFromDNSNameString' data-ref="MakeDomainNameFromDNSNameString" data-ref-filename="MakeDomainNameFromDNSNameString">MakeDomainNameFromDNSNameString</a>(&amp;<a class="local col8 ref" href="#318lhs" title='lhs' data-ref="318lhs" data-ref-filename="318lhs">lhs</a>, <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_DomainTypeNames" title='mDNS_DomainTypeNames' data-ref="mDNS_DomainTypeNames" data-ref-filename="mDNS_DomainTypeNames">mDNS_DomainTypeNames</a>[<a class="local col6 ref" href="#316type" title='type' data-ref="316type" data-ref-filename="316type">type</a>]);</td></tr>
<tr><th id="2311">2311</th><td>    <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AppendDNSNameString" title='AppendDNSNameString' data-ref="AppendDNSNameString" data-ref-filename="AppendDNSNameString">AppendDNSNameString</a>            (&amp;<a class="local col8 ref" href="#318lhs" title='lhs' data-ref="318lhs" data-ref-filename="318lhs">lhs</a>, <q>"local"</q>);</td></tr>
<tr><th id="2312">2312</th><td></td></tr>
<tr><th id="2313">2313</th><td>    <b>while</b> (*<a class="local col7 ref" href="#317ptr" title='ptr' data-ref="317ptr" data-ref-filename="317ptr">ptr</a>)</td></tr>
<tr><th id="2314">2314</th><td>    {</td></tr>
<tr><th id="2315">2315</th><td>        <b>if</b> (<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#SameDomainName" title='SameDomainName' data-ref="SameDomainName" data-ref-filename="SameDomainName">SameDomainName</a>(&amp;(*<a class="local col7 ref" href="#317ptr" title='ptr' data-ref="317ptr" data-ref-filename="317ptr">ptr</a>)-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ARListElem::ar" title='ARListElem::ar' data-ref="ARListElem::ar" data-ref-filename="ARListElem..ar">ar</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdata" title='ResourceRecord_struct::rdata' data-ref="ResourceRecord_struct::rdata" data-ref-filename="ResourceRecord_struct..rdata">rdata</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::u" title='(anonymous struct)::u' data-ref="(anonymous)::u" data-ref-filename="(anonymous)..u">u</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::name" title='(anonymous union)::name' data-ref="(anonymous)::name" data-ref-filename="(anonymous)..name">name</a>, <a class="local col5 ref" href="#315d" title='d' data-ref="315d" data-ref-filename="315d">d</a>) &amp;&amp; <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#SameDomainName" title='SameDomainName' data-ref="SameDomainName" data-ref-filename="SameDomainName">SameDomainName</a>((*<a class="local col7 ref" href="#317ptr" title='ptr' data-ref="317ptr" data-ref-filename="317ptr">ptr</a>)-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ARListElem::ar" title='ARListElem::ar' data-ref="ARListElem::ar" data-ref-filename="ARListElem..ar">ar</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::name" title='ResourceRecord_struct::name' data-ref="ResourceRecord_struct::name" data-ref-filename="ResourceRecord_struct..name">name</a>, &amp;<a class="local col8 ref" href="#318lhs" title='lhs' data-ref="318lhs" data-ref-filename="318lhs">lhs</a>))</td></tr>
<tr><th id="2316">2316</th><td>        {</td></tr>
<tr><th id="2317">2317</th><td>            <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ARListElem" title='ARListElem' data-type='struct ARListElem' data-ref="ARListElem" data-ref-filename="ARListElem">ARListElem</a> *<dfn class="local col9 decl" id="319rem" title='rem' data-type='ARListElem *' data-ref="319rem" data-ref-filename="319rem">rem</dfn> = *<a class="local col7 ref" href="#317ptr" title='ptr' data-ref="317ptr" data-ref-filename="317ptr">ptr</a>;</td></tr>
<tr><th id="2318">2318</th><td>            *<a class="local col7 ref" href="#317ptr" title='ptr' data-ref="317ptr" data-ref-filename="317ptr">ptr</a> = (*<a class="local col7 ref" href="#317ptr" title='ptr' data-ref="317ptr" data-ref-filename="317ptr">ptr</a>)-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ARListElem::next" title='ARListElem::next' data-ref="ARListElem::next" data-ref-filename="ARListElem..next">next</a>;</td></tr>
<tr><th id="2319">2319</th><td>            <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_Deregister" title='mDNS_Deregister' data-ref="mDNS_Deregister" data-ref-filename="mDNS_Deregister">mDNS_Deregister</a>(<a class="local col4 ref" href="#314m" title='m' data-ref="314m" data-ref-filename="314m">m</a>, &amp;<a class="local col9 ref" href="#319rem" title='rem' data-ref="319rem" data-ref-filename="319rem">rem</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ARListElem::ar" title='ARListElem::ar' data-ref="ARListElem::ar" data-ref-filename="ARListElem..ar">ar</a>);</td></tr>
<tr><th id="2320">2320</th><td>            <b>return</b>;</td></tr>
<tr><th id="2321">2321</th><td>        }</td></tr>
<tr><th id="2322">2322</th><td>        <b>else</b> <a class="local col7 ref" href="#317ptr" title='ptr' data-ref="317ptr" data-ref-filename="317ptr">ptr</a> = &amp;(*<a class="local col7 ref" href="#317ptr" title='ptr' data-ref="317ptr" data-ref-filename="317ptr">ptr</a>)-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ARListElem::next" title='ARListElem::next' data-ref="ARListElem::next" data-ref-filename="ARListElem..next">next</a>;</td></tr>
<tr><th id="2323">2323</th><td>    }</td></tr>
<tr><th id="2324">2324</th><td>}</td></tr>
<tr><th id="2325">2325</th><td></td></tr>
<tr><th id="2326">2326</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="AddAutoBrowseDomain" title='AddAutoBrowseDomain' data-ref="AddAutoBrowseDomain" data-ref-filename="AddAutoBrowseDomain">AddAutoBrowseDomain</dfn>(<em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col0 decl" id="320uid" title='uid' data-type='const mDNSu32' data-ref="320uid" data-ref-filename="320uid">uid</dfn>, <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#domainname" title='domainname' data-type='struct domainname' data-ref="domainname" data-ref-filename="domainname">domainname</a> *<em>const</em> <dfn class="local col1 decl" id="321name" title='name' data-type='const domainname *const' data-ref="321name" data-ref-filename="321name">name</dfn>)</td></tr>
<tr><th id="2327">2327</th><td>{</td></tr>
<tr><th id="2328">2328</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem" title='DNameListElem' data-type='struct DNameListElem' data-ref="DNameListElem" data-ref-filename="DNameListElem">DNameListElem</a> *<dfn class="local col2 decl" id="322new" title='new' data-type='DNameListElem *' data-ref="322new" data-ref-filename="322new">new</dfn> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformMemAllocate" title='mDNSPlatformMemAllocate' data-ref="mDNSPlatformMemAllocate" data-ref-filename="mDNSPlatformMemAllocate">mDNSPlatformMemAllocate</a>(<b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem" title='DNameListElem' data-type='struct DNameListElem' data-ref="DNameListElem" data-ref-filename="DNameListElem">DNameListElem</a>));</td></tr>
<tr><th id="2329">2329</th><td>    <b>if</b> (!<a class="local col2 ref" href="#322new" title='new' data-ref="322new" data-ref-filename="322new">new</a>) { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;ERROR: malloc&quot;)" data-ref="_M/LogMsg">LogMsg</a>(<q>"ERROR: malloc"</q>); <b>return</b>; }</td></tr>
<tr><th id="2330">2330</th><td>    <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2849" title="do { mDNSu16 len__ = DomainNameLengthLimit(((name)), ((name))-&gt;c + 256); if (len__ &lt;= 256) mDNSPlatformMemCopy((&amp;new-&gt;name)-&gt;c, (name)-&gt;c, len__); else (&amp;new-&gt;name)-&gt;c[0] = 0; } while(0)" data-ref="_M/AssignDomainName">AssignDomainName</a>(&amp;<a class="local col2 ref" href="#322new" title='new' data-ref="322new" data-ref-filename="322new">new</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::name" title='DNameListElem::name' data-ref="DNameListElem::name" data-ref-filename="DNameListElem..name">name</a>, <a class="local col1 ref" href="#321name" title='name' data-ref="321name" data-ref-filename="321name">name</a>);</td></tr>
<tr><th id="2331">2331</th><td>    <a class="local col2 ref" href="#322new" title='new' data-ref="322new" data-ref-filename="322new">new</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::uid" title='DNameListElem::uid' data-ref="DNameListElem::uid" data-ref-filename="DNameListElem..uid">uid</a> = <a class="local col0 ref" href="#320uid" title='uid' data-ref="320uid" data-ref-filename="320uid">uid</a>;</td></tr>
<tr><th id="2332">2332</th><td>    <a class="local col2 ref" href="#322new" title='new' data-ref="322new" data-ref-filename="322new">new</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::next" title='DNameListElem::next' data-ref="DNameListElem::next" data-ref-filename="DNameListElem..next">next</a> = <a class="ref" href="uds_daemon.h.html#AutoBrowseDomains" title='AutoBrowseDomains' data-ref="AutoBrowseDomains" data-ref-filename="AutoBrowseDomains">AutoBrowseDomains</a>;</td></tr>
<tr><th id="2333">2333</th><td>    <a class="ref" href="uds_daemon.h.html#AutoBrowseDomains" title='AutoBrowseDomains' data-ref="AutoBrowseDomains" data-ref-filename="AutoBrowseDomains">AutoBrowseDomains</a> = <a class="local col2 ref" href="#322new" title='new' data-ref="322new" data-ref-filename="322new">new</a>;</td></tr>
<tr><th id="2334">2334</th><td>    <a class="ref fn" href="#udsserver_automatic_browse_domain_changed" title='udsserver_automatic_browse_domain_changed' data-ref="udsserver_automatic_browse_domain_changed" data-ref-filename="udsserver_automatic_browse_domain_changed">udsserver_automatic_browse_domain_changed</a>(<a class="local col2 ref" href="#322new" title='new' data-ref="322new" data-ref-filename="322new">new</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>);</td></tr>
<tr><th id="2335">2335</th><td>}</td></tr>
<tr><th id="2336">2336</th><td></td></tr>
<tr><th id="2337">2337</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="RmvAutoBrowseDomain" title='RmvAutoBrowseDomain' data-ref="RmvAutoBrowseDomain" data-ref-filename="RmvAutoBrowseDomain">RmvAutoBrowseDomain</dfn>(<em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col3 decl" id="323uid" title='uid' data-type='const mDNSu32' data-ref="323uid" data-ref-filename="323uid">uid</dfn>, <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#domainname" title='domainname' data-type='struct domainname' data-ref="domainname" data-ref-filename="domainname">domainname</a> *<em>const</em> <dfn class="local col4 decl" id="324name" title='name' data-type='const domainname *const' data-ref="324name" data-ref-filename="324name">name</dfn>)</td></tr>
<tr><th id="2338">2338</th><td>{</td></tr>
<tr><th id="2339">2339</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem" title='DNameListElem' data-type='struct DNameListElem' data-ref="DNameListElem" data-ref-filename="DNameListElem">DNameListElem</a> **<dfn class="local col5 decl" id="325p" title='p' data-type='DNameListElem **' data-ref="325p" data-ref-filename="325p">p</dfn> = &amp;<a class="ref" href="uds_daemon.h.html#AutoBrowseDomains" title='AutoBrowseDomains' data-ref="AutoBrowseDomains" data-ref-filename="AutoBrowseDomains">AutoBrowseDomains</a>;</td></tr>
<tr><th id="2340">2340</th><td>    <b>while</b> (*<a class="local col5 ref" href="#325p" title='p' data-ref="325p" data-ref-filename="325p">p</a> &amp;&amp; (!<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#SameDomainName" title='SameDomainName' data-ref="SameDomainName" data-ref-filename="SameDomainName">SameDomainName</a>(&amp;(*<a class="local col5 ref" href="#325p" title='p' data-ref="325p" data-ref-filename="325p">p</a>)-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::name" title='DNameListElem::name' data-ref="DNameListElem::name" data-ref-filename="DNameListElem..name">name</a>, <a class="local col4 ref" href="#324name" title='name' data-ref="324name" data-ref-filename="324name">name</a>) || (*<a class="local col5 ref" href="#325p" title='p' data-ref="325p" data-ref-filename="325p">p</a>)-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::uid" title='DNameListElem::uid' data-ref="DNameListElem::uid" data-ref-filename="DNameListElem..uid">uid</a> != <a class="local col3 ref" href="#323uid" title='uid' data-ref="323uid" data-ref-filename="323uid">uid</a>)) <a class="local col5 ref" href="#325p" title='p' data-ref="325p" data-ref-filename="325p">p</a> = &amp;(*<a class="local col5 ref" href="#325p" title='p' data-ref="325p" data-ref-filename="325p">p</a>)-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::next" title='DNameListElem::next' data-ref="DNameListElem::next" data-ref-filename="DNameListElem..next">next</a>;</td></tr>
<tr><th id="2341">2341</th><td>    <b>if</b> (!*<a class="local col5 ref" href="#325p" title='p' data-ref="325p" data-ref-filename="325p">p</a>) <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;RmvAutoBrowseDomain: Got remove event for domain %##s not in list&quot;, name-&gt;c)" data-ref="_M/LogMsg">LogMsg</a>(<q>"RmvAutoBrowseDomain: Got remove event for domain %##s not in list"</q>, <a class="local col4 ref" href="#324name" title='name' data-ref="324name" data-ref-filename="324name">name</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>);</td></tr>
<tr><th id="2342">2342</th><td>    <b>else</b></td></tr>
<tr><th id="2343">2343</th><td>    {</td></tr>
<tr><th id="2344">2344</th><td>        <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem" title='DNameListElem' data-type='struct DNameListElem' data-ref="DNameListElem" data-ref-filename="DNameListElem">DNameListElem</a> *<dfn class="local col6 decl" id="326ptr" title='ptr' data-type='DNameListElem *' data-ref="326ptr" data-ref-filename="326ptr">ptr</dfn> = *<a class="local col5 ref" href="#325p" title='p' data-ref="325p" data-ref-filename="325p">p</a>;</td></tr>
<tr><th id="2345">2345</th><td>        *<a class="local col5 ref" href="#325p" title='p' data-ref="325p" data-ref-filename="325p">p</a> = <a class="local col6 ref" href="#326ptr" title='ptr' data-ref="326ptr" data-ref-filename="326ptr">ptr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::next" title='DNameListElem::next' data-ref="DNameListElem::next" data-ref-filename="DNameListElem..next">next</a>;</td></tr>
<tr><th id="2346">2346</th><td>        <a class="ref fn" href="#udsserver_automatic_browse_domain_changed" title='udsserver_automatic_browse_domain_changed' data-ref="udsserver_automatic_browse_domain_changed" data-ref-filename="udsserver_automatic_browse_domain_changed">udsserver_automatic_browse_domain_changed</a>(<a class="local col6 ref" href="#326ptr" title='ptr' data-ref="326ptr" data-ref-filename="326ptr">ptr</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>);</td></tr>
<tr><th id="2347">2347</th><td>        <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformMemFree" title='mDNSPlatformMemFree' data-ref="mDNSPlatformMemFree" data-ref-filename="mDNSPlatformMemFree">mDNSPlatformMemFree</a>(<a class="local col6 ref" href="#326ptr" title='ptr' data-ref="326ptr" data-ref-filename="326ptr">ptr</a>);</td></tr>
<tr><th id="2348">2348</th><td>    }</td></tr>
<tr><th id="2349">2349</th><td>}</td></tr>
<tr><th id="2350">2350</th><td></td></tr>
<tr><th id="2351">2351</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="SetPrefsBrowseDomains" title='SetPrefsBrowseDomains' data-ref="SetPrefsBrowseDomains" data-ref-filename="SetPrefsBrowseDomains">SetPrefsBrowseDomains</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS" title='mDNS' data-type='struct mDNS_struct' data-ref="mDNS" data-ref-filename="mDNS">mDNS</a> *<dfn class="local col7 decl" id="327m" title='m' data-type='mDNS *' data-ref="327m" data-ref-filename="327m">m</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem" title='DNameListElem' data-type='struct DNameListElem' data-ref="DNameListElem" data-ref-filename="DNameListElem">DNameListElem</a> *<dfn class="local col8 decl" id="328browseDomains" title='browseDomains' data-type='DNameListElem *' data-ref="328browseDomains" data-ref-filename="328browseDomains">browseDomains</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSBool" title='mDNSBool' data-type='unsigned char' data-ref="mDNSBool" data-ref-filename="mDNSBool">mDNSBool</a> <dfn class="local col9 decl" id="329add" title='add' data-type='mDNSBool' data-ref="329add" data-ref-filename="329add">add</dfn>)</td></tr>
<tr><th id="2352">2352</th><td>{</td></tr>
<tr><th id="2353">2353</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem" title='DNameListElem' data-type='struct DNameListElem' data-ref="DNameListElem" data-ref-filename="DNameListElem">DNameListElem</a> *<dfn class="local col0 decl" id="330d" title='d' data-type='DNameListElem *' data-ref="330d" data-ref-filename="330d">d</dfn>;</td></tr>
<tr><th id="2354">2354</th><td>    <b>for</b> (<a class="local col0 ref" href="#330d" title='d' data-ref="330d" data-ref-filename="330d">d</a> = <a class="local col8 ref" href="#328browseDomains" title='browseDomains' data-ref="328browseDomains" data-ref-filename="328browseDomains">browseDomains</a>; <a class="local col0 ref" href="#330d" title='d' data-ref="330d" data-ref-filename="330d">d</a>; <a class="local col0 ref" href="#330d" title='d' data-ref="330d" data-ref-filename="330d">d</a> = <a class="local col0 ref" href="#330d" title='d' data-ref="330d" data-ref-filename="330d">d</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::next" title='DNameListElem::next' data-ref="DNameListElem::next" data-ref-filename="DNameListElem..next">next</a>)</td></tr>
<tr><th id="2355">2355</th><td>    {</td></tr>
<tr><th id="2356">2356</th><td>        <b>if</b> (<a class="local col9 ref" href="#329add" title='add' data-ref="329add" data-ref-filename="329add">add</a>)</td></tr>
<tr><th id="2357">2357</th><td>        {</td></tr>
<tr><th id="2358">2358</th><td>            <a class="ref fn" href="#RegisterLocalOnlyDomainEnumPTR" title='RegisterLocalOnlyDomainEnumPTR' data-ref="RegisterLocalOnlyDomainEnumPTR" data-ref-filename="RegisterLocalOnlyDomainEnumPTR">RegisterLocalOnlyDomainEnumPTR</a>(<a class="local col7 ref" href="#327m" title='m' data-ref="327m" data-ref-filename="327m">m</a>, &amp;<a class="local col0 ref" href="#330d" title='d' data-ref="330d" data-ref-filename="330d">d</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::name" title='DNameListElem::name' data-ref="DNameListElem::name" data-ref-filename="DNameListElem..name">name</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_DomainTypeBrowse" title='mDNS_DomainTypeBrowse' data-ref="mDNS_DomainTypeBrowse" data-ref-filename="mDNS_DomainTypeBrowse">mDNS_DomainTypeBrowse</a>);</td></tr>
<tr><th id="2359">2359</th><td>            <a class="ref fn" href="#AddAutoBrowseDomain" title='AddAutoBrowseDomain' data-ref="AddAutoBrowseDomain" data-ref-filename="AddAutoBrowseDomain">AddAutoBrowseDomain</a>(<a class="local col0 ref" href="#330d" title='d' data-ref="330d" data-ref-filename="330d">d</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::uid" title='DNameListElem::uid' data-ref="DNameListElem::uid" data-ref-filename="DNameListElem..uid">uid</a>, &amp;<a class="local col0 ref" href="#330d" title='d' data-ref="330d" data-ref-filename="330d">d</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::name" title='DNameListElem::name' data-ref="DNameListElem::name" data-ref-filename="DNameListElem..name">name</a>);</td></tr>
<tr><th id="2360">2360</th><td>        }</td></tr>
<tr><th id="2361">2361</th><td>        <b>else</b></td></tr>
<tr><th id="2362">2362</th><td>        {</td></tr>
<tr><th id="2363">2363</th><td>            <a class="ref fn" href="#DeregisterLocalOnlyDomainEnumPTR" title='DeregisterLocalOnlyDomainEnumPTR' data-ref="DeregisterLocalOnlyDomainEnumPTR" data-ref-filename="DeregisterLocalOnlyDomainEnumPTR">DeregisterLocalOnlyDomainEnumPTR</a>(<a class="local col7 ref" href="#327m" title='m' data-ref="327m" data-ref-filename="327m">m</a>, &amp;<a class="local col0 ref" href="#330d" title='d' data-ref="330d" data-ref-filename="330d">d</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::name" title='DNameListElem::name' data-ref="DNameListElem::name" data-ref-filename="DNameListElem..name">name</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_DomainTypeBrowse" title='mDNS_DomainTypeBrowse' data-ref="mDNS_DomainTypeBrowse" data-ref-filename="mDNS_DomainTypeBrowse">mDNS_DomainTypeBrowse</a>);</td></tr>
<tr><th id="2364">2364</th><td>            <a class="ref fn" href="#RmvAutoBrowseDomain" title='RmvAutoBrowseDomain' data-ref="RmvAutoBrowseDomain" data-ref-filename="RmvAutoBrowseDomain">RmvAutoBrowseDomain</a>(<a class="local col0 ref" href="#330d" title='d' data-ref="330d" data-ref-filename="330d">d</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::uid" title='DNameListElem::uid' data-ref="DNameListElem::uid" data-ref-filename="DNameListElem..uid">uid</a>, &amp;<a class="local col0 ref" href="#330d" title='d' data-ref="330d" data-ref-filename="330d">d</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::name" title='DNameListElem::name' data-ref="DNameListElem::name" data-ref-filename="DNameListElem..name">name</a>);</td></tr>
<tr><th id="2365">2365</th><td>        }</td></tr>
<tr><th id="2366">2366</th><td>    }</td></tr>
<tr><th id="2367">2367</th><td>}</td></tr>
<tr><th id="2368">2368</th><td></td></tr>
<tr><th id="2369">2369</th><td><u>#<span data-ppcond="2369">if</span> APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="2370">2370</th><td></td></tr>
<tr><th id="2371">2371</th><td>mDNSlocal <em>void</em> UpdateDeviceInfoRecord(mDNS *<em>const</em> m)</td></tr>
<tr><th id="2372">2372</th><td>{</td></tr>
<tr><th id="2373">2373</th><td>    <em>int</em> num_autoname = <var>0</var>;</td></tr>
<tr><th id="2374">2374</th><td>    request_state *req;</td></tr>
<tr><th id="2375">2375</th><td></td></tr>
<tr><th id="2376">2376</th><td>    <i>// Don't need to register the device info record for kDNSServiceInterfaceIndexLocalOnly registrations.</i></td></tr>
<tr><th id="2377">2377</th><td>    <b>for</b> (req = all_requests; req; req = req-&gt;next)</td></tr>
<tr><th id="2378">2378</th><td>    {</td></tr>
<tr><th id="2379">2379</th><td>        <b>if</b> (req-&gt;terminate == regservice_termination_callback &amp;&amp; req-&gt;u.servicereg.autoname &amp;&amp; req-&gt;interfaceIndex != kDNSServiceInterfaceIndexLocalOnly)</td></tr>
<tr><th id="2380">2380</th><td>            num_autoname++;</td></tr>
<tr><th id="2381">2381</th><td>    }</td></tr>
<tr><th id="2382">2382</th><td></td></tr>
<tr><th id="2383">2383</th><td>    <i>// If DeviceInfo record is currently registered, see if we need to deregister it</i></td></tr>
<tr><th id="2384">2384</th><td>    <b>if</b> (m-&gt;DeviceInfo.resrec.RecordType != kDNSRecordTypeUnregistered)</td></tr>
<tr><th id="2385">2385</th><td>        <b>if</b> (num_autoname == <var>0</var> || !SameDomainLabelCS(m-&gt;DeviceInfo.resrec.name-&gt;c, m-&gt;nicelabel.c))</td></tr>
<tr><th id="2386">2386</th><td>        {</td></tr>
<tr><th id="2387">2387</th><td>            LogOperation(<q>"UpdateDeviceInfoRecord Deregister %##s"</q>, m-&gt;DeviceInfo.resrec.name);</td></tr>
<tr><th id="2388">2388</th><td>            mDNS_Deregister(m, &amp;m-&gt;DeviceInfo);</td></tr>
<tr><th id="2389">2389</th><td>        }</td></tr>
<tr><th id="2390">2390</th><td></td></tr>
<tr><th id="2391">2391</th><td>    <i>// If DeviceInfo record is not currently registered, see if we need to register it</i></td></tr>
<tr><th id="2392">2392</th><td>    <b>if</b> (m-&gt;DeviceInfo.resrec.RecordType == kDNSRecordTypeUnregistered)</td></tr>
<tr><th id="2393">2393</th><td>        <b>if</b> (num_autoname &gt; <var>0</var>)</td></tr>
<tr><th id="2394">2394</th><td>        {</td></tr>
<tr><th id="2395">2395</th><td>            mDNS_SetupResourceRecord(&amp;m-&gt;DeviceInfo, mDNSNULL, mDNSNULL, kDNSType_TXT, kStandardTTL, kDNSRecordTypeAdvisory, AuthRecordAny, mDNSNULL, mDNSNULL);</td></tr>
<tr><th id="2396">2396</th><td>            ConstructServiceName(&amp;m-&gt;DeviceInfo.namestorage, &amp;m-&gt;nicelabel, &amp;DeviceInfoName, &amp;localdomain);</td></tr>
<tr><th id="2397">2397</th><td>            m-&gt;DeviceInfo.resrec.rdlength = initializeDeviceInfoTXT(m, m-&gt;DeviceInfo.resrec.rdata-&gt;u.data);</td></tr>
<tr><th id="2398">2398</th><td>            LogOperation(<q>"UpdateDeviceInfoRecord   Register %##s"</q>, m-&gt;DeviceInfo.resrec.name);</td></tr>
<tr><th id="2399">2399</th><td>            mDNS_Register(m, &amp;m-&gt;DeviceInfo);</td></tr>
<tr><th id="2400">2400</th><td>        }</td></tr>
<tr><th id="2401">2401</th><td>}</td></tr>
<tr><th id="2402">2402</th><td><u>#<span data-ppcond="2369">else</span>   // APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="2403">2403</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="UpdateDeviceInfoRecord" title='UpdateDeviceInfoRecord' data-ref="UpdateDeviceInfoRecord" data-ref-filename="UpdateDeviceInfoRecord">UpdateDeviceInfoRecord</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS" title='mDNS' data-type='struct mDNS_struct' data-ref="mDNS" data-ref-filename="mDNS">mDNS</a> *<em>const</em> <dfn class="local col1 decl" id="331m" title='m' data-type='mDNS *const' data-ref="331m" data-ref-filename="331m">m</dfn>)</td></tr>
<tr><th id="2404">2404</th><td>{</td></tr>
<tr><th id="2405">2405</th><td>    (<em>void</em>)<a class="local col1 ref" href="#331m" title='m' data-ref="331m" data-ref-filename="331m">m</a>; <i>// unused</i></td></tr>
<tr><th id="2406">2406</th><td>}</td></tr>
<tr><th id="2407">2407</th><td><u>#<span data-ppcond="2369">endif</span>  // APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="2408">2408</th><td></td></tr>
<tr><th id="2409">2409</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#116" title="" data-ref="_M/mDNSexport">mDNSexport</a> <em>void</em> <dfn class="decl def fn" id="udsserver_handle_configchange" title='udsserver_handle_configchange' data-ref="udsserver_handle_configchange" data-ref-filename="udsserver_handle_configchange">udsserver_handle_configchange</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS" title='mDNS' data-type='struct mDNS_struct' data-ref="mDNS" data-ref-filename="mDNS">mDNS</a> *<em>const</em> <dfn class="local col2 decl" id="332m" title='m' data-type='mDNS *const' data-ref="332m" data-ref-filename="332m">m</dfn>)</td></tr>
<tr><th id="2410">2410</th><td>{</td></tr>
<tr><th id="2411">2411</th><td>    <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col3 decl" id="333req" title='req' data-type='request_state *' data-ref="333req" data-ref-filename="333req">req</dfn>;</td></tr>
<tr><th id="2412">2412</th><td>    <a class="typedef" href="uds_daemon.h.html#service_instance" title='service_instance' data-type='struct service_instance' data-ref="service_instance" data-ref-filename="service_instance">service_instance</a> *<dfn class="local col4 decl" id="334ptr" title='ptr' data-type='service_instance *' data-ref="334ptr" data-ref-filename="334ptr">ptr</dfn>;</td></tr>
<tr><th id="2413">2413</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem" title='DNameListElem' data-type='struct DNameListElem' data-ref="DNameListElem" data-ref-filename="DNameListElem">DNameListElem</a> *<dfn class="local col5 decl" id="335RegDomains" title='RegDomains' data-type='DNameListElem *' data-ref="335RegDomains" data-ref-filename="335RegDomains">RegDomains</dfn> = <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="2414">2414</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem" title='DNameListElem' data-type='struct DNameListElem' data-ref="DNameListElem" data-ref-filename="DNameListElem">DNameListElem</a> *<dfn class="local col6 decl" id="336BrowseDomains" title='BrowseDomains' data-type='DNameListElem *' data-ref="336BrowseDomains" data-ref-filename="336BrowseDomains">BrowseDomains</dfn> = <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="2415">2415</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem" title='DNameListElem' data-type='struct DNameListElem' data-ref="DNameListElem" data-ref-filename="DNameListElem">DNameListElem</a> *<dfn class="local col7 decl" id="337p" title='p' data-type='DNameListElem *' data-ref="337p" data-ref-filename="337p">p</dfn>;</td></tr>
<tr><th id="2416">2416</th><td></td></tr>
<tr><th id="2417">2417</th><td>    <a class="ref fn" href="#UpdateDeviceInfoRecord" title='UpdateDeviceInfoRecord' data-ref="UpdateDeviceInfoRecord" data-ref-filename="UpdateDeviceInfoRecord">UpdateDeviceInfoRecord</a>(<a class="local col2 ref" href="#332m" title='m' data-ref="332m" data-ref-filename="332m">m</a>);</td></tr>
<tr><th id="2418">2418</th><td></td></tr>
<tr><th id="2419">2419</th><td>    <i>// For autoname services, see if the default service name has changed, necessitating an automatic update</i></td></tr>
<tr><th id="2420">2420</th><td>    <b>for</b> (<a class="local col3 ref" href="#333req" title='req' data-ref="333req" data-ref-filename="333req">req</a> = <a class="tu ref" href="#all_requests" title='all_requests' data-use='r' data-ref="all_requests" data-ref-filename="all_requests">all_requests</a>; <a class="local col3 ref" href="#333req" title='req' data-ref="333req" data-ref-filename="333req">req</a>; <a class="local col3 ref" href="#333req" title='req' data-ref="333req" data-ref-filename="333req">req</a> = <a class="local col3 ref" href="#333req" title='req' data-ref="333req" data-ref-filename="333req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::next" title='request_state::next' data-ref="request_state::next" data-ref-filename="request_state..next">next</a>)</td></tr>
<tr><th id="2421">2421</th><td>        <b>if</b> (<a class="local col3 ref" href="#333req" title='req' data-ref="333req" data-ref-filename="333req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> == <a class="ref fn" href="#regservice_termination_callback" title='regservice_termination_callback' data-ref="regservice_termination_callback" data-ref-filename="regservice_termination_callback">regservice_termination_callback</a>)</td></tr>
<tr><th id="2422">2422</th><td>            <b>if</b> (<a class="local col3 ref" href="#333req" title='req' data-ref="333req" data-ref-filename="333req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::autoname" title='request_state::(anonymous union)::(anonymous struct)::autoname' data-ref="request_state::(anonymousunion)::(anonymous)::autoname" data-ref-filename="request_state..(anonymousunion)..(anonymous)..autoname">autoname</a> &amp;&amp; !<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2853" title="((req-&gt;u.servicereg.name.c)[0] == (m-&gt;nicelabel.c)[0] &amp;&amp; mDNSPlatformMemSame((req-&gt;u.servicereg.name.c)+1, (m-&gt;nicelabel.c)+1, (req-&gt;u.servicereg.name.c)[0]))" data-ref="_M/SameDomainLabelCS">SameDomainLabelCS</a>(<a class="local col3 ref" href="#333req" title='req' data-ref="333req" data-ref-filename="333req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::name" title='request_state::(anonymous union)::(anonymous struct)::name' data-ref="request_state::(anonymousunion)::(anonymous)::name" data-ref-filename="request_state..(anonymousunion)..(anonymous)..name">name</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="local col2 ref" href="#332m" title='m' data-ref="332m" data-ref-filename="332m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::nicelabel" title='mDNS_struct::nicelabel' data-ref="mDNS_struct::nicelabel" data-ref-filename="mDNS_struct..nicelabel">nicelabel</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>))</td></tr>
<tr><th id="2423">2423</th><td>            {</td></tr>
<tr><th id="2424">2424</th><td>                <a class="local col3 ref" href="#333req" title='req' data-ref="333req" data-ref-filename="333req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::name" title='request_state::(anonymous union)::(anonymous struct)::name' data-ref="request_state::(anonymousunion)::(anonymous)::name" data-ref-filename="request_state..(anonymousunion)..(anonymous)..name">name</a> = <a class="local col2 ref" href="#332m" title='m' data-ref="332m" data-ref-filename="332m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::nicelabel" title='mDNS_struct::nicelabel' data-ref="mDNS_struct::nicelabel" data-ref-filename="mDNS_struct..nicelabel">nicelabel</a>;</td></tr>
<tr><th id="2425">2425</th><td>                <b>for</b> (<a class="local col4 ref" href="#334ptr" title='ptr' data-ref="334ptr" data-ref-filename="334ptr">ptr</a> = <a class="local col3 ref" href="#333req" title='req' data-ref="333req" data-ref-filename="333req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::instances" title='request_state::(anonymous union)::(anonymous struct)::instances' data-ref="request_state::(anonymousunion)::(anonymous)::instances" data-ref-filename="request_state..(anonymousunion)..(anonymous)..instances">instances</a>; <a class="local col4 ref" href="#334ptr" title='ptr' data-ref="334ptr" data-ref-filename="334ptr">ptr</a>; <a class="local col4 ref" href="#334ptr" title='ptr' data-ref="334ptr" data-ref-filename="334ptr">ptr</a> = <a class="local col4 ref" href="#334ptr" title='ptr' data-ref="334ptr" data-ref-filename="334ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::next" title='service_instance::next' data-ref="service_instance::next" data-ref-filename="service_instance..next">next</a>)</td></tr>
<tr><th id="2426">2426</th><td>                {</td></tr>
<tr><th id="2427">2427</th><td>                    <a class="local col4 ref" href="#334ptr" title='ptr' data-ref="334ptr" data-ref-filename="334ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::renameonmemfree" title='service_instance::renameonmemfree' data-ref="service_instance::renameonmemfree" data-ref-filename="service_instance..renameonmemfree">renameonmemfree</a> = <var>1</var>;</td></tr>
<tr><th id="2428">2428</th><td>                    <b>if</b> (<a class="local col4 ref" href="#334ptr" title='ptr' data-ref="334ptr" data-ref-filename="334ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::clientnotified" title='service_instance::clientnotified' data-ref="service_instance::clientnotified" data-ref-filename="service_instance..clientnotified">clientnotified</a>) <a class="ref fn" href="#SendServiceRemovalNotification" title='SendServiceRemovalNotification' data-ref="SendServiceRemovalNotification" data-ref-filename="SendServiceRemovalNotification">SendServiceRemovalNotification</a>(&amp;<a class="local col4 ref" href="#334ptr" title='ptr' data-ref="334ptr" data-ref-filename="334ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>);</td></tr>
<tr><th id="2429">2429</th><td>                    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;udsserver_handle_configchange: Calling deregister for Service %##s&quot;, ptr-&gt;srs.RR_PTR.resrec.name-&gt;c);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"udsserver_handle_configchange: Calling deregister for Service %##s"</q>, <a class="local col4 ref" href="#334ptr" title='ptr' data-ref="334ptr" data-ref-filename="334ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_PTR" title='ServiceRecordSet_struct::RR_PTR' data-ref="ServiceRecordSet_struct::RR_PTR" data-ref-filename="ServiceRecordSet_struct..RR_PTR">RR_PTR</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::name" title='ResourceRecord_struct::name' data-ref="ResourceRecord_struct::name" data-ref-filename="ResourceRecord_struct..name">name</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>);</td></tr>
<tr><th id="2430">2430</th><td>                    <b>if</b> (<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_DeregisterService_drt" title='mDNS_DeregisterService_drt' data-ref="mDNS_DeregisterService_drt" data-ref-filename="mDNS_DeregisterService_drt">mDNS_DeregisterService_drt</a>(<a class="local col2 ref" href="#332m" title='m' data-ref="332m" data-ref-filename="332m">m</a>, &amp;<a class="local col4 ref" href="#334ptr" title='ptr' data-ref="334ptr" data-ref-filename="334ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_Dereg_rapid" title='mDNS_Dereg_rapid' data-ref="mDNS_Dereg_rapid" data-ref-filename="mDNS_Dereg_rapid">mDNS_Dereg_rapid</a>))</td></tr>
<tr><th id="2431">2431</th><td>                        <a class="ref fn" href="#regservice_callback" title='regservice_callback' data-ref="regservice_callback" data-ref-filename="regservice_callback">regservice_callback</a>(<a class="local col2 ref" href="#332m" title='m' data-ref="332m" data-ref-filename="332m">m</a>, &amp;<a class="local col4 ref" href="#334ptr" title='ptr' data-ref="334ptr" data-ref-filename="334ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_MemFree" title='mStatus_MemFree' data-ref="mStatus_MemFree" data-ref-filename="mStatus_MemFree">mStatus_MemFree</a>); <i>// If service deregistered already, we can re-register immediately</i></td></tr>
<tr><th id="2432">2432</th><td>                }</td></tr>
<tr><th id="2433">2433</th><td>            }</td></tr>
<tr><th id="2434">2434</th><td></td></tr>
<tr><th id="2435">2435</th><td>    <i>// Let the platform layer get the current DNS information</i></td></tr>
<tr><th id="2436">2436</th><td>    <a class="macro" href="../mDNSCore/DNSCommon.h.html#298" title="mDNS_Lock_((m), __func__, 2436)" data-ref="_M/mDNS_Lock">mDNS_Lock</a>(<a class="local col2 ref" href="#332m" title='m' data-ref="332m" data-ref-filename="332m">m</a>);</td></tr>
<tr><th id="2437">2437</th><td>    <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformSetDNSConfig" title='mDNSPlatformSetDNSConfig' data-ref="mDNSPlatformSetDNSConfig" data-ref-filename="mDNSPlatformSetDNSConfig">mDNSPlatformSetDNSConfig</a>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>, &amp;<a class="local col5 ref" href="#335RegDomains" title='RegDomains' data-ref="335RegDomains" data-ref-filename="335RegDomains">RegDomains</a>, &amp;<a class="local col6 ref" href="#336BrowseDomains" title='BrowseDomains' data-ref="336BrowseDomains" data-ref-filename="336BrowseDomains">BrowseDomains</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>);</td></tr>
<tr><th id="2438">2438</th><td>    <a class="macro" href="../mDNSCore/DNSCommon.h.html#300" title="mDNS_Unlock_((m), __func__, 2438)" data-ref="_M/mDNS_Unlock">mDNS_Unlock</a>(<a class="local col2 ref" href="#332m" title='m' data-ref="332m" data-ref-filename="332m">m</a>);</td></tr>
<tr><th id="2439">2439</th><td></td></tr>
<tr><th id="2440">2440</th><td>    <i>// Any automatic registration domains are also implicitly automatic browsing domains</i></td></tr>
<tr><th id="2441">2441</th><td>    <b>if</b> (<a class="local col5 ref" href="#335RegDomains" title='RegDomains' data-ref="335RegDomains" data-ref-filename="335RegDomains">RegDomains</a>) <a class="ref fn" href="#SetPrefsBrowseDomains" title='SetPrefsBrowseDomains' data-ref="SetPrefsBrowseDomains" data-ref-filename="SetPrefsBrowseDomains">SetPrefsBrowseDomains</a>(<a class="local col2 ref" href="#332m" title='m' data-ref="332m" data-ref-filename="332m">m</a>, <a class="local col5 ref" href="#335RegDomains" title='RegDomains' data-ref="335RegDomains" data-ref-filename="335RegDomains">RegDomains</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>);                             <i>// Add the new list first</i></td></tr>
<tr><th id="2442">2442</th><td>    <b>if</b> (<a class="ref" href="uds_daemon.h.html#AutoRegistrationDomains" title='AutoRegistrationDomains' data-ref="AutoRegistrationDomains" data-ref-filename="AutoRegistrationDomains">AutoRegistrationDomains</a>) <a class="ref fn" href="#SetPrefsBrowseDomains" title='SetPrefsBrowseDomains' data-ref="SetPrefsBrowseDomains" data-ref-filename="SetPrefsBrowseDomains">SetPrefsBrowseDomains</a>(<a class="local col2 ref" href="#332m" title='m' data-ref="332m" data-ref-filename="332m">m</a>, <a class="ref" href="uds_daemon.h.html#AutoRegistrationDomains" title='AutoRegistrationDomains' data-ref="AutoRegistrationDomains" data-ref-filename="AutoRegistrationDomains">AutoRegistrationDomains</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>);  <i>// Then clear the old list</i></td></tr>
<tr><th id="2443">2443</th><td></td></tr>
<tr><th id="2444">2444</th><td>    <i>// Add any new domains not already in our AutoRegistrationDomains list</i></td></tr>
<tr><th id="2445">2445</th><td>    <b>for</b> (<a class="local col7 ref" href="#337p" title='p' data-ref="337p" data-ref-filename="337p">p</a>=<a class="local col5 ref" href="#335RegDomains" title='RegDomains' data-ref="335RegDomains" data-ref-filename="335RegDomains">RegDomains</a>; <a class="local col7 ref" href="#337p" title='p' data-ref="337p" data-ref-filename="337p">p</a>; <a class="local col7 ref" href="#337p" title='p' data-ref="337p" data-ref-filename="337p">p</a>=<a class="local col7 ref" href="#337p" title='p' data-ref="337p" data-ref-filename="337p">p</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::next" title='DNameListElem::next' data-ref="DNameListElem::next" data-ref-filename="DNameListElem..next">next</a>)</td></tr>
<tr><th id="2446">2446</th><td>    {</td></tr>
<tr><th id="2447">2447</th><td>        <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem" title='DNameListElem' data-type='struct DNameListElem' data-ref="DNameListElem" data-ref-filename="DNameListElem">DNameListElem</a> **<dfn class="local col8 decl" id="338pp" title='pp' data-type='DNameListElem **' data-ref="338pp" data-ref-filename="338pp">pp</dfn> = &amp;<a class="ref" href="uds_daemon.h.html#AutoRegistrationDomains" title='AutoRegistrationDomains' data-ref="AutoRegistrationDomains" data-ref-filename="AutoRegistrationDomains">AutoRegistrationDomains</a>;</td></tr>
<tr><th id="2448">2448</th><td>        <b>while</b> (*<a class="local col8 ref" href="#338pp" title='pp' data-ref="338pp" data-ref-filename="338pp">pp</a> &amp;&amp; ((*<a class="local col8 ref" href="#338pp" title='pp' data-ref="338pp" data-ref-filename="338pp">pp</a>)-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::uid" title='DNameListElem::uid' data-ref="DNameListElem::uid" data-ref-filename="DNameListElem..uid">uid</a> != <a class="local col7 ref" href="#337p" title='p' data-ref="337p" data-ref-filename="337p">p</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::uid" title='DNameListElem::uid' data-ref="DNameListElem::uid" data-ref-filename="DNameListElem..uid">uid</a> || !<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#SameDomainName" title='SameDomainName' data-ref="SameDomainName" data-ref-filename="SameDomainName">SameDomainName</a>(&amp;(*<a class="local col8 ref" href="#338pp" title='pp' data-ref="338pp" data-ref-filename="338pp">pp</a>)-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::name" title='DNameListElem::name' data-ref="DNameListElem::name" data-ref-filename="DNameListElem..name">name</a>, &amp;<a class="local col7 ref" href="#337p" title='p' data-ref="337p" data-ref-filename="337p">p</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::name" title='DNameListElem::name' data-ref="DNameListElem::name" data-ref-filename="DNameListElem..name">name</a>))) <a class="local col8 ref" href="#338pp" title='pp' data-ref="338pp" data-ref-filename="338pp">pp</a> = &amp;(*<a class="local col8 ref" href="#338pp" title='pp' data-ref="338pp" data-ref-filename="338pp">pp</a>)-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::next" title='DNameListElem::next' data-ref="DNameListElem::next" data-ref-filename="DNameListElem..next">next</a>;</td></tr>
<tr><th id="2449">2449</th><td>        <b>if</b> (!*<a class="local col8 ref" href="#338pp" title='pp' data-ref="338pp" data-ref-filename="338pp">pp</a>)       <i>// If not found in our existing list, this is a new default registration domain</i></td></tr>
<tr><th id="2450">2450</th><td>        {</td></tr>
<tr><th id="2451">2451</th><td>            <a class="ref fn" href="#RegisterLocalOnlyDomainEnumPTR" title='RegisterLocalOnlyDomainEnumPTR' data-ref="RegisterLocalOnlyDomainEnumPTR" data-ref-filename="RegisterLocalOnlyDomainEnumPTR">RegisterLocalOnlyDomainEnumPTR</a>(<a class="local col2 ref" href="#332m" title='m' data-ref="332m" data-ref-filename="332m">m</a>, &amp;<a class="local col7 ref" href="#337p" title='p' data-ref="337p" data-ref-filename="337p">p</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::name" title='DNameListElem::name' data-ref="DNameListElem::name" data-ref-filename="DNameListElem..name">name</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_DomainTypeRegistration" title='mDNS_DomainTypeRegistration' data-ref="mDNS_DomainTypeRegistration" data-ref-filename="mDNS_DomainTypeRegistration">mDNS_DomainTypeRegistration</a>);</td></tr>
<tr><th id="2452">2452</th><td>            <a class="ref fn" href="#udsserver_default_reg_domain_changed" title='udsserver_default_reg_domain_changed' data-ref="udsserver_default_reg_domain_changed" data-ref-filename="udsserver_default_reg_domain_changed">udsserver_default_reg_domain_changed</a>(<a class="local col7 ref" href="#337p" title='p' data-ref="337p" data-ref-filename="337p">p</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>);</td></tr>
<tr><th id="2453">2453</th><td>        }</td></tr>
<tr><th id="2454">2454</th><td>        <b>else</b>            <i>// else found same domainname in both old and new lists, so no change, just delete old copy</i></td></tr>
<tr><th id="2455">2455</th><td>        {</td></tr>
<tr><th id="2456">2456</th><td>            <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem" title='DNameListElem' data-type='struct DNameListElem' data-ref="DNameListElem" data-ref-filename="DNameListElem">DNameListElem</a> *<dfn class="local col9 decl" id="339del" title='del' data-type='DNameListElem *' data-ref="339del" data-ref-filename="339del">del</dfn> = *<a class="local col8 ref" href="#338pp" title='pp' data-ref="338pp" data-ref-filename="338pp">pp</a>;</td></tr>
<tr><th id="2457">2457</th><td>            *<a class="local col8 ref" href="#338pp" title='pp' data-ref="338pp" data-ref-filename="338pp">pp</a> = (*<a class="local col8 ref" href="#338pp" title='pp' data-ref="338pp" data-ref-filename="338pp">pp</a>)-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::next" title='DNameListElem::next' data-ref="DNameListElem::next" data-ref-filename="DNameListElem..next">next</a>;</td></tr>
<tr><th id="2458">2458</th><td>            <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformMemFree" title='mDNSPlatformMemFree' data-ref="mDNSPlatformMemFree" data-ref-filename="mDNSPlatformMemFree">mDNSPlatformMemFree</a>(<a class="local col9 ref" href="#339del" title='del' data-ref="339del" data-ref-filename="339del">del</a>);</td></tr>
<tr><th id="2459">2459</th><td>        }</td></tr>
<tr><th id="2460">2460</th><td>    }</td></tr>
<tr><th id="2461">2461</th><td></td></tr>
<tr><th id="2462">2462</th><td>    <i>// Delete any domains in our old AutoRegistrationDomains list that are now gone</i></td></tr>
<tr><th id="2463">2463</th><td>    <b>while</b> (<a class="ref" href="uds_daemon.h.html#AutoRegistrationDomains" title='AutoRegistrationDomains' data-ref="AutoRegistrationDomains" data-ref-filename="AutoRegistrationDomains">AutoRegistrationDomains</a>)</td></tr>
<tr><th id="2464">2464</th><td>    {</td></tr>
<tr><th id="2465">2465</th><td>        <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem" title='DNameListElem' data-type='struct DNameListElem' data-ref="DNameListElem" data-ref-filename="DNameListElem">DNameListElem</a> *<dfn class="local col0 decl" id="340del" title='del' data-type='DNameListElem *' data-ref="340del" data-ref-filename="340del">del</dfn> = <a class="ref" href="uds_daemon.h.html#AutoRegistrationDomains" title='AutoRegistrationDomains' data-ref="AutoRegistrationDomains" data-ref-filename="AutoRegistrationDomains">AutoRegistrationDomains</a>;</td></tr>
<tr><th id="2466">2466</th><td>        <a class="ref" href="uds_daemon.h.html#AutoRegistrationDomains" title='AutoRegistrationDomains' data-ref="AutoRegistrationDomains" data-ref-filename="AutoRegistrationDomains">AutoRegistrationDomains</a> = <a class="ref" href="uds_daemon.h.html#AutoRegistrationDomains" title='AutoRegistrationDomains' data-ref="AutoRegistrationDomains" data-ref-filename="AutoRegistrationDomains">AutoRegistrationDomains</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::next" title='DNameListElem::next' data-ref="DNameListElem::next" data-ref-filename="DNameListElem..next">next</a>;        <i>// Cut record from list FIRST,</i></td></tr>
<tr><th id="2467">2467</th><td>        <a class="ref fn" href="#DeregisterLocalOnlyDomainEnumPTR" title='DeregisterLocalOnlyDomainEnumPTR' data-ref="DeregisterLocalOnlyDomainEnumPTR" data-ref-filename="DeregisterLocalOnlyDomainEnumPTR">DeregisterLocalOnlyDomainEnumPTR</a>(<a class="local col2 ref" href="#332m" title='m' data-ref="332m" data-ref-filename="332m">m</a>, &amp;<a class="local col0 ref" href="#340del" title='del' data-ref="340del" data-ref-filename="340del">del</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::name" title='DNameListElem::name' data-ref="DNameListElem::name" data-ref-filename="DNameListElem..name">name</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_DomainTypeRegistration" title='mDNS_DomainTypeRegistration' data-ref="mDNS_DomainTypeRegistration" data-ref-filename="mDNS_DomainTypeRegistration">mDNS_DomainTypeRegistration</a>);</td></tr>
<tr><th id="2468">2468</th><td>        <a class="ref fn" href="#udsserver_default_reg_domain_changed" title='udsserver_default_reg_domain_changed' data-ref="udsserver_default_reg_domain_changed" data-ref-filename="udsserver_default_reg_domain_changed">udsserver_default_reg_domain_changed</a>(<a class="local col0 ref" href="#340del" title='del' data-ref="340del" data-ref-filename="340del">del</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>);           <i>// before calling udsserver_default_reg_domain_changed()</i></td></tr>
<tr><th id="2469">2469</th><td>        <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformMemFree" title='mDNSPlatformMemFree' data-ref="mDNSPlatformMemFree" data-ref-filename="mDNSPlatformMemFree">mDNSPlatformMemFree</a>(<a class="local col0 ref" href="#340del" title='del' data-ref="340del" data-ref-filename="340del">del</a>);</td></tr>
<tr><th id="2470">2470</th><td>    }</td></tr>
<tr><th id="2471">2471</th><td></td></tr>
<tr><th id="2472">2472</th><td>    <i>// Now we have our new updated automatic registration domain list</i></td></tr>
<tr><th id="2473">2473</th><td>    <a class="ref" href="uds_daemon.h.html#AutoRegistrationDomains" title='AutoRegistrationDomains' data-ref="AutoRegistrationDomains" data-ref-filename="AutoRegistrationDomains">AutoRegistrationDomains</a> = <a class="local col5 ref" href="#335RegDomains" title='RegDomains' data-ref="335RegDomains" data-ref-filename="335RegDomains">RegDomains</a>;</td></tr>
<tr><th id="2474">2474</th><td></td></tr>
<tr><th id="2475">2475</th><td>    <i>// Add new browse domains to internal list</i></td></tr>
<tr><th id="2476">2476</th><td>    <b>if</b> (<a class="local col6 ref" href="#336BrowseDomains" title='BrowseDomains' data-ref="336BrowseDomains" data-ref-filename="336BrowseDomains">BrowseDomains</a>) <a class="ref fn" href="#SetPrefsBrowseDomains" title='SetPrefsBrowseDomains' data-ref="SetPrefsBrowseDomains" data-ref-filename="SetPrefsBrowseDomains">SetPrefsBrowseDomains</a>(<a class="local col2 ref" href="#332m" title='m' data-ref="332m" data-ref-filename="332m">m</a>, <a class="local col6 ref" href="#336BrowseDomains" title='BrowseDomains' data-ref="336BrowseDomains" data-ref-filename="336BrowseDomains">BrowseDomains</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>);</td></tr>
<tr><th id="2477">2477</th><td></td></tr>
<tr><th id="2478">2478</th><td>    <i>// Remove old browse domains from internal list</i></td></tr>
<tr><th id="2479">2479</th><td>    <b>if</b> (<a class="tu ref" href="#SCPrefBrowseDomains" title='SCPrefBrowseDomains' data-use='r' data-ref="SCPrefBrowseDomains" data-ref-filename="SCPrefBrowseDomains">SCPrefBrowseDomains</a>)</td></tr>
<tr><th id="2480">2480</th><td>    {</td></tr>
<tr><th id="2481">2481</th><td>        <a class="ref fn" href="#SetPrefsBrowseDomains" title='SetPrefsBrowseDomains' data-ref="SetPrefsBrowseDomains" data-ref-filename="SetPrefsBrowseDomains">SetPrefsBrowseDomains</a>(<a class="local col2 ref" href="#332m" title='m' data-ref="332m" data-ref-filename="332m">m</a>, <a class="tu ref" href="#SCPrefBrowseDomains" title='SCPrefBrowseDomains' data-use='r' data-ref="SCPrefBrowseDomains" data-ref-filename="SCPrefBrowseDomains">SCPrefBrowseDomains</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>);</td></tr>
<tr><th id="2482">2482</th><td>        <b>while</b> (<a class="tu ref" href="#SCPrefBrowseDomains" title='SCPrefBrowseDomains' data-use='r' data-ref="SCPrefBrowseDomains" data-ref-filename="SCPrefBrowseDomains">SCPrefBrowseDomains</a>)</td></tr>
<tr><th id="2483">2483</th><td>        {</td></tr>
<tr><th id="2484">2484</th><td>            <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem" title='DNameListElem' data-type='struct DNameListElem' data-ref="DNameListElem" data-ref-filename="DNameListElem">DNameListElem</a> *<dfn class="local col1 decl" id="341fptr" title='fptr' data-type='DNameListElem *' data-ref="341fptr" data-ref-filename="341fptr">fptr</dfn> = <a class="tu ref" href="#SCPrefBrowseDomains" title='SCPrefBrowseDomains' data-use='r' data-ref="SCPrefBrowseDomains" data-ref-filename="SCPrefBrowseDomains">SCPrefBrowseDomains</a>;</td></tr>
<tr><th id="2485">2485</th><td>            <a class="tu ref" href="#SCPrefBrowseDomains" title='SCPrefBrowseDomains' data-use='w' data-ref="SCPrefBrowseDomains" data-ref-filename="SCPrefBrowseDomains">SCPrefBrowseDomains</a> = <a class="tu ref" href="#SCPrefBrowseDomains" title='SCPrefBrowseDomains' data-use='r' data-ref="SCPrefBrowseDomains" data-ref-filename="SCPrefBrowseDomains">SCPrefBrowseDomains</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::next" title='DNameListElem::next' data-ref="DNameListElem::next" data-ref-filename="DNameListElem..next">next</a>;</td></tr>
<tr><th id="2486">2486</th><td>            <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformMemFree" title='mDNSPlatformMemFree' data-ref="mDNSPlatformMemFree" data-ref-filename="mDNSPlatformMemFree">mDNSPlatformMemFree</a>(<a class="local col1 ref" href="#341fptr" title='fptr' data-ref="341fptr" data-ref-filename="341fptr">fptr</a>);</td></tr>
<tr><th id="2487">2487</th><td>        }</td></tr>
<tr><th id="2488">2488</th><td>    }</td></tr>
<tr><th id="2489">2489</th><td></td></tr>
<tr><th id="2490">2490</th><td>    <i>// Replace the old browse domains array with the new array</i></td></tr>
<tr><th id="2491">2491</th><td>    <a class="tu ref" href="#SCPrefBrowseDomains" title='SCPrefBrowseDomains' data-use='w' data-ref="SCPrefBrowseDomains" data-ref-filename="SCPrefBrowseDomains">SCPrefBrowseDomains</a> = <a class="local col6 ref" href="#336BrowseDomains" title='BrowseDomains' data-ref="336BrowseDomains" data-ref-filename="336BrowseDomains">BrowseDomains</a>;</td></tr>
<tr><th id="2492">2492</th><td>}</td></tr>
<tr><th id="2493">2493</th><td></td></tr>
<tr><th id="2494">2494</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="AutomaticBrowseDomainChange" title='AutomaticBrowseDomainChange' data-ref="AutomaticBrowseDomainChange" data-ref-filename="AutomaticBrowseDomainChange">AutomaticBrowseDomainChange</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS" title='mDNS' data-type='struct mDNS_struct' data-ref="mDNS" data-ref-filename="mDNS">mDNS</a> *<em>const</em> <dfn class="local col2 decl" id="342m" title='m' data-type='mDNS *const' data-ref="342m" data-ref-filename="342m">m</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion" title='DNSQuestion' data-type='struct DNSQuestion_struct' data-ref="DNSQuestion" data-ref-filename="DNSQuestion">DNSQuestion</a> *<dfn class="local col3 decl" id="343q" title='q' data-type='DNSQuestion *' data-ref="343q" data-ref-filename="343q">q</dfn>, <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord" title='ResourceRecord' data-type='struct ResourceRecord_struct' data-ref="ResourceRecord" data-ref-filename="ResourceRecord">ResourceRecord</a> *<em>const</em> <dfn class="local col4 decl" id="344answer" title='answer' data-type='const ResourceRecord *const' data-ref="344answer" data-ref-filename="344answer">answer</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#QC_result" title='QC_result' data-type='enum QC_result' data-ref="QC_result" data-ref-filename="QC_result">QC_result</a> <dfn class="local col5 decl" id="345AddRecord" title='AddRecord' data-type='QC_result' data-ref="345AddRecord" data-ref-filename="345AddRecord">AddRecord</dfn>)</td></tr>
<tr><th id="2495">2495</th><td>{</td></tr>
<tr><th id="2496">2496</th><td>    (<em>void</em>)<a class="local col2 ref" href="#342m" title='m' data-ref="342m" data-ref-filename="342m">m</a>; <i>// unused;</i></td></tr>
<tr><th id="2497">2497</th><td>    (<em>void</em>)<a class="local col3 ref" href="#343q" title='q' data-ref="343q" data-ref-filename="343q">q</a>; <i>// unused</i></td></tr>
<tr><th id="2498">2498</th><td></td></tr>
<tr><th id="2499">2499</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;AutomaticBrowseDomainChange: %s automatic browse domain %##s&quot;, AddRecord ? &quot;Adding&quot; : &quot;Removing&quot;, answer-&gt;rdata-&gt;u.name.c);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"AutomaticBrowseDomainChange: %s automatic browse domain %##s"</q>,</td></tr>
<tr><th id="2500">2500</th><td>                 <a class="local col5 ref" href="#345AddRecord" title='AddRecord' data-ref="345AddRecord" data-ref-filename="345AddRecord">AddRecord</a> ? <q>"Adding"</q> : <q>"Removing"</q>, <a class="local col4 ref" href="#344answer" title='answer' data-ref="344answer" data-ref-filename="344answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdata" title='ResourceRecord_struct::rdata' data-ref="ResourceRecord_struct::rdata" data-ref-filename="ResourceRecord_struct..rdata">rdata</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::u" title='(anonymous struct)::u' data-ref="(anonymous)::u" data-ref-filename="(anonymous)..u">u</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::name" title='(anonymous union)::name' data-ref="(anonymous)::name" data-ref-filename="(anonymous)..name">name</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>);</td></tr>
<tr><th id="2501">2501</th><td></td></tr>
<tr><th id="2502">2502</th><td>    <b>if</b> (<a class="local col5 ref" href="#345AddRecord" title='AddRecord' data-ref="345AddRecord" data-ref-filename="345AddRecord">AddRecord</a>) <a class="ref fn" href="#AddAutoBrowseDomain" title='AddAutoBrowseDomain' data-ref="AddAutoBrowseDomain" data-ref-filename="AddAutoBrowseDomain">AddAutoBrowseDomain</a>(<var>0</var>, &amp;<a class="local col4 ref" href="#344answer" title='answer' data-ref="344answer" data-ref-filename="344answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdata" title='ResourceRecord_struct::rdata' data-ref="ResourceRecord_struct::rdata" data-ref-filename="ResourceRecord_struct..rdata">rdata</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::u" title='(anonymous struct)::u' data-ref="(anonymous)::u" data-ref-filename="(anonymous)..u">u</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::name" title='(anonymous union)::name' data-ref="(anonymous)::name" data-ref-filename="(anonymous)..name">name</a>);</td></tr>
<tr><th id="2503">2503</th><td>    <b>else</b> <a class="ref fn" href="#RmvAutoBrowseDomain" title='RmvAutoBrowseDomain' data-ref="RmvAutoBrowseDomain" data-ref-filename="RmvAutoBrowseDomain">RmvAutoBrowseDomain</a>(<var>0</var>, &amp;<a class="local col4 ref" href="#344answer" title='answer' data-ref="344answer" data-ref-filename="344answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdata" title='ResourceRecord_struct::rdata' data-ref="ResourceRecord_struct::rdata" data-ref-filename="ResourceRecord_struct..rdata">rdata</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::u" title='(anonymous struct)::u' data-ref="(anonymous)::u" data-ref-filename="(anonymous)..u">u</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::name" title='(anonymous union)::name' data-ref="(anonymous)::name" data-ref-filename="(anonymous)..name">name</a>);</td></tr>
<tr><th id="2504">2504</th><td>}</td></tr>
<tr><th id="2505">2505</th><td></td></tr>
<tr><th id="2506">2506</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="decl def fn" id="handle_browse_request" title='handle_browse_request' data-ref="handle_browse_request" data-ref-filename="handle_browse_request">handle_browse_request</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col6 decl" id="346request" title='request' data-type='request_state *' data-ref="346request" data-ref-filename="346request">request</dfn>)</td></tr>
<tr><th id="2507">2507</th><td>{</td></tr>
<tr><th id="2508">2508</th><td>    <em>char</em> <dfn class="local col7 decl" id="347regtype" title='regtype' data-type='char [1009]' data-ref="347regtype" data-ref-filename="347regtype">regtype</dfn>[<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#417" title="1009" data-ref="_M/MAX_ESCAPED_DOMAIN_NAME">MAX_ESCAPED_DOMAIN_NAME</a>], <dfn class="local col8 decl" id="348domain" title='domain' data-type='char [1009]' data-ref="348domain" data-ref-filename="348domain">domain</dfn>[<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#417" title="1009" data-ref="_M/MAX_ESCAPED_DOMAIN_NAME">MAX_ESCAPED_DOMAIN_NAME</a>];</td></tr>
<tr><th id="2509">2509</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#domainname" title='domainname' data-type='struct domainname' data-ref="domainname" data-ref-filename="domainname">domainname</a> <dfn class="local col9 decl" id="349typedn" title='typedn' data-type='domainname' data-ref="349typedn" data-ref-filename="349typedn">typedn</dfn>, <dfn class="local col0 decl" id="350d" title='d' data-type='domainname' data-ref="350d" data-ref-filename="350d">d</dfn>, <dfn class="local col1 decl" id="351temp" title='temp' data-type='domainname' data-ref="351temp" data-ref-filename="351temp">temp</dfn>;</td></tr>
<tr><th id="2510">2510</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSs32" title='mDNSs32' data-type='int' data-ref="mDNSs32" data-ref-filename="mDNSs32">mDNSs32</a> <dfn class="local col2 decl" id="352NumSubTypes" title='NumSubTypes' data-type='mDNSs32' data-ref="352NumSubTypes" data-ref-filename="352NumSubTypes">NumSubTypes</dfn>;</td></tr>
<tr><th id="2511">2511</th><td>    <em>char</em> *<dfn class="local col3 decl" id="353AnonData" title='AnonData' data-type='char *' data-ref="353AnonData" data-ref-filename="353AnonData">AnonData</dfn> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="2512">2512</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="local col4 decl" id="354err" title='err' data-type='mStatus' data-ref="354err" data-ref-filename="354err">err</dfn> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_NoError" title='mStatus_NoError' data-ref="mStatus_NoError" data-ref-filename="mStatus_NoError">mStatus_NoError</a>;</td></tr>
<tr><th id="2513">2513</th><td>    <em>int</em> <dfn class="local col5 decl" id="355AnonDataLen" title='AnonDataLen' data-type='int' data-ref="355AnonDataLen" data-ref-filename="355AnonDataLen">AnonDataLen</dfn>;</td></tr>
<tr><th id="2514">2514</th><td></td></tr>
<tr><th id="2515">2515</th><td>    <a class="typedef" href="dns_sd.h.html#DNSServiceFlags" title='DNSServiceFlags' data-type='uint32_t' data-ref="DNSServiceFlags" data-ref-filename="DNSServiceFlags">DNSServiceFlags</a> <dfn class="local col6 decl" id="356flags" title='flags' data-type='DNSServiceFlags' data-ref="356flags" data-ref-filename="356flags">flags</dfn> = <a class="macro" href="dnssd_ipc.h.html#210" title="__dnssd_ipc_get_uint32" data-ref="_M/get_flags">get_flags</a>(&amp;<a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);</td></tr>
<tr><th id="2516">2516</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col7 decl" id="357interfaceIndex" title='interfaceIndex' data-type='mDNSu32' data-ref="357interfaceIndex" data-ref-filename="357interfaceIndex">interfaceIndex</dfn> = <a class="macro" href="dnssd_ipc.h.html#194" title="__dnssd_ipc_get_uint32" data-ref="_M/get_uint32">get_uint32</a>(&amp;<a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);</td></tr>
<tr><th id="2517">2517</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterfaceID" title='mDNSInterfaceID' data-type='struct mDNSInterfaceID_dummystruct *' data-ref="mDNSInterfaceID" data-ref-filename="mDNSInterfaceID">mDNSInterfaceID</a> <dfn class="local col8 decl" id="358InterfaceID" title='InterfaceID' data-type='mDNSInterfaceID' data-ref="358InterfaceID" data-ref-filename="358InterfaceID">InterfaceID</dfn> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformInterfaceIDfromInterfaceIndex" title='mDNSPlatformInterfaceIDfromInterfaceIndex' data-ref="mDNSPlatformInterfaceIDfromInterfaceIndex" data-ref-filename="mDNSPlatformInterfaceIDfromInterfaceIndex">mDNSPlatformInterfaceIDfromInterfaceIndex</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col7 ref" href="#357interfaceIndex" title='interfaceIndex' data-ref="357interfaceIndex" data-ref-filename="357interfaceIndex">interfaceIndex</a>);</td></tr>
<tr><th id="2518">2518</th><td></td></tr>
<tr><th id="2519">2519</th><td>    <i>// The browse is scoped to a specific interface index, but the </i></td></tr>
<tr><th id="2520">2520</th><td><i>    // interface is not currently in our list.</i></td></tr>
<tr><th id="2521">2521</th><td>    <b>if</b> (<a class="local col7 ref" href="#357interfaceIndex" title='interfaceIndex' data-ref="357interfaceIndex" data-ref-filename="357interfaceIndex">interfaceIndex</a> &amp;&amp; !<a class="local col8 ref" href="#358InterfaceID" title='InterfaceID' data-ref="358InterfaceID" data-ref-filename="358InterfaceID">InterfaceID</a>)</td></tr>
<tr><th id="2522">2522</th><td>    {</td></tr>
<tr><th id="2523">2523</th><td>        <i>// If it's one of the specially defined inteface index values, just return an error.</i></td></tr>
<tr><th id="2524">2524</th><td>        <b>if</b> (<a class="ref fn" href="#PreDefinedInterfaceIndex" title='PreDefinedInterfaceIndex' data-ref="PreDefinedInterfaceIndex" data-ref-filename="PreDefinedInterfaceIndex">PreDefinedInterfaceIndex</a>(<a class="local col7 ref" href="#357interfaceIndex" title='interfaceIndex' data-ref="357interfaceIndex" data-ref-filename="357interfaceIndex">interfaceIndex</a>))</td></tr>
<tr><th id="2525">2525</th><td>        {</td></tr>
<tr><th id="2526">2526</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;handle_browse_request: bad interfaceIndex %d&quot;, interfaceIndex);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"handle_browse_request: bad interfaceIndex %d"</q>, <a class="local col7 ref" href="#357interfaceIndex" title='interfaceIndex' data-ref="357interfaceIndex" data-ref-filename="357interfaceIndex">interfaceIndex</a>);</td></tr>
<tr><th id="2527">2527</th><td>            <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>);</td></tr>
<tr><th id="2528">2528</th><td>        }</td></tr>
<tr><th id="2529">2529</th><td></td></tr>
<tr><th id="2530">2530</th><td>        <i>// Otherwise, use the specified interface index value and the browse will</i></td></tr>
<tr><th id="2531">2531</th><td><i>        // be applied to that interface when it comes up.</i></td></tr>
<tr><th id="2532">2532</th><td>        <a class="local col8 ref" href="#358InterfaceID" title='InterfaceID' data-ref="358InterfaceID" data-ref-filename="358InterfaceID">InterfaceID</a> = (<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterfaceID" title='mDNSInterfaceID' data-type='struct mDNSInterfaceID_dummystruct *' data-ref="mDNSInterfaceID" data-ref-filename="mDNSInterfaceID">mDNSInterfaceID</a>)(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/stdint.h.html#uintptr_t" title='uintptr_t' data-type='__uintptr_t' data-ref="uintptr_t" data-ref-filename="uintptr_t">uintptr_t</a>)<a class="local col7 ref" href="#357interfaceIndex" title='interfaceIndex' data-ref="357interfaceIndex" data-ref-filename="357interfaceIndex">interfaceIndex</a>;</td></tr>
<tr><th id="2533">2533</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;handle_browse_request: browse pending for interface index %d&quot;, interfaceIndex);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"handle_browse_request: browse pending for interface index %d"</q>, <a class="local col7 ref" href="#357interfaceIndex" title='interfaceIndex' data-ref="357interfaceIndex" data-ref-filename="357interfaceIndex">interfaceIndex</a>);</td></tr>
<tr><th id="2534">2534</th><td>    }</td></tr>
<tr><th id="2535">2535</th><td></td></tr>
<tr><th id="2536">2536</th><td>    <b>if</b> (<a class="macro" href="dnssd_ipc.h.html#198" title="__dnssd_ipc_get_string" data-ref="_M/get_string">get_string</a>(&amp;<a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>, <a class="local col7 ref" href="#347regtype" title='regtype' data-ref="347regtype" data-ref-filename="347regtype">regtype</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#417" title="1009" data-ref="_M/MAX_ESCAPED_DOMAIN_NAME">MAX_ESCAPED_DOMAIN_NAME</a>) &lt; <var>0</var> ||</td></tr>
<tr><th id="2537">2537</th><td>        <a class="macro" href="dnssd_ipc.h.html#198" title="__dnssd_ipc_get_string" data-ref="_M/get_string">get_string</a>(&amp;<a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>, <a class="local col8 ref" href="#348domain" title='domain' data-ref="348domain" data-ref-filename="348domain">domain</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#417" title="1009" data-ref="_M/MAX_ESCAPED_DOMAIN_NAME">MAX_ESCAPED_DOMAIN_NAME</a>) &lt; <var>0</var>) <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>);</td></tr>
<tr><th id="2538">2538</th><td></td></tr>
<tr><th id="2539">2539</th><td>    <b>if</b> (!<a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>) { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: DNSServiceBrowse(unreadable parameters)&quot;, request-&gt;sd)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: DNSServiceBrowse(unreadable parameters)"</q>, <a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>); <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>); }</td></tr>
<tr><th id="2540">2540</th><td></td></tr>
<tr><th id="2541">2541</th><td>    <a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a> = <a class="local col6 ref" href="#356flags" title='flags' data-ref="356flags" data-ref-filename="356flags">flags</a>;</td></tr>
<tr><th id="2542">2542</th><td>    <a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::interfaceIndex" title='request_state::interfaceIndex' data-ref="request_state::interfaceIndex" data-ref-filename="request_state..interfaceIndex">interfaceIndex</a> = <a class="local col7 ref" href="#357interfaceIndex" title='interfaceIndex' data-ref="357interfaceIndex" data-ref-filename="357interfaceIndex">interfaceIndex</a>;</td></tr>
<tr><th id="2543">2543</th><td>    <a class="local col9 ref" href="#349typedn" title='typedn' data-ref="349typedn" data-ref-filename="349typedn">typedn</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>[<var>0</var>] = <var>0</var>;</td></tr>
<tr><th id="2544">2544</th><td>    <a class="local col2 ref" href="#352NumSubTypes" title='NumSubTypes' data-ref="352NumSubTypes" data-ref-filename="352NumSubTypes">NumSubTypes</a> = <a class="ref fn" href="#ChopSubTypes" title='ChopSubTypes' data-ref="ChopSubTypes" data-ref-filename="ChopSubTypes">ChopSubTypes</a>(<a class="local col7 ref" href="#347regtype" title='regtype' data-ref="347regtype" data-ref-filename="347regtype">regtype</a>, &amp;<a class="local col3 ref" href="#353AnonData" title='AnonData' data-ref="353AnonData" data-ref-filename="353AnonData">AnonData</a>);    <i>// Note: Modifies regtype string to remove trailing subtypes</i></td></tr>
<tr><th id="2545">2545</th><td>    <b>if</b> (<a class="local col2 ref" href="#352NumSubTypes" title='NumSubTypes' data-ref="352NumSubTypes" data-ref-filename="352NumSubTypes">NumSubTypes</a> &lt; <var>0</var> || <a class="local col2 ref" href="#352NumSubTypes" title='NumSubTypes' data-ref="352NumSubTypes" data-ref-filename="352NumSubTypes">NumSubTypes</a> &gt; <var>1</var>)</td></tr>
<tr><th id="2546">2546</th><td>        <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>);</td></tr>
<tr><th id="2547">2547</th><td>    <a class="local col5 ref" href="#355AnonDataLen" title='AnonDataLen' data-ref="355AnonDataLen" data-ref-filename="355AnonDataLen">AnonDataLen</a> = <var>0</var>;</td></tr>
<tr><th id="2548">2548</th><td>    <b>if</b> (<a class="local col3 ref" href="#353AnonData" title='AnonData' data-ref="353AnonData" data-ref-filename="353AnonData">AnonData</a>)</td></tr>
<tr><th id="2549">2549</th><td>    {</td></tr>
<tr><th id="2550">2550</th><td>        <a class="local col5 ref" href="#355AnonDataLen" title='AnonDataLen' data-ref="355AnonDataLen" data-ref-filename="355AnonDataLen">AnonDataLen</a> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strlen" title='strlen' data-ref="strlen" data-ref-filename="strlen">strlen</a>(<a class="local col3 ref" href="#353AnonData" title='AnonData' data-ref="353AnonData" data-ref-filename="353AnonData">AnonData</a>);</td></tr>
<tr><th id="2551">2551</th><td>        <b>if</b> (<a class="local col5 ref" href="#355AnonDataLen" title='AnonDataLen' data-ref="355AnonDataLen" data-ref-filename="355AnonDataLen">AnonDataLen</a> &gt; <a class="macro" href="#85" title="256" data-ref="_M/MAX_ANONYMOUS_DATA">MAX_ANONYMOUS_DATA</a>)</td></tr>
<tr><th id="2552">2552</th><td>        {</td></tr>
<tr><th id="2553">2553</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;handle_browse_request: AnonDataLen %d&quot;, AnonDataLen)" data-ref="_M/LogMsg">LogMsg</a>(<q>"handle_browse_request: AnonDataLen %d"</q>, <a class="local col5 ref" href="#355AnonDataLen" title='AnonDataLen' data-ref="355AnonDataLen" data-ref-filename="355AnonDataLen">AnonDataLen</a>);</td></tr>
<tr><th id="2554">2554</th><td>            <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>);</td></tr>
<tr><th id="2555">2555</th><td>        }</td></tr>
<tr><th id="2556">2556</th><td>        <i>// Account for the null byte</i></td></tr>
<tr><th id="2557">2557</th><td>        <a class="local col5 ref" href="#355AnonDataLen" title='AnonDataLen' data-ref="355AnonDataLen" data-ref-filename="355AnonDataLen">AnonDataLen</a> += <var>1</var>;</td></tr>
<tr><th id="2558">2558</th><td>    }</td></tr>
<tr><th id="2559">2559</th><td>    <b>if</b> (<a class="local col2 ref" href="#352NumSubTypes" title='NumSubTypes' data-ref="352NumSubTypes" data-ref-filename="352NumSubTypes">NumSubTypes</a> == <var>1</var>)</td></tr>
<tr><th id="2560">2560</th><td>    {</td></tr>
<tr><th id="2561">2561</th><td>        <b>if</b> (!<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AppendDNSNameString" title='AppendDNSNameString' data-ref="AppendDNSNameString" data-ref-filename="AppendDNSNameString">AppendDNSNameString</a>(&amp;<a class="local col9 ref" href="#349typedn" title='typedn' data-ref="349typedn" data-ref-filename="349typedn">typedn</a>, <a class="local col7 ref" href="#347regtype" title='regtype' data-ref="347regtype" data-ref-filename="347regtype">regtype</a> + <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strlen" title='strlen' data-ref="strlen" data-ref-filename="strlen">strlen</a>(<a class="local col7 ref" href="#347regtype" title='regtype' data-ref="347regtype" data-ref-filename="347regtype">regtype</a>) + <var>1</var> + <a class="local col5 ref" href="#355AnonDataLen" title='AnonDataLen' data-ref="355AnonDataLen" data-ref-filename="355AnonDataLen">AnonDataLen</a>))</td></tr>
<tr><th id="2562">2562</th><td>            <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>);</td></tr>
<tr><th id="2563">2563</th><td>    }</td></tr>
<tr><th id="2564">2564</th><td></td></tr>
<tr><th id="2565">2565</th><td>    <b>if</b> (!<a class="local col7 ref" href="#347regtype" title='regtype' data-ref="347regtype" data-ref-filename="347regtype">regtype</a>[<var>0</var>] || !<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AppendDNSNameString" title='AppendDNSNameString' data-ref="AppendDNSNameString" data-ref-filename="AppendDNSNameString">AppendDNSNameString</a>(&amp;<a class="local col9 ref" href="#349typedn" title='typedn' data-ref="349typedn" data-ref-filename="349typedn">typedn</a>, <a class="local col7 ref" href="#347regtype" title='regtype' data-ref="347regtype" data-ref-filename="347regtype">regtype</a>)) <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>);</td></tr>
<tr><th id="2566">2566</th><td></td></tr>
<tr><th id="2567">2567</th><td>    <b>if</b> (!<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#MakeDomainNameFromDNSNameString" title='MakeDomainNameFromDNSNameString' data-ref="MakeDomainNameFromDNSNameString" data-ref-filename="MakeDomainNameFromDNSNameString">MakeDomainNameFromDNSNameString</a>(&amp;<a class="local col1 ref" href="#351temp" title='temp' data-ref="351temp" data-ref-filename="351temp">temp</a>, <a class="local col7 ref" href="#347regtype" title='regtype' data-ref="347regtype" data-ref-filename="347regtype">regtype</a>)) <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>);</td></tr>
<tr><th id="2568">2568</th><td>    <i>// For over-long service types, we only allow domain "local"</i></td></tr>
<tr><th id="2569">2569</th><td>    <b>if</b> (<a class="local col1 ref" href="#351temp" title='temp' data-ref="351temp" data-ref-filename="351temp">temp</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>[<var>0</var>] &gt; <var>15</var> &amp;&amp; <a class="local col8 ref" href="#348domain" title='domain' data-ref="348domain" data-ref-filename="348domain">domain</a>[<var>0</var>] == <var>0</var>) <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformStrLCopy" title='mDNSPlatformStrLCopy' data-ref="mDNSPlatformStrLCopy" data-ref-filename="mDNSPlatformStrLCopy">mDNSPlatformStrLCopy</a>(<a class="local col8 ref" href="#348domain" title='domain' data-ref="348domain" data-ref-filename="348domain">domain</a>, <q>"local."</q>, <b>sizeof</b>(<a class="local col8 ref" href="#348domain" title='domain' data-ref="348domain" data-ref-filename="348domain">domain</a>));</td></tr>
<tr><th id="2570">2570</th><td></td></tr>
<tr><th id="2571">2571</th><td>    <i>// Set up browser info</i></td></tr>
<tr><th id="2572">2572</th><td>    <a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::ForceMCast" title='request_state::(anonymous union)::(anonymous struct)::ForceMCast' data-ref="request_state::(anonymousunion)::(anonymous)::ForceMCast" data-ref-filename="request_state..(anonymousunion)..(anonymous)..ForceMCast">ForceMCast</a> = (<a class="local col6 ref" href="#356flags" title='flags' data-ref="356flags" data-ref-filename="356flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsForceMulticast" title='kDNSServiceFlagsForceMulticast' data-ref="kDNSServiceFlagsForceMulticast" data-ref-filename="kDNSServiceFlagsForceMulticast">kDNSServiceFlagsForceMulticast</a>) != <var>0</var>;</td></tr>
<tr><th id="2573">2573</th><td>    <a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::interface_id" title='request_state::(anonymous union)::(anonymous struct)::interface_id' data-ref="request_state::(anonymousunion)::(anonymous)::interface_id" data-ref-filename="request_state..(anonymousunion)..(anonymous)..interface_id">interface_id</a> = <a class="local col8 ref" href="#358InterfaceID" title='InterfaceID' data-ref="358InterfaceID" data-ref-filename="358InterfaceID">InterfaceID</a>;</td></tr>
<tr><th id="2574">2574</th><td>    <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2849" title="do { mDNSu16 len__ = DomainNameLengthLimit(((&amp;typedn)), ((&amp;typedn))-&gt;c + 256); if (len__ &lt;= 256) mDNSPlatformMemCopy((&amp;request-&gt;u.browser.regtype)-&gt;c, (&amp;typedn)-&gt;c, len__); else (&amp;request-&gt;u.browser.regtype)-&gt;c[0] = 0; } while(0)" data-ref="_M/AssignDomainName">AssignDomainName</a>(&amp;<a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::regtype" title='request_state::(anonymous union)::(anonymous struct)::regtype' data-ref="request_state::(anonymousunion)::(anonymous)::regtype" data-ref-filename="request_state..(anonymousunion)..(anonymous)..regtype">regtype</a>, &amp;<a class="local col9 ref" href="#349typedn" title='typedn' data-ref="349typedn" data-ref-filename="349typedn">typedn</a>);</td></tr>
<tr><th id="2575">2575</th><td>    <a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::default_domain" title='request_state::(anonymous union)::(anonymous struct)::default_domain' data-ref="request_state::(anonymousunion)::(anonymous)::default_domain" data-ref-filename="request_state..(anonymousunion)..(anonymous)..default_domain">default_domain</a> = !<a class="local col8 ref" href="#348domain" title='domain' data-ref="348domain" data-ref-filename="348domain">domain</a>[<var>0</var>];</td></tr>
<tr><th id="2576">2576</th><td>    <a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::browsers" title='request_state::(anonymous union)::(anonymous struct)::browsers' data-ref="request_state::(anonymousunion)::(anonymous)::browsers" data-ref-filename="request_state..(anonymousunion)..(anonymous)..browsers">browsers</a> = <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="2577">2577</th><td></td></tr>
<tr><th id="2578">2578</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: DNSServiceBrowse(%X, %d, \&quot;%##s\&quot;, \&quot;%s\&quot;) START PID[%d](%s)&quot;, request-&gt;sd, request-&gt;flags, interfaceIndex, request-&gt;u.browser.regtype.c, domain, request-&gt;process_id, request-&gt;pid_name);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: DNSServiceBrowse(%X, %d, \"%##s\", \"%s\") START PID[%d](%s)"</q>,</td></tr>
<tr><th id="2579">2579</th><td>                 <a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a>, <a class="local col7 ref" href="#357interfaceIndex" title='interfaceIndex' data-ref="357interfaceIndex" data-ref-filename="357interfaceIndex">interfaceIndex</a>, <a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::regtype" title='request_state::(anonymous union)::(anonymous struct)::regtype' data-ref="request_state::(anonymousunion)::(anonymous)::regtype" data-ref-filename="request_state..(anonymousunion)..(anonymous)..regtype">regtype</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="local col8 ref" href="#348domain" title='domain' data-ref="348domain" data-ref-filename="348domain">domain</a>, <a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="2580">2580</th><td></td></tr>
<tr><th id="2581">2581</th><td>    <b>if</b> (<a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::default_domain" title='request_state::(anonymous union)::(anonymous struct)::default_domain' data-ref="request_state::(anonymousunion)::(anonymous)::default_domain" data-ref-filename="request_state..(anonymousunion)..(anonymous)..default_domain">default_domain</a>)</td></tr>
<tr><th id="2582">2582</th><td>    {</td></tr>
<tr><th id="2583">2583</th><td>        <i>// Start the domain enumeration queries to discover the WAB browse domains</i></td></tr>
<tr><th id="2584">2584</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;%3d: DNSServiceBrowse Start WAB PID[%d](%s)&quot;, request-&gt;sd, request-&gt;process_id, request-&gt;pid_name);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"%3d: DNSServiceBrowse Start WAB PID[%d](%s)"</q>, <a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="2585">2585</th><td>        <a class="ref fn" href="../mDNSCore/uDNS.h.html#uDNS_StartWABQueries" title='uDNS_StartWABQueries' data-ref="uDNS_StartWABQueries" data-ref-filename="uDNS_StartWABQueries">uDNS_StartWABQueries</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="macro" href="../mDNSCore/uDNS.h.html#125" title="0x00000002" data-ref="_M/UDNS_WAB_LBROWSE_QUERY">UDNS_WAB_LBROWSE_QUERY</a>);</td></tr>
<tr><th id="2586">2586</th><td>    }</td></tr>
<tr><th id="2587">2587</th><td>    <a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::AnonData" title='request_state::(anonymous union)::(anonymous struct)::AnonData' data-ref="request_state::(anonymousunion)::(anonymous)::AnonData" data-ref-filename="request_state..(anonymousunion)..(anonymous)..AnonData">AnonData</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="2588">2588</th><td>    <b>if</b> (<a class="local col3 ref" href="#353AnonData" title='AnonData' data-ref="353AnonData" data-ref-filename="353AnonData">AnonData</a>)</td></tr>
<tr><th id="2589">2589</th><td>    {</td></tr>
<tr><th id="2590">2590</th><td>        <em>int</em> <dfn class="local col9 decl" id="359len" title='len' data-type='int' data-ref="359len" data-ref-filename="359len">len</dfn> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strlen" title='strlen' data-ref="strlen" data-ref-filename="strlen">strlen</a>(<a class="local col3 ref" href="#353AnonData" title='AnonData' data-ref="353AnonData" data-ref-filename="353AnonData">AnonData</a>) + <var>1</var>;</td></tr>
<tr><th id="2591">2591</th><td>        <a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::AnonData" title='request_state::(anonymous union)::(anonymous struct)::AnonData' data-ref="request_state::(anonymousunion)::(anonymous)::AnonData" data-ref-filename="request_state..(anonymousunion)..(anonymous)..AnonData">AnonData</a> = <a class="macro" href="../mDNSCore/mDNSDebug.h.html#166" title="malloc(len)" data-ref="_M/mallocL">mallocL</a>(<q>"Anonymous"</q>, <a class="local col9 ref" href="#359len" title='len' data-ref="359len" data-ref-filename="359len">len</a>);</td></tr>
<tr><th id="2592">2592</th><td>        <b>if</b> (!<a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::AnonData" title='request_state::(anonymous union)::(anonymous struct)::AnonData' data-ref="request_state::(anonymousunion)::(anonymous)::AnonData" data-ref-filename="request_state..(anonymousunion)..(anonymous)..AnonData">AnonData</a>)</td></tr>
<tr><th id="2593">2593</th><td>            <b>return</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_NoMemoryErr" title='mStatus_NoMemoryErr' data-ref="mStatus_NoMemoryErr" data-ref-filename="mStatus_NoMemoryErr">mStatus_NoMemoryErr</a>;</td></tr>
<tr><th id="2594">2594</th><td>        <b>else</b></td></tr>
<tr><th id="2595">2595</th><td>            <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformMemCopy" title='mDNSPlatformMemCopy' data-ref="mDNSPlatformMemCopy" data-ref-filename="mDNSPlatformMemCopy">mDNSPlatformMemCopy</a>((<em>void</em> *)<a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::AnonData" title='request_state::(anonymous union)::(anonymous struct)::AnonData' data-ref="request_state::(anonymousunion)::(anonymous)::AnonData" data-ref-filename="request_state..(anonymousunion)..(anonymous)..AnonData">AnonData</a>, <a class="local col3 ref" href="#353AnonData" title='AnonData' data-ref="353AnonData" data-ref-filename="353AnonData">AnonData</a>, <a class="local col9 ref" href="#359len" title='len' data-ref="359len" data-ref-filename="359len">len</a>);</td></tr>
<tr><th id="2596">2596</th><td>    }</td></tr>
<tr><th id="2597">2597</th><td>    <i>// We need to unconditionally set request-&gt;terminate, because even if we didn't successfully</i></td></tr>
<tr><th id="2598">2598</th><td><i>    // start any browses right now, subsequent configuration changes may cause successful</i></td></tr>
<tr><th id="2599">2599</th><td><i>    // browses to be added, and we'll need to cancel them before freeing this memory.</i></td></tr>
<tr><th id="2600">2600</th><td>    <a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> = <a class="ref fn" href="#browse_termination_callback" title='browse_termination_callback' data-ref="browse_termination_callback" data-ref-filename="browse_termination_callback">browse_termination_callback</a>;</td></tr>
<tr><th id="2601">2601</th><td></td></tr>
<tr><th id="2602">2602</th><td>    <b>if</b> (<a class="local col8 ref" href="#348domain" title='domain' data-ref="348domain" data-ref-filename="348domain">domain</a>[<var>0</var>])</td></tr>
<tr><th id="2603">2603</th><td>    {</td></tr>
<tr><th id="2604">2604</th><td>        <b>if</b> (!<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#MakeDomainNameFromDNSNameString" title='MakeDomainNameFromDNSNameString' data-ref="MakeDomainNameFromDNSNameString" data-ref-filename="MakeDomainNameFromDNSNameString">MakeDomainNameFromDNSNameString</a>(&amp;<a class="local col0 ref" href="#350d" title='d' data-ref="350d" data-ref-filename="350d">d</a>, <a class="local col8 ref" href="#348domain" title='domain' data-ref="348domain" data-ref-filename="348domain">domain</a>)) <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>);</td></tr>
<tr><th id="2605">2605</th><td>        <a class="local col4 ref" href="#354err" title='err' data-ref="354err" data-ref-filename="354err">err</a> = <a class="ref fn" href="#add_domain_to_browser" title='add_domain_to_browser' data-ref="add_domain_to_browser" data-ref-filename="add_domain_to_browser">add_domain_to_browser</a>(<a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>, &amp;<a class="local col0 ref" href="#350d" title='d' data-ref="350d" data-ref-filename="350d">d</a>);</td></tr>
<tr><th id="2606">2606</th><td>    }</td></tr>
<tr><th id="2607">2607</th><td>    <b>else</b></td></tr>
<tr><th id="2608">2608</th><td>    {</td></tr>
<tr><th id="2609">2609</th><td>        <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem" title='DNameListElem' data-type='struct DNameListElem' data-ref="DNameListElem" data-ref-filename="DNameListElem">DNameListElem</a> *<dfn class="local col0 decl" id="360sdom" title='sdom' data-type='DNameListElem *' data-ref="360sdom" data-ref-filename="360sdom">sdom</dfn>;</td></tr>
<tr><th id="2610">2610</th><td>        <b>for</b> (<a class="local col0 ref" href="#360sdom" title='sdom' data-ref="360sdom" data-ref-filename="360sdom">sdom</a> = <a class="ref" href="uds_daemon.h.html#AutoBrowseDomains" title='AutoBrowseDomains' data-ref="AutoBrowseDomains" data-ref-filename="AutoBrowseDomains">AutoBrowseDomains</a>; <a class="local col0 ref" href="#360sdom" title='sdom' data-ref="360sdom" data-ref-filename="360sdom">sdom</a>; <a class="local col0 ref" href="#360sdom" title='sdom' data-ref="360sdom" data-ref-filename="360sdom">sdom</a> = <a class="local col0 ref" href="#360sdom" title='sdom' data-ref="360sdom" data-ref-filename="360sdom">sdom</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::next" title='DNameListElem::next' data-ref="DNameListElem::next" data-ref-filename="DNameListElem..next">next</a>)</td></tr>
<tr><th id="2611">2611</th><td>            <b>if</b> (!<a class="local col0 ref" href="#360sdom" title='sdom' data-ref="360sdom" data-ref-filename="360sdom">sdom</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::uid" title='DNameListElem::uid' data-ref="DNameListElem::uid" data-ref-filename="DNameListElem..uid">uid</a> || <a class="macro" href="#83" title="((request-&gt;uid) &lt;= 500)" data-ref="_M/SystemUID">SystemUID</a>(<a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::uid" title='request_state::uid' data-ref="request_state::uid" data-ref-filename="request_state..uid">uid</a>) || <a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::uid" title='request_state::uid' data-ref="request_state::uid" data-ref-filename="request_state..uid">uid</a> == <a class="local col0 ref" href="#360sdom" title='sdom' data-ref="360sdom" data-ref-filename="360sdom">sdom</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::uid" title='DNameListElem::uid' data-ref="DNameListElem::uid" data-ref-filename="DNameListElem..uid">uid</a>)</td></tr>
<tr><th id="2612">2612</th><td>            {</td></tr>
<tr><th id="2613">2613</th><td>                <a class="local col4 ref" href="#354err" title='err' data-ref="354err" data-ref-filename="354err">err</a> = <a class="ref fn" href="#add_domain_to_browser" title='add_domain_to_browser' data-ref="add_domain_to_browser" data-ref-filename="add_domain_to_browser">add_domain_to_browser</a>(<a class="local col6 ref" href="#346request" title='request' data-ref="346request" data-ref-filename="346request">request</a>, &amp;<a class="local col0 ref" href="#360sdom" title='sdom' data-ref="360sdom" data-ref-filename="360sdom">sdom</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::name" title='DNameListElem::name' data-ref="DNameListElem::name" data-ref-filename="DNameListElem..name">name</a>);</td></tr>
<tr><th id="2614">2614</th><td>                <b>if</b> (<a class="local col4 ref" href="#354err" title='err' data-ref="354err" data-ref-filename="354err">err</a>)</td></tr>
<tr><th id="2615">2615</th><td>                {</td></tr>
<tr><th id="2616">2616</th><td>                    <b>if</b> (<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#SameDomainName" title='SameDomainName' data-ref="SameDomainName" data-ref-filename="SameDomainName">SameDomainName</a>(&amp;<a class="local col0 ref" href="#360sdom" title='sdom' data-ref="360sdom" data-ref-filename="360sdom">sdom</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::name" title='DNameListElem::name' data-ref="DNameListElem::name" data-ref-filename="DNameListElem..name">name</a>, &amp;<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2594" title="(*(const domainname *)&quot;\x5&quot; &quot;local&quot;)" data-ref="_M/localdomain">localdomain</a>)) <b>break</b>;</td></tr>
<tr><th id="2617">2617</th><td>                    <b>else</b> <a class="local col4 ref" href="#354err" title='err' data-ref="354err" data-ref-filename="354err">err</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_NoError" title='mStatus_NoError' data-ref="mStatus_NoError" data-ref-filename="mStatus_NoError">mStatus_NoError</a>;  <i>// suppress errors for non-local "default" domains</i></td></tr>
<tr><th id="2618">2618</th><td>                }</td></tr>
<tr><th id="2619">2619</th><td>            }</td></tr>
<tr><th id="2620">2620</th><td>    }</td></tr>
<tr><th id="2621">2621</th><td></td></tr>
<tr><th id="2622">2622</th><td>    <b>return</b>(<a class="local col4 ref" href="#354err" title='err' data-ref="354err" data-ref-filename="354err">err</a>);</td></tr>
<tr><th id="2623">2623</th><td>}</td></tr>
<tr><th id="2624">2624</th><td></td></tr>
<tr><th id="2625">2625</th><td><i>// ***************************************************************************</i></td></tr>
<tr><th id="2626">2626</th><td><u>#<span data-ppcond="2626">if</span> COMPILER_LIKES_PRAGMA_MARK</u></td></tr>
<tr><th id="2627">2627</th><td><u>#pragma mark -</u></td></tr>
<tr><th id="2628">2628</th><td><u>#pragma mark - DNSServiceResolve</u></td></tr>
<tr><th id="2629">2629</th><td><u>#<span data-ppcond="2626">endif</span></u></td></tr>
<tr><th id="2630">2630</th><td></td></tr>
<tr><th id="2631">2631</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="resolve_result_callback" title='resolve_result_callback' data-ref="resolve_result_callback" data-ref-filename="resolve_result_callback">resolve_result_callback</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS" title='mDNS' data-type='struct mDNS_struct' data-ref="mDNS" data-ref-filename="mDNS">mDNS</a> *<em>const</em> <dfn class="local col1 decl" id="361m" title='m' data-type='mDNS *const' data-ref="361m" data-ref-filename="361m">m</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion" title='DNSQuestion' data-type='struct DNSQuestion_struct' data-ref="DNSQuestion" data-ref-filename="DNSQuestion">DNSQuestion</a> *<dfn class="local col2 decl" id="362question" title='question' data-type='DNSQuestion *' data-ref="362question" data-ref-filename="362question">question</dfn>, <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord" title='ResourceRecord' data-type='struct ResourceRecord_struct' data-ref="ResourceRecord" data-ref-filename="ResourceRecord">ResourceRecord</a> *<em>const</em> <dfn class="local col3 decl" id="363answer" title='answer' data-type='const ResourceRecord *const' data-ref="363answer" data-ref-filename="363answer">answer</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#QC_result" title='QC_result' data-type='enum QC_result' data-ref="QC_result" data-ref-filename="QC_result">QC_result</a> <dfn class="local col4 decl" id="364AddRecord" title='AddRecord' data-type='QC_result' data-ref="364AddRecord" data-ref-filename="364AddRecord">AddRecord</dfn>)</td></tr>
<tr><th id="2632">2632</th><td>{</td></tr>
<tr><th id="2633">2633</th><td>    <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#size_t" title='size_t' data-type='unsigned long' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col5 decl" id="365len" title='len' data-type='size_t' data-ref="365len" data-ref-filename="365len">len</dfn> = <var>0</var>;</td></tr>
<tr><th id="2634">2634</th><td>    <em>char</em> <dfn class="local col6 decl" id="366fullname" title='fullname' data-type='char [1009]' data-ref="366fullname" data-ref-filename="366fullname">fullname</dfn>[<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#417" title="1009" data-ref="_M/MAX_ESCAPED_DOMAIN_NAME">MAX_ESCAPED_DOMAIN_NAME</a>], <dfn class="local col7 decl" id="367target" title='target' data-type='char [1009]' data-ref="367target" data-ref-filename="367target">target</dfn>[<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#417" title="1009" data-ref="_M/MAX_ESCAPED_DOMAIN_NAME">MAX_ESCAPED_DOMAIN_NAME</a>] = <q>"0"</q>;</td></tr>
<tr><th id="2635">2635</th><td>    <em>char</em> *<dfn class="local col8 decl" id="368data" title='data' data-type='char *' data-ref="368data" data-ref-filename="368data">data</dfn>;</td></tr>
<tr><th id="2636">2636</th><td>    <a class="typedef" href="uds_daemon.h.html#reply_state" title='reply_state' data-type='struct reply_state' data-ref="reply_state" data-ref-filename="reply_state">reply_state</a> *<dfn class="local col9 decl" id="369rep" title='rep' data-type='reply_state *' data-ref="369rep" data-ref-filename="369rep">rep</dfn>;</td></tr>
<tr><th id="2637">2637</th><td>    <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col0 decl" id="370req" title='req' data-type='request_state *' data-ref="370req" data-ref-filename="370req">req</dfn> = <a class="local col2 ref" href="#362question" title='question' data-ref="362question" data-ref-filename="362question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::QuestionContext" title='DNSQuestion_struct::QuestionContext' data-ref="DNSQuestion_struct::QuestionContext" data-ref-filename="DNSQuestion_struct..QuestionContext">QuestionContext</a>;</td></tr>
<tr><th id="2638">2638</th><td>    <em>const</em> <a class="typedef" href="dns_sd.h.html#DNSServiceErrorType" title='DNSServiceErrorType' data-type='int32_t' data-ref="DNSServiceErrorType" data-ref-filename="DNSServiceErrorType">DNSServiceErrorType</a> <dfn class="local col1 decl" id="371error" title='error' data-type='const DNSServiceErrorType' data-ref="371error" data-ref-filename="371error">error</dfn> =</td></tr>
<tr><th id="2639">2639</th><td>        (<a class="local col3 ref" href="#363answer" title='answer' data-ref="363answer" data-ref-filename="363answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::RecordType" title='ResourceRecord_struct::RecordType' data-ref="ResourceRecord_struct::RecordType" data-ref-filename="ResourceRecord_struct..RecordType">RecordType</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSRecordTypePacketNegative" title='kDNSRecordTypePacketNegative' data-ref="kDNSRecordTypePacketNegative" data-ref-filename="kDNSRecordTypePacketNegative">kDNSRecordTypePacketNegative</a>) ? <a class="enum" href="dns_sd.h.html#kDNSServiceErr_NoSuchRecord" title='kDNSServiceErr_NoSuchRecord' data-ref="kDNSServiceErr_NoSuchRecord" data-ref-filename="kDNSServiceErr_NoSuchRecord">kDNSServiceErr_NoSuchRecord</a> : <a class="enum" href="dns_sd.h.html#kDNSServiceErr_NoError" title='kDNSServiceErr_NoError' data-ref="kDNSServiceErr_NoError" data-ref-filename="kDNSServiceErr_NoError">kDNSServiceErr_NoError</a>;</td></tr>
<tr><th id="2640">2640</th><td>    (<em>void</em>)<a class="local col1 ref" href="#361m" title='m' data-ref="361m" data-ref-filename="361m">m</a>; <i>// Unused</i></td></tr>
<tr><th id="2641">2641</th><td></td></tr>
<tr><th id="2642">2642</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: DNSServiceResolve(%##s) %s interface %d: %s&quot;, req-&gt;sd, question-&gt;qname.c, AddRecord ? &quot;ADD&quot; : &quot;RMV&quot;, mDNSPlatformInterfaceIndexfromInterfaceID(m, answer-&gt;InterfaceID, mDNSfalse), GetRRDisplayString_rdb(answer, &amp;(answer)-&gt;rdata-&gt;u, (m)-&gt;MsgBuffer));} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: DNSServiceResolve(%##s) %s interface %d: %s"</q>, </td></tr>
<tr><th id="2643">2643</th><td>        <a class="local col0 ref" href="#370req" title='req' data-ref="370req" data-ref-filename="370req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col2 ref" href="#362question" title='question' data-ref="362question" data-ref-filename="362question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="local col4 ref" href="#364AddRecord" title='AddRecord' data-ref="364AddRecord" data-ref-filename="364AddRecord">AddRecord</a> ? <q>"ADD"</q> : <q>"RMV"</q>,</td></tr>
<tr><th id="2644">2644</th><td>        <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformInterfaceIndexfromInterfaceID" title='mDNSPlatformInterfaceIndexfromInterfaceID' data-ref="mDNSPlatformInterfaceIndexfromInterfaceID" data-ref-filename="mDNSPlatformInterfaceIndexfromInterfaceID">mDNSPlatformInterfaceIndexfromInterfaceID</a>(<a class="local col1 ref" href="#361m" title='m' data-ref="361m" data-ref-filename="361m">m</a>, <a class="local col3 ref" href="#363answer" title='answer' data-ref="363answer" data-ref-filename="363answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::InterfaceID" title='ResourceRecord_struct::InterfaceID' data-ref="ResourceRecord_struct::InterfaceID" data-ref-filename="ResourceRecord_struct..InterfaceID">InterfaceID</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>), <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2941" title="GetRRDisplayString_rdb(answer, &amp;(answer)-&gt;rdata-&gt;u, (m)-&gt;MsgBuffer)" data-ref="_M/RRDisplayString">RRDisplayString</a>(<a class="local col1 ref" href="#361m" title='m' data-ref="361m" data-ref-filename="361m">m</a>, <a class="local col3 ref" href="#363answer" title='answer' data-ref="363answer" data-ref-filename="363answer">answer</a>));</td></tr>
<tr><th id="2645">2645</th><td></td></tr>
<tr><th id="2646">2646</th><td>    <b>if</b> (!<a class="local col4 ref" href="#364AddRecord" title='AddRecord' data-ref="364AddRecord" data-ref-filename="364AddRecord">AddRecord</a>)</td></tr>
<tr><th id="2647">2647</th><td>    {</td></tr>
<tr><th id="2648">2648</th><td>        <b>if</b> (<a class="local col0 ref" href="#370req" title='req' data-ref="370req" data-ref-filename="370req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::srv" title='request_state::(anonymous union)::(anonymous struct)::srv' data-ref="request_state::(anonymousunion)::(anonymous)::srv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..srv">srv</a> == <a class="local col3 ref" href="#363answer" title='answer' data-ref="363answer" data-ref-filename="363answer">answer</a>) <a class="local col0 ref" href="#370req" title='req' data-ref="370req" data-ref-filename="370req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::srv" title='request_state::(anonymous union)::(anonymous struct)::srv' data-ref="request_state::(anonymousunion)::(anonymous)::srv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..srv">srv</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="2649">2649</th><td>        <b>if</b> (<a class="local col0 ref" href="#370req" title='req' data-ref="370req" data-ref-filename="370req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txt" title='request_state::(anonymous union)::(anonymous struct)::txt' data-ref="request_state::(anonymousunion)::(anonymous)::txt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txt">txt</a> == <a class="local col3 ref" href="#363answer" title='answer' data-ref="363answer" data-ref-filename="363answer">answer</a>) <a class="local col0 ref" href="#370req" title='req' data-ref="370req" data-ref-filename="370req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txt" title='request_state::(anonymous union)::(anonymous struct)::txt' data-ref="request_state::(anonymousunion)::(anonymous)::txt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txt">txt</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="2650">2650</th><td>        <b>return</b>;</td></tr>
<tr><th id="2651">2651</th><td>    }</td></tr>
<tr><th id="2652">2652</th><td></td></tr>
<tr><th id="2653">2653</th><td>    <b>if</b> (<a class="local col3 ref" href="#363answer" title='answer' data-ref="363answer" data-ref-filename="363answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rrtype" title='ResourceRecord_struct::rrtype' data-ref="ResourceRecord_struct::rrtype" data-ref-filename="ResourceRecord_struct..rrtype">rrtype</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSType_SRV" title='kDNSType_SRV' data-ref="kDNSType_SRV" data-ref-filename="kDNSType_SRV">kDNSType_SRV</a>) <a class="local col0 ref" href="#370req" title='req' data-ref="370req" data-ref-filename="370req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::srv" title='request_state::(anonymous union)::(anonymous struct)::srv' data-ref="request_state::(anonymousunion)::(anonymous)::srv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..srv">srv</a> = <a class="local col3 ref" href="#363answer" title='answer' data-ref="363answer" data-ref-filename="363answer">answer</a>;</td></tr>
<tr><th id="2654">2654</th><td>    <b>if</b> (<a class="local col3 ref" href="#363answer" title='answer' data-ref="363answer" data-ref-filename="363answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rrtype" title='ResourceRecord_struct::rrtype' data-ref="ResourceRecord_struct::rrtype" data-ref-filename="ResourceRecord_struct..rrtype">rrtype</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSType_TXT" title='kDNSType_TXT' data-ref="kDNSType_TXT" data-ref-filename="kDNSType_TXT">kDNSType_TXT</a>) <a class="local col0 ref" href="#370req" title='req' data-ref="370req" data-ref-filename="370req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txt" title='request_state::(anonymous union)::(anonymous struct)::txt' data-ref="request_state::(anonymousunion)::(anonymous)::txt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txt">txt</a> = <a class="local col3 ref" href="#363answer" title='answer' data-ref="363answer" data-ref-filename="363answer">answer</a>;</td></tr>
<tr><th id="2655">2655</th><td></td></tr>
<tr><th id="2656">2656</th><td>    <b>if</b> (!<a class="local col0 ref" href="#370req" title='req' data-ref="370req" data-ref-filename="370req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txt" title='request_state::(anonymous union)::(anonymous struct)::txt' data-ref="request_state::(anonymousunion)::(anonymous)::txt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txt">txt</a> || !<a class="local col0 ref" href="#370req" title='req' data-ref="370req" data-ref-filename="370req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::srv" title='request_state::(anonymous union)::(anonymous struct)::srv' data-ref="request_state::(anonymousunion)::(anonymous)::srv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..srv">srv</a>) <b>return</b>;     <i>// only deliver result to client if we have both answers</i></td></tr>
<tr><th id="2657">2657</th><td></td></tr>
<tr><th id="2658">2658</th><td>    <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2903" title="ConvertDomainNameToCString_withescape((answer-&gt;name), (fullname), &apos;\\&apos;)" data-ref="_M/ConvertDomainNameToCString">ConvertDomainNameToCString</a>(<a class="local col3 ref" href="#363answer" title='answer' data-ref="363answer" data-ref-filename="363answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::name" title='ResourceRecord_struct::name' data-ref="ResourceRecord_struct::name" data-ref-filename="ResourceRecord_struct..name">name</a>, <a class="local col6 ref" href="#366fullname" title='fullname' data-ref="366fullname" data-ref-filename="366fullname">fullname</a>);</td></tr>
<tr><th id="2659">2659</th><td></td></tr>
<tr><th id="2660">2660</th><td>    <b>if</b> (<a class="local col3 ref" href="#363answer" title='answer' data-ref="363answer" data-ref-filename="363answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::RecordType" title='ResourceRecord_struct::RecordType' data-ref="ResourceRecord_struct::RecordType" data-ref-filename="ResourceRecord_struct..RecordType">RecordType</a> != <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSRecordTypePacketNegative" title='kDNSRecordTypePacketNegative' data-ref="kDNSRecordTypePacketNegative" data-ref-filename="kDNSRecordTypePacketNegative">kDNSRecordTypePacketNegative</a>)</td></tr>
<tr><th id="2661">2661</th><td>        <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2903" title="ConvertDomainNameToCString_withescape((&amp;req-&gt;u.resolve.srv-&gt;rdata-&gt;u.srv.target), (target), &apos;\\&apos;)" data-ref="_M/ConvertDomainNameToCString">ConvertDomainNameToCString</a>(&amp;<a class="local col0 ref" href="#370req" title='req' data-ref="370req" data-ref-filename="370req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::srv" title='request_state::(anonymous union)::(anonymous struct)::srv' data-ref="request_state::(anonymousunion)::(anonymous)::srv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..srv">srv</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdata" title='ResourceRecord_struct::rdata' data-ref="ResourceRecord_struct::rdata" data-ref-filename="ResourceRecord_struct..rdata">rdata</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::u" title='(anonymous struct)::u' data-ref="(anonymous)::u" data-ref-filename="(anonymous)..u">u</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::srv" title='(anonymous union)::srv' data-ref="(anonymous)::srv" data-ref-filename="(anonymous)..srv">srv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::target" title='(anonymous struct)::target' data-ref="(anonymous)::target" data-ref-filename="(anonymous)..target">target</a>, <a class="local col7 ref" href="#367target" title='target' data-ref="367target" data-ref-filename="367target">target</a>);</td></tr>
<tr><th id="2662">2662</th><td></td></tr>
<tr><th id="2663">2663</th><td>    <i>// calculate reply length</i></td></tr>
<tr><th id="2664">2664</th><td>    <a class="local col5 ref" href="#365len" title='len' data-ref="365len" data-ref-filename="365len">len</a> += <b>sizeof</b>(<a class="typedef" href="dns_sd.h.html#DNSServiceFlags" title='DNSServiceFlags' data-type='uint32_t' data-ref="DNSServiceFlags" data-ref-filename="DNSServiceFlags">DNSServiceFlags</a>);</td></tr>
<tr><th id="2665">2665</th><td>    <a class="local col5 ref" href="#365len" title='len' data-ref="365len" data-ref-filename="365len">len</a> += <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a>);  <i>// interface index</i></td></tr>
<tr><th id="2666">2666</th><td>    <a class="local col5 ref" href="#365len" title='len' data-ref="365len" data-ref-filename="365len">len</a> += <b>sizeof</b>(<a class="typedef" href="dns_sd.h.html#DNSServiceErrorType" title='DNSServiceErrorType' data-type='int32_t' data-ref="DNSServiceErrorType" data-ref-filename="DNSServiceErrorType">DNSServiceErrorType</a>);</td></tr>
<tr><th id="2667">2667</th><td>    <a class="local col5 ref" href="#365len" title='len' data-ref="365len" data-ref-filename="365len">len</a> += <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strlen" title='strlen' data-ref="strlen" data-ref-filename="strlen">strlen</a>(<a class="local col6 ref" href="#366fullname" title='fullname' data-ref="366fullname" data-ref-filename="366fullname">fullname</a>) + <var>1</var>;</td></tr>
<tr><th id="2668">2668</th><td>    <a class="local col5 ref" href="#365len" title='len' data-ref="365len" data-ref-filename="365len">len</a> += <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strlen" title='strlen' data-ref="strlen" data-ref-filename="strlen">strlen</a>(<a class="local col7 ref" href="#367target" title='target' data-ref="367target" data-ref-filename="367target">target</a>) + <var>1</var>;</td></tr>
<tr><th id="2669">2669</th><td>    <a class="local col5 ref" href="#365len" title='len' data-ref="365len" data-ref-filename="365len">len</a> += <var>2</var> * <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu16" title='mDNSu16' data-type='unsigned short' data-ref="mDNSu16" data-ref-filename="mDNSu16">mDNSu16</a>);  <i>// port, txtLen</i></td></tr>
<tr><th id="2670">2670</th><td>    <a class="local col5 ref" href="#365len" title='len' data-ref="365len" data-ref-filename="365len">len</a> += <a class="local col0 ref" href="#370req" title='req' data-ref="370req" data-ref-filename="370req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txt" title='request_state::(anonymous union)::(anonymous struct)::txt' data-ref="request_state::(anonymousunion)::(anonymous)::txt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txt">txt</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdlength" title='ResourceRecord_struct::rdlength' data-ref="ResourceRecord_struct::rdlength" data-ref-filename="ResourceRecord_struct..rdlength">rdlength</a>;</td></tr>
<tr><th id="2671">2671</th><td></td></tr>
<tr><th id="2672">2672</th><td>    <i>// allocate/init reply header</i></td></tr>
<tr><th id="2673">2673</th><td>    <a class="local col9 ref" href="#369rep" title='rep' data-ref="369rep" data-ref-filename="369rep">rep</a> = <a class="ref fn" href="#create_reply" title='create_reply' data-ref="create_reply" data-ref-filename="create_reply">create_reply</a>(<a class="enum" href="dnssd_ipc.h.html#resolve_reply_op" title='resolve_reply_op' data-ref="resolve_reply_op" data-ref-filename="resolve_reply_op">resolve_reply_op</a>, <a class="local col5 ref" href="#365len" title='len' data-ref="365len" data-ref-filename="365len">len</a>, <a class="local col0 ref" href="#370req" title='req' data-ref="370req" data-ref-filename="370req">req</a>);</td></tr>
<tr><th id="2674">2674</th><td>    <a class="local col9 ref" href="#369rep" title='rep' data-ref="369rep" data-ref-filename="369rep">rep</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::rhdr" title='reply_state::rhdr' data-ref="reply_state::rhdr" data-ref-filename="reply_state..rhdr">rhdr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#(anonymous)::flags" title='(anonymous struct)::flags' data-ref="(anonymous)::flags" data-ref-filename="(anonymous)..flags">flags</a> = <a class="ref fn" href="#dnssd_htonl" title='dnssd_htonl' data-ref="dnssd_htonl" data-ref-filename="dnssd_htonl">dnssd_htonl</a>(<var>0</var>);</td></tr>
<tr><th id="2675">2675</th><td>    <a class="local col9 ref" href="#369rep" title='rep' data-ref="369rep" data-ref-filename="369rep">rep</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::rhdr" title='reply_state::rhdr' data-ref="reply_state::rhdr" data-ref-filename="reply_state..rhdr">rhdr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#(anonymous)::ifi" title='(anonymous struct)::ifi' data-ref="(anonymous)::ifi" data-ref-filename="(anonymous)..ifi">ifi</a>   = <a class="ref fn" href="#dnssd_htonl" title='dnssd_htonl' data-ref="dnssd_htonl" data-ref-filename="dnssd_htonl">dnssd_htonl</a>(<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformInterfaceIndexfromInterfaceID" title='mDNSPlatformInterfaceIndexfromInterfaceID' data-ref="mDNSPlatformInterfaceIndexfromInterfaceID" data-ref-filename="mDNSPlatformInterfaceIndexfromInterfaceID">mDNSPlatformInterfaceIndexfromInterfaceID</a>(<a class="local col1 ref" href="#361m" title='m' data-ref="361m" data-ref-filename="361m">m</a>, <a class="local col3 ref" href="#363answer" title='answer' data-ref="363answer" data-ref-filename="363answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::InterfaceID" title='ResourceRecord_struct::InterfaceID' data-ref="ResourceRecord_struct::InterfaceID" data-ref-filename="ResourceRecord_struct..InterfaceID">InterfaceID</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>));</td></tr>
<tr><th id="2676">2676</th><td>    <a class="local col9 ref" href="#369rep" title='rep' data-ref="369rep" data-ref-filename="369rep">rep</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::rhdr" title='reply_state::rhdr' data-ref="reply_state::rhdr" data-ref-filename="reply_state..rhdr">rhdr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#(anonymous)::error" title='(anonymous struct)::error' data-ref="(anonymous)::error" data-ref-filename="(anonymous)..error">error</a> = <a class="ref fn" href="#dnssd_htonl" title='dnssd_htonl' data-ref="dnssd_htonl" data-ref-filename="dnssd_htonl">dnssd_htonl</a>(<a class="local col1 ref" href="#371error" title='error' data-ref="371error" data-ref-filename="371error">error</a>);</td></tr>
<tr><th id="2677">2677</th><td></td></tr>
<tr><th id="2678">2678</th><td>    <a class="local col8 ref" href="#368data" title='data' data-ref="368data" data-ref-filename="368data">data</a> = (<em>char</em> *)&amp;<a class="local col9 ref" href="#369rep" title='rep' data-ref="369rep" data-ref-filename="369rep">rep</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::rhdr" title='reply_state::rhdr' data-ref="reply_state::rhdr" data-ref-filename="reply_state..rhdr">rhdr</a>[<var>1</var>];</td></tr>
<tr><th id="2679">2679</th><td></td></tr>
<tr><th id="2680">2680</th><td>    <i>// write reply data to message</i></td></tr>
<tr><th id="2681">2681</th><td>    <a class="macro" href="dnssd_ipc.h.html#197" title="__dnssd_ipc_put_string" data-ref="_M/put_string">put_string</a>(<a class="local col6 ref" href="#366fullname" title='fullname' data-ref="366fullname" data-ref-filename="366fullname">fullname</a>, &amp;<a class="local col8 ref" href="#368data" title='data' data-ref="368data" data-ref-filename="368data">data</a>);</td></tr>
<tr><th id="2682">2682</th><td>    <a class="macro" href="dnssd_ipc.h.html#197" title="__dnssd_ipc_put_string" data-ref="_M/put_string">put_string</a>(<a class="local col7 ref" href="#367target" title='target' data-ref="367target" data-ref-filename="367target">target</a>, &amp;<a class="local col8 ref" href="#368data" title='data' data-ref="368data" data-ref-filename="368data">data</a>);</td></tr>
<tr><th id="2683">2683</th><td>    *<a class="local col8 ref" href="#368data" title='data' data-ref="368data" data-ref-filename="368data">data</a>++ =  <a class="local col0 ref" href="#370req" title='req' data-ref="370req" data-ref-filename="370req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::srv" title='request_state::(anonymous union)::(anonymous struct)::srv' data-ref="request_state::(anonymousunion)::(anonymous)::srv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..srv">srv</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdata" title='ResourceRecord_struct::rdata' data-ref="ResourceRecord_struct::rdata" data-ref-filename="ResourceRecord_struct..rdata">rdata</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::u" title='(anonymous struct)::u' data-ref="(anonymous)::u" data-ref-filename="(anonymous)..u">u</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::srv" title='(anonymous union)::srv' data-ref="(anonymous)::srv" data-ref-filename="(anonymous)..srv">srv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::port" title='(anonymous struct)::port' data-ref="(anonymous)::port" data-ref-filename="(anonymous)..port">port</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::b" title='(anonymous union)::b' data-ref="(anonymous)::b" data-ref-filename="(anonymous)..b">b</a>[<var>0</var>];</td></tr>
<tr><th id="2684">2684</th><td>    *<a class="local col8 ref" href="#368data" title='data' data-ref="368data" data-ref-filename="368data">data</a>++ =  <a class="local col0 ref" href="#370req" title='req' data-ref="370req" data-ref-filename="370req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::srv" title='request_state::(anonymous union)::(anonymous struct)::srv' data-ref="request_state::(anonymousunion)::(anonymous)::srv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..srv">srv</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdata" title='ResourceRecord_struct::rdata' data-ref="ResourceRecord_struct::rdata" data-ref-filename="ResourceRecord_struct..rdata">rdata</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::u" title='(anonymous struct)::u' data-ref="(anonymous)::u" data-ref-filename="(anonymous)..u">u</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::srv" title='(anonymous union)::srv' data-ref="(anonymous)::srv" data-ref-filename="(anonymous)..srv">srv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::port" title='(anonymous struct)::port' data-ref="(anonymous)::port" data-ref-filename="(anonymous)..port">port</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::b" title='(anonymous union)::b' data-ref="(anonymous)::b" data-ref-filename="(anonymous)..b">b</a>[<var>1</var>];</td></tr>
<tr><th id="2685">2685</th><td>    <a class="macro" href="dnssd_ipc.h.html#195" title="__dnssd_ipc_put_uint16" data-ref="_M/put_uint16">put_uint16</a>(<a class="local col0 ref" href="#370req" title='req' data-ref="370req" data-ref-filename="370req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txt" title='request_state::(anonymous union)::(anonymous struct)::txt' data-ref="request_state::(anonymousunion)::(anonymous)::txt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txt">txt</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdlength" title='ResourceRecord_struct::rdlength' data-ref="ResourceRecord_struct::rdlength" data-ref-filename="ResourceRecord_struct..rdlength">rdlength</a>, &amp;<a class="local col8 ref" href="#368data" title='data' data-ref="368data" data-ref-filename="368data">data</a>);</td></tr>
<tr><th id="2686">2686</th><td>    <a class="macro" href="dnssd_ipc.h.html#199" title="__dnssd_ipc_put_rdata" data-ref="_M/put_rdata">put_rdata</a> (<a class="local col0 ref" href="#370req" title='req' data-ref="370req" data-ref-filename="370req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txt" title='request_state::(anonymous union)::(anonymous struct)::txt' data-ref="request_state::(anonymousunion)::(anonymous)::txt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txt">txt</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdlength" title='ResourceRecord_struct::rdlength' data-ref="ResourceRecord_struct::rdlength" data-ref-filename="ResourceRecord_struct..rdlength">rdlength</a>, <a class="local col0 ref" href="#370req" title='req' data-ref="370req" data-ref-filename="370req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txt" title='request_state::(anonymous union)::(anonymous struct)::txt' data-ref="request_state::(anonymousunion)::(anonymous)::txt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txt">txt</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdata" title='ResourceRecord_struct::rdata' data-ref="ResourceRecord_struct::rdata" data-ref-filename="ResourceRecord_struct..rdata">rdata</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::u" title='(anonymous struct)::u' data-ref="(anonymous)::u" data-ref-filename="(anonymous)..u">u</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::data" title='(anonymous union)::data' data-ref="(anonymous)::data" data-ref-filename="(anonymous)..data">data</a>, &amp;<a class="local col8 ref" href="#368data" title='data' data-ref="368data" data-ref-filename="368data">data</a>);</td></tr>
<tr><th id="2687">2687</th><td></td></tr>
<tr><th id="2688">2688</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: DNSServiceResolve(%s) RESULT   %s:%d&quot;, req-&gt;sd, fullname, target, mDNSVal16(req-&gt;u.resolve.srv-&gt;rdata-&gt;u.srv.port));} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: DNSServiceResolve(%s) RESULT   %s:%d"</q>, <a class="local col0 ref" href="#370req" title='req' data-ref="370req" data-ref-filename="370req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col6 ref" href="#366fullname" title='fullname' data-ref="366fullname" data-ref-filename="366fullname">fullname</a>, <a class="local col7 ref" href="#367target" title='target' data-ref="367target" data-ref-filename="367target">target</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSVal16" title='mDNSVal16' data-ref="mDNSVal16" data-ref-filename="mDNSVal16">mDNSVal16</a>(<a class="local col0 ref" href="#370req" title='req' data-ref="370req" data-ref-filename="370req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::srv" title='request_state::(anonymous union)::(anonymous struct)::srv' data-ref="request_state::(anonymousunion)::(anonymous)::srv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..srv">srv</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdata" title='ResourceRecord_struct::rdata' data-ref="ResourceRecord_struct::rdata" data-ref-filename="ResourceRecord_struct..rdata">rdata</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::u" title='(anonymous struct)::u' data-ref="(anonymous)::u" data-ref-filename="(anonymous)..u">u</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::srv" title='(anonymous union)::srv' data-ref="(anonymous)::srv" data-ref-filename="(anonymous)..srv">srv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::port" title='(anonymous struct)::port' data-ref="(anonymous)::port" data-ref-filename="(anonymous)..port">port</a>));</td></tr>
<tr><th id="2689">2689</th><td>    <a class="ref fn" href="#append_reply" title='append_reply' data-ref="append_reply" data-ref-filename="append_reply">append_reply</a>(<a class="local col0 ref" href="#370req" title='req' data-ref="370req" data-ref-filename="370req">req</a>, <a class="local col9 ref" href="#369rep" title='rep' data-ref="369rep" data-ref-filename="369rep">rep</a>);</td></tr>
<tr><th id="2690">2690</th><td>}</td></tr>
<tr><th id="2691">2691</th><td></td></tr>
<tr><th id="2692">2692</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="resolve_termination_callback" title='resolve_termination_callback' data-ref="resolve_termination_callback" data-ref-filename="resolve_termination_callback">resolve_termination_callback</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col2 decl" id="372request" title='request' data-type='request_state *' data-ref="372request" data-ref-filename="372request">request</dfn>)</td></tr>
<tr><th id="2693">2693</th><td>{</td></tr>
<tr><th id="2694">2694</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: DNSServiceResolve(%X, %d, \&quot;%##s\&quot;) STOP PID[%d](%s)&quot;, request-&gt;sd, request-&gt;flags, request-&gt;interfaceIndex, request-&gt;u.resolve.qtxt.qname.c, request-&gt;process_id, request-&gt;pid_name);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: DNSServiceResolve(%X, %d, \"%##s\") STOP PID[%d](%s)"</q>,</td></tr>
<tr><th id="2695">2695</th><td>                 <a class="local col2 ref" href="#372request" title='request' data-ref="372request" data-ref-filename="372request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col2 ref" href="#372request" title='request' data-ref="372request" data-ref-filename="372request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a>, <a class="local col2 ref" href="#372request" title='request' data-ref="372request" data-ref-filename="372request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::interfaceIndex" title='request_state::interfaceIndex' data-ref="request_state::interfaceIndex" data-ref-filename="request_state..interfaceIndex">interfaceIndex</a>, <a class="local col2 ref" href="#372request" title='request' data-ref="372request" data-ref-filename="372request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qtxt" title='request_state::(anonymous union)::(anonymous struct)::qtxt' data-ref="request_state::(anonymousunion)::(anonymous)::qtxt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qtxt">qtxt</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="local col2 ref" href="#372request" title='request' data-ref="372request" data-ref-filename="372request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col2 ref" href="#372request" title='request' data-ref="372request" data-ref-filename="372request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="2696">2696</th><td>    <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_StopQuery" title='mDNS_StopQuery' data-ref="mDNS_StopQuery" data-ref-filename="mDNS_StopQuery">mDNS_StopQuery</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col2 ref" href="#372request" title='request' data-ref="372request" data-ref-filename="372request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qtxt" title='request_state::(anonymous union)::(anonymous struct)::qtxt' data-ref="request_state::(anonymousunion)::(anonymous)::qtxt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qtxt">qtxt</a>);</td></tr>
<tr><th id="2697">2697</th><td>    <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_StopQuery" title='mDNS_StopQuery' data-ref="mDNS_StopQuery" data-ref-filename="mDNS_StopQuery">mDNS_StopQuery</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col2 ref" href="#372request" title='request' data-ref="372request" data-ref-filename="372request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>);</td></tr>
<tr><th id="2698">2698</th><td>    <a class="macro" href="uds_daemon.h.html#224" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMcastQuestion" data-ref="_M/LogMcastQ">LogMcastQ</a>(&amp;<a class="local col2 ref" href="#372request" title='request' data-ref="372request" data-ref-filename="372request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>, <a class="local col2 ref" href="#372request" title='request' data-ref="372request" data-ref-filename="372request">request</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#q_stop" title='q_stop' data-ref="q_stop" data-ref-filename="q_stop">q_stop</a>);</td></tr>
<tr><th id="2699">2699</th><td>    <b>if</b> (<a class="local col2 ref" href="#372request" title='request' data-ref="372request" data-ref-filename="372request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::external_advertise" title='request_state::(anonymous union)::(anonymous struct)::external_advertise' data-ref="request_state::(anonymousunion)::(anonymous)::external_advertise" data-ref-filename="request_state..(anonymousunion)..(anonymous)..external_advertise">external_advertise</a>)</td></tr>
<tr><th id="2700">2700</th><td>        <a class="macro" href="uds_daemon.h.html#269" title="(void)(request-&gt;u.resolve.qsrv.InterfaceID)" data-ref="_M/external_stop_resolving_service">external_stop_resolving_service</a>(<a class="local col2 ref" href="#372request" title='request' data-ref="372request" data-ref-filename="372request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::InterfaceID" title='DNSQuestion_struct::InterfaceID' data-ref="DNSQuestion_struct::InterfaceID" data-ref-filename="DNSQuestion_struct..InterfaceID">InterfaceID</a>, &amp;request-&gt;u.resolve.qsrv.qname, request-&gt;flags);</td></tr>
<tr><th id="2701">2701</th><td>}</td></tr>
<tr><th id="2702">2702</th><td></td></tr>
<tr><th id="2703">2703</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="decl def fn" id="handle_resolve_request" title='handle_resolve_request' data-ref="handle_resolve_request" data-ref-filename="handle_resolve_request">handle_resolve_request</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col3 decl" id="373request" title='request' data-type='request_state *' data-ref="373request" data-ref-filename="373request">request</dfn>)</td></tr>
<tr><th id="2704">2704</th><td>{</td></tr>
<tr><th id="2705">2705</th><td>    <em>char</em> <dfn class="local col4 decl" id="374name" title='name' data-type='char [256]' data-ref="374name" data-ref-filename="374name">name</dfn>[<var>256</var>], <dfn class="local col5 decl" id="375regtype" title='regtype' data-type='char [1009]' data-ref="375regtype" data-ref-filename="375regtype">regtype</dfn>[<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#417" title="1009" data-ref="_M/MAX_ESCAPED_DOMAIN_NAME">MAX_ESCAPED_DOMAIN_NAME</a>], <dfn class="local col6 decl" id="376domain" title='domain' data-type='char [1009]' data-ref="376domain" data-ref-filename="376domain">domain</dfn>[<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#417" title="1009" data-ref="_M/MAX_ESCAPED_DOMAIN_NAME">MAX_ESCAPED_DOMAIN_NAME</a>];</td></tr>
<tr><th id="2706">2706</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#domainname" title='domainname' data-type='struct domainname' data-ref="domainname" data-ref-filename="domainname">domainname</a> <dfn class="local col7 decl" id="377fqdn" title='fqdn' data-type='domainname' data-ref="377fqdn" data-ref-filename="377fqdn">fqdn</dfn>;</td></tr>
<tr><th id="2707">2707</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="local col8 decl" id="378err" title='err' data-type='mStatus' data-ref="378err" data-ref-filename="378err">err</dfn>;</td></tr>
<tr><th id="2708">2708</th><td></td></tr>
<tr><th id="2709">2709</th><td>    <i>// extract the data from the message</i></td></tr>
<tr><th id="2710">2710</th><td>    <a class="typedef" href="dns_sd.h.html#DNSServiceFlags" title='DNSServiceFlags' data-type='uint32_t' data-ref="DNSServiceFlags" data-ref-filename="DNSServiceFlags">DNSServiceFlags</a> <dfn class="local col9 decl" id="379flags" title='flags' data-type='DNSServiceFlags' data-ref="379flags" data-ref-filename="379flags">flags</dfn> = <a class="macro" href="dnssd_ipc.h.html#210" title="__dnssd_ipc_get_uint32" data-ref="_M/get_flags">get_flags</a>(&amp;<a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);</td></tr>
<tr><th id="2711">2711</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col0 decl" id="380interfaceIndex" title='interfaceIndex' data-type='mDNSu32' data-ref="380interfaceIndex" data-ref-filename="380interfaceIndex">interfaceIndex</dfn> = <a class="macro" href="dnssd_ipc.h.html#194" title="__dnssd_ipc_get_uint32" data-ref="_M/get_uint32">get_uint32</a>(&amp;<a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);</td></tr>
<tr><th id="2712">2712</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterfaceID" title='mDNSInterfaceID' data-type='struct mDNSInterfaceID_dummystruct *' data-ref="mDNSInterfaceID" data-ref-filename="mDNSInterfaceID">mDNSInterfaceID</a> <dfn class="local col1 decl" id="381InterfaceID" title='InterfaceID' data-type='mDNSInterfaceID' data-ref="381InterfaceID" data-ref-filename="381InterfaceID">InterfaceID</dfn>;</td></tr>
<tr><th id="2713">2713</th><td></td></tr>
<tr><th id="2714">2714</th><td>    <i>// Map kDNSServiceInterfaceIndexP2P to kDNSServiceInterfaceIndexAny with the kDNSServiceFlagsIncludeP2P</i></td></tr>
<tr><th id="2715">2715</th><td><i>    // flag set so that the resolve will run over P2P interfaces that are not yet created.</i></td></tr>
<tr><th id="2716">2716</th><td>    <b>if</b> (<a class="local col0 ref" href="#380interfaceIndex" title='interfaceIndex' data-ref="380interfaceIndex" data-ref-filename="380interfaceIndex">interfaceIndex</a> == <a class="macro" href="dns_sd.h.html#842" title="((uint32_t)-3)" data-ref="_M/kDNSServiceInterfaceIndexP2P">kDNSServiceInterfaceIndexP2P</a>)</td></tr>
<tr><th id="2717">2717</th><td>    {</td></tr>
<tr><th id="2718">2718</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;handle_resolve_request: mapping kDNSServiceInterfaceIndexP2P to kDNSServiceInterfaceIndexAny + kDNSServiceFlagsIncludeP2P&quot;);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"handle_resolve_request: mapping kDNSServiceInterfaceIndexP2P to kDNSServiceInterfaceIndexAny + kDNSServiceFlagsIncludeP2P"</q>);</td></tr>
<tr><th id="2719">2719</th><td>        <a class="local col9 ref" href="#379flags" title='flags' data-ref="379flags" data-ref-filename="379flags">flags</a> |= <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsIncludeP2P" title='kDNSServiceFlagsIncludeP2P' data-ref="kDNSServiceFlagsIncludeP2P" data-ref-filename="kDNSServiceFlagsIncludeP2P">kDNSServiceFlagsIncludeP2P</a>;</td></tr>
<tr><th id="2720">2720</th><td>        <a class="local col0 ref" href="#380interfaceIndex" title='interfaceIndex' data-ref="380interfaceIndex" data-ref-filename="380interfaceIndex">interfaceIndex</a> = <a class="macro" href="dns_sd.h.html#839" title="0" data-ref="_M/kDNSServiceInterfaceIndexAny">kDNSServiceInterfaceIndexAny</a>;</td></tr>
<tr><th id="2721">2721</th><td>    }</td></tr>
<tr><th id="2722">2722</th><td></td></tr>
<tr><th id="2723">2723</th><td>    <a class="local col1 ref" href="#381InterfaceID" title='InterfaceID' data-ref="381InterfaceID" data-ref-filename="381InterfaceID">InterfaceID</a> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformInterfaceIDfromInterfaceIndex" title='mDNSPlatformInterfaceIDfromInterfaceIndex' data-ref="mDNSPlatformInterfaceIDfromInterfaceIndex" data-ref-filename="mDNSPlatformInterfaceIDfromInterfaceIndex">mDNSPlatformInterfaceIDfromInterfaceIndex</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col0 ref" href="#380interfaceIndex" title='interfaceIndex' data-ref="380interfaceIndex" data-ref-filename="380interfaceIndex">interfaceIndex</a>);</td></tr>
<tr><th id="2724">2724</th><td></td></tr>
<tr><th id="2725">2725</th><td>    <i>// The operation is scoped to a specific interface index, but the </i></td></tr>
<tr><th id="2726">2726</th><td><i>    // interface is not currently in our list.</i></td></tr>
<tr><th id="2727">2727</th><td>    <b>if</b> (<a class="local col0 ref" href="#380interfaceIndex" title='interfaceIndex' data-ref="380interfaceIndex" data-ref-filename="380interfaceIndex">interfaceIndex</a> &amp;&amp; !<a class="local col1 ref" href="#381InterfaceID" title='InterfaceID' data-ref="381InterfaceID" data-ref-filename="381InterfaceID">InterfaceID</a>)</td></tr>
<tr><th id="2728">2728</th><td>    {</td></tr>
<tr><th id="2729">2729</th><td>        <i>// If it's one of the specially defined inteface index values, just return an error.</i></td></tr>
<tr><th id="2730">2730</th><td>        <b>if</b> (<a class="ref fn" href="#PreDefinedInterfaceIndex" title='PreDefinedInterfaceIndex' data-ref="PreDefinedInterfaceIndex" data-ref-filename="PreDefinedInterfaceIndex">PreDefinedInterfaceIndex</a>(<a class="local col0 ref" href="#380interfaceIndex" title='interfaceIndex' data-ref="380interfaceIndex" data-ref-filename="380interfaceIndex">interfaceIndex</a>))</td></tr>
<tr><th id="2731">2731</th><td>        {</td></tr>
<tr><th id="2732">2732</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;handle_resolve_request: bad interfaceIndex %d&quot;, interfaceIndex);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"handle_resolve_request: bad interfaceIndex %d"</q>, <a class="local col0 ref" href="#380interfaceIndex" title='interfaceIndex' data-ref="380interfaceIndex" data-ref-filename="380interfaceIndex">interfaceIndex</a>);</td></tr>
<tr><th id="2733">2733</th><td>            <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>);</td></tr>
<tr><th id="2734">2734</th><td>        }</td></tr>
<tr><th id="2735">2735</th><td></td></tr>
<tr><th id="2736">2736</th><td>        <i>// Otherwise, use the specified interface index value and the operation will</i></td></tr>
<tr><th id="2737">2737</th><td><i>        // be applied to that interface when it comes up.</i></td></tr>
<tr><th id="2738">2738</th><td>        <a class="local col1 ref" href="#381InterfaceID" title='InterfaceID' data-ref="381InterfaceID" data-ref-filename="381InterfaceID">InterfaceID</a> = (<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterfaceID" title='mDNSInterfaceID' data-type='struct mDNSInterfaceID_dummystruct *' data-ref="mDNSInterfaceID" data-ref-filename="mDNSInterfaceID">mDNSInterfaceID</a>)(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/stdint.h.html#uintptr_t" title='uintptr_t' data-type='__uintptr_t' data-ref="uintptr_t" data-ref-filename="uintptr_t">uintptr_t</a>)<a class="local col0 ref" href="#380interfaceIndex" title='interfaceIndex' data-ref="380interfaceIndex" data-ref-filename="380interfaceIndex">interfaceIndex</a>;</td></tr>
<tr><th id="2739">2739</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;handle_resolve_request: resolve pending for interface index %d&quot;, interfaceIndex);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"handle_resolve_request: resolve pending for interface index %d"</q>, <a class="local col0 ref" href="#380interfaceIndex" title='interfaceIndex' data-ref="380interfaceIndex" data-ref-filename="380interfaceIndex">interfaceIndex</a>);</td></tr>
<tr><th id="2740">2740</th><td>    }</td></tr>
<tr><th id="2741">2741</th><td></td></tr>
<tr><th id="2742">2742</th><td>    <b>if</b> (<a class="macro" href="dnssd_ipc.h.html#198" title="__dnssd_ipc_get_string" data-ref="_M/get_string">get_string</a>(&amp;<a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>, <a class="local col4 ref" href="#374name" title='name' data-ref="374name" data-ref-filename="374name">name</a>, <var>256</var>) &lt; <var>0</var> ||</td></tr>
<tr><th id="2743">2743</th><td>        <a class="macro" href="dnssd_ipc.h.html#198" title="__dnssd_ipc_get_string" data-ref="_M/get_string">get_string</a>(&amp;<a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>, <a class="local col5 ref" href="#375regtype" title='regtype' data-ref="375regtype" data-ref-filename="375regtype">regtype</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#417" title="1009" data-ref="_M/MAX_ESCAPED_DOMAIN_NAME">MAX_ESCAPED_DOMAIN_NAME</a>) &lt; <var>0</var> ||</td></tr>
<tr><th id="2744">2744</th><td>        <a class="macro" href="dnssd_ipc.h.html#198" title="__dnssd_ipc_get_string" data-ref="_M/get_string">get_string</a>(&amp;<a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>, <a class="local col6 ref" href="#376domain" title='domain' data-ref="376domain" data-ref-filename="376domain">domain</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#417" title="1009" data-ref="_M/MAX_ESCAPED_DOMAIN_NAME">MAX_ESCAPED_DOMAIN_NAME</a>) &lt; <var>0</var>)</td></tr>
<tr><th id="2745">2745</th><td>    { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;ERROR: handle_resolve_request - Couldn&apos;t read name/regtype/domain&quot;)" data-ref="_M/LogMsg">LogMsg</a>(<q>"ERROR: handle_resolve_request - Couldn't read name/regtype/domain"</q>); <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>); }</td></tr>
<tr><th id="2746">2746</th><td></td></tr>
<tr><th id="2747">2747</th><td>    <b>if</b> (!<a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>) { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: DNSServiceResolve(unreadable parameters)&quot;, request-&gt;sd)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: DNSServiceResolve(unreadable parameters)"</q>, <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>); <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>); }</td></tr>
<tr><th id="2748">2748</th><td></td></tr>
<tr><th id="2749">2749</th><td>    <b>if</b> (<a class="ref fn" href="#build_domainname_from_strings" title='build_domainname_from_strings' data-ref="build_domainname_from_strings" data-ref-filename="build_domainname_from_strings">build_domainname_from_strings</a>(&amp;<a class="local col7 ref" href="#377fqdn" title='fqdn' data-ref="377fqdn" data-ref-filename="377fqdn">fqdn</a>, <a class="local col4 ref" href="#374name" title='name' data-ref="374name" data-ref-filename="374name">name</a>, <a class="local col5 ref" href="#375regtype" title='regtype' data-ref="375regtype" data-ref-filename="375regtype">regtype</a>, <a class="local col6 ref" href="#376domain" title='domain' data-ref="376domain" data-ref-filename="376domain">domain</a>) &lt; <var>0</var>)</td></tr>
<tr><th id="2750">2750</th><td>    { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;ERROR: handle_resolve_request bad “%s” “%s” “%s”&quot;, name, regtype, domain)" data-ref="_M/LogMsg">LogMsg</a>(<q>"ERROR: handle_resolve_request bad “%s” “%s” “%s”"</q>, <a class="local col4 ref" href="#374name" title='name' data-ref="374name" data-ref-filename="374name">name</a>, <a class="local col5 ref" href="#375regtype" title='regtype' data-ref="375regtype" data-ref-filename="375regtype">regtype</a>, <a class="local col6 ref" href="#376domain" title='domain' data-ref="376domain" data-ref-filename="376domain">domain</a>); <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>); }</td></tr>
<tr><th id="2751">2751</th><td></td></tr>
<tr><th id="2752">2752</th><td>    <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformMemZero" title='mDNSPlatformMemZero' data-ref="mDNSPlatformMemZero" data-ref-filename="mDNSPlatformMemZero">mDNSPlatformMemZero</a>(&amp;<a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>, <b>sizeof</b>(<a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>));</td></tr>
<tr><th id="2753">2753</th><td></td></tr>
<tr><th id="2754">2754</th><td><u>#<span data-ppcond="2754">if</span> APPLE_OSX_mDNSResponder &amp;&amp; ENABLE_BLE_TRIGGERED_BONJOUR</u></td></tr>
<tr><th id="2755">2755</th><td>    <i>// Determine if this request should be promoted to use BLE triggered discovery.</i></td></tr>
<tr><th id="2756">2756</th><td>    <b>if</b> (shouldUseBLE(InterfaceID, <var>0</var>, (domainname *)SkipLeadingLabels(&amp;fqdn, <var>1</var>), &amp;fqdn))</td></tr>
<tr><th id="2757">2757</th><td>    {</td></tr>
<tr><th id="2758">2758</th><td>        flags |= (kDNSServiceFlagsAutoTrigger | kDNSServiceFlagsIncludeAWDL);</td></tr>
<tr><th id="2759">2759</th><td>        LogInfo(<q>"handle_resolve_request: request promoted to use kDNSServiceFlagsAutoTrigger"</q>);</td></tr>
<tr><th id="2760">2760</th><td>    } </td></tr>
<tr><th id="2761">2761</th><td><u>#<span data-ppcond="2754">endif</span> // APPLE_OSX_mDNSResponder &amp;&amp; ENABLE_BLE_TRIGGERED_BONJOUR</u></td></tr>
<tr><th id="2762">2762</th><td></td></tr>
<tr><th id="2763">2763</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a> = <a class="local col9 ref" href="#379flags" title='flags' data-ref="379flags" data-ref-filename="379flags">flags</a>;</td></tr>
<tr><th id="2764">2764</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::interfaceIndex" title='request_state::interfaceIndex' data-ref="request_state::interfaceIndex" data-ref-filename="request_state..interfaceIndex">interfaceIndex</a> = <a class="local col0 ref" href="#380interfaceIndex" title='interfaceIndex' data-ref="380interfaceIndex" data-ref-filename="380interfaceIndex">interfaceIndex</a>;</td></tr>
<tr><th id="2765">2765</th><td></td></tr>
<tr><th id="2766">2766</th><td>    <i>// format questions</i></td></tr>
<tr><th id="2767">2767</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::InterfaceID" title='DNSQuestion_struct::InterfaceID' data-ref="DNSQuestion_struct::InterfaceID" data-ref-filename="DNSQuestion_struct..InterfaceID">InterfaceID</a>      = <a class="local col1 ref" href="#381InterfaceID" title='InterfaceID' data-ref="381InterfaceID" data-ref-filename="381InterfaceID">InterfaceID</a>;</td></tr>
<tr><th id="2768">2768</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::flags" title='DNSQuestion_struct::flags' data-ref="DNSQuestion_struct::flags" data-ref-filename="DNSQuestion_struct..flags">flags</a>            = <a class="local col9 ref" href="#379flags" title='flags' data-ref="379flags" data-ref-filename="379flags">flags</a>;</td></tr>
<tr><th id="2769">2769</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::Target" title='DNSQuestion_struct::Target' data-ref="DNSQuestion_struct::Target" data-ref-filename="DNSQuestion_struct..Target">Target</a>           = <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#zeroAddr" title='zeroAddr' data-ref="zeroAddr" data-ref-filename="zeroAddr">zeroAddr</a>;</td></tr>
<tr><th id="2770">2770</th><td>    <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2849" title="do { mDNSu16 len__ = DomainNameLengthLimit(((&amp;fqdn)), ((&amp;fqdn))-&gt;c + 256); if (len__ &lt;= 256) mDNSPlatformMemCopy((&amp;request-&gt;u.resolve.qsrv.qname)-&gt;c, (&amp;fqdn)-&gt;c, len__); else (&amp;request-&gt;u.resolve.qsrv.qname)-&gt;c[0] = 0; } while(0)" data-ref="_M/AssignDomainName">AssignDomainName</a>(&amp;<a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>, &amp;<a class="local col7 ref" href="#377fqdn" title='fqdn' data-ref="377fqdn" data-ref-filename="377fqdn">fqdn</a>);</td></tr>
<tr><th id="2771">2771</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a>            = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSType_SRV" title='kDNSType_SRV' data-ref="kDNSType_SRV" data-ref-filename="kDNSType_SRV">kDNSType_SRV</a>;</td></tr>
<tr><th id="2772">2772</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qclass" title='DNSQuestion_struct::qclass' data-ref="DNSQuestion_struct::qclass" data-ref-filename="DNSQuestion_struct..qclass">qclass</a>           = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSClass_IN" title='kDNSClass_IN' data-ref="kDNSClass_IN" data-ref-filename="kDNSClass_IN">kDNSClass_IN</a>;</td></tr>
<tr><th id="2773">2773</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::LongLived" title='DNSQuestion_struct::LongLived' data-ref="DNSQuestion_struct::LongLived" data-ref-filename="DNSQuestion_struct..LongLived">LongLived</a>        = (<a class="local col9 ref" href="#379flags" title='flags' data-ref="379flags" data-ref-filename="379flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsLongLivedQuery" title='kDNSServiceFlagsLongLivedQuery' data-ref="kDNSServiceFlagsLongLivedQuery" data-ref-filename="kDNSServiceFlagsLongLivedQuery">kDNSServiceFlagsLongLivedQuery</a>     ) != <var>0</var>;</td></tr>
<tr><th id="2774">2774</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ExpectUnique" title='DNSQuestion_struct::ExpectUnique' data-ref="DNSQuestion_struct::ExpectUnique" data-ref-filename="DNSQuestion_struct..ExpectUnique">ExpectUnique</a>     = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>;</td></tr>
<tr><th id="2775">2775</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ForceMCast" title='DNSQuestion_struct::ForceMCast' data-ref="DNSQuestion_struct::ForceMCast" data-ref-filename="DNSQuestion_struct..ForceMCast">ForceMCast</a>       = (<a class="local col9 ref" href="#379flags" title='flags' data-ref="379flags" data-ref-filename="379flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsForceMulticast" title='kDNSServiceFlagsForceMulticast' data-ref="kDNSServiceFlagsForceMulticast" data-ref-filename="kDNSServiceFlagsForceMulticast">kDNSServiceFlagsForceMulticast</a>     ) != <var>0</var>;</td></tr>
<tr><th id="2776">2776</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ReturnIntermed" title='DNSQuestion_struct::ReturnIntermed' data-ref="DNSQuestion_struct::ReturnIntermed" data-ref-filename="DNSQuestion_struct..ReturnIntermed">ReturnIntermed</a>   = (<a class="local col9 ref" href="#379flags" title='flags' data-ref="379flags" data-ref-filename="379flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsReturnIntermediates" title='kDNSServiceFlagsReturnIntermediates' data-ref="kDNSServiceFlagsReturnIntermediates" data-ref-filename="kDNSServiceFlagsReturnIntermediates">kDNSServiceFlagsReturnIntermediates</a>) != <var>0</var>;</td></tr>
<tr><th id="2777">2777</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::SuppressUnusable" title='DNSQuestion_struct::SuppressUnusable' data-ref="DNSQuestion_struct::SuppressUnusable" data-ref-filename="DNSQuestion_struct..SuppressUnusable">SuppressUnusable</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>;</td></tr>
<tr><th id="2778">2778</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::SearchListIndex" title='DNSQuestion_struct::SearchListIndex' data-ref="DNSQuestion_struct::SearchListIndex" data-ref-filename="DNSQuestion_struct..SearchListIndex">SearchListIndex</a>  = <var>0</var>;</td></tr>
<tr><th id="2779">2779</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::AppendSearchDomains" title='DNSQuestion_struct::AppendSearchDomains' data-ref="DNSQuestion_struct::AppendSearchDomains" data-ref-filename="DNSQuestion_struct..AppendSearchDomains">AppendSearchDomains</a> = <var>0</var>;</td></tr>
<tr><th id="2780">2780</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::RetryWithSearchDomains" title='DNSQuestion_struct::RetryWithSearchDomains' data-ref="DNSQuestion_struct::RetryWithSearchDomains" data-ref-filename="DNSQuestion_struct..RetryWithSearchDomains">RetryWithSearchDomains</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>;</td></tr>
<tr><th id="2781">2781</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::TimeoutQuestion" title='DNSQuestion_struct::TimeoutQuestion' data-ref="DNSQuestion_struct::TimeoutQuestion" data-ref-filename="DNSQuestion_struct..TimeoutQuestion">TimeoutQuestion</a>  = <var>0</var>;</td></tr>
<tr><th id="2782">2782</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::WakeOnResolve" title='DNSQuestion_struct::WakeOnResolve' data-ref="DNSQuestion_struct::WakeOnResolve" data-ref-filename="DNSQuestion_struct..WakeOnResolve">WakeOnResolve</a>    = (<a class="local col9 ref" href="#379flags" title='flags' data-ref="379flags" data-ref-filename="379flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsWakeOnResolve" title='kDNSServiceFlagsWakeOnResolve' data-ref="kDNSServiceFlagsWakeOnResolve" data-ref-filename="kDNSServiceFlagsWakeOnResolve">kDNSServiceFlagsWakeOnResolve</a>) != <var>0</var>;</td></tr>
<tr><th id="2783">2783</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::UseBackgroundTrafficClass" title='DNSQuestion_struct::UseBackgroundTrafficClass' data-ref="DNSQuestion_struct::UseBackgroundTrafficClass" data-ref-filename="DNSQuestion_struct..UseBackgroundTrafficClass">UseBackgroundTrafficClass</a> = (<a class="local col9 ref" href="#379flags" title='flags' data-ref="379flags" data-ref-filename="379flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsBackgroundTrafficClass" title='kDNSServiceFlagsBackgroundTrafficClass' data-ref="kDNSServiceFlagsBackgroundTrafficClass" data-ref-filename="kDNSServiceFlagsBackgroundTrafficClass">kDNSServiceFlagsBackgroundTrafficClass</a>) != <var>0</var>;</td></tr>
<tr><th id="2784">2784</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ValidationRequired" title='DNSQuestion_struct::ValidationRequired' data-ref="DNSQuestion_struct::ValidationRequired" data-ref-filename="DNSQuestion_struct..ValidationRequired">ValidationRequired</a> = <var>0</var>;</td></tr>
<tr><th id="2785">2785</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ValidatingResponse" title='DNSQuestion_struct::ValidatingResponse' data-ref="DNSQuestion_struct::ValidatingResponse" data-ref-filename="DNSQuestion_struct..ValidatingResponse">ValidatingResponse</a> = <var>0</var>;</td></tr>
<tr><th id="2786">2786</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ProxyQuestion" title='DNSQuestion_struct::ProxyQuestion' data-ref="DNSQuestion_struct::ProxyQuestion" data-ref-filename="DNSQuestion_struct..ProxyQuestion">ProxyQuestion</a>    = <var>0</var>;</td></tr>
<tr><th id="2787">2787</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a>        = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="2788">2788</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::AnonInfo" title='DNSQuestion_struct::AnonInfo' data-ref="DNSQuestion_struct::AnonInfo" data-ref-filename="DNSQuestion_struct..AnonInfo">AnonInfo</a>         = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="2789">2789</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::pid" title='DNSQuestion_struct::pid' data-ref="DNSQuestion_struct::pid" data-ref-filename="DNSQuestion_struct..pid">pid</a>              = <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>;</td></tr>
<tr><th id="2790">2790</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::euid" title='DNSQuestion_struct::euid' data-ref="DNSQuestion_struct::euid" data-ref-filename="DNSQuestion_struct..euid">euid</a>             = <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::uid" title='request_state::uid' data-ref="request_state::uid" data-ref-filename="request_state..uid">uid</a>;</td></tr>
<tr><th id="2791">2791</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::QuestionCallback" title='DNSQuestion_struct::QuestionCallback' data-ref="DNSQuestion_struct::QuestionCallback" data-ref-filename="DNSQuestion_struct..QuestionCallback">QuestionCallback</a> = <a class="ref fn" href="#resolve_result_callback" title='resolve_result_callback' data-ref="resolve_result_callback" data-ref-filename="resolve_result_callback">resolve_result_callback</a>;</td></tr>
<tr><th id="2792">2792</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::QuestionContext" title='DNSQuestion_struct::QuestionContext' data-ref="DNSQuestion_struct::QuestionContext" data-ref-filename="DNSQuestion_struct..QuestionContext">QuestionContext</a>  = <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>;</td></tr>
<tr><th id="2793">2793</th><td></td></tr>
<tr><th id="2794">2794</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qtxt" title='request_state::(anonymous union)::(anonymous struct)::qtxt' data-ref="request_state::(anonymousunion)::(anonymous)::qtxt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qtxt">qtxt</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::InterfaceID" title='DNSQuestion_struct::InterfaceID' data-ref="DNSQuestion_struct::InterfaceID" data-ref-filename="DNSQuestion_struct..InterfaceID">InterfaceID</a>      = <a class="local col1 ref" href="#381InterfaceID" title='InterfaceID' data-ref="381InterfaceID" data-ref-filename="381InterfaceID">InterfaceID</a>;</td></tr>
<tr><th id="2795">2795</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qtxt" title='request_state::(anonymous union)::(anonymous struct)::qtxt' data-ref="request_state::(anonymousunion)::(anonymous)::qtxt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qtxt">qtxt</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::flags" title='DNSQuestion_struct::flags' data-ref="DNSQuestion_struct::flags" data-ref-filename="DNSQuestion_struct..flags">flags</a>            = <a class="local col9 ref" href="#379flags" title='flags' data-ref="379flags" data-ref-filename="379flags">flags</a>;</td></tr>
<tr><th id="2796">2796</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qtxt" title='request_state::(anonymous union)::(anonymous struct)::qtxt' data-ref="request_state::(anonymousunion)::(anonymous)::qtxt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qtxt">qtxt</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::Target" title='DNSQuestion_struct::Target' data-ref="DNSQuestion_struct::Target" data-ref-filename="DNSQuestion_struct..Target">Target</a>           = <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#zeroAddr" title='zeroAddr' data-ref="zeroAddr" data-ref-filename="zeroAddr">zeroAddr</a>;</td></tr>
<tr><th id="2797">2797</th><td>    <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2849" title="do { mDNSu16 len__ = DomainNameLengthLimit(((&amp;fqdn)), ((&amp;fqdn))-&gt;c + 256); if (len__ &lt;= 256) mDNSPlatformMemCopy((&amp;request-&gt;u.resolve.qtxt.qname)-&gt;c, (&amp;fqdn)-&gt;c, len__); else (&amp;request-&gt;u.resolve.qtxt.qname)-&gt;c[0] = 0; } while(0)" data-ref="_M/AssignDomainName">AssignDomainName</a>(&amp;<a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qtxt" title='request_state::(anonymous union)::(anonymous struct)::qtxt' data-ref="request_state::(anonymousunion)::(anonymous)::qtxt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qtxt">qtxt</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>, &amp;<a class="local col7 ref" href="#377fqdn" title='fqdn' data-ref="377fqdn" data-ref-filename="377fqdn">fqdn</a>);</td></tr>
<tr><th id="2798">2798</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qtxt" title='request_state::(anonymous union)::(anonymous struct)::qtxt' data-ref="request_state::(anonymousunion)::(anonymous)::qtxt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qtxt">qtxt</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a>            = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSType_TXT" title='kDNSType_TXT' data-ref="kDNSType_TXT" data-ref-filename="kDNSType_TXT">kDNSType_TXT</a>;</td></tr>
<tr><th id="2799">2799</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qtxt" title='request_state::(anonymous union)::(anonymous struct)::qtxt' data-ref="request_state::(anonymousunion)::(anonymous)::qtxt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qtxt">qtxt</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qclass" title='DNSQuestion_struct::qclass' data-ref="DNSQuestion_struct::qclass" data-ref-filename="DNSQuestion_struct..qclass">qclass</a>           = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSClass_IN" title='kDNSClass_IN' data-ref="kDNSClass_IN" data-ref-filename="kDNSClass_IN">kDNSClass_IN</a>;</td></tr>
<tr><th id="2800">2800</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qtxt" title='request_state::(anonymous union)::(anonymous struct)::qtxt' data-ref="request_state::(anonymousunion)::(anonymous)::qtxt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qtxt">qtxt</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::LongLived" title='DNSQuestion_struct::LongLived' data-ref="DNSQuestion_struct::LongLived" data-ref-filename="DNSQuestion_struct..LongLived">LongLived</a>        = (<a class="local col9 ref" href="#379flags" title='flags' data-ref="379flags" data-ref-filename="379flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsLongLivedQuery" title='kDNSServiceFlagsLongLivedQuery' data-ref="kDNSServiceFlagsLongLivedQuery" data-ref-filename="kDNSServiceFlagsLongLivedQuery">kDNSServiceFlagsLongLivedQuery</a>     ) != <var>0</var>;</td></tr>
<tr><th id="2801">2801</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qtxt" title='request_state::(anonymous union)::(anonymous struct)::qtxt' data-ref="request_state::(anonymousunion)::(anonymous)::qtxt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qtxt">qtxt</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ExpectUnique" title='DNSQuestion_struct::ExpectUnique' data-ref="DNSQuestion_struct::ExpectUnique" data-ref-filename="DNSQuestion_struct..ExpectUnique">ExpectUnique</a>     = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>;</td></tr>
<tr><th id="2802">2802</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qtxt" title='request_state::(anonymous union)::(anonymous struct)::qtxt' data-ref="request_state::(anonymousunion)::(anonymous)::qtxt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qtxt">qtxt</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ForceMCast" title='DNSQuestion_struct::ForceMCast' data-ref="DNSQuestion_struct::ForceMCast" data-ref-filename="DNSQuestion_struct..ForceMCast">ForceMCast</a>       = (<a class="local col9 ref" href="#379flags" title='flags' data-ref="379flags" data-ref-filename="379flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsForceMulticast" title='kDNSServiceFlagsForceMulticast' data-ref="kDNSServiceFlagsForceMulticast" data-ref-filename="kDNSServiceFlagsForceMulticast">kDNSServiceFlagsForceMulticast</a>     ) != <var>0</var>;</td></tr>
<tr><th id="2803">2803</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qtxt" title='request_state::(anonymous union)::(anonymous struct)::qtxt' data-ref="request_state::(anonymousunion)::(anonymous)::qtxt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qtxt">qtxt</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ReturnIntermed" title='DNSQuestion_struct::ReturnIntermed' data-ref="DNSQuestion_struct::ReturnIntermed" data-ref-filename="DNSQuestion_struct..ReturnIntermed">ReturnIntermed</a>   = (<a class="local col9 ref" href="#379flags" title='flags' data-ref="379flags" data-ref-filename="379flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsReturnIntermediates" title='kDNSServiceFlagsReturnIntermediates' data-ref="kDNSServiceFlagsReturnIntermediates" data-ref-filename="kDNSServiceFlagsReturnIntermediates">kDNSServiceFlagsReturnIntermediates</a>) != <var>0</var>;</td></tr>
<tr><th id="2804">2804</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qtxt" title='request_state::(anonymous union)::(anonymous struct)::qtxt' data-ref="request_state::(anonymousunion)::(anonymous)::qtxt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qtxt">qtxt</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::SuppressUnusable" title='DNSQuestion_struct::SuppressUnusable' data-ref="DNSQuestion_struct::SuppressUnusable" data-ref-filename="DNSQuestion_struct..SuppressUnusable">SuppressUnusable</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>;</td></tr>
<tr><th id="2805">2805</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qtxt" title='request_state::(anonymous union)::(anonymous struct)::qtxt' data-ref="request_state::(anonymousunion)::(anonymous)::qtxt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qtxt">qtxt</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::SearchListIndex" title='DNSQuestion_struct::SearchListIndex' data-ref="DNSQuestion_struct::SearchListIndex" data-ref-filename="DNSQuestion_struct..SearchListIndex">SearchListIndex</a>  = <var>0</var>;</td></tr>
<tr><th id="2806">2806</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qtxt" title='request_state::(anonymous union)::(anonymous struct)::qtxt' data-ref="request_state::(anonymousunion)::(anonymous)::qtxt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qtxt">qtxt</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::AppendSearchDomains" title='DNSQuestion_struct::AppendSearchDomains' data-ref="DNSQuestion_struct::AppendSearchDomains" data-ref-filename="DNSQuestion_struct..AppendSearchDomains">AppendSearchDomains</a> = <var>0</var>;</td></tr>
<tr><th id="2807">2807</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qtxt" title='request_state::(anonymous union)::(anonymous struct)::qtxt' data-ref="request_state::(anonymousunion)::(anonymous)::qtxt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qtxt">qtxt</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::RetryWithSearchDomains" title='DNSQuestion_struct::RetryWithSearchDomains' data-ref="DNSQuestion_struct::RetryWithSearchDomains" data-ref-filename="DNSQuestion_struct..RetryWithSearchDomains">RetryWithSearchDomains</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>;</td></tr>
<tr><th id="2808">2808</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qtxt" title='request_state::(anonymous union)::(anonymous struct)::qtxt' data-ref="request_state::(anonymousunion)::(anonymous)::qtxt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qtxt">qtxt</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::TimeoutQuestion" title='DNSQuestion_struct::TimeoutQuestion' data-ref="DNSQuestion_struct::TimeoutQuestion" data-ref-filename="DNSQuestion_struct..TimeoutQuestion">TimeoutQuestion</a>  = <var>0</var>;</td></tr>
<tr><th id="2809">2809</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qtxt" title='request_state::(anonymous union)::(anonymous struct)::qtxt' data-ref="request_state::(anonymousunion)::(anonymous)::qtxt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qtxt">qtxt</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::WakeOnResolve" title='DNSQuestion_struct::WakeOnResolve' data-ref="DNSQuestion_struct::WakeOnResolve" data-ref-filename="DNSQuestion_struct..WakeOnResolve">WakeOnResolve</a>    = <var>0</var>;</td></tr>
<tr><th id="2810">2810</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qtxt" title='request_state::(anonymous union)::(anonymous struct)::qtxt' data-ref="request_state::(anonymousunion)::(anonymous)::qtxt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qtxt">qtxt</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::UseBackgroundTrafficClass" title='DNSQuestion_struct::UseBackgroundTrafficClass' data-ref="DNSQuestion_struct::UseBackgroundTrafficClass" data-ref-filename="DNSQuestion_struct..UseBackgroundTrafficClass">UseBackgroundTrafficClass</a> = (<a class="local col9 ref" href="#379flags" title='flags' data-ref="379flags" data-ref-filename="379flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsBackgroundTrafficClass" title='kDNSServiceFlagsBackgroundTrafficClass' data-ref="kDNSServiceFlagsBackgroundTrafficClass" data-ref-filename="kDNSServiceFlagsBackgroundTrafficClass">kDNSServiceFlagsBackgroundTrafficClass</a>) != <var>0</var>;</td></tr>
<tr><th id="2811">2811</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qtxt" title='request_state::(anonymous union)::(anonymous struct)::qtxt' data-ref="request_state::(anonymousunion)::(anonymous)::qtxt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qtxt">qtxt</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ValidationRequired" title='DNSQuestion_struct::ValidationRequired' data-ref="DNSQuestion_struct::ValidationRequired" data-ref-filename="DNSQuestion_struct..ValidationRequired">ValidationRequired</a> = <var>0</var>;</td></tr>
<tr><th id="2812">2812</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qtxt" title='request_state::(anonymous union)::(anonymous struct)::qtxt' data-ref="request_state::(anonymousunion)::(anonymous)::qtxt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qtxt">qtxt</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ValidatingResponse" title='DNSQuestion_struct::ValidatingResponse' data-ref="DNSQuestion_struct::ValidatingResponse" data-ref-filename="DNSQuestion_struct..ValidatingResponse">ValidatingResponse</a> = <var>0</var>;</td></tr>
<tr><th id="2813">2813</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qtxt" title='request_state::(anonymous union)::(anonymous struct)::qtxt' data-ref="request_state::(anonymousunion)::(anonymous)::qtxt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qtxt">qtxt</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ProxyQuestion" title='DNSQuestion_struct::ProxyQuestion' data-ref="DNSQuestion_struct::ProxyQuestion" data-ref-filename="DNSQuestion_struct..ProxyQuestion">ProxyQuestion</a>    = <var>0</var>;</td></tr>
<tr><th id="2814">2814</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qtxt" title='request_state::(anonymous union)::(anonymous struct)::qtxt' data-ref="request_state::(anonymousunion)::(anonymous)::qtxt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qtxt">qtxt</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a>        = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="2815">2815</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qtxt" title='request_state::(anonymous union)::(anonymous struct)::qtxt' data-ref="request_state::(anonymousunion)::(anonymous)::qtxt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qtxt">qtxt</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::AnonInfo" title='DNSQuestion_struct::AnonInfo' data-ref="DNSQuestion_struct::AnonInfo" data-ref-filename="DNSQuestion_struct..AnonInfo">AnonInfo</a>         = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="2816">2816</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qtxt" title='request_state::(anonymous union)::(anonymous struct)::qtxt' data-ref="request_state::(anonymousunion)::(anonymous)::qtxt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qtxt">qtxt</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::pid" title='DNSQuestion_struct::pid' data-ref="DNSQuestion_struct::pid" data-ref-filename="DNSQuestion_struct..pid">pid</a>              = <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>;</td></tr>
<tr><th id="2817">2817</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qtxt" title='request_state::(anonymous union)::(anonymous struct)::qtxt' data-ref="request_state::(anonymousunion)::(anonymous)::qtxt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qtxt">qtxt</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::euid" title='DNSQuestion_struct::euid' data-ref="DNSQuestion_struct::euid" data-ref-filename="DNSQuestion_struct..euid">euid</a>             = <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::uid" title='request_state::uid' data-ref="request_state::uid" data-ref-filename="request_state..uid">uid</a>;</td></tr>
<tr><th id="2818">2818</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qtxt" title='request_state::(anonymous union)::(anonymous struct)::qtxt' data-ref="request_state::(anonymousunion)::(anonymous)::qtxt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qtxt">qtxt</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::QuestionCallback" title='DNSQuestion_struct::QuestionCallback' data-ref="DNSQuestion_struct::QuestionCallback" data-ref-filename="DNSQuestion_struct..QuestionCallback">QuestionCallback</a> = <a class="ref fn" href="#resolve_result_callback" title='resolve_result_callback' data-ref="resolve_result_callback" data-ref-filename="resolve_result_callback">resolve_result_callback</a>;</td></tr>
<tr><th id="2819">2819</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qtxt" title='request_state::(anonymous union)::(anonymous struct)::qtxt' data-ref="request_state::(anonymousunion)::(anonymous)::qtxt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qtxt">qtxt</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::QuestionContext" title='DNSQuestion_struct::QuestionContext' data-ref="DNSQuestion_struct::QuestionContext" data-ref-filename="DNSQuestion_struct..QuestionContext">QuestionContext</a>  = <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>;</td></tr>
<tr><th id="2820">2820</th><td></td></tr>
<tr><th id="2821">2821</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::ReportTime" title='request_state::(anonymous union)::(anonymous struct)::ReportTime' data-ref="request_state::(anonymousunion)::(anonymous)::ReportTime" data-ref-filename="request_state..(anonymousunion)..(anonymous)..ReportTime">ReportTime</a>            = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NonZeroTime" title='NonZeroTime' data-ref="NonZeroTime" data-ref-filename="NonZeroTime">NonZeroTime</a>(<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_TimeNow" title='mDNS_TimeNow' data-ref="mDNS_TimeNow" data-ref-filename="mDNS_TimeNow">mDNS_TimeNow</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>) + <var>130</var> * <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformOneSecond" title='mDNSPlatformOneSecond' data-ref="mDNSPlatformOneSecond" data-ref-filename="mDNSPlatformOneSecond">mDNSPlatformOneSecond</a>);</td></tr>
<tr><th id="2822">2822</th><td></td></tr>
<tr><th id="2823">2823</th><td>    <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::external_advertise" title='request_state::(anonymous union)::(anonymous struct)::external_advertise' data-ref="request_state::(anonymousunion)::(anonymous)::external_advertise" data-ref-filename="request_state..(anonymousunion)..(anonymous)..external_advertise">external_advertise</a>    = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>;</td></tr>
<tr><th id="2824">2824</th><td></td></tr>
<tr><th id="2825">2825</th><td><u>#<span data-ppcond="2825">if</span> 0</u></td></tr>
<tr><th id="2826">2826</th><td>    <b>if</b> (!AuthorizedDomain(request, &amp;fqdn, AutoBrowseDomains)) <b>return</b>(mStatus_NoError);</td></tr>
<tr><th id="2827">2827</th><td><u>#<span data-ppcond="2825">endif</span></u></td></tr>
<tr><th id="2828">2828</th><td></td></tr>
<tr><th id="2829">2829</th><td>    <i>// ask the questions</i></td></tr>
<tr><th id="2830">2830</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: DNSServiceResolve(%X, %d, \&quot;%##s\&quot;) START PID[%d](%s)&quot;, request-&gt;sd, flags, interfaceIndex, request-&gt;u.resolve.qsrv.qname.c, request-&gt;process_id, request-&gt;pid_name);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: DNSServiceResolve(%X, %d, \"%##s\") START PID[%d](%s)"</q>, <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col9 ref" href="#379flags" title='flags' data-ref="379flags" data-ref-filename="379flags">flags</a>, <a class="local col0 ref" href="#380interfaceIndex" title='interfaceIndex' data-ref="380interfaceIndex" data-ref-filename="380interfaceIndex">interfaceIndex</a>,</td></tr>
<tr><th id="2831">2831</th><td>                 <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="2832">2832</th><td></td></tr>
<tr><th id="2833">2833</th><td>    <a class="local col8 ref" href="#378err" title='err' data-ref="378err" data-ref-filename="378err">err</a> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_StartQuery" title='mDNS_StartQuery' data-ref="mDNS_StartQuery" data-ref-filename="mDNS_StartQuery">mDNS_StartQuery</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>);</td></tr>
<tr><th id="2834">2834</th><td></td></tr>
<tr><th id="2835">2835</th><td>    <b>if</b> (!<a class="local col8 ref" href="#378err" title='err' data-ref="378err" data-ref-filename="378err">err</a>)</td></tr>
<tr><th id="2836">2836</th><td>    {</td></tr>
<tr><th id="2837">2837</th><td>        <a class="local col8 ref" href="#378err" title='err' data-ref="378err" data-ref-filename="378err">err</a> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_StartQuery" title='mDNS_StartQuery' data-ref="mDNS_StartQuery" data-ref-filename="mDNS_StartQuery">mDNS_StartQuery</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qtxt" title='request_state::(anonymous union)::(anonymous struct)::qtxt' data-ref="request_state::(anonymousunion)::(anonymous)::qtxt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qtxt">qtxt</a>);</td></tr>
<tr><th id="2838">2838</th><td>        <b>if</b> (<a class="local col8 ref" href="#378err" title='err' data-ref="378err" data-ref-filename="378err">err</a>)</td></tr>
<tr><th id="2839">2839</th><td>        {</td></tr>
<tr><th id="2840">2840</th><td>            <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_StopQuery" title='mDNS_StopQuery' data-ref="mDNS_StopQuery" data-ref-filename="mDNS_StopQuery">mDNS_StopQuery</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>);</td></tr>
<tr><th id="2841">2841</th><td>        }</td></tr>
<tr><th id="2842">2842</th><td>        <b>else</b></td></tr>
<tr><th id="2843">2843</th><td>        {</td></tr>
<tr><th id="2844">2844</th><td>            <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> = <a class="ref fn" href="#resolve_termination_callback" title='resolve_termination_callback' data-ref="resolve_termination_callback" data-ref-filename="resolve_termination_callback">resolve_termination_callback</a>;</td></tr>
<tr><th id="2845">2845</th><td>            <a class="macro" href="uds_daemon.h.html#224" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMcastQuestion" data-ref="_M/LogMcastQ">LogMcastQ</a>(&amp;<a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>, <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#q_start" title='q_start' data-ref="q_start" data-ref-filename="q_start">q_start</a>);</td></tr>
<tr><th id="2846">2846</th><td>            <b>if</b> (<a class="ref fn" href="#callExternalHelpers" title='callExternalHelpers' data-ref="callExternalHelpers" data-ref-filename="callExternalHelpers">callExternalHelpers</a>(<a class="local col1 ref" href="#381InterfaceID" title='InterfaceID' data-ref="381InterfaceID" data-ref-filename="381InterfaceID">InterfaceID</a>, &amp;<a class="local col7 ref" href="#377fqdn" title='fqdn' data-ref="377fqdn" data-ref-filename="377fqdn">fqdn</a>, <a class="local col9 ref" href="#379flags" title='flags' data-ref="379flags" data-ref-filename="379flags">flags</a>))</td></tr>
<tr><th id="2847">2847</th><td>            {</td></tr>
<tr><th id="2848">2848</th><td>                <a class="local col3 ref" href="#373request" title='request' data-ref="373request" data-ref-filename="373request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::external_advertise" title='request_state::(anonymous union)::(anonymous struct)::external_advertise' data-ref="request_state::(anonymousunion)::(anonymous)::external_advertise" data-ref-filename="request_state..(anonymousunion)..(anonymous)..external_advertise">external_advertise</a>    = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>;</td></tr>
<tr><th id="2849">2849</th><td>                <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;handle_resolve_request: calling external_start_resolving_service()&quot;);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"handle_resolve_request: calling external_start_resolving_service()"</q>);</td></tr>
<tr><th id="2850">2850</th><td>                <a class="macro" href="uds_daemon.h.html#268" title="(void)(InterfaceID)" data-ref="_M/external_start_resolving_service">external_start_resolving_service</a>(<a class="local col1 ref" href="#381InterfaceID" title='InterfaceID' data-ref="381InterfaceID" data-ref-filename="381InterfaceID">InterfaceID</a>, &amp;fqdn, flags);</td></tr>
<tr><th id="2851">2851</th><td>            }</td></tr>
<tr><th id="2852">2852</th><td>        }</td></tr>
<tr><th id="2853">2853</th><td>    }</td></tr>
<tr><th id="2854">2854</th><td></td></tr>
<tr><th id="2855">2855</th><td>    <b>return</b>(<a class="local col8 ref" href="#378err" title='err' data-ref="378err" data-ref-filename="378err">err</a>);</td></tr>
<tr><th id="2856">2856</th><td>}</td></tr>
<tr><th id="2857">2857</th><td></td></tr>
<tr><th id="2858">2858</th><td><i>// ***************************************************************************</i></td></tr>
<tr><th id="2859">2859</th><td><u>#<span data-ppcond="2859">if</span> COMPILER_LIKES_PRAGMA_MARK</u></td></tr>
<tr><th id="2860">2860</th><td><u>#pragma mark -</u></td></tr>
<tr><th id="2861">2861</th><td><u>#pragma mark - DNSServiceQueryRecord</u></td></tr>
<tr><th id="2862">2862</th><td><u>#<span data-ppcond="2859">endif</span></u></td></tr>
<tr><th id="2863">2863</th><td></td></tr>
<tr><th id="2864">2864</th><td><i>// mDNS operation functions. Each operation has 3 associated functions - a request handler that parses</i></td></tr>
<tr><th id="2865">2865</th><td><i>// the client's request and makes the appropriate mDNSCore call, a result handler (passed as a callback</i></td></tr>
<tr><th id="2866">2866</th><td><i>// to the mDNSCore routine) that sends results back to the client, and a termination routine that aborts</i></td></tr>
<tr><th id="2867">2867</th><td><i>// the mDNSCore operation if the client dies or closes its socket.</i></td></tr>
<tr><th id="2868">2868</th><td><i></i></td></tr>
<tr><th id="2869">2869</th><td><i>// Returns -1 to tell the caller that it should not try to reissue the query anymore</i></td></tr>
<tr><th id="2870">2870</th><td><i>// Returns 1 on successfully appending a search domain and the caller should reissue the new query</i></td></tr>
<tr><th id="2871">2871</th><td><i>// Returns 0 when there are no more search domains and the caller should reissue the query</i></td></tr>
<tr><th id="2872">2872</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>int</em> <dfn class="decl def fn" id="AppendNewSearchDomain" title='AppendNewSearchDomain' data-ref="AppendNewSearchDomain" data-ref-filename="AppendNewSearchDomain">AppendNewSearchDomain</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion" title='DNSQuestion' data-type='struct DNSQuestion_struct' data-ref="DNSQuestion" data-ref-filename="DNSQuestion">DNSQuestion</a> *<dfn class="local col2 decl" id="382question" title='question' data-type='DNSQuestion *' data-ref="382question" data-ref-filename="382question">question</dfn>)</td></tr>
<tr><th id="2873">2873</th><td>{</td></tr>
<tr><th id="2874">2874</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#domainname" title='domainname' data-type='struct domainname' data-ref="domainname" data-ref-filename="domainname">domainname</a> *<dfn class="local col3 decl" id="383sd" title='sd' data-type='domainname *' data-ref="383sd" data-ref-filename="383sd">sd</dfn>;</td></tr>
<tr><th id="2875">2875</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="local col4 decl" id="384err" title='err' data-type='mStatus' data-ref="384err" data-ref-filename="384err">err</dfn>;</td></tr>
<tr><th id="2876">2876</th><td></td></tr>
<tr><th id="2877">2877</th><td>    <i>// Sanity check: The caller already checks this. We use -1 to indicate that we have searched all</i></td></tr>
<tr><th id="2878">2878</th><td><i>    // the domains and should try the single label query directly on the wire.</i></td></tr>
<tr><th id="2879">2879</th><td>    <b>if</b> (<a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::SearchListIndex" title='DNSQuestion_struct::SearchListIndex' data-ref="DNSQuestion_struct::SearchListIndex" data-ref-filename="DNSQuestion_struct..SearchListIndex">SearchListIndex</a> == -<var>1</var>)</td></tr>
<tr><th id="2880">2880</th><td>    {</td></tr>
<tr><th id="2881">2881</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;AppendNewSearchDomain: question %##s (%s) SearchListIndex is -1&quot;, question-&gt;qname.c, DNSTypeName(question-&gt;qtype))" data-ref="_M/LogMsg">LogMsg</a>(<q>"AppendNewSearchDomain: question %##s (%s) SearchListIndex is -1"</q>, <a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a>));</td></tr>
<tr><th id="2882">2882</th><td>        <b>return</b> -<var>1</var>;</td></tr>
<tr><th id="2883">2883</th><td>    }</td></tr>
<tr><th id="2884">2884</th><td></td></tr>
<tr><th id="2885">2885</th><td>    <b>if</b> (!<a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::AppendSearchDomains" title='DNSQuestion_struct::AppendSearchDomains' data-ref="DNSQuestion_struct::AppendSearchDomains" data-ref-filename="DNSQuestion_struct..AppendSearchDomains">AppendSearchDomains</a>)</td></tr>
<tr><th id="2886">2886</th><td>    {</td></tr>
<tr><th id="2887">2887</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;AppendNewSearchDomain: question %##s (%s) AppendSearchDoamins is 0&quot;, question-&gt;qname.c, DNSTypeName(question-&gt;qtype))" data-ref="_M/LogMsg">LogMsg</a>(<q>"AppendNewSearchDomain: question %##s (%s) AppendSearchDoamins is 0"</q>, <a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a>));</td></tr>
<tr><th id="2888">2888</th><td>        <b>return</b> -<var>1</var>;</td></tr>
<tr><th id="2889">2889</th><td>    }</td></tr>
<tr><th id="2890">2890</th><td></td></tr>
<tr><th id="2891">2891</th><td>    <i>// Save the original name, before we modify them below.</i></td></tr>
<tr><th id="2892">2892</th><td>    <b>if</b> (!<a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a>)</td></tr>
<tr><th id="2893">2893</th><td>    {</td></tr>
<tr><th id="2894">2894</th><td>        <a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a> =  <a class="macro" href="../mDNSCore/mDNSDebug.h.html#166" title="malloc(sizeof(domainname))" data-ref="_M/mallocL">mallocL</a>(<q>"AppendNewSearchDomain"</q>, <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#domainname" title='domainname' data-type='struct domainname' data-ref="domainname" data-ref-filename="domainname">domainname</a>));</td></tr>
<tr><th id="2895">2895</th><td>        <b>if</b> (!<a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a>) { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;AppendNewSearchDomain: ERROR!!  malloc failure&quot;)" data-ref="_M/LogMsg">LogMsg</a>(<q>"AppendNewSearchDomain: ERROR!!  malloc failure"</q>); <b>return</b> -<var>1</var>; }</td></tr>
<tr><th id="2896">2896</th><td>        <a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>[<var>0</var>] = <var>0</var>;</td></tr>
<tr><th id="2897">2897</th><td>        <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2849" title="do { mDNSu16 len__ = DomainNameLengthLimit(((&amp;question-&gt;qname)), ((&amp;question-&gt;qname))-&gt;c + 256); if (len__ &lt;= 256) mDNSPlatformMemCopy((question-&gt;qnameOrig)-&gt;c, (&amp;question-&gt;qname)-&gt;c, len__); else (question-&gt;qnameOrig)-&gt;c[0] = 0; } while(0)" data-ref="_M/AssignDomainName">AssignDomainName</a>(<a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a>, &amp;<a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>);</td></tr>
<tr><th id="2898">2898</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;AppendSearchDomain: qnameOrig %##s&quot;, question-&gt;qnameOrig-&gt;c);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"AppendSearchDomain: qnameOrig %##s"</q>, <a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>);</td></tr>
<tr><th id="2899">2899</th><td>    }</td></tr>
<tr><th id="2900">2900</th><td></td></tr>
<tr><th id="2901">2901</th><td>    <a class="local col3 ref" href="#383sd" title='sd' data-ref="383sd" data-ref-filename="383sd">sd</a> = <a class="ref fn" href="../mDNSCore/uDNS.h.html#uDNS_GetNextSearchDomain" title='uDNS_GetNextSearchDomain' data-ref="uDNS_GetNextSearchDomain" data-ref-filename="uDNS_GetNextSearchDomain">uDNS_GetNextSearchDomain</a>(<a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::InterfaceID" title='DNSQuestion_struct::InterfaceID' data-ref="DNSQuestion_struct::InterfaceID" data-ref-filename="DNSQuestion_struct..InterfaceID">InterfaceID</a>, &amp;<a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::SearchListIndex" title='DNSQuestion_struct::SearchListIndex' data-ref="DNSQuestion_struct::SearchListIndex" data-ref-filename="DNSQuestion_struct..SearchListIndex">SearchListIndex</a>, !<a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::AppendLocalSearchDomains" title='DNSQuestion_struct::AppendLocalSearchDomains' data-ref="DNSQuestion_struct::AppendLocalSearchDomains" data-ref-filename="DNSQuestion_struct..AppendLocalSearchDomains">AppendLocalSearchDomains</a>);</td></tr>
<tr><th id="2902">2902</th><td>    <i>// We use -1 to indicate that we have searched all the domains and should try the single label</i></td></tr>
<tr><th id="2903">2903</th><td><i>    // query directly on the wire. uDNS_GetNextSearchDomain should never return a negative value</i></td></tr>
<tr><th id="2904">2904</th><td>    <b>if</b> (<a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::SearchListIndex" title='DNSQuestion_struct::SearchListIndex' data-ref="DNSQuestion_struct::SearchListIndex" data-ref-filename="DNSQuestion_struct..SearchListIndex">SearchListIndex</a> == -<var>1</var>)</td></tr>
<tr><th id="2905">2905</th><td>    {</td></tr>
<tr><th id="2906">2906</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;AppendNewSearchDomain: ERROR!! uDNS_GetNextSearchDomain returned -1&quot;)" data-ref="_M/LogMsg">LogMsg</a>(<q>"AppendNewSearchDomain: ERROR!! uDNS_GetNextSearchDomain returned -1"</q>);</td></tr>
<tr><th id="2907">2907</th><td>        <b>return</b> -<var>1</var>;</td></tr>
<tr><th id="2908">2908</th><td>    }</td></tr>
<tr><th id="2909">2909</th><td></td></tr>
<tr><th id="2910">2910</th><td>    <i>// Not a common case. Perhaps, we should try the next search domain if it exceeds ?</i></td></tr>
<tr><th id="2911">2911</th><td>    <b>if</b> (<a class="local col3 ref" href="#383sd" title='sd' data-ref="383sd" data-ref-filename="383sd">sd</a> &amp;&amp; (<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2871" title="DomainNameLengthLimit((question-&gt;qnameOrig), (question-&gt;qnameOrig)-&gt;c + 256)" data-ref="_M/DomainNameLength">DomainNameLength</a>(<a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a>) + <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2871" title="DomainNameLengthLimit((sd), (sd)-&gt;c + 256)" data-ref="_M/DomainNameLength">DomainNameLength</a>(<a class="local col3 ref" href="#383sd" title='sd' data-ref="383sd" data-ref-filename="383sd">sd</a>)) &gt; <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#399" title="256" data-ref="_M/MAX_DOMAIN_NAME">MAX_DOMAIN_NAME</a>)</td></tr>
<tr><th id="2912">2912</th><td>    {</td></tr>
<tr><th id="2913">2913</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;AppendNewSearchDomain: ERROR!! exceeding max domain length for %##s (%s) SearchDomain %##s length %d, Question name length %d&quot;, question-&gt;qnameOrig-&gt;c, DNSTypeName(question-&gt;qtype), sd-&gt;c, DomainNameLengthLimit((question-&gt;qnameOrig), (question-&gt;qnameOrig)-&gt;c + 256), DomainNameLengthLimit((sd), (sd)-&gt;c + 256))" data-ref="_M/LogMsg">LogMsg</a>(<q>"AppendNewSearchDomain: ERROR!! exceeding max domain length for %##s (%s) SearchDomain %##s length %d, Question name length %d"</q>, <a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a>), <a class="local col3 ref" href="#383sd" title='sd' data-ref="383sd" data-ref-filename="383sd">sd</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2871" title="DomainNameLengthLimit((question-&gt;qnameOrig), (question-&gt;qnameOrig)-&gt;c + 256)" data-ref="_M/DomainNameLength">DomainNameLength</a>(<a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a>), <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2871" title="DomainNameLengthLimit((sd), (sd)-&gt;c + 256)" data-ref="_M/DomainNameLength">DomainNameLength</a>(<a class="local col3 ref" href="#383sd" title='sd' data-ref="383sd" data-ref-filename="383sd">sd</a>));</td></tr>
<tr><th id="2914">2914</th><td>        <b>return</b> -<var>1</var>;</td></tr>
<tr><th id="2915">2915</th><td>    }</td></tr>
<tr><th id="2916">2916</th><td></td></tr>
<tr><th id="2917">2917</th><td>    <i>// if there are no more search domains and we have already tried this question</i></td></tr>
<tr><th id="2918">2918</th><td><i>    // without appending search domains, then we are done.</i></td></tr>
<tr><th id="2919">2919</th><td>    <b>if</b> (!<a class="local col3 ref" href="#383sd" title='sd' data-ref="383sd" data-ref-filename="383sd">sd</a> &amp;&amp; !<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#1622" title="((question)-&gt;AppendSearchDomains &amp;&amp; (CountLabels(&amp;((question)-&gt;qname))) == 1)" data-ref="_M/ApplySearchDomainsFirst">ApplySearchDomainsFirst</a>(<a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>))</td></tr>
<tr><th id="2920">2920</th><td>    {</td></tr>
<tr><th id="2921">2921</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;AppendNewSearchDomain: No more search domains for question with name %##s (%s), not trying anymore&quot;, question-&gt;qname.c, DNSTypeName(question-&gt;qtype));} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"AppendNewSearchDomain: No more search domains for question with name %##s (%s), not trying anymore"</q>, <a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a>));</td></tr>
<tr><th id="2922">2922</th><td>        <b>return</b> -<var>1</var>;</td></tr>
<tr><th id="2923">2923</th><td>    }</td></tr>
<tr><th id="2924">2924</th><td></td></tr>
<tr><th id="2925">2925</th><td>    <i>// Stop the question before changing the name as negative cache entries could be pointing at this question.</i></td></tr>
<tr><th id="2926">2926</th><td><i>    // Even if we don't change the question in the case of returning 0, the caller is going to restart the</i></td></tr>
<tr><th id="2927">2927</th><td><i>    // question.</i></td></tr>
<tr><th id="2928">2928</th><td>    <a class="local col4 ref" href="#384err" title='err' data-ref="384err" data-ref-filename="384err">err</a> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_StopQuery" title='mDNS_StopQuery' data-ref="mDNS_StopQuery" data-ref-filename="mDNS_StopQuery">mDNS_StopQuery</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>);</td></tr>
<tr><th id="2929">2929</th><td>    <b>if</b> (<a class="local col4 ref" href="#384err" title='err' data-ref="384err" data-ref-filename="384err">err</a>) { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;AppendNewSearchDomain: ERROR!! %##s %s mDNS_StopQuery: %d, while retrying with search domains&quot;, question-&gt;qname.c, DNSTypeName(question-&gt;qtype), (int)err)" data-ref="_M/LogMsg">LogMsg</a>(<q>"AppendNewSearchDomain: ERROR!! %##s %s mDNS_StopQuery: %d, while retrying with search domains"</q>, <a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a>), (<em>int</em>)<a class="local col4 ref" href="#384err" title='err' data-ref="384err" data-ref-filename="384err">err</a>); }</td></tr>
<tr><th id="2930">2930</th><td></td></tr>
<tr><th id="2931">2931</th><td>    <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2849" title="do { mDNSu16 len__ = DomainNameLengthLimit(((question-&gt;qnameOrig)), ((question-&gt;qnameOrig))-&gt;c + 256); if (len__ &lt;= 256) mDNSPlatformMemCopy((&amp;question-&gt;qname)-&gt;c, (question-&gt;qnameOrig)-&gt;c, len__); else (&amp;question-&gt;qname)-&gt;c[0] = 0; } while(0)" data-ref="_M/AssignDomainName">AssignDomainName</a>(&amp;<a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>, <a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a>);</td></tr>
<tr><th id="2932">2932</th><td>    <b>if</b> (<a class="local col3 ref" href="#383sd" title='sd' data-ref="383sd" data-ref-filename="383sd">sd</a>)</td></tr>
<tr><th id="2933">2933</th><td>    {</td></tr>
<tr><th id="2934">2934</th><td>        <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AppendDomainName" title='AppendDomainName' data-ref="AppendDomainName" data-ref-filename="AppendDomainName">AppendDomainName</a>(&amp;<a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>, <a class="local col3 ref" href="#383sd" title='sd' data-ref="383sd" data-ref-filename="383sd">sd</a>);</td></tr>
<tr><th id="2935">2935</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;AppnedNewSearchDomain: Returning question with name %##s, SearchListIndex %d&quot;, question-&gt;qname.c, question-&gt;SearchListIndex);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"AppnedNewSearchDomain: Returning question with name %##s, SearchListIndex %d"</q>, <a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::SearchListIndex" title='DNSQuestion_struct::SearchListIndex' data-ref="DNSQuestion_struct::SearchListIndex" data-ref-filename="DNSQuestion_struct..SearchListIndex">SearchListIndex</a>);</td></tr>
<tr><th id="2936">2936</th><td>        <b>return</b> <var>1</var>;</td></tr>
<tr><th id="2937">2937</th><td>    }</td></tr>
<tr><th id="2938">2938</th><td></td></tr>
<tr><th id="2939">2939</th><td>    <i>// Try the question as single label</i></td></tr>
<tr><th id="2940">2940</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;AppnedNewSearchDomain: No more search domains for question with name %##s (%s), trying one last time&quot;, question-&gt;qname.c, DNSTypeName(question-&gt;qtype));} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"AppnedNewSearchDomain: No more search domains for question with name %##s (%s), trying one last time"</q>, <a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col2 ref" href="#382question" title='question' data-ref="382question" data-ref-filename="382question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a>));</td></tr>
<tr><th id="2941">2941</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="2942">2942</th><td>}</td></tr>
<tr><th id="2943">2943</th><td></td></tr>
<tr><th id="2944">2944</th><td><u>#<span data-ppcond="2944">if</span> APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="2945">2945</th><td></td></tr>
<tr><th id="2946">2946</th><td>mDNSlocal mDNSBool DomainInSearchList(<em>const</em> domainname *domain, mDNSBool excludeLocal)</td></tr>
<tr><th id="2947">2947</th><td>{</td></tr>
<tr><th id="2948">2948</th><td>    <em>const</em> SearchListElem *s;</td></tr>
<tr><th id="2949">2949</th><td>    <em>int</em> qcount, scount;</td></tr>
<tr><th id="2950">2950</th><td></td></tr>
<tr><th id="2951">2951</th><td>    qcount = CountLabels(domain);</td></tr>
<tr><th id="2952">2952</th><td>    <b>for</b> (s=SearchList; s; s=s-&gt;next)</td></tr>
<tr><th id="2953">2953</th><td>    {</td></tr>
<tr><th id="2954">2954</th><td>        <b>if</b> (excludeLocal &amp;&amp; SameDomainName(&amp;s-&gt;domain, &amp;localdomain))</td></tr>
<tr><th id="2955">2955</th><td>            <b>continue</b>;</td></tr>
<tr><th id="2956">2956</th><td>        scount = CountLabels(&amp;s-&gt;domain);</td></tr>
<tr><th id="2957">2957</th><td>        <b>if</b> (qcount &gt;= scount)</td></tr>
<tr><th id="2958">2958</th><td>        {</td></tr>
<tr><th id="2959">2959</th><td>            <i>// Note: When qcount == scount, we do a complete match of the domain</i></td></tr>
<tr><th id="2960">2960</th><td><i>            // which is expected by the callers.</i></td></tr>
<tr><th id="2961">2961</th><td>            <em>const</em> domainname *d = SkipLeadingLabels(domain, (qcount - scount));</td></tr>
<tr><th id="2962">2962</th><td>            <b>if</b> (SameDomainName(&amp;s-&gt;domain, d))</td></tr>
<tr><th id="2963">2963</th><td>            {</td></tr>
<tr><th id="2964">2964</th><td>                <b>return</b> mDNStrue;</td></tr>
<tr><th id="2965">2965</th><td>            }</td></tr>
<tr><th id="2966">2966</th><td>        }</td></tr>
<tr><th id="2967">2967</th><td>    }</td></tr>
<tr><th id="2968">2968</th><td>    <b>return</b> mDNSfalse;</td></tr>
<tr><th id="2969">2969</th><td>}</td></tr>
<tr><th id="2970">2970</th><td></td></tr>
<tr><th id="2971">2971</th><td><i>// The caller already checks that this is a dotlocal question.</i></td></tr>
<tr><th id="2972">2972</th><td>mDNSlocal mDNSBool ShouldDeliverNegativeResponse(DNSQuestion *question)</td></tr>
<tr><th id="2973">2973</th><td>{</td></tr>
<tr><th id="2974">2974</th><td>    mDNSu16 qtype;</td></tr>
<tr><th id="2975">2975</th><td></td></tr>
<tr><th id="2976">2976</th><td>    <i>// If the question matches the search domain exactly or the search domain is a</i></td></tr>
<tr><th id="2977">2977</th><td><i>    // subdomain of the question, it is most likely a valid unicast domain and hence</i></td></tr>
<tr><th id="2978">2978</th><td><i>    // don't suppress negative responses.</i></td></tr>
<tr><th id="2979">2979</th><td><i>    //</i></td></tr>
<tr><th id="2980">2980</th><td><i>    // If the user has configured ".local" as a search domain, we don't want</i></td></tr>
<tr><th id="2981">2981</th><td><i>    // to deliver a negative response for names ending in ".local" as that would</i></td></tr>
<tr><th id="2982">2982</th><td><i>    // prevent bonjour discovery. Passing mDNStrue for the last argument excludes</i></td></tr>
<tr><th id="2983">2983</th><td><i>    // ".local" search domains.</i></td></tr>
<tr><th id="2984">2984</th><td>    <b>if</b> (DomainInSearchList(&amp;question-&gt;qname, mDNStrue))</td></tr>
<tr><th id="2985">2985</th><td>    {</td></tr>
<tr><th id="2986">2986</th><td>        LogOperation(<q>"ShouldDeliverNegativeResponse: Question %##s (%s) in SearchList"</q>, question-&gt;qname.c, DNSTypeName(question-&gt;qtype));</td></tr>
<tr><th id="2987">2987</th><td>        <b>return</b> mDNStrue;</td></tr>
<tr><th id="2988">2988</th><td>    }</td></tr>
<tr><th id="2989">2989</th><td></td></tr>
<tr><th id="2990">2990</th><td>    <i>// Deliver negative response for A/AAAA if there was a positive response for AAAA/A respectively.</i></td></tr>
<tr><th id="2991">2991</th><td>    <b>if</b> (question-&gt;qtype != kDNSType_A &amp;&amp; question-&gt;qtype != kDNSType_AAAA)</td></tr>
<tr><th id="2992">2992</th><td>    {</td></tr>
<tr><th id="2993">2993</th><td>        LogOperation(<q>"ShouldDeliverNegativeResponse: Question %##s (%s) not answering local question with negative unicast response"</q>,</td></tr>
<tr><th id="2994">2994</th><td>            question-&gt;qname.c, DNSTypeName(question-&gt;qtype));</td></tr>
<tr><th id="2995">2995</th><td>        <b>return</b> mDNSfalse;</td></tr>
<tr><th id="2996">2996</th><td>    }</td></tr>
<tr><th id="2997">2997</th><td>    qtype = (question-&gt;qtype == kDNSType_A ? kDNSType_AAAA : kDNSType_A);</td></tr>
<tr><th id="2998">2998</th><td>    <b>if</b> (!mDNS_CheckForCacheRecord(&amp;mDNSStorage, question, qtype))</td></tr>
<tr><th id="2999">2999</th><td>    {</td></tr>
<tr><th id="3000">3000</th><td>        LogOperation(<q>"ShouldDeliverNegativeResponse:Question %##s (%s) not answering local question with negative unicast response"</q></td></tr>
<tr><th id="3001">3001</th><td>            <q>" (can't find positive record)"</q>, question-&gt;qname.c, DNSTypeName(question-&gt;qtype));</td></tr>
<tr><th id="3002">3002</th><td>        <b>return</b> mDNSfalse;</td></tr>
<tr><th id="3003">3003</th><td>    }</td></tr>
<tr><th id="3004">3004</th><td>    LogOperation(<q>"ShouldDeliverNegativeResponse:Question %##s (%s) answering local with negative unicast response (found positive record)"</q>,</td></tr>
<tr><th id="3005">3005</th><td>        question-&gt;qname.c, DNSTypeName(question-&gt;qtype));</td></tr>
<tr><th id="3006">3006</th><td>    <b>return</b> mDNStrue;</td></tr>
<tr><th id="3007">3007</th><td>}</td></tr>
<tr><th id="3008">3008</th><td></td></tr>
<tr><th id="3009">3009</th><td><i>// Workaround for networks using Microsoft Active Directory using "local" as a private internal</i></td></tr>
<tr><th id="3010">3010</th><td><i>// top-level domain</i></td></tr>
<tr><th id="3011">3011</th><td>mDNSlocal mStatus SendAdditionalQuery(DNSQuestion *q, request_state *request, mStatus err)</td></tr>
<tr><th id="3012">3012</th><td>{</td></tr>
<tr><th id="3013">3013</th><td><u>#ifndef UNICAST_DISABLED</u></td></tr>
<tr><th id="3014">3014</th><td>    <b>extern</b> domainname ActiveDirectoryPrimaryDomain;</td></tr>
<tr><th id="3015">3015</th><td>    DNSQuestion **question2;</td></tr>
<tr><th id="3016">3016</th><td>    <u>#define VALID_MSAD_SRV_TRANSPORT(T) (SameDomainLabel((T)-&gt;c, (const mDNSu8 *)"\x4_tcp") || SameDomainLabel((T)-&gt;c, (const mDNSu8 *)"\x4_udp"))</u></td></tr>
<tr><th id="3017">3017</th><td>    <u>#define VALID_MSAD_SRV(Q) ((Q)-&gt;qtype == kDNSType_SRV &amp;&amp; VALID_MSAD_SRV_TRANSPORT(SecondLabel(&amp;(Q)-&gt;qname)))</u></td></tr>
<tr><th id="3018">3018</th><td></td></tr>
<tr><th id="3019">3019</th><td>    question2 = mDNSNULL;</td></tr>
<tr><th id="3020">3020</th><td>    <b>if</b> (request-&gt;hdr.op == query_request)</td></tr>
<tr><th id="3021">3021</th><td>        question2 = &amp;request-&gt;u.queryrecord.q2;</td></tr>
<tr><th id="3022">3022</th><td>    <b>else</b> <b>if</b> (request-&gt;hdr.op == addrinfo_request)</td></tr>
<tr><th id="3023">3023</th><td>    {</td></tr>
<tr><th id="3024">3024</th><td>        <b>if</b> (q-&gt;qtype == kDNSType_A)</td></tr>
<tr><th id="3025">3025</th><td>            question2 = &amp;request-&gt;u.addrinfo.q42;</td></tr>
<tr><th id="3026">3026</th><td>        <b>else</b> <b>if</b> (q-&gt;qtype == kDNSType_AAAA)</td></tr>
<tr><th id="3027">3027</th><td>            question2 = &amp;request-&gt;u.addrinfo.q62;</td></tr>
<tr><th id="3028">3028</th><td>    }</td></tr>
<tr><th id="3029">3029</th><td>    <b>if</b> (!question2)</td></tr>
<tr><th id="3030">3030</th><td>    {</td></tr>
<tr><th id="3031">3031</th><td>        LogMsg(<q>"SendAdditionalQuery: question2 NULL for %##s (%s)"</q>, q-&gt;qname.c, DNSTypeName(q-&gt;qtype));</td></tr>
<tr><th id="3032">3032</th><td>        <b>return</b> mStatus_BadParamErr;</td></tr>
<tr><th id="3033">3033</th><td>    }</td></tr>
<tr><th id="3034">3034</th><td></td></tr>
<tr><th id="3035">3035</th><td>    <i>// Sanity check: If we already sent an additonal query, we don't need to send one more.</i></td></tr>
<tr><th id="3036">3036</th><td><i>    //</i></td></tr>
<tr><th id="3037">3037</th><td><i>    // 1. When the application calls DNSServiceQueryRecord or DNSServiceGetAddrInfo with a .local name, this function</i></td></tr>
<tr><th id="3038">3038</th><td><i>    // is called to see whether a unicast query should be sent or not.</i></td></tr>
<tr><th id="3039">3039</th><td><i>    //</i></td></tr>
<tr><th id="3040">3040</th><td><i>    // 2. As a result of appending search domains, the question may be end up with a .local suffix even though it</i></td></tr>
<tr><th id="3041">3041</th><td><i>    // was not a .local name to start with. In that case, queryrecord_result_callback calls this function to</i></td></tr>
<tr><th id="3042">3042</th><td><i>    // send the additional query.</i></td></tr>
<tr><th id="3043">3043</th><td><i>    //</i></td></tr>
<tr><th id="3044">3044</th><td><i>    // Thus, it should not be called more than once.</i></td></tr>
<tr><th id="3045">3045</th><td>    <b>if</b> (*question2)</td></tr>
<tr><th id="3046">3046</th><td>    {</td></tr>
<tr><th id="3047">3047</th><td>        LogInfo(<q>"SendAdditionalQuery: question2 already sent for %##s (%s), no more q2"</q>, q-&gt;qname.c, DNSTypeName(q-&gt;qtype));</td></tr>
<tr><th id="3048">3048</th><td>        <b>return</b> err;</td></tr>
<tr><th id="3049">3049</th><td>    }</td></tr>
<tr><th id="3050">3050</th><td></td></tr>
<tr><th id="3051">3051</th><td>    <b>if</b> (!q-&gt;ForceMCast &amp;&amp; SameDomainLabel(LastLabel(&amp;q-&gt;qname), (<em>const</em> mDNSu8 *)&amp;localdomain))</td></tr>
<tr><th id="3052">3052</th><td>        <b>if</b> (q-&gt;qtype == kDNSType_A || q-&gt;qtype == kDNSType_AAAA || VALID_MSAD_SRV(q))</td></tr>
<tr><th id="3053">3053</th><td>        {</td></tr>
<tr><th id="3054">3054</th><td>            DNSQuestion *q2;</td></tr>
<tr><th id="3055">3055</th><td>            <em>int</em> labels = CountLabels(&amp;q-&gt;qname);</td></tr>
<tr><th id="3056">3056</th><td>            q2 = mallocL(<q>"DNSQuestion"</q>, <b>sizeof</b>(DNSQuestion));</td></tr>
<tr><th id="3057">3057</th><td>            <b>if</b> (!q2) FatalError(<q>"ERROR: SendAdditionalQuery malloc"</q>);</td></tr>
<tr><th id="3058">3058</th><td>            *question2        = q2;</td></tr>
<tr><th id="3059">3059</th><td>            *q2               = *q;</td></tr>
<tr><th id="3060">3060</th><td>            q2-&gt;InterfaceID   = mDNSInterface_Unicast;</td></tr>
<tr><th id="3061">3061</th><td>            q2-&gt;ExpectUnique  = mDNStrue;</td></tr>
<tr><th id="3062">3062</th><td>            <i>// Always set the QuestionContext to indicate that this question should be stopped</i></td></tr>
<tr><th id="3063">3063</th><td><i>            // before freeing. Don't rely on "q".</i></td></tr>
<tr><th id="3064">3064</th><td>            q2-&gt;QuestionContext = request;</td></tr>
<tr><th id="3065">3065</th><td>            <i>// If the query starts as a single label e.g., somehost, and we have search domains with .local,</i></td></tr>
<tr><th id="3066">3066</th><td><i>            // queryrecord_result_callback calls this function when .local is appended to "somehost".</i></td></tr>
<tr><th id="3067">3067</th><td><i>            // At that time, the name in "q" is pointing at somehost.local and its qnameOrig pointing at</i></td></tr>
<tr><th id="3068">3068</th><td><i>            // "somehost". We need to copy that information so that when we retry with a different search</i></td></tr>
<tr><th id="3069">3069</th><td><i>            // domain e.g., mycompany.local, we get "somehost.mycompany.local".</i></td></tr>
<tr><th id="3070">3070</th><td>            <b>if</b> (q-&gt;qnameOrig)</td></tr>
<tr><th id="3071">3071</th><td>            {</td></tr>
<tr><th id="3072">3072</th><td>                (*question2)-&gt;qnameOrig =  mallocL(<q>"SendAdditionalQuery"</q>, DomainNameLength(q-&gt;qnameOrig));</td></tr>
<tr><th id="3073">3073</th><td>                <b>if</b> (!(*question2)-&gt;qnameOrig) { LogMsg(<q>"SendAdditionalQuery: ERROR!!  malloc failure"</q>); <b>return</b> mStatus_NoMemoryErr; }</td></tr>
<tr><th id="3074">3074</th><td>                (*question2)-&gt;qnameOrig-&gt;c[<var>0</var>] = <var>0</var>;</td></tr>
<tr><th id="3075">3075</th><td>                AssignDomainName((*question2)-&gt;qnameOrig, q-&gt;qnameOrig);</td></tr>
<tr><th id="3076">3076</th><td>                LogInfo(<q>"SendAdditionalQuery: qnameOrig %##s"</q>, (*question2)-&gt;qnameOrig-&gt;c);</td></tr>
<tr><th id="3077">3077</th><td>            }</td></tr>
<tr><th id="3078">3078</th><td>            <i>// For names of the form "&lt;one-or-more-labels&gt;.bar.local." we always do a second unicast query in parallel.</i></td></tr>
<tr><th id="3079">3079</th><td><i>            // For names of the form "&lt;one-label&gt;.local." it's less clear whether we should do a unicast query.</i></td></tr>
<tr><th id="3080">3080</th><td><i>            // If the name being queried is exactly the same as the name in the DHCP "domain" option (e.g. the DHCP</i></td></tr>
<tr><th id="3081">3081</th><td><i>            // "domain" is my-small-company.local, and the user types "my-small-company.local" into their web browser)</i></td></tr>
<tr><th id="3082">3082</th><td><i>            // then that's a hint that it's worth doing a unicast query. Otherwise, we first check to see if the</i></td></tr>
<tr><th id="3083">3083</th><td><i>            // site's DNS server claims there's an SOA record for "local", and if so, that's also a hint that queries</i></td></tr>
<tr><th id="3084">3084</th><td><i>            // for names in the "local" domain will be safely answered privately before they hit the root name servers.</i></td></tr>
<tr><th id="3085">3085</th><td><i>            // Note that in the "my-small-company.local" example above there will typically be an SOA record for</i></td></tr>
<tr><th id="3086">3086</th><td><i>            // "my-small-company.local" but *not* for "local", which is why the "local SOA" check would fail in that case.</i></td></tr>
<tr><th id="3087">3087</th><td><i>            // We need to check against both ActiveDirectoryPrimaryDomain and SearchList. If it matches against either</i></td></tr>
<tr><th id="3088">3088</th><td><i>            // of those, we don't want do the SOA check for the local</i></td></tr>
<tr><th id="3089">3089</th><td>            <b>if</b> (labels == <var>2</var> &amp;&amp; !SameDomainName(&amp;q-&gt;qname, &amp;ActiveDirectoryPrimaryDomain) &amp;&amp; !DomainInSearchList(&amp;q-&gt;qname, mDNSfalse))</td></tr>
<tr><th id="3090">3090</th><td>            {</td></tr>
<tr><th id="3091">3091</th><td>                AssignDomainName(&amp;q2-&gt;qname, &amp;localdomain);</td></tr>
<tr><th id="3092">3092</th><td>                q2-&gt;qtype          = kDNSType_SOA;</td></tr>
<tr><th id="3093">3093</th><td>                q2-&gt;LongLived      = mDNSfalse;</td></tr>
<tr><th id="3094">3094</th><td>                q2-&gt;ForceMCast     = mDNSfalse;</td></tr>
<tr><th id="3095">3095</th><td>                q2-&gt;ReturnIntermed = mDNStrue;</td></tr>
<tr><th id="3096">3096</th><td>                <i>// Don't append search domains for the .local SOA query</i></td></tr>
<tr><th id="3097">3097</th><td>                q2-&gt;AppendSearchDomains = <var>0</var>;</td></tr>
<tr><th id="3098">3098</th><td>                q2-&gt;AppendLocalSearchDomains = <var>0</var>;</td></tr>
<tr><th id="3099">3099</th><td>                q2-&gt;RetryWithSearchDomains = mDNSfalse;</td></tr>
<tr><th id="3100">3100</th><td>                q2-&gt;SearchListIndex = <var>0</var>;</td></tr>
<tr><th id="3101">3101</th><td>                q2-&gt;TimeoutQuestion = <var>0</var>;</td></tr>
<tr><th id="3102">3102</th><td>                q2-&gt;AnonInfo        = mDNSNULL;</td></tr>
<tr><th id="3103">3103</th><td>                q2-&gt;pid             = request-&gt;process_id;</td></tr>
<tr><th id="3104">3104</th><td>                q2-&gt;euid            = request-&gt;uid;</td></tr>
<tr><th id="3105">3105</th><td>            }</td></tr>
<tr><th id="3106">3106</th><td>            LogOperation(<q>"%3d: DNSServiceQueryRecord(%##s, %s) unicast"</q>, request-&gt;sd, q2-&gt;qname.c, DNSTypeName(q2-&gt;qtype));</td></tr>
<tr><th id="3107">3107</th><td>            err = mDNS_StartQuery(&amp;mDNSStorage, q2);</td></tr>
<tr><th id="3108">3108</th><td>            <b>if</b> (err) LogMsg(<q>"%3d: ERROR: DNSServiceQueryRecord %##s %s mDNS_StartQuery: %d"</q>, request-&gt;sd, q2-&gt;qname.c, DNSTypeName(q2-&gt;qtype), (<em>int</em>)err);</td></tr>
<tr><th id="3109">3109</th><td>        }</td></tr>
<tr><th id="3110">3110</th><td>    <b>return</b>(err);</td></tr>
<tr><th id="3111">3111</th><td><u>#else // !UNICAST_DISABLED</u></td></tr>
<tr><th id="3112">3112</th><td>    (<em>void</em>) q;</td></tr>
<tr><th id="3113">3113</th><td>    (<em>void</em>) request;</td></tr>
<tr><th id="3114">3114</th><td>    (<em>void</em>) err;</td></tr>
<tr><th id="3115">3115</th><td></td></tr>
<tr><th id="3116">3116</th><td>    <b>return</b> mStatus_NoError;</td></tr>
<tr><th id="3117">3117</th><td><u>#endif // !UNICAST_DISABLED</u></td></tr>
<tr><th id="3118">3118</th><td>}</td></tr>
<tr><th id="3119">3119</th><td><u>#<span data-ppcond="2944">endif</span> // APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="3120">3120</th><td></td></tr>
<tr><th id="3121">3121</th><td><i>// This function tries to append a search domain if valid and possible. If so, returns true.</i></td></tr>
<tr><th id="3122">3122</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSBool" title='mDNSBool' data-type='unsigned char' data-ref="mDNSBool" data-ref-filename="mDNSBool">mDNSBool</a> <dfn class="decl def fn" id="RetryQuestionWithSearchDomains" title='RetryQuestionWithSearchDomains' data-ref="RetryQuestionWithSearchDomains" data-ref-filename="RetryQuestionWithSearchDomains">RetryQuestionWithSearchDomains</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion" title='DNSQuestion' data-type='struct DNSQuestion_struct' data-ref="DNSQuestion" data-ref-filename="DNSQuestion">DNSQuestion</a> *<dfn class="local col5 decl" id="385question" title='question' data-type='DNSQuestion *' data-ref="385question" data-ref-filename="385question">question</dfn>, <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col6 decl" id="386req" title='req' data-type='request_state *' data-ref="386req" data-ref-filename="386req">req</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#QC_result" title='QC_result' data-type='enum QC_result' data-ref="QC_result" data-ref-filename="QC_result">QC_result</a> <dfn class="local col7 decl" id="387AddRecord" title='AddRecord' data-type='QC_result' data-ref="387AddRecord" data-ref-filename="387AddRecord">AddRecord</dfn>)</td></tr>
<tr><th id="3123">3123</th><td>{</td></tr>
<tr><th id="3124">3124</th><td>    <em>int</em> <dfn class="local col8 decl" id="388result" title='result' data-type='int' data-ref="388result" data-ref-filename="388result">result</dfn>;</td></tr>
<tr><th id="3125">3125</th><td>    <i>// RetryWithSearchDomains tells the core to call us back so that we can retry with search domains if there is no</i></td></tr>
<tr><th id="3126">3126</th><td><i>    // answer in the cache or /etc/hosts. In the first call back from the core, we clear RetryWithSearchDomains so</i></td></tr>
<tr><th id="3127">3127</th><td><i>    // that we don't get called back repeatedly. If we got an answer from the cache or /etc/hosts, we don't touch</i></td></tr>
<tr><th id="3128">3128</th><td><i>    // RetryWithSearchDomains which may or may not be set.</i></td></tr>
<tr><th id="3129">3129</th><td><i>    //</i></td></tr>
<tr><th id="3130">3130</th><td><i>    // If we get e.g., NXDOMAIN and the query is neither suppressed nor exhausted the domain search list and</i></td></tr>
<tr><th id="3131">3131</th><td><i>    // is a valid question for appending search domains, retry by appending domains</i></td></tr>
<tr><th id="3132">3132</th><td></td></tr>
<tr><th id="3133">3133</th><td>    <b>if</b> ((<a class="local col7 ref" href="#387AddRecord" title='AddRecord' data-ref="387AddRecord" data-ref-filename="387AddRecord">AddRecord</a> != <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#QC_suppressed" title='QC_suppressed' data-ref="QC_suppressed" data-ref-filename="QC_suppressed">QC_suppressed</a>) &amp;&amp; <a class="local col5 ref" href="#385question" title='question' data-ref="385question" data-ref-filename="385question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::SearchListIndex" title='DNSQuestion_struct::SearchListIndex' data-ref="DNSQuestion_struct::SearchListIndex" data-ref-filename="DNSQuestion_struct..SearchListIndex">SearchListIndex</a> != -<var>1</var> &amp;&amp; <a class="local col5 ref" href="#385question" title='question' data-ref="385question" data-ref-filename="385question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::AppendSearchDomains" title='DNSQuestion_struct::AppendSearchDomains' data-ref="DNSQuestion_struct::AppendSearchDomains" data-ref-filename="DNSQuestion_struct..AppendSearchDomains">AppendSearchDomains</a>)</td></tr>
<tr><th id="3134">3134</th><td>    {</td></tr>
<tr><th id="3135">3135</th><td>        <a class="local col5 ref" href="#385question" title='question' data-ref="385question" data-ref-filename="385question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::RetryWithSearchDomains" title='DNSQuestion_struct::RetryWithSearchDomains' data-ref="DNSQuestion_struct::RetryWithSearchDomains" data-ref-filename="DNSQuestion_struct..RetryWithSearchDomains">RetryWithSearchDomains</a> = <var>0</var>;</td></tr>
<tr><th id="3136">3136</th><td>        <a class="local col8 ref" href="#388result" title='result' data-ref="388result" data-ref-filename="388result">result</a> = <a class="ref fn" href="#AppendNewSearchDomain" title='AppendNewSearchDomain' data-ref="AppendNewSearchDomain" data-ref-filename="AppendNewSearchDomain">AppendNewSearchDomain</a>(<a class="local col5 ref" href="#385question" title='question' data-ref="385question" data-ref-filename="385question">question</a>);</td></tr>
<tr><th id="3137">3137</th><td>        <i>// As long as the result is either zero or 1, we retry the question. If we exahaust the search</i></td></tr>
<tr><th id="3138">3138</th><td><i>        // domains (result is zero) we try the original query (as it was before appending the search</i></td></tr>
<tr><th id="3139">3139</th><td><i>        // domains) as such on the wire as a last resort if we have not tried them before. For queries</i></td></tr>
<tr><th id="3140">3140</th><td><i>        // with more than one label, we have already tried them before appending search domains and</i></td></tr>
<tr><th id="3141">3141</th><td><i>        // hence don't retry again</i></td></tr>
<tr><th id="3142">3142</th><td>        <b>if</b> (<a class="local col8 ref" href="#388result" title='result' data-ref="388result" data-ref-filename="388result">result</a> != -<var>1</var>)</td></tr>
<tr><th id="3143">3143</th><td>        {</td></tr>
<tr><th id="3144">3144</th><td>            <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="local col9 decl" id="389err" title='err' data-type='mStatus' data-ref="389err" data-ref-filename="389err">err</dfn>;</td></tr>
<tr><th id="3145">3145</th><td>            <a class="local col9 ref" href="#389err" title='err' data-ref="389err" data-ref-filename="389err">err</a> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_StartQuery" title='mDNS_StartQuery' data-ref="mDNS_StartQuery" data-ref-filename="mDNS_StartQuery">mDNS_StartQuery</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col5 ref" href="#385question" title='question' data-ref="385question" data-ref-filename="385question">question</a>);</td></tr>
<tr><th id="3146">3146</th><td>            <b>if</b> (!<a class="local col9 ref" href="#389err" title='err' data-ref="389err" data-ref-filename="389err">err</a>)</td></tr>
<tr><th id="3147">3147</th><td>            {</td></tr>
<tr><th id="3148">3148</th><td>                <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: RetryQuestionWithSearchDomains(%##s, %s), retrying after appending search domain&quot;, req-&gt;sd, question-&gt;qname.c, DNSTypeName(question-&gt;qtype));} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: RetryQuestionWithSearchDomains(%##s, %s), retrying after appending search domain"</q>, <a class="local col6 ref" href="#386req" title='req' data-ref="386req" data-ref-filename="386req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col5 ref" href="#385question" title='question' data-ref="385question" data-ref-filename="385question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col5 ref" href="#385question" title='question' data-ref="385question" data-ref-filename="385question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a>));</td></tr>
<tr><th id="3149">3149</th><td>                <i>// If the result was zero, it meant that there are no search domains and we just retried the question</i></td></tr>
<tr><th id="3150">3150</th><td><i>                // as a single label and we should not retry with search domains anymore.</i></td></tr>
<tr><th id="3151">3151</th><td>                <b>if</b> (!<a class="local col8 ref" href="#388result" title='result' data-ref="388result" data-ref-filename="388result">result</a>) <a class="local col5 ref" href="#385question" title='question' data-ref="385question" data-ref-filename="385question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::SearchListIndex" title='DNSQuestion_struct::SearchListIndex' data-ref="DNSQuestion_struct::SearchListIndex" data-ref-filename="DNSQuestion_struct..SearchListIndex">SearchListIndex</a> = -<var>1</var>;</td></tr>
<tr><th id="3152">3152</th><td>                <b>return</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>;</td></tr>
<tr><th id="3153">3153</th><td>            }</td></tr>
<tr><th id="3154">3154</th><td>            <b>else</b></td></tr>
<tr><th id="3155">3155</th><td>            {</td></tr>
<tr><th id="3156">3156</th><td>                <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: ERROR: RetryQuestionWithSearchDomains %##s %s mDNS_StartQuery: %d, while retrying with search domains&quot;, req-&gt;sd, question-&gt;qname.c, DNSTypeName(question-&gt;qtype), (int)err)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: ERROR: RetryQuestionWithSearchDomains %##s %s mDNS_StartQuery: %d, while retrying with search domains"</q>, <a class="local col6 ref" href="#386req" title='req' data-ref="386req" data-ref-filename="386req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col5 ref" href="#385question" title='question' data-ref="385question" data-ref-filename="385question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col5 ref" href="#385question" title='question' data-ref="385question" data-ref-filename="385question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a>), (<em>int</em>)<a class="local col9 ref" href="#389err" title='err' data-ref="389err" data-ref-filename="389err">err</a>);</td></tr>
<tr><th id="3157">3157</th><td>                <i>// We have already stopped the query and could not restart. Reset the appropriate pointers</i></td></tr>
<tr><th id="3158">3158</th><td><i>                // so that we don't call stop again when the question terminates</i></td></tr>
<tr><th id="3159">3159</th><td>                <a class="local col5 ref" href="#385question" title='question' data-ref="385question" data-ref-filename="385question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::QuestionContext" title='DNSQuestion_struct::QuestionContext' data-ref="DNSQuestion_struct::QuestionContext" data-ref-filename="DNSQuestion_struct..QuestionContext">QuestionContext</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="3160">3160</th><td>            }</td></tr>
<tr><th id="3161">3161</th><td>        }</td></tr>
<tr><th id="3162">3162</th><td>    }</td></tr>
<tr><th id="3163">3163</th><td>    <b>else</b></td></tr>
<tr><th id="3164">3164</th><td>    {</td></tr>
<tr><th id="3165">3165</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;%3d: RetryQuestionWithSearchDomains: Not appending search domains - SuppressQuery %d, SearchListIndex %d, AppendSearchDomains %d&quot;, req-&gt;sd, AddRecord, question-&gt;SearchListIndex, question-&gt;AppendSearchDomains);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"%3d: RetryQuestionWithSearchDomains: Not appending search domains - SuppressQuery %d, SearchListIndex %d, AppendSearchDomains %d"</q>, <a class="local col6 ref" href="#386req" title='req' data-ref="386req" data-ref-filename="386req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col7 ref" href="#387AddRecord" title='AddRecord' data-ref="387AddRecord" data-ref-filename="387AddRecord">AddRecord</a>, <a class="local col5 ref" href="#385question" title='question' data-ref="385question" data-ref-filename="385question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::SearchListIndex" title='DNSQuestion_struct::SearchListIndex' data-ref="DNSQuestion_struct::SearchListIndex" data-ref-filename="DNSQuestion_struct..SearchListIndex">SearchListIndex</a>, <a class="local col5 ref" href="#385question" title='question' data-ref="385question" data-ref-filename="385question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::AppendSearchDomains" title='DNSQuestion_struct::AppendSearchDomains' data-ref="DNSQuestion_struct::AppendSearchDomains" data-ref-filename="DNSQuestion_struct..AppendSearchDomains">AppendSearchDomains</a>);</td></tr>
<tr><th id="3166">3166</th><td>    }</td></tr>
<tr><th id="3167">3167</th><td>    <b>return</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>;</td></tr>
<tr><th id="3168">3168</th><td>}</td></tr>
<tr><th id="3169">3169</th><td></td></tr>
<tr><th id="3170">3170</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="queryrecord_result_reply" title='queryrecord_result_reply' data-ref="queryrecord_result_reply" data-ref-filename="queryrecord_result_reply">queryrecord_result_reply</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS" title='mDNS' data-type='struct mDNS_struct' data-ref="mDNS" data-ref-filename="mDNS">mDNS</a> *<em>const</em> <dfn class="local col0 decl" id="390m" title='m' data-type='mDNS *const' data-ref="390m" data-ref-filename="390m">m</dfn>, <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col1 decl" id="391req" title='req' data-type='request_state *' data-ref="391req" data-ref-filename="391req">req</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion" title='DNSQuestion' data-type='struct DNSQuestion_struct' data-ref="DNSQuestion" data-ref-filename="DNSQuestion">DNSQuestion</a> *<dfn class="local col2 decl" id="392question" title='question' data-type='DNSQuestion *' data-ref="392question" data-ref-filename="392question">question</dfn>, <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord" title='ResourceRecord' data-type='struct ResourceRecord_struct' data-ref="ResourceRecord" data-ref-filename="ResourceRecord">ResourceRecord</a> *<em>const</em> <dfn class="local col3 decl" id="393answer" title='answer' data-type='const ResourceRecord *const' data-ref="393answer" data-ref-filename="393answer">answer</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#QC_result" title='QC_result' data-type='enum QC_result' data-ref="QC_result" data-ref-filename="QC_result">QC_result</a> <dfn class="local col4 decl" id="394AddRecord" title='AddRecord' data-type='QC_result' data-ref="394AddRecord" data-ref-filename="394AddRecord">AddRecord</dfn>,</td></tr>
<tr><th id="3171">3171</th><td>    <a class="typedef" href="dns_sd.h.html#DNSServiceErrorType" title='DNSServiceErrorType' data-type='int32_t' data-ref="DNSServiceErrorType" data-ref-filename="DNSServiceErrorType">DNSServiceErrorType</a> <dfn class="local col5 decl" id="395error" title='error' data-type='DNSServiceErrorType' data-ref="395error" data-ref-filename="395error">error</dfn>)</td></tr>
<tr><th id="3172">3172</th><td>{</td></tr>
<tr><th id="3173">3173</th><td>    <em>char</em> <dfn class="local col6 decl" id="396name" title='name' data-type='char [1009]' data-ref="396name" data-ref-filename="396name">name</dfn>[<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#417" title="1009" data-ref="_M/MAX_ESCAPED_DOMAIN_NAME">MAX_ESCAPED_DOMAIN_NAME</a>];</td></tr>
<tr><th id="3174">3174</th><td>    <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#size_t" title='size_t' data-type='unsigned long' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col7 decl" id="397len" title='len' data-type='size_t' data-ref="397len" data-ref-filename="397len">len</dfn>;</td></tr>
<tr><th id="3175">3175</th><td>    <a class="typedef" href="dns_sd.h.html#DNSServiceFlags" title='DNSServiceFlags' data-type='uint32_t' data-ref="DNSServiceFlags" data-ref-filename="DNSServiceFlags">DNSServiceFlags</a> <dfn class="local col8 decl" id="398flags" title='flags' data-type='DNSServiceFlags' data-ref="398flags" data-ref-filename="398flags">flags</dfn> = <var>0</var>;</td></tr>
<tr><th id="3176">3176</th><td>    <a class="typedef" href="uds_daemon.h.html#reply_state" title='reply_state' data-type='struct reply_state' data-ref="reply_state" data-ref-filename="reply_state">reply_state</a> *<dfn class="local col9 decl" id="399rep" title='rep' data-type='reply_state *' data-ref="399rep" data-ref-filename="399rep">rep</dfn>;</td></tr>
<tr><th id="3177">3177</th><td>    <em>char</em> *<dfn class="local col0 decl" id="400data" title='data' data-type='char *' data-ref="400data" data-ref-filename="400data">data</dfn>;</td></tr>
<tr><th id="3178">3178</th><td></td></tr>
<tr><th id="3179">3179</th><td>    <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2903" title="ConvertDomainNameToCString_withescape((answer-&gt;name), (name), &apos;\\&apos;)" data-ref="_M/ConvertDomainNameToCString">ConvertDomainNameToCString</a>(<a class="local col3 ref" href="#393answer" title='answer' data-ref="393answer" data-ref-filename="393answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::name" title='ResourceRecord_struct::name' data-ref="ResourceRecord_struct::name" data-ref-filename="ResourceRecord_struct..name">name</a>, <a class="local col6 ref" href="#396name" title='name' data-ref="396name" data-ref-filename="396name">name</a>);</td></tr>
<tr><th id="3180">3180</th><td></td></tr>
<tr><th id="3181">3181</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: %s(%##s, %s) RESULT %s interface %d: %s&quot;, req-&gt;sd, req-&gt;hdr.op == query_request ? &quot;DNSServiceQueryRecord&quot; : &quot;DNSServiceGetAddrInfo&quot;, question-&gt;qname.c, DNSTypeName(question-&gt;qtype), AddRecord ? &quot;ADD&quot; : &quot;RMV&quot;, mDNSPlatformInterfaceIndexfromInterfaceID(m, answer-&gt;InterfaceID, mDNSfalse), GetRRDisplayString_rdb(answer, &amp;(answer)-&gt;rdata-&gt;u, (m)-&gt;MsgBuffer));} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: %s(%##s, %s) RESULT %s interface %d: %s"</q>, <a class="local col1 ref" href="#391req" title='req' data-ref="391req" data-ref-filename="391req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>,</td></tr>
<tr><th id="3182">3182</th><td>                 <a class="local col1 ref" href="#391req" title='req' data-ref="391req" data-ref-filename="391req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::op" title='(anonymous struct)::op' data-ref="(anonymous)::op" data-ref-filename="(anonymous)..op">op</a> == <a class="enum" href="dnssd_ipc.h.html#query_request" title='query_request' data-ref="query_request" data-ref-filename="query_request">query_request</a> ? <q>"DNSServiceQueryRecord"</q> : <q>"DNSServiceGetAddrInfo"</q>,</td></tr>
<tr><th id="3183">3183</th><td>                 <a class="local col2 ref" href="#392question" title='question' data-ref="392question" data-ref-filename="392question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col2 ref" href="#392question" title='question' data-ref="392question" data-ref-filename="392question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a>), <a class="local col4 ref" href="#394AddRecord" title='AddRecord' data-ref="394AddRecord" data-ref-filename="394AddRecord">AddRecord</a> ? <q>"ADD"</q> : <q>"RMV"</q>,</td></tr>
<tr><th id="3184">3184</th><td>                 <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformInterfaceIndexfromInterfaceID" title='mDNSPlatformInterfaceIndexfromInterfaceID' data-ref="mDNSPlatformInterfaceIndexfromInterfaceID" data-ref-filename="mDNSPlatformInterfaceIndexfromInterfaceID">mDNSPlatformInterfaceIndexfromInterfaceID</a>(<a class="local col0 ref" href="#390m" title='m' data-ref="390m" data-ref-filename="390m">m</a>, <a class="local col3 ref" href="#393answer" title='answer' data-ref="393answer" data-ref-filename="393answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::InterfaceID" title='ResourceRecord_struct::InterfaceID' data-ref="ResourceRecord_struct::InterfaceID" data-ref-filename="ResourceRecord_struct..InterfaceID">InterfaceID</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>), <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2941" title="GetRRDisplayString_rdb(answer, &amp;(answer)-&gt;rdata-&gt;u, (m)-&gt;MsgBuffer)" data-ref="_M/RRDisplayString">RRDisplayString</a>(<a class="local col0 ref" href="#390m" title='m' data-ref="390m" data-ref-filename="390m">m</a>, <a class="local col3 ref" href="#393answer" title='answer' data-ref="393answer" data-ref-filename="393answer">answer</a>));</td></tr>
<tr><th id="3185">3185</th><td></td></tr>
<tr><th id="3186">3186</th><td>    <a class="local col7 ref" href="#397len" title='len' data-ref="397len" data-ref-filename="397len">len</a> = <b>sizeof</b>(<a class="typedef" href="dns_sd.h.html#DNSServiceFlags" title='DNSServiceFlags' data-type='uint32_t' data-ref="DNSServiceFlags" data-ref-filename="DNSServiceFlags">DNSServiceFlags</a>);  <i>// calculate reply data length</i></td></tr>
<tr><th id="3187">3187</th><td>    <a class="local col7 ref" href="#397len" title='len' data-ref="397len" data-ref-filename="397len">len</a> += <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a>);     <i>// interface index</i></td></tr>
<tr><th id="3188">3188</th><td>    <a class="local col7 ref" href="#397len" title='len' data-ref="397len" data-ref-filename="397len">len</a> += <b>sizeof</b>(<a class="typedef" href="dns_sd.h.html#DNSServiceErrorType" title='DNSServiceErrorType' data-type='int32_t' data-ref="DNSServiceErrorType" data-ref-filename="DNSServiceErrorType">DNSServiceErrorType</a>);</td></tr>
<tr><th id="3189">3189</th><td>    <a class="local col7 ref" href="#397len" title='len' data-ref="397len" data-ref-filename="397len">len</a> += <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strlen" title='strlen' data-ref="strlen" data-ref-filename="strlen">strlen</a>(<a class="local col6 ref" href="#396name" title='name' data-ref="396name" data-ref-filename="396name">name</a>) + <var>1</var>;</td></tr>
<tr><th id="3190">3190</th><td>    <a class="local col7 ref" href="#397len" title='len' data-ref="397len" data-ref-filename="397len">len</a> += <var>3</var> * <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu16" title='mDNSu16' data-type='unsigned short' data-ref="mDNSu16" data-ref-filename="mDNSu16">mDNSu16</a>); <i>// type, class, rdlen</i></td></tr>
<tr><th id="3191">3191</th><td>    <a class="local col7 ref" href="#397len" title='len' data-ref="397len" data-ref-filename="397len">len</a> += <a class="local col3 ref" href="#393answer" title='answer' data-ref="393answer" data-ref-filename="393answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdlength" title='ResourceRecord_struct::rdlength' data-ref="ResourceRecord_struct::rdlength" data-ref-filename="ResourceRecord_struct..rdlength">rdlength</a>;</td></tr>
<tr><th id="3192">3192</th><td>    <a class="local col7 ref" href="#397len" title='len' data-ref="397len" data-ref-filename="397len">len</a> += <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a>);     <i>// TTL</i></td></tr>
<tr><th id="3193">3193</th><td></td></tr>
<tr><th id="3194">3194</th><td>    <a class="local col9 ref" href="#399rep" title='rep' data-ref="399rep" data-ref-filename="399rep">rep</a> = <a class="ref fn" href="#create_reply" title='create_reply' data-ref="create_reply" data-ref-filename="create_reply">create_reply</a>(<a class="local col1 ref" href="#391req" title='req' data-ref="391req" data-ref-filename="391req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::op" title='(anonymous struct)::op' data-ref="(anonymous)::op" data-ref-filename="(anonymous)..op">op</a> == <a class="enum" href="dnssd_ipc.h.html#query_request" title='query_request' data-ref="query_request" data-ref-filename="query_request">query_request</a> ? <a class="enum" href="dnssd_ipc.h.html#query_reply_op" title='query_reply_op' data-ref="query_reply_op" data-ref-filename="query_reply_op">query_reply_op</a> : <a class="enum" href="dnssd_ipc.h.html#addrinfo_reply_op" title='addrinfo_reply_op' data-ref="addrinfo_reply_op" data-ref-filename="addrinfo_reply_op">addrinfo_reply_op</a>, <a class="local col7 ref" href="#397len" title='len' data-ref="397len" data-ref-filename="397len">len</a>, <a class="local col1 ref" href="#391req" title='req' data-ref="391req" data-ref-filename="391req">req</a>);</td></tr>
<tr><th id="3195">3195</th><td></td></tr>
<tr><th id="3196">3196</th><td>    <b>if</b> (<a class="local col4 ref" href="#394AddRecord" title='AddRecord' data-ref="394AddRecord" data-ref-filename="394AddRecord">AddRecord</a>)</td></tr>
<tr><th id="3197">3197</th><td>        <a class="local col8 ref" href="#398flags" title='flags' data-ref="398flags" data-ref-filename="398flags">flags</a> |= <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsAdd" title='kDNSServiceFlagsAdd' data-ref="kDNSServiceFlagsAdd" data-ref-filename="kDNSServiceFlagsAdd">kDNSServiceFlagsAdd</a>;</td></tr>
<tr><th id="3198">3198</th><td>    <b>if</b> (<a class="local col2 ref" href="#392question" title='question' data-ref="392question" data-ref-filename="392question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ValidationStatus" title='DNSQuestion_struct::ValidationStatus' data-ref="DNSQuestion_struct::ValidationStatus" data-ref-filename="DNSQuestion_struct..ValidationStatus">ValidationStatus</a> != <var>0</var>)</td></tr>
<tr><th id="3199">3199</th><td>    {</td></tr>
<tr><th id="3200">3200</th><td>        <a class="local col5 ref" href="#395error" title='error' data-ref="395error" data-ref-filename="395error">error</a> =   <a class="enum" href="dns_sd.h.html#kDNSServiceErr_NoError" title='kDNSServiceErr_NoError' data-ref="kDNSServiceErr_NoError" data-ref-filename="kDNSServiceErr_NoError">kDNSServiceErr_NoError</a>;</td></tr>
<tr><th id="3201">3201</th><td>        <b>if</b> (<a class="local col2 ref" href="#392question" title='question' data-ref="392question" data-ref-filename="392question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ValidationRequired" title='DNSQuestion_struct::ValidationRequired' data-ref="DNSQuestion_struct::ValidationRequired" data-ref-filename="DNSQuestion_struct..ValidationRequired">ValidationRequired</a> &amp;&amp; <a class="local col2 ref" href="#392question" title='question' data-ref="392question" data-ref-filename="392question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ValidationState" title='DNSQuestion_struct::ValidationState' data-ref="DNSQuestion_struct::ValidationState" data-ref-filename="DNSQuestion_struct..ValidationState">ValidationState</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSSECValDone" title='DNSSECValDone' data-ref="DNSSECValDone" data-ref-filename="DNSSECValDone">DNSSECValDone</a>)</td></tr>
<tr><th id="3202">3202</th><td>        {</td></tr>
<tr><th id="3203">3203</th><td>            <b>switch</b> (<a class="local col2 ref" href="#392question" title='question' data-ref="392question" data-ref-filename="392question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ValidationStatus" title='DNSQuestion_struct::ValidationStatus' data-ref="DNSQuestion_struct::ValidationStatus" data-ref-filename="DNSQuestion_struct..ValidationStatus">ValidationStatus</a>) <i>//Set the dnssec flags to be passed on to the Apps here</i></td></tr>
<tr><th id="3204">3204</th><td>            {</td></tr>
<tr><th id="3205">3205</th><td>            <b>case</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSSEC_Secure" title='DNSSEC_Secure' data-ref="DNSSEC_Secure" data-ref-filename="DNSSEC_Secure">DNSSEC_Secure</a>:</td></tr>
<tr><th id="3206">3206</th><td>                <a class="local col8 ref" href="#398flags" title='flags' data-ref="398flags" data-ref-filename="398flags">flags</a> |= <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsSecure" title='kDNSServiceFlagsSecure' data-ref="kDNSServiceFlagsSecure" data-ref-filename="kDNSServiceFlagsSecure">kDNSServiceFlagsSecure</a>;</td></tr>
<tr><th id="3207">3207</th><td>                <b>break</b>;</td></tr>
<tr><th id="3208">3208</th><td>            <b>case</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSSEC_Insecure" title='DNSSEC_Insecure' data-ref="DNSSEC_Insecure" data-ref-filename="DNSSEC_Insecure">DNSSEC_Insecure</a>:</td></tr>
<tr><th id="3209">3209</th><td>                <a class="local col8 ref" href="#398flags" title='flags' data-ref="398flags" data-ref-filename="398flags">flags</a> |= <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsInsecure" title='kDNSServiceFlagsInsecure' data-ref="kDNSServiceFlagsInsecure" data-ref-filename="kDNSServiceFlagsInsecure">kDNSServiceFlagsInsecure</a>;</td></tr>
<tr><th id="3210">3210</th><td>                <b>break</b>;</td></tr>
<tr><th id="3211">3211</th><td>            <b>case</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSSEC_Indeterminate" title='DNSSEC_Indeterminate' data-ref="DNSSEC_Indeterminate" data-ref-filename="DNSSEC_Indeterminate">DNSSEC_Indeterminate</a>:</td></tr>
<tr><th id="3212">3212</th><td>                <a class="local col8 ref" href="#398flags" title='flags' data-ref="398flags" data-ref-filename="398flags">flags</a> |= <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsIndeterminate" title='kDNSServiceFlagsIndeterminate' data-ref="kDNSServiceFlagsIndeterminate" data-ref-filename="kDNSServiceFlagsIndeterminate">kDNSServiceFlagsIndeterminate</a>;</td></tr>
<tr><th id="3213">3213</th><td>                <b>break</b>;</td></tr>
<tr><th id="3214">3214</th><td>            <b>case</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSSEC_Bogus" title='DNSSEC_Bogus' data-ref="DNSSEC_Bogus" data-ref-filename="DNSSEC_Bogus">DNSSEC_Bogus</a>:</td></tr>
<tr><th id="3215">3215</th><td>                <a class="local col8 ref" href="#398flags" title='flags' data-ref="398flags" data-ref-filename="398flags">flags</a> |= <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsBogus" title='kDNSServiceFlagsBogus' data-ref="kDNSServiceFlagsBogus" data-ref-filename="kDNSServiceFlagsBogus">kDNSServiceFlagsBogus</a>;</td></tr>
<tr><th id="3216">3216</th><td>                <b>break</b>;</td></tr>
<tr><th id="3217">3217</th><td>            <b>default</b>:</td></tr>
<tr><th id="3218">3218</th><td>                <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;queryrecord_result_reply unknown status %d for %##s&quot;, question-&gt;ValidationStatus, question-&gt;qname.c)" data-ref="_M/LogMsg">LogMsg</a>(<q>"queryrecord_result_reply unknown status %d for %##s"</q>, <a class="local col2 ref" href="#392question" title='question' data-ref="392question" data-ref-filename="392question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ValidationStatus" title='DNSQuestion_struct::ValidationStatus' data-ref="DNSQuestion_struct::ValidationStatus" data-ref-filename="DNSQuestion_struct..ValidationStatus">ValidationStatus</a>, <a class="local col2 ref" href="#392question" title='question' data-ref="392question" data-ref-filename="392question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>);</td></tr>
<tr><th id="3219">3219</th><td>            }</td></tr>
<tr><th id="3220">3220</th><td>        }</td></tr>
<tr><th id="3221">3221</th><td>    }</td></tr>
<tr><th id="3222">3222</th><td></td></tr>
<tr><th id="3223">3223</th><td>    <a class="local col9 ref" href="#399rep" title='rep' data-ref="399rep" data-ref-filename="399rep">rep</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::rhdr" title='reply_state::rhdr' data-ref="reply_state::rhdr" data-ref-filename="reply_state..rhdr">rhdr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#(anonymous)::flags" title='(anonymous struct)::flags' data-ref="(anonymous)::flags" data-ref-filename="(anonymous)..flags">flags</a> = <a class="ref fn" href="#dnssd_htonl" title='dnssd_htonl' data-ref="dnssd_htonl" data-ref-filename="dnssd_htonl">dnssd_htonl</a>(<a class="local col8 ref" href="#398flags" title='flags' data-ref="398flags" data-ref-filename="398flags">flags</a>);</td></tr>
<tr><th id="3224">3224</th><td>    <i>// Call mDNSPlatformInterfaceIndexfromInterfaceID, but suppressNetworkChange (last argument). Otherwise, if the</i></td></tr>
<tr><th id="3225">3225</th><td><i>    // InterfaceID is not valid, then it simulates a "NetworkChanged" which in turn makes questions</i></td></tr>
<tr><th id="3226">3226</th><td><i>    // to be stopped and started including  *this* one. Normally the InterfaceID is valid. But when we</i></td></tr>
<tr><th id="3227">3227</th><td><i>    // are using the /etc/hosts entries to answer a question, the InterfaceID may not be known to the</i></td></tr>
<tr><th id="3228">3228</th><td><i>    // mDNS core . Eventually, we should remove the calls to "NetworkChanged" in</i></td></tr>
<tr><th id="3229">3229</th><td><i>    // mDNSPlatformInterfaceIndexfromInterfaceID when it can't find InterfaceID as ResourceRecords</i></td></tr>
<tr><th id="3230">3230</th><td><i>    // should not have existed to answer this question if the corresponding interface is not valid.</i></td></tr>
<tr><th id="3231">3231</th><td>    <a class="local col9 ref" href="#399rep" title='rep' data-ref="399rep" data-ref-filename="399rep">rep</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::rhdr" title='reply_state::rhdr' data-ref="reply_state::rhdr" data-ref-filename="reply_state..rhdr">rhdr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#(anonymous)::ifi" title='(anonymous struct)::ifi' data-ref="(anonymous)::ifi" data-ref-filename="(anonymous)..ifi">ifi</a>   = <a class="ref fn" href="#dnssd_htonl" title='dnssd_htonl' data-ref="dnssd_htonl" data-ref-filename="dnssd_htonl">dnssd_htonl</a>(<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformInterfaceIndexfromInterfaceID" title='mDNSPlatformInterfaceIndexfromInterfaceID' data-ref="mDNSPlatformInterfaceIndexfromInterfaceID" data-ref-filename="mDNSPlatformInterfaceIndexfromInterfaceID">mDNSPlatformInterfaceIndexfromInterfaceID</a>(<a class="local col0 ref" href="#390m" title='m' data-ref="390m" data-ref-filename="390m">m</a>, <a class="local col3 ref" href="#393answer" title='answer' data-ref="393answer" data-ref-filename="393answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::InterfaceID" title='ResourceRecord_struct::InterfaceID' data-ref="ResourceRecord_struct::InterfaceID" data-ref-filename="ResourceRecord_struct..InterfaceID">InterfaceID</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>));</td></tr>
<tr><th id="3232">3232</th><td>    <a class="local col9 ref" href="#399rep" title='rep' data-ref="399rep" data-ref-filename="399rep">rep</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::rhdr" title='reply_state::rhdr' data-ref="reply_state::rhdr" data-ref-filename="reply_state..rhdr">rhdr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#(anonymous)::error" title='(anonymous struct)::error' data-ref="(anonymous)::error" data-ref-filename="(anonymous)..error">error</a> = <a class="ref fn" href="#dnssd_htonl" title='dnssd_htonl' data-ref="dnssd_htonl" data-ref-filename="dnssd_htonl">dnssd_htonl</a>(<a class="local col5 ref" href="#395error" title='error' data-ref="395error" data-ref-filename="395error">error</a>);</td></tr>
<tr><th id="3233">3233</th><td></td></tr>
<tr><th id="3234">3234</th><td>    <a class="local col0 ref" href="#400data" title='data' data-ref="400data" data-ref-filename="400data">data</a> = (<em>char</em> *)&amp;<a class="local col9 ref" href="#399rep" title='rep' data-ref="399rep" data-ref-filename="399rep">rep</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::rhdr" title='reply_state::rhdr' data-ref="reply_state::rhdr" data-ref-filename="reply_state..rhdr">rhdr</a>[<var>1</var>];</td></tr>
<tr><th id="3235">3235</th><td></td></tr>
<tr><th id="3236">3236</th><td>    <a class="macro" href="dnssd_ipc.h.html#197" title="__dnssd_ipc_put_string" data-ref="_M/put_string">put_string</a>(<a class="local col6 ref" href="#396name" title='name' data-ref="396name" data-ref-filename="396name">name</a>,             &amp;<a class="local col0 ref" href="#400data" title='data' data-ref="400data" data-ref-filename="400data">data</a>);</td></tr>
<tr><th id="3237">3237</th><td>    <a class="macro" href="dnssd_ipc.h.html#195" title="__dnssd_ipc_put_uint16" data-ref="_M/put_uint16">put_uint16</a>(<a class="local col3 ref" href="#393answer" title='answer' data-ref="393answer" data-ref-filename="393answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rrtype" title='ResourceRecord_struct::rrtype' data-ref="ResourceRecord_struct::rrtype" data-ref-filename="ResourceRecord_struct..rrtype">rrtype</a>,   &amp;<a class="local col0 ref" href="#400data" title='data' data-ref="400data" data-ref-filename="400data">data</a>);</td></tr>
<tr><th id="3238">3238</th><td>    <a class="macro" href="dnssd_ipc.h.html#195" title="__dnssd_ipc_put_uint16" data-ref="_M/put_uint16">put_uint16</a>(<a class="local col3 ref" href="#393answer" title='answer' data-ref="393answer" data-ref-filename="393answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rrclass" title='ResourceRecord_struct::rrclass' data-ref="ResourceRecord_struct::rrclass" data-ref-filename="ResourceRecord_struct..rrclass">rrclass</a>,  &amp;<a class="local col0 ref" href="#400data" title='data' data-ref="400data" data-ref-filename="400data">data</a>);</td></tr>
<tr><th id="3239">3239</th><td>    <a class="macro" href="dnssd_ipc.h.html#195" title="__dnssd_ipc_put_uint16" data-ref="_M/put_uint16">put_uint16</a>(<a class="local col3 ref" href="#393answer" title='answer' data-ref="393answer" data-ref-filename="393answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdlength" title='ResourceRecord_struct::rdlength' data-ref="ResourceRecord_struct::rdlength" data-ref-filename="ResourceRecord_struct..rdlength">rdlength</a>, &amp;<a class="local col0 ref" href="#400data" title='data' data-ref="400data" data-ref-filename="400data">data</a>);</td></tr>
<tr><th id="3240">3240</th><td>    <i>// We need to use putRData here instead of the crude put_rdata function, because the crude put_rdata</i></td></tr>
<tr><th id="3241">3241</th><td><i>    // function just does a blind memory copy without regard to structures that may have holes in them.</i></td></tr>
<tr><th id="3242">3242</th><td>    <b>if</b> (<a class="local col3 ref" href="#393answer" title='answer' data-ref="393answer" data-ref-filename="393answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdlength" title='ResourceRecord_struct::rdlength' data-ref="ResourceRecord_struct::rdlength" data-ref-filename="ResourceRecord_struct..rdlength">rdlength</a>)</td></tr>
<tr><th id="3243">3243</th><td>        <b>if</b> (!<a class="ref fn" href="../mDNSCore/DNSCommon.h.html#putRData" title='putRData' data-ref="putRData" data-ref-filename="putRData">putRData</a>(<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>, (<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu8" title='mDNSu8' data-type='unsigned char' data-ref="mDNSu8" data-ref-filename="mDNSu8">mDNSu8</a> *)<a class="local col0 ref" href="#400data" title='data' data-ref="400data" data-ref-filename="400data">data</a>, (<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu8" title='mDNSu8' data-type='unsigned char' data-ref="mDNSu8" data-ref-filename="mDNSu8">mDNSu8</a> *)<a class="local col9 ref" href="#399rep" title='rep' data-ref="399rep" data-ref-filename="399rep">rep</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::rhdr" title='reply_state::rhdr' data-ref="reply_state::rhdr" data-ref-filename="reply_state..rhdr">rhdr</a> + <a class="local col7 ref" href="#397len" title='len' data-ref="397len" data-ref-filename="397len">len</a>, <a class="local col3 ref" href="#393answer" title='answer' data-ref="393answer" data-ref-filename="393answer">answer</a>))</td></tr>
<tr><th id="3244">3244</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;queryrecord_result_reply putRData failed %d&quot;, (mDNSu8 *)rep-&gt;rhdr + len - (mDNSu8 *)data)" data-ref="_M/LogMsg">LogMsg</a>(<q>"queryrecord_result_reply putRData failed %d"</q>, (<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu8" title='mDNSu8' data-type='unsigned char' data-ref="mDNSu8" data-ref-filename="mDNSu8">mDNSu8</a> *)<a class="local col9 ref" href="#399rep" title='rep' data-ref="399rep" data-ref-filename="399rep">rep</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::rhdr" title='reply_state::rhdr' data-ref="reply_state::rhdr" data-ref-filename="reply_state..rhdr">rhdr</a> + <a class="local col7 ref" href="#397len" title='len' data-ref="397len" data-ref-filename="397len">len</a> - (<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu8" title='mDNSu8' data-type='unsigned char' data-ref="mDNSu8" data-ref-filename="mDNSu8">mDNSu8</a> *)<a class="local col0 ref" href="#400data" title='data' data-ref="400data" data-ref-filename="400data">data</a>);</td></tr>
<tr><th id="3245">3245</th><td>    <a class="local col0 ref" href="#400data" title='data' data-ref="400data" data-ref-filename="400data">data</a> += <a class="local col3 ref" href="#393answer" title='answer' data-ref="393answer" data-ref-filename="393answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdlength" title='ResourceRecord_struct::rdlength' data-ref="ResourceRecord_struct::rdlength" data-ref-filename="ResourceRecord_struct..rdlength">rdlength</a>;</td></tr>
<tr><th id="3246">3246</th><td>    <a class="macro" href="dnssd_ipc.h.html#193" title="__dnssd_ipc_put_uint32" data-ref="_M/put_uint32">put_uint32</a>(<a class="local col4 ref" href="#394AddRecord" title='AddRecord' data-ref="394AddRecord" data-ref-filename="394AddRecord">AddRecord</a> ? <a class="local col3 ref" href="#393answer" title='answer' data-ref="393answer" data-ref-filename="393answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rroriginalttl" title='ResourceRecord_struct::rroriginalttl' data-ref="ResourceRecord_struct::rroriginalttl" data-ref-filename="ResourceRecord_struct..rroriginalttl">rroriginalttl</a> : <var>0</var>, &amp;<a class="local col0 ref" href="#400data" title='data' data-ref="400data" data-ref-filename="400data">data</a>);</td></tr>
<tr><th id="3247">3247</th><td></td></tr>
<tr><th id="3248">3248</th><td>    <a class="ref fn" href="#append_reply" title='append_reply' data-ref="append_reply" data-ref-filename="append_reply">append_reply</a>(<a class="local col1 ref" href="#391req" title='req' data-ref="391req" data-ref-filename="391req">req</a>, <a class="local col9 ref" href="#399rep" title='rep' data-ref="399rep" data-ref-filename="399rep">rep</a>);</td></tr>
<tr><th id="3249">3249</th><td>    <i>// Stop the question, if we just timed out</i></td></tr>
<tr><th id="3250">3250</th><td>    <b>if</b> (<a class="local col5 ref" href="#395error" title='error' data-ref="395error" data-ref-filename="395error">error</a> == <a class="enum" href="dns_sd.h.html#kDNSServiceErr_Timeout" title='kDNSServiceErr_Timeout' data-ref="kDNSServiceErr_Timeout" data-ref-filename="kDNSServiceErr_Timeout">kDNSServiceErr_Timeout</a>)</td></tr>
<tr><th id="3251">3251</th><td>    {</td></tr>
<tr><th id="3252">3252</th><td>        <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_StopQuery" title='mDNS_StopQuery' data-ref="mDNS_StopQuery" data-ref-filename="mDNS_StopQuery">mDNS_StopQuery</a>(<a class="local col0 ref" href="#390m" title='m' data-ref="390m" data-ref-filename="390m">m</a>, <a class="local col2 ref" href="#392question" title='question' data-ref="392question" data-ref-filename="392question">question</a>);</td></tr>
<tr><th id="3253">3253</th><td>        <i>// Reset the pointers so that we don't call stop on termination</i></td></tr>
<tr><th id="3254">3254</th><td>        <a class="local col2 ref" href="#392question" title='question' data-ref="392question" data-ref-filename="392question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::QuestionContext" title='DNSQuestion_struct::QuestionContext' data-ref="DNSQuestion_struct::QuestionContext" data-ref-filename="DNSQuestion_struct..QuestionContext">QuestionContext</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="3255">3255</th><td>    }</td></tr>
<tr><th id="3256">3256</th><td>    <b>else</b> <b>if</b> ((<a class="local col4 ref" href="#394AddRecord" title='AddRecord' data-ref="394AddRecord" data-ref-filename="394AddRecord">AddRecord</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#QC_add" title='QC_add' data-ref="QC_add" data-ref-filename="QC_add">QC_add</a>) &amp;&amp; <a class="local col1 ref" href="#391req" title='req' data-ref="391req" data-ref-filename="391req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::op" title='(anonymous struct)::op' data-ref="(anonymous)::op" data-ref-filename="(anonymous)..op">op</a> == <a class="enum" href="dnssd_ipc.h.html#addrinfo_request" title='addrinfo_request' data-ref="addrinfo_request" data-ref-filename="addrinfo_request">addrinfo_request</a>)</td></tr>
<tr><th id="3257">3257</th><td>    {</td></tr>
<tr><th id="3258">3258</th><td>        <i>// Note: We count all answers including LocalOnly e.g., /etc/hosts. If we</i></td></tr>
<tr><th id="3259">3259</th><td><i>        // exclude that, v4ans/v6ans will be zero and we would wrongly think that</i></td></tr>
<tr><th id="3260">3260</th><td><i>        // we did not answer questions and setup the status to deliver triggers.</i></td></tr>
<tr><th id="3261">3261</th><td>        <b>if</b> (<a class="local col2 ref" href="#392question" title='question' data-ref="392question" data-ref-filename="392question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSType_A" title='kDNSType_A' data-ref="kDNSType_A" data-ref-filename="kDNSType_A">kDNSType_A</a>)</td></tr>
<tr><th id="3262">3262</th><td>            <a class="local col1 ref" href="#391req" title='req' data-ref="391req" data-ref-filename="391req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::v4ans" title='request_state::(anonymous union)::(anonymous struct)::v4ans' data-ref="request_state::(anonymousunion)::(anonymous)::v4ans" data-ref-filename="request_state..(anonymousunion)..(anonymous)..v4ans">v4ans</a> = <var>1</var>;</td></tr>
<tr><th id="3263">3263</th><td>        <b>if</b> (<a class="local col2 ref" href="#392question" title='question' data-ref="392question" data-ref-filename="392question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSType_AAAA" title='kDNSType_AAAA' data-ref="kDNSType_AAAA" data-ref-filename="kDNSType_AAAA">kDNSType_AAAA</a>)</td></tr>
<tr><th id="3264">3264</th><td>            <a class="local col1 ref" href="#391req" title='req' data-ref="391req" data-ref-filename="391req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::v6ans" title='request_state::(anonymous union)::(anonymous struct)::v6ans' data-ref="request_state::(anonymousunion)::(anonymous)::v6ans" data-ref-filename="request_state..(anonymousunion)..(anonymous)..v6ans">v6ans</a> = <var>1</var>;</td></tr>
<tr><th id="3265">3265</th><td>    }</td></tr>
<tr><th id="3266">3266</th><td>    <b>else</b> <b>if</b> ((<a class="local col4 ref" href="#394AddRecord" title='AddRecord' data-ref="394AddRecord" data-ref-filename="394AddRecord">AddRecord</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#QC_add" title='QC_add' data-ref="QC_add" data-ref-filename="QC_add">QC_add</a>) &amp;&amp; <a class="local col1 ref" href="#391req" title='req' data-ref="391req" data-ref-filename="391req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::op" title='(anonymous struct)::op' data-ref="(anonymous)::op" data-ref-filename="(anonymous)..op">op</a> == <a class="enum" href="dnssd_ipc.h.html#query_request" title='query_request' data-ref="query_request" data-ref-filename="query_request">query_request</a>)</td></tr>
<tr><th id="3267">3267</th><td>    {</td></tr>
<tr><th id="3268">3268</th><td>        <b>if</b> (<a class="local col2 ref" href="#392question" title='question' data-ref="392question" data-ref-filename="392question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSType_A" title='kDNSType_A' data-ref="kDNSType_A" data-ref-filename="kDNSType_A">kDNSType_A</a> || <a class="local col2 ref" href="#392question" title='question' data-ref="392question" data-ref-filename="392question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSType_AAAA" title='kDNSType_AAAA' data-ref="kDNSType_AAAA" data-ref-filename="kDNSType_AAAA">kDNSType_AAAA</a>)</td></tr>
<tr><th id="3269">3269</th><td>            <a class="local col1 ref" href="#391req" title='req' data-ref="391req" data-ref-filename="391req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::ans" title='request_state::(anonymous union)::(anonymous struct)::ans' data-ref="request_state::(anonymousunion)::(anonymous)::ans" data-ref-filename="request_state..(anonymousunion)..(anonymous)..ans">ans</a> = <var>1</var>;</td></tr>
<tr><th id="3270">3270</th><td>    }</td></tr>
<tr><th id="3271">3271</th><td></td></tr>
<tr><th id="3272">3272</th><td><u>#<span data-ppcond="3272">if</span> APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="3273">3273</th><td><u>#if !NO_WCF</u></td></tr>
<tr><th id="3274">3274</th><td>    CHECK_WCF_FUNCTION(WCFIsServerRunning)</td></tr>
<tr><th id="3275">3275</th><td>    {</td></tr>
<tr><th id="3276">3276</th><td>        <b>struct</b> xucred x;</td></tr>
<tr><th id="3277">3277</th><td>        socklen_t xucredlen = <b>sizeof</b>(x);</td></tr>
<tr><th id="3278">3278</th><td></td></tr>
<tr><th id="3279">3279</th><td>        <b>if</b> (WCFIsServerRunning((WCFConnection *)m-&gt;WCF) &amp;&amp; answer-&gt;rdlength != <var>0</var>)</td></tr>
<tr><th id="3280">3280</th><td>        {</td></tr>
<tr><th id="3281">3281</th><td>            <b>if</b> (getsockopt(req-&gt;sd, <var>0</var>, LOCAL_PEERCRED, &amp;x, &amp;xucredlen) &gt;= <var>0</var> &amp;&amp;</td></tr>
<tr><th id="3282">3282</th><td>                (x.cr_version == XUCRED_VERSION))</td></tr>
<tr><th id="3283">3283</th><td>            {</td></tr>
<tr><th id="3284">3284</th><td>                <b>struct</b> sockaddr_storage addr;</td></tr>
<tr><th id="3285">3285</th><td>                addr.ss_len = <var>0</var>;</td></tr>
<tr><th id="3286">3286</th><td>                <b>if</b> (answer-&gt;rrtype == kDNSType_A || answer-&gt;rrtype == kDNSType_AAAA)</td></tr>
<tr><th id="3287">3287</th><td>                {</td></tr>
<tr><th id="3288">3288</th><td>                    <b>if</b> (answer-&gt;rrtype == kDNSType_A)</td></tr>
<tr><th id="3289">3289</th><td>                    {</td></tr>
<tr><th id="3290">3290</th><td>                        <b>struct</b> sockaddr_in *<em>const</em> sin = (<b>struct</b> sockaddr_in *)&amp;addr;</td></tr>
<tr><th id="3291">3291</th><td>                        sin-&gt;sin_port = <var>0</var>;</td></tr>
<tr><th id="3292">3292</th><td>                        <i>// Instead of this stupid call to putRData it would be much simpler to just assign the value in the sensible way, like this:</i></td></tr>
<tr><th id="3293">3293</th><td><i>                        // sin-&gt;sin_addr.s_addr = answer-&gt;rdata-&gt;u.ipv4.NotAnInteger;</i></td></tr>
<tr><th id="3294">3294</th><td>                        <b>if</b> (!putRData(mDNSNULL, (mDNSu8 *)&amp;sin-&gt;sin_addr, (mDNSu8 *)(&amp;sin-&gt;sin_addr + <b>sizeof</b>(mDNSv4Addr)), answer))</td></tr>
<tr><th id="3295">3295</th><td>                            LogMsg(<q>"queryrecord_result_reply: WCF AF_INET putRData failed"</q>);</td></tr>
<tr><th id="3296">3296</th><td>                        <b>else</b></td></tr>
<tr><th id="3297">3297</th><td>                        {</td></tr>
<tr><th id="3298">3298</th><td>                            addr.ss_len = <b>sizeof</b> (<b>struct</b> sockaddr_in);</td></tr>
<tr><th id="3299">3299</th><td>                            addr.ss_family = AF_INET;</td></tr>
<tr><th id="3300">3300</th><td>                        }</td></tr>
<tr><th id="3301">3301</th><td>                    }</td></tr>
<tr><th id="3302">3302</th><td>                    <b>else</b> <b>if</b> (answer-&gt;rrtype == kDNSType_AAAA)</td></tr>
<tr><th id="3303">3303</th><td>                    {</td></tr>
<tr><th id="3304">3304</th><td>                        <b>struct</b> sockaddr_in6 *<em>const</em> sin6 = (<b>struct</b> sockaddr_in6 *)&amp;addr;</td></tr>
<tr><th id="3305">3305</th><td>                        sin6-&gt;sin6_port = <var>0</var>;</td></tr>
<tr><th id="3306">3306</th><td>                        <i>// Instead of this stupid call to putRData it would be much simpler to just assign the value in the sensible way, like this:</i></td></tr>
<tr><th id="3307">3307</th><td><i>                        // sin6-&gt;sin6_addr.__u6_addr.__u6_addr32[0] = answer-&gt;rdata-&gt;u.ipv6.l[0];</i></td></tr>
<tr><th id="3308">3308</th><td><i>                        // sin6-&gt;sin6_addr.__u6_addr.__u6_addr32[1] = answer-&gt;rdata-&gt;u.ipv6.l[1];</i></td></tr>
<tr><th id="3309">3309</th><td><i>                        // sin6-&gt;sin6_addr.__u6_addr.__u6_addr32[2] = answer-&gt;rdata-&gt;u.ipv6.l[2];</i></td></tr>
<tr><th id="3310">3310</th><td><i>                        // sin6-&gt;sin6_addr.__u6_addr.__u6_addr32[3] = answer-&gt;rdata-&gt;u.ipv6.l[3];</i></td></tr>
<tr><th id="3311">3311</th><td>                        <b>if</b> (!putRData(mDNSNULL, (mDNSu8 *)&amp;sin6-&gt;sin6_addr, (mDNSu8 *)(&amp;sin6-&gt;sin6_addr + <b>sizeof</b>(mDNSv6Addr)), answer))</td></tr>
<tr><th id="3312">3312</th><td>                            LogMsg(<q>"queryrecord_result_reply: WCF AF_INET6 putRData failed"</q>);</td></tr>
<tr><th id="3313">3313</th><td>                        <b>else</b></td></tr>
<tr><th id="3314">3314</th><td>                        {</td></tr>
<tr><th id="3315">3315</th><td>                            addr.ss_len = <b>sizeof</b> (<b>struct</b> sockaddr_in6);</td></tr>
<tr><th id="3316">3316</th><td>                            addr.ss_family = AF_INET6;</td></tr>
<tr><th id="3317">3317</th><td>                        }</td></tr>
<tr><th id="3318">3318</th><td>                    }</td></tr>
<tr><th id="3319">3319</th><td>                    <b>if</b> (addr.ss_len)</td></tr>
<tr><th id="3320">3320</th><td>                    {</td></tr>
<tr><th id="3321">3321</th><td>                        debugf(<q>"queryrecord_result_reply: Name %s, uid %u, addr length %d"</q>, name, x.cr_uid, addr.ss_len);</td></tr>
<tr><th id="3322">3322</th><td>                        CHECK_WCF_FUNCTION((WCFConnection *)WCFNameResolvesToAddr)</td></tr>
<tr><th id="3323">3323</th><td>                        {</td></tr>
<tr><th id="3324">3324</th><td>                            WCFNameResolvesToAddr(m-&gt;WCF, name, (<b>struct</b> sockaddr *)&amp;addr, x.cr_uid);</td></tr>
<tr><th id="3325">3325</th><td>                        }</td></tr>
<tr><th id="3326">3326</th><td>                    }</td></tr>
<tr><th id="3327">3327</th><td>                }</td></tr>
<tr><th id="3328">3328</th><td>                <b>else</b> <b>if</b> (answer-&gt;rrtype == kDNSType_CNAME)</td></tr>
<tr><th id="3329">3329</th><td>                {</td></tr>
<tr><th id="3330">3330</th><td>                    domainname cname;</td></tr>
<tr><th id="3331">3331</th><td>                    <em>char</em> cname_cstr[MAX_ESCAPED_DOMAIN_NAME];</td></tr>
<tr><th id="3332">3332</th><td>                    <b>if</b> (!putRData(mDNSNULL, cname.c, (mDNSu8 *)(cname.c + MAX_DOMAIN_NAME), answer))</td></tr>
<tr><th id="3333">3333</th><td>                        LogMsg(<q>"queryrecord_result_reply: WCF CNAME putRData failed"</q>);</td></tr>
<tr><th id="3334">3334</th><td>                    <b>else</b></td></tr>
<tr><th id="3335">3335</th><td>                    {</td></tr>
<tr><th id="3336">3336</th><td>                        ConvertDomainNameToCString(&amp;cname, cname_cstr);</td></tr>
<tr><th id="3337">3337</th><td>                        CHECK_WCF_FUNCTION((WCFConnection *)WCFNameResolvesToAddr)</td></tr>
<tr><th id="3338">3338</th><td>                        {</td></tr>
<tr><th id="3339">3339</th><td>                            WCFNameResolvesToName(m-&gt;WCF, name, cname_cstr, x.cr_uid);</td></tr>
<tr><th id="3340">3340</th><td>                        }</td></tr>
<tr><th id="3341">3341</th><td>                    }</td></tr>
<tr><th id="3342">3342</th><td>                }</td></tr>
<tr><th id="3343">3343</th><td>            }</td></tr>
<tr><th id="3344">3344</th><td>            <b>else</b> my_perror(<q>"queryrecord_result_reply: ERROR: getsockopt LOCAL_PEERCRED"</q>);</td></tr>
<tr><th id="3345">3345</th><td>        }</td></tr>
<tr><th id="3346">3346</th><td>    }</td></tr>
<tr><th id="3347">3347</th><td><u>#endif</u></td></tr>
<tr><th id="3348">3348</th><td><u>#<span data-ppcond="3272">endif</span></u></td></tr>
<tr><th id="3349">3349</th><td>}</td></tr>
<tr><th id="3350">3350</th><td></td></tr>
<tr><th id="3351">3351</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="queryrecord_result_callback" title='queryrecord_result_callback' data-ref="queryrecord_result_callback" data-ref-filename="queryrecord_result_callback">queryrecord_result_callback</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS" title='mDNS' data-type='struct mDNS_struct' data-ref="mDNS" data-ref-filename="mDNS">mDNS</a> *<em>const</em> <dfn class="local col1 decl" id="401m" title='m' data-type='mDNS *const' data-ref="401m" data-ref-filename="401m">m</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion" title='DNSQuestion' data-type='struct DNSQuestion_struct' data-ref="DNSQuestion" data-ref-filename="DNSQuestion">DNSQuestion</a> *<dfn class="local col2 decl" id="402question" title='question' data-type='DNSQuestion *' data-ref="402question" data-ref-filename="402question">question</dfn>, <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord" title='ResourceRecord' data-type='struct ResourceRecord_struct' data-ref="ResourceRecord" data-ref-filename="ResourceRecord">ResourceRecord</a> *<em>const</em> <dfn class="local col3 decl" id="403answer" title='answer' data-type='const ResourceRecord *const' data-ref="403answer" data-ref-filename="403answer">answer</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#QC_result" title='QC_result' data-type='enum QC_result' data-ref="QC_result" data-ref-filename="QC_result">QC_result</a> <dfn class="local col4 decl" id="404AddRecord" title='AddRecord' data-type='QC_result' data-ref="404AddRecord" data-ref-filename="404AddRecord">AddRecord</dfn>)</td></tr>
<tr><th id="3352">3352</th><td>{</td></tr>
<tr><th id="3353">3353</th><td>    <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col5 decl" id="405req" title='req' data-type='request_state *' data-ref="405req" data-ref-filename="405req">req</dfn> = <a class="local col2 ref" href="#402question" title='question' data-ref="402question" data-ref-filename="402question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::QuestionContext" title='DNSQuestion_struct::QuestionContext' data-ref="DNSQuestion_struct::QuestionContext" data-ref-filename="DNSQuestion_struct..QuestionContext">QuestionContext</a>;</td></tr>
<tr><th id="3354">3354</th><td>    <a class="typedef" href="dns_sd.h.html#DNSServiceErrorType" title='DNSServiceErrorType' data-type='int32_t' data-ref="DNSServiceErrorType" data-ref-filename="DNSServiceErrorType">DNSServiceErrorType</a> <dfn class="local col6 decl" id="406error" title='error' data-type='DNSServiceErrorType' data-ref="406error" data-ref-filename="406error">error</dfn> = <a class="enum" href="dns_sd.h.html#kDNSServiceErr_NoError" title='kDNSServiceErr_NoError' data-ref="kDNSServiceErr_NoError" data-ref-filename="kDNSServiceErr_NoError">kDNSServiceErr_NoError</a>;</td></tr>
<tr><th id="3355">3355</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion" title='DNSQuestion' data-type='struct DNSQuestion_struct' data-ref="DNSQuestion" data-ref-filename="DNSQuestion">DNSQuestion</a> *<dfn class="local col7 decl" id="407q" title='q' data-type='DNSQuestion *' data-ref="407q" data-ref-filename="407q">q</dfn> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="3356">3356</th><td></td></tr>
<tr><th id="3357">3357</th><td><u>#<span data-ppcond="3357">if</span> APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="3358">3358</th><td>    {</td></tr>
<tr><th id="3359">3359</th><td>        <i>// Sanity check: QuestionContext is set to NULL after we stop the question and hence we should not</i></td></tr>
<tr><th id="3360">3360</th><td><i>        // get any callbacks from the core after this.</i></td></tr>
<tr><th id="3361">3361</th><td>        <b>if</b> (!req)</td></tr>
<tr><th id="3362">3362</th><td>        {</td></tr>
<tr><th id="3363">3363</th><td>            LogMsg(<q>"queryrecord_result_callback: ERROR!! QuestionContext NULL for %##s (%s)"</q>, question-&gt;qname.c, DNSTypeName(question-&gt;qtype));</td></tr>
<tr><th id="3364">3364</th><td>            <b>return</b>;</td></tr>
<tr><th id="3365">3365</th><td>        }</td></tr>
<tr><th id="3366">3366</th><td>        <b>if</b> (req-&gt;hdr.op == query_request &amp;&amp; question == req-&gt;u.queryrecord.q2)</td></tr>
<tr><th id="3367">3367</th><td>            q = &amp;req-&gt;u.queryrecord.q;</td></tr>
<tr><th id="3368">3368</th><td>        <b>else</b> <b>if</b> (req-&gt;hdr.op == addrinfo_request &amp;&amp; question == req-&gt;u.addrinfo.q42)</td></tr>
<tr><th id="3369">3369</th><td>            q = &amp;req-&gt;u.addrinfo.q4;</td></tr>
<tr><th id="3370">3370</th><td>        <b>else</b> <b>if</b> (req-&gt;hdr.op == addrinfo_request &amp;&amp; question == req-&gt;u.addrinfo.q62)</td></tr>
<tr><th id="3371">3371</th><td>            q = &amp;req-&gt;u.addrinfo.q6;</td></tr>
<tr><th id="3372">3372</th><td></td></tr>
<tr><th id="3373">3373</th><td>        <b>if</b> (q &amp;&amp; question-&gt;qtype != q-&gt;qtype &amp;&amp; !SameDomainName(&amp;question-&gt;qname, &amp;q-&gt;qname))</td></tr>
<tr><th id="3374">3374</th><td>        {</td></tr>
<tr><th id="3375">3375</th><td>            mStatus err;</td></tr>
<tr><th id="3376">3376</th><td>            domainname *orig = question-&gt;qnameOrig;</td></tr>
<tr><th id="3377">3377</th><td></td></tr>
<tr><th id="3378">3378</th><td>            LogInfo(<q>"queryrecord_result_callback: Stopping q2 local %##s"</q>, question-&gt;qname.c);</td></tr>
<tr><th id="3379">3379</th><td>            mDNS_StopQuery(m, question);</td></tr>
<tr><th id="3380">3380</th><td>            question-&gt;QuestionContext = mDNSNULL;</td></tr>
<tr><th id="3381">3381</th><td></td></tr>
<tr><th id="3382">3382</th><td>            <i>// We got a negative response for the SOA record indicating that .local does not exist.</i></td></tr>
<tr><th id="3383">3383</th><td><i>            // But we might have other search domains (that does not end in .local) that can be</i></td></tr>
<tr><th id="3384">3384</th><td><i>            // appended to this question. In that case, we want to retry the question. Otherwise,</i></td></tr>
<tr><th id="3385">3385</th><td><i>            // we don't want to try this question as unicast.</i></td></tr>
<tr><th id="3386">3386</th><td>            <b>if</b> (answer-&gt;RecordType == kDNSRecordTypePacketNegative &amp;&amp; !q-&gt;AppendSearchDomains)</td></tr>
<tr><th id="3387">3387</th><td>            {</td></tr>
<tr><th id="3388">3388</th><td>                LogInfo(<q>"queryrecord_result_callback: question %##s AppendSearchDomains zero"</q>, q-&gt;qname.c);</td></tr>
<tr><th id="3389">3389</th><td>                <b>return</b>;</td></tr>
<tr><th id="3390">3390</th><td>            }</td></tr>
<tr><th id="3391">3391</th><td></td></tr>
<tr><th id="3392">3392</th><td>            <i>// If we got a non-negative answer for our "local SOA" test query, start an additional parallel unicast query</i></td></tr>
<tr><th id="3393">3393</th><td><i>            //</i></td></tr>
<tr><th id="3394">3394</th><td><i>            // Note: When we copy the original question, we copy everything including the AppendSearchDomains,</i></td></tr>
<tr><th id="3395">3395</th><td><i>            // RetryWithSearchDomains except for qnameOrig which can be non-NULL if the original question is</i></td></tr>
<tr><th id="3396">3396</th><td><i>            // e.g., somehost and then we appended e.g., ".local" and retried that question. See comment in</i></td></tr>
<tr><th id="3397">3397</th><td><i>            // SendAdditionalQuery as to how qnameOrig gets initialized.</i></td></tr>
<tr><th id="3398">3398</th><td>            *question              = *q;</td></tr>
<tr><th id="3399">3399</th><td>            question-&gt;InterfaceID  = mDNSInterface_Unicast;</td></tr>
<tr><th id="3400">3400</th><td>            question-&gt;ExpectUnique = mDNStrue;</td></tr>
<tr><th id="3401">3401</th><td>            question-&gt;qnameOrig    = orig;</td></tr>
<tr><th id="3402">3402</th><td></td></tr>
<tr><th id="3403">3403</th><td>            LogOperation(<q>"%3d: DNSServiceQueryRecord(%##s, %s) unicast, context %p"</q>, req-&gt;sd, question-&gt;qname.c, DNSTypeName(question-&gt;qtype), question-&gt;QuestionContext);</td></tr>
<tr><th id="3404">3404</th><td></td></tr>
<tr><th id="3405">3405</th><td>            <i>// If the original question timed out, its QuestionContext would already be set to NULL and that's what we copied above.</i></td></tr>
<tr><th id="3406">3406</th><td><i>            // Hence, we need to set it explicitly here.</i></td></tr>
<tr><th id="3407">3407</th><td>            question-&gt;QuestionContext = req;</td></tr>
<tr><th id="3408">3408</th><td>            err = mDNS_StartQuery(m, question);</td></tr>
<tr><th id="3409">3409</th><td>            <b>if</b> (err) LogMsg(<q>"%3d: ERROR: queryrecord_result_callback %##s %s mDNS_StartQuery: %d"</q>, req-&gt;sd, question-&gt;qname.c, DNSTypeName(question-&gt;qtype), (<em>int</em>)err);</td></tr>
<tr><th id="3410">3410</th><td></td></tr>
<tr><th id="3411">3411</th><td>            <i>// If we got a positive response to local SOA, then try the .local question as unicast</i></td></tr>
<tr><th id="3412">3412</th><td>            <b>if</b> (answer-&gt;RecordType != kDNSRecordTypePacketNegative) <b>return</b>;</td></tr>
<tr><th id="3413">3413</th><td></td></tr>
<tr><th id="3414">3414</th><td>            <i>// Fall through and get the next search domain. The question is pointing at .local</i></td></tr>
<tr><th id="3415">3415</th><td><i>            // and we don't want to try that. Try the next search domain. Don't try with local</i></td></tr>
<tr><th id="3416">3416</th><td><i>            // search domains for the unicast question anymore.</i></td></tr>
<tr><th id="3417">3417</th><td><i>            //</i></td></tr>
<tr><th id="3418">3418</th><td><i>            // Note: we started the question above which will be stopped immediately (never sent on the wire)</i></td></tr>
<tr><th id="3419">3419</th><td><i>            // before we pick the next search domain below. RetryQuestionWithSearchDomains assumes that the</i></td></tr>
<tr><th id="3420">3420</th><td><i>            // question has already started.</i></td></tr>
<tr><th id="3421">3421</th><td>            question-&gt;AppendLocalSearchDomains = <var>0</var>;</td></tr>
<tr><th id="3422">3422</th><td>        }</td></tr>
<tr><th id="3423">3423</th><td></td></tr>
<tr><th id="3424">3424</th><td>        <b>if</b> (q &amp;&amp; AddRecord &amp;&amp; AddRecord != QC_dnssec &amp;&amp; (question-&gt;InterfaceID == mDNSInterface_Unicast) &amp;&amp; !answer-&gt;rdlength)</td></tr>
<tr><th id="3425">3425</th><td>        {</td></tr>
<tr><th id="3426">3426</th><td>            <i>// If we get a negative response to the unicast query that we sent above, retry after appending search domains</i></td></tr>
<tr><th id="3427">3427</th><td><i>            // Note: We could have appended search domains below (where do it for regular unicast questions) instead of doing it here.</i></td></tr>
<tr><th id="3428">3428</th><td><i>            // As we ignore negative unicast answers below, we would never reach the code where the search domains are appended.</i></td></tr>
<tr><th id="3429">3429</th><td><i>            // To keep things simple, we handle unicast ".local" separately here.</i></td></tr>
<tr><th id="3430">3430</th><td>            LogInfo(<q>"queryrecord_result_callback: Retrying .local question %##s (%s) as unicast after appending search domains"</q>, question-&gt;qname.c, DNSTypeName(question-&gt;qtype));</td></tr>
<tr><th id="3431">3431</th><td>            <b>if</b> (RetryQuestionWithSearchDomains(question, req, AddRecord))</td></tr>
<tr><th id="3432">3432</th><td>                <b>return</b>;</td></tr>
<tr><th id="3433">3433</th><td>            <b>if</b> (question-&gt;AppendSearchDomains &amp;&amp; !question-&gt;AppendLocalSearchDomains &amp;&amp; IsLocalDomain(&amp;question-&gt;qname))</td></tr>
<tr><th id="3434">3434</th><td>            {</td></tr>
<tr><th id="3435">3435</th><td>                <i>// If "local" is the last search domain, we need to stop the question so that we don't send the "local"</i></td></tr>
<tr><th id="3436">3436</th><td><i>                // question on the wire as we got a negative response for the local SOA. But, we can't stop the question</i></td></tr>
<tr><th id="3437">3437</th><td><i>                // yet as we may have to timeout the question (done by the "core") for which we need to leave the question</i></td></tr>
<tr><th id="3438">3438</th><td><i>                // in the list. We leave it disabled so that it does not hit the wire.</i></td></tr>
<tr><th id="3439">3439</th><td>                LogInfo(<q>"queryrecord_result_callback: Disabling .local question %##s (%s)"</q>, question-&gt;qname.c, DNSTypeName(question-&gt;qtype));</td></tr>
<tr><th id="3440">3440</th><td>                question-&gt;ThisQInterval = <var>0</var>;</td></tr>
<tr><th id="3441">3441</th><td>            }</td></tr>
<tr><th id="3442">3442</th><td>        }</td></tr>
<tr><th id="3443">3443</th><td>        <i>// If we are here it means that either "question" is not "q2" OR we got a positive response for "q2" OR we have no more search</i></td></tr>
<tr><th id="3444">3444</th><td><i>        // domains to append for "q2". In all cases, fall through and deliver the response</i></td></tr>
<tr><th id="3445">3445</th><td>    }</td></tr>
<tr><th id="3446">3446</th><td><u>#<span data-ppcond="3357">endif</span> // APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="3447">3447</th><td></td></tr>
<tr><th id="3448">3448</th><td>    <i>// If a query is being suppressed for some reason, we don't have to do any other</i></td></tr>
<tr><th id="3449">3449</th><td><i>    // processing.</i></td></tr>
<tr><th id="3450">3450</th><td><i>    //</i></td></tr>
<tr><th id="3451">3451</th><td><i>    // Note: We don't check for "SuppressQuery" and instead use QC_suppressed because</i></td></tr>
<tr><th id="3452">3452</th><td><i>    // the "core" needs to temporarily turn off SuppressQuery to answer this query.</i></td></tr>
<tr><th id="3453">3453</th><td>    <b>if</b> (<a class="local col4 ref" href="#404AddRecord" title='AddRecord' data-ref="404AddRecord" data-ref-filename="404AddRecord">AddRecord</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#QC_suppressed" title='QC_suppressed' data-ref="QC_suppressed" data-ref-filename="QC_suppressed">QC_suppressed</a>)</td></tr>
<tr><th id="3454">3454</th><td>    {</td></tr>
<tr><th id="3455">3455</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;queryrecord_result_callback: Suppressed question %##s (%s)&quot;, question-&gt;qname.c, DNSTypeName(question-&gt;qtype));} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"queryrecord_result_callback: Suppressed question %##s (%s)"</q>, <a class="local col2 ref" href="#402question" title='question' data-ref="402question" data-ref-filename="402question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col2 ref" href="#402question" title='question' data-ref="402question" data-ref-filename="402question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a>));</td></tr>
<tr><th id="3456">3456</th><td>        <a class="ref fn" href="#queryrecord_result_reply" title='queryrecord_result_reply' data-ref="queryrecord_result_reply" data-ref-filename="queryrecord_result_reply">queryrecord_result_reply</a>(<a class="local col1 ref" href="#401m" title='m' data-ref="401m" data-ref-filename="401m">m</a>, <a class="local col5 ref" href="#405req" title='req' data-ref="405req" data-ref-filename="405req">req</a>, <a class="local col2 ref" href="#402question" title='question' data-ref="402question" data-ref-filename="402question">question</a>, <a class="local col3 ref" href="#403answer" title='answer' data-ref="403answer" data-ref-filename="403answer">answer</a>, <a class="local col4 ref" href="#404AddRecord" title='AddRecord' data-ref="404AddRecord" data-ref-filename="404AddRecord">AddRecord</a>, <a class="enum" href="dns_sd.h.html#kDNSServiceErr_NoSuchRecord" title='kDNSServiceErr_NoSuchRecord' data-ref="kDNSServiceErr_NoSuchRecord" data-ref-filename="kDNSServiceErr_NoSuchRecord">kDNSServiceErr_NoSuchRecord</a>);</td></tr>
<tr><th id="3457">3457</th><td>        <b>return</b>;</td></tr>
<tr><th id="3458">3458</th><td>    }</td></tr>
<tr><th id="3459">3459</th><td></td></tr>
<tr><th id="3460">3460</th><td>    <b>if</b> (<a class="local col3 ref" href="#403answer" title='answer' data-ref="403answer" data-ref-filename="403answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::RecordType" title='ResourceRecord_struct::RecordType' data-ref="ResourceRecord_struct::RecordType" data-ref-filename="ResourceRecord_struct..RecordType">RecordType</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSRecordTypePacketNegative" title='kDNSRecordTypePacketNegative' data-ref="kDNSRecordTypePacketNegative" data-ref-filename="kDNSRecordTypePacketNegative">kDNSRecordTypePacketNegative</a>)</td></tr>
<tr><th id="3461">3461</th><td>    {</td></tr>
<tr><th id="3462">3462</th><td>        <i>// If this question needs to be timed out and we have reached the stop time, mark</i></td></tr>
<tr><th id="3463">3463</th><td><i>        // the error as timeout. It is possible that we might get a negative response from an</i></td></tr>
<tr><th id="3464">3464</th><td><i>        // external DNS server at the same time when this question reaches its stop time. We</i></td></tr>
<tr><th id="3465">3465</th><td><i>        // can't tell the difference as there is no indication in the callback. This should</i></td></tr>
<tr><th id="3466">3466</th><td><i>        // be okay as we will be timing out this query anyway.</i></td></tr>
<tr><th id="3467">3467</th><td>        <a class="macro" href="../mDNSCore/DNSCommon.h.html#298" title="mDNS_Lock_((m), __func__, 3467)" data-ref="_M/mDNS_Lock">mDNS_Lock</a>(<a class="local col1 ref" href="#401m" title='m' data-ref="401m" data-ref-filename="401m">m</a>);</td></tr>
<tr><th id="3468">3468</th><td>        <b>if</b> (<a class="local col2 ref" href="#402question" title='question' data-ref="402question" data-ref-filename="402question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::TimeoutQuestion" title='DNSQuestion_struct::TimeoutQuestion' data-ref="DNSQuestion_struct::TimeoutQuestion" data-ref-filename="DNSQuestion_struct..TimeoutQuestion">TimeoutQuestion</a>)</td></tr>
<tr><th id="3469">3469</th><td>        {</td></tr>
<tr><th id="3470">3470</th><td>            <b>if</b> ((<a class="local col1 ref" href="#401m" title='m' data-ref="401m" data-ref-filename="401m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::timenow" title='mDNS_struct::timenow' data-ref="mDNS_struct::timenow" data-ref-filename="mDNS_struct..timenow">timenow</a> - <a class="local col2 ref" href="#402question" title='question' data-ref="402question" data-ref-filename="402question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::StopTime" title='DNSQuestion_struct::StopTime' data-ref="DNSQuestion_struct::StopTime" data-ref-filename="DNSQuestion_struct..StopTime">StopTime</a>) &gt;= <var>0</var>)</td></tr>
<tr><th id="3471">3471</th><td>            {</td></tr>
<tr><th id="3472">3472</th><td>                <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;queryrecord_result_callback:Question %##s (%s) timing out, InterfaceID %p&quot;, question-&gt;qname.c, DNSTypeName(question-&gt;qtype), question-&gt;InterfaceID);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"queryrecord_result_callback:Question %##s (%s) timing out, InterfaceID %p"</q>, <a class="local col2 ref" href="#402question" title='question' data-ref="402question" data-ref-filename="402question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col2 ref" href="#402question" title='question' data-ref="402question" data-ref-filename="402question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a>), <a class="local col2 ref" href="#402question" title='question' data-ref="402question" data-ref-filename="402question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::InterfaceID" title='DNSQuestion_struct::InterfaceID' data-ref="DNSQuestion_struct::InterfaceID" data-ref-filename="DNSQuestion_struct..InterfaceID">InterfaceID</a>);</td></tr>
<tr><th id="3473">3473</th><td>                <a class="local col6 ref" href="#406error" title='error' data-ref="406error" data-ref-filename="406error">error</a> = <a class="enum" href="dns_sd.h.html#kDNSServiceErr_Timeout" title='kDNSServiceErr_Timeout' data-ref="kDNSServiceErr_Timeout" data-ref-filename="kDNSServiceErr_Timeout">kDNSServiceErr_Timeout</a>;</td></tr>
<tr><th id="3474">3474</th><td>            }</td></tr>
<tr><th id="3475">3475</th><td>        }</td></tr>
<tr><th id="3476">3476</th><td>        <a class="macro" href="../mDNSCore/DNSCommon.h.html#300" title="mDNS_Unlock_((m), __func__, 3476)" data-ref="_M/mDNS_Unlock">mDNS_Unlock</a>(<a class="local col1 ref" href="#401m" title='m' data-ref="401m" data-ref-filename="401m">m</a>);</td></tr>
<tr><th id="3477">3477</th><td>        <i>// When we're doing parallel unicast and multicast queries for dot-local names (for supporting Microsoft</i></td></tr>
<tr><th id="3478">3478</th><td><i>        // Active Directory sites) we need to ignore negative unicast answers. Otherwise we'll generate negative</i></td></tr>
<tr><th id="3479">3479</th><td><i>        // answers for just about every single multicast name we ever look up, since the Microsoft Active Directory</i></td></tr>
<tr><th id="3480">3480</th><td><i>        // server is going to assert that pretty much every single multicast name doesn't exist.</i></td></tr>
<tr><th id="3481">3481</th><td><i>        //</i></td></tr>
<tr><th id="3482">3482</th><td><i>        // If we are timing out this query, we need to deliver the negative answer to the application</i></td></tr>
<tr><th id="3483">3483</th><td>        <b>if</b> (<a class="local col6 ref" href="#406error" title='error' data-ref="406error" data-ref-filename="406error">error</a> != <a class="enum" href="dns_sd.h.html#kDNSServiceErr_Timeout" title='kDNSServiceErr_Timeout' data-ref="kDNSServiceErr_Timeout" data-ref-filename="kDNSServiceErr_Timeout">kDNSServiceErr_Timeout</a>)</td></tr>
<tr><th id="3484">3484</th><td>        {</td></tr>
<tr><th id="3485">3485</th><td>            <b>if</b> (!<a class="local col3 ref" href="#403answer" title='answer' data-ref="403answer" data-ref-filename="403answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::InterfaceID" title='ResourceRecord_struct::InterfaceID' data-ref="ResourceRecord_struct::InterfaceID" data-ref-filename="ResourceRecord_struct..InterfaceID">InterfaceID</a> &amp;&amp; <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#IsLocalDomain" title='IsLocalDomain' data-ref="IsLocalDomain" data-ref-filename="IsLocalDomain">IsLocalDomain</a>(<a class="local col3 ref" href="#403answer" title='answer' data-ref="403answer" data-ref-filename="403answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::name" title='ResourceRecord_struct::name' data-ref="ResourceRecord_struct::name" data-ref-filename="ResourceRecord_struct..name">name</a>))</td></tr>
<tr><th id="3486">3486</th><td>            {</td></tr>
<tr><th id="3487">3487</th><td>                <i>// Sanity check: "q" will be set only if "question" is the .local unicast query.</i></td></tr>
<tr><th id="3488">3488</th><td>                <b>if</b> (!<a class="local col7 ref" href="#407q" title='q' data-ref="407q" data-ref-filename="407q">q</a>)</td></tr>
<tr><th id="3489">3489</th><td>                {</td></tr>
<tr><th id="3490">3490</th><td>                    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;queryrecord_result_callback: ERROR!! answering multicast question %s with unicast cache record&quot;, GetRRDisplayString_rdb(answer, &amp;(answer)-&gt;rdata-&gt;u, (m)-&gt;MsgBuffer))" data-ref="_M/LogMsg">LogMsg</a>(<q>"queryrecord_result_callback: ERROR!! answering multicast question %s with unicast cache record"</q>,</td></tr>
<tr><th id="3491">3491</th><td>                        <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2941" title="GetRRDisplayString_rdb(answer, &amp;(answer)-&gt;rdata-&gt;u, (m)-&gt;MsgBuffer)" data-ref="_M/RRDisplayString">RRDisplayString</a>(<a class="local col1 ref" href="#401m" title='m' data-ref="401m" data-ref-filename="401m">m</a>, <a class="local col3 ref" href="#403answer" title='answer' data-ref="403answer" data-ref-filename="403answer">answer</a>));</td></tr>
<tr><th id="3492">3492</th><td>                    <b>return</b>;</td></tr>
<tr><th id="3493">3493</th><td>                }</td></tr>
<tr><th id="3494">3494</th><td><u>#<span data-ppcond="3494">if</span> APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="3495">3495</th><td>                <b>if</b> (!ShouldDeliverNegativeResponse(question))</td></tr>
<tr><th id="3496">3496</th><td>                {</td></tr>
<tr><th id="3497">3497</th><td>                    <b>return</b>;</td></tr>
<tr><th id="3498">3498</th><td>                }</td></tr>
<tr><th id="3499">3499</th><td><u>#<span data-ppcond="3494">endif</span>  // APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="3500">3500</th><td>                <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;queryrecord_result_callback:Question %##s (%s) answering local with negative unicast response&quot;, question-&gt;qname.c, DNSTypeName(question-&gt;qtype));} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"queryrecord_result_callback:Question %##s (%s) answering local with negative unicast response"</q>, <a class="local col2 ref" href="#402question" title='question' data-ref="402question" data-ref-filename="402question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>,</td></tr>
<tr><th id="3501">3501</th><td>                    <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col2 ref" href="#402question" title='question' data-ref="402question" data-ref-filename="402question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a>));</td></tr>
<tr><th id="3502">3502</th><td>            }</td></tr>
<tr><th id="3503">3503</th><td>            <a class="local col6 ref" href="#406error" title='error' data-ref="406error" data-ref-filename="406error">error</a> = <a class="enum" href="dns_sd.h.html#kDNSServiceErr_NoSuchRecord" title='kDNSServiceErr_NoSuchRecord' data-ref="kDNSServiceErr_NoSuchRecord" data-ref-filename="kDNSServiceErr_NoSuchRecord">kDNSServiceErr_NoSuchRecord</a>;</td></tr>
<tr><th id="3504">3504</th><td>        }</td></tr>
<tr><th id="3505">3505</th><td>    }</td></tr>
<tr><th id="3506">3506</th><td>    <i>// If we get a negative answer, try appending search domains. Don't append search domains</i></td></tr>
<tr><th id="3507">3507</th><td><i>    // - if we are timing out this question</i></td></tr>
<tr><th id="3508">3508</th><td><i>    // - if the negative response was received as a result of a multicast query</i></td></tr>
<tr><th id="3509">3509</th><td><i>    // - if this is an additional query (q2), we already appended search domains above (indicated by "!q" below)</i></td></tr>
<tr><th id="3510">3510</th><td><i>    // - if this response is forced e.g., dnssec validation result</i></td></tr>
<tr><th id="3511">3511</th><td>    <b>if</b> (<a class="local col6 ref" href="#406error" title='error' data-ref="406error" data-ref-filename="406error">error</a> != <a class="enum" href="dns_sd.h.html#kDNSServiceErr_Timeout" title='kDNSServiceErr_Timeout' data-ref="kDNSServiceErr_Timeout" data-ref-filename="kDNSServiceErr_Timeout">kDNSServiceErr_Timeout</a>)</td></tr>
<tr><th id="3512">3512</th><td>    {</td></tr>
<tr><th id="3513">3513</th><td>        <b>if</b> (!<a class="local col7 ref" href="#407q" title='q' data-ref="407q" data-ref-filename="407q">q</a> &amp;&amp; !<a class="local col3 ref" href="#403answer" title='answer' data-ref="403answer" data-ref-filename="403answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::InterfaceID" title='ResourceRecord_struct::InterfaceID' data-ref="ResourceRecord_struct::InterfaceID" data-ref-filename="ResourceRecord_struct..InterfaceID">InterfaceID</a> &amp;&amp; !<a class="local col3 ref" href="#403answer" title='answer' data-ref="403answer" data-ref-filename="403answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdlength" title='ResourceRecord_struct::rdlength' data-ref="ResourceRecord_struct::rdlength" data-ref-filename="ResourceRecord_struct..rdlength">rdlength</a> &amp;&amp; <a class="local col4 ref" href="#404AddRecord" title='AddRecord' data-ref="404AddRecord" data-ref-filename="404AddRecord">AddRecord</a> &amp;&amp; <a class="local col4 ref" href="#404AddRecord" title='AddRecord' data-ref="404AddRecord" data-ref-filename="404AddRecord">AddRecord</a> != <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#QC_dnssec" title='QC_dnssec' data-ref="QC_dnssec" data-ref-filename="QC_dnssec">QC_dnssec</a>)</td></tr>
<tr><th id="3514">3514</th><td>        {</td></tr>
<tr><th id="3515">3515</th><td>            <i>// If the original question did not end in .local, we did not send an SOA query</i></td></tr>
<tr><th id="3516">3516</th><td><i>            // to figure out whether we should send an additional unicast query or not. If we just</i></td></tr>
<tr><th id="3517">3517</th><td><i>            // appended .local, we need to see if we need to send an additional query. This should</i></td></tr>
<tr><th id="3518">3518</th><td><i>            // normally happen just once because after we append .local, we ignore all negative</i></td></tr>
<tr><th id="3519">3519</th><td><i>            // responses for .local above.</i></td></tr>
<tr><th id="3520">3520</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;queryrecord_result_callback: Retrying question %##s (%s) after appending search domains&quot;, question-&gt;qname.c, DNSTypeName(question-&gt;qtype));} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"queryrecord_result_callback: Retrying question %##s (%s) after appending search domains"</q>, <a class="local col2 ref" href="#402question" title='question' data-ref="402question" data-ref-filename="402question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col2 ref" href="#402question" title='question' data-ref="402question" data-ref-filename="402question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a>));</td></tr>
<tr><th id="3521">3521</th><td>            <b>if</b> (<a class="ref fn" href="#RetryQuestionWithSearchDomains" title='RetryQuestionWithSearchDomains' data-ref="RetryQuestionWithSearchDomains" data-ref-filename="RetryQuestionWithSearchDomains">RetryQuestionWithSearchDomains</a>(<a class="local col2 ref" href="#402question" title='question' data-ref="402question" data-ref-filename="402question">question</a>, <a class="local col5 ref" href="#405req" title='req' data-ref="405req" data-ref-filename="405req">req</a>, <a class="local col4 ref" href="#404AddRecord" title='AddRecord' data-ref="404AddRecord" data-ref-filename="404AddRecord">AddRecord</a>))</td></tr>
<tr><th id="3522">3522</th><td>            {</td></tr>
<tr><th id="3523">3523</th><td>                <i>// Note: We need to call SendAdditionalQuery every time after appending a search domain as .local could</i></td></tr>
<tr><th id="3524">3524</th><td><i>                // be anywhere in the search domain list.</i></td></tr>
<tr><th id="3525">3525</th><td><u>#<span data-ppcond="3525">if</span> APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="3526">3526</th><td>                mStatus err = mStatus_NoError;</td></tr>
<tr><th id="3527">3527</th><td>                err = SendAdditionalQuery(question, req, err);</td></tr>
<tr><th id="3528">3528</th><td>                <b>if</b> (err) LogMsg(<q>"queryrecord_result_callback: Sending .local SOA query failed, after appending domains"</q>);</td></tr>
<tr><th id="3529">3529</th><td><u>#<span data-ppcond="3525">endif</span> // APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="3530">3530</th><td>                <b>return</b>;</td></tr>
<tr><th id="3531">3531</th><td>            }</td></tr>
<tr><th id="3532">3532</th><td>        }</td></tr>
<tr><th id="3533">3533</th><td>    }</td></tr>
<tr><th id="3534">3534</th><td>    <a class="ref fn" href="#queryrecord_result_reply" title='queryrecord_result_reply' data-ref="queryrecord_result_reply" data-ref-filename="queryrecord_result_reply">queryrecord_result_reply</a>(<a class="local col1 ref" href="#401m" title='m' data-ref="401m" data-ref-filename="401m">m</a>, <a class="local col5 ref" href="#405req" title='req' data-ref="405req" data-ref-filename="405req">req</a>, <a class="local col2 ref" href="#402question" title='question' data-ref="402question" data-ref-filename="402question">question</a>, <a class="local col3 ref" href="#403answer" title='answer' data-ref="403answer" data-ref-filename="403answer">answer</a>, <a class="local col4 ref" href="#404AddRecord" title='AddRecord' data-ref="404AddRecord" data-ref-filename="404AddRecord">AddRecord</a>, <a class="local col6 ref" href="#406error" title='error' data-ref="406error" data-ref-filename="406error">error</a>);</td></tr>
<tr><th id="3535">3535</th><td>}</td></tr>
<tr><th id="3536">3536</th><td></td></tr>
<tr><th id="3537">3537</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="queryrecord_termination_callback" title='queryrecord_termination_callback' data-ref="queryrecord_termination_callback" data-ref-filename="queryrecord_termination_callback">queryrecord_termination_callback</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col8 decl" id="408request" title='request' data-type='request_state *' data-ref="408request" data-ref-filename="408request">request</dfn>)</td></tr>
<tr><th id="3538">3538</th><td>{</td></tr>
<tr><th id="3539">3539</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: DNSServiceQueryRecord(%X, %d, %##s, %s) STOP PID[%d](%s)&quot;, request-&gt;sd, request-&gt;flags, request-&gt;interfaceIndex, request-&gt;u.queryrecord.q.qname.c, DNSTypeName(request-&gt;u.queryrecord.q.qtype), request-&gt;process_id, request-&gt;pid_name);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: DNSServiceQueryRecord(%X, %d, %##s, %s) STOP PID[%d](%s)"</q>,</td></tr>
<tr><th id="3540">3540</th><td>        <a class="local col8 ref" href="#408request" title='request' data-ref="408request" data-ref-filename="408request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col8 ref" href="#408request" title='request' data-ref="408request" data-ref-filename="408request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a>, <a class="local col8 ref" href="#408request" title='request' data-ref="408request" data-ref-filename="408request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::interfaceIndex" title='request_state::interfaceIndex' data-ref="request_state::interfaceIndex" data-ref-filename="request_state..interfaceIndex">interfaceIndex</a>, <a class="local col8 ref" href="#408request" title='request' data-ref="408request" data-ref-filename="408request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q" title='request_state::(anonymous union)::(anonymous struct)::q' data-ref="request_state::(anonymousunion)::(anonymous)::q" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q">q</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col8 ref" href="#408request" title='request' data-ref="408request" data-ref-filename="408request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q" title='request_state::(anonymous union)::(anonymous struct)::q' data-ref="request_state::(anonymousunion)::(anonymous)::q" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q">q</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a>), <a class="local col8 ref" href="#408request" title='request' data-ref="408request" data-ref-filename="408request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col8 ref" href="#408request" title='request' data-ref="408request" data-ref-filename="408request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="3541">3541</th><td>    <b>if</b> (<a class="local col8 ref" href="#408request" title='request' data-ref="408request" data-ref-filename="408request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q" title='request_state::(anonymous union)::(anonymous struct)::q' data-ref="request_state::(anonymousunion)::(anonymous)::q" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q">q</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::QuestionContext" title='DNSQuestion_struct::QuestionContext' data-ref="DNSQuestion_struct::QuestionContext" data-ref-filename="DNSQuestion_struct..QuestionContext">QuestionContext</a>)</td></tr>
<tr><th id="3542">3542</th><td>    {</td></tr>
<tr><th id="3543">3543</th><td>        <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_StopQuery" title='mDNS_StopQuery' data-ref="mDNS_StopQuery" data-ref-filename="mDNS_StopQuery">mDNS_StopQuery</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col8 ref" href="#408request" title='request' data-ref="408request" data-ref-filename="408request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q" title='request_state::(anonymous union)::(anonymous struct)::q' data-ref="request_state::(anonymousunion)::(anonymous)::q" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q">q</a>);  <i>// no need to error check</i></td></tr>
<tr><th id="3544">3544</th><td>        <a class="macro" href="uds_daemon.h.html#224" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMcastQuestion" data-ref="_M/LogMcastQ">LogMcastQ</a>(&amp;<a class="local col8 ref" href="#408request" title='request' data-ref="408request" data-ref-filename="408request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q" title='request_state::(anonymous union)::(anonymous struct)::q' data-ref="request_state::(anonymousunion)::(anonymous)::q" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q">q</a>, <a class="local col8 ref" href="#408request" title='request' data-ref="408request" data-ref-filename="408request">request</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#q_stop" title='q_stop' data-ref="q_stop" data-ref-filename="q_stop">q_stop</a>);</td></tr>
<tr><th id="3545">3545</th><td>        <a class="local col8 ref" href="#408request" title='request' data-ref="408request" data-ref-filename="408request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q" title='request_state::(anonymous union)::(anonymous struct)::q' data-ref="request_state::(anonymousunion)::(anonymous)::q" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q">q</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::QuestionContext" title='DNSQuestion_struct::QuestionContext' data-ref="DNSQuestion_struct::QuestionContext" data-ref-filename="DNSQuestion_struct..QuestionContext">QuestionContext</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="3546">3546</th><td>    }</td></tr>
<tr><th id="3547">3547</th><td>    <b>else</b></td></tr>
<tr><th id="3548">3548</th><td>    {</td></tr>
<tr><th id="3549">3549</th><td>        <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion" title='DNSQuestion' data-type='struct DNSQuestion_struct' data-ref="DNSQuestion" data-ref-filename="DNSQuestion">DNSQuestion</a> *<dfn class="local col9 decl" id="409question" title='question' data-type='DNSQuestion *' data-ref="409question" data-ref-filename="409question">question</dfn> = &amp;<a class="local col8 ref" href="#408request" title='request' data-ref="408request" data-ref-filename="408request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q" title='request_state::(anonymous union)::(anonymous struct)::q' data-ref="request_state::(anonymousunion)::(anonymous)::q" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q">q</a>;</td></tr>
<tr><th id="3550">3550</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;queryrecord_termination_callback: question %##s (%s) already stopped, InterfaceID %p&quot;, question-&gt;qname.c, DNSTypeName(question-&gt;qtype), question-&gt;InterfaceID);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"queryrecord_termination_callback: question %##s (%s) already stopped, InterfaceID %p"</q>, <a class="local col9 ref" href="#409question" title='question' data-ref="409question" data-ref-filename="409question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col9 ref" href="#409question" title='question' data-ref="409question" data-ref-filename="409question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a>), <a class="local col9 ref" href="#409question" title='question' data-ref="409question" data-ref-filename="409question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::InterfaceID" title='DNSQuestion_struct::InterfaceID' data-ref="DNSQuestion_struct::InterfaceID" data-ref-filename="DNSQuestion_struct..InterfaceID">InterfaceID</a>);</td></tr>
<tr><th id="3551">3551</th><td>    }</td></tr>
<tr><th id="3552">3552</th><td></td></tr>
<tr><th id="3553">3553</th><td>    <b>if</b> (<a class="local col8 ref" href="#408request" title='request' data-ref="408request" data-ref-filename="408request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q" title='request_state::(anonymous union)::(anonymous struct)::q' data-ref="request_state::(anonymousunion)::(anonymous)::q" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q">q</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a>)</td></tr>
<tr><th id="3554">3554</th><td>    {</td></tr>
<tr><th id="3555">3555</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(request-&gt;u.queryrecord.q.qnameOrig)" data-ref="_M/freeL">freeL</a>(<q>"QueryTermination"</q>, <a class="local col8 ref" href="#408request" title='request' data-ref="408request" data-ref-filename="408request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q" title='request_state::(anonymous union)::(anonymous struct)::q' data-ref="request_state::(anonymousunion)::(anonymous)::q" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q">q</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a>);</td></tr>
<tr><th id="3556">3556</th><td>        <a class="local col8 ref" href="#408request" title='request' data-ref="408request" data-ref-filename="408request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q" title='request_state::(anonymous union)::(anonymous struct)::q' data-ref="request_state::(anonymousunion)::(anonymous)::q" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q">q</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="3557">3557</th><td>    }</td></tr>
<tr><th id="3558">3558</th><td></td></tr>
<tr><th id="3559">3559</th><td>    <b>if</b> (<a class="ref fn" href="#callExternalHelpers" title='callExternalHelpers' data-ref="callExternalHelpers" data-ref-filename="callExternalHelpers">callExternalHelpers</a>(<a class="local col8 ref" href="#408request" title='request' data-ref="408request" data-ref-filename="408request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q" title='request_state::(anonymous union)::(anonymous struct)::q' data-ref="request_state::(anonymousunion)::(anonymous)::q" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q">q</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::InterfaceID" title='DNSQuestion_struct::InterfaceID' data-ref="DNSQuestion_struct::InterfaceID" data-ref-filename="DNSQuestion_struct..InterfaceID">InterfaceID</a>, &amp;<a class="local col8 ref" href="#408request" title='request' data-ref="408request" data-ref-filename="408request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q" title='request_state::(anonymous union)::(anonymous struct)::q' data-ref="request_state::(anonymousunion)::(anonymous)::q" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q">q</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>, <a class="local col8 ref" href="#408request" title='request' data-ref="408request" data-ref-filename="408request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q" title='request_state::(anonymous union)::(anonymous struct)::q' data-ref="request_state::(anonymousunion)::(anonymous)::q" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q">q</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::flags" title='DNSQuestion_struct::flags' data-ref="DNSQuestion_struct::flags" data-ref-filename="DNSQuestion_struct..flags">flags</a>))</td></tr>
<tr><th id="3560">3560</th><td>    {</td></tr>
<tr><th id="3561">3561</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;queryrecord_termination_callback: calling external_stop_browsing_for_service()&quot;);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"queryrecord_termination_callback: calling external_stop_browsing_for_service()"</q>);</td></tr>
<tr><th id="3562">3562</th><td>        <a class="macro" href="uds_daemon.h.html#265" title="(void)(request-&gt;u.queryrecord.q.InterfaceID)" data-ref="_M/external_stop_browsing_for_service">external_stop_browsing_for_service</a>(<a class="local col8 ref" href="#408request" title='request' data-ref="408request" data-ref-filename="408request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q" title='request_state::(anonymous union)::(anonymous struct)::q' data-ref="request_state::(anonymousunion)::(anonymous)::q" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q">q</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::InterfaceID" title='DNSQuestion_struct::InterfaceID' data-ref="DNSQuestion_struct::InterfaceID" data-ref-filename="DNSQuestion_struct..InterfaceID">InterfaceID</a>, &amp;request-&gt;u.queryrecord.q.qname, request-&gt;u.queryrecord.q.qtype, request-&gt;u.queryrecord.q.flags);</td></tr>
<tr><th id="3563">3563</th><td>    }</td></tr>
<tr><th id="3564">3564</th><td>    <b>if</b> (<a class="local col8 ref" href="#408request" title='request' data-ref="408request" data-ref-filename="408request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q2" title='request_state::(anonymous union)::(anonymous struct)::q2' data-ref="request_state::(anonymousunion)::(anonymous)::q2" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q2">q2</a>)</td></tr>
<tr><th id="3565">3565</th><td>    {</td></tr>
<tr><th id="3566">3566</th><td>        <b>if</b> (<a class="local col8 ref" href="#408request" title='request' data-ref="408request" data-ref-filename="408request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q2" title='request_state::(anonymous union)::(anonymous struct)::q2' data-ref="request_state::(anonymousunion)::(anonymous)::q2" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q2">q2</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::QuestionContext" title='DNSQuestion_struct::QuestionContext' data-ref="DNSQuestion_struct::QuestionContext" data-ref-filename="DNSQuestion_struct..QuestionContext">QuestionContext</a>)</td></tr>
<tr><th id="3567">3567</th><td>        {</td></tr>
<tr><th id="3568">3568</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;queryrecord_termination_callback: Stopping q2 %##s&quot;, request-&gt;u.queryrecord.q2-&gt;qname.c);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"queryrecord_termination_callback: Stopping q2 %##s"</q>, <a class="local col8 ref" href="#408request" title='request' data-ref="408request" data-ref-filename="408request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q2" title='request_state::(anonymous union)::(anonymous struct)::q2' data-ref="request_state::(anonymousunion)::(anonymous)::q2" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q2">q2</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>);</td></tr>
<tr><th id="3569">3569</th><td>            <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_StopQuery" title='mDNS_StopQuery' data-ref="mDNS_StopQuery" data-ref-filename="mDNS_StopQuery">mDNS_StopQuery</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col8 ref" href="#408request" title='request' data-ref="408request" data-ref-filename="408request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q2" title='request_state::(anonymous union)::(anonymous struct)::q2' data-ref="request_state::(anonymousunion)::(anonymous)::q2" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q2">q2</a>);</td></tr>
<tr><th id="3570">3570</th><td>            <a class="macro" href="uds_daemon.h.html#224" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMcastQuestion" data-ref="_M/LogMcastQ">LogMcastQ</a>(<a class="local col8 ref" href="#408request" title='request' data-ref="408request" data-ref-filename="408request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q2" title='request_state::(anonymous union)::(anonymous struct)::q2' data-ref="request_state::(anonymousunion)::(anonymous)::q2" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q2">q2</a>, <a class="local col8 ref" href="#408request" title='request' data-ref="408request" data-ref-filename="408request">request</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#q_stop" title='q_stop' data-ref="q_stop" data-ref-filename="q_stop">q_stop</a>);</td></tr>
<tr><th id="3571">3571</th><td>        }</td></tr>
<tr><th id="3572">3572</th><td>        <b>else</b></td></tr>
<tr><th id="3573">3573</th><td>        {</td></tr>
<tr><th id="3574">3574</th><td>            <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion" title='DNSQuestion' data-type='struct DNSQuestion_struct' data-ref="DNSQuestion" data-ref-filename="DNSQuestion">DNSQuestion</a> *<dfn class="local col0 decl" id="410question" title='question' data-type='DNSQuestion *' data-ref="410question" data-ref-filename="410question">question</dfn> = <a class="local col8 ref" href="#408request" title='request' data-ref="408request" data-ref-filename="408request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q2" title='request_state::(anonymous union)::(anonymous struct)::q2' data-ref="request_state::(anonymousunion)::(anonymous)::q2" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q2">q2</a>;</td></tr>
<tr><th id="3575">3575</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;queryrecord_termination_callback: q2 %##s (%s) already stopped, InterfaceID %p&quot;, question-&gt;qname.c, DNSTypeName(question-&gt;qtype), question-&gt;InterfaceID);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"queryrecord_termination_callback: q2 %##s (%s) already stopped, InterfaceID %p"</q>, <a class="local col0 ref" href="#410question" title='question' data-ref="410question" data-ref-filename="410question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col0 ref" href="#410question" title='question' data-ref="410question" data-ref-filename="410question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a>), <a class="local col0 ref" href="#410question" title='question' data-ref="410question" data-ref-filename="410question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::InterfaceID" title='DNSQuestion_struct::InterfaceID' data-ref="DNSQuestion_struct::InterfaceID" data-ref-filename="DNSQuestion_struct..InterfaceID">InterfaceID</a>);</td></tr>
<tr><th id="3576">3576</th><td>        }</td></tr>
<tr><th id="3577">3577</th><td>        <b>if</b> (<a class="local col8 ref" href="#408request" title='request' data-ref="408request" data-ref-filename="408request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q2" title='request_state::(anonymous union)::(anonymous struct)::q2' data-ref="request_state::(anonymousunion)::(anonymous)::q2" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q2">q2</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a>)</td></tr>
<tr><th id="3578">3578</th><td>        {</td></tr>
<tr><th id="3579">3579</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;queryrecord_termination_callback: freeing q2 qnameOrig %##s&quot;, request-&gt;u.queryrecord.q2-&gt;qnameOrig-&gt;c);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"queryrecord_termination_callback: freeing q2 qnameOrig %##s"</q>, <a class="local col8 ref" href="#408request" title='request' data-ref="408request" data-ref-filename="408request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q2" title='request_state::(anonymous union)::(anonymous struct)::q2' data-ref="request_state::(anonymousunion)::(anonymous)::q2" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q2">q2</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>);</td></tr>
<tr><th id="3580">3580</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(request-&gt;u.queryrecord.q2-&gt;qnameOrig)" data-ref="_M/freeL">freeL</a>(<q>"QueryTermination q2"</q>, <a class="local col8 ref" href="#408request" title='request' data-ref="408request" data-ref-filename="408request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q2" title='request_state::(anonymous union)::(anonymous struct)::q2' data-ref="request_state::(anonymousunion)::(anonymous)::q2" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q2">q2</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a>);</td></tr>
<tr><th id="3581">3581</th><td>            <a class="local col8 ref" href="#408request" title='request' data-ref="408request" data-ref-filename="408request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q2" title='request_state::(anonymous union)::(anonymous struct)::q2' data-ref="request_state::(anonymousunion)::(anonymous)::q2" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q2">q2</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="3582">3582</th><td>        }</td></tr>
<tr><th id="3583">3583</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(request-&gt;u.queryrecord.q2)" data-ref="_M/freeL">freeL</a>(<q>"queryrecord Q2"</q>, <a class="local col8 ref" href="#408request" title='request' data-ref="408request" data-ref-filename="408request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q2" title='request_state::(anonymous union)::(anonymous struct)::q2' data-ref="request_state::(anonymousunion)::(anonymous)::q2" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q2">q2</a>);</td></tr>
<tr><th id="3584">3584</th><td>        <a class="local col8 ref" href="#408request" title='request' data-ref="408request" data-ref-filename="408request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q2" title='request_state::(anonymous union)::(anonymous struct)::q2' data-ref="request_state::(anonymousunion)::(anonymous)::q2" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q2">q2</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="3585">3585</th><td>    }</td></tr>
<tr><th id="3586">3586</th><td><u>#<span data-ppcond="3586">if</span> APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="3587">3587</th><td>    {</td></tr>
<tr><th id="3588">3588</th><td>        <b>if</b> (request-&gt;u.queryrecord.ans)</td></tr>
<tr><th id="3589">3589</th><td>        {</td></tr>
<tr><th id="3590">3590</th><td>            DNSQuestion *v4q, *v6q;</td></tr>
<tr><th id="3591">3591</th><td>            <i>// If we are receiving poisitive answers, provide the hint to the</i></td></tr>
<tr><th id="3592">3592</th><td><i>            // upper layer.</i></td></tr>
<tr><th id="3593">3593</th><td>            v4q = v6q = mDNSNULL;</td></tr>
<tr><th id="3594">3594</th><td>            <b>if</b> (request-&gt;u.queryrecord.q.qtype == kDNSType_A)</td></tr>
<tr><th id="3595">3595</th><td>                v4q = &amp;request-&gt;u.queryrecord.q;</td></tr>
<tr><th id="3596">3596</th><td>            <b>else</b> <b>if</b> (request-&gt;u.queryrecord.q.qtype == kDNSType_AAAA)</td></tr>
<tr><th id="3597">3597</th><td>                v6q = &amp;request-&gt;u.queryrecord.q;</td></tr>
<tr><th id="3598">3598</th><td>            mDNSPlatformTriggerDNSRetry(v4q, v6q);</td></tr>
<tr><th id="3599">3599</th><td>        }</td></tr>
<tr><th id="3600">3600</th><td>    }</td></tr>
<tr><th id="3601">3601</th><td><u>#<span data-ppcond="3586">endif</span> // APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="3602">3602</th><td>}</td></tr>
<tr><th id="3603">3603</th><td></td></tr>
<tr><th id="3604">3604</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="decl def fn" id="handle_queryrecord_request" title='handle_queryrecord_request' data-ref="handle_queryrecord_request" data-ref-filename="handle_queryrecord_request">handle_queryrecord_request</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col1 decl" id="411request" title='request' data-type='request_state *' data-ref="411request" data-ref-filename="411request">request</dfn>)</td></tr>
<tr><th id="3605">3605</th><td>{</td></tr>
<tr><th id="3606">3606</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion" title='DNSQuestion' data-type='struct DNSQuestion_struct' data-ref="DNSQuestion" data-ref-filename="DNSQuestion">DNSQuestion</a> *<em>const</em> <dfn class="local col2 decl" id="412q" title='q' data-type='DNSQuestion *const' data-ref="412q" data-ref-filename="412q">q</dfn> = &amp;<a class="local col1 ref" href="#411request" title='request' data-ref="411request" data-ref-filename="411request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q" title='request_state::(anonymous union)::(anonymous struct)::q' data-ref="request_state::(anonymousunion)::(anonymous)::q" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q">q</a>;</td></tr>
<tr><th id="3607">3607</th><td>    <em>char</em> <dfn class="local col3 decl" id="413name" title='name' data-type='char [256]' data-ref="413name" data-ref-filename="413name">name</dfn>[<var>256</var>];</td></tr>
<tr><th id="3608">3608</th><td>    <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#size_t" title='size_t' data-type='unsigned long' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col4 decl" id="414nameLen" title='nameLen' data-type='size_t' data-ref="414nameLen" data-ref-filename="414nameLen">nameLen</dfn>;</td></tr>
<tr><th id="3609">3609</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu16" title='mDNSu16' data-type='unsigned short' data-ref="mDNSu16" data-ref-filename="mDNSu16">mDNSu16</a> <dfn class="local col5 decl" id="415rrtype" title='rrtype' data-type='mDNSu16' data-ref="415rrtype" data-ref-filename="415rrtype">rrtype</dfn>, <dfn class="local col6 decl" id="416rrclass" title='rrclass' data-type='mDNSu16' data-ref="416rrclass" data-ref-filename="416rrclass">rrclass</dfn>;</td></tr>
<tr><th id="3610">3610</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="local col7 decl" id="417err" title='err' data-type='mStatus' data-ref="417err" data-ref-filename="417err">err</dfn>;</td></tr>
<tr><th id="3611">3611</th><td></td></tr>
<tr><th id="3612">3612</th><td>    <a class="typedef" href="dns_sd.h.html#DNSServiceFlags" title='DNSServiceFlags' data-type='uint32_t' data-ref="DNSServiceFlags" data-ref-filename="DNSServiceFlags">DNSServiceFlags</a> <dfn class="local col8 decl" id="418flags" title='flags' data-type='DNSServiceFlags' data-ref="418flags" data-ref-filename="418flags">flags</dfn> = <a class="macro" href="dnssd_ipc.h.html#210" title="__dnssd_ipc_get_uint32" data-ref="_M/get_flags">get_flags</a>(&amp;<a class="local col1 ref" href="#411request" title='request' data-ref="411request" data-ref-filename="411request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col1 ref" href="#411request" title='request' data-ref="411request" data-ref-filename="411request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);</td></tr>
<tr><th id="3613">3613</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col9 decl" id="419interfaceIndex" title='interfaceIndex' data-type='mDNSu32' data-ref="419interfaceIndex" data-ref-filename="419interfaceIndex">interfaceIndex</dfn> = <a class="macro" href="dnssd_ipc.h.html#194" title="__dnssd_ipc_get_uint32" data-ref="_M/get_uint32">get_uint32</a>(&amp;<a class="local col1 ref" href="#411request" title='request' data-ref="411request" data-ref-filename="411request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col1 ref" href="#411request" title='request' data-ref="411request" data-ref-filename="411request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);</td></tr>
<tr><th id="3614">3614</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterfaceID" title='mDNSInterfaceID' data-type='struct mDNSInterfaceID_dummystruct *' data-ref="mDNSInterfaceID" data-ref-filename="mDNSInterfaceID">mDNSInterfaceID</a> <dfn class="local col0 decl" id="420InterfaceID" title='InterfaceID' data-type='mDNSInterfaceID' data-ref="420InterfaceID" data-ref-filename="420InterfaceID">InterfaceID</dfn> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformInterfaceIDfromInterfaceIndex" title='mDNSPlatformInterfaceIDfromInterfaceIndex' data-ref="mDNSPlatformInterfaceIDfromInterfaceIndex" data-ref-filename="mDNSPlatformInterfaceIDfromInterfaceIndex">mDNSPlatformInterfaceIDfromInterfaceIndex</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col9 ref" href="#419interfaceIndex" title='interfaceIndex' data-ref="419interfaceIndex" data-ref-filename="419interfaceIndex">interfaceIndex</a>);</td></tr>
<tr><th id="3615">3615</th><td></td></tr>
<tr><th id="3616">3616</th><td>    <i>// The request is scoped to a specific interface index, but the </i></td></tr>
<tr><th id="3617">3617</th><td><i>    // interface is not currently in our list.</i></td></tr>
<tr><th id="3618">3618</th><td>    <b>if</b> (<a class="local col9 ref" href="#419interfaceIndex" title='interfaceIndex' data-ref="419interfaceIndex" data-ref-filename="419interfaceIndex">interfaceIndex</a> &amp;&amp; !<a class="local col0 ref" href="#420InterfaceID" title='InterfaceID' data-ref="420InterfaceID" data-ref-filename="420InterfaceID">InterfaceID</a>)</td></tr>
<tr><th id="3619">3619</th><td>    {</td></tr>
<tr><th id="3620">3620</th><td>        <b>if</b> (<a class="local col9 ref" href="#419interfaceIndex" title='interfaceIndex' data-ref="419interfaceIndex" data-ref-filename="419interfaceIndex">interfaceIndex</a> &gt; <var>1</var>)</td></tr>
<tr><th id="3621">3621</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;handle_queryrecord_request: interfaceIndex %d is currently inactive requested by client[%d][%s]&quot;, interfaceIndex, request-&gt;process_id, request-&gt;pid_name)" data-ref="_M/LogMsg">LogMsg</a>(<q>"handle_queryrecord_request: interfaceIndex %d is currently inactive requested by client[%d][%s]"</q>,</td></tr>
<tr><th id="3622">3622</th><td>                    <a class="local col9 ref" href="#419interfaceIndex" title='interfaceIndex' data-ref="419interfaceIndex" data-ref-filename="419interfaceIndex">interfaceIndex</a>, <a class="local col1 ref" href="#411request" title='request' data-ref="411request" data-ref-filename="411request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col1 ref" href="#411request" title='request' data-ref="411request" data-ref-filename="411request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="3623">3623</th><td>        <i>// If it's one of the specially defined inteface index values, just return an error.</i></td></tr>
<tr><th id="3624">3624</th><td><i>        // Also, caller should return an error immediately if lo0 (index 1) is not configured </i></td></tr>
<tr><th id="3625">3625</th><td><i>        // into the current active interfaces.  See background in Radar 21967160.</i></td></tr>
<tr><th id="3626">3626</th><td>        <b>if</b> (<a class="ref fn" href="#PreDefinedInterfaceIndex" title='PreDefinedInterfaceIndex' data-ref="PreDefinedInterfaceIndex" data-ref-filename="PreDefinedInterfaceIndex">PreDefinedInterfaceIndex</a>(<a class="local col9 ref" href="#419interfaceIndex" title='interfaceIndex' data-ref="419interfaceIndex" data-ref-filename="419interfaceIndex">interfaceIndex</a>) || <a class="local col9 ref" href="#419interfaceIndex" title='interfaceIndex' data-ref="419interfaceIndex" data-ref-filename="419interfaceIndex">interfaceIndex</a> == <var>1</var>)</td></tr>
<tr><th id="3627">3627</th><td>        {</td></tr>
<tr><th id="3628">3628</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;handle_queryrecord_request: bad interfaceIndex %d&quot;, interfaceIndex);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"handle_queryrecord_request: bad interfaceIndex %d"</q>, <a class="local col9 ref" href="#419interfaceIndex" title='interfaceIndex' data-ref="419interfaceIndex" data-ref-filename="419interfaceIndex">interfaceIndex</a>);</td></tr>
<tr><th id="3629">3629</th><td>            <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>);</td></tr>
<tr><th id="3630">3630</th><td>        }</td></tr>
<tr><th id="3631">3631</th><td></td></tr>
<tr><th id="3632">3632</th><td>        <i>// Otherwise, use the specified interface index value and the request will</i></td></tr>
<tr><th id="3633">3633</th><td><i>        // be applied to that interface when it comes up.</i></td></tr>
<tr><th id="3634">3634</th><td>        <a class="local col0 ref" href="#420InterfaceID" title='InterfaceID' data-ref="420InterfaceID" data-ref-filename="420InterfaceID">InterfaceID</a> = (<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterfaceID" title='mDNSInterfaceID' data-type='struct mDNSInterfaceID_dummystruct *' data-ref="mDNSInterfaceID" data-ref-filename="mDNSInterfaceID">mDNSInterfaceID</a>)(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/stdint.h.html#uintptr_t" title='uintptr_t' data-type='__uintptr_t' data-ref="uintptr_t" data-ref-filename="uintptr_t">uintptr_t</a>)<a class="local col9 ref" href="#419interfaceIndex" title='interfaceIndex' data-ref="419interfaceIndex" data-ref-filename="419interfaceIndex">interfaceIndex</a>;</td></tr>
<tr><th id="3635">3635</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;handle_queryrecord_request: query pending for interface index %d&quot;, interfaceIndex);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"handle_queryrecord_request: query pending for interface index %d"</q>, <a class="local col9 ref" href="#419interfaceIndex" title='interfaceIndex' data-ref="419interfaceIndex" data-ref-filename="419interfaceIndex">interfaceIndex</a>);</td></tr>
<tr><th id="3636">3636</th><td>    }</td></tr>
<tr><th id="3637">3637</th><td></td></tr>
<tr><th id="3638">3638</th><td>    <b>if</b> (<a class="macro" href="dnssd_ipc.h.html#198" title="__dnssd_ipc_get_string" data-ref="_M/get_string">get_string</a>(&amp;<a class="local col1 ref" href="#411request" title='request' data-ref="411request" data-ref-filename="411request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col1 ref" href="#411request" title='request' data-ref="411request" data-ref-filename="411request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>, <a class="local col3 ref" href="#413name" title='name' data-ref="413name" data-ref-filename="413name">name</a>, <var>256</var>) &lt; <var>0</var>) <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>);</td></tr>
<tr><th id="3639">3639</th><td>    <a class="local col5 ref" href="#415rrtype" title='rrtype' data-ref="415rrtype" data-ref-filename="415rrtype">rrtype</a>  = <a class="macro" href="dnssd_ipc.h.html#196" title="__dnssd_ipc_get_uint16" data-ref="_M/get_uint16">get_uint16</a>(&amp;<a class="local col1 ref" href="#411request" title='request' data-ref="411request" data-ref-filename="411request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col1 ref" href="#411request" title='request' data-ref="411request" data-ref-filename="411request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);</td></tr>
<tr><th id="3640">3640</th><td>    <a class="local col6 ref" href="#416rrclass" title='rrclass' data-ref="416rrclass" data-ref-filename="416rrclass">rrclass</a> = <a class="macro" href="dnssd_ipc.h.html#196" title="__dnssd_ipc_get_uint16" data-ref="_M/get_uint16">get_uint16</a>(&amp;<a class="local col1 ref" href="#411request" title='request' data-ref="411request" data-ref-filename="411request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col1 ref" href="#411request" title='request' data-ref="411request" data-ref-filename="411request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);</td></tr>
<tr><th id="3641">3641</th><td></td></tr>
<tr><th id="3642">3642</th><td>    <b>if</b> (!<a class="local col1 ref" href="#411request" title='request' data-ref="411request" data-ref-filename="411request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>)</td></tr>
<tr><th id="3643">3643</th><td>    { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: DNSServiceQueryRecord(unreadable parameters)&quot;, request-&gt;sd)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: DNSServiceQueryRecord(unreadable parameters)"</q>, <a class="local col1 ref" href="#411request" title='request' data-ref="411request" data-ref-filename="411request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>); <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>); }</td></tr>
<tr><th id="3644">3644</th><td></td></tr>
<tr><th id="3645">3645</th><td>    <a class="local col1 ref" href="#411request" title='request' data-ref="411request" data-ref-filename="411request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a> = <a class="local col8 ref" href="#418flags" title='flags' data-ref="418flags" data-ref-filename="418flags">flags</a>;</td></tr>
<tr><th id="3646">3646</th><td>    <a class="local col1 ref" href="#411request" title='request' data-ref="411request" data-ref-filename="411request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::interfaceIndex" title='request_state::interfaceIndex' data-ref="request_state::interfaceIndex" data-ref-filename="request_state..interfaceIndex">interfaceIndex</a> = <a class="local col9 ref" href="#419interfaceIndex" title='interfaceIndex' data-ref="419interfaceIndex" data-ref-filename="419interfaceIndex">interfaceIndex</a>;</td></tr>
<tr><th id="3647">3647</th><td>    <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformMemZero" title='mDNSPlatformMemZero' data-ref="mDNSPlatformMemZero" data-ref-filename="mDNSPlatformMemZero">mDNSPlatformMemZero</a>(&amp;<a class="local col1 ref" href="#411request" title='request' data-ref="411request" data-ref-filename="411request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>, <b>sizeof</b>(<a class="local col1 ref" href="#411request" title='request' data-ref="411request" data-ref-filename="411request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>));</td></tr>
<tr><th id="3648">3648</th><td></td></tr>
<tr><th id="3649">3649</th><td>    <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::InterfaceID" title='DNSQuestion_struct::InterfaceID' data-ref="DNSQuestion_struct::InterfaceID" data-ref-filename="DNSQuestion_struct..InterfaceID">InterfaceID</a>      = <a class="local col0 ref" href="#420InterfaceID" title='InterfaceID' data-ref="420InterfaceID" data-ref-filename="420InterfaceID">InterfaceID</a>;</td></tr>
<tr><th id="3650">3650</th><td>    <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::flags" title='DNSQuestion_struct::flags' data-ref="DNSQuestion_struct::flags" data-ref-filename="DNSQuestion_struct..flags">flags</a>            = <a class="local col8 ref" href="#418flags" title='flags' data-ref="418flags" data-ref-filename="418flags">flags</a>;</td></tr>
<tr><th id="3651">3651</th><td>    <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::Target" title='DNSQuestion_struct::Target' data-ref="DNSQuestion_struct::Target" data-ref-filename="DNSQuestion_struct..Target">Target</a>           = <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#zeroAddr" title='zeroAddr' data-ref="zeroAddr" data-ref-filename="zeroAddr">zeroAddr</a>;</td></tr>
<tr><th id="3652">3652</th><td>    <b>if</b> (!<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#MakeDomainNameFromDNSNameString" title='MakeDomainNameFromDNSNameString' data-ref="MakeDomainNameFromDNSNameString" data-ref-filename="MakeDomainNameFromDNSNameString">MakeDomainNameFromDNSNameString</a>(&amp;<a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>, <a class="local col3 ref" href="#413name" title='name' data-ref="413name" data-ref-filename="413name">name</a>)) <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>);</td></tr>
<tr><th id="3653">3653</th><td><u>#<span data-ppcond="3653">if</span> 0</u></td></tr>
<tr><th id="3654">3654</th><td>    <b>if</b> (!AuthorizedDomain(request, &amp;q-&gt;qname, AutoBrowseDomains)) <b>return</b> (mStatus_NoError);</td></tr>
<tr><th id="3655">3655</th><td><u>#<span data-ppcond="3653">endif</span></u></td></tr>
<tr><th id="3656">3656</th><td>    <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a>            = <a class="local col5 ref" href="#415rrtype" title='rrtype' data-ref="415rrtype" data-ref-filename="415rrtype">rrtype</a>;</td></tr>
<tr><th id="3657">3657</th><td>    <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qclass" title='DNSQuestion_struct::qclass' data-ref="DNSQuestion_struct::qclass" data-ref-filename="DNSQuestion_struct..qclass">qclass</a>           = <a class="local col6 ref" href="#416rrclass" title='rrclass' data-ref="416rrclass" data-ref-filename="416rrclass">rrclass</a>;</td></tr>
<tr><th id="3658">3658</th><td>    <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::LongLived" title='DNSQuestion_struct::LongLived' data-ref="DNSQuestion_struct::LongLived" data-ref-filename="DNSQuestion_struct..LongLived">LongLived</a>        = (<a class="local col8 ref" href="#418flags" title='flags' data-ref="418flags" data-ref-filename="418flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsLongLivedQuery" title='kDNSServiceFlagsLongLivedQuery' data-ref="kDNSServiceFlagsLongLivedQuery" data-ref-filename="kDNSServiceFlagsLongLivedQuery">kDNSServiceFlagsLongLivedQuery</a>     ) != <var>0</var>;</td></tr>
<tr><th id="3659">3659</th><td>    <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ExpectUnique" title='DNSQuestion_struct::ExpectUnique' data-ref="DNSQuestion_struct::ExpectUnique" data-ref-filename="DNSQuestion_struct..ExpectUnique">ExpectUnique</a>     = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>;</td></tr>
<tr><th id="3660">3660</th><td>    <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ForceMCast" title='DNSQuestion_struct::ForceMCast' data-ref="DNSQuestion_struct::ForceMCast" data-ref-filename="DNSQuestion_struct..ForceMCast">ForceMCast</a>       = (<a class="local col8 ref" href="#418flags" title='flags' data-ref="418flags" data-ref-filename="418flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsForceMulticast" title='kDNSServiceFlagsForceMulticast' data-ref="kDNSServiceFlagsForceMulticast" data-ref-filename="kDNSServiceFlagsForceMulticast">kDNSServiceFlagsForceMulticast</a>     ) != <var>0</var>;</td></tr>
<tr><th id="3661">3661</th><td>    <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ReturnIntermed" title='DNSQuestion_struct::ReturnIntermed' data-ref="DNSQuestion_struct::ReturnIntermed" data-ref-filename="DNSQuestion_struct..ReturnIntermed">ReturnIntermed</a>   = (<a class="local col8 ref" href="#418flags" title='flags' data-ref="418flags" data-ref-filename="418flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsReturnIntermediates" title='kDNSServiceFlagsReturnIntermediates' data-ref="kDNSServiceFlagsReturnIntermediates" data-ref-filename="kDNSServiceFlagsReturnIntermediates">kDNSServiceFlagsReturnIntermediates</a>) != <var>0</var>;</td></tr>
<tr><th id="3662">3662</th><td>    <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::SuppressUnusable" title='DNSQuestion_struct::SuppressUnusable' data-ref="DNSQuestion_struct::SuppressUnusable" data-ref-filename="DNSQuestion_struct..SuppressUnusable">SuppressUnusable</a> = (<a class="local col8 ref" href="#418flags" title='flags' data-ref="418flags" data-ref-filename="418flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsSuppressUnusable" title='kDNSServiceFlagsSuppressUnusable' data-ref="kDNSServiceFlagsSuppressUnusable" data-ref-filename="kDNSServiceFlagsSuppressUnusable">kDNSServiceFlagsSuppressUnusable</a>   ) != <var>0</var>;</td></tr>
<tr><th id="3663">3663</th><td>    <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::TimeoutQuestion" title='DNSQuestion_struct::TimeoutQuestion' data-ref="DNSQuestion_struct::TimeoutQuestion" data-ref-filename="DNSQuestion_struct..TimeoutQuestion">TimeoutQuestion</a>  = (<a class="local col8 ref" href="#418flags" title='flags' data-ref="418flags" data-ref-filename="418flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsTimeout" title='kDNSServiceFlagsTimeout' data-ref="kDNSServiceFlagsTimeout" data-ref-filename="kDNSServiceFlagsTimeout">kDNSServiceFlagsTimeout</a>            ) != <var>0</var>;</td></tr>
<tr><th id="3664">3664</th><td>    <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::WakeOnResolve" title='DNSQuestion_struct::WakeOnResolve' data-ref="DNSQuestion_struct::WakeOnResolve" data-ref-filename="DNSQuestion_struct..WakeOnResolve">WakeOnResolve</a>    = <var>0</var>;</td></tr>
<tr><th id="3665">3665</th><td>    <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::UseBackgroundTrafficClass" title='DNSQuestion_struct::UseBackgroundTrafficClass' data-ref="DNSQuestion_struct::UseBackgroundTrafficClass" data-ref-filename="DNSQuestion_struct..UseBackgroundTrafficClass">UseBackgroundTrafficClass</a> = (<a class="local col8 ref" href="#418flags" title='flags' data-ref="418flags" data-ref-filename="418flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsBackgroundTrafficClass" title='kDNSServiceFlagsBackgroundTrafficClass' data-ref="kDNSServiceFlagsBackgroundTrafficClass" data-ref-filename="kDNSServiceFlagsBackgroundTrafficClass">kDNSServiceFlagsBackgroundTrafficClass</a>) != <var>0</var>;</td></tr>
<tr><th id="3666">3666</th><td>    <b>if</b> ((<a class="local col8 ref" href="#418flags" title='flags' data-ref="418flags" data-ref-filename="418flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsValidate" title='kDNSServiceFlagsValidate' data-ref="kDNSServiceFlagsValidate" data-ref-filename="kDNSServiceFlagsValidate">kDNSServiceFlagsValidate</a>) != <var>0</var>)</td></tr>
<tr><th id="3667">3667</th><td>        <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ValidationRequired" title='DNSQuestion_struct::ValidationRequired' data-ref="DNSQuestion_struct::ValidationRequired" data-ref-filename="DNSQuestion_struct..ValidationRequired">ValidationRequired</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#1877" title="0x01" data-ref="_M/DNSSEC_VALIDATION_SECURE">DNSSEC_VALIDATION_SECURE</a>;</td></tr>
<tr><th id="3668">3668</th><td>    <b>else</b> <b>if</b> ((<a class="local col8 ref" href="#418flags" title='flags' data-ref="418flags" data-ref-filename="418flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsValidateOptional" title='kDNSServiceFlagsValidateOptional' data-ref="kDNSServiceFlagsValidateOptional" data-ref-filename="kDNSServiceFlagsValidateOptional">kDNSServiceFlagsValidateOptional</a>) != <var>0</var>)</td></tr>
<tr><th id="3669">3669</th><td>        <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ValidationRequired" title='DNSQuestion_struct::ValidationRequired' data-ref="DNSQuestion_struct::ValidationRequired" data-ref-filename="DNSQuestion_struct..ValidationRequired">ValidationRequired</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#1878" title="0x02" data-ref="_M/DNSSEC_VALIDATION_SECURE_OPTIONAL">DNSSEC_VALIDATION_SECURE_OPTIONAL</a>;</td></tr>
<tr><th id="3670">3670</th><td>    <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ValidatingResponse" title='DNSQuestion_struct::ValidatingResponse' data-ref="DNSQuestion_struct::ValidatingResponse" data-ref-filename="DNSQuestion_struct..ValidatingResponse">ValidatingResponse</a> = <var>0</var>;</td></tr>
<tr><th id="3671">3671</th><td>    <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ProxyQuestion" title='DNSQuestion_struct::ProxyQuestion' data-ref="DNSQuestion_struct::ProxyQuestion" data-ref-filename="DNSQuestion_struct..ProxyQuestion">ProxyQuestion</a>    = <var>0</var>;</td></tr>
<tr><th id="3672">3672</th><td>    <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::AnonInfo" title='DNSQuestion_struct::AnonInfo' data-ref="DNSQuestion_struct::AnonInfo" data-ref-filename="DNSQuestion_struct..AnonInfo">AnonInfo</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="3673">3673</th><td>    <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::QuestionCallback" title='DNSQuestion_struct::QuestionCallback' data-ref="DNSQuestion_struct::QuestionCallback" data-ref-filename="DNSQuestion_struct..QuestionCallback">QuestionCallback</a> = <a class="ref fn" href="#queryrecord_result_callback" title='queryrecord_result_callback' data-ref="queryrecord_result_callback" data-ref-filename="queryrecord_result_callback">queryrecord_result_callback</a>;</td></tr>
<tr><th id="3674">3674</th><td>    <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::QuestionContext" title='DNSQuestion_struct::QuestionContext' data-ref="DNSQuestion_struct::QuestionContext" data-ref-filename="DNSQuestion_struct..QuestionContext">QuestionContext</a>  = <a class="local col1 ref" href="#411request" title='request' data-ref="411request" data-ref-filename="411request">request</a>;</td></tr>
<tr><th id="3675">3675</th><td>    <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::SearchListIndex" title='DNSQuestion_struct::SearchListIndex' data-ref="DNSQuestion_struct::SearchListIndex" data-ref-filename="DNSQuestion_struct..SearchListIndex">SearchListIndex</a>  = <var>0</var>;</td></tr>
<tr><th id="3676">3676</th><td>    <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::StopTime" title='DNSQuestion_struct::StopTime' data-ref="DNSQuestion_struct::StopTime" data-ref-filename="DNSQuestion_struct..StopTime">StopTime</a>         = <var>0</var>;</td></tr>
<tr><th id="3677">3677</th><td></td></tr>
<tr><th id="3678">3678</th><td>    <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::DNSSECAuthInfo" title='DNSQuestion_struct::DNSSECAuthInfo' data-ref="DNSQuestion_struct::DNSSECAuthInfo" data-ref-filename="DNSQuestion_struct..DNSSECAuthInfo">DNSSECAuthInfo</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="3679">3679</th><td>    <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::DAIFreeCallback" title='DNSQuestion_struct::DAIFreeCallback' data-ref="DNSQuestion_struct::DAIFreeCallback" data-ref-filename="DNSQuestion_struct..DAIFreeCallback">DAIFreeCallback</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="3680">3680</th><td></td></tr>
<tr><th id="3681">3681</th><td>    <i>//Turn off dnssec validation for local domains and Question Types: RRSIG/ANY(ANY Type is not supported yet)</i></td></tr>
<tr><th id="3682">3682</th><td>    <b>if</b> ((<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#IsLocalDomain" title='IsLocalDomain' data-ref="IsLocalDomain" data-ref-filename="IsLocalDomain">IsLocalDomain</a>(&amp;<a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>)) || (<a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a> == <a class="enum" href="dns_sd.h.html#kDNSServiceType_RRSIG" title='kDNSServiceType_RRSIG' data-ref="kDNSServiceType_RRSIG" data-ref-filename="kDNSServiceType_RRSIG">kDNSServiceType_RRSIG</a>) || (<a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a> == <a class="enum" href="dns_sd.h.html#kDNSServiceType_ANY" title='kDNSServiceType_ANY' data-ref="kDNSServiceType_ANY" data-ref-filename="kDNSServiceType_ANY">kDNSServiceType_ANY</a>))</td></tr>
<tr><th id="3683">3683</th><td>        <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ValidationRequired" title='DNSQuestion_struct::ValidationRequired' data-ref="DNSQuestion_struct::ValidationRequired" data-ref-filename="DNSQuestion_struct..ValidationRequired">ValidationRequired</a> = <var>0</var>;</td></tr>
<tr><th id="3684">3684</th><td></td></tr>
<tr><th id="3685">3685</th><td>    <i>// Don't append search domains for fully qualified domain names including queries</i></td></tr>
<tr><th id="3686">3686</th><td><i>    // such as e.g., "abc." that has only one label. We convert all names to FQDNs as internally</i></td></tr>
<tr><th id="3687">3687</th><td><i>    // we only deal with FQDNs. Hence, we cannot look at qname to figure out whether we should</i></td></tr>
<tr><th id="3688">3688</th><td><i>    // append search domains or not.  So, we record that information in AppendSearchDomains.</i></td></tr>
<tr><th id="3689">3689</th><td><i>    //</i></td></tr>
<tr><th id="3690">3690</th><td><i>    // We append search domains only for queries that are a single label. If overriden using command line </i></td></tr>
<tr><th id="3691">3691</th><td><i>    // argument "AlwaysAppendSearchDomains", then we do it for any query which is not fully qualified.</i></td></tr>
<tr><th id="3692">3692</th><td><i>    // For DNSSEC questions, append search domains only if kDNSServiceFlagsValidateOptional is set.</i></td></tr>
<tr><th id="3693">3693</th><td></td></tr>
<tr><th id="3694">3694</th><td>    <a class="local col4 ref" href="#414nameLen" title='nameLen' data-ref="414nameLen" data-ref-filename="414nameLen">nameLen</a> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strlen" title='strlen' data-ref="strlen" data-ref-filename="strlen">strlen</a>(<a class="local col3 ref" href="#413name" title='name' data-ref="413name" data-ref-filename="413name">name</a>);</td></tr>
<tr><th id="3695">3695</th><td>    <b>if</b> ((!(<a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ValidationRequired" title='DNSQuestion_struct::ValidationRequired' data-ref="DNSQuestion_struct::ValidationRequired" data-ref-filename="DNSQuestion_struct..ValidationRequired">ValidationRequired</a> == <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#1877" title="0x01" data-ref="_M/DNSSEC_VALIDATION_SECURE">DNSSEC_VALIDATION_SECURE</a>)) &amp;&amp; (!(<a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ValidationRequired" title='DNSQuestion_struct::ValidationRequired' data-ref="DNSQuestion_struct::ValidationRequired" data-ref-filename="DNSQuestion_struct..ValidationRequired">ValidationRequired</a> == <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#1879" title="0x03" data-ref="_M/DNSSEC_VALIDATION_INSECURE">DNSSEC_VALIDATION_INSECURE</a>))</td></tr>
<tr><th id="3696">3696</th><td>        &amp;&amp; (<a class="local col5 ref" href="#415rrtype" title='rrtype' data-ref="415rrtype" data-ref-filename="415rrtype">rrtype</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSType_A" title='kDNSType_A' data-ref="kDNSType_A" data-ref-filename="kDNSType_A">kDNSType_A</a> || <a class="local col5 ref" href="#415rrtype" title='rrtype' data-ref="415rrtype" data-ref-filename="415rrtype">rrtype</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSType_AAAA" title='kDNSType_AAAA' data-ref="kDNSType_AAAA" data-ref-filename="kDNSType_AAAA">kDNSType_AAAA</a>) &amp;&amp; ((<a class="local col4 ref" href="#414nameLen" title='nameLen' data-ref="414nameLen" data-ref-filename="414nameLen">nameLen</a> == <var>0</var>) || (<a class="local col3 ref" href="#413name" title='name' data-ref="413name" data-ref-filename="413name">name</a>[<a class="local col4 ref" href="#414nameLen" title='nameLen' data-ref="414nameLen" data-ref-filename="414nameLen">nameLen</a> - <var>1</var>] != <kbd>'.'</kbd>)) &amp;&amp;</td></tr>
<tr><th id="3697">3697</th><td>        (<a class="ref" href="#AlwaysAppendSearchDomains" title='AlwaysAppendSearchDomains' data-ref="AlwaysAppendSearchDomains" data-ref-filename="AlwaysAppendSearchDomains">AlwaysAppendSearchDomains</a> || <a class="ref fn" href="../mDNSCore/DNSCommon.h.html#CountLabels" title='CountLabels' data-ref="CountLabels" data-ref-filename="CountLabels">CountLabels</a>(&amp;<a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>) == <var>1</var>))</td></tr>
<tr><th id="3698">3698</th><td>    {</td></tr>
<tr><th id="3699">3699</th><td>        <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::AppendSearchDomains" title='DNSQuestion_struct::AppendSearchDomains' data-ref="DNSQuestion_struct::AppendSearchDomains" data-ref-filename="DNSQuestion_struct..AppendSearchDomains">AppendSearchDomains</a> = <var>1</var>;</td></tr>
<tr><th id="3700">3700</th><td>        <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::AppendLocalSearchDomains" title='DNSQuestion_struct::AppendLocalSearchDomains' data-ref="DNSQuestion_struct::AppendLocalSearchDomains" data-ref-filename="DNSQuestion_struct..AppendLocalSearchDomains">AppendLocalSearchDomains</a> = <var>1</var>;</td></tr>
<tr><th id="3701">3701</th><td>    }</td></tr>
<tr><th id="3702">3702</th><td>    <b>else</b></td></tr>
<tr><th id="3703">3703</th><td>    {</td></tr>
<tr><th id="3704">3704</th><td>        <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::AppendSearchDomains" title='DNSQuestion_struct::AppendSearchDomains' data-ref="DNSQuestion_struct::AppendSearchDomains" data-ref-filename="DNSQuestion_struct..AppendSearchDomains">AppendSearchDomains</a> = <var>0</var>;</td></tr>
<tr><th id="3705">3705</th><td>        <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::AppendLocalSearchDomains" title='DNSQuestion_struct::AppendLocalSearchDomains' data-ref="DNSQuestion_struct::AppendLocalSearchDomains" data-ref-filename="DNSQuestion_struct..AppendLocalSearchDomains">AppendLocalSearchDomains</a> = <var>0</var>;</td></tr>
<tr><th id="3706">3706</th><td>    }</td></tr>
<tr><th id="3707">3707</th><td></td></tr>
<tr><th id="3708">3708</th><td>    <i>// For single label queries that are not fully qualified, look at /etc/hosts, cache and try</i></td></tr>
<tr><th id="3709">3709</th><td><i>    // search domains before trying them on the wire as a single label query. RetryWithSearchDomains</i></td></tr>
<tr><th id="3710">3710</th><td><i>    // tell the core to call back into the UDS layer if there is no valid response in /etc/hosts or</i></td></tr>
<tr><th id="3711">3711</th><td><i>    // the cache</i></td></tr>
<tr><th id="3712">3712</th><td>    <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::RetryWithSearchDomains" title='DNSQuestion_struct::RetryWithSearchDomains' data-ref="DNSQuestion_struct::RetryWithSearchDomains" data-ref-filename="DNSQuestion_struct..RetryWithSearchDomains">RetryWithSearchDomains</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#1622" title="((q)-&gt;AppendSearchDomains &amp;&amp; (CountLabels(&amp;((q)-&gt;qname))) == 1)" data-ref="_M/ApplySearchDomainsFirst">ApplySearchDomainsFirst</a>(<a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>) ? <var>1</var> : <var>0</var>;</td></tr>
<tr><th id="3713">3713</th><td>    <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a>        = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="3714">3714</th><td>    <a class="ref fn" href="#SetQuestionPolicy" title='SetQuestionPolicy' data-ref="SetQuestionPolicy" data-ref-filename="SetQuestionPolicy">SetQuestionPolicy</a>(<a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>, <a class="local col1 ref" href="#411request" title='request' data-ref="411request" data-ref-filename="411request">request</a>);</td></tr>
<tr><th id="3715">3715</th><td></td></tr>
<tr><th id="3716">3716</th><td><u>#<span data-ppcond="3716">if</span> APPLE_OSX_mDNSResponder &amp;&amp; ENABLE_BLE_TRIGGERED_BONJOUR</u></td></tr>
<tr><th id="3717">3717</th><td>    <i>// Determine if this request should be promoted to use BLE triggered discovery.</i></td></tr>
<tr><th id="3718">3718</th><td>    <b>if</b> (shouldUseBLE(InterfaceID, rrtype, (domainname *)SkipLeadingLabels(&amp;q-&gt;qname, <var>1</var>), &amp;q-&gt;qname))</td></tr>
<tr><th id="3719">3719</th><td>    {</td></tr>
<tr><th id="3720">3720</th><td>        q-&gt;flags |= (kDNSServiceFlagsAutoTrigger | kDNSServiceFlagsIncludeAWDL);</td></tr>
<tr><th id="3721">3721</th><td>        request-&gt;flags |= (kDNSServiceFlagsAutoTrigger | kDNSServiceFlagsIncludeAWDL);</td></tr>
<tr><th id="3722">3722</th><td>        LogInfo(<q>"handle_queryrecord_request: request promoted to use kDNSServiceFlagsAutoTrigger"</q>);</td></tr>
<tr><th id="3723">3723</th><td>    }</td></tr>
<tr><th id="3724">3724</th><td><u>#<span data-ppcond="3716">endif</span> // APPLE_OSX_mDNSResponder &amp;&amp; ENABLE_BLE_TRIGGERED_BONJOUR</u></td></tr>
<tr><th id="3725">3725</th><td></td></tr>
<tr><th id="3726">3726</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: DNSServiceQueryRecord(%X, %d, %##s, %s) START PID[%d](%s)&quot;, request-&gt;sd, request-&gt;flags, interfaceIndex, q-&gt;qname.c, DNSTypeName(q-&gt;qtype), request-&gt;process_id, request-&gt;pid_name);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: DNSServiceQueryRecord(%X, %d, %##s, %s) START PID[%d](%s)"</q>,</td></tr>
<tr><th id="3727">3727</th><td>        <a class="local col1 ref" href="#411request" title='request' data-ref="411request" data-ref-filename="411request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col1 ref" href="#411request" title='request' data-ref="411request" data-ref-filename="411request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a>, <a class="local col9 ref" href="#419interfaceIndex" title='interfaceIndex' data-ref="419interfaceIndex" data-ref-filename="419interfaceIndex">interfaceIndex</a>, <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a>), <a class="local col1 ref" href="#411request" title='request' data-ref="411request" data-ref-filename="411request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col1 ref" href="#411request" title='request' data-ref="411request" data-ref-filename="411request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="3728">3728</th><td>    <a class="local col7 ref" href="#417err" title='err' data-ref="417err" data-ref-filename="417err">err</a> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_StartQuery" title='mDNS_StartQuery' data-ref="mDNS_StartQuery" data-ref-filename="mDNS_StartQuery">mDNS_StartQuery</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>);</td></tr>
<tr><th id="3729">3729</th><td></td></tr>
<tr><th id="3730">3730</th><td>    <b>if</b> (<a class="local col7 ref" href="#417err" title='err' data-ref="417err" data-ref-filename="417err">err</a>)</td></tr>
<tr><th id="3731">3731</th><td>    {</td></tr>
<tr><th id="3732">3732</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: ERROR: DNSServiceQueryRecord %##s %s mDNS_StartQuery: %d&quot;, request-&gt;sd, q-&gt;qname.c, DNSTypeName(q-&gt;qtype), (int)err)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: ERROR: DNSServiceQueryRecord %##s %s mDNS_StartQuery: %d"</q>, <a class="local col1 ref" href="#411request" title='request' data-ref="411request" data-ref-filename="411request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a>), (<em>int</em>)<a class="local col7 ref" href="#417err" title='err' data-ref="417err" data-ref-filename="417err">err</a>);</td></tr>
<tr><th id="3733">3733</th><td>    }</td></tr>
<tr><th id="3734">3734</th><td>    <b>else</b></td></tr>
<tr><th id="3735">3735</th><td>    {</td></tr>
<tr><th id="3736">3736</th><td>        <a class="local col1 ref" href="#411request" title='request' data-ref="411request" data-ref-filename="411request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> = <a class="ref fn" href="#queryrecord_termination_callback" title='queryrecord_termination_callback' data-ref="queryrecord_termination_callback" data-ref-filename="queryrecord_termination_callback">queryrecord_termination_callback</a>;</td></tr>
<tr><th id="3737">3737</th><td>        <a class="macro" href="uds_daemon.h.html#224" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMcastQuestion" data-ref="_M/LogMcastQ">LogMcastQ</a>(<a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>, <a class="local col1 ref" href="#411request" title='request' data-ref="411request" data-ref-filename="411request">request</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#q_start" title='q_start' data-ref="q_start" data-ref-filename="q_start">q_start</a>);</td></tr>
<tr><th id="3738">3738</th><td>        <b>if</b> (<a class="ref fn" href="#callExternalHelpers" title='callExternalHelpers' data-ref="callExternalHelpers" data-ref-filename="callExternalHelpers">callExternalHelpers</a>(<a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::InterfaceID" title='DNSQuestion_struct::InterfaceID' data-ref="DNSQuestion_struct::InterfaceID" data-ref-filename="DNSQuestion_struct..InterfaceID">InterfaceID</a>, &amp;<a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>, <a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::flags" title='DNSQuestion_struct::flags' data-ref="DNSQuestion_struct::flags" data-ref-filename="DNSQuestion_struct..flags">flags</a>))</td></tr>
<tr><th id="3739">3739</th><td>        {</td></tr>
<tr><th id="3740">3740</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;handle_queryrecord_request: calling external_start_browsing_for_service()&quot;);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"handle_queryrecord_request: calling external_start_browsing_for_service()"</q>);</td></tr>
<tr><th id="3741">3741</th><td>            <a class="macro" href="uds_daemon.h.html#264" title="(void)(q-&gt;InterfaceID)" data-ref="_M/external_start_browsing_for_service">external_start_browsing_for_service</a>(<a class="local col2 ref" href="#412q" title='q' data-ref="412q" data-ref-filename="412q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::InterfaceID" title='DNSQuestion_struct::InterfaceID' data-ref="DNSQuestion_struct::InterfaceID" data-ref-filename="DNSQuestion_struct..InterfaceID">InterfaceID</a>, &amp;q-&gt;qname, q-&gt;qtype, q-&gt;flags);</td></tr>
<tr><th id="3742">3742</th><td>        }</td></tr>
<tr><th id="3743">3743</th><td>    }</td></tr>
<tr><th id="3744">3744</th><td></td></tr>
<tr><th id="3745">3745</th><td><u>#<span data-ppcond="3745">if</span> APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="3746">3746</th><td>    err = SendAdditionalQuery(q, request, err);</td></tr>
<tr><th id="3747">3747</th><td><u>#<span data-ppcond="3745">endif</span> // APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="3748">3748</th><td></td></tr>
<tr><th id="3749">3749</th><td>    <b>return</b>(<a class="local col7 ref" href="#417err" title='err' data-ref="417err" data-ref-filename="417err">err</a>);</td></tr>
<tr><th id="3750">3750</th><td>}</td></tr>
<tr><th id="3751">3751</th><td></td></tr>
<tr><th id="3752">3752</th><td><i>// ***************************************************************************</i></td></tr>
<tr><th id="3753">3753</th><td><u>#<span data-ppcond="3753">if</span> COMPILER_LIKES_PRAGMA_MARK</u></td></tr>
<tr><th id="3754">3754</th><td><u>#pragma mark -</u></td></tr>
<tr><th id="3755">3755</th><td><u>#pragma mark - DNSServiceEnumerateDomains</u></td></tr>
<tr><th id="3756">3756</th><td><u>#<span data-ppcond="3753">endif</span></u></td></tr>
<tr><th id="3757">3757</th><td></td></tr>
<tr><th id="3758">3758</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <a class="typedef" href="uds_daemon.h.html#reply_state" title='reply_state' data-type='struct reply_state' data-ref="reply_state" data-ref-filename="reply_state">reply_state</a> *<dfn class="decl def fn" id="format_enumeration_reply" title='format_enumeration_reply' data-ref="format_enumeration_reply" data-ref-filename="format_enumeration_reply">format_enumeration_reply</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col1 decl" id="421request" title='request' data-type='request_state *' data-ref="421request" data-ref-filename="421request">request</dfn>,</td></tr>
<tr><th id="3759">3759</th><td>                                                <em>const</em> <em>char</em> *<dfn class="local col2 decl" id="422domain" title='domain' data-type='const char *' data-ref="422domain" data-ref-filename="422domain">domain</dfn>, <a class="typedef" href="dns_sd.h.html#DNSServiceFlags" title='DNSServiceFlags' data-type='uint32_t' data-ref="DNSServiceFlags" data-ref-filename="DNSServiceFlags">DNSServiceFlags</a> <dfn class="local col3 decl" id="423flags" title='flags' data-type='DNSServiceFlags' data-ref="423flags" data-ref-filename="423flags">flags</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col4 decl" id="424ifi" title='ifi' data-type='mDNSu32' data-ref="424ifi" data-ref-filename="424ifi">ifi</dfn>, <a class="typedef" href="dns_sd.h.html#DNSServiceErrorType" title='DNSServiceErrorType' data-type='int32_t' data-ref="DNSServiceErrorType" data-ref-filename="DNSServiceErrorType">DNSServiceErrorType</a> <dfn class="local col5 decl" id="425err" title='err' data-type='DNSServiceErrorType' data-ref="425err" data-ref-filename="425err">err</dfn>)</td></tr>
<tr><th id="3760">3760</th><td>{</td></tr>
<tr><th id="3761">3761</th><td>    <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#size_t" title='size_t' data-type='unsigned long' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col6 decl" id="426len" title='len' data-type='size_t' data-ref="426len" data-ref-filename="426len">len</dfn>;</td></tr>
<tr><th id="3762">3762</th><td>    <a class="typedef" href="uds_daemon.h.html#reply_state" title='reply_state' data-type='struct reply_state' data-ref="reply_state" data-ref-filename="reply_state">reply_state</a> *<dfn class="local col7 decl" id="427reply" title='reply' data-type='reply_state *' data-ref="427reply" data-ref-filename="427reply">reply</dfn>;</td></tr>
<tr><th id="3763">3763</th><td>    <em>char</em> *<dfn class="local col8 decl" id="428data" title='data' data-type='char *' data-ref="428data" data-ref-filename="428data">data</dfn>;</td></tr>
<tr><th id="3764">3764</th><td></td></tr>
<tr><th id="3765">3765</th><td>    <a class="local col6 ref" href="#426len" title='len' data-ref="426len" data-ref-filename="426len">len</a> = <b>sizeof</b>(<a class="typedef" href="dns_sd.h.html#DNSServiceFlags" title='DNSServiceFlags' data-type='uint32_t' data-ref="DNSServiceFlags" data-ref-filename="DNSServiceFlags">DNSServiceFlags</a>);</td></tr>
<tr><th id="3766">3766</th><td>    <a class="local col6 ref" href="#426len" title='len' data-ref="426len" data-ref-filename="426len">len</a> += <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a>);</td></tr>
<tr><th id="3767">3767</th><td>    <a class="local col6 ref" href="#426len" title='len' data-ref="426len" data-ref-filename="426len">len</a> += <b>sizeof</b>(<a class="typedef" href="dns_sd.h.html#DNSServiceErrorType" title='DNSServiceErrorType' data-type='int32_t' data-ref="DNSServiceErrorType" data-ref-filename="DNSServiceErrorType">DNSServiceErrorType</a>);</td></tr>
<tr><th id="3768">3768</th><td>    <a class="local col6 ref" href="#426len" title='len' data-ref="426len" data-ref-filename="426len">len</a> += <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strlen" title='strlen' data-ref="strlen" data-ref-filename="strlen">strlen</a>(<a class="local col2 ref" href="#422domain" title='domain' data-ref="422domain" data-ref-filename="422domain">domain</a>) + <var>1</var>;</td></tr>
<tr><th id="3769">3769</th><td></td></tr>
<tr><th id="3770">3770</th><td>    <a class="local col7 ref" href="#427reply" title='reply' data-ref="427reply" data-ref-filename="427reply">reply</a> = <a class="ref fn" href="#create_reply" title='create_reply' data-ref="create_reply" data-ref-filename="create_reply">create_reply</a>(<a class="enum" href="dnssd_ipc.h.html#enumeration_reply_op" title='enumeration_reply_op' data-ref="enumeration_reply_op" data-ref-filename="enumeration_reply_op">enumeration_reply_op</a>, <a class="local col6 ref" href="#426len" title='len' data-ref="426len" data-ref-filename="426len">len</a>, <a class="local col1 ref" href="#421request" title='request' data-ref="421request" data-ref-filename="421request">request</a>);</td></tr>
<tr><th id="3771">3771</th><td>    <a class="local col7 ref" href="#427reply" title='reply' data-ref="427reply" data-ref-filename="427reply">reply</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::rhdr" title='reply_state::rhdr' data-ref="reply_state::rhdr" data-ref-filename="reply_state..rhdr">rhdr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#(anonymous)::flags" title='(anonymous struct)::flags' data-ref="(anonymous)::flags" data-ref-filename="(anonymous)..flags">flags</a> = <a class="ref fn" href="#dnssd_htonl" title='dnssd_htonl' data-ref="dnssd_htonl" data-ref-filename="dnssd_htonl">dnssd_htonl</a>(<a class="local col3 ref" href="#423flags" title='flags' data-ref="423flags" data-ref-filename="423flags">flags</a>);</td></tr>
<tr><th id="3772">3772</th><td>    <a class="local col7 ref" href="#427reply" title='reply' data-ref="427reply" data-ref-filename="427reply">reply</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::rhdr" title='reply_state::rhdr' data-ref="reply_state::rhdr" data-ref-filename="reply_state..rhdr">rhdr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#(anonymous)::ifi" title='(anonymous struct)::ifi' data-ref="(anonymous)::ifi" data-ref-filename="(anonymous)..ifi">ifi</a>   = <a class="ref fn" href="#dnssd_htonl" title='dnssd_htonl' data-ref="dnssd_htonl" data-ref-filename="dnssd_htonl">dnssd_htonl</a>(<a class="local col4 ref" href="#424ifi" title='ifi' data-ref="424ifi" data-ref-filename="424ifi">ifi</a>);</td></tr>
<tr><th id="3773">3773</th><td>    <a class="local col7 ref" href="#427reply" title='reply' data-ref="427reply" data-ref-filename="427reply">reply</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::rhdr" title='reply_state::rhdr' data-ref="reply_state::rhdr" data-ref-filename="reply_state..rhdr">rhdr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#(anonymous)::error" title='(anonymous struct)::error' data-ref="(anonymous)::error" data-ref-filename="(anonymous)..error">error</a> = <a class="ref fn" href="#dnssd_htonl" title='dnssd_htonl' data-ref="dnssd_htonl" data-ref-filename="dnssd_htonl">dnssd_htonl</a>(<a class="local col5 ref" href="#425err" title='err' data-ref="425err" data-ref-filename="425err">err</a>);</td></tr>
<tr><th id="3774">3774</th><td>    <a class="local col8 ref" href="#428data" title='data' data-ref="428data" data-ref-filename="428data">data</a> = (<em>char</em> *)&amp;<a class="local col7 ref" href="#427reply" title='reply' data-ref="427reply" data-ref-filename="427reply">reply</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::rhdr" title='reply_state::rhdr' data-ref="reply_state::rhdr" data-ref-filename="reply_state..rhdr">rhdr</a>[<var>1</var>];</td></tr>
<tr><th id="3775">3775</th><td>    <a class="macro" href="dnssd_ipc.h.html#197" title="__dnssd_ipc_put_string" data-ref="_M/put_string">put_string</a>(<a class="local col2 ref" href="#422domain" title='domain' data-ref="422domain" data-ref-filename="422domain">domain</a>, &amp;<a class="local col8 ref" href="#428data" title='data' data-ref="428data" data-ref-filename="428data">data</a>);</td></tr>
<tr><th id="3776">3776</th><td>    <b>return</b> <a class="local col7 ref" href="#427reply" title='reply' data-ref="427reply" data-ref-filename="427reply">reply</a>;</td></tr>
<tr><th id="3777">3777</th><td>}</td></tr>
<tr><th id="3778">3778</th><td></td></tr>
<tr><th id="3779">3779</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="enum_termination_callback" title='enum_termination_callback' data-ref="enum_termination_callback" data-ref-filename="enum_termination_callback">enum_termination_callback</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col9 decl" id="429request" title='request' data-type='request_state *' data-ref="429request" data-ref-filename="429request">request</dfn>)</td></tr>
<tr><th id="3780">3780</th><td>{</td></tr>
<tr><th id="3781">3781</th><td>    <i>// Stop the domain enumeration queries to discover the WAB Browse/Registration domains</i></td></tr>
<tr><th id="3782">3782</th><td>    <b>if</b> (<a class="local col9 ref" href="#429request" title='request' data-ref="429request" data-ref-filename="429request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::enumeration" title='request_state::(anonymous union)::enumeration' data-ref="request_state::(anonymous)::enumeration" data-ref-filename="request_state..(anonymous)..enumeration">enumeration</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::flags" title='request_state::(anonymous union)::(anonymous struct)::flags' data-ref="request_state::(anonymousunion)::(anonymous)::flags" data-ref-filename="request_state..(anonymousunion)..(anonymous)..flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsRegistrationDomains" title='kDNSServiceFlagsRegistrationDomains' data-ref="kDNSServiceFlagsRegistrationDomains" data-ref-filename="kDNSServiceFlagsRegistrationDomains">kDNSServiceFlagsRegistrationDomains</a>)</td></tr>
<tr><th id="3783">3783</th><td>    {</td></tr>
<tr><th id="3784">3784</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;%3d: DNSServiceEnumeration Cancel WAB Registration PID[%d](%s)&quot;, request-&gt;sd, request-&gt;process_id, request-&gt;pid_name);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"%3d: DNSServiceEnumeration Cancel WAB Registration PID[%d](%s)"</q>, <a class="local col9 ref" href="#429request" title='request' data-ref="429request" data-ref-filename="429request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col9 ref" href="#429request" title='request' data-ref="429request" data-ref-filename="429request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col9 ref" href="#429request" title='request' data-ref="429request" data-ref-filename="429request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="3785">3785</th><td>        <a class="ref fn" href="../mDNSCore/uDNS.h.html#uDNS_StopWABQueries" title='uDNS_StopWABQueries' data-ref="uDNS_StopWABQueries" data-ref-filename="uDNS_StopWABQueries">uDNS_StopWABQueries</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="macro" href="../mDNSCore/uDNS.h.html#126" title="0x00000004" data-ref="_M/UDNS_WAB_REG_QUERY">UDNS_WAB_REG_QUERY</a>);</td></tr>
<tr><th id="3786">3786</th><td>    }</td></tr>
<tr><th id="3787">3787</th><td>    <b>else</b></td></tr>
<tr><th id="3788">3788</th><td>    {</td></tr>
<tr><th id="3789">3789</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;%3d: DNSServiceEnumeration Cancel WAB Browse PID[%d](%s)&quot;, request-&gt;sd, request-&gt;process_id, request-&gt;pid_name);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"%3d: DNSServiceEnumeration Cancel WAB Browse PID[%d](%s)"</q>, <a class="local col9 ref" href="#429request" title='request' data-ref="429request" data-ref-filename="429request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col9 ref" href="#429request" title='request' data-ref="429request" data-ref-filename="429request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col9 ref" href="#429request" title='request' data-ref="429request" data-ref-filename="429request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="3790">3790</th><td>        <a class="ref fn" href="../mDNSCore/uDNS.h.html#uDNS_StopWABQueries" title='uDNS_StopWABQueries' data-ref="uDNS_StopWABQueries" data-ref-filename="uDNS_StopWABQueries">uDNS_StopWABQueries</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="macro" href="../mDNSCore/uDNS.h.html#124" title="0x00000001" data-ref="_M/UDNS_WAB_BROWSE_QUERY">UDNS_WAB_BROWSE_QUERY</a> | <a class="macro" href="../mDNSCore/uDNS.h.html#125" title="0x00000002" data-ref="_M/UDNS_WAB_LBROWSE_QUERY">UDNS_WAB_LBROWSE_QUERY</a>);</td></tr>
<tr><th id="3791">3791</th><td>        <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2824" title="mDNS_StopQuery" data-ref="_M/mDNS_StopGetDomains">mDNS_StopGetDomains</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col9 ref" href="#429request" title='request' data-ref="429request" data-ref-filename="429request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::enumeration" title='request_state::(anonymous union)::enumeration' data-ref="request_state::(anonymous)::enumeration" data-ref-filename="request_state..(anonymous)..enumeration">enumeration</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q_autoall" title='request_state::(anonymous union)::(anonymous struct)::q_autoall' data-ref="request_state::(anonymousunion)::(anonymous)::q_autoall" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q_autoall">q_autoall</a>);</td></tr>
<tr><th id="3792">3792</th><td>    }</td></tr>
<tr><th id="3793">3793</th><td>    <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2824" title="mDNS_StopQuery" data-ref="_M/mDNS_StopGetDomains">mDNS_StopGetDomains</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col9 ref" href="#429request" title='request' data-ref="429request" data-ref-filename="429request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::enumeration" title='request_state::(anonymous union)::enumeration' data-ref="request_state::(anonymous)::enumeration" data-ref-filename="request_state..(anonymous)..enumeration">enumeration</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q_all" title='request_state::(anonymous union)::(anonymous struct)::q_all' data-ref="request_state::(anonymousunion)::(anonymous)::q_all" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q_all">q_all</a>);</td></tr>
<tr><th id="3794">3794</th><td>    <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2824" title="mDNS_StopQuery" data-ref="_M/mDNS_StopGetDomains">mDNS_StopGetDomains</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col9 ref" href="#429request" title='request' data-ref="429request" data-ref-filename="429request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::enumeration" title='request_state::(anonymous union)::enumeration' data-ref="request_state::(anonymous)::enumeration" data-ref-filename="request_state..(anonymous)..enumeration">enumeration</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q_default" title='request_state::(anonymous union)::(anonymous struct)::q_default' data-ref="request_state::(anonymousunion)::(anonymous)::q_default" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q_default">q_default</a>);</td></tr>
<tr><th id="3795">3795</th><td>}</td></tr>
<tr><th id="3796">3796</th><td></td></tr>
<tr><th id="3797">3797</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="enum_result_callback" title='enum_result_callback' data-ref="enum_result_callback" data-ref-filename="enum_result_callback">enum_result_callback</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS" title='mDNS' data-type='struct mDNS_struct' data-ref="mDNS" data-ref-filename="mDNS">mDNS</a> *<em>const</em> <dfn class="local col0 decl" id="430m" title='m' data-type='mDNS *const' data-ref="430m" data-ref-filename="430m">m</dfn>,</td></tr>
<tr><th id="3798">3798</th><td>                                    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion" title='DNSQuestion' data-type='struct DNSQuestion_struct' data-ref="DNSQuestion" data-ref-filename="DNSQuestion">DNSQuestion</a> *<em>const</em> <dfn class="local col1 decl" id="431question" title='question' data-type='DNSQuestion *const' data-ref="431question" data-ref-filename="431question">question</dfn>, <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord" title='ResourceRecord' data-type='struct ResourceRecord_struct' data-ref="ResourceRecord" data-ref-filename="ResourceRecord">ResourceRecord</a> *<em>const</em> <dfn class="local col2 decl" id="432answer" title='answer' data-type='const ResourceRecord *const' data-ref="432answer" data-ref-filename="432answer">answer</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#QC_result" title='QC_result' data-type='enum QC_result' data-ref="QC_result" data-ref-filename="QC_result">QC_result</a> <dfn class="local col3 decl" id="433AddRecord" title='AddRecord' data-type='QC_result' data-ref="433AddRecord" data-ref-filename="433AddRecord">AddRecord</dfn>)</td></tr>
<tr><th id="3799">3799</th><td>{</td></tr>
<tr><th id="3800">3800</th><td>    <em>char</em> <dfn class="local col4 decl" id="434domain" title='domain' data-type='char [1009]' data-ref="434domain" data-ref-filename="434domain">domain</dfn>[<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#417" title="1009" data-ref="_M/MAX_ESCAPED_DOMAIN_NAME">MAX_ESCAPED_DOMAIN_NAME</a>];</td></tr>
<tr><th id="3801">3801</th><td>    <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col5 decl" id="435request" title='request' data-type='request_state *' data-ref="435request" data-ref-filename="435request">request</dfn> = <a class="local col1 ref" href="#431question" title='question' data-ref="431question" data-ref-filename="431question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::QuestionContext" title='DNSQuestion_struct::QuestionContext' data-ref="DNSQuestion_struct::QuestionContext" data-ref-filename="DNSQuestion_struct..QuestionContext">QuestionContext</a>;</td></tr>
<tr><th id="3802">3802</th><td>    <a class="typedef" href="dns_sd.h.html#DNSServiceFlags" title='DNSServiceFlags' data-type='uint32_t' data-ref="DNSServiceFlags" data-ref-filename="DNSServiceFlags">DNSServiceFlags</a> <dfn class="local col6 decl" id="436flags" title='flags' data-type='DNSServiceFlags' data-ref="436flags" data-ref-filename="436flags">flags</dfn> = <var>0</var>;</td></tr>
<tr><th id="3803">3803</th><td>    <a class="typedef" href="uds_daemon.h.html#reply_state" title='reply_state' data-type='struct reply_state' data-ref="reply_state" data-ref-filename="reply_state">reply_state</a> *<dfn class="local col7 decl" id="437reply" title='reply' data-type='reply_state *' data-ref="437reply" data-ref-filename="437reply">reply</dfn>;</td></tr>
<tr><th id="3804">3804</th><td>    (<em>void</em>)<a class="local col0 ref" href="#430m" title='m' data-ref="430m" data-ref-filename="430m">m</a>; <i>// Unused</i></td></tr>
<tr><th id="3805">3805</th><td></td></tr>
<tr><th id="3806">3806</th><td>    <b>if</b> (<a class="local col2 ref" href="#432answer" title='answer' data-ref="432answer" data-ref-filename="432answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rrtype" title='ResourceRecord_struct::rrtype' data-ref="ResourceRecord_struct::rrtype" data-ref-filename="ResourceRecord_struct..rrtype">rrtype</a> != <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSType_PTR" title='kDNSType_PTR' data-ref="kDNSType_PTR" data-ref-filename="kDNSType_PTR">kDNSType_PTR</a>) <b>return</b>;</td></tr>
<tr><th id="3807">3807</th><td></td></tr>
<tr><th id="3808">3808</th><td><u>#<span data-ppcond="3808">if</span> 0</u></td></tr>
<tr><th id="3809">3809</th><td>    <b>if</b> (!AuthorizedDomain(request, &amp;answer-&gt;rdata-&gt;u.name, request-&gt;u.enumeration.flags ? AutoRegistrationDomains : AutoBrowseDomains)) <b>return</b>;</td></tr>
<tr><th id="3810">3810</th><td><u>#<span data-ppcond="3808">endif</span></u></td></tr>
<tr><th id="3811">3811</th><td></td></tr>
<tr><th id="3812">3812</th><td>    <i>// We only return add/remove events for the browse and registration lists</i></td></tr>
<tr><th id="3813">3813</th><td><i>    // For the default browse and registration answers, we only give an "ADD" event</i></td></tr>
<tr><th id="3814">3814</th><td>    <b>if</b> (<a class="local col1 ref" href="#431question" title='question' data-ref="431question" data-ref-filename="431question">question</a> == &amp;<a class="local col5 ref" href="#435request" title='request' data-ref="435request" data-ref-filename="435request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::enumeration" title='request_state::(anonymous union)::enumeration' data-ref="request_state::(anonymous)::enumeration" data-ref-filename="request_state..(anonymous)..enumeration">enumeration</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q_default" title='request_state::(anonymous union)::(anonymous struct)::q_default' data-ref="request_state::(anonymousunion)::(anonymous)::q_default" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q_default">q_default</a> &amp;&amp; !<a class="local col3 ref" href="#433AddRecord" title='AddRecord' data-ref="433AddRecord" data-ref-filename="433AddRecord">AddRecord</a>) <b>return</b>;</td></tr>
<tr><th id="3815">3815</th><td></td></tr>
<tr><th id="3816">3816</th><td>    <b>if</b> (<a class="local col3 ref" href="#433AddRecord" title='AddRecord' data-ref="433AddRecord" data-ref-filename="433AddRecord">AddRecord</a>)</td></tr>
<tr><th id="3817">3817</th><td>    {</td></tr>
<tr><th id="3818">3818</th><td>        <a class="local col6 ref" href="#436flags" title='flags' data-ref="436flags" data-ref-filename="436flags">flags</a> |= <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsAdd" title='kDNSServiceFlagsAdd' data-ref="kDNSServiceFlagsAdd" data-ref-filename="kDNSServiceFlagsAdd">kDNSServiceFlagsAdd</a>;</td></tr>
<tr><th id="3819">3819</th><td>        <b>if</b> (<a class="local col1 ref" href="#431question" title='question' data-ref="431question" data-ref-filename="431question">question</a> == &amp;<a class="local col5 ref" href="#435request" title='request' data-ref="435request" data-ref-filename="435request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::enumeration" title='request_state::(anonymous union)::enumeration' data-ref="request_state::(anonymous)::enumeration" data-ref-filename="request_state..(anonymous)..enumeration">enumeration</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q_default" title='request_state::(anonymous union)::(anonymous struct)::q_default' data-ref="request_state::(anonymousunion)::(anonymous)::q_default" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q_default">q_default</a>) <a class="local col6 ref" href="#436flags" title='flags' data-ref="436flags" data-ref-filename="436flags">flags</a> |= <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsDefault" title='kDNSServiceFlagsDefault' data-ref="kDNSServiceFlagsDefault" data-ref-filename="kDNSServiceFlagsDefault">kDNSServiceFlagsDefault</a>;</td></tr>
<tr><th id="3820">3820</th><td>    }</td></tr>
<tr><th id="3821">3821</th><td></td></tr>
<tr><th id="3822">3822</th><td>    <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2903" title="ConvertDomainNameToCString_withescape((&amp;answer-&gt;rdata-&gt;u.name), (domain), &apos;\\&apos;)" data-ref="_M/ConvertDomainNameToCString">ConvertDomainNameToCString</a>(&amp;<a class="local col2 ref" href="#432answer" title='answer' data-ref="432answer" data-ref-filename="432answer">answer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rdata" title='ResourceRecord_struct::rdata' data-ref="ResourceRecord_struct::rdata" data-ref-filename="ResourceRecord_struct..rdata">rdata</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::u" title='(anonymous struct)::u' data-ref="(anonymous)::u" data-ref-filename="(anonymous)..u">u</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::name" title='(anonymous union)::name' data-ref="(anonymous)::name" data-ref-filename="(anonymous)..name">name</a>, <a class="local col4 ref" href="#434domain" title='domain' data-ref="434domain" data-ref-filename="434domain">domain</a>);</td></tr>
<tr><th id="3823">3823</th><td>    <i>// Note that we do NOT propagate specific interface indexes to the client - for example, a domain we learn from</i></td></tr>
<tr><th id="3824">3824</th><td><i>    // a machine's system preferences may be discovered on the LocalOnly interface, but should be browsed on the</i></td></tr>
<tr><th id="3825">3825</th><td><i>    // network, so we just pass kDNSServiceInterfaceIndexAny</i></td></tr>
<tr><th id="3826">3826</th><td>    <a class="local col7 ref" href="#437reply" title='reply' data-ref="437reply" data-ref-filename="437reply">reply</a> = <a class="ref fn" href="#format_enumeration_reply" title='format_enumeration_reply' data-ref="format_enumeration_reply" data-ref-filename="format_enumeration_reply">format_enumeration_reply</a>(<a class="local col5 ref" href="#435request" title='request' data-ref="435request" data-ref-filename="435request">request</a>, <a class="local col4 ref" href="#434domain" title='domain' data-ref="434domain" data-ref-filename="434domain">domain</a>, <a class="local col6 ref" href="#436flags" title='flags' data-ref="436flags" data-ref-filename="436flags">flags</a>, <a class="macro" href="dns_sd.h.html#839" title="0" data-ref="_M/kDNSServiceInterfaceIndexAny">kDNSServiceInterfaceIndexAny</a>, <a class="enum" href="dns_sd.h.html#kDNSServiceErr_NoError" title='kDNSServiceErr_NoError' data-ref="kDNSServiceErr_NoError" data-ref-filename="kDNSServiceErr_NoError">kDNSServiceErr_NoError</a>);</td></tr>
<tr><th id="3827">3827</th><td>    <b>if</b> (!<a class="local col7 ref" href="#437reply" title='reply' data-ref="437reply" data-ref-filename="437reply">reply</a>) { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;ERROR: enum_result_callback, format_enumeration_reply&quot;)" data-ref="_M/LogMsg">LogMsg</a>(<q>"ERROR: enum_result_callback, format_enumeration_reply"</q>); <b>return</b>; }</td></tr>
<tr><th id="3828">3828</th><td></td></tr>
<tr><th id="3829">3829</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: DNSServiceEnumerateDomains(%#2s) RESULT %s: %s&quot;, request-&gt;sd, question-&gt;qname.c, AddRecord ? &quot;ADD&quot; : &quot;RMV&quot;, domain);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: DNSServiceEnumerateDomains(%#2s) RESULT %s: %s"</q>, <a class="local col5 ref" href="#435request" title='request' data-ref="435request" data-ref-filename="435request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col1 ref" href="#431question" title='question' data-ref="431question" data-ref-filename="431question">question</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="local col3 ref" href="#433AddRecord" title='AddRecord' data-ref="433AddRecord" data-ref-filename="433AddRecord">AddRecord</a> ? <q>"ADD"</q> : <q>"RMV"</q>, <a class="local col4 ref" href="#434domain" title='domain' data-ref="434domain" data-ref-filename="434domain">domain</a>);</td></tr>
<tr><th id="3830">3830</th><td></td></tr>
<tr><th id="3831">3831</th><td>    <a class="ref fn" href="#append_reply" title='append_reply' data-ref="append_reply" data-ref-filename="append_reply">append_reply</a>(<a class="local col5 ref" href="#435request" title='request' data-ref="435request" data-ref-filename="435request">request</a>, <a class="local col7 ref" href="#437reply" title='reply' data-ref="437reply" data-ref-filename="437reply">reply</a>);</td></tr>
<tr><th id="3832">3832</th><td>}</td></tr>
<tr><th id="3833">3833</th><td></td></tr>
<tr><th id="3834">3834</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="decl def fn" id="handle_enum_request" title='handle_enum_request' data-ref="handle_enum_request" data-ref-filename="handle_enum_request">handle_enum_request</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col8 decl" id="438request" title='request' data-type='request_state *' data-ref="438request" data-ref-filename="438request">request</dfn>)</td></tr>
<tr><th id="3835">3835</th><td>{</td></tr>
<tr><th id="3836">3836</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="local col9 decl" id="439err" title='err' data-type='mStatus' data-ref="439err" data-ref-filename="439err">err</dfn>;</td></tr>
<tr><th id="3837">3837</th><td>    <a class="typedef" href="dns_sd.h.html#DNSServiceFlags" title='DNSServiceFlags' data-type='uint32_t' data-ref="DNSServiceFlags" data-ref-filename="DNSServiceFlags">DNSServiceFlags</a> <dfn class="local col0 decl" id="440flags" title='flags' data-type='DNSServiceFlags' data-ref="440flags" data-ref-filename="440flags">flags</dfn> = <a class="macro" href="dnssd_ipc.h.html#210" title="__dnssd_ipc_get_uint32" data-ref="_M/get_flags">get_flags</a>(&amp;<a class="local col8 ref" href="#438request" title='request' data-ref="438request" data-ref-filename="438request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col8 ref" href="#438request" title='request' data-ref="438request" data-ref-filename="438request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);</td></tr>
<tr><th id="3838">3838</th><td>    <a class="typedef" href="dns_sd.h.html#DNSServiceFlags" title='DNSServiceFlags' data-type='uint32_t' data-ref="DNSServiceFlags" data-ref-filename="DNSServiceFlags">DNSServiceFlags</a> <dfn class="local col1 decl" id="441reg" title='reg' data-type='DNSServiceFlags' data-ref="441reg" data-ref-filename="441reg">reg</dfn> = <a class="local col0 ref" href="#440flags" title='flags' data-ref="440flags" data-ref-filename="440flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsRegistrationDomains" title='kDNSServiceFlagsRegistrationDomains' data-ref="kDNSServiceFlagsRegistrationDomains" data-ref-filename="kDNSServiceFlagsRegistrationDomains">kDNSServiceFlagsRegistrationDomains</a>;</td></tr>
<tr><th id="3839">3839</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_DomainType" title='mDNS_DomainType' data-type='enum mDNS_DomainType' data-ref="mDNS_DomainType" data-ref-filename="mDNS_DomainType">mDNS_DomainType</a> <dfn class="local col2 decl" id="442t_all" title='t_all' data-type='mDNS_DomainType' data-ref="442t_all" data-ref-filename="442t_all">t_all</dfn>     = <a class="local col1 ref" href="#441reg" title='reg' data-ref="441reg" data-ref-filename="441reg">reg</a> ? <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_DomainTypeRegistration" title='mDNS_DomainTypeRegistration' data-ref="mDNS_DomainTypeRegistration" data-ref-filename="mDNS_DomainTypeRegistration">mDNS_DomainTypeRegistration</a>        : <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_DomainTypeBrowse" title='mDNS_DomainTypeBrowse' data-ref="mDNS_DomainTypeBrowse" data-ref-filename="mDNS_DomainTypeBrowse">mDNS_DomainTypeBrowse</a>;</td></tr>
<tr><th id="3840">3840</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_DomainType" title='mDNS_DomainType' data-type='enum mDNS_DomainType' data-ref="mDNS_DomainType" data-ref-filename="mDNS_DomainType">mDNS_DomainType</a> <dfn class="local col3 decl" id="443t_default" title='t_default' data-type='mDNS_DomainType' data-ref="443t_default" data-ref-filename="443t_default">t_default</dfn> = <a class="local col1 ref" href="#441reg" title='reg' data-ref="441reg" data-ref-filename="441reg">reg</a> ? <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_DomainTypeRegistrationDefault" title='mDNS_DomainTypeRegistrationDefault' data-ref="mDNS_DomainTypeRegistrationDefault" data-ref-filename="mDNS_DomainTypeRegistrationDefault">mDNS_DomainTypeRegistrationDefault</a> : <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_DomainTypeBrowseDefault" title='mDNS_DomainTypeBrowseDefault' data-ref="mDNS_DomainTypeBrowseDefault" data-ref-filename="mDNS_DomainTypeBrowseDefault">mDNS_DomainTypeBrowseDefault</a>;</td></tr>
<tr><th id="3841">3841</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col4 decl" id="444interfaceIndex" title='interfaceIndex' data-type='mDNSu32' data-ref="444interfaceIndex" data-ref-filename="444interfaceIndex">interfaceIndex</dfn> = <a class="macro" href="dnssd_ipc.h.html#194" title="__dnssd_ipc_get_uint32" data-ref="_M/get_uint32">get_uint32</a>(&amp;<a class="local col8 ref" href="#438request" title='request' data-ref="438request" data-ref-filename="438request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col8 ref" href="#438request" title='request' data-ref="438request" data-ref-filename="438request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);</td></tr>
<tr><th id="3842">3842</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterfaceID" title='mDNSInterfaceID' data-type='struct mDNSInterfaceID_dummystruct *' data-ref="mDNSInterfaceID" data-ref-filename="mDNSInterfaceID">mDNSInterfaceID</a> <dfn class="local col5 decl" id="445InterfaceID" title='InterfaceID' data-type='mDNSInterfaceID' data-ref="445InterfaceID" data-ref-filename="445InterfaceID">InterfaceID</dfn> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformInterfaceIDfromInterfaceIndex" title='mDNSPlatformInterfaceIDfromInterfaceIndex' data-ref="mDNSPlatformInterfaceIDfromInterfaceIndex" data-ref-filename="mDNSPlatformInterfaceIDfromInterfaceIndex">mDNSPlatformInterfaceIDfromInterfaceIndex</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col4 ref" href="#444interfaceIndex" title='interfaceIndex' data-ref="444interfaceIndex" data-ref-filename="444interfaceIndex">interfaceIndex</a>);</td></tr>
<tr><th id="3843">3843</th><td>    <b>if</b> (<a class="local col4 ref" href="#444interfaceIndex" title='interfaceIndex' data-ref="444interfaceIndex" data-ref-filename="444interfaceIndex">interfaceIndex</a> &amp;&amp; !<a class="local col5 ref" href="#445InterfaceID" title='InterfaceID' data-ref="445InterfaceID" data-ref-filename="445InterfaceID">InterfaceID</a>) <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>);</td></tr>
<tr><th id="3844">3844</th><td></td></tr>
<tr><th id="3845">3845</th><td>    <b>if</b> (!<a class="local col8 ref" href="#438request" title='request' data-ref="438request" data-ref-filename="438request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>)</td></tr>
<tr><th id="3846">3846</th><td>    { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: DNSServiceEnumerateDomains(unreadable parameters)&quot;, request-&gt;sd)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: DNSServiceEnumerateDomains(unreadable parameters)"</q>, <a class="local col8 ref" href="#438request" title='request' data-ref="438request" data-ref-filename="438request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>); <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>); }</td></tr>
<tr><th id="3847">3847</th><td></td></tr>
<tr><th id="3848">3848</th><td>    <a class="local col8 ref" href="#438request" title='request' data-ref="438request" data-ref-filename="438request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a> = <a class="local col0 ref" href="#440flags" title='flags' data-ref="440flags" data-ref-filename="440flags">flags</a>;</td></tr>
<tr><th id="3849">3849</th><td>    <a class="local col8 ref" href="#438request" title='request' data-ref="438request" data-ref-filename="438request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::interfaceIndex" title='request_state::interfaceIndex' data-ref="request_state::interfaceIndex" data-ref-filename="request_state..interfaceIndex">interfaceIndex</a> = <a class="local col4 ref" href="#444interfaceIndex" title='interfaceIndex' data-ref="444interfaceIndex" data-ref-filename="444interfaceIndex">interfaceIndex</a>;</td></tr>
<tr><th id="3850">3850</th><td></td></tr>
<tr><th id="3851">3851</th><td>    <i>// mark which kind of enumeration we're doing so that we know what domain enumeration queries to stop</i></td></tr>
<tr><th id="3852">3852</th><td>    <a class="local col8 ref" href="#438request" title='request' data-ref="438request" data-ref-filename="438request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::enumeration" title='request_state::(anonymous union)::enumeration' data-ref="request_state::(anonymous)::enumeration" data-ref-filename="request_state..(anonymous)..enumeration">enumeration</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::flags" title='request_state::(anonymous union)::(anonymous struct)::flags' data-ref="request_state::(anonymousunion)::(anonymous)::flags" data-ref-filename="request_state..(anonymousunion)..(anonymous)..flags">flags</a> = <a class="local col1 ref" href="#441reg" title='reg' data-ref="441reg" data-ref-filename="441reg">reg</a>;</td></tr>
<tr><th id="3853">3853</th><td></td></tr>
<tr><th id="3854">3854</th><td>    <i>// enumeration requires multiple questions, so we must link all the context pointers so that</i></td></tr>
<tr><th id="3855">3855</th><td><i>    // necessary context can be reached from the callbacks</i></td></tr>
<tr><th id="3856">3856</th><td>    <a class="local col8 ref" href="#438request" title='request' data-ref="438request" data-ref-filename="438request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::enumeration" title='request_state::(anonymous union)::enumeration' data-ref="request_state::(anonymous)::enumeration" data-ref-filename="request_state..(anonymous)..enumeration">enumeration</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q_all" title='request_state::(anonymous union)::(anonymous struct)::q_all' data-ref="request_state::(anonymousunion)::(anonymous)::q_all" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q_all">q_all</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::QuestionContext" title='DNSQuestion_struct::QuestionContext' data-ref="DNSQuestion_struct::QuestionContext" data-ref-filename="DNSQuestion_struct..QuestionContext">QuestionContext</a> = <a class="local col8 ref" href="#438request" title='request' data-ref="438request" data-ref-filename="438request">request</a>;</td></tr>
<tr><th id="3857">3857</th><td>    <a class="local col8 ref" href="#438request" title='request' data-ref="438request" data-ref-filename="438request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::enumeration" title='request_state::(anonymous union)::enumeration' data-ref="request_state::(anonymous)::enumeration" data-ref-filename="request_state..(anonymous)..enumeration">enumeration</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q_default" title='request_state::(anonymous union)::(anonymous struct)::q_default' data-ref="request_state::(anonymousunion)::(anonymous)::q_default" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q_default">q_default</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::QuestionContext" title='DNSQuestion_struct::QuestionContext' data-ref="DNSQuestion_struct::QuestionContext" data-ref-filename="DNSQuestion_struct..QuestionContext">QuestionContext</a> = <a class="local col8 ref" href="#438request" title='request' data-ref="438request" data-ref-filename="438request">request</a>;</td></tr>
<tr><th id="3858">3858</th><td>    <b>if</b> (!<a class="local col1 ref" href="#441reg" title='reg' data-ref="441reg" data-ref-filename="441reg">reg</a>) <a class="local col8 ref" href="#438request" title='request' data-ref="438request" data-ref-filename="438request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::enumeration" title='request_state::(anonymous union)::enumeration' data-ref="request_state::(anonymous)::enumeration" data-ref-filename="request_state..(anonymous)..enumeration">enumeration</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q_autoall" title='request_state::(anonymous union)::(anonymous struct)::q_autoall' data-ref="request_state::(anonymousunion)::(anonymous)::q_autoall" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q_autoall">q_autoall</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::QuestionContext" title='DNSQuestion_struct::QuestionContext' data-ref="DNSQuestion_struct::QuestionContext" data-ref-filename="DNSQuestion_struct..QuestionContext">QuestionContext</a> = <a class="local col8 ref" href="#438request" title='request' data-ref="438request" data-ref-filename="438request">request</a>;</td></tr>
<tr><th id="3859">3859</th><td></td></tr>
<tr><th id="3860">3860</th><td>    <i>// if the caller hasn't specified an explicit interface, we use local-only to get the system-wide list.</i></td></tr>
<tr><th id="3861">3861</th><td>    <b>if</b> (!<a class="local col5 ref" href="#445InterfaceID" title='InterfaceID' data-ref="445InterfaceID" data-ref-filename="445InterfaceID">InterfaceID</a>) <a class="local col5 ref" href="#445InterfaceID" title='InterfaceID' data-ref="445InterfaceID" data-ref-filename="445InterfaceID">InterfaceID</a> = <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterface_LocalOnly" title='mDNSInterface_LocalOnly' data-ref="mDNSInterface_LocalOnly" data-ref-filename="mDNSInterface_LocalOnly">mDNSInterface_LocalOnly</a>;</td></tr>
<tr><th id="3862">3862</th><td></td></tr>
<tr><th id="3863">3863</th><td>    <i>// make the calls</i></td></tr>
<tr><th id="3864">3864</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: DNSServiceEnumerateDomains(%X=%s)&quot;, request-&gt;sd, flags, (flags &amp; kDNSServiceFlagsBrowseDomains ) ? &quot;kDNSServiceFlagsBrowseDomains&quot; : (flags &amp; kDNSServiceFlagsRegistrationDomains) ? &quot;kDNSServiceFlagsRegistrationDomains&quot; : &quot;&lt;&lt;Unknown&gt;&gt;&quot;);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: DNSServiceEnumerateDomains(%X=%s)"</q>, <a class="local col8 ref" href="#438request" title='request' data-ref="438request" data-ref-filename="438request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col0 ref" href="#440flags" title='flags' data-ref="440flags" data-ref-filename="440flags">flags</a>,</td></tr>
<tr><th id="3865">3865</th><td>                 (<a class="local col0 ref" href="#440flags" title='flags' data-ref="440flags" data-ref-filename="440flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsBrowseDomains" title='kDNSServiceFlagsBrowseDomains' data-ref="kDNSServiceFlagsBrowseDomains" data-ref-filename="kDNSServiceFlagsBrowseDomains">kDNSServiceFlagsBrowseDomains</a>      ) ? <q>"kDNSServiceFlagsBrowseDomains"</q> :</td></tr>
<tr><th id="3866">3866</th><td>                 (<a class="local col0 ref" href="#440flags" title='flags' data-ref="440flags" data-ref-filename="440flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsRegistrationDomains" title='kDNSServiceFlagsRegistrationDomains' data-ref="kDNSServiceFlagsRegistrationDomains" data-ref-filename="kDNSServiceFlagsRegistrationDomains">kDNSServiceFlagsRegistrationDomains</a>) ? <q>"kDNSServiceFlagsRegistrationDomains"</q> : <q>"&lt;&lt;Unknown&gt;&gt;"</q>);</td></tr>
<tr><th id="3867">3867</th><td>    <a class="local col9 ref" href="#439err" title='err' data-ref="439err" data-ref-filename="439err">err</a> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_GetDomains" title='mDNS_GetDomains' data-ref="mDNS_GetDomains" data-ref-filename="mDNS_GetDomains">mDNS_GetDomains</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col8 ref" href="#438request" title='request' data-ref="438request" data-ref-filename="438request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::enumeration" title='request_state::(anonymous union)::enumeration' data-ref="request_state::(anonymous)::enumeration" data-ref-filename="request_state..(anonymous)..enumeration">enumeration</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q_all" title='request_state::(anonymous union)::(anonymous struct)::q_all' data-ref="request_state::(anonymousunion)::(anonymous)::q_all" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q_all">q_all</a>, <a class="local col2 ref" href="#442t_all" title='t_all' data-ref="442t_all" data-ref-filename="442t_all">t_all</a>, <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>, <a class="local col5 ref" href="#445InterfaceID" title='InterfaceID' data-ref="445InterfaceID" data-ref-filename="445InterfaceID">InterfaceID</a>, <a class="ref fn" href="#enum_result_callback" title='enum_result_callback' data-ref="enum_result_callback" data-ref-filename="enum_result_callback">enum_result_callback</a>, <a class="local col8 ref" href="#438request" title='request' data-ref="438request" data-ref-filename="438request">request</a>);</td></tr>
<tr><th id="3868">3868</th><td>    <b>if</b> (!<a class="local col9 ref" href="#439err" title='err' data-ref="439err" data-ref-filename="439err">err</a>)</td></tr>
<tr><th id="3869">3869</th><td>    {</td></tr>
<tr><th id="3870">3870</th><td>        <a class="local col9 ref" href="#439err" title='err' data-ref="439err" data-ref-filename="439err">err</a> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_GetDomains" title='mDNS_GetDomains' data-ref="mDNS_GetDomains" data-ref-filename="mDNS_GetDomains">mDNS_GetDomains</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col8 ref" href="#438request" title='request' data-ref="438request" data-ref-filename="438request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::enumeration" title='request_state::(anonymous union)::enumeration' data-ref="request_state::(anonymous)::enumeration" data-ref-filename="request_state..(anonymous)..enumeration">enumeration</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q_default" title='request_state::(anonymous union)::(anonymous struct)::q_default' data-ref="request_state::(anonymousunion)::(anonymous)::q_default" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q_default">q_default</a>, <a class="local col3 ref" href="#443t_default" title='t_default' data-ref="443t_default" data-ref-filename="443t_default">t_default</a>, <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>, <a class="local col5 ref" href="#445InterfaceID" title='InterfaceID' data-ref="445InterfaceID" data-ref-filename="445InterfaceID">InterfaceID</a>, <a class="ref fn" href="#enum_result_callback" title='enum_result_callback' data-ref="enum_result_callback" data-ref-filename="enum_result_callback">enum_result_callback</a>, <a class="local col8 ref" href="#438request" title='request' data-ref="438request" data-ref-filename="438request">request</a>);</td></tr>
<tr><th id="3871">3871</th><td>        <b>if</b> (<a class="local col9 ref" href="#439err" title='err' data-ref="439err" data-ref-filename="439err">err</a>) <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2824" title="mDNS_StopQuery" data-ref="_M/mDNS_StopGetDomains">mDNS_StopGetDomains</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col8 ref" href="#438request" title='request' data-ref="438request" data-ref-filename="438request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::enumeration" title='request_state::(anonymous union)::enumeration' data-ref="request_state::(anonymous)::enumeration" data-ref-filename="request_state..(anonymous)..enumeration">enumeration</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q_all" title='request_state::(anonymous union)::(anonymous struct)::q_all' data-ref="request_state::(anonymousunion)::(anonymous)::q_all" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q_all">q_all</a>);</td></tr>
<tr><th id="3872">3872</th><td>        <b>else</b> <b>if</b> (!<a class="local col1 ref" href="#441reg" title='reg' data-ref="441reg" data-ref-filename="441reg">reg</a>)</td></tr>
<tr><th id="3873">3873</th><td>        {</td></tr>
<tr><th id="3874">3874</th><td>            <a class="local col9 ref" href="#439err" title='err' data-ref="439err" data-ref-filename="439err">err</a> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_GetDomains" title='mDNS_GetDomains' data-ref="mDNS_GetDomains" data-ref-filename="mDNS_GetDomains">mDNS_GetDomains</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col8 ref" href="#438request" title='request' data-ref="438request" data-ref-filename="438request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::enumeration" title='request_state::(anonymous union)::enumeration' data-ref="request_state::(anonymous)::enumeration" data-ref-filename="request_state..(anonymous)..enumeration">enumeration</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q_autoall" title='request_state::(anonymous union)::(anonymous struct)::q_autoall' data-ref="request_state::(anonymousunion)::(anonymous)::q_autoall" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q_autoall">q_autoall</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_DomainTypeBrowseAutomatic" title='mDNS_DomainTypeBrowseAutomatic' data-ref="mDNS_DomainTypeBrowseAutomatic" data-ref-filename="mDNS_DomainTypeBrowseAutomatic">mDNS_DomainTypeBrowseAutomatic</a>, <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>, <a class="local col5 ref" href="#445InterfaceID" title='InterfaceID' data-ref="445InterfaceID" data-ref-filename="445InterfaceID">InterfaceID</a>, <a class="ref fn" href="#enum_result_callback" title='enum_result_callback' data-ref="enum_result_callback" data-ref-filename="enum_result_callback">enum_result_callback</a>, <a class="local col8 ref" href="#438request" title='request' data-ref="438request" data-ref-filename="438request">request</a>);</td></tr>
<tr><th id="3875">3875</th><td>            <b>if</b> (<a class="local col9 ref" href="#439err" title='err' data-ref="439err" data-ref-filename="439err">err</a>)</td></tr>
<tr><th id="3876">3876</th><td>            {</td></tr>
<tr><th id="3877">3877</th><td>                <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2824" title="mDNS_StopQuery" data-ref="_M/mDNS_StopGetDomains">mDNS_StopGetDomains</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col8 ref" href="#438request" title='request' data-ref="438request" data-ref-filename="438request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::enumeration" title='request_state::(anonymous union)::enumeration' data-ref="request_state::(anonymous)::enumeration" data-ref-filename="request_state..(anonymous)..enumeration">enumeration</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q_all" title='request_state::(anonymous union)::(anonymous struct)::q_all' data-ref="request_state::(anonymousunion)::(anonymous)::q_all" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q_all">q_all</a>);</td></tr>
<tr><th id="3878">3878</th><td>                <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2824" title="mDNS_StopQuery" data-ref="_M/mDNS_StopGetDomains">mDNS_StopGetDomains</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col8 ref" href="#438request" title='request' data-ref="438request" data-ref-filename="438request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::enumeration" title='request_state::(anonymous union)::enumeration' data-ref="request_state::(anonymous)::enumeration" data-ref-filename="request_state..(anonymous)..enumeration">enumeration</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q_default" title='request_state::(anonymous union)::(anonymous struct)::q_default' data-ref="request_state::(anonymousunion)::(anonymous)::q_default" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q_default">q_default</a>);</td></tr>
<tr><th id="3879">3879</th><td>            }</td></tr>
<tr><th id="3880">3880</th><td>        }</td></tr>
<tr><th id="3881">3881</th><td>        <b>if</b> (!<a class="local col9 ref" href="#439err" title='err' data-ref="439err" data-ref-filename="439err">err</a>) <a class="local col8 ref" href="#438request" title='request' data-ref="438request" data-ref-filename="438request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> = <a class="ref fn" href="#enum_termination_callback" title='enum_termination_callback' data-ref="enum_termination_callback" data-ref-filename="enum_termination_callback">enum_termination_callback</a>;</td></tr>
<tr><th id="3882">3882</th><td>    }</td></tr>
<tr><th id="3883">3883</th><td>    <b>if</b> (!<a class="local col9 ref" href="#439err" title='err' data-ref="439err" data-ref-filename="439err">err</a>)</td></tr>
<tr><th id="3884">3884</th><td>    {</td></tr>
<tr><th id="3885">3885</th><td>        <i>// Start the domain enumeration queries to discover the WAB Browse/Registration domains</i></td></tr>
<tr><th id="3886">3886</th><td>        <b>if</b> (<a class="local col1 ref" href="#441reg" title='reg' data-ref="441reg" data-ref-filename="441reg">reg</a>)</td></tr>
<tr><th id="3887">3887</th><td>        {</td></tr>
<tr><th id="3888">3888</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;%3d: DNSServiceEnumerateDomains Start WAB Registration PID[%d](%s)&quot;, request-&gt;sd, request-&gt;process_id, request-&gt;pid_name);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"%3d: DNSServiceEnumerateDomains Start WAB Registration PID[%d](%s)"</q>, <a class="local col8 ref" href="#438request" title='request' data-ref="438request" data-ref-filename="438request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col8 ref" href="#438request" title='request' data-ref="438request" data-ref-filename="438request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col8 ref" href="#438request" title='request' data-ref="438request" data-ref-filename="438request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="3889">3889</th><td>            <a class="ref fn" href="../mDNSCore/uDNS.h.html#uDNS_StartWABQueries" title='uDNS_StartWABQueries' data-ref="uDNS_StartWABQueries" data-ref-filename="uDNS_StartWABQueries">uDNS_StartWABQueries</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="macro" href="../mDNSCore/uDNS.h.html#126" title="0x00000004" data-ref="_M/UDNS_WAB_REG_QUERY">UDNS_WAB_REG_QUERY</a>);</td></tr>
<tr><th id="3890">3890</th><td>        }</td></tr>
<tr><th id="3891">3891</th><td>        <b>else</b></td></tr>
<tr><th id="3892">3892</th><td>        {</td></tr>
<tr><th id="3893">3893</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;%3d: DNSServiceEnumerateDomains Start WAB Browse PID[%d](%s)&quot;, request-&gt;sd, request-&gt;process_id, request-&gt;pid_name);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"%3d: DNSServiceEnumerateDomains Start WAB Browse PID[%d](%s)"</q>, <a class="local col8 ref" href="#438request" title='request' data-ref="438request" data-ref-filename="438request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col8 ref" href="#438request" title='request' data-ref="438request" data-ref-filename="438request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col8 ref" href="#438request" title='request' data-ref="438request" data-ref-filename="438request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="3894">3894</th><td>            <a class="ref fn" href="../mDNSCore/uDNS.h.html#uDNS_StartWABQueries" title='uDNS_StartWABQueries' data-ref="uDNS_StartWABQueries" data-ref-filename="uDNS_StartWABQueries">uDNS_StartWABQueries</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="macro" href="../mDNSCore/uDNS.h.html#124" title="0x00000001" data-ref="_M/UDNS_WAB_BROWSE_QUERY">UDNS_WAB_BROWSE_QUERY</a> | <a class="macro" href="../mDNSCore/uDNS.h.html#125" title="0x00000002" data-ref="_M/UDNS_WAB_LBROWSE_QUERY">UDNS_WAB_LBROWSE_QUERY</a>);</td></tr>
<tr><th id="3895">3895</th><td>        }</td></tr>
<tr><th id="3896">3896</th><td>    }</td></tr>
<tr><th id="3897">3897</th><td></td></tr>
<tr><th id="3898">3898</th><td>    <b>return</b>(<a class="local col9 ref" href="#439err" title='err' data-ref="439err" data-ref-filename="439err">err</a>);</td></tr>
<tr><th id="3899">3899</th><td>}</td></tr>
<tr><th id="3900">3900</th><td></td></tr>
<tr><th id="3901">3901</th><td><i>// ***************************************************************************</i></td></tr>
<tr><th id="3902">3902</th><td><u>#<span data-ppcond="3902">if</span> COMPILER_LIKES_PRAGMA_MARK</u></td></tr>
<tr><th id="3903">3903</th><td><u>#pragma mark -</u></td></tr>
<tr><th id="3904">3904</th><td><u>#pragma mark - DNSServiceReconfirmRecord &amp; Misc</u></td></tr>
<tr><th id="3905">3905</th><td><u>#<span data-ppcond="3902">endif</span></u></td></tr>
<tr><th id="3906">3906</th><td></td></tr>
<tr><th id="3907">3907</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="decl def fn" id="handle_reconfirm_request" title='handle_reconfirm_request' data-ref="handle_reconfirm_request" data-ref-filename="handle_reconfirm_request">handle_reconfirm_request</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col6 decl" id="446request" title='request' data-type='request_state *' data-ref="446request" data-ref-filename="446request">request</dfn>)</td></tr>
<tr><th id="3908">3908</th><td>{</td></tr>
<tr><th id="3909">3909</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="local col7 decl" id="447status" title='status' data-type='mStatus' data-ref="447status" data-ref-filename="447status">status</dfn> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>;</td></tr>
<tr><th id="3910">3910</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord" title='AuthRecord' data-type='struct AuthRecord_struct' data-ref="AuthRecord" data-ref-filename="AuthRecord">AuthRecord</a> *<dfn class="local col8 decl" id="448rr" title='rr' data-type='AuthRecord *' data-ref="448rr" data-ref-filename="448rr">rr</dfn> = <a class="ref fn" href="#read_rr_from_ipc_msg" title='read_rr_from_ipc_msg' data-ref="read_rr_from_ipc_msg" data-ref-filename="read_rr_from_ipc_msg">read_rr_from_ipc_msg</a>(<a class="local col6 ref" href="#446request" title='request' data-ref="446request" data-ref-filename="446request">request</a>, <var>0</var>, <var>0</var>);</td></tr>
<tr><th id="3911">3911</th><td>    <b>if</b> (<a class="local col8 ref" href="#448rr" title='rr' data-ref="448rr" data-ref-filename="448rr">rr</a>)</td></tr>
<tr><th id="3912">3912</th><td>    {</td></tr>
<tr><th id="3913">3913</th><td>        <a class="local col7 ref" href="#447status" title='status' data-ref="447status" data-ref-filename="447status">status</a> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_ReconfirmByValue" title='mDNS_ReconfirmByValue' data-ref="mDNS_ReconfirmByValue" data-ref-filename="mDNS_ReconfirmByValue">mDNS_ReconfirmByValue</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col8 ref" href="#448rr" title='rr' data-ref="448rr" data-ref-filename="448rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>);</td></tr>
<tr><th id="3914">3914</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, (status == mStatus_NoError) ? &quot;%3d: DNSServiceReconfirmRecord(%s) interface %d initiated PID[%d](%s)&quot; : &quot;%3d: DNSServiceReconfirmRecord(%s) interface %d failed PID[%d](%s) status %d&quot;, request-&gt;sd, GetRRDisplayString_rdb(&amp;rr-&gt;resrec, &amp;(&amp;rr-&gt;resrec)-&gt;rdata-&gt;u, (&amp;mDNSStorage)-&gt;MsgBuffer), mDNSPlatformInterfaceIndexfromInterfaceID(&amp;mDNSStorage, rr-&gt;resrec.InterfaceID, mDNSfalse), request-&gt;process_id, request-&gt;pid_name, status);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(</td></tr>
<tr><th id="3915">3915</th><td>            (<a class="local col7 ref" href="#447status" title='status' data-ref="447status" data-ref-filename="447status">status</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_NoError" title='mStatus_NoError' data-ref="mStatus_NoError" data-ref-filename="mStatus_NoError">mStatus_NoError</a>) ?</td></tr>
<tr><th id="3916">3916</th><td>            <q>"%3d: DNSServiceReconfirmRecord(%s) interface %d initiated PID[%d](%s)"</q> :</td></tr>
<tr><th id="3917">3917</th><td>            <q>"%3d: DNSServiceReconfirmRecord(%s) interface %d failed PID[%d](%s) status %d"</q>,</td></tr>
<tr><th id="3918">3918</th><td>            <a class="local col6 ref" href="#446request" title='request' data-ref="446request" data-ref-filename="446request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2941" title="GetRRDisplayString_rdb(&amp;rr-&gt;resrec, &amp;(&amp;rr-&gt;resrec)-&gt;rdata-&gt;u, (&amp;mDNSStorage)-&gt;MsgBuffer)" data-ref="_M/RRDisplayString">RRDisplayString</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col8 ref" href="#448rr" title='rr' data-ref="448rr" data-ref-filename="448rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>),</td></tr>
<tr><th id="3919">3919</th><td>            <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformInterfaceIndexfromInterfaceID" title='mDNSPlatformInterfaceIndexfromInterfaceID' data-ref="mDNSPlatformInterfaceIndexfromInterfaceID" data-ref-filename="mDNSPlatformInterfaceIndexfromInterfaceID">mDNSPlatformInterfaceIndexfromInterfaceID</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col8 ref" href="#448rr" title='rr' data-ref="448rr" data-ref-filename="448rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::InterfaceID" title='ResourceRecord_struct::InterfaceID' data-ref="ResourceRecord_struct::InterfaceID" data-ref-filename="ResourceRecord_struct..InterfaceID">InterfaceID</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>), </td></tr>
<tr><th id="3920">3920</th><td>            <a class="local col6 ref" href="#446request" title='request' data-ref="446request" data-ref-filename="446request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col6 ref" href="#446request" title='request' data-ref="446request" data-ref-filename="446request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>, <a class="local col7 ref" href="#447status" title='status' data-ref="447status" data-ref-filename="447status">status</a>);</td></tr>
<tr><th id="3921">3921</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(rr)" data-ref="_M/freeL">freeL</a>(<q>"AuthRecord/handle_reconfirm_request"</q>, <a class="local col8 ref" href="#448rr" title='rr' data-ref="448rr" data-ref-filename="448rr">rr</a>);</td></tr>
<tr><th id="3922">3922</th><td>    }</td></tr>
<tr><th id="3923">3923</th><td>    <b>return</b>(<a class="local col7 ref" href="#447status" title='status' data-ref="447status" data-ref-filename="447status">status</a>);</td></tr>
<tr><th id="3924">3924</th><td>}</td></tr>
<tr><th id="3925">3925</th><td></td></tr>
<tr><th id="3926">3926</th><td><u>#<span data-ppcond="3926">if</span> APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="3927">3927</th><td></td></tr>
<tr><th id="3928">3928</th><td>mDNSlocal mStatus handle_release_request(request_state *request)</td></tr>
<tr><th id="3929">3929</th><td>{</td></tr>
<tr><th id="3930">3930</th><td>    mStatus err = <var>0</var>;</td></tr>
<tr><th id="3931">3931</th><td>    <em>char</em> name[<var>256</var>], regtype[MAX_ESCAPED_DOMAIN_NAME], domain[MAX_ESCAPED_DOMAIN_NAME];</td></tr>
<tr><th id="3932">3932</th><td>    domainname instance;</td></tr>
<tr><th id="3933">3933</th><td></td></tr>
<tr><th id="3934">3934</th><td>    <i>// extract the data from the message</i></td></tr>
<tr><th id="3935">3935</th><td>    DNSServiceFlags flags = get_flags(&amp;request-&gt;msgptr, request-&gt;msgend);</td></tr>
<tr><th id="3936">3936</th><td></td></tr>
<tr><th id="3937">3937</th><td>    <b>if</b> (get_string(&amp;request-&gt;msgptr, request-&gt;msgend, name, <var>256</var>) &lt; <var>0</var> ||</td></tr>
<tr><th id="3938">3938</th><td>        get_string(&amp;request-&gt;msgptr, request-&gt;msgend, regtype, MAX_ESCAPED_DOMAIN_NAME) &lt; <var>0</var> ||</td></tr>
<tr><th id="3939">3939</th><td>        get_string(&amp;request-&gt;msgptr, request-&gt;msgend, domain, MAX_ESCAPED_DOMAIN_NAME) &lt; <var>0</var>)</td></tr>
<tr><th id="3940">3940</th><td>    {</td></tr>
<tr><th id="3941">3941</th><td>        LogMsg(<q>"ERROR: handle_release_request - Couldn't read name/regtype/domain"</q>);</td></tr>
<tr><th id="3942">3942</th><td>        <b>return</b>(mStatus_BadParamErr);</td></tr>
<tr><th id="3943">3943</th><td>    }</td></tr>
<tr><th id="3944">3944</th><td></td></tr>
<tr><th id="3945">3945</th><td>    <b>if</b> (!request-&gt;msgptr)</td></tr>
<tr><th id="3946">3946</th><td>    {</td></tr>
<tr><th id="3947">3947</th><td>        LogMsg(<q>"%3d: PeerConnectionRelease(unreadable parameters)"</q>, request-&gt;sd);</td></tr>
<tr><th id="3948">3948</th><td>        <b>return</b>(mStatus_BadParamErr);</td></tr>
<tr><th id="3949">3949</th><td>    }</td></tr>
<tr><th id="3950">3950</th><td></td></tr>
<tr><th id="3951">3951</th><td>    <b>if</b> (build_domainname_from_strings(&amp;instance, name, regtype, domain) &lt; <var>0</var>)</td></tr>
<tr><th id="3952">3952</th><td>    {</td></tr>
<tr><th id="3953">3953</th><td>        LogMsg(<q>"ERROR: handle_release_request bad “%s” “%s” “%s”"</q>, name, regtype, domain);</td></tr>
<tr><th id="3954">3954</th><td>        <b>return</b>(mStatus_BadParamErr);</td></tr>
<tr><th id="3955">3955</th><td>    }</td></tr>
<tr><th id="3956">3956</th><td></td></tr>
<tr><th id="3957">3957</th><td>    LogOperation(<q>"%3d: PeerConnectionRelease(%X %##s) START PID[%d](%s)"</q>,</td></tr>
<tr><th id="3958">3958</th><td>                 request-&gt;sd, flags, instance.c, request-&gt;process_id, request-&gt;pid_name);</td></tr>
<tr><th id="3959">3959</th><td></td></tr>
<tr><th id="3960">3960</th><td>    external_connection_release(&amp;instance);</td></tr>
<tr><th id="3961">3961</th><td>    <b>return</b>(err);</td></tr>
<tr><th id="3962">3962</th><td>}</td></tr>
<tr><th id="3963">3963</th><td></td></tr>
<tr><th id="3964">3964</th><td><u>#<span data-ppcond="3926">else</span>   // APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="3965">3965</th><td></td></tr>
<tr><th id="3966">3966</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="decl def fn" id="handle_release_request" title='handle_release_request' data-ref="handle_release_request" data-ref-filename="handle_release_request">handle_release_request</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col9 decl" id="449request" title='request' data-type='request_state *' data-ref="449request" data-ref-filename="449request">request</dfn>)</td></tr>
<tr><th id="3967">3967</th><td>{</td></tr>
<tr><th id="3968">3968</th><td>    (<em>void</em>) <a class="local col9 ref" href="#449request" title='request' data-ref="449request" data-ref-filename="449request">request</a>;</td></tr>
<tr><th id="3969">3969</th><td>    <b>return</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_UnsupportedErr" title='mStatus_UnsupportedErr' data-ref="mStatus_UnsupportedErr" data-ref-filename="mStatus_UnsupportedErr">mStatus_UnsupportedErr</a>;</td></tr>
<tr><th id="3970">3970</th><td>}</td></tr>
<tr><th id="3971">3971</th><td></td></tr>
<tr><th id="3972">3972</th><td><u>#<span data-ppcond="3926">endif</span>  // APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="3973">3973</th><td></td></tr>
<tr><th id="3974">3974</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="decl def fn" id="handle_setdomain_request" title='handle_setdomain_request' data-ref="handle_setdomain_request" data-ref-filename="handle_setdomain_request">handle_setdomain_request</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col0 decl" id="450request" title='request' data-type='request_state *' data-ref="450request" data-ref-filename="450request">request</dfn>)</td></tr>
<tr><th id="3975">3975</th><td>{</td></tr>
<tr><th id="3976">3976</th><td>    <em>char</em> <dfn class="local col1 decl" id="451domainstr" title='domainstr' data-type='char [1009]' data-ref="451domainstr" data-ref-filename="451domainstr">domainstr</dfn>[<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#417" title="1009" data-ref="_M/MAX_ESCAPED_DOMAIN_NAME">MAX_ESCAPED_DOMAIN_NAME</a>];</td></tr>
<tr><th id="3977">3977</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#domainname" title='domainname' data-type='struct domainname' data-ref="domainname" data-ref-filename="domainname">domainname</a> <dfn class="local col2 decl" id="452domain" title='domain' data-type='domainname' data-ref="452domain" data-ref-filename="452domain">domain</dfn>;</td></tr>
<tr><th id="3978">3978</th><td>    <a class="typedef" href="dns_sd.h.html#DNSServiceFlags" title='DNSServiceFlags' data-type='uint32_t' data-ref="DNSServiceFlags" data-ref-filename="DNSServiceFlags">DNSServiceFlags</a> <dfn class="local col3 decl" id="453flags" title='flags' data-type='DNSServiceFlags' data-ref="453flags" data-ref-filename="453flags">flags</dfn> = <a class="macro" href="dnssd_ipc.h.html#210" title="__dnssd_ipc_get_uint32" data-ref="_M/get_flags">get_flags</a>(&amp;<a class="local col0 ref" href="#450request" title='request' data-ref="450request" data-ref-filename="450request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col0 ref" href="#450request" title='request' data-ref="450request" data-ref-filename="450request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);</td></tr>
<tr><th id="3979">3979</th><td>    (<em>void</em>)<a class="local col3 ref" href="#453flags" title='flags' data-ref="453flags" data-ref-filename="453flags">flags</a>; <i>// Unused</i></td></tr>
<tr><th id="3980">3980</th><td>    <b>if</b> (<a class="macro" href="dnssd_ipc.h.html#198" title="__dnssd_ipc_get_string" data-ref="_M/get_string">get_string</a>(&amp;<a class="local col0 ref" href="#450request" title='request' data-ref="450request" data-ref-filename="450request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col0 ref" href="#450request" title='request' data-ref="450request" data-ref-filename="450request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>, <a class="local col1 ref" href="#451domainstr" title='domainstr' data-ref="451domainstr" data-ref-filename="451domainstr">domainstr</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#417" title="1009" data-ref="_M/MAX_ESCAPED_DOMAIN_NAME">MAX_ESCAPED_DOMAIN_NAME</a>) &lt; <var>0</var> ||</td></tr>
<tr><th id="3981">3981</th><td>        !<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#MakeDomainNameFromDNSNameString" title='MakeDomainNameFromDNSNameString' data-ref="MakeDomainNameFromDNSNameString" data-ref-filename="MakeDomainNameFromDNSNameString">MakeDomainNameFromDNSNameString</a>(&amp;<a class="local col2 ref" href="#452domain" title='domain' data-ref="452domain" data-ref-filename="452domain">domain</a>, <a class="local col1 ref" href="#451domainstr" title='domainstr' data-ref="451domainstr" data-ref-filename="451domainstr">domainstr</a>))</td></tr>
<tr><th id="3982">3982</th><td>    { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: DNSServiceSetDefaultDomainForUser(unreadable parameters)&quot;, request-&gt;sd)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: DNSServiceSetDefaultDomainForUser(unreadable parameters)"</q>, <a class="local col0 ref" href="#450request" title='request' data-ref="450request" data-ref-filename="450request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>); <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>); }</td></tr>
<tr><th id="3983">3983</th><td></td></tr>
<tr><th id="3984">3984</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: DNSServiceSetDefaultDomainForUser(%##s)&quot;, request-&gt;sd, domain.c);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: DNSServiceSetDefaultDomainForUser(%##s)"</q>, <a class="local col0 ref" href="#450request" title='request' data-ref="450request" data-ref-filename="450request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col2 ref" href="#452domain" title='domain' data-ref="452domain" data-ref-filename="452domain">domain</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>);</td></tr>
<tr><th id="3985">3985</th><td>    <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_NoError" title='mStatus_NoError' data-ref="mStatus_NoError" data-ref-filename="mStatus_NoError">mStatus_NoError</a>);</td></tr>
<tr><th id="3986">3986</th><td>}</td></tr>
<tr><th id="3987">3987</th><td></td></tr>
<tr><th id="3988">3988</th><td><b>typedef</b> <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#141" title="struct __attribute__((__packed__))" data-ref="_M/packedstruct">packedstruct</a></td></tr>
<tr><th id="3989">3989</th><td>{</td></tr>
<tr><th id="3990">3990</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="decl field" id="(anonymous)::err" title='(anonymous struct)::err' data-ref="(anonymous)::err" data-ref-filename="(anonymous)..err">err</dfn>;</td></tr>
<tr><th id="3991">3991</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="decl field" id="(anonymous)::len" title='(anonymous struct)::len' data-ref="(anonymous)::len" data-ref-filename="(anonymous)..len">len</dfn>;</td></tr>
<tr><th id="3992">3992</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="decl field" id="(anonymous)::vers" title='(anonymous struct)::vers' data-ref="(anonymous)::vers" data-ref-filename="(anonymous)..vers">vers</dfn>;</td></tr>
<tr><th id="3993">3993</th><td>} <dfn class="typedef" id="DaemonVersionReply" title='DaemonVersionReply' data-type='struct DaemonVersionReply' data-ref="DaemonVersionReply" data-ref-filename="DaemonVersionReply">DaemonVersionReply</dfn>;</td></tr>
<tr><th id="3994">3994</th><td></td></tr>
<tr><th id="3995">3995</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="handle_getproperty_request" title='handle_getproperty_request' data-ref="handle_getproperty_request" data-ref-filename="handle_getproperty_request">handle_getproperty_request</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col4 decl" id="454request" title='request' data-type='request_state *' data-ref="454request" data-ref-filename="454request">request</dfn>)</td></tr>
<tr><th id="3996">3996</th><td>{</td></tr>
<tr><th id="3997">3997</th><td>    <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="local col5 decl" id="455BadParamErr" title='BadParamErr' data-type='const mStatus' data-ref="455BadParamErr" data-ref-filename="455BadParamErr">BadParamErr</dfn> = <a class="ref fn" href="#dnssd_htonl" title='dnssd_htonl' data-ref="dnssd_htonl" data-ref-filename="dnssd_htonl">dnssd_htonl</a>((<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a>)<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>);</td></tr>
<tr><th id="3998">3998</th><td>    <em>char</em> <dfn class="local col6 decl" id="456prop" title='prop' data-type='char [256]' data-ref="456prop" data-ref-filename="456prop">prop</dfn>[<var>256</var>];</td></tr>
<tr><th id="3999">3999</th><td>    <b>if</b> (<a class="macro" href="dnssd_ipc.h.html#198" title="__dnssd_ipc_get_string" data-ref="_M/get_string">get_string</a>(&amp;<a class="local col4 ref" href="#454request" title='request' data-ref="454request" data-ref-filename="454request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col4 ref" href="#454request" title='request' data-ref="454request" data-ref-filename="454request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>, <a class="local col6 ref" href="#456prop" title='prop' data-ref="456prop" data-ref-filename="456prop">prop</a>, <b>sizeof</b>(<a class="local col6 ref" href="#456prop" title='prop' data-ref="456prop" data-ref-filename="456prop">prop</a>)) &gt;= <var>0</var>)</td></tr>
<tr><th id="4000">4000</th><td>    {</td></tr>
<tr><th id="4001">4001</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: DNSServiceGetProperty(%s)&quot;, request-&gt;sd, prop);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: DNSServiceGetProperty(%s)"</q>, <a class="local col4 ref" href="#454request" title='request' data-ref="454request" data-ref-filename="454request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col6 ref" href="#456prop" title='prop' data-ref="456prop" data-ref-filename="456prop">prop</a>);</td></tr>
<tr><th id="4002">4002</th><td>        <b>if</b> (!<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strcmp" title='strcmp' data-ref="strcmp" data-ref-filename="strcmp">strcmp</a>(<a class="local col6 ref" href="#456prop" title='prop' data-ref="456prop" data-ref-filename="456prop">prop</a>, <a class="macro" href="dns_sd.h.html#899" title="&quot;DaemonVersion&quot;" data-ref="_M/kDNSServiceProperty_DaemonVersion">kDNSServiceProperty_DaemonVersion</a>))</td></tr>
<tr><th id="4003">4003</th><td>        {</td></tr>
<tr><th id="4004">4004</th><td>            <a class="typedef" href="#DaemonVersionReply" title='DaemonVersionReply' data-type='struct DaemonVersionReply' data-ref="DaemonVersionReply" data-ref-filename="DaemonVersionReply">DaemonVersionReply</a> <dfn class="local col7 decl" id="457x" title='x' data-type='DaemonVersionReply' data-ref="457x" data-ref-filename="457x">x</dfn> = { <var>0</var>, <a class="ref fn" href="#dnssd_htonl" title='dnssd_htonl' data-ref="dnssd_htonl" data-ref-filename="dnssd_htonl">dnssd_htonl</a>(<var>4</var>), <a class="ref fn" href="#dnssd_htonl" title='dnssd_htonl' data-ref="dnssd_htonl" data-ref-filename="dnssd_htonl">dnssd_htonl</a>(<a class="macro" href="dns_sd.h.html#69" title="8783004" data-ref="_M/_DNS_SD_H">_DNS_SD_H</a>) };</td></tr>
<tr><th id="4005">4005</th><td>            <a class="ref fn" href="#send_all" title='send_all' data-ref="send_all" data-ref-filename="send_all">send_all</a>(<a class="local col4 ref" href="#454request" title='request' data-ref="454request" data-ref-filename="454request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, (<em>const</em> <em>char</em> *)&amp;<a class="local col7 ref" href="#457x" title='x' data-ref="457x" data-ref-filename="457x">x</a>, <b>sizeof</b>(<a class="local col7 ref" href="#457x" title='x' data-ref="457x" data-ref-filename="457x">x</a>));</td></tr>
<tr><th id="4006">4006</th><td>            <b>return</b>;</td></tr>
<tr><th id="4007">4007</th><td>        }</td></tr>
<tr><th id="4008">4008</th><td>    }</td></tr>
<tr><th id="4009">4009</th><td></td></tr>
<tr><th id="4010">4010</th><td>    <i>// If we didn't recogize the requested property name, return BadParamErr</i></td></tr>
<tr><th id="4011">4011</th><td>    <a class="ref fn" href="#send_all" title='send_all' data-ref="send_all" data-ref-filename="send_all">send_all</a>(<a class="local col4 ref" href="#454request" title='request' data-ref="454request" data-ref-filename="454request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, (<em>const</em> <em>char</em> *)&amp;<a class="local col5 ref" href="#455BadParamErr" title='BadParamErr' data-ref="455BadParamErr" data-ref-filename="455BadParamErr">BadParamErr</a>, <b>sizeof</b>(<a class="local col5 ref" href="#455BadParamErr" title='BadParamErr' data-ref="455BadParamErr" data-ref-filename="455BadParamErr">BadParamErr</a>));</td></tr>
<tr><th id="4012">4012</th><td>}</td></tr>
<tr><th id="4013">4013</th><td></td></tr>
<tr><th id="4014">4014</th><td><u>#<span data-ppcond="4014">ifdef</span> <span class="macro" data-ref="_M/APPLE_OSX_mDNSResponder">APPLE_OSX_mDNSResponder</span></u></td></tr>
<tr><th id="4015">4015</th><td><i>// The caller can specify either the pid or the uuid. If the pid is not specified,</i></td></tr>
<tr><th id="4016">4016</th><td><i>// update the effective uuid. Don't overwrite the pid which is used for debugging</i></td></tr>
<tr><th id="4017">4017</th><td><i>// purposes and initialized when the socket is opened.</i></td></tr>
<tr><th id="4018">4018</th><td>mDNSlocal <em>void</em> handle_connection_delegate_request(request_state *request)</td></tr>
<tr><th id="4019">4019</th><td>{</td></tr>
<tr><th id="4020">4020</th><td>    mDNSs32 pid;</td></tr>
<tr><th id="4021">4021</th><td>    socklen_t len;</td></tr>
<tr><th id="4022">4022</th><td></td></tr>
<tr><th id="4023">4023</th><td>    LogOperation(<q>"%3d: DNSServiceCreateDelegateConnection START PID[%d](%s)"</q>,</td></tr>
<tr><th id="4024">4024</th><td>                 request-&gt;sd, request-&gt;process_id, request-&gt;pid_name);</td></tr>
<tr><th id="4025">4025</th><td>    request-&gt;terminate = connection_termination;</td></tr>
<tr><th id="4026">4026</th><td></td></tr>
<tr><th id="4027">4027</th><td>    len = <var>0</var>;</td></tr>
<tr><th id="4028">4028</th><td>    pid = get_uint32(&amp;request-&gt;msgptr, request-&gt;msgend);</td></tr>
<tr><th id="4029">4029</th><td><u>#ifdef LOCAL_PEEREPID</u></td></tr>
<tr><th id="4030">4030</th><td>    <b>if</b> (pid)</td></tr>
<tr><th id="4031">4031</th><td>    {</td></tr>
<tr><th id="4032">4032</th><td>        len = <b>sizeof</b>(pid);</td></tr>
<tr><th id="4033">4033</th><td>        <b>if</b> (getsockopt(request-&gt;sd, SOL_LOCAL, LOCAL_PEEREPID, &amp;request-&gt;process_id, &amp;len) != <var>0</var>)</td></tr>
<tr><th id="4034">4034</th><td>        {</td></tr>
<tr><th id="4035">4035</th><td>            LogMsg(<q>"handle_connection_delegate_request: getsockopt for LOCAL_PEEREPID failed errno:%d / %s"</q>, errno, strerror(errno));</td></tr>
<tr><th id="4036">4036</th><td>            <b>return</b>;</td></tr>
<tr><th id="4037">4037</th><td>        }</td></tr>
<tr><th id="4038">4038</th><td>        <i>// to extract the process name from the pid value</i></td></tr>
<tr><th id="4039">4039</th><td>        <b>if</b> (proc_pidinfo(request-&gt;process_id, PROC_PIDT_SHORTBSDINFO, <var>1</var>, &amp;proc, PROC_PIDT_SHORTBSDINFO_SIZE) == <var>0</var>)</td></tr>
<tr><th id="4040">4040</th><td>            <b>return</b>;</td></tr>
<tr><th id="4041">4041</th><td>        mDNSPlatformStrLCopy(request-&gt;pid_name, proc.pbsi_comm, <b>sizeof</b>(request-&gt;pid_name));</td></tr>
<tr><th id="4042">4042</th><td>        debugf(<q>"handle_connection_delegate_request: process id %d, name %s"</q>, request-&gt;process_id, request-&gt;pid_name);</td></tr>
<tr><th id="4043">4043</th><td>    }</td></tr>
<tr><th id="4044">4044</th><td><u>#endif</u></td></tr>
<tr><th id="4045">4045</th><td><u>#ifdef LOCAL_PEEREUUID</u></td></tr>
<tr><th id="4046">4046</th><td>    <b>if</b> (!pid)</td></tr>
<tr><th id="4047">4047</th><td>    {</td></tr>
<tr><th id="4048">4048</th><td>        len = UUID_SIZE;</td></tr>
<tr><th id="4049">4049</th><td>        <b>if</b> (getsockopt(request-&gt;sd, SOL_LOCAL, LOCAL_PEEREUUID, request-&gt;uuid, &amp;len) != <var>0</var>)</td></tr>
<tr><th id="4050">4050</th><td>        {</td></tr>
<tr><th id="4051">4051</th><td>            LogMsg(<q>"handle_connection_delegate_request: getsockopt for LOCAL_PEEREUUID failed errno:%d / %s"</q>, errno, strerror(errno));</td></tr>
<tr><th id="4052">4052</th><td>            <b>return</b>;</td></tr>
<tr><th id="4053">4053</th><td>        }</td></tr>
<tr><th id="4054">4054</th><td>        request-&gt;validUUID = mDNStrue;</td></tr>
<tr><th id="4055">4055</th><td>    }</td></tr>
<tr><th id="4056">4056</th><td><u>#endif</u></td></tr>
<tr><th id="4057">4057</th><td>}</td></tr>
<tr><th id="4058">4058</th><td><u>#<span data-ppcond="4014">else</span></u></td></tr>
<tr><th id="4059">4059</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="handle_connection_delegate_request" title='handle_connection_delegate_request' data-ref="handle_connection_delegate_request" data-ref-filename="handle_connection_delegate_request">handle_connection_delegate_request</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col8 decl" id="458request" title='request' data-type='request_state *' data-ref="458request" data-ref-filename="458request">request</dfn>)</td></tr>
<tr><th id="4060">4060</th><td>{</td></tr>
<tr><th id="4061">4061</th><td>    (<em>void</em>) <a class="local col8 ref" href="#458request" title='request' data-ref="458request" data-ref-filename="458request">request</a>;</td></tr>
<tr><th id="4062">4062</th><td>}</td></tr>
<tr><th id="4063">4063</th><td><u>#<span data-ppcond="4014">endif</span></u></td></tr>
<tr><th id="4064">4064</th><td></td></tr>
<tr><th id="4065">4065</th><td><b>typedef</b> <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#141" title="struct __attribute__((__packed__))" data-ref="_M/packedstruct">packedstruct</a></td></tr>
<tr><th id="4066">4066</th><td>{</td></tr>
<tr><th id="4067">4067</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="decl field" id="(anonymous)::err" title='(anonymous struct)::err' data-ref="(anonymous)::err" data-ref-filename="(anonymous)..err">err</dfn>;</td></tr>
<tr><th id="4068">4068</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSs32" title='mDNSs32' data-type='int' data-ref="mDNSs32" data-ref-filename="mDNSs32">mDNSs32</a> <dfn class="decl field" id="(anonymous)::pid" title='(anonymous struct)::pid' data-ref="(anonymous)::pid" data-ref-filename="(anonymous)..pid">pid</dfn>;</td></tr>
<tr><th id="4069">4069</th><td>} <dfn class="typedef" id="PIDInfo" title='PIDInfo' data-type='struct PIDInfo' data-ref="PIDInfo" data-ref-filename="PIDInfo">PIDInfo</dfn>;</td></tr>
<tr><th id="4070">4070</th><td></td></tr>
<tr><th id="4071">4071</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="handle_getpid_request" title='handle_getpid_request' data-ref="handle_getpid_request" data-ref-filename="handle_getpid_request">handle_getpid_request</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col9 decl" id="459request" title='request' data-type='request_state *' data-ref="459request" data-ref-filename="459request">request</dfn>)</td></tr>
<tr><th id="4072">4072</th><td>{</td></tr>
<tr><th id="4073">4073</th><td>    <em>const</em> <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col0 decl" id="460req" title='req' data-type='const request_state *' data-ref="460req" data-ref-filename="460req">req</dfn>;</td></tr>
<tr><th id="4074">4074</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSs32" title='mDNSs32' data-type='int' data-ref="mDNSs32" data-ref-filename="mDNSs32">mDNSs32</a> <dfn class="local col1 decl" id="461pid" title='pid' data-type='mDNSs32' data-ref="461pid" data-ref-filename="461pid">pid</dfn> = -<var>1</var>;</td></tr>
<tr><th id="4075">4075</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu16" title='mDNSu16' data-type='unsigned short' data-ref="mDNSu16" data-ref-filename="mDNSu16">mDNSu16</a> <dfn class="local col2 decl" id="462srcport" title='srcport' data-type='mDNSu16' data-ref="462srcport" data-ref-filename="462srcport">srcport</dfn> = <a class="macro" href="dnssd_ipc.h.html#196" title="__dnssd_ipc_get_uint16" data-ref="_M/get_uint16">get_uint16</a>(&amp;<a class="local col9 ref" href="#459request" title='request' data-ref="459request" data-ref-filename="459request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col9 ref" href="#459request" title='request' data-ref="459request" data-ref-filename="459request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);</td></tr>
<tr><th id="4076">4076</th><td>    <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion" title='DNSQuestion' data-type='struct DNSQuestion_struct' data-ref="DNSQuestion" data-ref-filename="DNSQuestion">DNSQuestion</a> *<dfn class="local col3 decl" id="463q" title='q' data-type='const DNSQuestion *' data-ref="463q" data-ref-filename="463q">q</dfn> = <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="4077">4077</th><td>    <a class="typedef" href="#PIDInfo" title='PIDInfo' data-type='struct PIDInfo' data-ref="PIDInfo" data-ref-filename="PIDInfo">PIDInfo</a> <dfn class="local col4 decl" id="464pi" title='pi' data-type='PIDInfo' data-ref="464pi" data-ref-filename="464pi">pi</dfn>;</td></tr>
<tr><th id="4078">4078</th><td></td></tr>
<tr><th id="4079">4079</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: DNSServiceGetPID START&quot;, request-&gt;sd)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: DNSServiceGetPID START"</q>, <a class="local col9 ref" href="#459request" title='request' data-ref="459request" data-ref-filename="459request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>);</td></tr>
<tr><th id="4080">4080</th><td></td></tr>
<tr><th id="4081">4081</th><td>    <b>for</b> (<a class="local col0 ref" href="#460req" title='req' data-ref="460req" data-ref-filename="460req">req</a> = <a class="tu ref" href="#all_requests" title='all_requests' data-use='r' data-ref="all_requests" data-ref-filename="all_requests">all_requests</a>; <a class="local col0 ref" href="#460req" title='req' data-ref="460req" data-ref-filename="460req">req</a>; <a class="local col0 ref" href="#460req" title='req' data-ref="460req" data-ref-filename="460req">req</a>=<a class="local col0 ref" href="#460req" title='req' data-ref="460req" data-ref-filename="460req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::next" title='request_state::next' data-ref="request_state::next" data-ref-filename="request_state..next">next</a>)</td></tr>
<tr><th id="4082">4082</th><td>    {</td></tr>
<tr><th id="4083">4083</th><td>        <b>if</b> (<a class="local col0 ref" href="#460req" title='req' data-ref="460req" data-ref-filename="460req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::op" title='(anonymous struct)::op' data-ref="(anonymous)::op" data-ref-filename="(anonymous)..op">op</a> == <a class="enum" href="dnssd_ipc.h.html#query_request" title='query_request' data-ref="query_request" data-ref-filename="query_request">query_request</a>)</td></tr>
<tr><th id="4084">4084</th><td>            <a class="local col3 ref" href="#463q" title='q' data-ref="463q" data-ref-filename="463q">q</a> = &amp;<a class="local col0 ref" href="#460req" title='req' data-ref="460req" data-ref-filename="460req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q" title='request_state::(anonymous union)::(anonymous struct)::q' data-ref="request_state::(anonymousunion)::(anonymous)::q" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q">q</a>;</td></tr>
<tr><th id="4085">4085</th><td>        <b>else</b> <b>if</b> (<a class="local col0 ref" href="#460req" title='req' data-ref="460req" data-ref-filename="460req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::op" title='(anonymous struct)::op' data-ref="(anonymous)::op" data-ref-filename="(anonymous)..op">op</a> == <a class="enum" href="dnssd_ipc.h.html#addrinfo_request" title='addrinfo_request' data-ref="addrinfo_request" data-ref-filename="addrinfo_request">addrinfo_request</a>)</td></tr>
<tr><th id="4086">4086</th><td>            <a class="local col3 ref" href="#463q" title='q' data-ref="463q" data-ref-filename="463q">q</a> = &amp;<a class="local col0 ref" href="#460req" title='req' data-ref="460req" data-ref-filename="460req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>;</td></tr>
<tr><th id="4087">4087</th><td>        <b>else</b> <b>if</b> (<a class="local col0 ref" href="#460req" title='req' data-ref="460req" data-ref-filename="460req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::op" title='(anonymous struct)::op' data-ref="(anonymous)::op" data-ref-filename="(anonymous)..op">op</a> == <a class="enum" href="dnssd_ipc.h.html#addrinfo_request" title='addrinfo_request' data-ref="addrinfo_request" data-ref-filename="addrinfo_request">addrinfo_request</a>)</td></tr>
<tr><th id="4088">4088</th><td>            <a class="local col3 ref" href="#463q" title='q' data-ref="463q" data-ref-filename="463q">q</a> = &amp;<a class="local col0 ref" href="#460req" title='req' data-ref="460req" data-ref-filename="460req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>;</td></tr>
<tr><th id="4089">4089</th><td></td></tr>
<tr><th id="4090">4090</th><td>        <b>if</b> (<a class="local col3 ref" href="#463q" title='q' data-ref="463q" data-ref-filename="463q">q</a> &amp;&amp; <a class="local col3 ref" href="#463q" title='q' data-ref="463q" data-ref-filename="463q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::LocalSocket" title='DNSQuestion_struct::LocalSocket' data-ref="DNSQuestion_struct::LocalSocket" data-ref-filename="DNSQuestion_struct..LocalSocket">LocalSocket</a> != <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="4091">4091</th><td>        {</td></tr>
<tr><th id="4092">4092</th><td>            <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu16" title='mDNSu16' data-type='unsigned short' data-ref="mDNSu16" data-ref-filename="mDNSu16">mDNSu16</a> <dfn class="local col5 decl" id="465port" title='port' data-type='mDNSu16' data-ref="465port" data-ref-filename="465port">port</dfn> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformGetUDPPort" title='mDNSPlatformGetUDPPort' data-ref="mDNSPlatformGetUDPPort" data-ref-filename="mDNSPlatformGetUDPPort">mDNSPlatformGetUDPPort</a>(<a class="local col3 ref" href="#463q" title='q' data-ref="463q" data-ref-filename="463q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::LocalSocket" title='DNSQuestion_struct::LocalSocket' data-ref="DNSQuestion_struct::LocalSocket" data-ref-filename="DNSQuestion_struct..LocalSocket">LocalSocket</a>);</td></tr>
<tr><th id="4093">4093</th><td>            <b>if</b> (<a class="local col5 ref" href="#465port" title='port' data-ref="465port" data-ref-filename="465port">port</a> == <a class="local col2 ref" href="#462srcport" title='srcport' data-ref="462srcport" data-ref-filename="462srcport">srcport</a>)</td></tr>
<tr><th id="4094">4094</th><td>            {</td></tr>
<tr><th id="4095">4095</th><td>                <a class="local col1 ref" href="#461pid" title='pid' data-ref="461pid" data-ref-filename="461pid">pid</a> = <a class="local col0 ref" href="#460req" title='req' data-ref="460req" data-ref-filename="460req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>;</td></tr>
<tr><th id="4096">4096</th><td>                <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;DNSServiceGetPID: srcport %d, pid %d [%s] question %##s&quot;, ((uint16_t)(__builtin_constant_p((((uint16_t)((srcport))))) ? (((uint16_t)(((((((uint16_t)((srcport)))) &amp; 0xff00) &gt;&gt; 8) | (((((uint16_t)((srcport)))) &amp; 0x00ff) &lt;&lt; 8))))) : __byte_swap_u16_variable(((uint16_t)((srcport)))))), pid, req-&gt;pid_name, q-&gt;qname.c)" data-ref="_M/LogMsg">LogMsg</a>(<q>"DNSServiceGetPID: srcport %d, pid %d [%s] question %##s"</q>, <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/endian.h.html#128" title="((uint16_t)(__builtin_constant_p((((uint16_t)((srcport))))) ? (((uint16_t)(((((((uint16_t)((srcport)))) &amp; 0xff00) &gt;&gt; 8) | (((((uint16_t)((srcport)))) &amp; 0x00ff) &lt;&lt; 8))))) : __byte_swap_u16_variable(((uint16_t)((srcport))))))" data-ref="_M/htons">htons</a>(<a class="local col2 ref" href="#462srcport" title='srcport' data-ref="462srcport" data-ref-filename="462srcport">srcport</a>), <a class="local col1 ref" href="#461pid" title='pid' data-ref="461pid" data-ref-filename="461pid">pid</a>, <a class="local col0 ref" href="#460req" title='req' data-ref="460req" data-ref-filename="460req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>, <a class="local col3 ref" href="#463q" title='q' data-ref="463q" data-ref-filename="463q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>);</td></tr>
<tr><th id="4097">4097</th><td>                <b>break</b>;</td></tr>
<tr><th id="4098">4098</th><td>            }</td></tr>
<tr><th id="4099">4099</th><td>        }</td></tr>
<tr><th id="4100">4100</th><td>    }</td></tr>
<tr><th id="4101">4101</th><td>    <i>// If we cannot find in the client requests, look to see if this was</i></td></tr>
<tr><th id="4102">4102</th><td><i>    // started by mDNSResponder.</i></td></tr>
<tr><th id="4103">4103</th><td>    <b>if</b> (<a class="local col1 ref" href="#461pid" title='pid' data-ref="461pid" data-ref-filename="461pid">pid</a> == -<var>1</var>)</td></tr>
<tr><th id="4104">4104</th><td>    {</td></tr>
<tr><th id="4105">4105</th><td>        <b>for</b> (<a class="local col3 ref" href="#463q" title='q' data-ref="463q" data-ref-filename="463q">q</a> = <a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::Questions" title='mDNS_struct::Questions' data-ref="mDNS_struct::Questions" data-ref-filename="mDNS_struct..Questions">Questions</a>; <a class="local col3 ref" href="#463q" title='q' data-ref="463q" data-ref-filename="463q">q</a>; <a class="local col3 ref" href="#463q" title='q' data-ref="463q" data-ref-filename="463q">q</a> = <a class="local col3 ref" href="#463q" title='q' data-ref="463q" data-ref-filename="463q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::next" title='DNSQuestion_struct::next' data-ref="DNSQuestion_struct::next" data-ref-filename="DNSQuestion_struct..next">next</a>)</td></tr>
<tr><th id="4106">4106</th><td>        {</td></tr>
<tr><th id="4107">4107</th><td>            <b>if</b> (<a class="local col3 ref" href="#463q" title='q' data-ref="463q" data-ref-filename="463q">q</a> &amp;&amp; <a class="local col3 ref" href="#463q" title='q' data-ref="463q" data-ref-filename="463q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::LocalSocket" title='DNSQuestion_struct::LocalSocket' data-ref="DNSQuestion_struct::LocalSocket" data-ref-filename="DNSQuestion_struct..LocalSocket">LocalSocket</a> != <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="4108">4108</th><td>            {</td></tr>
<tr><th id="4109">4109</th><td>                <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu16" title='mDNSu16' data-type='unsigned short' data-ref="mDNSu16" data-ref-filename="mDNSu16">mDNSu16</a> <dfn class="local col6 decl" id="466port" title='port' data-type='mDNSu16' data-ref="466port" data-ref-filename="466port">port</dfn> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformGetUDPPort" title='mDNSPlatformGetUDPPort' data-ref="mDNSPlatformGetUDPPort" data-ref-filename="mDNSPlatformGetUDPPort">mDNSPlatformGetUDPPort</a>(<a class="local col3 ref" href="#463q" title='q' data-ref="463q" data-ref-filename="463q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::LocalSocket" title='DNSQuestion_struct::LocalSocket' data-ref="DNSQuestion_struct::LocalSocket" data-ref-filename="DNSQuestion_struct..LocalSocket">LocalSocket</a>);</td></tr>
<tr><th id="4110">4110</th><td>                <b>if</b> (<a class="local col6 ref" href="#466port" title='port' data-ref="466port" data-ref-filename="466port">port</a> == <a class="local col2 ref" href="#462srcport" title='srcport' data-ref="462srcport" data-ref-filename="462srcport">srcport</a>)</td></tr>
<tr><th id="4111">4111</th><td>                {</td></tr>
<tr><th id="4112">4112</th><td><u>#<span data-ppcond="4112">if</span> APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="4113">4113</th><td>                    pid = getpid();</td></tr>
<tr><th id="4114">4114</th><td><u>#<span data-ppcond="4112">endif</span> // APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="4115">4115</th><td>                    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;DNSServiceGetPID: srcport %d, pid %d [%s], question %##s&quot;, ((uint16_t)(__builtin_constant_p((((uint16_t)((srcport))))) ? (((uint16_t)(((((((uint16_t)((srcport)))) &amp; 0xff00) &gt;&gt; 8) | (((((uint16_t)((srcport)))) &amp; 0x00ff) &lt;&lt; 8))))) : __byte_swap_u16_variable(((uint16_t)((srcport)))))), pid, &quot;_mDNSResponder&quot;, q-&gt;qname.c)" data-ref="_M/LogMsg">LogMsg</a>(<q>"DNSServiceGetPID: srcport %d, pid %d [%s], question %##s"</q>, <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/endian.h.html#128" title="((uint16_t)(__builtin_constant_p((((uint16_t)((srcport))))) ? (((uint16_t)(((((((uint16_t)((srcport)))) &amp; 0xff00) &gt;&gt; 8) | (((((uint16_t)((srcport)))) &amp; 0x00ff) &lt;&lt; 8))))) : __byte_swap_u16_variable(((uint16_t)((srcport))))))" data-ref="_M/htons">htons</a>(<a class="local col2 ref" href="#462srcport" title='srcport' data-ref="462srcport" data-ref-filename="462srcport">srcport</a>), <a class="local col1 ref" href="#461pid" title='pid' data-ref="461pid" data-ref-filename="461pid">pid</a>, <q>"_mDNSResponder"</q>, <a class="local col3 ref" href="#463q" title='q' data-ref="463q" data-ref-filename="463q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>);</td></tr>
<tr><th id="4116">4116</th><td>                    <b>break</b>;</td></tr>
<tr><th id="4117">4117</th><td>                }</td></tr>
<tr><th id="4118">4118</th><td>            }</td></tr>
<tr><th id="4119">4119</th><td>        }</td></tr>
<tr><th id="4120">4120</th><td>    }</td></tr>
<tr><th id="4121">4121</th><td></td></tr>
<tr><th id="4122">4122</th><td>    <a class="local col4 ref" href="#464pi" title='pi' data-ref="464pi" data-ref-filename="464pi">pi</a>.<a class="ref field" href="#(anonymous)::err" title='(anonymous struct)::err' data-ref="(anonymous)::err" data-ref-filename="(anonymous)..err">err</a> = <var>0</var>;</td></tr>
<tr><th id="4123">4123</th><td>    <a class="local col4 ref" href="#464pi" title='pi' data-ref="464pi" data-ref-filename="464pi">pi</a>.<a class="ref field" href="#(anonymous)::pid" title='(anonymous struct)::pid' data-ref="(anonymous)::pid" data-ref-filename="(anonymous)..pid">pid</a> = <a class="local col1 ref" href="#461pid" title='pid' data-ref="461pid" data-ref-filename="461pid">pid</a>;</td></tr>
<tr><th id="4124">4124</th><td>    <a class="ref fn" href="#send_all" title='send_all' data-ref="send_all" data-ref-filename="send_all">send_all</a>(<a class="local col9 ref" href="#459request" title='request' data-ref="459request" data-ref-filename="459request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, (<em>const</em> <em>char</em> *)&amp;<a class="local col4 ref" href="#464pi" title='pi' data-ref="464pi" data-ref-filename="464pi">pi</a>, <b>sizeof</b>(<a class="typedef" href="#PIDInfo" title='PIDInfo' data-type='struct PIDInfo' data-ref="PIDInfo" data-ref-filename="PIDInfo">PIDInfo</a>));</td></tr>
<tr><th id="4125">4125</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: DNSServiceGetPID STOP&quot;, request-&gt;sd)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: DNSServiceGetPID STOP"</q>, <a class="local col9 ref" href="#459request" title='request' data-ref="459request" data-ref-filename="459request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>);</td></tr>
<tr><th id="4126">4126</th><td>}</td></tr>
<tr><th id="4127">4127</th><td></td></tr>
<tr><th id="4128">4128</th><td><i>// ***************************************************************************</i></td></tr>
<tr><th id="4129">4129</th><td><u>#<span data-ppcond="4129">if</span> COMPILER_LIKES_PRAGMA_MARK</u></td></tr>
<tr><th id="4130">4130</th><td><u>#pragma mark -</u></td></tr>
<tr><th id="4131">4131</th><td><u>#pragma mark - DNSServiceNATPortMappingCreate</u></td></tr>
<tr><th id="4132">4132</th><td><u>#<span data-ppcond="4129">endif</span></u></td></tr>
<tr><th id="4133">4133</th><td></td></tr>
<tr><th id="4134">4134</th><td><u>#define <dfn class="macro" id="_M/DNSServiceProtocol" data-ref="_M/DNSServiceProtocol">DNSServiceProtocol</dfn>(X) ((X) == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATOp_AddrRequest" title='NATOp_AddrRequest' data-ref="NATOp_AddrRequest" data-ref-filename="NATOp_AddrRequest">NATOp_AddrRequest</a> ? 0 : (X) == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATOp_MapUDP" title='NATOp_MapUDP' data-ref="NATOp_MapUDP" data-ref-filename="NATOp_MapUDP">NATOp_MapUDP</a> ? <a class="enum" href="dns_sd.h.html#kDNSServiceProtocol_UDP" title='kDNSServiceProtocol_UDP' data-ref="kDNSServiceProtocol_UDP" data-ref-filename="kDNSServiceProtocol_UDP">kDNSServiceProtocol_UDP</a> : <a class="enum" href="dns_sd.h.html#kDNSServiceProtocol_TCP" title='kDNSServiceProtocol_TCP' data-ref="kDNSServiceProtocol_TCP" data-ref-filename="kDNSServiceProtocol_TCP">kDNSServiceProtocol_TCP</a>)</u></td></tr>
<tr><th id="4135">4135</th><td></td></tr>
<tr><th id="4136">4136</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="port_mapping_termination_callback" title='port_mapping_termination_callback' data-ref="port_mapping_termination_callback" data-ref-filename="port_mapping_termination_callback">port_mapping_termination_callback</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col7 decl" id="467request" title='request' data-type='request_state *' data-ref="467request" data-ref-filename="467request">request</dfn>)</td></tr>
<tr><th id="4137">4137</th><td>{</td></tr>
<tr><th id="4138">4138</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: DNSServiceNATPortMappingCreate(%X, %u, %u, %d) STOP PID[%d](%s)&quot;, request-&gt;sd, ((request-&gt;u.pm.NATinfo.Protocol) == NATOp_AddrRequest ? 0 : (request-&gt;u.pm.NATinfo.Protocol) == NATOp_MapUDP ? kDNSServiceProtocol_UDP : kDNSServiceProtocol_TCP), mDNSVal16(request-&gt;u.pm.NATinfo.IntPort), mDNSVal16(request-&gt;u.pm.ReqExt), request-&gt;u.pm.NATinfo.NATLease, request-&gt;process_id, request-&gt;pid_name);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: DNSServiceNATPortMappingCreate(%X, %u, %u, %d) STOP PID[%d](%s)"</q>, <a class="local col7 ref" href="#467request" title='request' data-ref="467request" data-ref-filename="467request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>,</td></tr>
<tr><th id="4139">4139</th><td>                 <a class="macro" href="#4134" title="((request-&gt;u.pm.NATinfo.Protocol) == NATOp_AddrRequest ? 0 : (request-&gt;u.pm.NATinfo.Protocol) == NATOp_MapUDP ? kDNSServiceProtocol_UDP : kDNSServiceProtocol_TCP)" data-ref="_M/DNSServiceProtocol">DNSServiceProtocol</a>(<a class="local col7 ref" href="#467request" title='request' data-ref="467request" data-ref-filename="467request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::Protocol" title='NATTraversalInfo_struct::Protocol' data-ref="NATTraversalInfo_struct::Protocol" data-ref-filename="NATTraversalInfo_struct..Protocol">Protocol</a>),</td></tr>
<tr><th id="4140">4140</th><td>                 <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSVal16" title='mDNSVal16' data-ref="mDNSVal16" data-ref-filename="mDNSVal16">mDNSVal16</a>(<a class="local col7 ref" href="#467request" title='request' data-ref="467request" data-ref-filename="467request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::IntPort" title='NATTraversalInfo_struct::IntPort' data-ref="NATTraversalInfo_struct::IntPort" data-ref-filename="NATTraversalInfo_struct..IntPort">IntPort</a>), <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSVal16" title='mDNSVal16' data-ref="mDNSVal16" data-ref-filename="mDNSVal16">mDNSVal16</a>(<a class="local col7 ref" href="#467request" title='request' data-ref="467request" data-ref-filename="467request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::ReqExt" title='request_state::(anonymous union)::(anonymous struct)::ReqExt' data-ref="request_state::(anonymousunion)::(anonymous)::ReqExt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..ReqExt">ReqExt</a>), <a class="local col7 ref" href="#467request" title='request' data-ref="467request" data-ref-filename="467request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::NATLease" title='NATTraversalInfo_struct::NATLease' data-ref="NATTraversalInfo_struct::NATLease" data-ref-filename="NATTraversalInfo_struct..NATLease">NATLease</a>,</td></tr>
<tr><th id="4141">4141</th><td>                 <a class="local col7 ref" href="#467request" title='request' data-ref="467request" data-ref-filename="467request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col7 ref" href="#467request" title='request' data-ref="467request" data-ref-filename="467request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="4142">4142</th><td>    <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_StopNATOperation" title='mDNS_StopNATOperation' data-ref="mDNS_StopNATOperation" data-ref-filename="mDNS_StopNATOperation">mDNS_StopNATOperation</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col7 ref" href="#467request" title='request' data-ref="467request" data-ref-filename="467request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>);</td></tr>
<tr><th id="4143">4143</th><td>}</td></tr>
<tr><th id="4144">4144</th><td></td></tr>
<tr><th id="4145">4145</th><td><i>// Called via function pointer when we get a NAT Traversal (address request or port mapping) response</i></td></tr>
<tr><th id="4146">4146</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="port_mapping_create_request_callback" title='port_mapping_create_request_callback' data-ref="port_mapping_create_request_callback" data-ref-filename="port_mapping_create_request_callback">port_mapping_create_request_callback</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS" title='mDNS' data-type='struct mDNS_struct' data-ref="mDNS" data-ref-filename="mDNS">mDNS</a> *<dfn class="local col8 decl" id="468m" title='m' data-type='mDNS *' data-ref="468m" data-ref-filename="468m">m</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo" title='NATTraversalInfo' data-type='struct NATTraversalInfo_struct' data-ref="NATTraversalInfo" data-ref-filename="NATTraversalInfo">NATTraversalInfo</a> *<dfn class="local col9 decl" id="469n" title='n' data-type='NATTraversalInfo *' data-ref="469n" data-ref-filename="469n">n</dfn>)</td></tr>
<tr><th id="4147">4147</th><td>{</td></tr>
<tr><th id="4148">4148</th><td>    <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col0 decl" id="470request" title='request' data-type='request_state *' data-ref="470request" data-ref-filename="470request">request</dfn> = (<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *)<a class="local col9 ref" href="#469n" title='n' data-ref="469n" data-ref-filename="469n">n</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::clientContext" title='NATTraversalInfo_struct::clientContext' data-ref="NATTraversalInfo_struct::clientContext" data-ref-filename="NATTraversalInfo_struct..clientContext">clientContext</a>;</td></tr>
<tr><th id="4149">4149</th><td>    <a class="typedef" href="uds_daemon.h.html#reply_state" title='reply_state' data-type='struct reply_state' data-ref="reply_state" data-ref-filename="reply_state">reply_state</a> *<dfn class="local col1 decl" id="471rep" title='rep' data-type='reply_state *' data-ref="471rep" data-ref-filename="471rep">rep</dfn>;</td></tr>
<tr><th id="4150">4150</th><td>    <em>int</em> <dfn class="local col2 decl" id="472replyLen" title='replyLen' data-type='int' data-ref="472replyLen" data-ref-filename="472replyLen">replyLen</dfn>;</td></tr>
<tr><th id="4151">4151</th><td>    <em>char</em> *<dfn class="local col3 decl" id="473data" title='data' data-type='char *' data-ref="473data" data-ref-filename="473data">data</dfn>;</td></tr>
<tr><th id="4152">4152</th><td></td></tr>
<tr><th id="4153">4153</th><td>    <b>if</b> (!<a class="local col0 ref" href="#470request" title='request' data-ref="470request" data-ref-filename="470request">request</a>) { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;port_mapping_create_request_callback called with unknown request_state object&quot;)" data-ref="_M/LogMsg">LogMsg</a>(<q>"port_mapping_create_request_callback called with unknown request_state object"</q>); <b>return</b>; }</td></tr>
<tr><th id="4154">4154</th><td></td></tr>
<tr><th id="4155">4155</th><td>    <i>// calculate reply data length</i></td></tr>
<tr><th id="4156">4156</th><td>    <a class="local col2 ref" href="#472replyLen" title='replyLen' data-ref="472replyLen" data-ref-filename="472replyLen">replyLen</a> = <b>sizeof</b>(<a class="typedef" href="dns_sd.h.html#DNSServiceFlags" title='DNSServiceFlags' data-type='uint32_t' data-ref="DNSServiceFlags" data-ref-filename="DNSServiceFlags">DNSServiceFlags</a>);</td></tr>
<tr><th id="4157">4157</th><td>    <a class="local col2 ref" href="#472replyLen" title='replyLen' data-ref="472replyLen" data-ref-filename="472replyLen">replyLen</a> += <var>3</var> * <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a>);  <i>// if index + addr + ttl</i></td></tr>
<tr><th id="4158">4158</th><td>    <a class="local col2 ref" href="#472replyLen" title='replyLen' data-ref="472replyLen" data-ref-filename="472replyLen">replyLen</a> += <b>sizeof</b>(<a class="typedef" href="dns_sd.h.html#DNSServiceErrorType" title='DNSServiceErrorType' data-type='int32_t' data-ref="DNSServiceErrorType" data-ref-filename="DNSServiceErrorType">DNSServiceErrorType</a>);</td></tr>
<tr><th id="4159">4159</th><td>    <a class="local col2 ref" href="#472replyLen" title='replyLen' data-ref="472replyLen" data-ref-filename="472replyLen">replyLen</a> += <var>2</var> * <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu16" title='mDNSu16' data-type='unsigned short' data-ref="mDNSu16" data-ref-filename="mDNSu16">mDNSu16</a>);  <i>// Internal Port + External Port</i></td></tr>
<tr><th id="4160">4160</th><td>    <a class="local col2 ref" href="#472replyLen" title='replyLen' data-ref="472replyLen" data-ref-filename="472replyLen">replyLen</a> += <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu8" title='mDNSu8' data-type='unsigned char' data-ref="mDNSu8" data-ref-filename="mDNSu8">mDNSu8</a>);       <i>// protocol</i></td></tr>
<tr><th id="4161">4161</th><td></td></tr>
<tr><th id="4162">4162</th><td>    <a class="local col1 ref" href="#471rep" title='rep' data-ref="471rep" data-ref-filename="471rep">rep</a> = <a class="ref fn" href="#create_reply" title='create_reply' data-ref="create_reply" data-ref-filename="create_reply">create_reply</a>(<a class="enum" href="dnssd_ipc.h.html#port_mapping_reply_op" title='port_mapping_reply_op' data-ref="port_mapping_reply_op" data-ref-filename="port_mapping_reply_op">port_mapping_reply_op</a>, <a class="local col2 ref" href="#472replyLen" title='replyLen' data-ref="472replyLen" data-ref-filename="472replyLen">replyLen</a>, <a class="local col0 ref" href="#470request" title='request' data-ref="470request" data-ref-filename="470request">request</a>);</td></tr>
<tr><th id="4163">4163</th><td></td></tr>
<tr><th id="4164">4164</th><td>    <a class="local col1 ref" href="#471rep" title='rep' data-ref="471rep" data-ref-filename="471rep">rep</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::rhdr" title='reply_state::rhdr' data-ref="reply_state::rhdr" data-ref-filename="reply_state..rhdr">rhdr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#(anonymous)::flags" title='(anonymous struct)::flags' data-ref="(anonymous)::flags" data-ref-filename="(anonymous)..flags">flags</a> = <a class="ref fn" href="#dnssd_htonl" title='dnssd_htonl' data-ref="dnssd_htonl" data-ref-filename="dnssd_htonl">dnssd_htonl</a>(<var>0</var>);</td></tr>
<tr><th id="4165">4165</th><td>    <a class="local col1 ref" href="#471rep" title='rep' data-ref="471rep" data-ref-filename="471rep">rep</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::rhdr" title='reply_state::rhdr' data-ref="reply_state::rhdr" data-ref-filename="reply_state..rhdr">rhdr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#(anonymous)::ifi" title='(anonymous struct)::ifi' data-ref="(anonymous)::ifi" data-ref-filename="(anonymous)..ifi">ifi</a>   = <a class="ref fn" href="#dnssd_htonl" title='dnssd_htonl' data-ref="dnssd_htonl" data-ref-filename="dnssd_htonl">dnssd_htonl</a>(<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformInterfaceIndexfromInterfaceID" title='mDNSPlatformInterfaceIndexfromInterfaceID' data-ref="mDNSPlatformInterfaceIndexfromInterfaceID" data-ref-filename="mDNSPlatformInterfaceIndexfromInterfaceID">mDNSPlatformInterfaceIndexfromInterfaceID</a>(<a class="local col8 ref" href="#468m" title='m' data-ref="468m" data-ref-filename="468m">m</a>, <a class="local col9 ref" href="#469n" title='n' data-ref="469n" data-ref-filename="469n">n</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::InterfaceID" title='NATTraversalInfo_struct::InterfaceID' data-ref="NATTraversalInfo_struct::InterfaceID" data-ref-filename="NATTraversalInfo_struct..InterfaceID">InterfaceID</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>));</td></tr>
<tr><th id="4166">4166</th><td>    <a class="local col1 ref" href="#471rep" title='rep' data-ref="471rep" data-ref-filename="471rep">rep</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::rhdr" title='reply_state::rhdr' data-ref="reply_state::rhdr" data-ref-filename="reply_state..rhdr">rhdr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#(anonymous)::error" title='(anonymous struct)::error' data-ref="(anonymous)::error" data-ref-filename="(anonymous)..error">error</a> = <a class="ref fn" href="#dnssd_htonl" title='dnssd_htonl' data-ref="dnssd_htonl" data-ref-filename="dnssd_htonl">dnssd_htonl</a>(<a class="local col9 ref" href="#469n" title='n' data-ref="469n" data-ref-filename="469n">n</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::Result" title='NATTraversalInfo_struct::Result' data-ref="NATTraversalInfo_struct::Result" data-ref-filename="NATTraversalInfo_struct..Result">Result</a>);</td></tr>
<tr><th id="4167">4167</th><td></td></tr>
<tr><th id="4168">4168</th><td>    <a class="local col3 ref" href="#473data" title='data' data-ref="473data" data-ref-filename="473data">data</a> = (<em>char</em> *)&amp;<a class="local col1 ref" href="#471rep" title='rep' data-ref="471rep" data-ref-filename="471rep">rep</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::rhdr" title='reply_state::rhdr' data-ref="reply_state::rhdr" data-ref-filename="reply_state..rhdr">rhdr</a>[<var>1</var>];</td></tr>
<tr><th id="4169">4169</th><td></td></tr>
<tr><th id="4170">4170</th><td>    *<a class="local col3 ref" href="#473data" title='data' data-ref="473data" data-ref-filename="473data">data</a>++ = <a class="local col0 ref" href="#470request" title='request' data-ref="470request" data-ref-filename="470request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::ExternalAddress" title='NATTraversalInfo_struct::ExternalAddress' data-ref="NATTraversalInfo_struct::ExternalAddress" data-ref-filename="NATTraversalInfo_struct..ExternalAddress">ExternalAddress</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::b" title='(anonymous union)::b' data-ref="(anonymous)::b" data-ref-filename="(anonymous)..b">b</a>[<var>0</var>];</td></tr>
<tr><th id="4171">4171</th><td>    *<a class="local col3 ref" href="#473data" title='data' data-ref="473data" data-ref-filename="473data">data</a>++ = <a class="local col0 ref" href="#470request" title='request' data-ref="470request" data-ref-filename="470request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::ExternalAddress" title='NATTraversalInfo_struct::ExternalAddress' data-ref="NATTraversalInfo_struct::ExternalAddress" data-ref-filename="NATTraversalInfo_struct..ExternalAddress">ExternalAddress</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::b" title='(anonymous union)::b' data-ref="(anonymous)::b" data-ref-filename="(anonymous)..b">b</a>[<var>1</var>];</td></tr>
<tr><th id="4172">4172</th><td>    *<a class="local col3 ref" href="#473data" title='data' data-ref="473data" data-ref-filename="473data">data</a>++ = <a class="local col0 ref" href="#470request" title='request' data-ref="470request" data-ref-filename="470request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::ExternalAddress" title='NATTraversalInfo_struct::ExternalAddress' data-ref="NATTraversalInfo_struct::ExternalAddress" data-ref-filename="NATTraversalInfo_struct..ExternalAddress">ExternalAddress</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::b" title='(anonymous union)::b' data-ref="(anonymous)::b" data-ref-filename="(anonymous)..b">b</a>[<var>2</var>];</td></tr>
<tr><th id="4173">4173</th><td>    *<a class="local col3 ref" href="#473data" title='data' data-ref="473data" data-ref-filename="473data">data</a>++ = <a class="local col0 ref" href="#470request" title='request' data-ref="470request" data-ref-filename="470request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::ExternalAddress" title='NATTraversalInfo_struct::ExternalAddress' data-ref="NATTraversalInfo_struct::ExternalAddress" data-ref-filename="NATTraversalInfo_struct..ExternalAddress">ExternalAddress</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::b" title='(anonymous union)::b' data-ref="(anonymous)::b" data-ref-filename="(anonymous)..b">b</a>[<var>3</var>];</td></tr>
<tr><th id="4174">4174</th><td>    *<a class="local col3 ref" href="#473data" title='data' data-ref="473data" data-ref-filename="473data">data</a>++ = <a class="macro" href="#4134" title="((request-&gt;u.pm.NATinfo.Protocol) == NATOp_AddrRequest ? 0 : (request-&gt;u.pm.NATinfo.Protocol) == NATOp_MapUDP ? kDNSServiceProtocol_UDP : kDNSServiceProtocol_TCP)" data-ref="_M/DNSServiceProtocol">DNSServiceProtocol</a>(<a class="local col0 ref" href="#470request" title='request' data-ref="470request" data-ref-filename="470request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::Protocol" title='NATTraversalInfo_struct::Protocol' data-ref="NATTraversalInfo_struct::Protocol" data-ref-filename="NATTraversalInfo_struct..Protocol">Protocol</a>);</td></tr>
<tr><th id="4175">4175</th><td>    *<a class="local col3 ref" href="#473data" title='data' data-ref="473data" data-ref-filename="473data">data</a>++ = <a class="local col0 ref" href="#470request" title='request' data-ref="470request" data-ref-filename="470request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::IntPort" title='NATTraversalInfo_struct::IntPort' data-ref="NATTraversalInfo_struct::IntPort" data-ref-filename="NATTraversalInfo_struct..IntPort">IntPort</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::b" title='(anonymous union)::b' data-ref="(anonymous)::b" data-ref-filename="(anonymous)..b">b</a>[<var>0</var>];</td></tr>
<tr><th id="4176">4176</th><td>    *<a class="local col3 ref" href="#473data" title='data' data-ref="473data" data-ref-filename="473data">data</a>++ = <a class="local col0 ref" href="#470request" title='request' data-ref="470request" data-ref-filename="470request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::IntPort" title='NATTraversalInfo_struct::IntPort' data-ref="NATTraversalInfo_struct::IntPort" data-ref-filename="NATTraversalInfo_struct..IntPort">IntPort</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::b" title='(anonymous union)::b' data-ref="(anonymous)::b" data-ref-filename="(anonymous)..b">b</a>[<var>1</var>];</td></tr>
<tr><th id="4177">4177</th><td>    *<a class="local col3 ref" href="#473data" title='data' data-ref="473data" data-ref-filename="473data">data</a>++ = <a class="local col0 ref" href="#470request" title='request' data-ref="470request" data-ref-filename="470request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::ExternalPort" title='NATTraversalInfo_struct::ExternalPort' data-ref="NATTraversalInfo_struct::ExternalPort" data-ref-filename="NATTraversalInfo_struct..ExternalPort">ExternalPort</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::b" title='(anonymous union)::b' data-ref="(anonymous)::b" data-ref-filename="(anonymous)..b">b</a>[<var>0</var>];</td></tr>
<tr><th id="4178">4178</th><td>    *<a class="local col3 ref" href="#473data" title='data' data-ref="473data" data-ref-filename="473data">data</a>++ = <a class="local col0 ref" href="#470request" title='request' data-ref="470request" data-ref-filename="470request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::ExternalPort" title='NATTraversalInfo_struct::ExternalPort' data-ref="NATTraversalInfo_struct::ExternalPort" data-ref-filename="NATTraversalInfo_struct..ExternalPort">ExternalPort</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::b" title='(anonymous union)::b' data-ref="(anonymous)::b" data-ref-filename="(anonymous)..b">b</a>[<var>1</var>];</td></tr>
<tr><th id="4179">4179</th><td>    <a class="macro" href="dnssd_ipc.h.html#193" title="__dnssd_ipc_put_uint32" data-ref="_M/put_uint32">put_uint32</a>(<a class="local col0 ref" href="#470request" title='request' data-ref="470request" data-ref-filename="470request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::Lifetime" title='NATTraversalInfo_struct::Lifetime' data-ref="NATTraversalInfo_struct::Lifetime" data-ref-filename="NATTraversalInfo_struct..Lifetime">Lifetime</a>, &amp;<a class="local col3 ref" href="#473data" title='data' data-ref="473data" data-ref-filename="473data">data</a>);</td></tr>
<tr><th id="4180">4180</th><td></td></tr>
<tr><th id="4181">4181</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: DNSServiceNATPortMappingCreate(%X, %u, %u, %d) RESULT %.4a:%u TTL %u&quot;, request-&gt;sd, ((request-&gt;u.pm.NATinfo.Protocol) == NATOp_AddrRequest ? 0 : (request-&gt;u.pm.NATinfo.Protocol) == NATOp_MapUDP ? kDNSServiceProtocol_UDP : kDNSServiceProtocol_TCP), mDNSVal16(request-&gt;u.pm.NATinfo.IntPort), mDNSVal16(request-&gt;u.pm.ReqExt), request-&gt;u.pm.NATinfo.NATLease, &amp;request-&gt;u.pm.NATinfo.ExternalAddress, mDNSVal16(request-&gt;u.pm.NATinfo.ExternalPort), request-&gt;u.pm.NATinfo.Lifetime);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: DNSServiceNATPortMappingCreate(%X, %u, %u, %d) RESULT %.4a:%u TTL %u"</q>, <a class="local col0 ref" href="#470request" title='request' data-ref="470request" data-ref-filename="470request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>,</td></tr>
<tr><th id="4182">4182</th><td>                 <a class="macro" href="#4134" title="((request-&gt;u.pm.NATinfo.Protocol) == NATOp_AddrRequest ? 0 : (request-&gt;u.pm.NATinfo.Protocol) == NATOp_MapUDP ? kDNSServiceProtocol_UDP : kDNSServiceProtocol_TCP)" data-ref="_M/DNSServiceProtocol">DNSServiceProtocol</a>(<a class="local col0 ref" href="#470request" title='request' data-ref="470request" data-ref-filename="470request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::Protocol" title='NATTraversalInfo_struct::Protocol' data-ref="NATTraversalInfo_struct::Protocol" data-ref-filename="NATTraversalInfo_struct..Protocol">Protocol</a>),</td></tr>
<tr><th id="4183">4183</th><td>                 <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSVal16" title='mDNSVal16' data-ref="mDNSVal16" data-ref-filename="mDNSVal16">mDNSVal16</a>(<a class="local col0 ref" href="#470request" title='request' data-ref="470request" data-ref-filename="470request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::IntPort" title='NATTraversalInfo_struct::IntPort' data-ref="NATTraversalInfo_struct::IntPort" data-ref-filename="NATTraversalInfo_struct..IntPort">IntPort</a>), <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSVal16" title='mDNSVal16' data-ref="mDNSVal16" data-ref-filename="mDNSVal16">mDNSVal16</a>(<a class="local col0 ref" href="#470request" title='request' data-ref="470request" data-ref-filename="470request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::ReqExt" title='request_state::(anonymous union)::(anonymous struct)::ReqExt' data-ref="request_state::(anonymousunion)::(anonymous)::ReqExt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..ReqExt">ReqExt</a>), <a class="local col0 ref" href="#470request" title='request' data-ref="470request" data-ref-filename="470request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::NATLease" title='NATTraversalInfo_struct::NATLease' data-ref="NATTraversalInfo_struct::NATLease" data-ref-filename="NATTraversalInfo_struct..NATLease">NATLease</a>,</td></tr>
<tr><th id="4184">4184</th><td>                 &amp;<a class="local col0 ref" href="#470request" title='request' data-ref="470request" data-ref-filename="470request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::ExternalAddress" title='NATTraversalInfo_struct::ExternalAddress' data-ref="NATTraversalInfo_struct::ExternalAddress" data-ref-filename="NATTraversalInfo_struct..ExternalAddress">ExternalAddress</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSVal16" title='mDNSVal16' data-ref="mDNSVal16" data-ref-filename="mDNSVal16">mDNSVal16</a>(<a class="local col0 ref" href="#470request" title='request' data-ref="470request" data-ref-filename="470request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::ExternalPort" title='NATTraversalInfo_struct::ExternalPort' data-ref="NATTraversalInfo_struct::ExternalPort" data-ref-filename="NATTraversalInfo_struct..ExternalPort">ExternalPort</a>), <a class="local col0 ref" href="#470request" title='request' data-ref="470request" data-ref-filename="470request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::Lifetime" title='NATTraversalInfo_struct::Lifetime' data-ref="NATTraversalInfo_struct::Lifetime" data-ref-filename="NATTraversalInfo_struct..Lifetime">Lifetime</a>);</td></tr>
<tr><th id="4185">4185</th><td></td></tr>
<tr><th id="4186">4186</th><td>    <a class="ref fn" href="#append_reply" title='append_reply' data-ref="append_reply" data-ref-filename="append_reply">append_reply</a>(<a class="local col0 ref" href="#470request" title='request' data-ref="470request" data-ref-filename="470request">request</a>, <a class="local col1 ref" href="#471rep" title='rep' data-ref="471rep" data-ref-filename="471rep">rep</a>);</td></tr>
<tr><th id="4187">4187</th><td>}</td></tr>
<tr><th id="4188">4188</th><td></td></tr>
<tr><th id="4189">4189</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="decl def fn" id="handle_port_mapping_request" title='handle_port_mapping_request' data-ref="handle_port_mapping_request" data-ref-filename="handle_port_mapping_request">handle_port_mapping_request</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col4 decl" id="474request" title='request' data-type='request_state *' data-ref="474request" data-ref-filename="474request">request</dfn>)</td></tr>
<tr><th id="4190">4190</th><td>{</td></tr>
<tr><th id="4191">4191</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col5 decl" id="475ttl" title='ttl' data-type='mDNSu32' data-ref="475ttl" data-ref-filename="475ttl">ttl</dfn> = <var>0</var>;</td></tr>
<tr><th id="4192">4192</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="local col6 decl" id="476err" title='err' data-type='mStatus' data-ref="476err" data-ref-filename="476err">err</dfn> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_NoError" title='mStatus_NoError' data-ref="mStatus_NoError" data-ref-filename="mStatus_NoError">mStatus_NoError</a>;</td></tr>
<tr><th id="4193">4193</th><td></td></tr>
<tr><th id="4194">4194</th><td>    <a class="typedef" href="dns_sd.h.html#DNSServiceFlags" title='DNSServiceFlags' data-type='uint32_t' data-ref="DNSServiceFlags" data-ref-filename="DNSServiceFlags">DNSServiceFlags</a> <dfn class="local col7 decl" id="477flags" title='flags' data-type='DNSServiceFlags' data-ref="477flags" data-ref-filename="477flags">flags</dfn>          = <a class="macro" href="dnssd_ipc.h.html#210" title="__dnssd_ipc_get_uint32" data-ref="_M/get_flags">get_flags</a>(&amp;<a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);</td></tr>
<tr><th id="4195">4195</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col8 decl" id="478interfaceIndex" title='interfaceIndex' data-type='mDNSu32' data-ref="478interfaceIndex" data-ref-filename="478interfaceIndex">interfaceIndex</dfn> = <a class="macro" href="dnssd_ipc.h.html#194" title="__dnssd_ipc_get_uint32" data-ref="_M/get_uint32">get_uint32</a>(&amp;<a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);</td></tr>
<tr><th id="4196">4196</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterfaceID" title='mDNSInterfaceID' data-type='struct mDNSInterfaceID_dummystruct *' data-ref="mDNSInterfaceID" data-ref-filename="mDNSInterfaceID">mDNSInterfaceID</a> <dfn class="local col9 decl" id="479InterfaceID" title='InterfaceID' data-type='mDNSInterfaceID' data-ref="479InterfaceID" data-ref-filename="479InterfaceID">InterfaceID</dfn>    = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformInterfaceIDfromInterfaceIndex" title='mDNSPlatformInterfaceIDfromInterfaceIndex' data-ref="mDNSPlatformInterfaceIDfromInterfaceIndex" data-ref-filename="mDNSPlatformInterfaceIDfromInterfaceIndex">mDNSPlatformInterfaceIDfromInterfaceIndex</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col8 ref" href="#478interfaceIndex" title='interfaceIndex' data-ref="478interfaceIndex" data-ref-filename="478interfaceIndex">interfaceIndex</a>);</td></tr>
<tr><th id="4197">4197</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu8" title='mDNSu8' data-type='unsigned char' data-ref="mDNSu8" data-ref-filename="mDNSu8">mDNSu8</a> <dfn class="local col0 decl" id="480protocol" title='protocol' data-type='mDNSu8' data-ref="480protocol" data-ref-filename="480protocol">protocol</dfn>       = (<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu8" title='mDNSu8' data-type='unsigned char' data-ref="mDNSu8" data-ref-filename="mDNSu8">mDNSu8</a>)<a class="macro" href="dnssd_ipc.h.html#194" title="__dnssd_ipc_get_uint32" data-ref="_M/get_uint32">get_uint32</a>(&amp;<a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);</td></tr>
<tr><th id="4198">4198</th><td>    (<em>void</em>)<a class="local col7 ref" href="#477flags" title='flags' data-ref="477flags" data-ref-filename="477flags">flags</a>; <i>// Unused</i></td></tr>
<tr><th id="4199">4199</th><td>    <b>if</b> (<a class="local col8 ref" href="#478interfaceIndex" title='interfaceIndex' data-ref="478interfaceIndex" data-ref-filename="478interfaceIndex">interfaceIndex</a> &amp;&amp; !<a class="local col9 ref" href="#479InterfaceID" title='InterfaceID' data-ref="479InterfaceID" data-ref-filename="479InterfaceID">InterfaceID</a>) <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>);</td></tr>
<tr><th id="4200">4200</th><td>    <b>if</b> (<a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a> + <var>8</var> &gt; <a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>) <a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a> = <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="4201">4201</th><td>    <b>else</b></td></tr>
<tr><th id="4202">4202</th><td>    {</td></tr>
<tr><th id="4203">4203</th><td>        <a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::IntPort" title='NATTraversalInfo_struct::IntPort' data-ref="NATTraversalInfo_struct::IntPort" data-ref-filename="NATTraversalInfo_struct..IntPort">IntPort</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::b" title='(anonymous union)::b' data-ref="(anonymous)::b" data-ref-filename="(anonymous)..b">b</a>[<var>0</var>] = *<a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>++;</td></tr>
<tr><th id="4204">4204</th><td>        <a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::IntPort" title='NATTraversalInfo_struct::IntPort' data-ref="NATTraversalInfo_struct::IntPort" data-ref-filename="NATTraversalInfo_struct..IntPort">IntPort</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::b" title='(anonymous union)::b' data-ref="(anonymous)::b" data-ref-filename="(anonymous)..b">b</a>[<var>1</var>] = *<a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>++;</td></tr>
<tr><th id="4205">4205</th><td>        <a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::ReqExt" title='request_state::(anonymous union)::(anonymous struct)::ReqExt' data-ref="request_state::(anonymousunion)::(anonymous)::ReqExt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..ReqExt">ReqExt</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::b" title='(anonymous union)::b' data-ref="(anonymous)::b" data-ref-filename="(anonymous)..b">b</a>[<var>0</var>]          = *<a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>++;</td></tr>
<tr><th id="4206">4206</th><td>        <a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::ReqExt" title='request_state::(anonymous union)::(anonymous struct)::ReqExt' data-ref="request_state::(anonymousunion)::(anonymous)::ReqExt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..ReqExt">ReqExt</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::b" title='(anonymous union)::b' data-ref="(anonymous)::b" data-ref-filename="(anonymous)..b">b</a>[<var>1</var>]          = *<a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>++;</td></tr>
<tr><th id="4207">4207</th><td>        <a class="local col5 ref" href="#475ttl" title='ttl' data-ref="475ttl" data-ref-filename="475ttl">ttl</a> = <a class="macro" href="dnssd_ipc.h.html#194" title="__dnssd_ipc_get_uint32" data-ref="_M/get_uint32">get_uint32</a>(&amp;<a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);</td></tr>
<tr><th id="4208">4208</th><td>    }</td></tr>
<tr><th id="4209">4209</th><td></td></tr>
<tr><th id="4210">4210</th><td>    <b>if</b> (!<a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>)</td></tr>
<tr><th id="4211">4211</th><td>    { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: DNSServiceNATPortMappingCreate(unreadable parameters)&quot;, request-&gt;sd)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: DNSServiceNATPortMappingCreate(unreadable parameters)"</q>, <a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>); <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>); }</td></tr>
<tr><th id="4212">4212</th><td></td></tr>
<tr><th id="4213">4213</th><td>    <b>if</b> (<a class="local col0 ref" href="#480protocol" title='protocol' data-ref="480protocol" data-ref-filename="480protocol">protocol</a> == <var>0</var>)  <i>// If protocol == 0 (i.e. just request public address) then IntPort, ExtPort, ttl must be zero too</i></td></tr>
<tr><th id="4214">4214</th><td>    {</td></tr>
<tr><th id="4215">4215</th><td>        <b>if</b> (!<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2963" title="((request-&gt;u.pm.NATinfo.IntPort).NotAnInteger == 0)" data-ref="_M/mDNSIPPortIsZero">mDNSIPPortIsZero</a>(<a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::IntPort" title='NATTraversalInfo_struct::IntPort' data-ref="NATTraversalInfo_struct::IntPort" data-ref-filename="NATTraversalInfo_struct..IntPort">IntPort</a>) || !<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2963" title="((request-&gt;u.pm.ReqExt).NotAnInteger == 0)" data-ref="_M/mDNSIPPortIsZero">mDNSIPPortIsZero</a>(<a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::ReqExt" title='request_state::(anonymous union)::(anonymous struct)::ReqExt' data-ref="request_state::(anonymousunion)::(anonymous)::ReqExt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..ReqExt">ReqExt</a>) || <a class="local col5 ref" href="#475ttl" title='ttl' data-ref="475ttl" data-ref-filename="475ttl">ttl</a>) <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>);</td></tr>
<tr><th id="4216">4216</th><td>    }</td></tr>
<tr><th id="4217">4217</th><td>    <b>else</b></td></tr>
<tr><th id="4218">4218</th><td>    {</td></tr>
<tr><th id="4219">4219</th><td>        <b>if</b> (<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2963" title="((request-&gt;u.pm.NATinfo.IntPort).NotAnInteger == 0)" data-ref="_M/mDNSIPPortIsZero">mDNSIPPortIsZero</a>(<a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::IntPort" title='NATTraversalInfo_struct::IntPort' data-ref="NATTraversalInfo_struct::IntPort" data-ref-filename="NATTraversalInfo_struct..IntPort">IntPort</a>)) <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>);</td></tr>
<tr><th id="4220">4220</th><td>        <b>if</b> (!(<a class="local col0 ref" href="#480protocol" title='protocol' data-ref="480protocol" data-ref-filename="480protocol">protocol</a> &amp; (<a class="enum" href="dns_sd.h.html#kDNSServiceProtocol_UDP" title='kDNSServiceProtocol_UDP' data-ref="kDNSServiceProtocol_UDP" data-ref-filename="kDNSServiceProtocol_UDP">kDNSServiceProtocol_UDP</a> | <a class="enum" href="dns_sd.h.html#kDNSServiceProtocol_TCP" title='kDNSServiceProtocol_TCP' data-ref="kDNSServiceProtocol_TCP" data-ref-filename="kDNSServiceProtocol_TCP">kDNSServiceProtocol_TCP</a>))) <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>);</td></tr>
<tr><th id="4221">4221</th><td>    }</td></tr>
<tr><th id="4222">4222</th><td></td></tr>
<tr><th id="4223">4223</th><td>    <a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a>                       = <a class="local col7 ref" href="#477flags" title='flags' data-ref="477flags" data-ref-filename="477flags">flags</a>;</td></tr>
<tr><th id="4224">4224</th><td>    <a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::interfaceIndex" title='request_state::interfaceIndex' data-ref="request_state::interfaceIndex" data-ref-filename="request_state..interfaceIndex">interfaceIndex</a>              = <a class="local col8 ref" href="#478interfaceIndex" title='interfaceIndex' data-ref="478interfaceIndex" data-ref-filename="478interfaceIndex">interfaceIndex</a>;</td></tr>
<tr><th id="4225">4225</th><td>    <a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::Protocol" title='NATTraversalInfo_struct::Protocol' data-ref="NATTraversalInfo_struct::Protocol" data-ref-filename="NATTraversalInfo_struct..Protocol">Protocol</a>       = !<a class="local col0 ref" href="#480protocol" title='protocol' data-ref="480protocol" data-ref-filename="480protocol">protocol</a> ? <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATOp_AddrRequest" title='NATOp_AddrRequest' data-ref="NATOp_AddrRequest" data-ref-filename="NATOp_AddrRequest">NATOp_AddrRequest</a> : (<a class="local col0 ref" href="#480protocol" title='protocol' data-ref="480protocol" data-ref-filename="480protocol">protocol</a> == <a class="enum" href="dns_sd.h.html#kDNSServiceProtocol_UDP" title='kDNSServiceProtocol_UDP' data-ref="kDNSServiceProtocol_UDP" data-ref-filename="kDNSServiceProtocol_UDP">kDNSServiceProtocol_UDP</a>) ? <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATOp_MapUDP" title='NATOp_MapUDP' data-ref="NATOp_MapUDP" data-ref-filename="NATOp_MapUDP">NATOp_MapUDP</a> : <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATOp_MapTCP" title='NATOp_MapTCP' data-ref="NATOp_MapTCP" data-ref-filename="NATOp_MapTCP">NATOp_MapTCP</a>;</td></tr>
<tr><th id="4226">4226</th><td>    <i>//       u.pm.NATinfo.IntPort        = already set above</i></td></tr>
<tr><th id="4227">4227</th><td>    <a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::RequestedPort" title='NATTraversalInfo_struct::RequestedPort' data-ref="NATTraversalInfo_struct::RequestedPort" data-ref-filename="NATTraversalInfo_struct..RequestedPort">RequestedPort</a>  = <a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::ReqExt" title='request_state::(anonymous union)::(anonymous struct)::ReqExt' data-ref="request_state::(anonymousunion)::(anonymous)::ReqExt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..ReqExt">ReqExt</a>;</td></tr>
<tr><th id="4228">4228</th><td>    <a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::NATLease" title='NATTraversalInfo_struct::NATLease' data-ref="NATTraversalInfo_struct::NATLease" data-ref-filename="NATTraversalInfo_struct..NATLease">NATLease</a>       = <a class="local col5 ref" href="#475ttl" title='ttl' data-ref="475ttl" data-ref-filename="475ttl">ttl</a>;</td></tr>
<tr><th id="4229">4229</th><td>    <a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::clientCallback" title='NATTraversalInfo_struct::clientCallback' data-ref="NATTraversalInfo_struct::clientCallback" data-ref-filename="NATTraversalInfo_struct..clientCallback">clientCallback</a> = <a class="ref fn" href="#port_mapping_create_request_callback" title='port_mapping_create_request_callback' data-ref="port_mapping_create_request_callback" data-ref-filename="port_mapping_create_request_callback">port_mapping_create_request_callback</a>;</td></tr>
<tr><th id="4230">4230</th><td>    <a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::clientContext" title='NATTraversalInfo_struct::clientContext' data-ref="NATTraversalInfo_struct::clientContext" data-ref-filename="NATTraversalInfo_struct..clientContext">clientContext</a>  = <a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>;</td></tr>
<tr><th id="4231">4231</th><td></td></tr>
<tr><th id="4232">4232</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: DNSServiceNATPortMappingCreate(%X, %u, %u, %d) START PID[%d](%s)&quot;, request-&gt;sd, protocol, mDNSVal16(request-&gt;u.pm.NATinfo.IntPort), mDNSVal16(request-&gt;u.pm.ReqExt), request-&gt;u.pm.NATinfo.NATLease, request-&gt;process_id, request-&gt;pid_name);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: DNSServiceNATPortMappingCreate(%X, %u, %u, %d) START PID[%d](%s)"</q>, <a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>,</td></tr>
<tr><th id="4233">4233</th><td>                 <a class="local col0 ref" href="#480protocol" title='protocol' data-ref="480protocol" data-ref-filename="480protocol">protocol</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSVal16" title='mDNSVal16' data-ref="mDNSVal16" data-ref-filename="mDNSVal16">mDNSVal16</a>(<a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::IntPort" title='NATTraversalInfo_struct::IntPort' data-ref="NATTraversalInfo_struct::IntPort" data-ref-filename="NATTraversalInfo_struct..IntPort">IntPort</a>), <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSVal16" title='mDNSVal16' data-ref="mDNSVal16" data-ref-filename="mDNSVal16">mDNSVal16</a>(<a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::ReqExt" title='request_state::(anonymous union)::(anonymous struct)::ReqExt' data-ref="request_state::(anonymousunion)::(anonymous)::ReqExt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..ReqExt">ReqExt</a>), <a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::NATLease" title='NATTraversalInfo_struct::NATLease' data-ref="NATTraversalInfo_struct::NATLease" data-ref-filename="NATTraversalInfo_struct..NATLease">NATLease</a>,</td></tr>
<tr><th id="4234">4234</th><td>                 <a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="4235">4235</th><td>    <a class="local col6 ref" href="#476err" title='err' data-ref="476err" data-ref-filename="476err">err</a> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_StartNATOperation" title='mDNS_StartNATOperation' data-ref="mDNS_StartNATOperation" data-ref-filename="mDNS_StartNATOperation">mDNS_StartNATOperation</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>);</td></tr>
<tr><th id="4236">4236</th><td>    <b>if</b> (<a class="local col6 ref" href="#476err" title='err' data-ref="476err" data-ref-filename="476err">err</a>) <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;ERROR: mDNS_StartNATOperation: %d&quot;, (int)err)" data-ref="_M/LogMsg">LogMsg</a>(<q>"ERROR: mDNS_StartNATOperation: %d"</q>, (<em>int</em>)<a class="local col6 ref" href="#476err" title='err' data-ref="476err" data-ref-filename="476err">err</a>);</td></tr>
<tr><th id="4237">4237</th><td>    <b>else</b> <a class="local col4 ref" href="#474request" title='request' data-ref="474request" data-ref-filename="474request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> = <a class="ref fn" href="#port_mapping_termination_callback" title='port_mapping_termination_callback' data-ref="port_mapping_termination_callback" data-ref-filename="port_mapping_termination_callback">port_mapping_termination_callback</a>;</td></tr>
<tr><th id="4238">4238</th><td></td></tr>
<tr><th id="4239">4239</th><td>    <b>return</b>(<a class="local col6 ref" href="#476err" title='err' data-ref="476err" data-ref-filename="476err">err</a>);</td></tr>
<tr><th id="4240">4240</th><td>}</td></tr>
<tr><th id="4241">4241</th><td></td></tr>
<tr><th id="4242">4242</th><td><i>// ***************************************************************************</i></td></tr>
<tr><th id="4243">4243</th><td><u>#<span data-ppcond="4243">if</span> COMPILER_LIKES_PRAGMA_MARK</u></td></tr>
<tr><th id="4244">4244</th><td><u>#pragma mark -</u></td></tr>
<tr><th id="4245">4245</th><td><u>#pragma mark - DNSServiceGetAddrInfo</u></td></tr>
<tr><th id="4246">4246</th><td><u>#<span data-ppcond="4243">endif</span></u></td></tr>
<tr><th id="4247">4247</th><td></td></tr>
<tr><th id="4248">4248</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="addrinfo_termination_callback" title='addrinfo_termination_callback' data-ref="addrinfo_termination_callback" data-ref-filename="addrinfo_termination_callback">addrinfo_termination_callback</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col1 decl" id="481request" title='request' data-type='request_state *' data-ref="481request" data-ref-filename="481request">request</dfn>)</td></tr>
<tr><th id="4249">4249</th><td>{</td></tr>
<tr><th id="4250">4250</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: DNSServiceGetAddrInfo(%##s) STOP PID[%d](%s)&quot;, request-&gt;sd, request-&gt;u.addrinfo.q4.qname.c, request-&gt;process_id, request-&gt;pid_name);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: DNSServiceGetAddrInfo(%##s) STOP PID[%d](%s)"</q>, <a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>,</td></tr>
<tr><th id="4251">4251</th><td>                  <a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="4252">4252</th><td></td></tr>
<tr><th id="4253">4253</th><td>    <b>if</b> (<a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::QuestionContext" title='DNSQuestion_struct::QuestionContext' data-ref="DNSQuestion_struct::QuestionContext" data-ref-filename="DNSQuestion_struct..QuestionContext">QuestionContext</a>)</td></tr>
<tr><th id="4254">4254</th><td>    {</td></tr>
<tr><th id="4255">4255</th><td>        <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_StopQuery" title='mDNS_StopQuery' data-ref="mDNS_StopQuery" data-ref-filename="mDNS_StopQuery">mDNS_StopQuery</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>);</td></tr>
<tr><th id="4256">4256</th><td>        <a class="macro" href="uds_daemon.h.html#224" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMcastQuestion" data-ref="_M/LogMcastQ">LogMcastQ</a>(&amp;<a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>, <a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#q_stop" title='q_stop' data-ref="q_stop" data-ref-filename="q_stop">q_stop</a>);</td></tr>
<tr><th id="4257">4257</th><td>        <a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::QuestionContext" title='DNSQuestion_struct::QuestionContext' data-ref="DNSQuestion_struct::QuestionContext" data-ref-filename="DNSQuestion_struct..QuestionContext">QuestionContext</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="4258">4258</th><td></td></tr>
<tr><th id="4259">4259</th><td>        <b>if</b> (<a class="ref fn" href="#callExternalHelpers" title='callExternalHelpers' data-ref="callExternalHelpers" data-ref-filename="callExternalHelpers">callExternalHelpers</a>(<a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::interface_id" title='request_state::(anonymous union)::(anonymous struct)::interface_id' data-ref="request_state::(anonymousunion)::(anonymous)::interface_id" data-ref-filename="request_state..(anonymousunion)..(anonymous)..interface_id">interface_id</a>, &amp;<a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>, <a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a>))</td></tr>
<tr><th id="4260">4260</th><td>        {</td></tr>
<tr><th id="4261">4261</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;addrinfo_termination_callback: calling external_stop_browsing_for_service() for kDNSServiceType_A record&quot;);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"addrinfo_termination_callback: calling external_stop_browsing_for_service() for kDNSServiceType_A record"</q>);</td></tr>
<tr><th id="4262">4262</th><td>            <a class="macro" href="uds_daemon.h.html#265" title="(void)(request-&gt;u.addrinfo.interface_id)" data-ref="_M/external_stop_browsing_for_service">external_stop_browsing_for_service</a>(<a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::interface_id" title='request_state::(anonymous union)::(anonymous struct)::interface_id' data-ref="request_state::(anonymousunion)::(anonymous)::interface_id" data-ref-filename="request_state..(anonymousunion)..(anonymous)..interface_id">interface_id</a>, &amp;request-&gt;u.addrinfo.q4.qname, kDNSServiceType_A, request-&gt;flags);</td></tr>
<tr><th id="4263">4263</th><td>        }</td></tr>
<tr><th id="4264">4264</th><td>    }</td></tr>
<tr><th id="4265">4265</th><td>    <b>if</b> (<a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a>)</td></tr>
<tr><th id="4266">4266</th><td>    {</td></tr>
<tr><th id="4267">4267</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(request-&gt;u.addrinfo.q4.qnameOrig)" data-ref="_M/freeL">freeL</a>(<q>"QueryTermination"</q>, <a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a>);</td></tr>
<tr><th id="4268">4268</th><td>        <a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="4269">4269</th><td>    }</td></tr>
<tr><th id="4270">4270</th><td>    <b>if</b> (<a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q42" title='request_state::(anonymous union)::(anonymous struct)::q42' data-ref="request_state::(anonymousunion)::(anonymous)::q42" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q42">q42</a>)</td></tr>
<tr><th id="4271">4271</th><td>    {</td></tr>
<tr><th id="4272">4272</th><td>        <b>if</b> (<a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q42" title='request_state::(anonymous union)::(anonymous struct)::q42' data-ref="request_state::(anonymousunion)::(anonymous)::q42" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q42">q42</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::QuestionContext" title='DNSQuestion_struct::QuestionContext' data-ref="DNSQuestion_struct::QuestionContext" data-ref-filename="DNSQuestion_struct..QuestionContext">QuestionContext</a>)</td></tr>
<tr><th id="4273">4273</th><td>        {</td></tr>
<tr><th id="4274">4274</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;addrinfo_termination_callback: Stopping q42 %##s&quot;, request-&gt;u.addrinfo.q42-&gt;qname.c);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"addrinfo_termination_callback: Stopping q42 %##s"</q>, <a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q42" title='request_state::(anonymous union)::(anonymous struct)::q42' data-ref="request_state::(anonymousunion)::(anonymous)::q42" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q42">q42</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>);</td></tr>
<tr><th id="4275">4275</th><td>            <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_StopQuery" title='mDNS_StopQuery' data-ref="mDNS_StopQuery" data-ref-filename="mDNS_StopQuery">mDNS_StopQuery</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q42" title='request_state::(anonymous union)::(anonymous struct)::q42' data-ref="request_state::(anonymousunion)::(anonymous)::q42" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q42">q42</a>);</td></tr>
<tr><th id="4276">4276</th><td>            <a class="macro" href="uds_daemon.h.html#224" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMcastQuestion" data-ref="_M/LogMcastQ">LogMcastQ</a>(<a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q42" title='request_state::(anonymous union)::(anonymous struct)::q42' data-ref="request_state::(anonymousunion)::(anonymous)::q42" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q42">q42</a>, <a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#q_stop" title='q_stop' data-ref="q_stop" data-ref-filename="q_stop">q_stop</a>);</td></tr>
<tr><th id="4277">4277</th><td>        }</td></tr>
<tr><th id="4278">4278</th><td>        <b>if</b> (<a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q42" title='request_state::(anonymous union)::(anonymous struct)::q42' data-ref="request_state::(anonymousunion)::(anonymous)::q42" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q42">q42</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a>)</td></tr>
<tr><th id="4279">4279</th><td>        {</td></tr>
<tr><th id="4280">4280</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;addrinfo_termination_callback: freeing q42 qnameOrig %##s&quot;, request-&gt;u.addrinfo.q42-&gt;qnameOrig-&gt;c);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"addrinfo_termination_callback: freeing q42 qnameOrig %##s"</q>, <a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q42" title='request_state::(anonymous union)::(anonymous struct)::q42' data-ref="request_state::(anonymousunion)::(anonymous)::q42" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q42">q42</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>);</td></tr>
<tr><th id="4281">4281</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(request-&gt;u.addrinfo.q42-&gt;qnameOrig)" data-ref="_M/freeL">freeL</a>(<q>"QueryTermination q42"</q>, <a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q42" title='request_state::(anonymous union)::(anonymous struct)::q42' data-ref="request_state::(anonymousunion)::(anonymous)::q42" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q42">q42</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a>);</td></tr>
<tr><th id="4282">4282</th><td>            <a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q42" title='request_state::(anonymous union)::(anonymous struct)::q42' data-ref="request_state::(anonymousunion)::(anonymous)::q42" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q42">q42</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="4283">4283</th><td>        }</td></tr>
<tr><th id="4284">4284</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(request-&gt;u.addrinfo.q42)" data-ref="_M/freeL">freeL</a>(<q>"addrinfo Q42"</q>, <a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q42" title='request_state::(anonymous union)::(anonymous struct)::q42' data-ref="request_state::(anonymousunion)::(anonymous)::q42" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q42">q42</a>);</td></tr>
<tr><th id="4285">4285</th><td>        <a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q42" title='request_state::(anonymous union)::(anonymous struct)::q42' data-ref="request_state::(anonymousunion)::(anonymous)::q42" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q42">q42</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="4286">4286</th><td>    }</td></tr>
<tr><th id="4287">4287</th><td></td></tr>
<tr><th id="4288">4288</th><td>    <b>if</b> (<a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::QuestionContext" title='DNSQuestion_struct::QuestionContext' data-ref="DNSQuestion_struct::QuestionContext" data-ref-filename="DNSQuestion_struct..QuestionContext">QuestionContext</a>)</td></tr>
<tr><th id="4289">4289</th><td>    {</td></tr>
<tr><th id="4290">4290</th><td>        <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_StopQuery" title='mDNS_StopQuery' data-ref="mDNS_StopQuery" data-ref-filename="mDNS_StopQuery">mDNS_StopQuery</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>);</td></tr>
<tr><th id="4291">4291</th><td>        <a class="macro" href="uds_daemon.h.html#224" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMcastQuestion" data-ref="_M/LogMcastQ">LogMcastQ</a>(&amp;<a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>, <a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#q_stop" title='q_stop' data-ref="q_stop" data-ref-filename="q_stop">q_stop</a>);</td></tr>
<tr><th id="4292">4292</th><td>        <a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::QuestionContext" title='DNSQuestion_struct::QuestionContext' data-ref="DNSQuestion_struct::QuestionContext" data-ref-filename="DNSQuestion_struct..QuestionContext">QuestionContext</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="4293">4293</th><td></td></tr>
<tr><th id="4294">4294</th><td>        <b>if</b> (<a class="ref fn" href="#callExternalHelpers" title='callExternalHelpers' data-ref="callExternalHelpers" data-ref-filename="callExternalHelpers">callExternalHelpers</a>(<a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::interface_id" title='request_state::(anonymous union)::(anonymous struct)::interface_id' data-ref="request_state::(anonymousunion)::(anonymous)::interface_id" data-ref-filename="request_state..(anonymousunion)..(anonymous)..interface_id">interface_id</a>, &amp;<a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>, <a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a>))</td></tr>
<tr><th id="4295">4295</th><td>        {</td></tr>
<tr><th id="4296">4296</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;addrinfo_termination_callback: calling external_stop_browsing_for_service() for kDNSServiceType_AAAA record&quot;);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"addrinfo_termination_callback: calling external_stop_browsing_for_service() for kDNSServiceType_AAAA record"</q>);</td></tr>
<tr><th id="4297">4297</th><td>            <a class="macro" href="uds_daemon.h.html#265" title="(void)(request-&gt;u.addrinfo.interface_id)" data-ref="_M/external_stop_browsing_for_service">external_stop_browsing_for_service</a>(<a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::interface_id" title='request_state::(anonymous union)::(anonymous struct)::interface_id' data-ref="request_state::(anonymousunion)::(anonymous)::interface_id" data-ref-filename="request_state..(anonymousunion)..(anonymous)..interface_id">interface_id</a>, &amp;request-&gt;u.addrinfo.q6.qname, kDNSServiceType_AAAA, request-&gt;flags);</td></tr>
<tr><th id="4298">4298</th><td>        }</td></tr>
<tr><th id="4299">4299</th><td>    }</td></tr>
<tr><th id="4300">4300</th><td>    <b>if</b> (<a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a>)</td></tr>
<tr><th id="4301">4301</th><td>    {</td></tr>
<tr><th id="4302">4302</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(request-&gt;u.addrinfo.q6.qnameOrig)" data-ref="_M/freeL">freeL</a>(<q>"QueryTermination"</q>, <a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a>);</td></tr>
<tr><th id="4303">4303</th><td>        <a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="4304">4304</th><td>    }</td></tr>
<tr><th id="4305">4305</th><td>    <b>if</b> (<a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q62" title='request_state::(anonymous union)::(anonymous struct)::q62' data-ref="request_state::(anonymousunion)::(anonymous)::q62" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q62">q62</a>)</td></tr>
<tr><th id="4306">4306</th><td>    {</td></tr>
<tr><th id="4307">4307</th><td>        <b>if</b> (<a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q62" title='request_state::(anonymous union)::(anonymous struct)::q62' data-ref="request_state::(anonymousunion)::(anonymous)::q62" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q62">q62</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::QuestionContext" title='DNSQuestion_struct::QuestionContext' data-ref="DNSQuestion_struct::QuestionContext" data-ref-filename="DNSQuestion_struct..QuestionContext">QuestionContext</a>)</td></tr>
<tr><th id="4308">4308</th><td>        {</td></tr>
<tr><th id="4309">4309</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;addrinfo_termination_callback: Stopping q62 %##s&quot;, request-&gt;u.addrinfo.q62-&gt;qname.c);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"addrinfo_termination_callback: Stopping q62 %##s"</q>, <a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q62" title='request_state::(anonymous union)::(anonymous struct)::q62' data-ref="request_state::(anonymousunion)::(anonymous)::q62" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q62">q62</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>);</td></tr>
<tr><th id="4310">4310</th><td>            <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_StopQuery" title='mDNS_StopQuery' data-ref="mDNS_StopQuery" data-ref-filename="mDNS_StopQuery">mDNS_StopQuery</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q62" title='request_state::(anonymous union)::(anonymous struct)::q62' data-ref="request_state::(anonymousunion)::(anonymous)::q62" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q62">q62</a>);</td></tr>
<tr><th id="4311">4311</th><td>            <a class="macro" href="uds_daemon.h.html#224" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMcastQuestion" data-ref="_M/LogMcastQ">LogMcastQ</a>(<a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q62" title='request_state::(anonymous union)::(anonymous struct)::q62' data-ref="request_state::(anonymousunion)::(anonymous)::q62" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q62">q62</a>, <a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#q_stop" title='q_stop' data-ref="q_stop" data-ref-filename="q_stop">q_stop</a>);</td></tr>
<tr><th id="4312">4312</th><td>        }</td></tr>
<tr><th id="4313">4313</th><td>        <b>if</b> (<a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q62" title='request_state::(anonymous union)::(anonymous struct)::q62' data-ref="request_state::(anonymousunion)::(anonymous)::q62" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q62">q62</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a>)</td></tr>
<tr><th id="4314">4314</th><td>        {</td></tr>
<tr><th id="4315">4315</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;addrinfo_termination_callback: freeing q62 qnameOrig %##s&quot;, request-&gt;u.addrinfo.q62-&gt;qnameOrig-&gt;c);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"addrinfo_termination_callback: freeing q62 qnameOrig %##s"</q>, <a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q62" title='request_state::(anonymous union)::(anonymous struct)::q62' data-ref="request_state::(anonymousunion)::(anonymous)::q62" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q62">q62</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>);</td></tr>
<tr><th id="4316">4316</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(request-&gt;u.addrinfo.q62-&gt;qnameOrig)" data-ref="_M/freeL">freeL</a>(<q>"QueryTermination q62"</q>, <a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q62" title='request_state::(anonymous union)::(anonymous struct)::q62' data-ref="request_state::(anonymousunion)::(anonymous)::q62" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q62">q62</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a>);</td></tr>
<tr><th id="4317">4317</th><td>            <a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q62" title='request_state::(anonymous union)::(anonymous struct)::q62' data-ref="request_state::(anonymousunion)::(anonymous)::q62" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q62">q62</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="4318">4318</th><td>        }</td></tr>
<tr><th id="4319">4319</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(request-&gt;u.addrinfo.q62)" data-ref="_M/freeL">freeL</a>(<q>"addrinfo Q62"</q>, <a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q62" title='request_state::(anonymous union)::(anonymous struct)::q62' data-ref="request_state::(anonymousunion)::(anonymous)::q62" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q62">q62</a>);</td></tr>
<tr><th id="4320">4320</th><td>        <a class="local col1 ref" href="#481request" title='request' data-ref="481request" data-ref-filename="481request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q62" title='request_state::(anonymous union)::(anonymous struct)::q62' data-ref="request_state::(anonymousunion)::(anonymous)::q62" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q62">q62</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="4321">4321</th><td>    }</td></tr>
<tr><th id="4322">4322</th><td><u>#<span data-ppcond="4322">if</span> APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="4323">4323</th><td>    {</td></tr>
<tr><th id="4324">4324</th><td>        DNSQuestion *v4q, *v6q;</td></tr>
<tr><th id="4325">4325</th><td>        v4q = v6q = mDNSNULL;</td></tr>
<tr><th id="4326">4326</th><td>        <b>if</b> (request-&gt;u.addrinfo.protocol &amp; kDNSServiceProtocol_IPv4)</td></tr>
<tr><th id="4327">4327</th><td>        {</td></tr>
<tr><th id="4328">4328</th><td>            <i>// If we are not delivering answers, we may be timing out prematurely.</i></td></tr>
<tr><th id="4329">4329</th><td><i>            // Note down the current state so that we know to retry when we see a</i></td></tr>
<tr><th id="4330">4330</th><td><i>            // valid response again.</i></td></tr>
<tr><th id="4331">4331</th><td>            <b>if</b> (request-&gt;u.addrinfo.q4.TimeoutQuestion &amp;&amp; !request-&gt;u.addrinfo.v4ans)</td></tr>
<tr><th id="4332">4332</th><td>            {</td></tr>
<tr><th id="4333">4333</th><td>                mDNSPlatformUpdateDNSStatus(&amp;request-&gt;u.addrinfo.q4);</td></tr>
<tr><th id="4334">4334</th><td>            }</td></tr>
<tr><th id="4335">4335</th><td>            <i>// If we have a v4 answer and if we timed out prematurely before, provide</i></td></tr>
<tr><th id="4336">4336</th><td><i>            // a trigger to the upper layer so that it can retry questions if needed.</i></td></tr>
<tr><th id="4337">4337</th><td>            <b>if</b> (request-&gt;u.addrinfo.v4ans)</td></tr>
<tr><th id="4338">4338</th><td>                v4q = &amp;request-&gt;u.addrinfo.q4;</td></tr>
<tr><th id="4339">4339</th><td>        }</td></tr>
<tr><th id="4340">4340</th><td>        <b>if</b> (request-&gt;u.addrinfo.protocol &amp; kDNSServiceProtocol_IPv6)</td></tr>
<tr><th id="4341">4341</th><td>        {</td></tr>
<tr><th id="4342">4342</th><td>            <b>if</b> (request-&gt;u.addrinfo.q6.TimeoutQuestion &amp;&amp; !request-&gt;u.addrinfo.v6ans)</td></tr>
<tr><th id="4343">4343</th><td>            {</td></tr>
<tr><th id="4344">4344</th><td>                mDNSPlatformUpdateDNSStatus(&amp;request-&gt;u.addrinfo.q6);</td></tr>
<tr><th id="4345">4345</th><td>            }</td></tr>
<tr><th id="4346">4346</th><td>            <b>if</b> (request-&gt;u.addrinfo.v6ans)</td></tr>
<tr><th id="4347">4347</th><td>                v6q = &amp;request-&gt;u.addrinfo.q6;</td></tr>
<tr><th id="4348">4348</th><td>        }</td></tr>
<tr><th id="4349">4349</th><td>        mDNSPlatformTriggerDNSRetry(v4q, v6q);</td></tr>
<tr><th id="4350">4350</th><td>    }</td></tr>
<tr><th id="4351">4351</th><td><u>#<span data-ppcond="4322">endif</span> // APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="4352">4352</th><td>}</td></tr>
<tr><th id="4353">4353</th><td></td></tr>
<tr><th id="4354">4354</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="decl def fn" id="handle_addrinfo_request" title='handle_addrinfo_request' data-ref="handle_addrinfo_request" data-ref-filename="handle_addrinfo_request">handle_addrinfo_request</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col2 decl" id="482request" title='request' data-type='request_state *' data-ref="482request" data-ref-filename="482request">request</dfn>)</td></tr>
<tr><th id="4355">4355</th><td>{</td></tr>
<tr><th id="4356">4356</th><td>    <em>char</em> <dfn class="local col3 decl" id="483hostname" title='hostname' data-type='char [256]' data-ref="483hostname" data-ref-filename="483hostname">hostname</dfn>[<var>256</var>];</td></tr>
<tr><th id="4357">4357</th><td>    <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#size_t" title='size_t' data-type='unsigned long' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col4 decl" id="484hostnameLen" title='hostnameLen' data-type='size_t' data-ref="484hostnameLen" data-ref-filename="484hostnameLen">hostnameLen</dfn>;</td></tr>
<tr><th id="4358">4358</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#domainname" title='domainname' data-type='struct domainname' data-ref="domainname" data-ref-filename="domainname">domainname</a> <dfn class="local col5 decl" id="485d" title='d' data-type='domainname' data-ref="485d" data-ref-filename="485d">d</dfn>;</td></tr>
<tr><th id="4359">4359</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="local col6 decl" id="486err" title='err' data-type='mStatus' data-ref="486err" data-ref-filename="486err">err</dfn> = <var>0</var>;</td></tr>
<tr><th id="4360">4360</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSs32" title='mDNSs32' data-type='int' data-ref="mDNSs32" data-ref-filename="mDNSs32">mDNSs32</a> <dfn class="local col7 decl" id="487serviceIndex" title='serviceIndex' data-type='mDNSs32' data-ref="487serviceIndex" data-ref-filename="487serviceIndex">serviceIndex</dfn>   = -<var>1</var>;  <i>// default unscoped value for ServiceID is -1</i></td></tr>
<tr><th id="4361">4361</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterfaceID" title='mDNSInterfaceID' data-type='struct mDNSInterfaceID_dummystruct *' data-ref="mDNSInterfaceID" data-ref-filename="mDNSInterfaceID">mDNSInterfaceID</a> <dfn class="local col8 decl" id="488InterfaceID" title='InterfaceID' data-type='mDNSInterfaceID' data-ref="488InterfaceID" data-ref-filename="488InterfaceID">InterfaceID</dfn>;</td></tr>
<tr><th id="4362">4362</th><td></td></tr>
<tr><th id="4363">4363</th><td>    <a class="typedef" href="dns_sd.h.html#DNSServiceFlags" title='DNSServiceFlags' data-type='uint32_t' data-ref="DNSServiceFlags" data-ref-filename="DNSServiceFlags">DNSServiceFlags</a> <dfn class="local col9 decl" id="489flags" title='flags' data-type='DNSServiceFlags' data-ref="489flags" data-ref-filename="489flags">flags</dfn>  = <a class="macro" href="dnssd_ipc.h.html#210" title="__dnssd_ipc_get_uint32" data-ref="_M/get_flags">get_flags</a>(&amp;<a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);</td></tr>
<tr><th id="4364">4364</th><td></td></tr>
<tr><th id="4365">4365</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col0 decl" id="490interfaceIndex" title='interfaceIndex' data-type='mDNSu32' data-ref="490interfaceIndex" data-ref-filename="490interfaceIndex">interfaceIndex</dfn> = <a class="macro" href="dnssd_ipc.h.html#194" title="__dnssd_ipc_get_uint32" data-ref="_M/get_uint32">get_uint32</a>(&amp;<a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);</td></tr>
<tr><th id="4366">4366</th><td></td></tr>
<tr><th id="4367">4367</th><td>    <b>if</b> (<a class="local col9 ref" href="#489flags" title='flags' data-ref="489flags" data-ref-filename="489flags">flags</a> &amp; <a class="enum" href="dns_sd_private.h.html#kDNSServiceFlagsServiceIndex" title='kDNSServiceFlagsServiceIndex' data-ref="kDNSServiceFlagsServiceIndex" data-ref-filename="kDNSServiceFlagsServiceIndex">kDNSServiceFlagsServiceIndex</a>)</td></tr>
<tr><th id="4368">4368</th><td>    {</td></tr>
<tr><th id="4369">4369</th><td>        <i>// NOTE: kDNSServiceFlagsServiceIndex flag can only be set for DNSServiceGetAddrInfo()</i></td></tr>
<tr><th id="4370">4370</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;DNSServiceGetAddrInfo: kDNSServiceFlagsServiceIndex is SET by the client&quot;);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"DNSServiceGetAddrInfo: kDNSServiceFlagsServiceIndex is SET by the client"</q>);</td></tr>
<tr><th id="4371">4371</th><td>        <i>// if kDNSServiceFlagsServiceIndex is SET,</i></td></tr>
<tr><th id="4372">4372</th><td><i>        // interpret the interfaceID as the serviceId and set the interfaceID to 0.</i></td></tr>
<tr><th id="4373">4373</th><td>        <a class="local col7 ref" href="#487serviceIndex" title='serviceIndex' data-ref="487serviceIndex" data-ref-filename="487serviceIndex">serviceIndex</a>   = <a class="local col0 ref" href="#490interfaceIndex" title='interfaceIndex' data-ref="490interfaceIndex" data-ref-filename="490interfaceIndex">interfaceIndex</a>;</td></tr>
<tr><th id="4374">4374</th><td>        <a class="local col0 ref" href="#490interfaceIndex" title='interfaceIndex' data-ref="490interfaceIndex" data-ref-filename="490interfaceIndex">interfaceIndex</a> = <var>0</var>;</td></tr>
<tr><th id="4375">4375</th><td>    }</td></tr>
<tr><th id="4376">4376</th><td></td></tr>
<tr><th id="4377">4377</th><td>    <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformMemZero" title='mDNSPlatformMemZero' data-ref="mDNSPlatformMemZero" data-ref-filename="mDNSPlatformMemZero">mDNSPlatformMemZero</a>(&amp;<a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>, <b>sizeof</b>(<a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>));</td></tr>
<tr><th id="4378">4378</th><td></td></tr>
<tr><th id="4379">4379</th><td>    <a class="local col8 ref" href="#488InterfaceID" title='InterfaceID' data-ref="488InterfaceID" data-ref-filename="488InterfaceID">InterfaceID</a> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformInterfaceIDfromInterfaceIndex" title='mDNSPlatformInterfaceIDfromInterfaceIndex' data-ref="mDNSPlatformInterfaceIDfromInterfaceIndex" data-ref-filename="mDNSPlatformInterfaceIDfromInterfaceIndex">mDNSPlatformInterfaceIDfromInterfaceIndex</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col0 ref" href="#490interfaceIndex" title='interfaceIndex' data-ref="490interfaceIndex" data-ref-filename="490interfaceIndex">interfaceIndex</a>);</td></tr>
<tr><th id="4380">4380</th><td></td></tr>
<tr><th id="4381">4381</th><td>    <i>// The request is scoped to a specific interface index, but the </i></td></tr>
<tr><th id="4382">4382</th><td><i>    // interface is not currently in our list.</i></td></tr>
<tr><th id="4383">4383</th><td>    <b>if</b> (<a class="local col0 ref" href="#490interfaceIndex" title='interfaceIndex' data-ref="490interfaceIndex" data-ref-filename="490interfaceIndex">interfaceIndex</a> &amp;&amp; !<a class="local col8 ref" href="#488InterfaceID" title='InterfaceID' data-ref="488InterfaceID" data-ref-filename="488InterfaceID">InterfaceID</a>)</td></tr>
<tr><th id="4384">4384</th><td>    {</td></tr>
<tr><th id="4385">4385</th><td>        <b>if</b> (<a class="local col0 ref" href="#490interfaceIndex" title='interfaceIndex' data-ref="490interfaceIndex" data-ref-filename="490interfaceIndex">interfaceIndex</a> &gt; <var>1</var>)</td></tr>
<tr><th id="4386">4386</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;handle_addrinfo_request: interfaceIndex %d is currently inactive requested by client[%d][%s]&quot;, interfaceIndex, request-&gt;process_id, request-&gt;pid_name)" data-ref="_M/LogMsg">LogMsg</a>(<q>"handle_addrinfo_request: interfaceIndex %d is currently inactive requested by client[%d][%s]"</q>,</td></tr>
<tr><th id="4387">4387</th><td>                    <a class="local col0 ref" href="#490interfaceIndex" title='interfaceIndex' data-ref="490interfaceIndex" data-ref-filename="490interfaceIndex">interfaceIndex</a>, <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="4388">4388</th><td>        <i>// If it's one of the specially defined inteface index values, just return an error.</i></td></tr>
<tr><th id="4389">4389</th><td>        <b>if</b> (<a class="ref fn" href="#PreDefinedInterfaceIndex" title='PreDefinedInterfaceIndex' data-ref="PreDefinedInterfaceIndex" data-ref-filename="PreDefinedInterfaceIndex">PreDefinedInterfaceIndex</a>(<a class="local col0 ref" href="#490interfaceIndex" title='interfaceIndex' data-ref="490interfaceIndex" data-ref-filename="490interfaceIndex">interfaceIndex</a>))</td></tr>
<tr><th id="4390">4390</th><td>        {</td></tr>
<tr><th id="4391">4391</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;handle_addrinfo_request: bad interfaceIndex %d&quot;, interfaceIndex);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"handle_addrinfo_request: bad interfaceIndex %d"</q>, <a class="local col0 ref" href="#490interfaceIndex" title='interfaceIndex' data-ref="490interfaceIndex" data-ref-filename="490interfaceIndex">interfaceIndex</a>);</td></tr>
<tr><th id="4392">4392</th><td>            <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>);</td></tr>
<tr><th id="4393">4393</th><td>        }</td></tr>
<tr><th id="4394">4394</th><td></td></tr>
<tr><th id="4395">4395</th><td>        <i>// Otherwise, use the specified interface index value and the request will</i></td></tr>
<tr><th id="4396">4396</th><td><i>        // be applied to that interface when it comes up.</i></td></tr>
<tr><th id="4397">4397</th><td>        <a class="local col8 ref" href="#488InterfaceID" title='InterfaceID' data-ref="488InterfaceID" data-ref-filename="488InterfaceID">InterfaceID</a> = (<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterfaceID" title='mDNSInterfaceID' data-type='struct mDNSInterfaceID_dummystruct *' data-ref="mDNSInterfaceID" data-ref-filename="mDNSInterfaceID">mDNSInterfaceID</a>)(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/stdint.h.html#uintptr_t" title='uintptr_t' data-type='__uintptr_t' data-ref="uintptr_t" data-ref-filename="uintptr_t">uintptr_t</a>)<a class="local col0 ref" href="#490interfaceIndex" title='interfaceIndex' data-ref="490interfaceIndex" data-ref-filename="490interfaceIndex">interfaceIndex</a>;</td></tr>
<tr><th id="4398">4398</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;handle_addrinfo_request: query pending for interface index %d&quot;, interfaceIndex);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"handle_addrinfo_request: query pending for interface index %d"</q>, <a class="local col0 ref" href="#490interfaceIndex" title='interfaceIndex' data-ref="490interfaceIndex" data-ref-filename="490interfaceIndex">interfaceIndex</a>);</td></tr>
<tr><th id="4399">4399</th><td>    }</td></tr>
<tr><th id="4400">4400</th><td></td></tr>
<tr><th id="4401">4401</th><td>    <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a>                   = <a class="local col9 ref" href="#489flags" title='flags' data-ref="489flags" data-ref-filename="489flags">flags</a>;</td></tr>
<tr><th id="4402">4402</th><td>    <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::interfaceIndex" title='request_state::interfaceIndex' data-ref="request_state::interfaceIndex" data-ref-filename="request_state..interfaceIndex">interfaceIndex</a>          = <a class="local col0 ref" href="#490interfaceIndex" title='interfaceIndex' data-ref="490interfaceIndex" data-ref-filename="490interfaceIndex">interfaceIndex</a>;</td></tr>
<tr><th id="4403">4403</th><td>    <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::interface_id" title='request_state::(anonymous union)::(anonymous struct)::interface_id' data-ref="request_state::(anonymousunion)::(anonymous)::interface_id" data-ref-filename="request_state..(anonymousunion)..(anonymous)..interface_id">interface_id</a> = <a class="local col8 ref" href="#488InterfaceID" title='InterfaceID' data-ref="488InterfaceID" data-ref-filename="488InterfaceID">InterfaceID</a>;</td></tr>
<tr><th id="4404">4404</th><td>    <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::flags" title='request_state::(anonymous union)::(anonymous struct)::flags' data-ref="request_state::(anonymousunion)::(anonymous)::flags" data-ref-filename="request_state..(anonymousunion)..(anonymous)..flags">flags</a>        = <a class="local col9 ref" href="#489flags" title='flags' data-ref="489flags" data-ref-filename="489flags">flags</a>;</td></tr>
<tr><th id="4405">4405</th><td>    <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::protocol" title='request_state::(anonymous union)::(anonymous struct)::protocol' data-ref="request_state::(anonymousunion)::(anonymous)::protocol" data-ref-filename="request_state..(anonymousunion)..(anonymous)..protocol">protocol</a>     = <a class="macro" href="dnssd_ipc.h.html#194" title="__dnssd_ipc_get_uint32" data-ref="_M/get_uint32">get_uint32</a>(&amp;<a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>);</td></tr>
<tr><th id="4406">4406</th><td></td></tr>
<tr><th id="4407">4407</th><td>    <b>if</b> (<a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::protocol" title='request_state::(anonymous union)::(anonymous struct)::protocol' data-ref="request_state::(anonymousunion)::(anonymous)::protocol" data-ref-filename="request_state..(anonymousunion)..(anonymous)..protocol">protocol</a> &gt; (<a class="enum" href="dns_sd.h.html#kDNSServiceProtocol_IPv4" title='kDNSServiceProtocol_IPv4' data-ref="kDNSServiceProtocol_IPv4" data-ref-filename="kDNSServiceProtocol_IPv4">kDNSServiceProtocol_IPv4</a>|<a class="enum" href="dns_sd.h.html#kDNSServiceProtocol_IPv6" title='kDNSServiceProtocol_IPv6' data-ref="kDNSServiceProtocol_IPv6" data-ref-filename="kDNSServiceProtocol_IPv6">kDNSServiceProtocol_IPv6</a>)) <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>);</td></tr>
<tr><th id="4408">4408</th><td></td></tr>
<tr><th id="4409">4409</th><td>    <b>if</b> (<a class="macro" href="dnssd_ipc.h.html#198" title="__dnssd_ipc_get_string" data-ref="_M/get_string">get_string</a>(&amp;<a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>, <a class="local col3 ref" href="#483hostname" title='hostname' data-ref="483hostname" data-ref-filename="483hostname">hostname</a>, <var>256</var>) &lt; <var>0</var>) <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>);</td></tr>
<tr><th id="4410">4410</th><td></td></tr>
<tr><th id="4411">4411</th><td>    <b>if</b> (!<a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>) { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: DNSServiceGetAddrInfo(unreadable parameters)&quot;, request-&gt;sd)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: DNSServiceGetAddrInfo(unreadable parameters)"</q>, <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>); <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>); }</td></tr>
<tr><th id="4412">4412</th><td></td></tr>
<tr><th id="4413">4413</th><td>    <b>if</b> (!<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#MakeDomainNameFromDNSNameString" title='MakeDomainNameFromDNSNameString' data-ref="MakeDomainNameFromDNSNameString" data-ref-filename="MakeDomainNameFromDNSNameString">MakeDomainNameFromDNSNameString</a>(&amp;<a class="local col5 ref" href="#485d" title='d' data-ref="485d" data-ref-filename="485d">d</a>, <a class="local col3 ref" href="#483hostname" title='hostname' data-ref="483hostname" data-ref-filename="483hostname">hostname</a>))</td></tr>
<tr><th id="4414">4414</th><td>    { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;ERROR: handle_addrinfo_request: bad hostname: %s&quot;, hostname)" data-ref="_M/LogMsg">LogMsg</a>(<q>"ERROR: handle_addrinfo_request: bad hostname: %s"</q>, <a class="local col3 ref" href="#483hostname" title='hostname' data-ref="483hostname" data-ref-filename="483hostname">hostname</a>); <b>return</b>(<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>); }</td></tr>
<tr><th id="4415">4415</th><td></td></tr>
<tr><th id="4416">4416</th><td><u>#<span data-ppcond="4416">if</span> 0</u></td></tr>
<tr><th id="4417">4417</th><td>    <b>if</b> (!AuthorizedDomain(request, &amp;d, AutoBrowseDomains)) <b>return</b> (mStatus_NoError);</td></tr>
<tr><th id="4418">4418</th><td><u>#<span data-ppcond="4416">endif</span></u></td></tr>
<tr><th id="4419">4419</th><td></td></tr>
<tr><th id="4420">4420</th><td>    <b>if</b> (!<a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::protocol" title='request_state::(anonymous union)::(anonymous struct)::protocol' data-ref="request_state::(anonymousunion)::(anonymous)::protocol" data-ref-filename="request_state..(anonymousunion)..(anonymous)..protocol">protocol</a>)</td></tr>
<tr><th id="4421">4421</th><td>    {</td></tr>
<tr><th id="4422">4422</th><td>        <a class="local col9 ref" href="#489flags" title='flags' data-ref="489flags" data-ref-filename="489flags">flags</a> |= <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsSuppressUnusable" title='kDNSServiceFlagsSuppressUnusable' data-ref="kDNSServiceFlagsSuppressUnusable" data-ref-filename="kDNSServiceFlagsSuppressUnusable">kDNSServiceFlagsSuppressUnusable</a>;</td></tr>
<tr><th id="4423">4423</th><td>        <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::protocol" title='request_state::(anonymous union)::(anonymous struct)::protocol' data-ref="request_state::(anonymousunion)::(anonymous)::protocol" data-ref-filename="request_state..(anonymousunion)..(anonymous)..protocol">protocol</a> = (<a class="enum" href="dns_sd.h.html#kDNSServiceProtocol_IPv4" title='kDNSServiceProtocol_IPv4' data-ref="kDNSServiceProtocol_IPv4" data-ref-filename="kDNSServiceProtocol_IPv4">kDNSServiceProtocol_IPv4</a> | <a class="enum" href="dns_sd.h.html#kDNSServiceProtocol_IPv6" title='kDNSServiceProtocol_IPv6' data-ref="kDNSServiceProtocol_IPv6" data-ref-filename="kDNSServiceProtocol_IPv6">kDNSServiceProtocol_IPv6</a>);</td></tr>
<tr><th id="4424">4424</th><td>    }</td></tr>
<tr><th id="4425">4425</th><td></td></tr>
<tr><th id="4426">4426</th><td>    <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::InterfaceID" title='DNSQuestion_struct::InterfaceID' data-ref="DNSQuestion_struct::InterfaceID" data-ref-filename="DNSQuestion_struct..InterfaceID">InterfaceID</a>      = <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::InterfaceID" title='DNSQuestion_struct::InterfaceID' data-ref="DNSQuestion_struct::InterfaceID" data-ref-filename="DNSQuestion_struct..InterfaceID">InterfaceID</a>      = <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::interface_id" title='request_state::(anonymous union)::(anonymous struct)::interface_id' data-ref="request_state::(anonymousunion)::(anonymous)::interface_id" data-ref-filename="request_state..(anonymousunion)..(anonymous)..interface_id">interface_id</a>;</td></tr>
<tr><th id="4427">4427</th><td>    <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ServiceID" title='DNSQuestion_struct::ServiceID' data-ref="DNSQuestion_struct::ServiceID" data-ref-filename="DNSQuestion_struct..ServiceID">ServiceID</a>        = <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ServiceID" title='DNSQuestion_struct::ServiceID' data-ref="DNSQuestion_struct::ServiceID" data-ref-filename="DNSQuestion_struct..ServiceID">ServiceID</a>        = <a class="local col7 ref" href="#487serviceIndex" title='serviceIndex' data-ref="487serviceIndex" data-ref-filename="487serviceIndex">serviceIndex</a>;</td></tr>
<tr><th id="4428">4428</th><td>    <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::flags" title='DNSQuestion_struct::flags' data-ref="DNSQuestion_struct::flags" data-ref-filename="DNSQuestion_struct..flags">flags</a>            = <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::flags" title='DNSQuestion_struct::flags' data-ref="DNSQuestion_struct::flags" data-ref-filename="DNSQuestion_struct..flags">flags</a>            = <a class="local col9 ref" href="#489flags" title='flags' data-ref="489flags" data-ref-filename="489flags">flags</a>;</td></tr>
<tr><th id="4429">4429</th><td>    <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::Target" title='DNSQuestion_struct::Target' data-ref="DNSQuestion_struct::Target" data-ref-filename="DNSQuestion_struct..Target">Target</a>           = <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::Target" title='DNSQuestion_struct::Target' data-ref="DNSQuestion_struct::Target" data-ref-filename="DNSQuestion_struct..Target">Target</a>           = <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#zeroAddr" title='zeroAddr' data-ref="zeroAddr" data-ref-filename="zeroAddr">zeroAddr</a>;</td></tr>
<tr><th id="4430">4430</th><td>    <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>            = <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>            = <a class="local col5 ref" href="#485d" title='d' data-ref="485d" data-ref-filename="485d">d</a>;</td></tr>
<tr><th id="4431">4431</th><td>    <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qclass" title='DNSQuestion_struct::qclass' data-ref="DNSQuestion_struct::qclass" data-ref-filename="DNSQuestion_struct..qclass">qclass</a>           = <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qclass" title='DNSQuestion_struct::qclass' data-ref="DNSQuestion_struct::qclass" data-ref-filename="DNSQuestion_struct..qclass">qclass</a>           = <a class="enum" href="dns_sd.h.html#kDNSServiceClass_IN" title='kDNSServiceClass_IN' data-ref="kDNSServiceClass_IN" data-ref-filename="kDNSServiceClass_IN">kDNSServiceClass_IN</a>;</td></tr>
<tr><th id="4432">4432</th><td>    <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::LongLived" title='DNSQuestion_struct::LongLived' data-ref="DNSQuestion_struct::LongLived" data-ref-filename="DNSQuestion_struct..LongLived">LongLived</a>        = <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::LongLived" title='DNSQuestion_struct::LongLived' data-ref="DNSQuestion_struct::LongLived" data-ref-filename="DNSQuestion_struct..LongLived">LongLived</a>        = (<a class="local col9 ref" href="#489flags" title='flags' data-ref="489flags" data-ref-filename="489flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsLongLivedQuery" title='kDNSServiceFlagsLongLivedQuery' data-ref="kDNSServiceFlagsLongLivedQuery" data-ref-filename="kDNSServiceFlagsLongLivedQuery">kDNSServiceFlagsLongLivedQuery</a>     ) != <var>0</var>;</td></tr>
<tr><th id="4433">4433</th><td>    <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ExpectUnique" title='DNSQuestion_struct::ExpectUnique' data-ref="DNSQuestion_struct::ExpectUnique" data-ref-filename="DNSQuestion_struct..ExpectUnique">ExpectUnique</a>     = <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ExpectUnique" title='DNSQuestion_struct::ExpectUnique' data-ref="DNSQuestion_struct::ExpectUnique" data-ref-filename="DNSQuestion_struct..ExpectUnique">ExpectUnique</a>     = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>;</td></tr>
<tr><th id="4434">4434</th><td>    <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ForceMCast" title='DNSQuestion_struct::ForceMCast' data-ref="DNSQuestion_struct::ForceMCast" data-ref-filename="DNSQuestion_struct..ForceMCast">ForceMCast</a>       = <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ForceMCast" title='DNSQuestion_struct::ForceMCast' data-ref="DNSQuestion_struct::ForceMCast" data-ref-filename="DNSQuestion_struct..ForceMCast">ForceMCast</a>       = (<a class="local col9 ref" href="#489flags" title='flags' data-ref="489flags" data-ref-filename="489flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsForceMulticast" title='kDNSServiceFlagsForceMulticast' data-ref="kDNSServiceFlagsForceMulticast" data-ref-filename="kDNSServiceFlagsForceMulticast">kDNSServiceFlagsForceMulticast</a>     ) != <var>0</var>;</td></tr>
<tr><th id="4435">4435</th><td>    <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ReturnIntermed" title='DNSQuestion_struct::ReturnIntermed' data-ref="DNSQuestion_struct::ReturnIntermed" data-ref-filename="DNSQuestion_struct..ReturnIntermed">ReturnIntermed</a>   = <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ReturnIntermed" title='DNSQuestion_struct::ReturnIntermed' data-ref="DNSQuestion_struct::ReturnIntermed" data-ref-filename="DNSQuestion_struct..ReturnIntermed">ReturnIntermed</a>   = (<a class="local col9 ref" href="#489flags" title='flags' data-ref="489flags" data-ref-filename="489flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsReturnIntermediates" title='kDNSServiceFlagsReturnIntermediates' data-ref="kDNSServiceFlagsReturnIntermediates" data-ref-filename="kDNSServiceFlagsReturnIntermediates">kDNSServiceFlagsReturnIntermediates</a>) != <var>0</var>;</td></tr>
<tr><th id="4436">4436</th><td>    <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::SuppressUnusable" title='DNSQuestion_struct::SuppressUnusable' data-ref="DNSQuestion_struct::SuppressUnusable" data-ref-filename="DNSQuestion_struct..SuppressUnusable">SuppressUnusable</a> = <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::SuppressUnusable" title='DNSQuestion_struct::SuppressUnusable' data-ref="DNSQuestion_struct::SuppressUnusable" data-ref-filename="DNSQuestion_struct..SuppressUnusable">SuppressUnusable</a> = (<a class="local col9 ref" href="#489flags" title='flags' data-ref="489flags" data-ref-filename="489flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsSuppressUnusable" title='kDNSServiceFlagsSuppressUnusable' data-ref="kDNSServiceFlagsSuppressUnusable" data-ref-filename="kDNSServiceFlagsSuppressUnusable">kDNSServiceFlagsSuppressUnusable</a>   ) != <var>0</var>;</td></tr>
<tr><th id="4437">4437</th><td>    <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::TimeoutQuestion" title='DNSQuestion_struct::TimeoutQuestion' data-ref="DNSQuestion_struct::TimeoutQuestion" data-ref-filename="DNSQuestion_struct..TimeoutQuestion">TimeoutQuestion</a>  = <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::TimeoutQuestion" title='DNSQuestion_struct::TimeoutQuestion' data-ref="DNSQuestion_struct::TimeoutQuestion" data-ref-filename="DNSQuestion_struct..TimeoutQuestion">TimeoutQuestion</a>  = (<a class="local col9 ref" href="#489flags" title='flags' data-ref="489flags" data-ref-filename="489flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsTimeout" title='kDNSServiceFlagsTimeout' data-ref="kDNSServiceFlagsTimeout" data-ref-filename="kDNSServiceFlagsTimeout">kDNSServiceFlagsTimeout</a>            ) != <var>0</var>;</td></tr>
<tr><th id="4438">4438</th><td>    <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::WakeOnResolve" title='DNSQuestion_struct::WakeOnResolve' data-ref="DNSQuestion_struct::WakeOnResolve" data-ref-filename="DNSQuestion_struct..WakeOnResolve">WakeOnResolve</a>    = <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::WakeOnResolve" title='DNSQuestion_struct::WakeOnResolve' data-ref="DNSQuestion_struct::WakeOnResolve" data-ref-filename="DNSQuestion_struct..WakeOnResolve">WakeOnResolve</a>    = <var>0</var>;</td></tr>
<tr><th id="4439">4439</th><td>    <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::UseBackgroundTrafficClass" title='DNSQuestion_struct::UseBackgroundTrafficClass' data-ref="DNSQuestion_struct::UseBackgroundTrafficClass" data-ref-filename="DNSQuestion_struct..UseBackgroundTrafficClass">UseBackgroundTrafficClass</a> = <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::UseBackgroundTrafficClass" title='DNSQuestion_struct::UseBackgroundTrafficClass' data-ref="DNSQuestion_struct::UseBackgroundTrafficClass" data-ref-filename="DNSQuestion_struct..UseBackgroundTrafficClass">UseBackgroundTrafficClass</a>  = (<a class="local col9 ref" href="#489flags" title='flags' data-ref="489flags" data-ref-filename="489flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsBackgroundTrafficClass" title='kDNSServiceFlagsBackgroundTrafficClass' data-ref="kDNSServiceFlagsBackgroundTrafficClass" data-ref-filename="kDNSServiceFlagsBackgroundTrafficClass">kDNSServiceFlagsBackgroundTrafficClass</a>) != <var>0</var>;</td></tr>
<tr><th id="4440">4440</th><td>    <b>if</b> ((<a class="local col9 ref" href="#489flags" title='flags' data-ref="489flags" data-ref-filename="489flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsValidate" title='kDNSServiceFlagsValidate' data-ref="kDNSServiceFlagsValidate" data-ref-filename="kDNSServiceFlagsValidate">kDNSServiceFlagsValidate</a>) != <var>0</var>)</td></tr>
<tr><th id="4441">4441</th><td>        <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ValidationRequired" title='DNSQuestion_struct::ValidationRequired' data-ref="DNSQuestion_struct::ValidationRequired" data-ref-filename="DNSQuestion_struct..ValidationRequired">ValidationRequired</a> = <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ValidationRequired" title='DNSQuestion_struct::ValidationRequired' data-ref="DNSQuestion_struct::ValidationRequired" data-ref-filename="DNSQuestion_struct..ValidationRequired">ValidationRequired</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#1877" title="0x01" data-ref="_M/DNSSEC_VALIDATION_SECURE">DNSSEC_VALIDATION_SECURE</a>;</td></tr>
<tr><th id="4442">4442</th><td>    <b>else</b> <b>if</b> ((<a class="local col9 ref" href="#489flags" title='flags' data-ref="489flags" data-ref-filename="489flags">flags</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceFlagsValidateOptional" title='kDNSServiceFlagsValidateOptional' data-ref="kDNSServiceFlagsValidateOptional" data-ref-filename="kDNSServiceFlagsValidateOptional">kDNSServiceFlagsValidateOptional</a>) != <var>0</var>)</td></tr>
<tr><th id="4443">4443</th><td>        <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ValidationRequired" title='DNSQuestion_struct::ValidationRequired' data-ref="DNSQuestion_struct::ValidationRequired" data-ref-filename="DNSQuestion_struct..ValidationRequired">ValidationRequired</a> = <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ValidationRequired" title='DNSQuestion_struct::ValidationRequired' data-ref="DNSQuestion_struct::ValidationRequired" data-ref-filename="DNSQuestion_struct..ValidationRequired">ValidationRequired</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#1878" title="0x02" data-ref="_M/DNSSEC_VALIDATION_SECURE_OPTIONAL">DNSSEC_VALIDATION_SECURE_OPTIONAL</a>;</td></tr>
<tr><th id="4444">4444</th><td>    <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ValidatingResponse" title='DNSQuestion_struct::ValidatingResponse' data-ref="DNSQuestion_struct::ValidatingResponse" data-ref-filename="DNSQuestion_struct..ValidatingResponse">ValidatingResponse</a> = <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ValidatingResponse" title='DNSQuestion_struct::ValidatingResponse' data-ref="DNSQuestion_struct::ValidatingResponse" data-ref-filename="DNSQuestion_struct..ValidatingResponse">ValidatingResponse</a> = <var>0</var>;</td></tr>
<tr><th id="4445">4445</th><td>    <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ProxyQuestion" title='DNSQuestion_struct::ProxyQuestion' data-ref="DNSQuestion_struct::ProxyQuestion" data-ref-filename="DNSQuestion_struct..ProxyQuestion">ProxyQuestion</a>      = <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ProxyQuestion" title='DNSQuestion_struct::ProxyQuestion' data-ref="DNSQuestion_struct::ProxyQuestion" data-ref-filename="DNSQuestion_struct..ProxyQuestion">ProxyQuestion</a>      = <var>0</var>;</td></tr>
<tr><th id="4446">4446</th><td>    <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a>          = <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qnameOrig" title='DNSQuestion_struct::qnameOrig' data-ref="DNSQuestion_struct::qnameOrig" data-ref-filename="DNSQuestion_struct..qnameOrig">qnameOrig</a>          = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="4447">4447</th><td>    <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::AnonInfo" title='DNSQuestion_struct::AnonInfo' data-ref="DNSQuestion_struct::AnonInfo" data-ref-filename="DNSQuestion_struct..AnonInfo">AnonInfo</a>           = <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::AnonInfo" title='DNSQuestion_struct::AnonInfo' data-ref="DNSQuestion_struct::AnonInfo" data-ref-filename="DNSQuestion_struct..AnonInfo">AnonInfo</a>           = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="4448">4448</th><td></td></tr>
<tr><th id="4449">4449</th><td>    <a class="ref fn" href="#SetQuestionPolicy" title='SetQuestionPolicy' data-ref="SetQuestionPolicy" data-ref-filename="SetQuestionPolicy">SetQuestionPolicy</a>(&amp;<a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>, <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>);</td></tr>
<tr><th id="4450">4450</th><td>    <a class="ref fn" href="#SetQuestionPolicy" title='SetQuestionPolicy' data-ref="SetQuestionPolicy" data-ref-filename="SetQuestionPolicy">SetQuestionPolicy</a>(&amp;<a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>, <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>);</td></tr>
<tr><th id="4451">4451</th><td></td></tr>
<tr><th id="4452">4452</th><td>    <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::StopTime" title='DNSQuestion_struct::StopTime' data-ref="DNSQuestion_struct::StopTime" data-ref-filename="DNSQuestion_struct..StopTime">StopTime</a> = <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::StopTime" title='DNSQuestion_struct::StopTime' data-ref="DNSQuestion_struct::StopTime" data-ref-filename="DNSQuestion_struct..StopTime">StopTime</a>  = <var>0</var>;</td></tr>
<tr><th id="4453">4453</th><td></td></tr>
<tr><th id="4454">4454</th><td>    <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::DNSSECAuthInfo" title='DNSQuestion_struct::DNSSECAuthInfo' data-ref="DNSQuestion_struct::DNSSECAuthInfo" data-ref-filename="DNSQuestion_struct..DNSSECAuthInfo">DNSSECAuthInfo</a> = <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::DNSSECAuthInfo" title='DNSQuestion_struct::DNSSECAuthInfo' data-ref="DNSQuestion_struct::DNSSECAuthInfo" data-ref-filename="DNSQuestion_struct..DNSSECAuthInfo">DNSSECAuthInfo</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="4455">4455</th><td>    <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::DAIFreeCallback" title='DNSQuestion_struct::DAIFreeCallback' data-ref="DNSQuestion_struct::DAIFreeCallback" data-ref-filename="DNSQuestion_struct..DAIFreeCallback">DAIFreeCallback</a> = <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::DAIFreeCallback" title='DNSQuestion_struct::DAIFreeCallback' data-ref="DNSQuestion_struct::DAIFreeCallback" data-ref-filename="DNSQuestion_struct..DAIFreeCallback">DAIFreeCallback</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="4456">4456</th><td></td></tr>
<tr><th id="4457">4457</th><td>    <i>//Turn off dnssec validation for local domains</i></td></tr>
<tr><th id="4458">4458</th><td>    <b>if</b> (<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#IsLocalDomain" title='IsLocalDomain' data-ref="IsLocalDomain" data-ref-filename="IsLocalDomain">IsLocalDomain</a>(&amp;<a class="local col5 ref" href="#485d" title='d' data-ref="485d" data-ref-filename="485d">d</a>))</td></tr>
<tr><th id="4459">4459</th><td>        <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ValidationRequired" title='DNSQuestion_struct::ValidationRequired' data-ref="DNSQuestion_struct::ValidationRequired" data-ref-filename="DNSQuestion_struct..ValidationRequired">ValidationRequired</a> = <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ValidationRequired" title='DNSQuestion_struct::ValidationRequired' data-ref="DNSQuestion_struct::ValidationRequired" data-ref-filename="DNSQuestion_struct..ValidationRequired">ValidationRequired</a> = <var>0</var>;</td></tr>
<tr><th id="4460">4460</th><td></td></tr>
<tr><th id="4461">4461</th><td>    <a class="local col4 ref" href="#484hostnameLen" title='hostnameLen' data-ref="484hostnameLen" data-ref-filename="484hostnameLen">hostnameLen</a> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strlen" title='strlen' data-ref="strlen" data-ref-filename="strlen">strlen</a>(<a class="local col3 ref" href="#483hostname" title='hostname' data-ref="483hostname" data-ref-filename="483hostname">hostname</a>);</td></tr>
<tr><th id="4462">4462</th><td></td></tr>
<tr><th id="4463">4463</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: DNSServiceGetAddrInfo(%X, %d, %d, %##s) START PID[%d](%s)&quot;, request-&gt;sd, flags, interfaceIndex, request-&gt;u.addrinfo.protocol, d.c, request-&gt;process_id, request-&gt;pid_name);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: DNSServiceGetAddrInfo(%X, %d, %d, %##s) START PID[%d](%s)"</q>, </td></tr>
<tr><th id="4464">4464</th><td>        <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col9 ref" href="#489flags" title='flags' data-ref="489flags" data-ref-filename="489flags">flags</a>, <a class="local col0 ref" href="#490interfaceIndex" title='interfaceIndex' data-ref="490interfaceIndex" data-ref-filename="490interfaceIndex">interfaceIndex</a>, <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::protocol" title='request_state::(anonymous union)::(anonymous struct)::protocol' data-ref="request_state::(anonymousunion)::(anonymous)::protocol" data-ref-filename="request_state..(anonymousunion)..(anonymous)..protocol">protocol</a>, <a class="local col5 ref" href="#485d" title='d' data-ref="485d" data-ref-filename="485d">d</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="4465">4465</th><td></td></tr>
<tr><th id="4466">4466</th><td>    <b>if</b> (<a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::protocol" title='request_state::(anonymous union)::(anonymous struct)::protocol' data-ref="request_state::(anonymousunion)::(anonymous)::protocol" data-ref-filename="request_state..(anonymousunion)..(anonymous)..protocol">protocol</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceProtocol_IPv6" title='kDNSServiceProtocol_IPv6' data-ref="kDNSServiceProtocol_IPv6" data-ref-filename="kDNSServiceProtocol_IPv6">kDNSServiceProtocol_IPv6</a>)</td></tr>
<tr><th id="4467">4467</th><td>    {</td></tr>
<tr><th id="4468">4468</th><td>        <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a>            = <a class="enum" href="dns_sd.h.html#kDNSServiceType_AAAA" title='kDNSServiceType_AAAA' data-ref="kDNSServiceType_AAAA" data-ref-filename="kDNSServiceType_AAAA">kDNSServiceType_AAAA</a>;</td></tr>
<tr><th id="4469">4469</th><td>        <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::SearchListIndex" title='DNSQuestion_struct::SearchListIndex' data-ref="DNSQuestion_struct::SearchListIndex" data-ref-filename="DNSQuestion_struct..SearchListIndex">SearchListIndex</a>  = <var>0</var>;</td></tr>
<tr><th id="4470">4470</th><td>        <i>// For DNSSEC questions, append search domains only if kDNSServiceFlagsValidateOptional is set</i></td></tr>
<tr><th id="4471">4471</th><td>        <b>if</b> ((!(<a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ValidationRequired" title='DNSQuestion_struct::ValidationRequired' data-ref="DNSQuestion_struct::ValidationRequired" data-ref-filename="DNSQuestion_struct..ValidationRequired">ValidationRequired</a> == <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#1877" title="0x01" data-ref="_M/DNSSEC_VALIDATION_SECURE">DNSSEC_VALIDATION_SECURE</a>)) &amp;&amp; (!(<a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ValidationRequired" title='DNSQuestion_struct::ValidationRequired' data-ref="DNSQuestion_struct::ValidationRequired" data-ref-filename="DNSQuestion_struct..ValidationRequired">ValidationRequired</a> == <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#1879" title="0x03" data-ref="_M/DNSSEC_VALIDATION_INSECURE">DNSSEC_VALIDATION_INSECURE</a>))</td></tr>
<tr><th id="4472">4472</th><td>            &amp;&amp; ((<a class="local col4 ref" href="#484hostnameLen" title='hostnameLen' data-ref="484hostnameLen" data-ref-filename="484hostnameLen">hostnameLen</a> == <var>0</var>) || (<a class="local col3 ref" href="#483hostname" title='hostname' data-ref="483hostname" data-ref-filename="483hostname">hostname</a>[<a class="local col4 ref" href="#484hostnameLen" title='hostnameLen' data-ref="484hostnameLen" data-ref-filename="484hostnameLen">hostnameLen</a> - <var>1</var>] != <kbd>'.'</kbd>)) &amp;&amp; (<a class="ref" href="#AlwaysAppendSearchDomains" title='AlwaysAppendSearchDomains' data-ref="AlwaysAppendSearchDomains" data-ref-filename="AlwaysAppendSearchDomains">AlwaysAppendSearchDomains</a> || <a class="ref fn" href="../mDNSCore/DNSCommon.h.html#CountLabels" title='CountLabels' data-ref="CountLabels" data-ref-filename="CountLabels">CountLabels</a>(&amp;<a class="local col5 ref" href="#485d" title='d' data-ref="485d" data-ref-filename="485d">d</a>) == <var>1</var>))</td></tr>
<tr><th id="4473">4473</th><td>        {</td></tr>
<tr><th id="4474">4474</th><td>            <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::AppendSearchDomains" title='DNSQuestion_struct::AppendSearchDomains' data-ref="DNSQuestion_struct::AppendSearchDomains" data-ref-filename="DNSQuestion_struct..AppendSearchDomains">AppendSearchDomains</a> = <var>1</var>;</td></tr>
<tr><th id="4475">4475</th><td>            <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::AppendLocalSearchDomains" title='DNSQuestion_struct::AppendLocalSearchDomains' data-ref="DNSQuestion_struct::AppendLocalSearchDomains" data-ref-filename="DNSQuestion_struct..AppendLocalSearchDomains">AppendLocalSearchDomains</a> = <var>1</var>;</td></tr>
<tr><th id="4476">4476</th><td>        }</td></tr>
<tr><th id="4477">4477</th><td>        <b>else</b></td></tr>
<tr><th id="4478">4478</th><td>        {</td></tr>
<tr><th id="4479">4479</th><td>            <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::AppendSearchDomains" title='DNSQuestion_struct::AppendSearchDomains' data-ref="DNSQuestion_struct::AppendSearchDomains" data-ref-filename="DNSQuestion_struct..AppendSearchDomains">AppendSearchDomains</a> = <var>0</var>;</td></tr>
<tr><th id="4480">4480</th><td>            <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::AppendLocalSearchDomains" title='DNSQuestion_struct::AppendLocalSearchDomains' data-ref="DNSQuestion_struct::AppendLocalSearchDomains" data-ref-filename="DNSQuestion_struct..AppendLocalSearchDomains">AppendLocalSearchDomains</a> = <var>0</var>;</td></tr>
<tr><th id="4481">4481</th><td>        }</td></tr>
<tr><th id="4482">4482</th><td>        <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::RetryWithSearchDomains" title='DNSQuestion_struct::RetryWithSearchDomains' data-ref="DNSQuestion_struct::RetryWithSearchDomains" data-ref-filename="DNSQuestion_struct..RetryWithSearchDomains">RetryWithSearchDomains</a> = (<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#1622" title="((&amp;request-&gt;u.addrinfo.q6)-&gt;AppendSearchDomains &amp;&amp; (CountLabels(&amp;((&amp;request-&gt;u.addrinfo.q6)-&gt;qname))) == 1)" data-ref="_M/ApplySearchDomainsFirst">ApplySearchDomainsFirst</a>(&amp;<a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>) ? <var>1</var> : <var>0</var>);</td></tr>
<tr><th id="4483">4483</th><td>        <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::QuestionCallback" title='DNSQuestion_struct::QuestionCallback' data-ref="DNSQuestion_struct::QuestionCallback" data-ref-filename="DNSQuestion_struct..QuestionCallback">QuestionCallback</a> = <a class="ref fn" href="#queryrecord_result_callback" title='queryrecord_result_callback' data-ref="queryrecord_result_callback" data-ref-filename="queryrecord_result_callback">queryrecord_result_callback</a>;</td></tr>
<tr><th id="4484">4484</th><td>        <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::QuestionContext" title='DNSQuestion_struct::QuestionContext' data-ref="DNSQuestion_struct::QuestionContext" data-ref-filename="DNSQuestion_struct..QuestionContext">QuestionContext</a>  = <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>;</td></tr>
<tr><th id="4485">4485</th><td>        <a class="local col6 ref" href="#486err" title='err' data-ref="486err" data-ref-filename="486err">err</a> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_StartQuery" title='mDNS_StartQuery' data-ref="mDNS_StartQuery" data-ref-filename="mDNS_StartQuery">mDNS_StartQuery</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>);</td></tr>
<tr><th id="4486">4486</th><td>        <b>if</b> (<a class="local col6 ref" href="#486err" title='err' data-ref="486err" data-ref-filename="486err">err</a> != <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_NoError" title='mStatus_NoError' data-ref="mStatus_NoError" data-ref-filename="mStatus_NoError">mStatus_NoError</a>)</td></tr>
<tr><th id="4487">4487</th><td>        {</td></tr>
<tr><th id="4488">4488</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;ERROR: mDNS_StartQuery: %d&quot;, (int)err)" data-ref="_M/LogMsg">LogMsg</a>(<q>"ERROR: mDNS_StartQuery: %d"</q>, (<em>int</em>)<a class="local col6 ref" href="#486err" title='err' data-ref="486err" data-ref-filename="486err">err</a>);</td></tr>
<tr><th id="4489">4489</th><td>            <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::QuestionContext" title='DNSQuestion_struct::QuestionContext' data-ref="DNSQuestion_struct::QuestionContext" data-ref-filename="DNSQuestion_struct..QuestionContext">QuestionContext</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="4490">4490</th><td>        }</td></tr>
<tr><th id="4491">4491</th><td>        <u>#<span data-ppcond="4491">if</span> APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="4492">4492</th><td>        err = SendAdditionalQuery(&amp;request-&gt;u.addrinfo.q6, request, err);</td></tr>
<tr><th id="4493">4493</th><td>        <u>#<span data-ppcond="4491">endif</span> // APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="4494">4494</th><td>        <b>if</b> (!<a class="local col6 ref" href="#486err" title='err' data-ref="486err" data-ref-filename="486err">err</a>)</td></tr>
<tr><th id="4495">4495</th><td>        {</td></tr>
<tr><th id="4496">4496</th><td>            <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> = <a class="ref fn" href="#addrinfo_termination_callback" title='addrinfo_termination_callback' data-ref="addrinfo_termination_callback" data-ref-filename="addrinfo_termination_callback">addrinfo_termination_callback</a>;</td></tr>
<tr><th id="4497">4497</th><td>            <a class="macro" href="uds_daemon.h.html#224" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMcastQuestion" data-ref="_M/LogMcastQ">LogMcastQ</a>(&amp;<a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>, <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#q_start" title='q_start' data-ref="q_start" data-ref-filename="q_start">q_start</a>);</td></tr>
<tr><th id="4498">4498</th><td>            <b>if</b> (<a class="ref fn" href="#callExternalHelpers" title='callExternalHelpers' data-ref="callExternalHelpers" data-ref-filename="callExternalHelpers">callExternalHelpers</a>(<a class="local col8 ref" href="#488InterfaceID" title='InterfaceID' data-ref="488InterfaceID" data-ref-filename="488InterfaceID">InterfaceID</a>, &amp;<a class="local col5 ref" href="#485d" title='d' data-ref="485d" data-ref-filename="485d">d</a>, <a class="local col9 ref" href="#489flags" title='flags' data-ref="489flags" data-ref-filename="489flags">flags</a>))</td></tr>
<tr><th id="4499">4499</th><td>            {</td></tr>
<tr><th id="4500">4500</th><td>                <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;handle_addrinfo_request: calling external_start_browsing_for_service() for kDNSServiceType_AAAA record&quot;);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"handle_addrinfo_request: calling external_start_browsing_for_service() for kDNSServiceType_AAAA record"</q>);</td></tr>
<tr><th id="4501">4501</th><td>                <a class="macro" href="uds_daemon.h.html#264" title="(void)(InterfaceID)" data-ref="_M/external_start_browsing_for_service">external_start_browsing_for_service</a>(<a class="local col8 ref" href="#488InterfaceID" title='InterfaceID' data-ref="488InterfaceID" data-ref-filename="488InterfaceID">InterfaceID</a>, &amp;d, kDNSServiceType_AAAA, flags);</td></tr>
<tr><th id="4502">4502</th><td>            }</td></tr>
<tr><th id="4503">4503</th><td>        }</td></tr>
<tr><th id="4504">4504</th><td>    }</td></tr>
<tr><th id="4505">4505</th><td></td></tr>
<tr><th id="4506">4506</th><td>    <b>if</b> (!<a class="local col6 ref" href="#486err" title='err' data-ref="486err" data-ref-filename="486err">err</a> &amp;&amp; (<a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::protocol" title='request_state::(anonymous union)::(anonymous struct)::protocol' data-ref="request_state::(anonymousunion)::(anonymous)::protocol" data-ref-filename="request_state..(anonymousunion)..(anonymous)..protocol">protocol</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceProtocol_IPv4" title='kDNSServiceProtocol_IPv4' data-ref="kDNSServiceProtocol_IPv4" data-ref-filename="kDNSServiceProtocol_IPv4">kDNSServiceProtocol_IPv4</a>))</td></tr>
<tr><th id="4507">4507</th><td>    {</td></tr>
<tr><th id="4508">4508</th><td>        <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a>            = <a class="enum" href="dns_sd.h.html#kDNSServiceType_A" title='kDNSServiceType_A' data-ref="kDNSServiceType_A" data-ref-filename="kDNSServiceType_A">kDNSServiceType_A</a>;</td></tr>
<tr><th id="4509">4509</th><td>        <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::SearchListIndex" title='DNSQuestion_struct::SearchListIndex' data-ref="DNSQuestion_struct::SearchListIndex" data-ref-filename="DNSQuestion_struct..SearchListIndex">SearchListIndex</a>  = <var>0</var>;</td></tr>
<tr><th id="4510">4510</th><td></td></tr>
<tr><th id="4511">4511</th><td>        <i>// We append search domains only for queries that are a single label. If overriden using cmd line arg</i></td></tr>
<tr><th id="4512">4512</th><td><i>        // "AlwaysAppendSearchDomains", then we do it for any query which is not fully qualified.</i></td></tr>
<tr><th id="4513">4513</th><td><i>        // For DNSSEC questions, append search domains only if kDNSServiceFlagsValidateOptional is set.</i></td></tr>
<tr><th id="4514">4514</th><td></td></tr>
<tr><th id="4515">4515</th><td>        <b>if</b> ((!(<a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ValidationRequired" title='DNSQuestion_struct::ValidationRequired' data-ref="DNSQuestion_struct::ValidationRequired" data-ref-filename="DNSQuestion_struct..ValidationRequired">ValidationRequired</a> == <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#1877" title="0x01" data-ref="_M/DNSSEC_VALIDATION_SECURE">DNSSEC_VALIDATION_SECURE</a>)) &amp;&amp; (!(<a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ValidationRequired" title='DNSQuestion_struct::ValidationRequired' data-ref="DNSQuestion_struct::ValidationRequired" data-ref-filename="DNSQuestion_struct..ValidationRequired">ValidationRequired</a> == <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#1879" title="0x03" data-ref="_M/DNSSEC_VALIDATION_INSECURE">DNSSEC_VALIDATION_INSECURE</a>))</td></tr>
<tr><th id="4516">4516</th><td>            &amp;&amp; ((<a class="local col4 ref" href="#484hostnameLen" title='hostnameLen' data-ref="484hostnameLen" data-ref-filename="484hostnameLen">hostnameLen</a> == <var>0</var>) || (<a class="local col3 ref" href="#483hostname" title='hostname' data-ref="483hostname" data-ref-filename="483hostname">hostname</a>[<a class="local col4 ref" href="#484hostnameLen" title='hostnameLen' data-ref="484hostnameLen" data-ref-filename="484hostnameLen">hostnameLen</a> - <var>1</var>] != <kbd>'.'</kbd>)) &amp;&amp; (<a class="ref" href="#AlwaysAppendSearchDomains" title='AlwaysAppendSearchDomains' data-ref="AlwaysAppendSearchDomains" data-ref-filename="AlwaysAppendSearchDomains">AlwaysAppendSearchDomains</a> || <a class="ref fn" href="../mDNSCore/DNSCommon.h.html#CountLabels" title='CountLabels' data-ref="CountLabels" data-ref-filename="CountLabels">CountLabels</a>(&amp;<a class="local col5 ref" href="#485d" title='d' data-ref="485d" data-ref-filename="485d">d</a>) == <var>1</var>))</td></tr>
<tr><th id="4517">4517</th><td>        {</td></tr>
<tr><th id="4518">4518</th><td>            <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::AppendSearchDomains" title='DNSQuestion_struct::AppendSearchDomains' data-ref="DNSQuestion_struct::AppendSearchDomains" data-ref-filename="DNSQuestion_struct..AppendSearchDomains">AppendSearchDomains</a> = <var>1</var>;</td></tr>
<tr><th id="4519">4519</th><td>            <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::AppendLocalSearchDomains" title='DNSQuestion_struct::AppendLocalSearchDomains' data-ref="DNSQuestion_struct::AppendLocalSearchDomains" data-ref-filename="DNSQuestion_struct..AppendLocalSearchDomains">AppendLocalSearchDomains</a> = <var>1</var>;</td></tr>
<tr><th id="4520">4520</th><td>        }</td></tr>
<tr><th id="4521">4521</th><td>        <b>else</b></td></tr>
<tr><th id="4522">4522</th><td>        {</td></tr>
<tr><th id="4523">4523</th><td>            <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::AppendSearchDomains" title='DNSQuestion_struct::AppendSearchDomains' data-ref="DNSQuestion_struct::AppendSearchDomains" data-ref-filename="DNSQuestion_struct..AppendSearchDomains">AppendSearchDomains</a> = <var>0</var>;</td></tr>
<tr><th id="4524">4524</th><td>            <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::AppendLocalSearchDomains" title='DNSQuestion_struct::AppendLocalSearchDomains' data-ref="DNSQuestion_struct::AppendLocalSearchDomains" data-ref-filename="DNSQuestion_struct..AppendLocalSearchDomains">AppendLocalSearchDomains</a> = <var>0</var>;</td></tr>
<tr><th id="4525">4525</th><td>        }</td></tr>
<tr><th id="4526">4526</th><td>        <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::RetryWithSearchDomains" title='DNSQuestion_struct::RetryWithSearchDomains' data-ref="DNSQuestion_struct::RetryWithSearchDomains" data-ref-filename="DNSQuestion_struct..RetryWithSearchDomains">RetryWithSearchDomains</a> = (<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#1622" title="((&amp;request-&gt;u.addrinfo.q4)-&gt;AppendSearchDomains &amp;&amp; (CountLabels(&amp;((&amp;request-&gt;u.addrinfo.q4)-&gt;qname))) == 1)" data-ref="_M/ApplySearchDomainsFirst">ApplySearchDomainsFirst</a>(&amp;<a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>) ? <var>1</var> : <var>0</var>);</td></tr>
<tr><th id="4527">4527</th><td>        <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::QuestionCallback" title='DNSQuestion_struct::QuestionCallback' data-ref="DNSQuestion_struct::QuestionCallback" data-ref-filename="DNSQuestion_struct..QuestionCallback">QuestionCallback</a> = <a class="ref fn" href="#queryrecord_result_callback" title='queryrecord_result_callback' data-ref="queryrecord_result_callback" data-ref-filename="queryrecord_result_callback">queryrecord_result_callback</a>;</td></tr>
<tr><th id="4528">4528</th><td>        <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::QuestionContext" title='DNSQuestion_struct::QuestionContext' data-ref="DNSQuestion_struct::QuestionContext" data-ref-filename="DNSQuestion_struct..QuestionContext">QuestionContext</a>  = <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>;</td></tr>
<tr><th id="4529">4529</th><td>        <a class="local col6 ref" href="#486err" title='err' data-ref="486err" data-ref-filename="486err">err</a> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_StartQuery" title='mDNS_StartQuery' data-ref="mDNS_StartQuery" data-ref-filename="mDNS_StartQuery">mDNS_StartQuery</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>);</td></tr>
<tr><th id="4530">4530</th><td>        <b>if</b> (<a class="local col6 ref" href="#486err" title='err' data-ref="486err" data-ref-filename="486err">err</a> != <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_NoError" title='mStatus_NoError' data-ref="mStatus_NoError" data-ref-filename="mStatus_NoError">mStatus_NoError</a>)</td></tr>
<tr><th id="4531">4531</th><td>        {</td></tr>
<tr><th id="4532">4532</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;ERROR: mDNS_StartQuery: %d&quot;, (int)err)" data-ref="_M/LogMsg">LogMsg</a>(<q>"ERROR: mDNS_StartQuery: %d"</q>, (<em>int</em>)<a class="local col6 ref" href="#486err" title='err' data-ref="486err" data-ref-filename="486err">err</a>);</td></tr>
<tr><th id="4533">4533</th><td>            <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::QuestionContext" title='DNSQuestion_struct::QuestionContext' data-ref="DNSQuestion_struct::QuestionContext" data-ref-filename="DNSQuestion_struct..QuestionContext">QuestionContext</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="4534">4534</th><td>            <b>if</b> (<a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::protocol" title='request_state::(anonymous union)::(anonymous struct)::protocol' data-ref="request_state::(anonymousunion)::(anonymous)::protocol" data-ref-filename="request_state..(anonymousunion)..(anonymous)..protocol">protocol</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceProtocol_IPv6" title='kDNSServiceProtocol_IPv6' data-ref="kDNSServiceProtocol_IPv6" data-ref-filename="kDNSServiceProtocol_IPv6">kDNSServiceProtocol_IPv6</a>)</td></tr>
<tr><th id="4535">4535</th><td>            {</td></tr>
<tr><th id="4536">4536</th><td>                <i>// If we started a query for IPv6, we need to cancel it</i></td></tr>
<tr><th id="4537">4537</th><td>                <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_StopQuery" title='mDNS_StopQuery' data-ref="mDNS_StopQuery" data-ref-filename="mDNS_StopQuery">mDNS_StopQuery</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>);</td></tr>
<tr><th id="4538">4538</th><td>                <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q6" title='request_state::(anonymous union)::(anonymous struct)::q6' data-ref="request_state::(anonymousunion)::(anonymous)::q6" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q6">q6</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::QuestionContext" title='DNSQuestion_struct::QuestionContext' data-ref="DNSQuestion_struct::QuestionContext" data-ref-filename="DNSQuestion_struct..QuestionContext">QuestionContext</a> = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="4539">4539</th><td></td></tr>
<tr><th id="4540">4540</th><td>                <b>if</b> (<a class="ref fn" href="#callExternalHelpers" title='callExternalHelpers' data-ref="callExternalHelpers" data-ref-filename="callExternalHelpers">callExternalHelpers</a>(<a class="local col8 ref" href="#488InterfaceID" title='InterfaceID' data-ref="488InterfaceID" data-ref-filename="488InterfaceID">InterfaceID</a>, &amp;<a class="local col5 ref" href="#485d" title='d' data-ref="485d" data-ref-filename="485d">d</a>, <a class="local col9 ref" href="#489flags" title='flags' data-ref="489flags" data-ref-filename="489flags">flags</a>))</td></tr>
<tr><th id="4541">4541</th><td>                {</td></tr>
<tr><th id="4542">4542</th><td>                    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;addrinfo_termination_callback: calling external_stop_browsing_for_service() for kDNSServiceType_AAAA record&quot;);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"addrinfo_termination_callback: calling external_stop_browsing_for_service() for kDNSServiceType_AAAA record"</q>);</td></tr>
<tr><th id="4543">4543</th><td>                    <a class="macro" href="uds_daemon.h.html#265" title="(void)(InterfaceID)" data-ref="_M/external_stop_browsing_for_service">external_stop_browsing_for_service</a>(<a class="local col8 ref" href="#488InterfaceID" title='InterfaceID' data-ref="488InterfaceID" data-ref-filename="488InterfaceID">InterfaceID</a>, &amp;d, kDNSServiceType_AAAA, flags);</td></tr>
<tr><th id="4544">4544</th><td>                }</td></tr>
<tr><th id="4545">4545</th><td>            }</td></tr>
<tr><th id="4546">4546</th><td>        }</td></tr>
<tr><th id="4547">4547</th><td>        <u>#<span data-ppcond="4547">if</span> APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="4548">4548</th><td>        err = SendAdditionalQuery(&amp;request-&gt;u.addrinfo.q4, request, err);</td></tr>
<tr><th id="4549">4549</th><td>        <u>#<span data-ppcond="4547">endif</span> // APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="4550">4550</th><td>        <b>if</b> (!<a class="local col6 ref" href="#486err" title='err' data-ref="486err" data-ref-filename="486err">err</a>)</td></tr>
<tr><th id="4551">4551</th><td>        {</td></tr>
<tr><th id="4552">4552</th><td>            <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> = <a class="ref fn" href="#addrinfo_termination_callback" title='addrinfo_termination_callback' data-ref="addrinfo_termination_callback" data-ref-filename="addrinfo_termination_callback">addrinfo_termination_callback</a>;</td></tr>
<tr><th id="4553">4553</th><td>            <a class="macro" href="uds_daemon.h.html#224" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMcastQuestion" data-ref="_M/LogMcastQ">LogMcastQ</a>(&amp;<a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>, <a class="local col2 ref" href="#482request" title='request' data-ref="482request" data-ref-filename="482request">request</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#q_start" title='q_start' data-ref="q_start" data-ref-filename="q_start">q_start</a>);</td></tr>
<tr><th id="4554">4554</th><td>            <b>if</b> (<a class="ref fn" href="#callExternalHelpers" title='callExternalHelpers' data-ref="callExternalHelpers" data-ref-filename="callExternalHelpers">callExternalHelpers</a>(<a class="local col8 ref" href="#488InterfaceID" title='InterfaceID' data-ref="488InterfaceID" data-ref-filename="488InterfaceID">InterfaceID</a>, &amp;<a class="local col5 ref" href="#485d" title='d' data-ref="485d" data-ref-filename="485d">d</a>, <a class="local col9 ref" href="#489flags" title='flags' data-ref="489flags" data-ref-filename="489flags">flags</a>))</td></tr>
<tr><th id="4555">4555</th><td>            {</td></tr>
<tr><th id="4556">4556</th><td>                <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;handle_addrinfo_request: calling external_start_browsing_for_service() for kDNSServiceType_A record&quot;);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"handle_addrinfo_request: calling external_start_browsing_for_service() for kDNSServiceType_A record"</q>);</td></tr>
<tr><th id="4557">4557</th><td>                <a class="macro" href="uds_daemon.h.html#264" title="(void)(InterfaceID)" data-ref="_M/external_start_browsing_for_service">external_start_browsing_for_service</a>(<a class="local col8 ref" href="#488InterfaceID" title='InterfaceID' data-ref="488InterfaceID" data-ref-filename="488InterfaceID">InterfaceID</a>, &amp;d, kDNSServiceType_A, flags);</td></tr>
<tr><th id="4558">4558</th><td>            }</td></tr>
<tr><th id="4559">4559</th><td>        }</td></tr>
<tr><th id="4560">4560</th><td>    }</td></tr>
<tr><th id="4561">4561</th><td></td></tr>
<tr><th id="4562">4562</th><td>    <b>return</b>(<a class="local col6 ref" href="#486err" title='err' data-ref="486err" data-ref-filename="486err">err</a>);</td></tr>
<tr><th id="4563">4563</th><td>}</td></tr>
<tr><th id="4564">4564</th><td></td></tr>
<tr><th id="4565">4565</th><td><i>// ***************************************************************************</i></td></tr>
<tr><th id="4566">4566</th><td><u>#<span data-ppcond="4566">if</span> COMPILER_LIKES_PRAGMA_MARK</u></td></tr>
<tr><th id="4567">4567</th><td><u>#pragma mark -</u></td></tr>
<tr><th id="4568">4568</th><td><u>#pragma mark - Main Request Handler etc.</u></td></tr>
<tr><th id="4569">4569</th><td><u>#<span data-ppcond="4566">endif</span></u></td></tr>
<tr><th id="4570">4570</th><td></td></tr>
<tr><th id="4571">4571</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="decl def fn" id="NewRequest" title='NewRequest' data-ref="NewRequest" data-ref-filename="NewRequest">NewRequest</dfn>(<em>void</em>)</td></tr>
<tr><th id="4572">4572</th><td>{</td></tr>
<tr><th id="4573">4573</th><td>    <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> **<dfn class="local col1 decl" id="491p" title='p' data-type='request_state **' data-ref="491p" data-ref-filename="491p">p</dfn> = &amp;<a class="tu ref" href="#all_requests" title='all_requests' data-use='a' data-ref="all_requests" data-ref-filename="all_requests">all_requests</a>;</td></tr>
<tr><th id="4574">4574</th><td>    <b>while</b> (*<a class="local col1 ref" href="#491p" title='p' data-ref="491p" data-ref-filename="491p">p</a>)</td></tr>
<tr><th id="4575">4575</th><td>        <a class="local col1 ref" href="#491p" title='p' data-ref="491p" data-ref-filename="491p">p</a>=&amp;(*<a class="local col1 ref" href="#491p" title='p' data-ref="491p" data-ref-filename="491p">p</a>)-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::next" title='request_state::next' data-ref="request_state::next" data-ref-filename="request_state..next">next</a>;</td></tr>
<tr><th id="4576">4576</th><td>    *<a class="local col1 ref" href="#491p" title='p' data-ref="491p" data-ref-filename="491p">p</a> = <a class="macro" href="../mDNSCore/mDNSDebug.h.html#166" title="malloc(sizeof(request_state))" data-ref="_M/mallocL">mallocL</a>(<q>"request_state"</q>, <b>sizeof</b>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a>));</td></tr>
<tr><th id="4577">4577</th><td>    <b>if</b> (!*<a class="local col1 ref" href="#491p" title='p' data-ref="491p" data-ref-filename="491p">p</a>)</td></tr>
<tr><th id="4578">4578</th><td>        <a class="ref fn" href="#FatalError" title='FatalError' data-ref="FatalError" data-ref-filename="FatalError">FatalError</a>(<q>"ERROR: malloc"</q>);</td></tr>
<tr><th id="4579">4579</th><td>    <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformMemZero" title='mDNSPlatformMemZero' data-ref="mDNSPlatformMemZero" data-ref-filename="mDNSPlatformMemZero">mDNSPlatformMemZero</a>(*<a class="local col1 ref" href="#491p" title='p' data-ref="491p" data-ref-filename="491p">p</a>, <b>sizeof</b>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a>));</td></tr>
<tr><th id="4580">4580</th><td>    <b>return</b>(*<a class="local col1 ref" href="#491p" title='p' data-ref="491p" data-ref-filename="491p">p</a>);</td></tr>
<tr><th id="4581">4581</th><td>}</td></tr>
<tr><th id="4582">4582</th><td></td></tr>
<tr><th id="4583">4583</th><td><i>// read_msg may be called any time when the transfer state (req-&gt;ts) is t_morecoming.</i></td></tr>
<tr><th id="4584">4584</th><td><i>// if there is no data on the socket, the socket will be closed and t_terminated will be returned</i></td></tr>
<tr><th id="4585">4585</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="read_msg" title='read_msg' data-ref="read_msg" data-ref-filename="read_msg">read_msg</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col2 decl" id="492req" title='req' data-type='request_state *' data-ref="492req" data-ref-filename="492req">req</dfn>)</td></tr>
<tr><th id="4586">4586</th><td>{</td></tr>
<tr><th id="4587">4587</th><td>    <b>if</b> (<a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::ts" title='request_state::ts' data-ref="request_state::ts" data-ref-filename="request_state..ts">ts</a> == <a class="enum" href="uds_daemon.h.html#t_terminated" title='t_terminated' data-ref="t_terminated" data-ref-filename="t_terminated">t_terminated</a> || <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::ts" title='request_state::ts' data-ref="request_state::ts" data-ref-filename="request_state..ts">ts</a> == <a class="enum" href="uds_daemon.h.html#t_error" title='t_error' data-ref="t_error" data-ref-filename="t_error">t_error</a>)</td></tr>
<tr><th id="4588">4588</th><td>    { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: ERROR: read_msg called with transfer state terminated or error&quot;, req-&gt;sd)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: ERROR: read_msg called with transfer state terminated or error"</q>, <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>); <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::ts" title='request_state::ts' data-ref="request_state::ts" data-ref-filename="request_state..ts">ts</a> = <a class="enum" href="uds_daemon.h.html#t_error" title='t_error' data-ref="t_error" data-ref-filename="t_error">t_error</a>; <b>return</b>; }</td></tr>
<tr><th id="4589">4589</th><td></td></tr>
<tr><th id="4590">4590</th><td>    <b>if</b> (<a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::ts" title='request_state::ts' data-ref="request_state::ts" data-ref-filename="request_state..ts">ts</a> == <a class="enum" href="uds_daemon.h.html#t_complete" title='t_complete' data-ref="t_complete" data-ref-filename="t_complete">t_complete</a>)  <i>// this must be death or something is wrong</i></td></tr>
<tr><th id="4591">4591</th><td>    {</td></tr>
<tr><th id="4592">4592</th><td>        <em>char</em> <dfn class="local col3 decl" id="493buf" title='buf' data-type='char [4]' data-ref="493buf" data-ref-filename="493buf">buf</dfn>[<var>4</var>];    <i>// dummy for death notification</i></td></tr>
<tr><th id="4593">4593</th><td>        <em>int</em> <dfn class="local col4 decl" id="494nread" title='nread' data-type='int' data-ref="494nread" data-ref-filename="494nread">nread</dfn> = <a class="ref fn" href="uds_daemon.h.html#udsSupportReadFD" title='udsSupportReadFD' data-ref="udsSupportReadFD" data-ref-filename="udsSupportReadFD">udsSupportReadFD</a>(<a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col3 ref" href="#493buf" title='buf' data-ref="493buf" data-ref-filename="493buf">buf</a>, <var>4</var>, <var>0</var>, <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::platform_data" title='request_state::platform_data' data-ref="request_state::platform_data" data-ref-filename="request_state..platform_data">platform_data</a>);</td></tr>
<tr><th id="4594">4594</th><td>        <b>if</b> (!<a class="local col4 ref" href="#494nread" title='nread' data-ref="494nread" data-ref-filename="494nread">nread</a>) { <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::ts" title='request_state::ts' data-ref="request_state::ts" data-ref-filename="request_state..ts">ts</a> = <a class="enum" href="uds_daemon.h.html#t_terminated" title='t_terminated' data-ref="t_terminated" data-ref-filename="t_terminated">t_terminated</a>; <b>return</b>; }</td></tr>
<tr><th id="4595">4595</th><td>        <b>if</b> (<a class="local col4 ref" href="#494nread" title='nread' data-ref="494nread" data-ref-filename="494nread">nread</a> &lt; <var>0</var>) <b>goto</b> <a class="lbl" href="#495rerror" data-ref="495rerror" data-ref-filename="495rerror">rerror</a>;</td></tr>
<tr><th id="4596">4596</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: ERROR: read data from a completed request&quot;, req-&gt;sd)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: ERROR: read data from a completed request"</q>, <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>);</td></tr>
<tr><th id="4597">4597</th><td>        <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::ts" title='request_state::ts' data-ref="request_state::ts" data-ref-filename="request_state..ts">ts</a> = <a class="enum" href="uds_daemon.h.html#t_error" title='t_error' data-ref="t_error" data-ref-filename="t_error">t_error</a>;</td></tr>
<tr><th id="4598">4598</th><td>        <b>return</b>;</td></tr>
<tr><th id="4599">4599</th><td>    }</td></tr>
<tr><th id="4600">4600</th><td></td></tr>
<tr><th id="4601">4601</th><td>    <b>if</b> (<a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::ts" title='request_state::ts' data-ref="request_state::ts" data-ref-filename="request_state..ts">ts</a> != <a class="enum" href="uds_daemon.h.html#t_morecoming" title='t_morecoming' data-ref="t_morecoming" data-ref-filename="t_morecoming">t_morecoming</a>)</td></tr>
<tr><th id="4602">4602</th><td>    { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: ERROR: read_msg called with invalid transfer state (%d)&quot;, req-&gt;sd, req-&gt;ts)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: ERROR: read_msg called with invalid transfer state (%d)"</q>, <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::ts" title='request_state::ts' data-ref="request_state::ts" data-ref-filename="request_state..ts">ts</a>); <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::ts" title='request_state::ts' data-ref="request_state::ts" data-ref-filename="request_state..ts">ts</a> = <a class="enum" href="uds_daemon.h.html#t_error" title='t_error' data-ref="t_error" data-ref-filename="t_error">t_error</a>; <b>return</b>; }</td></tr>
<tr><th id="4603">4603</th><td></td></tr>
<tr><th id="4604">4604</th><td>    <b>if</b> (<a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr_bytes" title='request_state::hdr_bytes' data-ref="request_state::hdr_bytes" data-ref-filename="request_state..hdr_bytes">hdr_bytes</a> &lt; <b>sizeof</b>(<a class="typedef" href="dnssd_ipc.h.html#ipc_msg_hdr" title='ipc_msg_hdr' data-type='struct ipc_msg_hdr' data-ref="ipc_msg_hdr" data-ref-filename="ipc_msg_hdr">ipc_msg_hdr</a>))</td></tr>
<tr><th id="4605">4605</th><td>    {</td></tr>
<tr><th id="4606">4606</th><td>        <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col6 decl" id="496nleft" title='nleft' data-type='mDNSu32' data-ref="496nleft" data-ref-filename="496nleft">nleft</dfn> = <b>sizeof</b>(<a class="typedef" href="dnssd_ipc.h.html#ipc_msg_hdr" title='ipc_msg_hdr' data-type='struct ipc_msg_hdr' data-ref="ipc_msg_hdr" data-ref-filename="ipc_msg_hdr">ipc_msg_hdr</a>) - <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr_bytes" title='request_state::hdr_bytes' data-ref="request_state::hdr_bytes" data-ref-filename="request_state..hdr_bytes">hdr_bytes</a>;</td></tr>
<tr><th id="4607">4607</th><td>        <em>int</em> <dfn class="local col7 decl" id="497nread" title='nread' data-type='int' data-ref="497nread" data-ref-filename="497nread">nread</dfn> = <a class="ref fn" href="uds_daemon.h.html#udsSupportReadFD" title='udsSupportReadFD' data-ref="udsSupportReadFD" data-ref-filename="udsSupportReadFD">udsSupportReadFD</a>(<a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, (<em>char</em> *)&amp;<a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a> + <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr_bytes" title='request_state::hdr_bytes' data-ref="request_state::hdr_bytes" data-ref-filename="request_state..hdr_bytes">hdr_bytes</a>, <a class="local col6 ref" href="#496nleft" title='nleft' data-ref="496nleft" data-ref-filename="496nleft">nleft</a>, <var>0</var>, <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::platform_data" title='request_state::platform_data' data-ref="request_state::platform_data" data-ref-filename="request_state..platform_data">platform_data</a>);</td></tr>
<tr><th id="4608">4608</th><td>        <b>if</b> (<a class="local col7 ref" href="#497nread" title='nread' data-ref="497nread" data-ref-filename="497nread">nread</a> == <var>0</var>) { <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::ts" title='request_state::ts' data-ref="request_state::ts" data-ref-filename="request_state..ts">ts</a> = <a class="enum" href="uds_daemon.h.html#t_terminated" title='t_terminated' data-ref="t_terminated" data-ref-filename="t_terminated">t_terminated</a>; <b>return</b>; }</td></tr>
<tr><th id="4609">4609</th><td>        <b>if</b> (<a class="local col7 ref" href="#497nread" title='nread' data-ref="497nread" data-ref-filename="497nread">nread</a> &lt; <var>0</var>) <b>goto</b> <a class="lbl" href="#495rerror" data-ref="495rerror" data-ref-filename="495rerror">rerror</a>;</td></tr>
<tr><th id="4610">4610</th><td>        <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr_bytes" title='request_state::hdr_bytes' data-ref="request_state::hdr_bytes" data-ref-filename="request_state..hdr_bytes">hdr_bytes</a> += <a class="local col7 ref" href="#497nread" title='nread' data-ref="497nread" data-ref-filename="497nread">nread</a>;</td></tr>
<tr><th id="4611">4611</th><td>        <b>if</b> (<a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr_bytes" title='request_state::hdr_bytes' data-ref="request_state::hdr_bytes" data-ref-filename="request_state..hdr_bytes">hdr_bytes</a> &gt; <b>sizeof</b>(<a class="typedef" href="dnssd_ipc.h.html#ipc_msg_hdr" title='ipc_msg_hdr' data-type='struct ipc_msg_hdr' data-ref="ipc_msg_hdr" data-ref-filename="ipc_msg_hdr">ipc_msg_hdr</a>))</td></tr>
<tr><th id="4612">4612</th><td>        { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: ERROR: read_msg - read too many header bytes&quot;, req-&gt;sd)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: ERROR: read_msg - read too many header bytes"</q>, <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>); <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::ts" title='request_state::ts' data-ref="request_state::ts" data-ref-filename="request_state..ts">ts</a> = <a class="enum" href="uds_daemon.h.html#t_error" title='t_error' data-ref="t_error" data-ref-filename="t_error">t_error</a>; <b>return</b>; }</td></tr>
<tr><th id="4613">4613</th><td></td></tr>
<tr><th id="4614">4614</th><td>        <i>// only read data if header is complete</i></td></tr>
<tr><th id="4615">4615</th><td>        <b>if</b> (<a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr_bytes" title='request_state::hdr_bytes' data-ref="request_state::hdr_bytes" data-ref-filename="request_state..hdr_bytes">hdr_bytes</a> == <b>sizeof</b>(<a class="typedef" href="dnssd_ipc.h.html#ipc_msg_hdr" title='ipc_msg_hdr' data-type='struct ipc_msg_hdr' data-ref="ipc_msg_hdr" data-ref-filename="ipc_msg_hdr">ipc_msg_hdr</a>))</td></tr>
<tr><th id="4616">4616</th><td>        {</td></tr>
<tr><th id="4617">4617</th><td>            <a class="macro" href="dnssd_ipc.h.html#201" title="__dnssd_ipc_ConvertHeaderBytes" data-ref="_M/ConvertHeaderBytes">ConvertHeaderBytes</a>(&amp;<a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>);</td></tr>
<tr><th id="4618">4618</th><td>            <b>if</b> (<a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::version" title='(anonymous struct)::version' data-ref="(anonymous)::version" data-ref-filename="(anonymous)..version">version</a> != <a class="macro" href="dnssd_ipc.h.html#102" title="1" data-ref="_M/VERSION">VERSION</a>)</td></tr>
<tr><th id="4619">4619</th><td>            { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: ERROR: client version 0x%08X daemon version 0x%08X&quot;, req-&gt;sd, req-&gt;hdr.version, 1)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: ERROR: client version 0x%08X daemon version 0x%08X"</q>, <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::version" title='(anonymous struct)::version' data-ref="(anonymous)::version" data-ref-filename="(anonymous)..version">version</a>, <a class="macro" href="dnssd_ipc.h.html#102" title="1" data-ref="_M/VERSION">VERSION</a>); <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::ts" title='request_state::ts' data-ref="request_state::ts" data-ref-filename="request_state..ts">ts</a> = <a class="enum" href="uds_daemon.h.html#t_error" title='t_error' data-ref="t_error" data-ref-filename="t_error">t_error</a>; <b>return</b>; }</td></tr>
<tr><th id="4620">4620</th><td></td></tr>
<tr><th id="4621">4621</th><td>            <i>// Largest conceivable single request is a DNSServiceRegisterRecord() or DNSServiceAddRecord()</i></td></tr>
<tr><th id="4622">4622</th><td><i>            // with 64kB of rdata. Adding 1009 byte for a maximal domain name, plus a safety margin</i></td></tr>
<tr><th id="4623">4623</th><td><i>            // for other overhead, this means any message above 70kB is definitely bogus.</i></td></tr>
<tr><th id="4624">4624</th><td>            <b>if</b> (<a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::datalen" title='(anonymous struct)::datalen' data-ref="(anonymous)::datalen" data-ref-filename="(anonymous)..datalen">datalen</a> &gt; <var>70000</var>)</td></tr>
<tr><th id="4625">4625</th><td>            { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: ERROR: read_msg: hdr.datalen %u (0x%X) &gt; 70000&quot;, req-&gt;sd, req-&gt;hdr.datalen, req-&gt;hdr.datalen)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: ERROR: read_msg: hdr.datalen %u (0x%X) &gt; 70000"</q>, <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::datalen" title='(anonymous struct)::datalen' data-ref="(anonymous)::datalen" data-ref-filename="(anonymous)..datalen">datalen</a>, <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::datalen" title='(anonymous struct)::datalen' data-ref="(anonymous)::datalen" data-ref-filename="(anonymous)..datalen">datalen</a>); <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::ts" title='request_state::ts' data-ref="request_state::ts" data-ref-filename="request_state..ts">ts</a> = <a class="enum" href="uds_daemon.h.html#t_error" title='t_error' data-ref="t_error" data-ref-filename="t_error">t_error</a>; <b>return</b>; }</td></tr>
<tr><th id="4626">4626</th><td>            <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgbuf" title='request_state::msgbuf' data-ref="request_state::msgbuf" data-ref-filename="request_state..msgbuf">msgbuf</a> = <a class="macro" href="../mDNSCore/mDNSDebug.h.html#166" title="malloc(req-&gt;hdr.datalen + 5)" data-ref="_M/mallocL">mallocL</a>(<q>"request_state msgbuf"</q>, <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::datalen" title='(anonymous struct)::datalen' data-ref="(anonymous)::datalen" data-ref-filename="(anonymous)..datalen">datalen</a> + <a class="macro" href="#140" title="5" data-ref="_M/MSG_PAD_BYTES">MSG_PAD_BYTES</a>);</td></tr>
<tr><th id="4627">4627</th><td>            <b>if</b> (!<a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgbuf" title='request_state::msgbuf' data-ref="request_state::msgbuf" data-ref-filename="request_state..msgbuf">msgbuf</a>) { <a class="ref fn" href="#my_perror" title='my_perror' data-ref="my_perror" data-ref-filename="my_perror">my_perror</a>(<q>"ERROR: malloc"</q>); <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::ts" title='request_state::ts' data-ref="request_state::ts" data-ref-filename="request_state..ts">ts</a> = <a class="enum" href="uds_daemon.h.html#t_error" title='t_error' data-ref="t_error" data-ref-filename="t_error">t_error</a>; <b>return</b>; }</td></tr>
<tr><th id="4628">4628</th><td>            <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a> = <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgbuf" title='request_state::msgbuf' data-ref="request_state::msgbuf" data-ref-filename="request_state..msgbuf">msgbuf</a>;</td></tr>
<tr><th id="4629">4629</th><td>            <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a> = <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgbuf" title='request_state::msgbuf' data-ref="request_state::msgbuf" data-ref-filename="request_state..msgbuf">msgbuf</a> + <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::datalen" title='(anonymous struct)::datalen' data-ref="(anonymous)::datalen" data-ref-filename="(anonymous)..datalen">datalen</a>;</td></tr>
<tr><th id="4630">4630</th><td>            <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformMemZero" title='mDNSPlatformMemZero' data-ref="mDNSPlatformMemZero" data-ref-filename="mDNSPlatformMemZero">mDNSPlatformMemZero</a>(<a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgbuf" title='request_state::msgbuf' data-ref="request_state::msgbuf" data-ref-filename="request_state..msgbuf">msgbuf</a>, <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::datalen" title='(anonymous struct)::datalen' data-ref="(anonymous)::datalen" data-ref-filename="(anonymous)..datalen">datalen</a> + <a class="macro" href="#140" title="5" data-ref="_M/MSG_PAD_BYTES">MSG_PAD_BYTES</a>);</td></tr>
<tr><th id="4631">4631</th><td>        }</td></tr>
<tr><th id="4632">4632</th><td>    }</td></tr>
<tr><th id="4633">4633</th><td></td></tr>
<tr><th id="4634">4634</th><td>    <i>// If our header is complete, but we're still needing more body data, then try to read it now</i></td></tr>
<tr><th id="4635">4635</th><td><i>    // Note: For cancel_request req-&gt;hdr.datalen == 0, but there's no error return socket for cancel_request</i></td></tr>
<tr><th id="4636">4636</th><td><i>    // Any time we need to get the error return socket we know we'll have at least one data byte</i></td></tr>
<tr><th id="4637">4637</th><td><i>    // (even if only the one-byte empty C string placeholder for the old ctrl_path parameter)</i></td></tr>
<tr><th id="4638">4638</th><td>    <b>if</b> (<a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr_bytes" title='request_state::hdr_bytes' data-ref="request_state::hdr_bytes" data-ref-filename="request_state..hdr_bytes">hdr_bytes</a> == <b>sizeof</b>(<a class="typedef" href="dnssd_ipc.h.html#ipc_msg_hdr" title='ipc_msg_hdr' data-type='struct ipc_msg_hdr' data-ref="ipc_msg_hdr" data-ref-filename="ipc_msg_hdr">ipc_msg_hdr</a>) &amp;&amp; <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::data_bytes" title='request_state::data_bytes' data-ref="request_state::data_bytes" data-ref-filename="request_state..data_bytes">data_bytes</a> &lt; <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::datalen" title='(anonymous struct)::datalen' data-ref="(anonymous)::datalen" data-ref-filename="(anonymous)..datalen">datalen</a>)</td></tr>
<tr><th id="4639">4639</th><td>    {</td></tr>
<tr><th id="4640">4640</th><td>        <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col8 decl" id="498nleft" title='nleft' data-type='mDNSu32' data-ref="498nleft" data-ref-filename="498nleft">nleft</dfn> = <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::datalen" title='(anonymous struct)::datalen' data-ref="(anonymous)::datalen" data-ref-filename="(anonymous)..datalen">datalen</a> - <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::data_bytes" title='request_state::data_bytes' data-ref="request_state::data_bytes" data-ref-filename="request_state..data_bytes">data_bytes</a>;</td></tr>
<tr><th id="4641">4641</th><td>        <em>int</em> <dfn class="local col9 decl" id="499nread" title='nread' data-type='int' data-ref="499nread" data-ref-filename="499nread">nread</dfn>;</td></tr>
<tr><th id="4642">4642</th><td><u>#<span data-ppcond="4642">if</span> !defined(<span class="macro" data-ref="_M/_WIN32">_WIN32</span>)</u></td></tr>
<tr><th id="4643">4643</th><td>        <b>struct</b> <a class="type" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/uio.h.html#iovec" title='iovec' data-ref="iovec" data-ref-filename="iovec">iovec</a> <dfn class="local col0 decl" id="500vec" title='vec' data-type='struct iovec' data-ref="500vec" data-ref-filename="500vec">vec</dfn> = { <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgbuf" title='request_state::msgbuf' data-ref="request_state::msgbuf" data-ref-filename="request_state..msgbuf">msgbuf</a> + <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::data_bytes" title='request_state::data_bytes' data-ref="request_state::data_bytes" data-ref-filename="request_state..data_bytes">data_bytes</a>, <a class="local col8 ref" href="#498nleft" title='nleft' data-ref="498nleft" data-ref-filename="498nleft">nleft</a> };    <i>// Tell recvmsg where we want the bytes put</i></td></tr>
<tr><th id="4644">4644</th><td>        <b>struct</b> <a class="type" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#msghdr" title='msghdr' data-ref="msghdr" data-ref-filename="msghdr">msghdr</a> <dfn class="local col1 decl" id="501msg" title='msg' data-type='struct msghdr' data-ref="501msg" data-ref-filename="501msg">msg</dfn>;</td></tr>
<tr><th id="4645">4645</th><td>        <b>struct</b> <a class="type" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#cmsghdr" title='cmsghdr' data-ref="cmsghdr" data-ref-filename="cmsghdr">cmsghdr</a> *<dfn class="local col2 decl" id="502cmsg" title='cmsg' data-type='struct cmsghdr *' data-ref="502cmsg" data-ref-filename="502cmsg">cmsg</dfn>;</td></tr>
<tr><th id="4646">4646</th><td>        <em>char</em> <dfn class="local col3 decl" id="503cbuf" title='cbuf' data-type='char [32]' data-ref="503cbuf" data-ref-filename="503cbuf">cbuf</dfn>[<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#572" title="((((sizeof(struct cmsghdr)) + (sizeof(long) - 1)) &amp; ~(sizeof(long) - 1)) + (((4 * sizeof(dnssd_sock_t)) + (sizeof(long) - 1)) &amp; ~(sizeof(long) - 1)))" data-ref="_M/CMSG_SPACE">CMSG_SPACE</a>(<var>4</var> * <b>sizeof</b>(<a class="typedef" href="dns_sd.h.html#dnssd_sock_t" title='dnssd_sock_t' data-type='int' data-ref="dnssd_sock_t" data-ref-filename="dnssd_sock_t">dnssd_sock_t</a>))];</td></tr>
<tr><th id="4647">4647</th><td>        <a class="local col1 ref" href="#501msg" title='msg' data-ref="501msg" data-ref-filename="501msg">msg</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#msghdr::msg_name" title='msghdr::msg_name' data-ref="msghdr::msg_name" data-ref-filename="msghdr..msg_name">msg_name</a>       = <var>0</var>;</td></tr>
<tr><th id="4648">4648</th><td>        <a class="local col1 ref" href="#501msg" title='msg' data-ref="501msg" data-ref-filename="501msg">msg</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#msghdr::msg_namelen" title='msghdr::msg_namelen' data-ref="msghdr::msg_namelen" data-ref-filename="msghdr..msg_namelen">msg_namelen</a>    = <var>0</var>;</td></tr>
<tr><th id="4649">4649</th><td>        <a class="local col1 ref" href="#501msg" title='msg' data-ref="501msg" data-ref-filename="501msg">msg</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#msghdr::msg_iov" title='msghdr::msg_iov' data-ref="msghdr::msg_iov" data-ref-filename="msghdr..msg_iov">msg_iov</a>        = &amp;<a class="local col0 ref" href="#500vec" title='vec' data-ref="500vec" data-ref-filename="500vec">vec</a>;</td></tr>
<tr><th id="4650">4650</th><td>        <a class="local col1 ref" href="#501msg" title='msg' data-ref="501msg" data-ref-filename="501msg">msg</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#msghdr::msg_iovlen" title='msghdr::msg_iovlen' data-ref="msghdr::msg_iovlen" data-ref-filename="msghdr..msg_iovlen">msg_iovlen</a>     = <var>1</var>;</td></tr>
<tr><th id="4651">4651</th><td>        <a class="local col1 ref" href="#501msg" title='msg' data-ref="501msg" data-ref-filename="501msg">msg</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#msghdr::msg_control" title='msghdr::msg_control' data-ref="msghdr::msg_control" data-ref-filename="msghdr..msg_control">msg_control</a>    = <a class="local col3 ref" href="#503cbuf" title='cbuf' data-ref="503cbuf" data-ref-filename="503cbuf">cbuf</a>;</td></tr>
<tr><th id="4652">4652</th><td>        <a class="local col1 ref" href="#501msg" title='msg' data-ref="501msg" data-ref-filename="501msg">msg</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#msghdr::msg_controllen" title='msghdr::msg_controllen' data-ref="msghdr::msg_controllen" data-ref-filename="msghdr..msg_controllen">msg_controllen</a> = <b>sizeof</b>(<a class="local col3 ref" href="#503cbuf" title='cbuf' data-ref="503cbuf" data-ref-filename="503cbuf">cbuf</a>);</td></tr>
<tr><th id="4653">4653</th><td>        <a class="local col1 ref" href="#501msg" title='msg' data-ref="501msg" data-ref-filename="501msg">msg</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#msghdr::msg_flags" title='msghdr::msg_flags' data-ref="msghdr::msg_flags" data-ref-filename="msghdr..msg_flags">msg_flags</a>      = <var>0</var>;</td></tr>
<tr><th id="4654">4654</th><td>        <a class="local col9 ref" href="#499nread" title='nread' data-ref="499nread" data-ref-filename="499nread">nread</a> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#recvmsg" title='recvmsg' data-ref="recvmsg" data-ref-filename="recvmsg">recvmsg</a>(<a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, &amp;<a class="local col1 ref" href="#501msg" title='msg' data-ref="501msg" data-ref-filename="501msg">msg</a>, <var>0</var>);</td></tr>
<tr><th id="4655">4655</th><td><u>#<span data-ppcond="4642">else</span></u></td></tr>
<tr><th id="4656">4656</th><td>        nread = udsSupportReadFD(req-&gt;sd, (<em>char</em> *)req-&gt;msgbuf + req-&gt;data_bytes, nleft, <var>0</var>, req-&gt;platform_data);</td></tr>
<tr><th id="4657">4657</th><td><u>#<span data-ppcond="4642">endif</span></u></td></tr>
<tr><th id="4658">4658</th><td>        <b>if</b> (<a class="local col9 ref" href="#499nread" title='nread' data-ref="499nread" data-ref-filename="499nread">nread</a> == <var>0</var>) { <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::ts" title='request_state::ts' data-ref="request_state::ts" data-ref-filename="request_state..ts">ts</a> = <a class="enum" href="uds_daemon.h.html#t_terminated" title='t_terminated' data-ref="t_terminated" data-ref-filename="t_terminated">t_terminated</a>; <b>return</b>; }</td></tr>
<tr><th id="4659">4659</th><td>        <b>if</b> (<a class="local col9 ref" href="#499nread" title='nread' data-ref="499nread" data-ref-filename="499nread">nread</a> &lt; <var>0</var>) <b>goto</b> <a class="lbl" href="#495rerror" data-ref="495rerror" data-ref-filename="495rerror">rerror</a>;</td></tr>
<tr><th id="4660">4660</th><td>        <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::data_bytes" title='request_state::data_bytes' data-ref="request_state::data_bytes" data-ref-filename="request_state..data_bytes">data_bytes</a> += <a class="local col9 ref" href="#499nread" title='nread' data-ref="499nread" data-ref-filename="499nread">nread</a>;</td></tr>
<tr><th id="4661">4661</th><td>        <b>if</b> (<a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::data_bytes" title='request_state::data_bytes' data-ref="request_state::data_bytes" data-ref-filename="request_state..data_bytes">data_bytes</a> &gt; <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::datalen" title='(anonymous struct)::datalen' data-ref="(anonymous)::datalen" data-ref-filename="(anonymous)..datalen">datalen</a>)</td></tr>
<tr><th id="4662">4662</th><td>        { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: ERROR: read_msg - read too many data bytes&quot;, req-&gt;sd)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: ERROR: read_msg - read too many data bytes"</q>, <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>); <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::ts" title='request_state::ts' data-ref="request_state::ts" data-ref-filename="request_state..ts">ts</a> = <a class="enum" href="uds_daemon.h.html#t_error" title='t_error' data-ref="t_error" data-ref-filename="t_error">t_error</a>; <b>return</b>; }</td></tr>
<tr><th id="4663">4663</th><td><u>#<span data-ppcond="4663">if</span> !defined(<span class="macro" data-ref="_M/_WIN32">_WIN32</span>)</u></td></tr>
<tr><th id="4664">4664</th><td>        <a class="local col2 ref" href="#502cmsg" title='cmsg' data-ref="502cmsg" data-ref-filename="502cmsg">cmsg</a> = <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#567" title="((struct cmsghdr *)(((void *)((&amp;msg)-&gt;msg_controllen &lt; sizeof(struct cmsghdr) ? 0 : (&amp;msg)-&gt;msg_control))))" data-ref="_M/CMSG_FIRSTHDR">CMSG_FIRSTHDR</a>(&amp;<a class="local col1 ref" href="#501msg" title='msg' data-ref="501msg" data-ref-filename="501msg">msg</a>);</td></tr>
<tr><th id="4665">4665</th><td><u>#<span data-ppcond="4665">if</span> DEBUG_64BIT_SCM_RIGHTS</u></td></tr>
<tr><th id="4666">4666</th><td>        LogMsg(<q>"%3d: Expecting %d %d %d %d"</q>, req-&gt;sd, <b>sizeof</b>(cbuf), <b>sizeof</b>(cbuf), SOL_SOCKET, SCM_RIGHTS);</td></tr>
<tr><th id="4667">4667</th><td>        LogMsg(<q>"%3d: Got       %d %d %d %d"</q>, req-&gt;sd, msg.msg_controllen, cmsg ? cmsg-&gt;cmsg_len : -<var>1</var>, cmsg ? cmsg-&gt;cmsg_level : -<var>1</var>, cmsg ? cmsg-&gt;cmsg_type : -<var>1</var>);</td></tr>
<tr><th id="4668">4668</th><td><u>#<span data-ppcond="4665">endif</span> // DEBUG_64BIT_SCM_RIGHTS</u></td></tr>
<tr><th id="4669">4669</th><td>        <b>if</b> (<a class="local col2 ref" href="#502cmsg" title='cmsg' data-ref="502cmsg" data-ref-filename="502cmsg">cmsg</a> &amp;&amp; <a class="local col2 ref" href="#502cmsg" title='cmsg' data-ref="502cmsg" data-ref-filename="502cmsg">cmsg</a>-&gt;<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#cmsghdr::cmsg_level" title='cmsghdr::cmsg_level' data-ref="cmsghdr::cmsg_level" data-ref-filename="cmsghdr..cmsg_level">cmsg_level</a> == <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#195" title="0xffff" data-ref="_M/SOL_SOCKET">SOL_SOCKET</a> &amp;&amp; <a class="local col2 ref" href="#502cmsg" title='cmsg' data-ref="502cmsg" data-ref-filename="502cmsg">cmsg</a>-&gt;<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#cmsghdr::cmsg_type" title='cmsghdr::cmsg_type' data-ref="cmsghdr::cmsg_type" data-ref-filename="cmsghdr..cmsg_type">cmsg_type</a> == <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#576" title="0x01" data-ref="_M/SCM_RIGHTS">SCM_RIGHTS</a>)</td></tr>
<tr><th id="4670">4670</th><td>        {</td></tr>
<tr><th id="4671">4671</th><td><u>#<span data-ppcond="4671">if</span> APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="4672">4672</th><td>            <i>// Strictly speaking BPF_fd belongs solely in the platform support layer, but because</i></td></tr>
<tr><th id="4673">4673</th><td><i>            // of privilege separation on Mac OS X we need to get BPF_fd from mDNSResponderHelper,</i></td></tr>
<tr><th id="4674">4674</th><td><i>            // and it's convenient to repurpose the existing fd-passing code here for that task</i></td></tr>
<tr><th id="4675">4675</th><td>            <b>if</b> (req-&gt;hdr.op == send_bpf)</td></tr>
<tr><th id="4676">4676</th><td>            {</td></tr>
<tr><th id="4677">4677</th><td>                dnssd_sock_t x = *(dnssd_sock_t *)CMSG_DATA(cmsg);</td></tr>
<tr><th id="4678">4678</th><td>                LogOperation(<q>"%3d: Got len %d, BPF %d"</q>, req-&gt;sd, cmsg-&gt;cmsg_len, x);</td></tr>
<tr><th id="4679">4679</th><td>                mDNSPlatformReceiveBPF_fd(x);</td></tr>
<tr><th id="4680">4680</th><td>            }</td></tr>
<tr><th id="4681">4681</th><td>            <b>else</b></td></tr>
<tr><th id="4682">4682</th><td><u>#<span data-ppcond="4671">endif</span> // APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="4683">4683</th><td>            <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::errsd" title='request_state::errsd' data-ref="request_state::errsd" data-ref-filename="request_state..errsd">errsd</a> = *(<a class="typedef" href="dns_sd.h.html#dnssd_sock_t" title='dnssd_sock_t' data-type='int' data-ref="dnssd_sock_t" data-ref-filename="dnssd_sock_t">dnssd_sock_t</a> *)<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#554" title="(((u_char *)(((void *)(cmsg)))) + (((sizeof(struct cmsghdr)) + (sizeof(long) - 1)) &amp; ~(sizeof(long) - 1)))" data-ref="_M/CMSG_DATA">CMSG_DATA</a>(<a class="local col2 ref" href="#502cmsg" title='cmsg' data-ref="502cmsg" data-ref-filename="502cmsg">cmsg</a>);</td></tr>
<tr><th id="4684">4684</th><td><u>#<span data-ppcond="4684">if</span> DEBUG_64BIT_SCM_RIGHTS</u></td></tr>
<tr><th id="4685">4685</th><td>            LogMsg(<q>"%3d: read req-&gt;errsd %d"</q>, req-&gt;sd, req-&gt;errsd);</td></tr>
<tr><th id="4686">4686</th><td><u>#<span data-ppcond="4684">endif</span> // DEBUG_64BIT_SCM_RIGHTS</u></td></tr>
<tr><th id="4687">4687</th><td>            <b>if</b> (<a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::data_bytes" title='request_state::data_bytes' data-ref="request_state::data_bytes" data-ref-filename="request_state..data_bytes">data_bytes</a> &lt; <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::datalen" title='(anonymous struct)::datalen' data-ref="(anonymous)::datalen" data-ref-filename="(anonymous)..datalen">datalen</a>)</td></tr>
<tr><th id="4688">4688</th><td>            {</td></tr>
<tr><th id="4689">4689</th><td>                <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: Client(PID [%d](%s)) sent result code socket %d via SCM_RIGHTS with req-&gt;data_bytes %d &lt; req-&gt;hdr.datalen %d&quot;, req-&gt;sd, req-&gt;process_id, req-&gt;pid_name, req-&gt;errsd, req-&gt;data_bytes, req-&gt;hdr.datalen)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: Client(PID [%d](%s)) sent result code socket %d via SCM_RIGHTS with req-&gt;data_bytes %d &lt; req-&gt;hdr.datalen %d"</q>,</td></tr>
<tr><th id="4690">4690</th><td>                       <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>, <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::errsd" title='request_state::errsd' data-ref="request_state::errsd" data-ref-filename="request_state..errsd">errsd</a>, <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::data_bytes" title='request_state::data_bytes' data-ref="request_state::data_bytes" data-ref-filename="request_state..data_bytes">data_bytes</a>, <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::datalen" title='(anonymous struct)::datalen' data-ref="(anonymous)::datalen" data-ref-filename="(anonymous)..datalen">datalen</a>);</td></tr>
<tr><th id="4691">4691</th><td>                <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::ts" title='request_state::ts' data-ref="request_state::ts" data-ref-filename="request_state..ts">ts</a> = <a class="enum" href="uds_daemon.h.html#t_error" title='t_error' data-ref="t_error" data-ref-filename="t_error">t_error</a>;</td></tr>
<tr><th id="4692">4692</th><td>                <b>return</b>;</td></tr>
<tr><th id="4693">4693</th><td>            }</td></tr>
<tr><th id="4694">4694</th><td>        }</td></tr>
<tr><th id="4695">4695</th><td><u>#<span data-ppcond="4663">endif</span></u></td></tr>
<tr><th id="4696">4696</th><td>    }</td></tr>
<tr><th id="4697">4697</th><td></td></tr>
<tr><th id="4698">4698</th><td>    <i>// If our header and data are both complete, see if we need to make our separate error return socket</i></td></tr>
<tr><th id="4699">4699</th><td>    <b>if</b> (<a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr_bytes" title='request_state::hdr_bytes' data-ref="request_state::hdr_bytes" data-ref-filename="request_state..hdr_bytes">hdr_bytes</a> == <b>sizeof</b>(<a class="typedef" href="dnssd_ipc.h.html#ipc_msg_hdr" title='ipc_msg_hdr' data-type='struct ipc_msg_hdr' data-ref="ipc_msg_hdr" data-ref-filename="ipc_msg_hdr">ipc_msg_hdr</a>) &amp;&amp; <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::data_bytes" title='request_state::data_bytes' data-ref="request_state::data_bytes" data-ref-filename="request_state..data_bytes">data_bytes</a> == <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::datalen" title='(anonymous struct)::datalen' data-ref="(anonymous)::datalen" data-ref-filename="(anonymous)..datalen">datalen</a>)</td></tr>
<tr><th id="4700">4700</th><td>    {</td></tr>
<tr><th id="4701">4701</th><td>        <b>if</b> (<a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> &amp;&amp; <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::op" title='(anonymous struct)::op' data-ref="(anonymous)::op" data-ref-filename="(anonymous)..op">op</a> != <a class="enum" href="dnssd_ipc.h.html#cancel_request" title='cancel_request' data-ref="cancel_request" data-ref-filename="cancel_request">cancel_request</a>)</td></tr>
<tr><th id="4702">4702</th><td>        {</td></tr>
<tr><th id="4703">4703</th><td>            <a class="macro" href="dnssd_ipc.h.html#90" title="struct sockaddr_un" data-ref="_M/dnssd_sockaddr_t">dnssd_sockaddr_t</a> <dfn class="local col4 decl" id="504cliaddr" title='cliaddr' data-type='struct sockaddr_un' data-ref="504cliaddr" data-ref-filename="504cliaddr">cliaddr</dfn>;</td></tr>
<tr><th id="4704">4704</th><td><u>#<span data-ppcond="4704">if</span> defined(<span class="macro" data-ref="_M/USE_TCP_LOOPBACK">USE_TCP_LOOPBACK</span>)</u></td></tr>
<tr><th id="4705">4705</th><td>            mDNSOpaque16 port;</td></tr>
<tr><th id="4706">4706</th><td>            u_long opt = <var>1</var>;</td></tr>
<tr><th id="4707">4707</th><td>            port.b[<var>0</var>] = req-&gt;msgptr[<var>0</var>];</td></tr>
<tr><th id="4708">4708</th><td>            port.b[<var>1</var>] = req-&gt;msgptr[<var>1</var>];</td></tr>
<tr><th id="4709">4709</th><td>            req-&gt;msgptr += <var>2</var>;</td></tr>
<tr><th id="4710">4710</th><td>            cliaddr.sin_family      = AF_INET;</td></tr>
<tr><th id="4711">4711</th><td>            cliaddr.sin_port        = port.NotAnInteger;</td></tr>
<tr><th id="4712">4712</th><td>            cliaddr.sin_addr.s_addr = inet_addr(MDNS_TCP_SERVERADDR);</td></tr>
<tr><th id="4713">4713</th><td><u>#<span data-ppcond="4704">else</span></u></td></tr>
<tr><th id="4714">4714</th><td>            <em>char</em> <dfn class="local col5 decl" id="505ctrl_path" title='ctrl_path' data-type='char [104]' data-ref="505ctrl_path" data-ref-filename="505ctrl_path">ctrl_path</dfn>[<a class="macro" href="dnssd_ipc.h.html#89" title="(sizeof(((struct sockaddr_un*)0)-&gt;sun_path))" data-ref="_M/MAX_CTLPATH">MAX_CTLPATH</a>];</td></tr>
<tr><th id="4715">4715</th><td>            <a class="macro" href="dnssd_ipc.h.html#198" title="__dnssd_ipc_get_string" data-ref="_M/get_string">get_string</a>(&amp;<a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>, <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>, <a class="local col5 ref" href="#505ctrl_path" title='ctrl_path' data-ref="505ctrl_path" data-ref-filename="505ctrl_path">ctrl_path</a>, <a class="macro" href="dnssd_ipc.h.html#89" title="(sizeof(((struct sockaddr_un*)0)-&gt;sun_path))" data-ref="_M/MAX_CTLPATH">MAX_CTLPATH</a>);  <i>// path is first element in message buffer</i></td></tr>
<tr><th id="4716">4716</th><td>            <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformMemZero" title='mDNSPlatformMemZero' data-ref="mDNSPlatformMemZero" data-ref-filename="mDNSPlatformMemZero">mDNSPlatformMemZero</a>(&amp;<a class="local col4 ref" href="#504cliaddr" title='cliaddr' data-ref="504cliaddr" data-ref-filename="504cliaddr">cliaddr</a>, <b>sizeof</b>(<a class="local col4 ref" href="#504cliaddr" title='cliaddr' data-ref="504cliaddr" data-ref-filename="504cliaddr">cliaddr</a>));</td></tr>
<tr><th id="4717">4717</th><td>            <a class="local col4 ref" href="#504cliaddr" title='cliaddr' data-ref="504cliaddr" data-ref-filename="504cliaddr">cliaddr</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/un.h.html#sockaddr_un::sun_family" title='sockaddr_un::sun_family' data-ref="sockaddr_un::sun_family" data-ref-filename="sockaddr_un..sun_family">sun_family</a> = <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#201" title="1" data-ref="_M/AF_LOCAL">AF_LOCAL</a>;</td></tr>
<tr><th id="4718">4718</th><td>            <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformStrLCopy" title='mDNSPlatformStrLCopy' data-ref="mDNSPlatformStrLCopy" data-ref-filename="mDNSPlatformStrLCopy">mDNSPlatformStrLCopy</a>(<a class="local col4 ref" href="#504cliaddr" title='cliaddr' data-ref="504cliaddr" data-ref-filename="504cliaddr">cliaddr</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/un.h.html#sockaddr_un::sun_path" title='sockaddr_un::sun_path' data-ref="sockaddr_un::sun_path" data-ref-filename="sockaddr_un..sun_path">sun_path</a>, <a class="local col5 ref" href="#505ctrl_path" title='ctrl_path' data-ref="505ctrl_path" data-ref-filename="505ctrl_path">ctrl_path</a>, <b>sizeof</b>(<a class="local col4 ref" href="#504cliaddr" title='cliaddr' data-ref="504cliaddr" data-ref-filename="504cliaddr">cliaddr</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/un.h.html#sockaddr_un::sun_path" title='sockaddr_un::sun_path' data-ref="sockaddr_un::sun_path" data-ref-filename="sockaddr_un..sun_path">sun_path</a>));</td></tr>
<tr><th id="4719">4719</th><td>            <i>// If the error return path UDS name is empty string, that tells us</i></td></tr>
<tr><th id="4720">4720</th><td><i>            // that this is a new version of the library that's going to pass us</i></td></tr>
<tr><th id="4721">4721</th><td><i>            // the error return path socket via sendmsg/recvmsg</i></td></tr>
<tr><th id="4722">4722</th><td>            <b>if</b> (<a class="local col5 ref" href="#505ctrl_path" title='ctrl_path' data-ref="505ctrl_path" data-ref-filename="505ctrl_path">ctrl_path</a>[<var>0</var>] == <var>0</var>)</td></tr>
<tr><th id="4723">4723</th><td>            {</td></tr>
<tr><th id="4724">4724</th><td>                <b>if</b> (<a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::errsd" title='request_state::errsd' data-ref="request_state::errsd" data-ref-filename="request_state..errsd">errsd</a> == <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>)</td></tr>
<tr><th id="4725">4725</th><td>                { <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: read_msg: ERROR failed to get errsd via SCM_RIGHTS&quot;, req-&gt;sd)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: read_msg: ERROR failed to get errsd via SCM_RIGHTS"</q>, <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>); <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::ts" title='request_state::ts' data-ref="request_state::ts" data-ref-filename="request_state..ts">ts</a> = <a class="enum" href="uds_daemon.h.html#t_error" title='t_error' data-ref="t_error" data-ref-filename="t_error">t_error</a>; <b>return</b>; }</td></tr>
<tr><th id="4726">4726</th><td>                <b>goto</b> <a class="lbl" href="#506got_errfd" data-ref="506got_errfd" data-ref-filename="506got_errfd">got_errfd</a>;</td></tr>
<tr><th id="4727">4727</th><td>            }</td></tr>
<tr><th id="4728">4728</th><td><u>#<span data-ppcond="4704">endif</span></u></td></tr>
<tr><th id="4729">4729</th><td></td></tr>
<tr><th id="4730">4730</th><td>            <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::errsd" title='request_state::errsd' data-ref="request_state::errsd" data-ref-filename="request_state..errsd">errsd</a> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#__socket30" title='socket' data-ref="__socket30" data-ref-filename="__socket30">socket</a>(<a class="macro" href="dnssd_ipc.h.html#82" title="1" data-ref="_M/AF_DNSSD">AF_DNSSD</a>, <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#105" title="1" data-ref="_M/SOCK_STREAM">SOCK_STREAM</a>, <var>0</var>);</td></tr>
<tr><th id="4731">4731</th><td>            <b>if</b> (!<a class="macro" href="dnssd_ipc.h.html#64" title="((req-&gt;errsd) &gt;= 0)" data-ref="_M/dnssd_SocketValid">dnssd_SocketValid</a>(<a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::errsd" title='request_state::errsd' data-ref="request_state::errsd" data-ref-filename="request_state..errsd">errsd</a>))</td></tr>
<tr><th id="4732">4732</th><td>            {</td></tr>
<tr><th id="4733">4733</th><td>                <a class="ref fn" href="#my_throttled_perror" title='my_throttled_perror' data-ref="my_throttled_perror" data-ref-filename="my_throttled_perror">my_throttled_perror</a>(<q>"ERROR: socket"</q>);</td></tr>
<tr><th id="4734">4734</th><td>                <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::ts" title='request_state::ts' data-ref="request_state::ts" data-ref-filename="request_state..ts">ts</a> = <a class="enum" href="uds_daemon.h.html#t_error" title='t_error' data-ref="t_error" data-ref-filename="t_error">t_error</a>;</td></tr>
<tr><th id="4735">4735</th><td>                <b>return</b>;</td></tr>
<tr><th id="4736">4736</th><td>            }</td></tr>
<tr><th id="4737">4737</th><td></td></tr>
<tr><th id="4738">4738</th><td>            <b>if</b> (<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#connect" title='connect' data-ref="connect" data-ref-filename="connect">connect</a>(<a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::errsd" title='request_state::errsd' data-ref="request_state::errsd" data-ref-filename="request_state..errsd">errsd</a>, (<b>struct</b> <a class="type" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#sockaddr" title='sockaddr' data-ref="sockaddr" data-ref-filename="sockaddr">sockaddr</a> *)&amp;<a class="local col4 ref" href="#504cliaddr" title='cliaddr' data-ref="504cliaddr" data-ref-filename="504cliaddr">cliaddr</a>, <b>sizeof</b>(<a class="local col4 ref" href="#504cliaddr" title='cliaddr' data-ref="504cliaddr" data-ref-filename="504cliaddr">cliaddr</a>)) &lt; <var>0</var>)</td></tr>
<tr><th id="4739">4739</th><td>            {</td></tr>
<tr><th id="4740">4740</th><td><u>#<span data-ppcond="4740">if</span> !defined(<span class="macro" data-ref="_M/USE_TCP_LOOPBACK">USE_TCP_LOOPBACK</span>)</u></td></tr>
<tr><th id="4741">4741</th><td>                <b>struct</b> <a class="type" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/stat.h.html#stat" title='stat' data-ref="stat" data-ref-filename="stat">stat</a> <dfn class="local col7 decl" id="507sb" title='sb' data-type='struct stat' data-ref="507sb" data-ref-filename="507sb">sb</dfn>;</td></tr>
<tr><th id="4742">4742</th><td>                <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: read_msg: Couldn&apos;t connect to error return path socket “%s” errno %d (%s)&quot;, req-&gt;sd, cliaddr.sun_path, (*__errno()), strerror((*__errno())))" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: read_msg: Couldn't connect to error return path socket “%s” errno %d (%s)"</q>,</td></tr>
<tr><th id="4743">4743</th><td>                       <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col4 ref" href="#504cliaddr" title='cliaddr' data-ref="504cliaddr" data-ref-filename="504cliaddr">cliaddr</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/un.h.html#sockaddr_un::sun_path" title='sockaddr_un::sun_path' data-ref="sockaddr_un::sun_path" data-ref-filename="sockaddr_un..sun_path">sun_path</a>, <a class="macro" href="dnssd_ipc.h.html#71" title="(*__errno())" data-ref="_M/dnssd_errno">dnssd_errno</a>, <a class="macro" href="dnssd_ipc.h.html#72" title="strerror((*__errno()))" data-ref="_M/dnssd_strerror">dnssd_strerror</a>(<a class="macro" href="dnssd_ipc.h.html#71" title="(*__errno())" data-ref="_M/dnssd_errno">dnssd_errno</a>));</td></tr>
<tr><th id="4744">4744</th><td>                <b>if</b> (<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/stat.h.html#__stat50" title='stat' data-ref="__stat50" data-ref-filename="__stat50">stat</a>(<a class="local col4 ref" href="#504cliaddr" title='cliaddr' data-ref="504cliaddr" data-ref-filename="504cliaddr">cliaddr</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/un.h.html#sockaddr_un::sun_path" title='sockaddr_un::sun_path' data-ref="sockaddr_un::sun_path" data-ref-filename="sockaddr_un..sun_path">sun_path</a>, &amp;<a class="local col7 ref" href="#507sb" title='sb' data-ref="507sb" data-ref-filename="507sb">sb</a>) &lt; <var>0</var>)</td></tr>
<tr><th id="4745">4745</th><td>                    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: read_msg: stat failed “%s” errno %d (%s)&quot;, req-&gt;sd, cliaddr.sun_path, (*__errno()), strerror((*__errno())))" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: read_msg: stat failed “%s” errno %d (%s)"</q>, <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col4 ref" href="#504cliaddr" title='cliaddr' data-ref="504cliaddr" data-ref-filename="504cliaddr">cliaddr</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/un.h.html#sockaddr_un::sun_path" title='sockaddr_un::sun_path' data-ref="sockaddr_un::sun_path" data-ref-filename="sockaddr_un..sun_path">sun_path</a>, <a class="macro" href="dnssd_ipc.h.html#71" title="(*__errno())" data-ref="_M/dnssd_errno">dnssd_errno</a>, <a class="macro" href="dnssd_ipc.h.html#72" title="strerror((*__errno()))" data-ref="_M/dnssd_strerror">dnssd_strerror</a>(<a class="macro" href="dnssd_ipc.h.html#71" title="(*__errno())" data-ref="_M/dnssd_errno">dnssd_errno</a>));</td></tr>
<tr><th id="4746">4746</th><td>                <b>else</b></td></tr>
<tr><th id="4747">4747</th><td>                    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: read_msg: file “%s” mode %o (octal) uid %d gid %d&quot;, req-&gt;sd, cliaddr.sun_path, sb.st_mode, sb.st_uid, sb.st_gid)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: read_msg: file “%s” mode %o (octal) uid %d gid %d"</q>, <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col4 ref" href="#504cliaddr" title='cliaddr' data-ref="504cliaddr" data-ref-filename="504cliaddr">cliaddr</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/un.h.html#sockaddr_un::sun_path" title='sockaddr_un::sun_path' data-ref="sockaddr_un::sun_path" data-ref-filename="sockaddr_un..sun_path">sun_path</a>, <a class="local col7 ref" href="#507sb" title='sb' data-ref="507sb" data-ref-filename="507sb">sb</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/stat.h.html#stat::st_mode" title='stat::st_mode' data-ref="stat::st_mode" data-ref-filename="stat..st_mode">st_mode</a>, <a class="local col7 ref" href="#507sb" title='sb' data-ref="507sb" data-ref-filename="507sb">sb</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/stat.h.html#stat::st_uid" title='stat::st_uid' data-ref="stat::st_uid" data-ref-filename="stat..st_uid">st_uid</a>, <a class="local col7 ref" href="#507sb" title='sb' data-ref="507sb" data-ref-filename="507sb">sb</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/stat.h.html#stat::st_gid" title='stat::st_gid' data-ref="stat::st_gid" data-ref-filename="stat..st_gid">st_gid</a>);</td></tr>
<tr><th id="4748">4748</th><td><u>#<span data-ppcond="4740">endif</span></u></td></tr>
<tr><th id="4749">4749</th><td>                <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::ts" title='request_state::ts' data-ref="request_state::ts" data-ref-filename="request_state..ts">ts</a> = <a class="enum" href="uds_daemon.h.html#t_error" title='t_error' data-ref="t_error" data-ref-filename="t_error">t_error</a>;</td></tr>
<tr><th id="4750">4750</th><td>                <b>return</b>;</td></tr>
<tr><th id="4751">4751</th><td>            }</td></tr>
<tr><th id="4752">4752</th><td></td></tr>
<tr><th id="4753">4753</th><td><u>#<span data-ppcond="4753">if</span> !defined(<span class="macro" data-ref="_M/USE_TCP_LOOPBACK">USE_TCP_LOOPBACK</span>)</u></td></tr>
<tr><th id="4754">4754</th><td><dfn class="lbl" id="506got_errfd" data-ref="506got_errfd" data-ref-filename="506got_errfd">got_errfd</dfn>:</td></tr>
<tr><th id="4755">4755</th><td><u>#<span data-ppcond="4753">endif</span></u></td></tr>
<tr><th id="4756">4756</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: Result code socket %d created %08X %08X&quot;, req-&gt;sd, req-&gt;errsd, req-&gt;hdr.client_context.u32[1], req-&gt;hdr.client_context.u32[0]);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: Result code socket %d created %08X %08X"</q>, <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::errsd" title='request_state::errsd' data-ref="request_state::errsd" data-ref-filename="request_state..errsd">errsd</a>, <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::client_context" title='(anonymous struct)::client_context' data-ref="(anonymous)::client_context" data-ref-filename="(anonymous)..client_context">client_context</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::u32" title='(anonymous union)::u32' data-ref="(anonymous)::u32" data-ref-filename="(anonymous)..u32">u32</a>[<var>1</var>], <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::client_context" title='(anonymous struct)::client_context' data-ref="(anonymous)::client_context" data-ref-filename="(anonymous)..client_context">client_context</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::u32" title='(anonymous union)::u32' data-ref="(anonymous)::u32" data-ref-filename="(anonymous)..u32">u32</a>[<var>0</var>]);</td></tr>
<tr><th id="4757">4757</th><td><u>#<span data-ppcond="4757">if</span> defined(<span class="macro" data-ref="_M/_WIN32">_WIN32</span>)</u></td></tr>
<tr><th id="4758">4758</th><td>            <b>if</b> (ioctlsocket(req-&gt;errsd, FIONBIO, &amp;opt) != <var>0</var>)</td></tr>
<tr><th id="4759">4759</th><td><u>#<span data-ppcond="4757">else</span></u></td></tr>
<tr><th id="4760">4760</th><td>            <b>if</b> (<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/fcntl.h.html#fcntl" title='fcntl' data-ref="fcntl" data-ref-filename="fcntl">fcntl</a>(<a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::errsd" title='request_state::errsd' data-ref="request_state::errsd" data-ref-filename="request_state..errsd">errsd</a>, <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/fcntl.h.html#181" title="4" data-ref="_M/F_SETFL">F_SETFL</a>, <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/fcntl.h.html#fcntl" title='fcntl' data-ref="fcntl" data-ref-filename="fcntl">fcntl</a>(<a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::errsd" title='request_state::errsd' data-ref="request_state::errsd" data-ref-filename="request_state..errsd">errsd</a>, <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/fcntl.h.html#180" title="3" data-ref="_M/F_GETFL">F_GETFL</a>, <var>0</var>) | <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/fcntl.h.html#81" title="0x00000004" data-ref="_M/O_NONBLOCK">O_NONBLOCK</a>) != <var>0</var>)</td></tr>
<tr><th id="4761">4761</th><td><u>#<span data-ppcond="4757">endif</span></u></td></tr>
<tr><th id="4762">4762</th><td>            {</td></tr>
<tr><th id="4763">4763</th><td>                <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: ERROR: could not set control socket to non-blocking mode errno %d (%s)&quot;, req-&gt;sd, (*__errno()), strerror((*__errno())))" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: ERROR: could not set control socket to non-blocking mode errno %d (%s)"</q>,</td></tr>
<tr><th id="4764">4764</th><td>                       <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="macro" href="dnssd_ipc.h.html#71" title="(*__errno())" data-ref="_M/dnssd_errno">dnssd_errno</a>, <a class="macro" href="dnssd_ipc.h.html#72" title="strerror((*__errno()))" data-ref="_M/dnssd_strerror">dnssd_strerror</a>(<a class="macro" href="dnssd_ipc.h.html#71" title="(*__errno())" data-ref="_M/dnssd_errno">dnssd_errno</a>));</td></tr>
<tr><th id="4765">4765</th><td>                <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::ts" title='request_state::ts' data-ref="request_state::ts" data-ref-filename="request_state..ts">ts</a> = <a class="enum" href="uds_daemon.h.html#t_error" title='t_error' data-ref="t_error" data-ref-filename="t_error">t_error</a>;</td></tr>
<tr><th id="4766">4766</th><td>                <b>return</b>;</td></tr>
<tr><th id="4767">4767</th><td>            }</td></tr>
<tr><th id="4768">4768</th><td>        }</td></tr>
<tr><th id="4769">4769</th><td></td></tr>
<tr><th id="4770">4770</th><td>        <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::ts" title='request_state::ts' data-ref="request_state::ts" data-ref-filename="request_state..ts">ts</a> = <a class="enum" href="uds_daemon.h.html#t_complete" title='t_complete' data-ref="t_complete" data-ref-filename="t_complete">t_complete</a>;</td></tr>
<tr><th id="4771">4771</th><td>    }</td></tr>
<tr><th id="4772">4772</th><td></td></tr>
<tr><th id="4773">4773</th><td>    <b>return</b>;</td></tr>
<tr><th id="4774">4774</th><td></td></tr>
<tr><th id="4775">4775</th><td><dfn class="lbl" id="495rerror" data-ref="495rerror" data-ref-filename="495rerror">rerror</dfn>:</td></tr>
<tr><th id="4776">4776</th><td>    <b>if</b> (<a class="macro" href="dnssd_ipc.h.html#71" title="(*__errno())" data-ref="_M/dnssd_errno">dnssd_errno</a> == <a class="macro" href="dnssd_ipc.h.html#65" title="35" data-ref="_M/dnssd_EWOULDBLOCK">dnssd_EWOULDBLOCK</a> || <a class="macro" href="dnssd_ipc.h.html#71" title="(*__errno())" data-ref="_M/dnssd_errno">dnssd_errno</a> == <a class="macro" href="dnssd_ipc.h.html#66" title="4" data-ref="_M/dnssd_EINTR">dnssd_EINTR</a>) <b>return</b>;</td></tr>
<tr><th id="4777">4777</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: ERROR: read_msg errno %d (%s)&quot;, req-&gt;sd, (*__errno()), strerror((*__errno())))" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: ERROR: read_msg errno %d (%s)"</q>, <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="macro" href="dnssd_ipc.h.html#71" title="(*__errno())" data-ref="_M/dnssd_errno">dnssd_errno</a>, <a class="macro" href="dnssd_ipc.h.html#72" title="strerror((*__errno()))" data-ref="_M/dnssd_strerror">dnssd_strerror</a>(<a class="macro" href="dnssd_ipc.h.html#71" title="(*__errno())" data-ref="_M/dnssd_errno">dnssd_errno</a>));</td></tr>
<tr><th id="4778">4778</th><td>    <a class="local col2 ref" href="#492req" title='req' data-ref="492req" data-ref-filename="492req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::ts" title='request_state::ts' data-ref="request_state::ts" data-ref-filename="request_state..ts">ts</a> = <a class="enum" href="uds_daemon.h.html#t_error" title='t_error' data-ref="t_error" data-ref-filename="t_error">t_error</a>;</td></tr>
<tr><th id="4779">4779</th><td>}</td></tr>
<tr><th id="4780">4780</th><td></td></tr>
<tr><th id="4781">4781</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="decl def fn" id="handle_client_request" title='handle_client_request' data-ref="handle_client_request" data-ref-filename="handle_client_request">handle_client_request</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col8 decl" id="508req" title='req' data-type='request_state *' data-ref="508req" data-ref-filename="508req">req</dfn>)</td></tr>
<tr><th id="4782">4782</th><td>{</td></tr>
<tr><th id="4783">4783</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="local col9 decl" id="509err" title='err' data-type='mStatus' data-ref="509err" data-ref-filename="509err">err</dfn> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_NoError" title='mStatus_NoError' data-ref="mStatus_NoError" data-ref-filename="mStatus_NoError">mStatus_NoError</a>;</td></tr>
<tr><th id="4784">4784</th><td>    <b>switch</b>(<a class="local col8 ref" href="#508req" title='req' data-ref="508req" data-ref-filename="508req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::op" title='(anonymous struct)::op' data-ref="(anonymous)::op" data-ref-filename="(anonymous)..op">op</a>)</td></tr>
<tr><th id="4785">4785</th><td>    {</td></tr>
<tr><th id="4786">4786</th><td>            <i>// These are all operations that have their own first-class request_state object</i></td></tr>
<tr><th id="4787">4787</th><td>        <b>case</b> <a class="enum" href="dnssd_ipc.h.html#connection_request" title='connection_request' data-ref="connection_request" data-ref-filename="connection_request">connection_request</a>:</td></tr>
<tr><th id="4788">4788</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: DNSServiceCreateConnection START PID[%d](%s)&quot;, req-&gt;sd, req-&gt;process_id, req-&gt;pid_name);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: DNSServiceCreateConnection START PID[%d](%s)"</q>,</td></tr>
<tr><th id="4789">4789</th><td>                         <a class="local col8 ref" href="#508req" title='req' data-ref="508req" data-ref-filename="508req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col8 ref" href="#508req" title='req' data-ref="508req" data-ref-filename="508req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col8 ref" href="#508req" title='req' data-ref="508req" data-ref-filename="508req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="4790">4790</th><td>            <a class="local col8 ref" href="#508req" title='req' data-ref="508req" data-ref-filename="508req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> = <a class="ref fn" href="#connection_termination" title='connection_termination' data-ref="connection_termination" data-ref-filename="connection_termination">connection_termination</a>;</td></tr>
<tr><th id="4791">4791</th><td>            <b>break</b>;</td></tr>
<tr><th id="4792">4792</th><td>        <b>case</b> <a class="enum" href="dnssd_ipc.h.html#connection_delegate_request" title='connection_delegate_request' data-ref="connection_delegate_request" data-ref-filename="connection_delegate_request">connection_delegate_request</a>:</td></tr>
<tr><th id="4793">4793</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: DNSServiceCreateDelegateConnection START PID[%d](%s)&quot;, req-&gt;sd, req-&gt;process_id, req-&gt;pid_name);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: DNSServiceCreateDelegateConnection START PID[%d](%s)"</q>,</td></tr>
<tr><th id="4794">4794</th><td>                         <a class="local col8 ref" href="#508req" title='req' data-ref="508req" data-ref-filename="508req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col8 ref" href="#508req" title='req' data-ref="508req" data-ref-filename="508req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col8 ref" href="#508req" title='req' data-ref="508req" data-ref-filename="508req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="4795">4795</th><td>            <a class="local col8 ref" href="#508req" title='req' data-ref="508req" data-ref-filename="508req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> = <a class="ref fn" href="#connection_termination" title='connection_termination' data-ref="connection_termination" data-ref-filename="connection_termination">connection_termination</a>;</td></tr>
<tr><th id="4796">4796</th><td>            <a class="ref fn" href="#handle_connection_delegate_request" title='handle_connection_delegate_request' data-ref="handle_connection_delegate_request" data-ref-filename="handle_connection_delegate_request">handle_connection_delegate_request</a>(<a class="local col8 ref" href="#508req" title='req' data-ref="508req" data-ref-filename="508req">req</a>);</td></tr>
<tr><th id="4797">4797</th><td>            <b>break</b>;</td></tr>
<tr><th id="4798">4798</th><td>        <b>case</b> <a class="enum" href="dnssd_ipc.h.html#resolve_request" title='resolve_request' data-ref="resolve_request" data-ref-filename="resolve_request">resolve_request</a>:              <a class="local col9 ref" href="#509err" title='err' data-ref="509err" data-ref-filename="509err">err</a> = <a class="ref fn" href="#handle_resolve_request" title='handle_resolve_request' data-ref="handle_resolve_request" data-ref-filename="handle_resolve_request">handle_resolve_request</a>     (<a class="local col8 ref" href="#508req" title='req' data-ref="508req" data-ref-filename="508req">req</a>);  <b>break</b>;</td></tr>
<tr><th id="4799">4799</th><td>        <b>case</b> <a class="enum" href="dnssd_ipc.h.html#query_request" title='query_request' data-ref="query_request" data-ref-filename="query_request">query_request</a>:                <a class="local col9 ref" href="#509err" title='err' data-ref="509err" data-ref-filename="509err">err</a> = <a class="ref fn" href="#handle_queryrecord_request" title='handle_queryrecord_request' data-ref="handle_queryrecord_request" data-ref-filename="handle_queryrecord_request">handle_queryrecord_request</a> (<a class="local col8 ref" href="#508req" title='req' data-ref="508req" data-ref-filename="508req">req</a>);  <b>break</b>;</td></tr>
<tr><th id="4800">4800</th><td>        <b>case</b> <a class="enum" href="dnssd_ipc.h.html#browse_request" title='browse_request' data-ref="browse_request" data-ref-filename="browse_request">browse_request</a>:               <a class="local col9 ref" href="#509err" title='err' data-ref="509err" data-ref-filename="509err">err</a> = <a class="ref fn" href="#handle_browse_request" title='handle_browse_request' data-ref="handle_browse_request" data-ref-filename="handle_browse_request">handle_browse_request</a>      (<a class="local col8 ref" href="#508req" title='req' data-ref="508req" data-ref-filename="508req">req</a>);  <b>break</b>;</td></tr>
<tr><th id="4801">4801</th><td>        <b>case</b> <a class="enum" href="dnssd_ipc.h.html#reg_service_request" title='reg_service_request' data-ref="reg_service_request" data-ref-filename="reg_service_request">reg_service_request</a>:          <a class="local col9 ref" href="#509err" title='err' data-ref="509err" data-ref-filename="509err">err</a> = <a class="ref fn" href="#handle_regservice_request" title='handle_regservice_request' data-ref="handle_regservice_request" data-ref-filename="handle_regservice_request">handle_regservice_request</a>  (<a class="local col8 ref" href="#508req" title='req' data-ref="508req" data-ref-filename="508req">req</a>);  <b>break</b>;</td></tr>
<tr><th id="4802">4802</th><td>        <b>case</b> <a class="enum" href="dnssd_ipc.h.html#enumeration_request" title='enumeration_request' data-ref="enumeration_request" data-ref-filename="enumeration_request">enumeration_request</a>:          <a class="local col9 ref" href="#509err" title='err' data-ref="509err" data-ref-filename="509err">err</a> = <a class="ref fn" href="#handle_enum_request" title='handle_enum_request' data-ref="handle_enum_request" data-ref-filename="handle_enum_request">handle_enum_request</a>        (<a class="local col8 ref" href="#508req" title='req' data-ref="508req" data-ref-filename="508req">req</a>);  <b>break</b>;</td></tr>
<tr><th id="4803">4803</th><td>        <b>case</b> <a class="enum" href="dnssd_ipc.h.html#reconfirm_record_request" title='reconfirm_record_request' data-ref="reconfirm_record_request" data-ref-filename="reconfirm_record_request">reconfirm_record_request</a>:     <a class="local col9 ref" href="#509err" title='err' data-ref="509err" data-ref-filename="509err">err</a> = <a class="ref fn" href="#handle_reconfirm_request" title='handle_reconfirm_request' data-ref="handle_reconfirm_request" data-ref-filename="handle_reconfirm_request">handle_reconfirm_request</a>   (<a class="local col8 ref" href="#508req" title='req' data-ref="508req" data-ref-filename="508req">req</a>);  <b>break</b>;</td></tr>
<tr><th id="4804">4804</th><td>        <b>case</b> <a class="enum" href="dnssd_ipc.h.html#setdomain_request" title='setdomain_request' data-ref="setdomain_request" data-ref-filename="setdomain_request">setdomain_request</a>:            <a class="local col9 ref" href="#509err" title='err' data-ref="509err" data-ref-filename="509err">err</a> = <a class="ref fn" href="#handle_setdomain_request" title='handle_setdomain_request' data-ref="handle_setdomain_request" data-ref-filename="handle_setdomain_request">handle_setdomain_request</a>   (<a class="local col8 ref" href="#508req" title='req' data-ref="508req" data-ref-filename="508req">req</a>);  <b>break</b>;</td></tr>
<tr><th id="4805">4805</th><td>        <b>case</b> <a class="enum" href="dnssd_ipc.h.html#getproperty_request" title='getproperty_request' data-ref="getproperty_request" data-ref-filename="getproperty_request">getproperty_request</a>:                <a class="ref fn" href="#handle_getproperty_request" title='handle_getproperty_request' data-ref="handle_getproperty_request" data-ref-filename="handle_getproperty_request">handle_getproperty_request</a> (<a class="local col8 ref" href="#508req" title='req' data-ref="508req" data-ref-filename="508req">req</a>);  <b>break</b>;</td></tr>
<tr><th id="4806">4806</th><td>        <b>case</b> <a class="enum" href="dnssd_ipc.h.html#getpid_request" title='getpid_request' data-ref="getpid_request" data-ref-filename="getpid_request">getpid_request</a>:                     <a class="ref fn" href="#handle_getpid_request" title='handle_getpid_request' data-ref="handle_getpid_request" data-ref-filename="handle_getpid_request">handle_getpid_request</a>      (<a class="local col8 ref" href="#508req" title='req' data-ref="508req" data-ref-filename="508req">req</a>);  <b>break</b>;</td></tr>
<tr><th id="4807">4807</th><td>        <b>case</b> <a class="enum" href="dnssd_ipc.h.html#port_mapping_request" title='port_mapping_request' data-ref="port_mapping_request" data-ref-filename="port_mapping_request">port_mapping_request</a>:         <a class="local col9 ref" href="#509err" title='err' data-ref="509err" data-ref-filename="509err">err</a> = <a class="ref fn" href="#handle_port_mapping_request" title='handle_port_mapping_request' data-ref="handle_port_mapping_request" data-ref-filename="handle_port_mapping_request">handle_port_mapping_request</a>(<a class="local col8 ref" href="#508req" title='req' data-ref="508req" data-ref-filename="508req">req</a>);  <b>break</b>;</td></tr>
<tr><th id="4808">4808</th><td>        <b>case</b> <a class="enum" href="dnssd_ipc.h.html#addrinfo_request" title='addrinfo_request' data-ref="addrinfo_request" data-ref-filename="addrinfo_request">addrinfo_request</a>:             <a class="local col9 ref" href="#509err" title='err' data-ref="509err" data-ref-filename="509err">err</a> = <a class="ref fn" href="#handle_addrinfo_request" title='handle_addrinfo_request' data-ref="handle_addrinfo_request" data-ref-filename="handle_addrinfo_request">handle_addrinfo_request</a>    (<a class="local col8 ref" href="#508req" title='req' data-ref="508req" data-ref-filename="508req">req</a>);  <b>break</b>;</td></tr>
<tr><th id="4809">4809</th><td>        <b>case</b> <a class="enum" href="dnssd_ipc.h.html#send_bpf" title='send_bpf' data-ref="send_bpf" data-ref-filename="send_bpf">send_bpf</a>:                     <i>/* Do nothing for send_bpf */</i>            <b>break</b>;</td></tr>
<tr><th id="4810">4810</th><td></td></tr>
<tr><th id="4811">4811</th><td>            <i>// These are all operations that work with an existing request_state object</i></td></tr>
<tr><th id="4812">4812</th><td>        <b>case</b> <a class="enum" href="dnssd_ipc.h.html#reg_record_request" title='reg_record_request' data-ref="reg_record_request" data-ref-filename="reg_record_request">reg_record_request</a>:           <a class="local col9 ref" href="#509err" title='err' data-ref="509err" data-ref-filename="509err">err</a> = <a class="ref fn" href="#handle_regrecord_request" title='handle_regrecord_request' data-ref="handle_regrecord_request" data-ref-filename="handle_regrecord_request">handle_regrecord_request</a>   (<a class="local col8 ref" href="#508req" title='req' data-ref="508req" data-ref-filename="508req">req</a>);  <b>break</b>;</td></tr>
<tr><th id="4813">4813</th><td>        <b>case</b> <a class="enum" href="dnssd_ipc.h.html#add_record_request" title='add_record_request' data-ref="add_record_request" data-ref-filename="add_record_request">add_record_request</a>:           <a class="local col9 ref" href="#509err" title='err' data-ref="509err" data-ref-filename="509err">err</a> = <a class="ref fn" href="#handle_add_request" title='handle_add_request' data-ref="handle_add_request" data-ref-filename="handle_add_request">handle_add_request</a>         (<a class="local col8 ref" href="#508req" title='req' data-ref="508req" data-ref-filename="508req">req</a>);  <b>break</b>;</td></tr>
<tr><th id="4814">4814</th><td>        <b>case</b> <a class="enum" href="dnssd_ipc.h.html#update_record_request" title='update_record_request' data-ref="update_record_request" data-ref-filename="update_record_request">update_record_request</a>:        <a class="local col9 ref" href="#509err" title='err' data-ref="509err" data-ref-filename="509err">err</a> = <a class="ref fn" href="#handle_update_request" title='handle_update_request' data-ref="handle_update_request" data-ref-filename="handle_update_request">handle_update_request</a>      (<a class="local col8 ref" href="#508req" title='req' data-ref="508req" data-ref-filename="508req">req</a>);  <b>break</b>;</td></tr>
<tr><th id="4815">4815</th><td>        <b>case</b> <a class="enum" href="dnssd_ipc.h.html#remove_record_request" title='remove_record_request' data-ref="remove_record_request" data-ref-filename="remove_record_request">remove_record_request</a>:        <a class="local col9 ref" href="#509err" title='err' data-ref="509err" data-ref-filename="509err">err</a> = <a class="ref fn" href="#handle_removerecord_request" title='handle_removerecord_request' data-ref="handle_removerecord_request" data-ref-filename="handle_removerecord_request">handle_removerecord_request</a>(<a class="local col8 ref" href="#508req" title='req' data-ref="508req" data-ref-filename="508req">req</a>);  <b>break</b>;</td></tr>
<tr><th id="4816">4816</th><td>        <b>case</b> <a class="enum" href="dnssd_ipc.h.html#cancel_request" title='cancel_request' data-ref="cancel_request" data-ref-filename="cancel_request">cancel_request</a>:                     <a class="ref fn" href="#handle_cancel_request" title='handle_cancel_request' data-ref="handle_cancel_request" data-ref-filename="handle_cancel_request">handle_cancel_request</a>      (<a class="local col8 ref" href="#508req" title='req' data-ref="508req" data-ref-filename="508req">req</a>);  <b>break</b>;</td></tr>
<tr><th id="4817">4817</th><td>        <b>case</b> <a class="enum" href="dnssd_ipc.h.html#release_request" title='release_request' data-ref="release_request" data-ref-filename="release_request">release_request</a>:              <a class="local col9 ref" href="#509err" title='err' data-ref="509err" data-ref-filename="509err">err</a> = <a class="ref fn" href="#handle_release_request" title='handle_release_request' data-ref="handle_release_request" data-ref-filename="handle_release_request">handle_release_request</a>     (<a class="local col8 ref" href="#508req" title='req' data-ref="508req" data-ref-filename="508req">req</a>);  <b>break</b>;</td></tr>
<tr><th id="4818">4818</th><td>        <b>default</b>: <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;request_callback: %3d:ERROR: Unsupported UDS req:%d PID[%d][%s]&quot;, req-&gt;sd, req-&gt;hdr.op, req-&gt;process_id, req-&gt;pid_name)" data-ref="_M/LogMsg">LogMsg</a>(<q>"request_callback: %3d:ERROR: Unsupported UDS req:%d PID[%d][%s]"</q>,</td></tr>
<tr><th id="4819">4819</th><td>                        <a class="local col8 ref" href="#508req" title='req' data-ref="508req" data-ref-filename="508req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col8 ref" href="#508req" title='req' data-ref="508req" data-ref-filename="508req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::op" title='(anonymous struct)::op' data-ref="(anonymous)::op" data-ref-filename="(anonymous)..op">op</a>, <a class="local col8 ref" href="#508req" title='req' data-ref="508req" data-ref-filename="508req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col8 ref" href="#508req" title='req' data-ref="508req" data-ref-filename="508req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="4820">4820</th><td>            <a class="local col9 ref" href="#509err" title='err' data-ref="509err" data-ref-filename="509err">err</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_BadParamErr" title='mStatus_BadParamErr' data-ref="mStatus_BadParamErr" data-ref-filename="mStatus_BadParamErr">mStatus_BadParamErr</a>;</td></tr>
<tr><th id="4821">4821</th><td>            <b>break</b>;</td></tr>
<tr><th id="4822">4822</th><td>    }</td></tr>
<tr><th id="4823">4823</th><td></td></tr>
<tr><th id="4824">4824</th><td>    <b>return</b> <a class="local col9 ref" href="#509err" title='err' data-ref="509err" data-ref-filename="509err">err</a>;</td></tr>
<tr><th id="4825">4825</th><td>}</td></tr>
<tr><th id="4826">4826</th><td></td></tr>
<tr><th id="4827">4827</th><td><u>#define <dfn class="macro" id="_M/RecordOrientedOp" data-ref="_M/RecordOrientedOp">RecordOrientedOp</dfn>(X) \</u></td></tr>
<tr><th id="4828">4828</th><td><u>    ((X) == <a class="enum" href="dnssd_ipc.h.html#reg_record_request" title='reg_record_request' data-ref="reg_record_request" data-ref-filename="reg_record_request">reg_record_request</a> || (X) == <a class="enum" href="dnssd_ipc.h.html#add_record_request" title='add_record_request' data-ref="add_record_request" data-ref-filename="add_record_request">add_record_request</a> || (X) == <a class="enum" href="dnssd_ipc.h.html#update_record_request" title='update_record_request' data-ref="update_record_request" data-ref-filename="update_record_request">update_record_request</a> || (X) == <a class="enum" href="dnssd_ipc.h.html#remove_record_request" title='remove_record_request' data-ref="remove_record_request" data-ref-filename="remove_record_request">remove_record_request</a>)</u></td></tr>
<tr><th id="4829">4829</th><td></td></tr>
<tr><th id="4830">4830</th><td><i>// The lightweight operations are the ones that don't need a dedicated request_state structure allocated for them</i></td></tr>
<tr><th id="4831">4831</th><td><u>#define <dfn class="macro" id="_M/LightweightOp" data-ref="_M/LightweightOp">LightweightOp</dfn>(X) (RecordOrientedOp(X) || (X) == <a class="enum" href="dnssd_ipc.h.html#cancel_request" title='cancel_request' data-ref="cancel_request" data-ref-filename="cancel_request">cancel_request</a>)</u></td></tr>
<tr><th id="4832">4832</th><td></td></tr>
<tr><th id="4833">4833</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="request_callback" title='request_callback' data-ref="request_callback" data-ref-filename="request_callback">request_callback</dfn>(<em>int</em> <dfn class="local col0 decl" id="510fd" title='fd' data-type='int' data-ref="510fd" data-ref-filename="510fd">fd</dfn>, <em>short</em> <dfn class="local col1 decl" id="511filter" title='filter' data-type='short' data-ref="511filter" data-ref-filename="511filter">filter</dfn>, <em>void</em> *<dfn class="local col2 decl" id="512info" title='info' data-type='void *' data-ref="512info" data-ref-filename="512info">info</dfn>)</td></tr>
<tr><th id="4834">4834</th><td>{</td></tr>
<tr><th id="4835">4835</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="local col3 decl" id="513err" title='err' data-type='mStatus' data-ref="513err" data-ref-filename="513err">err</dfn> = <var>0</var>;</td></tr>
<tr><th id="4836">4836</th><td>    <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col4 decl" id="514req" title='req' data-type='request_state *' data-ref="514req" data-ref-filename="514req">req</dfn> = <a class="local col2 ref" href="#512info" title='info' data-ref="512info" data-ref-filename="512info">info</a>;</td></tr>
<tr><th id="4837">4837</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSs32" title='mDNSs32' data-type='int' data-ref="mDNSs32" data-ref-filename="mDNSs32">mDNSs32</a> <dfn class="local col5 decl" id="515min_size" title='min_size' data-type='mDNSs32' data-ref="515min_size" data-ref-filename="515min_size">min_size</dfn> = <b>sizeof</b>(<a class="typedef" href="dns_sd.h.html#DNSServiceFlags" title='DNSServiceFlags' data-type='uint32_t' data-ref="DNSServiceFlags" data-ref-filename="DNSServiceFlags">DNSServiceFlags</a>);</td></tr>
<tr><th id="4838">4838</th><td>    (<em>void</em>)<a class="local col0 ref" href="#510fd" title='fd' data-ref="510fd" data-ref-filename="510fd">fd</a>; <i>// Unused</i></td></tr>
<tr><th id="4839">4839</th><td>    (<em>void</em>)<a class="local col1 ref" href="#511filter" title='filter' data-ref="511filter" data-ref-filename="511filter">filter</a>; <i>// Unused</i></td></tr>
<tr><th id="4840">4840</th><td></td></tr>
<tr><th id="4841">4841</th><td>    <b>for</b> (;;)</td></tr>
<tr><th id="4842">4842</th><td>    {</td></tr>
<tr><th id="4843">4843</th><td>        <a class="ref fn" href="#read_msg" title='read_msg' data-ref="read_msg" data-ref-filename="read_msg">read_msg</a>(<a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>);</td></tr>
<tr><th id="4844">4844</th><td>        <b>if</b> (<a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::ts" title='request_state::ts' data-ref="request_state::ts" data-ref-filename="request_state..ts">ts</a> == <a class="enum" href="uds_daemon.h.html#t_morecoming" title='t_morecoming' data-ref="t_morecoming" data-ref-filename="t_morecoming">t_morecoming</a>)</td></tr>
<tr><th id="4845">4845</th><td>            <b>return</b>;</td></tr>
<tr><th id="4846">4846</th><td>        <b>if</b> (<a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::ts" title='request_state::ts' data-ref="request_state::ts" data-ref-filename="request_state..ts">ts</a> == <a class="enum" href="uds_daemon.h.html#t_terminated" title='t_terminated' data-ref="t_terminated" data-ref-filename="t_terminated">t_terminated</a> || <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::ts" title='request_state::ts' data-ref="request_state::ts" data-ref-filename="request_state..ts">ts</a> == <a class="enum" href="uds_daemon.h.html#t_error" title='t_error' data-ref="t_error" data-ref-filename="t_error">t_error</a>)</td></tr>
<tr><th id="4847">4847</th><td>        {</td></tr>
<tr><th id="4848">4848</th><td>            <a class="ref fn" href="#AbortUnlinkAndFree" title='AbortUnlinkAndFree' data-ref="AbortUnlinkAndFree" data-ref-filename="AbortUnlinkAndFree">AbortUnlinkAndFree</a>(<a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>);</td></tr>
<tr><th id="4849">4849</th><td>            <b>return</b>;</td></tr>
<tr><th id="4850">4850</th><td>        }</td></tr>
<tr><th id="4851">4851</th><td>        <b>if</b> (<a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::ts" title='request_state::ts' data-ref="request_state::ts" data-ref-filename="request_state..ts">ts</a> != <a class="enum" href="uds_daemon.h.html#t_complete" title='t_complete' data-ref="t_complete" data-ref-filename="t_complete">t_complete</a>)</td></tr>
<tr><th id="4852">4852</th><td>        {</td></tr>
<tr><th id="4853">4853</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;request_callback: req-&gt;ts %d != t_complete PID[%d][%s]&quot;, req-&gt;ts, req-&gt;process_id, req-&gt;pid_name)" data-ref="_M/LogMsg">LogMsg</a>(<q>"request_callback: req-&gt;ts %d != t_complete PID[%d][%s]"</q>, <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::ts" title='request_state::ts' data-ref="request_state::ts" data-ref-filename="request_state..ts">ts</a>, <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="4854">4854</th><td>            <a class="ref fn" href="#AbortUnlinkAndFree" title='AbortUnlinkAndFree' data-ref="AbortUnlinkAndFree" data-ref-filename="AbortUnlinkAndFree">AbortUnlinkAndFree</a>(<a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>);</td></tr>
<tr><th id="4855">4855</th><td>            <b>return</b>;</td></tr>
<tr><th id="4856">4856</th><td>        }</td></tr>
<tr><th id="4857">4857</th><td></td></tr>
<tr><th id="4858">4858</th><td>        <b>switch</b>(<a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::op" title='(anonymous struct)::op' data-ref="(anonymous)::op" data-ref-filename="(anonymous)..op">op</a>)            <i>//          Interface       + other data</i></td></tr>
<tr><th id="4859">4859</th><td>        {</td></tr>
<tr><th id="4860">4860</th><td>            <b>case</b> <a class="enum" href="dnssd_ipc.h.html#connection_request" title='connection_request' data-ref="connection_request" data-ref-filename="connection_request">connection_request</a>:       <a class="local col5 ref" href="#515min_size" title='min_size' data-ref="515min_size" data-ref-filename="515min_size">min_size</a> = <var>0</var>;                                                                           <b>break</b>;</td></tr>
<tr><th id="4861">4861</th><td>            <b>case</b> <a class="enum" href="dnssd_ipc.h.html#connection_delegate_request" title='connection_delegate_request' data-ref="connection_delegate_request" data-ref-filename="connection_delegate_request">connection_delegate_request</a>: <a class="local col5 ref" href="#515min_size" title='min_size' data-ref="515min_size" data-ref-filename="515min_size">min_size</a> = <var>4</var>; <i>/* pid */</i>                                                              <b>break</b>;</td></tr>
<tr><th id="4862">4862</th><td>            <b>case</b> <a class="enum" href="dnssd_ipc.h.html#reg_service_request" title='reg_service_request' data-ref="reg_service_request" data-ref-filename="reg_service_request">reg_service_request</a>:      <a class="local col5 ref" href="#515min_size" title='min_size' data-ref="515min_size" data-ref-filename="515min_size">min_size</a> += <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a>) + <var>4</var> <i>/* name, type, domain, host */</i> + <var>4</var> <i>/* port, textlen */</i>; <b>break</b>;</td></tr>
<tr><th id="4863">4863</th><td>            <b>case</b> <a class="enum" href="dnssd_ipc.h.html#add_record_request" title='add_record_request' data-ref="add_record_request" data-ref-filename="add_record_request">add_record_request</a>:       <a class="local col5 ref" href="#515min_size" title='min_size' data-ref="515min_size" data-ref-filename="515min_size">min_size</a> +=                   <var>4</var> <i>/* type, rdlen */</i>              + <var>4</var> <i>/* ttl */</i>;           <b>break</b>;</td></tr>
<tr><th id="4864">4864</th><td>            <b>case</b> <a class="enum" href="dnssd_ipc.h.html#update_record_request" title='update_record_request' data-ref="update_record_request" data-ref-filename="update_record_request">update_record_request</a>:    <a class="local col5 ref" href="#515min_size" title='min_size' data-ref="515min_size" data-ref-filename="515min_size">min_size</a> +=                   <var>2</var> <i>/* rdlen */</i>                    + <var>4</var> <i>/* ttl */</i>;           <b>break</b>;</td></tr>
<tr><th id="4865">4865</th><td>            <b>case</b> <a class="enum" href="dnssd_ipc.h.html#remove_record_request" title='remove_record_request' data-ref="remove_record_request" data-ref-filename="remove_record_request">remove_record_request</a>:                                                                                            <b>break</b>;</td></tr>
<tr><th id="4866">4866</th><td>            <b>case</b> <a class="enum" href="dnssd_ipc.h.html#browse_request" title='browse_request' data-ref="browse_request" data-ref-filename="browse_request">browse_request</a>:           <a class="local col5 ref" href="#515min_size" title='min_size' data-ref="515min_size" data-ref-filename="515min_size">min_size</a> += <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a>) + <var>2</var> <i>/* type, domain */</i>;                                     <b>break</b>;</td></tr>
<tr><th id="4867">4867</th><td>            <b>case</b> <a class="enum" href="dnssd_ipc.h.html#resolve_request" title='resolve_request' data-ref="resolve_request" data-ref-filename="resolve_request">resolve_request</a>:          <a class="local col5 ref" href="#515min_size" title='min_size' data-ref="515min_size" data-ref-filename="515min_size">min_size</a> += <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a>) + <var>3</var> <i>/* type, type, domain */</i>;                               <b>break</b>;</td></tr>
<tr><th id="4868">4868</th><td>            <b>case</b> <a class="enum" href="dnssd_ipc.h.html#query_request" title='query_request' data-ref="query_request" data-ref-filename="query_request">query_request</a>:            <a class="local col5 ref" href="#515min_size" title='min_size' data-ref="515min_size" data-ref-filename="515min_size">min_size</a> += <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a>) + <var>1</var> <i>/* name */</i>                     + <var>4</var> <i>/* type, class*/</i>;    <b>break</b>;</td></tr>
<tr><th id="4869">4869</th><td>            <b>case</b> <a class="enum" href="dnssd_ipc.h.html#enumeration_request" title='enumeration_request' data-ref="enumeration_request" data-ref-filename="enumeration_request">enumeration_request</a>:      <a class="local col5 ref" href="#515min_size" title='min_size' data-ref="515min_size" data-ref-filename="515min_size">min_size</a> += <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a>);                                                            <b>break</b>;</td></tr>
<tr><th id="4870">4870</th><td>            <b>case</b> <a class="enum" href="dnssd_ipc.h.html#reg_record_request" title='reg_record_request' data-ref="reg_record_request" data-ref-filename="reg_record_request">reg_record_request</a>:       <a class="local col5 ref" href="#515min_size" title='min_size' data-ref="515min_size" data-ref-filename="515min_size">min_size</a> += <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a>) + <var>1</var> <i>/* name */</i> + <var>6</var> <i>/* type, class, rdlen */</i> + <var>4</var> <i>/* ttl */</i>;  <b>break</b>;</td></tr>
<tr><th id="4871">4871</th><td>            <b>case</b> <a class="enum" href="dnssd_ipc.h.html#reconfirm_record_request" title='reconfirm_record_request' data-ref="reconfirm_record_request" data-ref-filename="reconfirm_record_request">reconfirm_record_request</a>: <a class="local col5 ref" href="#515min_size" title='min_size' data-ref="515min_size" data-ref-filename="515min_size">min_size</a> += <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a>) + <var>1</var> <i>/* name */</i> + <var>6</var> <i>/* type, class, rdlen */</i>;                <b>break</b>;</td></tr>
<tr><th id="4872">4872</th><td>            <b>case</b> <a class="enum" href="dnssd_ipc.h.html#setdomain_request" title='setdomain_request' data-ref="setdomain_request" data-ref-filename="setdomain_request">setdomain_request</a>:        <a class="local col5 ref" href="#515min_size" title='min_size' data-ref="515min_size" data-ref-filename="515min_size">min_size</a> +=                   <var>1</var> <i>/* domain */</i>;                                           <b>break</b>;</td></tr>
<tr><th id="4873">4873</th><td>            <b>case</b> <a class="enum" href="dnssd_ipc.h.html#getproperty_request" title='getproperty_request' data-ref="getproperty_request" data-ref-filename="getproperty_request">getproperty_request</a>:      <a class="local col5 ref" href="#515min_size" title='min_size' data-ref="515min_size" data-ref-filename="515min_size">min_size</a> = <var>2</var>;                                                                           <b>break</b>;</td></tr>
<tr><th id="4874">4874</th><td>            <b>case</b> <a class="enum" href="dnssd_ipc.h.html#getpid_request" title='getpid_request' data-ref="getpid_request" data-ref-filename="getpid_request">getpid_request</a>:           <a class="local col5 ref" href="#515min_size" title='min_size' data-ref="515min_size" data-ref-filename="515min_size">min_size</a> = <var>2</var>;                                                                           <b>break</b>;</td></tr>
<tr><th id="4875">4875</th><td>            <b>case</b> <a class="enum" href="dnssd_ipc.h.html#port_mapping_request" title='port_mapping_request' data-ref="port_mapping_request" data-ref-filename="port_mapping_request">port_mapping_request</a>:     <a class="local col5 ref" href="#515min_size" title='min_size' data-ref="515min_size" data-ref-filename="515min_size">min_size</a> += <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a>) + <var>4</var> <i>/* udp/tcp */</i> + <var>4</var> <i>/* int/ext port */</i>    + <var>4</var> <i>/* ttl */</i>;  <b>break</b>;</td></tr>
<tr><th id="4876">4876</th><td>            <b>case</b> <a class="enum" href="dnssd_ipc.h.html#addrinfo_request" title='addrinfo_request' data-ref="addrinfo_request" data-ref-filename="addrinfo_request">addrinfo_request</a>:         <a class="local col5 ref" href="#515min_size" title='min_size' data-ref="515min_size" data-ref-filename="515min_size">min_size</a> += <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a>) + <var>4</var> <i>/* v4/v6 */</i>   + <var>1</var> <i>/* hostname */</i>;                       <b>break</b>;</td></tr>
<tr><th id="4877">4877</th><td>            <b>case</b> <a class="enum" href="dnssd_ipc.h.html#send_bpf" title='send_bpf' data-ref="send_bpf" data-ref-filename="send_bpf">send_bpf</a>:                 <i>// Same as cancel_request below</i></td></tr>
<tr><th id="4878">4878</th><td>            <b>case</b> <a class="enum" href="dnssd_ipc.h.html#cancel_request" title='cancel_request' data-ref="cancel_request" data-ref-filename="cancel_request">cancel_request</a>:           <a class="local col5 ref" href="#515min_size" title='min_size' data-ref="515min_size" data-ref-filename="515min_size">min_size</a> = <var>0</var>;                                                                           <b>break</b>;</td></tr>
<tr><th id="4879">4879</th><td>            <b>case</b> <a class="enum" href="dnssd_ipc.h.html#release_request" title='release_request' data-ref="release_request" data-ref-filename="release_request">release_request</a>:          <a class="local col5 ref" href="#515min_size" title='min_size' data-ref="515min_size" data-ref-filename="515min_size">min_size</a> += <b>sizeof</b>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a>) + <var>3</var> <i>/* type, type, domain */</i>;                               <b>break</b>;</td></tr>
<tr><th id="4880">4880</th><td>            <b>default</b>: <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;request_callback: ERROR: validate_message - unsupported req type: %d PID[%d][%s]&quot;, req-&gt;hdr.op, req-&gt;process_id, req-&gt;pid_name)" data-ref="_M/LogMsg">LogMsg</a>(<q>"request_callback: ERROR: validate_message - unsupported req type: %d PID[%d][%s]"</q>,</td></tr>
<tr><th id="4881">4881</th><td>                            <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::op" title='(anonymous struct)::op' data-ref="(anonymous)::op" data-ref-filename="(anonymous)..op">op</a>, <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="4882">4882</th><td>                     <a class="local col5 ref" href="#515min_size" title='min_size' data-ref="515min_size" data-ref-filename="515min_size">min_size</a> = -<var>1</var>;                                                                                                <b>break</b>;</td></tr>
<tr><th id="4883">4883</th><td>        }</td></tr>
<tr><th id="4884">4884</th><td></td></tr>
<tr><th id="4885">4885</th><td>        <b>if</b> ((<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSs32" title='mDNSs32' data-type='int' data-ref="mDNSs32" data-ref-filename="mDNSs32">mDNSs32</a>)<a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::data_bytes" title='request_state::data_bytes' data-ref="request_state::data_bytes" data-ref-filename="request_state..data_bytes">data_bytes</a> &lt; <a class="local col5 ref" href="#515min_size" title='min_size' data-ref="515min_size" data-ref-filename="515min_size">min_size</a>)</td></tr>
<tr><th id="4886">4886</th><td>        {</td></tr>
<tr><th id="4887">4887</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;request_callback: Invalid message %d bytes; min for %d is %d PID[%d][%s]&quot;, req-&gt;data_bytes, req-&gt;hdr.op, min_size, req-&gt;process_id, req-&gt;pid_name)" data-ref="_M/LogMsg">LogMsg</a>(<q>"request_callback: Invalid message %d bytes; min for %d is %d PID[%d][%s]"</q>,</td></tr>
<tr><th id="4888">4888</th><td>                    <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::data_bytes" title='request_state::data_bytes' data-ref="request_state::data_bytes" data-ref-filename="request_state..data_bytes">data_bytes</a>, <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::op" title='(anonymous struct)::op' data-ref="(anonymous)::op" data-ref-filename="(anonymous)..op">op</a>, <a class="local col5 ref" href="#515min_size" title='min_size' data-ref="515min_size" data-ref-filename="515min_size">min_size</a>, <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="4889">4889</th><td>            <a class="ref fn" href="#AbortUnlinkAndFree" title='AbortUnlinkAndFree' data-ref="AbortUnlinkAndFree" data-ref-filename="AbortUnlinkAndFree">AbortUnlinkAndFree</a>(<a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>);</td></tr>
<tr><th id="4890">4890</th><td>            <b>return</b>;</td></tr>
<tr><th id="4891">4891</th><td>        }</td></tr>
<tr><th id="4892">4892</th><td>        <b>if</b> (<a class="macro" href="#4831" title="(((req-&gt;hdr.op) == reg_record_request || (req-&gt;hdr.op) == add_record_request || (req-&gt;hdr.op) == update_record_request || (req-&gt;hdr.op) == remove_record_request) || (req-&gt;hdr.op) == cancel_request)" data-ref="_M/LightweightOp">LightweightOp</a>(<a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::op" title='(anonymous struct)::op' data-ref="(anonymous)::op" data-ref-filename="(anonymous)..op">op</a>) &amp;&amp; !<a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a>)</td></tr>
<tr><th id="4893">4893</th><td>        {</td></tr>
<tr><th id="4894">4894</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;request_callback: Reg/Add/Update/Remove %d require existing connection PID[%d][%s]&quot;, req-&gt;hdr.op, req-&gt;process_id, req-&gt;pid_name)" data-ref="_M/LogMsg">LogMsg</a>(<q>"request_callback: Reg/Add/Update/Remove %d require existing connection PID[%d][%s]"</q>,</td></tr>
<tr><th id="4895">4895</th><td>                    <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::op" title='(anonymous struct)::op' data-ref="(anonymous)::op" data-ref-filename="(anonymous)..op">op</a>, <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="4896">4896</th><td>            <a class="ref fn" href="#AbortUnlinkAndFree" title='AbortUnlinkAndFree' data-ref="AbortUnlinkAndFree" data-ref-filename="AbortUnlinkAndFree">AbortUnlinkAndFree</a>(<a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>);</td></tr>
<tr><th id="4897">4897</th><td>            <b>return</b>;</td></tr>
<tr><th id="4898">4898</th><td>        }</td></tr>
<tr><th id="4899">4899</th><td></td></tr>
<tr><th id="4900">4900</th><td>        <i>// If req-&gt;terminate is already set, this means this operation is sharing an existing connection</i></td></tr>
<tr><th id="4901">4901</th><td>        <b>if</b> (<a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> &amp;&amp; !<a class="macro" href="#4831" title="(((req-&gt;hdr.op) == reg_record_request || (req-&gt;hdr.op) == add_record_request || (req-&gt;hdr.op) == update_record_request || (req-&gt;hdr.op) == remove_record_request) || (req-&gt;hdr.op) == cancel_request)" data-ref="_M/LightweightOp">LightweightOp</a>(<a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::op" title='(anonymous struct)::op' data-ref="(anonymous)::op" data-ref-filename="(anonymous)..op">op</a>))</td></tr>
<tr><th id="4902">4902</th><td>        {</td></tr>
<tr><th id="4903">4903</th><td>            <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col6 decl" id="516newreq" title='newreq' data-type='request_state *' data-ref="516newreq" data-ref-filename="516newreq">newreq</dfn> = <a class="ref fn" href="#NewRequest" title='NewRequest' data-ref="NewRequest" data-ref-filename="NewRequest">NewRequest</a>();</td></tr>
<tr><th id="4904">4904</th><td>            <a class="local col6 ref" href="#516newreq" title='newreq' data-ref="516newreq" data-ref-filename="516newreq">newreq</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::primary" title='request_state::primary' data-ref="request_state::primary" data-ref-filename="request_state..primary">primary</a> = <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>;</td></tr>
<tr><th id="4905">4905</th><td>            <a class="local col6 ref" href="#516newreq" title='newreq' data-ref="516newreq" data-ref-filename="516newreq">newreq</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>      = <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>;</td></tr>
<tr><th id="4906">4906</th><td>            <a class="local col6 ref" href="#516newreq" title='newreq' data-ref="516newreq" data-ref-filename="516newreq">newreq</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::errsd" title='request_state::errsd' data-ref="request_state::errsd" data-ref-filename="request_state..errsd">errsd</a>   = <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::errsd" title='request_state::errsd' data-ref="request_state::errsd" data-ref-filename="request_state..errsd">errsd</a>;</td></tr>
<tr><th id="4907">4907</th><td>            <a class="local col6 ref" href="#516newreq" title='newreq' data-ref="516newreq" data-ref-filename="516newreq">newreq</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::uid" title='request_state::uid' data-ref="request_state::uid" data-ref-filename="request_state..uid">uid</a>     = <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::uid" title='request_state::uid' data-ref="request_state::uid" data-ref-filename="request_state..uid">uid</a>;</td></tr>
<tr><th id="4908">4908</th><td>            <a class="local col6 ref" href="#516newreq" title='newreq' data-ref="516newreq" data-ref-filename="516newreq">newreq</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>     = <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>;</td></tr>
<tr><th id="4909">4909</th><td>            <a class="local col6 ref" href="#516newreq" title='newreq' data-ref="516newreq" data-ref-filename="516newreq">newreq</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgbuf" title='request_state::msgbuf' data-ref="request_state::msgbuf" data-ref-filename="request_state..msgbuf">msgbuf</a>  = <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgbuf" title='request_state::msgbuf' data-ref="request_state::msgbuf" data-ref-filename="request_state..msgbuf">msgbuf</a>;</td></tr>
<tr><th id="4910">4910</th><td>            <a class="local col6 ref" href="#516newreq" title='newreq' data-ref="516newreq" data-ref-filename="516newreq">newreq</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>  = <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>;</td></tr>
<tr><th id="4911">4911</th><td>            <a class="local col6 ref" href="#516newreq" title='newreq' data-ref="516newreq" data-ref-filename="516newreq">newreq</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>  = <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>;</td></tr>
<tr><th id="4912">4912</th><td>            <i>// if the parent request is a delegate connection, copy the</i></td></tr>
<tr><th id="4913">4913</th><td><i>            // relevant bits</i></td></tr>
<tr><th id="4914">4914</th><td>            <b>if</b> (<a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::validUUID" title='request_state::validUUID' data-ref="request_state::validUUID" data-ref-filename="request_state..validUUID">validUUID</a>)</td></tr>
<tr><th id="4915">4915</th><td>            {</td></tr>
<tr><th id="4916">4916</th><td>                <a class="local col6 ref" href="#516newreq" title='newreq' data-ref="516newreq" data-ref-filename="516newreq">newreq</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::validUUID" title='request_state::validUUID' data-ref="request_state::validUUID" data-ref-filename="request_state..validUUID">validUUID</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>;</td></tr>
<tr><th id="4917">4917</th><td>                <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformMemCopy" title='mDNSPlatformMemCopy' data-ref="mDNSPlatformMemCopy" data-ref-filename="mDNSPlatformMemCopy">mDNSPlatformMemCopy</a>(<a class="local col6 ref" href="#516newreq" title='newreq' data-ref="516newreq" data-ref-filename="516newreq">newreq</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::uuid" title='request_state::uuid' data-ref="request_state::uuid" data-ref-filename="request_state..uuid">uuid</a>, <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::uuid" title='request_state::uuid' data-ref="request_state::uuid" data-ref-filename="request_state..uuid">uuid</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#1897" title="16" data-ref="_M/UUID_SIZE">UUID_SIZE</a>);</td></tr>
<tr><th id="4918">4918</th><td>            }</td></tr>
<tr><th id="4919">4919</th><td>            <b>else</b></td></tr>
<tr><th id="4920">4920</th><td>            {</td></tr>
<tr><th id="4921">4921</th><td>                <b>if</b> (<a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>)</td></tr>
<tr><th id="4922">4922</th><td>                {</td></tr>
<tr><th id="4923">4923</th><td>                    <a class="local col6 ref" href="#516newreq" title='newreq' data-ref="516newreq" data-ref-filename="516newreq">newreq</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a> = <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>;</td></tr>
<tr><th id="4924">4924</th><td>                    <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformStrLCopy" title='mDNSPlatformStrLCopy' data-ref="mDNSPlatformStrLCopy" data-ref-filename="mDNSPlatformStrLCopy">mDNSPlatformStrLCopy</a>(<a class="local col6 ref" href="#516newreq" title='newreq' data-ref="516newreq" data-ref-filename="516newreq">newreq</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>, <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>, (<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a>)<b>sizeof</b>(<a class="local col6 ref" href="#516newreq" title='newreq' data-ref="516newreq" data-ref-filename="516newreq">newreq</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>));</td></tr>
<tr><th id="4925">4925</th><td>                }</td></tr>
<tr><th id="4926">4926</th><td>                <b>else</b></td></tr>
<tr><th id="4927">4927</th><td>                {</td></tr>
<tr><th id="4928">4928</th><td>                    <a class="ref fn" href="#set_peer_pid" title='set_peer_pid' data-ref="set_peer_pid" data-ref-filename="set_peer_pid">set_peer_pid</a>(<a class="local col6 ref" href="#516newreq" title='newreq' data-ref="516newreq" data-ref-filename="516newreq">newreq</a>);</td></tr>
<tr><th id="4929">4929</th><td>                }</td></tr>
<tr><th id="4930">4930</th><td>            }</td></tr>
<tr><th id="4931">4931</th><td>            <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a> = <a class="local col6 ref" href="#516newreq" title='newreq' data-ref="516newreq" data-ref-filename="516newreq">newreq</a>;</td></tr>
<tr><th id="4932">4932</th><td>        }</td></tr>
<tr><th id="4933">4933</th><td></td></tr>
<tr><th id="4934">4934</th><td>        <i>// Check if the request wants no asynchronous replies.</i></td></tr>
<tr><th id="4935">4935</th><td>        <b>if</b> (<a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::ipc_flags" title='(anonymous struct)::ipc_flags' data-ref="(anonymous)::ipc_flags" data-ref-filename="(anonymous)..ipc_flags">ipc_flags</a> &amp; <a class="macro" href="dnssd_ipc.h.html#103" title="1" data-ref="_M/IPC_FLAGS_NOREPLY">IPC_FLAGS_NOREPLY</a>) <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::no_reply" title='request_state::no_reply' data-ref="request_state::no_reply" data-ref-filename="request_state..no_reply">no_reply</a> = <var>1</var>;</td></tr>
<tr><th id="4936">4936</th><td></td></tr>
<tr><th id="4937">4937</th><td>        <i>// If we're shutting down, don't allow new client requests</i></td></tr>
<tr><th id="4938">4938</th><td><i>        // We do allow "cancel" and "getproperty" during shutdown</i></td></tr>
<tr><th id="4939">4939</th><td>        <b>if</b> (<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::ShutdownTime" title='mDNS_struct::ShutdownTime' data-ref="mDNS_struct::ShutdownTime" data-ref-filename="mDNS_struct..ShutdownTime">ShutdownTime</a> &amp;&amp; <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::op" title='(anonymous struct)::op' data-ref="(anonymous)::op" data-ref-filename="(anonymous)..op">op</a> != <a class="enum" href="dnssd_ipc.h.html#cancel_request" title='cancel_request' data-ref="cancel_request" data-ref-filename="cancel_request">cancel_request</a> &amp;&amp; <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::op" title='(anonymous struct)::op' data-ref="(anonymous)::op" data-ref-filename="(anonymous)..op">op</a> != <a class="enum" href="dnssd_ipc.h.html#getproperty_request" title='getproperty_request' data-ref="getproperty_request" data-ref-filename="getproperty_request">getproperty_request</a>)</td></tr>
<tr><th id="4940">4940</th><td>            <a class="local col3 ref" href="#513err" title='err' data-ref="513err" data-ref-filename="513err">err</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_ServiceNotRunning" title='mStatus_ServiceNotRunning' data-ref="mStatus_ServiceNotRunning" data-ref-filename="mStatus_ServiceNotRunning">mStatus_ServiceNotRunning</a>;</td></tr>
<tr><th id="4941">4941</th><td>        <b>else</b></td></tr>
<tr><th id="4942">4942</th><td>            <a class="local col3 ref" href="#513err" title='err' data-ref="513err" data-ref-filename="513err">err</a> = <a class="ref fn" href="#handle_client_request" title='handle_client_request' data-ref="handle_client_request" data-ref-filename="handle_client_request">handle_client_request</a>(<a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>);</td></tr>
<tr><th id="4943">4943</th><td></td></tr>
<tr><th id="4944">4944</th><td>        <i>// req-&gt;msgbuf may be NULL, e.g. for connection_request or remove_record_request</i></td></tr>
<tr><th id="4945">4945</th><td>        <b>if</b> (<a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgbuf" title='request_state::msgbuf' data-ref="request_state::msgbuf" data-ref-filename="request_state..msgbuf">msgbuf</a>) <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(req-&gt;msgbuf)" data-ref="_M/freeL">freeL</a>(<q>"request_state msgbuf"</q>, <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgbuf" title='request_state::msgbuf' data-ref="request_state::msgbuf" data-ref-filename="request_state..msgbuf">msgbuf</a>);</td></tr>
<tr><th id="4946">4946</th><td></td></tr>
<tr><th id="4947">4947</th><td>        <i>// There's no return data for a cancel request (DNSServiceRefDeallocate returns no result)</i></td></tr>
<tr><th id="4948">4948</th><td><i>        // For a DNSServiceGetProperty call, the handler already generated the response, so no need to do it again here</i></td></tr>
<tr><th id="4949">4949</th><td>        <b>if</b> (<a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::op" title='(anonymous struct)::op' data-ref="(anonymous)::op" data-ref-filename="(anonymous)..op">op</a> != <a class="enum" href="dnssd_ipc.h.html#cancel_request" title='cancel_request' data-ref="cancel_request" data-ref-filename="cancel_request">cancel_request</a> &amp;&amp; <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::op" title='(anonymous struct)::op' data-ref="(anonymous)::op" data-ref-filename="(anonymous)..op">op</a> != <a class="enum" href="dnssd_ipc.h.html#getproperty_request" title='getproperty_request' data-ref="getproperty_request" data-ref-filename="getproperty_request">getproperty_request</a> &amp;&amp; <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::op" title='(anonymous struct)::op' data-ref="(anonymous)::op" data-ref-filename="(anonymous)..op">op</a> != <a class="enum" href="dnssd_ipc.h.html#send_bpf" title='send_bpf' data-ref="send_bpf" data-ref-filename="send_bpf">send_bpf</a> &amp;&amp; <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::op" title='(anonymous struct)::op' data-ref="(anonymous)::op" data-ref-filename="(anonymous)..op">op</a> != <a class="enum" href="dnssd_ipc.h.html#getpid_request" title='getpid_request' data-ref="getpid_request" data-ref-filename="getpid_request">getpid_request</a>)</td></tr>
<tr><th id="4950">4950</th><td>        {</td></tr>
<tr><th id="4951">4951</th><td>            <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus" title='mStatus' data-type='mDNSs32' data-ref="mStatus" data-ref-filename="mStatus">mStatus</a> <dfn class="local col7 decl" id="517err_netorder" title='err_netorder' data-type='const mStatus' data-ref="517err_netorder" data-ref-filename="517err_netorder">err_netorder</dfn> = <a class="ref fn" href="#dnssd_htonl" title='dnssd_htonl' data-ref="dnssd_htonl" data-ref-filename="dnssd_htonl">dnssd_htonl</a>(<a class="local col3 ref" href="#513err" title='err' data-ref="513err" data-ref-filename="513err">err</a>);</td></tr>
<tr><th id="4952">4952</th><td>            <a class="ref fn" href="#send_all" title='send_all' data-ref="send_all" data-ref-filename="send_all">send_all</a>(<a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::errsd" title='request_state::errsd' data-ref="request_state::errsd" data-ref-filename="request_state..errsd">errsd</a>, (<em>const</em> <em>char</em> *)&amp;<a class="local col7 ref" href="#517err_netorder" title='err_netorder' data-ref="517err_netorder" data-ref-filename="517err_netorder">err_netorder</a>, <b>sizeof</b>(<a class="local col7 ref" href="#517err_netorder" title='err_netorder' data-ref="517err_netorder" data-ref-filename="517err_netorder">err_netorder</a>));</td></tr>
<tr><th id="4953">4953</th><td>            <b>if</b> (<a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::errsd" title='request_state::errsd' data-ref="request_state::errsd" data-ref-filename="request_state..errsd">errsd</a> != <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>)</td></tr>
<tr><th id="4954">4954</th><td>            {</td></tr>
<tr><th id="4955">4955</th><td>                <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: Result code socket %d closed  %08X %08X (%d)&quot;, req-&gt;sd, req-&gt;errsd, req-&gt;hdr.client_context.u32[1], req-&gt;hdr.client_context.u32[0], err);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: Result code socket %d closed  %08X %08X (%d)"</q>,</td></tr>
<tr><th id="4956">4956</th><td>                             <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::errsd" title='request_state::errsd' data-ref="request_state::errsd" data-ref-filename="request_state..errsd">errsd</a>, <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::client_context" title='(anonymous struct)::client_context' data-ref="(anonymous)::client_context" data-ref-filename="(anonymous)..client_context">client_context</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::u32" title='(anonymous union)::u32' data-ref="(anonymous)::u32" data-ref-filename="(anonymous)..u32">u32</a>[<var>1</var>], <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr" title='request_state::hdr' data-ref="request_state::hdr" data-ref-filename="request_state..hdr">hdr</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::client_context" title='(anonymous struct)::client_context' data-ref="(anonymous)::client_context" data-ref-filename="(anonymous)..client_context">client_context</a>.<a class="ref field" href="dnssd_ipc.h.html#(anonymous)::u32" title='(anonymous union)::u32' data-ref="(anonymous)::u32" data-ref-filename="(anonymous)..u32">u32</a>[<var>0</var>], <a class="local col3 ref" href="#513err" title='err' data-ref="513err" data-ref-filename="513err">err</a>);</td></tr>
<tr><th id="4957">4957</th><td>                <a class="macro" href="dnssd_ipc.h.html#70" title="close(req-&gt;errsd)" data-ref="_M/dnssd_close">dnssd_close</a>(<a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::errsd" title='request_state::errsd' data-ref="request_state::errsd" data-ref-filename="request_state..errsd">errsd</a>);</td></tr>
<tr><th id="4958">4958</th><td>                <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::errsd" title='request_state::errsd' data-ref="request_state::errsd" data-ref-filename="request_state..errsd">errsd</a> = <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>;</td></tr>
<tr><th id="4959">4959</th><td>                <i>// Also need to reset the parent's errsd, if this is a subordinate operation</i></td></tr>
<tr><th id="4960">4960</th><td>                <b>if</b> (<a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::primary" title='request_state::primary' data-ref="request_state::primary" data-ref-filename="request_state..primary">primary</a>) <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::primary" title='request_state::primary' data-ref="request_state::primary" data-ref-filename="request_state..primary">primary</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::errsd" title='request_state::errsd' data-ref="request_state::errsd" data-ref-filename="request_state..errsd">errsd</a> = <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::primary" title='request_state::primary' data-ref="request_state::primary" data-ref-filename="request_state..primary">primary</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>;</td></tr>
<tr><th id="4961">4961</th><td>            }</td></tr>
<tr><th id="4962">4962</th><td>        }</td></tr>
<tr><th id="4963">4963</th><td></td></tr>
<tr><th id="4964">4964</th><td>        <i>// Reset ready to accept the next req on this pipe</i></td></tr>
<tr><th id="4965">4965</th><td>        <b>if</b> (<a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::primary" title='request_state::primary' data-ref="request_state::primary" data-ref-filename="request_state..primary">primary</a>) <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a> = <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::primary" title='request_state::primary' data-ref="request_state::primary" data-ref-filename="request_state..primary">primary</a>;</td></tr>
<tr><th id="4966">4966</th><td>        <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::ts" title='request_state::ts' data-ref="request_state::ts" data-ref-filename="request_state..ts">ts</a>         = <a class="enum" href="uds_daemon.h.html#t_morecoming" title='t_morecoming' data-ref="t_morecoming" data-ref-filename="t_morecoming">t_morecoming</a>;</td></tr>
<tr><th id="4967">4967</th><td>        <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::hdr_bytes" title='request_state::hdr_bytes' data-ref="request_state::hdr_bytes" data-ref-filename="request_state..hdr_bytes">hdr_bytes</a>  = <var>0</var>;</td></tr>
<tr><th id="4968">4968</th><td>        <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::data_bytes" title='request_state::data_bytes' data-ref="request_state::data_bytes" data-ref-filename="request_state..data_bytes">data_bytes</a> = <var>0</var>;</td></tr>
<tr><th id="4969">4969</th><td>        <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgbuf" title='request_state::msgbuf' data-ref="request_state::msgbuf" data-ref-filename="request_state..msgbuf">msgbuf</a>     = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="4970">4970</th><td>        <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgptr" title='request_state::msgptr' data-ref="request_state::msgptr" data-ref-filename="request_state..msgptr">msgptr</a>     = <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>;</td></tr>
<tr><th id="4971">4971</th><td>        <a class="local col4 ref" href="#514req" title='req' data-ref="514req" data-ref-filename="514req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::msgend" title='request_state::msgend' data-ref="request_state::msgend" data-ref-filename="request_state..msgend">msgend</a>     = <var>0</var>;</td></tr>
<tr><th id="4972">4972</th><td>    }</td></tr>
<tr><th id="4973">4973</th><td>}</td></tr>
<tr><th id="4974">4974</th><td></td></tr>
<tr><th id="4975">4975</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="connect_callback" title='connect_callback' data-ref="connect_callback" data-ref-filename="connect_callback">connect_callback</dfn>(<em>int</em> <dfn class="local col8 decl" id="518fd" title='fd' data-type='int' data-ref="518fd" data-ref-filename="518fd">fd</dfn>, <em>short</em> <dfn class="local col9 decl" id="519filter" title='filter' data-type='short' data-ref="519filter" data-ref-filename="519filter">filter</dfn>, <em>void</em> *<dfn class="local col0 decl" id="520info" title='info' data-type='void *' data-ref="520info" data-ref-filename="520info">info</dfn>)</td></tr>
<tr><th id="4976">4976</th><td>{</td></tr>
<tr><th id="4977">4977</th><td>    <a class="macro" href="dnssd_ipc.h.html#90" title="struct sockaddr_un" data-ref="_M/dnssd_sockaddr_t">dnssd_sockaddr_t</a> <dfn class="local col1 decl" id="521cliaddr" title='cliaddr' data-type='struct sockaddr_un' data-ref="521cliaddr" data-ref-filename="521cliaddr">cliaddr</dfn>;</td></tr>
<tr><th id="4978">4978</th><td>    <a class="macro" href="dnssd_ipc.h.html#69" title="unsigned int" data-ref="_M/dnssd_socklen_t">dnssd_socklen_t</a> <dfn class="local col2 decl" id="522len" title='len' data-type='unsigned int' data-ref="522len" data-ref-filename="522len">len</dfn> = (<a class="macro" href="dnssd_ipc.h.html#69" title="unsigned int" data-ref="_M/dnssd_socklen_t">dnssd_socklen_t</a>) <b>sizeof</b>(<a class="local col1 ref" href="#521cliaddr" title='cliaddr' data-ref="521cliaddr" data-ref-filename="521cliaddr">cliaddr</a>);</td></tr>
<tr><th id="4979">4979</th><td>    <a class="typedef" href="dns_sd.h.html#dnssd_sock_t" title='dnssd_sock_t' data-type='int' data-ref="dnssd_sock_t" data-ref-filename="dnssd_sock_t">dnssd_sock_t</a> <dfn class="local col3 decl" id="523sd" title='sd' data-type='dnssd_sock_t' data-ref="523sd" data-ref-filename="523sd">sd</dfn> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#accept" title='accept' data-ref="accept" data-ref-filename="accept">accept</a>(<a class="local col8 ref" href="#518fd" title='fd' data-ref="518fd" data-ref-filename="518fd">fd</a>, (<b>struct</b> <a class="type" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#sockaddr" title='sockaddr' data-ref="sockaddr" data-ref-filename="sockaddr">sockaddr</a>*) &amp;<a class="local col1 ref" href="#521cliaddr" title='cliaddr' data-ref="521cliaddr" data-ref-filename="521cliaddr">cliaddr</a>, &amp;<a class="local col2 ref" href="#522len" title='len' data-ref="522len" data-ref-filename="522len">len</a>);</td></tr>
<tr><th id="4980">4980</th><td><u>#<span data-ppcond="4980">if</span> defined(<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#132" data-ref="_M/SO_NOSIGPIPE">SO_NOSIGPIPE</a>) || defined(<span class="macro" data-ref="_M/_WIN32">_WIN32</span>)</u></td></tr>
<tr><th id="4981">4981</th><td>    <em>unsigned</em> <em>int</em> <dfn class="local col4 decl" id="524optval" title='optval' data-type='unsigned int' data-ref="524optval" data-ref-filename="524optval">optval</dfn> = <var>1</var>;</td></tr>
<tr><th id="4982">4982</th><td><u>#<span data-ppcond="4980">endif</span></u></td></tr>
<tr><th id="4983">4983</th><td></td></tr>
<tr><th id="4984">4984</th><td>    (<em>void</em>)<a class="local col9 ref" href="#519filter" title='filter' data-ref="519filter" data-ref-filename="519filter">filter</a>; <i>// Unused</i></td></tr>
<tr><th id="4985">4985</th><td>    (<em>void</em>)<a class="local col0 ref" href="#520info" title='info' data-ref="520info" data-ref-filename="520info">info</a>; <i>// Unused</i></td></tr>
<tr><th id="4986">4986</th><td></td></tr>
<tr><th id="4987">4987</th><td>    <b>if</b> (!<a class="macro" href="dnssd_ipc.h.html#64" title="((sd) &gt;= 0)" data-ref="_M/dnssd_SocketValid">dnssd_SocketValid</a>(<a class="local col3 ref" href="#523sd" title='sd' data-ref="523sd" data-ref-filename="523sd">sd</a>))</td></tr>
<tr><th id="4988">4988</th><td>    {</td></tr>
<tr><th id="4989">4989</th><td>        <b>if</b> (<a class="macro" href="dnssd_ipc.h.html#71" title="(*__errno())" data-ref="_M/dnssd_errno">dnssd_errno</a> != <a class="macro" href="dnssd_ipc.h.html#65" title="35" data-ref="_M/dnssd_EWOULDBLOCK">dnssd_EWOULDBLOCK</a>)</td></tr>
<tr><th id="4990">4990</th><td>            <a class="ref fn" href="#my_throttled_perror" title='my_throttled_perror' data-ref="my_throttled_perror" data-ref-filename="my_throttled_perror">my_throttled_perror</a>(<q>"ERROR: accept"</q>);</td></tr>
<tr><th id="4991">4991</th><td>        <b>return</b>;</td></tr>
<tr><th id="4992">4992</th><td>    }</td></tr>
<tr><th id="4993">4993</th><td></td></tr>
<tr><th id="4994">4994</th><td><u>#<span data-ppcond="4994">ifdef</span> <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#132" data-ref="_M/SO_NOSIGPIPE">SO_NOSIGPIPE</a></u></td></tr>
<tr><th id="4995">4995</th><td>    <i>// Some environments (e.g. OS X) support turning off SIGPIPE for a socket</i></td></tr>
<tr><th id="4996">4996</th><td>    <b>if</b> (<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#setsockopt" title='setsockopt' data-ref="setsockopt" data-ref-filename="setsockopt">setsockopt</a>(<a class="local col3 ref" href="#523sd" title='sd' data-ref="523sd" data-ref-filename="523sd">sd</a>, <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#195" title="0xffff" data-ref="_M/SOL_SOCKET">SOL_SOCKET</a>, <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#132" title="0x0800" data-ref="_M/SO_NOSIGPIPE">SO_NOSIGPIPE</a>, &amp;<a class="local col4 ref" href="#524optval" title='optval' data-ref="524optval" data-ref-filename="524optval">optval</a>, <b>sizeof</b>(<a class="local col4 ref" href="#524optval" title='optval' data-ref="524optval" data-ref-filename="524optval">optval</a>)) &lt; <var>0</var>)</td></tr>
<tr><th id="4997">4997</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: WARNING: setsockopt - SO_NOSIGPIPE %d (%s)&quot;, sd, (*__errno()), strerror((*__errno())))" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: WARNING: setsockopt - SO_NOSIGPIPE %d (%s)"</q>, <a class="local col3 ref" href="#523sd" title='sd' data-ref="523sd" data-ref-filename="523sd">sd</a>, <a class="macro" href="dnssd_ipc.h.html#71" title="(*__errno())" data-ref="_M/dnssd_errno">dnssd_errno</a>, <a class="macro" href="dnssd_ipc.h.html#72" title="strerror((*__errno()))" data-ref="_M/dnssd_strerror">dnssd_strerror</a>(<a class="macro" href="dnssd_ipc.h.html#71" title="(*__errno())" data-ref="_M/dnssd_errno">dnssd_errno</a>));</td></tr>
<tr><th id="4998">4998</th><td><u>#<span data-ppcond="4994">endif</span></u></td></tr>
<tr><th id="4999">4999</th><td></td></tr>
<tr><th id="5000">5000</th><td><u>#<span data-ppcond="5000">if</span> defined(<span class="macro" data-ref="_M/_WIN32">_WIN32</span>)</u></td></tr>
<tr><th id="5001">5001</th><td>    <b>if</b> (ioctlsocket(sd, FIONBIO, &amp;optval) != <var>0</var>)</td></tr>
<tr><th id="5002">5002</th><td><u>#<span data-ppcond="5000">else</span></u></td></tr>
<tr><th id="5003">5003</th><td>    <b>if</b> (<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/fcntl.h.html#fcntl" title='fcntl' data-ref="fcntl" data-ref-filename="fcntl">fcntl</a>(<a class="local col3 ref" href="#523sd" title='sd' data-ref="523sd" data-ref-filename="523sd">sd</a>, <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/fcntl.h.html#181" title="4" data-ref="_M/F_SETFL">F_SETFL</a>, <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/fcntl.h.html#fcntl" title='fcntl' data-ref="fcntl" data-ref-filename="fcntl">fcntl</a>(<a class="local col3 ref" href="#523sd" title='sd' data-ref="523sd" data-ref-filename="523sd">sd</a>, <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/fcntl.h.html#180" title="3" data-ref="_M/F_GETFL">F_GETFL</a>, <var>0</var>) | <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/fcntl.h.html#81" title="0x00000004" data-ref="_M/O_NONBLOCK">O_NONBLOCK</a>) != <var>0</var>)</td></tr>
<tr><th id="5004">5004</th><td><u>#<span data-ppcond="5000">endif</span></u></td></tr>
<tr><th id="5005">5005</th><td>    {</td></tr>
<tr><th id="5006">5006</th><td>        <a class="ref fn" href="#my_perror" title='my_perror' data-ref="my_perror" data-ref-filename="my_perror">my_perror</a>(<q>"ERROR: fcntl(sd, F_SETFL, O_NONBLOCK) - aborting client"</q>);</td></tr>
<tr><th id="5007">5007</th><td>        <a class="macro" href="dnssd_ipc.h.html#70" title="close(sd)" data-ref="_M/dnssd_close">dnssd_close</a>(<a class="local col3 ref" href="#523sd" title='sd' data-ref="523sd" data-ref-filename="523sd">sd</a>);</td></tr>
<tr><th id="5008">5008</th><td>        <b>return</b>;</td></tr>
<tr><th id="5009">5009</th><td>    }</td></tr>
<tr><th id="5010">5010</th><td>    <b>else</b></td></tr>
<tr><th id="5011">5011</th><td>    {</td></tr>
<tr><th id="5012">5012</th><td>        <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col5 decl" id="525request" title='request' data-type='request_state *' data-ref="525request" data-ref-filename="525request">request</dfn> = <a class="ref fn" href="#NewRequest" title='NewRequest' data-ref="NewRequest" data-ref-filename="NewRequest">NewRequest</a>();</td></tr>
<tr><th id="5013">5013</th><td>        <a class="local col5 ref" href="#525request" title='request' data-ref="525request" data-ref-filename="525request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::ts" title='request_state::ts' data-ref="request_state::ts" data-ref-filename="request_state..ts">ts</a>    = <a class="enum" href="uds_daemon.h.html#t_morecoming" title='t_morecoming' data-ref="t_morecoming" data-ref-filename="t_morecoming">t_morecoming</a>;</td></tr>
<tr><th id="5014">5014</th><td>        <a class="local col5 ref" href="#525request" title='request' data-ref="525request" data-ref-filename="525request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>    = <a class="local col3 ref" href="#523sd" title='sd' data-ref="523sd" data-ref-filename="523sd">sd</a>;</td></tr>
<tr><th id="5015">5015</th><td>        <a class="local col5 ref" href="#525request" title='request' data-ref="525request" data-ref-filename="525request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::errsd" title='request_state::errsd' data-ref="request_state::errsd" data-ref-filename="request_state..errsd">errsd</a> = <a class="local col3 ref" href="#523sd" title='sd' data-ref="523sd" data-ref-filename="523sd">sd</a>;</td></tr>
<tr><th id="5016">5016</th><td>        <a class="ref fn" href="#set_peer_pid" title='set_peer_pid' data-ref="set_peer_pid" data-ref-filename="set_peer_pid">set_peer_pid</a>(<a class="local col5 ref" href="#525request" title='request' data-ref="525request" data-ref-filename="525request">request</a>);</td></tr>
<tr><th id="5017">5017</th><td><u>#<span data-ppcond="5017">if</span> APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="5018">5018</th><td>        <b>struct</b> xucred x;</td></tr>
<tr><th id="5019">5019</th><td>        socklen_t xucredlen = <b>sizeof</b>(x);</td></tr>
<tr><th id="5020">5020</th><td>        <b>if</b> (getsockopt(sd, <var>0</var>, LOCAL_PEERCRED, &amp;x, &amp;xucredlen) &gt;= <var>0</var> &amp;&amp; x.cr_version == XUCRED_VERSION)</td></tr>
<tr><th id="5021">5021</th><td>            request-&gt;uid = x.cr_uid; <i>// save the effective userid of the client</i></td></tr>
<tr><th id="5022">5022</th><td>        <b>else</b></td></tr>
<tr><th id="5023">5023</th><td>            my_perror(<q>"ERROR: getsockopt, LOCAL_PEERCRED"</q>);</td></tr>
<tr><th id="5024">5024</th><td></td></tr>
<tr><th id="5025">5025</th><td>        debugf(<q>"LOCAL_PEERCRED %d %u %u %d"</q>, xucredlen, x.cr_version, x.cr_uid, x.cr_ngroups);</td></tr>
<tr><th id="5026">5026</th><td><u>#<span data-ppcond="5017">endif</span> // APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="5027">5027</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: connect_callback: Adding FD for uid %u&quot;, request-&gt;sd, request-&gt;uid);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: connect_callback: Adding FD for uid %u"</q>, <a class="local col5 ref" href="#525request" title='request' data-ref="525request" data-ref-filename="525request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col5 ref" href="#525request" title='request' data-ref="525request" data-ref-filename="525request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::uid" title='request_state::uid' data-ref="request_state::uid" data-ref-filename="request_state..uid">uid</a>);</td></tr>
<tr><th id="5028">5028</th><td>        <a class="ref fn" href="uds_daemon.h.html#udsSupportAddFDToEventLoop" title='udsSupportAddFDToEventLoop' data-ref="udsSupportAddFDToEventLoop" data-ref-filename="udsSupportAddFDToEventLoop">udsSupportAddFDToEventLoop</a>(<a class="local col3 ref" href="#523sd" title='sd' data-ref="523sd" data-ref-filename="523sd">sd</a>, <a class="ref fn" href="#request_callback" title='request_callback' data-ref="request_callback" data-ref-filename="request_callback">request_callback</a>, <a class="local col5 ref" href="#525request" title='request' data-ref="525request" data-ref-filename="525request">request</a>, &amp;<a class="local col5 ref" href="#525request" title='request' data-ref="525request" data-ref-filename="525request">request</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::platform_data" title='request_state::platform_data' data-ref="request_state::platform_data" data-ref-filename="request_state..platform_data">platform_data</a>);</td></tr>
<tr><th id="5029">5029</th><td>    }</td></tr>
<tr><th id="5030">5030</th><td>}</td></tr>
<tr><th id="5031">5031</th><td></td></tr>
<tr><th id="5032">5032</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSBool" title='mDNSBool' data-type='unsigned char' data-ref="mDNSBool" data-ref-filename="mDNSBool">mDNSBool</a> <dfn class="decl def fn" id="uds_socket_setup" title='uds_socket_setup' data-ref="uds_socket_setup" data-ref-filename="uds_socket_setup">uds_socket_setup</dfn>(<a class="typedef" href="dns_sd.h.html#dnssd_sock_t" title='dnssd_sock_t' data-type='int' data-ref="dnssd_sock_t" data-ref-filename="dnssd_sock_t">dnssd_sock_t</a> <dfn class="local col6 decl" id="526skt" title='skt' data-type='dnssd_sock_t' data-ref="526skt" data-ref-filename="526skt">skt</dfn>)</td></tr>
<tr><th id="5033">5033</th><td>{</td></tr>
<tr><th id="5034">5034</th><td><u>#<span data-ppcond="5034">if</span> defined(<span class="macro" data-ref="_M/SO_NP_EXTENSIONS">SO_NP_EXTENSIONS</span>)</u></td></tr>
<tr><th id="5035">5035</th><td>    <b>struct</b>      so_np_extensions sonpx;</td></tr>
<tr><th id="5036">5036</th><td>    socklen_t optlen = <b>sizeof</b>(<b>struct</b> so_np_extensions);</td></tr>
<tr><th id="5037">5037</th><td>    sonpx.npx_flags = SONPX_SETOPTSHUT;</td></tr>
<tr><th id="5038">5038</th><td>    sonpx.npx_mask  = SONPX_SETOPTSHUT;</td></tr>
<tr><th id="5039">5039</th><td>    <b>if</b> (setsockopt(skt, SOL_SOCKET, SO_NP_EXTENSIONS, &amp;sonpx, optlen) &lt; <var>0</var>)</td></tr>
<tr><th id="5040">5040</th><td>        my_perror(<q>"WARNING: could not set sockopt - SO_NP_EXTENSIONS"</q>);</td></tr>
<tr><th id="5041">5041</th><td><u>#<span data-ppcond="5034">endif</span></u></td></tr>
<tr><th id="5042">5042</th><td><u>#<span data-ppcond="5042">if</span> defined(<span class="macro" data-ref="_M/_WIN32">_WIN32</span>)</u></td></tr>
<tr><th id="5043">5043</th><td>    <i>// SEH: do we even need to do this on windows?</i></td></tr>
<tr><th id="5044">5044</th><td><i>    // This socket will be given to WSAEventSelect which will automatically set it to non-blocking</i></td></tr>
<tr><th id="5045">5045</th><td>    u_long opt = <var>1</var>;</td></tr>
<tr><th id="5046">5046</th><td>    <b>if</b> (ioctlsocket(skt, FIONBIO, &amp;opt) != <var>0</var>)</td></tr>
<tr><th id="5047">5047</th><td><u>#<span data-ppcond="5042">else</span></u></td></tr>
<tr><th id="5048">5048</th><td>    <b>if</b> (<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/fcntl.h.html#fcntl" title='fcntl' data-ref="fcntl" data-ref-filename="fcntl">fcntl</a>(<a class="local col6 ref" href="#526skt" title='skt' data-ref="526skt" data-ref-filename="526skt">skt</a>, <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/fcntl.h.html#181" title="4" data-ref="_M/F_SETFL">F_SETFL</a>, <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/fcntl.h.html#fcntl" title='fcntl' data-ref="fcntl" data-ref-filename="fcntl">fcntl</a>(<a class="local col6 ref" href="#526skt" title='skt' data-ref="526skt" data-ref-filename="526skt">skt</a>, <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/fcntl.h.html#180" title="3" data-ref="_M/F_GETFL">F_GETFL</a>, <var>0</var>) | <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/fcntl.h.html#81" title="0x00000004" data-ref="_M/O_NONBLOCK">O_NONBLOCK</a>) != <var>0</var>)</td></tr>
<tr><th id="5049">5049</th><td><u>#<span data-ppcond="5042">endif</span></u></td></tr>
<tr><th id="5050">5050</th><td>    {</td></tr>
<tr><th id="5051">5051</th><td>        <a class="ref fn" href="#my_perror" title='my_perror' data-ref="my_perror" data-ref-filename="my_perror">my_perror</a>(<q>"ERROR: could not set listen socket to non-blocking mode"</q>);</td></tr>
<tr><th id="5052">5052</th><td>        <b>return</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>;</td></tr>
<tr><th id="5053">5053</th><td>    }</td></tr>
<tr><th id="5054">5054</th><td></td></tr>
<tr><th id="5055">5055</th><td>    <b>if</b> (<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#listen" title='listen' data-ref="listen" data-ref-filename="listen">listen</a>(<a class="local col6 ref" href="#526skt" title='skt' data-ref="526skt" data-ref-filename="526skt">skt</a>, <a class="macro" href="dnssd_ipc.h.html#87" title="100" data-ref="_M/LISTENQ">LISTENQ</a>) != <var>0</var>)</td></tr>
<tr><th id="5056">5056</th><td>    {</td></tr>
<tr><th id="5057">5057</th><td>        <a class="ref fn" href="#my_perror" title='my_perror' data-ref="my_perror" data-ref-filename="my_perror">my_perror</a>(<q>"ERROR: could not listen on listen socket"</q>);</td></tr>
<tr><th id="5058">5058</th><td>        <b>return</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>;</td></tr>
<tr><th id="5059">5059</th><td>    }</td></tr>
<tr><th id="5060">5060</th><td></td></tr>
<tr><th id="5061">5061</th><td>    <b>if</b> (<a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mStatus_NoError" title='mStatus_NoError' data-ref="mStatus_NoError" data-ref-filename="mStatus_NoError">mStatus_NoError</a> != <a class="ref fn" href="uds_daemon.h.html#udsSupportAddFDToEventLoop" title='udsSupportAddFDToEventLoop' data-ref="udsSupportAddFDToEventLoop" data-ref-filename="udsSupportAddFDToEventLoop">udsSupportAddFDToEventLoop</a>(<a class="local col6 ref" href="#526skt" title='skt' data-ref="526skt" data-ref-filename="526skt">skt</a>, <a class="ref fn" href="#connect_callback" title='connect_callback' data-ref="connect_callback" data-ref-filename="connect_callback">connect_callback</a>, (<em>void</em> *) <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>, (<em>void</em> **) <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>))</td></tr>
<tr><th id="5062">5062</th><td>    {</td></tr>
<tr><th id="5063">5063</th><td>        <a class="ref fn" href="#my_perror" title='my_perror' data-ref="my_perror" data-ref-filename="my_perror">my_perror</a>(<q>"ERROR: could not add listen socket to event loop"</q>);</td></tr>
<tr><th id="5064">5064</th><td>        <b>return</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>;</td></tr>
<tr><th id="5065">5065</th><td>    }</td></tr>
<tr><th id="5066">5066</th><td>    <b>else</b></td></tr>
<tr><th id="5067">5067</th><td>    {</td></tr>
<tr><th id="5068">5068</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#101" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_OPERATION, &quot;%3d: Listening for incoming Unix Domain Socket client requests&quot;, skt);} while (0)" data-ref="_M/LogOperation">LogOperation</a>(<q>"%3d: Listening for incoming Unix Domain Socket client requests"</q>, <a class="local col6 ref" href="#526skt" title='skt' data-ref="526skt" data-ref-filename="526skt">skt</a>);</td></tr>
<tr><th id="5069">5069</th><td>        <a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::uds_listener_skt" title='mDNS_struct::uds_listener_skt' data-ref="mDNS_struct::uds_listener_skt" data-ref-filename="mDNS_struct..uds_listener_skt">uds_listener_skt</a> = <a class="local col6 ref" href="#526skt" title='skt' data-ref="526skt" data-ref-filename="526skt">skt</a>;</td></tr>
<tr><th id="5070">5070</th><td>    }</td></tr>
<tr><th id="5071">5071</th><td>    <b>return</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>;</td></tr>
<tr><th id="5072">5072</th><td>}</td></tr>
<tr><th id="5073">5073</th><td></td></tr>
<tr><th id="5074">5074</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#116" title="" data-ref="_M/mDNSexport">mDNSexport</a> <em>int</em> <dfn class="decl def fn" id="udsserver_init" title='udsserver_init' data-ref="udsserver_init" data-ref-filename="udsserver_init">udsserver_init</dfn>(<a class="typedef" href="dns_sd.h.html#dnssd_sock_t" title='dnssd_sock_t' data-type='int' data-ref="dnssd_sock_t" data-ref-filename="dnssd_sock_t">dnssd_sock_t</a> <dfn class="local col7 decl" id="527skts" title='skts' data-type='dnssd_sock_t *' data-ref="527skts" data-ref-filename="527skts">skts</dfn>[], <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col8 decl" id="528count" title='count' data-type='mDNSu32' data-ref="528count" data-ref-filename="528count">count</dfn>)</td></tr>
<tr><th id="5075">5075</th><td>{</td></tr>
<tr><th id="5076">5076</th><td>    <a class="macro" href="dnssd_ipc.h.html#90" title="struct sockaddr_un" data-ref="_M/dnssd_sockaddr_t">dnssd_sockaddr_t</a> <dfn class="local col9 decl" id="529laddr" title='laddr' data-type='struct sockaddr_un' data-ref="529laddr" data-ref-filename="529laddr">laddr</dfn>;</td></tr>
<tr><th id="5077">5077</th><td>    <em>int</em> <dfn class="local col0 decl" id="530ret" title='ret' data-type='int' data-ref="530ret" data-ref-filename="530ret">ret</dfn>;</td></tr>
<tr><th id="5078">5078</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col1 decl" id="531i" title='i' data-type='mDNSu32' data-ref="531i" data-ref-filename="531i">i</dfn> = <var>0</var>;</td></tr>
<tr><th id="5079">5079</th><td></td></tr>
<tr><th id="5080">5080</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;udsserver_init: %d %d&quot;, 8783004, mDNSStorage.mDNS_plat);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"udsserver_init: %d %d"</q>, <a class="macro" href="dns_sd.h.html#69" title="8783004" data-ref="_M/_DNS_SD_H">_DNS_SD_H</a>, <a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::mDNS_plat" title='mDNS_struct::mDNS_plat' data-ref="mDNS_struct::mDNS_plat" data-ref-filename="mDNS_struct..mDNS_plat">mDNS_plat</a>);</td></tr>
<tr><th id="5081">5081</th><td></td></tr>
<tr><th id="5082">5082</th><td>    <i>// If a particular platform wants to opt out of having a PID file, define PID_FILE to be ""</i></td></tr>
<tr><th id="5083">5083</th><td>    <b>if</b> (<span class="macro" title="&quot;/var/run/mdnsd/mdnsd.pid&quot;" data-ref="_M/PID_FILE">PID_FILE</span>[<var>0</var>])</td></tr>
<tr><th id="5084">5084</th><td>    {</td></tr>
<tr><th id="5085">5085</th><td>        <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#FILE" title='FILE' data-type='struct __sFILE' data-ref="FILE" data-ref-filename="FILE">FILE</a> *<dfn class="local col2 decl" id="532fp" title='fp' data-type='FILE *' data-ref="532fp" data-ref-filename="532fp">fp</dfn> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#fopen" title='fopen' data-ref="fopen" data-ref-filename="fopen">fopen</a>(<span class="macro" title="&quot;/var/run/mdnsd/mdnsd.pid&quot;" data-ref="_M/PID_FILE">PID_FILE</span>, <q>"w"</q>);</td></tr>
<tr><th id="5086">5086</th><td>        <b>if</b> (<a class="local col2 ref" href="#532fp" title='fp' data-ref="532fp" data-ref-filename="532fp">fp</a> != <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="5087">5087</th><td>        {</td></tr>
<tr><th id="5088">5088</th><td>            <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#fprintf" title='fprintf' data-ref="fprintf" data-ref-filename="fprintf">fprintf</a>(<a class="local col2 ref" href="#532fp" title='fp' data-ref="532fp" data-ref-filename="532fp">fp</a>, <q>"%d\n"</q>, <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/unistd.h.html#getpid" title='getpid' data-ref="getpid" data-ref-filename="getpid">getpid</a>());</td></tr>
<tr><th id="5089">5089</th><td>            <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#fclose" title='fclose' data-ref="fclose" data-ref-filename="fclose">fclose</a>(<a class="local col2 ref" href="#532fp" title='fp' data-ref="532fp" data-ref-filename="532fp">fp</a>);</td></tr>
<tr><th id="5090">5090</th><td>        }</td></tr>
<tr><th id="5091">5091</th><td>    }</td></tr>
<tr><th id="5092">5092</th><td></td></tr>
<tr><th id="5093">5093</th><td>    <b>if</b> (<a class="local col7 ref" href="#527skts" title='skts' data-ref="527skts" data-ref-filename="527skts">skts</a>)</td></tr>
<tr><th id="5094">5094</th><td>    {</td></tr>
<tr><th id="5095">5095</th><td>        <b>for</b> (<a class="local col1 ref" href="#531i" title='i' data-ref="531i" data-ref-filename="531i">i</a> = <var>0</var>; <a class="local col1 ref" href="#531i" title='i' data-ref="531i" data-ref-filename="531i">i</a> &lt; <a class="local col8 ref" href="#528count" title='count' data-ref="528count" data-ref-filename="528count">count</a>; <a class="local col1 ref" href="#531i" title='i' data-ref="531i" data-ref-filename="531i">i</a>++)</td></tr>
<tr><th id="5096">5096</th><td>            <b>if</b> (<a class="macro" href="dnssd_ipc.h.html#64" title="((skts[i]) &gt;= 0)" data-ref="_M/dnssd_SocketValid">dnssd_SocketValid</a>(<a class="local col7 ref" href="#527skts" title='skts' data-ref="527skts" data-ref-filename="527skts">skts</a>[<a class="local col1 ref" href="#531i" title='i' data-ref="531i" data-ref-filename="531i">i</a>]) &amp;&amp; !<a class="ref fn" href="#uds_socket_setup" title='uds_socket_setup' data-ref="uds_socket_setup" data-ref-filename="uds_socket_setup">uds_socket_setup</a>(<a class="local col7 ref" href="#527skts" title='skts' data-ref="527skts" data-ref-filename="527skts">skts</a>[<a class="local col1 ref" href="#531i" title='i' data-ref="531i" data-ref-filename="531i">i</a>]))</td></tr>
<tr><th id="5097">5097</th><td>                <b>goto</b> <a class="lbl" href="#533error" data-ref="533error" data-ref-filename="533error">error</a>;</td></tr>
<tr><th id="5098">5098</th><td>    }</td></tr>
<tr><th id="5099">5099</th><td>    <b>else</b></td></tr>
<tr><th id="5100">5100</th><td>    {</td></tr>
<tr><th id="5101">5101</th><td>        <a class="tu ref" href="#listenfd" title='listenfd' data-use='w' data-ref="listenfd" data-ref-filename="listenfd">listenfd</a> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#__socket30" title='socket' data-ref="__socket30" data-ref-filename="__socket30">socket</a>(<a class="macro" href="dnssd_ipc.h.html#82" title="1" data-ref="_M/AF_DNSSD">AF_DNSSD</a>, <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#105" title="1" data-ref="_M/SOCK_STREAM">SOCK_STREAM</a>, <var>0</var>);</td></tr>
<tr><th id="5102">5102</th><td>        <b>if</b> (!<a class="macro" href="dnssd_ipc.h.html#64" title="((listenfd) &gt;= 0)" data-ref="_M/dnssd_SocketValid">dnssd_SocketValid</a>(<a class="tu ref" href="#listenfd" title='listenfd' data-use='r' data-ref="listenfd" data-ref-filename="listenfd">listenfd</a>))</td></tr>
<tr><th id="5103">5103</th><td>        {</td></tr>
<tr><th id="5104">5104</th><td>            <a class="ref fn" href="#my_perror" title='my_perror' data-ref="my_perror" data-ref-filename="my_perror">my_perror</a>(<q>"ERROR: socket(AF_DNSSD, SOCK_STREAM, 0); failed"</q>);</td></tr>
<tr><th id="5105">5105</th><td>            <b>goto</b> <a class="lbl" href="#533error" data-ref="533error" data-ref-filename="533error">error</a>;</td></tr>
<tr><th id="5106">5106</th><td>        }</td></tr>
<tr><th id="5107">5107</th><td></td></tr>
<tr><th id="5108">5108</th><td>        <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformMemZero" title='mDNSPlatformMemZero' data-ref="mDNSPlatformMemZero" data-ref-filename="mDNSPlatformMemZero">mDNSPlatformMemZero</a>(&amp;<a class="local col9 ref" href="#529laddr" title='laddr' data-ref="529laddr" data-ref-filename="529laddr">laddr</a>, <b>sizeof</b>(<a class="local col9 ref" href="#529laddr" title='laddr' data-ref="529laddr" data-ref-filename="529laddr">laddr</a>));</td></tr>
<tr><th id="5109">5109</th><td></td></tr>
<tr><th id="5110">5110</th><td>        <u>#<span data-ppcond="5110">if</span> defined(<span class="macro" data-ref="_M/USE_TCP_LOOPBACK">USE_TCP_LOOPBACK</span>)</u></td></tr>
<tr><th id="5111">5111</th><td>        {</td></tr>
<tr><th id="5112">5112</th><td>            laddr.sin_family = AF_INET;</td></tr>
<tr><th id="5113">5113</th><td>            laddr.sin_port = htons(MDNS_TCP_SERVERPORT);</td></tr>
<tr><th id="5114">5114</th><td>            laddr.sin_addr.s_addr = inet_addr(MDNS_TCP_SERVERADDR);</td></tr>
<tr><th id="5115">5115</th><td>            ret = bind(listenfd, (<b>struct</b> sockaddr *) &amp;laddr, <b>sizeof</b>(laddr));</td></tr>
<tr><th id="5116">5116</th><td>            <b>if</b> (ret &lt; <var>0</var>)</td></tr>
<tr><th id="5117">5117</th><td>            {</td></tr>
<tr><th id="5118">5118</th><td>                my_perror(<q>"ERROR: bind(listenfd, (struct sockaddr *) &amp;laddr, sizeof(laddr)); failed"</q>);</td></tr>
<tr><th id="5119">5119</th><td>                <b>goto</b> error;</td></tr>
<tr><th id="5120">5120</th><td>            }</td></tr>
<tr><th id="5121">5121</th><td>        }</td></tr>
<tr><th id="5122">5122</th><td>        <u>#<span data-ppcond="5110">else</span></u></td></tr>
<tr><th id="5123">5123</th><td>        {</td></tr>
<tr><th id="5124">5124</th><td>            <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#171" title="__mode_t" data-ref="_M/mode_t">mode_t</a> <dfn class="local col4 decl" id="534mask" title='mask' data-type='__mode_t' data-ref="534mask" data-ref-filename="534mask">mask</dfn> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/stat.h.html#umask" title='umask' data-ref="umask" data-ref-filename="umask">umask</a>(<var>0</var>);</td></tr>
<tr><th id="5125">5125</th><td>            <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/unistd.h.html#unlink" title='unlink' data-ref="unlink" data-ref-filename="unlink">unlink</a>(<a class="tu ref" href="#boundPath" title='boundPath' data-use='r' data-ref="boundPath" data-ref-filename="boundPath">boundPath</a>);  <i>// OK if this fails</i></td></tr>
<tr><th id="5126">5126</th><td>            <a class="local col9 ref" href="#529laddr" title='laddr' data-ref="529laddr" data-ref-filename="529laddr">laddr</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/un.h.html#sockaddr_un::sun_family" title='sockaddr_un::sun_family' data-ref="sockaddr_un::sun_family" data-ref-filename="sockaddr_un..sun_family">sun_family</a> = <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#201" title="1" data-ref="_M/AF_LOCAL">AF_LOCAL</a>;</td></tr>
<tr><th id="5127">5127</th><td>            <u>#<span data-ppcond="5127">ifndef</span> <span class="macro" data-ref="_M/NOT_HAVE_SA_LEN">NOT_HAVE_SA_LEN</span></u></td></tr>
<tr><th id="5128">5128</th><td>            <i>// According to Stevens (section 3.2), there is no portable way to</i></td></tr>
<tr><th id="5129">5129</th><td><i>            // determine whether sa_len is defined on a particular platform.</i></td></tr>
<tr><th id="5130">5130</th><td>            <a class="local col9 ref" href="#529laddr" title='laddr' data-ref="529laddr" data-ref-filename="529laddr">laddr</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/un.h.html#sockaddr_un::sun_len" title='sockaddr_un::sun_len' data-ref="sockaddr_un::sun_len" data-ref-filename="sockaddr_un..sun_len">sun_len</a> = <b>sizeof</b>(<b>struct</b> <a class="type" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/un.h.html#sockaddr_un" title='sockaddr_un' data-ref="sockaddr_un" data-ref-filename="sockaddr_un">sockaddr_un</a>);</td></tr>
<tr><th id="5131">5131</th><td>            <u>#<span data-ppcond="5127">endif</span></u></td></tr>
<tr><th id="5132">5132</th><td>            <b>if</b> (<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strlen" title='strlen' data-ref="strlen" data-ref-filename="strlen">strlen</a>(<a class="tu ref" href="#boundPath" title='boundPath' data-use='r' data-ref="boundPath" data-ref-filename="boundPath">boundPath</a>) &gt;= <b>sizeof</b>(<a class="local col9 ref" href="#529laddr" title='laddr' data-ref="529laddr" data-ref-filename="529laddr">laddr</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/un.h.html#sockaddr_un::sun_path" title='sockaddr_un::sun_path' data-ref="sockaddr_un::sun_path" data-ref-filename="sockaddr_un..sun_path">sun_path</a>))</td></tr>
<tr><th id="5133">5133</th><td>            {</td></tr>
<tr><th id="5134">5134</th><td>                <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;ERROR: MDNS_UDS_SERVERPATH must be &lt; %d characters&quot;, (int)sizeof(laddr.sun_path))" data-ref="_M/LogMsg">LogMsg</a>(<q>"ERROR: MDNS_UDS_SERVERPATH must be &lt; %d characters"</q>, (<em>int</em>)<b>sizeof</b>(<a class="local col9 ref" href="#529laddr" title='laddr' data-ref="529laddr" data-ref-filename="529laddr">laddr</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/un.h.html#sockaddr_un::sun_path" title='sockaddr_un::sun_path' data-ref="sockaddr_un::sun_path" data-ref-filename="sockaddr_un..sun_path">sun_path</a>));</td></tr>
<tr><th id="5135">5135</th><td>                <b>goto</b> <a class="lbl" href="#533error" data-ref="533error" data-ref-filename="533error">error</a>;</td></tr>
<tr><th id="5136">5136</th><td>            }</td></tr>
<tr><th id="5137">5137</th><td>            <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformStrLCopy" title='mDNSPlatformStrLCopy' data-ref="mDNSPlatformStrLCopy" data-ref-filename="mDNSPlatformStrLCopy">mDNSPlatformStrLCopy</a>(<a class="local col9 ref" href="#529laddr" title='laddr' data-ref="529laddr" data-ref-filename="529laddr">laddr</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/un.h.html#sockaddr_un::sun_path" title='sockaddr_un::sun_path' data-ref="sockaddr_un::sun_path" data-ref-filename="sockaddr_un..sun_path">sun_path</a>, <a class="tu ref" href="#boundPath" title='boundPath' data-use='r' data-ref="boundPath" data-ref-filename="boundPath">boundPath</a>, <b>sizeof</b>(<a class="local col9 ref" href="#529laddr" title='laddr' data-ref="529laddr" data-ref-filename="529laddr">laddr</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/un.h.html#sockaddr_un::sun_path" title='sockaddr_un::sun_path' data-ref="sockaddr_un::sun_path" data-ref-filename="sockaddr_un..sun_path">sun_path</a>));</td></tr>
<tr><th id="5138">5138</th><td>            <a class="local col0 ref" href="#530ret" title='ret' data-ref="530ret" data-ref-filename="530ret">ret</a> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#bind" title='bind' data-ref="bind" data-ref-filename="bind">bind</a>(<a class="tu ref" href="#listenfd" title='listenfd' data-use='r' data-ref="listenfd" data-ref-filename="listenfd">listenfd</a>, (<b>struct</b> <a class="type" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#sockaddr" title='sockaddr' data-ref="sockaddr" data-ref-filename="sockaddr">sockaddr</a> *) &amp;<a class="local col9 ref" href="#529laddr" title='laddr' data-ref="529laddr" data-ref-filename="529laddr">laddr</a>, <b>sizeof</b>(<a class="local col9 ref" href="#529laddr" title='laddr' data-ref="529laddr" data-ref-filename="529laddr">laddr</a>));</td></tr>
<tr><th id="5139">5139</th><td>            <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/stat.h.html#umask" title='umask' data-ref="umask" data-ref-filename="umask">umask</a>(<a class="local col4 ref" href="#534mask" title='mask' data-ref="534mask" data-ref-filename="534mask">mask</a>);</td></tr>
<tr><th id="5140">5140</th><td>            <b>if</b> (<a class="local col0 ref" href="#530ret" title='ret' data-ref="530ret" data-ref-filename="530ret">ret</a> &lt; <var>0</var>)</td></tr>
<tr><th id="5141">5141</th><td>            {</td></tr>
<tr><th id="5142">5142</th><td>                <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;ERROR: bind(listenfd, (struct sockaddr *) &amp;laddr, sizeof(laddr)); failed `%s&apos;: %s&quot;, boundPath, strerror((*__errno())))" data-ref="_M/LogMsg">LogMsg</a>(<q>"ERROR: bind(listenfd, (struct sockaddr *) &amp;laddr, sizeof(laddr)); failed `%s': %s"</q>, <a class="tu ref" href="#boundPath" title='boundPath' data-use='r' data-ref="boundPath" data-ref-filename="boundPath">boundPath</a>, <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strerror" title='strerror' data-ref="strerror" data-ref-filename="strerror">strerror</a>(<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/errno.h.html#55" title="(*__errno())" data-ref="_M/errno">errno</a>));</td></tr>
<tr><th id="5143">5143</th><td>                <b>goto</b> <a class="lbl" href="#533error" data-ref="533error" data-ref-filename="533error">error</a>;</td></tr>
<tr><th id="5144">5144</th><td>            }</td></tr>
<tr><th id="5145">5145</th><td>        }</td></tr>
<tr><th id="5146">5146</th><td>        <u>#<span data-ppcond="5110">endif</span></u></td></tr>
<tr><th id="5147">5147</th><td></td></tr>
<tr><th id="5148">5148</th><td>        <b>if</b> (!<a class="ref fn" href="#uds_socket_setup" title='uds_socket_setup' data-ref="uds_socket_setup" data-ref-filename="uds_socket_setup">uds_socket_setup</a>(<a class="tu ref" href="#listenfd" title='listenfd' data-use='r' data-ref="listenfd" data-ref-filename="listenfd">listenfd</a>)) <b>goto</b> <a class="lbl" href="#533error" data-ref="533error" data-ref-filename="533error">error</a>;</td></tr>
<tr><th id="5149">5149</th><td>    }</td></tr>
<tr><th id="5150">5150</th><td></td></tr>
<tr><th id="5151">5151</th><td><u>#<span data-ppcond="5151">if</span> !defined(<span class="macro" data-ref="_M/PLATFORM_NO_RLIMIT">PLATFORM_NO_RLIMIT</span>)</u></td></tr>
<tr><th id="5152">5152</th><td>    {</td></tr>
<tr><th id="5153">5153</th><td>        <i>// Set maximum number of open file descriptors</i></td></tr>
<tr><th id="5154">5154</th><td>    <u>#define <dfn class="macro" id="_M/MIN_OPENFILES" data-ref="_M/MIN_OPENFILES">MIN_OPENFILES</dfn> 10240</u></td></tr>
<tr><th id="5155">5155</th><td>        <b>struct</b> <a class="type" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/resource.h.html#rlimit" title='rlimit' data-ref="rlimit" data-ref-filename="rlimit">rlimit</a> <dfn class="local col5 decl" id="535maxfds" title='maxfds' data-type='struct rlimit' data-ref="535maxfds" data-ref-filename="535maxfds">maxfds</dfn>, <dfn class="local col6 decl" id="536newfds" title='newfds' data-type='struct rlimit' data-ref="536newfds" data-ref-filename="536newfds">newfds</dfn>;</td></tr>
<tr><th id="5156">5156</th><td></td></tr>
<tr><th id="5157">5157</th><td>        <i>// Due to bugs in OS X (&lt;rdar://problem/2941095&gt;, &lt;rdar://problem/3342704&gt;, &lt;rdar://problem/3839173&gt;)</i></td></tr>
<tr><th id="5158">5158</th><td><i>        // you have to get and set rlimits once before getrlimit will return sensible values</i></td></tr>
<tr><th id="5159">5159</th><td>        <b>if</b> (<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/resource.h.html#getrlimit" title='getrlimit' data-ref="getrlimit" data-ref-filename="getrlimit">getrlimit</a>(<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/resource.h.html#96" title="8" data-ref="_M/RLIMIT_NOFILE">RLIMIT_NOFILE</a>, &amp;<a class="local col5 ref" href="#535maxfds" title='maxfds' data-ref="535maxfds" data-ref-filename="535maxfds">maxfds</a>) &lt; <var>0</var>) { <a class="ref fn" href="#my_perror" title='my_perror' data-ref="my_perror" data-ref-filename="my_perror">my_perror</a>(<q>"ERROR: Unable to get file descriptor limit"</q>); <b>return</b> <var>0</var>; }</td></tr>
<tr><th id="5160">5160</th><td>        <b>if</b> (<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/resource.h.html#setrlimit" title='setrlimit' data-ref="setrlimit" data-ref-filename="setrlimit">setrlimit</a>(<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/resource.h.html#96" title="8" data-ref="_M/RLIMIT_NOFILE">RLIMIT_NOFILE</a>, &amp;<a class="local col5 ref" href="#535maxfds" title='maxfds' data-ref="535maxfds" data-ref-filename="535maxfds">maxfds</a>) &lt; <var>0</var>) <a class="ref fn" href="#my_perror" title='my_perror' data-ref="my_perror" data-ref-filename="my_perror">my_perror</a>(<q>"ERROR: Unable to set maximum file descriptor limit"</q>);</td></tr>
<tr><th id="5161">5161</th><td></td></tr>
<tr><th id="5162">5162</th><td>        <b>if</b> (<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/resource.h.html#getrlimit" title='getrlimit' data-ref="getrlimit" data-ref-filename="getrlimit">getrlimit</a>(<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/resource.h.html#96" title="8" data-ref="_M/RLIMIT_NOFILE">RLIMIT_NOFILE</a>, &amp;<a class="local col5 ref" href="#535maxfds" title='maxfds' data-ref="535maxfds" data-ref-filename="535maxfds">maxfds</a>) &lt; <var>0</var>) { <a class="ref fn" href="#my_perror" title='my_perror' data-ref="my_perror" data-ref-filename="my_perror">my_perror</a>(<q>"ERROR: Unable to get file descriptor limit"</q>); <b>return</b> <var>0</var>; }</td></tr>
<tr><th id="5163">5163</th><td>        <a class="local col6 ref" href="#536newfds" title='newfds' data-ref="536newfds" data-ref-filename="536newfds">newfds</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/resource.h.html#rlimit::rlim_max" title='rlimit::rlim_max' data-ref="rlimit::rlim_max" data-ref-filename="rlimit..rlim_max">rlim_max</a> = (<a class="local col5 ref" href="#535maxfds" title='maxfds' data-ref="535maxfds" data-ref-filename="535maxfds">maxfds</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/resource.h.html#rlimit::rlim_max" title='rlimit::rlim_max' data-ref="rlimit::rlim_max" data-ref-filename="rlimit..rlim_max">rlim_max</a> &gt; <a class="macro" href="#5154" title="10240" data-ref="_M/MIN_OPENFILES">MIN_OPENFILES</a>) ? <a class="local col5 ref" href="#535maxfds" title='maxfds' data-ref="535maxfds" data-ref-filename="535maxfds">maxfds</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/resource.h.html#rlimit::rlim_max" title='rlimit::rlim_max' data-ref="rlimit::rlim_max" data-ref-filename="rlimit..rlim_max">rlim_max</a> : <a class="macro" href="#5154" title="10240" data-ref="_M/MIN_OPENFILES">MIN_OPENFILES</a>;</td></tr>
<tr><th id="5164">5164</th><td>        <a class="local col6 ref" href="#536newfds" title='newfds' data-ref="536newfds" data-ref-filename="536newfds">newfds</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/resource.h.html#rlimit::rlim_cur" title='rlimit::rlim_cur' data-ref="rlimit::rlim_cur" data-ref-filename="rlimit..rlim_cur">rlim_cur</a> = (<a class="local col5 ref" href="#535maxfds" title='maxfds' data-ref="535maxfds" data-ref-filename="535maxfds">maxfds</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/resource.h.html#rlimit::rlim_cur" title='rlimit::rlim_cur' data-ref="rlimit::rlim_cur" data-ref-filename="rlimit..rlim_cur">rlim_cur</a> &gt; <a class="macro" href="#5154" title="10240" data-ref="_M/MIN_OPENFILES">MIN_OPENFILES</a>) ? <a class="local col5 ref" href="#535maxfds" title='maxfds' data-ref="535maxfds" data-ref-filename="535maxfds">maxfds</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/resource.h.html#rlimit::rlim_cur" title='rlimit::rlim_cur' data-ref="rlimit::rlim_cur" data-ref-filename="rlimit..rlim_cur">rlim_cur</a> : <a class="macro" href="#5154" title="10240" data-ref="_M/MIN_OPENFILES">MIN_OPENFILES</a>;</td></tr>
<tr><th id="5165">5165</th><td>        <b>if</b> (<a class="local col6 ref" href="#536newfds" title='newfds' data-ref="536newfds" data-ref-filename="536newfds">newfds</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/resource.h.html#rlimit::rlim_max" title='rlimit::rlim_max' data-ref="rlimit::rlim_max" data-ref-filename="rlimit..rlim_max">rlim_max</a> != <a class="local col5 ref" href="#535maxfds" title='maxfds' data-ref="535maxfds" data-ref-filename="535maxfds">maxfds</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/resource.h.html#rlimit::rlim_max" title='rlimit::rlim_max' data-ref="rlimit::rlim_max" data-ref-filename="rlimit..rlim_max">rlim_max</a> || <a class="local col6 ref" href="#536newfds" title='newfds' data-ref="536newfds" data-ref-filename="536newfds">newfds</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/resource.h.html#rlimit::rlim_cur" title='rlimit::rlim_cur' data-ref="rlimit::rlim_cur" data-ref-filename="rlimit..rlim_cur">rlim_cur</a> != <a class="local col5 ref" href="#535maxfds" title='maxfds' data-ref="535maxfds" data-ref-filename="535maxfds">maxfds</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/resource.h.html#rlimit::rlim_cur" title='rlimit::rlim_cur' data-ref="rlimit::rlim_cur" data-ref-filename="rlimit..rlim_cur">rlim_cur</a>)</td></tr>
<tr><th id="5166">5166</th><td>            <b>if</b> (<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/resource.h.html#setrlimit" title='setrlimit' data-ref="setrlimit" data-ref-filename="setrlimit">setrlimit</a>(<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/resource.h.html#96" title="8" data-ref="_M/RLIMIT_NOFILE">RLIMIT_NOFILE</a>, &amp;<a class="local col6 ref" href="#536newfds" title='newfds' data-ref="536newfds" data-ref-filename="536newfds">newfds</a>) &lt; <var>0</var>) <a class="ref fn" href="#my_perror" title='my_perror' data-ref="my_perror" data-ref-filename="my_perror">my_perror</a>(<q>"ERROR: Unable to set maximum file descriptor limit"</q>);</td></tr>
<tr><th id="5167">5167</th><td></td></tr>
<tr><th id="5168">5168</th><td>        <b>if</b> (<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/resource.h.html#getrlimit" title='getrlimit' data-ref="getrlimit" data-ref-filename="getrlimit">getrlimit</a>(<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/resource.h.html#96" title="8" data-ref="_M/RLIMIT_NOFILE">RLIMIT_NOFILE</a>, &amp;<a class="local col5 ref" href="#535maxfds" title='maxfds' data-ref="535maxfds" data-ref-filename="535maxfds">maxfds</a>) &lt; <var>0</var>) { <a class="ref fn" href="#my_perror" title='my_perror' data-ref="my_perror" data-ref-filename="my_perror">my_perror</a>(<q>"ERROR: Unable to get file descriptor limit"</q>); <b>return</b> <var>0</var>; }</td></tr>
<tr><th id="5169">5169</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#131" title="debug_noop" data-ref="_M/debugf">debugf</a>(<q>"maxfds.rlim_max %d"</q>, (<em>long</em>)maxfds.rlim_max);</td></tr>
<tr><th id="5170">5170</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#131" title="debug_noop" data-ref="_M/debugf">debugf</a>(<q>"maxfds.rlim_cur %d"</q>, (<em>long</em>)maxfds.rlim_cur);</td></tr>
<tr><th id="5171">5171</th><td>    }</td></tr>
<tr><th id="5172">5172</th><td><u>#<span data-ppcond="5151">endif</span></u></td></tr>
<tr><th id="5173">5173</th><td></td></tr>
<tr><th id="5174">5174</th><td>    <i>// We start a "LocalOnly" query looking for Automatic Browse Domain records.</i></td></tr>
<tr><th id="5175">5175</th><td><i>    // When Domain Enumeration in uDNS.c finds an "lb" record from the network, its "FoundDomain" routine</i></td></tr>
<tr><th id="5176">5176</th><td><i>    // creates a "LocalOnly" record, which results in our AutomaticBrowseDomainChange callback being invoked</i></td></tr>
<tr><th id="5177">5177</th><td>    <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_GetDomains" title='mDNS_GetDomains' data-ref="mDNS_GetDomains" data-ref-filename="mDNS_GetDomains">mDNS_GetDomains</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::AutomaticBrowseDomainQ" title='mDNS_struct::AutomaticBrowseDomainQ' data-ref="mDNS_struct::AutomaticBrowseDomainQ" data-ref-filename="mDNS_struct..AutomaticBrowseDomainQ">AutomaticBrowseDomainQ</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_DomainTypeBrowseAutomatic" title='mDNS_DomainTypeBrowseAutomatic' data-ref="mDNS_DomainTypeBrowseAutomatic" data-ref-filename="mDNS_DomainTypeBrowseAutomatic">mDNS_DomainTypeBrowseAutomatic</a>,</td></tr>
<tr><th id="5178">5178</th><td>                    <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>, <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterface_LocalOnly" title='mDNSInterface_LocalOnly' data-ref="mDNSInterface_LocalOnly" data-ref-filename="mDNSInterface_LocalOnly">mDNSInterface_LocalOnly</a>, <a class="ref fn" href="#AutomaticBrowseDomainChange" title='AutomaticBrowseDomainChange' data-ref="AutomaticBrowseDomainChange" data-ref-filename="AutomaticBrowseDomainChange">AutomaticBrowseDomainChange</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>);</td></tr>
<tr><th id="5179">5179</th><td></td></tr>
<tr><th id="5180">5180</th><td>    <i>// Add "local" as recommended registration domain ("dns-sd -E"), recommended browsing domain ("dns-sd -F"), and automatic browsing domain</i></td></tr>
<tr><th id="5181">5181</th><td>    <a class="ref fn" href="#RegisterLocalOnlyDomainEnumPTR" title='RegisterLocalOnlyDomainEnumPTR' data-ref="RegisterLocalOnlyDomainEnumPTR" data-ref-filename="RegisterLocalOnlyDomainEnumPTR">RegisterLocalOnlyDomainEnumPTR</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2594" title="(*(const domainname *)&quot;\x5&quot; &quot;local&quot;)" data-ref="_M/localdomain">localdomain</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_DomainTypeRegistration" title='mDNS_DomainTypeRegistration' data-ref="mDNS_DomainTypeRegistration" data-ref-filename="mDNS_DomainTypeRegistration">mDNS_DomainTypeRegistration</a>);</td></tr>
<tr><th id="5182">5182</th><td>    <a class="ref fn" href="#RegisterLocalOnlyDomainEnumPTR" title='RegisterLocalOnlyDomainEnumPTR' data-ref="RegisterLocalOnlyDomainEnumPTR" data-ref-filename="RegisterLocalOnlyDomainEnumPTR">RegisterLocalOnlyDomainEnumPTR</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2594" title="(*(const domainname *)&quot;\x5&quot; &quot;local&quot;)" data-ref="_M/localdomain">localdomain</a>, <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_DomainTypeBrowse" title='mDNS_DomainTypeBrowse' data-ref="mDNS_DomainTypeBrowse" data-ref-filename="mDNS_DomainTypeBrowse">mDNS_DomainTypeBrowse</a>);</td></tr>
<tr><th id="5183">5183</th><td>    <a class="ref fn" href="#AddAutoBrowseDomain" title='AddAutoBrowseDomain' data-ref="AddAutoBrowseDomain" data-ref-filename="AddAutoBrowseDomain">AddAutoBrowseDomain</a>(<var>0</var>, &amp;<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2594" title="(*(const domainname *)&quot;\x5&quot; &quot;local&quot;)" data-ref="_M/localdomain">localdomain</a>);</td></tr>
<tr><th id="5184">5184</th><td></td></tr>
<tr><th id="5185">5185</th><td>    <a class="ref fn" href="#udsserver_handle_configchange" title='udsserver_handle_configchange' data-ref="udsserver_handle_configchange" data-ref-filename="udsserver_handle_configchange">udsserver_handle_configchange</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>);</td></tr>
<tr><th id="5186">5186</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="5187">5187</th><td></td></tr>
<tr><th id="5188">5188</th><td><dfn class="lbl" id="533error" data-ref="533error" data-ref-filename="533error">error</dfn>:</td></tr>
<tr><th id="5189">5189</th><td></td></tr>
<tr><th id="5190">5190</th><td>    <a class="ref fn" href="#my_perror" title='my_perror' data-ref="my_perror" data-ref-filename="my_perror">my_perror</a>(<q>"ERROR: udsserver_init"</q>);</td></tr>
<tr><th id="5191">5191</th><td>    <b>return</b> -<var>1</var>;</td></tr>
<tr><th id="5192">5192</th><td>}</td></tr>
<tr><th id="5193">5193</th><td></td></tr>
<tr><th id="5194">5194</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#116" title="" data-ref="_M/mDNSexport">mDNSexport</a> <em>int</em> <dfn class="decl def fn" id="udsserver_exit" title='udsserver_exit' data-ref="udsserver_exit" data-ref-filename="udsserver_exit">udsserver_exit</dfn>(<em>void</em>)</td></tr>
<tr><th id="5195">5195</th><td>{</td></tr>
<tr><th id="5196">5196</th><td>    <i>// Cancel all outstanding client requests</i></td></tr>
<tr><th id="5197">5197</th><td>    <b>while</b> (<a class="tu ref" href="#all_requests" title='all_requests' data-use='r' data-ref="all_requests" data-ref-filename="all_requests">all_requests</a>) <a class="ref fn" href="#AbortUnlinkAndFree" title='AbortUnlinkAndFree' data-ref="AbortUnlinkAndFree" data-ref-filename="AbortUnlinkAndFree">AbortUnlinkAndFree</a>(<a class="tu ref" href="#all_requests" title='all_requests' data-use='r' data-ref="all_requests" data-ref-filename="all_requests">all_requests</a>);</td></tr>
<tr><th id="5198">5198</th><td></td></tr>
<tr><th id="5199">5199</th><td>    <i>// Clean up any special mDNSInterface_LocalOnly records we created, both the entries for "local" we</i></td></tr>
<tr><th id="5200">5200</th><td><i>    // created in udsserver_init, and others we created as a result of reading local configuration data</i></td></tr>
<tr><th id="5201">5201</th><td>    <b>while</b> (<a class="tu ref" href="#LocalDomainEnumRecords" title='LocalDomainEnumRecords' data-use='r' data-ref="LocalDomainEnumRecords" data-ref-filename="LocalDomainEnumRecords">LocalDomainEnumRecords</a>)</td></tr>
<tr><th id="5202">5202</th><td>    {</td></tr>
<tr><th id="5203">5203</th><td>        <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ARListElem" title='ARListElem' data-type='struct ARListElem' data-ref="ARListElem" data-ref-filename="ARListElem">ARListElem</a> *<dfn class="local col7 decl" id="537rem" title='rem' data-type='ARListElem *' data-ref="537rem" data-ref-filename="537rem">rem</dfn> = <a class="tu ref" href="#LocalDomainEnumRecords" title='LocalDomainEnumRecords' data-use='r' data-ref="LocalDomainEnumRecords" data-ref-filename="LocalDomainEnumRecords">LocalDomainEnumRecords</a>;</td></tr>
<tr><th id="5204">5204</th><td>        <a class="tu ref" href="#LocalDomainEnumRecords" title='LocalDomainEnumRecords' data-use='w' data-ref="LocalDomainEnumRecords" data-ref-filename="LocalDomainEnumRecords">LocalDomainEnumRecords</a> = <a class="tu ref" href="#LocalDomainEnumRecords" title='LocalDomainEnumRecords' data-use='r' data-ref="LocalDomainEnumRecords" data-ref-filename="LocalDomainEnumRecords">LocalDomainEnumRecords</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ARListElem::next" title='ARListElem::next' data-ref="ARListElem::next" data-ref-filename="ARListElem..next">next</a>;</td></tr>
<tr><th id="5205">5205</th><td>        <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_Deregister" title='mDNS_Deregister' data-ref="mDNS_Deregister" data-ref-filename="mDNS_Deregister">mDNS_Deregister</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, &amp;<a class="local col7 ref" href="#537rem" title='rem' data-ref="537rem" data-ref-filename="537rem">rem</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ARListElem::ar" title='ARListElem::ar' data-ref="ARListElem::ar" data-ref-filename="ARListElem..ar">ar</a>);</td></tr>
<tr><th id="5206">5206</th><td>    }</td></tr>
<tr><th id="5207">5207</th><td></td></tr>
<tr><th id="5208">5208</th><td>    <i>// If the launching environment created no listening socket,</i></td></tr>
<tr><th id="5209">5209</th><td><i>    // that means we created it ourselves, so we should clean it up on exit</i></td></tr>
<tr><th id="5210">5210</th><td>    <b>if</b> (<a class="macro" href="dnssd_ipc.h.html#64" title="((listenfd) &gt;= 0)" data-ref="_M/dnssd_SocketValid">dnssd_SocketValid</a>(<a class="tu ref" href="#listenfd" title='listenfd' data-use='r' data-ref="listenfd" data-ref-filename="listenfd">listenfd</a>))</td></tr>
<tr><th id="5211">5211</th><td>    {</td></tr>
<tr><th id="5212">5212</th><td>        <a class="macro" href="dnssd_ipc.h.html#70" title="close(listenfd)" data-ref="_M/dnssd_close">dnssd_close</a>(<a class="tu ref" href="#listenfd" title='listenfd' data-use='r' data-ref="listenfd" data-ref-filename="listenfd">listenfd</a>);</td></tr>
<tr><th id="5213">5213</th><td><u>#<span data-ppcond="5213">if</span> !defined(<span class="macro" data-ref="_M/USE_TCP_LOOPBACK">USE_TCP_LOOPBACK</span>)</u></td></tr>
<tr><th id="5214">5214</th><td>        <i>// Currently, we're unable to remove /var/run/mdnsd because we've changed to userid "nobody"</i></td></tr>
<tr><th id="5215">5215</th><td><i>        // to give up unnecessary privilege, but we need to be root to remove this Unix Domain Socket.</i></td></tr>
<tr><th id="5216">5216</th><td><i>        // It would be nice if we could find a solution to this problem</i></td></tr>
<tr><th id="5217">5217</th><td>        <b>if</b> (<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/unistd.h.html#unlink" title='unlink' data-ref="unlink" data-ref-filename="unlink">unlink</a>(<a class="tu ref" href="#boundPath" title='boundPath' data-use='r' data-ref="boundPath" data-ref-filename="boundPath">boundPath</a>))</td></tr>
<tr><th id="5218">5218</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#131" title="debug_noop" data-ref="_M/debugf">debugf</a>(<q>"Unable to remove %s"</q>, MDNS_UDS_SERVERPATH);</td></tr>
<tr><th id="5219">5219</th><td><u>#<span data-ppcond="5213">endif</span></u></td></tr>
<tr><th id="5220">5220</th><td>    }</td></tr>
<tr><th id="5221">5221</th><td></td></tr>
<tr><th id="5222">5222</th><td>    <b>if</b> (<span class="macro" title="&quot;/var/run/mdnsd/mdnsd.pid&quot;" data-ref="_M/PID_FILE">PID_FILE</span>[<var>0</var>]) <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/unistd.h.html#unlink" title='unlink' data-ref="unlink" data-ref-filename="unlink">unlink</a>(<span class="macro" title="&quot;/var/run/mdnsd/mdnsd.pid&quot;" data-ref="_M/PID_FILE">PID_FILE</span>);</td></tr>
<tr><th id="5223">5223</th><td></td></tr>
<tr><th id="5224">5224</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="5225">5225</th><td>}</td></tr>
<tr><th id="5226">5226</th><td></td></tr>
<tr><th id="5227">5227</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="LogClientInfo" title='LogClientInfo' data-ref="LogClientInfo" data-ref-filename="LogClientInfo">LogClientInfo</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col8 decl" id="538req" title='req' data-type='request_state *' data-ref="538req" data-ref-filename="538req">req</dfn>)</td></tr>
<tr><th id="5228">5228</th><td>{</td></tr>
<tr><th id="5229">5229</th><td>    <em>char</em> <dfn class="local col9 decl" id="539prefix" title='prefix' data-type='char [16]' data-ref="539prefix" data-ref-filename="539prefix">prefix</dfn>[<var>16</var>];</td></tr>
<tr><th id="5230">5230</th><td>    <b>if</b> (<a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::primary" title='request_state::primary' data-ref="request_state::primary" data-ref-filename="request_state..primary">primary</a>)</td></tr>
<tr><th id="5231">5231</th><td>        <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_snprintf" title='mDNS_snprintf' data-ref="mDNS_snprintf" data-ref-filename="mDNS_snprintf">mDNS_snprintf</a>(<a class="local col9 ref" href="#539prefix" title='prefix' data-ref="539prefix" data-ref-filename="539prefix">prefix</a>, <b>sizeof</b>(<a class="local col9 ref" href="#539prefix" title='prefix' data-ref="539prefix" data-ref-filename="539prefix">prefix</a>), <q>" -&gt; "</q>);</td></tr>
<tr><th id="5232">5232</th><td>    <b>else</b></td></tr>
<tr><th id="5233">5233</th><td>        <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_snprintf" title='mDNS_snprintf' data-ref="mDNS_snprintf" data-ref-filename="mDNS_snprintf">mDNS_snprintf</a>(<a class="local col9 ref" href="#539prefix" title='prefix' data-ref="539prefix" data-ref-filename="539prefix">prefix</a>, <b>sizeof</b>(<a class="local col9 ref" href="#539prefix" title='prefix' data-ref="539prefix" data-ref-filename="539prefix">prefix</a>), <q>"%3d:"</q>, <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>);</td></tr>
<tr><th id="5234">5234</th><td></td></tr>
<tr><th id="5235">5235</th><td>    <b>if</b> (!<a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a>)</td></tr>
<tr><th id="5236">5236</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"%s No operation yet on this socket"</q>, <a class="local col9 ref" href="#539prefix" title='prefix' data-ref="539prefix" data-ref-filename="539prefix">prefix</a>);</td></tr>
<tr><th id="5237">5237</th><td>    <b>else</b> <b>if</b> (<a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> == <a class="ref fn" href="#connection_termination" title='connection_termination' data-ref="connection_termination" data-ref-filename="connection_termination">connection_termination</a>)</td></tr>
<tr><th id="5238">5238</th><td>    {</td></tr>
<tr><th id="5239">5239</th><td>        <em>int</em> <dfn class="local col0 decl" id="540num_records" title='num_records' data-type='int' data-ref="540num_records" data-ref-filename="540num_records">num_records</dfn> = <var>0</var>, <dfn class="local col1 decl" id="541num_ops" title='num_ops' data-type='int' data-ref="541num_ops" data-ref-filename="541num_ops">num_ops</dfn> = <var>0</var>;</td></tr>
<tr><th id="5240">5240</th><td>        <em>const</em> <a class="typedef" href="uds_daemon.h.html#registered_record_entry" title='registered_record_entry' data-type='struct registered_record_entry' data-ref="registered_record_entry" data-ref-filename="registered_record_entry">registered_record_entry</a> *<dfn class="local col2 decl" id="542p" title='p' data-type='const registered_record_entry *' data-ref="542p" data-ref-filename="542p">p</dfn>;</td></tr>
<tr><th id="5241">5241</th><td>        <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col3 decl" id="543r" title='r' data-type='request_state *' data-ref="543r" data-ref-filename="543r">r</dfn>;</td></tr>
<tr><th id="5242">5242</th><td>        <b>for</b> (<a class="local col2 ref" href="#542p" title='p' data-ref="542p" data-ref-filename="542p">p</a> = <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::reg_recs" title='request_state::(anonymous union)::reg_recs' data-ref="request_state::(anonymous)::reg_recs" data-ref-filename="request_state..(anonymous)..reg_recs">reg_recs</a>; <a class="local col2 ref" href="#542p" title='p' data-ref="542p" data-ref-filename="542p">p</a>; <a class="local col2 ref" href="#542p" title='p' data-ref="542p" data-ref-filename="542p">p</a>=<a class="local col2 ref" href="#542p" title='p' data-ref="542p" data-ref-filename="542p">p</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::next" title='registered_record_entry::next' data-ref="registered_record_entry::next" data-ref-filename="registered_record_entry..next">next</a>) <a class="local col0 ref" href="#540num_records" title='num_records' data-ref="540num_records" data-ref-filename="540num_records">num_records</a>++;</td></tr>
<tr><th id="5243">5243</th><td>        <b>for</b> (<a class="local col3 ref" href="#543r" title='r' data-ref="543r" data-ref-filename="543r">r</a> = <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::next" title='request_state::next' data-ref="request_state::next" data-ref-filename="request_state..next">next</a>; <a class="local col3 ref" href="#543r" title='r' data-ref="543r" data-ref-filename="543r">r</a>; <a class="local col3 ref" href="#543r" title='r' data-ref="543r" data-ref-filename="543r">r</a>=<a class="local col3 ref" href="#543r" title='r' data-ref="543r" data-ref-filename="543r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::next" title='request_state::next' data-ref="request_state::next" data-ref-filename="request_state..next">next</a>) <b>if</b> (<a class="local col3 ref" href="#543r" title='r' data-ref="543r" data-ref-filename="543r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::primary" title='request_state::primary' data-ref="request_state::primary" data-ref-filename="request_state..primary">primary</a> == <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>) <a class="local col1 ref" href="#541num_ops" title='num_ops' data-ref="541num_ops" data-ref-filename="541num_ops">num_ops</a>++;</td></tr>
<tr><th id="5244">5244</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"%s DNSServiceCreateConnection: %d registered record%s, %d kDNSServiceFlagsShareConnection operation%s PID[%d](%s)"</q>,</td></tr>
<tr><th id="5245">5245</th><td>                       <a class="local col9 ref" href="#539prefix" title='prefix' data-ref="539prefix" data-ref-filename="539prefix">prefix</a>, <a class="local col0 ref" href="#540num_records" title='num_records' data-ref="540num_records" data-ref-filename="540num_records">num_records</a>, <a class="local col0 ref" href="#540num_records" title='num_records' data-ref="540num_records" data-ref-filename="540num_records">num_records</a> != <var>1</var> ? <q>"s"</q> : <q>""</q>, <a class="local col1 ref" href="#541num_ops" title='num_ops' data-ref="541num_ops" data-ref-filename="541num_ops">num_ops</a>,     <a class="local col1 ref" href="#541num_ops" title='num_ops' data-ref="541num_ops" data-ref-filename="541num_ops">num_ops</a>     != <var>1</var> ? <q>"s"</q> : <q>""</q>,</td></tr>
<tr><th id="5246">5246</th><td>                       <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="5247">5247</th><td>        <b>for</b> (<a class="local col2 ref" href="#542p" title='p' data-ref="542p" data-ref-filename="542p">p</a> = <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::reg_recs" title='request_state::(anonymous union)::reg_recs' data-ref="request_state::(anonymous)::reg_recs" data-ref-filename="request_state..(anonymous)..reg_recs">reg_recs</a>; <a class="local col2 ref" href="#542p" title='p' data-ref="542p" data-ref-filename="542p">p</a>; <a class="local col2 ref" href="#542p" title='p' data-ref="542p" data-ref-filename="542p">p</a>=<a class="local col2 ref" href="#542p" title='p' data-ref="542p" data-ref-filename="542p">p</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::next" title='registered_record_entry::next' data-ref="registered_record_entry::next" data-ref-filename="registered_record_entry..next">next</a>)</td></tr>
<tr><th id="5248">5248</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>" -&gt;  DNSServiceRegisterRecord   0x%08X %2d %3d %s PID[%d](%s)"</q>,</td></tr>
<tr><th id="5249">5249</th><td>                           <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a>, <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::interfaceIndex" title='request_state::interfaceIndex' data-ref="request_state::interfaceIndex" data-ref-filename="request_state..interfaceIndex">interfaceIndex</a>, <a class="local col2 ref" href="#542p" title='p' data-ref="542p" data-ref-filename="542p">p</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::key" title='registered_record_entry::key' data-ref="registered_record_entry::key" data-ref-filename="registered_record_entry..key">key</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2942" title="GetRRDisplayString_rdb(&amp;(p-&gt;rr)-&gt;resrec, &amp;(p-&gt;rr)-&gt;resrec.rdata-&gt;u, (&amp;mDNSStorage)-&gt;MsgBuffer)" data-ref="_M/ARDisplayString">ARDisplayString</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col2 ref" href="#542p" title='p' data-ref="542p" data-ref-filename="542p">p</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::rr" title='registered_record_entry::rr' data-ref="registered_record_entry::rr" data-ref-filename="registered_record_entry..rr">rr</a>), <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="5250">5250</th><td>        <b>for</b> (<a class="local col3 ref" href="#543r" title='r' data-ref="543r" data-ref-filename="543r">r</a> = <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::next" title='request_state::next' data-ref="request_state::next" data-ref-filename="request_state..next">next</a>; <a class="local col3 ref" href="#543r" title='r' data-ref="543r" data-ref-filename="543r">r</a>; <a class="local col3 ref" href="#543r" title='r' data-ref="543r" data-ref-filename="543r">r</a>=<a class="local col3 ref" href="#543r" title='r' data-ref="543r" data-ref-filename="543r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::next" title='request_state::next' data-ref="request_state::next" data-ref-filename="request_state..next">next</a>) <b>if</b> (<a class="local col3 ref" href="#543r" title='r' data-ref="543r" data-ref-filename="543r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::primary" title='request_state::primary' data-ref="request_state::primary" data-ref-filename="request_state..primary">primary</a> == <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>) <a class="ref fn" href="#LogClientInfo" title='LogClientInfo' data-ref="LogClientInfo" data-ref-filename="LogClientInfo">LogClientInfo</a>(<a class="local col3 ref" href="#543r" title='r' data-ref="543r" data-ref-filename="543r">r</a>);</td></tr>
<tr><th id="5251">5251</th><td>    }</td></tr>
<tr><th id="5252">5252</th><td>    <b>else</b> <b>if</b> (<a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> == <a class="ref fn" href="#regservice_termination_callback" title='regservice_termination_callback' data-ref="regservice_termination_callback" data-ref-filename="regservice_termination_callback">regservice_termination_callback</a>)</td></tr>
<tr><th id="5253">5253</th><td>    {</td></tr>
<tr><th id="5254">5254</th><td>        <a class="typedef" href="uds_daemon.h.html#service_instance" title='service_instance' data-type='struct service_instance' data-ref="service_instance" data-ref-filename="service_instance">service_instance</a> *<dfn class="local col4 decl" id="544ptr" title='ptr' data-type='service_instance *' data-ref="544ptr" data-ref-filename="544ptr">ptr</dfn>;</td></tr>
<tr><th id="5255">5255</th><td>        <em>char</em> <dfn class="local col5 decl" id="545anonstr" title='anonstr' data-type='char [256]' data-ref="545anonstr" data-ref-filename="545anonstr">anonstr</dfn>[<var>256</var>];</td></tr>
<tr><th id="5256">5256</th><td>        <b>for</b> (<a class="local col4 ref" href="#544ptr" title='ptr' data-ref="544ptr" data-ref-filename="544ptr">ptr</a> = <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::instances" title='request_state::(anonymous union)::(anonymous struct)::instances' data-ref="request_state::(anonymousunion)::(anonymous)::instances" data-ref-filename="request_state..(anonymousunion)..(anonymous)..instances">instances</a>; <a class="local col4 ref" href="#544ptr" title='ptr' data-ref="544ptr" data-ref-filename="544ptr">ptr</a>; <a class="local col4 ref" href="#544ptr" title='ptr' data-ref="544ptr" data-ref-filename="544ptr">ptr</a> = <a class="local col4 ref" href="#544ptr" title='ptr' data-ref="544ptr" data-ref-filename="544ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::next" title='service_instance::next' data-ref="service_instance::next" data-ref-filename="service_instance..next">next</a>)</td></tr>
<tr><th id="5257">5257</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"%s DNSServiceRegister         0x%08X %2d %##s%s %u/%u PID[%d](%s)"</q>,</td></tr>
<tr><th id="5258">5258</th><td>                           (<a class="local col4 ref" href="#544ptr" title='ptr' data-ref="544ptr" data-ref-filename="544ptr">ptr</a> == <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::instances" title='request_state::(anonymous union)::(anonymous struct)::instances' data-ref="request_state::(anonymousunion)::(anonymous)::instances" data-ref-filename="request_state..(anonymousunion)..(anonymous)..instances">instances</a>) ? <a class="local col9 ref" href="#539prefix" title='prefix' data-ref="539prefix" data-ref-filename="539prefix">prefix</a> : <q>"    "</q>, <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a>, <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::interfaceIndex" title='request_state::interfaceIndex' data-ref="request_state::interfaceIndex" data-ref-filename="request_state..interfaceIndex">interfaceIndex</a>, <a class="local col4 ref" href="#544ptr" title='ptr' data-ref="544ptr" data-ref-filename="544ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_SRV" title='ServiceRecordSet_struct::RR_SRV' data-ref="ServiceRecordSet_struct::RR_SRV" data-ref-filename="ServiceRecordSet_struct..RR_SRV">RR_SRV</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::name" title='ResourceRecord_struct::name' data-ref="ResourceRecord_struct::name" data-ref-filename="ResourceRecord_struct..name">name</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>,</td></tr>
<tr><th id="5259">5259</th><td>                           <a class="ref fn" href="#AnonDataToString" title='AnonDataToString' data-ref="AnonDataToString" data-ref-filename="AnonDataToString">AnonDataToString</a>(<a class="local col4 ref" href="#544ptr" title='ptr' data-ref="544ptr" data-ref-filename="544ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::AnonData" title='ServiceRecordSet_struct::AnonData' data-ref="ServiceRecordSet_struct::AnonData" data-ref-filename="ServiceRecordSet_struct..AnonData">AnonData</a>, <var>0</var>, <a class="local col5 ref" href="#545anonstr" title='anonstr' data-ref="545anonstr" data-ref-filename="545anonstr">anonstr</a>, <b>sizeof</b>(<a class="local col5 ref" href="#545anonstr" title='anonstr' data-ref="545anonstr" data-ref-filename="545anonstr">anonstr</a>)), <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSVal16" title='mDNSVal16' data-ref="mDNSVal16" data-ref-filename="mDNSVal16">mDNSVal16</a>(<a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::port" title='request_state::(anonymous union)::(anonymous struct)::port' data-ref="request_state::(anonymousunion)::(anonymous)::port" data-ref-filename="request_state..(anonymousunion)..(anonymous)..port">port</a>),</td></tr>
<tr><th id="5260">5260</th><td>                           <a class="macro" href="uds_daemon.h.html#214" title="mDNSVal16((&amp;ptr-&gt;srs)-&gt;RR_SRV.resrec.rdata-&gt;u.srv.port)" data-ref="_M/SRS_PORT">SRS_PORT</a>(&amp;<a class="local col4 ref" href="#544ptr" title='ptr' data-ref="544ptr" data-ref-filename="544ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>), <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="5261">5261</th><td>    }</td></tr>
<tr><th id="5262">5262</th><td>    <b>else</b> <b>if</b> (<a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> == <a class="ref fn" href="#browse_termination_callback" title='browse_termination_callback' data-ref="browse_termination_callback" data-ref-filename="browse_termination_callback">browse_termination_callback</a>)</td></tr>
<tr><th id="5263">5263</th><td>    {</td></tr>
<tr><th id="5264">5264</th><td>        <a class="typedef" href="uds_daemon.h.html#browser_t" title='browser_t' data-type='struct browser_t' data-ref="browser_t" data-ref-filename="browser_t">browser_t</a> *<dfn class="local col6 decl" id="546blist" title='blist' data-type='browser_t *' data-ref="546blist" data-ref-filename="546blist">blist</dfn>;</td></tr>
<tr><th id="5265">5265</th><td>        <em>char</em> <dfn class="local col7 decl" id="547anonstr" title='anonstr' data-type='char [256]' data-ref="547anonstr" data-ref-filename="547anonstr">anonstr</dfn>[<var>256</var>];</td></tr>
<tr><th id="5266">5266</th><td>        <b>for</b> (<a class="local col6 ref" href="#546blist" title='blist' data-ref="546blist" data-ref-filename="546blist">blist</a> = <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::browsers" title='request_state::(anonymous union)::(anonymous struct)::browsers' data-ref="request_state::(anonymousunion)::(anonymous)::browsers" data-ref-filename="request_state..(anonymousunion)..(anonymous)..browsers">browsers</a>; <a class="local col6 ref" href="#546blist" title='blist' data-ref="546blist" data-ref-filename="546blist">blist</a>; <a class="local col6 ref" href="#546blist" title='blist' data-ref="546blist" data-ref-filename="546blist">blist</a> = <a class="local col6 ref" href="#546blist" title='blist' data-ref="546blist" data-ref-filename="546blist">blist</a>-&gt;<a class="ref field" href="uds_daemon.h.html#browser_t::next" title='browser_t::next' data-ref="browser_t::next" data-ref-filename="browser_t..next">next</a>)</td></tr>
<tr><th id="5267">5267</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"%s DNSServiceBrowse           0x%08X %2d %##s%s PID[%d](%s)"</q>,</td></tr>
<tr><th id="5268">5268</th><td>                           (<a class="local col6 ref" href="#546blist" title='blist' data-ref="546blist" data-ref-filename="546blist">blist</a> == <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::browsers" title='request_state::(anonymous union)::(anonymous struct)::browsers' data-ref="request_state::(anonymousunion)::(anonymous)::browsers" data-ref-filename="request_state..(anonymousunion)..(anonymous)..browsers">browsers</a>) ? <a class="local col9 ref" href="#539prefix" title='prefix' data-ref="539prefix" data-ref-filename="539prefix">prefix</a> : <q>"    "</q>, <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a>, <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::interfaceIndex" title='request_state::interfaceIndex' data-ref="request_state::interfaceIndex" data-ref-filename="request_state..interfaceIndex">interfaceIndex</a>, <a class="local col6 ref" href="#546blist" title='blist' data-ref="546blist" data-ref-filename="546blist">blist</a>-&gt;<a class="ref field" href="uds_daemon.h.html#browser_t::q" title='browser_t::q' data-ref="browser_t::q" data-ref-filename="browser_t..q">q</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>,</td></tr>
<tr><th id="5269">5269</th><td>                           <a class="ref fn" href="#AnonDataToString" title='AnonDataToString' data-ref="AnonDataToString" data-ref-filename="AnonDataToString">AnonDataToString</a>(<a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::AnonData" title='request_state::(anonymous union)::(anonymous struct)::AnonData' data-ref="request_state::(anonymousunion)::(anonymous)::AnonData" data-ref-filename="request_state..(anonymousunion)..(anonymous)..AnonData">AnonData</a>, <var>0</var>, <a class="local col7 ref" href="#547anonstr" title='anonstr' data-ref="547anonstr" data-ref-filename="547anonstr">anonstr</a>, <b>sizeof</b>(<a class="local col7 ref" href="#547anonstr" title='anonstr' data-ref="547anonstr" data-ref-filename="547anonstr">anonstr</a>)), <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="5270">5270</th><td>    }</td></tr>
<tr><th id="5271">5271</th><td>    <b>else</b> <b>if</b> (<a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> == <a class="ref fn" href="#resolve_termination_callback" title='resolve_termination_callback' data-ref="resolve_termination_callback" data-ref-filename="resolve_termination_callback">resolve_termination_callback</a>)</td></tr>
<tr><th id="5272">5272</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"%s DNSServiceResolve          0x%08X %2d %##s PID[%d](%s)"</q>,</td></tr>
<tr><th id="5273">5273</th><td>                       <a class="local col9 ref" href="#539prefix" title='prefix' data-ref="539prefix" data-ref-filename="539prefix">prefix</a>, <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a>, <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::interfaceIndex" title='request_state::interfaceIndex' data-ref="request_state::interfaceIndex" data-ref-filename="request_state..interfaceIndex">interfaceIndex</a>, <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="5274">5274</th><td>    <b>else</b> <b>if</b> (<a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> == <a class="ref fn" href="#queryrecord_termination_callback" title='queryrecord_termination_callback' data-ref="queryrecord_termination_callback" data-ref-filename="queryrecord_termination_callback">queryrecord_termination_callback</a>)</td></tr>
<tr><th id="5275">5275</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"%s DNSServiceQueryRecord      0x%08X %2d %##s (%s) PID[%d](%s)"</q>,</td></tr>
<tr><th id="5276">5276</th><td>                       <a class="local col9 ref" href="#539prefix" title='prefix' data-ref="539prefix" data-ref-filename="539prefix">prefix</a>, <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a>, <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::interfaceIndex" title='request_state::interfaceIndex' data-ref="request_state::interfaceIndex" data-ref-filename="request_state..interfaceIndex">interfaceIndex</a>, <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q" title='request_state::(anonymous union)::(anonymous struct)::q' data-ref="request_state::(anonymousunion)::(anonymous)::q" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q">q</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q" title='request_state::(anonymous union)::(anonymous struct)::q' data-ref="request_state::(anonymousunion)::(anonymous)::q" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q">q</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a>), <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="5277">5277</th><td>    <b>else</b> <b>if</b> (<a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> == <a class="ref fn" href="#enum_termination_callback" title='enum_termination_callback' data-ref="enum_termination_callback" data-ref-filename="enum_termination_callback">enum_termination_callback</a>)</td></tr>
<tr><th id="5278">5278</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"%s DNSServiceEnumerateDomains 0x%08X %2d %##s PID[%d](%s)"</q>,</td></tr>
<tr><th id="5279">5279</th><td>                       <a class="local col9 ref" href="#539prefix" title='prefix' data-ref="539prefix" data-ref-filename="539prefix">prefix</a>, <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a>, <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::interfaceIndex" title='request_state::interfaceIndex' data-ref="request_state::interfaceIndex" data-ref-filename="request_state..interfaceIndex">interfaceIndex</a>, <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::enumeration" title='request_state::(anonymous union)::enumeration' data-ref="request_state::(anonymous)::enumeration" data-ref-filename="request_state..(anonymous)..enumeration">enumeration</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q_all" title='request_state::(anonymous union)::(anonymous struct)::q_all' data-ref="request_state::(anonymousunion)::(anonymous)::q_all" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q_all">q_all</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="5280">5280</th><td>    <b>else</b> <b>if</b> (<a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> == <a class="ref fn" href="#port_mapping_termination_callback" title='port_mapping_termination_callback' data-ref="port_mapping_termination_callback" data-ref-filename="port_mapping_termination_callback">port_mapping_termination_callback</a>)</td></tr>
<tr><th id="5281">5281</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"%s DNSServiceNATPortMapping   0x%08X %2d %s%s Int %5d Req %5d Ext %.4a:%5d Req TTL %5d Granted TTL %5d PID[%d](%s)"</q>,</td></tr>
<tr><th id="5282">5282</th><td>                      <a class="local col9 ref" href="#539prefix" title='prefix' data-ref="539prefix" data-ref-filename="539prefix">prefix</a>,</td></tr>
<tr><th id="5283">5283</th><td>                      <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a>,</td></tr>
<tr><th id="5284">5284</th><td>                      <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::interfaceIndex" title='request_state::interfaceIndex' data-ref="request_state::interfaceIndex" data-ref-filename="request_state..interfaceIndex">interfaceIndex</a>,</td></tr>
<tr><th id="5285">5285</th><td>                      <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::Protocol" title='NATTraversalInfo_struct::Protocol' data-ref="NATTraversalInfo_struct::Protocol" data-ref-filename="NATTraversalInfo_struct..Protocol">Protocol</a> &amp; <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATOp_MapTCP" title='NATOp_MapTCP' data-ref="NATOp_MapTCP" data-ref-filename="NATOp_MapTCP">NATOp_MapTCP</a> ? <q>"TCP"</q> : <q>"   "</q>,</td></tr>
<tr><th id="5286">5286</th><td>                      <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::Protocol" title='NATTraversalInfo_struct::Protocol' data-ref="NATTraversalInfo_struct::Protocol" data-ref-filename="NATTraversalInfo_struct..Protocol">Protocol</a> &amp; <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATOp_MapUDP" title='NATOp_MapUDP' data-ref="NATOp_MapUDP" data-ref-filename="NATOp_MapUDP">NATOp_MapUDP</a> ? <q>"UDP"</q> : <q>"   "</q>,</td></tr>
<tr><th id="5287">5287</th><td>                      <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSVal16" title='mDNSVal16' data-ref="mDNSVal16" data-ref-filename="mDNSVal16">mDNSVal16</a>(<a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::IntPort" title='NATTraversalInfo_struct::IntPort' data-ref="NATTraversalInfo_struct::IntPort" data-ref-filename="NATTraversalInfo_struct..IntPort">IntPort</a>),</td></tr>
<tr><th id="5288">5288</th><td>                      <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSVal16" title='mDNSVal16' data-ref="mDNSVal16" data-ref-filename="mDNSVal16">mDNSVal16</a>(<a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::ReqExt" title='request_state::(anonymous union)::(anonymous struct)::ReqExt' data-ref="request_state::(anonymousunion)::(anonymous)::ReqExt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..ReqExt">ReqExt</a>),</td></tr>
<tr><th id="5289">5289</th><td>                      &amp;<a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::ExternalAddress" title='NATTraversalInfo_struct::ExternalAddress' data-ref="NATTraversalInfo_struct::ExternalAddress" data-ref-filename="NATTraversalInfo_struct..ExternalAddress">ExternalAddress</a>,</td></tr>
<tr><th id="5290">5290</th><td>                      <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSVal16" title='mDNSVal16' data-ref="mDNSVal16" data-ref-filename="mDNSVal16">mDNSVal16</a>(<a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::ExternalPort" title='NATTraversalInfo_struct::ExternalPort' data-ref="NATTraversalInfo_struct::ExternalPort" data-ref-filename="NATTraversalInfo_struct..ExternalPort">ExternalPort</a>),</td></tr>
<tr><th id="5291">5291</th><td>                      <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::NATLease" title='NATTraversalInfo_struct::NATLease' data-ref="NATTraversalInfo_struct::NATLease" data-ref-filename="NATTraversalInfo_struct..NATLease">NATLease</a>,</td></tr>
<tr><th id="5292">5292</th><td>                      <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::pm" title='request_state::(anonymous union)::pm' data-ref="request_state::(anonymous)::pm" data-ref-filename="request_state..(anonymous)..pm">pm</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::NATinfo" title='request_state::(anonymous union)::(anonymous struct)::NATinfo' data-ref="request_state::(anonymousunion)::(anonymous)::NATinfo" data-ref-filename="request_state..(anonymousunion)..(anonymous)..NATinfo">NATinfo</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::Lifetime" title='NATTraversalInfo_struct::Lifetime' data-ref="NATTraversalInfo_struct::Lifetime" data-ref-filename="NATTraversalInfo_struct..Lifetime">Lifetime</a>,</td></tr>
<tr><th id="5293">5293</th><td>                      <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="5294">5294</th><td>    <b>else</b> <b>if</b> (<a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> == <a class="ref fn" href="#addrinfo_termination_callback" title='addrinfo_termination_callback' data-ref="addrinfo_termination_callback" data-ref-filename="addrinfo_termination_callback">addrinfo_termination_callback</a>)</td></tr>
<tr><th id="5295">5295</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"%s DNSServiceGetAddrInfo      0x%08X %2d %s%s %##s PID[%d](%s)"</q>,</td></tr>
<tr><th id="5296">5296</th><td>                      <a class="local col9 ref" href="#539prefix" title='prefix' data-ref="539prefix" data-ref-filename="539prefix">prefix</a>, <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::flags" title='request_state::flags' data-ref="request_state::flags" data-ref-filename="request_state..flags">flags</a>, <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::interfaceIndex" title='request_state::interfaceIndex' data-ref="request_state::interfaceIndex" data-ref-filename="request_state..interfaceIndex">interfaceIndex</a>,</td></tr>
<tr><th id="5297">5297</th><td>                      <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::protocol" title='request_state::(anonymous union)::(anonymous struct)::protocol' data-ref="request_state::(anonymousunion)::(anonymous)::protocol" data-ref-filename="request_state..(anonymousunion)..(anonymous)..protocol">protocol</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceProtocol_IPv4" title='kDNSServiceProtocol_IPv4' data-ref="kDNSServiceProtocol_IPv4" data-ref-filename="kDNSServiceProtocol_IPv4">kDNSServiceProtocol_IPv4</a> ? <q>"v4"</q> : <q>"  "</q>,</td></tr>
<tr><th id="5298">5298</th><td>                      <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::protocol" title='request_state::(anonymous union)::(anonymous struct)::protocol' data-ref="request_state::(anonymousunion)::(anonymous)::protocol" data-ref-filename="request_state..(anonymousunion)..(anonymous)..protocol">protocol</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceProtocol_IPv6" title='kDNSServiceProtocol_IPv6' data-ref="kDNSServiceProtocol_IPv6" data-ref-filename="kDNSServiceProtocol_IPv6">kDNSServiceProtocol_IPv6</a> ? <q>"v6"</q> : <q>"  "</q>,</td></tr>
<tr><th id="5299">5299</th><td>                      <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="5300">5300</th><td>    <b>else</b></td></tr>
<tr><th id="5301">5301</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"%s Unrecognized operation %p"</q>, <a class="local col9 ref" href="#539prefix" title='prefix' data-ref="539prefix" data-ref-filename="539prefix">prefix</a>, <a class="local col8 ref" href="#538req" title='req' data-ref="538req" data-ref-filename="538req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a>);</td></tr>
<tr><th id="5302">5302</th><td>}</td></tr>
<tr><th id="5303">5303</th><td></td></tr>
<tr><th id="5304">5304</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="GetMcastClients" title='GetMcastClients' data-ref="GetMcastClients" data-ref-filename="GetMcastClients">GetMcastClients</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col8 decl" id="548req" title='req' data-type='request_state *' data-ref="548req" data-ref-filename="548req">req</dfn>)</td></tr>
<tr><th id="5305">5305</th><td>{</td></tr>
<tr><th id="5306">5306</th><td>    <b>if</b> (<a class="local col8 ref" href="#548req" title='req' data-ref="548req" data-ref-filename="548req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> == <a class="ref fn" href="#connection_termination" title='connection_termination' data-ref="connection_termination" data-ref-filename="connection_termination">connection_termination</a>)</td></tr>
<tr><th id="5307">5307</th><td>    {</td></tr>
<tr><th id="5308">5308</th><td>        <em>int</em> <dfn class="local col9 decl" id="549num_records" title='num_records' data-type='int' data-ref="549num_records" data-ref-filename="549num_records">num_records</dfn> = <var>0</var>, <dfn class="local col0 decl" id="550num_ops" title='num_ops' data-type='int' data-ref="550num_ops" data-ref-filename="550num_ops">num_ops</dfn> = <var>0</var>;</td></tr>
<tr><th id="5309">5309</th><td>        <em>const</em> <a class="typedef" href="uds_daemon.h.html#registered_record_entry" title='registered_record_entry' data-type='struct registered_record_entry' data-ref="registered_record_entry" data-ref-filename="registered_record_entry">registered_record_entry</a> *<dfn class="local col1 decl" id="551p" title='p' data-type='const registered_record_entry *' data-ref="551p" data-ref-filename="551p">p</dfn>;</td></tr>
<tr><th id="5310">5310</th><td>        <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col2 decl" id="552r" title='r' data-type='request_state *' data-ref="552r" data-ref-filename="552r">r</dfn>;</td></tr>
<tr><th id="5311">5311</th><td>        <b>for</b> (<a class="local col1 ref" href="#551p" title='p' data-ref="551p" data-ref-filename="551p">p</a> = <a class="local col8 ref" href="#548req" title='req' data-ref="548req" data-ref-filename="548req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::reg_recs" title='request_state::(anonymous union)::reg_recs' data-ref="request_state::(anonymous)::reg_recs" data-ref-filename="request_state..(anonymous)..reg_recs">reg_recs</a>; <a class="local col1 ref" href="#551p" title='p' data-ref="551p" data-ref-filename="551p">p</a>; <a class="local col1 ref" href="#551p" title='p' data-ref="551p" data-ref-filename="551p">p</a>=<a class="local col1 ref" href="#551p" title='p' data-ref="551p" data-ref-filename="551p">p</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::next" title='registered_record_entry::next' data-ref="registered_record_entry::next" data-ref-filename="registered_record_entry..next">next</a>)</td></tr>
<tr><th id="5312">5312</th><td>            <a class="local col9 ref" href="#549num_records" title='num_records' data-ref="549num_records" data-ref-filename="549num_records">num_records</a>++;</td></tr>
<tr><th id="5313">5313</th><td>        <b>for</b> (<a class="local col2 ref" href="#552r" title='r' data-ref="552r" data-ref-filename="552r">r</a> = <a class="local col8 ref" href="#548req" title='req' data-ref="548req" data-ref-filename="548req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::next" title='request_state::next' data-ref="request_state::next" data-ref-filename="request_state..next">next</a>; <a class="local col2 ref" href="#552r" title='r' data-ref="552r" data-ref-filename="552r">r</a>; <a class="local col2 ref" href="#552r" title='r' data-ref="552r" data-ref-filename="552r">r</a>=<a class="local col2 ref" href="#552r" title='r' data-ref="552r" data-ref-filename="552r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::next" title='request_state::next' data-ref="request_state::next" data-ref-filename="request_state..next">next</a>)</td></tr>
<tr><th id="5314">5314</th><td>            <b>if</b> (<a class="local col2 ref" href="#552r" title='r' data-ref="552r" data-ref-filename="552r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::primary" title='request_state::primary' data-ref="request_state::primary" data-ref-filename="request_state..primary">primary</a> == <a class="local col8 ref" href="#548req" title='req' data-ref="548req" data-ref-filename="548req">req</a>)</td></tr>
<tr><th id="5315">5315</th><td>                <a class="local col0 ref" href="#550num_ops" title='num_ops' data-ref="550num_ops" data-ref-filename="550num_ops">num_ops</a>++;</td></tr>
<tr><th id="5316">5316</th><td>        <b>for</b> (<a class="local col1 ref" href="#551p" title='p' data-ref="551p" data-ref-filename="551p">p</a> = <a class="local col8 ref" href="#548req" title='req' data-ref="548req" data-ref-filename="548req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::reg_recs" title='request_state::(anonymous union)::reg_recs' data-ref="request_state::(anonymous)::reg_recs" data-ref-filename="request_state..(anonymous)..reg_recs">reg_recs</a>; <a class="local col1 ref" href="#551p" title='p' data-ref="551p" data-ref-filename="551p">p</a>; <a class="local col1 ref" href="#551p" title='p' data-ref="551p" data-ref-filename="551p">p</a>=<a class="local col1 ref" href="#551p" title='p' data-ref="551p" data-ref-filename="551p">p</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::next" title='registered_record_entry::next' data-ref="registered_record_entry::next" data-ref-filename="registered_record_entry..next">next</a>)</td></tr>
<tr><th id="5317">5317</th><td>        {</td></tr>
<tr><th id="5318">5318</th><td>            <b>if</b> (!<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#1601" title="((p-&gt;rr)-&gt;resrec.InterfaceID == mDNSInterface_Any &amp;&amp; !(p-&gt;rr)-&gt;ForceMCast &amp;&amp; !IsLocalDomain((p-&gt;rr)-&gt;resrec.name))" data-ref="_M/AuthRecord_uDNS">AuthRecord_uDNS</a>(<a class="local col1 ref" href="#551p" title='p' data-ref="551p" data-ref-filename="551p">p</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::rr" title='registered_record_entry::rr' data-ref="registered_record_entry::rr" data-ref-filename="registered_record_entry..rr">rr</a>))</td></tr>
<tr><th id="5319">5319</th><td>                <a class="tu ref" href="#n_mrecords" title='n_mrecords' data-use='w' data-ref="n_mrecords" data-ref-filename="n_mrecords">n_mrecords</a>++;</td></tr>
<tr><th id="5320">5320</th><td>        }</td></tr>
<tr><th id="5321">5321</th><td>        <b>for</b> (<a class="local col2 ref" href="#552r" title='r' data-ref="552r" data-ref-filename="552r">r</a> = <a class="local col8 ref" href="#548req" title='req' data-ref="548req" data-ref-filename="548req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::next" title='request_state::next' data-ref="request_state::next" data-ref-filename="request_state..next">next</a>; <a class="local col2 ref" href="#552r" title='r' data-ref="552r" data-ref-filename="552r">r</a>; <a class="local col2 ref" href="#552r" title='r' data-ref="552r" data-ref-filename="552r">r</a>=<a class="local col2 ref" href="#552r" title='r' data-ref="552r" data-ref-filename="552r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::next" title='request_state::next' data-ref="request_state::next" data-ref-filename="request_state..next">next</a>)</td></tr>
<tr><th id="5322">5322</th><td>            <b>if</b> (<a class="local col2 ref" href="#552r" title='r' data-ref="552r" data-ref-filename="552r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::primary" title='request_state::primary' data-ref="request_state::primary" data-ref-filename="request_state..primary">primary</a> == <a class="local col8 ref" href="#548req" title='req' data-ref="548req" data-ref-filename="548req">req</a>)</td></tr>
<tr><th id="5323">5323</th><td>                <a class="ref fn" href="#GetMcastClients" title='GetMcastClients' data-ref="GetMcastClients" data-ref-filename="GetMcastClients">GetMcastClients</a>(<a class="local col2 ref" href="#552r" title='r' data-ref="552r" data-ref-filename="552r">r</a>);</td></tr>
<tr><th id="5324">5324</th><td>    }</td></tr>
<tr><th id="5325">5325</th><td>    <b>else</b> <b>if</b> (<a class="local col8 ref" href="#548req" title='req' data-ref="548req" data-ref-filename="548req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> == <a class="ref fn" href="#regservice_termination_callback" title='regservice_termination_callback' data-ref="regservice_termination_callback" data-ref-filename="regservice_termination_callback">regservice_termination_callback</a>)</td></tr>
<tr><th id="5326">5326</th><td>    {</td></tr>
<tr><th id="5327">5327</th><td>        <a class="typedef" href="uds_daemon.h.html#service_instance" title='service_instance' data-type='struct service_instance' data-ref="service_instance" data-ref-filename="service_instance">service_instance</a> *<dfn class="local col3 decl" id="553ptr" title='ptr' data-type='service_instance *' data-ref="553ptr" data-ref-filename="553ptr">ptr</dfn>;</td></tr>
<tr><th id="5328">5328</th><td>        <b>for</b> (<a class="local col3 ref" href="#553ptr" title='ptr' data-ref="553ptr" data-ref-filename="553ptr">ptr</a> = <a class="local col8 ref" href="#548req" title='req' data-ref="548req" data-ref-filename="548req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::instances" title='request_state::(anonymous union)::(anonymous struct)::instances' data-ref="request_state::(anonymousunion)::(anonymous)::instances" data-ref-filename="request_state..(anonymousunion)..(anonymous)..instances">instances</a>; <a class="local col3 ref" href="#553ptr" title='ptr' data-ref="553ptr" data-ref-filename="553ptr">ptr</a>; <a class="local col3 ref" href="#553ptr" title='ptr' data-ref="553ptr" data-ref-filename="553ptr">ptr</a> = <a class="local col3 ref" href="#553ptr" title='ptr' data-ref="553ptr" data-ref-filename="553ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::next" title='service_instance::next' data-ref="service_instance::next" data-ref-filename="service_instance..next">next</a>)</td></tr>
<tr><th id="5329">5329</th><td>        {</td></tr>
<tr><th id="5330">5330</th><td>            <b>if</b> (!<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#1601" title="((&amp;ptr-&gt;srs.RR_SRV)-&gt;resrec.InterfaceID == mDNSInterface_Any &amp;&amp; !(&amp;ptr-&gt;srs.RR_SRV)-&gt;ForceMCast &amp;&amp; !IsLocalDomain((&amp;ptr-&gt;srs.RR_SRV)-&gt;resrec.name))" data-ref="_M/AuthRecord_uDNS">AuthRecord_uDNS</a>(&amp;<a class="local col3 ref" href="#553ptr" title='ptr' data-ref="553ptr" data-ref-filename="553ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_SRV" title='ServiceRecordSet_struct::RR_SRV' data-ref="ServiceRecordSet_struct::RR_SRV" data-ref-filename="ServiceRecordSet_struct..RR_SRV">RR_SRV</a>))</td></tr>
<tr><th id="5331">5331</th><td>                <a class="tu ref" href="#n_mrecords" title='n_mrecords' data-use='w' data-ref="n_mrecords" data-ref-filename="n_mrecords">n_mrecords</a>++;</td></tr>
<tr><th id="5332">5332</th><td>        }</td></tr>
<tr><th id="5333">5333</th><td>    }</td></tr>
<tr><th id="5334">5334</th><td>    <b>else</b> <b>if</b> (<a class="local col8 ref" href="#548req" title='req' data-ref="548req" data-ref-filename="548req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> == <a class="ref fn" href="#browse_termination_callback" title='browse_termination_callback' data-ref="browse_termination_callback" data-ref-filename="browse_termination_callback">browse_termination_callback</a>)</td></tr>
<tr><th id="5335">5335</th><td>    {</td></tr>
<tr><th id="5336">5336</th><td>        <a class="typedef" href="uds_daemon.h.html#browser_t" title='browser_t' data-type='struct browser_t' data-ref="browser_t" data-ref-filename="browser_t">browser_t</a> *<dfn class="local col4 decl" id="554blist" title='blist' data-type='browser_t *' data-ref="554blist" data-ref-filename="554blist">blist</dfn>;</td></tr>
<tr><th id="5337">5337</th><td>        <b>for</b> (<a class="local col4 ref" href="#554blist" title='blist' data-ref="554blist" data-ref-filename="554blist">blist</a> = <a class="local col8 ref" href="#548req" title='req' data-ref="548req" data-ref-filename="548req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::browsers" title='request_state::(anonymous union)::(anonymous struct)::browsers' data-ref="request_state::(anonymousunion)::(anonymous)::browsers" data-ref-filename="request_state..(anonymousunion)..(anonymous)..browsers">browsers</a>; <a class="local col4 ref" href="#554blist" title='blist' data-ref="554blist" data-ref-filename="554blist">blist</a>; <a class="local col4 ref" href="#554blist" title='blist' data-ref="554blist" data-ref-filename="554blist">blist</a> = <a class="local col4 ref" href="#554blist" title='blist' data-ref="554blist" data-ref-filename="554blist">blist</a>-&gt;<a class="ref field" href="uds_daemon.h.html#browser_t::next" title='browser_t::next' data-ref="browser_t::next" data-ref-filename="browser_t..next">next</a>)</td></tr>
<tr><th id="5338">5338</th><td>        {</td></tr>
<tr><th id="5339">5339</th><td>            <b>if</b> (<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2964" title="((blist-&gt;q.TargetQID).NotAnInteger == 0)" data-ref="_M/mDNSOpaque16IsZero">mDNSOpaque16IsZero</a>(<a class="local col4 ref" href="#554blist" title='blist' data-ref="554blist" data-ref-filename="554blist">blist</a>-&gt;<a class="ref field" href="uds_daemon.h.html#browser_t::q" title='browser_t::q' data-ref="browser_t::q" data-ref-filename="browser_t..q">q</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::TargetQID" title='DNSQuestion_struct::TargetQID' data-ref="DNSQuestion_struct::TargetQID" data-ref-filename="DNSQuestion_struct..TargetQID">TargetQID</a>))</td></tr>
<tr><th id="5340">5340</th><td>                <a class="tu ref" href="#n_mquests" title='n_mquests' data-use='w' data-ref="n_mquests" data-ref-filename="n_mquests">n_mquests</a>++;</td></tr>
<tr><th id="5341">5341</th><td>        }</td></tr>
<tr><th id="5342">5342</th><td>    }</td></tr>
<tr><th id="5343">5343</th><td>    <b>else</b> <b>if</b> (<a class="local col8 ref" href="#548req" title='req' data-ref="548req" data-ref-filename="548req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> == <a class="ref fn" href="#resolve_termination_callback" title='resolve_termination_callback' data-ref="resolve_termination_callback" data-ref-filename="resolve_termination_callback">resolve_termination_callback</a>)</td></tr>
<tr><th id="5344">5344</th><td>    {</td></tr>
<tr><th id="5345">5345</th><td>        <b>if</b> ((<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2964" title="((req-&gt;u.resolve.qsrv.TargetQID).NotAnInteger == 0)" data-ref="_M/mDNSOpaque16IsZero">mDNSOpaque16IsZero</a>(<a class="local col8 ref" href="#548req" title='req' data-ref="548req" data-ref-filename="548req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::TargetQID" title='DNSQuestion_struct::TargetQID' data-ref="DNSQuestion_struct::TargetQID" data-ref-filename="DNSQuestion_struct..TargetQID">TargetQID</a>)) &amp;&amp; (<a class="local col8 ref" href="#548req" title='req' data-ref="548req" data-ref-filename="548req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ThisQInterval" title='DNSQuestion_struct::ThisQInterval' data-ref="DNSQuestion_struct::ThisQInterval" data-ref-filename="DNSQuestion_struct..ThisQInterval">ThisQInterval</a> &gt; <var>0</var>))</td></tr>
<tr><th id="5346">5346</th><td>            <a class="tu ref" href="#n_mquests" title='n_mquests' data-use='w' data-ref="n_mquests" data-ref-filename="n_mquests">n_mquests</a>++;</td></tr>
<tr><th id="5347">5347</th><td>    }</td></tr>
<tr><th id="5348">5348</th><td>    <b>else</b> <b>if</b> (<a class="local col8 ref" href="#548req" title='req' data-ref="548req" data-ref-filename="548req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> == <a class="ref fn" href="#queryrecord_termination_callback" title='queryrecord_termination_callback' data-ref="queryrecord_termination_callback" data-ref-filename="queryrecord_termination_callback">queryrecord_termination_callback</a>)</td></tr>
<tr><th id="5349">5349</th><td>    {</td></tr>
<tr><th id="5350">5350</th><td>        <b>if</b> ((<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2964" title="((req-&gt;u.queryrecord.q.TargetQID).NotAnInteger == 0)" data-ref="_M/mDNSOpaque16IsZero">mDNSOpaque16IsZero</a>(<a class="local col8 ref" href="#548req" title='req' data-ref="548req" data-ref-filename="548req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q" title='request_state::(anonymous union)::(anonymous struct)::q' data-ref="request_state::(anonymousunion)::(anonymous)::q" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q">q</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::TargetQID" title='DNSQuestion_struct::TargetQID' data-ref="DNSQuestion_struct::TargetQID" data-ref-filename="DNSQuestion_struct..TargetQID">TargetQID</a>)) &amp;&amp; (<a class="local col8 ref" href="#548req" title='req' data-ref="548req" data-ref-filename="548req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q" title='request_state::(anonymous union)::(anonymous struct)::q' data-ref="request_state::(anonymousunion)::(anonymous)::q" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q">q</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ThisQInterval" title='DNSQuestion_struct::ThisQInterval' data-ref="DNSQuestion_struct::ThisQInterval" data-ref-filename="DNSQuestion_struct..ThisQInterval">ThisQInterval</a> &gt; <var>0</var>))</td></tr>
<tr><th id="5351">5351</th><td>            <a class="tu ref" href="#n_mquests" title='n_mquests' data-use='w' data-ref="n_mquests" data-ref-filename="n_mquests">n_mquests</a>++;</td></tr>
<tr><th id="5352">5352</th><td>    }</td></tr>
<tr><th id="5353">5353</th><td>    <b>else</b> <b>if</b> (<a class="local col8 ref" href="#548req" title='req' data-ref="548req" data-ref-filename="548req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> == <a class="ref fn" href="#addrinfo_termination_callback" title='addrinfo_termination_callback' data-ref="addrinfo_termination_callback" data-ref-filename="addrinfo_termination_callback">addrinfo_termination_callback</a>)</td></tr>
<tr><th id="5354">5354</th><td>    {</td></tr>
<tr><th id="5355">5355</th><td>        <b>if</b> ((<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2964" title="((req-&gt;u.addrinfo.q4.TargetQID).NotAnInteger == 0)" data-ref="_M/mDNSOpaque16IsZero">mDNSOpaque16IsZero</a>(<a class="local col8 ref" href="#548req" title='req' data-ref="548req" data-ref-filename="548req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::TargetQID" title='DNSQuestion_struct::TargetQID' data-ref="DNSQuestion_struct::TargetQID" data-ref-filename="DNSQuestion_struct..TargetQID">TargetQID</a>)) &amp;&amp; (<a class="local col8 ref" href="#548req" title='req' data-ref="548req" data-ref-filename="548req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ThisQInterval" title='DNSQuestion_struct::ThisQInterval' data-ref="DNSQuestion_struct::ThisQInterval" data-ref-filename="DNSQuestion_struct..ThisQInterval">ThisQInterval</a> &gt; <var>0</var>))</td></tr>
<tr><th id="5356">5356</th><td>            <a class="tu ref" href="#n_mquests" title='n_mquests' data-use='w' data-ref="n_mquests" data-ref-filename="n_mquests">n_mquests</a>++;</td></tr>
<tr><th id="5357">5357</th><td>    }</td></tr>
<tr><th id="5358">5358</th><td>    <b>else</b></td></tr>
<tr><th id="5359">5359</th><td>    {</td></tr>
<tr><th id="5360">5360</th><td>        <b>return</b>;</td></tr>
<tr><th id="5361">5361</th><td>    }</td></tr>
<tr><th id="5362">5362</th><td>}</td></tr>
<tr><th id="5363">5363</th><td></td></tr>
<tr><th id="5364">5364</th><td></td></tr>
<tr><th id="5365">5365</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="LogMcastClientInfo" title='LogMcastClientInfo' data-ref="LogMcastClientInfo" data-ref-filename="LogMcastClientInfo">LogMcastClientInfo</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col5 decl" id="555req" title='req' data-type='request_state *' data-ref="555req" data-ref-filename="555req">req</dfn>)</td></tr>
<tr><th id="5366">5366</th><td>{</td></tr>
<tr><th id="5367">5367</th><td>    <b>if</b> (!<a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a>)</td></tr>
<tr><th id="5368">5368</th><td>        <a class="macro" href="uds_daemon.h.html#227" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMsg" data-ref="_M/LogMcastNoIdent">LogMcastNoIdent</a>(<q>"No operation yet on this socket"</q>);</td></tr>
<tr><th id="5369">5369</th><td>    <b>else</b> <b>if</b> (<a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> == <a class="ref fn" href="#connection_termination" title='connection_termination' data-ref="connection_termination" data-ref-filename="connection_termination">connection_termination</a>)</td></tr>
<tr><th id="5370">5370</th><td>    {</td></tr>
<tr><th id="5371">5371</th><td>        <em>int</em> <dfn class="local col6 decl" id="556num_records" title='num_records' data-type='int' data-ref="556num_records" data-ref-filename="556num_records">num_records</dfn> = <var>0</var>, <dfn class="local col7 decl" id="557num_ops" title='num_ops' data-type='int' data-ref="557num_ops" data-ref-filename="557num_ops">num_ops</dfn> = <var>0</var>;</td></tr>
<tr><th id="5372">5372</th><td>        <em>const</em> <a class="typedef" href="uds_daemon.h.html#registered_record_entry" title='registered_record_entry' data-type='struct registered_record_entry' data-ref="registered_record_entry" data-ref-filename="registered_record_entry">registered_record_entry</a> *<dfn class="local col8 decl" id="558p" title='p' data-type='const registered_record_entry *' data-ref="558p" data-ref-filename="558p">p</dfn>;</td></tr>
<tr><th id="5373">5373</th><td>        <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col9 decl" id="559r" title='r' data-type='request_state *' data-ref="559r" data-ref-filename="559r">r</dfn>;</td></tr>
<tr><th id="5374">5374</th><td>        <b>for</b> (<a class="local col8 ref" href="#558p" title='p' data-ref="558p" data-ref-filename="558p">p</a> = <a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::reg_recs" title='request_state::(anonymous union)::reg_recs' data-ref="request_state::(anonymous)::reg_recs" data-ref-filename="request_state..(anonymous)..reg_recs">reg_recs</a>; <a class="local col8 ref" href="#558p" title='p' data-ref="558p" data-ref-filename="558p">p</a>; <a class="local col8 ref" href="#558p" title='p' data-ref="558p" data-ref-filename="558p">p</a>=<a class="local col8 ref" href="#558p" title='p' data-ref="558p" data-ref-filename="558p">p</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::next" title='registered_record_entry::next' data-ref="registered_record_entry::next" data-ref-filename="registered_record_entry..next">next</a>)</td></tr>
<tr><th id="5375">5375</th><td>            <a class="local col6 ref" href="#556num_records" title='num_records' data-ref="556num_records" data-ref-filename="556num_records">num_records</a>++;</td></tr>
<tr><th id="5376">5376</th><td>        <b>for</b> (<a class="local col9 ref" href="#559r" title='r' data-ref="559r" data-ref-filename="559r">r</a> = <a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::next" title='request_state::next' data-ref="request_state::next" data-ref-filename="request_state..next">next</a>; <a class="local col9 ref" href="#559r" title='r' data-ref="559r" data-ref-filename="559r">r</a>; <a class="local col9 ref" href="#559r" title='r' data-ref="559r" data-ref-filename="559r">r</a>=<a class="local col9 ref" href="#559r" title='r' data-ref="559r" data-ref-filename="559r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::next" title='request_state::next' data-ref="request_state::next" data-ref-filename="request_state..next">next</a>)</td></tr>
<tr><th id="5377">5377</th><td>            <b>if</b> (<a class="local col9 ref" href="#559r" title='r' data-ref="559r" data-ref-filename="559r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::primary" title='request_state::primary' data-ref="request_state::primary" data-ref-filename="request_state..primary">primary</a> == <a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>)</td></tr>
<tr><th id="5378">5378</th><td>                <a class="local col7 ref" href="#557num_ops" title='num_ops' data-ref="557num_ops" data-ref-filename="557num_ops">num_ops</a>++;</td></tr>
<tr><th id="5379">5379</th><td>        <b>for</b> (<a class="local col8 ref" href="#558p" title='p' data-ref="558p" data-ref-filename="558p">p</a> = <a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::reg_recs" title='request_state::(anonymous union)::reg_recs' data-ref="request_state::(anonymous)::reg_recs" data-ref-filename="request_state..(anonymous)..reg_recs">reg_recs</a>; <a class="local col8 ref" href="#558p" title='p' data-ref="558p" data-ref-filename="558p">p</a>; <a class="local col8 ref" href="#558p" title='p' data-ref="558p" data-ref-filename="558p">p</a>=<a class="local col8 ref" href="#558p" title='p' data-ref="558p" data-ref-filename="558p">p</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::next" title='registered_record_entry::next' data-ref="registered_record_entry::next" data-ref-filename="registered_record_entry..next">next</a>)</td></tr>
<tr><th id="5380">5380</th><td>        {</td></tr>
<tr><th id="5381">5381</th><td>            <b>if</b> (!<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#1601" title="((p-&gt;rr)-&gt;resrec.InterfaceID == mDNSInterface_Any &amp;&amp; !(p-&gt;rr)-&gt;ForceMCast &amp;&amp; !IsLocalDomain((p-&gt;rr)-&gt;resrec.name))" data-ref="_M/AuthRecord_uDNS">AuthRecord_uDNS</a>(<a class="local col8 ref" href="#558p" title='p' data-ref="558p" data-ref-filename="558p">p</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::rr" title='registered_record_entry::rr' data-ref="registered_record_entry::rr" data-ref-filename="registered_record_entry..rr">rr</a>))</td></tr>
<tr><th id="5382">5382</th><td>                <a class="macro" href="uds_daemon.h.html#227" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMsg" data-ref="_M/LogMcastNoIdent">LogMcastNoIdent</a>(<q>"R: -&gt;  DNSServiceRegisterRecord:  %##s %s PID[%d](%s)"</q>, <a class="local col8 ref" href="#558p" title='p' data-ref="558p" data-ref-filename="558p">p</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::rr" title='registered_record_entry::rr' data-ref="registered_record_entry::rr" data-ref-filename="registered_record_entry..rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::name" title='ResourceRecord_struct::name' data-ref="ResourceRecord_struct::name" data-ref-filename="ResourceRecord_struct..name">name</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>,</td></tr>
<tr><th id="5383">5383</th><td>                                <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col8 ref" href="#558p" title='p' data-ref="558p" data-ref-filename="558p">p</a>-&gt;<a class="ref field" href="uds_daemon.h.html#registered_record_entry::rr" title='registered_record_entry::rr' data-ref="registered_record_entry::rr" data-ref-filename="registered_record_entry..rr">rr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rrtype" title='ResourceRecord_struct::rrtype' data-ref="ResourceRecord_struct::rrtype" data-ref-filename="ResourceRecord_struct..rrtype">rrtype</a>), <a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>, <a class="tu ref" href="#i_mcount" title='i_mcount' data-use='w' data-ref="i_mcount" data-ref-filename="i_mcount">i_mcount</a>++);</td></tr>
<tr><th id="5384">5384</th><td>        }</td></tr>
<tr><th id="5385">5385</th><td>        <b>for</b> (<a class="local col9 ref" href="#559r" title='r' data-ref="559r" data-ref-filename="559r">r</a> = <a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::next" title='request_state::next' data-ref="request_state::next" data-ref-filename="request_state..next">next</a>; <a class="local col9 ref" href="#559r" title='r' data-ref="559r" data-ref-filename="559r">r</a>; <a class="local col9 ref" href="#559r" title='r' data-ref="559r" data-ref-filename="559r">r</a>=<a class="local col9 ref" href="#559r" title='r' data-ref="559r" data-ref-filename="559r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::next" title='request_state::next' data-ref="request_state::next" data-ref-filename="request_state..next">next</a>)</td></tr>
<tr><th id="5386">5386</th><td>            <b>if</b> (<a class="local col9 ref" href="#559r" title='r' data-ref="559r" data-ref-filename="559r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::primary" title='request_state::primary' data-ref="request_state::primary" data-ref-filename="request_state..primary">primary</a> == <a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>)</td></tr>
<tr><th id="5387">5387</th><td>                <a class="ref fn" href="#LogMcastClientInfo" title='LogMcastClientInfo' data-ref="LogMcastClientInfo" data-ref-filename="LogMcastClientInfo">LogMcastClientInfo</a>(<a class="local col9 ref" href="#559r" title='r' data-ref="559r" data-ref-filename="559r">r</a>);</td></tr>
<tr><th id="5388">5388</th><td>    }</td></tr>
<tr><th id="5389">5389</th><td>    <b>else</b> <b>if</b> (<a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> == <a class="ref fn" href="#regservice_termination_callback" title='regservice_termination_callback' data-ref="regservice_termination_callback" data-ref-filename="regservice_termination_callback">regservice_termination_callback</a>)</td></tr>
<tr><th id="5390">5390</th><td>    {</td></tr>
<tr><th id="5391">5391</th><td>        <a class="typedef" href="uds_daemon.h.html#service_instance" title='service_instance' data-type='struct service_instance' data-ref="service_instance" data-ref-filename="service_instance">service_instance</a> *<dfn class="local col0 decl" id="560ptr" title='ptr' data-type='service_instance *' data-ref="560ptr" data-ref-filename="560ptr">ptr</dfn>;</td></tr>
<tr><th id="5392">5392</th><td>        <b>for</b> (<a class="local col0 ref" href="#560ptr" title='ptr' data-ref="560ptr" data-ref-filename="560ptr">ptr</a> = <a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::instances" title='request_state::(anonymous union)::(anonymous struct)::instances' data-ref="request_state::(anonymousunion)::(anonymous)::instances" data-ref-filename="request_state..(anonymousunion)..(anonymous)..instances">instances</a>; <a class="local col0 ref" href="#560ptr" title='ptr' data-ref="560ptr" data-ref-filename="560ptr">ptr</a>; <a class="local col0 ref" href="#560ptr" title='ptr' data-ref="560ptr" data-ref-filename="560ptr">ptr</a> = <a class="local col0 ref" href="#560ptr" title='ptr' data-ref="560ptr" data-ref-filename="560ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::next" title='service_instance::next' data-ref="service_instance::next" data-ref-filename="service_instance..next">next</a>)</td></tr>
<tr><th id="5393">5393</th><td>        {</td></tr>
<tr><th id="5394">5394</th><td>            <b>if</b> (!<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#1601" title="((&amp;ptr-&gt;srs.RR_SRV)-&gt;resrec.InterfaceID == mDNSInterface_Any &amp;&amp; !(&amp;ptr-&gt;srs.RR_SRV)-&gt;ForceMCast &amp;&amp; !IsLocalDomain((&amp;ptr-&gt;srs.RR_SRV)-&gt;resrec.name))" data-ref="_M/AuthRecord_uDNS">AuthRecord_uDNS</a>(&amp;<a class="local col0 ref" href="#560ptr" title='ptr' data-ref="560ptr" data-ref-filename="560ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_SRV" title='ServiceRecordSet_struct::RR_SRV' data-ref="ServiceRecordSet_struct::RR_SRV" data-ref-filename="ServiceRecordSet_struct..RR_SRV">RR_SRV</a>))</td></tr>
<tr><th id="5395">5395</th><td>                <a class="macro" href="uds_daemon.h.html#227" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMsg" data-ref="_M/LogMcastNoIdent">LogMcastNoIdent</a>(<q>"R: DNSServiceRegister:  %##s %u/%u PID[%d](%s)"</q>, <a class="local col0 ref" href="#560ptr" title='ptr' data-ref="560ptr" data-ref-filename="560ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_SRV" title='ServiceRecordSet_struct::RR_SRV' data-ref="ServiceRecordSet_struct::RR_SRV" data-ref-filename="ServiceRecordSet_struct..RR_SRV">RR_SRV</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::name" title='ResourceRecord_struct::name' data-ref="ResourceRecord_struct::name" data-ref-filename="ResourceRecord_struct..name">name</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSVal16" title='mDNSVal16' data-ref="mDNSVal16" data-ref-filename="mDNSVal16">mDNSVal16</a>(<a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::servicereg" title='request_state::(anonymous union)::servicereg' data-ref="request_state::(anonymous)::servicereg" data-ref-filename="request_state..(anonymous)..servicereg">servicereg</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::port" title='request_state::(anonymous union)::(anonymous struct)::port' data-ref="request_state::(anonymousunion)::(anonymous)::port" data-ref-filename="request_state..(anonymousunion)..(anonymous)..port">port</a>),</td></tr>
<tr><th id="5396">5396</th><td>                                <a class="macro" href="uds_daemon.h.html#214" title="mDNSVal16((&amp;ptr-&gt;srs)-&gt;RR_SRV.resrec.rdata-&gt;u.srv.port)" data-ref="_M/SRS_PORT">SRS_PORT</a>(&amp;<a class="local col0 ref" href="#560ptr" title='ptr' data-ref="560ptr" data-ref-filename="560ptr">ptr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#service_instance::srs" title='service_instance::srs' data-ref="service_instance::srs" data-ref-filename="service_instance..srs">srs</a>), <a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>, <a class="tu ref" href="#i_mcount" title='i_mcount' data-use='w' data-ref="i_mcount" data-ref-filename="i_mcount">i_mcount</a>++);</td></tr>
<tr><th id="5397">5397</th><td>        }</td></tr>
<tr><th id="5398">5398</th><td>    }</td></tr>
<tr><th id="5399">5399</th><td>    <b>else</b> <b>if</b> (<a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> == <a class="ref fn" href="#browse_termination_callback" title='browse_termination_callback' data-ref="browse_termination_callback" data-ref-filename="browse_termination_callback">browse_termination_callback</a>)</td></tr>
<tr><th id="5400">5400</th><td>    {</td></tr>
<tr><th id="5401">5401</th><td>        <a class="typedef" href="uds_daemon.h.html#browser_t" title='browser_t' data-type='struct browser_t' data-ref="browser_t" data-ref-filename="browser_t">browser_t</a> *<dfn class="local col1 decl" id="561blist" title='blist' data-type='browser_t *' data-ref="561blist" data-ref-filename="561blist">blist</dfn>;</td></tr>
<tr><th id="5402">5402</th><td>        <b>for</b> (<a class="local col1 ref" href="#561blist" title='blist' data-ref="561blist" data-ref-filename="561blist">blist</a> = <a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::browser" title='request_state::(anonymous union)::browser' data-ref="request_state::(anonymous)::browser" data-ref-filename="request_state..(anonymous)..browser">browser</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::browsers" title='request_state::(anonymous union)::(anonymous struct)::browsers' data-ref="request_state::(anonymousunion)::(anonymous)::browsers" data-ref-filename="request_state..(anonymousunion)..(anonymous)..browsers">browsers</a>; <a class="local col1 ref" href="#561blist" title='blist' data-ref="561blist" data-ref-filename="561blist">blist</a>; <a class="local col1 ref" href="#561blist" title='blist' data-ref="561blist" data-ref-filename="561blist">blist</a> = <a class="local col1 ref" href="#561blist" title='blist' data-ref="561blist" data-ref-filename="561blist">blist</a>-&gt;<a class="ref field" href="uds_daemon.h.html#browser_t::next" title='browser_t::next' data-ref="browser_t::next" data-ref-filename="browser_t..next">next</a>)</td></tr>
<tr><th id="5403">5403</th><td>        {</td></tr>
<tr><th id="5404">5404</th><td>            <b>if</b> (<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2964" title="((blist-&gt;q.TargetQID).NotAnInteger == 0)" data-ref="_M/mDNSOpaque16IsZero">mDNSOpaque16IsZero</a>(<a class="local col1 ref" href="#561blist" title='blist' data-ref="561blist" data-ref-filename="561blist">blist</a>-&gt;<a class="ref field" href="uds_daemon.h.html#browser_t::q" title='browser_t::q' data-ref="browser_t::q" data-ref-filename="browser_t..q">q</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::TargetQID" title='DNSQuestion_struct::TargetQID' data-ref="DNSQuestion_struct::TargetQID" data-ref-filename="DNSQuestion_struct..TargetQID">TargetQID</a>))</td></tr>
<tr><th id="5405">5405</th><td>                <a class="macro" href="uds_daemon.h.html#227" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMsg" data-ref="_M/LogMcastNoIdent">LogMcastNoIdent</a>(<q>"Q: DNSServiceBrowse  %##s %s PID[%d](%s)"</q>, <a class="local col1 ref" href="#561blist" title='blist' data-ref="561blist" data-ref-filename="561blist">blist</a>-&gt;<a class="ref field" href="uds_daemon.h.html#browser_t::q" title='browser_t::q' data-ref="browser_t::q" data-ref-filename="browser_t..q">q</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col1 ref" href="#561blist" title='blist' data-ref="561blist" data-ref-filename="561blist">blist</a>-&gt;<a class="ref field" href="uds_daemon.h.html#browser_t::q" title='browser_t::q' data-ref="browser_t::q" data-ref-filename="browser_t..q">q</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a>),</td></tr>
<tr><th id="5406">5406</th><td>                                <a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>, <a class="tu ref" href="#i_mcount" title='i_mcount' data-use='w' data-ref="i_mcount" data-ref-filename="i_mcount">i_mcount</a>++);</td></tr>
<tr><th id="5407">5407</th><td>        }</td></tr>
<tr><th id="5408">5408</th><td>    }</td></tr>
<tr><th id="5409">5409</th><td>    <b>else</b> <b>if</b> (<a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> == <a class="ref fn" href="#resolve_termination_callback" title='resolve_termination_callback' data-ref="resolve_termination_callback" data-ref-filename="resolve_termination_callback">resolve_termination_callback</a>)</td></tr>
<tr><th id="5410">5410</th><td>    {</td></tr>
<tr><th id="5411">5411</th><td>        <b>if</b> ((<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2964" title="((req-&gt;u.resolve.qsrv.TargetQID).NotAnInteger == 0)" data-ref="_M/mDNSOpaque16IsZero">mDNSOpaque16IsZero</a>(<a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::TargetQID" title='DNSQuestion_struct::TargetQID' data-ref="DNSQuestion_struct::TargetQID" data-ref-filename="DNSQuestion_struct..TargetQID">TargetQID</a>)) &amp;&amp; (<a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ThisQInterval" title='DNSQuestion_struct::ThisQInterval' data-ref="DNSQuestion_struct::ThisQInterval" data-ref-filename="DNSQuestion_struct..ThisQInterval">ThisQInterval</a> &gt; <var>0</var>))</td></tr>
<tr><th id="5412">5412</th><td>            <a class="macro" href="uds_daemon.h.html#227" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMsg" data-ref="_M/LogMcastNoIdent">LogMcastNoIdent</a>(<q>"Q: DNSServiceResolve  %##s %s PID[%d](%s)"</q>, <a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a>),</td></tr>
<tr><th id="5413">5413</th><td>                            <a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>, <a class="tu ref" href="#i_mcount" title='i_mcount' data-use='w' data-ref="i_mcount" data-ref-filename="i_mcount">i_mcount</a>++);</td></tr>
<tr><th id="5414">5414</th><td>    }</td></tr>
<tr><th id="5415">5415</th><td>    <b>else</b> <b>if</b> (<a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> == <a class="ref fn" href="#queryrecord_termination_callback" title='queryrecord_termination_callback' data-ref="queryrecord_termination_callback" data-ref-filename="queryrecord_termination_callback">queryrecord_termination_callback</a>)</td></tr>
<tr><th id="5416">5416</th><td>    {</td></tr>
<tr><th id="5417">5417</th><td>        <b>if</b> ((<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2964" title="((req-&gt;u.queryrecord.q.TargetQID).NotAnInteger == 0)" data-ref="_M/mDNSOpaque16IsZero">mDNSOpaque16IsZero</a>(<a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q" title='request_state::(anonymous union)::(anonymous struct)::q' data-ref="request_state::(anonymousunion)::(anonymous)::q" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q">q</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::TargetQID" title='DNSQuestion_struct::TargetQID' data-ref="DNSQuestion_struct::TargetQID" data-ref-filename="DNSQuestion_struct..TargetQID">TargetQID</a>)) &amp;&amp; (<a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q" title='request_state::(anonymous union)::(anonymous struct)::q' data-ref="request_state::(anonymousunion)::(anonymous)::q" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q">q</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ThisQInterval" title='DNSQuestion_struct::ThisQInterval' data-ref="DNSQuestion_struct::ThisQInterval" data-ref-filename="DNSQuestion_struct..ThisQInterval">ThisQInterval</a> &gt; <var>0</var>))</td></tr>
<tr><th id="5418">5418</th><td>            <a class="macro" href="uds_daemon.h.html#227" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMsg" data-ref="_M/LogMcastNoIdent">LogMcastNoIdent</a>(<q>"Q: DNSServiceQueryRecord  %##s %s PID[%d](%s)"</q>, <a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q" title='request_state::(anonymous union)::(anonymous struct)::q' data-ref="request_state::(anonymousunion)::(anonymous)::q" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q">q</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::queryrecord" title='request_state::(anonymous union)::queryrecord' data-ref="request_state::(anonymous)::queryrecord" data-ref-filename="request_state..(anonymous)..queryrecord">queryrecord</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q" title='request_state::(anonymous union)::(anonymous struct)::q' data-ref="request_state::(anonymousunion)::(anonymous)::q" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q">q</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a>),</td></tr>
<tr><th id="5419">5419</th><td>                          <a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>, <a class="tu ref" href="#i_mcount" title='i_mcount' data-use='w' data-ref="i_mcount" data-ref-filename="i_mcount">i_mcount</a>++);</td></tr>
<tr><th id="5420">5420</th><td>    }</td></tr>
<tr><th id="5421">5421</th><td>    <b>else</b> <b>if</b> (<a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> == <a class="ref fn" href="#addrinfo_termination_callback" title='addrinfo_termination_callback' data-ref="addrinfo_termination_callback" data-ref-filename="addrinfo_termination_callback">addrinfo_termination_callback</a>)</td></tr>
<tr><th id="5422">5422</th><td>    {</td></tr>
<tr><th id="5423">5423</th><td>        <b>if</b> ((<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2964" title="((req-&gt;u.addrinfo.q4.TargetQID).NotAnInteger == 0)" data-ref="_M/mDNSOpaque16IsZero">mDNSOpaque16IsZero</a>(<a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::TargetQID" title='DNSQuestion_struct::TargetQID' data-ref="DNSQuestion_struct::TargetQID" data-ref-filename="DNSQuestion_struct..TargetQID">TargetQID</a>)) &amp;&amp; (<a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ThisQInterval" title='DNSQuestion_struct::ThisQInterval' data-ref="DNSQuestion_struct::ThisQInterval" data-ref-filename="DNSQuestion_struct..ThisQInterval">ThisQInterval</a> &gt; <var>0</var>))</td></tr>
<tr><th id="5424">5424</th><td>            <a class="macro" href="uds_daemon.h.html#227" title="(mDNS_McastLoggingEnabled == 0) ? ((void)0) : LogMsg" data-ref="_M/LogMcastNoIdent">LogMcastNoIdent</a>(<q>"Q: DNSServiceGetAddrInfo  %s%s %##s PID[%d](%s)"</q>,</td></tr>
<tr><th id="5425">5425</th><td>                          <a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::protocol" title='request_state::(anonymous union)::(anonymous struct)::protocol' data-ref="request_state::(anonymousunion)::(anonymous)::protocol" data-ref-filename="request_state..(anonymousunion)..(anonymous)..protocol">protocol</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceProtocol_IPv4" title='kDNSServiceProtocol_IPv4' data-ref="kDNSServiceProtocol_IPv4" data-ref-filename="kDNSServiceProtocol_IPv4">kDNSServiceProtocol_IPv4</a> ? <q>"v4"</q> : <q>"  "</q>,</td></tr>
<tr><th id="5426">5426</th><td>                          <a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::protocol" title='request_state::(anonymous union)::(anonymous struct)::protocol' data-ref="request_state::(anonymousunion)::(anonymous)::protocol" data-ref-filename="request_state..(anonymousunion)..(anonymous)..protocol">protocol</a> &amp; <a class="enum" href="dns_sd.h.html#kDNSServiceProtocol_IPv6" title='kDNSServiceProtocol_IPv6' data-ref="kDNSServiceProtocol_IPv6" data-ref-filename="kDNSServiceProtocol_IPv6">kDNSServiceProtocol_IPv6</a> ? <q>"v6"</q> : <q>"  "</q>,</td></tr>
<tr><th id="5427">5427</th><td>                          <a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::addrinfo" title='request_state::(anonymous union)::addrinfo' data-ref="request_state::(anonymous)::addrinfo" data-ref-filename="request_state..(anonymous)..addrinfo">addrinfo</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::q4" title='request_state::(anonymous union)::(anonymous struct)::q4' data-ref="request_state::(anonymousunion)::(anonymous)::q4" data-ref-filename="request_state..(anonymousunion)..(anonymous)..q4">q4</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col5 ref" href="#555req" title='req' data-ref="555req" data-ref-filename="555req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>, <a class="tu ref" href="#i_mcount" title='i_mcount' data-use='w' data-ref="i_mcount" data-ref-filename="i_mcount">i_mcount</a>++);</td></tr>
<tr><th id="5428">5428</th><td>    }</td></tr>
<tr><th id="5429">5429</th><td>    <b>else</b></td></tr>
<tr><th id="5430">5430</th><td>    {</td></tr>
<tr><th id="5431">5431</th><td>        <b>return</b>;</td></tr>
<tr><th id="5432">5432</th><td>    }</td></tr>
<tr><th id="5433">5433</th><td></td></tr>
<tr><th id="5434">5434</th><td>}</td></tr>
<tr><th id="5435">5435</th><td></td></tr>
<tr><th id="5436">5436</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>char</em> *<dfn class="decl def fn" id="RecordTypeName" title='RecordTypeName' data-ref="RecordTypeName" data-ref-filename="RecordTypeName">RecordTypeName</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu8" title='mDNSu8' data-type='unsigned char' data-ref="mDNSu8" data-ref-filename="mDNSu8">mDNSu8</a> <dfn class="local col2 decl" id="562rtype" title='rtype' data-type='mDNSu8' data-ref="562rtype" data-ref-filename="562rtype">rtype</dfn>)</td></tr>
<tr><th id="5437">5437</th><td>{</td></tr>
<tr><th id="5438">5438</th><td>    <b>switch</b> (<a class="local col2 ref" href="#562rtype" title='rtype' data-ref="562rtype" data-ref-filename="562rtype">rtype</a>)</td></tr>
<tr><th id="5439">5439</th><td>    {</td></tr>
<tr><th id="5440">5440</th><td>    <b>case</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSRecordTypeUnregistered" title='kDNSRecordTypeUnregistered' data-ref="kDNSRecordTypeUnregistered" data-ref-filename="kDNSRecordTypeUnregistered">kDNSRecordTypeUnregistered</a>:  <b>return</b> (<q>"Unregistered "</q>);</td></tr>
<tr><th id="5441">5441</th><td>    <b>case</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSRecordTypeDeregistering" title='kDNSRecordTypeDeregistering' data-ref="kDNSRecordTypeDeregistering" data-ref-filename="kDNSRecordTypeDeregistering">kDNSRecordTypeDeregistering</a>: <b>return</b> (<q>"Deregistering"</q>);</td></tr>
<tr><th id="5442">5442</th><td>    <b>case</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSRecordTypeUnique" title='kDNSRecordTypeUnique' data-ref="kDNSRecordTypeUnique" data-ref-filename="kDNSRecordTypeUnique">kDNSRecordTypeUnique</a>:        <b>return</b> (<q>"Unique       "</q>);</td></tr>
<tr><th id="5443">5443</th><td>    <b>case</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSRecordTypeAdvisory" title='kDNSRecordTypeAdvisory' data-ref="kDNSRecordTypeAdvisory" data-ref-filename="kDNSRecordTypeAdvisory">kDNSRecordTypeAdvisory</a>:      <b>return</b> (<q>"Advisory     "</q>);</td></tr>
<tr><th id="5444">5444</th><td>    <b>case</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSRecordTypeShared" title='kDNSRecordTypeShared' data-ref="kDNSRecordTypeShared" data-ref-filename="kDNSRecordTypeShared">kDNSRecordTypeShared</a>:        <b>return</b> (<q>"Shared       "</q>);</td></tr>
<tr><th id="5445">5445</th><td>    <b>case</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSRecordTypeVerified" title='kDNSRecordTypeVerified' data-ref="kDNSRecordTypeVerified" data-ref-filename="kDNSRecordTypeVerified">kDNSRecordTypeVerified</a>:      <b>return</b> (<q>"Verified     "</q>);</td></tr>
<tr><th id="5446">5446</th><td>    <b>case</b> <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSRecordTypeKnownUnique" title='kDNSRecordTypeKnownUnique' data-ref="kDNSRecordTypeKnownUnique" data-ref-filename="kDNSRecordTypeKnownUnique">kDNSRecordTypeKnownUnique</a>:   <b>return</b> (<q>"KnownUnique  "</q>);</td></tr>
<tr><th id="5447">5447</th><td>    <b>default</b>: <b>return</b>(<q>"Unknown"</q>);</td></tr>
<tr><th id="5448">5448</th><td>    }</td></tr>
<tr><th id="5449">5449</th><td>}</td></tr>
<tr><th id="5450">5450</th><td></td></tr>
<tr><th id="5451">5451</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>int</em> <dfn class="decl def fn" id="LogEtcHosts" title='LogEtcHosts' data-ref="LogEtcHosts" data-ref-filename="LogEtcHosts">LogEtcHosts</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS" title='mDNS' data-type='struct mDNS_struct' data-ref="mDNS" data-ref-filename="mDNS">mDNS</a> *<em>const</em> <dfn class="local col3 decl" id="563m" title='m' data-type='mDNS *const' data-ref="563m" data-ref-filename="563m">m</dfn>)</td></tr>
<tr><th id="5452">5452</th><td>{</td></tr>
<tr><th id="5453">5453</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSBool" title='mDNSBool' data-type='unsigned char' data-ref="mDNSBool" data-ref-filename="mDNSBool">mDNSBool</a> <dfn class="local col4 decl" id="564showheader" title='showheader' data-type='mDNSBool' data-ref="564showheader" data-ref-filename="564showheader">showheader</dfn> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>;</td></tr>
<tr><th id="5454">5454</th><td>    <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord" title='AuthRecord' data-type='struct AuthRecord_struct' data-ref="AuthRecord" data-ref-filename="AuthRecord">AuthRecord</a> *<dfn class="local col5 decl" id="565ar" title='ar' data-type='const AuthRecord *' data-ref="565ar" data-ref-filename="565ar">ar</dfn>;</td></tr>
<tr><th id="5455">5455</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col6 decl" id="566slot" title='slot' data-type='mDNSu32' data-ref="566slot" data-ref-filename="566slot">slot</dfn>;</td></tr>
<tr><th id="5456">5456</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthGroup" title='AuthGroup' data-type='struct AuthGroup_struct' data-ref="AuthGroup" data-ref-filename="AuthGroup">AuthGroup</a> *<dfn class="local col7 decl" id="567ag" title='ag' data-type='AuthGroup *' data-ref="567ag" data-ref-filename="567ag">ag</dfn>;</td></tr>
<tr><th id="5457">5457</th><td>    <em>int</em> <dfn class="local col8 decl" id="568count" title='count' data-type='int' data-ref="568count" data-ref-filename="568count">count</dfn> = <var>0</var>;</td></tr>
<tr><th id="5458">5458</th><td>    <em>int</em> <dfn class="local col9 decl" id="569authslot" title='authslot' data-type='int' data-ref="569authslot" data-ref-filename="569authslot">authslot</dfn> = <var>0</var>;</td></tr>
<tr><th id="5459">5459</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSBool" title='mDNSBool' data-type='unsigned char' data-ref="mDNSBool" data-ref-filename="mDNSBool">mDNSBool</a> <dfn class="local col0 decl" id="570truncated" title='truncated' data-type='mDNSBool' data-ref="570truncated" data-ref-filename="570truncated">truncated</dfn> = <var>0</var>;</td></tr>
<tr><th id="5460">5460</th><td></td></tr>
<tr><th id="5461">5461</th><td>    <b>for</b> (<a class="local col6 ref" href="#566slot" title='slot' data-ref="566slot" data-ref-filename="566slot">slot</a> = <var>0</var>; <a class="local col6 ref" href="#566slot" title='slot' data-ref="566slot" data-ref-filename="566slot">slot</a> &lt; <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#1456" title="499" data-ref="_M/AUTH_HASH_SLOTS">AUTH_HASH_SLOTS</a>; <a class="local col6 ref" href="#566slot" title='slot' data-ref="566slot" data-ref-filename="566slot">slot</a>++)</td></tr>
<tr><th id="5462">5462</th><td>    {</td></tr>
<tr><th id="5463">5463</th><td>        <b>if</b> (<a class="local col3 ref" href="#563m" title='m' data-ref="563m" data-ref-filename="563m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::rrauth" title='mDNS_struct::rrauth' data-ref="mDNS_struct::rrauth" data-ref-filename="mDNS_struct..rrauth">rrauth</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::rrauth_hash" title='(anonymous struct)::rrauth_hash' data-ref="(anonymous)::rrauth_hash" data-ref-filename="(anonymous)..rrauth_hash">rrauth_hash</a>[<a class="local col6 ref" href="#566slot" title='slot' data-ref="566slot" data-ref-filename="566slot">slot</a>]) <a class="local col9 ref" href="#569authslot" title='authslot' data-ref="569authslot" data-ref-filename="569authslot">authslot</a>++;</td></tr>
<tr><th id="5464">5464</th><td>        <b>for</b> (<a class="local col7 ref" href="#567ag" title='ag' data-ref="567ag" data-ref-filename="567ag">ag</a> = <a class="local col3 ref" href="#563m" title='m' data-ref="563m" data-ref-filename="563m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::rrauth" title='mDNS_struct::rrauth' data-ref="mDNS_struct::rrauth" data-ref-filename="mDNS_struct..rrauth">rrauth</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::rrauth_hash" title='(anonymous struct)::rrauth_hash' data-ref="(anonymous)::rrauth_hash" data-ref-filename="(anonymous)..rrauth_hash">rrauth_hash</a>[<a class="local col6 ref" href="#566slot" title='slot' data-ref="566slot" data-ref-filename="566slot">slot</a>]; <a class="local col7 ref" href="#567ag" title='ag' data-ref="567ag" data-ref-filename="567ag">ag</a>; <a class="local col7 ref" href="#567ag" title='ag' data-ref="567ag" data-ref-filename="567ag">ag</a> = <a class="local col7 ref" href="#567ag" title='ag' data-ref="567ag" data-ref-filename="567ag">ag</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthGroup_struct::next" title='AuthGroup_struct::next' data-ref="AuthGroup_struct::next" data-ref-filename="AuthGroup_struct..next">next</a>)</td></tr>
<tr><th id="5465">5465</th><td>            <b>for</b> (<a class="local col5 ref" href="#565ar" title='ar' data-ref="565ar" data-ref-filename="565ar">ar</a> = <a class="local col7 ref" href="#567ag" title='ag' data-ref="567ag" data-ref-filename="567ag">ag</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthGroup_struct::members" title='AuthGroup_struct::members' data-ref="AuthGroup_struct::members" data-ref-filename="AuthGroup_struct..members">members</a>; <a class="local col5 ref" href="#565ar" title='ar' data-ref="565ar" data-ref-filename="565ar">ar</a>; <a class="local col5 ref" href="#565ar" title='ar' data-ref="565ar" data-ref-filename="565ar">ar</a> = <a class="local col5 ref" href="#565ar" title='ar' data-ref="565ar" data-ref-filename="565ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::next" title='AuthRecord_struct::next' data-ref="AuthRecord_struct::next" data-ref-filename="AuthRecord_struct..next">next</a>)</td></tr>
<tr><th id="5466">5466</th><td>            {</td></tr>
<tr><th id="5467">5467</th><td>                <b>if</b> (<a class="local col5 ref" href="#565ar" title='ar' data-ref="565ar" data-ref-filename="565ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::RecordCallback" title='AuthRecord_struct::RecordCallback' data-ref="AuthRecord_struct::RecordCallback" data-ref-filename="AuthRecord_struct..RecordCallback">RecordCallback</a> != <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#FreeEtcHosts" title='FreeEtcHosts' data-ref="FreeEtcHosts" data-ref-filename="FreeEtcHosts">FreeEtcHosts</a>) <b>continue</b>;</td></tr>
<tr><th id="5468">5468</th><td>                <b>if</b> (<a class="local col4 ref" href="#564showheader" title='showheader' data-ref="564showheader" data-ref-filename="564showheader">showheader</a>) { <a class="local col4 ref" href="#564showheader" title='showheader' data-ref="564showheader" data-ref-filename="564showheader">showheader</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>; <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"  State       Interface"</q>); }</td></tr>
<tr><th id="5469">5469</th><td></td></tr>
<tr><th id="5470">5470</th><td>                <i>// Print a maximum of 50 records</i></td></tr>
<tr><th id="5471">5471</th><td>                <b>if</b> (<a class="local col8 ref" href="#568count" title='count' data-ref="568count" data-ref-filename="568count">count</a>++ &gt;= <var>50</var>) { <a class="local col0 ref" href="#570truncated" title='truncated' data-ref="570truncated" data-ref-filename="570truncated">truncated</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>; <b>continue</b>; }</td></tr>
<tr><th id="5472">5472</th><td>                <b>if</b> (<a class="local col5 ref" href="#565ar" title='ar' data-ref="565ar" data-ref-filename="565ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::ARType" title='AuthRecord_struct::ARType' data-ref="AuthRecord_struct::ARType" data-ref-filename="AuthRecord_struct..ARType">ARType</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecordLocalOnly" title='AuthRecordLocalOnly' data-ref="AuthRecordLocalOnly" data-ref-filename="AuthRecordLocalOnly">AuthRecordLocalOnly</a>)</td></tr>
<tr><th id="5473">5473</th><td>                {</td></tr>
<tr><th id="5474">5474</th><td>                    <b>if</b> (<a class="local col5 ref" href="#565ar" title='ar' data-ref="565ar" data-ref-filename="565ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::InterfaceID" title='ResourceRecord_struct::InterfaceID' data-ref="ResourceRecord_struct::InterfaceID" data-ref-filename="ResourceRecord_struct..InterfaceID">InterfaceID</a> == <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterface_LocalOnly" title='mDNSInterface_LocalOnly' data-ref="mDNSInterface_LocalOnly" data-ref-filename="mDNSInterface_LocalOnly">mDNSInterface_LocalOnly</a>)</td></tr>
<tr><th id="5475">5475</th><td>                        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>" %s   LO %s"</q>, <a class="ref fn" href="#RecordTypeName" title='RecordTypeName' data-ref="RecordTypeName" data-ref-filename="RecordTypeName">RecordTypeName</a>(<a class="local col5 ref" href="#565ar" title='ar' data-ref="565ar" data-ref-filename="565ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::RecordType" title='ResourceRecord_struct::RecordType' data-ref="ResourceRecord_struct::RecordType" data-ref-filename="ResourceRecord_struct..RecordType">RecordType</a>), <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2942" title="GetRRDisplayString_rdb(&amp;(ar)-&gt;resrec, &amp;(ar)-&gt;resrec.rdata-&gt;u, (m)-&gt;MsgBuffer)" data-ref="_M/ARDisplayString">ARDisplayString</a>(<a class="local col3 ref" href="#563m" title='m' data-ref="563m" data-ref-filename="563m">m</a>, <a class="local col5 ref" href="#565ar" title='ar' data-ref="565ar" data-ref-filename="565ar">ar</a>));</td></tr>
<tr><th id="5476">5476</th><td>                    <b>else</b></td></tr>
<tr><th id="5477">5477</th><td>                    {</td></tr>
<tr><th id="5478">5478</th><td>                        <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col1 decl" id="571scopeid" title='scopeid' data-type='mDNSu32' data-ref="571scopeid" data-ref-filename="571scopeid">scopeid</dfn>  = (<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a>)(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/stdint.h.html#uintptr_t" title='uintptr_t' data-type='__uintptr_t' data-ref="uintptr_t" data-ref-filename="uintptr_t">uintptr_t</a>)<a class="local col5 ref" href="#565ar" title='ar' data-ref="565ar" data-ref-filename="565ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::InterfaceID" title='ResourceRecord_struct::InterfaceID' data-ref="ResourceRecord_struct::InterfaceID" data-ref-filename="ResourceRecord_struct..InterfaceID">InterfaceID</a>;</td></tr>
<tr><th id="5479">5479</th><td>                        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>" %s   %u  %s"</q>, <a class="ref fn" href="#RecordTypeName" title='RecordTypeName' data-ref="RecordTypeName" data-ref-filename="RecordTypeName">RecordTypeName</a>(<a class="local col5 ref" href="#565ar" title='ar' data-ref="565ar" data-ref-filename="565ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::RecordType" title='ResourceRecord_struct::RecordType' data-ref="ResourceRecord_struct::RecordType" data-ref-filename="ResourceRecord_struct..RecordType">RecordType</a>), <a class="local col1 ref" href="#571scopeid" title='scopeid' data-ref="571scopeid" data-ref-filename="571scopeid">scopeid</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2942" title="GetRRDisplayString_rdb(&amp;(ar)-&gt;resrec, &amp;(ar)-&gt;resrec.rdata-&gt;u, (m)-&gt;MsgBuffer)" data-ref="_M/ARDisplayString">ARDisplayString</a>(<a class="local col3 ref" href="#563m" title='m' data-ref="563m" data-ref-filename="563m">m</a>, <a class="local col5 ref" href="#565ar" title='ar' data-ref="565ar" data-ref-filename="565ar">ar</a>));</td></tr>
<tr><th id="5480">5480</th><td>                    }</td></tr>
<tr><th id="5481">5481</th><td>                }</td></tr>
<tr><th id="5482">5482</th><td>            }</td></tr>
<tr><th id="5483">5483</th><td>    }</td></tr>
<tr><th id="5484">5484</th><td></td></tr>
<tr><th id="5485">5485</th><td>    <b>if</b> (<a class="local col4 ref" href="#564showheader" title='showheader' data-ref="564showheader" data-ref-filename="564showheader">showheader</a>) <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"&lt;None&gt;"</q>);</td></tr>
<tr><th id="5486">5486</th><td>    <b>else</b> <b>if</b> (<a class="local col0 ref" href="#570truncated" title='truncated' data-ref="570truncated" data-ref-filename="570truncated">truncated</a>) <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"&lt;Truncated: to 50 records, Total records %d, Total Auth Groups %d, Auth Slots %d&gt;"</q>, <a class="local col8 ref" href="#568count" title='count' data-ref="568count" data-ref-filename="568count">count</a>, <a class="local col3 ref" href="#563m" title='m' data-ref="563m" data-ref-filename="563m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::rrauth" title='mDNS_struct::rrauth' data-ref="mDNS_struct::rrauth" data-ref-filename="mDNS_struct..rrauth">rrauth</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::rrauth_totalused" title='(anonymous struct)::rrauth_totalused' data-ref="(anonymous)::rrauth_totalused" data-ref-filename="(anonymous)..rrauth_totalused">rrauth_totalused</a>, <a class="local col9 ref" href="#569authslot" title='authslot' data-ref="569authslot" data-ref-filename="569authslot">authslot</a>);</td></tr>
<tr><th id="5487">5487</th><td>    <b>return</b> <a class="local col8 ref" href="#568count" title='count' data-ref="568count" data-ref-filename="568count">count</a>;</td></tr>
<tr><th id="5488">5488</th><td>}</td></tr>
<tr><th id="5489">5489</th><td></td></tr>
<tr><th id="5490">5490</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="LogLocalOnlyAuthRecords" title='LogLocalOnlyAuthRecords' data-ref="LogLocalOnlyAuthRecords" data-ref-filename="LogLocalOnlyAuthRecords">LogLocalOnlyAuthRecords</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS" title='mDNS' data-type='struct mDNS_struct' data-ref="mDNS" data-ref-filename="mDNS">mDNS</a> *<em>const</em> <dfn class="local col2 decl" id="572m" title='m' data-type='mDNS *const' data-ref="572m" data-ref-filename="572m">m</dfn>)</td></tr>
<tr><th id="5491">5491</th><td>{</td></tr>
<tr><th id="5492">5492</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSBool" title='mDNSBool' data-type='unsigned char' data-ref="mDNSBool" data-ref-filename="mDNSBool">mDNSBool</a> <dfn class="local col3 decl" id="573showheader" title='showheader' data-type='mDNSBool' data-ref="573showheader" data-ref-filename="573showheader">showheader</dfn> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>;</td></tr>
<tr><th id="5493">5493</th><td>    <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord" title='AuthRecord' data-type='struct AuthRecord_struct' data-ref="AuthRecord" data-ref-filename="AuthRecord">AuthRecord</a> *<dfn class="local col4 decl" id="574ar" title='ar' data-type='const AuthRecord *' data-ref="574ar" data-ref-filename="574ar">ar</dfn>;</td></tr>
<tr><th id="5494">5494</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col5 decl" id="575slot" title='slot' data-type='mDNSu32' data-ref="575slot" data-ref-filename="575slot">slot</dfn>;</td></tr>
<tr><th id="5495">5495</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthGroup" title='AuthGroup' data-type='struct AuthGroup_struct' data-ref="AuthGroup" data-ref-filename="AuthGroup">AuthGroup</a> *<dfn class="local col6 decl" id="576ag" title='ag' data-type='AuthGroup *' data-ref="576ag" data-ref-filename="576ag">ag</dfn>;</td></tr>
<tr><th id="5496">5496</th><td></td></tr>
<tr><th id="5497">5497</th><td>    <b>for</b> (<a class="local col5 ref" href="#575slot" title='slot' data-ref="575slot" data-ref-filename="575slot">slot</a> = <var>0</var>; <a class="local col5 ref" href="#575slot" title='slot' data-ref="575slot" data-ref-filename="575slot">slot</a> &lt; <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#1456" title="499" data-ref="_M/AUTH_HASH_SLOTS">AUTH_HASH_SLOTS</a>; <a class="local col5 ref" href="#575slot" title='slot' data-ref="575slot" data-ref-filename="575slot">slot</a>++)</td></tr>
<tr><th id="5498">5498</th><td>    {</td></tr>
<tr><th id="5499">5499</th><td>        <b>for</b> (<a class="local col6 ref" href="#576ag" title='ag' data-ref="576ag" data-ref-filename="576ag">ag</a> = <a class="local col2 ref" href="#572m" title='m' data-ref="572m" data-ref-filename="572m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::rrauth" title='mDNS_struct::rrauth' data-ref="mDNS_struct::rrauth" data-ref-filename="mDNS_struct..rrauth">rrauth</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::rrauth_hash" title='(anonymous struct)::rrauth_hash' data-ref="(anonymous)::rrauth_hash" data-ref-filename="(anonymous)..rrauth_hash">rrauth_hash</a>[<a class="local col5 ref" href="#575slot" title='slot' data-ref="575slot" data-ref-filename="575slot">slot</a>]; <a class="local col6 ref" href="#576ag" title='ag' data-ref="576ag" data-ref-filename="576ag">ag</a>; <a class="local col6 ref" href="#576ag" title='ag' data-ref="576ag" data-ref-filename="576ag">ag</a> = <a class="local col6 ref" href="#576ag" title='ag' data-ref="576ag" data-ref-filename="576ag">ag</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthGroup_struct::next" title='AuthGroup_struct::next' data-ref="AuthGroup_struct::next" data-ref-filename="AuthGroup_struct..next">next</a>)</td></tr>
<tr><th id="5500">5500</th><td>            <b>for</b> (<a class="local col4 ref" href="#574ar" title='ar' data-ref="574ar" data-ref-filename="574ar">ar</a> = <a class="local col6 ref" href="#576ag" title='ag' data-ref="576ag" data-ref-filename="576ag">ag</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthGroup_struct::members" title='AuthGroup_struct::members' data-ref="AuthGroup_struct::members" data-ref-filename="AuthGroup_struct..members">members</a>; <a class="local col4 ref" href="#574ar" title='ar' data-ref="574ar" data-ref-filename="574ar">ar</a>; <a class="local col4 ref" href="#574ar" title='ar' data-ref="574ar" data-ref-filename="574ar">ar</a> = <a class="local col4 ref" href="#574ar" title='ar' data-ref="574ar" data-ref-filename="574ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::next" title='AuthRecord_struct::next' data-ref="AuthRecord_struct::next" data-ref-filename="AuthRecord_struct..next">next</a>)</td></tr>
<tr><th id="5501">5501</th><td>            {</td></tr>
<tr><th id="5502">5502</th><td>                <b>if</b> (<a class="local col4 ref" href="#574ar" title='ar' data-ref="574ar" data-ref-filename="574ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::RecordCallback" title='AuthRecord_struct::RecordCallback' data-ref="AuthRecord_struct::RecordCallback" data-ref-filename="AuthRecord_struct..RecordCallback">RecordCallback</a> == <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#FreeEtcHosts" title='FreeEtcHosts' data-ref="FreeEtcHosts" data-ref-filename="FreeEtcHosts">FreeEtcHosts</a>) <b>continue</b>;</td></tr>
<tr><th id="5503">5503</th><td>                <b>if</b> (<a class="local col3 ref" href="#573showheader" title='showheader' data-ref="573showheader" data-ref-filename="573showheader">showheader</a>) { <a class="local col3 ref" href="#573showheader" title='showheader' data-ref="573showheader" data-ref-filename="573showheader">showheader</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>; <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"  State       Interface"</q>); }</td></tr>
<tr><th id="5504">5504</th><td></td></tr>
<tr><th id="5505">5505</th><td>                <i>// Print a maximum of 400 records</i></td></tr>
<tr><th id="5506">5506</th><td>                <b>if</b> (<a class="local col4 ref" href="#574ar" title='ar' data-ref="574ar" data-ref-filename="574ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::ARType" title='AuthRecord_struct::ARType' data-ref="AuthRecord_struct::ARType" data-ref-filename="AuthRecord_struct..ARType">ARType</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecordLocalOnly" title='AuthRecordLocalOnly' data-ref="AuthRecordLocalOnly" data-ref-filename="AuthRecordLocalOnly">AuthRecordLocalOnly</a>)</td></tr>
<tr><th id="5507">5507</th><td>                    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>" %s   LO  %s"</q>, <a class="ref fn" href="#RecordTypeName" title='RecordTypeName' data-ref="RecordTypeName" data-ref-filename="RecordTypeName">RecordTypeName</a>(<a class="local col4 ref" href="#574ar" title='ar' data-ref="574ar" data-ref-filename="574ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::RecordType" title='ResourceRecord_struct::RecordType' data-ref="ResourceRecord_struct::RecordType" data-ref-filename="ResourceRecord_struct..RecordType">RecordType</a>), <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2942" title="GetRRDisplayString_rdb(&amp;(ar)-&gt;resrec, &amp;(ar)-&gt;resrec.rdata-&gt;u, (m)-&gt;MsgBuffer)" data-ref="_M/ARDisplayString">ARDisplayString</a>(<a class="local col2 ref" href="#572m" title='m' data-ref="572m" data-ref-filename="572m">m</a>, <a class="local col4 ref" href="#574ar" title='ar' data-ref="574ar" data-ref-filename="574ar">ar</a>));</td></tr>
<tr><th id="5508">5508</th><td>                <b>else</b> <b>if</b> (<a class="local col4 ref" href="#574ar" title='ar' data-ref="574ar" data-ref-filename="574ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::ARType" title='AuthRecord_struct::ARType' data-ref="AuthRecord_struct::ARType" data-ref-filename="AuthRecord_struct..ARType">ARType</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecordP2P" title='AuthRecordP2P' data-ref="AuthRecordP2P" data-ref-filename="AuthRecordP2P">AuthRecordP2P</a>)</td></tr>
<tr><th id="5509">5509</th><td>                {</td></tr>
<tr><th id="5510">5510</th><td>                    <b>if</b> (<a class="local col4 ref" href="#574ar" title='ar' data-ref="574ar" data-ref-filename="574ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::InterfaceID" title='ResourceRecord_struct::InterfaceID' data-ref="ResourceRecord_struct::InterfaceID" data-ref-filename="ResourceRecord_struct..InterfaceID">InterfaceID</a> == <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterface_BLE" title='mDNSInterface_BLE' data-ref="mDNSInterface_BLE" data-ref-filename="mDNSInterface_BLE">mDNSInterface_BLE</a>)</td></tr>
<tr><th id="5511">5511</th><td>                        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>" %s   BLE %s"</q>, <a class="ref fn" href="#RecordTypeName" title='RecordTypeName' data-ref="RecordTypeName" data-ref-filename="RecordTypeName">RecordTypeName</a>(<a class="local col4 ref" href="#574ar" title='ar' data-ref="574ar" data-ref-filename="574ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::RecordType" title='ResourceRecord_struct::RecordType' data-ref="ResourceRecord_struct::RecordType" data-ref-filename="ResourceRecord_struct..RecordType">RecordType</a>), <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2942" title="GetRRDisplayString_rdb(&amp;(ar)-&gt;resrec, &amp;(ar)-&gt;resrec.rdata-&gt;u, (m)-&gt;MsgBuffer)" data-ref="_M/ARDisplayString">ARDisplayString</a>(<a class="local col2 ref" href="#572m" title='m' data-ref="572m" data-ref-filename="572m">m</a>, <a class="local col4 ref" href="#574ar" title='ar' data-ref="574ar" data-ref-filename="574ar">ar</a>));</td></tr>
<tr><th id="5512">5512</th><td>                    <b>else</b></td></tr>
<tr><th id="5513">5513</th><td>                        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>" %s   PP  %s"</q>, <a class="ref fn" href="#RecordTypeName" title='RecordTypeName' data-ref="RecordTypeName" data-ref-filename="RecordTypeName">RecordTypeName</a>(<a class="local col4 ref" href="#574ar" title='ar' data-ref="574ar" data-ref-filename="574ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::RecordType" title='ResourceRecord_struct::RecordType' data-ref="ResourceRecord_struct::RecordType" data-ref-filename="ResourceRecord_struct..RecordType">RecordType</a>), <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2942" title="GetRRDisplayString_rdb(&amp;(ar)-&gt;resrec, &amp;(ar)-&gt;resrec.rdata-&gt;u, (m)-&gt;MsgBuffer)" data-ref="_M/ARDisplayString">ARDisplayString</a>(<a class="local col2 ref" href="#572m" title='m' data-ref="572m" data-ref-filename="572m">m</a>, <a class="local col4 ref" href="#574ar" title='ar' data-ref="574ar" data-ref-filename="574ar">ar</a>));</td></tr>
<tr><th id="5514">5514</th><td>                }</td></tr>
<tr><th id="5515">5515</th><td>            }</td></tr>
<tr><th id="5516">5516</th><td>    }</td></tr>
<tr><th id="5517">5517</th><td></td></tr>
<tr><th id="5518">5518</th><td>    <b>if</b> (<a class="local col3 ref" href="#573showheader" title='showheader' data-ref="573showheader" data-ref-filename="573showheader">showheader</a>) <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"&lt;None&gt;"</q>);</td></tr>
<tr><th id="5519">5519</th><td>}</td></tr>
<tr><th id="5520">5520</th><td></td></tr>
<tr><th id="5521">5521</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>char</em> *<dfn class="decl def fn" id="AnonInfoToString" title='AnonInfoToString' data-ref="AnonInfoToString" data-ref-filename="AnonInfoToString">AnonInfoToString</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AnonymousInfo" title='AnonymousInfo' data-type='struct AnonymousInfo' data-ref="AnonymousInfo" data-ref-filename="AnonymousInfo">AnonymousInfo</a> *<dfn class="local col7 decl" id="577ai" title='ai' data-type='AnonymousInfo *' data-ref="577ai" data-ref-filename="577ai">ai</dfn>, <em>char</em> *<dfn class="local col8 decl" id="578anonstr" title='anonstr' data-type='char *' data-ref="578anonstr" data-ref-filename="578anonstr">anonstr</dfn>, <em>int</em> <dfn class="local col9 decl" id="579anstrlen" title='anstrlen' data-type='int' data-ref="579anstrlen" data-ref-filename="579anstrlen">anstrlen</dfn>)</td></tr>
<tr><th id="5522">5522</th><td>{</td></tr>
<tr><th id="5523">5523</th><td>    <a class="local col8 ref" href="#578anonstr" title='anonstr' data-ref="578anonstr" data-ref-filename="578anonstr">anonstr</a>[<var>0</var>] = <var>0</var>;</td></tr>
<tr><th id="5524">5524</th><td>    <b>if</b> (<a class="local col7 ref" href="#577ai" title='ai' data-ref="577ai" data-ref-filename="577ai">ai</a> &amp;&amp; <a class="local col7 ref" href="#577ai" title='ai' data-ref="577ai" data-ref-filename="577ai">ai</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::AnonData" title='(anonymous struct)::AnonData' data-ref="(anonymous)::AnonData" data-ref-filename="(anonymous)..AnonData">AnonData</a>)</td></tr>
<tr><th id="5525">5525</th><td>    {</td></tr>
<tr><th id="5526">5526</th><td>        <b>return</b> (<a class="ref fn" href="#AnonDataToString" title='AnonDataToString' data-ref="AnonDataToString" data-ref-filename="AnonDataToString">AnonDataToString</a>(<a class="local col7 ref" href="#577ai" title='ai' data-ref="577ai" data-ref-filename="577ai">ai</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::AnonData" title='(anonymous struct)::AnonData' data-ref="(anonymous)::AnonData" data-ref-filename="(anonymous)..AnonData">AnonData</a>, <a class="local col7 ref" href="#577ai" title='ai' data-ref="577ai" data-ref-filename="577ai">ai</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::AnonDataLen" title='(anonymous struct)::AnonDataLen' data-ref="(anonymous)::AnonDataLen" data-ref-filename="(anonymous)..AnonDataLen">AnonDataLen</a>, <a class="local col8 ref" href="#578anonstr" title='anonstr' data-ref="578anonstr" data-ref-filename="578anonstr">anonstr</a>, <a class="local col9 ref" href="#579anstrlen" title='anstrlen' data-ref="579anstrlen" data-ref-filename="579anstrlen">anstrlen</a>));</td></tr>
<tr><th id="5527">5527</th><td>    }</td></tr>
<tr><th id="5528">5528</th><td>    <b>return</b> <a class="local col8 ref" href="#578anonstr" title='anonstr' data-ref="578anonstr" data-ref-filename="578anonstr">anonstr</a>;</td></tr>
<tr><th id="5529">5529</th><td>}</td></tr>
<tr><th id="5530">5530</th><td></td></tr>
<tr><th id="5531">5531</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="LogOneAuthRecord" title='LogOneAuthRecord' data-ref="LogOneAuthRecord" data-ref-filename="LogOneAuthRecord">LogOneAuthRecord</dfn>(<em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord" title='AuthRecord' data-type='struct AuthRecord_struct' data-ref="AuthRecord" data-ref-filename="AuthRecord">AuthRecord</a> *<dfn class="local col0 decl" id="580ar" title='ar' data-type='const AuthRecord *' data-ref="580ar" data-ref-filename="580ar">ar</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSs32" title='mDNSs32' data-type='int' data-ref="mDNSs32" data-ref-filename="mDNSs32">mDNSs32</a> <dfn class="local col1 decl" id="581now" title='now' data-type='mDNSs32' data-ref="581now" data-ref-filename="581now">now</dfn>, <em>const</em> <em>char</em> *<em>const</em> <dfn class="local col2 decl" id="582ifname" title='ifname' data-type='const char *const' data-ref="582ifname" data-ref-filename="582ifname">ifname</dfn>)</td></tr>
<tr><th id="5532">5532</th><td>{</td></tr>
<tr><th id="5533">5533</th><td>    <em>char</em> <dfn class="local col3 decl" id="583anstr" title='anstr' data-type='char [256]' data-ref="583anstr" data-ref-filename="583anstr">anstr</dfn>[<var>256</var>];</td></tr>
<tr><th id="5534">5534</th><td>    <b>if</b> (<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#1601" title="((ar)-&gt;resrec.InterfaceID == mDNSInterface_Any &amp;&amp; !(ar)-&gt;ForceMCast &amp;&amp; !IsLocalDomain((ar)-&gt;resrec.name))" data-ref="_M/AuthRecord_uDNS">AuthRecord_uDNS</a>(<a class="local col0 ref" href="#580ar" title='ar' data-ref="580ar" data-ref-filename="580ar">ar</a>))</td></tr>
<tr><th id="5535">5535</th><td>    {</td></tr>
<tr><th id="5536">5536</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"%7d %7d %7d %-7s %4d %s %s"</q>,</td></tr>
<tr><th id="5537">5537</th><td>                      <a class="local col0 ref" href="#580ar" title='ar' data-ref="580ar" data-ref-filename="580ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::ThisAPInterval" title='AuthRecord_struct::ThisAPInterval' data-ref="AuthRecord_struct::ThisAPInterval" data-ref-filename="AuthRecord_struct..ThisAPInterval">ThisAPInterval</a> / <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformOneSecond" title='mDNSPlatformOneSecond' data-ref="mDNSPlatformOneSecond" data-ref-filename="mDNSPlatformOneSecond">mDNSPlatformOneSecond</a>,</td></tr>
<tr><th id="5538">5538</th><td>                      (<a class="local col0 ref" href="#580ar" title='ar' data-ref="580ar" data-ref-filename="580ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::LastAPTime" title='AuthRecord_struct::LastAPTime' data-ref="AuthRecord_struct::LastAPTime" data-ref-filename="AuthRecord_struct..LastAPTime">LastAPTime</a> + <a class="local col0 ref" href="#580ar" title='ar' data-ref="580ar" data-ref-filename="580ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::ThisAPInterval" title='AuthRecord_struct::ThisAPInterval' data-ref="AuthRecord_struct::ThisAPInterval" data-ref-filename="AuthRecord_struct..ThisAPInterval">ThisAPInterval</a> - <a class="local col1 ref" href="#581now" title='now' data-ref="581now" data-ref-filename="581now">now</a>) / <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformOneSecond" title='mDNSPlatformOneSecond' data-ref="mDNSPlatformOneSecond" data-ref-filename="mDNSPlatformOneSecond">mDNSPlatformOneSecond</a>,</td></tr>
<tr><th id="5539">5539</th><td>                      <a class="local col0 ref" href="#580ar" title='ar' data-ref="580ar" data-ref-filename="580ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::expire" title='AuthRecord_struct::expire' data-ref="AuthRecord_struct::expire" data-ref-filename="AuthRecord_struct..expire">expire</a> ? (<a class="local col0 ref" href="#580ar" title='ar' data-ref="580ar" data-ref-filename="580ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::expire" title='AuthRecord_struct::expire' data-ref="AuthRecord_struct::expire" data-ref-filename="AuthRecord_struct..expire">expire</a> - <a class="local col1 ref" href="#581now" title='now' data-ref="581now" data-ref-filename="581now">now</a>) / <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformOneSecond" title='mDNSPlatformOneSecond' data-ref="mDNSPlatformOneSecond" data-ref-filename="mDNSPlatformOneSecond">mDNSPlatformOneSecond</a> : <var>0</var>,</td></tr>
<tr><th id="5540">5540</th><td>                      <q>"-U-"</q>,</td></tr>
<tr><th id="5541">5541</th><td>                      <a class="local col0 ref" href="#580ar" title='ar' data-ref="580ar" data-ref-filename="580ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::state" title='AuthRecord_struct::state' data-ref="AuthRecord_struct::state" data-ref-filename="AuthRecord_struct..state">state</a>,</td></tr>
<tr><th id="5542">5542</th><td>                      <a class="local col0 ref" href="#580ar" title='ar' data-ref="580ar" data-ref-filename="580ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::AllowRemoteQuery" title='AuthRecord_struct::AllowRemoteQuery' data-ref="AuthRecord_struct::AllowRemoteQuery" data-ref-filename="AuthRecord_struct..AllowRemoteQuery">AllowRemoteQuery</a> ? <q>"☠"</q> : <q>" "</q>,</td></tr>
<tr><th id="5543">5543</th><td>                      <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2942" title="GetRRDisplayString_rdb(&amp;(ar)-&gt;resrec, &amp;(ar)-&gt;resrec.rdata-&gt;u, (&amp;mDNSStorage)-&gt;MsgBuffer)" data-ref="_M/ARDisplayString">ARDisplayString</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col0 ref" href="#580ar" title='ar' data-ref="580ar" data-ref-filename="580ar">ar</a>));</td></tr>
<tr><th id="5544">5544</th><td>    }</td></tr>
<tr><th id="5545">5545</th><td>    <b>else</b></td></tr>
<tr><th id="5546">5546</th><td>    {</td></tr>
<tr><th id="5547">5547</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"%7d %7d %7d %-7s 0x%02X %s %s%s"</q>,</td></tr>
<tr><th id="5548">5548</th><td>                      <a class="local col0 ref" href="#580ar" title='ar' data-ref="580ar" data-ref-filename="580ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::ThisAPInterval" title='AuthRecord_struct::ThisAPInterval' data-ref="AuthRecord_struct::ThisAPInterval" data-ref-filename="AuthRecord_struct..ThisAPInterval">ThisAPInterval</a> / <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformOneSecond" title='mDNSPlatformOneSecond' data-ref="mDNSPlatformOneSecond" data-ref-filename="mDNSPlatformOneSecond">mDNSPlatformOneSecond</a>,</td></tr>
<tr><th id="5549">5549</th><td>                      <a class="local col0 ref" href="#580ar" title='ar' data-ref="580ar" data-ref-filename="580ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::AnnounceCount" title='AuthRecord_struct::AnnounceCount' data-ref="AuthRecord_struct::AnnounceCount" data-ref-filename="AuthRecord_struct..AnnounceCount">AnnounceCount</a> ? (<a class="local col0 ref" href="#580ar" title='ar' data-ref="580ar" data-ref-filename="580ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::LastAPTime" title='AuthRecord_struct::LastAPTime' data-ref="AuthRecord_struct::LastAPTime" data-ref-filename="AuthRecord_struct..LastAPTime">LastAPTime</a> + <a class="local col0 ref" href="#580ar" title='ar' data-ref="580ar" data-ref-filename="580ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::ThisAPInterval" title='AuthRecord_struct::ThisAPInterval' data-ref="AuthRecord_struct::ThisAPInterval" data-ref-filename="AuthRecord_struct..ThisAPInterval">ThisAPInterval</a> - <a class="local col1 ref" href="#581now" title='now' data-ref="581now" data-ref-filename="581now">now</a>) / <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformOneSecond" title='mDNSPlatformOneSecond' data-ref="mDNSPlatformOneSecond" data-ref-filename="mDNSPlatformOneSecond">mDNSPlatformOneSecond</a> : <var>0</var>,</td></tr>
<tr><th id="5550">5550</th><td>                      <a class="local col0 ref" href="#580ar" title='ar' data-ref="580ar" data-ref-filename="580ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::TimeExpire" title='AuthRecord_struct::TimeExpire' data-ref="AuthRecord_struct::TimeExpire" data-ref-filename="AuthRecord_struct..TimeExpire">TimeExpire</a>    ? (<a class="local col0 ref" href="#580ar" title='ar' data-ref="580ar" data-ref-filename="580ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::TimeExpire" title='AuthRecord_struct::TimeExpire' data-ref="AuthRecord_struct::TimeExpire" data-ref-filename="AuthRecord_struct..TimeExpire">TimeExpire</a>                      - <a class="local col1 ref" href="#581now" title='now' data-ref="581now" data-ref-filename="581now">now</a>) / <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformOneSecond" title='mDNSPlatformOneSecond' data-ref="mDNSPlatformOneSecond" data-ref-filename="mDNSPlatformOneSecond">mDNSPlatformOneSecond</a> : <var>0</var>,</td></tr>
<tr><th id="5551">5551</th><td>                      <a class="local col2 ref" href="#582ifname" title='ifname' data-ref="582ifname" data-ref-filename="582ifname">ifname</a> ? <a class="local col2 ref" href="#582ifname" title='ifname' data-ref="582ifname" data-ref-filename="582ifname">ifname</a> : <q>"ALL"</q>,</td></tr>
<tr><th id="5552">5552</th><td>                      <a class="local col0 ref" href="#580ar" title='ar' data-ref="580ar" data-ref-filename="580ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::RecordType" title='ResourceRecord_struct::RecordType' data-ref="ResourceRecord_struct::RecordType" data-ref-filename="ResourceRecord_struct..RecordType">RecordType</a>,</td></tr>
<tr><th id="5553">5553</th><td>                      <a class="local col0 ref" href="#580ar" title='ar' data-ref="580ar" data-ref-filename="580ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::AllowRemoteQuery" title='AuthRecord_struct::AllowRemoteQuery' data-ref="AuthRecord_struct::AllowRemoteQuery" data-ref-filename="AuthRecord_struct..AllowRemoteQuery">AllowRemoteQuery</a> ? <q>"☠"</q> : <q>" "</q>,</td></tr>
<tr><th id="5554">5554</th><td>                      <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2942" title="GetRRDisplayString_rdb(&amp;(ar)-&gt;resrec, &amp;(ar)-&gt;resrec.rdata-&gt;u, (&amp;mDNSStorage)-&gt;MsgBuffer)" data-ref="_M/ARDisplayString">ARDisplayString</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col0 ref" href="#580ar" title='ar' data-ref="580ar" data-ref-filename="580ar">ar</a>), <a class="ref fn" href="#AnonInfoToString" title='AnonInfoToString' data-ref="AnonInfoToString" data-ref-filename="AnonInfoToString">AnonInfoToString</a>(<a class="local col0 ref" href="#580ar" title='ar' data-ref="580ar" data-ref-filename="580ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::AnonInfo" title='ResourceRecord_struct::AnonInfo' data-ref="ResourceRecord_struct::AnonInfo" data-ref-filename="ResourceRecord_struct..AnonInfo">AnonInfo</a>, <a class="local col3 ref" href="#583anstr" title='anstr' data-ref="583anstr" data-ref-filename="583anstr">anstr</a>, <b>sizeof</b>(<a class="local col3 ref" href="#583anstr" title='anstr' data-ref="583anstr" data-ref-filename="583anstr">anstr</a>)));</td></tr>
<tr><th id="5555">5555</th><td>    }</td></tr>
<tr><th id="5556">5556</th><td>}</td></tr>
<tr><th id="5557">5557</th><td></td></tr>
<tr><th id="5558">5558</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="LogAuthRecords" title='LogAuthRecords' data-ref="LogAuthRecords" data-ref-filename="LogAuthRecords">LogAuthRecords</dfn>(<em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSs32" title='mDNSs32' data-type='int' data-ref="mDNSs32" data-ref-filename="mDNSs32">mDNSs32</a> <dfn class="local col4 decl" id="584now" title='now' data-type='const mDNSs32' data-ref="584now" data-ref-filename="584now">now</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord" title='AuthRecord' data-type='struct AuthRecord_struct' data-ref="AuthRecord" data-ref-filename="AuthRecord">AuthRecord</a> *<dfn class="local col5 decl" id="585ResourceRecords" title='ResourceRecords' data-type='AuthRecord *' data-ref="585ResourceRecords" data-ref-filename="585ResourceRecords">ResourceRecords</dfn>, <em>int</em> *<dfn class="local col6 decl" id="586proxy" title='proxy' data-type='int *' data-ref="586proxy" data-ref-filename="586proxy">proxy</dfn>)</td></tr>
<tr><th id="5559">5559</th><td>{</td></tr>
<tr><th id="5560">5560</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSBool" title='mDNSBool' data-type='unsigned char' data-ref="mDNSBool" data-ref-filename="mDNSBool">mDNSBool</a> <dfn class="local col7 decl" id="587showheader" title='showheader' data-type='mDNSBool' data-ref="587showheader" data-ref-filename="587showheader">showheader</dfn> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNStrue" title='mDNStrue' data-ref="mDNStrue" data-ref-filename="mDNStrue">mDNStrue</a>;</td></tr>
<tr><th id="5561">5561</th><td>    <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord" title='AuthRecord' data-type='struct AuthRecord_struct' data-ref="AuthRecord" data-ref-filename="AuthRecord">AuthRecord</a> *<dfn class="local col8 decl" id="588ar" title='ar' data-type='const AuthRecord *' data-ref="588ar" data-ref-filename="588ar">ar</dfn>;</td></tr>
<tr><th id="5562">5562</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#OwnerOptData" title='OwnerOptData' data-type='struct OwnerOptData' data-ref="OwnerOptData" data-ref-filename="OwnerOptData">OwnerOptData</a> <dfn class="local col9 decl" id="589owner" title='owner' data-type='OwnerOptData' data-ref="589owner" data-ref-filename="589owner">owner</dfn> = <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#zeroOwner" title='zeroOwner' data-ref="zeroOwner" data-ref-filename="zeroOwner">zeroOwner</a>;</td></tr>
<tr><th id="5563">5563</th><td>    <b>for</b> (<a class="local col8 ref" href="#588ar" title='ar' data-ref="588ar" data-ref-filename="588ar">ar</a> = <a class="local col5 ref" href="#585ResourceRecords" title='ResourceRecords' data-ref="585ResourceRecords" data-ref-filename="585ResourceRecords">ResourceRecords</a>; <a class="local col8 ref" href="#588ar" title='ar' data-ref="588ar" data-ref-filename="588ar">ar</a>; <a class="local col8 ref" href="#588ar" title='ar' data-ref="588ar" data-ref-filename="588ar">ar</a>=<a class="local col8 ref" href="#588ar" title='ar' data-ref="588ar" data-ref-filename="588ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::next" title='AuthRecord_struct::next' data-ref="AuthRecord_struct::next" data-ref-filename="AuthRecord_struct..next">next</a>)</td></tr>
<tr><th id="5564">5564</th><td>    {</td></tr>
<tr><th id="5565">5565</th><td>        <em>const</em> <em>char</em> *<em>const</em> <dfn class="local col0 decl" id="590ifname" title='ifname' data-type='const char *const' data-ref="590ifname" data-ref-filename="590ifname">ifname</dfn> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#InterfaceNameForID" title='InterfaceNameForID' data-ref="InterfaceNameForID" data-ref-filename="InterfaceNameForID">InterfaceNameForID</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col8 ref" href="#588ar" title='ar' data-ref="588ar" data-ref-filename="588ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::InterfaceID" title='ResourceRecord_struct::InterfaceID' data-ref="ResourceRecord_struct::InterfaceID" data-ref-filename="ResourceRecord_struct..InterfaceID">InterfaceID</a>);</td></tr>
<tr><th id="5566">5566</th><td>        <b>if</b> ((<a class="local col8 ref" href="#588ar" title='ar' data-ref="588ar" data-ref-filename="588ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::WakeUp" title='AuthRecord_struct::WakeUp' data-ref="AuthRecord_struct::WakeUp" data-ref-filename="AuthRecord_struct..WakeUp">WakeUp</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::HMAC" title='(anonymous struct)::HMAC' data-ref="(anonymous)::HMAC" data-ref-filename="(anonymous)..HMAC">HMAC</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::l" title='(anonymous union)::l' data-ref="(anonymous)::l" data-ref-filename="(anonymous)..l">l</a>[<var>0</var>] != <var>0</var>) == (<a class="local col6 ref" href="#586proxy" title='proxy' data-ref="586proxy" data-ref-filename="586proxy">proxy</a> != <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>))</td></tr>
<tr><th id="5567">5567</th><td>        {</td></tr>
<tr><th id="5568">5568</th><td>            <b>if</b> (<a class="local col7 ref" href="#587showheader" title='showheader' data-ref="587showheader" data-ref-filename="587showheader">showheader</a>) { <a class="local col7 ref" href="#587showheader" title='showheader' data-ref="587showheader" data-ref-filename="587showheader">showheader</a> = <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSfalse" title='mDNSfalse' data-ref="mDNSfalse" data-ref-filename="mDNSfalse">mDNSfalse</a>; <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"    Int    Next  Expire if     State"</q>); }</td></tr>
<tr><th id="5569">5569</th><td>            <b>if</b> (<a class="local col6 ref" href="#586proxy" title='proxy' data-ref="586proxy" data-ref-filename="586proxy">proxy</a>) (*<a class="local col6 ref" href="#586proxy" title='proxy' data-ref="586proxy" data-ref-filename="586proxy">proxy</a>)++;</td></tr>
<tr><th id="5570">5570</th><td>            <b>if</b> (!<a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformMemSame" title='mDNSPlatformMemSame' data-ref="mDNSPlatformMemSame" data-ref-filename="mDNSPlatformMemSame">mDNSPlatformMemSame</a>(&amp;<a class="local col9 ref" href="#589owner" title='owner' data-ref="589owner" data-ref-filename="589owner">owner</a>, &amp;<a class="local col8 ref" href="#588ar" title='ar' data-ref="588ar" data-ref-filename="588ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::WakeUp" title='AuthRecord_struct::WakeUp' data-ref="AuthRecord_struct::WakeUp" data-ref-filename="AuthRecord_struct..WakeUp">WakeUp</a>, <b>sizeof</b>(<a class="local col9 ref" href="#589owner" title='owner' data-ref="589owner" data-ref-filename="589owner">owner</a>)))</td></tr>
<tr><th id="5571">5571</th><td>            {</td></tr>
<tr><th id="5572">5572</th><td>                <a class="local col9 ref" href="#589owner" title='owner' data-ref="589owner" data-ref-filename="589owner">owner</a> = <a class="local col8 ref" href="#588ar" title='ar' data-ref="588ar" data-ref-filename="588ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::WakeUp" title='AuthRecord_struct::WakeUp' data-ref="AuthRecord_struct::WakeUp" data-ref-filename="AuthRecord_struct..WakeUp">WakeUp</a>;</td></tr>
<tr><th id="5573">5573</th><td>                <b>if</b> (<a class="local col9 ref" href="#589owner" title='owner' data-ref="589owner" data-ref-filename="589owner">owner</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::password" title='(anonymous struct)::password' data-ref="(anonymous)::password" data-ref-filename="(anonymous)..password">password</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::l" title='(anonymous union)::l' data-ref="(anonymous)::l" data-ref-filename="(anonymous)..l">l</a>[<var>0</var>])</td></tr>
<tr><th id="5574">5574</th><td>                    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"Proxying for H-MAC %.6a I-MAC %.6a Password %.6a seq %d"</q>, &amp;<a class="local col9 ref" href="#589owner" title='owner' data-ref="589owner" data-ref-filename="589owner">owner</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::HMAC" title='(anonymous struct)::HMAC' data-ref="(anonymous)::HMAC" data-ref-filename="(anonymous)..HMAC">HMAC</a>, &amp;<a class="local col9 ref" href="#589owner" title='owner' data-ref="589owner" data-ref-filename="589owner">owner</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::IMAC" title='(anonymous struct)::IMAC' data-ref="(anonymous)::IMAC" data-ref-filename="(anonymous)..IMAC">IMAC</a>, &amp;<a class="local col9 ref" href="#589owner" title='owner' data-ref="589owner" data-ref-filename="589owner">owner</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::password" title='(anonymous struct)::password' data-ref="(anonymous)::password" data-ref-filename="(anonymous)..password">password</a>, <a class="local col9 ref" href="#589owner" title='owner' data-ref="589owner" data-ref-filename="589owner">owner</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::seq" title='(anonymous struct)::seq' data-ref="(anonymous)::seq" data-ref-filename="(anonymous)..seq">seq</a>);</td></tr>
<tr><th id="5575">5575</th><td>                <b>else</b> <b>if</b> (!<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2961" title="((&amp;owner.HMAC)-&gt;w[0] == (&amp;owner.IMAC)-&gt;w[0] &amp;&amp; (&amp;owner.HMAC)-&gt;w[1] == (&amp;owner.IMAC)-&gt;w[1] &amp;&amp; (&amp;owner.HMAC)-&gt;w[2] == (&amp;owner.IMAC)-&gt;w[2])" data-ref="_M/mDNSSameEthAddress">mDNSSameEthAddress</a>(&amp;<a class="local col9 ref" href="#589owner" title='owner' data-ref="589owner" data-ref-filename="589owner">owner</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::HMAC" title='(anonymous struct)::HMAC' data-ref="(anonymous)::HMAC" data-ref-filename="(anonymous)..HMAC">HMAC</a>, &amp;<a class="local col9 ref" href="#589owner" title='owner' data-ref="589owner" data-ref-filename="589owner">owner</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::IMAC" title='(anonymous struct)::IMAC' data-ref="(anonymous)::IMAC" data-ref-filename="(anonymous)..IMAC">IMAC</a>))</td></tr>
<tr><th id="5576">5576</th><td>                    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"Proxying for H-MAC %.6a I-MAC %.6a seq %d"</q>,               &amp;<a class="local col9 ref" href="#589owner" title='owner' data-ref="589owner" data-ref-filename="589owner">owner</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::HMAC" title='(anonymous struct)::HMAC' data-ref="(anonymous)::HMAC" data-ref-filename="(anonymous)..HMAC">HMAC</a>, &amp;<a class="local col9 ref" href="#589owner" title='owner' data-ref="589owner" data-ref-filename="589owner">owner</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::IMAC" title='(anonymous struct)::IMAC' data-ref="(anonymous)::IMAC" data-ref-filename="(anonymous)..IMAC">IMAC</a>,                  <a class="local col9 ref" href="#589owner" title='owner' data-ref="589owner" data-ref-filename="589owner">owner</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::seq" title='(anonymous struct)::seq' data-ref="(anonymous)::seq" data-ref-filename="(anonymous)..seq">seq</a>);</td></tr>
<tr><th id="5577">5577</th><td>                <b>else</b></td></tr>
<tr><th id="5578">5578</th><td>                    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"Proxying for %.6a seq %d"</q>,                                &amp;<a class="local col9 ref" href="#589owner" title='owner' data-ref="589owner" data-ref-filename="589owner">owner</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::HMAC" title='(anonymous struct)::HMAC' data-ref="(anonymous)::HMAC" data-ref-filename="(anonymous)..HMAC">HMAC</a>,                               <a class="local col9 ref" href="#589owner" title='owner' data-ref="589owner" data-ref-filename="589owner">owner</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::seq" title='(anonymous struct)::seq' data-ref="(anonymous)::seq" data-ref-filename="(anonymous)..seq">seq</a>);</td></tr>
<tr><th id="5579">5579</th><td>            }</td></tr>
<tr><th id="5580">5580</th><td>            <b>if</b> (<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#1601" title="((ar)-&gt;resrec.InterfaceID == mDNSInterface_Any &amp;&amp; !(ar)-&gt;ForceMCast &amp;&amp; !IsLocalDomain((ar)-&gt;resrec.name))" data-ref="_M/AuthRecord_uDNS">AuthRecord_uDNS</a>(<a class="local col8 ref" href="#588ar" title='ar' data-ref="588ar" data-ref-filename="588ar">ar</a>))</td></tr>
<tr><th id="5581">5581</th><td>            {</td></tr>
<tr><th id="5582">5582</th><td>                <a class="ref fn" href="#LogOneAuthRecord" title='LogOneAuthRecord' data-ref="LogOneAuthRecord" data-ref-filename="LogOneAuthRecord">LogOneAuthRecord</a>(<a class="local col8 ref" href="#588ar" title='ar' data-ref="588ar" data-ref-filename="588ar">ar</a>, <a class="local col4 ref" href="#584now" title='now' data-ref="584now" data-ref-filename="584now">now</a>, <a class="local col0 ref" href="#590ifname" title='ifname' data-ref="590ifname" data-ref-filename="590ifname">ifname</a>);</td></tr>
<tr><th id="5583">5583</th><td>            }</td></tr>
<tr><th id="5584">5584</th><td>            <b>else</b> <b>if</b> (<a class="local col8 ref" href="#588ar" title='ar' data-ref="588ar" data-ref-filename="588ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::ARType" title='AuthRecord_struct::ARType' data-ref="AuthRecord_struct::ARType" data-ref-filename="AuthRecord_struct..ARType">ARType</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecordLocalOnly" title='AuthRecordLocalOnly' data-ref="AuthRecordLocalOnly" data-ref-filename="AuthRecordLocalOnly">AuthRecordLocalOnly</a>)</td></tr>
<tr><th id="5585">5585</th><td>            {</td></tr>
<tr><th id="5586">5586</th><td>                <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"                             LO %s"</q>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2942" title="GetRRDisplayString_rdb(&amp;(ar)-&gt;resrec, &amp;(ar)-&gt;resrec.rdata-&gt;u, (&amp;mDNSStorage)-&gt;MsgBuffer)" data-ref="_M/ARDisplayString">ARDisplayString</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col8 ref" href="#588ar" title='ar' data-ref="588ar" data-ref-filename="588ar">ar</a>));</td></tr>
<tr><th id="5587">5587</th><td>            }</td></tr>
<tr><th id="5588">5588</th><td>            <b>else</b> <b>if</b> (<a class="local col8 ref" href="#588ar" title='ar' data-ref="588ar" data-ref-filename="588ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::ARType" title='AuthRecord_struct::ARType' data-ref="AuthRecord_struct::ARType" data-ref-filename="AuthRecord_struct..ARType">ARType</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecordP2P" title='AuthRecordP2P' data-ref="AuthRecordP2P" data-ref-filename="AuthRecordP2P">AuthRecordP2P</a>)</td></tr>
<tr><th id="5589">5589</th><td>            {</td></tr>
<tr><th id="5590">5590</th><td>                <b>if</b> (<a class="local col8 ref" href="#588ar" title='ar' data-ref="588ar" data-ref-filename="588ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::InterfaceID" title='ResourceRecord_struct::InterfaceID' data-ref="ResourceRecord_struct::InterfaceID" data-ref-filename="ResourceRecord_struct..InterfaceID">InterfaceID</a> == <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterface_BLE" title='mDNSInterface_BLE' data-ref="mDNSInterface_BLE" data-ref-filename="mDNSInterface_BLE">mDNSInterface_BLE</a>)</td></tr>
<tr><th id="5591">5591</th><td>                    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"                             BLE %s"</q>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2942" title="GetRRDisplayString_rdb(&amp;(ar)-&gt;resrec, &amp;(ar)-&gt;resrec.rdata-&gt;u, (&amp;mDNSStorage)-&gt;MsgBuffer)" data-ref="_M/ARDisplayString">ARDisplayString</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col8 ref" href="#588ar" title='ar' data-ref="588ar" data-ref-filename="588ar">ar</a>));</td></tr>
<tr><th id="5592">5592</th><td>                <b>else</b></td></tr>
<tr><th id="5593">5593</th><td>                    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"                             PP %s"</q>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2942" title="GetRRDisplayString_rdb(&amp;(ar)-&gt;resrec, &amp;(ar)-&gt;resrec.rdata-&gt;u, (&amp;mDNSStorage)-&gt;MsgBuffer)" data-ref="_M/ARDisplayString">ARDisplayString</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col8 ref" href="#588ar" title='ar' data-ref="588ar" data-ref-filename="588ar">ar</a>));</td></tr>
<tr><th id="5594">5594</th><td>            }</td></tr>
<tr><th id="5595">5595</th><td>            <b>else</b></td></tr>
<tr><th id="5596">5596</th><td>            {</td></tr>
<tr><th id="5597">5597</th><td>                <a class="ref fn" href="#LogOneAuthRecord" title='LogOneAuthRecord' data-ref="LogOneAuthRecord" data-ref-filename="LogOneAuthRecord">LogOneAuthRecord</a>(<a class="local col8 ref" href="#588ar" title='ar' data-ref="588ar" data-ref-filename="588ar">ar</a>, <a class="local col4 ref" href="#584now" title='now' data-ref="584now" data-ref-filename="584now">now</a>, <a class="local col0 ref" href="#590ifname" title='ifname' data-ref="590ifname" data-ref-filename="590ifname">ifname</a>);</td></tr>
<tr><th id="5598">5598</th><td>                <b>if</b> (<a class="local col8 ref" href="#588ar" title='ar' data-ref="588ar" data-ref-filename="588ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::AnonInfo" title='ResourceRecord_struct::AnonInfo' data-ref="ResourceRecord_struct::AnonInfo" data-ref-filename="ResourceRecord_struct..AnonInfo">AnonInfo</a>)</td></tr>
<tr><th id="5599">5599</th><td>                {</td></tr>
<tr><th id="5600">5600</th><td>                    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord" title='ResourceRecord' data-type='struct ResourceRecord_struct' data-ref="ResourceRecord" data-ref-filename="ResourceRecord">ResourceRecord</a> *<dfn class="local col1 decl" id="591nsec3" title='nsec3' data-type='ResourceRecord *' data-ref="591nsec3" data-ref-filename="591nsec3">nsec3</dfn> = <a class="local col8 ref" href="#588ar" title='ar' data-ref="588ar" data-ref-filename="588ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::AnonInfo" title='ResourceRecord_struct::AnonInfo' data-ref="ResourceRecord_struct::AnonInfo" data-ref-filename="ResourceRecord_struct..AnonInfo">AnonInfo</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::nsec3RR" title='(anonymous struct)::nsec3RR' data-ref="(anonymous)::nsec3RR" data-ref-filename="(anonymous)..nsec3RR">nsec3RR</a>;</td></tr>
<tr><th id="5601">5601</th><td>                    <i>// We just print the values from the AuthRecord to keep it nicely aligned though</i></td></tr>
<tr><th id="5602">5602</th><td><i>                    // all we want here is the nsec3 information.</i></td></tr>
<tr><th id="5603">5603</th><td>                    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"%7d %7d %7d %7s %s"</q>,</td></tr>
<tr><th id="5604">5604</th><td>                                  <a class="local col8 ref" href="#588ar" title='ar' data-ref="588ar" data-ref-filename="588ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::ThisAPInterval" title='AuthRecord_struct::ThisAPInterval' data-ref="AuthRecord_struct::ThisAPInterval" data-ref-filename="AuthRecord_struct..ThisAPInterval">ThisAPInterval</a> / <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformOneSecond" title='mDNSPlatformOneSecond' data-ref="mDNSPlatformOneSecond" data-ref-filename="mDNSPlatformOneSecond">mDNSPlatformOneSecond</a>,</td></tr>
<tr><th id="5605">5605</th><td>                                  <a class="local col8 ref" href="#588ar" title='ar' data-ref="588ar" data-ref-filename="588ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::AnnounceCount" title='AuthRecord_struct::AnnounceCount' data-ref="AuthRecord_struct::AnnounceCount" data-ref-filename="AuthRecord_struct..AnnounceCount">AnnounceCount</a> ? (<a class="local col8 ref" href="#588ar" title='ar' data-ref="588ar" data-ref-filename="588ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::LastAPTime" title='AuthRecord_struct::LastAPTime' data-ref="AuthRecord_struct::LastAPTime" data-ref-filename="AuthRecord_struct..LastAPTime">LastAPTime</a> + <a class="local col8 ref" href="#588ar" title='ar' data-ref="588ar" data-ref-filename="588ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::ThisAPInterval" title='AuthRecord_struct::ThisAPInterval' data-ref="AuthRecord_struct::ThisAPInterval" data-ref-filename="AuthRecord_struct..ThisAPInterval">ThisAPInterval</a> - <a class="local col4 ref" href="#584now" title='now' data-ref="584now" data-ref-filename="584now">now</a>) / <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformOneSecond" title='mDNSPlatformOneSecond' data-ref="mDNSPlatformOneSecond" data-ref-filename="mDNSPlatformOneSecond">mDNSPlatformOneSecond</a> : <var>0</var>,</td></tr>
<tr><th id="5606">5606</th><td>                                  <a class="local col8 ref" href="#588ar" title='ar' data-ref="588ar" data-ref-filename="588ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::TimeExpire" title='AuthRecord_struct::TimeExpire' data-ref="AuthRecord_struct::TimeExpire" data-ref-filename="AuthRecord_struct..TimeExpire">TimeExpire</a>    ? (<a class="local col8 ref" href="#588ar" title='ar' data-ref="588ar" data-ref-filename="588ar">ar</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::TimeExpire" title='AuthRecord_struct::TimeExpire' data-ref="AuthRecord_struct::TimeExpire" data-ref-filename="AuthRecord_struct..TimeExpire">TimeExpire</a>                      - <a class="local col4 ref" href="#584now" title='now' data-ref="584now" data-ref-filename="584now">now</a>) / <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformOneSecond" title='mDNSPlatformOneSecond' data-ref="mDNSPlatformOneSecond" data-ref-filename="mDNSPlatformOneSecond">mDNSPlatformOneSecond</a> : <var>0</var>,</td></tr>
<tr><th id="5607">5607</th><td>                                  <a class="local col0 ref" href="#590ifname" title='ifname' data-ref="590ifname" data-ref-filename="590ifname">ifname</a> ? <a class="local col0 ref" href="#590ifname" title='ifname' data-ref="590ifname" data-ref-filename="590ifname">ifname</a> : <q>"ALL"</q>,</td></tr>
<tr><th id="5608">5608</th><td>                                  <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2941" title="GetRRDisplayString_rdb(nsec3, &amp;(nsec3)-&gt;rdata-&gt;u, (&amp;mDNSStorage)-&gt;MsgBuffer)" data-ref="_M/RRDisplayString">RRDisplayString</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col1 ref" href="#591nsec3" title='nsec3' data-ref="591nsec3" data-ref-filename="591nsec3">nsec3</a>));</td></tr>
<tr><th id="5609">5609</th><td>                }</td></tr>
<tr><th id="5610">5610</th><td>            }</td></tr>
<tr><th id="5611">5611</th><td>        }</td></tr>
<tr><th id="5612">5612</th><td>    }</td></tr>
<tr><th id="5613">5613</th><td>    <b>if</b> (<a class="local col7 ref" href="#587showheader" title='showheader' data-ref="587showheader" data-ref-filename="587showheader">showheader</a>) <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"&lt;None&gt;"</q>);</td></tr>
<tr><th id="5614">5614</th><td>}</td></tr>
<tr><th id="5615">5615</th><td></td></tr>
<tr><th id="5616">5616</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="PrintOneCacheRecord" title='PrintOneCacheRecord' data-ref="PrintOneCacheRecord" data-ref-filename="PrintOneCacheRecord">PrintOneCacheRecord</dfn>(<em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#CacheRecord" title='CacheRecord' data-type='struct CacheRecord_struct' data-ref="CacheRecord" data-ref-filename="CacheRecord">CacheRecord</a> *<dfn class="local col2 decl" id="592cr" title='cr' data-type='const CacheRecord *' data-ref="592cr" data-ref-filename="592cr">cr</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col3 decl" id="593slot" title='slot' data-type='mDNSu32' data-ref="593slot" data-ref-filename="593slot">slot</dfn>, <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col4 decl" id="594remain" title='remain' data-type='const mDNSu32' data-ref="594remain" data-ref-filename="594remain">remain</dfn>, <em>const</em> <em>char</em> *<dfn class="local col5 decl" id="595ifname" title='ifname' data-type='const char *' data-ref="595ifname" data-ref-filename="595ifname">ifname</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> *<dfn class="local col6 decl" id="596CacheUsed" title='CacheUsed' data-type='mDNSu32 *' data-ref="596CacheUsed" data-ref-filename="596CacheUsed">CacheUsed</dfn>)</td></tr>
<tr><th id="5617">5617</th><td>{</td></tr>
<tr><th id="5618">5618</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"%3d %s%8d %-7s%s %-6s%s"</q>,</td></tr>
<tr><th id="5619">5619</th><td>                  <a class="local col3 ref" href="#593slot" title='slot' data-ref="593slot" data-ref-filename="593slot">slot</a>,</td></tr>
<tr><th id="5620">5620</th><td>                  <a class="local col2 ref" href="#592cr" title='cr' data-ref="592cr" data-ref-filename="592cr">cr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#CacheRecord_struct::CRActiveQuestion" title='CacheRecord_struct::CRActiveQuestion' data-ref="CacheRecord_struct::CRActiveQuestion" data-ref-filename="CacheRecord_struct..CRActiveQuestion">CRActiveQuestion</a> ? <q>"*"</q> : <q>" "</q>,</td></tr>
<tr><th id="5621">5621</th><td>                  <a class="local col4 ref" href="#594remain" title='remain' data-ref="594remain" data-ref-filename="594remain">remain</a>,</td></tr>
<tr><th id="5622">5622</th><td>                  <a class="local col5 ref" href="#595ifname" title='ifname' data-ref="595ifname" data-ref-filename="595ifname">ifname</a> ? <a class="local col5 ref" href="#595ifname" title='ifname' data-ref="595ifname" data-ref-filename="595ifname">ifname</a> : <q>"-U-"</q>,</td></tr>
<tr><th id="5623">5623</th><td>                  (<a class="local col2 ref" href="#592cr" title='cr' data-ref="592cr" data-ref-filename="592cr">cr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#CacheRecord_struct::resrec" title='CacheRecord_struct::resrec' data-ref="CacheRecord_struct::resrec" data-ref-filename="CacheRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::RecordType" title='ResourceRecord_struct::RecordType' data-ref="ResourceRecord_struct::RecordType" data-ref-filename="ResourceRecord_struct..RecordType">RecordType</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSRecordTypePacketNegative" title='kDNSRecordTypePacketNegative' data-ref="kDNSRecordTypePacketNegative" data-ref-filename="kDNSRecordTypePacketNegative">kDNSRecordTypePacketNegative</a>)  ? <q>"-"</q> :</td></tr>
<tr><th id="5624">5624</th><td>                  (<a class="local col2 ref" href="#592cr" title='cr' data-ref="592cr" data-ref-filename="592cr">cr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#CacheRecord_struct::resrec" title='CacheRecord_struct::resrec' data-ref="CacheRecord_struct::resrec" data-ref-filename="CacheRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::RecordType" title='ResourceRecord_struct::RecordType' data-ref="ResourceRecord_struct::RecordType" data-ref-filename="ResourceRecord_struct..RecordType">RecordType</a> &amp; <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSRecordTypePacketUniqueMask" title='kDNSRecordTypePacketUniqueMask' data-ref="kDNSRecordTypePacketUniqueMask" data-ref-filename="kDNSRecordTypePacketUniqueMask">kDNSRecordTypePacketUniqueMask</a>) ? <q>" "</q> : <q>"+"</q>,</td></tr>
<tr><th id="5625">5625</th><td>                  <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col2 ref" href="#592cr" title='cr' data-ref="592cr" data-ref-filename="592cr">cr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#CacheRecord_struct::resrec" title='CacheRecord_struct::resrec' data-ref="CacheRecord_struct::resrec" data-ref-filename="CacheRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rrtype" title='ResourceRecord_struct::rrtype' data-ref="ResourceRecord_struct::rrtype" data-ref-filename="ResourceRecord_struct..rrtype">rrtype</a>),</td></tr>
<tr><th id="5626">5626</th><td>                  <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2943" title="GetRRDisplayString_rdb(&amp;(cr)-&gt;resrec, &amp;(cr)-&gt;resrec.rdata-&gt;u, (&amp;mDNSStorage)-&gt;MsgBuffer)" data-ref="_M/CRDisplayString">CRDisplayString</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col2 ref" href="#592cr" title='cr' data-ref="592cr" data-ref-filename="592cr">cr</a>));</td></tr>
<tr><th id="5627">5627</th><td>    (*<a class="local col6 ref" href="#596CacheUsed" title='CacheUsed' data-ref="596CacheUsed" data-ref-filename="596CacheUsed">CacheUsed</a>)++;</td></tr>
<tr><th id="5628">5628</th><td>}</td></tr>
<tr><th id="5629">5629</th><td></td></tr>
<tr><th id="5630">5630</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>void</em> <dfn class="decl def fn" id="PrintCachedRecords" title='PrintCachedRecords' data-ref="PrintCachedRecords" data-ref-filename="PrintCachedRecords">PrintCachedRecords</dfn>(<em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#CacheRecord" title='CacheRecord' data-type='struct CacheRecord_struct' data-ref="CacheRecord" data-ref-filename="CacheRecord">CacheRecord</a> *<dfn class="local col7 decl" id="597cr" title='cr' data-type='const CacheRecord *' data-ref="597cr" data-ref-filename="597cr">cr</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col8 decl" id="598slot" title='slot' data-type='mDNSu32' data-ref="598slot" data-ref-filename="598slot">slot</dfn>, <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col9 decl" id="599remain" title='remain' data-type='const mDNSu32' data-ref="599remain" data-ref-filename="599remain">remain</dfn>, <em>const</em> <em>char</em> *<dfn class="local col0 decl" id="600ifname" title='ifname' data-type='const char *' data-ref="600ifname" data-ref-filename="600ifname">ifname</dfn>, <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> *<dfn class="local col1 decl" id="601CacheUsed" title='CacheUsed' data-type='mDNSu32 *' data-ref="601CacheUsed" data-ref-filename="601CacheUsed">CacheUsed</dfn>)</td></tr>
<tr><th id="5631">5631</th><td>{</td></tr>
<tr><th id="5632">5632</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#CacheRecord" title='CacheRecord' data-type='struct CacheRecord_struct' data-ref="CacheRecord" data-ref-filename="CacheRecord">CacheRecord</a> *<dfn class="local col2 decl" id="602nsec" title='nsec' data-type='CacheRecord *' data-ref="602nsec" data-ref-filename="602nsec">nsec</dfn>;</td></tr>
<tr><th id="5633">5633</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#CacheRecord" title='CacheRecord' data-type='struct CacheRecord_struct' data-ref="CacheRecord" data-ref-filename="CacheRecord">CacheRecord</a> *<dfn class="local col3 decl" id="603soa" title='soa' data-type='CacheRecord *' data-ref="603soa" data-ref-filename="603soa">soa</dfn>;</td></tr>
<tr><th id="5634">5634</th><td>    <a class="local col2 ref" href="#602nsec" title='nsec' data-ref="602nsec" data-ref-filename="602nsec">nsec</a> = <a class="local col7 ref" href="#597cr" title='cr' data-ref="597cr" data-ref-filename="597cr">cr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#CacheRecord_struct::nsec" title='CacheRecord_struct::nsec' data-ref="CacheRecord_struct::nsec" data-ref-filename="CacheRecord_struct..nsec">nsec</a>;</td></tr>
<tr><th id="5635">5635</th><td></td></tr>
<tr><th id="5636">5636</th><td>    <i>// The records that are cached under the main cache record like nsec, soa don't have</i></td></tr>
<tr><th id="5637">5637</th><td><i>    // their own lifetime. If the main cache record expires, they also expire.</i></td></tr>
<tr><th id="5638">5638</th><td>    <b>while</b> (<a class="local col2 ref" href="#602nsec" title='nsec' data-ref="602nsec" data-ref-filename="602nsec">nsec</a>)</td></tr>
<tr><th id="5639">5639</th><td>    {</td></tr>
<tr><th id="5640">5640</th><td>        <a class="ref fn" href="#PrintOneCacheRecord" title='PrintOneCacheRecord' data-ref="PrintOneCacheRecord" data-ref-filename="PrintOneCacheRecord">PrintOneCacheRecord</a>(<a class="local col2 ref" href="#602nsec" title='nsec' data-ref="602nsec" data-ref-filename="602nsec">nsec</a>, <a class="local col8 ref" href="#598slot" title='slot' data-ref="598slot" data-ref-filename="598slot">slot</a>, <a class="local col9 ref" href="#599remain" title='remain' data-ref="599remain" data-ref-filename="599remain">remain</a>, <a class="local col0 ref" href="#600ifname" title='ifname' data-ref="600ifname" data-ref-filename="600ifname">ifname</a>, <a class="local col1 ref" href="#601CacheUsed" title='CacheUsed' data-ref="601CacheUsed" data-ref-filename="601CacheUsed">CacheUsed</a>);</td></tr>
<tr><th id="5641">5641</th><td>        <a class="local col2 ref" href="#602nsec" title='nsec' data-ref="602nsec" data-ref-filename="602nsec">nsec</a> = <a class="local col2 ref" href="#602nsec" title='nsec' data-ref="602nsec" data-ref-filename="602nsec">nsec</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#CacheRecord_struct::next" title='CacheRecord_struct::next' data-ref="CacheRecord_struct::next" data-ref-filename="CacheRecord_struct..next">next</a>;</td></tr>
<tr><th id="5642">5642</th><td>    }</td></tr>
<tr><th id="5643">5643</th><td>    <a class="local col3 ref" href="#603soa" title='soa' data-ref="603soa" data-ref-filename="603soa">soa</a> = <a class="local col7 ref" href="#597cr" title='cr' data-ref="597cr" data-ref-filename="597cr">cr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#CacheRecord_struct::soa" title='CacheRecord_struct::soa' data-ref="CacheRecord_struct::soa" data-ref-filename="CacheRecord_struct..soa">soa</a>;</td></tr>
<tr><th id="5644">5644</th><td>    <b>if</b> (<a class="local col3 ref" href="#603soa" title='soa' data-ref="603soa" data-ref-filename="603soa">soa</a>)</td></tr>
<tr><th id="5645">5645</th><td>    {</td></tr>
<tr><th id="5646">5646</th><td>        <a class="ref fn" href="#PrintOneCacheRecord" title='PrintOneCacheRecord' data-ref="PrintOneCacheRecord" data-ref-filename="PrintOneCacheRecord">PrintOneCacheRecord</a>(<a class="local col3 ref" href="#603soa" title='soa' data-ref="603soa" data-ref-filename="603soa">soa</a>, <a class="local col8 ref" href="#598slot" title='slot' data-ref="598slot" data-ref-filename="598slot">slot</a>, <a class="local col9 ref" href="#599remain" title='remain' data-ref="599remain" data-ref-filename="599remain">remain</a>, <a class="local col0 ref" href="#600ifname" title='ifname' data-ref="600ifname" data-ref-filename="600ifname">ifname</a>, <a class="local col1 ref" href="#601CacheUsed" title='CacheUsed' data-ref="601CacheUsed" data-ref-filename="601CacheUsed">CacheUsed</a>);</td></tr>
<tr><th id="5647">5647</th><td>    }</td></tr>
<tr><th id="5648">5648</th><td>    <b>if</b> (<a class="local col7 ref" href="#597cr" title='cr' data-ref="597cr" data-ref-filename="597cr">cr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#CacheRecord_struct::resrec" title='CacheRecord_struct::resrec' data-ref="CacheRecord_struct::resrec" data-ref-filename="CacheRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::AnonInfo" title='ResourceRecord_struct::AnonInfo' data-ref="ResourceRecord_struct::AnonInfo" data-ref-filename="ResourceRecord_struct..AnonInfo">AnonInfo</a>)</td></tr>
<tr><th id="5649">5649</th><td>    {</td></tr>
<tr><th id="5650">5650</th><td>        <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord" title='ResourceRecord' data-type='struct ResourceRecord_struct' data-ref="ResourceRecord" data-ref-filename="ResourceRecord">ResourceRecord</a> *<dfn class="local col4 decl" id="604nsec3" title='nsec3' data-type='ResourceRecord *' data-ref="604nsec3" data-ref-filename="604nsec3">nsec3</dfn> = <a class="local col7 ref" href="#597cr" title='cr' data-ref="597cr" data-ref-filename="597cr">cr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#CacheRecord_struct::resrec" title='CacheRecord_struct::resrec' data-ref="CacheRecord_struct::resrec" data-ref-filename="CacheRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::AnonInfo" title='ResourceRecord_struct::AnonInfo' data-ref="ResourceRecord_struct::AnonInfo" data-ref-filename="ResourceRecord_struct..AnonInfo">AnonInfo</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::nsec3RR" title='(anonymous struct)::nsec3RR' data-ref="(anonymous)::nsec3RR" data-ref-filename="(anonymous)..nsec3RR">nsec3RR</a>;</td></tr>
<tr><th id="5651">5651</th><td>        <i>// Even though it is a resource record, we print the sameway</i></td></tr>
<tr><th id="5652">5652</th><td><i>        // as a cache record so that it aligns properly.</i></td></tr>
<tr><th id="5653">5653</th><td>        <b>if</b> (<a class="local col4 ref" href="#604nsec3" title='nsec3' data-ref="604nsec3" data-ref-filename="604nsec3">nsec3</a>)</td></tr>
<tr><th id="5654">5654</th><td>        {</td></tr>
<tr><th id="5655">5655</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"%3d %s%8d %-7s%s %-6s%s"</q>,</td></tr>
<tr><th id="5656">5656</th><td>                          <a class="local col8 ref" href="#598slot" title='slot' data-ref="598slot" data-ref-filename="598slot">slot</a>,</td></tr>
<tr><th id="5657">5657</th><td>                          <q>" "</q>,</td></tr>
<tr><th id="5658">5658</th><td>                          <a class="local col9 ref" href="#599remain" title='remain' data-ref="599remain" data-ref-filename="599remain">remain</a>,</td></tr>
<tr><th id="5659">5659</th><td>                          <a class="local col0 ref" href="#600ifname" title='ifname' data-ref="600ifname" data-ref-filename="600ifname">ifname</a> ? <a class="local col0 ref" href="#600ifname" title='ifname' data-ref="600ifname" data-ref-filename="600ifname">ifname</a> : <q>"-U-"</q>,</td></tr>
<tr><th id="5660">5660</th><td>                          (<a class="local col4 ref" href="#604nsec3" title='nsec3' data-ref="604nsec3" data-ref-filename="604nsec3">nsec3</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::RecordType" title='ResourceRecord_struct::RecordType' data-ref="ResourceRecord_struct::RecordType" data-ref-filename="ResourceRecord_struct..RecordType">RecordType</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSRecordTypePacketNegative" title='kDNSRecordTypePacketNegative' data-ref="kDNSRecordTypePacketNegative" data-ref-filename="kDNSRecordTypePacketNegative">kDNSRecordTypePacketNegative</a>)  ? <q>"-"</q> :</td></tr>
<tr><th id="5661">5661</th><td>                          (<a class="local col4 ref" href="#604nsec3" title='nsec3' data-ref="604nsec3" data-ref-filename="604nsec3">nsec3</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::RecordType" title='ResourceRecord_struct::RecordType' data-ref="ResourceRecord_struct::RecordType" data-ref-filename="ResourceRecord_struct..RecordType">RecordType</a> &amp; <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#kDNSRecordTypePacketUniqueMask" title='kDNSRecordTypePacketUniqueMask' data-ref="kDNSRecordTypePacketUniqueMask" data-ref-filename="kDNSRecordTypePacketUniqueMask">kDNSRecordTypePacketUniqueMask</a>) ? <q>" "</q> : <q>"+"</q>,</td></tr>
<tr><th id="5662">5662</th><td>                          <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col4 ref" href="#604nsec3" title='nsec3' data-ref="604nsec3" data-ref-filename="604nsec3">nsec3</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rrtype" title='ResourceRecord_struct::rrtype' data-ref="ResourceRecord_struct::rrtype" data-ref-filename="ResourceRecord_struct..rrtype">rrtype</a>),</td></tr>
<tr><th id="5663">5663</th><td>                          <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2941" title="GetRRDisplayString_rdb(nsec3, &amp;(nsec3)-&gt;rdata-&gt;u, (&amp;mDNSStorage)-&gt;MsgBuffer)" data-ref="_M/RRDisplayString">RRDisplayString</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>, <a class="local col4 ref" href="#604nsec3" title='nsec3' data-ref="604nsec3" data-ref-filename="604nsec3">nsec3</a>));</td></tr>
<tr><th id="5664">5664</th><td>        }</td></tr>
<tr><th id="5665">5665</th><td>    }</td></tr>
<tr><th id="5666">5666</th><td>}</td></tr>
<tr><th id="5667">5667</th><td></td></tr>
<tr><th id="5668">5668</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>char</em> *<dfn class="decl def fn" id="AnonDataToString" title='AnonDataToString' data-ref="AnonDataToString" data-ref-filename="AnonDataToString">AnonDataToString</dfn>(<em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu8" title='mDNSu8' data-type='unsigned char' data-ref="mDNSu8" data-ref-filename="mDNSu8">mDNSu8</a> *<dfn class="local col5 decl" id="605ad" title='ad' data-type='const mDNSu8 *' data-ref="605ad" data-ref-filename="605ad">ad</dfn>, <em>int</em> <dfn class="local col6 decl" id="606adlen" title='adlen' data-type='int' data-ref="606adlen" data-ref-filename="606adlen">adlen</dfn>, <em>char</em> *<dfn class="local col7 decl" id="607adstr" title='adstr' data-type='char *' data-ref="607adstr" data-ref-filename="607adstr">adstr</dfn>, <em>int</em> <dfn class="local col8 decl" id="608adstrlen" title='adstrlen' data-type='int' data-ref="608adstrlen" data-ref-filename="608adstrlen">adstrlen</dfn>)</td></tr>
<tr><th id="5669">5669</th><td>{</td></tr>
<tr><th id="5670">5670</th><td>    <a class="local col7 ref" href="#607adstr" title='adstr' data-ref="607adstr" data-ref-filename="607adstr">adstr</a>[<var>0</var>] = <var>0</var>;</td></tr>
<tr><th id="5671">5671</th><td>    <b>if</b> (<a class="local col5 ref" href="#605ad" title='ad' data-ref="605ad" data-ref-filename="605ad">ad</a>)</td></tr>
<tr><th id="5672">5672</th><td>    {</td></tr>
<tr><th id="5673">5673</th><td>        <em>int</em> <dfn class="local col9 decl" id="609len" title='len' data-type='int' data-ref="609len" data-ref-filename="609len">len</dfn>;</td></tr>
<tr><th id="5674">5674</th><td>        <em>char</em> *<dfn class="local col0 decl" id="610orig" title='orig' data-type='char *' data-ref="610orig" data-ref-filename="610orig">orig</dfn> = <a class="local col7 ref" href="#607adstr" title='adstr' data-ref="607adstr" data-ref-filename="607adstr">adstr</a>;</td></tr>
<tr><th id="5675">5675</th><td></td></tr>
<tr><th id="5676">5676</th><td>        <i>// If the caller is lazy to compute the length, we do it for them.</i></td></tr>
<tr><th id="5677">5677</th><td>        <b>if</b> (!<a class="local col6 ref" href="#606adlen" title='adlen' data-ref="606adlen" data-ref-filename="606adlen">adlen</a>)</td></tr>
<tr><th id="5678">5678</th><td>            <a class="local col9 ref" href="#609len" title='len' data-ref="609len" data-ref-filename="609len">len</a> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strlen" title='strlen' data-ref="strlen" data-ref-filename="strlen">strlen</a>((<em>const</em> <em>char</em> *)<a class="local col5 ref" href="#605ad" title='ad' data-ref="605ad" data-ref-filename="605ad">ad</a>);</td></tr>
<tr><th id="5679">5679</th><td>        <b>else</b></td></tr>
<tr><th id="5680">5680</th><td>            <a class="local col9 ref" href="#609len" title='len' data-ref="609len" data-ref-filename="609len">len</a> = <a class="local col6 ref" href="#606adlen" title='adlen' data-ref="606adlen" data-ref-filename="606adlen">adlen</a>;</td></tr>
<tr><th id="5681">5681</th><td></td></tr>
<tr><th id="5682">5682</th><td>        <i>// Print the anondata within brackets. Hence, we need space for two</i></td></tr>
<tr><th id="5683">5683</th><td><i>        // brackets and a NULL byte.</i></td></tr>
<tr><th id="5684">5684</th><td>        <b>if</b> (<a class="local col9 ref" href="#609len" title='len' data-ref="609len" data-ref-filename="609len">len</a> &gt; (<a class="local col8 ref" href="#608adstrlen" title='adstrlen' data-ref="608adstrlen" data-ref-filename="608adstrlen">adstrlen</a> - <var>3</var>))</td></tr>
<tr><th id="5685">5685</th><td>            <a class="local col9 ref" href="#609len" title='len' data-ref="609len" data-ref-filename="609len">len</a> = <a class="local col8 ref" href="#608adstrlen" title='adstrlen' data-ref="608adstrlen" data-ref-filename="608adstrlen">adstrlen</a> - <var>3</var>;</td></tr>
<tr><th id="5686">5686</th><td></td></tr>
<tr><th id="5687">5687</th><td>        *<a class="local col7 ref" href="#607adstr" title='adstr' data-ref="607adstr" data-ref-filename="607adstr">adstr</a>++ = <kbd>'('</kbd>;</td></tr>
<tr><th id="5688">5688</th><td>        <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformMemCopy" title='mDNSPlatformMemCopy' data-ref="mDNSPlatformMemCopy" data-ref-filename="mDNSPlatformMemCopy">mDNSPlatformMemCopy</a>(<a class="local col7 ref" href="#607adstr" title='adstr' data-ref="607adstr" data-ref-filename="607adstr">adstr</a>, <a class="local col5 ref" href="#605ad" title='ad' data-ref="605ad" data-ref-filename="605ad">ad</a>, <a class="local col9 ref" href="#609len" title='len' data-ref="609len" data-ref-filename="609len">len</a>);</td></tr>
<tr><th id="5689">5689</th><td>        <a class="local col7 ref" href="#607adstr" title='adstr' data-ref="607adstr" data-ref-filename="607adstr">adstr</a>[<a class="local col9 ref" href="#609len" title='len' data-ref="609len" data-ref-filename="609len">len</a>] = <kbd>')'</kbd>;</td></tr>
<tr><th id="5690">5690</th><td>        <a class="local col7 ref" href="#607adstr" title='adstr' data-ref="607adstr" data-ref-filename="607adstr">adstr</a>[<a class="local col9 ref" href="#609len" title='len' data-ref="609len" data-ref-filename="609len">len</a>+<var>1</var>] = <var>0</var>;</td></tr>
<tr><th id="5691">5691</th><td>        <b>return</b> <a class="local col0 ref" href="#610orig" title='orig' data-ref="610orig" data-ref-filename="610orig">orig</a>;</td></tr>
<tr><th id="5692">5692</th><td>    }</td></tr>
<tr><th id="5693">5693</th><td>    <b>return</b> <a class="local col7 ref" href="#607adstr" title='adstr' data-ref="607adstr" data-ref-filename="607adstr">adstr</a>;</td></tr>
<tr><th id="5694">5694</th><td>}</td></tr>
<tr><th id="5695">5695</th><td></td></tr>
<tr><th id="5696">5696</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#116" title="" data-ref="_M/mDNSexport">mDNSexport</a> <em>void</em> <dfn class="decl def fn" id="LogMDNSStatistics" title='LogMDNSStatistics' data-ref="LogMDNSStatistics" data-ref-filename="LogMDNSStatistics">LogMDNSStatistics</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS" title='mDNS' data-type='struct mDNS_struct' data-ref="mDNS" data-ref-filename="mDNS">mDNS</a> *<em>const</em> <dfn class="local col1 decl" id="611m" title='m' data-type='mDNS *const' data-ref="611m" data-ref-filename="611m">m</dfn>)</td></tr>
<tr><th id="5697">5697</th><td>{</td></tr>
<tr><th id="5698">5698</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"--- MDNS Statistics ---"</q>);</td></tr>
<tr><th id="5699">5699</th><td></td></tr>
<tr><th id="5700">5700</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"Name Conflicts                 %u"</q>, <a class="local col1 ref" href="#611m" title='m' data-ref="611m" data-ref-filename="611m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::mDNSStats" title='mDNS_struct::mDNSStats' data-ref="mDNS_struct::mDNSStats" data-ref-filename="mDNS_struct..mDNSStats">mDNSStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::NameConflicts" title='(anonymous struct)::NameConflicts' data-ref="(anonymous)::NameConflicts" data-ref-filename="(anonymous)..NameConflicts">NameConflicts</a>);</td></tr>
<tr><th id="5701">5701</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"KnownUnique Name Conflicts     %u"</q>, <a class="local col1 ref" href="#611m" title='m' data-ref="611m" data-ref-filename="611m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::mDNSStats" title='mDNS_struct::mDNSStats' data-ref="mDNS_struct::mDNSStats" data-ref-filename="mDNS_struct..mDNSStats">mDNSStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::KnownUniqueNameConflicts" title='(anonymous struct)::KnownUniqueNameConflicts' data-ref="(anonymous)::KnownUniqueNameConflicts" data-ref-filename="(anonymous)..KnownUniqueNameConflicts">KnownUniqueNameConflicts</a>);</td></tr>
<tr><th id="5702">5702</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"Duplicate Query Suppressions   %u"</q>, <a class="local col1 ref" href="#611m" title='m' data-ref="611m" data-ref-filename="611m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::mDNSStats" title='mDNS_struct::mDNSStats' data-ref="mDNS_struct::mDNSStats" data-ref-filename="mDNS_struct..mDNSStats">mDNSStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::DupQuerySuppressions" title='(anonymous struct)::DupQuerySuppressions' data-ref="(anonymous)::DupQuerySuppressions" data-ref-filename="(anonymous)..DupQuerySuppressions">DupQuerySuppressions</a>);</td></tr>
<tr><th id="5703">5703</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"KA Suppressions                %u"</q>, <a class="local col1 ref" href="#611m" title='m' data-ref="611m" data-ref-filename="611m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::mDNSStats" title='mDNS_struct::mDNSStats' data-ref="mDNS_struct::mDNSStats" data-ref-filename="mDNS_struct..mDNSStats">mDNSStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::KnownAnswerSuppressions" title='(anonymous struct)::KnownAnswerSuppressions' data-ref="(anonymous)::KnownAnswerSuppressions" data-ref-filename="(anonymous)..KnownAnswerSuppressions">KnownAnswerSuppressions</a>);</td></tr>
<tr><th id="5704">5704</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"KA Multiple Packets            %u"</q>, <a class="local col1 ref" href="#611m" title='m' data-ref="611m" data-ref-filename="611m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::mDNSStats" title='mDNS_struct::mDNSStats' data-ref="mDNS_struct::mDNSStats" data-ref-filename="mDNS_struct..mDNSStats">mDNSStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::KnownAnswerMultiplePkts" title='(anonymous struct)::KnownAnswerMultiplePkts' data-ref="(anonymous)::KnownAnswerMultiplePkts" data-ref-filename="(anonymous)..KnownAnswerMultiplePkts">KnownAnswerMultiplePkts</a>);</td></tr>
<tr><th id="5705">5705</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"Poof Cache Deletions           %u"</q>, <a class="local col1 ref" href="#611m" title='m' data-ref="611m" data-ref-filename="611m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::mDNSStats" title='mDNS_struct::mDNSStats' data-ref="mDNS_struct::mDNSStats" data-ref-filename="mDNS_struct..mDNSStats">mDNSStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::PoofCacheDeletions" title='(anonymous struct)::PoofCacheDeletions' data-ref="(anonymous)::PoofCacheDeletions" data-ref-filename="(anonymous)..PoofCacheDeletions">PoofCacheDeletions</a>);</td></tr>
<tr><th id="5706">5706</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"--------------------------------"</q>);</td></tr>
<tr><th id="5707">5707</th><td></td></tr>
<tr><th id="5708">5708</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"Multicast packets Sent         %u"</q>, <a class="local col1 ref" href="#611m" title='m' data-ref="611m" data-ref-filename="611m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::MulticastPacketsSent" title='mDNS_struct::MulticastPacketsSent' data-ref="mDNS_struct::MulticastPacketsSent" data-ref-filename="mDNS_struct..MulticastPacketsSent">MulticastPacketsSent</a>);</td></tr>
<tr><th id="5709">5709</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"Multicast packets Received     %u"</q>, <a class="local col1 ref" href="#611m" title='m' data-ref="611m" data-ref-filename="611m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::MPktNum" title='mDNS_struct::MPktNum' data-ref="mDNS_struct::MPktNum" data-ref-filename="mDNS_struct..MPktNum">MPktNum</a>);</td></tr>
<tr><th id="5710">5710</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"Remote Subnet packets          %u"</q>, <a class="local col1 ref" href="#611m" title='m' data-ref="611m" data-ref-filename="611m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::RemoteSubnet" title='mDNS_struct::RemoteSubnet' data-ref="mDNS_struct::RemoteSubnet" data-ref-filename="mDNS_struct..RemoteSubnet">RemoteSubnet</a>);</td></tr>
<tr><th id="5711">5711</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"QU questions  received         %u"</q>, <a class="local col1 ref" href="#611m" title='m' data-ref="611m" data-ref-filename="611m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::mDNSStats" title='mDNS_struct::mDNSStats' data-ref="mDNS_struct::mDNSStats" data-ref-filename="mDNS_struct..mDNSStats">mDNSStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::UnicastBitInQueries" title='(anonymous struct)::UnicastBitInQueries' data-ref="(anonymous)::UnicastBitInQueries" data-ref-filename="(anonymous)..UnicastBitInQueries">UnicastBitInQueries</a>);</td></tr>
<tr><th id="5712">5712</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"Normal multicast questions     %u"</q>, <a class="local col1 ref" href="#611m" title='m' data-ref="611m" data-ref-filename="611m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::mDNSStats" title='mDNS_struct::mDNSStats' data-ref="mDNS_struct::mDNSStats" data-ref-filename="mDNS_struct..mDNSStats">mDNSStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::NormalQueries" title='(anonymous struct)::NormalQueries' data-ref="(anonymous)::NormalQueries" data-ref-filename="(anonymous)..NormalQueries">NormalQueries</a>);</td></tr>
<tr><th id="5713">5713</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"Answers for questions          %u"</q>, <a class="local col1 ref" href="#611m" title='m' data-ref="611m" data-ref-filename="611m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::mDNSStats" title='mDNS_struct::mDNSStats' data-ref="mDNS_struct::mDNSStats" data-ref-filename="mDNS_struct..mDNSStats">mDNSStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::MatchingAnswersForQueries" title='(anonymous struct)::MatchingAnswersForQueries' data-ref="(anonymous)::MatchingAnswersForQueries" data-ref-filename="(anonymous)..MatchingAnswersForQueries">MatchingAnswersForQueries</a>);</td></tr>
<tr><th id="5714">5714</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"Unicast responses              %u"</q>, <a class="local col1 ref" href="#611m" title='m' data-ref="611m" data-ref-filename="611m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::mDNSStats" title='mDNS_struct::mDNSStats' data-ref="mDNS_struct::mDNSStats" data-ref-filename="mDNS_struct..mDNSStats">mDNSStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::UnicastResponses" title='(anonymous struct)::UnicastResponses' data-ref="(anonymous)::UnicastResponses" data-ref-filename="(anonymous)..UnicastResponses">UnicastResponses</a>);</td></tr>
<tr><th id="5715">5715</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"Multicast responses            %u"</q>, <a class="local col1 ref" href="#611m" title='m' data-ref="611m" data-ref-filename="611m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::mDNSStats" title='mDNS_struct::mDNSStats' data-ref="mDNS_struct::mDNSStats" data-ref-filename="mDNS_struct..mDNSStats">mDNSStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::MulticastResponses" title='(anonymous struct)::MulticastResponses' data-ref="(anonymous)::MulticastResponses" data-ref-filename="(anonymous)..MulticastResponses">MulticastResponses</a>);</td></tr>
<tr><th id="5716">5716</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"Unicast response Demotions     %u"</q>, <a class="local col1 ref" href="#611m" title='m' data-ref="611m" data-ref-filename="611m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::mDNSStats" title='mDNS_struct::mDNSStats' data-ref="mDNS_struct::mDNSStats" data-ref-filename="mDNS_struct..mDNSStats">mDNSStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::UnicastDemotedToMulticast" title='(anonymous struct)::UnicastDemotedToMulticast' data-ref="(anonymous)::UnicastDemotedToMulticast" data-ref-filename="(anonymous)..UnicastDemotedToMulticast">UnicastDemotedToMulticast</a>);</td></tr>
<tr><th id="5717">5717</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"--------------------------------"</q>);</td></tr>
<tr><th id="5718">5718</th><td></td></tr>
<tr><th id="5719">5719</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"Sleeps                         %u"</q>, <a class="local col1 ref" href="#611m" title='m' data-ref="611m" data-ref-filename="611m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::mDNSStats" title='mDNS_struct::mDNSStats' data-ref="mDNS_struct::mDNSStats" data-ref-filename="mDNS_struct..mDNSStats">mDNSStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::Sleeps" title='(anonymous struct)::Sleeps' data-ref="(anonymous)::Sleeps" data-ref-filename="(anonymous)..Sleeps">Sleeps</a>);</td></tr>
<tr><th id="5720">5720</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"Wakeups                        %u"</q>, <a class="local col1 ref" href="#611m" title='m' data-ref="611m" data-ref-filename="611m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::mDNSStats" title='mDNS_struct::mDNSStats' data-ref="mDNS_struct::mDNSStats" data-ref-filename="mDNS_struct..mDNSStats">mDNSStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::Wakes" title='(anonymous struct)::Wakes' data-ref="(anonymous)::Wakes" data-ref-filename="(anonymous)..Wakes">Wakes</a>);</td></tr>
<tr><th id="5721">5721</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"Interface UP events            %u"</q>, <a class="local col1 ref" href="#611m" title='m' data-ref="611m" data-ref-filename="611m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::mDNSStats" title='mDNS_struct::mDNSStats' data-ref="mDNS_struct::mDNSStats" data-ref-filename="mDNS_struct..mDNSStats">mDNSStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::InterfaceUp" title='(anonymous struct)::InterfaceUp' data-ref="(anonymous)::InterfaceUp" data-ref-filename="(anonymous)..InterfaceUp">InterfaceUp</a>);</td></tr>
<tr><th id="5722">5722</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"Interface UP Flap events       %u"</q>, <a class="local col1 ref" href="#611m" title='m' data-ref="611m" data-ref-filename="611m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::mDNSStats" title='mDNS_struct::mDNSStats' data-ref="mDNS_struct::mDNSStats" data-ref-filename="mDNS_struct..mDNSStats">mDNSStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::InterfaceUpFlap" title='(anonymous struct)::InterfaceUpFlap' data-ref="(anonymous)::InterfaceUpFlap" data-ref-filename="(anonymous)..InterfaceUpFlap">InterfaceUpFlap</a>);</td></tr>
<tr><th id="5723">5723</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"Interface Down events          %u"</q>, <a class="local col1 ref" href="#611m" title='m' data-ref="611m" data-ref-filename="611m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::mDNSStats" title='mDNS_struct::mDNSStats' data-ref="mDNS_struct::mDNSStats" data-ref-filename="mDNS_struct..mDNSStats">mDNSStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::InterfaceDown" title='(anonymous struct)::InterfaceDown' data-ref="(anonymous)::InterfaceDown" data-ref-filename="(anonymous)..InterfaceDown">InterfaceDown</a>);</td></tr>
<tr><th id="5724">5724</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"Interface DownFlap events      %u"</q>, <a class="local col1 ref" href="#611m" title='m' data-ref="611m" data-ref-filename="611m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::mDNSStats" title='mDNS_struct::mDNSStats' data-ref="mDNS_struct::mDNSStats" data-ref-filename="mDNS_struct..mDNSStats">mDNSStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::InterfaceDownFlap" title='(anonymous struct)::InterfaceDownFlap' data-ref="(anonymous)::InterfaceDownFlap" data-ref-filename="(anonymous)..InterfaceDownFlap">InterfaceDownFlap</a>);</td></tr>
<tr><th id="5725">5725</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"Cache refresh queries          %u"</q>, <a class="local col1 ref" href="#611m" title='m' data-ref="611m" data-ref-filename="611m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::mDNSStats" title='mDNS_struct::mDNSStats' data-ref="mDNS_struct::mDNSStats" data-ref-filename="mDNS_struct..mDNSStats">mDNSStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::CacheRefreshQueries" title='(anonymous struct)::CacheRefreshQueries' data-ref="(anonymous)::CacheRefreshQueries" data-ref-filename="(anonymous)..CacheRefreshQueries">CacheRefreshQueries</a>);</td></tr>
<tr><th id="5726">5726</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"Cache refreshed                %u"</q>, <a class="local col1 ref" href="#611m" title='m' data-ref="611m" data-ref-filename="611m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::mDNSStats" title='mDNS_struct::mDNSStats' data-ref="mDNS_struct::mDNSStats" data-ref-filename="mDNS_struct..mDNSStats">mDNSStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::CacheRefreshed" title='(anonymous struct)::CacheRefreshed' data-ref="(anonymous)::CacheRefreshed" data-ref-filename="(anonymous)..CacheRefreshed">CacheRefreshed</a>);</td></tr>
<tr><th id="5727">5727</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"Wakeup on Resolves             %u"</q>, <a class="local col1 ref" href="#611m" title='m' data-ref="611m" data-ref-filename="611m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::mDNSStats" title='mDNS_struct::mDNSStats' data-ref="mDNS_struct::mDNSStats" data-ref-filename="mDNS_struct..mDNSStats">mDNSStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::WakeOnResolves" title='(anonymous struct)::WakeOnResolves' data-ref="(anonymous)::WakeOnResolves" data-ref-filename="(anonymous)..WakeOnResolves">WakeOnResolves</a>);</td></tr>
<tr><th id="5728">5728</th><td>}</td></tr>
<tr><th id="5729">5729</th><td></td></tr>
<tr><th id="5730">5730</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#116" title="" data-ref="_M/mDNSexport">mDNSexport</a> <em>void</em> <dfn class="decl def fn" id="udsserver_info" title='udsserver_info' data-ref="udsserver_info" data-ref-filename="udsserver_info">udsserver_info</dfn>()</td></tr>
<tr><th id="5731">5731</th><td>{</td></tr>
<tr><th id="5732">5732</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS" title='mDNS' data-type='struct mDNS_struct' data-ref="mDNS" data-ref-filename="mDNS">mDNS</a> *<em>const</em> <dfn class="local col2 decl" id="612m" title='m' data-type='mDNS *const' data-ref="612m" data-ref-filename="612m">m</dfn> = &amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>;</td></tr>
<tr><th id="5733">5733</th><td>    <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSs32" title='mDNSs32' data-type='int' data-ref="mDNSs32" data-ref-filename="mDNSs32">mDNSs32</a> <dfn class="local col3 decl" id="613now" title='now' data-type='const mDNSs32' data-ref="613now" data-ref-filename="613now">now</dfn> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_TimeNow" title='mDNS_TimeNow' data-ref="mDNS_TimeNow" data-ref-filename="mDNS_TimeNow">mDNS_TimeNow</a>(<a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>);</td></tr>
<tr><th id="5734">5734</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col4 decl" id="614CacheUsed" title='CacheUsed' data-type='mDNSu32' data-ref="614CacheUsed" data-ref-filename="614CacheUsed">CacheUsed</dfn> = <var>0</var>, <dfn class="local col5 decl" id="615CacheActive" title='CacheActive' data-type='mDNSu32' data-ref="615CacheActive" data-ref-filename="615CacheActive">CacheActive</dfn> = <var>0</var>, <dfn class="local col6 decl" id="616slot" title='slot' data-type='mDNSu32' data-ref="616slot" data-ref-filename="616slot">slot</dfn>;</td></tr>
<tr><th id="5735">5735</th><td>    <em>int</em> <dfn class="local col7 decl" id="617ProxyA" title='ProxyA' data-type='int' data-ref="617ProxyA" data-ref-filename="617ProxyA">ProxyA</dfn> = <var>0</var>, <dfn class="local col8 decl" id="618ProxyD" title='ProxyD' data-type='int' data-ref="618ProxyD" data-ref-filename="618ProxyD">ProxyD</dfn> = <var>0</var>;</td></tr>
<tr><th id="5736">5736</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col9 decl" id="619groupCount" title='groupCount' data-type='mDNSu32' data-ref="619groupCount" data-ref-filename="619groupCount">groupCount</dfn> = <var>0</var>;</td></tr>
<tr><th id="5737">5737</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col0 decl" id="620mcastRecordCount" title='mcastRecordCount' data-type='mDNSu32' data-ref="620mcastRecordCount" data-ref-filename="620mcastRecordCount">mcastRecordCount</dfn> = <var>0</var>;</td></tr>
<tr><th id="5738">5738</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> <dfn class="local col1 decl" id="621ucastRecordCount" title='ucastRecordCount' data-type='mDNSu32' data-ref="621ucastRecordCount" data-ref-filename="621ucastRecordCount">ucastRecordCount</dfn> = <var>0</var>;</td></tr>
<tr><th id="5739">5739</th><td>    <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#CacheGroup" title='CacheGroup' data-type='struct CacheGroup_struct' data-ref="CacheGroup" data-ref-filename="CacheGroup">CacheGroup</a> *<dfn class="local col2 decl" id="622cg" title='cg' data-type='const CacheGroup *' data-ref="622cg" data-ref-filename="622cg">cg</dfn>;</td></tr>
<tr><th id="5740">5740</th><td>    <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#CacheRecord" title='CacheRecord' data-type='struct CacheRecord_struct' data-ref="CacheRecord" data-ref-filename="CacheRecord">CacheRecord</a> *<dfn class="local col3 decl" id="623cr" title='cr' data-type='const CacheRecord *' data-ref="623cr" data-ref-filename="623cr">cr</dfn>;</td></tr>
<tr><th id="5741">5741</th><td>    <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion" title='DNSQuestion' data-type='struct DNSQuestion_struct' data-ref="DNSQuestion" data-ref-filename="DNSQuestion">DNSQuestion</a> *<dfn class="local col4 decl" id="624q" title='q' data-type='const DNSQuestion *' data-ref="624q" data-ref-filename="624q">q</dfn>;</td></tr>
<tr><th id="5742">5742</th><td>    <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem" title='DNameListElem' data-type='struct DNameListElem' data-ref="DNameListElem" data-ref-filename="DNameListElem">DNameListElem</a> *<dfn class="local col5 decl" id="625d" title='d' data-type='const DNameListElem *' data-ref="625d" data-ref-filename="625d">d</dfn>;</td></tr>
<tr><th id="5743">5743</th><td>    <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#SearchListElem" title='SearchListElem' data-type='struct SearchListElem' data-ref="SearchListElem" data-ref-filename="SearchListElem">SearchListElem</a> *<dfn class="local col6 decl" id="626s" title='s' data-type='const SearchListElem *' data-ref="626s" data-ref-filename="626s">s</dfn>;</td></tr>
<tr><th id="5744">5744</th><td></td></tr>
<tr><th id="5745">5745</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"Timenow 0x%08lX (%d)"</q>, (<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a>)<a class="local col3 ref" href="#613now" title='now' data-ref="613now" data-ref-filename="613now">now</a>, <a class="local col3 ref" href="#613now" title='now' data-ref="613now" data-ref-filename="613now">now</a>);</td></tr>
<tr><th id="5746">5746</th><td></td></tr>
<tr><th id="5747">5747</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"------------ Cache -------------"</q>);</td></tr>
<tr><th id="5748">5748</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"Slt Q     TTL if     U Type rdlen"</q>);</td></tr>
<tr><th id="5749">5749</th><td>    <b>for</b> (<a class="local col6 ref" href="#616slot" title='slot' data-ref="616slot" data-ref-filename="616slot">slot</a> = <var>0</var>; <a class="local col6 ref" href="#616slot" title='slot' data-ref="616slot" data-ref-filename="616slot">slot</a> &lt; <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2197" title="499" data-ref="_M/CACHE_HASH_SLOTS">CACHE_HASH_SLOTS</a>; <a class="local col6 ref" href="#616slot" title='slot' data-ref="616slot" data-ref-filename="616slot">slot</a>++)</td></tr>
<tr><th id="5750">5750</th><td>    {</td></tr>
<tr><th id="5751">5751</th><td>        <b>for</b> (<a class="local col2 ref" href="#622cg" title='cg' data-ref="622cg" data-ref-filename="622cg">cg</a> = <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::rrcache_hash" title='mDNS_struct::rrcache_hash' data-ref="mDNS_struct::rrcache_hash" data-ref-filename="mDNS_struct..rrcache_hash">rrcache_hash</a>[<a class="local col6 ref" href="#616slot" title='slot' data-ref="616slot" data-ref-filename="616slot">slot</a>]; <a class="local col2 ref" href="#622cg" title='cg' data-ref="622cg" data-ref-filename="622cg">cg</a>; <a class="local col2 ref" href="#622cg" title='cg' data-ref="622cg" data-ref-filename="622cg">cg</a>=<a class="local col2 ref" href="#622cg" title='cg' data-ref="622cg" data-ref-filename="622cg">cg</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#CacheGroup_struct::next" title='CacheGroup_struct::next' data-ref="CacheGroup_struct::next" data-ref-filename="CacheGroup_struct..next">next</a>)</td></tr>
<tr><th id="5752">5752</th><td>        {</td></tr>
<tr><th id="5753">5753</th><td>            <a class="local col9 ref" href="#619groupCount" title='groupCount' data-ref="619groupCount" data-ref-filename="619groupCount">groupCount</a>++;   <i>// Count one cache entity for the CacheGroup object</i></td></tr>
<tr><th id="5754">5754</th><td>            <b>for</b> (<a class="local col3 ref" href="#623cr" title='cr' data-ref="623cr" data-ref-filename="623cr">cr</a> = <a class="local col2 ref" href="#622cg" title='cg' data-ref="622cg" data-ref-filename="622cg">cg</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#CacheGroup_struct::members" title='CacheGroup_struct::members' data-ref="CacheGroup_struct::members" data-ref-filename="CacheGroup_struct..members">members</a>; <a class="local col3 ref" href="#623cr" title='cr' data-ref="623cr" data-ref-filename="623cr">cr</a>; <a class="local col3 ref" href="#623cr" title='cr' data-ref="623cr" data-ref-filename="623cr">cr</a>=<a class="local col3 ref" href="#623cr" title='cr' data-ref="623cr" data-ref-filename="623cr">cr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#CacheRecord_struct::next" title='CacheRecord_struct::next' data-ref="CacheRecord_struct::next" data-ref-filename="CacheRecord_struct..next">next</a>)</td></tr>
<tr><th id="5755">5755</th><td>            {</td></tr>
<tr><th id="5756">5756</th><td>                <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSs32" title='mDNSs32' data-type='int' data-ref="mDNSs32" data-ref-filename="mDNSs32">mDNSs32</a> <dfn class="local col7 decl" id="627remain" title='remain' data-type='const mDNSs32' data-ref="627remain" data-ref-filename="627remain">remain</dfn> = <a class="local col3 ref" href="#623cr" title='cr' data-ref="623cr" data-ref-filename="623cr">cr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#CacheRecord_struct::resrec" title='CacheRecord_struct::resrec' data-ref="CacheRecord_struct::resrec" data-ref-filename="CacheRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rroriginalttl" title='ResourceRecord_struct::rroriginalttl' data-ref="ResourceRecord_struct::rroriginalttl" data-ref-filename="ResourceRecord_struct..rroriginalttl">rroriginalttl</a> - (<a class="local col3 ref" href="#613now" title='now' data-ref="613now" data-ref-filename="613now">now</a> - <a class="local col3 ref" href="#623cr" title='cr' data-ref="623cr" data-ref-filename="623cr">cr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#CacheRecord_struct::TimeRcvd" title='CacheRecord_struct::TimeRcvd' data-ref="CacheRecord_struct::TimeRcvd" data-ref-filename="CacheRecord_struct..TimeRcvd">TimeRcvd</a>) / <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformOneSecond" title='mDNSPlatformOneSecond' data-ref="mDNSPlatformOneSecond" data-ref-filename="mDNSPlatformOneSecond">mDNSPlatformOneSecond</a>;</td></tr>
<tr><th id="5757">5757</th><td>                <em>const</em> <em>char</em> *<dfn class="local col8 decl" id="628ifname" title='ifname' data-type='const char *' data-ref="628ifname" data-ref-filename="628ifname">ifname</dfn>;</td></tr>
<tr><th id="5758">5758</th><td>                <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterfaceID" title='mDNSInterfaceID' data-type='struct mDNSInterfaceID_dummystruct *' data-ref="mDNSInterfaceID" data-ref-filename="mDNSInterfaceID">mDNSInterfaceID</a> <dfn class="local col9 decl" id="629InterfaceID" title='InterfaceID' data-type='mDNSInterfaceID' data-ref="629InterfaceID" data-ref-filename="629InterfaceID">InterfaceID</dfn> = <a class="local col3 ref" href="#623cr" title='cr' data-ref="623cr" data-ref-filename="623cr">cr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#CacheRecord_struct::resrec" title='CacheRecord_struct::resrec' data-ref="CacheRecord_struct::resrec" data-ref-filename="CacheRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::InterfaceID" title='ResourceRecord_struct::InterfaceID' data-ref="ResourceRecord_struct::InterfaceID" data-ref-filename="ResourceRecord_struct..InterfaceID">InterfaceID</a>;</td></tr>
<tr><th id="5759">5759</th><td>                <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu32" title='mDNSu32' data-type='unsigned int' data-ref="mDNSu32" data-ref-filename="mDNSu32">mDNSu32</a> *<em>const</em> <dfn class="local col0 decl" id="630countPtr" title='countPtr' data-type='mDNSu32 *const' data-ref="630countPtr" data-ref-filename="630countPtr">countPtr</dfn> = <a class="local col9 ref" href="#629InterfaceID" title='InterfaceID' data-ref="629InterfaceID" data-ref-filename="629InterfaceID">InterfaceID</a> ? &amp;<a class="local col0 ref" href="#620mcastRecordCount" title='mcastRecordCount' data-ref="620mcastRecordCount" data-ref-filename="620mcastRecordCount">mcastRecordCount</a> : &amp;<a class="local col1 ref" href="#621ucastRecordCount" title='ucastRecordCount' data-ref="621ucastRecordCount" data-ref-filename="621ucastRecordCount">ucastRecordCount</a>;</td></tr>
<tr><th id="5760">5760</th><td>                <b>if</b> (!<a class="local col9 ref" href="#629InterfaceID" title='InterfaceID' data-ref="629InterfaceID" data-ref-filename="629InterfaceID">InterfaceID</a> &amp;&amp; <a class="local col3 ref" href="#623cr" title='cr' data-ref="623cr" data-ref-filename="623cr">cr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#CacheRecord_struct::resrec" title='CacheRecord_struct::resrec' data-ref="CacheRecord_struct::resrec" data-ref-filename="CacheRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rDNSServer" title='ResourceRecord_struct::rDNSServer' data-ref="ResourceRecord_struct::rDNSServer" data-ref-filename="ResourceRecord_struct..rDNSServer">rDNSServer</a> &amp;&amp; <a class="local col3 ref" href="#623cr" title='cr' data-ref="623cr" data-ref-filename="623cr">cr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#CacheRecord_struct::resrec" title='CacheRecord_struct::resrec' data-ref="CacheRecord_struct::resrec" data-ref-filename="CacheRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rDNSServer" title='ResourceRecord_struct::rDNSServer' data-ref="ResourceRecord_struct::rDNSServer" data-ref-filename="ResourceRecord_struct..rDNSServer">rDNSServer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSServer::scoped" title='DNSServer::scoped' data-ref="DNSServer::scoped" data-ref-filename="DNSServer..scoped">scoped</a>)</td></tr>
<tr><th id="5761">5761</th><td>                    <a class="local col9 ref" href="#629InterfaceID" title='InterfaceID' data-ref="629InterfaceID" data-ref-filename="629InterfaceID">InterfaceID</a> = <a class="local col3 ref" href="#623cr" title='cr' data-ref="623cr" data-ref-filename="623cr">cr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#CacheRecord_struct::resrec" title='CacheRecord_struct::resrec' data-ref="CacheRecord_struct::resrec" data-ref-filename="CacheRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::rDNSServer" title='ResourceRecord_struct::rDNSServer' data-ref="ResourceRecord_struct::rDNSServer" data-ref-filename="ResourceRecord_struct..rDNSServer">rDNSServer</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSServer::interface" title='DNSServer::interface' data-ref="DNSServer::interface" data-ref-filename="DNSServer..interface">interface</a>;</td></tr>
<tr><th id="5762">5762</th><td>                <a class="local col8 ref" href="#628ifname" title='ifname' data-ref="628ifname" data-ref-filename="628ifname">ifname</a> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#InterfaceNameForID" title='InterfaceNameForID' data-ref="InterfaceNameForID" data-ref-filename="InterfaceNameForID">InterfaceNameForID</a>(<a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>, <a class="local col9 ref" href="#629InterfaceID" title='InterfaceID' data-ref="629InterfaceID" data-ref-filename="629InterfaceID">InterfaceID</a>);</td></tr>
<tr><th id="5763">5763</th><td>                <b>if</b> (<a class="local col3 ref" href="#623cr" title='cr' data-ref="623cr" data-ref-filename="623cr">cr</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#CacheRecord_struct::CRActiveQuestion" title='CacheRecord_struct::CRActiveQuestion' data-ref="CacheRecord_struct::CRActiveQuestion" data-ref-filename="CacheRecord_struct..CRActiveQuestion">CRActiveQuestion</a>) <a class="local col5 ref" href="#615CacheActive" title='CacheActive' data-ref="615CacheActive" data-ref-filename="615CacheActive">CacheActive</a>++;</td></tr>
<tr><th id="5764">5764</th><td>                <a class="ref fn" href="#PrintOneCacheRecord" title='PrintOneCacheRecord' data-ref="PrintOneCacheRecord" data-ref-filename="PrintOneCacheRecord">PrintOneCacheRecord</a>(<a class="local col3 ref" href="#623cr" title='cr' data-ref="623cr" data-ref-filename="623cr">cr</a>, <a class="local col6 ref" href="#616slot" title='slot' data-ref="616slot" data-ref-filename="616slot">slot</a>, <a class="local col7 ref" href="#627remain" title='remain' data-ref="627remain" data-ref-filename="627remain">remain</a>, <a class="local col8 ref" href="#628ifname" title='ifname' data-ref="628ifname" data-ref-filename="628ifname">ifname</a>, <a class="local col0 ref" href="#630countPtr" title='countPtr' data-ref="630countPtr" data-ref-filename="630countPtr">countPtr</a>);</td></tr>
<tr><th id="5765">5765</th><td>                <a class="ref fn" href="#PrintCachedRecords" title='PrintCachedRecords' data-ref="PrintCachedRecords" data-ref-filename="PrintCachedRecords">PrintCachedRecords</a>(<a class="local col3 ref" href="#623cr" title='cr' data-ref="623cr" data-ref-filename="623cr">cr</a>, <a class="local col6 ref" href="#616slot" title='slot' data-ref="616slot" data-ref-filename="616slot">slot</a>, <a class="local col7 ref" href="#627remain" title='remain' data-ref="627remain" data-ref-filename="627remain">remain</a>, <a class="local col8 ref" href="#628ifname" title='ifname' data-ref="628ifname" data-ref-filename="628ifname">ifname</a>, <a class="local col0 ref" href="#630countPtr" title='countPtr' data-ref="630countPtr" data-ref-filename="630countPtr">countPtr</a>);</td></tr>
<tr><th id="5766">5766</th><td>            }</td></tr>
<tr><th id="5767">5767</th><td>        }</td></tr>
<tr><th id="5768">5768</th><td>    }</td></tr>
<tr><th id="5769">5769</th><td></td></tr>
<tr><th id="5770">5770</th><td>    <a class="local col4 ref" href="#614CacheUsed" title='CacheUsed' data-ref="614CacheUsed" data-ref-filename="614CacheUsed">CacheUsed</a> = <a class="local col9 ref" href="#619groupCount" title='groupCount' data-ref="619groupCount" data-ref-filename="619groupCount">groupCount</a> + <a class="local col0 ref" href="#620mcastRecordCount" title='mcastRecordCount' data-ref="620mcastRecordCount" data-ref-filename="620mcastRecordCount">mcastRecordCount</a> + <a class="local col1 ref" href="#621ucastRecordCount" title='ucastRecordCount' data-ref="621ucastRecordCount" data-ref-filename="621ucastRecordCount">ucastRecordCount</a>;</td></tr>
<tr><th id="5771">5771</th><td>    <b>if</b> (<a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::rrcache_totalused" title='mDNS_struct::rrcache_totalused' data-ref="mDNS_struct::rrcache_totalused" data-ref-filename="mDNS_struct..rrcache_totalused">rrcache_totalused</a> != <a class="local col4 ref" href="#614CacheUsed" title='CacheUsed' data-ref="614CacheUsed" data-ref-filename="614CacheUsed">CacheUsed</a>)</td></tr>
<tr><th id="5772">5772</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"Cache use mismatch: rrcache_totalused is %lu, true count %lu"</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::rrcache_totalused" title='mDNS_struct::rrcache_totalused' data-ref="mDNS_struct::rrcache_totalused" data-ref-filename="mDNS_struct..rrcache_totalused">rrcache_totalused</a>, <a class="local col4 ref" href="#614CacheUsed" title='CacheUsed' data-ref="614CacheUsed" data-ref-filename="614CacheUsed">CacheUsed</a>);</td></tr>
<tr><th id="5773">5773</th><td>    <b>if</b> (<a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::rrcache_active" title='mDNS_struct::rrcache_active' data-ref="mDNS_struct::rrcache_active" data-ref-filename="mDNS_struct..rrcache_active">rrcache_active</a> != <a class="local col5 ref" href="#615CacheActive" title='CacheActive' data-ref="615CacheActive" data-ref-filename="615CacheActive">CacheActive</a>)</td></tr>
<tr><th id="5774">5774</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"Cache use mismatch: rrcache_active is %lu, true count %lu"</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::rrcache_active" title='mDNS_struct::rrcache_active' data-ref="mDNS_struct::rrcache_active" data-ref-filename="mDNS_struct..rrcache_active">rrcache_active</a>, <a class="local col5 ref" href="#615CacheActive" title='CacheActive' data-ref="615CacheActive" data-ref-filename="615CacheActive">CacheActive</a>);</td></tr>
<tr><th id="5775">5775</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"Cache size %u entities; %u in use (%u group, %u multicast, %u unicast); %u referenced by active questions"</q>,</td></tr>
<tr><th id="5776">5776</th><td>        <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::rrcache_size" title='mDNS_struct::rrcache_size' data-ref="mDNS_struct::rrcache_size" data-ref-filename="mDNS_struct..rrcache_size">rrcache_size</a>, <a class="local col4 ref" href="#614CacheUsed" title='CacheUsed' data-ref="614CacheUsed" data-ref-filename="614CacheUsed">CacheUsed</a>, <a class="local col9 ref" href="#619groupCount" title='groupCount' data-ref="619groupCount" data-ref-filename="619groupCount">groupCount</a>, <a class="local col0 ref" href="#620mcastRecordCount" title='mcastRecordCount' data-ref="620mcastRecordCount" data-ref-filename="620mcastRecordCount">mcastRecordCount</a>, <a class="local col1 ref" href="#621ucastRecordCount" title='ucastRecordCount' data-ref="621ucastRecordCount" data-ref-filename="621ucastRecordCount">ucastRecordCount</a>, <a class="local col5 ref" href="#615CacheActive" title='CacheActive' data-ref="615CacheActive" data-ref-filename="615CacheActive">CacheActive</a>);</td></tr>
<tr><th id="5777">5777</th><td></td></tr>
<tr><th id="5778">5778</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"--------- Auth Records ---------"</q>);</td></tr>
<tr><th id="5779">5779</th><td>    <a class="ref fn" href="#LogAuthRecords" title='LogAuthRecords' data-ref="LogAuthRecords" data-ref-filename="LogAuthRecords">LogAuthRecords</a>(<a class="local col3 ref" href="#613now" title='now' data-ref="613now" data-ref-filename="613now">now</a>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::ResourceRecords" title='mDNS_struct::ResourceRecords' data-ref="mDNS_struct::ResourceRecords" data-ref-filename="mDNS_struct..ResourceRecords">ResourceRecords</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>);</td></tr>
<tr><th id="5780">5780</th><td></td></tr>
<tr><th id="5781">5781</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"--------- LocalOnly, P2P Auth Records ---------"</q>);</td></tr>
<tr><th id="5782">5782</th><td>    <a class="ref fn" href="#LogLocalOnlyAuthRecords" title='LogLocalOnlyAuthRecords' data-ref="LogLocalOnlyAuthRecords" data-ref-filename="LogLocalOnlyAuthRecords">LogLocalOnlyAuthRecords</a>(<a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>);</td></tr>
<tr><th id="5783">5783</th><td></td></tr>
<tr><th id="5784">5784</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"--------- /etc/hosts ---------"</q>);</td></tr>
<tr><th id="5785">5785</th><td>    <a class="ref fn" href="#LogEtcHosts" title='LogEtcHosts' data-ref="LogEtcHosts" data-ref-filename="LogEtcHosts">LogEtcHosts</a>(<a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>);</td></tr>
<tr><th id="5786">5786</th><td></td></tr>
<tr><th id="5787">5787</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"------ Duplicate Records -------"</q>);</td></tr>
<tr><th id="5788">5788</th><td>    <a class="ref fn" href="#LogAuthRecords" title='LogAuthRecords' data-ref="LogAuthRecords" data-ref-filename="LogAuthRecords">LogAuthRecords</a>(<a class="local col3 ref" href="#613now" title='now' data-ref="613now" data-ref-filename="613now">now</a>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::DuplicateRecords" title='mDNS_struct::DuplicateRecords' data-ref="mDNS_struct::DuplicateRecords" data-ref-filename="mDNS_struct..DuplicateRecords">DuplicateRecords</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#328" title="0L" data-ref="_M/mDNSNULL">mDNSNULL</a>);</td></tr>
<tr><th id="5789">5789</th><td></td></tr>
<tr><th id="5790">5790</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"----- Auth Records Proxied -----"</q>);</td></tr>
<tr><th id="5791">5791</th><td>    <a class="ref fn" href="#LogAuthRecords" title='LogAuthRecords' data-ref="LogAuthRecords" data-ref-filename="LogAuthRecords">LogAuthRecords</a>(<a class="local col3 ref" href="#613now" title='now' data-ref="613now" data-ref-filename="613now">now</a>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::ResourceRecords" title='mDNS_struct::ResourceRecords' data-ref="mDNS_struct::ResourceRecords" data-ref-filename="mDNS_struct..ResourceRecords">ResourceRecords</a>, &amp;<a class="local col7 ref" href="#617ProxyA" title='ProxyA' data-ref="617ProxyA" data-ref-filename="617ProxyA">ProxyA</a>);</td></tr>
<tr><th id="5792">5792</th><td></td></tr>
<tr><th id="5793">5793</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"-- Duplicate Records Proxied ---"</q>);</td></tr>
<tr><th id="5794">5794</th><td>    <a class="ref fn" href="#LogAuthRecords" title='LogAuthRecords' data-ref="LogAuthRecords" data-ref-filename="LogAuthRecords">LogAuthRecords</a>(<a class="local col3 ref" href="#613now" title='now' data-ref="613now" data-ref-filename="613now">now</a>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::DuplicateRecords" title='mDNS_struct::DuplicateRecords' data-ref="mDNS_struct::DuplicateRecords" data-ref-filename="mDNS_struct..DuplicateRecords">DuplicateRecords</a>, &amp;<a class="local col8 ref" href="#618ProxyD" title='ProxyD' data-ref="618ProxyD" data-ref-filename="618ProxyD">ProxyD</a>);</td></tr>
<tr><th id="5795">5795</th><td></td></tr>
<tr><th id="5796">5796</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"---------- Questions -----------"</q>);</td></tr>
<tr><th id="5797">5797</th><td>    <b>if</b> (!<a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::Questions" title='mDNS_struct::Questions' data-ref="mDNS_struct::Questions" data-ref-filename="mDNS_struct..Questions">Questions</a>) <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"&lt;None&gt;"</q>);</td></tr>
<tr><th id="5798">5798</th><td>    <b>else</b></td></tr>
<tr><th id="5799">5799</th><td>    {</td></tr>
<tr><th id="5800">5800</th><td>        <em>char</em> <dfn class="local col1 decl" id="631anonstr" title='anonstr' data-type='char [256]' data-ref="631anonstr" data-ref-filename="631anonstr">anonstr</dfn>[<var>256</var>];</td></tr>
<tr><th id="5801">5801</th><td>        <a class="local col4 ref" href="#614CacheUsed" title='CacheUsed' data-ref="614CacheUsed" data-ref-filename="614CacheUsed">CacheUsed</a> = <var>0</var>;</td></tr>
<tr><th id="5802">5802</th><td>        <a class="local col5 ref" href="#615CacheActive" title='CacheActive' data-ref="615CacheActive" data-ref-filename="615CacheActive">CacheActive</a> = <var>0</var>;</td></tr>
<tr><th id="5803">5803</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"   Int  Next if     T  NumAns VDNS    Qptr     DupOf    SU SQ Type Name"</q>);</td></tr>
<tr><th id="5804">5804</th><td>        <b>for</b> (<a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a> = <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::Questions" title='mDNS_struct::Questions' data-ref="mDNS_struct::Questions" data-ref-filename="mDNS_struct..Questions">Questions</a>; <a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>; <a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>=<a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::next" title='DNSQuestion_struct::next' data-ref="DNSQuestion_struct::next" data-ref-filename="DNSQuestion_struct..next">next</a>)</td></tr>
<tr><th id="5805">5805</th><td>        {</td></tr>
<tr><th id="5806">5806</th><td>            <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSs32" title='mDNSs32' data-type='int' data-ref="mDNSs32" data-ref-filename="mDNSs32">mDNSs32</a> <dfn class="local col2 decl" id="632i" title='i' data-type='mDNSs32' data-ref="632i" data-ref-filename="632i">i</dfn> = <a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ThisQInterval" title='DNSQuestion_struct::ThisQInterval' data-ref="DNSQuestion_struct::ThisQInterval" data-ref-filename="DNSQuestion_struct..ThisQInterval">ThisQInterval</a> / <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformOneSecond" title='mDNSPlatformOneSecond' data-ref="mDNSPlatformOneSecond" data-ref-filename="mDNSPlatformOneSecond">mDNSPlatformOneSecond</a>;</td></tr>
<tr><th id="5807">5807</th><td>            <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSs32" title='mDNSs32' data-type='int' data-ref="mDNSs32" data-ref-filename="mDNSs32">mDNSs32</a> <dfn class="local col3 decl" id="633n" title='n' data-type='mDNSs32' data-ref="633n" data-ref-filename="633n">n</dfn> = (<a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#1862" title="((q)-&gt;LastQTime + (q)-&gt;ThisQInterval)" data-ref="_M/NextQSendTime">NextQSendTime</a>(<a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>) - <a class="local col3 ref" href="#613now" title='now' data-ref="613now" data-ref-filename="613now">now</a>) / <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformOneSecond" title='mDNSPlatformOneSecond' data-ref="mDNSPlatformOneSecond" data-ref-filename="mDNSPlatformOneSecond">mDNSPlatformOneSecond</a>;</td></tr>
<tr><th id="5808">5808</th><td>            <em>char</em> *<dfn class="local col4 decl" id="634ifname" title='ifname' data-type='char *' data-ref="634ifname" data-ref-filename="634ifname">ifname</dfn> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#InterfaceNameForID" title='InterfaceNameForID' data-ref="InterfaceNameForID" data-ref-filename="InterfaceNameForID">InterfaceNameForID</a>(<a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>, <a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::InterfaceID" title='DNSQuestion_struct::InterfaceID' data-ref="DNSQuestion_struct::InterfaceID" data-ref-filename="DNSQuestion_struct..InterfaceID">InterfaceID</a>);</td></tr>
<tr><th id="5809">5809</th><td>            <a class="local col4 ref" href="#614CacheUsed" title='CacheUsed' data-ref="614CacheUsed" data-ref-filename="614CacheUsed">CacheUsed</a>++;</td></tr>
<tr><th id="5810">5810</th><td>            <b>if</b> (<a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ThisQInterval" title='DNSQuestion_struct::ThisQInterval' data-ref="DNSQuestion_struct::ThisQInterval" data-ref-filename="DNSQuestion_struct..ThisQInterval">ThisQInterval</a>) <a class="local col5 ref" href="#615CacheActive" title='CacheActive' data-ref="615CacheActive" data-ref-filename="615CacheActive">CacheActive</a>++;</td></tr>
<tr><th id="5811">5811</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"%6d%6d %-7s%s%s %5d 0x%x%x%x%x 0x%p 0x%p %1d %2d %-5s%##s%s%s"</q>,</td></tr>
<tr><th id="5812">5812</th><td>                          <a class="local col2 ref" href="#632i" title='i' data-ref="632i" data-ref-filename="632i">i</a>, <a class="local col3 ref" href="#633n" title='n' data-ref="633n" data-ref-filename="633n">n</a>,</td></tr>
<tr><th id="5813">5813</th><td>                          <a class="local col4 ref" href="#634ifname" title='ifname' data-ref="634ifname" data-ref-filename="634ifname">ifname</a> ? <a class="local col4 ref" href="#634ifname" title='ifname' data-ref="634ifname" data-ref-filename="634ifname">ifname</a> : <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2964" title="((q-&gt;TargetQID).NotAnInteger == 0)" data-ref="_M/mDNSOpaque16IsZero">mDNSOpaque16IsZero</a>(<a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::TargetQID" title='DNSQuestion_struct::TargetQID' data-ref="DNSQuestion_struct::TargetQID" data-ref-filename="DNSQuestion_struct..TargetQID">TargetQID</a>) ? <q>""</q> : <q>"-U-"</q>,</td></tr>
<tr><th id="5814">5814</th><td>                          <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2964" title="((q-&gt;TargetQID).NotAnInteger == 0)" data-ref="_M/mDNSOpaque16IsZero">mDNSOpaque16IsZero</a>(<a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::TargetQID" title='DNSQuestion_struct::TargetQID' data-ref="DNSQuestion_struct::TargetQID" data-ref-filename="DNSQuestion_struct..TargetQID">TargetQID</a>) ? (<a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::LongLived" title='DNSQuestion_struct::LongLived' data-ref="DNSQuestion_struct::LongLived" data-ref-filename="DNSQuestion_struct..LongLived">LongLived</a> ? <q>"l"</q> : <q>" "</q>) : (<a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::LongLived" title='DNSQuestion_struct::LongLived' data-ref="DNSQuestion_struct::LongLived" data-ref-filename="DNSQuestion_struct..LongLived">LongLived</a> ? <q>"L"</q> : <q>"O"</q>),</td></tr>
<tr><th id="5815">5815</th><td>                          <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#1617" title="((q)-&gt;AuthInfo &amp;&amp; (q)-&gt;AuthInfo-&gt;AutoTunnel)" data-ref="_M/PrivateQuery">PrivateQuery</a>(<a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>)    ? <q>"P"</q> : <a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ValidationRequired" title='DNSQuestion_struct::ValidationRequired' data-ref="DNSQuestion_struct::ValidationRequired" data-ref-filename="DNSQuestion_struct..ValidationRequired">ValidationRequired</a> ? <q>"V"</q> : <a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::ValidatingResponse" title='DNSQuestion_struct::ValidatingResponse' data-ref="DNSQuestion_struct::ValidatingResponse" data-ref-filename="DNSQuestion_struct..ValidatingResponse">ValidatingResponse</a> ? <q>"R"</q> : <q>" "</q>,</td></tr>
<tr><th id="5816">5816</th><td>                          <a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::CurrentAnswers" title='DNSQuestion_struct::CurrentAnswers' data-ref="DNSQuestion_struct::CurrentAnswers" data-ref-filename="DNSQuestion_struct..CurrentAnswers">CurrentAnswers</a>, <a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::validDNSServers" title='DNSQuestion_struct::validDNSServers' data-ref="DNSQuestion_struct::validDNSServers" data-ref-filename="DNSQuestion_struct..validDNSServers">validDNSServers</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::l" title='(anonymous union)::l' data-ref="(anonymous)::l" data-ref-filename="(anonymous)..l">l</a>[<var>3</var>], <a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::validDNSServers" title='DNSQuestion_struct::validDNSServers' data-ref="DNSQuestion_struct::validDNSServers" data-ref-filename="DNSQuestion_struct..validDNSServers">validDNSServers</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::l" title='(anonymous union)::l' data-ref="(anonymous)::l" data-ref-filename="(anonymous)..l">l</a>[<var>2</var>], <a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::validDNSServers" title='DNSQuestion_struct::validDNSServers' data-ref="DNSQuestion_struct::validDNSServers" data-ref-filename="DNSQuestion_struct..validDNSServers">validDNSServers</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::l" title='(anonymous union)::l' data-ref="(anonymous)::l" data-ref-filename="(anonymous)..l">l</a>[<var>1</var>],</td></tr>
<tr><th id="5817">5817</th><td>                          <a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::validDNSServers" title='DNSQuestion_struct::validDNSServers' data-ref="DNSQuestion_struct::validDNSServers" data-ref-filename="DNSQuestion_struct..validDNSServers">validDNSServers</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::l" title='(anonymous union)::l' data-ref="(anonymous)::l" data-ref-filename="(anonymous)..l">l</a>[<var>0</var>], <a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>, <a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::DuplicateOf" title='DNSQuestion_struct::DuplicateOf' data-ref="DNSQuestion_struct::DuplicateOf" data-ref-filename="DNSQuestion_struct..DuplicateOf">DuplicateOf</a>,</td></tr>
<tr><th id="5818">5818</th><td>                          <a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::SuppressUnusable" title='DNSQuestion_struct::SuppressUnusable' data-ref="DNSQuestion_struct::SuppressUnusable" data-ref-filename="DNSQuestion_struct..SuppressUnusable">SuppressUnusable</a>, <a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::SuppressQuery" title='DNSQuestion_struct::SuppressQuery' data-ref="DNSQuestion_struct::SuppressQuery" data-ref-filename="DNSQuestion_struct..SuppressQuery">SuppressQuery</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a>), <a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>,</td></tr>
<tr><th id="5819">5819</th><td>                          <a class="ref fn" href="#AnonInfoToString" title='AnonInfoToString' data-ref="AnonInfoToString" data-ref-filename="AnonInfoToString">AnonInfoToString</a>(<a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::AnonInfo" title='DNSQuestion_struct::AnonInfo' data-ref="DNSQuestion_struct::AnonInfo" data-ref-filename="DNSQuestion_struct..AnonInfo">AnonInfo</a>, <a class="local col1 ref" href="#631anonstr" title='anonstr' data-ref="631anonstr" data-ref-filename="631anonstr">anonstr</a>, <b>sizeof</b>(<a class="local col1 ref" href="#631anonstr" title='anonstr' data-ref="631anonstr" data-ref-filename="631anonstr">anonstr</a>)),</td></tr>
<tr><th id="5820">5820</th><td>                          <a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::DuplicateOf" title='DNSQuestion_struct::DuplicateOf' data-ref="DNSQuestion_struct::DuplicateOf" data-ref-filename="DNSQuestion_struct..DuplicateOf">DuplicateOf</a> ? <q>" (dup)"</q> : <q>""</q>);</td></tr>
<tr><th id="5821">5821</th><td>        }</td></tr>
<tr><th id="5822">5822</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"%lu question%s; %lu active"</q>, <a class="local col4 ref" href="#614CacheUsed" title='CacheUsed' data-ref="614CacheUsed" data-ref-filename="614CacheUsed">CacheUsed</a>, <a class="local col4 ref" href="#614CacheUsed" title='CacheUsed' data-ref="614CacheUsed" data-ref-filename="614CacheUsed">CacheUsed</a> &gt; <var>1</var> ? <q>"s"</q> : <q>""</q>, <a class="local col5 ref" href="#615CacheActive" title='CacheActive' data-ref="615CacheActive" data-ref-filename="615CacheActive">CacheActive</a>);</td></tr>
<tr><th id="5823">5823</th><td>    }</td></tr>
<tr><th id="5824">5824</th><td></td></tr>
<tr><th id="5825">5825</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"----- LocalOnly, P2P Questions -----"</q>);</td></tr>
<tr><th id="5826">5826</th><td>    <b>if</b> (!<a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::LocalOnlyQuestions" title='mDNS_struct::LocalOnlyQuestions' data-ref="mDNS_struct::LocalOnlyQuestions" data-ref-filename="mDNS_struct..LocalOnlyQuestions">LocalOnlyQuestions</a>) <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"&lt;None&gt;"</q>);</td></tr>
<tr><th id="5827">5827</th><td>    <b>else</b> <b>for</b> (<a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a> = <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::LocalOnlyQuestions" title='mDNS_struct::LocalOnlyQuestions' data-ref="mDNS_struct::LocalOnlyQuestions" data-ref-filename="mDNS_struct..LocalOnlyQuestions">LocalOnlyQuestions</a>; <a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>; <a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>=<a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::next" title='DNSQuestion_struct::next' data-ref="DNSQuestion_struct::next" data-ref-filename="DNSQuestion_struct..next">next</a>)</td></tr>
<tr><th id="5828">5828</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"                 %3s   %5d  %-6s%##s%s"</q>,</td></tr>
<tr><th id="5829">5829</th><td>                          <a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::InterfaceID" title='DNSQuestion_struct::InterfaceID' data-ref="DNSQuestion_struct::InterfaceID" data-ref-filename="DNSQuestion_struct..InterfaceID">InterfaceID</a> == <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterface_LocalOnly" title='mDNSInterface_LocalOnly' data-ref="mDNSInterface_LocalOnly" data-ref-filename="mDNSInterface_LocalOnly">mDNSInterface_LocalOnly</a> ? <q>"LO "</q>: <a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::InterfaceID" title='DNSQuestion_struct::InterfaceID' data-ref="DNSQuestion_struct::InterfaceID" data-ref-filename="DNSQuestion_struct..InterfaceID">InterfaceID</a> == <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSInterface_BLE" title='mDNSInterface_BLE' data-ref="mDNSInterface_BLE" data-ref-filename="mDNSInterface_BLE">mDNSInterface_BLE</a> ? <q>"BLE"</q>: <q>"P2P"</q>,</td></tr>
<tr><th id="5830">5830</th><td>                          <a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::CurrentAnswers" title='DNSQuestion_struct::CurrentAnswers' data-ref="DNSQuestion_struct::CurrentAnswers" data-ref-filename="DNSQuestion_struct..CurrentAnswers">CurrentAnswers</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a>), <a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="local col4 ref" href="#624q" title='q' data-ref="624q" data-ref-filename="624q">q</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::DuplicateOf" title='DNSQuestion_struct::DuplicateOf' data-ref="DNSQuestion_struct::DuplicateOf" data-ref-filename="DNSQuestion_struct..DuplicateOf">DuplicateOf</a> ? <q>" (dup)"</q> : <q>""</q>);</td></tr>
<tr><th id="5831">5831</th><td></td></tr>
<tr><th id="5832">5832</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"---- Active UDS Client Requests ----"</q>);</td></tr>
<tr><th id="5833">5833</th><td>    <b>if</b> (!<a class="tu ref" href="#all_requests" title='all_requests' data-use='r' data-ref="all_requests" data-ref-filename="all_requests">all_requests</a>) <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"&lt;None&gt;"</q>);</td></tr>
<tr><th id="5834">5834</th><td>    <b>else</b></td></tr>
<tr><th id="5835">5835</th><td>    {</td></tr>
<tr><th id="5836">5836</th><td>        <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<dfn class="local col5 decl" id="635req" title='req' data-type='request_state *' data-ref="635req" data-ref-filename="635req">req</dfn>, *<dfn class="local col6 decl" id="636r" title='r' data-type='request_state *' data-ref="636r" data-ref-filename="636r">r</dfn>;</td></tr>
<tr><th id="5837">5837</th><td>        <b>for</b> (<a class="local col5 ref" href="#635req" title='req' data-ref="635req" data-ref-filename="635req">req</a> = <a class="tu ref" href="#all_requests" title='all_requests' data-use='r' data-ref="all_requests" data-ref-filename="all_requests">all_requests</a>; <a class="local col5 ref" href="#635req" title='req' data-ref="635req" data-ref-filename="635req">req</a>; <a class="local col5 ref" href="#635req" title='req' data-ref="635req" data-ref-filename="635req">req</a>=<a class="local col5 ref" href="#635req" title='req' data-ref="635req" data-ref-filename="635req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::next" title='request_state::next' data-ref="request_state::next" data-ref-filename="request_state..next">next</a>)</td></tr>
<tr><th id="5838">5838</th><td>        {</td></tr>
<tr><th id="5839">5839</th><td>            <b>if</b> (<a class="local col5 ref" href="#635req" title='req' data-ref="635req" data-ref-filename="635req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::primary" title='request_state::primary' data-ref="request_state::primary" data-ref-filename="request_state..primary">primary</a>)   <i>// If this is a subbordinate operation, check that the parent is in the list</i></td></tr>
<tr><th id="5840">5840</th><td>            {</td></tr>
<tr><th id="5841">5841</th><td>                <b>for</b> (<a class="local col6 ref" href="#636r" title='r' data-ref="636r" data-ref-filename="636r">r</a> = <a class="tu ref" href="#all_requests" title='all_requests' data-use='r' data-ref="all_requests" data-ref-filename="all_requests">all_requests</a>; <a class="local col6 ref" href="#636r" title='r' data-ref="636r" data-ref-filename="636r">r</a> &amp;&amp; <a class="local col6 ref" href="#636r" title='r' data-ref="636r" data-ref-filename="636r">r</a> != <a class="local col5 ref" href="#635req" title='req' data-ref="635req" data-ref-filename="635req">req</a>; <a class="local col6 ref" href="#636r" title='r' data-ref="636r" data-ref-filename="636r">r</a>=<a class="local col6 ref" href="#636r" title='r' data-ref="636r" data-ref-filename="636r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::next" title='request_state::next' data-ref="request_state::next" data-ref-filename="request_state..next">next</a>) <b>if</b> (<a class="local col6 ref" href="#636r" title='r' data-ref="636r" data-ref-filename="636r">r</a> == <a class="local col5 ref" href="#635req" title='req' data-ref="635req" data-ref-filename="635req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::primary" title='request_state::primary' data-ref="request_state::primary" data-ref-filename="request_state..primary">primary</a>) <b>goto</b> <a class="lbl" href="#637foundparent" data-ref="637foundparent" data-ref-filename="637foundparent">foundparent</a>;</td></tr>
<tr><th id="5842">5842</th><td>                <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"%3d: Orhpan operation %p; parent %p not found in request list"</q>, <a class="local col5 ref" href="#635req" title='req' data-ref="635req" data-ref-filename="635req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>);</td></tr>
<tr><th id="5843">5843</th><td>            }</td></tr>
<tr><th id="5844">5844</th><td>            <i>// For non-subbordinate operations, and subbordinate operations that have lost their parent, write out their info</i></td></tr>
<tr><th id="5845">5845</th><td>            <a class="ref fn" href="#LogClientInfo" title='LogClientInfo' data-ref="LogClientInfo" data-ref-filename="LogClientInfo">LogClientInfo</a>(<a class="local col5 ref" href="#635req" title='req' data-ref="635req" data-ref-filename="635req">req</a>);</td></tr>
<tr><th id="5846">5846</th><td><dfn class="lbl" id="637foundparent" data-ref="637foundparent" data-ref-filename="637foundparent">foundparent</dfn>:;</td></tr>
<tr><th id="5847">5847</th><td>        }</td></tr>
<tr><th id="5848">5848</th><td>    }</td></tr>
<tr><th id="5849">5849</th><td>    </td></tr>
<tr><th id="5850">5850</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"-------- NAT Traversals --------"</q>);</td></tr>
<tr><th id="5851">5851</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"ExtAddress %.4a Retry %d Interval %d"</q>,</td></tr>
<tr><th id="5852">5852</th><td>                  &amp;<a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::ExtAddress" title='mDNS_struct::ExtAddress' data-ref="mDNS_struct::ExtAddress" data-ref-filename="mDNS_struct..ExtAddress">ExtAddress</a>,</td></tr>
<tr><th id="5853">5853</th><td>                  <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::retryGetAddr" title='mDNS_struct::retryGetAddr' data-ref="mDNS_struct::retryGetAddr" data-ref-filename="mDNS_struct..retryGetAddr">retryGetAddr</a> ? (<a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::retryGetAddr" title='mDNS_struct::retryGetAddr' data-ref="mDNS_struct::retryGetAddr" data-ref-filename="mDNS_struct..retryGetAddr">retryGetAddr</a> - <a class="local col3 ref" href="#613now" title='now' data-ref="613now" data-ref-filename="613now">now</a>) / <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformOneSecond" title='mDNSPlatformOneSecond' data-ref="mDNSPlatformOneSecond" data-ref-filename="mDNSPlatformOneSecond">mDNSPlatformOneSecond</a> : <var>0</var>,</td></tr>
<tr><th id="5854">5854</th><td>                  <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::retryIntervalGetAddr" title='mDNS_struct::retryIntervalGetAddr' data-ref="mDNS_struct::retryIntervalGetAddr" data-ref-filename="mDNS_struct..retryIntervalGetAddr">retryIntervalGetAddr</a> / <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformOneSecond" title='mDNSPlatformOneSecond' data-ref="mDNSPlatformOneSecond" data-ref-filename="mDNSPlatformOneSecond">mDNSPlatformOneSecond</a>);</td></tr>
<tr><th id="5855">5855</th><td>    <b>if</b> (<a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::NATTraversals" title='mDNS_struct::NATTraversals' data-ref="mDNS_struct::NATTraversals" data-ref-filename="mDNS_struct..NATTraversals">NATTraversals</a>)</td></tr>
<tr><th id="5856">5856</th><td>    {</td></tr>
<tr><th id="5857">5857</th><td>        <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo" title='NATTraversalInfo' data-type='struct NATTraversalInfo_struct' data-ref="NATTraversalInfo" data-ref-filename="NATTraversalInfo">NATTraversalInfo</a> *<dfn class="local col8 decl" id="638nat" title='nat' data-type='const NATTraversalInfo *' data-ref="638nat" data-ref-filename="638nat">nat</dfn>;</td></tr>
<tr><th id="5858">5858</th><td>        <b>for</b> (<a class="local col8 ref" href="#638nat" title='nat' data-ref="638nat" data-ref-filename="638nat">nat</a> = <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::NATTraversals" title='mDNS_struct::NATTraversals' data-ref="mDNS_struct::NATTraversals" data-ref-filename="mDNS_struct..NATTraversals">NATTraversals</a>; <a class="local col8 ref" href="#638nat" title='nat' data-ref="638nat" data-ref-filename="638nat">nat</a>; <a class="local col8 ref" href="#638nat" title='nat' data-ref="638nat" data-ref-filename="638nat">nat</a>=<a class="local col8 ref" href="#638nat" title='nat' data-ref="638nat" data-ref-filename="638nat">nat</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::next" title='NATTraversalInfo_struct::next' data-ref="NATTraversalInfo_struct::next" data-ref-filename="NATTraversalInfo_struct..next">next</a>)</td></tr>
<tr><th id="5859">5859</th><td>        {</td></tr>
<tr><th id="5860">5860</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"%p %s Int %5d %s Err %d Retry %5d Interval %5d Expire %5d Req %.4a:%d Ext %.4a:%d"</q>,</td></tr>
<tr><th id="5861">5861</th><td>                          <a class="local col8 ref" href="#638nat" title='nat' data-ref="638nat" data-ref-filename="638nat">nat</a>,</td></tr>
<tr><th id="5862">5862</th><td>                          <a class="local col8 ref" href="#638nat" title='nat' data-ref="638nat" data-ref-filename="638nat">nat</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::Protocol" title='NATTraversalInfo_struct::Protocol' data-ref="NATTraversalInfo_struct::Protocol" data-ref-filename="NATTraversalInfo_struct..Protocol">Protocol</a> ? (<a class="local col8 ref" href="#638nat" title='nat' data-ref="638nat" data-ref-filename="638nat">nat</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::Protocol" title='NATTraversalInfo_struct::Protocol' data-ref="NATTraversalInfo_struct::Protocol" data-ref-filename="NATTraversalInfo_struct..Protocol">Protocol</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATOp_MapTCP" title='NATOp_MapTCP' data-ref="NATOp_MapTCP" data-ref-filename="NATOp_MapTCP">NATOp_MapTCP</a> ? <q>"TCP"</q> : <q>"UDP"</q>) : <q>"ADD"</q>,</td></tr>
<tr><th id="5863">5863</th><td>                          <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSVal16" title='mDNSVal16' data-ref="mDNSVal16" data-ref-filename="mDNSVal16">mDNSVal16</a>(<a class="local col8 ref" href="#638nat" title='nat' data-ref="638nat" data-ref-filename="638nat">nat</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::IntPort" title='NATTraversalInfo_struct::IntPort' data-ref="NATTraversalInfo_struct::IntPort" data-ref-filename="NATTraversalInfo_struct..IntPort">IntPort</a>),</td></tr>
<tr><th id="5864">5864</th><td>                          (<a class="local col8 ref" href="#638nat" title='nat' data-ref="638nat" data-ref-filename="638nat">nat</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::lastSuccessfulProtocol" title='NATTraversalInfo_struct::lastSuccessfulProtocol' data-ref="NATTraversalInfo_struct::lastSuccessfulProtocol" data-ref-filename="NATTraversalInfo_struct..lastSuccessfulProtocol">lastSuccessfulProtocol</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTProtocolNone" title='NATTProtocolNone' data-ref="NATTProtocolNone" data-ref-filename="NATTProtocolNone">NATTProtocolNone</a>    ? <q>"None    "</q> :</td></tr>
<tr><th id="5865">5865</th><td>                           <a class="local col8 ref" href="#638nat" title='nat' data-ref="638nat" data-ref-filename="638nat">nat</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::lastSuccessfulProtocol" title='NATTraversalInfo_struct::lastSuccessfulProtocol' data-ref="NATTraversalInfo_struct::lastSuccessfulProtocol" data-ref-filename="NATTraversalInfo_struct..lastSuccessfulProtocol">lastSuccessfulProtocol</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTProtocolNATPMP" title='NATTProtocolNATPMP' data-ref="NATTProtocolNATPMP" data-ref-filename="NATTProtocolNATPMP">NATTProtocolNATPMP</a>  ? <q>"NAT-PMP "</q> :</td></tr>
<tr><th id="5866">5866</th><td>                           <a class="local col8 ref" href="#638nat" title='nat' data-ref="638nat" data-ref-filename="638nat">nat</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::lastSuccessfulProtocol" title='NATTraversalInfo_struct::lastSuccessfulProtocol' data-ref="NATTraversalInfo_struct::lastSuccessfulProtocol" data-ref-filename="NATTraversalInfo_struct..lastSuccessfulProtocol">lastSuccessfulProtocol</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTProtocolUPNPIGD" title='NATTProtocolUPNPIGD' data-ref="NATTProtocolUPNPIGD" data-ref-filename="NATTProtocolUPNPIGD">NATTProtocolUPNPIGD</a> ? <q>"UPnP/IGD"</q> :</td></tr>
<tr><th id="5867">5867</th><td>                           <a class="local col8 ref" href="#638nat" title='nat' data-ref="638nat" data-ref-filename="638nat">nat</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::lastSuccessfulProtocol" title='NATTraversalInfo_struct::lastSuccessfulProtocol' data-ref="NATTraversalInfo_struct::lastSuccessfulProtocol" data-ref-filename="NATTraversalInfo_struct..lastSuccessfulProtocol">lastSuccessfulProtocol</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTProtocolPCP" title='NATTProtocolPCP' data-ref="NATTProtocolPCP" data-ref-filename="NATTProtocolPCP">NATTProtocolPCP</a>     ? <q>"PCP     "</q> :</td></tr>
<tr><th id="5868">5868</th><td>                           <i>/* else */</i>                                           <q>"Unknown "</q> ),</td></tr>
<tr><th id="5869">5869</th><td>                          <a class="local col8 ref" href="#638nat" title='nat' data-ref="638nat" data-ref-filename="638nat">nat</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::Result" title='NATTraversalInfo_struct::Result' data-ref="NATTraversalInfo_struct::Result" data-ref-filename="NATTraversalInfo_struct..Result">Result</a>,</td></tr>
<tr><th id="5870">5870</th><td>                          <a class="local col8 ref" href="#638nat" title='nat' data-ref="638nat" data-ref-filename="638nat">nat</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::retryPortMap" title='NATTraversalInfo_struct::retryPortMap' data-ref="NATTraversalInfo_struct::retryPortMap" data-ref-filename="NATTraversalInfo_struct..retryPortMap">retryPortMap</a> ? (<a class="local col8 ref" href="#638nat" title='nat' data-ref="638nat" data-ref-filename="638nat">nat</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::retryPortMap" title='NATTraversalInfo_struct::retryPortMap' data-ref="NATTraversalInfo_struct::retryPortMap" data-ref-filename="NATTraversalInfo_struct..retryPortMap">retryPortMap</a> - <a class="local col3 ref" href="#613now" title='now' data-ref="613now" data-ref-filename="613now">now</a>) / <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformOneSecond" title='mDNSPlatformOneSecond' data-ref="mDNSPlatformOneSecond" data-ref-filename="mDNSPlatformOneSecond">mDNSPlatformOneSecond</a> : <var>0</var>,</td></tr>
<tr><th id="5871">5871</th><td>                          <a class="local col8 ref" href="#638nat" title='nat' data-ref="638nat" data-ref-filename="638nat">nat</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::retryInterval" title='NATTraversalInfo_struct::retryInterval' data-ref="NATTraversalInfo_struct::retryInterval" data-ref-filename="NATTraversalInfo_struct..retryInterval">retryInterval</a> / <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformOneSecond" title='mDNSPlatformOneSecond' data-ref="mDNSPlatformOneSecond" data-ref-filename="mDNSPlatformOneSecond">mDNSPlatformOneSecond</a>,</td></tr>
<tr><th id="5872">5872</th><td>                          <a class="local col8 ref" href="#638nat" title='nat' data-ref="638nat" data-ref-filename="638nat">nat</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::ExpiryTime" title='NATTraversalInfo_struct::ExpiryTime' data-ref="NATTraversalInfo_struct::ExpiryTime" data-ref-filename="NATTraversalInfo_struct..ExpiryTime">ExpiryTime</a> ? (<a class="local col8 ref" href="#638nat" title='nat' data-ref="638nat" data-ref-filename="638nat">nat</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::ExpiryTime" title='NATTraversalInfo_struct::ExpiryTime' data-ref="NATTraversalInfo_struct::ExpiryTime" data-ref-filename="NATTraversalInfo_struct..ExpiryTime">ExpiryTime</a> - <a class="local col3 ref" href="#613now" title='now' data-ref="613now" data-ref-filename="613now">now</a>) / <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformOneSecond" title='mDNSPlatformOneSecond' data-ref="mDNSPlatformOneSecond" data-ref-filename="mDNSPlatformOneSecond">mDNSPlatformOneSecond</a> : <var>0</var>,</td></tr>
<tr><th id="5873">5873</th><td>                          &amp;<a class="local col8 ref" href="#638nat" title='nat' data-ref="638nat" data-ref-filename="638nat">nat</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::NewAddress" title='NATTraversalInfo_struct::NewAddress' data-ref="NATTraversalInfo_struct::NewAddress" data-ref-filename="NATTraversalInfo_struct..NewAddress">NewAddress</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSVal16" title='mDNSVal16' data-ref="mDNSVal16" data-ref-filename="mDNSVal16">mDNSVal16</a>(<a class="local col8 ref" href="#638nat" title='nat' data-ref="638nat" data-ref-filename="638nat">nat</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::RequestedPort" title='NATTraversalInfo_struct::RequestedPort' data-ref="NATTraversalInfo_struct::RequestedPort" data-ref-filename="NATTraversalInfo_struct..RequestedPort">RequestedPort</a>),</td></tr>
<tr><th id="5874">5874</th><td>                          &amp;<a class="local col8 ref" href="#638nat" title='nat' data-ref="638nat" data-ref-filename="638nat">nat</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::ExternalAddress" title='NATTraversalInfo_struct::ExternalAddress' data-ref="NATTraversalInfo_struct::ExternalAddress" data-ref-filename="NATTraversalInfo_struct..ExternalAddress">ExternalAddress</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSVal16" title='mDNSVal16' data-ref="mDNSVal16" data-ref-filename="mDNSVal16">mDNSVal16</a>(<a class="local col8 ref" href="#638nat" title='nat' data-ref="638nat" data-ref-filename="638nat">nat</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NATTraversalInfo_struct::ExternalPort" title='NATTraversalInfo_struct::ExternalPort' data-ref="NATTraversalInfo_struct::ExternalPort" data-ref-filename="NATTraversalInfo_struct..ExternalPort">ExternalPort</a>));</td></tr>
<tr><th id="5875">5875</th><td>        }</td></tr>
<tr><th id="5876">5876</th><td>    }</td></tr>
<tr><th id="5877">5877</th><td></td></tr>
<tr><th id="5878">5878</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"--------- AuthInfoList ---------"</q>);</td></tr>
<tr><th id="5879">5879</th><td>    <b>if</b> (!<a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::AuthInfoList" title='mDNS_struct::AuthInfoList' data-ref="mDNS_struct::AuthInfoList" data-ref-filename="mDNS_struct..AuthInfoList">AuthInfoList</a>) <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"&lt;None&gt;"</q>);</td></tr>
<tr><th id="5880">5880</th><td>    <b>else</b></td></tr>
<tr><th id="5881">5881</th><td>    {</td></tr>
<tr><th id="5882">5882</th><td>        <em>const</em> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DomainAuthInfo" title='DomainAuthInfo' data-type='struct DomainAuthInfo' data-ref="DomainAuthInfo" data-ref-filename="DomainAuthInfo">DomainAuthInfo</a> *<dfn class="local col9 decl" id="639a" title='a' data-type='const DomainAuthInfo *' data-ref="639a" data-ref-filename="639a">a</dfn>;</td></tr>
<tr><th id="5883">5883</th><td>        <b>for</b> (<a class="local col9 ref" href="#639a" title='a' data-ref="639a" data-ref-filename="639a">a</a> = <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::AuthInfoList" title='mDNS_struct::AuthInfoList' data-ref="mDNS_struct::AuthInfoList" data-ref-filename="mDNS_struct..AuthInfoList">AuthInfoList</a>; <a class="local col9 ref" href="#639a" title='a' data-ref="639a" data-ref-filename="639a">a</a>; <a class="local col9 ref" href="#639a" title='a' data-ref="639a" data-ref-filename="639a">a</a> = <a class="local col9 ref" href="#639a" title='a' data-ref="639a" data-ref-filename="639a">a</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DomainAuthInfo::next" title='DomainAuthInfo::next' data-ref="DomainAuthInfo::next" data-ref-filename="DomainAuthInfo..next">next</a>)</td></tr>
<tr><th id="5884">5884</th><td>        {</td></tr>
<tr><th id="5885">5885</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"%##s %##s %##s %d %d %.16a%s"</q>,</td></tr>
<tr><th id="5886">5886</th><td>                          <a class="local col9 ref" href="#639a" title='a' data-ref="639a" data-ref-filename="639a">a</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DomainAuthInfo::domain" title='DomainAuthInfo::domain' data-ref="DomainAuthInfo::domain" data-ref-filename="DomainAuthInfo..domain">domain</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="local col9 ref" href="#639a" title='a' data-ref="639a" data-ref-filename="639a">a</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DomainAuthInfo::keyname" title='DomainAuthInfo::keyname' data-ref="DomainAuthInfo::keyname" data-ref-filename="DomainAuthInfo..keyname">keyname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>,</td></tr>
<tr><th id="5887">5887</th><td>                          <a class="local col9 ref" href="#639a" title='a' data-ref="639a" data-ref-filename="639a">a</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DomainAuthInfo::hostname" title='DomainAuthInfo::hostname' data-ref="DomainAuthInfo::hostname" data-ref-filename="DomainAuthInfo..hostname">hostname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, (<a class="local col9 ref" href="#639a" title='a' data-ref="639a" data-ref-filename="639a">a</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DomainAuthInfo::port" title='DomainAuthInfo::port' data-ref="DomainAuthInfo::port" data-ref-filename="DomainAuthInfo..port">port</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::b" title='(anonymous union)::b' data-ref="(anonymous)::b" data-ref-filename="(anonymous)..b">b</a>[<var>0</var>] &lt;&lt; <var>8</var> | <a class="local col9 ref" href="#639a" title='a' data-ref="639a" data-ref-filename="639a">a</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DomainAuthInfo::port" title='DomainAuthInfo::port' data-ref="DomainAuthInfo::port" data-ref-filename="DomainAuthInfo..port">port</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::b" title='(anonymous union)::b' data-ref="(anonymous)::b" data-ref-filename="(anonymous)..b">b</a>[<var>1</var>]),</td></tr>
<tr><th id="5888">5888</th><td>                          (<a class="local col9 ref" href="#639a" title='a' data-ref="639a" data-ref-filename="639a">a</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DomainAuthInfo::deltime" title='DomainAuthInfo::deltime' data-ref="DomainAuthInfo::deltime" data-ref-filename="DomainAuthInfo..deltime">deltime</a> ? (<a class="local col9 ref" href="#639a" title='a' data-ref="639a" data-ref-filename="639a">a</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DomainAuthInfo::deltime" title='DomainAuthInfo::deltime' data-ref="DomainAuthInfo::deltime" data-ref-filename="DomainAuthInfo..deltime">deltime</a> - <a class="local col3 ref" href="#613now" title='now' data-ref="613now" data-ref-filename="613now">now</a>) : <var>0</var>),</td></tr>
<tr><th id="5889">5889</th><td>                          &amp;<a class="local col9 ref" href="#639a" title='a' data-ref="639a" data-ref-filename="639a">a</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DomainAuthInfo::AutoTunnelInnerAddress" title='DomainAuthInfo::AutoTunnelInnerAddress' data-ref="DomainAuthInfo::AutoTunnelInnerAddress" data-ref-filename="DomainAuthInfo..AutoTunnelInnerAddress">AutoTunnelInnerAddress</a>, <a class="local col9 ref" href="#639a" title='a' data-ref="639a" data-ref-filename="639a">a</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DomainAuthInfo::AutoTunnel" title='DomainAuthInfo::AutoTunnel' data-ref="DomainAuthInfo::AutoTunnel" data-ref-filename="DomainAuthInfo..AutoTunnel">AutoTunnel</a> ? <q>" AutoTunnel"</q> : <q>""</q>);</td></tr>
<tr><th id="5890">5890</th><td>        }</td></tr>
<tr><th id="5891">5891</th><td>    }</td></tr>
<tr><th id="5892">5892</th><td></td></tr>
<tr><th id="5893">5893</th><td>    <u>#<span data-ppcond="5893">if</span> APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="5894">5894</th><td>    LogMsgNoIdent(<q>"--------- TunnelClients --------"</q>);</td></tr>
<tr><th id="5895">5895</th><td>    <b>if</b> (!m-&gt;TunnelClients) LogMsgNoIdent(<q>"&lt;None&gt;"</q>);</td></tr>
<tr><th id="5896">5896</th><td>    <b>else</b></td></tr>
<tr><th id="5897">5897</th><td>    {</td></tr>
<tr><th id="5898">5898</th><td>        <em>const</em> ClientTunnel *c;</td></tr>
<tr><th id="5899">5899</th><td>        <b>for</b> (c = m-&gt;TunnelClients; c; c = c-&gt;next)</td></tr>
<tr><th id="5900">5900</th><td>            LogMsgNoIdent(<q>"%##s local %.16a %.4a %.16a remote %.16a %.4a %5d %.16a interval %d"</q>,</td></tr>
<tr><th id="5901">5901</th><td>                          c-&gt;dstname.c, &amp;c-&gt;loc_inner, &amp;c-&gt;loc_outer, &amp;c-&gt;loc_outer6, &amp;c-&gt;rmt_inner, &amp;c-&gt;rmt_outer, mDNSVal16(c-&gt;rmt_outer_port), &amp;c-&gt;rmt_outer6, c-&gt;q.ThisQInterval);</td></tr>
<tr><th id="5902">5902</th><td>    }</td></tr>
<tr><th id="5903">5903</th><td>    <u>#<span data-ppcond="5893">endif</span> // APPLE_OSX_mDNSResponder</u></td></tr>
<tr><th id="5904">5904</th><td></td></tr>
<tr><th id="5905">5905</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"---------- Misc State ----------"</q>);</td></tr>
<tr><th id="5906">5906</th><td></td></tr>
<tr><th id="5907">5907</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"PrimaryMAC:   %.6a"</q>, &amp;<a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::PrimaryMAC" title='mDNS_struct::PrimaryMAC' data-ref="mDNS_struct::PrimaryMAC" data-ref-filename="mDNS_struct..PrimaryMAC">PrimaryMAC</a>);</td></tr>
<tr><th id="5908">5908</th><td></td></tr>
<tr><th id="5909">5909</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"m-&gt;SleepState %d (%s) seq %d"</q>,</td></tr>
<tr><th id="5910">5910</th><td>                  <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::SleepState" title='mDNS_struct::SleepState' data-ref="mDNS_struct::SleepState" data-ref-filename="mDNS_struct..SleepState">SleepState</a>,</td></tr>
<tr><th id="5911">5911</th><td>                  <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::SleepState" title='mDNS_struct::SleepState' data-ref="mDNS_struct::SleepState" data-ref-filename="mDNS_struct..SleepState">SleepState</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#SleepState_Awake" title='SleepState_Awake' data-ref="SleepState_Awake" data-ref-filename="SleepState_Awake">SleepState_Awake</a>        ? <q>"Awake"</q>        :</td></tr>
<tr><th id="5912">5912</th><td>                  <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::SleepState" title='mDNS_struct::SleepState' data-ref="mDNS_struct::SleepState" data-ref-filename="mDNS_struct..SleepState">SleepState</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#SleepState_Transferring" title='SleepState_Transferring' data-ref="SleepState_Transferring" data-ref-filename="SleepState_Transferring">SleepState_Transferring</a> ? <q>"Transferring"</q> :</td></tr>
<tr><th id="5913">5913</th><td>                  <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::SleepState" title='mDNS_struct::SleepState' data-ref="mDNS_struct::SleepState" data-ref-filename="mDNS_struct..SleepState">SleepState</a> == <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#SleepState_Sleeping" title='SleepState_Sleeping' data-ref="SleepState_Sleeping" data-ref-filename="SleepState_Sleeping">SleepState_Sleeping</a>     ? <q>"Sleeping"</q>     : <q>"?"</q>,</td></tr>
<tr><th id="5914">5914</th><td>                  <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::SleepSeqNum" title='mDNS_struct::SleepSeqNum' data-ref="mDNS_struct::SleepSeqNum" data-ref-filename="mDNS_struct..SleepSeqNum">SleepSeqNum</a>);</td></tr>
<tr><th id="5915">5915</th><td></td></tr>
<tr><th id="5916">5916</th><td>    <b>if</b> (!<a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::SPSSocket" title='mDNS_struct::SPSSocket' data-ref="mDNS_struct::SPSSocket" data-ref-filename="mDNS_struct..SPSSocket">SPSSocket</a>) <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"Not offering Sleep Proxy Service"</q>);</td></tr>
<tr><th id="5917">5917</th><td><u>#<span data-ppcond="5917">ifndef</span> <span class="macro" data-ref="_M/SPC_DISABLED">SPC_DISABLED</span></u></td></tr>
<tr><th id="5918">5918</th><td>    <b>else</b> <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"Offering Sleep Proxy Service: %#s"</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::SPSRecords" title='mDNS_struct::SPSRecords' data-ref="mDNS_struct::SPSRecords" data-ref-filename="mDNS_struct..SPSRecords">SPSRecords</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ServiceRecordSet_struct::RR_SRV" title='ServiceRecordSet_struct::RR_SRV' data-ref="ServiceRecordSet_struct::RR_SRV" data-ref-filename="ServiceRecordSet_struct..RR_SRV">RR_SRV</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::name" title='ResourceRecord_struct::name' data-ref="ResourceRecord_struct::name" data-ref-filename="ResourceRecord_struct..name">name</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>);</td></tr>
<tr><th id="5919">5919</th><td><u>#<span data-ppcond="5917">endif</span></u></td></tr>
<tr><th id="5920">5920</th><td>    <b>if</b> (<a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::ProxyRecords" title='mDNS_struct::ProxyRecords' data-ref="mDNS_struct::ProxyRecords" data-ref-filename="mDNS_struct..ProxyRecords">ProxyRecords</a> == <a class="local col7 ref" href="#617ProxyA" title='ProxyA' data-ref="617ProxyA" data-ref-filename="617ProxyA">ProxyA</a> + <a class="local col8 ref" href="#618ProxyD" title='ProxyD' data-ref="618ProxyD" data-ref-filename="618ProxyD">ProxyD</a>) <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"ProxyRecords: %d + %d = %d"</q>, <a class="local col7 ref" href="#617ProxyA" title='ProxyA' data-ref="617ProxyA" data-ref-filename="617ProxyA">ProxyA</a>, <a class="local col8 ref" href="#618ProxyD" title='ProxyD' data-ref="618ProxyD" data-ref-filename="618ProxyD">ProxyD</a>, <a class="local col7 ref" href="#617ProxyA" title='ProxyA' data-ref="617ProxyA" data-ref-filename="617ProxyA">ProxyA</a> + <a class="local col8 ref" href="#618ProxyD" title='ProxyD' data-ref="618ProxyD" data-ref-filename="618ProxyD">ProxyD</a>);</td></tr>
<tr><th id="5921">5921</th><td>    <b>else</b> <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"ProxyRecords: MISMATCH %d + %d = %d ≠ %d"</q>, <a class="local col7 ref" href="#617ProxyA" title='ProxyA' data-ref="617ProxyA" data-ref-filename="617ProxyA">ProxyA</a>, <a class="local col8 ref" href="#618ProxyD" title='ProxyD' data-ref="618ProxyD" data-ref-filename="618ProxyD">ProxyD</a>, <a class="local col7 ref" href="#617ProxyA" title='ProxyA' data-ref="617ProxyA" data-ref-filename="617ProxyA">ProxyA</a> + <a class="local col8 ref" href="#618ProxyD" title='ProxyD' data-ref="618ProxyD" data-ref-filename="618ProxyD">ProxyD</a>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::ProxyRecords" title='mDNS_struct::ProxyRecords' data-ref="mDNS_struct::ProxyRecords" data-ref-filename="mDNS_struct..ProxyRecords">ProxyRecords</a>);</td></tr>
<tr><th id="5922">5922</th><td></td></tr>
<tr><th id="5923">5923</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"------ Auto Browse Domains -----"</q>);</td></tr>
<tr><th id="5924">5924</th><td>    <b>if</b> (!<a class="ref" href="uds_daemon.h.html#AutoBrowseDomains" title='AutoBrowseDomains' data-ref="AutoBrowseDomains" data-ref-filename="AutoBrowseDomains">AutoBrowseDomains</a>) <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"&lt;None&gt;"</q>);</td></tr>
<tr><th id="5925">5925</th><td>    <b>else</b> <b>for</b> (<a class="local col5 ref" href="#625d" title='d' data-ref="625d" data-ref-filename="625d">d</a>=<a class="ref" href="uds_daemon.h.html#AutoBrowseDomains" title='AutoBrowseDomains' data-ref="AutoBrowseDomains" data-ref-filename="AutoBrowseDomains">AutoBrowseDomains</a>; <a class="local col5 ref" href="#625d" title='d' data-ref="625d" data-ref-filename="625d">d</a>; <a class="local col5 ref" href="#625d" title='d' data-ref="625d" data-ref-filename="625d">d</a>=<a class="local col5 ref" href="#625d" title='d' data-ref="625d" data-ref-filename="625d">d</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::next" title='DNameListElem::next' data-ref="DNameListElem::next" data-ref-filename="DNameListElem..next">next</a>) <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"%##s"</q>, <a class="local col5 ref" href="#625d" title='d' data-ref="625d" data-ref-filename="625d">d</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::name" title='DNameListElem::name' data-ref="DNameListElem::name" data-ref-filename="DNameListElem..name">name</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>);</td></tr>
<tr><th id="5926">5926</th><td></td></tr>
<tr><th id="5927">5927</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"--- Auto Registration Domains --"</q>);</td></tr>
<tr><th id="5928">5928</th><td>    <b>if</b> (!<a class="ref" href="uds_daemon.h.html#AutoRegistrationDomains" title='AutoRegistrationDomains' data-ref="AutoRegistrationDomains" data-ref-filename="AutoRegistrationDomains">AutoRegistrationDomains</a>) <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"&lt;None&gt;"</q>);</td></tr>
<tr><th id="5929">5929</th><td>    <b>else</b> <b>for</b> (<a class="local col5 ref" href="#625d" title='d' data-ref="625d" data-ref-filename="625d">d</a>=<a class="ref" href="uds_daemon.h.html#AutoRegistrationDomains" title='AutoRegistrationDomains' data-ref="AutoRegistrationDomains" data-ref-filename="AutoRegistrationDomains">AutoRegistrationDomains</a>; <a class="local col5 ref" href="#625d" title='d' data-ref="625d" data-ref-filename="625d">d</a>; <a class="local col5 ref" href="#625d" title='d' data-ref="625d" data-ref-filename="625d">d</a>=<a class="local col5 ref" href="#625d" title='d' data-ref="625d" data-ref-filename="625d">d</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::next" title='DNameListElem::next' data-ref="DNameListElem::next" data-ref-filename="DNameListElem..next">next</a>) <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"%##s"</q>, <a class="local col5 ref" href="#625d" title='d' data-ref="625d" data-ref-filename="625d">d</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNameListElem::name" title='DNameListElem::name' data-ref="DNameListElem::name" data-ref-filename="DNameListElem..name">name</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>);</td></tr>
<tr><th id="5930">5930</th><td></td></tr>
<tr><th id="5931">5931</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"--- Search Domains --"</q>);</td></tr>
<tr><th id="5932">5932</th><td>    <b>if</b> (!<a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#SearchList" title='SearchList' data-ref="SearchList" data-ref-filename="SearchList">SearchList</a>) <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"&lt;None&gt;"</q>);</td></tr>
<tr><th id="5933">5933</th><td>    <b>else</b></td></tr>
<tr><th id="5934">5934</th><td>    {</td></tr>
<tr><th id="5935">5935</th><td>        <b>for</b> (<a class="local col6 ref" href="#626s" title='s' data-ref="626s" data-ref-filename="626s">s</a>=<a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#SearchList" title='SearchList' data-ref="SearchList" data-ref-filename="SearchList">SearchList</a>; <a class="local col6 ref" href="#626s" title='s' data-ref="626s" data-ref-filename="626s">s</a>; <a class="local col6 ref" href="#626s" title='s' data-ref="626s" data-ref-filename="626s">s</a>=<a class="local col6 ref" href="#626s" title='s' data-ref="626s" data-ref-filename="626s">s</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#SearchListElem::next" title='SearchListElem::next' data-ref="SearchListElem::next" data-ref-filename="SearchListElem..next">next</a>)</td></tr>
<tr><th id="5936">5936</th><td>        {</td></tr>
<tr><th id="5937">5937</th><td>            <em>char</em> *<dfn class="local col0 decl" id="640ifname" title='ifname' data-type='char *' data-ref="640ifname" data-ref-filename="640ifname">ifname</dfn> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#InterfaceNameForID" title='InterfaceNameForID' data-ref="InterfaceNameForID" data-ref-filename="InterfaceNameForID">InterfaceNameForID</a>(<a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>, <a class="local col6 ref" href="#626s" title='s' data-ref="626s" data-ref-filename="626s">s</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#SearchListElem::InterfaceID" title='SearchListElem::InterfaceID' data-ref="SearchListElem::InterfaceID" data-ref-filename="SearchListElem..InterfaceID">InterfaceID</a>);</td></tr>
<tr><th id="5938">5938</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"%##s %s"</q>, <a class="local col6 ref" href="#626s" title='s' data-ref="626s" data-ref-filename="626s">s</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#SearchListElem::domain" title='SearchListElem::domain' data-ref="SearchListElem::domain" data-ref-filename="SearchListElem..domain">domain</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="local col0 ref" href="#640ifname" title='ifname' data-ref="640ifname" data-ref-filename="640ifname">ifname</a> ? <a class="local col0 ref" href="#640ifname" title='ifname' data-ref="640ifname" data-ref-filename="640ifname">ifname</a> : <q>""</q>);</td></tr>
<tr><th id="5939">5939</th><td>        }</td></tr>
<tr><th id="5940">5940</th><td>    }</td></tr>
<tr><th id="5941">5941</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;--- Trust Anchors ---&quot;);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"--- Trust Anchors ---"</q>);</td></tr>
<tr><th id="5942">5942</th><td>    <b>if</b> (!<a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::TrustAnchors" title='mDNS_struct::TrustAnchors' data-ref="mDNS_struct::TrustAnchors" data-ref-filename="mDNS_struct..TrustAnchors">TrustAnchors</a>)</td></tr>
<tr><th id="5943">5943</th><td>    {</td></tr>
<tr><th id="5944">5944</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;&lt;None&gt;&quot;);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"&lt;None&gt;"</q>);</td></tr>
<tr><th id="5945">5945</th><td>    }</td></tr>
<tr><th id="5946">5946</th><td>    <b>else</b></td></tr>
<tr><th id="5947">5947</th><td>    {</td></tr>
<tr><th id="5948">5948</th><td>        <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#TrustAnchor" title='TrustAnchor' data-type='struct TrustAnchor' data-ref="TrustAnchor" data-ref-filename="TrustAnchor">TrustAnchor</a> *<dfn class="local col1 decl" id="641ta" title='ta' data-type='TrustAnchor *' data-ref="641ta" data-ref-filename="641ta">ta</dfn>;</td></tr>
<tr><th id="5949">5949</th><td>        <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu8" title='mDNSu8' data-type='unsigned char' data-ref="mDNSu8" data-ref-filename="mDNSu8">mDNSu8</a> <dfn class="local col2 decl" id="642fromTimeBuf" title='fromTimeBuf' data-type='mDNSu8 [64]' data-ref="642fromTimeBuf" data-ref-filename="642fromTimeBuf">fromTimeBuf</dfn>[<var>64</var>];</td></tr>
<tr><th id="5950">5950</th><td>        <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSu8" title='mDNSu8' data-type='unsigned char' data-ref="mDNSu8" data-ref-filename="mDNSu8">mDNSu8</a> <dfn class="local col3 decl" id="643untilTimeBuf" title='untilTimeBuf' data-type='mDNSu8 [64]' data-ref="643untilTimeBuf" data-ref-filename="643untilTimeBuf">untilTimeBuf</dfn>[<var>64</var>];</td></tr>
<tr><th id="5951">5951</th><td></td></tr>
<tr><th id="5952">5952</th><td>        <b>for</b> (<a class="local col1 ref" href="#641ta" title='ta' data-ref="641ta" data-ref-filename="641ta">ta</a>=<a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::TrustAnchors" title='mDNS_struct::TrustAnchors' data-ref="mDNS_struct::TrustAnchors" data-ref-filename="mDNS_struct..TrustAnchors">TrustAnchors</a>; <a class="local col1 ref" href="#641ta" title='ta' data-ref="641ta" data-ref-filename="641ta">ta</a>; <a class="local col1 ref" href="#641ta" title='ta' data-ref="641ta" data-ref-filename="641ta">ta</a>=<a class="local col1 ref" href="#641ta" title='ta' data-ref="641ta" data-ref-filename="641ta">ta</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#TrustAnchor::next" title='TrustAnchor::next' data-ref="TrustAnchor::next" data-ref-filename="TrustAnchor..next">next</a>)</td></tr>
<tr><th id="5953">5953</th><td>        {</td></tr>
<tr><th id="5954">5954</th><td>            <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformFormatTime" title='mDNSPlatformFormatTime' data-ref="mDNSPlatformFormatTime" data-ref-filename="mDNSPlatformFormatTime">mDNSPlatformFormatTime</a>((<em>unsigned</em> <em>long</em>)<a class="local col1 ref" href="#641ta" title='ta' data-ref="641ta" data-ref-filename="641ta">ta</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#TrustAnchor::validFrom" title='TrustAnchor::validFrom' data-ref="TrustAnchor::validFrom" data-ref-filename="TrustAnchor..validFrom">validFrom</a>, <a class="local col2 ref" href="#642fromTimeBuf" title='fromTimeBuf' data-ref="642fromTimeBuf" data-ref-filename="642fromTimeBuf">fromTimeBuf</a>, <b>sizeof</b>(<a class="local col2 ref" href="#642fromTimeBuf" title='fromTimeBuf' data-ref="642fromTimeBuf" data-ref-filename="642fromTimeBuf">fromTimeBuf</a>));</td></tr>
<tr><th id="5955">5955</th><td>            <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformFormatTime" title='mDNSPlatformFormatTime' data-ref="mDNSPlatformFormatTime" data-ref-filename="mDNSPlatformFormatTime">mDNSPlatformFormatTime</a>((<em>unsigned</em> <em>long</em>)<a class="local col1 ref" href="#641ta" title='ta' data-ref="641ta" data-ref-filename="641ta">ta</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#TrustAnchor::validUntil" title='TrustAnchor::validUntil' data-ref="TrustAnchor::validUntil" data-ref-filename="TrustAnchor..validUntil">validUntil</a>, <a class="local col3 ref" href="#643untilTimeBuf" title='untilTimeBuf' data-ref="643untilTimeBuf" data-ref-filename="643untilTimeBuf">untilTimeBuf</a>, <b>sizeof</b>(<a class="local col3 ref" href="#643untilTimeBuf" title='untilTimeBuf' data-ref="643untilTimeBuf" data-ref-filename="643untilTimeBuf">untilTimeBuf</a>));</td></tr>
<tr><th id="5956">5956</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;%##s %d %d %d %d %s %s&quot;, ta-&gt;zone.c, ta-&gt;rds.keyTag, ta-&gt;rds.alg, ta-&gt;rds.digestType, ta-&gt;digestLen, fromTimeBuf, untilTimeBuf);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"%##s %d %d %d %d %s %s"</q>, <a class="local col1 ref" href="#641ta" title='ta' data-ref="641ta" data-ref-filename="641ta">ta</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#TrustAnchor::zone" title='TrustAnchor::zone' data-ref="TrustAnchor::zone" data-ref-filename="TrustAnchor..zone">zone</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="local col1 ref" href="#641ta" title='ta' data-ref="641ta" data-ref-filename="641ta">ta</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#TrustAnchor::rds" title='TrustAnchor::rds' data-ref="TrustAnchor::rds" data-ref-filename="TrustAnchor..rds">rds</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::keyTag" title='(anonymous struct)::keyTag' data-ref="(anonymous)::keyTag" data-ref-filename="(anonymous)..keyTag">keyTag</a>,</td></tr>
<tr><th id="5957">5957</th><td>                <a class="local col1 ref" href="#641ta" title='ta' data-ref="641ta" data-ref-filename="641ta">ta</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#TrustAnchor::rds" title='TrustAnchor::rds' data-ref="TrustAnchor::rds" data-ref-filename="TrustAnchor..rds">rds</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::alg" title='(anonymous struct)::alg' data-ref="(anonymous)::alg" data-ref-filename="(anonymous)..alg">alg</a>, <a class="local col1 ref" href="#641ta" title='ta' data-ref="641ta" data-ref-filename="641ta">ta</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#TrustAnchor::rds" title='TrustAnchor::rds' data-ref="TrustAnchor::rds" data-ref-filename="TrustAnchor..rds">rds</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::digestType" title='(anonymous struct)::digestType' data-ref="(anonymous)::digestType" data-ref-filename="(anonymous)..digestType">digestType</a>, <a class="local col1 ref" href="#641ta" title='ta' data-ref="641ta" data-ref-filename="641ta">ta</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#TrustAnchor::digestLen" title='TrustAnchor::digestLen' data-ref="TrustAnchor::digestLen" data-ref-filename="TrustAnchor..digestLen">digestLen</a>, <a class="local col2 ref" href="#642fromTimeBuf" title='fromTimeBuf' data-ref="642fromTimeBuf" data-ref-filename="642fromTimeBuf">fromTimeBuf</a>, <a class="local col3 ref" href="#643untilTimeBuf" title='untilTimeBuf' data-ref="643untilTimeBuf" data-ref-filename="643untilTimeBuf">untilTimeBuf</a>);</td></tr>
<tr><th id="5958">5958</th><td>        }</td></tr>
<tr><th id="5959">5959</th><td>    }</td></tr>
<tr><th id="5960">5960</th><td></td></tr>
<tr><th id="5961">5961</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;--- DNSSEC Statistics ---&quot;);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"--- DNSSEC Statistics ---"</q>);</td></tr>
<tr><th id="5962">5962</th><td></td></tr>
<tr><th id="5963">5963</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"Unicast Cache size              %u"</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::rrcache_totalused_unicast" title='mDNS_struct::rrcache_totalused_unicast' data-ref="mDNS_struct::rrcache_totalused_unicast" data-ref-filename="mDNS_struct..rrcache_totalused_unicast">rrcache_totalused_unicast</a>);</td></tr>
<tr><th id="5964">5964</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;DNSSEC  Cache size              %u&quot;, m-&gt;DNSSECStats.TotalMemUsed);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"DNSSEC  Cache size              %u"</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::DNSSECStats" title='mDNS_struct::DNSSECStats' data-ref="mDNS_struct::DNSSECStats" data-ref-filename="mDNS_struct..DNSSECStats">DNSSECStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::TotalMemUsed" title='(anonymous struct)::TotalMemUsed' data-ref="(anonymous)::TotalMemUsed" data-ref-filename="(anonymous)..TotalMemUsed">TotalMemUsed</a>);</td></tr>
<tr><th id="5965">5965</th><td>    <b>if</b> (<a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::rrcache_totalused_unicast" title='mDNS_struct::rrcache_totalused_unicast' data-ref="mDNS_struct::rrcache_totalused_unicast" data-ref-filename="mDNS_struct..rrcache_totalused_unicast">rrcache_totalused_unicast</a>)</td></tr>
<tr><th id="5966">5966</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;DNSSEC  usage percentage        %u&quot;, ((unsigned long)(m-&gt;DNSSECStats.TotalMemUsed * 100))/m-&gt;rrcache_totalused_unicast);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"DNSSEC  usage percentage        %u"</q>, ((<em>unsigned</em> <em>long</em>)(<a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::DNSSECStats" title='mDNS_struct::DNSSECStats' data-ref="mDNS_struct::DNSSECStats" data-ref-filename="mDNS_struct..DNSSECStats">DNSSECStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::TotalMemUsed" title='(anonymous struct)::TotalMemUsed' data-ref="(anonymous)::TotalMemUsed" data-ref-filename="(anonymous)..TotalMemUsed">TotalMemUsed</a> * <var>100</var>))/<a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::rrcache_totalused_unicast" title='mDNS_struct::rrcache_totalused_unicast' data-ref="mDNS_struct::rrcache_totalused_unicast" data-ref-filename="mDNS_struct..rrcache_totalused_unicast">rrcache_totalused_unicast</a>);</td></tr>
<tr><th id="5967">5967</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;DNSSEC  Extra Packets (0 to 2)  %u&quot;, m-&gt;DNSSECStats.ExtraPackets0);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"DNSSEC  Extra Packets (0 to 2)  %u"</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::DNSSECStats" title='mDNS_struct::DNSSECStats' data-ref="mDNS_struct::DNSSECStats" data-ref-filename="mDNS_struct..DNSSECStats">DNSSECStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::ExtraPackets0" title='(anonymous struct)::ExtraPackets0' data-ref="(anonymous)::ExtraPackets0" data-ref-filename="(anonymous)..ExtraPackets0">ExtraPackets0</a>);</td></tr>
<tr><th id="5968">5968</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;DNSSEC  Extra Packets (3 to 6)  %u&quot;, m-&gt;DNSSECStats.ExtraPackets3);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"DNSSEC  Extra Packets (3 to 6)  %u"</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::DNSSECStats" title='mDNS_struct::DNSSECStats' data-ref="mDNS_struct::DNSSECStats" data-ref-filename="mDNS_struct..DNSSECStats">DNSSECStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::ExtraPackets3" title='(anonymous struct)::ExtraPackets3' data-ref="(anonymous)::ExtraPackets3" data-ref-filename="(anonymous)..ExtraPackets3">ExtraPackets3</a>);</td></tr>
<tr><th id="5969">5969</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;DNSSEC  Extra Packets (7 to 9)  %u&quot;, m-&gt;DNSSECStats.ExtraPackets7);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"DNSSEC  Extra Packets (7 to 9)  %u"</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::DNSSECStats" title='mDNS_struct::DNSSECStats' data-ref="mDNS_struct::DNSSECStats" data-ref-filename="mDNS_struct..DNSSECStats">DNSSECStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::ExtraPackets7" title='(anonymous struct)::ExtraPackets7' data-ref="(anonymous)::ExtraPackets7" data-ref-filename="(anonymous)..ExtraPackets7">ExtraPackets7</a>);</td></tr>
<tr><th id="5970">5970</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;DNSSEC  Extra Packets ( &gt;= 10)  %u&quot;, m-&gt;DNSSECStats.ExtraPackets10);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"DNSSEC  Extra Packets ( &gt;= 10)  %u"</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::DNSSECStats" title='mDNS_struct::DNSSECStats' data-ref="mDNS_struct::DNSSECStats" data-ref-filename="mDNS_struct..DNSSECStats">DNSSECStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::ExtraPackets10" title='(anonymous struct)::ExtraPackets10' data-ref="(anonymous)::ExtraPackets10" data-ref-filename="(anonymous)..ExtraPackets10">ExtraPackets10</a>);</td></tr>
<tr><th id="5971">5971</th><td></td></tr>
<tr><th id="5972">5972</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;DNSSEC  Latency (0 to 4ms)      %u&quot;, m-&gt;DNSSECStats.Latency0);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"DNSSEC  Latency (0 to 4ms)      %u"</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::DNSSECStats" title='mDNS_struct::DNSSECStats' data-ref="mDNS_struct::DNSSECStats" data-ref-filename="mDNS_struct..DNSSECStats">DNSSECStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::Latency0" title='(anonymous struct)::Latency0' data-ref="(anonymous)::Latency0" data-ref-filename="(anonymous)..Latency0">Latency0</a>);</td></tr>
<tr><th id="5973">5973</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;DNSSEC  Latency (4 to 9ms)      %u&quot;, m-&gt;DNSSECStats.Latency5);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"DNSSEC  Latency (4 to 9ms)      %u"</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::DNSSECStats" title='mDNS_struct::DNSSECStats' data-ref="mDNS_struct::DNSSECStats" data-ref-filename="mDNS_struct..DNSSECStats">DNSSECStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::Latency5" title='(anonymous struct)::Latency5' data-ref="(anonymous)::Latency5" data-ref-filename="(anonymous)..Latency5">Latency5</a>);</td></tr>
<tr><th id="5974">5974</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;DNSSEC  Latency (10 to 19ms)    %u&quot;, m-&gt;DNSSECStats.Latency10);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"DNSSEC  Latency (10 to 19ms)    %u"</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::DNSSECStats" title='mDNS_struct::DNSSECStats' data-ref="mDNS_struct::DNSSECStats" data-ref-filename="mDNS_struct..DNSSECStats">DNSSECStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::Latency10" title='(anonymous struct)::Latency10' data-ref="(anonymous)::Latency10" data-ref-filename="(anonymous)..Latency10">Latency10</a>);</td></tr>
<tr><th id="5975">5975</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;DNSSEC  Latency (20 to 49ms)    %u&quot;, m-&gt;DNSSECStats.Latency20);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"DNSSEC  Latency (20 to 49ms)    %u"</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::DNSSECStats" title='mDNS_struct::DNSSECStats' data-ref="mDNS_struct::DNSSECStats" data-ref-filename="mDNS_struct..DNSSECStats">DNSSECStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::Latency20" title='(anonymous struct)::Latency20' data-ref="(anonymous)::Latency20" data-ref-filename="(anonymous)..Latency20">Latency20</a>);</td></tr>
<tr><th id="5976">5976</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;DNSSEC  Latency (50 to 99ms)    %u&quot;, m-&gt;DNSSECStats.Latency50);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"DNSSEC  Latency (50 to 99ms)    %u"</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::DNSSECStats" title='mDNS_struct::DNSSECStats' data-ref="mDNS_struct::DNSSECStats" data-ref-filename="mDNS_struct..DNSSECStats">DNSSECStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::Latency50" title='(anonymous struct)::Latency50' data-ref="(anonymous)::Latency50" data-ref-filename="(anonymous)..Latency50">Latency50</a>);</td></tr>
<tr><th id="5977">5977</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;DNSSEC  Latency (   &gt;=100ms)    %u&quot;, m-&gt;DNSSECStats.Latency100);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"DNSSEC  Latency (   &gt;=100ms)    %u"</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::DNSSECStats" title='mDNS_struct::DNSSECStats' data-ref="mDNS_struct::DNSSECStats" data-ref-filename="mDNS_struct..DNSSECStats">DNSSECStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::Latency100" title='(anonymous struct)::Latency100' data-ref="(anonymous)::Latency100" data-ref-filename="(anonymous)..Latency100">Latency100</a>);</td></tr>
<tr><th id="5978">5978</th><td></td></tr>
<tr><th id="5979">5979</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;DNSSEC  Secure Status           %u&quot;, m-&gt;DNSSECStats.SecureStatus);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"DNSSEC  Secure Status           %u"</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::DNSSECStats" title='mDNS_struct::DNSSECStats' data-ref="mDNS_struct::DNSSECStats" data-ref-filename="mDNS_struct..DNSSECStats">DNSSECStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::SecureStatus" title='(anonymous struct)::SecureStatus' data-ref="(anonymous)::SecureStatus" data-ref-filename="(anonymous)..SecureStatus">SecureStatus</a>);</td></tr>
<tr><th id="5980">5980</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;DNSSEC  Insecure Status         %u&quot;, m-&gt;DNSSECStats.InsecureStatus);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"DNSSEC  Insecure Status         %u"</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::DNSSECStats" title='mDNS_struct::DNSSECStats' data-ref="mDNS_struct::DNSSECStats" data-ref-filename="mDNS_struct..DNSSECStats">DNSSECStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::InsecureStatus" title='(anonymous struct)::InsecureStatus' data-ref="(anonymous)::InsecureStatus" data-ref-filename="(anonymous)..InsecureStatus">InsecureStatus</a>);</td></tr>
<tr><th id="5981">5981</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;DNSSEC  Indeterminate Status    %u&quot;, m-&gt;DNSSECStats.IndeterminateStatus);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"DNSSEC  Indeterminate Status    %u"</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::DNSSECStats" title='mDNS_struct::DNSSECStats' data-ref="mDNS_struct::DNSSECStats" data-ref-filename="mDNS_struct..DNSSECStats">DNSSECStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::IndeterminateStatus" title='(anonymous struct)::IndeterminateStatus' data-ref="(anonymous)::IndeterminateStatus" data-ref-filename="(anonymous)..IndeterminateStatus">IndeterminateStatus</a>);</td></tr>
<tr><th id="5982">5982</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;DNSSEC  Bogus Status            %u&quot;, m-&gt;DNSSECStats.BogusStatus);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"DNSSEC  Bogus Status            %u"</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::DNSSECStats" title='mDNS_struct::DNSSECStats' data-ref="mDNS_struct::DNSSECStats" data-ref-filename="mDNS_struct..DNSSECStats">DNSSECStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::BogusStatus" title='(anonymous struct)::BogusStatus' data-ref="(anonymous)::BogusStatus" data-ref-filename="(anonymous)..BogusStatus">BogusStatus</a>);</td></tr>
<tr><th id="5983">5983</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;DNSSEC  NoResponse Status       %u&quot;, m-&gt;DNSSECStats.NoResponseStatus);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"DNSSEC  NoResponse Status       %u"</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::DNSSECStats" title='mDNS_struct::DNSSECStats' data-ref="mDNS_struct::DNSSECStats" data-ref-filename="mDNS_struct..DNSSECStats">DNSSECStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::NoResponseStatus" title='(anonymous struct)::NoResponseStatus' data-ref="(anonymous)::NoResponseStatus" data-ref-filename="(anonymous)..NoResponseStatus">NoResponseStatus</a>);</td></tr>
<tr><th id="5984">5984</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;DNSSEC  Probes sent             %u&quot;, m-&gt;DNSSECStats.NumProbesSent);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"DNSSEC  Probes sent             %u"</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::DNSSECStats" title='mDNS_struct::DNSSECStats' data-ref="mDNS_struct::DNSSECStats" data-ref-filename="mDNS_struct..DNSSECStats">DNSSECStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::NumProbesSent" title='(anonymous struct)::NumProbesSent' data-ref="(anonymous)::NumProbesSent" data-ref-filename="(anonymous)..NumProbesSent">NumProbesSent</a>);</td></tr>
<tr><th id="5985">5985</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;DNSSEC  Msg Size (&lt;=1024)       %u&quot;, m-&gt;DNSSECStats.MsgSize0);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"DNSSEC  Msg Size (&lt;=1024)       %u"</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::DNSSECStats" title='mDNS_struct::DNSSECStats' data-ref="mDNS_struct::DNSSECStats" data-ref-filename="mDNS_struct..DNSSECStats">DNSSECStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::MsgSize0" title='(anonymous struct)::MsgSize0' data-ref="(anonymous)::MsgSize0" data-ref-filename="(anonymous)..MsgSize0">MsgSize0</a>);</td></tr>
<tr><th id="5986">5986</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;DNSSEC  Msg Size (&lt;=2048)       %u&quot;, m-&gt;DNSSECStats.MsgSize1);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"DNSSEC  Msg Size (&lt;=2048)       %u"</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::DNSSECStats" title='mDNS_struct::DNSSECStats' data-ref="mDNS_struct::DNSSECStats" data-ref-filename="mDNS_struct..DNSSECStats">DNSSECStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::MsgSize1" title='(anonymous struct)::MsgSize1' data-ref="(anonymous)::MsgSize1" data-ref-filename="(anonymous)..MsgSize1">MsgSize1</a>);</td></tr>
<tr><th id="5987">5987</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;DNSSEC  Msg Size (&gt; 2048)       %u&quot;, m-&gt;DNSSECStats.MsgSize2);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"DNSSEC  Msg Size (&gt; 2048)       %u"</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::DNSSECStats" title='mDNS_struct::DNSSECStats' data-ref="mDNS_struct::DNSSECStats" data-ref-filename="mDNS_struct..DNSSECStats">DNSSECStats</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::MsgSize2" title='(anonymous struct)::MsgSize2' data-ref="(anonymous)::MsgSize2" data-ref-filename="(anonymous)..MsgSize2">MsgSize2</a>);</td></tr>
<tr><th id="5988">5988</th><td></td></tr>
<tr><th id="5989">5989</th><td>    <a class="ref fn" href="#LogMDNSStatistics" title='LogMDNSStatistics' data-ref="LogMDNSStatistics" data-ref-filename="LogMDNSStatistics">LogMDNSStatistics</a>(<a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>);</td></tr>
<tr><th id="5990">5990</th><td></td></tr>
<tr><th id="5991">5991</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"---- Task Scheduling Timers ----"</q>);</td></tr>
<tr><th id="5992">5992</th><td></td></tr>
<tr><th id="5993">5993</th><td><u>#<span data-ppcond="5993">if</span> BONJOUR_ON_DEMAND</u></td></tr>
<tr><th id="5994">5994</th><td>    LogMsgNoIdent(<q>"BonjourEnabled %d"</q>, m-&gt;BonjourEnabled);</td></tr>
<tr><th id="5995">5995</th><td><u>#<span data-ppcond="5993">endif</span> // BONJOUR_ON_DEMAND</u></td></tr>
<tr><th id="5996">5996</th><td></td></tr>
<tr><th id="5997">5997</th><td><u>#<span data-ppcond="5997">if</span> APPLE_OSX_mDNSResponder &amp;&amp; ENABLE_BLE_TRIGGERED_BONJOUR</u></td></tr>
<tr><th id="5998">5998</th><td>    LogMsgNoIdent(<q>"EnableBLEBasedDiscovery %d"</q>, EnableBLEBasedDiscovery);</td></tr>
<tr><th id="5999">5999</th><td>    LogMsgNoIdent(<q>"DefaultToBLETriggered %d"</q>, DefaultToBLETriggered);</td></tr>
<tr><th id="6000">6000</th><td><u>#<span data-ppcond="5997">endif</span> // APPLE_OSX_mDNSResponder &amp;&amp; ENABLE_BLE_TRIGGERED_BONJOUR</u></td></tr>
<tr><th id="6001">6001</th><td></td></tr>
<tr><th id="6002">6002</th><td>    <b>if</b> (!<a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::NewQuestions" title='mDNS_struct::NewQuestions' data-ref="mDNS_struct::NewQuestions" data-ref-filename="mDNS_struct..NewQuestions">NewQuestions</a>)</td></tr>
<tr><th id="6003">6003</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"NewQuestion &lt;NONE&gt;"</q>);</td></tr>
<tr><th id="6004">6004</th><td>    <b>else</b></td></tr>
<tr><th id="6005">6005</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"NewQuestion DelayAnswering %d %d %##s (%s)"</q>,</td></tr>
<tr><th id="6006">6006</th><td>                      <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::NewQuestions" title='mDNS_struct::NewQuestions' data-ref="mDNS_struct::NewQuestions" data-ref-filename="mDNS_struct..NewQuestions">NewQuestions</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::DelayAnswering" title='DNSQuestion_struct::DelayAnswering' data-ref="DNSQuestion_struct::DelayAnswering" data-ref-filename="DNSQuestion_struct..DelayAnswering">DelayAnswering</a>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::NewQuestions" title='mDNS_struct::NewQuestions' data-ref="mDNS_struct::NewQuestions" data-ref-filename="mDNS_struct..NewQuestions">NewQuestions</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::DelayAnswering" title='DNSQuestion_struct::DelayAnswering' data-ref="DNSQuestion_struct::DelayAnswering" data-ref-filename="DNSQuestion_struct..DelayAnswering">DelayAnswering</a>-<a class="local col3 ref" href="#613now" title='now' data-ref="613now" data-ref-filename="613now">now</a>,</td></tr>
<tr><th id="6007">6007</th><td>                      <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::NewQuestions" title='mDNS_struct::NewQuestions' data-ref="mDNS_struct::NewQuestions" data-ref-filename="mDNS_struct..NewQuestions">NewQuestions</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::NewQuestions" title='mDNS_struct::NewQuestions' data-ref="mDNS_struct::NewQuestions" data-ref-filename="mDNS_struct..NewQuestions">NewQuestions</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a>));</td></tr>
<tr><th id="6008">6008</th><td></td></tr>
<tr><th id="6009">6009</th><td>    <b>if</b> (!<a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::NewLocalOnlyQuestions" title='mDNS_struct::NewLocalOnlyQuestions' data-ref="mDNS_struct::NewLocalOnlyQuestions" data-ref-filename="mDNS_struct..NewLocalOnlyQuestions">NewLocalOnlyQuestions</a>)</td></tr>
<tr><th id="6010">6010</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"NewLocalOnlyQuestions &lt;NONE&gt;"</q>);</td></tr>
<tr><th id="6011">6011</th><td>    <b>else</b></td></tr>
<tr><th id="6012">6012</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"NewLocalOnlyQuestions %##s (%s)"</q>,</td></tr>
<tr><th id="6013">6013</th><td>                      <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::NewLocalOnlyQuestions" title='mDNS_struct::NewLocalOnlyQuestions' data-ref="mDNS_struct::NewLocalOnlyQuestions" data-ref-filename="mDNS_struct..NewLocalOnlyQuestions">NewLocalOnlyQuestions</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>, <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSTypeName" title='DNSTypeName' data-ref="DNSTypeName" data-ref-filename="DNSTypeName">DNSTypeName</a>(<a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::NewLocalOnlyQuestions" title='mDNS_struct::NewLocalOnlyQuestions' data-ref="mDNS_struct::NewLocalOnlyQuestions" data-ref-filename="mDNS_struct..NewLocalOnlyQuestions">NewLocalOnlyQuestions</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qtype" title='DNSQuestion_struct::qtype' data-ref="DNSQuestion_struct::qtype" data-ref-filename="DNSQuestion_struct..qtype">qtype</a>));</td></tr>
<tr><th id="6014">6014</th><td></td></tr>
<tr><th id="6015">6015</th><td>    <b>if</b> (!<a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::NewLocalRecords" title='mDNS_struct::NewLocalRecords' data-ref="mDNS_struct::NewLocalRecords" data-ref-filename="mDNS_struct..NewLocalRecords">NewLocalRecords</a>)</td></tr>
<tr><th id="6016">6016</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"NewLocalRecords &lt;NONE&gt;"</q>);</td></tr>
<tr><th id="6017">6017</th><td>    <b>else</b></td></tr>
<tr><th id="6018">6018</th><td>        <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"NewLocalRecords %02X %s"</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::NewLocalRecords" title='mDNS_struct::NewLocalRecords' data-ref="mDNS_struct::NewLocalRecords" data-ref-filename="mDNS_struct..NewLocalRecords">NewLocalRecords</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#AuthRecord_struct::resrec" title='AuthRecord_struct::resrec' data-ref="AuthRecord_struct::resrec" data-ref-filename="AuthRecord_struct..resrec">resrec</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#ResourceRecord_struct::RecordType" title='ResourceRecord_struct::RecordType' data-ref="ResourceRecord_struct::RecordType" data-ref-filename="ResourceRecord_struct..RecordType">RecordType</a>, <a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#2942" title="GetRRDisplayString_rdb(&amp;(m-&gt;NewLocalRecords)-&gt;resrec, &amp;(m-&gt;NewLocalRecords)-&gt;resrec.rdata-&gt;u, (m)-&gt;MsgBuffer)" data-ref="_M/ARDisplayString">ARDisplayString</a>(<a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::NewLocalRecords" title='mDNS_struct::NewLocalRecords' data-ref="mDNS_struct::NewLocalRecords" data-ref-filename="mDNS_struct..NewLocalRecords">NewLocalRecords</a>));</td></tr>
<tr><th id="6019">6019</th><td></td></tr>
<tr><th id="6020">6020</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"SPSProxyListChanged%s"</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::SPSProxyListChanged" title='mDNS_struct::SPSProxyListChanged' data-ref="mDNS_struct::SPSProxyListChanged" data-ref-filename="mDNS_struct..SPSProxyListChanged">SPSProxyListChanged</a> ? <q>""</q> : <q>" &lt;NONE&gt;"</q>);</td></tr>
<tr><th id="6021">6021</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"LocalRemoveEvents%s"</q>,   <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::LocalRemoveEvents" title='mDNS_struct::LocalRemoveEvents' data-ref="mDNS_struct::LocalRemoveEvents" data-ref-filename="mDNS_struct..LocalRemoveEvents">LocalRemoveEvents</a>   ? <q>""</q> : <q>" &lt;NONE&gt;"</q>);</td></tr>
<tr><th id="6022">6022</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"m-&gt;AutoTunnelRelayAddr %.16a"</q>, &amp;<a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::AutoTunnelRelayAddr" title='mDNS_struct::AutoTunnelRelayAddr' data-ref="mDNS_struct::AutoTunnelRelayAddr" data-ref-filename="mDNS_struct..AutoTunnelRelayAddr">AutoTunnelRelayAddr</a>);</td></tr>
<tr><th id="6023">6023</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"m-&gt;WABBrowseQueriesCount %d"</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::WABBrowseQueriesCount" title='mDNS_struct::WABBrowseQueriesCount' data-ref="mDNS_struct::WABBrowseQueriesCount" data-ref-filename="mDNS_struct..WABBrowseQueriesCount">WABBrowseQueriesCount</a>);</td></tr>
<tr><th id="6024">6024</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"m-&gt;WABLBrowseQueriesCount %d"</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::WABLBrowseQueriesCount" title='mDNS_struct::WABLBrowseQueriesCount' data-ref="mDNS_struct::WABLBrowseQueriesCount" data-ref-filename="mDNS_struct..WABLBrowseQueriesCount">WABLBrowseQueriesCount</a>);</td></tr>
<tr><th id="6025">6025</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"m-&gt;WABRegQueriesCount %d"</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::WABRegQueriesCount" title='mDNS_struct::WABRegQueriesCount' data-ref="mDNS_struct::WABRegQueriesCount" data-ref-filename="mDNS_struct..WABRegQueriesCount">WABRegQueriesCount</a>);</td></tr>
<tr><th id="6026">6026</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"m-&gt;AutoTargetServices %d"</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::AutoTargetServices" title='mDNS_struct::AutoTargetServices' data-ref="mDNS_struct::AutoTargetServices" data-ref-filename="mDNS_struct..AutoTargetServices">AutoTargetServices</a>);</td></tr>
<tr><th id="6027">6027</th><td></td></tr>
<tr><th id="6028">6028</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"                         ABS (hex)  ABS (dec)  REL (hex)  REL (dec)"</q>);</td></tr>
<tr><th id="6029">6029</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"m-&gt;timenow               %08X %11d"</q>, <a class="local col3 ref" href="#613now" title='now' data-ref="613now" data-ref-filename="613now">now</a>, <a class="local col3 ref" href="#613now" title='now' data-ref="613now" data-ref-filename="613now">now</a>);</td></tr>
<tr><th id="6030">6030</th><td>    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"m-&gt;timenow_adjust        %08X %11d"</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::timenow_adjust" title='mDNS_struct::timenow_adjust' data-ref="mDNS_struct::timenow_adjust" data-ref-filename="mDNS_struct..timenow_adjust">timenow_adjust</a>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::timenow_adjust" title='mDNS_struct::timenow_adjust' data-ref="mDNS_struct::timenow_adjust" data-ref-filename="mDNS_struct..timenow_adjust">timenow_adjust</a>);</td></tr>
<tr><th id="6031">6031</th><td>    <a class="macro" href="uds_daemon.h.html#216" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;m-&gt;NextScheduledEvent   &quot; &quot; %08X %11d  %08X %11d&quot;, (m-&gt;NextScheduledEvent), (m-&gt;NextScheduledEvent), (m-&gt;NextScheduledEvent)-now, (m-&gt;NextScheduledEvent)-now)" data-ref="_M/LogTimer">LogTimer</a>(<q>"m-&gt;NextScheduledEvent   "</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::NextScheduledEvent" title='mDNS_struct::NextScheduledEvent' data-ref="mDNS_struct::NextScheduledEvent" data-ref-filename="mDNS_struct..NextScheduledEvent">NextScheduledEvent</a>);</td></tr>
<tr><th id="6032">6032</th><td></td></tr>
<tr><th id="6033">6033</th><td><u>#<span data-ppcond="6033">ifndef</span> <span class="macro" data-ref="_M/UNICAST_DISABLED">UNICAST_DISABLED</span></u></td></tr>
<tr><th id="6034">6034</th><td>    <a class="macro" href="uds_daemon.h.html#216" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;m-&gt;NextuDNSEvent        &quot; &quot; %08X %11d  %08X %11d&quot;, (m-&gt;NextuDNSEvent), (m-&gt;NextuDNSEvent), (m-&gt;NextuDNSEvent)-now, (m-&gt;NextuDNSEvent)-now)" data-ref="_M/LogTimer">LogTimer</a>(<q>"m-&gt;NextuDNSEvent        "</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::NextuDNSEvent" title='mDNS_struct::NextuDNSEvent' data-ref="mDNS_struct::NextuDNSEvent" data-ref-filename="mDNS_struct..NextuDNSEvent">NextuDNSEvent</a>);</td></tr>
<tr><th id="6035">6035</th><td>    <a class="macro" href="uds_daemon.h.html#216" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;m-&gt;NextSRVUpdate        &quot; &quot; %08X %11d  %08X %11d&quot;, (m-&gt;NextSRVUpdate), (m-&gt;NextSRVUpdate), (m-&gt;NextSRVUpdate)-now, (m-&gt;NextSRVUpdate)-now)" data-ref="_M/LogTimer">LogTimer</a>(<q>"m-&gt;NextSRVUpdate        "</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::NextSRVUpdate" title='mDNS_struct::NextSRVUpdate' data-ref="mDNS_struct::NextSRVUpdate" data-ref-filename="mDNS_struct..NextSRVUpdate">NextSRVUpdate</a>);</td></tr>
<tr><th id="6036">6036</th><td>    <a class="macro" href="uds_daemon.h.html#216" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;m-&gt;NextScheduledNATOp   &quot; &quot; %08X %11d  %08X %11d&quot;, (m-&gt;NextScheduledNATOp), (m-&gt;NextScheduledNATOp), (m-&gt;NextScheduledNATOp)-now, (m-&gt;NextScheduledNATOp)-now)" data-ref="_M/LogTimer">LogTimer</a>(<q>"m-&gt;NextScheduledNATOp   "</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::NextScheduledNATOp" title='mDNS_struct::NextScheduledNATOp' data-ref="mDNS_struct::NextScheduledNATOp" data-ref-filename="mDNS_struct..NextScheduledNATOp">NextScheduledNATOp</a>);</td></tr>
<tr><th id="6037">6037</th><td>    <a class="macro" href="uds_daemon.h.html#216" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;m-&gt;retryGetAddr         &quot; &quot; %08X %11d  %08X %11d&quot;, (m-&gt;retryGetAddr), (m-&gt;retryGetAddr), (m-&gt;retryGetAddr)-now, (m-&gt;retryGetAddr)-now)" data-ref="_M/LogTimer">LogTimer</a>(<q>"m-&gt;retryGetAddr         "</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::retryGetAddr" title='mDNS_struct::retryGetAddr' data-ref="mDNS_struct::retryGetAddr" data-ref-filename="mDNS_struct..retryGetAddr">retryGetAddr</a>);</td></tr>
<tr><th id="6038">6038</th><td><u>#<span data-ppcond="6033">endif</span></u></td></tr>
<tr><th id="6039">6039</th><td></td></tr>
<tr><th id="6040">6040</th><td>    <a class="macro" href="uds_daemon.h.html#216" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;m-&gt;NextCacheCheck       &quot; &quot; %08X %11d  %08X %11d&quot;, (m-&gt;NextCacheCheck), (m-&gt;NextCacheCheck), (m-&gt;NextCacheCheck)-now, (m-&gt;NextCacheCheck)-now)" data-ref="_M/LogTimer">LogTimer</a>(<q>"m-&gt;NextCacheCheck       "</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::NextCacheCheck" title='mDNS_struct::NextCacheCheck' data-ref="mDNS_struct::NextCacheCheck" data-ref-filename="mDNS_struct..NextCacheCheck">NextCacheCheck</a>);</td></tr>
<tr><th id="6041">6041</th><td>    <a class="macro" href="uds_daemon.h.html#216" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;m-&gt;NextScheduledSPS     &quot; &quot; %08X %11d  %08X %11d&quot;, (m-&gt;NextScheduledSPS), (m-&gt;NextScheduledSPS), (m-&gt;NextScheduledSPS)-now, (m-&gt;NextScheduledSPS)-now)" data-ref="_M/LogTimer">LogTimer</a>(<q>"m-&gt;NextScheduledSPS     "</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::NextScheduledSPS" title='mDNS_struct::NextScheduledSPS' data-ref="mDNS_struct::NextScheduledSPS" data-ref-filename="mDNS_struct..NextScheduledSPS">NextScheduledSPS</a>);</td></tr>
<tr><th id="6042">6042</th><td>    <a class="macro" href="uds_daemon.h.html#216" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;m-&gt;NextScheduledKA      &quot; &quot; %08X %11d  %08X %11d&quot;, (m-&gt;NextScheduledKA), (m-&gt;NextScheduledKA), (m-&gt;NextScheduledKA)-now, (m-&gt;NextScheduledKA)-now)" data-ref="_M/LogTimer">LogTimer</a>(<q>"m-&gt;NextScheduledKA      "</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::NextScheduledKA" title='mDNS_struct::NextScheduledKA' data-ref="mDNS_struct::NextScheduledKA" data-ref-filename="mDNS_struct..NextScheduledKA">NextScheduledKA</a>);</td></tr>
<tr><th id="6043">6043</th><td></td></tr>
<tr><th id="6044">6044</th><td><u>#<span data-ppcond="6044">if</span> BONJOUR_ON_DEMAND</u></td></tr>
<tr><th id="6045">6045</th><td>    LogTimer(<q>"m-&gt;NextBonjourDisableTime "</q>, m-&gt;NextBonjourDisableTime);</td></tr>
<tr><th id="6046">6046</th><td><u>#<span data-ppcond="6044">endif</span> // BONJOUR_ON_DEMAND</u></td></tr>
<tr><th id="6047">6047</th><td></td></tr>
<tr><th id="6048">6048</th><td>    <a class="macro" href="uds_daemon.h.html#216" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;m-&gt;NextScheduledSPRetry &quot; &quot; %08X %11d  %08X %11d&quot;, (m-&gt;NextScheduledSPRetry), (m-&gt;NextScheduledSPRetry), (m-&gt;NextScheduledSPRetry)-now, (m-&gt;NextScheduledSPRetry)-now)" data-ref="_M/LogTimer">LogTimer</a>(<q>"m-&gt;NextScheduledSPRetry "</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::NextScheduledSPRetry" title='mDNS_struct::NextScheduledSPRetry' data-ref="mDNS_struct::NextScheduledSPRetry" data-ref-filename="mDNS_struct..NextScheduledSPRetry">NextScheduledSPRetry</a>);</td></tr>
<tr><th id="6049">6049</th><td>    <a class="macro" href="uds_daemon.h.html#216" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;m-&gt;DelaySleep           &quot; &quot; %08X %11d  %08X %11d&quot;, (m-&gt;DelaySleep), (m-&gt;DelaySleep), (m-&gt;DelaySleep)-now, (m-&gt;DelaySleep)-now)" data-ref="_M/LogTimer">LogTimer</a>(<q>"m-&gt;DelaySleep           "</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::DelaySleep" title='mDNS_struct::DelaySleep' data-ref="mDNS_struct::DelaySleep" data-ref-filename="mDNS_struct..DelaySleep">DelaySleep</a>);</td></tr>
<tr><th id="6050">6050</th><td></td></tr>
<tr><th id="6051">6051</th><td>    <a class="macro" href="uds_daemon.h.html#216" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;m-&gt;NextScheduledQuery   &quot; &quot; %08X %11d  %08X %11d&quot;, (m-&gt;NextScheduledQuery), (m-&gt;NextScheduledQuery), (m-&gt;NextScheduledQuery)-now, (m-&gt;NextScheduledQuery)-now)" data-ref="_M/LogTimer">LogTimer</a>(<q>"m-&gt;NextScheduledQuery   "</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::NextScheduledQuery" title='mDNS_struct::NextScheduledQuery' data-ref="mDNS_struct::NextScheduledQuery" data-ref-filename="mDNS_struct..NextScheduledQuery">NextScheduledQuery</a>);</td></tr>
<tr><th id="6052">6052</th><td>    <a class="macro" href="uds_daemon.h.html#216" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;m-&gt;NextScheduledProbe   &quot; &quot; %08X %11d  %08X %11d&quot;, (m-&gt;NextScheduledProbe), (m-&gt;NextScheduledProbe), (m-&gt;NextScheduledProbe)-now, (m-&gt;NextScheduledProbe)-now)" data-ref="_M/LogTimer">LogTimer</a>(<q>"m-&gt;NextScheduledProbe   "</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::NextScheduledProbe" title='mDNS_struct::NextScheduledProbe' data-ref="mDNS_struct::NextScheduledProbe" data-ref-filename="mDNS_struct..NextScheduledProbe">NextScheduledProbe</a>);</td></tr>
<tr><th id="6053">6053</th><td>    <a class="macro" href="uds_daemon.h.html#216" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;m-&gt;NextScheduledResponse&quot; &quot; %08X %11d  %08X %11d&quot;, (m-&gt;NextScheduledResponse), (m-&gt;NextScheduledResponse), (m-&gt;NextScheduledResponse)-now, (m-&gt;NextScheduledResponse)-now)" data-ref="_M/LogTimer">LogTimer</a>(<q>"m-&gt;NextScheduledResponse"</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::NextScheduledResponse" title='mDNS_struct::NextScheduledResponse' data-ref="mDNS_struct::NextScheduledResponse" data-ref-filename="mDNS_struct..NextScheduledResponse">NextScheduledResponse</a>);</td></tr>
<tr><th id="6054">6054</th><td></td></tr>
<tr><th id="6055">6055</th><td>    <a class="macro" href="uds_daemon.h.html#216" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;m-&gt;SuppressSending      &quot; &quot; %08X %11d  %08X %11d&quot;, (m-&gt;SuppressSending), (m-&gt;SuppressSending), (m-&gt;SuppressSending)-now, (m-&gt;SuppressSending)-now)" data-ref="_M/LogTimer">LogTimer</a>(<q>"m-&gt;SuppressSending      "</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::SuppressSending" title='mDNS_struct::SuppressSending' data-ref="mDNS_struct::SuppressSending" data-ref-filename="mDNS_struct..SuppressSending">SuppressSending</a>);</td></tr>
<tr><th id="6056">6056</th><td>    <a class="macro" href="uds_daemon.h.html#216" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;m-&gt;SuppressProbes       &quot; &quot; %08X %11d  %08X %11d&quot;, (m-&gt;SuppressProbes), (m-&gt;SuppressProbes), (m-&gt;SuppressProbes)-now, (m-&gt;SuppressProbes)-now)" data-ref="_M/LogTimer">LogTimer</a>(<q>"m-&gt;SuppressProbes       "</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::SuppressProbes" title='mDNS_struct::SuppressProbes' data-ref="mDNS_struct::SuppressProbes" data-ref-filename="mDNS_struct..SuppressProbes">SuppressProbes</a>);</td></tr>
<tr><th id="6057">6057</th><td>    <a class="macro" href="uds_daemon.h.html#216" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;m-&gt;ProbeFailTime        &quot; &quot; %08X %11d  %08X %11d&quot;, (m-&gt;ProbeFailTime), (m-&gt;ProbeFailTime), (m-&gt;ProbeFailTime)-now, (m-&gt;ProbeFailTime)-now)" data-ref="_M/LogTimer">LogTimer</a>(<q>"m-&gt;ProbeFailTime        "</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::ProbeFailTime" title='mDNS_struct::ProbeFailTime' data-ref="mDNS_struct::ProbeFailTime" data-ref-filename="mDNS_struct..ProbeFailTime">ProbeFailTime</a>);</td></tr>
<tr><th id="6058">6058</th><td>    <a class="macro" href="uds_daemon.h.html#216" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;m-&gt;DelaySleep           &quot; &quot; %08X %11d  %08X %11d&quot;, (m-&gt;DelaySleep), (m-&gt;DelaySleep), (m-&gt;DelaySleep)-now, (m-&gt;DelaySleep)-now)" data-ref="_M/LogTimer">LogTimer</a>(<q>"m-&gt;DelaySleep           "</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::DelaySleep" title='mDNS_struct::DelaySleep' data-ref="mDNS_struct::DelaySleep" data-ref-filename="mDNS_struct..DelaySleep">DelaySleep</a>);</td></tr>
<tr><th id="6059">6059</th><td>    <a class="macro" href="uds_daemon.h.html#216" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;m-&gt;SleepLimit           &quot; &quot; %08X %11d  %08X %11d&quot;, (m-&gt;SleepLimit), (m-&gt;SleepLimit), (m-&gt;SleepLimit)-now, (m-&gt;SleepLimit)-now)" data-ref="_M/LogTimer">LogTimer</a>(<q>"m-&gt;SleepLimit           "</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::SleepLimit" title='mDNS_struct::SleepLimit' data-ref="mDNS_struct::SleepLimit" data-ref-filename="mDNS_struct..SleepLimit">SleepLimit</a>);</td></tr>
<tr><th id="6060">6060</th><td>    <a class="macro" href="uds_daemon.h.html#216" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;m-&gt;NextScheduledStopTime &quot; &quot; %08X %11d  %08X %11d&quot;, (m-&gt;NextScheduledStopTime), (m-&gt;NextScheduledStopTime), (m-&gt;NextScheduledStopTime)-now, (m-&gt;NextScheduledStopTime)-now)" data-ref="_M/LogTimer">LogTimer</a>(<q>"m-&gt;NextScheduledStopTime "</q>, <a class="local col2 ref" href="#612m" title='m' data-ref="612m" data-ref-filename="612m">m</a>-&gt;<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::NextScheduledStopTime" title='mDNS_struct::NextScheduledStopTime' data-ref="mDNS_struct::NextScheduledStopTime" data-ref-filename="mDNS_struct..NextScheduledStopTime">NextScheduledStopTime</a>);</td></tr>
<tr><th id="6061">6061</th><td>}</td></tr>
<tr><th id="6062">6062</th><td></td></tr>
<tr><th id="6063">6063</th><td><u>#<span data-ppcond="6063">if</span> APPLE_OSX_mDNSResponder &amp;&amp; MACOSX_MDNS_MALLOC_DEBUGGING</u></td></tr>
<tr><th id="6064">6064</th><td>mDNSexport <em>void</em> uds_validatelists(<em>void</em>)</td></tr>
<tr><th id="6065">6065</th><td>{</td></tr>
<tr><th id="6066">6066</th><td>    <em>const</em> request_state *req, *p;</td></tr>
<tr><th id="6067">6067</th><td>    <b>for</b> (req = all_requests; req; req=req-&gt;next)</td></tr>
<tr><th id="6068">6068</th><td>    {</td></tr>
<tr><th id="6069">6069</th><td>        <b>if</b> (req-&gt;next == (request_state *)~<var>0</var> || (req-&gt;sd &lt; <var>0</var> &amp;&amp; req-&gt;sd != -<var>2</var>))</td></tr>
<tr><th id="6070">6070</th><td>            LogMemCorruption(<q>"UDS request list: %p is garbage (%d)"</q>, req, req-&gt;sd);</td></tr>
<tr><th id="6071">6071</th><td></td></tr>
<tr><th id="6072">6072</th><td>        <b>if</b> (req-&gt;primary == req)</td></tr>
<tr><th id="6073">6073</th><td>            LogMemCorruption(<q>"UDS request list: req-&gt;primary should not point to self %p/%d"</q>, req, req-&gt;sd);</td></tr>
<tr><th id="6074">6074</th><td></td></tr>
<tr><th id="6075">6075</th><td>        <b>if</b> (req-&gt;primary &amp;&amp; req-&gt;replies)</td></tr>
<tr><th id="6076">6076</th><td>            LogMemCorruption(<q>"UDS request list: Subordinate request %p/%d/%p should not have replies (%p)"</q>,</td></tr>
<tr><th id="6077">6077</th><td>                             req, req-&gt;sd, req-&gt;primary &amp;&amp; req-&gt;replies);</td></tr>
<tr><th id="6078">6078</th><td></td></tr>
<tr><th id="6079">6079</th><td>        p = req-&gt;primary;</td></tr>
<tr><th id="6080">6080</th><td>        <b>if</b> ((<em>long</em>)p &amp; <var>3</var>)</td></tr>
<tr><th id="6081">6081</th><td>            LogMemCorruption(<q>"UDS request list: req %p primary %p is misaligned (%d)"</q>, req, p, req-&gt;sd);</td></tr>
<tr><th id="6082">6082</th><td>        <b>else</b> <b>if</b> (p &amp;&amp; (p-&gt;next == (request_state *)~<var>0</var> || (p-&gt;sd &lt; <var>0</var> &amp;&amp; p-&gt;sd != -<var>2</var>)))</td></tr>
<tr><th id="6083">6083</th><td>            LogMemCorruption(<q>"UDS request list: req %p primary %p is garbage (%d)"</q>, req, p, p-&gt;sd);</td></tr>
<tr><th id="6084">6084</th><td></td></tr>
<tr><th id="6085">6085</th><td>        reply_state *rep;</td></tr>
<tr><th id="6086">6086</th><td>        <b>for</b> (rep = req-&gt;replies; rep; rep=rep-&gt;next)</td></tr>
<tr><th id="6087">6087</th><td>            <b>if</b> (rep-&gt;next == (reply_state *)~<var>0</var>)</td></tr>
<tr><th id="6088">6088</th><td>                LogMemCorruption(<q>"UDS req-&gt;replies: %p is garbage"</q>, rep);</td></tr>
<tr><th id="6089">6089</th><td></td></tr>
<tr><th id="6090">6090</th><td>        <b>if</b> (req-&gt;terminate == connection_termination)</td></tr>
<tr><th id="6091">6091</th><td>        {</td></tr>
<tr><th id="6092">6092</th><td>            registered_record_entry *r;</td></tr>
<tr><th id="6093">6093</th><td>            <b>for</b> (r = req-&gt;u.reg_recs; r; r=r-&gt;next)</td></tr>
<tr><th id="6094">6094</th><td>                <b>if</b> (r-&gt;next == (registered_record_entry *)~<var>0</var>)</td></tr>
<tr><th id="6095">6095</th><td>                    LogMemCorruption(<q>"UDS req-&gt;u.reg_recs: %p is garbage"</q>, r);</td></tr>
<tr><th id="6096">6096</th><td>        }</td></tr>
<tr><th id="6097">6097</th><td>        <b>else</b> <b>if</b> (req-&gt;terminate == regservice_termination_callback)</td></tr>
<tr><th id="6098">6098</th><td>        {</td></tr>
<tr><th id="6099">6099</th><td>            service_instance *s;</td></tr>
<tr><th id="6100">6100</th><td>            <b>for</b> (s = req-&gt;u.servicereg.instances; s; s=s-&gt;next)</td></tr>
<tr><th id="6101">6101</th><td>                <b>if</b> (s-&gt;next == (service_instance *)~<var>0</var>)</td></tr>
<tr><th id="6102">6102</th><td>                    LogMemCorruption(<q>"UDS req-&gt;u.servicereg.instances: %p is garbage"</q>, s);</td></tr>
<tr><th id="6103">6103</th><td>        }</td></tr>
<tr><th id="6104">6104</th><td>        <b>else</b> <b>if</b> (req-&gt;terminate == browse_termination_callback)</td></tr>
<tr><th id="6105">6105</th><td>        {</td></tr>
<tr><th id="6106">6106</th><td>            browser_t *b;</td></tr>
<tr><th id="6107">6107</th><td>            <b>for</b> (b = req-&gt;u.browser.browsers; b; b=b-&gt;next)</td></tr>
<tr><th id="6108">6108</th><td>                <b>if</b> (b-&gt;next == (browser_t *)~<var>0</var>)</td></tr>
<tr><th id="6109">6109</th><td>                    LogMemCorruption(<q>"UDS req-&gt;u.browser.browsers: %p is garbage"</q>, b);</td></tr>
<tr><th id="6110">6110</th><td>        }</td></tr>
<tr><th id="6111">6111</th><td>    }</td></tr>
<tr><th id="6112">6112</th><td></td></tr>
<tr><th id="6113">6113</th><td>    DNameListElem *d;</td></tr>
<tr><th id="6114">6114</th><td>    <b>for</b> (d = SCPrefBrowseDomains; d; d=d-&gt;next)</td></tr>
<tr><th id="6115">6115</th><td>        <b>if</b> (d-&gt;next == (DNameListElem *)~<var>0</var> || d-&gt;name.c[<var>0</var>] &gt; <var>63</var>)</td></tr>
<tr><th id="6116">6116</th><td>            LogMemCorruption(<q>"SCPrefBrowseDomains: %p is garbage (%d)"</q>, d, d-&gt;name.c[<var>0</var>]);</td></tr>
<tr><th id="6117">6117</th><td></td></tr>
<tr><th id="6118">6118</th><td>    ARListElem *b;</td></tr>
<tr><th id="6119">6119</th><td>    <b>for</b> (b = LocalDomainEnumRecords; b; b=b-&gt;next)</td></tr>
<tr><th id="6120">6120</th><td>        <b>if</b> (b-&gt;next == (ARListElem *)~<var>0</var> || b-&gt;ar.resrec.name-&gt;c[<var>0</var>] &gt; <var>63</var>)</td></tr>
<tr><th id="6121">6121</th><td>            LogMemCorruption(<q>"LocalDomainEnumRecords: %p is garbage (%d)"</q>, b, b-&gt;ar.resrec.name-&gt;c[<var>0</var>]);</td></tr>
<tr><th id="6122">6122</th><td></td></tr>
<tr><th id="6123">6123</th><td>    <b>for</b> (d = AutoBrowseDomains; d; d=d-&gt;next)</td></tr>
<tr><th id="6124">6124</th><td>        <b>if</b> (d-&gt;next == (DNameListElem *)~<var>0</var> || d-&gt;name.c[<var>0</var>] &gt; <var>63</var>)</td></tr>
<tr><th id="6125">6125</th><td>            LogMemCorruption(<q>"AutoBrowseDomains: %p is garbage (%d)"</q>, d, d-&gt;name.c[<var>0</var>]);</td></tr>
<tr><th id="6126">6126</th><td></td></tr>
<tr><th id="6127">6127</th><td>    <b>for</b> (d = AutoRegistrationDomains; d; d=d-&gt;next)</td></tr>
<tr><th id="6128">6128</th><td>        <b>if</b> (d-&gt;next == (DNameListElem *)~<var>0</var> || d-&gt;name.c[<var>0</var>] &gt; <var>63</var>)</td></tr>
<tr><th id="6129">6129</th><td>            LogMemCorruption(<q>"AutoRegistrationDomains: %p is garbage (%d)"</q>, d, d-&gt;name.c[<var>0</var>]);</td></tr>
<tr><th id="6130">6130</th><td>}</td></tr>
<tr><th id="6131">6131</th><td><u>#<span data-ppcond="6063">endif</span> // APPLE_OSX_mDNSResponder &amp;&amp; MACOSX_MDNS_MALLOC_DEBUGGING</u></td></tr>
<tr><th id="6132">6132</th><td></td></tr>
<tr><th id="6133">6133</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#109" title="static" data-ref="_M/mDNSlocal">mDNSlocal</a> <em>int</em> <dfn class="decl def fn" id="send_msg" title='send_msg' data-ref="send_msg" data-ref-filename="send_msg">send_msg</dfn>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<em>const</em> <dfn class="local col4 decl" id="644req" title='req' data-type='request_state *const' data-ref="644req" data-ref-filename="644req">req</dfn>)</td></tr>
<tr><th id="6134">6134</th><td>{</td></tr>
<tr><th id="6135">6135</th><td>    <a class="typedef" href="uds_daemon.h.html#reply_state" title='reply_state' data-type='struct reply_state' data-ref="reply_state" data-ref-filename="reply_state">reply_state</a> *<em>const</em> <dfn class="local col5 decl" id="645rep" title='rep' data-type='reply_state *const' data-ref="645rep" data-ref-filename="645rep">rep</dfn> = <a class="local col4 ref" href="#644req" title='req' data-ref="644req" data-ref-filename="644req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::replies" title='request_state::replies' data-ref="request_state::replies" data-ref-filename="request_state..replies">replies</a>;      <i>// Send the first waiting reply</i></td></tr>
<tr><th id="6136">6136</th><td>    <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#ssize_t" title='ssize_t' data-type='long' data-ref="ssize_t" data-ref-filename="ssize_t">ssize_t</a> <dfn class="local col6 decl" id="646nwriten" title='nwriten' data-type='ssize_t' data-ref="646nwriten" data-ref-filename="646nwriten">nwriten</dfn>;</td></tr>
<tr><th id="6137">6137</th><td></td></tr>
<tr><th id="6138">6138</th><td>    <a class="macro" href="dnssd_ipc.h.html#201" title="__dnssd_ipc_ConvertHeaderBytes" data-ref="_M/ConvertHeaderBytes">ConvertHeaderBytes</a>(<a class="local col5 ref" href="#645rep" title='rep' data-ref="645rep" data-ref-filename="645rep">rep</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::mhdr" title='reply_state::mhdr' data-ref="reply_state::mhdr" data-ref-filename="reply_state..mhdr">mhdr</a>);</td></tr>
<tr><th id="6139">6139</th><td>    <a class="local col6 ref" href="#646nwriten" title='nwriten' data-ref="646nwriten" data-ref-filename="646nwriten">nwriten</a> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#send" title='send' data-ref="send" data-ref-filename="send">send</a>(<a class="local col4 ref" href="#644req" title='req' data-ref="644req" data-ref-filename="644req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, (<em>char</em> *)&amp;<a class="local col5 ref" href="#645rep" title='rep' data-ref="645rep" data-ref-filename="645rep">rep</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::mhdr" title='reply_state::mhdr' data-ref="reply_state::mhdr" data-ref-filename="reply_state..mhdr">mhdr</a> + <a class="local col5 ref" href="#645rep" title='rep' data-ref="645rep" data-ref-filename="645rep">rep</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::nwriten" title='reply_state::nwriten' data-ref="reply_state::nwriten" data-ref-filename="reply_state..nwriten">nwriten</a>, <a class="local col5 ref" href="#645rep" title='rep' data-ref="645rep" data-ref-filename="645rep">rep</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::totallen" title='reply_state::totallen' data-ref="reply_state::totallen" data-ref-filename="reply_state..totallen">totallen</a> - <a class="local col5 ref" href="#645rep" title='rep' data-ref="645rep" data-ref-filename="645rep">rep</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::nwriten" title='reply_state::nwriten' data-ref="reply_state::nwriten" data-ref-filename="reply_state..nwriten">nwriten</a>, <var>0</var>);</td></tr>
<tr><th id="6140">6140</th><td>    <a class="macro" href="dnssd_ipc.h.html#201" title="__dnssd_ipc_ConvertHeaderBytes" data-ref="_M/ConvertHeaderBytes">ConvertHeaderBytes</a>(<a class="local col5 ref" href="#645rep" title='rep' data-ref="645rep" data-ref-filename="645rep">rep</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::mhdr" title='reply_state::mhdr' data-ref="reply_state::mhdr" data-ref-filename="reply_state..mhdr">mhdr</a>);</td></tr>
<tr><th id="6141">6141</th><td></td></tr>
<tr><th id="6142">6142</th><td>    <b>if</b> (<a class="local col6 ref" href="#646nwriten" title='nwriten' data-ref="646nwriten" data-ref-filename="646nwriten">nwriten</a> &lt; <var>0</var>)</td></tr>
<tr><th id="6143">6143</th><td>    {</td></tr>
<tr><th id="6144">6144</th><td>        <b>if</b> (<a class="macro" href="dnssd_ipc.h.html#71" title="(*__errno())" data-ref="_M/dnssd_errno">dnssd_errno</a> == <a class="macro" href="dnssd_ipc.h.html#66" title="4" data-ref="_M/dnssd_EINTR">dnssd_EINTR</a> || <a class="macro" href="dnssd_ipc.h.html#71" title="(*__errno())" data-ref="_M/dnssd_errno">dnssd_errno</a> == <a class="macro" href="dnssd_ipc.h.html#65" title="35" data-ref="_M/dnssd_EWOULDBLOCK">dnssd_EWOULDBLOCK</a>) <a class="local col6 ref" href="#646nwriten" title='nwriten' data-ref="646nwriten" data-ref-filename="646nwriten">nwriten</a> = <var>0</var>;</td></tr>
<tr><th id="6145">6145</th><td>        <b>else</b></td></tr>
<tr><th id="6146">6146</th><td>        {</td></tr>
<tr><th id="6147">6147</th><td><u>#<span data-ppcond="6147">if</span> !defined(<span class="macro" data-ref="_M/PLATFORM_NO_EPIPE">PLATFORM_NO_EPIPE</span>)</u></td></tr>
<tr><th id="6148">6148</th><td>            <b>if</b> (<a class="macro" href="dnssd_ipc.h.html#71" title="(*__errno())" data-ref="_M/dnssd_errno">dnssd_errno</a> == <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/errno.h.html#74" title="32" data-ref="_M/EPIPE">EPIPE</a>)</td></tr>
<tr><th id="6149">6149</th><td>                <b>return</b>(<a class="local col4 ref" href="#644req" title='req' data-ref="644req" data-ref-filename="644req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::ts" title='request_state::ts' data-ref="request_state::ts" data-ref-filename="request_state..ts">ts</a> = <a class="enum" href="uds_daemon.h.html#t_terminated" title='t_terminated' data-ref="t_terminated" data-ref-filename="t_terminated">t_terminated</a>);</td></tr>
<tr><th id="6150">6150</th><td>            <b>else</b></td></tr>
<tr><th id="6151">6151</th><td><u>#<span data-ppcond="6147">endif</span></u></td></tr>
<tr><th id="6152">6152</th><td>            {</td></tr>
<tr><th id="6153">6153</th><td>                <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;send_msg ERROR: failed to write %d of %d bytes to fd %d errno %d (%s)&quot;, rep-&gt;totallen - rep-&gt;nwriten, rep-&gt;totallen, req-&gt;sd, (*__errno()), strerror((*__errno())))" data-ref="_M/LogMsg">LogMsg</a>(<q>"send_msg ERROR: failed to write %d of %d bytes to fd %d errno %d (%s)"</q>,</td></tr>
<tr><th id="6154">6154</th><td>                       <a class="local col5 ref" href="#645rep" title='rep' data-ref="645rep" data-ref-filename="645rep">rep</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::totallen" title='reply_state::totallen' data-ref="reply_state::totallen" data-ref-filename="reply_state..totallen">totallen</a> - <a class="local col5 ref" href="#645rep" title='rep' data-ref="645rep" data-ref-filename="645rep">rep</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::nwriten" title='reply_state::nwriten' data-ref="reply_state::nwriten" data-ref-filename="reply_state..nwriten">nwriten</a>, <a class="local col5 ref" href="#645rep" title='rep' data-ref="645rep" data-ref-filename="645rep">rep</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::totallen" title='reply_state::totallen' data-ref="reply_state::totallen" data-ref-filename="reply_state..totallen">totallen</a>, <a class="local col4 ref" href="#644req" title='req' data-ref="644req" data-ref-filename="644req">req</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="macro" href="dnssd_ipc.h.html#71" title="(*__errno())" data-ref="_M/dnssd_errno">dnssd_errno</a>, <a class="macro" href="dnssd_ipc.h.html#72" title="strerror((*__errno()))" data-ref="_M/dnssd_strerror">dnssd_strerror</a>(<a class="macro" href="dnssd_ipc.h.html#71" title="(*__errno())" data-ref="_M/dnssd_errno">dnssd_errno</a>));</td></tr>
<tr><th id="6155">6155</th><td>                <b>return</b>(<a class="enum" href="uds_daemon.h.html#t_error" title='t_error' data-ref="t_error" data-ref-filename="t_error">t_error</a>);</td></tr>
<tr><th id="6156">6156</th><td>            }</td></tr>
<tr><th id="6157">6157</th><td>        }</td></tr>
<tr><th id="6158">6158</th><td>    }</td></tr>
<tr><th id="6159">6159</th><td>    <a class="local col5 ref" href="#645rep" title='rep' data-ref="645rep" data-ref-filename="645rep">rep</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::nwriten" title='reply_state::nwriten' data-ref="reply_state::nwriten" data-ref-filename="reply_state..nwriten">nwriten</a> += <a class="local col6 ref" href="#646nwriten" title='nwriten' data-ref="646nwriten" data-ref-filename="646nwriten">nwriten</a>;</td></tr>
<tr><th id="6160">6160</th><td>    <b>return</b> (<a class="local col5 ref" href="#645rep" title='rep' data-ref="645rep" data-ref-filename="645rep">rep</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::nwriten" title='reply_state::nwriten' data-ref="reply_state::nwriten" data-ref-filename="reply_state..nwriten">nwriten</a> == <a class="local col5 ref" href="#645rep" title='rep' data-ref="645rep" data-ref-filename="645rep">rep</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::totallen" title='reply_state::totallen' data-ref="reply_state::totallen" data-ref-filename="reply_state..totallen">totallen</a>) ? <a class="enum" href="uds_daemon.h.html#t_complete" title='t_complete' data-ref="t_complete" data-ref-filename="t_complete">t_complete</a> : <a class="enum" href="uds_daemon.h.html#t_morecoming" title='t_morecoming' data-ref="t_morecoming" data-ref-filename="t_morecoming">t_morecoming</a>;</td></tr>
<tr><th id="6161">6161</th><td>}</td></tr>
<tr><th id="6162">6162</th><td></td></tr>
<tr><th id="6163">6163</th><td><a class="macro" href="../mDNSCore/mDNSEmbeddedAPI.h.html#116" title="" data-ref="_M/mDNSexport">mDNSexport</a> <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSs32" title='mDNSs32' data-type='int' data-ref="mDNSs32" data-ref-filename="mDNSs32">mDNSs32</a> <dfn class="decl def fn" id="udsserver_idle" title='udsserver_idle' data-ref="udsserver_idle" data-ref-filename="udsserver_idle">udsserver_idle</dfn>(<a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSs32" title='mDNSs32' data-type='int' data-ref="mDNSs32" data-ref-filename="mDNSs32">mDNSs32</a> <dfn class="local col7 decl" id="647nextevent" title='nextevent' data-type='mDNSs32' data-ref="647nextevent" data-ref-filename="647nextevent">nextevent</dfn>)</td></tr>
<tr><th id="6164">6164</th><td>{</td></tr>
<tr><th id="6165">6165</th><td>    <a class="typedef" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSs32" title='mDNSs32' data-type='int' data-ref="mDNSs32" data-ref-filename="mDNSs32">mDNSs32</a> <dfn class="local col8 decl" id="648now" title='now' data-type='mDNSs32' data-ref="648now" data-ref-filename="648now">now</dfn> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_TimeNow" title='mDNS_TimeNow' data-ref="mDNS_TimeNow" data-ref-filename="mDNS_TimeNow">mDNS_TimeNow</a>(&amp;<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>);</td></tr>
<tr><th id="6166">6166</th><td>    <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> **<dfn class="local col9 decl" id="649req" title='req' data-type='request_state **' data-ref="649req" data-ref-filename="649req">req</dfn> = &amp;<a class="tu ref" href="#all_requests" title='all_requests' data-use='a' data-ref="all_requests" data-ref-filename="all_requests">all_requests</a>;</td></tr>
<tr><th id="6167">6167</th><td></td></tr>
<tr><th id="6168">6168</th><td>    <b>while</b> (*<a class="local col9 ref" href="#649req" title='req' data-ref="649req" data-ref-filename="649req">req</a>)</td></tr>
<tr><th id="6169">6169</th><td>    {</td></tr>
<tr><th id="6170">6170</th><td>        <a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a> *<em>const</em> <dfn class="local col0 decl" id="650r" title='r' data-type='request_state *const' data-ref="650r" data-ref-filename="650r">r</dfn> = *<a class="local col9 ref" href="#649req" title='req' data-ref="649req" data-ref-filename="649req">req</a>;</td></tr>
<tr><th id="6171">6171</th><td></td></tr>
<tr><th id="6172">6172</th><td>        <b>if</b> (<a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::terminate" title='request_state::terminate' data-ref="request_state::terminate" data-ref-filename="request_state..terminate">terminate</a> == <a class="ref fn" href="#resolve_termination_callback" title='resolve_termination_callback' data-ref="resolve_termination_callback" data-ref-filename="resolve_termination_callback">resolve_termination_callback</a>)</td></tr>
<tr><th id="6173">6173</th><td>            <b>if</b> (<a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::ReportTime" title='request_state::(anonymous union)::(anonymous struct)::ReportTime' data-ref="request_state::(anonymousunion)::(anonymous)::ReportTime" data-ref-filename="request_state..(anonymousunion)..(anonymous)..ReportTime">ReportTime</a> &amp;&amp; <a class="local col8 ref" href="#648now" title='now' data-ref="648now" data-ref-filename="648now">now</a> - <a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::ReportTime" title='request_state::(anonymous union)::(anonymous struct)::ReportTime' data-ref="request_state::(anonymousunion)::(anonymous)::ReportTime" data-ref-filename="request_state..(anonymousunion)..(anonymous)..ReportTime">ReportTime</a> &gt;= <var>0</var>)</td></tr>
<tr><th id="6174">6174</th><td>            {</td></tr>
<tr><th id="6175">6175</th><td>                <a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::ReportTime" title='request_state::(anonymous union)::(anonymous struct)::ReportTime' data-ref="request_state::(anonymousunion)::(anonymous)::ReportTime" data-ref-filename="request_state..(anonymousunion)..(anonymous)..ReportTime">ReportTime</a> = <var>0</var>;</td></tr>
<tr><th id="6176">6176</th><td>                <i>// if client received results and resolve still active</i></td></tr>
<tr><th id="6177">6177</th><td>                <b>if</b> (<a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::txt" title='request_state::(anonymous union)::(anonymous struct)::txt' data-ref="request_state::(anonymousunion)::(anonymous)::txt" data-ref-filename="request_state..(anonymousunion)..(anonymous)..txt">txt</a> &amp;&amp; <a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::srv" title='request_state::(anonymous union)::(anonymous struct)::srv' data-ref="request_state::(anonymousunion)::(anonymous)::srv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..srv">srv</a>)</td></tr>
<tr><th id="6178">6178</th><td>                    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#151" title="LogMsg" data-ref="_M/LogMsgNoIdent">LogMsgNoIdent</a>(<q>"Client application PID[%d](%s) has received results for DNSServiceResolve(%##s) yet remains active over two minutes."</q>, <a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>, <a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::u" title='request_state::u' data-ref="request_state::u" data-ref-filename="request_state..u">u</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymous)::resolve" title='request_state::(anonymous union)::resolve' data-ref="request_state::(anonymous)::resolve" data-ref-filename="request_state..(anonymous)..resolve">resolve</a>.<a class="ref field" href="uds_daemon.h.html#request_state::(anonymousunion)::(anonymous)::qsrv" title='request_state::(anonymous union)::(anonymous struct)::qsrv' data-ref="request_state::(anonymousunion)::(anonymous)::qsrv" data-ref-filename="request_state..(anonymousunion)..(anonymous)..qsrv">qsrv</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#DNSQuestion_struct::qname" title='DNSQuestion_struct::qname' data-ref="DNSQuestion_struct::qname" data-ref-filename="DNSQuestion_struct..qname">qname</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#(anonymous)::c" title='(anonymous struct)::c' data-ref="(anonymous)::c" data-ref-filename="(anonymous)..c">c</a>);</td></tr>
<tr><th id="6179">6179</th><td>            }</td></tr>
<tr><th id="6180">6180</th><td></td></tr>
<tr><th id="6181">6181</th><td>        <i>// Note: Only primary req's have reply lists, not subordinate req's.</i></td></tr>
<tr><th id="6182">6182</th><td>        <b>while</b> (<a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::replies" title='request_state::replies' data-ref="request_state::replies" data-ref-filename="request_state..replies">replies</a>)      <i>// Send queued replies</i></td></tr>
<tr><th id="6183">6183</th><td>        {</td></tr>
<tr><th id="6184">6184</th><td>            <a class="typedef" href="uds_daemon.h.html#transfer_state" title='transfer_state' data-type='enum transfer_state' data-ref="transfer_state" data-ref-filename="transfer_state">transfer_state</a> <dfn class="local col1 decl" id="651result" title='result' data-type='transfer_state' data-ref="651result" data-ref-filename="651result">result</dfn>;</td></tr>
<tr><th id="6185">6185</th><td>            <b>if</b> (<a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::replies" title='request_state::replies' data-ref="request_state::replies" data-ref-filename="request_state..replies">replies</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::next" title='reply_state::next' data-ref="reply_state::next" data-ref-filename="reply_state..next">next</a>)</td></tr>
<tr><th id="6186">6186</th><td>                <a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::replies" title='request_state::replies' data-ref="request_state::replies" data-ref-filename="request_state..replies">replies</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::rhdr" title='reply_state::rhdr' data-ref="reply_state::rhdr" data-ref-filename="reply_state..rhdr">rhdr</a>-&gt;<a class="ref field" href="uds_daemon.h.html#(anonymous)::flags" title='(anonymous struct)::flags' data-ref="(anonymous)::flags" data-ref-filename="(anonymous)..flags">flags</a> |= <a class="ref fn" href="#dnssd_htonl" title='dnssd_htonl' data-ref="dnssd_htonl" data-ref-filename="dnssd_htonl">dnssd_htonl</a>(<a class="enum" href="dns_sd.h.html#kDNSServiceFlagsMoreComing" title='kDNSServiceFlagsMoreComing' data-ref="kDNSServiceFlagsMoreComing" data-ref-filename="kDNSServiceFlagsMoreComing">kDNSServiceFlagsMoreComing</a>);</td></tr>
<tr><th id="6187">6187</th><td>            <a class="local col1 ref" href="#651result" title='result' data-ref="651result" data-ref-filename="651result">result</a> = <a class="ref fn" href="#send_msg" title='send_msg' data-ref="send_msg" data-ref-filename="send_msg">send_msg</a>(<a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>);   <i>// Returns t_morecoming if buffer full because client is not reading</i></td></tr>
<tr><th id="6188">6188</th><td>            <b>if</b> (<a class="local col1 ref" href="#651result" title='result' data-ref="651result" data-ref-filename="651result">result</a> == <a class="enum" href="uds_daemon.h.html#t_complete" title='t_complete' data-ref="t_complete" data-ref-filename="t_complete">t_complete</a>)</td></tr>
<tr><th id="6189">6189</th><td>            {</td></tr>
<tr><th id="6190">6190</th><td>                <a class="typedef" href="uds_daemon.h.html#reply_state" title='reply_state' data-type='struct reply_state' data-ref="reply_state" data-ref-filename="reply_state">reply_state</a> *<dfn class="local col2 decl" id="652fptr" title='fptr' data-type='reply_state *' data-ref="652fptr" data-ref-filename="652fptr">fptr</dfn> = <a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::replies" title='request_state::replies' data-ref="request_state::replies" data-ref-filename="request_state..replies">replies</a>;</td></tr>
<tr><th id="6191">6191</th><td>                <a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::replies" title='request_state::replies' data-ref="request_state::replies" data-ref-filename="request_state..replies">replies</a> = <a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::replies" title='request_state::replies' data-ref="request_state::replies" data-ref-filename="request_state..replies">replies</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::next" title='reply_state::next' data-ref="reply_state::next" data-ref-filename="reply_state..next">next</a>;</td></tr>
<tr><th id="6192">6192</th><td>                <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(fptr)" data-ref="_M/freeL">freeL</a>(<q>"reply_state/udsserver_idle"</q>, <a class="local col2 ref" href="#652fptr" title='fptr' data-ref="652fptr" data-ref-filename="652fptr">fptr</a>);</td></tr>
<tr><th id="6193">6193</th><td>                <a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::time_blocked" title='request_state::time_blocked' data-ref="request_state::time_blocked" data-ref-filename="request_state..time_blocked">time_blocked</a> = <var>0</var>; <i>// reset failure counter after successful send</i></td></tr>
<tr><th id="6194">6194</th><td>                <a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::unresponsiveness_reports" title='request_state::unresponsiveness_reports' data-ref="request_state::unresponsiveness_reports" data-ref-filename="request_state..unresponsiveness_reports">unresponsiveness_reports</a> = <var>0</var>;</td></tr>
<tr><th id="6195">6195</th><td>                <b>continue</b>;</td></tr>
<tr><th id="6196">6196</th><td>            }</td></tr>
<tr><th id="6197">6197</th><td>            <b>else</b> <b>if</b> (<a class="local col1 ref" href="#651result" title='result' data-ref="651result" data-ref-filename="651result">result</a> == <a class="enum" href="uds_daemon.h.html#t_terminated" title='t_terminated' data-ref="t_terminated" data-ref-filename="t_terminated">t_terminated</a>)</td></tr>
<tr><th id="6198">6198</th><td>            {</td></tr>
<tr><th id="6199">6199</th><td>                <a class="macro" href="../mDNSCore/mDNSDebug.h.html#103" title="do { if (mDNS_LoggingEnabled) LogMsgWithLevel(MDNS_LOG_INFO, &quot;%3d: Could not write data to client PID[%d](%s) because connection is terminated by the client&quot;, r-&gt;sd, r-&gt;process_id, r-&gt;pid_name);} while (0)" data-ref="_M/LogInfo">LogInfo</a>(<q>"%3d: Could not write data to client PID[%d](%s) because connection is terminated by the client"</q>, <a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="6200">6200</th><td>                <a class="ref fn" href="#abort_request" title='abort_request' data-ref="abort_request" data-ref-filename="abort_request">abort_request</a>(<a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>);</td></tr>
<tr><th id="6201">6201</th><td>            }</td></tr>
<tr><th id="6202">6202</th><td>            <b>else</b> <b>if</b> (<a class="local col1 ref" href="#651result" title='result' data-ref="651result" data-ref-filename="651result">result</a> == <a class="enum" href="uds_daemon.h.html#t_error" title='t_error' data-ref="t_error" data-ref-filename="t_error">t_error</a>)</td></tr>
<tr><th id="6203">6203</th><td>            {</td></tr>
<tr><th id="6204">6204</th><td>                <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: Could not write data to client PID[%d](%s) because of error - aborting connection&quot;, r-&gt;sd, r-&gt;process_id, r-&gt;pid_name)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: Could not write data to client PID[%d](%s) because of error - aborting connection"</q>, <a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="6205">6205</th><td>                <a class="ref fn" href="#LogClientInfo" title='LogClientInfo' data-ref="LogClientInfo" data-ref-filename="LogClientInfo">LogClientInfo</a>(<a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>);</td></tr>
<tr><th id="6206">6206</th><td>                <a class="ref fn" href="#abort_request" title='abort_request' data-ref="abort_request" data-ref-filename="abort_request">abort_request</a>(<a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>);</td></tr>
<tr><th id="6207">6207</th><td>            }</td></tr>
<tr><th id="6208">6208</th><td>            <b>break</b>;</td></tr>
<tr><th id="6209">6209</th><td>        }</td></tr>
<tr><th id="6210">6210</th><td></td></tr>
<tr><th id="6211">6211</th><td>        <b>if</b> (<a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::replies" title='request_state::replies' data-ref="request_state::replies" data-ref-filename="request_state..replies">replies</a>)     <i>// If we failed to send everything, check our time_blocked timer</i></td></tr>
<tr><th id="6212">6212</th><td>        {</td></tr>
<tr><th id="6213">6213</th><td>            <b>if</b> (<a class="local col7 ref" href="#647nextevent" title='nextevent' data-ref="647nextevent" data-ref-filename="647nextevent">nextevent</a> - <a class="local col8 ref" href="#648now" title='now' data-ref="648now" data-ref-filename="648now">now</a> &gt; <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformOneSecond" title='mDNSPlatformOneSecond' data-ref="mDNSPlatformOneSecond" data-ref-filename="mDNSPlatformOneSecond">mDNSPlatformOneSecond</a>)</td></tr>
<tr><th id="6214">6214</th><td>                <a class="local col7 ref" href="#647nextevent" title='nextevent' data-ref="647nextevent" data-ref-filename="647nextevent">nextevent</a> = <a class="local col8 ref" href="#648now" title='now' data-ref="648now" data-ref-filename="648now">now</a> + <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformOneSecond" title='mDNSPlatformOneSecond' data-ref="mDNSPlatformOneSecond" data-ref-filename="mDNSPlatformOneSecond">mDNSPlatformOneSecond</a>;</td></tr>
<tr><th id="6215">6215</th><td></td></tr>
<tr><th id="6216">6216</th><td>            <b>if</b> (<a class="ref" href="uds_daemon.h.html#mDNSStorage" title='mDNSStorage' data-ref="mDNSStorage" data-ref-filename="mDNSStorage">mDNSStorage</a>.<a class="ref field" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNS_struct::SleepState" title='mDNS_struct::SleepState' data-ref="mDNS_struct::SleepState" data-ref-filename="mDNS_struct..SleepState">SleepState</a> != <a class="enum" href="../mDNSCore/mDNSEmbeddedAPI.h.html#SleepState_Awake" title='SleepState_Awake' data-ref="SleepState_Awake" data-ref-filename="SleepState_Awake">SleepState_Awake</a>)</td></tr>
<tr><th id="6217">6217</th><td>                <a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::time_blocked" title='request_state::time_blocked' data-ref="request_state::time_blocked" data-ref-filename="request_state..time_blocked">time_blocked</a> = <var>0</var>;</td></tr>
<tr><th id="6218">6218</th><td>            <b>else</b> <b>if</b> (!<a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::time_blocked" title='request_state::time_blocked' data-ref="request_state::time_blocked" data-ref-filename="request_state..time_blocked">time_blocked</a>)</td></tr>
<tr><th id="6219">6219</th><td>                <a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::time_blocked" title='request_state::time_blocked' data-ref="request_state::time_blocked" data-ref-filename="request_state..time_blocked">time_blocked</a> = <a class="ref fn" href="../mDNSCore/mDNSEmbeddedAPI.h.html#NonZeroTime" title='NonZeroTime' data-ref="NonZeroTime" data-ref-filename="NonZeroTime">NonZeroTime</a>(<a class="local col8 ref" href="#648now" title='now' data-ref="648now" data-ref-filename="648now">now</a>);</td></tr>
<tr><th id="6220">6220</th><td>            <b>else</b> <b>if</b> (<a class="local col8 ref" href="#648now" title='now' data-ref="648now" data-ref-filename="648now">now</a> - <a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::time_blocked" title='request_state::time_blocked' data-ref="request_state::time_blocked" data-ref-filename="request_state..time_blocked">time_blocked</a> &gt;= <var>10</var> * <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformOneSecond" title='mDNSPlatformOneSecond' data-ref="mDNSPlatformOneSecond" data-ref-filename="mDNSPlatformOneSecond">mDNSPlatformOneSecond</a> * (<a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::unresponsiveness_reports" title='request_state::unresponsiveness_reports' data-ref="request_state::unresponsiveness_reports" data-ref-filename="request_state..unresponsiveness_reports">unresponsiveness_reports</a>+<var>1</var>))</td></tr>
<tr><th id="6221">6221</th><td>            {</td></tr>
<tr><th id="6222">6222</th><td>                <em>int</em> <dfn class="local col3 decl" id="653num" title='num' data-type='int' data-ref="653num" data-ref-filename="653num">num</dfn> = <var>0</var>;</td></tr>
<tr><th id="6223">6223</th><td>                <b>struct</b> <a class="type" href="uds_daemon.h.html#reply_state" title='reply_state' data-ref="reply_state" data-ref-filename="reply_state">reply_state</a> *<dfn class="local col4 decl" id="654x" title='x' data-type='struct reply_state *' data-ref="654x" data-ref-filename="654x">x</dfn> = <a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::replies" title='request_state::replies' data-ref="request_state::replies" data-ref-filename="request_state..replies">replies</a>;</td></tr>
<tr><th id="6224">6224</th><td>                <b>while</b> (<a class="local col4 ref" href="#654x" title='x' data-ref="654x" data-ref-filename="654x">x</a>)</td></tr>
<tr><th id="6225">6225</th><td>                {</td></tr>
<tr><th id="6226">6226</th><td>                    <a class="local col3 ref" href="#653num" title='num' data-ref="653num" data-ref-filename="653num">num</a>++;</td></tr>
<tr><th id="6227">6227</th><td>                    <a class="local col4 ref" href="#654x" title='x' data-ref="654x" data-ref-filename="654x">x</a>=<a class="local col4 ref" href="#654x" title='x' data-ref="654x" data-ref-filename="654x">x</a>-&gt;<a class="ref field" href="uds_daemon.h.html#reply_state::next" title='reply_state::next' data-ref="reply_state::next" data-ref-filename="reply_state..next">next</a>;</td></tr>
<tr><th id="6228">6228</th><td>                }</td></tr>
<tr><th id="6229">6229</th><td>                <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: Could not write data to client PID[%d](%s) after %ld seconds, %d repl%s waiting&quot;, r-&gt;sd, r-&gt;process_id, r-&gt;pid_name, (now - r-&gt;time_blocked) / mDNSPlatformOneSecond, num, num == 1 ? &quot;y&quot; : &quot;ies&quot;)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: Could not write data to client PID[%d](%s) after %ld seconds, %d repl%s waiting"</q>,</td></tr>
<tr><th id="6230">6230</th><td>                       <a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>, (<a class="local col8 ref" href="#648now" title='now' data-ref="648now" data-ref-filename="648now">now</a> - <a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::time_blocked" title='request_state::time_blocked' data-ref="request_state::time_blocked" data-ref-filename="request_state..time_blocked">time_blocked</a>) / <a class="ref" href="../mDNSCore/mDNSEmbeddedAPI.h.html#mDNSPlatformOneSecond" title='mDNSPlatformOneSecond' data-ref="mDNSPlatformOneSecond" data-ref-filename="mDNSPlatformOneSecond">mDNSPlatformOneSecond</a>, <a class="local col3 ref" href="#653num" title='num' data-ref="653num" data-ref-filename="653num">num</a>, <a class="local col3 ref" href="#653num" title='num' data-ref="653num" data-ref-filename="653num">num</a> == <var>1</var> ? <q>"y"</q> : <q>"ies"</q>);</td></tr>
<tr><th id="6231">6231</th><td>                <b>if</b> (++<a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::unresponsiveness_reports" title='request_state::unresponsiveness_reports' data-ref="request_state::unresponsiveness_reports" data-ref-filename="request_state..unresponsiveness_reports">unresponsiveness_reports</a> &gt;= <var>60</var>)</td></tr>
<tr><th id="6232">6232</th><td>                {</td></tr>
<tr><th id="6233">6233</th><td>                    <a class="macro" href="../mDNSCore/mDNSDebug.h.html#100" title="LogMsgWithLevel(MDNS_LOG_MSG, &quot;%3d: Client PID[%d](%s) unresponsive; aborting connection&quot;, r-&gt;sd, r-&gt;process_id, r-&gt;pid_name)" data-ref="_M/LogMsg">LogMsg</a>(<q>"%3d: Client PID[%d](%s) unresponsive; aborting connection"</q>, <a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>, <a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::process_id" title='request_state::process_id' data-ref="request_state::process_id" data-ref-filename="request_state..process_id">process_id</a>, <a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::pid_name" title='request_state::pid_name' data-ref="request_state::pid_name" data-ref-filename="request_state..pid_name">pid_name</a>);</td></tr>
<tr><th id="6234">6234</th><td>                    <a class="ref fn" href="#LogClientInfo" title='LogClientInfo' data-ref="LogClientInfo" data-ref-filename="LogClientInfo">LogClientInfo</a>(<a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>);</td></tr>
<tr><th id="6235">6235</th><td>                    <a class="ref fn" href="#abort_request" title='abort_request' data-ref="abort_request" data-ref-filename="abort_request">abort_request</a>(<a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>);</td></tr>
<tr><th id="6236">6236</th><td>                }</td></tr>
<tr><th id="6237">6237</th><td>            }</td></tr>
<tr><th id="6238">6238</th><td>        }</td></tr>
<tr><th id="6239">6239</th><td></td></tr>
<tr><th id="6240">6240</th><td>        <b>if</b> (!<a class="macro" href="dnssd_ipc.h.html#64" title="((r-&gt;sd) &gt;= 0)" data-ref="_M/dnssd_SocketValid">dnssd_SocketValid</a>(<a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::sd" title='request_state::sd' data-ref="request_state::sd" data-ref-filename="request_state..sd">sd</a>)) <i>// If this request is finished, unlink it from the list and free the memory</i></td></tr>
<tr><th id="6241">6241</th><td>        {</td></tr>
<tr><th id="6242">6242</th><td>            <i>// Since we're already doing a list traversal, we unlink the request directly instead of using AbortUnlinkAndFree()</i></td></tr>
<tr><th id="6243">6243</th><td>            *<a class="local col9 ref" href="#649req" title='req' data-ref="649req" data-ref-filename="649req">req</a> = <a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::next" title='request_state::next' data-ref="request_state::next" data-ref-filename="request_state..next">next</a>;</td></tr>
<tr><th id="6244">6244</th><td>            <a class="macro" href="../mDNSCore/mDNSDebug.h.html#167" title="free(r)" data-ref="_M/freeL">freeL</a>(<q>"request_state/udsserver_idle"</q>, <a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>);</td></tr>
<tr><th id="6245">6245</th><td>        }</td></tr>
<tr><th id="6246">6246</th><td>        <b>else</b></td></tr>
<tr><th id="6247">6247</th><td>            <a class="local col9 ref" href="#649req" title='req' data-ref="649req" data-ref-filename="649req">req</a> = &amp;<a class="local col0 ref" href="#650r" title='r' data-ref="650r" data-ref-filename="650r">r</a>-&gt;<a class="ref field" href="uds_daemon.h.html#request_state::next" title='request_state::next' data-ref="request_state::next" data-ref-filename="request_state..next">next</a>;</td></tr>
<tr><th id="6248">6248</th><td>    }</td></tr>
<tr><th id="6249">6249</th><td>    <b>return</b> <a class="local col7 ref" href="#647nextevent" title='nextevent' data-ref="647nextevent" data-ref-filename="647nextevent">nextevent</a>;</td></tr>
<tr><th id="6250">6250</th><td>}</td></tr>
<tr><th id="6251">6251</th><td></td></tr>
<tr><th id="6252">6252</th><td><b>struct</b> <dfn class="type def" id="CompileTimeAssertionChecks_uds_daemon" title='CompileTimeAssertionChecks_uds_daemon' data-ref="CompileTimeAssertionChecks_uds_daemon" data-ref-filename="CompileTimeAssertionChecks_uds_daemon">CompileTimeAssertionChecks_uds_daemon</dfn></td></tr>
<tr><th id="6253">6253</th><td>{</td></tr>
<tr><th id="6254">6254</th><td>    <i  data-doc="CompileTimeAssertionChecks_uds_daemon::sizecheck_request_state">// Check our structures are reasonable sizes. Including overly-large buffers, or embedding</i></td></tr>
<tr><th id="6255">6255</th><td><i  data-doc="CompileTimeAssertionChecks_uds_daemon::sizecheck_request_state">    // other overly-large structures instead of having a pointer to them, can inadvertently</i></td></tr>
<tr><th id="6256">6256</th><td><i  data-doc="CompileTimeAssertionChecks_uds_daemon::sizecheck_request_state">    // cause structure sizes (and therefore memory usage) to balloon unreasonably.</i></td></tr>
<tr><th id="6257">6257</th><td>    <em>char</em> <dfn class="tu decl field" id="CompileTimeAssertionChecks_uds_daemon::sizecheck_request_state" title='CompileTimeAssertionChecks_uds_daemon::sizecheck_request_state' data-type='char [1]' data-ref="CompileTimeAssertionChecks_uds_daemon::sizecheck_request_state" data-ref-filename="CompileTimeAssertionChecks_uds_daemon..sizecheck_request_state">sizecheck_request_state</dfn>          [(<b>sizeof</b>(<a class="typedef" href="uds_daemon.h.html#request_state" title='request_state' data-type='struct request_state' data-ref="request_state" data-ref-filename="request_state">request_state</a>)           &lt;= <var>2954</var>) ? <var>1</var> : -<var>1</var>];</td></tr>
<tr><th id="6258">6258</th><td>    <em>char</em> <dfn class="tu decl field" id="CompileTimeAssertionChecks_uds_daemon::sizecheck_registered_record_entry" title='CompileTimeAssertionChecks_uds_daemon::sizecheck_registered_record_entry' data-type='char [1]' data-ref="CompileTimeAssertionChecks_uds_daemon::sizecheck_registered_record_entry" data-ref-filename="CompileTimeAssertionChecks_uds_daemon..sizecheck_registered_record_entry">sizecheck_registered_record_entry</dfn>[(<b>sizeof</b>(<a class="typedef" href="uds_daemon.h.html#registered_record_entry" title='registered_record_entry' data-type='struct registered_record_entry' data-ref="registered_record_entry" data-ref-filename="registered_record_entry">registered_record_entry</a>) &lt;=   <var>60</var>) ? <var>1</var> : -<var>1</var>];</td></tr>
<tr><th id="6259">6259</th><td>    <em>char</em> <dfn class="tu decl field" id="CompileTimeAssertionChecks_uds_daemon::sizecheck_service_instance" title='CompileTimeAssertionChecks_uds_daemon::sizecheck_service_instance' data-type='char [1]' data-ref="CompileTimeAssertionChecks_uds_daemon::sizecheck_service_instance" data-ref-filename="CompileTimeAssertionChecks_uds_daemon..sizecheck_service_instance">sizecheck_service_instance</dfn>       [(<b>sizeof</b>(<a class="typedef" href="uds_daemon.h.html#service_instance" title='service_instance' data-type='struct service_instance' data-ref="service_instance" data-ref-filename="service_instance">service_instance</a>)        &lt;= <var>6552</var>) ? <var>1</var> : -<var>1</var>];</td></tr>
<tr><th id="6260">6260</th><td>    <em>char</em> <dfn class="tu decl field" id="CompileTimeAssertionChecks_uds_daemon::sizecheck_browser_t" title='CompileTimeAssertionChecks_uds_daemon::sizecheck_browser_t' data-type='char [1]' data-ref="CompileTimeAssertionChecks_uds_daemon::sizecheck_browser_t" data-ref-filename="CompileTimeAssertionChecks_uds_daemon..sizecheck_browser_t">sizecheck_browser_t</dfn>              [(<b>sizeof</b>(<a class="typedef" href="uds_daemon.h.html#browser_t" title='browser_t' data-type='struct browser_t' data-ref="browser_t" data-ref-filename="browser_t">browser_t</a>)               &lt;= <var>1202</var>) ? <var>1</var> : -<var>1</var>];</td></tr>
<tr><th id="6261">6261</th><td>    <em>char</em> <dfn class="tu decl field" id="CompileTimeAssertionChecks_uds_daemon::sizecheck_reply_hdr" title='CompileTimeAssertionChecks_uds_daemon::sizecheck_reply_hdr' data-type='char [1]' data-ref="CompileTimeAssertionChecks_uds_daemon::sizecheck_reply_hdr" data-ref-filename="CompileTimeAssertionChecks_uds_daemon..sizecheck_reply_hdr">sizecheck_reply_hdr</dfn>              [(<b>sizeof</b>(<a class="typedef" href="uds_daemon.h.html#reply_hdr" title='reply_hdr' data-type='struct reply_hdr' data-ref="reply_hdr" data-ref-filename="reply_hdr">reply_hdr</a>)               &lt;=   <var>12</var>) ? <var>1</var> : -<var>1</var>];</td></tr>
<tr><th id="6262">6262</th><td>    <em>char</em> <dfn class="tu decl field" id="CompileTimeAssertionChecks_uds_daemon::sizecheck_reply_state" title='CompileTimeAssertionChecks_uds_daemon::sizecheck_reply_state' data-type='char [1]' data-ref="CompileTimeAssertionChecks_uds_daemon::sizecheck_reply_state" data-ref-filename="CompileTimeAssertionChecks_uds_daemon..sizecheck_reply_state">sizecheck_reply_state</dfn>            [(<b>sizeof</b>(<a class="typedef" href="uds_daemon.h.html#reply_state" title='reply_state' data-type='struct reply_state' data-ref="reply_state" data-ref-filename="reply_state">reply_state</a>)             &lt;=   <var>64</var>) ? <var>1</var> : -<var>1</var>];</td></tr>
<tr><th id="6263">6263</th><td>};</td></tr>
<tr><th id="6264">6264</th><td></td></tr>
<tr><th id="6265">6265</th><td><u>#<span data-ppcond="6265">ifdef</span> <span class="macro" data-ref="_M/UNIT_TEST">UNIT_TEST</span></u></td></tr>
<tr><th id="6266">6266</th><td><u>#include "../unittests/uds_daemon_ut.c"</u></td></tr>
<tr><th id="6267">6267</th><td><u>#<span data-ppcond="6265">endif</span>  //  UNIT_TEST</u></td></tr>
<tr><th id="6268">6268</th><td></td></tr>
</table><hr/><p id='footer'>
Generated on <em>2019-Jul-19</em> from project netbsd revision <em>f9da89e0d</em><br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 2.1
<br/>Generator usage only permitted with license.</p>
</div></body></html>
