<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>authzone.c source code [netbsd/external/bsd/unbound/dist/services/authzone.c] - Woboq Code Browser</title>
<link rel="stylesheet" href="https://code.woboq.org/data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="https://code.woboq.org/data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="https://code.woboq.org/data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="https://code.woboq.org/data/jquery/jquery-ui.min.js"></script>
<script>var file = 'netbsd/external/bsd/unbound/dist/services/authzone.c'; var root_path = '../../../../../..'; var data_path = 'https://code.woboq.org/data'; var ecma_script_api_version = 2;</script>
<script src='https://code.woboq.org/data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='../../../../..'>netbsd</a>/<a href='../../../..'>external</a>/<a href='../../..'>bsd</a>/<a href='../..'>unbound</a>/<a href='..'>dist</a>/<a href='./'>services</a>/<a href='authzone.c.html'>authzone.c</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>/*</i></td></tr>
<tr><th id="2">2</th><td><i> * services/authzone.c - authoritative zone that is locally hosted.</i></td></tr>
<tr><th id="3">3</th><td><i> *</i></td></tr>
<tr><th id="4">4</th><td><i> * Copyright (c) 2017, NLnet Labs. All rights reserved.</i></td></tr>
<tr><th id="5">5</th><td><i> *</i></td></tr>
<tr><th id="6">6</th><td><i> * This software is open source.</i></td></tr>
<tr><th id="7">7</th><td><i> * </i></td></tr>
<tr><th id="8">8</th><td><i> * Redistribution and use in source and binary forms, with or without</i></td></tr>
<tr><th id="9">9</th><td><i> * modification, are permitted provided that the following conditions</i></td></tr>
<tr><th id="10">10</th><td><i> * are met:</i></td></tr>
<tr><th id="11">11</th><td><i> * </i></td></tr>
<tr><th id="12">12</th><td><i> * Redistributions of source code must retain the above copyright notice,</i></td></tr>
<tr><th id="13">13</th><td><i> * this list of conditions and the following disclaimer.</i></td></tr>
<tr><th id="14">14</th><td><i> * </i></td></tr>
<tr><th id="15">15</th><td><i> * Redistributions in binary form must reproduce the above copyright notice,</i></td></tr>
<tr><th id="16">16</th><td><i> * this list of conditions and the following disclaimer in the documentation</i></td></tr>
<tr><th id="17">17</th><td><i> * and/or other materials provided with the distribution.</i></td></tr>
<tr><th id="18">18</th><td><i> * </i></td></tr>
<tr><th id="19">19</th><td><i> * Neither the name of the NLNET LABS nor the names of its contributors may</i></td></tr>
<tr><th id="20">20</th><td><i> * be used to endorse or promote products derived from this software without</i></td></tr>
<tr><th id="21">21</th><td><i> * specific prior written permission.</i></td></tr>
<tr><th id="22">22</th><td><i> * </i></td></tr>
<tr><th id="23">23</th><td><i> * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</i></td></tr>
<tr><th id="24">24</th><td><i> * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</i></td></tr>
<tr><th id="25">25</th><td><i> * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</i></td></tr>
<tr><th id="26">26</th><td><i> * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</i></td></tr>
<tr><th id="27">27</th><td><i> * HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</i></td></tr>
<tr><th id="28">28</th><td><i> * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED</i></td></tr>
<tr><th id="29">29</th><td><i> * TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR</i></td></tr>
<tr><th id="30">30</th><td><i> * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF</i></td></tr>
<tr><th id="31">31</th><td><i> * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING</i></td></tr>
<tr><th id="32">32</th><td><i> * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS</i></td></tr>
<tr><th id="33">33</th><td><i> * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</i></td></tr>
<tr><th id="34">34</th><td><i> */</i></td></tr>
<tr><th id="35">35</th><td></td></tr>
<tr><th id="36">36</th><td><i class="doc">/**</i></td></tr>
<tr><th id="37">37</th><td><i class="doc"> *<span class="command"> \file</span></i></td></tr>
<tr><th id="38">38</th><td><i class="doc"> *</i></td></tr>
<tr><th id="39">39</th><td><i class="doc"> * This file contains the functions for an authority zone.  This zone</i></td></tr>
<tr><th id="40">40</th><td><i class="doc"> * is queried by the iterator, just like a stub or forward zone, but then</i></td></tr>
<tr><th id="41">41</th><td><i class="doc"> * the data is locally held.</i></td></tr>
<tr><th id="42">42</th><td><i class="doc"> */</i></td></tr>
<tr><th id="43">43</th><td></td></tr>
<tr><th id="44">44</th><td><u>#include <a href="../../include/config.h.html">"config.h"</a></u></td></tr>
<tr><th id="45">45</th><td><u>#include <a href="authzone.h.html">"services/authzone.h"</a></u></td></tr>
<tr><th id="46">46</th><td><u>#include <a href="../util/data/dname.h.html">"util/data/dname.h"</a></u></td></tr>
<tr><th id="47">47</th><td><u>#include <a href="../util/data/msgparse.h.html">"util/data/msgparse.h"</a></u></td></tr>
<tr><th id="48">48</th><td><u>#include <a href="../util/data/msgreply.h.html">"util/data/msgreply.h"</a></u></td></tr>
<tr><th id="49">49</th><td><u>#include <a href="../util/data/msgencode.h.html">"util/data/msgencode.h"</a></u></td></tr>
<tr><th id="50">50</th><td><u>#include <a href="../util/data/packed_rrset.h.html">"util/data/packed_rrset.h"</a></u></td></tr>
<tr><th id="51">51</th><td><u>#include <a href="../util/regional.h.html">"util/regional.h"</a></u></td></tr>
<tr><th id="52">52</th><td><u>#include <a href="../util/net_help.h.html">"util/net_help.h"</a></u></td></tr>
<tr><th id="53">53</th><td><u>#include <a href="../util/netevent.h.html">"util/netevent.h"</a></u></td></tr>
<tr><th id="54">54</th><td><u>#include <a href="../util/config_file.h.html">"util/config_file.h"</a></u></td></tr>
<tr><th id="55">55</th><td><u>#include <a href="../util/log.h.html">"util/log.h"</a></u></td></tr>
<tr><th id="56">56</th><td><u>#include <a href="../util/module.h.html">"util/module.h"</a></u></td></tr>
<tr><th id="57">57</th><td><u>#include <a href="../util/random.h.html">"util/random.h"</a></u></td></tr>
<tr><th id="58">58</th><td><u>#include <a href="cache/dns.h.html">"services/cache/dns.h"</a></u></td></tr>
<tr><th id="59">59</th><td><u>#include <a href="outside_network.h.html">"services/outside_network.h"</a></u></td></tr>
<tr><th id="60">60</th><td><u>#include <a href="listen_dnsport.h.html">"services/listen_dnsport.h"</a></u></td></tr>
<tr><th id="61">61</th><td><u>#include <a href="mesh.h.html">"services/mesh.h"</a></u></td></tr>
<tr><th id="62">62</th><td><u>#include <a href="../sldns/rrdef.h.html">"sldns/rrdef.h"</a></u></td></tr>
<tr><th id="63">63</th><td><u>#include <a href="../sldns/pkthdr.h.html">"sldns/pkthdr.h"</a></u></td></tr>
<tr><th id="64">64</th><td><u>#include <a href="../sldns/sbuffer.h.html">"sldns/sbuffer.h"</a></u></td></tr>
<tr><th id="65">65</th><td><u>#include <a href="../sldns/str2wire.h.html">"sldns/str2wire.h"</a></u></td></tr>
<tr><th id="66">66</th><td><u>#include <a href="../sldns/wire2str.h.html">"sldns/wire2str.h"</a></u></td></tr>
<tr><th id="67">67</th><td><u>#include <a href="../sldns/parseutil.h.html">"sldns/parseutil.h"</a></u></td></tr>
<tr><th id="68">68</th><td><u>#include <a href="../sldns/keyraw.h.html">"sldns/keyraw.h"</a></u></td></tr>
<tr><th id="69">69</th><td><u>#include <a href="../validator/val_nsec3.h.html">"validator/val_nsec3.h"</a></u></td></tr>
<tr><th id="70">70</th><td><u>#include <a href="../validator/val_secalgo.h.html">"validator/val_secalgo.h"</a></u></td></tr>
<tr><th id="71">71</th><td><u>#include <a href="../../../../../objdir.amd64/destdir.amd64/usr/include/ctype.h.html">&lt;ctype.h&gt;</a></u></td></tr>
<tr><th id="72">72</th><td></td></tr>
<tr><th id="73">73</th><td><i class="doc">/** bytes to use for NSEC3 hash buffer. 20 for sha1 */</i></td></tr>
<tr><th id="74">74</th><td><u>#define <dfn class="macro" id="_M/N3HASHBUFLEN" data-ref="_M/N3HASHBUFLEN">N3HASHBUFLEN</dfn> 32</u></td></tr>
<tr><th id="75">75</th><td><i class="doc">/** max number of CNAMEs we are willing to follow (in one answer) */</i></td></tr>
<tr><th id="76">76</th><td><u>#define <dfn class="macro" id="_M/MAX_CNAME_CHAIN" data-ref="_M/MAX_CNAME_CHAIN">MAX_CNAME_CHAIN</dfn> 8</u></td></tr>
<tr><th id="77">77</th><td><i class="doc">/** timeout for probe packets for SOA */</i></td></tr>
<tr><th id="78">78</th><td><u>#define <dfn class="macro" id="_M/AUTH_PROBE_TIMEOUT" data-ref="_M/AUTH_PROBE_TIMEOUT">AUTH_PROBE_TIMEOUT</dfn> 100 /* msec */</u></td></tr>
<tr><th id="79">79</th><td><i class="doc">/** when to stop with SOA probes (when exponential timeouts exceed this) */</i></td></tr>
<tr><th id="80">80</th><td><u>#define <dfn class="macro" id="_M/AUTH_PROBE_TIMEOUT_STOP" data-ref="_M/AUTH_PROBE_TIMEOUT_STOP">AUTH_PROBE_TIMEOUT_STOP</dfn> 1000 /* msec */</u></td></tr>
<tr><th id="81">81</th><td><i>/* auth transfer timeout for TCP connections, in msec */</i></td></tr>
<tr><th id="82">82</th><td><u>#define <dfn class="macro" id="_M/AUTH_TRANSFER_TIMEOUT" data-ref="_M/AUTH_TRANSFER_TIMEOUT">AUTH_TRANSFER_TIMEOUT</dfn> 10000 /* msec */</u></td></tr>
<tr><th id="83">83</th><td><i>/* auth transfer max backoff for failed tranfers and probes */</i></td></tr>
<tr><th id="84">84</th><td><u>#define <dfn class="macro" id="_M/AUTH_TRANSFER_MAX_BACKOFF" data-ref="_M/AUTH_TRANSFER_MAX_BACKOFF">AUTH_TRANSFER_MAX_BACKOFF</dfn> 86400 /* sec */</u></td></tr>
<tr><th id="85">85</th><td><i>/* auth http port number */</i></td></tr>
<tr><th id="86">86</th><td><u>#define <dfn class="macro" id="_M/AUTH_HTTP_PORT" data-ref="_M/AUTH_HTTP_PORT">AUTH_HTTP_PORT</dfn> 80</u></td></tr>
<tr><th id="87">87</th><td><i>/* auth https port number */</i></td></tr>
<tr><th id="88">88</th><td><u>#define <dfn class="macro" id="_M/AUTH_HTTPS_PORT" data-ref="_M/AUTH_HTTPS_PORT">AUTH_HTTPS_PORT</dfn> 443</u></td></tr>
<tr><th id="89">89</th><td><i>/* max depth for nested $INCLUDEs */</i></td></tr>
<tr><th id="90">90</th><td><u>#define <dfn class="macro" id="_M/MAX_INCLUDE_DEPTH" data-ref="_M/MAX_INCLUDE_DEPTH">MAX_INCLUDE_DEPTH</dfn> 10</u></td></tr>
<tr><th id="91">91</th><td><i class="doc">/** number of timeouts before we fallback from IXFR to AXFR,</i></td></tr>
<tr><th id="92">92</th><td><i class="doc"> * because some versions of servers (eg. dnsmasq) drop IXFR packets. */</i></td></tr>
<tr><th id="93">93</th><td><u>#define <dfn class="macro" id="_M/NUM_TIMEOUTS_FALLBACK_IXFR" data-ref="_M/NUM_TIMEOUTS_FALLBACK_IXFR">NUM_TIMEOUTS_FALLBACK_IXFR</dfn> 3</u></td></tr>
<tr><th id="94">94</th><td></td></tr>
<tr><th id="95">95</th><td><i class="doc" data-doc="xfr_set_timeout">/** pick up nextprobe task to start waiting to perform transfer actions */</i></td></tr>
<tr><th id="96">96</th><td><em>static</em> <em>void</em> <a class="tu decl fn" href="#xfr_set_timeout" title='xfr_set_timeout' data-type='void xfr_set_timeout(struct auth_xfer * xfr, struct module_env * env, int failure, int lookup_only)' data-ref="xfr_set_timeout" data-ref-filename="xfr_set_timeout">xfr_set_timeout</a>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col2 decl" id="182xfr" title='xfr' data-type='struct auth_xfer *' data-ref="182xfr" data-ref-filename="182xfr">xfr</dfn>, <b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col3 decl" id="183env" title='env' data-type='struct module_env *' data-ref="183env" data-ref-filename="183env">env</dfn>,</td></tr>
<tr><th id="97">97</th><td>	<em>int</em> <dfn class="local col4 decl" id="184failure" title='failure' data-type='int' data-ref="184failure" data-ref-filename="184failure">failure</dfn>, <em>int</em> <dfn class="local col5 decl" id="185lookup_only" title='lookup_only' data-type='int' data-ref="185lookup_only" data-ref-filename="185lookup_only">lookup_only</dfn>);</td></tr>
<tr><th id="98">98</th><td><i class="doc" data-doc="xfr_probe_send_or_end">/** move to sending the probe packets, next if fails. task_probe */</i></td></tr>
<tr><th id="99">99</th><td><em>static</em> <em>void</em> <a class="tu decl fn" href="#xfr_probe_send_or_end" title='xfr_probe_send_or_end' data-type='void xfr_probe_send_or_end(struct auth_xfer * xfr, struct module_env * env)' data-ref="xfr_probe_send_or_end" data-ref-filename="xfr_probe_send_or_end">xfr_probe_send_or_end</a>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col6 decl" id="186xfr" title='xfr' data-type='struct auth_xfer *' data-ref="186xfr" data-ref-filename="186xfr">xfr</dfn>,</td></tr>
<tr><th id="100">100</th><td>	<b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col7 decl" id="187env" title='env' data-type='struct module_env *' data-ref="187env" data-ref-filename="187env">env</dfn>);</td></tr>
<tr><th id="101">101</th><td><i class="doc" data-doc="xfr_start_probe">/** pick up probe task with specified(or NULL) destination first,</i></td></tr>
<tr><th id="102">102</th><td><i class="doc" data-doc="xfr_start_probe"> * or transfer task if nothing to probe, or false if already in progress */</i></td></tr>
<tr><th id="103">103</th><td><em>static</em> <em>int</em> <a class="tu decl fn" href="#xfr_start_probe" title='xfr_start_probe' data-type='int xfr_start_probe(struct auth_xfer * xfr, struct module_env * env, struct auth_master * spec)' data-ref="xfr_start_probe" data-ref-filename="xfr_start_probe">xfr_start_probe</a>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col8 decl" id="188xfr" title='xfr' data-type='struct auth_xfer *' data-ref="188xfr" data-ref-filename="188xfr">xfr</dfn>, <b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col9 decl" id="189env" title='env' data-type='struct module_env *' data-ref="189env" data-ref-filename="189env">env</dfn>,</td></tr>
<tr><th id="104">104</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>* <dfn class="local col0 decl" id="190spec" title='spec' data-type='struct auth_master *' data-ref="190spec" data-ref-filename="190spec">spec</dfn>);</td></tr>
<tr><th id="105">105</th><td><i class="doc">/** delete xfer structure (not its tree entry) */</i></td></tr>
<tr><th id="106">106</th><td><em>void</em> <a class="decl fn" href="#auth_xfer_delete" title='auth_xfer_delete' data-ref="auth_xfer_delete" data-ref-filename="auth_xfer_delete">auth_xfer_delete</a>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col1 decl" id="191xfr" title='xfr' data-type='struct auth_xfer *' data-ref="191xfr" data-ref-filename="191xfr">xfr</dfn>);</td></tr>
<tr><th id="107">107</th><td></td></tr>
<tr><th id="108">108</th><td><i class="doc" data-doc="msg_create">/** create new dns_msg */</i></td></tr>
<tr><th id="109">109</th><td><em>static</em> <b>struct</b> <a class="type" href="cache/dns.h.html#dns_msg" title='dns_msg' data-ref="dns_msg" data-ref-filename="dns_msg">dns_msg</a>*</td></tr>
<tr><th id="110">110</th><td><dfn class="tu decl def fn" id="msg_create" title='msg_create' data-type='struct dns_msg * msg_create(struct regional * region, struct query_info * qinfo)' data-ref="msg_create" data-ref-filename="msg_create">msg_create</dfn>(<b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col2 decl" id="192region" title='region' data-type='struct regional *' data-ref="192region" data-ref-filename="192region">region</dfn>, <b>struct</b> <a class="type" href="../util/data/msgreply.h.html#query_info" title='query_info' data-ref="query_info" data-ref-filename="query_info">query_info</a>* <dfn class="local col3 decl" id="193qinfo" title='qinfo' data-type='struct query_info *' data-ref="193qinfo" data-ref-filename="193qinfo">qinfo</dfn>)</td></tr>
<tr><th id="111">111</th><td>{</td></tr>
<tr><th id="112">112</th><td>	<b>struct</b> <a class="type" href="cache/dns.h.html#dns_msg" title='dns_msg' data-ref="dns_msg" data-ref-filename="dns_msg">dns_msg</a>* <dfn class="local col4 decl" id="194msg" title='msg' data-type='struct dns_msg *' data-ref="194msg" data-ref-filename="194msg">msg</dfn> = (<b>struct</b> <a class="type" href="cache/dns.h.html#dns_msg" title='dns_msg' data-ref="dns_msg" data-ref-filename="dns_msg">dns_msg</a>*)<a class="ref fn" href="../util/regional.h.html#regional_alloc" title='regional_alloc' data-ref="regional_alloc" data-ref-filename="regional_alloc">regional_alloc</a>(<a class="local col2 ref" href="#192region" title='region' data-ref="192region" data-ref-filename="192region">region</a>,</td></tr>
<tr><th id="113">113</th><td>		<b>sizeof</b>(<b>struct</b> <a class="type" href="cache/dns.h.html#dns_msg" title='dns_msg' data-ref="dns_msg" data-ref-filename="dns_msg">dns_msg</a>));</td></tr>
<tr><th id="114">114</th><td>	<b>if</b>(!<a class="local col4 ref" href="#194msg" title='msg' data-ref="194msg" data-ref-filename="194msg">msg</a>)</td></tr>
<tr><th id="115">115</th><td>		<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="116">116</th><td>	<a class="local col4 ref" href="#194msg" title='msg' data-ref="194msg" data-ref-filename="194msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::qinfo" title='dns_msg::qinfo' data-ref="dns_msg::qinfo" data-ref-filename="dns_msg..qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname" title='query_info::qname' data-ref="query_info::qname" data-ref-filename="query_info..qname">qname</a> = <a class="ref fn" href="../util/regional.h.html#regional_alloc_init" title='regional_alloc_init' data-ref="regional_alloc_init" data-ref-filename="regional_alloc_init">regional_alloc_init</a>(<a class="local col2 ref" href="#192region" title='region' data-ref="192region" data-ref-filename="192region">region</a>, <a class="local col3 ref" href="#193qinfo" title='qinfo' data-ref="193qinfo" data-ref-filename="193qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname" title='query_info::qname' data-ref="query_info::qname" data-ref-filename="query_info..qname">qname</a>,</td></tr>
<tr><th id="117">117</th><td>		<a class="local col3 ref" href="#193qinfo" title='qinfo' data-ref="193qinfo" data-ref-filename="193qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname_len" title='query_info::qname_len' data-ref="query_info::qname_len" data-ref-filename="query_info..qname_len">qname_len</a>);</td></tr>
<tr><th id="118">118</th><td>	<b>if</b>(!<a class="local col4 ref" href="#194msg" title='msg' data-ref="194msg" data-ref-filename="194msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::qinfo" title='dns_msg::qinfo' data-ref="dns_msg::qinfo" data-ref-filename="dns_msg..qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname" title='query_info::qname' data-ref="query_info::qname" data-ref-filename="query_info..qname">qname</a>)</td></tr>
<tr><th id="119">119</th><td>		<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="120">120</th><td>	<a class="local col4 ref" href="#194msg" title='msg' data-ref="194msg" data-ref-filename="194msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::qinfo" title='dns_msg::qinfo' data-ref="dns_msg::qinfo" data-ref-filename="dns_msg..qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname_len" title='query_info::qname_len' data-ref="query_info::qname_len" data-ref-filename="query_info..qname_len">qname_len</a> = <a class="local col3 ref" href="#193qinfo" title='qinfo' data-ref="193qinfo" data-ref-filename="193qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname_len" title='query_info::qname_len' data-ref="query_info::qname_len" data-ref-filename="query_info..qname_len">qname_len</a>;</td></tr>
<tr><th id="121">121</th><td>	<a class="local col4 ref" href="#194msg" title='msg' data-ref="194msg" data-ref-filename="194msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::qinfo" title='dns_msg::qinfo' data-ref="dns_msg::qinfo" data-ref-filename="dns_msg..qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qtype" title='query_info::qtype' data-ref="query_info::qtype" data-ref-filename="query_info..qtype">qtype</a> = <a class="local col3 ref" href="#193qinfo" title='qinfo' data-ref="193qinfo" data-ref-filename="193qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qtype" title='query_info::qtype' data-ref="query_info::qtype" data-ref-filename="query_info..qtype">qtype</a>;</td></tr>
<tr><th id="122">122</th><td>	<a class="local col4 ref" href="#194msg" title='msg' data-ref="194msg" data-ref-filename="194msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::qinfo" title='dns_msg::qinfo' data-ref="dns_msg::qinfo" data-ref-filename="dns_msg..qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qclass" title='query_info::qclass' data-ref="query_info::qclass" data-ref-filename="query_info..qclass">qclass</a> = <a class="local col3 ref" href="#193qinfo" title='qinfo' data-ref="193qinfo" data-ref-filename="193qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qclass" title='query_info::qclass' data-ref="query_info::qclass" data-ref-filename="query_info..qclass">qclass</a>;</td></tr>
<tr><th id="123">123</th><td>	<a class="local col4 ref" href="#194msg" title='msg' data-ref="194msg" data-ref-filename="194msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::qinfo" title='dns_msg::qinfo' data-ref="dns_msg::qinfo" data-ref-filename="dns_msg..qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::local_alias" title='query_info::local_alias' data-ref="query_info::local_alias" data-ref-filename="query_info..local_alias">local_alias</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="124">124</th><td>	<i>/* non-packed reply_info, because it needs to grow the array */</i></td></tr>
<tr><th id="125">125</th><td>	<a class="local col4 ref" href="#194msg" title='msg' data-ref="194msg" data-ref-filename="194msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a> = (<b>struct</b> <a class="type" href="../util/data/msgreply.h.html#reply_info" title='reply_info' data-ref="reply_info" data-ref-filename="reply_info">reply_info</a>*)<a class="ref fn" href="../util/regional.h.html#regional_alloc_zero" title='regional_alloc_zero' data-ref="regional_alloc_zero" data-ref-filename="regional_alloc_zero">regional_alloc_zero</a>(<a class="local col2 ref" href="#192region" title='region' data-ref="192region" data-ref-filename="192region">region</a>,</td></tr>
<tr><th id="126">126</th><td>		<b>sizeof</b>(<b>struct</b> <a class="type" href="../util/data/msgreply.h.html#reply_info" title='reply_info' data-ref="reply_info" data-ref-filename="reply_info">reply_info</a>)-<b>sizeof</b>(<b>struct</b> <a class="type" href="../util/data/msgreply.h.html#rrset_ref" title='rrset_ref' data-ref="rrset_ref" data-ref-filename="rrset_ref">rrset_ref</a>));</td></tr>
<tr><th id="127">127</th><td>	<b>if</b>(!<a class="local col4 ref" href="#194msg" title='msg' data-ref="194msg" data-ref-filename="194msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>)</td></tr>
<tr><th id="128">128</th><td>		<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="129">129</th><td>	<a class="local col4 ref" href="#194msg" title='msg' data-ref="194msg" data-ref-filename="194msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::flags" title='reply_info::flags' data-ref="reply_info::flags" data-ref-filename="reply_info..flags">flags</a> = (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a>)(<a class="macro" href="../util/net_help.h.html#71" title="0x8000" data-ref="_M/BIT_QR">BIT_QR</a> | <a class="macro" href="../util/net_help.h.html#69" title="0x0400" data-ref="_M/BIT_AA">BIT_AA</a>);</td></tr>
<tr><th id="130">130</th><td>	<a class="local col4 ref" href="#194msg" title='msg' data-ref="194msg" data-ref-filename="194msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::authoritative" title='reply_info::authoritative' data-ref="reply_info::authoritative" data-ref-filename="reply_info..authoritative">authoritative</a> = <var>1</var>;</td></tr>
<tr><th id="131">131</th><td>	<a class="local col4 ref" href="#194msg" title='msg' data-ref="194msg" data-ref-filename="194msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::qdcount" title='reply_info::qdcount' data-ref="reply_info::qdcount" data-ref-filename="reply_info..qdcount">qdcount</a> = <var>1</var>;</td></tr>
<tr><th id="132">132</th><td>	<i>/* rrsets is NULL, no rrsets yet */</i></td></tr>
<tr><th id="133">133</th><td>	<b>return</b> <a class="local col4 ref" href="#194msg" title='msg' data-ref="194msg" data-ref-filename="194msg">msg</a>;</td></tr>
<tr><th id="134">134</th><td>}</td></tr>
<tr><th id="135">135</th><td></td></tr>
<tr><th id="136">136</th><td><i class="doc" data-doc="msg_grow_array">/** grow rrset array by one in msg */</i></td></tr>
<tr><th id="137">137</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="138">138</th><td><dfn class="tu decl def fn" id="msg_grow_array" title='msg_grow_array' data-type='int msg_grow_array(struct regional * region, struct dns_msg * msg)' data-ref="msg_grow_array" data-ref-filename="msg_grow_array">msg_grow_array</dfn>(<b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col5 decl" id="195region" title='region' data-type='struct regional *' data-ref="195region" data-ref-filename="195region">region</dfn>, <b>struct</b> <a class="type" href="cache/dns.h.html#dns_msg" title='dns_msg' data-ref="dns_msg" data-ref-filename="dns_msg">dns_msg</a>* <dfn class="local col6 decl" id="196msg" title='msg' data-type='struct dns_msg *' data-ref="196msg" data-ref-filename="196msg">msg</dfn>)</td></tr>
<tr><th id="139">139</th><td>{</td></tr>
<tr><th id="140">140</th><td>	<b>if</b>(<a class="local col6 ref" href="#196msg" title='msg' data-ref="196msg" data-ref-filename="196msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrsets" title='reply_info::rrsets' data-ref="reply_info::rrsets" data-ref-filename="reply_info..rrsets">rrsets</a> == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="141">141</th><td>		<a class="local col6 ref" href="#196msg" title='msg' data-ref="196msg" data-ref-filename="196msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrsets" title='reply_info::rrsets' data-ref="reply_info::rrsets" data-ref-filename="reply_info..rrsets">rrsets</a> = <a class="ref fn" href="../util/regional.h.html#regional_alloc_zero" title='regional_alloc_zero' data-ref="regional_alloc_zero" data-ref-filename="regional_alloc_zero">regional_alloc_zero</a>(<a class="local col5 ref" href="#195region" title='region' data-ref="195region" data-ref-filename="195region">region</a>,</td></tr>
<tr><th id="142">142</th><td>			<b>sizeof</b>(<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key" title='ub_packed_rrset_key' data-ref="ub_packed_rrset_key" data-ref-filename="ub_packed_rrset_key">ub_packed_rrset_key</a>*)*(<a class="local col6 ref" href="#196msg" title='msg' data-ref="196msg" data-ref-filename="196msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrset_count" title='reply_info::rrset_count' data-ref="reply_info::rrset_count" data-ref-filename="reply_info..rrset_count">rrset_count</a>+<var>1</var>));</td></tr>
<tr><th id="143">143</th><td>		<b>if</b>(!<a class="local col6 ref" href="#196msg" title='msg' data-ref="196msg" data-ref-filename="196msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrsets" title='reply_info::rrsets' data-ref="reply_info::rrsets" data-ref-filename="reply_info..rrsets">rrsets</a>)</td></tr>
<tr><th id="144">144</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="145">145</th><td>	} <b>else</b> {</td></tr>
<tr><th id="146">146</th><td>		<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key" title='ub_packed_rrset_key' data-ref="ub_packed_rrset_key" data-ref-filename="ub_packed_rrset_key">ub_packed_rrset_key</a>** <dfn class="local col7 decl" id="197rrsets_old" title='rrsets_old' data-type='struct ub_packed_rrset_key **' data-ref="197rrsets_old" data-ref-filename="197rrsets_old">rrsets_old</dfn> = <a class="local col6 ref" href="#196msg" title='msg' data-ref="196msg" data-ref-filename="196msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrsets" title='reply_info::rrsets' data-ref="reply_info::rrsets" data-ref-filename="reply_info..rrsets">rrsets</a>;</td></tr>
<tr><th id="147">147</th><td>		<a class="local col6 ref" href="#196msg" title='msg' data-ref="196msg" data-ref-filename="196msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrsets" title='reply_info::rrsets' data-ref="reply_info::rrsets" data-ref-filename="reply_info..rrsets">rrsets</a> = <a class="ref fn" href="../util/regional.h.html#regional_alloc_zero" title='regional_alloc_zero' data-ref="regional_alloc_zero" data-ref-filename="regional_alloc_zero">regional_alloc_zero</a>(<a class="local col5 ref" href="#195region" title='region' data-ref="195region" data-ref-filename="195region">region</a>,</td></tr>
<tr><th id="148">148</th><td>			<b>sizeof</b>(<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key" title='ub_packed_rrset_key' data-ref="ub_packed_rrset_key" data-ref-filename="ub_packed_rrset_key">ub_packed_rrset_key</a>*)*(<a class="local col6 ref" href="#196msg" title='msg' data-ref="196msg" data-ref-filename="196msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrset_count" title='reply_info::rrset_count' data-ref="reply_info::rrset_count" data-ref-filename="reply_info..rrset_count">rrset_count</a>+<var>1</var>));</td></tr>
<tr><th id="149">149</th><td>		<b>if</b>(!<a class="local col6 ref" href="#196msg" title='msg' data-ref="196msg" data-ref-filename="196msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrsets" title='reply_info::rrsets' data-ref="reply_info::rrsets" data-ref-filename="reply_info..rrsets">rrsets</a>)</td></tr>
<tr><th id="150">150</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="151">151</th><td>		<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(msg-&gt;rep-&gt;rrsets, 0) != (size_t)-1) ? __builtin___memmove_chk(msg-&gt;rep-&gt;rrsets, rrsets_old, sizeof(struct ub_packed_rrset_key*)*msg-&gt;rep-&gt;rrset_count, __builtin_object_size(msg-&gt;rep-&gt;rrsets, 0)) : __memmove_ichk(msg-&gt;rep-&gt;rrsets, rrsets_old, sizeof(struct ub_packed_rrset_key*)*msg-&gt;rep-&gt;rrset_count))" data-ref="_M/memmove">memmove</a>(<a class="local col6 ref" href="#196msg" title='msg' data-ref="196msg" data-ref-filename="196msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrsets" title='reply_info::rrsets' data-ref="reply_info::rrsets" data-ref-filename="reply_info..rrsets">rrsets</a>, <a class="local col7 ref" href="#197rrsets_old" title='rrsets_old' data-ref="197rrsets_old" data-ref-filename="197rrsets_old">rrsets_old</a>,</td></tr>
<tr><th id="152">152</th><td>			<b>sizeof</b>(<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key" title='ub_packed_rrset_key' data-ref="ub_packed_rrset_key" data-ref-filename="ub_packed_rrset_key">ub_packed_rrset_key</a>*)*<a class="local col6 ref" href="#196msg" title='msg' data-ref="196msg" data-ref-filename="196msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrset_count" title='reply_info::rrset_count' data-ref="reply_info::rrset_count" data-ref-filename="reply_info..rrset_count">rrset_count</a>);</td></tr>
<tr><th id="153">153</th><td>	}</td></tr>
<tr><th id="154">154</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="155">155</th><td>}</td></tr>
<tr><th id="156">156</th><td></td></tr>
<tr><th id="157">157</th><td><i class="doc" data-doc="get_rrset_ttl">/** get ttl of rrset */</i></td></tr>
<tr><th id="158">158</th><td><em>static</em> <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#time_t" title='time_t' data-type='__int64_t' data-ref="time_t" data-ref-filename="time_t">time_t</a></td></tr>
<tr><th id="159">159</th><td><dfn class="tu decl def fn" id="get_rrset_ttl" title='get_rrset_ttl' data-type='time_t get_rrset_ttl(struct ub_packed_rrset_key * k)' data-ref="get_rrset_ttl" data-ref-filename="get_rrset_ttl">get_rrset_ttl</dfn>(<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key" title='ub_packed_rrset_key' data-ref="ub_packed_rrset_key" data-ref-filename="ub_packed_rrset_key">ub_packed_rrset_key</a>* <dfn class="local col8 decl" id="198k" title='k' data-type='struct ub_packed_rrset_key *' data-ref="198k" data-ref-filename="198k">k</dfn>)</td></tr>
<tr><th id="160">160</th><td>{</td></tr>
<tr><th id="161">161</th><td>	<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>* <dfn class="local col9 decl" id="199d" title='d' data-type='struct packed_rrset_data *' data-ref="199d" data-ref-filename="199d">d</dfn> = (<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>*)</td></tr>
<tr><th id="162">162</th><td>		<a class="local col8 ref" href="#198k" title='k' data-ref="198k" data-ref-filename="198k">k</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key::entry" title='ub_packed_rrset_key::entry' data-ref="ub_packed_rrset_key::entry" data-ref-filename="ub_packed_rrset_key..entry">entry</a>.<a class="ref field" href="../util/storage/lruhash.h.html#lruhash_entry::data" title='lruhash_entry::data' data-ref="lruhash_entry::data" data-ref-filename="lruhash_entry..data">data</a>;</td></tr>
<tr><th id="163">163</th><td>	<b>return</b> <a class="local col9 ref" href="#199d" title='d' data-ref="199d" data-ref-filename="199d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::ttl" title='packed_rrset_data::ttl' data-ref="packed_rrset_data::ttl" data-ref-filename="packed_rrset_data..ttl">ttl</a>;</td></tr>
<tr><th id="164">164</th><td>}</td></tr>
<tr><th id="165">165</th><td></td></tr>
<tr><th id="166">166</th><td><i class="doc" data-doc="auth_packed_rrset_copy_region">/** Copy rrset into region from domain-datanode and packet rrset */</i></td></tr>
<tr><th id="167">167</th><td><em>static</em> <b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key" title='ub_packed_rrset_key' data-ref="ub_packed_rrset_key" data-ref-filename="ub_packed_rrset_key">ub_packed_rrset_key</a>*</td></tr>
<tr><th id="168">168</th><td><dfn class="tu decl def fn" id="auth_packed_rrset_copy_region" title='auth_packed_rrset_copy_region' data-type='struct ub_packed_rrset_key * auth_packed_rrset_copy_region(struct auth_zone * z, struct auth_data * node, struct auth_rrset * rrset, struct regional * region, time_t adjust)' data-ref="auth_packed_rrset_copy_region" data-ref-filename="auth_packed_rrset_copy_region">auth_packed_rrset_copy_region</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col0 decl" id="200z" title='z' data-type='struct auth_zone *' data-ref="200z" data-ref-filename="200z">z</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col1 decl" id="201node" title='node' data-type='struct auth_data *' data-ref="201node" data-ref-filename="201node">node</dfn>,</td></tr>
<tr><th id="169">169</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col2 decl" id="202rrset" title='rrset' data-type='struct auth_rrset *' data-ref="202rrset" data-ref-filename="202rrset">rrset</dfn>, <b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col3 decl" id="203region" title='region' data-type='struct regional *' data-ref="203region" data-ref-filename="203region">region</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#time_t" title='time_t' data-type='__int64_t' data-ref="time_t" data-ref-filename="time_t">time_t</a> <dfn class="local col4 decl" id="204adjust" title='adjust' data-type='time_t' data-ref="204adjust" data-ref-filename="204adjust">adjust</dfn>)</td></tr>
<tr><th id="170">170</th><td>{</td></tr>
<tr><th id="171">171</th><td>	<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key" title='ub_packed_rrset_key' data-ref="ub_packed_rrset_key" data-ref-filename="ub_packed_rrset_key">ub_packed_rrset_key</a> <dfn class="local col5 decl" id="205key" title='key' data-type='struct ub_packed_rrset_key' data-ref="205key" data-ref-filename="205key">key</dfn>;</td></tr>
<tr><th id="172">172</th><td>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#97" title="((__builtin_object_size(&amp;key, 0) != (size_t)-1) ? __builtin___memset_chk(&amp;key, 0, sizeof(key), __builtin_object_size(&amp;key, 0)) : __memset_ichk(&amp;key, 0, sizeof(key)))" data-ref="_M/memset">memset</a>(&amp;<a class="local col5 ref" href="#205key" title='key' data-ref="205key" data-ref-filename="205key">key</a>, <var>0</var>, <b>sizeof</b>(<a class="local col5 ref" href="#205key" title='key' data-ref="205key" data-ref-filename="205key">key</a>));</td></tr>
<tr><th id="173">173</th><td>	<a class="local col5 ref" href="#205key" title='key' data-ref="205key" data-ref-filename="205key">key</a>.<a class="ref field" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key::entry" title='ub_packed_rrset_key::entry' data-ref="ub_packed_rrset_key::entry" data-ref-filename="ub_packed_rrset_key..entry">entry</a>.<a class="ref field" href="../util/storage/lruhash.h.html#lruhash_entry::key" title='lruhash_entry::key' data-ref="lruhash_entry::key" data-ref-filename="lruhash_entry..key">key</a> = &amp;<a class="local col5 ref" href="#205key" title='key' data-ref="205key" data-ref-filename="205key">key</a>;</td></tr>
<tr><th id="174">174</th><td>	<a class="local col5 ref" href="#205key" title='key' data-ref="205key" data-ref-filename="205key">key</a>.<a class="ref field" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key::entry" title='ub_packed_rrset_key::entry' data-ref="ub_packed_rrset_key::entry" data-ref-filename="ub_packed_rrset_key..entry">entry</a>.<a class="ref field" href="../util/storage/lruhash.h.html#lruhash_entry::data" title='lruhash_entry::data' data-ref="lruhash_entry::data" data-ref-filename="lruhash_entry..data">data</a> = <a class="local col2 ref" href="#202rrset" title='rrset' data-ref="202rrset" data-ref-filename="202rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>;</td></tr>
<tr><th id="175">175</th><td>	<a class="local col5 ref" href="#205key" title='key' data-ref="205key" data-ref-filename="205key">key</a>.<a class="ref field" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key::rk" title='ub_packed_rrset_key::rk' data-ref="ub_packed_rrset_key::rk" data-ref-filename="ub_packed_rrset_key..rk">rk</a>.<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_key::dname" title='packed_rrset_key::dname' data-ref="packed_rrset_key::dname" data-ref-filename="packed_rrset_key..dname">dname</a> = <a class="local col1 ref" href="#201node" title='node' data-ref="201node" data-ref-filename="201node">node</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::name" title='auth_data::name' data-ref="auth_data::name" data-ref-filename="auth_data..name">name</a>;</td></tr>
<tr><th id="176">176</th><td>	<a class="local col5 ref" href="#205key" title='key' data-ref="205key" data-ref-filename="205key">key</a>.<a class="ref field" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key::rk" title='ub_packed_rrset_key::rk' data-ref="ub_packed_rrset_key::rk" data-ref-filename="ub_packed_rrset_key..rk">rk</a>.<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_key::dname_len" title='packed_rrset_key::dname_len' data-ref="packed_rrset_key::dname_len" data-ref-filename="packed_rrset_key..dname_len">dname_len</a> = <a class="local col1 ref" href="#201node" title='node' data-ref="201node" data-ref-filename="201node">node</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::namelen" title='auth_data::namelen' data-ref="auth_data::namelen" data-ref-filename="auth_data..namelen">namelen</a>;</td></tr>
<tr><th id="177">177</th><td>	<a class="local col5 ref" href="#205key" title='key' data-ref="205key" data-ref-filename="205key">key</a>.<a class="ref field" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key::rk" title='ub_packed_rrset_key::rk' data-ref="ub_packed_rrset_key::rk" data-ref-filename="ub_packed_rrset_key..rk">rk</a>.<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_key::type" title='packed_rrset_key::type' data-ref="packed_rrset_key::type" data-ref-filename="packed_rrset_key..type">type</a> = <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/endian.h.html#128" title="((uint16_t)(__builtin_constant_p((((uint16_t)((rrset-&gt;type))))) ? (((uint16_t)(((((((uint16_t)((rrset-&gt;type)))) &amp; 0xff00) &gt;&gt; 8) | (((((uint16_t)((rrset-&gt;type)))) &amp; 0x00ff) &lt;&lt; 8))))) : __byte_swap_u16_variable(((uint16_t)((rrset-&gt;type))))))" data-ref="_M/htons">htons</a>(<a class="local col2 ref" href="#202rrset" title='rrset' data-ref="202rrset" data-ref-filename="202rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::type" title='auth_rrset::type' data-ref="auth_rrset::type" data-ref-filename="auth_rrset..type">type</a>);</td></tr>
<tr><th id="178">178</th><td>	<a class="local col5 ref" href="#205key" title='key' data-ref="205key" data-ref-filename="205key">key</a>.<a class="ref field" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key::rk" title='ub_packed_rrset_key::rk' data-ref="ub_packed_rrset_key::rk" data-ref-filename="ub_packed_rrset_key..rk">rk</a>.<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_key::rrset_class" title='packed_rrset_key::rrset_class' data-ref="packed_rrset_key::rrset_class" data-ref-filename="packed_rrset_key..rrset_class">rrset_class</a> = <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/endian.h.html#128" title="((uint16_t)(__builtin_constant_p((((uint16_t)((z-&gt;dclass))))) ? (((uint16_t)(((((((uint16_t)((z-&gt;dclass)))) &amp; 0xff00) &gt;&gt; 8) | (((((uint16_t)((z-&gt;dclass)))) &amp; 0x00ff) &lt;&lt; 8))))) : __byte_swap_u16_variable(((uint16_t)((z-&gt;dclass))))))" data-ref="_M/htons">htons</a>(<a class="local col0 ref" href="#200z" title='z' data-ref="200z" data-ref-filename="200z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::dclass" title='auth_zone::dclass' data-ref="auth_zone::dclass" data-ref-filename="auth_zone..dclass">dclass</a>);</td></tr>
<tr><th id="179">179</th><td>	<a class="local col5 ref" href="#205key" title='key' data-ref="205key" data-ref-filename="205key">key</a>.<a class="ref field" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key::entry" title='ub_packed_rrset_key::entry' data-ref="ub_packed_rrset_key::entry" data-ref-filename="ub_packed_rrset_key..entry">entry</a>.<a class="ref field" href="../util/storage/lruhash.h.html#lruhash_entry::hash" title='lruhash_entry::hash' data-ref="lruhash_entry::hash" data-ref-filename="lruhash_entry..hash">hash</a> = <a class="ref fn" href="../util/data/packed_rrset.h.html#rrset_key_hash" title='rrset_key_hash' data-ref="rrset_key_hash" data-ref-filename="rrset_key_hash">rrset_key_hash</a>(&amp;<a class="local col5 ref" href="#205key" title='key' data-ref="205key" data-ref-filename="205key">key</a>.<a class="ref field" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key::rk" title='ub_packed_rrset_key::rk' data-ref="ub_packed_rrset_key::rk" data-ref-filename="ub_packed_rrset_key..rk">rk</a>);</td></tr>
<tr><th id="180">180</th><td>	<b>return</b> <a class="ref fn" href="../util/data/packed_rrset.h.html#packed_rrset_copy_region" title='packed_rrset_copy_region' data-ref="packed_rrset_copy_region" data-ref-filename="packed_rrset_copy_region">packed_rrset_copy_region</a>(&amp;<a class="local col5 ref" href="#205key" title='key' data-ref="205key" data-ref-filename="205key">key</a>, <a class="local col3 ref" href="#203region" title='region' data-ref="203region" data-ref-filename="203region">region</a>, <a class="local col4 ref" href="#204adjust" title='adjust' data-ref="204adjust" data-ref-filename="204adjust">adjust</a>);</td></tr>
<tr><th id="181">181</th><td>}</td></tr>
<tr><th id="182">182</th><td></td></tr>
<tr><th id="183">183</th><td><i class="doc" data-doc="msg_ttl">/** fix up msg-&gt;rep TTL and prefetch ttl */</i></td></tr>
<tr><th id="184">184</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="185">185</th><td><dfn class="tu decl def fn" id="msg_ttl" title='msg_ttl' data-type='void msg_ttl(struct dns_msg * msg)' data-ref="msg_ttl" data-ref-filename="msg_ttl">msg_ttl</dfn>(<b>struct</b> <a class="type" href="cache/dns.h.html#dns_msg" title='dns_msg' data-ref="dns_msg" data-ref-filename="dns_msg">dns_msg</a>* <dfn class="local col6 decl" id="206msg" title='msg' data-type='struct dns_msg *' data-ref="206msg" data-ref-filename="206msg">msg</dfn>)</td></tr>
<tr><th id="186">186</th><td>{</td></tr>
<tr><th id="187">187</th><td>	<b>if</b>(<a class="local col6 ref" href="#206msg" title='msg' data-ref="206msg" data-ref-filename="206msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrset_count" title='reply_info::rrset_count' data-ref="reply_info::rrset_count" data-ref-filename="reply_info..rrset_count">rrset_count</a> == <var>0</var>) <b>return</b>;</td></tr>
<tr><th id="188">188</th><td>	<b>if</b>(<a class="local col6 ref" href="#206msg" title='msg' data-ref="206msg" data-ref-filename="206msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrset_count" title='reply_info::rrset_count' data-ref="reply_info::rrset_count" data-ref-filename="reply_info..rrset_count">rrset_count</a> == <var>1</var>) {</td></tr>
<tr><th id="189">189</th><td>		<a class="local col6 ref" href="#206msg" title='msg' data-ref="206msg" data-ref-filename="206msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::ttl" title='reply_info::ttl' data-ref="reply_info::ttl" data-ref-filename="reply_info..ttl">ttl</a> = <a class="tu ref fn" href="#get_rrset_ttl" title='get_rrset_ttl' data-use='c' data-ref="get_rrset_ttl" data-ref-filename="get_rrset_ttl">get_rrset_ttl</a>(<a class="local col6 ref" href="#206msg" title='msg' data-ref="206msg" data-ref-filename="206msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrsets" title='reply_info::rrsets' data-ref="reply_info::rrsets" data-ref-filename="reply_info..rrsets">rrsets</a>[<var>0</var>]);</td></tr>
<tr><th id="190">190</th><td>		<a class="local col6 ref" href="#206msg" title='msg' data-ref="206msg" data-ref-filename="206msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::prefetch_ttl" title='reply_info::prefetch_ttl' data-ref="reply_info::prefetch_ttl" data-ref-filename="reply_info..prefetch_ttl">prefetch_ttl</a> = <a class="macro" href="../util/data/msgreply.h.html#63" title="((msg-&gt;rep-&gt;ttl) - (msg-&gt;rep-&gt;ttl)/10)" data-ref="_M/PREFETCH_TTL_CALC">PREFETCH_TTL_CALC</a>(<a class="local col6 ref" href="#206msg" title='msg' data-ref="206msg" data-ref-filename="206msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::ttl" title='reply_info::ttl' data-ref="reply_info::ttl" data-ref-filename="reply_info..ttl">ttl</a>);</td></tr>
<tr><th id="191">191</th><td>		<a class="local col6 ref" href="#206msg" title='msg' data-ref="206msg" data-ref-filename="206msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::serve_expired_ttl" title='reply_info::serve_expired_ttl' data-ref="reply_info::serve_expired_ttl" data-ref-filename="reply_info..serve_expired_ttl">serve_expired_ttl</a> = <a class="local col6 ref" href="#206msg" title='msg' data-ref="206msg" data-ref-filename="206msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::ttl" title='reply_info::ttl' data-ref="reply_info::ttl" data-ref-filename="reply_info..ttl">ttl</a> + <a class="ref" href="../util/data/msgparse.h.html#SERVE_EXPIRED_TTL" title='SERVE_EXPIRED_TTL' data-ref="SERVE_EXPIRED_TTL" data-ref-filename="SERVE_EXPIRED_TTL">SERVE_EXPIRED_TTL</a>;</td></tr>
<tr><th id="192">192</th><td>	} <b>else</b> <b>if</b>(<a class="tu ref fn" href="#get_rrset_ttl" title='get_rrset_ttl' data-use='c' data-ref="get_rrset_ttl" data-ref-filename="get_rrset_ttl">get_rrset_ttl</a>(<a class="local col6 ref" href="#206msg" title='msg' data-ref="206msg" data-ref-filename="206msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrsets" title='reply_info::rrsets' data-ref="reply_info::rrsets" data-ref-filename="reply_info..rrsets">rrsets</a>[<a class="local col6 ref" href="#206msg" title='msg' data-ref="206msg" data-ref-filename="206msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrset_count" title='reply_info::rrset_count' data-ref="reply_info::rrset_count" data-ref-filename="reply_info..rrset_count">rrset_count</a>-<var>1</var>]) &lt;</td></tr>
<tr><th id="193">193</th><td>		<a class="local col6 ref" href="#206msg" title='msg' data-ref="206msg" data-ref-filename="206msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::ttl" title='reply_info::ttl' data-ref="reply_info::ttl" data-ref-filename="reply_info..ttl">ttl</a>) {</td></tr>
<tr><th id="194">194</th><td>		<a class="local col6 ref" href="#206msg" title='msg' data-ref="206msg" data-ref-filename="206msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::ttl" title='reply_info::ttl' data-ref="reply_info::ttl" data-ref-filename="reply_info..ttl">ttl</a> = <a class="tu ref fn" href="#get_rrset_ttl" title='get_rrset_ttl' data-use='c' data-ref="get_rrset_ttl" data-ref-filename="get_rrset_ttl">get_rrset_ttl</a>(<a class="local col6 ref" href="#206msg" title='msg' data-ref="206msg" data-ref-filename="206msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrsets" title='reply_info::rrsets' data-ref="reply_info::rrsets" data-ref-filename="reply_info..rrsets">rrsets</a>[</td></tr>
<tr><th id="195">195</th><td>			<a class="local col6 ref" href="#206msg" title='msg' data-ref="206msg" data-ref-filename="206msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrset_count" title='reply_info::rrset_count' data-ref="reply_info::rrset_count" data-ref-filename="reply_info..rrset_count">rrset_count</a>-<var>1</var>]);</td></tr>
<tr><th id="196">196</th><td>		<a class="local col6 ref" href="#206msg" title='msg' data-ref="206msg" data-ref-filename="206msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::prefetch_ttl" title='reply_info::prefetch_ttl' data-ref="reply_info::prefetch_ttl" data-ref-filename="reply_info..prefetch_ttl">prefetch_ttl</a> = <a class="macro" href="../util/data/msgreply.h.html#63" title="((msg-&gt;rep-&gt;ttl) - (msg-&gt;rep-&gt;ttl)/10)" data-ref="_M/PREFETCH_TTL_CALC">PREFETCH_TTL_CALC</a>(<a class="local col6 ref" href="#206msg" title='msg' data-ref="206msg" data-ref-filename="206msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::ttl" title='reply_info::ttl' data-ref="reply_info::ttl" data-ref-filename="reply_info..ttl">ttl</a>);</td></tr>
<tr><th id="197">197</th><td>		<a class="local col6 ref" href="#206msg" title='msg' data-ref="206msg" data-ref-filename="206msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::serve_expired_ttl" title='reply_info::serve_expired_ttl' data-ref="reply_info::serve_expired_ttl" data-ref-filename="reply_info..serve_expired_ttl">serve_expired_ttl</a> = <a class="local col6 ref" href="#206msg" title='msg' data-ref="206msg" data-ref-filename="206msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::ttl" title='reply_info::ttl' data-ref="reply_info::ttl" data-ref-filename="reply_info..ttl">ttl</a> + <a class="ref" href="../util/data/msgparse.h.html#SERVE_EXPIRED_TTL" title='SERVE_EXPIRED_TTL' data-ref="SERVE_EXPIRED_TTL" data-ref-filename="SERVE_EXPIRED_TTL">SERVE_EXPIRED_TTL</a>;</td></tr>
<tr><th id="198">198</th><td>	}</td></tr>
<tr><th id="199">199</th><td>}</td></tr>
<tr><th id="200">200</th><td></td></tr>
<tr><th id="201">201</th><td><i class="doc" data-doc="msg_rrset_duplicate">/** see if rrset is a duplicate in the answer message */</i></td></tr>
<tr><th id="202">202</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="203">203</th><td><dfn class="tu decl def fn" id="msg_rrset_duplicate" title='msg_rrset_duplicate' data-type='int msg_rrset_duplicate(struct dns_msg * msg, uint8_t * nm, size_t nmlen, uint16_t type, uint16_t dclass)' data-ref="msg_rrset_duplicate" data-ref-filename="msg_rrset_duplicate">msg_rrset_duplicate</dfn>(<b>struct</b> <a class="type" href="cache/dns.h.html#dns_msg" title='dns_msg' data-ref="dns_msg" data-ref-filename="dns_msg">dns_msg</a>* <dfn class="local col7 decl" id="207msg" title='msg' data-type='struct dns_msg *' data-ref="207msg" data-ref-filename="207msg">msg</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col8 decl" id="208nm" title='nm' data-type='uint8_t *' data-ref="208nm" data-ref-filename="208nm">nm</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col9 decl" id="209nmlen" title='nmlen' data-type='size_t' data-ref="209nmlen" data-ref-filename="209nmlen">nmlen</dfn>,</td></tr>
<tr><th id="204">204</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col0 decl" id="210type" title='type' data-type='uint16_t' data-ref="210type" data-ref-filename="210type">type</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col1 decl" id="211dclass" title='dclass' data-type='uint16_t' data-ref="211dclass" data-ref-filename="211dclass">dclass</dfn>)</td></tr>
<tr><th id="205">205</th><td>{</td></tr>
<tr><th id="206">206</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col2 decl" id="212i" title='i' data-type='size_t' data-ref="212i" data-ref-filename="212i">i</dfn>;</td></tr>
<tr><th id="207">207</th><td>	<b>for</b>(<a class="local col2 ref" href="#212i" title='i' data-ref="212i" data-ref-filename="212i">i</a>=<var>0</var>; <a class="local col2 ref" href="#212i" title='i' data-ref="212i" data-ref-filename="212i">i</a>&lt;<a class="local col7 ref" href="#207msg" title='msg' data-ref="207msg" data-ref-filename="207msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrset_count" title='reply_info::rrset_count' data-ref="reply_info::rrset_count" data-ref-filename="reply_info..rrset_count">rrset_count</a>; <a class="local col2 ref" href="#212i" title='i' data-ref="212i" data-ref-filename="212i">i</a>++) {</td></tr>
<tr><th id="208">208</th><td>		<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key" title='ub_packed_rrset_key' data-ref="ub_packed_rrset_key" data-ref-filename="ub_packed_rrset_key">ub_packed_rrset_key</a>* <dfn class="local col3 decl" id="213k" title='k' data-type='struct ub_packed_rrset_key *' data-ref="213k" data-ref-filename="213k">k</dfn> = <a class="local col7 ref" href="#207msg" title='msg' data-ref="207msg" data-ref-filename="207msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrsets" title='reply_info::rrsets' data-ref="reply_info::rrsets" data-ref-filename="reply_info..rrsets">rrsets</a>[<a class="local col2 ref" href="#212i" title='i' data-ref="212i" data-ref-filename="212i">i</a>];</td></tr>
<tr><th id="209">209</th><td>		<b>if</b>(<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/endian.h.html#126" title="((uint16_t)(__builtin_constant_p((((uint16_t)((k-&gt;rk.type))))) ? (((uint16_t)(((((((uint16_t)((k-&gt;rk.type)))) &amp; 0xff00) &gt;&gt; 8) | (((((uint16_t)((k-&gt;rk.type)))) &amp; 0x00ff) &lt;&lt; 8))))) : __byte_swap_u16_variable(((uint16_t)((k-&gt;rk.type))))))" data-ref="_M/ntohs">ntohs</a>(<a class="local col3 ref" href="#213k" title='k' data-ref="213k" data-ref-filename="213k">k</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key::rk" title='ub_packed_rrset_key::rk' data-ref="ub_packed_rrset_key::rk" data-ref-filename="ub_packed_rrset_key..rk">rk</a>.<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_key::type" title='packed_rrset_key::type' data-ref="packed_rrset_key::type" data-ref-filename="packed_rrset_key..type">type</a>) == <a class="local col0 ref" href="#210type" title='type' data-ref="210type" data-ref-filename="210type">type</a> &amp;&amp; <a class="local col3 ref" href="#213k" title='k' data-ref="213k" data-ref-filename="213k">k</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key::rk" title='ub_packed_rrset_key::rk' data-ref="ub_packed_rrset_key::rk" data-ref-filename="ub_packed_rrset_key..rk">rk</a>.<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_key::dname_len" title='packed_rrset_key::dname_len' data-ref="packed_rrset_key::dname_len" data-ref-filename="packed_rrset_key..dname_len">dname_len</a> == <a class="local col9 ref" href="#209nmlen" title='nmlen' data-ref="209nmlen" data-ref-filename="209nmlen">nmlen</a> &amp;&amp;</td></tr>
<tr><th id="210">210</th><td>			<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/endian.h.html#126" title="((uint16_t)(__builtin_constant_p((((uint16_t)((k-&gt;rk.rrset_class))))) ? (((uint16_t)(((((((uint16_t)((k-&gt;rk.rrset_class)))) &amp; 0xff00) &gt;&gt; 8) | (((((uint16_t)((k-&gt;rk.rrset_class)))) &amp; 0x00ff) &lt;&lt; 8))))) : __byte_swap_u16_variable(((uint16_t)((k-&gt;rk.rrset_class))))))" data-ref="_M/ntohs">ntohs</a>(<a class="local col3 ref" href="#213k" title='k' data-ref="213k" data-ref-filename="213k">k</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key::rk" title='ub_packed_rrset_key::rk' data-ref="ub_packed_rrset_key::rk" data-ref-filename="ub_packed_rrset_key..rk">rk</a>.<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_key::rrset_class" title='packed_rrset_key::rrset_class' data-ref="packed_rrset_key::rrset_class" data-ref-filename="packed_rrset_key..rrset_class">rrset_class</a>) == <a class="local col1 ref" href="#211dclass" title='dclass' data-ref="211dclass" data-ref-filename="211dclass">dclass</a> &amp;&amp;</td></tr>
<tr><th id="211">211</th><td>			<a class="ref fn" href="../util/data/dname.h.html#query_dname_compare" title='query_dname_compare' data-ref="query_dname_compare" data-ref-filename="query_dname_compare">query_dname_compare</a>(<a class="local col3 ref" href="#213k" title='k' data-ref="213k" data-ref-filename="213k">k</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key::rk" title='ub_packed_rrset_key::rk' data-ref="ub_packed_rrset_key::rk" data-ref-filename="ub_packed_rrset_key..rk">rk</a>.<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_key::dname" title='packed_rrset_key::dname' data-ref="packed_rrset_key::dname" data-ref-filename="packed_rrset_key..dname">dname</a>, <a class="local col8 ref" href="#208nm" title='nm' data-ref="208nm" data-ref-filename="208nm">nm</a>) == <var>0</var>)</td></tr>
<tr><th id="212">212</th><td>			<b>return</b> <var>1</var>;</td></tr>
<tr><th id="213">213</th><td>	}</td></tr>
<tr><th id="214">214</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="215">215</th><td>}</td></tr>
<tr><th id="216">216</th><td></td></tr>
<tr><th id="217">217</th><td><i class="doc" data-doc="msg_add_rrset_an">/** add rrset to answer section (no auth, add rrsets yet) */</i></td></tr>
<tr><th id="218">218</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="219">219</th><td><dfn class="tu decl def fn" id="msg_add_rrset_an" title='msg_add_rrset_an' data-type='int msg_add_rrset_an(struct auth_zone * z, struct regional * region, struct dns_msg * msg, struct auth_data * node, struct auth_rrset * rrset)' data-ref="msg_add_rrset_an" data-ref-filename="msg_add_rrset_an">msg_add_rrset_an</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col4 decl" id="214z" title='z' data-type='struct auth_zone *' data-ref="214z" data-ref-filename="214z">z</dfn>, <b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col5 decl" id="215region" title='region' data-type='struct regional *' data-ref="215region" data-ref-filename="215region">region</dfn>,</td></tr>
<tr><th id="220">220</th><td>	<b>struct</b> <a class="type" href="cache/dns.h.html#dns_msg" title='dns_msg' data-ref="dns_msg" data-ref-filename="dns_msg">dns_msg</a>* <dfn class="local col6 decl" id="216msg" title='msg' data-type='struct dns_msg *' data-ref="216msg" data-ref-filename="216msg">msg</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col7 decl" id="217node" title='node' data-type='struct auth_data *' data-ref="217node" data-ref-filename="217node">node</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col8 decl" id="218rrset" title='rrset' data-type='struct auth_rrset *' data-ref="218rrset" data-ref-filename="218rrset">rrset</dfn>)</td></tr>
<tr><th id="221">221</th><td>{</td></tr>
<tr><th id="222">222</th><td>	<a class="macro" href="../util/log.h.html#211" title="" data-ref="_M/log_assert">log_assert</a>(msg-&gt;rep-&gt;ns_numrrsets == <var>0</var>);</td></tr>
<tr><th id="223">223</th><td>	<a class="macro" href="../util/log.h.html#211" title="" data-ref="_M/log_assert">log_assert</a>(msg-&gt;rep-&gt;ar_numrrsets == <var>0</var>);</td></tr>
<tr><th id="224">224</th><td>	<b>if</b>(!<a class="local col8 ref" href="#218rrset" title='rrset' data-ref="218rrset" data-ref-filename="218rrset">rrset</a> || !<a class="local col7 ref" href="#217node" title='node' data-ref="217node" data-ref-filename="217node">node</a>)</td></tr>
<tr><th id="225">225</th><td>		<b>return</b> <var>1</var>;</td></tr>
<tr><th id="226">226</th><td>	<b>if</b>(<a class="tu ref fn" href="#msg_rrset_duplicate" title='msg_rrset_duplicate' data-use='c' data-ref="msg_rrset_duplicate" data-ref-filename="msg_rrset_duplicate">msg_rrset_duplicate</a>(<a class="local col6 ref" href="#216msg" title='msg' data-ref="216msg" data-ref-filename="216msg">msg</a>, <a class="local col7 ref" href="#217node" title='node' data-ref="217node" data-ref-filename="217node">node</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::name" title='auth_data::name' data-ref="auth_data::name" data-ref-filename="auth_data..name">name</a>, <a class="local col7 ref" href="#217node" title='node' data-ref="217node" data-ref-filename="217node">node</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::namelen" title='auth_data::namelen' data-ref="auth_data::namelen" data-ref-filename="auth_data..namelen">namelen</a>, <a class="local col8 ref" href="#218rrset" title='rrset' data-ref="218rrset" data-ref-filename="218rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::type" title='auth_rrset::type' data-ref="auth_rrset::type" data-ref-filename="auth_rrset..type">type</a>,</td></tr>
<tr><th id="227">227</th><td>		<a class="local col4 ref" href="#214z" title='z' data-ref="214z" data-ref-filename="214z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::dclass" title='auth_zone::dclass' data-ref="auth_zone::dclass" data-ref-filename="auth_zone..dclass">dclass</a>))</td></tr>
<tr><th id="228">228</th><td>		<b>return</b> <var>1</var>;</td></tr>
<tr><th id="229">229</th><td>	<i>/* grow array */</i></td></tr>
<tr><th id="230">230</th><td>	<b>if</b>(!<a class="tu ref fn" href="#msg_grow_array" title='msg_grow_array' data-use='c' data-ref="msg_grow_array" data-ref-filename="msg_grow_array">msg_grow_array</a>(<a class="local col5 ref" href="#215region" title='region' data-ref="215region" data-ref-filename="215region">region</a>, <a class="local col6 ref" href="#216msg" title='msg' data-ref="216msg" data-ref-filename="216msg">msg</a>))</td></tr>
<tr><th id="231">231</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="232">232</th><td>	<i>/* copy it */</i></td></tr>
<tr><th id="233">233</th><td>	<b>if</b>(!(<a class="local col6 ref" href="#216msg" title='msg' data-ref="216msg" data-ref-filename="216msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrsets" title='reply_info::rrsets' data-ref="reply_info::rrsets" data-ref-filename="reply_info..rrsets">rrsets</a>[<a class="local col6 ref" href="#216msg" title='msg' data-ref="216msg" data-ref-filename="216msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrset_count" title='reply_info::rrset_count' data-ref="reply_info::rrset_count" data-ref-filename="reply_info..rrset_count">rrset_count</a>] =</td></tr>
<tr><th id="234">234</th><td>		<a class="tu ref fn" href="#auth_packed_rrset_copy_region" title='auth_packed_rrset_copy_region' data-use='c' data-ref="auth_packed_rrset_copy_region" data-ref-filename="auth_packed_rrset_copy_region">auth_packed_rrset_copy_region</a>(<a class="local col4 ref" href="#214z" title='z' data-ref="214z" data-ref-filename="214z">z</a>, <a class="local col7 ref" href="#217node" title='node' data-ref="217node" data-ref-filename="217node">node</a>, <a class="local col8 ref" href="#218rrset" title='rrset' data-ref="218rrset" data-ref-filename="218rrset">rrset</a>, <a class="local col5 ref" href="#215region" title='region' data-ref="215region" data-ref-filename="215region">region</a>, <var>0</var>)))</td></tr>
<tr><th id="235">235</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="236">236</th><td>	<a class="local col6 ref" href="#216msg" title='msg' data-ref="216msg" data-ref-filename="216msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrset_count" title='reply_info::rrset_count' data-ref="reply_info::rrset_count" data-ref-filename="reply_info..rrset_count">rrset_count</a>++;</td></tr>
<tr><th id="237">237</th><td>	<a class="local col6 ref" href="#216msg" title='msg' data-ref="216msg" data-ref-filename="216msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::an_numrrsets" title='reply_info::an_numrrsets' data-ref="reply_info::an_numrrsets" data-ref-filename="reply_info..an_numrrsets">an_numrrsets</a>++;</td></tr>
<tr><th id="238">238</th><td>	<a class="tu ref fn" href="#msg_ttl" title='msg_ttl' data-use='c' data-ref="msg_ttl" data-ref-filename="msg_ttl">msg_ttl</a>(<a class="local col6 ref" href="#216msg" title='msg' data-ref="216msg" data-ref-filename="216msg">msg</a>);</td></tr>
<tr><th id="239">239</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="240">240</th><td>}</td></tr>
<tr><th id="241">241</th><td></td></tr>
<tr><th id="242">242</th><td><i class="doc" data-doc="msg_add_rrset_ns">/** add rrset to authority section (no additonal section rrsets yet) */</i></td></tr>
<tr><th id="243">243</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="244">244</th><td><dfn class="tu decl def fn" id="msg_add_rrset_ns" title='msg_add_rrset_ns' data-type='int msg_add_rrset_ns(struct auth_zone * z, struct regional * region, struct dns_msg * msg, struct auth_data * node, struct auth_rrset * rrset)' data-ref="msg_add_rrset_ns" data-ref-filename="msg_add_rrset_ns">msg_add_rrset_ns</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col9 decl" id="219z" title='z' data-type='struct auth_zone *' data-ref="219z" data-ref-filename="219z">z</dfn>, <b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col0 decl" id="220region" title='region' data-type='struct regional *' data-ref="220region" data-ref-filename="220region">region</dfn>,</td></tr>
<tr><th id="245">245</th><td>	<b>struct</b> <a class="type" href="cache/dns.h.html#dns_msg" title='dns_msg' data-ref="dns_msg" data-ref-filename="dns_msg">dns_msg</a>* <dfn class="local col1 decl" id="221msg" title='msg' data-type='struct dns_msg *' data-ref="221msg" data-ref-filename="221msg">msg</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col2 decl" id="222node" title='node' data-type='struct auth_data *' data-ref="222node" data-ref-filename="222node">node</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col3 decl" id="223rrset" title='rrset' data-type='struct auth_rrset *' data-ref="223rrset" data-ref-filename="223rrset">rrset</dfn>)</td></tr>
<tr><th id="246">246</th><td>{</td></tr>
<tr><th id="247">247</th><td>	<a class="macro" href="../util/log.h.html#211" title="" data-ref="_M/log_assert">log_assert</a>(msg-&gt;rep-&gt;ar_numrrsets == <var>0</var>);</td></tr>
<tr><th id="248">248</th><td>	<b>if</b>(!<a class="local col3 ref" href="#223rrset" title='rrset' data-ref="223rrset" data-ref-filename="223rrset">rrset</a> || !<a class="local col2 ref" href="#222node" title='node' data-ref="222node" data-ref-filename="222node">node</a>)</td></tr>
<tr><th id="249">249</th><td>		<b>return</b> <var>1</var>;</td></tr>
<tr><th id="250">250</th><td>	<b>if</b>(<a class="tu ref fn" href="#msg_rrset_duplicate" title='msg_rrset_duplicate' data-use='c' data-ref="msg_rrset_duplicate" data-ref-filename="msg_rrset_duplicate">msg_rrset_duplicate</a>(<a class="local col1 ref" href="#221msg" title='msg' data-ref="221msg" data-ref-filename="221msg">msg</a>, <a class="local col2 ref" href="#222node" title='node' data-ref="222node" data-ref-filename="222node">node</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::name" title='auth_data::name' data-ref="auth_data::name" data-ref-filename="auth_data..name">name</a>, <a class="local col2 ref" href="#222node" title='node' data-ref="222node" data-ref-filename="222node">node</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::namelen" title='auth_data::namelen' data-ref="auth_data::namelen" data-ref-filename="auth_data..namelen">namelen</a>, <a class="local col3 ref" href="#223rrset" title='rrset' data-ref="223rrset" data-ref-filename="223rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::type" title='auth_rrset::type' data-ref="auth_rrset::type" data-ref-filename="auth_rrset..type">type</a>,</td></tr>
<tr><th id="251">251</th><td>		<a class="local col9 ref" href="#219z" title='z' data-ref="219z" data-ref-filename="219z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::dclass" title='auth_zone::dclass' data-ref="auth_zone::dclass" data-ref-filename="auth_zone..dclass">dclass</a>))</td></tr>
<tr><th id="252">252</th><td>		<b>return</b> <var>1</var>;</td></tr>
<tr><th id="253">253</th><td>	<i>/* grow array */</i></td></tr>
<tr><th id="254">254</th><td>	<b>if</b>(!<a class="tu ref fn" href="#msg_grow_array" title='msg_grow_array' data-use='c' data-ref="msg_grow_array" data-ref-filename="msg_grow_array">msg_grow_array</a>(<a class="local col0 ref" href="#220region" title='region' data-ref="220region" data-ref-filename="220region">region</a>, <a class="local col1 ref" href="#221msg" title='msg' data-ref="221msg" data-ref-filename="221msg">msg</a>))</td></tr>
<tr><th id="255">255</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="256">256</th><td>	<i>/* copy it */</i></td></tr>
<tr><th id="257">257</th><td>	<b>if</b>(!(<a class="local col1 ref" href="#221msg" title='msg' data-ref="221msg" data-ref-filename="221msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrsets" title='reply_info::rrsets' data-ref="reply_info::rrsets" data-ref-filename="reply_info..rrsets">rrsets</a>[<a class="local col1 ref" href="#221msg" title='msg' data-ref="221msg" data-ref-filename="221msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrset_count" title='reply_info::rrset_count' data-ref="reply_info::rrset_count" data-ref-filename="reply_info..rrset_count">rrset_count</a>] =</td></tr>
<tr><th id="258">258</th><td>		<a class="tu ref fn" href="#auth_packed_rrset_copy_region" title='auth_packed_rrset_copy_region' data-use='c' data-ref="auth_packed_rrset_copy_region" data-ref-filename="auth_packed_rrset_copy_region">auth_packed_rrset_copy_region</a>(<a class="local col9 ref" href="#219z" title='z' data-ref="219z" data-ref-filename="219z">z</a>, <a class="local col2 ref" href="#222node" title='node' data-ref="222node" data-ref-filename="222node">node</a>, <a class="local col3 ref" href="#223rrset" title='rrset' data-ref="223rrset" data-ref-filename="223rrset">rrset</a>, <a class="local col0 ref" href="#220region" title='region' data-ref="220region" data-ref-filename="220region">region</a>, <var>0</var>)))</td></tr>
<tr><th id="259">259</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="260">260</th><td>	<a class="local col1 ref" href="#221msg" title='msg' data-ref="221msg" data-ref-filename="221msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrset_count" title='reply_info::rrset_count' data-ref="reply_info::rrset_count" data-ref-filename="reply_info..rrset_count">rrset_count</a>++;</td></tr>
<tr><th id="261">261</th><td>	<a class="local col1 ref" href="#221msg" title='msg' data-ref="221msg" data-ref-filename="221msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::ns_numrrsets" title='reply_info::ns_numrrsets' data-ref="reply_info::ns_numrrsets" data-ref-filename="reply_info..ns_numrrsets">ns_numrrsets</a>++;</td></tr>
<tr><th id="262">262</th><td>	<a class="tu ref fn" href="#msg_ttl" title='msg_ttl' data-use='c' data-ref="msg_ttl" data-ref-filename="msg_ttl">msg_ttl</a>(<a class="local col1 ref" href="#221msg" title='msg' data-ref="221msg" data-ref-filename="221msg">msg</a>);</td></tr>
<tr><th id="263">263</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="264">264</th><td>}</td></tr>
<tr><th id="265">265</th><td></td></tr>
<tr><th id="266">266</th><td><i class="doc" data-doc="msg_add_rrset_ar">/** add rrset to additional section */</i></td></tr>
<tr><th id="267">267</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="268">268</th><td><dfn class="tu decl def fn" id="msg_add_rrset_ar" title='msg_add_rrset_ar' data-type='int msg_add_rrset_ar(struct auth_zone * z, struct regional * region, struct dns_msg * msg, struct auth_data * node, struct auth_rrset * rrset)' data-ref="msg_add_rrset_ar" data-ref-filename="msg_add_rrset_ar">msg_add_rrset_ar</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col4 decl" id="224z" title='z' data-type='struct auth_zone *' data-ref="224z" data-ref-filename="224z">z</dfn>, <b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col5 decl" id="225region" title='region' data-type='struct regional *' data-ref="225region" data-ref-filename="225region">region</dfn>,</td></tr>
<tr><th id="269">269</th><td>	<b>struct</b> <a class="type" href="cache/dns.h.html#dns_msg" title='dns_msg' data-ref="dns_msg" data-ref-filename="dns_msg">dns_msg</a>* <dfn class="local col6 decl" id="226msg" title='msg' data-type='struct dns_msg *' data-ref="226msg" data-ref-filename="226msg">msg</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col7 decl" id="227node" title='node' data-type='struct auth_data *' data-ref="227node" data-ref-filename="227node">node</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col8 decl" id="228rrset" title='rrset' data-type='struct auth_rrset *' data-ref="228rrset" data-ref-filename="228rrset">rrset</dfn>)</td></tr>
<tr><th id="270">270</th><td>{</td></tr>
<tr><th id="271">271</th><td>	<b>if</b>(!<a class="local col8 ref" href="#228rrset" title='rrset' data-ref="228rrset" data-ref-filename="228rrset">rrset</a> || !<a class="local col7 ref" href="#227node" title='node' data-ref="227node" data-ref-filename="227node">node</a>)</td></tr>
<tr><th id="272">272</th><td>		<b>return</b> <var>1</var>;</td></tr>
<tr><th id="273">273</th><td>	<b>if</b>(<a class="tu ref fn" href="#msg_rrset_duplicate" title='msg_rrset_duplicate' data-use='c' data-ref="msg_rrset_duplicate" data-ref-filename="msg_rrset_duplicate">msg_rrset_duplicate</a>(<a class="local col6 ref" href="#226msg" title='msg' data-ref="226msg" data-ref-filename="226msg">msg</a>, <a class="local col7 ref" href="#227node" title='node' data-ref="227node" data-ref-filename="227node">node</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::name" title='auth_data::name' data-ref="auth_data::name" data-ref-filename="auth_data..name">name</a>, <a class="local col7 ref" href="#227node" title='node' data-ref="227node" data-ref-filename="227node">node</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::namelen" title='auth_data::namelen' data-ref="auth_data::namelen" data-ref-filename="auth_data..namelen">namelen</a>, <a class="local col8 ref" href="#228rrset" title='rrset' data-ref="228rrset" data-ref-filename="228rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::type" title='auth_rrset::type' data-ref="auth_rrset::type" data-ref-filename="auth_rrset..type">type</a>,</td></tr>
<tr><th id="274">274</th><td>		<a class="local col4 ref" href="#224z" title='z' data-ref="224z" data-ref-filename="224z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::dclass" title='auth_zone::dclass' data-ref="auth_zone::dclass" data-ref-filename="auth_zone..dclass">dclass</a>))</td></tr>
<tr><th id="275">275</th><td>		<b>return</b> <var>1</var>;</td></tr>
<tr><th id="276">276</th><td>	<i>/* grow array */</i></td></tr>
<tr><th id="277">277</th><td>	<b>if</b>(!<a class="tu ref fn" href="#msg_grow_array" title='msg_grow_array' data-use='c' data-ref="msg_grow_array" data-ref-filename="msg_grow_array">msg_grow_array</a>(<a class="local col5 ref" href="#225region" title='region' data-ref="225region" data-ref-filename="225region">region</a>, <a class="local col6 ref" href="#226msg" title='msg' data-ref="226msg" data-ref-filename="226msg">msg</a>))</td></tr>
<tr><th id="278">278</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="279">279</th><td>	<i>/* copy it */</i></td></tr>
<tr><th id="280">280</th><td>	<b>if</b>(!(<a class="local col6 ref" href="#226msg" title='msg' data-ref="226msg" data-ref-filename="226msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrsets" title='reply_info::rrsets' data-ref="reply_info::rrsets" data-ref-filename="reply_info..rrsets">rrsets</a>[<a class="local col6 ref" href="#226msg" title='msg' data-ref="226msg" data-ref-filename="226msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrset_count" title='reply_info::rrset_count' data-ref="reply_info::rrset_count" data-ref-filename="reply_info..rrset_count">rrset_count</a>] =</td></tr>
<tr><th id="281">281</th><td>		<a class="tu ref fn" href="#auth_packed_rrset_copy_region" title='auth_packed_rrset_copy_region' data-use='c' data-ref="auth_packed_rrset_copy_region" data-ref-filename="auth_packed_rrset_copy_region">auth_packed_rrset_copy_region</a>(<a class="local col4 ref" href="#224z" title='z' data-ref="224z" data-ref-filename="224z">z</a>, <a class="local col7 ref" href="#227node" title='node' data-ref="227node" data-ref-filename="227node">node</a>, <a class="local col8 ref" href="#228rrset" title='rrset' data-ref="228rrset" data-ref-filename="228rrset">rrset</a>, <a class="local col5 ref" href="#225region" title='region' data-ref="225region" data-ref-filename="225region">region</a>, <var>0</var>)))</td></tr>
<tr><th id="282">282</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="283">283</th><td>	<a class="local col6 ref" href="#226msg" title='msg' data-ref="226msg" data-ref-filename="226msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrset_count" title='reply_info::rrset_count' data-ref="reply_info::rrset_count" data-ref-filename="reply_info..rrset_count">rrset_count</a>++;</td></tr>
<tr><th id="284">284</th><td>	<a class="local col6 ref" href="#226msg" title='msg' data-ref="226msg" data-ref-filename="226msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::ar_numrrsets" title='reply_info::ar_numrrsets' data-ref="reply_info::ar_numrrsets" data-ref-filename="reply_info..ar_numrrsets">ar_numrrsets</a>++;</td></tr>
<tr><th id="285">285</th><td>	<a class="tu ref fn" href="#msg_ttl" title='msg_ttl' data-use='c' data-ref="msg_ttl" data-ref-filename="msg_ttl">msg_ttl</a>(<a class="local col6 ref" href="#226msg" title='msg' data-ref="226msg" data-ref-filename="226msg">msg</a>);</td></tr>
<tr><th id="286">286</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="287">287</th><td>}</td></tr>
<tr><th id="288">288</th><td></td></tr>
<tr><th id="289">289</th><td><b>struct</b> <a class="type" href="authzone.h.html#auth_zones" title='auth_zones' data-ref="auth_zones" data-ref-filename="auth_zones">auth_zones</a>* <dfn class="decl def fn" id="auth_zones_create" title='auth_zones_create' data-ref="auth_zones_create" data-ref-filename="auth_zones_create">auth_zones_create</dfn>(<em>void</em>)</td></tr>
<tr><th id="290">290</th><td>{</td></tr>
<tr><th id="291">291</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_zones" title='auth_zones' data-ref="auth_zones" data-ref-filename="auth_zones">auth_zones</a>* <dfn class="local col9 decl" id="229az" title='az' data-type='struct auth_zones *' data-ref="229az" data-ref-filename="229az">az</dfn> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_zones" title='auth_zones' data-ref="auth_zones" data-ref-filename="auth_zones">auth_zones</a>*)<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#calloc" title='calloc' data-ref="calloc" data-ref-filename="calloc">calloc</a>(<var>1</var>, <b>sizeof</b>(*<a class="local col9 ref" href="#229az" title='az' data-ref="229az" data-ref-filename="229az">az</a>));</td></tr>
<tr><th id="292">292</th><td>	<b>if</b>(!<a class="local col9 ref" href="#229az" title='az' data-ref="229az" data-ref-filename="229az">az</a>) {</td></tr>
<tr><th id="293">293</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"out of memory"</q>);</td></tr>
<tr><th id="294">294</th><td>		<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="295">295</th><td>	}</td></tr>
<tr><th id="296">296</th><td>	<a class="ref fn" href="../util/rbtree.h.html#rbtree_init" title='rbtree_init' data-ref="rbtree_init" data-ref-filename="rbtree_init">rbtree_init</a>(&amp;<a class="local col9 ref" href="#229az" title='az' data-ref="229az" data-ref-filename="229az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::ztree" title='auth_zones::ztree' data-ref="auth_zones::ztree" data-ref-filename="auth_zones..ztree">ztree</a>, &amp;<a class="ref fn" href="#auth_zone_cmp" title='auth_zone_cmp' data-ref="auth_zone_cmp" data-ref-filename="auth_zone_cmp">auth_zone_cmp</a>);</td></tr>
<tr><th id="297">297</th><td>	<a class="ref fn" href="../util/rbtree.h.html#rbtree_init" title='rbtree_init' data-ref="rbtree_init" data-ref-filename="rbtree_init">rbtree_init</a>(&amp;<a class="local col9 ref" href="#229az" title='az' data-ref="229az" data-ref-filename="229az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::xtree" title='auth_zones::xtree' data-ref="auth_zones::xtree" data-ref-filename="auth_zones..xtree">xtree</a>, &amp;<a class="ref fn" href="#auth_xfer_cmp" title='auth_xfer_cmp' data-ref="auth_xfer_cmp" data-ref-filename="auth_xfer_cmp">auth_xfer_cmp</a>);</td></tr>
<tr><th id="298">298</th><td>	<a class="macro" href="../util/locks.h.html#117" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_init(&amp;az-&gt;lock, ((void*)0)))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_init(&amp;az-&gt;lock, NULL)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 298, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_init">lock_rw_init</a>(&amp;<a class="local col9 ref" href="#229az" title='az' data-ref="229az" data-ref-filename="229az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="299">299</th><td>	<a class="macro" href="../util/locks.h.html#86" title="" data-ref="_M/lock_protect">lock_protect</a>(&amp;az-&gt;lock, &amp;az-&gt;ztree, <b>sizeof</b>(az-&gt;ztree));</td></tr>
<tr><th id="300">300</th><td>	<a class="macro" href="../util/locks.h.html#86" title="" data-ref="_M/lock_protect">lock_protect</a>(&amp;az-&gt;lock, &amp;az-&gt;xtree, <b>sizeof</b>(az-&gt;xtree));</td></tr>
<tr><th id="301">301</th><td>	<i>/* also lock protects the rbnode's in struct auth_zone, auth_xfer */</i></td></tr>
<tr><th id="302">302</th><td>	<b>return</b> <a class="local col9 ref" href="#229az" title='az' data-ref="229az" data-ref-filename="229az">az</a>;</td></tr>
<tr><th id="303">303</th><td>}</td></tr>
<tr><th id="304">304</th><td></td></tr>
<tr><th id="305">305</th><td><em>int</em> <dfn class="decl def fn" id="auth_zone_cmp" title='auth_zone_cmp' data-ref="auth_zone_cmp" data-ref-filename="auth_zone_cmp">auth_zone_cmp</dfn>(<em>const</em> <em>void</em>* <dfn class="local col0 decl" id="230z1" title='z1' data-type='const void *' data-ref="230z1" data-ref-filename="230z1">z1</dfn>, <em>const</em> <em>void</em>* <dfn class="local col1 decl" id="231z2" title='z2' data-type='const void *' data-ref="231z2" data-ref-filename="231z2">z2</dfn>)</td></tr>
<tr><th id="306">306</th><td>{</td></tr>
<tr><th id="307">307</th><td>	<i>/* first sort on class, so that hierarchy can be maintained within</i></td></tr>
<tr><th id="308">308</th><td><i>	 * a class */</i></td></tr>
<tr><th id="309">309</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col2 decl" id="232a" title='a' data-type='struct auth_zone *' data-ref="232a" data-ref-filename="232a">a</dfn> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>*)<a class="local col0 ref" href="#230z1" title='z1' data-ref="230z1" data-ref-filename="230z1">z1</a>;</td></tr>
<tr><th id="310">310</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col3 decl" id="233b" title='b' data-type='struct auth_zone *' data-ref="233b" data-ref-filename="233b">b</dfn> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>*)<a class="local col1 ref" href="#231z2" title='z2' data-ref="231z2" data-ref-filename="231z2">z2</a>;</td></tr>
<tr><th id="311">311</th><td>	<em>int</em> <dfn class="local col4 decl" id="234m" title='m' data-type='int' data-ref="234m" data-ref-filename="234m">m</dfn>;</td></tr>
<tr><th id="312">312</th><td>	<b>if</b>(<a class="local col2 ref" href="#232a" title='a' data-ref="232a" data-ref-filename="232a">a</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::dclass" title='auth_zone::dclass' data-ref="auth_zone::dclass" data-ref-filename="auth_zone..dclass">dclass</a> != <a class="local col3 ref" href="#233b" title='b' data-ref="233b" data-ref-filename="233b">b</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::dclass" title='auth_zone::dclass' data-ref="auth_zone::dclass" data-ref-filename="auth_zone..dclass">dclass</a>) {</td></tr>
<tr><th id="313">313</th><td>		<b>if</b>(<a class="local col2 ref" href="#232a" title='a' data-ref="232a" data-ref-filename="232a">a</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::dclass" title='auth_zone::dclass' data-ref="auth_zone::dclass" data-ref-filename="auth_zone..dclass">dclass</a> &lt; <a class="local col3 ref" href="#233b" title='b' data-ref="233b" data-ref-filename="233b">b</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::dclass" title='auth_zone::dclass' data-ref="auth_zone::dclass" data-ref-filename="auth_zone..dclass">dclass</a>)</td></tr>
<tr><th id="314">314</th><td>			<b>return</b> -<var>1</var>;</td></tr>
<tr><th id="315">315</th><td>		<b>return</b> <var>1</var>;</td></tr>
<tr><th id="316">316</th><td>	}</td></tr>
<tr><th id="317">317</th><td>	<i>/* sorted such that higher zones sort before lower zones (their</i></td></tr>
<tr><th id="318">318</th><td><i>	 * contents) */</i></td></tr>
<tr><th id="319">319</th><td>	<b>return</b> <a class="ref fn" href="../util/data/dname.h.html#dname_lab_cmp" title='dname_lab_cmp' data-ref="dname_lab_cmp" data-ref-filename="dname_lab_cmp">dname_lab_cmp</a>(<a class="local col2 ref" href="#232a" title='a' data-ref="232a" data-ref-filename="232a">a</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::name" title='auth_zone::name' data-ref="auth_zone::name" data-ref-filename="auth_zone..name">name</a>, <a class="local col2 ref" href="#232a" title='a' data-ref="232a" data-ref-filename="232a">a</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::namelabs" title='auth_zone::namelabs' data-ref="auth_zone::namelabs" data-ref-filename="auth_zone..namelabs">namelabs</a>, <a class="local col3 ref" href="#233b" title='b' data-ref="233b" data-ref-filename="233b">b</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::name" title='auth_zone::name' data-ref="auth_zone::name" data-ref-filename="auth_zone..name">name</a>, <a class="local col3 ref" href="#233b" title='b' data-ref="233b" data-ref-filename="233b">b</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::namelabs" title='auth_zone::namelabs' data-ref="auth_zone::namelabs" data-ref-filename="auth_zone..namelabs">namelabs</a>, &amp;<a class="local col4 ref" href="#234m" title='m' data-ref="234m" data-ref-filename="234m">m</a>);</td></tr>
<tr><th id="320">320</th><td>}</td></tr>
<tr><th id="321">321</th><td></td></tr>
<tr><th id="322">322</th><td><em>int</em> <dfn class="decl def fn" id="auth_data_cmp" title='auth_data_cmp' data-ref="auth_data_cmp" data-ref-filename="auth_data_cmp">auth_data_cmp</dfn>(<em>const</em> <em>void</em>* <dfn class="local col5 decl" id="235z1" title='z1' data-type='const void *' data-ref="235z1" data-ref-filename="235z1">z1</dfn>, <em>const</em> <em>void</em>* <dfn class="local col6 decl" id="236z2" title='z2' data-type='const void *' data-ref="236z2" data-ref-filename="236z2">z2</dfn>)</td></tr>
<tr><th id="323">323</th><td>{</td></tr>
<tr><th id="324">324</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col7 decl" id="237a" title='a' data-type='struct auth_data *' data-ref="237a" data-ref-filename="237a">a</dfn> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>*)<a class="local col5 ref" href="#235z1" title='z1' data-ref="235z1" data-ref-filename="235z1">z1</a>;</td></tr>
<tr><th id="325">325</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col8 decl" id="238b" title='b' data-type='struct auth_data *' data-ref="238b" data-ref-filename="238b">b</dfn> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>*)<a class="local col6 ref" href="#236z2" title='z2' data-ref="236z2" data-ref-filename="236z2">z2</a>;</td></tr>
<tr><th id="326">326</th><td>	<em>int</em> <dfn class="local col9 decl" id="239m" title='m' data-type='int' data-ref="239m" data-ref-filename="239m">m</dfn>;</td></tr>
<tr><th id="327">327</th><td>	<i>/* canonical sort, because DNSSEC needs that */</i></td></tr>
<tr><th id="328">328</th><td>	<b>return</b> <a class="ref fn" href="../util/data/dname.h.html#dname_canon_lab_cmp" title='dname_canon_lab_cmp' data-ref="dname_canon_lab_cmp" data-ref-filename="dname_canon_lab_cmp">dname_canon_lab_cmp</a>(<a class="local col7 ref" href="#237a" title='a' data-ref="237a" data-ref-filename="237a">a</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::name" title='auth_data::name' data-ref="auth_data::name" data-ref-filename="auth_data..name">name</a>, <a class="local col7 ref" href="#237a" title='a' data-ref="237a" data-ref-filename="237a">a</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::namelabs" title='auth_data::namelabs' data-ref="auth_data::namelabs" data-ref-filename="auth_data..namelabs">namelabs</a>, <a class="local col8 ref" href="#238b" title='b' data-ref="238b" data-ref-filename="238b">b</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::name" title='auth_data::name' data-ref="auth_data::name" data-ref-filename="auth_data..name">name</a>,</td></tr>
<tr><th id="329">329</th><td>		<a class="local col8 ref" href="#238b" title='b' data-ref="238b" data-ref-filename="238b">b</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::namelabs" title='auth_data::namelabs' data-ref="auth_data::namelabs" data-ref-filename="auth_data..namelabs">namelabs</a>, &amp;<a class="local col9 ref" href="#239m" title='m' data-ref="239m" data-ref-filename="239m">m</a>);</td></tr>
<tr><th id="330">330</th><td>}</td></tr>
<tr><th id="331">331</th><td></td></tr>
<tr><th id="332">332</th><td><em>int</em> <dfn class="decl def fn" id="auth_xfer_cmp" title='auth_xfer_cmp' data-ref="auth_xfer_cmp" data-ref-filename="auth_xfer_cmp">auth_xfer_cmp</dfn>(<em>const</em> <em>void</em>* <dfn class="local col0 decl" id="240z1" title='z1' data-type='const void *' data-ref="240z1" data-ref-filename="240z1">z1</dfn>, <em>const</em> <em>void</em>* <dfn class="local col1 decl" id="241z2" title='z2' data-type='const void *' data-ref="241z2" data-ref-filename="241z2">z2</dfn>)</td></tr>
<tr><th id="333">333</th><td>{</td></tr>
<tr><th id="334">334</th><td>	<i>/* first sort on class, so that hierarchy can be maintained within</i></td></tr>
<tr><th id="335">335</th><td><i>	 * a class */</i></td></tr>
<tr><th id="336">336</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col2 decl" id="242a" title='a' data-type='struct auth_xfer *' data-ref="242a" data-ref-filename="242a">a</dfn> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>*)<a class="local col0 ref" href="#240z1" title='z1' data-ref="240z1" data-ref-filename="240z1">z1</a>;</td></tr>
<tr><th id="337">337</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col3 decl" id="243b" title='b' data-type='struct auth_xfer *' data-ref="243b" data-ref-filename="243b">b</dfn> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>*)<a class="local col1 ref" href="#241z2" title='z2' data-ref="241z2" data-ref-filename="241z2">z2</a>;</td></tr>
<tr><th id="338">338</th><td>	<em>int</em> <dfn class="local col4 decl" id="244m" title='m' data-type='int' data-ref="244m" data-ref-filename="244m">m</dfn>;</td></tr>
<tr><th id="339">339</th><td>	<b>if</b>(<a class="local col2 ref" href="#242a" title='a' data-ref="242a" data-ref-filename="242a">a</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::dclass" title='auth_xfer::dclass' data-ref="auth_xfer::dclass" data-ref-filename="auth_xfer..dclass">dclass</a> != <a class="local col3 ref" href="#243b" title='b' data-ref="243b" data-ref-filename="243b">b</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::dclass" title='auth_xfer::dclass' data-ref="auth_xfer::dclass" data-ref-filename="auth_xfer..dclass">dclass</a>) {</td></tr>
<tr><th id="340">340</th><td>		<b>if</b>(<a class="local col2 ref" href="#242a" title='a' data-ref="242a" data-ref-filename="242a">a</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::dclass" title='auth_xfer::dclass' data-ref="auth_xfer::dclass" data-ref-filename="auth_xfer..dclass">dclass</a> &lt; <a class="local col3 ref" href="#243b" title='b' data-ref="243b" data-ref-filename="243b">b</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::dclass" title='auth_xfer::dclass' data-ref="auth_xfer::dclass" data-ref-filename="auth_xfer..dclass">dclass</a>)</td></tr>
<tr><th id="341">341</th><td>			<b>return</b> -<var>1</var>;</td></tr>
<tr><th id="342">342</th><td>		<b>return</b> <var>1</var>;</td></tr>
<tr><th id="343">343</th><td>	}</td></tr>
<tr><th id="344">344</th><td>	<i>/* sorted such that higher zones sort before lower zones (their</i></td></tr>
<tr><th id="345">345</th><td><i>	 * contents) */</i></td></tr>
<tr><th id="346">346</th><td>	<b>return</b> <a class="ref fn" href="../util/data/dname.h.html#dname_lab_cmp" title='dname_lab_cmp' data-ref="dname_lab_cmp" data-ref-filename="dname_lab_cmp">dname_lab_cmp</a>(<a class="local col2 ref" href="#242a" title='a' data-ref="242a" data-ref-filename="242a">a</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a>, <a class="local col2 ref" href="#242a" title='a' data-ref="242a" data-ref-filename="242a">a</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::namelabs" title='auth_xfer::namelabs' data-ref="auth_xfer::namelabs" data-ref-filename="auth_xfer..namelabs">namelabs</a>, <a class="local col3 ref" href="#243b" title='b' data-ref="243b" data-ref-filename="243b">b</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a>, <a class="local col3 ref" href="#243b" title='b' data-ref="243b" data-ref-filename="243b">b</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::namelabs" title='auth_xfer::namelabs' data-ref="auth_xfer::namelabs" data-ref-filename="auth_xfer..namelabs">namelabs</a>, &amp;<a class="local col4 ref" href="#244m" title='m' data-ref="244m" data-ref-filename="244m">m</a>);</td></tr>
<tr><th id="347">347</th><td>}</td></tr>
<tr><th id="348">348</th><td></td></tr>
<tr><th id="349">349</th><td><i class="doc" data-doc="auth_rrset_delete">/** delete auth rrset node */</i></td></tr>
<tr><th id="350">350</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="351">351</th><td><dfn class="tu decl def fn" id="auth_rrset_delete" title='auth_rrset_delete' data-type='void auth_rrset_delete(struct auth_rrset * rrset)' data-ref="auth_rrset_delete" data-ref-filename="auth_rrset_delete">auth_rrset_delete</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col5 decl" id="245rrset" title='rrset' data-type='struct auth_rrset *' data-ref="245rrset" data-ref-filename="245rrset">rrset</dfn>)</td></tr>
<tr><th id="352">352</th><td>{</td></tr>
<tr><th id="353">353</th><td>	<b>if</b>(!<a class="local col5 ref" href="#245rrset" title='rrset' data-ref="245rrset" data-ref-filename="245rrset">rrset</a>) <b>return</b>;</td></tr>
<tr><th id="354">354</th><td>	<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col5 ref" href="#245rrset" title='rrset' data-ref="245rrset" data-ref-filename="245rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>);</td></tr>
<tr><th id="355">355</th><td>	<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col5 ref" href="#245rrset" title='rrset' data-ref="245rrset" data-ref-filename="245rrset">rrset</a>);</td></tr>
<tr><th id="356">356</th><td>}</td></tr>
<tr><th id="357">357</th><td></td></tr>
<tr><th id="358">358</th><td><i class="doc" data-doc="auth_data_delete">/** delete auth data domain node */</i></td></tr>
<tr><th id="359">359</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="360">360</th><td><dfn class="tu decl def fn" id="auth_data_delete" title='auth_data_delete' data-type='void auth_data_delete(struct auth_data * n)' data-ref="auth_data_delete" data-ref-filename="auth_data_delete">auth_data_delete</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col6 decl" id="246n" title='n' data-type='struct auth_data *' data-ref="246n" data-ref-filename="246n">n</dfn>)</td></tr>
<tr><th id="361">361</th><td>{</td></tr>
<tr><th id="362">362</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col7 decl" id="247p" title='p' data-type='struct auth_rrset *' data-ref="247p" data-ref-filename="247p">p</dfn>, *<dfn class="local col8 decl" id="248np" title='np' data-type='struct auth_rrset *' data-ref="248np" data-ref-filename="248np">np</dfn>;</td></tr>
<tr><th id="363">363</th><td>	<b>if</b>(!<a class="local col6 ref" href="#246n" title='n' data-ref="246n" data-ref-filename="246n">n</a>) <b>return</b>;</td></tr>
<tr><th id="364">364</th><td>	<a class="local col7 ref" href="#247p" title='p' data-ref="247p" data-ref-filename="247p">p</a> = <a class="local col6 ref" href="#246n" title='n' data-ref="246n" data-ref-filename="246n">n</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::rrsets" title='auth_data::rrsets' data-ref="auth_data::rrsets" data-ref-filename="auth_data..rrsets">rrsets</a>;</td></tr>
<tr><th id="365">365</th><td>	<b>while</b>(<a class="local col7 ref" href="#247p" title='p' data-ref="247p" data-ref-filename="247p">p</a>) {</td></tr>
<tr><th id="366">366</th><td>		<a class="local col8 ref" href="#248np" title='np' data-ref="248np" data-ref-filename="248np">np</a> = <a class="local col7 ref" href="#247p" title='p' data-ref="247p" data-ref-filename="247p">p</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::next" title='auth_rrset::next' data-ref="auth_rrset::next" data-ref-filename="auth_rrset..next">next</a>;</td></tr>
<tr><th id="367">367</th><td>		<a class="tu ref fn" href="#auth_rrset_delete" title='auth_rrset_delete' data-use='c' data-ref="auth_rrset_delete" data-ref-filename="auth_rrset_delete">auth_rrset_delete</a>(<a class="local col7 ref" href="#247p" title='p' data-ref="247p" data-ref-filename="247p">p</a>);</td></tr>
<tr><th id="368">368</th><td>		<a class="local col7 ref" href="#247p" title='p' data-ref="247p" data-ref-filename="247p">p</a> = <a class="local col8 ref" href="#248np" title='np' data-ref="248np" data-ref-filename="248np">np</a>;</td></tr>
<tr><th id="369">369</th><td>	}</td></tr>
<tr><th id="370">370</th><td>	<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col6 ref" href="#246n" title='n' data-ref="246n" data-ref-filename="246n">n</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::name" title='auth_data::name' data-ref="auth_data::name" data-ref-filename="auth_data..name">name</a>);</td></tr>
<tr><th id="371">371</th><td>	<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col6 ref" href="#246n" title='n' data-ref="246n" data-ref-filename="246n">n</a>);</td></tr>
<tr><th id="372">372</th><td>}</td></tr>
<tr><th id="373">373</th><td></td></tr>
<tr><th id="374">374</th><td><i class="doc" data-doc="auth_data_del">/** helper traverse to delete zones */</i></td></tr>
<tr><th id="375">375</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="376">376</th><td><dfn class="tu decl def fn" id="auth_data_del" title='auth_data_del' data-type='void auth_data_del(rbnode_type * n, void * arg)' data-ref="auth_data_del" data-ref-filename="auth_data_del">auth_data_del</dfn>(<a class="typedef" href="../util/rbtree.h.html#rbnode_type" title='rbnode_type' data-type='struct rbnode_type' data-ref="rbnode_type" data-ref-filename="rbnode_type">rbnode_type</a>* <dfn class="local col9 decl" id="249n" title='n' data-type='rbnode_type *' data-ref="249n" data-ref-filename="249n">n</dfn>, <em>void</em>* <a class="macro" href="../../include/config.h.html#1057" title="arg __attribute__((unused))" data-ref="_M/ATTR_UNUSED">ATTR_UNUSED</a>(<dfn class="local col0 decl" id="250arg" title='arg' data-type='void *' data-ref="250arg" data-ref-filename="250arg">arg</dfn>))</td></tr>
<tr><th id="377">377</th><td>{</td></tr>
<tr><th id="378">378</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col1 decl" id="251z" title='z' data-type='struct auth_data *' data-ref="251z" data-ref-filename="251z">z</dfn> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>*)<a class="local col9 ref" href="#249n" title='n' data-ref="249n" data-ref-filename="249n">n</a>-&gt;<a class="ref field" href="../util/rbtree.h.html#rbnode_type::key" title='rbnode_type::key' data-ref="rbnode_type::key" data-ref-filename="rbnode_type..key">key</a>;</td></tr>
<tr><th id="379">379</th><td>	<a class="tu ref fn" href="#auth_data_delete" title='auth_data_delete' data-use='c' data-ref="auth_data_delete" data-ref-filename="auth_data_delete">auth_data_delete</a>(<a class="local col1 ref" href="#251z" title='z' data-ref="251z" data-ref-filename="251z">z</a>);</td></tr>
<tr><th id="380">380</th><td>}</td></tr>
<tr><th id="381">381</th><td></td></tr>
<tr><th id="382">382</th><td><i class="doc" data-doc="auth_zone_delete">/** delete an auth zone structure (tree remove must be done elsewhere) */</i></td></tr>
<tr><th id="383">383</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="384">384</th><td><dfn class="tu decl def fn" id="auth_zone_delete" title='auth_zone_delete' data-type='void auth_zone_delete(struct auth_zone * z)' data-ref="auth_zone_delete" data-ref-filename="auth_zone_delete">auth_zone_delete</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col2 decl" id="252z" title='z' data-type='struct auth_zone *' data-ref="252z" data-ref-filename="252z">z</dfn>)</td></tr>
<tr><th id="385">385</th><td>{</td></tr>
<tr><th id="386">386</th><td>	<b>if</b>(!<a class="local col2 ref" href="#252z" title='z' data-ref="252z" data-ref-filename="252z">z</a>) <b>return</b>;</td></tr>
<tr><th id="387">387</th><td>	<a class="macro" href="../util/locks.h.html#118" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_destroy(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_destroy(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 387, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_destroy">lock_rw_destroy</a>(&amp;<a class="local col2 ref" href="#252z" title='z' data-ref="252z" data-ref-filename="252z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="388">388</th><td>	<a class="ref fn" href="../util/rbtree.h.html#traverse_postorder" title='traverse_postorder' data-ref="traverse_postorder" data-ref-filename="traverse_postorder">traverse_postorder</a>(&amp;<a class="local col2 ref" href="#252z" title='z' data-ref="252z" data-ref-filename="252z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::data" title='auth_zone::data' data-ref="auth_zone::data" data-ref-filename="auth_zone..data">data</a>, <a class="tu ref fn" href="#auth_data_del" title='auth_data_del' data-use='r' data-ref="auth_data_del" data-ref-filename="auth_data_del">auth_data_del</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="389">389</th><td>	<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col2 ref" href="#252z" title='z' data-ref="252z" data-ref-filename="252z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::name" title='auth_zone::name' data-ref="auth_zone::name" data-ref-filename="auth_zone..name">name</a>);</td></tr>
<tr><th id="390">390</th><td>	<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col2 ref" href="#252z" title='z' data-ref="252z" data-ref-filename="252z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::zonefile" title='auth_zone::zonefile' data-ref="auth_zone::zonefile" data-ref-filename="auth_zone..zonefile">zonefile</a>);</td></tr>
<tr><th id="391">391</th><td>	<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col2 ref" href="#252z" title='z' data-ref="252z" data-ref-filename="252z">z</a>);</td></tr>
<tr><th id="392">392</th><td>}</td></tr>
<tr><th id="393">393</th><td></td></tr>
<tr><th id="394">394</th><td><b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>*</td></tr>
<tr><th id="395">395</th><td><dfn class="decl def fn" id="auth_zone_create" title='auth_zone_create' data-ref="auth_zone_create" data-ref-filename="auth_zone_create">auth_zone_create</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zones" title='auth_zones' data-ref="auth_zones" data-ref-filename="auth_zones">auth_zones</a>* <dfn class="local col3 decl" id="253az" title='az' data-type='struct auth_zones *' data-ref="253az" data-ref-filename="253az">az</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col4 decl" id="254nm" title='nm' data-type='uint8_t *' data-ref="254nm" data-ref-filename="254nm">nm</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col5 decl" id="255nmlen" title='nmlen' data-type='size_t' data-ref="255nmlen" data-ref-filename="255nmlen">nmlen</dfn>,</td></tr>
<tr><th id="396">396</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col6 decl" id="256dclass" title='dclass' data-type='uint16_t' data-ref="256dclass" data-ref-filename="256dclass">dclass</dfn>)</td></tr>
<tr><th id="397">397</th><td>{</td></tr>
<tr><th id="398">398</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col7 decl" id="257z" title='z' data-type='struct auth_zone *' data-ref="257z" data-ref-filename="257z">z</dfn> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>*)<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#calloc" title='calloc' data-ref="calloc" data-ref-filename="calloc">calloc</a>(<var>1</var>, <b>sizeof</b>(*<a class="local col7 ref" href="#257z" title='z' data-ref="257z" data-ref-filename="257z">z</a>));</td></tr>
<tr><th id="399">399</th><td>	<b>if</b>(!<a class="local col7 ref" href="#257z" title='z' data-ref="257z" data-ref-filename="257z">z</a>) {</td></tr>
<tr><th id="400">400</th><td>		<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="401">401</th><td>	}</td></tr>
<tr><th id="402">402</th><td>	<a class="local col7 ref" href="#257z" title='z' data-ref="257z" data-ref-filename="257z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::node" title='auth_zone::node' data-ref="auth_zone::node" data-ref-filename="auth_zone..node">node</a>.<a class="ref field" href="../util/rbtree.h.html#rbnode_type::key" title='rbnode_type::key' data-ref="rbnode_type::key" data-ref-filename="rbnode_type..key">key</a> = <a class="local col7 ref" href="#257z" title='z' data-ref="257z" data-ref-filename="257z">z</a>;</td></tr>
<tr><th id="403">403</th><td>	<a class="local col7 ref" href="#257z" title='z' data-ref="257z" data-ref-filename="257z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::dclass" title='auth_zone::dclass' data-ref="auth_zone::dclass" data-ref-filename="auth_zone..dclass">dclass</a> = <a class="local col6 ref" href="#256dclass" title='dclass' data-ref="256dclass" data-ref-filename="256dclass">dclass</a>;</td></tr>
<tr><th id="404">404</th><td>	<a class="local col7 ref" href="#257z" title='z' data-ref="257z" data-ref-filename="257z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::namelen" title='auth_zone::namelen' data-ref="auth_zone::namelen" data-ref-filename="auth_zone..namelen">namelen</a> = <a class="local col5 ref" href="#255nmlen" title='nmlen' data-ref="255nmlen" data-ref-filename="255nmlen">nmlen</a>;</td></tr>
<tr><th id="405">405</th><td>	<a class="local col7 ref" href="#257z" title='z' data-ref="257z" data-ref-filename="257z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::namelabs" title='auth_zone::namelabs' data-ref="auth_zone::namelabs" data-ref-filename="auth_zone..namelabs">namelabs</a> = <a class="ref fn" href="../util/data/dname.h.html#dname_count_labels" title='dname_count_labels' data-ref="dname_count_labels" data-ref-filename="dname_count_labels">dname_count_labels</a>(<a class="local col4 ref" href="#254nm" title='nm' data-ref="254nm" data-ref-filename="254nm">nm</a>);</td></tr>
<tr><th id="406">406</th><td>	<a class="local col7 ref" href="#257z" title='z' data-ref="257z" data-ref-filename="257z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::name" title='auth_zone::name' data-ref="auth_zone::name" data-ref-filename="auth_zone..name">name</a> = <a class="ref fn" href="../util/net_help.h.html#memdup" title='memdup' data-ref="memdup" data-ref-filename="memdup">memdup</a>(<a class="local col4 ref" href="#254nm" title='nm' data-ref="254nm" data-ref-filename="254nm">nm</a>, <a class="local col5 ref" href="#255nmlen" title='nmlen' data-ref="255nmlen" data-ref-filename="255nmlen">nmlen</a>);</td></tr>
<tr><th id="407">407</th><td>	<b>if</b>(!<a class="local col7 ref" href="#257z" title='z' data-ref="257z" data-ref-filename="257z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::name" title='auth_zone::name' data-ref="auth_zone::name" data-ref-filename="auth_zone..name">name</a>) {</td></tr>
<tr><th id="408">408</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col7 ref" href="#257z" title='z' data-ref="257z" data-ref-filename="257z">z</a>);</td></tr>
<tr><th id="409">409</th><td>		<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="410">410</th><td>	}</td></tr>
<tr><th id="411">411</th><td>	<a class="ref fn" href="../util/rbtree.h.html#rbtree_init" title='rbtree_init' data-ref="rbtree_init" data-ref-filename="rbtree_init">rbtree_init</a>(&amp;<a class="local col7 ref" href="#257z" title='z' data-ref="257z" data-ref-filename="257z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::data" title='auth_zone::data' data-ref="auth_zone::data" data-ref-filename="auth_zone..data">data</a>, &amp;<a class="ref fn" href="#auth_data_cmp" title='auth_data_cmp' data-ref="auth_data_cmp" data-ref-filename="auth_data_cmp">auth_data_cmp</a>);</td></tr>
<tr><th id="412">412</th><td>	<a class="macro" href="../util/locks.h.html#117" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_init(&amp;z-&gt;lock, ((void*)0)))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_init(&amp;z-&gt;lock, NULL)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 412, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_init">lock_rw_init</a>(&amp;<a class="local col7 ref" href="#257z" title='z' data-ref="257z" data-ref-filename="257z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="413">413</th><td>	<a class="macro" href="../util/locks.h.html#86" title="" data-ref="_M/lock_protect">lock_protect</a>(&amp;z-&gt;lock, &amp;z-&gt;name, <b>sizeof</b>(*z)-<b>sizeof</b>(rbnode_type));</td></tr>
<tr><th id="414">414</th><td>	<a class="macro" href="../util/locks.h.html#120" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_wrlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_wrlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 414, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_wrlock">lock_rw_wrlock</a>(&amp;<a class="local col7 ref" href="#257z" title='z' data-ref="257z" data-ref-filename="257z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="415">415</th><td>	<i>/* z lock protects all, except rbtree itself, which is az-&gt;lock */</i></td></tr>
<tr><th id="416">416</th><td>	<b>if</b>(!<a class="ref fn" href="../util/rbtree.h.html#rbtree_insert" title='rbtree_insert' data-ref="rbtree_insert" data-ref-filename="rbtree_insert">rbtree_insert</a>(&amp;<a class="local col3 ref" href="#253az" title='az' data-ref="253az" data-ref-filename="253az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::ztree" title='auth_zones::ztree' data-ref="auth_zones::ztree" data-ref-filename="auth_zones..ztree">ztree</a>, &amp;<a class="local col7 ref" href="#257z" title='z' data-ref="257z" data-ref-filename="257z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::node" title='auth_zone::node' data-ref="auth_zone::node" data-ref-filename="auth_zone..node">node</a>)) {</td></tr>
<tr><th id="417">417</th><td>		<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 417, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col7 ref" href="#257z" title='z' data-ref="257z" data-ref-filename="257z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="418">418</th><td>		<a class="tu ref fn" href="#auth_zone_delete" title='auth_zone_delete' data-use='c' data-ref="auth_zone_delete" data-ref-filename="auth_zone_delete">auth_zone_delete</a>(<a class="local col7 ref" href="#257z" title='z' data-ref="257z" data-ref-filename="257z">z</a>);</td></tr>
<tr><th id="419">419</th><td>		<a class="ref fn" href="../util/log.h.html#log_warn" title='log_warn' data-ref="log_warn" data-ref-filename="log_warn">log_warn</a>(<q>"duplicate auth zone"</q>);</td></tr>
<tr><th id="420">420</th><td>		<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="421">421</th><td>	}</td></tr>
<tr><th id="422">422</th><td>	<b>return</b> <a class="local col7 ref" href="#257z" title='z' data-ref="257z" data-ref-filename="257z">z</a>;</td></tr>
<tr><th id="423">423</th><td>}</td></tr>
<tr><th id="424">424</th><td></td></tr>
<tr><th id="425">425</th><td><b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>*</td></tr>
<tr><th id="426">426</th><td><dfn class="decl def fn" id="auth_zone_find" title='auth_zone_find' data-ref="auth_zone_find" data-ref-filename="auth_zone_find">auth_zone_find</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zones" title='auth_zones' data-ref="auth_zones" data-ref-filename="auth_zones">auth_zones</a>* <dfn class="local col8 decl" id="258az" title='az' data-type='struct auth_zones *' data-ref="258az" data-ref-filename="258az">az</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col9 decl" id="259nm" title='nm' data-type='uint8_t *' data-ref="259nm" data-ref-filename="259nm">nm</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col0 decl" id="260nmlen" title='nmlen' data-type='size_t' data-ref="260nmlen" data-ref-filename="260nmlen">nmlen</dfn>,</td></tr>
<tr><th id="427">427</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col1 decl" id="261dclass" title='dclass' data-type='uint16_t' data-ref="261dclass" data-ref-filename="261dclass">dclass</dfn>)</td></tr>
<tr><th id="428">428</th><td>{</td></tr>
<tr><th id="429">429</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a> <dfn class="local col2 decl" id="262key" title='key' data-type='struct auth_zone' data-ref="262key" data-ref-filename="262key">key</dfn>;</td></tr>
<tr><th id="430">430</th><td>	<a class="local col2 ref" href="#262key" title='key' data-ref="262key" data-ref-filename="262key">key</a>.<a class="ref field" href="authzone.h.html#auth_zone::node" title='auth_zone::node' data-ref="auth_zone::node" data-ref-filename="auth_zone..node">node</a>.<a class="ref field" href="../util/rbtree.h.html#rbnode_type::key" title='rbnode_type::key' data-ref="rbnode_type::key" data-ref-filename="rbnode_type..key">key</a> = &amp;<a class="local col2 ref" href="#262key" title='key' data-ref="262key" data-ref-filename="262key">key</a>;</td></tr>
<tr><th id="431">431</th><td>	<a class="local col2 ref" href="#262key" title='key' data-ref="262key" data-ref-filename="262key">key</a>.<a class="ref field" href="authzone.h.html#auth_zone::dclass" title='auth_zone::dclass' data-ref="auth_zone::dclass" data-ref-filename="auth_zone..dclass">dclass</a> = <a class="local col1 ref" href="#261dclass" title='dclass' data-ref="261dclass" data-ref-filename="261dclass">dclass</a>;</td></tr>
<tr><th id="432">432</th><td>	<a class="local col2 ref" href="#262key" title='key' data-ref="262key" data-ref-filename="262key">key</a>.<a class="ref field" href="authzone.h.html#auth_zone::name" title='auth_zone::name' data-ref="auth_zone::name" data-ref-filename="auth_zone..name">name</a> = <a class="local col9 ref" href="#259nm" title='nm' data-ref="259nm" data-ref-filename="259nm">nm</a>;</td></tr>
<tr><th id="433">433</th><td>	<a class="local col2 ref" href="#262key" title='key' data-ref="262key" data-ref-filename="262key">key</a>.<a class="ref field" href="authzone.h.html#auth_zone::namelen" title='auth_zone::namelen' data-ref="auth_zone::namelen" data-ref-filename="auth_zone..namelen">namelen</a> = <a class="local col0 ref" href="#260nmlen" title='nmlen' data-ref="260nmlen" data-ref-filename="260nmlen">nmlen</a>;</td></tr>
<tr><th id="434">434</th><td>	<a class="local col2 ref" href="#262key" title='key' data-ref="262key" data-ref-filename="262key">key</a>.<a class="ref field" href="authzone.h.html#auth_zone::namelabs" title='auth_zone::namelabs' data-ref="auth_zone::namelabs" data-ref-filename="auth_zone..namelabs">namelabs</a> = <a class="ref fn" href="../util/data/dname.h.html#dname_count_labels" title='dname_count_labels' data-ref="dname_count_labels" data-ref-filename="dname_count_labels">dname_count_labels</a>(<a class="local col9 ref" href="#259nm" title='nm' data-ref="259nm" data-ref-filename="259nm">nm</a>);</td></tr>
<tr><th id="435">435</th><td>	<b>return</b> (<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>*)<a class="ref fn" href="../util/rbtree.h.html#rbtree_search" title='rbtree_search' data-ref="rbtree_search" data-ref-filename="rbtree_search">rbtree_search</a>(&amp;<a class="local col8 ref" href="#258az" title='az' data-ref="258az" data-ref-filename="258az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::ztree" title='auth_zones::ztree' data-ref="auth_zones::ztree" data-ref-filename="auth_zones..ztree">ztree</a>, &amp;<a class="local col2 ref" href="#262key" title='key' data-ref="262key" data-ref-filename="262key">key</a>);</td></tr>
<tr><th id="436">436</th><td>}</td></tr>
<tr><th id="437">437</th><td></td></tr>
<tr><th id="438">438</th><td><b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>*</td></tr>
<tr><th id="439">439</th><td><dfn class="decl def fn" id="auth_xfer_find" title='auth_xfer_find' data-ref="auth_xfer_find" data-ref-filename="auth_xfer_find">auth_xfer_find</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zones" title='auth_zones' data-ref="auth_zones" data-ref-filename="auth_zones">auth_zones</a>* <dfn class="local col3 decl" id="263az" title='az' data-type='struct auth_zones *' data-ref="263az" data-ref-filename="263az">az</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col4 decl" id="264nm" title='nm' data-type='uint8_t *' data-ref="264nm" data-ref-filename="264nm">nm</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col5 decl" id="265nmlen" title='nmlen' data-type='size_t' data-ref="265nmlen" data-ref-filename="265nmlen">nmlen</dfn>,</td></tr>
<tr><th id="440">440</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col6 decl" id="266dclass" title='dclass' data-type='uint16_t' data-ref="266dclass" data-ref-filename="266dclass">dclass</dfn>)</td></tr>
<tr><th id="441">441</th><td>{</td></tr>
<tr><th id="442">442</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a> <dfn class="local col7 decl" id="267key" title='key' data-type='struct auth_xfer' data-ref="267key" data-ref-filename="267key">key</dfn>;</td></tr>
<tr><th id="443">443</th><td>	<a class="local col7 ref" href="#267key" title='key' data-ref="267key" data-ref-filename="267key">key</a>.<a class="ref field" href="authzone.h.html#auth_xfer::node" title='auth_xfer::node' data-ref="auth_xfer::node" data-ref-filename="auth_xfer..node">node</a>.<a class="ref field" href="../util/rbtree.h.html#rbnode_type::key" title='rbnode_type::key' data-ref="rbnode_type::key" data-ref-filename="rbnode_type..key">key</a> = &amp;<a class="local col7 ref" href="#267key" title='key' data-ref="267key" data-ref-filename="267key">key</a>;</td></tr>
<tr><th id="444">444</th><td>	<a class="local col7 ref" href="#267key" title='key' data-ref="267key" data-ref-filename="267key">key</a>.<a class="ref field" href="authzone.h.html#auth_xfer::dclass" title='auth_xfer::dclass' data-ref="auth_xfer::dclass" data-ref-filename="auth_xfer..dclass">dclass</a> = <a class="local col6 ref" href="#266dclass" title='dclass' data-ref="266dclass" data-ref-filename="266dclass">dclass</a>;</td></tr>
<tr><th id="445">445</th><td>	<a class="local col7 ref" href="#267key" title='key' data-ref="267key" data-ref-filename="267key">key</a>.<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a> = <a class="local col4 ref" href="#264nm" title='nm' data-ref="264nm" data-ref-filename="264nm">nm</a>;</td></tr>
<tr><th id="446">446</th><td>	<a class="local col7 ref" href="#267key" title='key' data-ref="267key" data-ref-filename="267key">key</a>.<a class="ref field" href="authzone.h.html#auth_xfer::namelen" title='auth_xfer::namelen' data-ref="auth_xfer::namelen" data-ref-filename="auth_xfer..namelen">namelen</a> = <a class="local col5 ref" href="#265nmlen" title='nmlen' data-ref="265nmlen" data-ref-filename="265nmlen">nmlen</a>;</td></tr>
<tr><th id="447">447</th><td>	<a class="local col7 ref" href="#267key" title='key' data-ref="267key" data-ref-filename="267key">key</a>.<a class="ref field" href="authzone.h.html#auth_xfer::namelabs" title='auth_xfer::namelabs' data-ref="auth_xfer::namelabs" data-ref-filename="auth_xfer..namelabs">namelabs</a> = <a class="ref fn" href="../util/data/dname.h.html#dname_count_labels" title='dname_count_labels' data-ref="dname_count_labels" data-ref-filename="dname_count_labels">dname_count_labels</a>(<a class="local col4 ref" href="#264nm" title='nm' data-ref="264nm" data-ref-filename="264nm">nm</a>);</td></tr>
<tr><th id="448">448</th><td>	<b>return</b> (<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>*)<a class="ref fn" href="../util/rbtree.h.html#rbtree_search" title='rbtree_search' data-ref="rbtree_search" data-ref-filename="rbtree_search">rbtree_search</a>(&amp;<a class="local col3 ref" href="#263az" title='az' data-ref="263az" data-ref-filename="263az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::xtree" title='auth_zones::xtree' data-ref="auth_zones::xtree" data-ref-filename="auth_zones..xtree">xtree</a>, &amp;<a class="local col7 ref" href="#267key" title='key' data-ref="267key" data-ref-filename="267key">key</a>);</td></tr>
<tr><th id="449">449</th><td>}</td></tr>
<tr><th id="450">450</th><td></td></tr>
<tr><th id="451">451</th><td><i class="doc" data-doc="auth_zone_find_less_equal">/** find an auth zone or sorted less-or-equal, return true if exact */</i></td></tr>
<tr><th id="452">452</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="453">453</th><td><dfn class="tu decl def fn" id="auth_zone_find_less_equal" title='auth_zone_find_less_equal' data-type='int auth_zone_find_less_equal(struct auth_zones * az, uint8_t * nm, size_t nmlen, uint16_t dclass, struct auth_zone ** z)' data-ref="auth_zone_find_less_equal" data-ref-filename="auth_zone_find_less_equal">auth_zone_find_less_equal</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zones" title='auth_zones' data-ref="auth_zones" data-ref-filename="auth_zones">auth_zones</a>* <dfn class="local col8 decl" id="268az" title='az' data-type='struct auth_zones *' data-ref="268az" data-ref-filename="268az">az</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col9 decl" id="269nm" title='nm' data-type='uint8_t *' data-ref="269nm" data-ref-filename="269nm">nm</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col0 decl" id="270nmlen" title='nmlen' data-type='size_t' data-ref="270nmlen" data-ref-filename="270nmlen">nmlen</dfn>,</td></tr>
<tr><th id="454">454</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col1 decl" id="271dclass" title='dclass' data-type='uint16_t' data-ref="271dclass" data-ref-filename="271dclass">dclass</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>** <dfn class="local col2 decl" id="272z" title='z' data-type='struct auth_zone **' data-ref="272z" data-ref-filename="272z">z</dfn>)</td></tr>
<tr><th id="455">455</th><td>{</td></tr>
<tr><th id="456">456</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a> <dfn class="local col3 decl" id="273key" title='key' data-type='struct auth_zone' data-ref="273key" data-ref-filename="273key">key</dfn>;</td></tr>
<tr><th id="457">457</th><td>	<a class="local col3 ref" href="#273key" title='key' data-ref="273key" data-ref-filename="273key">key</a>.<a class="ref field" href="authzone.h.html#auth_zone::node" title='auth_zone::node' data-ref="auth_zone::node" data-ref-filename="auth_zone..node">node</a>.<a class="ref field" href="../util/rbtree.h.html#rbnode_type::key" title='rbnode_type::key' data-ref="rbnode_type::key" data-ref-filename="rbnode_type..key">key</a> = &amp;<a class="local col3 ref" href="#273key" title='key' data-ref="273key" data-ref-filename="273key">key</a>;</td></tr>
<tr><th id="458">458</th><td>	<a class="local col3 ref" href="#273key" title='key' data-ref="273key" data-ref-filename="273key">key</a>.<a class="ref field" href="authzone.h.html#auth_zone::dclass" title='auth_zone::dclass' data-ref="auth_zone::dclass" data-ref-filename="auth_zone..dclass">dclass</a> = <a class="local col1 ref" href="#271dclass" title='dclass' data-ref="271dclass" data-ref-filename="271dclass">dclass</a>;</td></tr>
<tr><th id="459">459</th><td>	<a class="local col3 ref" href="#273key" title='key' data-ref="273key" data-ref-filename="273key">key</a>.<a class="ref field" href="authzone.h.html#auth_zone::name" title='auth_zone::name' data-ref="auth_zone::name" data-ref-filename="auth_zone..name">name</a> = <a class="local col9 ref" href="#269nm" title='nm' data-ref="269nm" data-ref-filename="269nm">nm</a>;</td></tr>
<tr><th id="460">460</th><td>	<a class="local col3 ref" href="#273key" title='key' data-ref="273key" data-ref-filename="273key">key</a>.<a class="ref field" href="authzone.h.html#auth_zone::namelen" title='auth_zone::namelen' data-ref="auth_zone::namelen" data-ref-filename="auth_zone..namelen">namelen</a> = <a class="local col0 ref" href="#270nmlen" title='nmlen' data-ref="270nmlen" data-ref-filename="270nmlen">nmlen</a>;</td></tr>
<tr><th id="461">461</th><td>	<a class="local col3 ref" href="#273key" title='key' data-ref="273key" data-ref-filename="273key">key</a>.<a class="ref field" href="authzone.h.html#auth_zone::namelabs" title='auth_zone::namelabs' data-ref="auth_zone::namelabs" data-ref-filename="auth_zone..namelabs">namelabs</a> = <a class="ref fn" href="../util/data/dname.h.html#dname_count_labels" title='dname_count_labels' data-ref="dname_count_labels" data-ref-filename="dname_count_labels">dname_count_labels</a>(<a class="local col9 ref" href="#269nm" title='nm' data-ref="269nm" data-ref-filename="269nm">nm</a>);</td></tr>
<tr><th id="462">462</th><td>	<b>return</b> <a class="ref fn" href="../util/rbtree.h.html#rbtree_find_less_equal" title='rbtree_find_less_equal' data-ref="rbtree_find_less_equal" data-ref-filename="rbtree_find_less_equal">rbtree_find_less_equal</a>(&amp;<a class="local col8 ref" href="#268az" title='az' data-ref="268az" data-ref-filename="268az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::ztree" title='auth_zones::ztree' data-ref="auth_zones::ztree" data-ref-filename="auth_zones..ztree">ztree</a>, &amp;<a class="local col3 ref" href="#273key" title='key' data-ref="273key" data-ref-filename="273key">key</a>, (<a class="typedef" href="../util/rbtree.h.html#rbnode_type" title='rbnode_type' data-type='struct rbnode_type' data-ref="rbnode_type" data-ref-filename="rbnode_type">rbnode_type</a>**)<a class="local col2 ref" href="#272z" title='z' data-ref="272z" data-ref-filename="272z">z</a>);</td></tr>
<tr><th id="463">463</th><td>}</td></tr>
<tr><th id="464">464</th><td></td></tr>
<tr><th id="465">465</th><td></td></tr>
<tr><th id="466">466</th><td><i class="doc">/** find the auth zone that is above the given name */</i></td></tr>
<tr><th id="467">467</th><td><b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>*</td></tr>
<tr><th id="468">468</th><td><dfn class="decl def fn" id="auth_zones_find_zone" title='auth_zones_find_zone' data-ref="auth_zones_find_zone" data-ref-filename="auth_zones_find_zone">auth_zones_find_zone</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zones" title='auth_zones' data-ref="auth_zones" data-ref-filename="auth_zones">auth_zones</a>* <dfn class="local col4 decl" id="274az" title='az' data-type='struct auth_zones *' data-ref="274az" data-ref-filename="274az">az</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col5 decl" id="275name" title='name' data-type='uint8_t *' data-ref="275name" data-ref-filename="275name">name</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col6 decl" id="276name_len" title='name_len' data-type='size_t' data-ref="276name_len" data-ref-filename="276name_len">name_len</dfn>,</td></tr>
<tr><th id="469">469</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col7 decl" id="277dclass" title='dclass' data-type='uint16_t' data-ref="277dclass" data-ref-filename="277dclass">dclass</dfn>)</td></tr>
<tr><th id="470">470</th><td>{</td></tr>
<tr><th id="471">471</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col8 decl" id="278nm" title='nm' data-type='uint8_t *' data-ref="278nm" data-ref-filename="278nm">nm</dfn> = <a class="local col5 ref" href="#275name" title='name' data-ref="275name" data-ref-filename="275name">name</a>;</td></tr>
<tr><th id="472">472</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col9 decl" id="279nmlen" title='nmlen' data-type='size_t' data-ref="279nmlen" data-ref-filename="279nmlen">nmlen</dfn> = <a class="local col6 ref" href="#276name_len" title='name_len' data-ref="276name_len" data-ref-filename="276name_len">name_len</a>;</td></tr>
<tr><th id="473">473</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col0 decl" id="280z" title='z' data-type='struct auth_zone *' data-ref="280z" data-ref-filename="280z">z</dfn>;</td></tr>
<tr><th id="474">474</th><td>	<b>if</b>(<a class="tu ref fn" href="#auth_zone_find_less_equal" title='auth_zone_find_less_equal' data-use='c' data-ref="auth_zone_find_less_equal" data-ref-filename="auth_zone_find_less_equal">auth_zone_find_less_equal</a>(<a class="local col4 ref" href="#274az" title='az' data-ref="274az" data-ref-filename="274az">az</a>, <a class="local col8 ref" href="#278nm" title='nm' data-ref="278nm" data-ref-filename="278nm">nm</a>, <a class="local col9 ref" href="#279nmlen" title='nmlen' data-ref="279nmlen" data-ref-filename="279nmlen">nmlen</a>, <a class="local col7 ref" href="#277dclass" title='dclass' data-ref="277dclass" data-ref-filename="277dclass">dclass</a>, &amp;<a class="local col0 ref" href="#280z" title='z' data-ref="280z" data-ref-filename="280z">z</a>)) {</td></tr>
<tr><th id="475">475</th><td>		<i>/* exact match */</i></td></tr>
<tr><th id="476">476</th><td>		<b>return</b> <a class="local col0 ref" href="#280z" title='z' data-ref="280z" data-ref-filename="280z">z</a>;</td></tr>
<tr><th id="477">477</th><td>	} <b>else</b> {</td></tr>
<tr><th id="478">478</th><td>		<i>/* less-or-nothing */</i></td></tr>
<tr><th id="479">479</th><td>		<b>if</b>(!<a class="local col0 ref" href="#280z" title='z' data-ref="280z" data-ref-filename="280z">z</a>) <b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>; <i>/* nothing smaller, nothing above it */</i></td></tr>
<tr><th id="480">480</th><td>		<i>/* we found smaller name; smaller may be above the name,</i></td></tr>
<tr><th id="481">481</th><td><i>		 * but not below it. */</i></td></tr>
<tr><th id="482">482</th><td>		<a class="local col8 ref" href="#278nm" title='nm' data-ref="278nm" data-ref-filename="278nm">nm</a> = <a class="ref fn" href="../util/data/dname.h.html#dname_get_shared_topdomain" title='dname_get_shared_topdomain' data-ref="dname_get_shared_topdomain" data-ref-filename="dname_get_shared_topdomain">dname_get_shared_topdomain</a>(<a class="local col0 ref" href="#280z" title='z' data-ref="280z" data-ref-filename="280z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::name" title='auth_zone::name' data-ref="auth_zone::name" data-ref-filename="auth_zone..name">name</a>, <a class="local col5 ref" href="#275name" title='name' data-ref="275name" data-ref-filename="275name">name</a>);</td></tr>
<tr><th id="483">483</th><td>		<a class="ref fn" href="../util/data/dname.h.html#dname_count_size_labels" title='dname_count_size_labels' data-ref="dname_count_size_labels" data-ref-filename="dname_count_size_labels">dname_count_size_labels</a>(<a class="local col8 ref" href="#278nm" title='nm' data-ref="278nm" data-ref-filename="278nm">nm</a>, &amp;<a class="local col9 ref" href="#279nmlen" title='nmlen' data-ref="279nmlen" data-ref-filename="279nmlen">nmlen</a>);</td></tr>
<tr><th id="484">484</th><td>		<a class="local col0 ref" href="#280z" title='z' data-ref="280z" data-ref-filename="280z">z</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="485">485</th><td>	}</td></tr>
<tr><th id="486">486</th><td></td></tr>
<tr><th id="487">487</th><td>	<i>/* search up */</i></td></tr>
<tr><th id="488">488</th><td>	<b>while</b>(!<a class="local col0 ref" href="#280z" title='z' data-ref="280z" data-ref-filename="280z">z</a>) {</td></tr>
<tr><th id="489">489</th><td>		<a class="local col0 ref" href="#280z" title='z' data-ref="280z" data-ref-filename="280z">z</a> = <a class="ref fn" href="#auth_zone_find" title='auth_zone_find' data-ref="auth_zone_find" data-ref-filename="auth_zone_find">auth_zone_find</a>(<a class="local col4 ref" href="#274az" title='az' data-ref="274az" data-ref-filename="274az">az</a>, <a class="local col8 ref" href="#278nm" title='nm' data-ref="278nm" data-ref-filename="278nm">nm</a>, <a class="local col9 ref" href="#279nmlen" title='nmlen' data-ref="279nmlen" data-ref-filename="279nmlen">nmlen</a>, <a class="local col7 ref" href="#277dclass" title='dclass' data-ref="277dclass" data-ref-filename="277dclass">dclass</a>);</td></tr>
<tr><th id="490">490</th><td>		<b>if</b>(<a class="local col0 ref" href="#280z" title='z' data-ref="280z" data-ref-filename="280z">z</a>) <b>return</b> <a class="local col0 ref" href="#280z" title='z' data-ref="280z" data-ref-filename="280z">z</a>;</td></tr>
<tr><th id="491">491</th><td>		<b>if</b>(<a class="ref fn" href="../util/data/dname.h.html#dname_is_root" title='dname_is_root' data-ref="dname_is_root" data-ref-filename="dname_is_root">dname_is_root</a>(<a class="local col8 ref" href="#278nm" title='nm' data-ref="278nm" data-ref-filename="278nm">nm</a>)) <b>break</b>;</td></tr>
<tr><th id="492">492</th><td>		<a class="ref fn" href="../util/data/dname.h.html#dname_remove_label" title='dname_remove_label' data-ref="dname_remove_label" data-ref-filename="dname_remove_label">dname_remove_label</a>(&amp;<a class="local col8 ref" href="#278nm" title='nm' data-ref="278nm" data-ref-filename="278nm">nm</a>, &amp;<a class="local col9 ref" href="#279nmlen" title='nmlen' data-ref="279nmlen" data-ref-filename="279nmlen">nmlen</a>);</td></tr>
<tr><th id="493">493</th><td>	}</td></tr>
<tr><th id="494">494</th><td>	<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="495">495</th><td>}</td></tr>
<tr><th id="496">496</th><td></td></tr>
<tr><th id="497">497</th><td><i class="doc" data-doc="auth_zones_find_or_add_zone">/** find or create zone with name str. caller must have lock on az. </i></td></tr>
<tr><th id="498">498</th><td><i class="doc" data-doc="auth_zones_find_or_add_zone"> * returns a wrlocked zone */</i></td></tr>
<tr><th id="499">499</th><td><em>static</em> <b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>*</td></tr>
<tr><th id="500">500</th><td><dfn class="tu decl def fn" id="auth_zones_find_or_add_zone" title='auth_zones_find_or_add_zone' data-type='struct auth_zone * auth_zones_find_or_add_zone(struct auth_zones * az, char * name)' data-ref="auth_zones_find_or_add_zone" data-ref-filename="auth_zones_find_or_add_zone">auth_zones_find_or_add_zone</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zones" title='auth_zones' data-ref="auth_zones" data-ref-filename="auth_zones">auth_zones</a>* <dfn class="local col1 decl" id="281az" title='az' data-type='struct auth_zones *' data-ref="281az" data-ref-filename="281az">az</dfn>, <em>char</em>* <dfn class="local col2 decl" id="282name" title='name' data-type='char *' data-ref="282name" data-ref-filename="282name">name</dfn>)</td></tr>
<tr><th id="501">501</th><td>{</td></tr>
<tr><th id="502">502</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a> <dfn class="local col3 decl" id="283nm" title='nm' data-type='uint8_t [256]' data-ref="283nm" data-ref-filename="283nm">nm</dfn>[<a class="macro" href="../sldns/rrdef.h.html#29" title="255" data-ref="_M/LDNS_MAX_DOMAINLEN">LDNS_MAX_DOMAINLEN</a>+<var>1</var>];</td></tr>
<tr><th id="503">503</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col4 decl" id="284nmlen" title='nmlen' data-type='size_t' data-ref="284nmlen" data-ref-filename="284nmlen">nmlen</dfn> = <b>sizeof</b>(<a class="local col3 ref" href="#283nm" title='nm' data-ref="283nm" data-ref-filename="283nm">nm</a>);</td></tr>
<tr><th id="504">504</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col5 decl" id="285z" title='z' data-type='struct auth_zone *' data-ref="285z" data-ref-filename="285z">z</dfn>;</td></tr>
<tr><th id="505">505</th><td></td></tr>
<tr><th id="506">506</th><td>	<b>if</b>(<a class="ref fn" href="../sldns/str2wire.h.html#sldns_str2wire_dname_buf" title='sldns_str2wire_dname_buf' data-ref="sldns_str2wire_dname_buf" data-ref-filename="sldns_str2wire_dname_buf">sldns_str2wire_dname_buf</a>(<a class="local col2 ref" href="#282name" title='name' data-ref="282name" data-ref-filename="282name">name</a>, <a class="local col3 ref" href="#283nm" title='nm' data-ref="283nm" data-ref-filename="283nm">nm</a>, &amp;<a class="local col4 ref" href="#284nmlen" title='nmlen' data-ref="284nmlen" data-ref-filename="284nmlen">nmlen</a>) != <var>0</var>) {</td></tr>
<tr><th id="507">507</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"cannot parse auth zone name: %s"</q>, <a class="local col2 ref" href="#282name" title='name' data-ref="282name" data-ref-filename="282name">name</a>);</td></tr>
<tr><th id="508">508</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="509">509</th><td>	}</td></tr>
<tr><th id="510">510</th><td>	<a class="local col5 ref" href="#285z" title='z' data-ref="285z" data-ref-filename="285z">z</a> = <a class="ref fn" href="#auth_zone_find" title='auth_zone_find' data-ref="auth_zone_find" data-ref-filename="auth_zone_find">auth_zone_find</a>(<a class="local col1 ref" href="#281az" title='az' data-ref="281az" data-ref-filename="281az">az</a>, <a class="local col3 ref" href="#283nm" title='nm' data-ref="283nm" data-ref-filename="283nm">nm</a>, <a class="local col4 ref" href="#284nmlen" title='nmlen' data-ref="284nmlen" data-ref-filename="284nmlen">nmlen</a>, <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_CLASS_IN" title='LDNS_RR_CLASS_IN' data-ref="LDNS_RR_CLASS_IN" data-ref-filename="LDNS_RR_CLASS_IN">LDNS_RR_CLASS_IN</a>);</td></tr>
<tr><th id="511">511</th><td>	<b>if</b>(!<a class="local col5 ref" href="#285z" title='z' data-ref="285z" data-ref-filename="285z">z</a>) {</td></tr>
<tr><th id="512">512</th><td>		<i>/* not found, create the zone */</i></td></tr>
<tr><th id="513">513</th><td>		<a class="local col5 ref" href="#285z" title='z' data-ref="285z" data-ref-filename="285z">z</a> = <a class="ref fn" href="#auth_zone_create" title='auth_zone_create' data-ref="auth_zone_create" data-ref-filename="auth_zone_create">auth_zone_create</a>(<a class="local col1 ref" href="#281az" title='az' data-ref="281az" data-ref-filename="281az">az</a>, <a class="local col3 ref" href="#283nm" title='nm' data-ref="283nm" data-ref-filename="283nm">nm</a>, <a class="local col4 ref" href="#284nmlen" title='nmlen' data-ref="284nmlen" data-ref-filename="284nmlen">nmlen</a>, <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_CLASS_IN" title='LDNS_RR_CLASS_IN' data-ref="LDNS_RR_CLASS_IN" data-ref-filename="LDNS_RR_CLASS_IN">LDNS_RR_CLASS_IN</a>);</td></tr>
<tr><th id="514">514</th><td>	} <b>else</b> {</td></tr>
<tr><th id="515">515</th><td>		<a class="macro" href="../util/locks.h.html#120" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_wrlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_wrlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 515, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_wrlock">lock_rw_wrlock</a>(&amp;<a class="local col5 ref" href="#285z" title='z' data-ref="285z" data-ref-filename="285z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="516">516</th><td>	}</td></tr>
<tr><th id="517">517</th><td>	<b>return</b> <a class="local col5 ref" href="#285z" title='z' data-ref="285z" data-ref-filename="285z">z</a>;</td></tr>
<tr><th id="518">518</th><td>}</td></tr>
<tr><th id="519">519</th><td></td></tr>
<tr><th id="520">520</th><td><i class="doc" data-doc="auth_zones_find_or_add_xfer">/** find or create xfer zone with name str. caller must have lock on az. </i></td></tr>
<tr><th id="521">521</th><td><i class="doc" data-doc="auth_zones_find_or_add_xfer"> * returns a locked xfer */</i></td></tr>
<tr><th id="522">522</th><td><em>static</em> <b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>*</td></tr>
<tr><th id="523">523</th><td><dfn class="tu decl def fn" id="auth_zones_find_or_add_xfer" title='auth_zones_find_or_add_xfer' data-type='struct auth_xfer * auth_zones_find_or_add_xfer(struct auth_zones * az, struct auth_zone * z)' data-ref="auth_zones_find_or_add_xfer" data-ref-filename="auth_zones_find_or_add_xfer">auth_zones_find_or_add_xfer</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zones" title='auth_zones' data-ref="auth_zones" data-ref-filename="auth_zones">auth_zones</a>* <dfn class="local col6 decl" id="286az" title='az' data-type='struct auth_zones *' data-ref="286az" data-ref-filename="286az">az</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col7 decl" id="287z" title='z' data-type='struct auth_zone *' data-ref="287z" data-ref-filename="287z">z</dfn>)</td></tr>
<tr><th id="524">524</th><td>{</td></tr>
<tr><th id="525">525</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col8 decl" id="288x" title='x' data-type='struct auth_xfer *' data-ref="288x" data-ref-filename="288x">x</dfn>;</td></tr>
<tr><th id="526">526</th><td>	<a class="local col8 ref" href="#288x" title='x' data-ref="288x" data-ref-filename="288x">x</a> = <a class="ref fn" href="#auth_xfer_find" title='auth_xfer_find' data-ref="auth_xfer_find" data-ref-filename="auth_xfer_find">auth_xfer_find</a>(<a class="local col6 ref" href="#286az" title='az' data-ref="286az" data-ref-filename="286az">az</a>, <a class="local col7 ref" href="#287z" title='z' data-ref="287z" data-ref-filename="287z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::name" title='auth_zone::name' data-ref="auth_zone::name" data-ref-filename="auth_zone..name">name</a>, <a class="local col7 ref" href="#287z" title='z' data-ref="287z" data-ref-filename="287z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::namelen" title='auth_zone::namelen' data-ref="auth_zone::namelen" data-ref-filename="auth_zone..namelen">namelen</a>, <a class="local col7 ref" href="#287z" title='z' data-ref="287z" data-ref-filename="287z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::dclass" title='auth_zone::dclass' data-ref="auth_zone::dclass" data-ref-filename="auth_zone..dclass">dclass</a>);</td></tr>
<tr><th id="527">527</th><td>	<b>if</b>(!<a class="local col8 ref" href="#288x" title='x' data-ref="288x" data-ref-filename="288x">x</a>) {</td></tr>
<tr><th id="528">528</th><td>		<i>/* not found, create the zone */</i></td></tr>
<tr><th id="529">529</th><td>		<a class="local col8 ref" href="#288x" title='x' data-ref="288x" data-ref-filename="288x">x</a> = <a class="ref fn" href="#auth_xfer_create" title='auth_xfer_create' data-ref="auth_xfer_create" data-ref-filename="auth_xfer_create">auth_xfer_create</a>(<a class="local col6 ref" href="#286az" title='az' data-ref="286az" data-ref-filename="286az">az</a>, <a class="local col7 ref" href="#287z" title='z' data-ref="287z" data-ref-filename="287z">z</a>);</td></tr>
<tr><th id="530">530</th><td>	} <b>else</b> {</td></tr>
<tr><th id="531">531</th><td>		<a class="macro" href="../util/locks.h.html#102" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_lock(&amp;x-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_lock(&amp;x-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 531, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_lock">lock_basic_lock</a>(&amp;<a class="local col8 ref" href="#288x" title='x' data-ref="288x" data-ref-filename="288x">x</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="532">532</th><td>	}</td></tr>
<tr><th id="533">533</th><td>	<b>return</b> <a class="local col8 ref" href="#288x" title='x' data-ref="288x" data-ref-filename="288x">x</a>;</td></tr>
<tr><th id="534">534</th><td>}</td></tr>
<tr><th id="535">535</th><td></td></tr>
<tr><th id="536">536</th><td><em>int</em></td></tr>
<tr><th id="537">537</th><td><dfn class="decl def fn" id="auth_zone_set_zonefile" title='auth_zone_set_zonefile' data-ref="auth_zone_set_zonefile" data-ref-filename="auth_zone_set_zonefile">auth_zone_set_zonefile</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col9 decl" id="289z" title='z' data-type='struct auth_zone *' data-ref="289z" data-ref-filename="289z">z</dfn>, <em>char</em>* <dfn class="local col0 decl" id="290zonefile" title='zonefile' data-type='char *' data-ref="290zonefile" data-ref-filename="290zonefile">zonefile</dfn>)</td></tr>
<tr><th id="538">538</th><td>{</td></tr>
<tr><th id="539">539</th><td>	<b>if</b>(<a class="local col9 ref" href="#289z" title='z' data-ref="289z" data-ref-filename="289z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::zonefile" title='auth_zone::zonefile' data-ref="auth_zone::zonefile" data-ref-filename="auth_zone..zonefile">zonefile</a>) <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col9 ref" href="#289z" title='z' data-ref="289z" data-ref-filename="289z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::zonefile" title='auth_zone::zonefile' data-ref="auth_zone::zonefile" data-ref-filename="auth_zone..zonefile">zonefile</a>);</td></tr>
<tr><th id="540">540</th><td>	<b>if</b>(<a class="local col0 ref" href="#290zonefile" title='zonefile' data-ref="290zonefile" data-ref-filename="290zonefile">zonefile</a> == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="541">541</th><td>		<a class="local col9 ref" href="#289z" title='z' data-ref="289z" data-ref-filename="289z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::zonefile" title='auth_zone::zonefile' data-ref="auth_zone::zonefile" data-ref-filename="auth_zone..zonefile">zonefile</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="542">542</th><td>	} <b>else</b> {</td></tr>
<tr><th id="543">543</th><td>		<a class="local col9 ref" href="#289z" title='z' data-ref="289z" data-ref-filename="289z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::zonefile" title='auth_zone::zonefile' data-ref="auth_zone::zonefile" data-ref-filename="auth_zone..zonefile">zonefile</a> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strdup" title='strdup' data-ref="strdup" data-ref-filename="strdup">strdup</a>(<a class="local col0 ref" href="#290zonefile" title='zonefile' data-ref="290zonefile" data-ref-filename="290zonefile">zonefile</a>);</td></tr>
<tr><th id="544">544</th><td>		<b>if</b>(!<a class="local col9 ref" href="#289z" title='z' data-ref="289z" data-ref-filename="289z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::zonefile" title='auth_zone::zonefile' data-ref="auth_zone::zonefile" data-ref-filename="auth_zone..zonefile">zonefile</a>) {</td></tr>
<tr><th id="545">545</th><td>			<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"malloc failure"</q>);</td></tr>
<tr><th id="546">546</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="547">547</th><td>		}</td></tr>
<tr><th id="548">548</th><td>	}</td></tr>
<tr><th id="549">549</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="550">550</th><td>}</td></tr>
<tr><th id="551">551</th><td></td></tr>
<tr><th id="552">552</th><td><i class="doc">/** set auth zone fallback. caller must have lock on zone */</i></td></tr>
<tr><th id="553">553</th><td><em>int</em></td></tr>
<tr><th id="554">554</th><td><dfn class="decl def fn" id="auth_zone_set_fallback" title='auth_zone_set_fallback' data-ref="auth_zone_set_fallback" data-ref-filename="auth_zone_set_fallback">auth_zone_set_fallback</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col1 decl" id="291z" title='z' data-type='struct auth_zone *' data-ref="291z" data-ref-filename="291z">z</dfn>, <em>char</em>* <dfn class="local col2 decl" id="292fallbackstr" title='fallbackstr' data-type='char *' data-ref="292fallbackstr" data-ref-filename="292fallbackstr">fallbackstr</dfn>)</td></tr>
<tr><th id="555">555</th><td>{</td></tr>
<tr><th id="556">556</th><td>	<b>if</b>(<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strcmp" title='strcmp' data-ref="strcmp" data-ref-filename="strcmp">strcmp</a>(<a class="local col2 ref" href="#292fallbackstr" title='fallbackstr' data-ref="292fallbackstr" data-ref-filename="292fallbackstr">fallbackstr</a>, <q>"yes"</q>) != <var>0</var> &amp;&amp; <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strcmp" title='strcmp' data-ref="strcmp" data-ref-filename="strcmp">strcmp</a>(<a class="local col2 ref" href="#292fallbackstr" title='fallbackstr' data-ref="292fallbackstr" data-ref-filename="292fallbackstr">fallbackstr</a>, <q>"no"</q>) != <var>0</var>){</td></tr>
<tr><th id="557">557</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"auth zone fallback, expected yes or no, got %s"</q>,</td></tr>
<tr><th id="558">558</th><td>			<a class="local col2 ref" href="#292fallbackstr" title='fallbackstr' data-ref="292fallbackstr" data-ref-filename="292fallbackstr">fallbackstr</a>);</td></tr>
<tr><th id="559">559</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="560">560</th><td>	}</td></tr>
<tr><th id="561">561</th><td>	<a class="local col1 ref" href="#291z" title='z' data-ref="291z" data-ref-filename="291z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::fallback_enabled" title='auth_zone::fallback_enabled' data-ref="auth_zone::fallback_enabled" data-ref-filename="auth_zone..fallback_enabled">fallback_enabled</a> = (<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strcmp" title='strcmp' data-ref="strcmp" data-ref-filename="strcmp">strcmp</a>(<a class="local col2 ref" href="#292fallbackstr" title='fallbackstr' data-ref="292fallbackstr" data-ref-filename="292fallbackstr">fallbackstr</a>, <q>"yes"</q>)==<var>0</var>);</td></tr>
<tr><th id="562">562</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="563">563</th><td>}</td></tr>
<tr><th id="564">564</th><td></td></tr>
<tr><th id="565">565</th><td><i class="doc" data-doc="az_domain_create">/** create domain with the given name */</i></td></tr>
<tr><th id="566">566</th><td><em>static</em> <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>*</td></tr>
<tr><th id="567">567</th><td><dfn class="tu decl def fn" id="az_domain_create" title='az_domain_create' data-type='struct auth_data * az_domain_create(struct auth_zone * z, uint8_t * nm, size_t nmlen)' data-ref="az_domain_create" data-ref-filename="az_domain_create">az_domain_create</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col3 decl" id="293z" title='z' data-type='struct auth_zone *' data-ref="293z" data-ref-filename="293z">z</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col4 decl" id="294nm" title='nm' data-type='uint8_t *' data-ref="294nm" data-ref-filename="294nm">nm</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col5 decl" id="295nmlen" title='nmlen' data-type='size_t' data-ref="295nmlen" data-ref-filename="295nmlen">nmlen</dfn>)</td></tr>
<tr><th id="568">568</th><td>{</td></tr>
<tr><th id="569">569</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col6 decl" id="296n" title='n' data-type='struct auth_data *' data-ref="296n" data-ref-filename="296n">n</dfn> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>*)<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#malloc" title='malloc' data-ref="malloc" data-ref-filename="malloc">malloc</a>(<b>sizeof</b>(*<a class="local col6 ref" href="#296n" title='n' data-ref="296n" data-ref-filename="296n">n</a>));</td></tr>
<tr><th id="570">570</th><td>	<b>if</b>(!<a class="local col6 ref" href="#296n" title='n' data-ref="296n" data-ref-filename="296n">n</a>) <b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="571">571</th><td>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#97" title="((__builtin_object_size(n, 0) != (size_t)-1) ? __builtin___memset_chk(n, 0, sizeof(*n), __builtin_object_size(n, 0)) : __memset_ichk(n, 0, sizeof(*n)))" data-ref="_M/memset">memset</a>(<a class="local col6 ref" href="#296n" title='n' data-ref="296n" data-ref-filename="296n">n</a>, <var>0</var>, <b>sizeof</b>(*<a class="local col6 ref" href="#296n" title='n' data-ref="296n" data-ref-filename="296n">n</a>));</td></tr>
<tr><th id="572">572</th><td>	<a class="local col6 ref" href="#296n" title='n' data-ref="296n" data-ref-filename="296n">n</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::node" title='auth_data::node' data-ref="auth_data::node" data-ref-filename="auth_data..node">node</a>.<a class="ref field" href="../util/rbtree.h.html#rbnode_type::key" title='rbnode_type::key' data-ref="rbnode_type::key" data-ref-filename="rbnode_type..key">key</a> = <a class="local col6 ref" href="#296n" title='n' data-ref="296n" data-ref-filename="296n">n</a>;</td></tr>
<tr><th id="573">573</th><td>	<a class="local col6 ref" href="#296n" title='n' data-ref="296n" data-ref-filename="296n">n</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::name" title='auth_data::name' data-ref="auth_data::name" data-ref-filename="auth_data..name">name</a> = <a class="ref fn" href="../util/net_help.h.html#memdup" title='memdup' data-ref="memdup" data-ref-filename="memdup">memdup</a>(<a class="local col4 ref" href="#294nm" title='nm' data-ref="294nm" data-ref-filename="294nm">nm</a>, <a class="local col5 ref" href="#295nmlen" title='nmlen' data-ref="295nmlen" data-ref-filename="295nmlen">nmlen</a>);</td></tr>
<tr><th id="574">574</th><td>	<b>if</b>(!<a class="local col6 ref" href="#296n" title='n' data-ref="296n" data-ref-filename="296n">n</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::name" title='auth_data::name' data-ref="auth_data::name" data-ref-filename="auth_data..name">name</a>) {</td></tr>
<tr><th id="575">575</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col6 ref" href="#296n" title='n' data-ref="296n" data-ref-filename="296n">n</a>);</td></tr>
<tr><th id="576">576</th><td>		<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="577">577</th><td>	}</td></tr>
<tr><th id="578">578</th><td>	<a class="local col6 ref" href="#296n" title='n' data-ref="296n" data-ref-filename="296n">n</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::namelen" title='auth_data::namelen' data-ref="auth_data::namelen" data-ref-filename="auth_data..namelen">namelen</a> = <a class="local col5 ref" href="#295nmlen" title='nmlen' data-ref="295nmlen" data-ref-filename="295nmlen">nmlen</a>;</td></tr>
<tr><th id="579">579</th><td>	<a class="local col6 ref" href="#296n" title='n' data-ref="296n" data-ref-filename="296n">n</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::namelabs" title='auth_data::namelabs' data-ref="auth_data::namelabs" data-ref-filename="auth_data..namelabs">namelabs</a> = <a class="ref fn" href="../util/data/dname.h.html#dname_count_labels" title='dname_count_labels' data-ref="dname_count_labels" data-ref-filename="dname_count_labels">dname_count_labels</a>(<a class="local col4 ref" href="#294nm" title='nm' data-ref="294nm" data-ref-filename="294nm">nm</a>);</td></tr>
<tr><th id="580">580</th><td>	<b>if</b>(!<a class="ref fn" href="../util/rbtree.h.html#rbtree_insert" title='rbtree_insert' data-ref="rbtree_insert" data-ref-filename="rbtree_insert">rbtree_insert</a>(&amp;<a class="local col3 ref" href="#293z" title='z' data-ref="293z" data-ref-filename="293z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::data" title='auth_zone::data' data-ref="auth_zone::data" data-ref-filename="auth_zone..data">data</a>, &amp;<a class="local col6 ref" href="#296n" title='n' data-ref="296n" data-ref-filename="296n">n</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::node" title='auth_data::node' data-ref="auth_data::node" data-ref-filename="auth_data..node">node</a>)) {</td></tr>
<tr><th id="581">581</th><td>		<a class="ref fn" href="../util/log.h.html#log_warn" title='log_warn' data-ref="log_warn" data-ref-filename="log_warn">log_warn</a>(<q>"duplicate auth domain name"</q>);</td></tr>
<tr><th id="582">582</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col6 ref" href="#296n" title='n' data-ref="296n" data-ref-filename="296n">n</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::name" title='auth_data::name' data-ref="auth_data::name" data-ref-filename="auth_data..name">name</a>);</td></tr>
<tr><th id="583">583</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col6 ref" href="#296n" title='n' data-ref="296n" data-ref-filename="296n">n</a>);</td></tr>
<tr><th id="584">584</th><td>		<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="585">585</th><td>	}</td></tr>
<tr><th id="586">586</th><td>	<b>return</b> <a class="local col6 ref" href="#296n" title='n' data-ref="296n" data-ref-filename="296n">n</a>;</td></tr>
<tr><th id="587">587</th><td>}</td></tr>
<tr><th id="588">588</th><td></td></tr>
<tr><th id="589">589</th><td><i class="doc" data-doc="az_find_name">/** find domain with exactly the given name */</i></td></tr>
<tr><th id="590">590</th><td><em>static</em> <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>*</td></tr>
<tr><th id="591">591</th><td><dfn class="tu decl def fn" id="az_find_name" title='az_find_name' data-type='struct auth_data * az_find_name(struct auth_zone * z, uint8_t * nm, size_t nmlen)' data-ref="az_find_name" data-ref-filename="az_find_name">az_find_name</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col7 decl" id="297z" title='z' data-type='struct auth_zone *' data-ref="297z" data-ref-filename="297z">z</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col8 decl" id="298nm" title='nm' data-type='uint8_t *' data-ref="298nm" data-ref-filename="298nm">nm</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col9 decl" id="299nmlen" title='nmlen' data-type='size_t' data-ref="299nmlen" data-ref-filename="299nmlen">nmlen</dfn>)</td></tr>
<tr><th id="592">592</th><td>{</td></tr>
<tr><th id="593">593</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a> <dfn class="local col0 decl" id="300key" title='key' data-type='struct auth_zone' data-ref="300key" data-ref-filename="300key">key</dfn>;</td></tr>
<tr><th id="594">594</th><td>	<a class="local col0 ref" href="#300key" title='key' data-ref="300key" data-ref-filename="300key">key</a>.<a class="ref field" href="authzone.h.html#auth_zone::node" title='auth_zone::node' data-ref="auth_zone::node" data-ref-filename="auth_zone..node">node</a>.<a class="ref field" href="../util/rbtree.h.html#rbnode_type::key" title='rbnode_type::key' data-ref="rbnode_type::key" data-ref-filename="rbnode_type..key">key</a> = &amp;<a class="local col0 ref" href="#300key" title='key' data-ref="300key" data-ref-filename="300key">key</a>;</td></tr>
<tr><th id="595">595</th><td>	<a class="local col0 ref" href="#300key" title='key' data-ref="300key" data-ref-filename="300key">key</a>.<a class="ref field" href="authzone.h.html#auth_zone::name" title='auth_zone::name' data-ref="auth_zone::name" data-ref-filename="auth_zone..name">name</a> = <a class="local col8 ref" href="#298nm" title='nm' data-ref="298nm" data-ref-filename="298nm">nm</a>;</td></tr>
<tr><th id="596">596</th><td>	<a class="local col0 ref" href="#300key" title='key' data-ref="300key" data-ref-filename="300key">key</a>.<a class="ref field" href="authzone.h.html#auth_zone::namelen" title='auth_zone::namelen' data-ref="auth_zone::namelen" data-ref-filename="auth_zone..namelen">namelen</a> = <a class="local col9 ref" href="#299nmlen" title='nmlen' data-ref="299nmlen" data-ref-filename="299nmlen">nmlen</a>;</td></tr>
<tr><th id="597">597</th><td>	<a class="local col0 ref" href="#300key" title='key' data-ref="300key" data-ref-filename="300key">key</a>.<a class="ref field" href="authzone.h.html#auth_zone::namelabs" title='auth_zone::namelabs' data-ref="auth_zone::namelabs" data-ref-filename="auth_zone..namelabs">namelabs</a> = <a class="ref fn" href="../util/data/dname.h.html#dname_count_labels" title='dname_count_labels' data-ref="dname_count_labels" data-ref-filename="dname_count_labels">dname_count_labels</a>(<a class="local col8 ref" href="#298nm" title='nm' data-ref="298nm" data-ref-filename="298nm">nm</a>);</td></tr>
<tr><th id="598">598</th><td>	<b>return</b> (<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>*)<a class="ref fn" href="../util/rbtree.h.html#rbtree_search" title='rbtree_search' data-ref="rbtree_search" data-ref-filename="rbtree_search">rbtree_search</a>(&amp;<a class="local col7 ref" href="#297z" title='z' data-ref="297z" data-ref-filename="297z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::data" title='auth_zone::data' data-ref="auth_zone::data" data-ref-filename="auth_zone..data">data</a>, &amp;<a class="local col0 ref" href="#300key" title='key' data-ref="300key" data-ref-filename="300key">key</a>);</td></tr>
<tr><th id="599">599</th><td>}</td></tr>
<tr><th id="600">600</th><td></td></tr>
<tr><th id="601">601</th><td><i class="doc" data-doc="az_find_domain">/** Find domain name (or closest match) */</i></td></tr>
<tr><th id="602">602</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="603">603</th><td><dfn class="tu decl def fn" id="az_find_domain" title='az_find_domain' data-type='void az_find_domain(struct auth_zone * z, struct query_info * qinfo, int * node_exact, struct auth_data ** node)' data-ref="az_find_domain" data-ref-filename="az_find_domain">az_find_domain</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col1 decl" id="301z" title='z' data-type='struct auth_zone *' data-ref="301z" data-ref-filename="301z">z</dfn>, <b>struct</b> <a class="type" href="../util/data/msgreply.h.html#query_info" title='query_info' data-ref="query_info" data-ref-filename="query_info">query_info</a>* <dfn class="local col2 decl" id="302qinfo" title='qinfo' data-type='struct query_info *' data-ref="302qinfo" data-ref-filename="302qinfo">qinfo</dfn>, <em>int</em>* <dfn class="local col3 decl" id="303node_exact" title='node_exact' data-type='int *' data-ref="303node_exact" data-ref-filename="303node_exact">node_exact</dfn>,</td></tr>
<tr><th id="604">604</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>** <dfn class="local col4 decl" id="304node" title='node' data-type='struct auth_data **' data-ref="304node" data-ref-filename="304node">node</dfn>)</td></tr>
<tr><th id="605">605</th><td>{</td></tr>
<tr><th id="606">606</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a> <dfn class="local col5 decl" id="305key" title='key' data-type='struct auth_zone' data-ref="305key" data-ref-filename="305key">key</dfn>;</td></tr>
<tr><th id="607">607</th><td>	<a class="local col5 ref" href="#305key" title='key' data-ref="305key" data-ref-filename="305key">key</a>.<a class="ref field" href="authzone.h.html#auth_zone::node" title='auth_zone::node' data-ref="auth_zone::node" data-ref-filename="auth_zone..node">node</a>.<a class="ref field" href="../util/rbtree.h.html#rbnode_type::key" title='rbnode_type::key' data-ref="rbnode_type::key" data-ref-filename="rbnode_type..key">key</a> = &amp;<a class="local col5 ref" href="#305key" title='key' data-ref="305key" data-ref-filename="305key">key</a>;</td></tr>
<tr><th id="608">608</th><td>	<a class="local col5 ref" href="#305key" title='key' data-ref="305key" data-ref-filename="305key">key</a>.<a class="ref field" href="authzone.h.html#auth_zone::name" title='auth_zone::name' data-ref="auth_zone::name" data-ref-filename="auth_zone..name">name</a> = <a class="local col2 ref" href="#302qinfo" title='qinfo' data-ref="302qinfo" data-ref-filename="302qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname" title='query_info::qname' data-ref="query_info::qname" data-ref-filename="query_info..qname">qname</a>;</td></tr>
<tr><th id="609">609</th><td>	<a class="local col5 ref" href="#305key" title='key' data-ref="305key" data-ref-filename="305key">key</a>.<a class="ref field" href="authzone.h.html#auth_zone::namelen" title='auth_zone::namelen' data-ref="auth_zone::namelen" data-ref-filename="auth_zone..namelen">namelen</a> = <a class="local col2 ref" href="#302qinfo" title='qinfo' data-ref="302qinfo" data-ref-filename="302qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname_len" title='query_info::qname_len' data-ref="query_info::qname_len" data-ref-filename="query_info..qname_len">qname_len</a>;</td></tr>
<tr><th id="610">610</th><td>	<a class="local col5 ref" href="#305key" title='key' data-ref="305key" data-ref-filename="305key">key</a>.<a class="ref field" href="authzone.h.html#auth_zone::namelabs" title='auth_zone::namelabs' data-ref="auth_zone::namelabs" data-ref-filename="auth_zone..namelabs">namelabs</a> = <a class="ref fn" href="../util/data/dname.h.html#dname_count_labels" title='dname_count_labels' data-ref="dname_count_labels" data-ref-filename="dname_count_labels">dname_count_labels</a>(<a class="local col5 ref" href="#305key" title='key' data-ref="305key" data-ref-filename="305key">key</a>.<a class="ref field" href="authzone.h.html#auth_zone::name" title='auth_zone::name' data-ref="auth_zone::name" data-ref-filename="auth_zone..name">name</a>);</td></tr>
<tr><th id="611">611</th><td>	*<a class="local col3 ref" href="#303node_exact" title='node_exact' data-ref="303node_exact" data-ref-filename="303node_exact">node_exact</a> = <a class="ref fn" href="../util/rbtree.h.html#rbtree_find_less_equal" title='rbtree_find_less_equal' data-ref="rbtree_find_less_equal" data-ref-filename="rbtree_find_less_equal">rbtree_find_less_equal</a>(&amp;<a class="local col1 ref" href="#301z" title='z' data-ref="301z" data-ref-filename="301z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::data" title='auth_zone::data' data-ref="auth_zone::data" data-ref-filename="auth_zone..data">data</a>, &amp;<a class="local col5 ref" href="#305key" title='key' data-ref="305key" data-ref-filename="305key">key</a>,</td></tr>
<tr><th id="612">612</th><td>		(<a class="typedef" href="../util/rbtree.h.html#rbnode_type" title='rbnode_type' data-type='struct rbnode_type' data-ref="rbnode_type" data-ref-filename="rbnode_type">rbnode_type</a>**)<a class="local col4 ref" href="#304node" title='node' data-ref="304node" data-ref-filename="304node">node</a>);</td></tr>
<tr><th id="613">613</th><td>}</td></tr>
<tr><th id="614">614</th><td></td></tr>
<tr><th id="615">615</th><td><i class="doc" data-doc="az_domain_find_or_create">/** find or create domain with name in zone */</i></td></tr>
<tr><th id="616">616</th><td><em>static</em> <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>*</td></tr>
<tr><th id="617">617</th><td><dfn class="tu decl def fn" id="az_domain_find_or_create" title='az_domain_find_or_create' data-type='struct auth_data * az_domain_find_or_create(struct auth_zone * z, uint8_t * dname, size_t dname_len)' data-ref="az_domain_find_or_create" data-ref-filename="az_domain_find_or_create">az_domain_find_or_create</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col6 decl" id="306z" title='z' data-type='struct auth_zone *' data-ref="306z" data-ref-filename="306z">z</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col7 decl" id="307dname" title='dname' data-type='uint8_t *' data-ref="307dname" data-ref-filename="307dname">dname</dfn>,</td></tr>
<tr><th id="618">618</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col8 decl" id="308dname_len" title='dname_len' data-type='size_t' data-ref="308dname_len" data-ref-filename="308dname_len">dname_len</dfn>)</td></tr>
<tr><th id="619">619</th><td>{</td></tr>
<tr><th id="620">620</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col9 decl" id="309n" title='n' data-type='struct auth_data *' data-ref="309n" data-ref-filename="309n">n</dfn> = <a class="tu ref fn" href="#az_find_name" title='az_find_name' data-use='c' data-ref="az_find_name" data-ref-filename="az_find_name">az_find_name</a>(<a class="local col6 ref" href="#306z" title='z' data-ref="306z" data-ref-filename="306z">z</a>, <a class="local col7 ref" href="#307dname" title='dname' data-ref="307dname" data-ref-filename="307dname">dname</a>, <a class="local col8 ref" href="#308dname_len" title='dname_len' data-ref="308dname_len" data-ref-filename="308dname_len">dname_len</a>);</td></tr>
<tr><th id="621">621</th><td>	<b>if</b>(!<a class="local col9 ref" href="#309n" title='n' data-ref="309n" data-ref-filename="309n">n</a>) {</td></tr>
<tr><th id="622">622</th><td>		<a class="local col9 ref" href="#309n" title='n' data-ref="309n" data-ref-filename="309n">n</a> = <a class="tu ref fn" href="#az_domain_create" title='az_domain_create' data-use='c' data-ref="az_domain_create" data-ref-filename="az_domain_create">az_domain_create</a>(<a class="local col6 ref" href="#306z" title='z' data-ref="306z" data-ref-filename="306z">z</a>, <a class="local col7 ref" href="#307dname" title='dname' data-ref="307dname" data-ref-filename="307dname">dname</a>, <a class="local col8 ref" href="#308dname_len" title='dname_len' data-ref="308dname_len" data-ref-filename="308dname_len">dname_len</a>);</td></tr>
<tr><th id="623">623</th><td>	}</td></tr>
<tr><th id="624">624</th><td>	<b>return</b> <a class="local col9 ref" href="#309n" title='n' data-ref="309n" data-ref-filename="309n">n</a>;</td></tr>
<tr><th id="625">625</th><td>}</td></tr>
<tr><th id="626">626</th><td></td></tr>
<tr><th id="627">627</th><td><i class="doc" data-doc="az_domain_rrset">/** find rrset of given type in the domain */</i></td></tr>
<tr><th id="628">628</th><td><em>static</em> <b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>*</td></tr>
<tr><th id="629">629</th><td><dfn class="tu decl def fn" id="az_domain_rrset" title='az_domain_rrset' data-type='struct auth_rrset * az_domain_rrset(struct auth_data * n, uint16_t t)' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col0 decl" id="310n" title='n' data-type='struct auth_data *' data-ref="310n" data-ref-filename="310n">n</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col1 decl" id="311t" title='t' data-type='uint16_t' data-ref="311t" data-ref-filename="311t">t</dfn>)</td></tr>
<tr><th id="630">630</th><td>{</td></tr>
<tr><th id="631">631</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col2 decl" id="312rrset" title='rrset' data-type='struct auth_rrset *' data-ref="312rrset" data-ref-filename="312rrset">rrset</dfn>;</td></tr>
<tr><th id="632">632</th><td>	<b>if</b>(!<a class="local col0 ref" href="#310n" title='n' data-ref="310n" data-ref-filename="310n">n</a>) <b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="633">633</th><td>	<a class="local col2 ref" href="#312rrset" title='rrset' data-ref="312rrset" data-ref-filename="312rrset">rrset</a> = <a class="local col0 ref" href="#310n" title='n' data-ref="310n" data-ref-filename="310n">n</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::rrsets" title='auth_data::rrsets' data-ref="auth_data::rrsets" data-ref-filename="auth_data..rrsets">rrsets</a>;</td></tr>
<tr><th id="634">634</th><td>	<b>while</b>(<a class="local col2 ref" href="#312rrset" title='rrset' data-ref="312rrset" data-ref-filename="312rrset">rrset</a>) {</td></tr>
<tr><th id="635">635</th><td>		<b>if</b>(<a class="local col2 ref" href="#312rrset" title='rrset' data-ref="312rrset" data-ref-filename="312rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::type" title='auth_rrset::type' data-ref="auth_rrset::type" data-ref-filename="auth_rrset..type">type</a> == <a class="local col1 ref" href="#311t" title='t' data-ref="311t" data-ref-filename="311t">t</a>)</td></tr>
<tr><th id="636">636</th><td>			<b>return</b> <a class="local col2 ref" href="#312rrset" title='rrset' data-ref="312rrset" data-ref-filename="312rrset">rrset</a>;</td></tr>
<tr><th id="637">637</th><td>		<a class="local col2 ref" href="#312rrset" title='rrset' data-ref="312rrset" data-ref-filename="312rrset">rrset</a> = <a class="local col2 ref" href="#312rrset" title='rrset' data-ref="312rrset" data-ref-filename="312rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::next" title='auth_rrset::next' data-ref="auth_rrset::next" data-ref-filename="auth_rrset..next">next</a>;</td></tr>
<tr><th id="638">638</th><td>	}</td></tr>
<tr><th id="639">639</th><td>	<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="640">640</th><td>}</td></tr>
<tr><th id="641">641</th><td></td></tr>
<tr><th id="642">642</th><td><i class="doc" data-doc="domain_remove_rrset">/** remove rrset of this type from domain */</i></td></tr>
<tr><th id="643">643</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="644">644</th><td><dfn class="tu decl def fn" id="domain_remove_rrset" title='domain_remove_rrset' data-type='void domain_remove_rrset(struct auth_data * node, uint16_t rr_type)' data-ref="domain_remove_rrset" data-ref-filename="domain_remove_rrset">domain_remove_rrset</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col3 decl" id="313node" title='node' data-type='struct auth_data *' data-ref="313node" data-ref-filename="313node">node</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col4 decl" id="314rr_type" title='rr_type' data-type='uint16_t' data-ref="314rr_type" data-ref-filename="314rr_type">rr_type</dfn>)</td></tr>
<tr><th id="645">645</th><td>{</td></tr>
<tr><th id="646">646</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col5 decl" id="315rrset" title='rrset' data-type='struct auth_rrset *' data-ref="315rrset" data-ref-filename="315rrset">rrset</dfn>, *<dfn class="local col6 decl" id="316prev" title='prev' data-type='struct auth_rrset *' data-ref="316prev" data-ref-filename="316prev">prev</dfn>;</td></tr>
<tr><th id="647">647</th><td>	<b>if</b>(!<a class="local col3 ref" href="#313node" title='node' data-ref="313node" data-ref-filename="313node">node</a>) <b>return</b>;</td></tr>
<tr><th id="648">648</th><td>	<a class="local col6 ref" href="#316prev" title='prev' data-ref="316prev" data-ref-filename="316prev">prev</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="649">649</th><td>	<a class="local col5 ref" href="#315rrset" title='rrset' data-ref="315rrset" data-ref-filename="315rrset">rrset</a> = <a class="local col3 ref" href="#313node" title='node' data-ref="313node" data-ref-filename="313node">node</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::rrsets" title='auth_data::rrsets' data-ref="auth_data::rrsets" data-ref-filename="auth_data..rrsets">rrsets</a>;</td></tr>
<tr><th id="650">650</th><td>	<b>while</b>(<a class="local col5 ref" href="#315rrset" title='rrset' data-ref="315rrset" data-ref-filename="315rrset">rrset</a>) {</td></tr>
<tr><th id="651">651</th><td>		<b>if</b>(<a class="local col5 ref" href="#315rrset" title='rrset' data-ref="315rrset" data-ref-filename="315rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::type" title='auth_rrset::type' data-ref="auth_rrset::type" data-ref-filename="auth_rrset..type">type</a> == <a class="local col4 ref" href="#314rr_type" title='rr_type' data-ref="314rr_type" data-ref-filename="314rr_type">rr_type</a>) {</td></tr>
<tr><th id="652">652</th><td>			<i>/* found it, now delete it */</i></td></tr>
<tr><th id="653">653</th><td>			<b>if</b>(<a class="local col6 ref" href="#316prev" title='prev' data-ref="316prev" data-ref-filename="316prev">prev</a>) <a class="local col6 ref" href="#316prev" title='prev' data-ref="316prev" data-ref-filename="316prev">prev</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::next" title='auth_rrset::next' data-ref="auth_rrset::next" data-ref-filename="auth_rrset..next">next</a> = <a class="local col5 ref" href="#315rrset" title='rrset' data-ref="315rrset" data-ref-filename="315rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::next" title='auth_rrset::next' data-ref="auth_rrset::next" data-ref-filename="auth_rrset..next">next</a>;</td></tr>
<tr><th id="654">654</th><td>			<b>else</b>	<a class="local col3 ref" href="#313node" title='node' data-ref="313node" data-ref-filename="313node">node</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::rrsets" title='auth_data::rrsets' data-ref="auth_data::rrsets" data-ref-filename="auth_data..rrsets">rrsets</a> = <a class="local col5 ref" href="#315rrset" title='rrset' data-ref="315rrset" data-ref-filename="315rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::next" title='auth_rrset::next' data-ref="auth_rrset::next" data-ref-filename="auth_rrset..next">next</a>;</td></tr>
<tr><th id="655">655</th><td>			<a class="tu ref fn" href="#auth_rrset_delete" title='auth_rrset_delete' data-use='c' data-ref="auth_rrset_delete" data-ref-filename="auth_rrset_delete">auth_rrset_delete</a>(<a class="local col5 ref" href="#315rrset" title='rrset' data-ref="315rrset" data-ref-filename="315rrset">rrset</a>);</td></tr>
<tr><th id="656">656</th><td>			<b>return</b>;</td></tr>
<tr><th id="657">657</th><td>		}</td></tr>
<tr><th id="658">658</th><td>		<a class="local col6 ref" href="#316prev" title='prev' data-ref="316prev" data-ref-filename="316prev">prev</a> = <a class="local col5 ref" href="#315rrset" title='rrset' data-ref="315rrset" data-ref-filename="315rrset">rrset</a>;</td></tr>
<tr><th id="659">659</th><td>		<a class="local col5 ref" href="#315rrset" title='rrset' data-ref="315rrset" data-ref-filename="315rrset">rrset</a> = <a class="local col5 ref" href="#315rrset" title='rrset' data-ref="315rrset" data-ref-filename="315rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::next" title='auth_rrset::next' data-ref="auth_rrset::next" data-ref-filename="auth_rrset..next">next</a>;</td></tr>
<tr><th id="660">660</th><td>	}</td></tr>
<tr><th id="661">661</th><td>}</td></tr>
<tr><th id="662">662</th><td></td></tr>
<tr><th id="663">663</th><td><i class="doc" data-doc="az_rrset_find_rr">/** find an rr index in the rrset.  returns true if found */</i></td></tr>
<tr><th id="664">664</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="665">665</th><td><dfn class="tu decl def fn" id="az_rrset_find_rr" title='az_rrset_find_rr' data-type='int az_rrset_find_rr(struct packed_rrset_data * d, uint8_t * rdata, size_t len, size_t * index)' data-ref="az_rrset_find_rr" data-ref-filename="az_rrset_find_rr">az_rrset_find_rr</dfn>(<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>* <dfn class="local col7 decl" id="317d" title='d' data-type='struct packed_rrset_data *' data-ref="317d" data-ref-filename="317d">d</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col8 decl" id="318rdata" title='rdata' data-type='uint8_t *' data-ref="318rdata" data-ref-filename="318rdata">rdata</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col9 decl" id="319len" title='len' data-type='size_t' data-ref="319len" data-ref-filename="319len">len</dfn>,</td></tr>
<tr><th id="666">666</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>* <dfn class="local col0 decl" id="320index" title='index' data-type='size_t *' data-ref="320index" data-ref-filename="320index">index</dfn>)</td></tr>
<tr><th id="667">667</th><td>{</td></tr>
<tr><th id="668">668</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col1 decl" id="321i" title='i' data-type='size_t' data-ref="321i" data-ref-filename="321i">i</dfn>;</td></tr>
<tr><th id="669">669</th><td>	<b>for</b>(<a class="local col1 ref" href="#321i" title='i' data-ref="321i" data-ref-filename="321i">i</a>=<var>0</var>; <a class="local col1 ref" href="#321i" title='i' data-ref="321i" data-ref-filename="321i">i</a>&lt;<a class="local col7 ref" href="#317d" title='d' data-ref="317d" data-ref-filename="317d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>; <a class="local col1 ref" href="#321i" title='i' data-ref="321i" data-ref-filename="321i">i</a>++) {</td></tr>
<tr><th id="670">670</th><td>		<b>if</b>(<a class="local col7 ref" href="#317d" title='d' data-ref="317d" data-ref-filename="317d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<a class="local col1 ref" href="#321i" title='i' data-ref="321i" data-ref-filename="321i">i</a>] != <a class="local col9 ref" href="#319len" title='len' data-ref="319len" data-ref-filename="319len">len</a>)</td></tr>
<tr><th id="671">671</th><td>			<b>continue</b>;</td></tr>
<tr><th id="672">672</th><td>		<b>if</b>(<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#memcmp" title='memcmp' data-ref="memcmp" data-ref-filename="memcmp">memcmp</a>(<a class="local col7 ref" href="#317d" title='d' data-ref="317d" data-ref-filename="317d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<a class="local col1 ref" href="#321i" title='i' data-ref="321i" data-ref-filename="321i">i</a>], <a class="local col8 ref" href="#318rdata" title='rdata' data-ref="318rdata" data-ref-filename="318rdata">rdata</a>, <a class="local col9 ref" href="#319len" title='len' data-ref="319len" data-ref-filename="319len">len</a>) == <var>0</var>) {</td></tr>
<tr><th id="673">673</th><td>			*<a class="local col0 ref" href="#320index" title='index' data-ref="320index" data-ref-filename="320index">index</a> = <a class="local col1 ref" href="#321i" title='i' data-ref="321i" data-ref-filename="321i">i</a>;</td></tr>
<tr><th id="674">674</th><td>			<b>return</b> <var>1</var>;</td></tr>
<tr><th id="675">675</th><td>		}</td></tr>
<tr><th id="676">676</th><td>	}</td></tr>
<tr><th id="677">677</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="678">678</th><td>}</td></tr>
<tr><th id="679">679</th><td></td></tr>
<tr><th id="680">680</th><td><i class="doc" data-doc="az_rrset_find_rrsig">/** find an rrsig index in the rrset.  returns true if found */</i></td></tr>
<tr><th id="681">681</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="682">682</th><td><dfn class="tu decl def fn" id="az_rrset_find_rrsig" title='az_rrset_find_rrsig' data-type='int az_rrset_find_rrsig(struct packed_rrset_data * d, uint8_t * rdata, size_t len, size_t * index)' data-ref="az_rrset_find_rrsig" data-ref-filename="az_rrset_find_rrsig">az_rrset_find_rrsig</dfn>(<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>* <dfn class="local col2 decl" id="322d" title='d' data-type='struct packed_rrset_data *' data-ref="322d" data-ref-filename="322d">d</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col3 decl" id="323rdata" title='rdata' data-type='uint8_t *' data-ref="323rdata" data-ref-filename="323rdata">rdata</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col4 decl" id="324len" title='len' data-type='size_t' data-ref="324len" data-ref-filename="324len">len</dfn>,</td></tr>
<tr><th id="683">683</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>* <dfn class="local col5 decl" id="325index" title='index' data-type='size_t *' data-ref="325index" data-ref-filename="325index">index</dfn>)</td></tr>
<tr><th id="684">684</th><td>{</td></tr>
<tr><th id="685">685</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col6 decl" id="326i" title='i' data-type='size_t' data-ref="326i" data-ref-filename="326i">i</dfn>;</td></tr>
<tr><th id="686">686</th><td>	<b>for</b>(<a class="local col6 ref" href="#326i" title='i' data-ref="326i" data-ref-filename="326i">i</a>=<a class="local col2 ref" href="#322d" title='d' data-ref="322d" data-ref-filename="322d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>; <a class="local col6 ref" href="#326i" title='i' data-ref="326i" data-ref-filename="326i">i</a>&lt;<a class="local col2 ref" href="#322d" title='d' data-ref="322d" data-ref-filename="322d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a> + <a class="local col2 ref" href="#322d" title='d' data-ref="322d" data-ref-filename="322d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a>; <a class="local col6 ref" href="#326i" title='i' data-ref="326i" data-ref-filename="326i">i</a>++) {</td></tr>
<tr><th id="687">687</th><td>		<b>if</b>(<a class="local col2 ref" href="#322d" title='d' data-ref="322d" data-ref-filename="322d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<a class="local col6 ref" href="#326i" title='i' data-ref="326i" data-ref-filename="326i">i</a>] != <a class="local col4 ref" href="#324len" title='len' data-ref="324len" data-ref-filename="324len">len</a>)</td></tr>
<tr><th id="688">688</th><td>			<b>continue</b>;</td></tr>
<tr><th id="689">689</th><td>		<b>if</b>(<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#memcmp" title='memcmp' data-ref="memcmp" data-ref-filename="memcmp">memcmp</a>(<a class="local col2 ref" href="#322d" title='d' data-ref="322d" data-ref-filename="322d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<a class="local col6 ref" href="#326i" title='i' data-ref="326i" data-ref-filename="326i">i</a>], <a class="local col3 ref" href="#323rdata" title='rdata' data-ref="323rdata" data-ref-filename="323rdata">rdata</a>, <a class="local col4 ref" href="#324len" title='len' data-ref="324len" data-ref-filename="324len">len</a>) == <var>0</var>) {</td></tr>
<tr><th id="690">690</th><td>			*<a class="local col5 ref" href="#325index" title='index' data-ref="325index" data-ref-filename="325index">index</a> = <a class="local col6 ref" href="#326i" title='i' data-ref="326i" data-ref-filename="326i">i</a>;</td></tr>
<tr><th id="691">691</th><td>			<b>return</b> <var>1</var>;</td></tr>
<tr><th id="692">692</th><td>		}</td></tr>
<tr><th id="693">693</th><td>	}</td></tr>
<tr><th id="694">694</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="695">695</th><td>}</td></tr>
<tr><th id="696">696</th><td></td></tr>
<tr><th id="697">697</th><td><i class="doc" data-doc="rdata_duplicate">/** see if rdata is duplicate */</i></td></tr>
<tr><th id="698">698</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="699">699</th><td><dfn class="tu decl def fn" id="rdata_duplicate" title='rdata_duplicate' data-type='int rdata_duplicate(struct packed_rrset_data * d, uint8_t * rdata, size_t len)' data-ref="rdata_duplicate" data-ref-filename="rdata_duplicate">rdata_duplicate</dfn>(<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>* <dfn class="local col7 decl" id="327d" title='d' data-type='struct packed_rrset_data *' data-ref="327d" data-ref-filename="327d">d</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col8 decl" id="328rdata" title='rdata' data-type='uint8_t *' data-ref="328rdata" data-ref-filename="328rdata">rdata</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col9 decl" id="329len" title='len' data-type='size_t' data-ref="329len" data-ref-filename="329len">len</dfn>)</td></tr>
<tr><th id="700">700</th><td>{</td></tr>
<tr><th id="701">701</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col0 decl" id="330i" title='i' data-type='size_t' data-ref="330i" data-ref-filename="330i">i</dfn>;</td></tr>
<tr><th id="702">702</th><td>	<b>for</b>(<a class="local col0 ref" href="#330i" title='i' data-ref="330i" data-ref-filename="330i">i</a>=<var>0</var>; <a class="local col0 ref" href="#330i" title='i' data-ref="330i" data-ref-filename="330i">i</a>&lt;<a class="local col7 ref" href="#327d" title='d' data-ref="327d" data-ref-filename="327d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a> + <a class="local col7 ref" href="#327d" title='d' data-ref="327d" data-ref-filename="327d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a>; <a class="local col0 ref" href="#330i" title='i' data-ref="330i" data-ref-filename="330i">i</a>++) {</td></tr>
<tr><th id="703">703</th><td>		<b>if</b>(<a class="local col7 ref" href="#327d" title='d' data-ref="327d" data-ref-filename="327d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<a class="local col0 ref" href="#330i" title='i' data-ref="330i" data-ref-filename="330i">i</a>] != <a class="local col9 ref" href="#329len" title='len' data-ref="329len" data-ref-filename="329len">len</a>)</td></tr>
<tr><th id="704">704</th><td>			<b>continue</b>;</td></tr>
<tr><th id="705">705</th><td>		<b>if</b>(<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#memcmp" title='memcmp' data-ref="memcmp" data-ref-filename="memcmp">memcmp</a>(<a class="local col7 ref" href="#327d" title='d' data-ref="327d" data-ref-filename="327d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<a class="local col0 ref" href="#330i" title='i' data-ref="330i" data-ref-filename="330i">i</a>], <a class="local col8 ref" href="#328rdata" title='rdata' data-ref="328rdata" data-ref-filename="328rdata">rdata</a>, <a class="local col9 ref" href="#329len" title='len' data-ref="329len" data-ref-filename="329len">len</a>) == <var>0</var>)</td></tr>
<tr><th id="706">706</th><td>			<b>return</b> <var>1</var>;</td></tr>
<tr><th id="707">707</th><td>	}</td></tr>
<tr><th id="708">708</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="709">709</th><td>}</td></tr>
<tr><th id="710">710</th><td></td></tr>
<tr><th id="711">711</th><td><i class="doc" data-doc="rrsig_rdata_get_type_covered">/** get rrsig type covered from rdata.</i></td></tr>
<tr><th id="712">712</th><td><i class="doc" data-doc="rrsig_rdata_get_type_covered"> * <span class="command">@param</span> <span class="arg">rdata:</span> rdata in wireformat, starting with 16bit rdlength.</i></td></tr>
<tr><th id="713">713</th><td><i class="doc" data-doc="rrsig_rdata_get_type_covered"> * <span class="command">@param</span> <span class="arg">rdatalen:</span> length of rdata buffer.</i></td></tr>
<tr><th id="714">714</th><td><i class="doc" data-doc="rrsig_rdata_get_type_covered"> * <span class="command">@return</span> type covered (or 0).</i></td></tr>
<tr><th id="715">715</th><td><i class="doc" data-doc="rrsig_rdata_get_type_covered"> */</i></td></tr>
<tr><th id="716">716</th><td><em>static</em> <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a></td></tr>
<tr><th id="717">717</th><td><dfn class="tu decl def fn" id="rrsig_rdata_get_type_covered" title='rrsig_rdata_get_type_covered' data-type='uint16_t rrsig_rdata_get_type_covered(uint8_t * rdata, size_t rdatalen)' data-ref="rrsig_rdata_get_type_covered" data-ref-filename="rrsig_rdata_get_type_covered">rrsig_rdata_get_type_covered</dfn>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col1 decl" id="331rdata" title='rdata' data-type='uint8_t *' data-ref="331rdata" data-ref-filename="331rdata">rdata</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col2 decl" id="332rdatalen" title='rdatalen' data-type='size_t' data-ref="332rdatalen" data-ref-filename="332rdatalen">rdatalen</dfn>)</td></tr>
<tr><th id="718">718</th><td>{</td></tr>
<tr><th id="719">719</th><td>	<b>if</b>(<a class="local col2 ref" href="#332rdatalen" title='rdatalen' data-ref="332rdatalen" data-ref-filename="332rdatalen">rdatalen</a> &lt; <var>4</var>)</td></tr>
<tr><th id="720">720</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="721">721</th><td>	<b>return</b> <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_read_uint16" title='sldns_read_uint16' data-ref="sldns_read_uint16" data-ref-filename="sldns_read_uint16">sldns_read_uint16</a>(<a class="local col1 ref" href="#331rdata" title='rdata' data-ref="331rdata" data-ref-filename="331rdata">rdata</a>+<var>2</var>);</td></tr>
<tr><th id="722">722</th><td>}</td></tr>
<tr><th id="723">723</th><td></td></tr>
<tr><th id="724">724</th><td><i class="doc" data-doc="rrset_remove_rr">/** remove RR from existing RRset. Also sig, if it is a signature.</i></td></tr>
<tr><th id="725">725</th><td><i class="doc" data-doc="rrset_remove_rr"> * reallocates the packed rrset for a new one, false on alloc failure */</i></td></tr>
<tr><th id="726">726</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="727">727</th><td><dfn class="tu decl def fn" id="rrset_remove_rr" title='rrset_remove_rr' data-type='int rrset_remove_rr(struct auth_rrset * rrset, size_t index)' data-ref="rrset_remove_rr" data-ref-filename="rrset_remove_rr">rrset_remove_rr</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col3 decl" id="333rrset" title='rrset' data-type='struct auth_rrset *' data-ref="333rrset" data-ref-filename="333rrset">rrset</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col4 decl" id="334index" title='index' data-type='size_t' data-ref="334index" data-ref-filename="334index">index</dfn>)</td></tr>
<tr><th id="728">728</th><td>{</td></tr>
<tr><th id="729">729</th><td>	<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>* <dfn class="local col5 decl" id="335d" title='d' data-type='struct packed_rrset_data *' data-ref="335d" data-ref-filename="335d">d</dfn>, *<dfn class="local col6 decl" id="336old" title='old' data-type='struct packed_rrset_data *' data-ref="336old" data-ref-filename="336old">old</dfn> = <a class="local col3 ref" href="#333rrset" title='rrset' data-ref="333rrset" data-ref-filename="333rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>;</td></tr>
<tr><th id="730">730</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col7 decl" id="337i" title='i' data-type='size_t' data-ref="337i" data-ref-filename="337i">i</dfn>;</td></tr>
<tr><th id="731">731</th><td>	<b>if</b>(<a class="local col4 ref" href="#334index" title='index' data-ref="334index" data-ref-filename="334index">index</a> &gt;= <a class="local col6 ref" href="#336old" title='old' data-ref="336old" data-ref-filename="336old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a> + <a class="local col6 ref" href="#336old" title='old' data-ref="336old" data-ref-filename="336old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a>)</td></tr>
<tr><th id="732">732</th><td>		<b>return</b> <var>0</var>; <i>/* index out of bounds */</i></td></tr>
<tr><th id="733">733</th><td>	<a class="local col5 ref" href="#335d" title='d' data-ref="335d" data-ref-filename="335d">d</a> = (<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>*)<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#calloc" title='calloc' data-ref="calloc" data-ref-filename="calloc">calloc</a>(<var>1</var>, <a class="ref fn" href="../util/data/packed_rrset.h.html#packed_rrset_sizeof" title='packed_rrset_sizeof' data-ref="packed_rrset_sizeof" data-ref-filename="packed_rrset_sizeof">packed_rrset_sizeof</a>(<a class="local col6 ref" href="#336old" title='old' data-ref="336old" data-ref-filename="336old">old</a>) - (</td></tr>
<tr><th id="734">734</th><td>		<b>sizeof</b>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>) + <b>sizeof</b>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>*) + <b>sizeof</b>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#time_t" title='time_t' data-type='__int64_t' data-ref="time_t" data-ref-filename="time_t">time_t</a>) +</td></tr>
<tr><th id="735">735</th><td>		<a class="local col6 ref" href="#336old" title='old' data-ref="336old" data-ref-filename="336old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<a class="local col4 ref" href="#334index" title='index' data-ref="334index" data-ref-filename="334index">index</a>]));</td></tr>
<tr><th id="736">736</th><td>	<b>if</b>(!<a class="local col5 ref" href="#335d" title='d' data-ref="335d" data-ref-filename="335d">d</a>) {</td></tr>
<tr><th id="737">737</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"malloc failure"</q>);</td></tr>
<tr><th id="738">738</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="739">739</th><td>	}</td></tr>
<tr><th id="740">740</th><td>	<a class="local col5 ref" href="#335d" title='d' data-ref="335d" data-ref-filename="335d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::ttl" title='packed_rrset_data::ttl' data-ref="packed_rrset_data::ttl" data-ref-filename="packed_rrset_data..ttl">ttl</a> = <a class="local col6 ref" href="#336old" title='old' data-ref="336old" data-ref-filename="336old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::ttl" title='packed_rrset_data::ttl' data-ref="packed_rrset_data::ttl" data-ref-filename="packed_rrset_data..ttl">ttl</a>;</td></tr>
<tr><th id="741">741</th><td>	<a class="local col5 ref" href="#335d" title='d' data-ref="335d" data-ref-filename="335d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a> = <a class="local col6 ref" href="#336old" title='old' data-ref="336old" data-ref-filename="336old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>;</td></tr>
<tr><th id="742">742</th><td>	<a class="local col5 ref" href="#335d" title='d' data-ref="335d" data-ref-filename="335d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a> = <a class="local col6 ref" href="#336old" title='old' data-ref="336old" data-ref-filename="336old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a>;</td></tr>
<tr><th id="743">743</th><td>	<b>if</b>(<a class="local col4 ref" href="#334index" title='index' data-ref="334index" data-ref-filename="334index">index</a> &lt; <a class="local col5 ref" href="#335d" title='d' data-ref="335d" data-ref-filename="335d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>) <a class="local col5 ref" href="#335d" title='d' data-ref="335d" data-ref-filename="335d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>--;</td></tr>
<tr><th id="744">744</th><td>	<b>else</b> <a class="local col5 ref" href="#335d" title='d' data-ref="335d" data-ref-filename="335d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a>--;</td></tr>
<tr><th id="745">745</th><td>	<a class="local col5 ref" href="#335d" title='d' data-ref="335d" data-ref-filename="335d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::trust" title='packed_rrset_data::trust' data-ref="packed_rrset_data::trust" data-ref-filename="packed_rrset_data..trust">trust</a> = <a class="local col6 ref" href="#336old" title='old' data-ref="336old" data-ref-filename="336old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::trust" title='packed_rrset_data::trust' data-ref="packed_rrset_data::trust" data-ref-filename="packed_rrset_data..trust">trust</a>;</td></tr>
<tr><th id="746">746</th><td>	<a class="local col5 ref" href="#335d" title='d' data-ref="335d" data-ref-filename="335d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::security" title='packed_rrset_data::security' data-ref="packed_rrset_data::security" data-ref-filename="packed_rrset_data..security">security</a> = <a class="local col6 ref" href="#336old" title='old' data-ref="336old" data-ref-filename="336old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::security" title='packed_rrset_data::security' data-ref="packed_rrset_data::security" data-ref-filename="packed_rrset_data..security">security</a>;</td></tr>
<tr><th id="747">747</th><td></td></tr>
<tr><th id="748">748</th><td>	<i>/* set rr_len, needed for ptr_fixup */</i></td></tr>
<tr><th id="749">749</th><td>	<a class="local col5 ref" href="#335d" title='d' data-ref="335d" data-ref-filename="335d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a> = (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>*)((<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>*)<a class="local col5 ref" href="#335d" title='d' data-ref="335d" data-ref-filename="335d">d</a> +</td></tr>
<tr><th id="750">750</th><td>		<b>sizeof</b>(<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>));</td></tr>
<tr><th id="751">751</th><td>	<b>if</b>(<a class="local col4 ref" href="#334index" title='index' data-ref="334index" data-ref-filename="334index">index</a> &gt; <var>0</var>)</td></tr>
<tr><th id="752">752</th><td>		<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(d-&gt;rr_len, 0) != (size_t)-1) ? __builtin___memmove_chk(d-&gt;rr_len, old-&gt;rr_len, (index)*sizeof(size_t), __builtin_object_size(d-&gt;rr_len, 0)) : __memmove_ichk(d-&gt;rr_len, old-&gt;rr_len, (index)*sizeof(size_t)))" data-ref="_M/memmove">memmove</a>(<a class="local col5 ref" href="#335d" title='d' data-ref="335d" data-ref-filename="335d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>, <a class="local col6 ref" href="#336old" title='old' data-ref="336old" data-ref-filename="336old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>, (<a class="local col4 ref" href="#334index" title='index' data-ref="334index" data-ref-filename="334index">index</a>)*<b>sizeof</b>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>));</td></tr>
<tr><th id="753">753</th><td>	<b>if</b>(<a class="local col4 ref" href="#334index" title='index' data-ref="334index" data-ref-filename="334index">index</a>+<var>1</var> &lt; <a class="local col6 ref" href="#336old" title='old' data-ref="336old" data-ref-filename="336old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>+<a class="local col6 ref" href="#336old" title='old' data-ref="336old" data-ref-filename="336old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a>)</td></tr>
<tr><th id="754">754</th><td>		<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(&amp;d-&gt;rr_len[index], 0) != (size_t)-1) ? __builtin___memmove_chk(&amp;d-&gt;rr_len[index], &amp;old-&gt;rr_len[index+1], (old-&gt;count+old-&gt;rrsig_count - (index+1))*sizeof(size_t), __builtin_object_size(&amp;d-&gt;rr_len[index], 0)) : __memmove_ichk(&amp;d-&gt;rr_len[index], &amp;old-&gt;rr_len[index+1], (old-&gt;count+old-&gt;rrsig_count - (index+1))*sizeof(size_t)))" data-ref="_M/memmove">memmove</a>(&amp;<a class="local col5 ref" href="#335d" title='d' data-ref="335d" data-ref-filename="335d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<a class="local col4 ref" href="#334index" title='index' data-ref="334index" data-ref-filename="334index">index</a>], &amp;<a class="local col6 ref" href="#336old" title='old' data-ref="336old" data-ref-filename="336old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<a class="local col4 ref" href="#334index" title='index' data-ref="334index" data-ref-filename="334index">index</a>+<var>1</var>],</td></tr>
<tr><th id="755">755</th><td>		(<a class="local col6 ref" href="#336old" title='old' data-ref="336old" data-ref-filename="336old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>+<a class="local col6 ref" href="#336old" title='old' data-ref="336old" data-ref-filename="336old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a> - (<a class="local col4 ref" href="#334index" title='index' data-ref="334index" data-ref-filename="334index">index</a>+<var>1</var>))*<b>sizeof</b>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>));</td></tr>
<tr><th id="756">756</th><td>	<a class="ref fn" href="../util/data/packed_rrset.h.html#packed_rrset_ptr_fixup" title='packed_rrset_ptr_fixup' data-ref="packed_rrset_ptr_fixup" data-ref-filename="packed_rrset_ptr_fixup">packed_rrset_ptr_fixup</a>(<a class="local col5 ref" href="#335d" title='d' data-ref="335d" data-ref-filename="335d">d</a>);</td></tr>
<tr><th id="757">757</th><td></td></tr>
<tr><th id="758">758</th><td>	<i>/* move over ttls */</i></td></tr>
<tr><th id="759">759</th><td>	<b>if</b>(<a class="local col4 ref" href="#334index" title='index' data-ref="334index" data-ref-filename="334index">index</a> &gt; <var>0</var>)</td></tr>
<tr><th id="760">760</th><td>		<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(d-&gt;rr_ttl, 0) != (size_t)-1) ? __builtin___memmove_chk(d-&gt;rr_ttl, old-&gt;rr_ttl, (index)*sizeof(time_t), __builtin_object_size(d-&gt;rr_ttl, 0)) : __memmove_ichk(d-&gt;rr_ttl, old-&gt;rr_ttl, (index)*sizeof(time_t)))" data-ref="_M/memmove">memmove</a>(<a class="local col5 ref" href="#335d" title='d' data-ref="335d" data-ref-filename="335d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_ttl" title='packed_rrset_data::rr_ttl' data-ref="packed_rrset_data::rr_ttl" data-ref-filename="packed_rrset_data..rr_ttl">rr_ttl</a>, <a class="local col6 ref" href="#336old" title='old' data-ref="336old" data-ref-filename="336old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_ttl" title='packed_rrset_data::rr_ttl' data-ref="packed_rrset_data::rr_ttl" data-ref-filename="packed_rrset_data..rr_ttl">rr_ttl</a>, (<a class="local col4 ref" href="#334index" title='index' data-ref="334index" data-ref-filename="334index">index</a>)*<b>sizeof</b>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#time_t" title='time_t' data-type='__int64_t' data-ref="time_t" data-ref-filename="time_t">time_t</a>));</td></tr>
<tr><th id="761">761</th><td>	<b>if</b>(<a class="local col4 ref" href="#334index" title='index' data-ref="334index" data-ref-filename="334index">index</a>+<var>1</var> &lt; <a class="local col6 ref" href="#336old" title='old' data-ref="336old" data-ref-filename="336old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>+<a class="local col6 ref" href="#336old" title='old' data-ref="336old" data-ref-filename="336old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a>)</td></tr>
<tr><th id="762">762</th><td>		<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(&amp;d-&gt;rr_ttl[index], 0) != (size_t)-1) ? __builtin___memmove_chk(&amp;d-&gt;rr_ttl[index], &amp;old-&gt;rr_ttl[index+1], (old-&gt;count+old-&gt;rrsig_count - (index+1))*sizeof(time_t), __builtin_object_size(&amp;d-&gt;rr_ttl[index], 0)) : __memmove_ichk(&amp;d-&gt;rr_ttl[index], &amp;old-&gt;rr_ttl[index+1], (old-&gt;count+old-&gt;rrsig_count - (index+1))*sizeof(time_t)))" data-ref="_M/memmove">memmove</a>(&amp;<a class="local col5 ref" href="#335d" title='d' data-ref="335d" data-ref-filename="335d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_ttl" title='packed_rrset_data::rr_ttl' data-ref="packed_rrset_data::rr_ttl" data-ref-filename="packed_rrset_data..rr_ttl">rr_ttl</a>[<a class="local col4 ref" href="#334index" title='index' data-ref="334index" data-ref-filename="334index">index</a>], &amp;<a class="local col6 ref" href="#336old" title='old' data-ref="336old" data-ref-filename="336old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_ttl" title='packed_rrset_data::rr_ttl' data-ref="packed_rrset_data::rr_ttl" data-ref-filename="packed_rrset_data..rr_ttl">rr_ttl</a>[<a class="local col4 ref" href="#334index" title='index' data-ref="334index" data-ref-filename="334index">index</a>+<var>1</var>],</td></tr>
<tr><th id="763">763</th><td>		(<a class="local col6 ref" href="#336old" title='old' data-ref="336old" data-ref-filename="336old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>+<a class="local col6 ref" href="#336old" title='old' data-ref="336old" data-ref-filename="336old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a> - (<a class="local col4 ref" href="#334index" title='index' data-ref="334index" data-ref-filename="334index">index</a>+<var>1</var>))*<b>sizeof</b>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#time_t" title='time_t' data-type='__int64_t' data-ref="time_t" data-ref-filename="time_t">time_t</a>));</td></tr>
<tr><th id="764">764</th><td>	</td></tr>
<tr><th id="765">765</th><td>	<i>/* move over rr_data */</i></td></tr>
<tr><th id="766">766</th><td>	<b>for</b>(<a class="local col7 ref" href="#337i" title='i' data-ref="337i" data-ref-filename="337i">i</a>=<var>0</var>; <a class="local col7 ref" href="#337i" title='i' data-ref="337i" data-ref-filename="337i">i</a>&lt;<a class="local col5 ref" href="#335d" title='d' data-ref="335d" data-ref-filename="335d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>+<a class="local col5 ref" href="#335d" title='d' data-ref="335d" data-ref-filename="335d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a>; <a class="local col7 ref" href="#337i" title='i' data-ref="337i" data-ref-filename="337i">i</a>++) {</td></tr>
<tr><th id="767">767</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col8 decl" id="338oldi" title='oldi' data-type='size_t' data-ref="338oldi" data-ref-filename="338oldi">oldi</dfn>;</td></tr>
<tr><th id="768">768</th><td>		<b>if</b>(<a class="local col7 ref" href="#337i" title='i' data-ref="337i" data-ref-filename="337i">i</a> &lt; <a class="local col4 ref" href="#334index" title='index' data-ref="334index" data-ref-filename="334index">index</a>) <a class="local col8 ref" href="#338oldi" title='oldi' data-ref="338oldi" data-ref-filename="338oldi">oldi</a> = <a class="local col7 ref" href="#337i" title='i' data-ref="337i" data-ref-filename="337i">i</a>;</td></tr>
<tr><th id="769">769</th><td>		<b>else</b> <a class="local col8 ref" href="#338oldi" title='oldi' data-ref="338oldi" data-ref-filename="338oldi">oldi</a> = <a class="local col7 ref" href="#337i" title='i' data-ref="337i" data-ref-filename="337i">i</a>+<var>1</var>;</td></tr>
<tr><th id="770">770</th><td>		<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(d-&gt;rr_data[i], 0) != (size_t)-1) ? __builtin___memmove_chk(d-&gt;rr_data[i], old-&gt;rr_data[oldi], d-&gt;rr_len[i], __builtin_object_size(d-&gt;rr_data[i], 0)) : __memmove_ichk(d-&gt;rr_data[i], old-&gt;rr_data[oldi], d-&gt;rr_len[i]))" data-ref="_M/memmove">memmove</a>(<a class="local col5 ref" href="#335d" title='d' data-ref="335d" data-ref-filename="335d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<a class="local col7 ref" href="#337i" title='i' data-ref="337i" data-ref-filename="337i">i</a>], <a class="local col6 ref" href="#336old" title='old' data-ref="336old" data-ref-filename="336old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<a class="local col8 ref" href="#338oldi" title='oldi' data-ref="338oldi" data-ref-filename="338oldi">oldi</a>], <a class="local col5 ref" href="#335d" title='d' data-ref="335d" data-ref-filename="335d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<a class="local col7 ref" href="#337i" title='i' data-ref="337i" data-ref-filename="337i">i</a>]);</td></tr>
<tr><th id="771">771</th><td>	}</td></tr>
<tr><th id="772">772</th><td></td></tr>
<tr><th id="773">773</th><td>	<i>/* recalc ttl (lowest of remaining RR ttls) */</i></td></tr>
<tr><th id="774">774</th><td>	<b>if</b>(<a class="local col5 ref" href="#335d" title='d' data-ref="335d" data-ref-filename="335d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a> + <a class="local col5 ref" href="#335d" title='d' data-ref="335d" data-ref-filename="335d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a> &gt; <var>0</var>)</td></tr>
<tr><th id="775">775</th><td>		<a class="local col5 ref" href="#335d" title='d' data-ref="335d" data-ref-filename="335d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::ttl" title='packed_rrset_data::ttl' data-ref="packed_rrset_data::ttl" data-ref-filename="packed_rrset_data..ttl">ttl</a> = <a class="local col5 ref" href="#335d" title='d' data-ref="335d" data-ref-filename="335d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_ttl" title='packed_rrset_data::rr_ttl' data-ref="packed_rrset_data::rr_ttl" data-ref-filename="packed_rrset_data..rr_ttl">rr_ttl</a>[<var>0</var>];</td></tr>
<tr><th id="776">776</th><td>	<b>for</b>(<a class="local col7 ref" href="#337i" title='i' data-ref="337i" data-ref-filename="337i">i</a>=<var>0</var>; <a class="local col7 ref" href="#337i" title='i' data-ref="337i" data-ref-filename="337i">i</a>&lt;<a class="local col5 ref" href="#335d" title='d' data-ref="335d" data-ref-filename="335d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>+<a class="local col5 ref" href="#335d" title='d' data-ref="335d" data-ref-filename="335d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a>; <a class="local col7 ref" href="#337i" title='i' data-ref="337i" data-ref-filename="337i">i</a>++) {</td></tr>
<tr><th id="777">777</th><td>		<b>if</b>(<a class="local col5 ref" href="#335d" title='d' data-ref="335d" data-ref-filename="335d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_ttl" title='packed_rrset_data::rr_ttl' data-ref="packed_rrset_data::rr_ttl" data-ref-filename="packed_rrset_data..rr_ttl">rr_ttl</a>[<a class="local col7 ref" href="#337i" title='i' data-ref="337i" data-ref-filename="337i">i</a>] &lt; <a class="local col5 ref" href="#335d" title='d' data-ref="335d" data-ref-filename="335d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::ttl" title='packed_rrset_data::ttl' data-ref="packed_rrset_data::ttl" data-ref-filename="packed_rrset_data..ttl">ttl</a>)</td></tr>
<tr><th id="778">778</th><td>			<a class="local col5 ref" href="#335d" title='d' data-ref="335d" data-ref-filename="335d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::ttl" title='packed_rrset_data::ttl' data-ref="packed_rrset_data::ttl" data-ref-filename="packed_rrset_data..ttl">ttl</a> = <a class="local col5 ref" href="#335d" title='d' data-ref="335d" data-ref-filename="335d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_ttl" title='packed_rrset_data::rr_ttl' data-ref="packed_rrset_data::rr_ttl" data-ref-filename="packed_rrset_data..rr_ttl">rr_ttl</a>[<a class="local col7 ref" href="#337i" title='i' data-ref="337i" data-ref-filename="337i">i</a>];</td></tr>
<tr><th id="779">779</th><td>	}</td></tr>
<tr><th id="780">780</th><td></td></tr>
<tr><th id="781">781</th><td>	<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col3 ref" href="#333rrset" title='rrset' data-ref="333rrset" data-ref-filename="333rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>);</td></tr>
<tr><th id="782">782</th><td>	<a class="local col3 ref" href="#333rrset" title='rrset' data-ref="333rrset" data-ref-filename="333rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a> = <a class="local col5 ref" href="#335d" title='d' data-ref="335d" data-ref-filename="335d">d</a>;</td></tr>
<tr><th id="783">783</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="784">784</th><td>}</td></tr>
<tr><th id="785">785</th><td></td></tr>
<tr><th id="786">786</th><td><i class="doc" data-doc="rrset_add_rr">/** add RR to existing RRset. If insert_sig is true, add to rrsigs. </i></td></tr>
<tr><th id="787">787</th><td><i class="doc" data-doc="rrset_add_rr"> * This reallocates the packed rrset for a new one */</i></td></tr>
<tr><th id="788">788</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="789">789</th><td><dfn class="tu decl def fn" id="rrset_add_rr" title='rrset_add_rr' data-type='int rrset_add_rr(struct auth_rrset * rrset, uint32_t rr_ttl, uint8_t * rdata, size_t rdatalen, int insert_sig)' data-ref="rrset_add_rr" data-ref-filename="rrset_add_rr">rrset_add_rr</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col9 decl" id="339rrset" title='rrset' data-type='struct auth_rrset *' data-ref="339rrset" data-ref-filename="339rrset">rrset</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a> <dfn class="local col0 decl" id="340rr_ttl" title='rr_ttl' data-type='uint32_t' data-ref="340rr_ttl" data-ref-filename="340rr_ttl">rr_ttl</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col1 decl" id="341rdata" title='rdata' data-type='uint8_t *' data-ref="341rdata" data-ref-filename="341rdata">rdata</dfn>,</td></tr>
<tr><th id="790">790</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col2 decl" id="342rdatalen" title='rdatalen' data-type='size_t' data-ref="342rdatalen" data-ref-filename="342rdatalen">rdatalen</dfn>, <em>int</em> <dfn class="local col3 decl" id="343insert_sig" title='insert_sig' data-type='int' data-ref="343insert_sig" data-ref-filename="343insert_sig">insert_sig</dfn>)</td></tr>
<tr><th id="791">791</th><td>{</td></tr>
<tr><th id="792">792</th><td>	<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>* <dfn class="local col4 decl" id="344d" title='d' data-type='struct packed_rrset_data *' data-ref="344d" data-ref-filename="344d">d</dfn>, *<dfn class="local col5 decl" id="345old" title='old' data-type='struct packed_rrset_data *' data-ref="345old" data-ref-filename="345old">old</dfn> = <a class="local col9 ref" href="#339rrset" title='rrset' data-ref="339rrset" data-ref-filename="339rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>;</td></tr>
<tr><th id="793">793</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col6 decl" id="346total" title='total' data-type='size_t' data-ref="346total" data-ref-filename="346total">total</dfn>, <dfn class="local col7 decl" id="347old_total" title='old_total' data-type='size_t' data-ref="347old_total" data-ref-filename="347old_total">old_total</dfn>;</td></tr>
<tr><th id="794">794</th><td></td></tr>
<tr><th id="795">795</th><td>	<a class="local col4 ref" href="#344d" title='d' data-ref="344d" data-ref-filename="344d">d</a> = (<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>*)<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#calloc" title='calloc' data-ref="calloc" data-ref-filename="calloc">calloc</a>(<var>1</var>, <a class="ref fn" href="../util/data/packed_rrset.h.html#packed_rrset_sizeof" title='packed_rrset_sizeof' data-ref="packed_rrset_sizeof" data-ref-filename="packed_rrset_sizeof">packed_rrset_sizeof</a>(<a class="local col5 ref" href="#345old" title='old' data-ref="345old" data-ref-filename="345old">old</a>)</td></tr>
<tr><th id="796">796</th><td>		+ <b>sizeof</b>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>) + <b>sizeof</b>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>*) + <b>sizeof</b>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#time_t" title='time_t' data-type='__int64_t' data-ref="time_t" data-ref-filename="time_t">time_t</a>)</td></tr>
<tr><th id="797">797</th><td>		+ <a class="local col2 ref" href="#342rdatalen" title='rdatalen' data-ref="342rdatalen" data-ref-filename="342rdatalen">rdatalen</a>);</td></tr>
<tr><th id="798">798</th><td>	<b>if</b>(!<a class="local col4 ref" href="#344d" title='d' data-ref="344d" data-ref-filename="344d">d</a>) {</td></tr>
<tr><th id="799">799</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"out of memory"</q>);</td></tr>
<tr><th id="800">800</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="801">801</th><td>	}</td></tr>
<tr><th id="802">802</th><td>	<i>/* copy base values */</i></td></tr>
<tr><th id="803">803</th><td>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#95" title="((__builtin_object_size(d, 0) != (size_t)-1) ? __builtin___memcpy_chk(d, old, sizeof(struct packed_rrset_data), __builtin_object_size(d, 0)) : __memcpy_ichk(d, old, sizeof(struct packed_rrset_data)))" data-ref="_M/memcpy">memcpy</a>(<a class="local col4 ref" href="#344d" title='d' data-ref="344d" data-ref-filename="344d">d</a>, <a class="local col5 ref" href="#345old" title='old' data-ref="345old" data-ref-filename="345old">old</a>, <b>sizeof</b>(<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>));</td></tr>
<tr><th id="804">804</th><td>	<b>if</b>(!<a class="local col3 ref" href="#343insert_sig" title='insert_sig' data-ref="343insert_sig" data-ref-filename="343insert_sig">insert_sig</a>) {</td></tr>
<tr><th id="805">805</th><td>		<a class="local col4 ref" href="#344d" title='d' data-ref="344d" data-ref-filename="344d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>++;</td></tr>
<tr><th id="806">806</th><td>	} <b>else</b> {</td></tr>
<tr><th id="807">807</th><td>		<a class="local col4 ref" href="#344d" title='d' data-ref="344d" data-ref-filename="344d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a>++;</td></tr>
<tr><th id="808">808</th><td>	}</td></tr>
<tr><th id="809">809</th><td>	<a class="local col7 ref" href="#347old_total" title='old_total' data-ref="347old_total" data-ref-filename="347old_total">old_total</a> = <a class="local col5 ref" href="#345old" title='old' data-ref="345old" data-ref-filename="345old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a> + <a class="local col5 ref" href="#345old" title='old' data-ref="345old" data-ref-filename="345old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a>;</td></tr>
<tr><th id="810">810</th><td>	<a class="local col6 ref" href="#346total" title='total' data-ref="346total" data-ref-filename="346total">total</a> = <a class="local col4 ref" href="#344d" title='d' data-ref="344d" data-ref-filename="344d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a> + <a class="local col4 ref" href="#344d" title='d' data-ref="344d" data-ref-filename="344d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a>;</td></tr>
<tr><th id="811">811</th><td>	<i>/* set rr_len, needed for ptr_fixup */</i></td></tr>
<tr><th id="812">812</th><td>	<a class="local col4 ref" href="#344d" title='d' data-ref="344d" data-ref-filename="344d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a> = (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>*)((<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>*)<a class="local col4 ref" href="#344d" title='d' data-ref="344d" data-ref-filename="344d">d</a> +</td></tr>
<tr><th id="813">813</th><td>		<b>sizeof</b>(<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>));</td></tr>
<tr><th id="814">814</th><td>	<b>if</b>(<a class="local col5 ref" href="#345old" title='old' data-ref="345old" data-ref-filename="345old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a> != <var>0</var>)</td></tr>
<tr><th id="815">815</th><td>		<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(d-&gt;rr_len, 0) != (size_t)-1) ? __builtin___memmove_chk(d-&gt;rr_len, old-&gt;rr_len, old-&gt;count*sizeof(size_t), __builtin_object_size(d-&gt;rr_len, 0)) : __memmove_ichk(d-&gt;rr_len, old-&gt;rr_len, old-&gt;count*sizeof(size_t)))" data-ref="_M/memmove">memmove</a>(<a class="local col4 ref" href="#344d" title='d' data-ref="344d" data-ref-filename="344d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>, <a class="local col5 ref" href="#345old" title='old' data-ref="345old" data-ref-filename="345old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>, <a class="local col5 ref" href="#345old" title='old' data-ref="345old" data-ref-filename="345old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>*<b>sizeof</b>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>));</td></tr>
<tr><th id="816">816</th><td>	<b>if</b>(<a class="local col5 ref" href="#345old" title='old' data-ref="345old" data-ref-filename="345old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a> != <var>0</var>)</td></tr>
<tr><th id="817">817</th><td>		<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(d-&gt;rr_len+d-&gt;count, 0) != (size_t)-1) ? __builtin___memmove_chk(d-&gt;rr_len+d-&gt;count, old-&gt;rr_len+old-&gt;count, old-&gt;rrsig_count*sizeof(size_t), __builtin_object_size(d-&gt;rr_len+d-&gt;count, 0)) : __memmove_ichk(d-&gt;rr_len+d-&gt;count, old-&gt;rr_len+old-&gt;count, old-&gt;rrsig_count*sizeof(size_t)))" data-ref="_M/memmove">memmove</a>(<a class="local col4 ref" href="#344d" title='d' data-ref="344d" data-ref-filename="344d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>+<a class="local col4 ref" href="#344d" title='d' data-ref="344d" data-ref-filename="344d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>, <a class="local col5 ref" href="#345old" title='old' data-ref="345old" data-ref-filename="345old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>+<a class="local col5 ref" href="#345old" title='old' data-ref="345old" data-ref-filename="345old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>,</td></tr>
<tr><th id="818">818</th><td>			<a class="local col5 ref" href="#345old" title='old' data-ref="345old" data-ref-filename="345old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a>*<b>sizeof</b>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>));</td></tr>
<tr><th id="819">819</th><td>	<b>if</b>(!<a class="local col3 ref" href="#343insert_sig" title='insert_sig' data-ref="343insert_sig" data-ref-filename="343insert_sig">insert_sig</a>)</td></tr>
<tr><th id="820">820</th><td>		<a class="local col4 ref" href="#344d" title='d' data-ref="344d" data-ref-filename="344d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<a class="local col4 ref" href="#344d" title='d' data-ref="344d" data-ref-filename="344d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>-<var>1</var>] = <a class="local col2 ref" href="#342rdatalen" title='rdatalen' data-ref="342rdatalen" data-ref-filename="342rdatalen">rdatalen</a>;</td></tr>
<tr><th id="821">821</th><td>	<b>else</b>	<a class="local col4 ref" href="#344d" title='d' data-ref="344d" data-ref-filename="344d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<a class="local col6 ref" href="#346total" title='total' data-ref="346total" data-ref-filename="346total">total</a>-<var>1</var>] = <a class="local col2 ref" href="#342rdatalen" title='rdatalen' data-ref="342rdatalen" data-ref-filename="342rdatalen">rdatalen</a>;</td></tr>
<tr><th id="822">822</th><td>	<a class="ref fn" href="../util/data/packed_rrset.h.html#packed_rrset_ptr_fixup" title='packed_rrset_ptr_fixup' data-ref="packed_rrset_ptr_fixup" data-ref-filename="packed_rrset_ptr_fixup">packed_rrset_ptr_fixup</a>(<a class="local col4 ref" href="#344d" title='d' data-ref="344d" data-ref-filename="344d">d</a>);</td></tr>
<tr><th id="823">823</th><td>	<b>if</b>((<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#time_t" title='time_t' data-type='__int64_t' data-ref="time_t" data-ref-filename="time_t">time_t</a>)<a class="local col0 ref" href="#340rr_ttl" title='rr_ttl' data-ref="340rr_ttl" data-ref-filename="340rr_ttl">rr_ttl</a> &lt; <a class="local col4 ref" href="#344d" title='d' data-ref="344d" data-ref-filename="344d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::ttl" title='packed_rrset_data::ttl' data-ref="packed_rrset_data::ttl" data-ref-filename="packed_rrset_data..ttl">ttl</a>)</td></tr>
<tr><th id="824">824</th><td>		<a class="local col4 ref" href="#344d" title='d' data-ref="344d" data-ref-filename="344d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::ttl" title='packed_rrset_data::ttl' data-ref="packed_rrset_data::ttl" data-ref-filename="packed_rrset_data..ttl">ttl</a> = <a class="local col0 ref" href="#340rr_ttl" title='rr_ttl' data-ref="340rr_ttl" data-ref-filename="340rr_ttl">rr_ttl</a>;</td></tr>
<tr><th id="825">825</th><td></td></tr>
<tr><th id="826">826</th><td>	<i>/* copy old values into new array */</i></td></tr>
<tr><th id="827">827</th><td>	<b>if</b>(<a class="local col5 ref" href="#345old" title='old' data-ref="345old" data-ref-filename="345old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a> != <var>0</var>) {</td></tr>
<tr><th id="828">828</th><td>		<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(d-&gt;rr_ttl, 0) != (size_t)-1) ? __builtin___memmove_chk(d-&gt;rr_ttl, old-&gt;rr_ttl, old-&gt;count*sizeof(time_t), __builtin_object_size(d-&gt;rr_ttl, 0)) : __memmove_ichk(d-&gt;rr_ttl, old-&gt;rr_ttl, old-&gt;count*sizeof(time_t)))" data-ref="_M/memmove">memmove</a>(<a class="local col4 ref" href="#344d" title='d' data-ref="344d" data-ref-filename="344d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_ttl" title='packed_rrset_data::rr_ttl' data-ref="packed_rrset_data::rr_ttl" data-ref-filename="packed_rrset_data..rr_ttl">rr_ttl</a>, <a class="local col5 ref" href="#345old" title='old' data-ref="345old" data-ref-filename="345old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_ttl" title='packed_rrset_data::rr_ttl' data-ref="packed_rrset_data::rr_ttl" data-ref-filename="packed_rrset_data..rr_ttl">rr_ttl</a>, <a class="local col5 ref" href="#345old" title='old' data-ref="345old" data-ref-filename="345old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>*<b>sizeof</b>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#time_t" title='time_t' data-type='__int64_t' data-ref="time_t" data-ref-filename="time_t">time_t</a>));</td></tr>
<tr><th id="829">829</th><td>		<i>/* all the old rr pieces are allocated sequential, so we</i></td></tr>
<tr><th id="830">830</th><td><i>		 * can copy them in one go */</i></td></tr>
<tr><th id="831">831</th><td>		<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(d-&gt;rr_data[0], 0) != (size_t)-1) ? __builtin___memmove_chk(d-&gt;rr_data[0], old-&gt;rr_data[0], (old-&gt;rr_data[old-&gt;count-1] - old-&gt;rr_data[0]) + old-&gt;rr_len[old-&gt;count-1], __builtin_object_size(d-&gt;rr_data[0], 0)) : __memmove_ichk(d-&gt;rr_data[0], old-&gt;rr_data[0], (old-&gt;rr_data[old-&gt;count-1] - old-&gt;rr_data[0]) + old-&gt;rr_len[old-&gt;count-1]))" data-ref="_M/memmove">memmove</a>(<a class="local col4 ref" href="#344d" title='d' data-ref="344d" data-ref-filename="344d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<var>0</var>], <a class="local col5 ref" href="#345old" title='old' data-ref="345old" data-ref-filename="345old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<var>0</var>],</td></tr>
<tr><th id="832">832</th><td>			(<a class="local col5 ref" href="#345old" title='old' data-ref="345old" data-ref-filename="345old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<a class="local col5 ref" href="#345old" title='old' data-ref="345old" data-ref-filename="345old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>-<var>1</var>] - <a class="local col5 ref" href="#345old" title='old' data-ref="345old" data-ref-filename="345old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<var>0</var>]) +</td></tr>
<tr><th id="833">833</th><td>			<a class="local col5 ref" href="#345old" title='old' data-ref="345old" data-ref-filename="345old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<a class="local col5 ref" href="#345old" title='old' data-ref="345old" data-ref-filename="345old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>-<var>1</var>]);</td></tr>
<tr><th id="834">834</th><td>	}</td></tr>
<tr><th id="835">835</th><td>	<b>if</b>(<a class="local col5 ref" href="#345old" title='old' data-ref="345old" data-ref-filename="345old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a> != <var>0</var>) {</td></tr>
<tr><th id="836">836</th><td>		<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(d-&gt;rr_ttl+d-&gt;count, 0) != (size_t)-1) ? __builtin___memmove_chk(d-&gt;rr_ttl+d-&gt;count, old-&gt;rr_ttl+old-&gt;count, old-&gt;rrsig_count*sizeof(time_t), __builtin_object_size(d-&gt;rr_ttl+d-&gt;count, 0)) : __memmove_ichk(d-&gt;rr_ttl+d-&gt;count, old-&gt;rr_ttl+old-&gt;count, old-&gt;rrsig_count*sizeof(time_t)))" data-ref="_M/memmove">memmove</a>(<a class="local col4 ref" href="#344d" title='d' data-ref="344d" data-ref-filename="344d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_ttl" title='packed_rrset_data::rr_ttl' data-ref="packed_rrset_data::rr_ttl" data-ref-filename="packed_rrset_data..rr_ttl">rr_ttl</a>+<a class="local col4 ref" href="#344d" title='d' data-ref="344d" data-ref-filename="344d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>, <a class="local col5 ref" href="#345old" title='old' data-ref="345old" data-ref-filename="345old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_ttl" title='packed_rrset_data::rr_ttl' data-ref="packed_rrset_data::rr_ttl" data-ref-filename="packed_rrset_data..rr_ttl">rr_ttl</a>+<a class="local col5 ref" href="#345old" title='old' data-ref="345old" data-ref-filename="345old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>,</td></tr>
<tr><th id="837">837</th><td>			<a class="local col5 ref" href="#345old" title='old' data-ref="345old" data-ref-filename="345old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a>*<b>sizeof</b>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#time_t" title='time_t' data-type='__int64_t' data-ref="time_t" data-ref-filename="time_t">time_t</a>));</td></tr>
<tr><th id="838">838</th><td>		<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(d-&gt;rr_data[d-&gt;count], 0) != (size_t)-1) ? __builtin___memmove_chk(d-&gt;rr_data[d-&gt;count], old-&gt;rr_data[old-&gt;count], (old-&gt;rr_data[old_total-1] - old-&gt;rr_data[old-&gt;count]) + old-&gt;rr_len[old_total-1], __builtin_object_size(d-&gt;rr_data[d-&gt;count], 0)) : __memmove_ichk(d-&gt;rr_data[d-&gt;count], old-&gt;rr_data[old-&gt;count], (old-&gt;rr_data[old_total-1] - old-&gt;rr_data[old-&gt;count]) + old-&gt;rr_len[old_total-1]))" data-ref="_M/memmove">memmove</a>(<a class="local col4 ref" href="#344d" title='d' data-ref="344d" data-ref-filename="344d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<a class="local col4 ref" href="#344d" title='d' data-ref="344d" data-ref-filename="344d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>], <a class="local col5 ref" href="#345old" title='old' data-ref="345old" data-ref-filename="345old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<a class="local col5 ref" href="#345old" title='old' data-ref="345old" data-ref-filename="345old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>],</td></tr>
<tr><th id="839">839</th><td>			(<a class="local col5 ref" href="#345old" title='old' data-ref="345old" data-ref-filename="345old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<a class="local col7 ref" href="#347old_total" title='old_total' data-ref="347old_total" data-ref-filename="347old_total">old_total</a>-<var>1</var>] - <a class="local col5 ref" href="#345old" title='old' data-ref="345old" data-ref-filename="345old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<a class="local col5 ref" href="#345old" title='old' data-ref="345old" data-ref-filename="345old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>]) +</td></tr>
<tr><th id="840">840</th><td>			<a class="local col5 ref" href="#345old" title='old' data-ref="345old" data-ref-filename="345old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<a class="local col7 ref" href="#347old_total" title='old_total' data-ref="347old_total" data-ref-filename="347old_total">old_total</a>-<var>1</var>]);</td></tr>
<tr><th id="841">841</th><td>	}</td></tr>
<tr><th id="842">842</th><td></td></tr>
<tr><th id="843">843</th><td>	<i>/* insert new value */</i></td></tr>
<tr><th id="844">844</th><td>	<b>if</b>(!<a class="local col3 ref" href="#343insert_sig" title='insert_sig' data-ref="343insert_sig" data-ref-filename="343insert_sig">insert_sig</a>) {</td></tr>
<tr><th id="845">845</th><td>		<a class="local col4 ref" href="#344d" title='d' data-ref="344d" data-ref-filename="344d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_ttl" title='packed_rrset_data::rr_ttl' data-ref="packed_rrset_data::rr_ttl" data-ref-filename="packed_rrset_data..rr_ttl">rr_ttl</a>[<a class="local col4 ref" href="#344d" title='d' data-ref="344d" data-ref-filename="344d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>-<var>1</var>] = <a class="local col0 ref" href="#340rr_ttl" title='rr_ttl' data-ref="340rr_ttl" data-ref-filename="340rr_ttl">rr_ttl</a>;</td></tr>
<tr><th id="846">846</th><td>		<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(d-&gt;rr_data[d-&gt;count-1], 0) != (size_t)-1) ? __builtin___memmove_chk(d-&gt;rr_data[d-&gt;count-1], rdata, rdatalen, __builtin_object_size(d-&gt;rr_data[d-&gt;count-1], 0)) : __memmove_ichk(d-&gt;rr_data[d-&gt;count-1], rdata, rdatalen))" data-ref="_M/memmove">memmove</a>(<a class="local col4 ref" href="#344d" title='d' data-ref="344d" data-ref-filename="344d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<a class="local col4 ref" href="#344d" title='d' data-ref="344d" data-ref-filename="344d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>-<var>1</var>], <a class="local col1 ref" href="#341rdata" title='rdata' data-ref="341rdata" data-ref-filename="341rdata">rdata</a>, <a class="local col2 ref" href="#342rdatalen" title='rdatalen' data-ref="342rdatalen" data-ref-filename="342rdatalen">rdatalen</a>);</td></tr>
<tr><th id="847">847</th><td>	} <b>else</b> {</td></tr>
<tr><th id="848">848</th><td>		<a class="local col4 ref" href="#344d" title='d' data-ref="344d" data-ref-filename="344d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_ttl" title='packed_rrset_data::rr_ttl' data-ref="packed_rrset_data::rr_ttl" data-ref-filename="packed_rrset_data..rr_ttl">rr_ttl</a>[<a class="local col6 ref" href="#346total" title='total' data-ref="346total" data-ref-filename="346total">total</a>-<var>1</var>] = <a class="local col0 ref" href="#340rr_ttl" title='rr_ttl' data-ref="340rr_ttl" data-ref-filename="340rr_ttl">rr_ttl</a>;</td></tr>
<tr><th id="849">849</th><td>		<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(d-&gt;rr_data[total-1], 0) != (size_t)-1) ? __builtin___memmove_chk(d-&gt;rr_data[total-1], rdata, rdatalen, __builtin_object_size(d-&gt;rr_data[total-1], 0)) : __memmove_ichk(d-&gt;rr_data[total-1], rdata, rdatalen))" data-ref="_M/memmove">memmove</a>(<a class="local col4 ref" href="#344d" title='d' data-ref="344d" data-ref-filename="344d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<a class="local col6 ref" href="#346total" title='total' data-ref="346total" data-ref-filename="346total">total</a>-<var>1</var>], <a class="local col1 ref" href="#341rdata" title='rdata' data-ref="341rdata" data-ref-filename="341rdata">rdata</a>, <a class="local col2 ref" href="#342rdatalen" title='rdatalen' data-ref="342rdatalen" data-ref-filename="342rdatalen">rdatalen</a>);</td></tr>
<tr><th id="850">850</th><td>	}</td></tr>
<tr><th id="851">851</th><td></td></tr>
<tr><th id="852">852</th><td>	<a class="local col9 ref" href="#339rrset" title='rrset' data-ref="339rrset" data-ref-filename="339rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a> = <a class="local col4 ref" href="#344d" title='d' data-ref="344d" data-ref-filename="344d">d</a>;</td></tr>
<tr><th id="853">853</th><td>	<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col5 ref" href="#345old" title='old' data-ref="345old" data-ref-filename="345old">old</a>);</td></tr>
<tr><th id="854">854</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="855">855</th><td>}</td></tr>
<tr><th id="856">856</th><td></td></tr>
<tr><th id="857">857</th><td><i class="doc" data-doc="rrset_create">/** Create new rrset for node with packed rrset with one RR element */</i></td></tr>
<tr><th id="858">858</th><td><em>static</em> <b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>*</td></tr>
<tr><th id="859">859</th><td><dfn class="tu decl def fn" id="rrset_create" title='rrset_create' data-type='struct auth_rrset * rrset_create(struct auth_data * node, uint16_t rr_type, uint32_t rr_ttl, uint8_t * rdata, size_t rdatalen)' data-ref="rrset_create" data-ref-filename="rrset_create">rrset_create</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col8 decl" id="348node" title='node' data-type='struct auth_data *' data-ref="348node" data-ref-filename="348node">node</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col9 decl" id="349rr_type" title='rr_type' data-type='uint16_t' data-ref="349rr_type" data-ref-filename="349rr_type">rr_type</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a> <dfn class="local col0 decl" id="350rr_ttl" title='rr_ttl' data-type='uint32_t' data-ref="350rr_ttl" data-ref-filename="350rr_ttl">rr_ttl</dfn>,</td></tr>
<tr><th id="860">860</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col1 decl" id="351rdata" title='rdata' data-type='uint8_t *' data-ref="351rdata" data-ref-filename="351rdata">rdata</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col2 decl" id="352rdatalen" title='rdatalen' data-type='size_t' data-ref="352rdatalen" data-ref-filename="352rdatalen">rdatalen</dfn>)</td></tr>
<tr><th id="861">861</th><td>{</td></tr>
<tr><th id="862">862</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col3 decl" id="353rrset" title='rrset' data-type='struct auth_rrset *' data-ref="353rrset" data-ref-filename="353rrset">rrset</dfn> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>*)<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#calloc" title='calloc' data-ref="calloc" data-ref-filename="calloc">calloc</a>(<var>1</var>,</td></tr>
<tr><th id="863">863</th><td>		<b>sizeof</b>(*<a class="local col3 ref" href="#353rrset" title='rrset' data-ref="353rrset" data-ref-filename="353rrset">rrset</a>));</td></tr>
<tr><th id="864">864</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col4 decl" id="354p" title='p' data-type='struct auth_rrset *' data-ref="354p" data-ref-filename="354p">p</dfn>, *<dfn class="local col5 decl" id="355prev" title='prev' data-type='struct auth_rrset *' data-ref="355prev" data-ref-filename="355prev">prev</dfn>;</td></tr>
<tr><th id="865">865</th><td>	<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>* <dfn class="local col6 decl" id="356d" title='d' data-type='struct packed_rrset_data *' data-ref="356d" data-ref-filename="356d">d</dfn>;</td></tr>
<tr><th id="866">866</th><td>	<b>if</b>(!<a class="local col3 ref" href="#353rrset" title='rrset' data-ref="353rrset" data-ref-filename="353rrset">rrset</a>) {</td></tr>
<tr><th id="867">867</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"out of memory"</q>);</td></tr>
<tr><th id="868">868</th><td>		<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="869">869</th><td>	}</td></tr>
<tr><th id="870">870</th><td>	<a class="local col3 ref" href="#353rrset" title='rrset' data-ref="353rrset" data-ref-filename="353rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::type" title='auth_rrset::type' data-ref="auth_rrset::type" data-ref-filename="auth_rrset..type">type</a> = <a class="local col9 ref" href="#349rr_type" title='rr_type' data-ref="349rr_type" data-ref-filename="349rr_type">rr_type</a>;</td></tr>
<tr><th id="871">871</th><td></td></tr>
<tr><th id="872">872</th><td>	<i>/* the rrset data structure, with one RR */</i></td></tr>
<tr><th id="873">873</th><td>	<a class="local col6 ref" href="#356d" title='d' data-ref="356d" data-ref-filename="356d">d</a> = (<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>*)<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#calloc" title='calloc' data-ref="calloc" data-ref-filename="calloc">calloc</a>(<var>1</var>,</td></tr>
<tr><th id="874">874</th><td>		<b>sizeof</b>(<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>) + <b>sizeof</b>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>) +</td></tr>
<tr><th id="875">875</th><td>		<b>sizeof</b>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>*) + <b>sizeof</b>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#time_t" title='time_t' data-type='__int64_t' data-ref="time_t" data-ref-filename="time_t">time_t</a>) + <a class="local col2 ref" href="#352rdatalen" title='rdatalen' data-ref="352rdatalen" data-ref-filename="352rdatalen">rdatalen</a>);</td></tr>
<tr><th id="876">876</th><td>	<b>if</b>(!<a class="local col6 ref" href="#356d" title='d' data-ref="356d" data-ref-filename="356d">d</a>) {</td></tr>
<tr><th id="877">877</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col3 ref" href="#353rrset" title='rrset' data-ref="353rrset" data-ref-filename="353rrset">rrset</a>);</td></tr>
<tr><th id="878">878</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"out of memory"</q>);</td></tr>
<tr><th id="879">879</th><td>		<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="880">880</th><td>	}</td></tr>
<tr><th id="881">881</th><td>	<a class="local col3 ref" href="#353rrset" title='rrset' data-ref="353rrset" data-ref-filename="353rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a> = <a class="local col6 ref" href="#356d" title='d' data-ref="356d" data-ref-filename="356d">d</a>;</td></tr>
<tr><th id="882">882</th><td>	<a class="local col6 ref" href="#356d" title='d' data-ref="356d" data-ref-filename="356d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::ttl" title='packed_rrset_data::ttl' data-ref="packed_rrset_data::ttl" data-ref-filename="packed_rrset_data..ttl">ttl</a> = <a class="local col0 ref" href="#350rr_ttl" title='rr_ttl' data-ref="350rr_ttl" data-ref-filename="350rr_ttl">rr_ttl</a>;</td></tr>
<tr><th id="883">883</th><td>	<a class="local col6 ref" href="#356d" title='d' data-ref="356d" data-ref-filename="356d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::trust" title='packed_rrset_data::trust' data-ref="packed_rrset_data::trust" data-ref-filename="packed_rrset_data..trust">trust</a> = <a class="enum" href="../util/data/packed_rrset.h.html#rrset_trust_prim_noglue" title='rrset_trust_prim_noglue' data-ref="rrset_trust_prim_noglue" data-ref-filename="rrset_trust_prim_noglue">rrset_trust_prim_noglue</a>;</td></tr>
<tr><th id="884">884</th><td>	<a class="local col6 ref" href="#356d" title='d' data-ref="356d" data-ref-filename="356d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a> = (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>*)((<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>*)<a class="local col6 ref" href="#356d" title='d' data-ref="356d" data-ref-filename="356d">d</a> + <b>sizeof</b>(<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>));</td></tr>
<tr><th id="885">885</th><td>	<a class="local col6 ref" href="#356d" title='d' data-ref="356d" data-ref-filename="356d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a> = (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>**)&amp;(<a class="local col6 ref" href="#356d" title='d' data-ref="356d" data-ref-filename="356d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<var>1</var>]);</td></tr>
<tr><th id="886">886</th><td>	<a class="local col6 ref" href="#356d" title='d' data-ref="356d" data-ref-filename="356d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_ttl" title='packed_rrset_data::rr_ttl' data-ref="packed_rrset_data::rr_ttl" data-ref-filename="packed_rrset_data..rr_ttl">rr_ttl</a> = (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#time_t" title='time_t' data-type='__int64_t' data-ref="time_t" data-ref-filename="time_t">time_t</a>*)&amp;(<a class="local col6 ref" href="#356d" title='d' data-ref="356d" data-ref-filename="356d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<var>1</var>]);</td></tr>
<tr><th id="887">887</th><td>	<a class="local col6 ref" href="#356d" title='d' data-ref="356d" data-ref-filename="356d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<var>0</var>] = (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>*)&amp;(<a class="local col6 ref" href="#356d" title='d' data-ref="356d" data-ref-filename="356d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_ttl" title='packed_rrset_data::rr_ttl' data-ref="packed_rrset_data::rr_ttl" data-ref-filename="packed_rrset_data..rr_ttl">rr_ttl</a>[<var>1</var>]);</td></tr>
<tr><th id="888">888</th><td></td></tr>
<tr><th id="889">889</th><td>	<i>/* insert the RR */</i></td></tr>
<tr><th id="890">890</th><td>	<a class="local col6 ref" href="#356d" title='d' data-ref="356d" data-ref-filename="356d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<var>0</var>] = <a class="local col2 ref" href="#352rdatalen" title='rdatalen' data-ref="352rdatalen" data-ref-filename="352rdatalen">rdatalen</a>;</td></tr>
<tr><th id="891">891</th><td>	<a class="local col6 ref" href="#356d" title='d' data-ref="356d" data-ref-filename="356d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_ttl" title='packed_rrset_data::rr_ttl' data-ref="packed_rrset_data::rr_ttl" data-ref-filename="packed_rrset_data..rr_ttl">rr_ttl</a>[<var>0</var>] = <a class="local col0 ref" href="#350rr_ttl" title='rr_ttl' data-ref="350rr_ttl" data-ref-filename="350rr_ttl">rr_ttl</a>;</td></tr>
<tr><th id="892">892</th><td>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(d-&gt;rr_data[0], 0) != (size_t)-1) ? __builtin___memmove_chk(d-&gt;rr_data[0], rdata, rdatalen, __builtin_object_size(d-&gt;rr_data[0], 0)) : __memmove_ichk(d-&gt;rr_data[0], rdata, rdatalen))" data-ref="_M/memmove">memmove</a>(<a class="local col6 ref" href="#356d" title='d' data-ref="356d" data-ref-filename="356d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<var>0</var>], <a class="local col1 ref" href="#351rdata" title='rdata' data-ref="351rdata" data-ref-filename="351rdata">rdata</a>, <a class="local col2 ref" href="#352rdatalen" title='rdatalen' data-ref="352rdatalen" data-ref-filename="352rdatalen">rdatalen</a>);</td></tr>
<tr><th id="893">893</th><td>	<a class="local col6 ref" href="#356d" title='d' data-ref="356d" data-ref-filename="356d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>++;</td></tr>
<tr><th id="894">894</th><td></td></tr>
<tr><th id="895">895</th><td>	<i>/* insert rrset into linked list for domain */</i></td></tr>
<tr><th id="896">896</th><td>	<i>/* find sorted place to link the rrset into the list */</i></td></tr>
<tr><th id="897">897</th><td>	<a class="local col5 ref" href="#355prev" title='prev' data-ref="355prev" data-ref-filename="355prev">prev</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="898">898</th><td>	<a class="local col4 ref" href="#354p" title='p' data-ref="354p" data-ref-filename="354p">p</a> = <a class="local col8 ref" href="#348node" title='node' data-ref="348node" data-ref-filename="348node">node</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::rrsets" title='auth_data::rrsets' data-ref="auth_data::rrsets" data-ref-filename="auth_data..rrsets">rrsets</a>;</td></tr>
<tr><th id="899">899</th><td>	<b>while</b>(<a class="local col4 ref" href="#354p" title='p' data-ref="354p" data-ref-filename="354p">p</a> &amp;&amp; <a class="local col4 ref" href="#354p" title='p' data-ref="354p" data-ref-filename="354p">p</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::type" title='auth_rrset::type' data-ref="auth_rrset::type" data-ref-filename="auth_rrset..type">type</a>&lt;=<a class="local col9 ref" href="#349rr_type" title='rr_type' data-ref="349rr_type" data-ref-filename="349rr_type">rr_type</a>) {</td></tr>
<tr><th id="900">900</th><td>		<a class="local col5 ref" href="#355prev" title='prev' data-ref="355prev" data-ref-filename="355prev">prev</a> = <a class="local col4 ref" href="#354p" title='p' data-ref="354p" data-ref-filename="354p">p</a>;</td></tr>
<tr><th id="901">901</th><td>		<a class="local col4 ref" href="#354p" title='p' data-ref="354p" data-ref-filename="354p">p</a> = <a class="local col4 ref" href="#354p" title='p' data-ref="354p" data-ref-filename="354p">p</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::next" title='auth_rrset::next' data-ref="auth_rrset::next" data-ref-filename="auth_rrset..next">next</a>;</td></tr>
<tr><th id="902">902</th><td>	}</td></tr>
<tr><th id="903">903</th><td>	<i>/* so, prev is smaller, and p is larger than rr_type */</i></td></tr>
<tr><th id="904">904</th><td>	<a class="local col3 ref" href="#353rrset" title='rrset' data-ref="353rrset" data-ref-filename="353rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::next" title='auth_rrset::next' data-ref="auth_rrset::next" data-ref-filename="auth_rrset..next">next</a> = <a class="local col4 ref" href="#354p" title='p' data-ref="354p" data-ref-filename="354p">p</a>;</td></tr>
<tr><th id="905">905</th><td>	<b>if</b>(<a class="local col5 ref" href="#355prev" title='prev' data-ref="355prev" data-ref-filename="355prev">prev</a>) <a class="local col5 ref" href="#355prev" title='prev' data-ref="355prev" data-ref-filename="355prev">prev</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::next" title='auth_rrset::next' data-ref="auth_rrset::next" data-ref-filename="auth_rrset..next">next</a> = <a class="local col3 ref" href="#353rrset" title='rrset' data-ref="353rrset" data-ref-filename="353rrset">rrset</a>;</td></tr>
<tr><th id="906">906</th><td>	<b>else</b> <a class="local col8 ref" href="#348node" title='node' data-ref="348node" data-ref-filename="348node">node</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::rrsets" title='auth_data::rrsets' data-ref="auth_data::rrsets" data-ref-filename="auth_data..rrsets">rrsets</a> = <a class="local col3 ref" href="#353rrset" title='rrset' data-ref="353rrset" data-ref-filename="353rrset">rrset</a>;</td></tr>
<tr><th id="907">907</th><td>	<b>return</b> <a class="local col3 ref" href="#353rrset" title='rrset' data-ref="353rrset" data-ref-filename="353rrset">rrset</a>;</td></tr>
<tr><th id="908">908</th><td>}</td></tr>
<tr><th id="909">909</th><td></td></tr>
<tr><th id="910">910</th><td><i class="doc" data-doc="rrsig_num_that_cover">/** count number (and size) of rrsigs that cover a type */</i></td></tr>
<tr><th id="911">911</th><td><em>static</em> <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a></td></tr>
<tr><th id="912">912</th><td><dfn class="tu decl def fn" id="rrsig_num_that_cover" title='rrsig_num_that_cover' data-type='size_t rrsig_num_that_cover(struct auth_rrset * rrsig, uint16_t rr_type, size_t * sigsz)' data-ref="rrsig_num_that_cover" data-ref-filename="rrsig_num_that_cover">rrsig_num_that_cover</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col7 decl" id="357rrsig" title='rrsig' data-type='struct auth_rrset *' data-ref="357rrsig" data-ref-filename="357rrsig">rrsig</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col8 decl" id="358rr_type" title='rr_type' data-type='uint16_t' data-ref="358rr_type" data-ref-filename="358rr_type">rr_type</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>* <dfn class="local col9 decl" id="359sigsz" title='sigsz' data-type='size_t *' data-ref="359sigsz" data-ref-filename="359sigsz">sigsz</dfn>)</td></tr>
<tr><th id="913">913</th><td>{</td></tr>
<tr><th id="914">914</th><td>	<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>* <dfn class="local col0 decl" id="360d" title='d' data-type='struct packed_rrset_data *' data-ref="360d" data-ref-filename="360d">d</dfn> = <a class="local col7 ref" href="#357rrsig" title='rrsig' data-ref="357rrsig" data-ref-filename="357rrsig">rrsig</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>;</td></tr>
<tr><th id="915">915</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col1 decl" id="361i" title='i' data-type='size_t' data-ref="361i" data-ref-filename="361i">i</dfn>, <dfn class="local col2 decl" id="362num" title='num' data-type='size_t' data-ref="362num" data-ref-filename="362num">num</dfn> = <var>0</var>;</td></tr>
<tr><th id="916">916</th><td>	*<a class="local col9 ref" href="#359sigsz" title='sigsz' data-ref="359sigsz" data-ref-filename="359sigsz">sigsz</a> = <var>0</var>;</td></tr>
<tr><th id="917">917</th><td>	<a class="macro" href="../util/log.h.html#211" title="" data-ref="_M/log_assert">log_assert</a>(d &amp;&amp; rrsig-&gt;type == LDNS_RR_TYPE_RRSIG);</td></tr>
<tr><th id="918">918</th><td>	<b>for</b>(<a class="local col1 ref" href="#361i" title='i' data-ref="361i" data-ref-filename="361i">i</a>=<var>0</var>; <a class="local col1 ref" href="#361i" title='i' data-ref="361i" data-ref-filename="361i">i</a>&lt;<a class="local col0 ref" href="#360d" title='d' data-ref="360d" data-ref-filename="360d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>+<a class="local col0 ref" href="#360d" title='d' data-ref="360d" data-ref-filename="360d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a>; <a class="local col1 ref" href="#361i" title='i' data-ref="361i" data-ref-filename="361i">i</a>++) {</td></tr>
<tr><th id="919">919</th><td>		<b>if</b>(<a class="tu ref fn" href="#rrsig_rdata_get_type_covered" title='rrsig_rdata_get_type_covered' data-use='c' data-ref="rrsig_rdata_get_type_covered" data-ref-filename="rrsig_rdata_get_type_covered">rrsig_rdata_get_type_covered</a>(<a class="local col0 ref" href="#360d" title='d' data-ref="360d" data-ref-filename="360d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<a class="local col1 ref" href="#361i" title='i' data-ref="361i" data-ref-filename="361i">i</a>],</td></tr>
<tr><th id="920">920</th><td>			<a class="local col0 ref" href="#360d" title='d' data-ref="360d" data-ref-filename="360d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<a class="local col1 ref" href="#361i" title='i' data-ref="361i" data-ref-filename="361i">i</a>]) == <a class="local col8 ref" href="#358rr_type" title='rr_type' data-ref="358rr_type" data-ref-filename="358rr_type">rr_type</a>) {</td></tr>
<tr><th id="921">921</th><td>			<a class="local col2 ref" href="#362num" title='num' data-ref="362num" data-ref-filename="362num">num</a>++;</td></tr>
<tr><th id="922">922</th><td>			(*<a class="local col9 ref" href="#359sigsz" title='sigsz' data-ref="359sigsz" data-ref-filename="359sigsz">sigsz</a>) += <a class="local col0 ref" href="#360d" title='d' data-ref="360d" data-ref-filename="360d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<a class="local col1 ref" href="#361i" title='i' data-ref="361i" data-ref-filename="361i">i</a>];</td></tr>
<tr><th id="923">923</th><td>		}</td></tr>
<tr><th id="924">924</th><td>	}</td></tr>
<tr><th id="925">925</th><td>	<b>return</b> <a class="local col2 ref" href="#362num" title='num' data-ref="362num" data-ref-filename="362num">num</a>;</td></tr>
<tr><th id="926">926</th><td>}</td></tr>
<tr><th id="927">927</th><td></td></tr>
<tr><th id="928">928</th><td><i class="doc" data-doc="rrset_moveover_rrsigs">/** See if rrsig set has covered sigs for rrset and move them over */</i></td></tr>
<tr><th id="929">929</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="930">930</th><td><dfn class="tu decl def fn" id="rrset_moveover_rrsigs" title='rrset_moveover_rrsigs' data-type='int rrset_moveover_rrsigs(struct auth_data * node, uint16_t rr_type, struct auth_rrset * rrset, struct auth_rrset * rrsig)' data-ref="rrset_moveover_rrsigs" data-ref-filename="rrset_moveover_rrsigs">rrset_moveover_rrsigs</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col3 decl" id="363node" title='node' data-type='struct auth_data *' data-ref="363node" data-ref-filename="363node">node</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col4 decl" id="364rr_type" title='rr_type' data-type='uint16_t' data-ref="364rr_type" data-ref-filename="364rr_type">rr_type</dfn>,</td></tr>
<tr><th id="931">931</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col5 decl" id="365rrset" title='rrset' data-type='struct auth_rrset *' data-ref="365rrset" data-ref-filename="365rrset">rrset</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col6 decl" id="366rrsig" title='rrsig' data-type='struct auth_rrset *' data-ref="366rrsig" data-ref-filename="366rrsig">rrsig</dfn>)</td></tr>
<tr><th id="932">932</th><td>{</td></tr>
<tr><th id="933">933</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col7 decl" id="367sigs" title='sigs' data-type='size_t' data-ref="367sigs" data-ref-filename="367sigs">sigs</dfn>, <dfn class="local col8 decl" id="368sigsz" title='sigsz' data-type='size_t' data-ref="368sigsz" data-ref-filename="368sigsz">sigsz</dfn>, <dfn class="local col9 decl" id="369i" title='i' data-type='size_t' data-ref="369i" data-ref-filename="369i">i</dfn>, <dfn class="local col0 decl" id="370j" title='j' data-type='size_t' data-ref="370j" data-ref-filename="370j">j</dfn>, <dfn class="local col1 decl" id="371total" title='total' data-type='size_t' data-ref="371total" data-ref-filename="371total">total</dfn>;</td></tr>
<tr><th id="934">934</th><td>	<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>* <dfn class="local col2 decl" id="372sigold" title='sigold' data-type='struct packed_rrset_data *' data-ref="372sigold" data-ref-filename="372sigold">sigold</dfn> = <a class="local col6 ref" href="#366rrsig" title='rrsig' data-ref="366rrsig" data-ref-filename="366rrsig">rrsig</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>;</td></tr>
<tr><th id="935">935</th><td>	<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>* <dfn class="local col3 decl" id="373old" title='old' data-type='struct packed_rrset_data *' data-ref="373old" data-ref-filename="373old">old</dfn> = <a class="local col5 ref" href="#365rrset" title='rrset' data-ref="365rrset" data-ref-filename="365rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>;</td></tr>
<tr><th id="936">936</th><td>	<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>* <dfn class="local col4 decl" id="374d" title='d' data-type='struct packed_rrset_data *' data-ref="374d" data-ref-filename="374d">d</dfn>, *<dfn class="local col5 decl" id="375sigd" title='sigd' data-type='struct packed_rrset_data *' data-ref="375sigd" data-ref-filename="375sigd">sigd</dfn>;</td></tr>
<tr><th id="937">937</th><td></td></tr>
<tr><th id="938">938</th><td>	<a class="macro" href="../util/log.h.html#211" title="" data-ref="_M/log_assert">log_assert</a>(rrset-&gt;type == rr_type);</td></tr>
<tr><th id="939">939</th><td>	<a class="macro" href="../util/log.h.html#211" title="" data-ref="_M/log_assert">log_assert</a>(rrsig-&gt;type == LDNS_RR_TYPE_RRSIG);</td></tr>
<tr><th id="940">940</th><td>	<a class="local col7 ref" href="#367sigs" title='sigs' data-ref="367sigs" data-ref-filename="367sigs">sigs</a> = <a class="tu ref fn" href="#rrsig_num_that_cover" title='rrsig_num_that_cover' data-use='c' data-ref="rrsig_num_that_cover" data-ref-filename="rrsig_num_that_cover">rrsig_num_that_cover</a>(<a class="local col6 ref" href="#366rrsig" title='rrsig' data-ref="366rrsig" data-ref-filename="366rrsig">rrsig</a>, <a class="local col4 ref" href="#364rr_type" title='rr_type' data-ref="364rr_type" data-ref-filename="364rr_type">rr_type</a>, &amp;<a class="local col8 ref" href="#368sigsz" title='sigsz' data-ref="368sigsz" data-ref-filename="368sigsz">sigsz</a>);</td></tr>
<tr><th id="941">941</th><td>	<b>if</b>(<a class="local col7 ref" href="#367sigs" title='sigs' data-ref="367sigs" data-ref-filename="367sigs">sigs</a> == <var>0</var>) {</td></tr>
<tr><th id="942">942</th><td>		<i>/* 0 rrsigs to move over, done */</i></td></tr>
<tr><th id="943">943</th><td>		<b>return</b> <var>1</var>;</td></tr>
<tr><th id="944">944</th><td>	}</td></tr>
<tr><th id="945">945</th><td></td></tr>
<tr><th id="946">946</th><td>	<i>/* allocate rrset sigsz larger for extra sigs elements, and</i></td></tr>
<tr><th id="947">947</th><td><i>	 * allocate rrsig sigsz smaller for less sigs elements. */</i></td></tr>
<tr><th id="948">948</th><td>	<a class="local col4 ref" href="#374d" title='d' data-ref="374d" data-ref-filename="374d">d</a> = (<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>*)<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#calloc" title='calloc' data-ref="calloc" data-ref-filename="calloc">calloc</a>(<var>1</var>, <a class="ref fn" href="../util/data/packed_rrset.h.html#packed_rrset_sizeof" title='packed_rrset_sizeof' data-ref="packed_rrset_sizeof" data-ref-filename="packed_rrset_sizeof">packed_rrset_sizeof</a>(<a class="local col3 ref" href="#373old" title='old' data-ref="373old" data-ref-filename="373old">old</a>)</td></tr>
<tr><th id="949">949</th><td>		+ <a class="local col7 ref" href="#367sigs" title='sigs' data-ref="367sigs" data-ref-filename="367sigs">sigs</a>*(<b>sizeof</b>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>) + <b>sizeof</b>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>*) + <b>sizeof</b>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#time_t" title='time_t' data-type='__int64_t' data-ref="time_t" data-ref-filename="time_t">time_t</a>))</td></tr>
<tr><th id="950">950</th><td>		+ <a class="local col8 ref" href="#368sigsz" title='sigsz' data-ref="368sigsz" data-ref-filename="368sigsz">sigsz</a>);</td></tr>
<tr><th id="951">951</th><td>	<b>if</b>(!<a class="local col4 ref" href="#374d" title='d' data-ref="374d" data-ref-filename="374d">d</a>) {</td></tr>
<tr><th id="952">952</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"out of memory"</q>);</td></tr>
<tr><th id="953">953</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="954">954</th><td>	}</td></tr>
<tr><th id="955">955</th><td>	<i>/* copy base values */</i></td></tr>
<tr><th id="956">956</th><td>	<a class="local col1 ref" href="#371total" title='total' data-ref="371total" data-ref-filename="371total">total</a> = <a class="local col3 ref" href="#373old" title='old' data-ref="373old" data-ref-filename="373old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a> + <a class="local col3 ref" href="#373old" title='old' data-ref="373old" data-ref-filename="373old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a>;</td></tr>
<tr><th id="957">957</th><td>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#95" title="((__builtin_object_size(d, 0) != (size_t)-1) ? __builtin___memcpy_chk(d, old, sizeof(struct packed_rrset_data), __builtin_object_size(d, 0)) : __memcpy_ichk(d, old, sizeof(struct packed_rrset_data)))" data-ref="_M/memcpy">memcpy</a>(<a class="local col4 ref" href="#374d" title='d' data-ref="374d" data-ref-filename="374d">d</a>, <a class="local col3 ref" href="#373old" title='old' data-ref="373old" data-ref-filename="373old">old</a>, <b>sizeof</b>(<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>));</td></tr>
<tr><th id="958">958</th><td>	<a class="local col4 ref" href="#374d" title='d' data-ref="374d" data-ref-filename="374d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a> += <a class="local col7 ref" href="#367sigs" title='sigs' data-ref="367sigs" data-ref-filename="367sigs">sigs</a>;</td></tr>
<tr><th id="959">959</th><td>	<i>/* setup rr_len */</i></td></tr>
<tr><th id="960">960</th><td>	<a class="local col4 ref" href="#374d" title='d' data-ref="374d" data-ref-filename="374d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a> = (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>*)((<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>*)<a class="local col4 ref" href="#374d" title='d' data-ref="374d" data-ref-filename="374d">d</a> +</td></tr>
<tr><th id="961">961</th><td>		<b>sizeof</b>(<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>));</td></tr>
<tr><th id="962">962</th><td>	<b>if</b>(<a class="local col1 ref" href="#371total" title='total' data-ref="371total" data-ref-filename="371total">total</a> != <var>0</var>)</td></tr>
<tr><th id="963">963</th><td>		<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(d-&gt;rr_len, 0) != (size_t)-1) ? __builtin___memmove_chk(d-&gt;rr_len, old-&gt;rr_len, total*sizeof(size_t), __builtin_object_size(d-&gt;rr_len, 0)) : __memmove_ichk(d-&gt;rr_len, old-&gt;rr_len, total*sizeof(size_t)))" data-ref="_M/memmove">memmove</a>(<a class="local col4 ref" href="#374d" title='d' data-ref="374d" data-ref-filename="374d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>, <a class="local col3 ref" href="#373old" title='old' data-ref="373old" data-ref-filename="373old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>, <a class="local col1 ref" href="#371total" title='total' data-ref="371total" data-ref-filename="371total">total</a>*<b>sizeof</b>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>));</td></tr>
<tr><th id="964">964</th><td>	<a class="local col0 ref" href="#370j" title='j' data-ref="370j" data-ref-filename="370j">j</a> = <a class="local col4 ref" href="#374d" title='d' data-ref="374d" data-ref-filename="374d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>+<a class="local col4 ref" href="#374d" title='d' data-ref="374d" data-ref-filename="374d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a>-<a class="local col7 ref" href="#367sigs" title='sigs' data-ref="367sigs" data-ref-filename="367sigs">sigs</a>;</td></tr>
<tr><th id="965">965</th><td>	<b>for</b>(<a class="local col9 ref" href="#369i" title='i' data-ref="369i" data-ref-filename="369i">i</a>=<var>0</var>; <a class="local col9 ref" href="#369i" title='i' data-ref="369i" data-ref-filename="369i">i</a>&lt;<a class="local col2 ref" href="#372sigold" title='sigold' data-ref="372sigold" data-ref-filename="372sigold">sigold</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>+<a class="local col2 ref" href="#372sigold" title='sigold' data-ref="372sigold" data-ref-filename="372sigold">sigold</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a>; <a class="local col9 ref" href="#369i" title='i' data-ref="369i" data-ref-filename="369i">i</a>++) {</td></tr>
<tr><th id="966">966</th><td>		<b>if</b>(<a class="tu ref fn" href="#rrsig_rdata_get_type_covered" title='rrsig_rdata_get_type_covered' data-use='c' data-ref="rrsig_rdata_get_type_covered" data-ref-filename="rrsig_rdata_get_type_covered">rrsig_rdata_get_type_covered</a>(<a class="local col2 ref" href="#372sigold" title='sigold' data-ref="372sigold" data-ref-filename="372sigold">sigold</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<a class="local col9 ref" href="#369i" title='i' data-ref="369i" data-ref-filename="369i">i</a>],</td></tr>
<tr><th id="967">967</th><td>			<a class="local col2 ref" href="#372sigold" title='sigold' data-ref="372sigold" data-ref-filename="372sigold">sigold</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<a class="local col9 ref" href="#369i" title='i' data-ref="369i" data-ref-filename="369i">i</a>]) == <a class="local col4 ref" href="#364rr_type" title='rr_type' data-ref="364rr_type" data-ref-filename="364rr_type">rr_type</a>) {</td></tr>
<tr><th id="968">968</th><td>			<a class="local col4 ref" href="#374d" title='d' data-ref="374d" data-ref-filename="374d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<a class="local col0 ref" href="#370j" title='j' data-ref="370j" data-ref-filename="370j">j</a>] = <a class="local col2 ref" href="#372sigold" title='sigold' data-ref="372sigold" data-ref-filename="372sigold">sigold</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<a class="local col9 ref" href="#369i" title='i' data-ref="369i" data-ref-filename="369i">i</a>];</td></tr>
<tr><th id="969">969</th><td>			<a class="local col0 ref" href="#370j" title='j' data-ref="370j" data-ref-filename="370j">j</a>++;</td></tr>
<tr><th id="970">970</th><td>		}</td></tr>
<tr><th id="971">971</th><td>	}</td></tr>
<tr><th id="972">972</th><td>	<a class="ref fn" href="../util/data/packed_rrset.h.html#packed_rrset_ptr_fixup" title='packed_rrset_ptr_fixup' data-ref="packed_rrset_ptr_fixup" data-ref-filename="packed_rrset_ptr_fixup">packed_rrset_ptr_fixup</a>(<a class="local col4 ref" href="#374d" title='d' data-ref="374d" data-ref-filename="374d">d</a>);</td></tr>
<tr><th id="973">973</th><td></td></tr>
<tr><th id="974">974</th><td>	<i>/* copy old values into new array */</i></td></tr>
<tr><th id="975">975</th><td>	<b>if</b>(<a class="local col1 ref" href="#371total" title='total' data-ref="371total" data-ref-filename="371total">total</a> != <var>0</var>) {</td></tr>
<tr><th id="976">976</th><td>		<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(d-&gt;rr_ttl, 0) != (size_t)-1) ? __builtin___memmove_chk(d-&gt;rr_ttl, old-&gt;rr_ttl, total*sizeof(time_t), __builtin_object_size(d-&gt;rr_ttl, 0)) : __memmove_ichk(d-&gt;rr_ttl, old-&gt;rr_ttl, total*sizeof(time_t)))" data-ref="_M/memmove">memmove</a>(<a class="local col4 ref" href="#374d" title='d' data-ref="374d" data-ref-filename="374d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_ttl" title='packed_rrset_data::rr_ttl' data-ref="packed_rrset_data::rr_ttl" data-ref-filename="packed_rrset_data..rr_ttl">rr_ttl</a>, <a class="local col3 ref" href="#373old" title='old' data-ref="373old" data-ref-filename="373old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_ttl" title='packed_rrset_data::rr_ttl' data-ref="packed_rrset_data::rr_ttl" data-ref-filename="packed_rrset_data..rr_ttl">rr_ttl</a>, <a class="local col1 ref" href="#371total" title='total' data-ref="371total" data-ref-filename="371total">total</a>*<b>sizeof</b>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#time_t" title='time_t' data-type='__int64_t' data-ref="time_t" data-ref-filename="time_t">time_t</a>));</td></tr>
<tr><th id="977">977</th><td>		<i>/* all the old rr pieces are allocated sequential, so we</i></td></tr>
<tr><th id="978">978</th><td><i>		 * can copy them in one go */</i></td></tr>
<tr><th id="979">979</th><td>		<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(d-&gt;rr_data[0], 0) != (size_t)-1) ? __builtin___memmove_chk(d-&gt;rr_data[0], old-&gt;rr_data[0], (old-&gt;rr_data[total-1] - old-&gt;rr_data[0]) + old-&gt;rr_len[total-1], __builtin_object_size(d-&gt;rr_data[0], 0)) : __memmove_ichk(d-&gt;rr_data[0], old-&gt;rr_data[0], (old-&gt;rr_data[total-1] - old-&gt;rr_data[0]) + old-&gt;rr_len[total-1]))" data-ref="_M/memmove">memmove</a>(<a class="local col4 ref" href="#374d" title='d' data-ref="374d" data-ref-filename="374d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<var>0</var>], <a class="local col3 ref" href="#373old" title='old' data-ref="373old" data-ref-filename="373old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<var>0</var>],</td></tr>
<tr><th id="980">980</th><td>			(<a class="local col3 ref" href="#373old" title='old' data-ref="373old" data-ref-filename="373old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<a class="local col1 ref" href="#371total" title='total' data-ref="371total" data-ref-filename="371total">total</a>-<var>1</var>] - <a class="local col3 ref" href="#373old" title='old' data-ref="373old" data-ref-filename="373old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<var>0</var>]) +</td></tr>
<tr><th id="981">981</th><td>			<a class="local col3 ref" href="#373old" title='old' data-ref="373old" data-ref-filename="373old">old</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<a class="local col1 ref" href="#371total" title='total' data-ref="371total" data-ref-filename="371total">total</a>-<var>1</var>]);</td></tr>
<tr><th id="982">982</th><td>	}</td></tr>
<tr><th id="983">983</th><td></td></tr>
<tr><th id="984">984</th><td>	<i>/* move over the rrsigs to the larger rrset*/</i></td></tr>
<tr><th id="985">985</th><td>	<a class="local col0 ref" href="#370j" title='j' data-ref="370j" data-ref-filename="370j">j</a> = <a class="local col4 ref" href="#374d" title='d' data-ref="374d" data-ref-filename="374d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>+<a class="local col4 ref" href="#374d" title='d' data-ref="374d" data-ref-filename="374d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a>-<a class="local col7 ref" href="#367sigs" title='sigs' data-ref="367sigs" data-ref-filename="367sigs">sigs</a>;</td></tr>
<tr><th id="986">986</th><td>	<b>for</b>(<a class="local col9 ref" href="#369i" title='i' data-ref="369i" data-ref-filename="369i">i</a>=<var>0</var>; <a class="local col9 ref" href="#369i" title='i' data-ref="369i" data-ref-filename="369i">i</a>&lt;<a class="local col2 ref" href="#372sigold" title='sigold' data-ref="372sigold" data-ref-filename="372sigold">sigold</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>+<a class="local col2 ref" href="#372sigold" title='sigold' data-ref="372sigold" data-ref-filename="372sigold">sigold</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a>; <a class="local col9 ref" href="#369i" title='i' data-ref="369i" data-ref-filename="369i">i</a>++) {</td></tr>
<tr><th id="987">987</th><td>		<b>if</b>(<a class="tu ref fn" href="#rrsig_rdata_get_type_covered" title='rrsig_rdata_get_type_covered' data-use='c' data-ref="rrsig_rdata_get_type_covered" data-ref-filename="rrsig_rdata_get_type_covered">rrsig_rdata_get_type_covered</a>(<a class="local col2 ref" href="#372sigold" title='sigold' data-ref="372sigold" data-ref-filename="372sigold">sigold</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<a class="local col9 ref" href="#369i" title='i' data-ref="369i" data-ref-filename="369i">i</a>],</td></tr>
<tr><th id="988">988</th><td>			<a class="local col2 ref" href="#372sigold" title='sigold' data-ref="372sigold" data-ref-filename="372sigold">sigold</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<a class="local col9 ref" href="#369i" title='i' data-ref="369i" data-ref-filename="369i">i</a>]) == <a class="local col4 ref" href="#364rr_type" title='rr_type' data-ref="364rr_type" data-ref-filename="364rr_type">rr_type</a>) {</td></tr>
<tr><th id="989">989</th><td>			<i>/* move this one over to location j */</i></td></tr>
<tr><th id="990">990</th><td>			<a class="local col4 ref" href="#374d" title='d' data-ref="374d" data-ref-filename="374d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_ttl" title='packed_rrset_data::rr_ttl' data-ref="packed_rrset_data::rr_ttl" data-ref-filename="packed_rrset_data..rr_ttl">rr_ttl</a>[<a class="local col0 ref" href="#370j" title='j' data-ref="370j" data-ref-filename="370j">j</a>] = <a class="local col2 ref" href="#372sigold" title='sigold' data-ref="372sigold" data-ref-filename="372sigold">sigold</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_ttl" title='packed_rrset_data::rr_ttl' data-ref="packed_rrset_data::rr_ttl" data-ref-filename="packed_rrset_data..rr_ttl">rr_ttl</a>[<a class="local col9 ref" href="#369i" title='i' data-ref="369i" data-ref-filename="369i">i</a>];</td></tr>
<tr><th id="991">991</th><td>			<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(d-&gt;rr_data[j], 0) != (size_t)-1) ? __builtin___memmove_chk(d-&gt;rr_data[j], sigold-&gt;rr_data[i], sigold-&gt;rr_len[i], __builtin_object_size(d-&gt;rr_data[j], 0)) : __memmove_ichk(d-&gt;rr_data[j], sigold-&gt;rr_data[i], sigold-&gt;rr_len[i]))" data-ref="_M/memmove">memmove</a>(<a class="local col4 ref" href="#374d" title='d' data-ref="374d" data-ref-filename="374d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<a class="local col0 ref" href="#370j" title='j' data-ref="370j" data-ref-filename="370j">j</a>], <a class="local col2 ref" href="#372sigold" title='sigold' data-ref="372sigold" data-ref-filename="372sigold">sigold</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<a class="local col9 ref" href="#369i" title='i' data-ref="369i" data-ref-filename="369i">i</a>],</td></tr>
<tr><th id="992">992</th><td>				<a class="local col2 ref" href="#372sigold" title='sigold' data-ref="372sigold" data-ref-filename="372sigold">sigold</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<a class="local col9 ref" href="#369i" title='i' data-ref="369i" data-ref-filename="369i">i</a>]);</td></tr>
<tr><th id="993">993</th><td>			<b>if</b>(<a class="local col4 ref" href="#374d" title='d' data-ref="374d" data-ref-filename="374d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_ttl" title='packed_rrset_data::rr_ttl' data-ref="packed_rrset_data::rr_ttl" data-ref-filename="packed_rrset_data..rr_ttl">rr_ttl</a>[<a class="local col0 ref" href="#370j" title='j' data-ref="370j" data-ref-filename="370j">j</a>] &lt; <a class="local col4 ref" href="#374d" title='d' data-ref="374d" data-ref-filename="374d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::ttl" title='packed_rrset_data::ttl' data-ref="packed_rrset_data::ttl" data-ref-filename="packed_rrset_data..ttl">ttl</a>)</td></tr>
<tr><th id="994">994</th><td>				<a class="local col4 ref" href="#374d" title='d' data-ref="374d" data-ref-filename="374d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::ttl" title='packed_rrset_data::ttl' data-ref="packed_rrset_data::ttl" data-ref-filename="packed_rrset_data..ttl">ttl</a> = <a class="local col4 ref" href="#374d" title='d' data-ref="374d" data-ref-filename="374d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_ttl" title='packed_rrset_data::rr_ttl' data-ref="packed_rrset_data::rr_ttl" data-ref-filename="packed_rrset_data..rr_ttl">rr_ttl</a>[<a class="local col0 ref" href="#370j" title='j' data-ref="370j" data-ref-filename="370j">j</a>];</td></tr>
<tr><th id="995">995</th><td>			<a class="local col0 ref" href="#370j" title='j' data-ref="370j" data-ref-filename="370j">j</a>++;</td></tr>
<tr><th id="996">996</th><td>		}</td></tr>
<tr><th id="997">997</th><td>	}</td></tr>
<tr><th id="998">998</th><td></td></tr>
<tr><th id="999">999</th><td>	<i>/* put it in and deallocate the old rrset */</i></td></tr>
<tr><th id="1000">1000</th><td>	<a class="local col5 ref" href="#365rrset" title='rrset' data-ref="365rrset" data-ref-filename="365rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a> = <a class="local col4 ref" href="#374d" title='d' data-ref="374d" data-ref-filename="374d">d</a>;</td></tr>
<tr><th id="1001">1001</th><td>	<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col3 ref" href="#373old" title='old' data-ref="373old" data-ref-filename="373old">old</a>);</td></tr>
<tr><th id="1002">1002</th><td></td></tr>
<tr><th id="1003">1003</th><td>	<i>/* now make rrsig set smaller */</i></td></tr>
<tr><th id="1004">1004</th><td>	<b>if</b>(<a class="local col2 ref" href="#372sigold" title='sigold' data-ref="372sigold" data-ref-filename="372sigold">sigold</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>+<a class="local col2 ref" href="#372sigold" title='sigold' data-ref="372sigold" data-ref-filename="372sigold">sigold</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a> == <a class="local col7 ref" href="#367sigs" title='sigs' data-ref="367sigs" data-ref-filename="367sigs">sigs</a>) {</td></tr>
<tr><th id="1005">1005</th><td>		<i>/* remove all sigs from rrsig, remove it entirely */</i></td></tr>
<tr><th id="1006">1006</th><td>		<a class="tu ref fn" href="#domain_remove_rrset" title='domain_remove_rrset' data-use='c' data-ref="domain_remove_rrset" data-ref-filename="domain_remove_rrset">domain_remove_rrset</a>(<a class="local col3 ref" href="#363node" title='node' data-ref="363node" data-ref-filename="363node">node</a>, <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_RRSIG" title='LDNS_RR_TYPE_RRSIG' data-ref="LDNS_RR_TYPE_RRSIG" data-ref-filename="LDNS_RR_TYPE_RRSIG">LDNS_RR_TYPE_RRSIG</a>);</td></tr>
<tr><th id="1007">1007</th><td>		<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1008">1008</th><td>	}</td></tr>
<tr><th id="1009">1009</th><td>	<a class="macro" href="../util/log.h.html#211" title="" data-ref="_M/log_assert">log_assert</a>(packed_rrset_sizeof(sigold) &gt; sigs*(<b>sizeof</b>(size_t) +</td></tr>
<tr><th id="1010">1010</th><td>		<b>sizeof</b>(uint8_t*) + <b>sizeof</b>(time_t)) + sigsz);</td></tr>
<tr><th id="1011">1011</th><td>	<a class="local col5 ref" href="#375sigd" title='sigd' data-ref="375sigd" data-ref-filename="375sigd">sigd</a> = (<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>*)<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#calloc" title='calloc' data-ref="calloc" data-ref-filename="calloc">calloc</a>(<var>1</var>, <a class="ref fn" href="../util/data/packed_rrset.h.html#packed_rrset_sizeof" title='packed_rrset_sizeof' data-ref="packed_rrset_sizeof" data-ref-filename="packed_rrset_sizeof">packed_rrset_sizeof</a>(<a class="local col2 ref" href="#372sigold" title='sigold' data-ref="372sigold" data-ref-filename="372sigold">sigold</a>)</td></tr>
<tr><th id="1012">1012</th><td>		- <a class="local col7 ref" href="#367sigs" title='sigs' data-ref="367sigs" data-ref-filename="367sigs">sigs</a>*(<b>sizeof</b>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>) + <b>sizeof</b>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>*) + <b>sizeof</b>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#time_t" title='time_t' data-type='__int64_t' data-ref="time_t" data-ref-filename="time_t">time_t</a>))</td></tr>
<tr><th id="1013">1013</th><td>		- <a class="local col8 ref" href="#368sigsz" title='sigsz' data-ref="368sigsz" data-ref-filename="368sigsz">sigsz</a>);</td></tr>
<tr><th id="1014">1014</th><td>	<b>if</b>(!<a class="local col5 ref" href="#375sigd" title='sigd' data-ref="375sigd" data-ref-filename="375sigd">sigd</a>) {</td></tr>
<tr><th id="1015">1015</th><td>		<i>/* no need to free up d, it has already been placed in the</i></td></tr>
<tr><th id="1016">1016</th><td><i>		 * node-&gt;rrset structure */</i></td></tr>
<tr><th id="1017">1017</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"out of memory"</q>);</td></tr>
<tr><th id="1018">1018</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1019">1019</th><td>	}</td></tr>
<tr><th id="1020">1020</th><td>	<i>/* copy base values */</i></td></tr>
<tr><th id="1021">1021</th><td>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#95" title="((__builtin_object_size(sigd, 0) != (size_t)-1) ? __builtin___memcpy_chk(sigd, sigold, sizeof(struct packed_rrset_data), __builtin_object_size(sigd, 0)) : __memcpy_ichk(sigd, sigold, sizeof(struct packed_rrset_data)))" data-ref="_M/memcpy">memcpy</a>(<a class="local col5 ref" href="#375sigd" title='sigd' data-ref="375sigd" data-ref-filename="375sigd">sigd</a>, <a class="local col2 ref" href="#372sigold" title='sigold' data-ref="372sigold" data-ref-filename="372sigold">sigold</a>, <b>sizeof</b>(<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>));</td></tr>
<tr><th id="1022">1022</th><td>	<i>/* in sigd the RRSIGs are stored in the base of the RR, in count */</i></td></tr>
<tr><th id="1023">1023</th><td>	<a class="local col5 ref" href="#375sigd" title='sigd' data-ref="375sigd" data-ref-filename="375sigd">sigd</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a> -= <a class="local col7 ref" href="#367sigs" title='sigs' data-ref="367sigs" data-ref-filename="367sigs">sigs</a>;</td></tr>
<tr><th id="1024">1024</th><td>	<i>/* setup rr_len */</i></td></tr>
<tr><th id="1025">1025</th><td>	<a class="local col5 ref" href="#375sigd" title='sigd' data-ref="375sigd" data-ref-filename="375sigd">sigd</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a> = (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>*)((<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>*)<a class="local col5 ref" href="#375sigd" title='sigd' data-ref="375sigd" data-ref-filename="375sigd">sigd</a> +</td></tr>
<tr><th id="1026">1026</th><td>		<b>sizeof</b>(<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>));</td></tr>
<tr><th id="1027">1027</th><td>	<a class="local col0 ref" href="#370j" title='j' data-ref="370j" data-ref-filename="370j">j</a> = <var>0</var>;</td></tr>
<tr><th id="1028">1028</th><td>	<b>for</b>(<a class="local col9 ref" href="#369i" title='i' data-ref="369i" data-ref-filename="369i">i</a>=<var>0</var>; <a class="local col9 ref" href="#369i" title='i' data-ref="369i" data-ref-filename="369i">i</a>&lt;<a class="local col2 ref" href="#372sigold" title='sigold' data-ref="372sigold" data-ref-filename="372sigold">sigold</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>+<a class="local col2 ref" href="#372sigold" title='sigold' data-ref="372sigold" data-ref-filename="372sigold">sigold</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a>; <a class="local col9 ref" href="#369i" title='i' data-ref="369i" data-ref-filename="369i">i</a>++) {</td></tr>
<tr><th id="1029">1029</th><td>		<b>if</b>(<a class="tu ref fn" href="#rrsig_rdata_get_type_covered" title='rrsig_rdata_get_type_covered' data-use='c' data-ref="rrsig_rdata_get_type_covered" data-ref-filename="rrsig_rdata_get_type_covered">rrsig_rdata_get_type_covered</a>(<a class="local col2 ref" href="#372sigold" title='sigold' data-ref="372sigold" data-ref-filename="372sigold">sigold</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<a class="local col9 ref" href="#369i" title='i' data-ref="369i" data-ref-filename="369i">i</a>],</td></tr>
<tr><th id="1030">1030</th><td>			<a class="local col2 ref" href="#372sigold" title='sigold' data-ref="372sigold" data-ref-filename="372sigold">sigold</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<a class="local col9 ref" href="#369i" title='i' data-ref="369i" data-ref-filename="369i">i</a>]) != <a class="local col4 ref" href="#364rr_type" title='rr_type' data-ref="364rr_type" data-ref-filename="364rr_type">rr_type</a>) {</td></tr>
<tr><th id="1031">1031</th><td>			<a class="local col5 ref" href="#375sigd" title='sigd' data-ref="375sigd" data-ref-filename="375sigd">sigd</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<a class="local col0 ref" href="#370j" title='j' data-ref="370j" data-ref-filename="370j">j</a>] = <a class="local col2 ref" href="#372sigold" title='sigold' data-ref="372sigold" data-ref-filename="372sigold">sigold</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<a class="local col9 ref" href="#369i" title='i' data-ref="369i" data-ref-filename="369i">i</a>];</td></tr>
<tr><th id="1032">1032</th><td>			<a class="local col0 ref" href="#370j" title='j' data-ref="370j" data-ref-filename="370j">j</a>++;</td></tr>
<tr><th id="1033">1033</th><td>		}</td></tr>
<tr><th id="1034">1034</th><td>	}</td></tr>
<tr><th id="1035">1035</th><td>	<a class="ref fn" href="../util/data/packed_rrset.h.html#packed_rrset_ptr_fixup" title='packed_rrset_ptr_fixup' data-ref="packed_rrset_ptr_fixup" data-ref-filename="packed_rrset_ptr_fixup">packed_rrset_ptr_fixup</a>(<a class="local col5 ref" href="#375sigd" title='sigd' data-ref="375sigd" data-ref-filename="375sigd">sigd</a>);</td></tr>
<tr><th id="1036">1036</th><td></td></tr>
<tr><th id="1037">1037</th><td>	<i>/* copy old values into new rrsig array */</i></td></tr>
<tr><th id="1038">1038</th><td>	<a class="local col0 ref" href="#370j" title='j' data-ref="370j" data-ref-filename="370j">j</a> = <var>0</var>;</td></tr>
<tr><th id="1039">1039</th><td>	<b>for</b>(<a class="local col9 ref" href="#369i" title='i' data-ref="369i" data-ref-filename="369i">i</a>=<var>0</var>; <a class="local col9 ref" href="#369i" title='i' data-ref="369i" data-ref-filename="369i">i</a>&lt;<a class="local col2 ref" href="#372sigold" title='sigold' data-ref="372sigold" data-ref-filename="372sigold">sigold</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>+<a class="local col2 ref" href="#372sigold" title='sigold' data-ref="372sigold" data-ref-filename="372sigold">sigold</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a>; <a class="local col9 ref" href="#369i" title='i' data-ref="369i" data-ref-filename="369i">i</a>++) {</td></tr>
<tr><th id="1040">1040</th><td>		<b>if</b>(<a class="tu ref fn" href="#rrsig_rdata_get_type_covered" title='rrsig_rdata_get_type_covered' data-use='c' data-ref="rrsig_rdata_get_type_covered" data-ref-filename="rrsig_rdata_get_type_covered">rrsig_rdata_get_type_covered</a>(<a class="local col2 ref" href="#372sigold" title='sigold' data-ref="372sigold" data-ref-filename="372sigold">sigold</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<a class="local col9 ref" href="#369i" title='i' data-ref="369i" data-ref-filename="369i">i</a>],</td></tr>
<tr><th id="1041">1041</th><td>			<a class="local col2 ref" href="#372sigold" title='sigold' data-ref="372sigold" data-ref-filename="372sigold">sigold</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<a class="local col9 ref" href="#369i" title='i' data-ref="369i" data-ref-filename="369i">i</a>]) != <a class="local col4 ref" href="#364rr_type" title='rr_type' data-ref="364rr_type" data-ref-filename="364rr_type">rr_type</a>) {</td></tr>
<tr><th id="1042">1042</th><td>			<i>/* move this one over to location j */</i></td></tr>
<tr><th id="1043">1043</th><td>			<a class="local col5 ref" href="#375sigd" title='sigd' data-ref="375sigd" data-ref-filename="375sigd">sigd</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_ttl" title='packed_rrset_data::rr_ttl' data-ref="packed_rrset_data::rr_ttl" data-ref-filename="packed_rrset_data..rr_ttl">rr_ttl</a>[<a class="local col0 ref" href="#370j" title='j' data-ref="370j" data-ref-filename="370j">j</a>] = <a class="local col2 ref" href="#372sigold" title='sigold' data-ref="372sigold" data-ref-filename="372sigold">sigold</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_ttl" title='packed_rrset_data::rr_ttl' data-ref="packed_rrset_data::rr_ttl" data-ref-filename="packed_rrset_data..rr_ttl">rr_ttl</a>[<a class="local col9 ref" href="#369i" title='i' data-ref="369i" data-ref-filename="369i">i</a>];</td></tr>
<tr><th id="1044">1044</th><td>			<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(sigd-&gt;rr_data[j], 0) != (size_t)-1) ? __builtin___memmove_chk(sigd-&gt;rr_data[j], sigold-&gt;rr_data[i], sigold-&gt;rr_len[i], __builtin_object_size(sigd-&gt;rr_data[j], 0)) : __memmove_ichk(sigd-&gt;rr_data[j], sigold-&gt;rr_data[i], sigold-&gt;rr_len[i]))" data-ref="_M/memmove">memmove</a>(<a class="local col5 ref" href="#375sigd" title='sigd' data-ref="375sigd" data-ref-filename="375sigd">sigd</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<a class="local col0 ref" href="#370j" title='j' data-ref="370j" data-ref-filename="370j">j</a>], <a class="local col2 ref" href="#372sigold" title='sigold' data-ref="372sigold" data-ref-filename="372sigold">sigold</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<a class="local col9 ref" href="#369i" title='i' data-ref="369i" data-ref-filename="369i">i</a>],</td></tr>
<tr><th id="1045">1045</th><td>				<a class="local col2 ref" href="#372sigold" title='sigold' data-ref="372sigold" data-ref-filename="372sigold">sigold</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<a class="local col9 ref" href="#369i" title='i' data-ref="369i" data-ref-filename="369i">i</a>]);</td></tr>
<tr><th id="1046">1046</th><td>			<b>if</b>(<a class="local col0 ref" href="#370j" title='j' data-ref="370j" data-ref-filename="370j">j</a>==<var>0</var>) <a class="local col5 ref" href="#375sigd" title='sigd' data-ref="375sigd" data-ref-filename="375sigd">sigd</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::ttl" title='packed_rrset_data::ttl' data-ref="packed_rrset_data::ttl" data-ref-filename="packed_rrset_data..ttl">ttl</a> = <a class="local col5 ref" href="#375sigd" title='sigd' data-ref="375sigd" data-ref-filename="375sigd">sigd</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_ttl" title='packed_rrset_data::rr_ttl' data-ref="packed_rrset_data::rr_ttl" data-ref-filename="packed_rrset_data..rr_ttl">rr_ttl</a>[<a class="local col0 ref" href="#370j" title='j' data-ref="370j" data-ref-filename="370j">j</a>];</td></tr>
<tr><th id="1047">1047</th><td>			<b>else</b> {</td></tr>
<tr><th id="1048">1048</th><td>				<b>if</b>(<a class="local col5 ref" href="#375sigd" title='sigd' data-ref="375sigd" data-ref-filename="375sigd">sigd</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_ttl" title='packed_rrset_data::rr_ttl' data-ref="packed_rrset_data::rr_ttl" data-ref-filename="packed_rrset_data..rr_ttl">rr_ttl</a>[<a class="local col0 ref" href="#370j" title='j' data-ref="370j" data-ref-filename="370j">j</a>] &lt; <a class="local col5 ref" href="#375sigd" title='sigd' data-ref="375sigd" data-ref-filename="375sigd">sigd</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::ttl" title='packed_rrset_data::ttl' data-ref="packed_rrset_data::ttl" data-ref-filename="packed_rrset_data..ttl">ttl</a>)</td></tr>
<tr><th id="1049">1049</th><td>					<a class="local col5 ref" href="#375sigd" title='sigd' data-ref="375sigd" data-ref-filename="375sigd">sigd</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::ttl" title='packed_rrset_data::ttl' data-ref="packed_rrset_data::ttl" data-ref-filename="packed_rrset_data..ttl">ttl</a> = <a class="local col5 ref" href="#375sigd" title='sigd' data-ref="375sigd" data-ref-filename="375sigd">sigd</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_ttl" title='packed_rrset_data::rr_ttl' data-ref="packed_rrset_data::rr_ttl" data-ref-filename="packed_rrset_data..rr_ttl">rr_ttl</a>[<a class="local col0 ref" href="#370j" title='j' data-ref="370j" data-ref-filename="370j">j</a>];</td></tr>
<tr><th id="1050">1050</th><td>			}</td></tr>
<tr><th id="1051">1051</th><td>			<a class="local col0 ref" href="#370j" title='j' data-ref="370j" data-ref-filename="370j">j</a>++;</td></tr>
<tr><th id="1052">1052</th><td>		}</td></tr>
<tr><th id="1053">1053</th><td>	}</td></tr>
<tr><th id="1054">1054</th><td></td></tr>
<tr><th id="1055">1055</th><td>	<i>/* put it in and deallocate the old rrset */</i></td></tr>
<tr><th id="1056">1056</th><td>	<a class="local col6 ref" href="#366rrsig" title='rrsig' data-ref="366rrsig" data-ref-filename="366rrsig">rrsig</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a> = <a class="local col5 ref" href="#375sigd" title='sigd' data-ref="375sigd" data-ref-filename="375sigd">sigd</a>;</td></tr>
<tr><th id="1057">1057</th><td>	<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col2 ref" href="#372sigold" title='sigold' data-ref="372sigold" data-ref-filename="372sigold">sigold</a>);</td></tr>
<tr><th id="1058">1058</th><td></td></tr>
<tr><th id="1059">1059</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1060">1060</th><td>}</td></tr>
<tr><th id="1061">1061</th><td></td></tr>
<tr><th id="1062">1062</th><td><i class="doc" data-doc="rrsigs_copy_from_rrset_to_rrsigset">/** copy the rrsigs from the rrset to the rrsig rrset, because the rrset</i></td></tr>
<tr><th id="1063">1063</th><td><i class="doc" data-doc="rrsigs_copy_from_rrset_to_rrsigset"> * is going to be deleted.  reallocates the RRSIG rrset data. */</i></td></tr>
<tr><th id="1064">1064</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="1065">1065</th><td><dfn class="tu decl def fn" id="rrsigs_copy_from_rrset_to_rrsigset" title='rrsigs_copy_from_rrset_to_rrsigset' data-type='int rrsigs_copy_from_rrset_to_rrsigset(struct auth_rrset * rrset, struct auth_rrset * rrsigset)' data-ref="rrsigs_copy_from_rrset_to_rrsigset" data-ref-filename="rrsigs_copy_from_rrset_to_rrsigset">rrsigs_copy_from_rrset_to_rrsigset</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col6 decl" id="376rrset" title='rrset' data-type='struct auth_rrset *' data-ref="376rrset" data-ref-filename="376rrset">rrset</dfn>,</td></tr>
<tr><th id="1066">1066</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col7 decl" id="377rrsigset" title='rrsigset' data-type='struct auth_rrset *' data-ref="377rrsigset" data-ref-filename="377rrsigset">rrsigset</dfn>)</td></tr>
<tr><th id="1067">1067</th><td>{</td></tr>
<tr><th id="1068">1068</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col8 decl" id="378i" title='i' data-type='size_t' data-ref="378i" data-ref-filename="378i">i</dfn>;</td></tr>
<tr><th id="1069">1069</th><td>	<b>if</b>(<a class="local col6 ref" href="#376rrset" title='rrset' data-ref="376rrset" data-ref-filename="376rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a> == <var>0</var>)</td></tr>
<tr><th id="1070">1070</th><td>		<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1071">1071</th><td></td></tr>
<tr><th id="1072">1072</th><td>	<i>/* move them over one by one, because there might be duplicates,</i></td></tr>
<tr><th id="1073">1073</th><td><i>	 * duplicates are ignored */</i></td></tr>
<tr><th id="1074">1074</th><td>	<b>for</b>(<a class="local col8 ref" href="#378i" title='i' data-ref="378i" data-ref-filename="378i">i</a>=<a class="local col6 ref" href="#376rrset" title='rrset' data-ref="376rrset" data-ref-filename="376rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>;</td></tr>
<tr><th id="1075">1075</th><td>		<a class="local col8 ref" href="#378i" title='i' data-ref="378i" data-ref-filename="378i">i</a>&lt;<a class="local col6 ref" href="#376rrset" title='rrset' data-ref="376rrset" data-ref-filename="376rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>+<a class="local col6 ref" href="#376rrset" title='rrset' data-ref="376rrset" data-ref-filename="376rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a>; <a class="local col8 ref" href="#378i" title='i' data-ref="378i" data-ref-filename="378i">i</a>++) {</td></tr>
<tr><th id="1076">1076</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col9 decl" id="379rdata" title='rdata' data-type='uint8_t *' data-ref="379rdata" data-ref-filename="379rdata">rdata</dfn> = <a class="local col6 ref" href="#376rrset" title='rrset' data-ref="376rrset" data-ref-filename="376rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<a class="local col8 ref" href="#378i" title='i' data-ref="378i" data-ref-filename="378i">i</a>];</td></tr>
<tr><th id="1077">1077</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col0 decl" id="380rdatalen" title='rdatalen' data-type='size_t' data-ref="380rdatalen" data-ref-filename="380rdatalen">rdatalen</dfn> = <a class="local col6 ref" href="#376rrset" title='rrset' data-ref="376rrset" data-ref-filename="376rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<a class="local col8 ref" href="#378i" title='i' data-ref="378i" data-ref-filename="378i">i</a>];</td></tr>
<tr><th id="1078">1078</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#time_t" title='time_t' data-type='__int64_t' data-ref="time_t" data-ref-filename="time_t">time_t</a> <dfn class="local col1 decl" id="381rr_ttl" title='rr_ttl' data-type='time_t' data-ref="381rr_ttl" data-ref-filename="381rr_ttl">rr_ttl</dfn>  = <a class="local col6 ref" href="#376rrset" title='rrset' data-ref="376rrset" data-ref-filename="376rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_ttl" title='packed_rrset_data::rr_ttl' data-ref="packed_rrset_data::rr_ttl" data-ref-filename="packed_rrset_data..rr_ttl">rr_ttl</a>[<a class="local col8 ref" href="#378i" title='i' data-ref="378i" data-ref-filename="378i">i</a>];</td></tr>
<tr><th id="1079">1079</th><td></td></tr>
<tr><th id="1080">1080</th><td>		<b>if</b>(<a class="tu ref fn" href="#rdata_duplicate" title='rdata_duplicate' data-use='c' data-ref="rdata_duplicate" data-ref-filename="rdata_duplicate">rdata_duplicate</a>(<a class="local col7 ref" href="#377rrsigset" title='rrsigset' data-ref="377rrsigset" data-ref-filename="377rrsigset">rrsigset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>, <a class="local col9 ref" href="#379rdata" title='rdata' data-ref="379rdata" data-ref-filename="379rdata">rdata</a>, <a class="local col0 ref" href="#380rdatalen" title='rdatalen' data-ref="380rdatalen" data-ref-filename="380rdatalen">rdatalen</a>)) {</td></tr>
<tr><th id="1081">1081</th><td>			<b>continue</b>;</td></tr>
<tr><th id="1082">1082</th><td>		}</td></tr>
<tr><th id="1083">1083</th><td>		<b>if</b>(!<a class="tu ref fn" href="#rrset_add_rr" title='rrset_add_rr' data-use='c' data-ref="rrset_add_rr" data-ref-filename="rrset_add_rr">rrset_add_rr</a>(<a class="local col7 ref" href="#377rrsigset" title='rrsigset' data-ref="377rrsigset" data-ref-filename="377rrsigset">rrsigset</a>, <a class="local col1 ref" href="#381rr_ttl" title='rr_ttl' data-ref="381rr_ttl" data-ref-filename="381rr_ttl">rr_ttl</a>, <a class="local col9 ref" href="#379rdata" title='rdata' data-ref="379rdata" data-ref-filename="379rdata">rdata</a>, <a class="local col0 ref" href="#380rdatalen" title='rdatalen' data-ref="380rdatalen" data-ref-filename="380rdatalen">rdatalen</a>, <var>0</var>))</td></tr>
<tr><th id="1084">1084</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1085">1085</th><td>	}</td></tr>
<tr><th id="1086">1086</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1087">1087</th><td>}</td></tr>
<tr><th id="1088">1088</th><td></td></tr>
<tr><th id="1089">1089</th><td><i class="doc" data-doc="az_domain_add_rr">/** Add rr to node, ignores duplicate RRs,</i></td></tr>
<tr><th id="1090">1090</th><td><i class="doc" data-doc="az_domain_add_rr"> * rdata points to buffer with rdatalen octets, starts with 2bytelength. */</i></td></tr>
<tr><th id="1091">1091</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="1092">1092</th><td><dfn class="tu decl def fn" id="az_domain_add_rr" title='az_domain_add_rr' data-type='int az_domain_add_rr(struct auth_data * node, uint16_t rr_type, uint32_t rr_ttl, uint8_t * rdata, size_t rdatalen, int * duplicate)' data-ref="az_domain_add_rr" data-ref-filename="az_domain_add_rr">az_domain_add_rr</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col2 decl" id="382node" title='node' data-type='struct auth_data *' data-ref="382node" data-ref-filename="382node">node</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col3 decl" id="383rr_type" title='rr_type' data-type='uint16_t' data-ref="383rr_type" data-ref-filename="383rr_type">rr_type</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a> <dfn class="local col4 decl" id="384rr_ttl" title='rr_ttl' data-type='uint32_t' data-ref="384rr_ttl" data-ref-filename="384rr_ttl">rr_ttl</dfn>,</td></tr>
<tr><th id="1093">1093</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col5 decl" id="385rdata" title='rdata' data-type='uint8_t *' data-ref="385rdata" data-ref-filename="385rdata">rdata</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col6 decl" id="386rdatalen" title='rdatalen' data-type='size_t' data-ref="386rdatalen" data-ref-filename="386rdatalen">rdatalen</dfn>, <em>int</em>* <dfn class="local col7 decl" id="387duplicate" title='duplicate' data-type='int *' data-ref="387duplicate" data-ref-filename="387duplicate">duplicate</dfn>)</td></tr>
<tr><th id="1094">1094</th><td>{</td></tr>
<tr><th id="1095">1095</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col8 decl" id="388rrset" title='rrset' data-type='struct auth_rrset *' data-ref="388rrset" data-ref-filename="388rrset">rrset</dfn>;</td></tr>
<tr><th id="1096">1096</th><td>	<i>/* packed rrsets have their rrsigs along with them, sort them out */</i></td></tr>
<tr><th id="1097">1097</th><td>	<b>if</b>(<a class="local col3 ref" href="#383rr_type" title='rr_type' data-ref="383rr_type" data-ref-filename="383rr_type">rr_type</a> == <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_RRSIG" title='LDNS_RR_TYPE_RRSIG' data-ref="LDNS_RR_TYPE_RRSIG" data-ref-filename="LDNS_RR_TYPE_RRSIG">LDNS_RR_TYPE_RRSIG</a>) {</td></tr>
<tr><th id="1098">1098</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col9 decl" id="389ctype" title='ctype' data-type='uint16_t' data-ref="389ctype" data-ref-filename="389ctype">ctype</dfn> = <a class="tu ref fn" href="#rrsig_rdata_get_type_covered" title='rrsig_rdata_get_type_covered' data-use='c' data-ref="rrsig_rdata_get_type_covered" data-ref-filename="rrsig_rdata_get_type_covered">rrsig_rdata_get_type_covered</a>(<a class="local col5 ref" href="#385rdata" title='rdata' data-ref="385rdata" data-ref-filename="385rdata">rdata</a>, <a class="local col6 ref" href="#386rdatalen" title='rdatalen' data-ref="386rdatalen" data-ref-filename="386rdatalen">rdatalen</a>);</td></tr>
<tr><th id="1099">1099</th><td>		<b>if</b>((<a class="local col8 ref" href="#388rrset" title='rrset' data-ref="388rrset" data-ref-filename="388rrset">rrset</a>=<a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(<a class="local col2 ref" href="#382node" title='node' data-ref="382node" data-ref-filename="382node">node</a>, <a class="local col9 ref" href="#389ctype" title='ctype' data-ref="389ctype" data-ref-filename="389ctype">ctype</a>))!= <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="1100">1100</th><td>			<i>/* a node of the correct type exists, add the RRSIG</i></td></tr>
<tr><th id="1101">1101</th><td><i>			 * to the rrset of the covered data type */</i></td></tr>
<tr><th id="1102">1102</th><td>			<b>if</b>(<a class="tu ref fn" href="#rdata_duplicate" title='rdata_duplicate' data-use='c' data-ref="rdata_duplicate" data-ref-filename="rdata_duplicate">rdata_duplicate</a>(<a class="local col8 ref" href="#388rrset" title='rrset' data-ref="388rrset" data-ref-filename="388rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>, <a class="local col5 ref" href="#385rdata" title='rdata' data-ref="385rdata" data-ref-filename="385rdata">rdata</a>, <a class="local col6 ref" href="#386rdatalen" title='rdatalen' data-ref="386rdatalen" data-ref-filename="386rdatalen">rdatalen</a>)) {</td></tr>
<tr><th id="1103">1103</th><td>				<b>if</b>(<a class="local col7 ref" href="#387duplicate" title='duplicate' data-ref="387duplicate" data-ref-filename="387duplicate">duplicate</a>) *<a class="local col7 ref" href="#387duplicate" title='duplicate' data-ref="387duplicate" data-ref-filename="387duplicate">duplicate</a> = <var>1</var>;</td></tr>
<tr><th id="1104">1104</th><td>				<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1105">1105</th><td>			}</td></tr>
<tr><th id="1106">1106</th><td>			<b>if</b>(!<a class="tu ref fn" href="#rrset_add_rr" title='rrset_add_rr' data-use='c' data-ref="rrset_add_rr" data-ref-filename="rrset_add_rr">rrset_add_rr</a>(<a class="local col8 ref" href="#388rrset" title='rrset' data-ref="388rrset" data-ref-filename="388rrset">rrset</a>, <a class="local col4 ref" href="#384rr_ttl" title='rr_ttl' data-ref="384rr_ttl" data-ref-filename="384rr_ttl">rr_ttl</a>, <a class="local col5 ref" href="#385rdata" title='rdata' data-ref="385rdata" data-ref-filename="385rdata">rdata</a>, <a class="local col6 ref" href="#386rdatalen" title='rdatalen' data-ref="386rdatalen" data-ref-filename="386rdatalen">rdatalen</a>, <var>1</var>))</td></tr>
<tr><th id="1107">1107</th><td>				<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1108">1108</th><td>		} <b>else</b> <b>if</b>((<a class="local col8 ref" href="#388rrset" title='rrset' data-ref="388rrset" data-ref-filename="388rrset">rrset</a>=<a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(<a class="local col2 ref" href="#382node" title='node' data-ref="382node" data-ref-filename="382node">node</a>, <a class="local col3 ref" href="#383rr_type" title='rr_type' data-ref="383rr_type" data-ref-filename="383rr_type">rr_type</a>))!= <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="1109">1109</th><td>			<i>/* add RRSIG to rrset of type RRSIG */</i></td></tr>
<tr><th id="1110">1110</th><td>			<b>if</b>(<a class="tu ref fn" href="#rdata_duplicate" title='rdata_duplicate' data-use='c' data-ref="rdata_duplicate" data-ref-filename="rdata_duplicate">rdata_duplicate</a>(<a class="local col8 ref" href="#388rrset" title='rrset' data-ref="388rrset" data-ref-filename="388rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>, <a class="local col5 ref" href="#385rdata" title='rdata' data-ref="385rdata" data-ref-filename="385rdata">rdata</a>, <a class="local col6 ref" href="#386rdatalen" title='rdatalen' data-ref="386rdatalen" data-ref-filename="386rdatalen">rdatalen</a>)) {</td></tr>
<tr><th id="1111">1111</th><td>				<b>if</b>(<a class="local col7 ref" href="#387duplicate" title='duplicate' data-ref="387duplicate" data-ref-filename="387duplicate">duplicate</a>) *<a class="local col7 ref" href="#387duplicate" title='duplicate' data-ref="387duplicate" data-ref-filename="387duplicate">duplicate</a> = <var>1</var>;</td></tr>
<tr><th id="1112">1112</th><td>				<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1113">1113</th><td>			}</td></tr>
<tr><th id="1114">1114</th><td>			<b>if</b>(!<a class="tu ref fn" href="#rrset_add_rr" title='rrset_add_rr' data-use='c' data-ref="rrset_add_rr" data-ref-filename="rrset_add_rr">rrset_add_rr</a>(<a class="local col8 ref" href="#388rrset" title='rrset' data-ref="388rrset" data-ref-filename="388rrset">rrset</a>, <a class="local col4 ref" href="#384rr_ttl" title='rr_ttl' data-ref="384rr_ttl" data-ref-filename="384rr_ttl">rr_ttl</a>, <a class="local col5 ref" href="#385rdata" title='rdata' data-ref="385rdata" data-ref-filename="385rdata">rdata</a>, <a class="local col6 ref" href="#386rdatalen" title='rdatalen' data-ref="386rdatalen" data-ref-filename="386rdatalen">rdatalen</a>, <var>0</var>))</td></tr>
<tr><th id="1115">1115</th><td>				<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1116">1116</th><td>		} <b>else</b> {</td></tr>
<tr><th id="1117">1117</th><td>			<i>/* create rrset of type RRSIG */</i></td></tr>
<tr><th id="1118">1118</th><td>			<b>if</b>(!<a class="tu ref fn" href="#rrset_create" title='rrset_create' data-use='c' data-ref="rrset_create" data-ref-filename="rrset_create">rrset_create</a>(<a class="local col2 ref" href="#382node" title='node' data-ref="382node" data-ref-filename="382node">node</a>, <a class="local col3 ref" href="#383rr_type" title='rr_type' data-ref="383rr_type" data-ref-filename="383rr_type">rr_type</a>, <a class="local col4 ref" href="#384rr_ttl" title='rr_ttl' data-ref="384rr_ttl" data-ref-filename="384rr_ttl">rr_ttl</a>, <a class="local col5 ref" href="#385rdata" title='rdata' data-ref="385rdata" data-ref-filename="385rdata">rdata</a>,</td></tr>
<tr><th id="1119">1119</th><td>				<a class="local col6 ref" href="#386rdatalen" title='rdatalen' data-ref="386rdatalen" data-ref-filename="386rdatalen">rdatalen</a>))</td></tr>
<tr><th id="1120">1120</th><td>				<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1121">1121</th><td>		}</td></tr>
<tr><th id="1122">1122</th><td>	} <b>else</b> {</td></tr>
<tr><th id="1123">1123</th><td>		<i>/* normal RR type */</i></td></tr>
<tr><th id="1124">1124</th><td>		<b>if</b>((<a class="local col8 ref" href="#388rrset" title='rrset' data-ref="388rrset" data-ref-filename="388rrset">rrset</a>=<a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(<a class="local col2 ref" href="#382node" title='node' data-ref="382node" data-ref-filename="382node">node</a>, <a class="local col3 ref" href="#383rr_type" title='rr_type' data-ref="383rr_type" data-ref-filename="383rr_type">rr_type</a>))!= <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="1125">1125</th><td>			<i>/* add data to existing node with data type */</i></td></tr>
<tr><th id="1126">1126</th><td>			<b>if</b>(<a class="tu ref fn" href="#rdata_duplicate" title='rdata_duplicate' data-use='c' data-ref="rdata_duplicate" data-ref-filename="rdata_duplicate">rdata_duplicate</a>(<a class="local col8 ref" href="#388rrset" title='rrset' data-ref="388rrset" data-ref-filename="388rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>, <a class="local col5 ref" href="#385rdata" title='rdata' data-ref="385rdata" data-ref-filename="385rdata">rdata</a>, <a class="local col6 ref" href="#386rdatalen" title='rdatalen' data-ref="386rdatalen" data-ref-filename="386rdatalen">rdatalen</a>)) {</td></tr>
<tr><th id="1127">1127</th><td>				<b>if</b>(<a class="local col7 ref" href="#387duplicate" title='duplicate' data-ref="387duplicate" data-ref-filename="387duplicate">duplicate</a>) *<a class="local col7 ref" href="#387duplicate" title='duplicate' data-ref="387duplicate" data-ref-filename="387duplicate">duplicate</a> = <var>1</var>;</td></tr>
<tr><th id="1128">1128</th><td>				<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1129">1129</th><td>			}</td></tr>
<tr><th id="1130">1130</th><td>			<b>if</b>(!<a class="tu ref fn" href="#rrset_add_rr" title='rrset_add_rr' data-use='c' data-ref="rrset_add_rr" data-ref-filename="rrset_add_rr">rrset_add_rr</a>(<a class="local col8 ref" href="#388rrset" title='rrset' data-ref="388rrset" data-ref-filename="388rrset">rrset</a>, <a class="local col4 ref" href="#384rr_ttl" title='rr_ttl' data-ref="384rr_ttl" data-ref-filename="384rr_ttl">rr_ttl</a>, <a class="local col5 ref" href="#385rdata" title='rdata' data-ref="385rdata" data-ref-filename="385rdata">rdata</a>, <a class="local col6 ref" href="#386rdatalen" title='rdatalen' data-ref="386rdatalen" data-ref-filename="386rdatalen">rdatalen</a>, <var>0</var>))</td></tr>
<tr><th id="1131">1131</th><td>				<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1132">1132</th><td>		} <b>else</b> {</td></tr>
<tr><th id="1133">1133</th><td>			<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col0 decl" id="390rrsig" title='rrsig' data-type='struct auth_rrset *' data-ref="390rrsig" data-ref-filename="390rrsig">rrsig</dfn>;</td></tr>
<tr><th id="1134">1134</th><td>			<i>/* create new node with data type */</i></td></tr>
<tr><th id="1135">1135</th><td>			<b>if</b>(!(<a class="local col8 ref" href="#388rrset" title='rrset' data-ref="388rrset" data-ref-filename="388rrset">rrset</a>=<a class="tu ref fn" href="#rrset_create" title='rrset_create' data-use='c' data-ref="rrset_create" data-ref-filename="rrset_create">rrset_create</a>(<a class="local col2 ref" href="#382node" title='node' data-ref="382node" data-ref-filename="382node">node</a>, <a class="local col3 ref" href="#383rr_type" title='rr_type' data-ref="383rr_type" data-ref-filename="383rr_type">rr_type</a>, <a class="local col4 ref" href="#384rr_ttl" title='rr_ttl' data-ref="384rr_ttl" data-ref-filename="384rr_ttl">rr_ttl</a>, <a class="local col5 ref" href="#385rdata" title='rdata' data-ref="385rdata" data-ref-filename="385rdata">rdata</a>,</td></tr>
<tr><th id="1136">1136</th><td>				<a class="local col6 ref" href="#386rdatalen" title='rdatalen' data-ref="386rdatalen" data-ref-filename="386rdatalen">rdatalen</a>)))</td></tr>
<tr><th id="1137">1137</th><td>				<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1138">1138</th><td></td></tr>
<tr><th id="1139">1139</th><td>			<i>/* see if node of type RRSIG has signatures that</i></td></tr>
<tr><th id="1140">1140</th><td><i>			 * cover the data type, and move them over */</i></td></tr>
<tr><th id="1141">1141</th><td>			<i>/* and then make the RRSIG type smaller */</i></td></tr>
<tr><th id="1142">1142</th><td>			<b>if</b>((<a class="local col0 ref" href="#390rrsig" title='rrsig' data-ref="390rrsig" data-ref-filename="390rrsig">rrsig</a>=<a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(<a class="local col2 ref" href="#382node" title='node' data-ref="382node" data-ref-filename="382node">node</a>, <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_RRSIG" title='LDNS_RR_TYPE_RRSIG' data-ref="LDNS_RR_TYPE_RRSIG" data-ref-filename="LDNS_RR_TYPE_RRSIG">LDNS_RR_TYPE_RRSIG</a>))</td></tr>
<tr><th id="1143">1143</th><td>				!= <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="1144">1144</th><td>				<b>if</b>(!<a class="tu ref fn" href="#rrset_moveover_rrsigs" title='rrset_moveover_rrsigs' data-use='c' data-ref="rrset_moveover_rrsigs" data-ref-filename="rrset_moveover_rrsigs">rrset_moveover_rrsigs</a>(<a class="local col2 ref" href="#382node" title='node' data-ref="382node" data-ref-filename="382node">node</a>, <a class="local col3 ref" href="#383rr_type" title='rr_type' data-ref="383rr_type" data-ref-filename="383rr_type">rr_type</a>,</td></tr>
<tr><th id="1145">1145</th><td>					<a class="local col8 ref" href="#388rrset" title='rrset' data-ref="388rrset" data-ref-filename="388rrset">rrset</a>, <a class="local col0 ref" href="#390rrsig" title='rrsig' data-ref="390rrsig" data-ref-filename="390rrsig">rrsig</a>))</td></tr>
<tr><th id="1146">1146</th><td>					<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1147">1147</th><td>			}</td></tr>
<tr><th id="1148">1148</th><td>		}</td></tr>
<tr><th id="1149">1149</th><td>	}</td></tr>
<tr><th id="1150">1150</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1151">1151</th><td>}</td></tr>
<tr><th id="1152">1152</th><td></td></tr>
<tr><th id="1153">1153</th><td><i class="doc" data-doc="az_insert_rr">/** insert RR into zone, ignore duplicates */</i></td></tr>
<tr><th id="1154">1154</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="1155">1155</th><td><dfn class="tu decl def fn" id="az_insert_rr" title='az_insert_rr' data-type='int az_insert_rr(struct auth_zone * z, uint8_t * rr, size_t rr_len, size_t dname_len, int * duplicate)' data-ref="az_insert_rr" data-ref-filename="az_insert_rr">az_insert_rr</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col1 decl" id="391z" title='z' data-type='struct auth_zone *' data-ref="391z" data-ref-filename="391z">z</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col2 decl" id="392rr" title='rr' data-type='uint8_t *' data-ref="392rr" data-ref-filename="392rr">rr</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col3 decl" id="393rr_len" title='rr_len' data-type='size_t' data-ref="393rr_len" data-ref-filename="393rr_len">rr_len</dfn>,</td></tr>
<tr><th id="1156">1156</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col4 decl" id="394dname_len" title='dname_len' data-type='size_t' data-ref="394dname_len" data-ref-filename="394dname_len">dname_len</dfn>, <em>int</em>* <dfn class="local col5 decl" id="395duplicate" title='duplicate' data-type='int *' data-ref="395duplicate" data-ref-filename="395duplicate">duplicate</dfn>)</td></tr>
<tr><th id="1157">1157</th><td>{</td></tr>
<tr><th id="1158">1158</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col6 decl" id="396node" title='node' data-type='struct auth_data *' data-ref="396node" data-ref-filename="396node">node</dfn>;</td></tr>
<tr><th id="1159">1159</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col7 decl" id="397dname" title='dname' data-type='uint8_t *' data-ref="397dname" data-ref-filename="397dname">dname</dfn> = <a class="local col2 ref" href="#392rr" title='rr' data-ref="392rr" data-ref-filename="392rr">rr</a>;</td></tr>
<tr><th id="1160">1160</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col8 decl" id="398rr_type" title='rr_type' data-type='uint16_t' data-ref="398rr_type" data-ref-filename="398rr_type">rr_type</dfn> = <a class="ref fn" href="../sldns/str2wire.h.html#sldns_wirerr_get_type" title='sldns_wirerr_get_type' data-ref="sldns_wirerr_get_type" data-ref-filename="sldns_wirerr_get_type">sldns_wirerr_get_type</a>(<a class="local col2 ref" href="#392rr" title='rr' data-ref="392rr" data-ref-filename="392rr">rr</a>, <a class="local col3 ref" href="#393rr_len" title='rr_len' data-ref="393rr_len" data-ref-filename="393rr_len">rr_len</a>, <a class="local col4 ref" href="#394dname_len" title='dname_len' data-ref="394dname_len" data-ref-filename="394dname_len">dname_len</a>);</td></tr>
<tr><th id="1161">1161</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col9 decl" id="399rr_class" title='rr_class' data-type='uint16_t' data-ref="399rr_class" data-ref-filename="399rr_class">rr_class</dfn> = <a class="ref fn" href="../sldns/str2wire.h.html#sldns_wirerr_get_class" title='sldns_wirerr_get_class' data-ref="sldns_wirerr_get_class" data-ref-filename="sldns_wirerr_get_class">sldns_wirerr_get_class</a>(<a class="local col2 ref" href="#392rr" title='rr' data-ref="392rr" data-ref-filename="392rr">rr</a>, <a class="local col3 ref" href="#393rr_len" title='rr_len' data-ref="393rr_len" data-ref-filename="393rr_len">rr_len</a>, <a class="local col4 ref" href="#394dname_len" title='dname_len' data-ref="394dname_len" data-ref-filename="394dname_len">dname_len</a>);</td></tr>
<tr><th id="1162">1162</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a> <dfn class="local col0 decl" id="400rr_ttl" title='rr_ttl' data-type='uint32_t' data-ref="400rr_ttl" data-ref-filename="400rr_ttl">rr_ttl</dfn> = <a class="ref fn" href="../sldns/str2wire.h.html#sldns_wirerr_get_ttl" title='sldns_wirerr_get_ttl' data-ref="sldns_wirerr_get_ttl" data-ref-filename="sldns_wirerr_get_ttl">sldns_wirerr_get_ttl</a>(<a class="local col2 ref" href="#392rr" title='rr' data-ref="392rr" data-ref-filename="392rr">rr</a>, <a class="local col3 ref" href="#393rr_len" title='rr_len' data-ref="393rr_len" data-ref-filename="393rr_len">rr_len</a>, <a class="local col4 ref" href="#394dname_len" title='dname_len' data-ref="394dname_len" data-ref-filename="394dname_len">dname_len</a>);</td></tr>
<tr><th id="1163">1163</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col1 decl" id="401rdatalen" title='rdatalen' data-type='size_t' data-ref="401rdatalen" data-ref-filename="401rdatalen">rdatalen</dfn> = ((<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>)<a class="ref fn" href="../sldns/str2wire.h.html#sldns_wirerr_get_rdatalen" title='sldns_wirerr_get_rdatalen' data-ref="sldns_wirerr_get_rdatalen" data-ref-filename="sldns_wirerr_get_rdatalen">sldns_wirerr_get_rdatalen</a>(<a class="local col2 ref" href="#392rr" title='rr' data-ref="392rr" data-ref-filename="392rr">rr</a>, <a class="local col3 ref" href="#393rr_len" title='rr_len' data-ref="393rr_len" data-ref-filename="393rr_len">rr_len</a>,</td></tr>
<tr><th id="1164">1164</th><td>		<a class="local col4 ref" href="#394dname_len" title='dname_len' data-ref="394dname_len" data-ref-filename="394dname_len">dname_len</a>))+<var>2</var>;</td></tr>
<tr><th id="1165">1165</th><td>	<i>/* rdata points to rdata prefixed with uint16 rdatalength */</i></td></tr>
<tr><th id="1166">1166</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col2 decl" id="402rdata" title='rdata' data-type='uint8_t *' data-ref="402rdata" data-ref-filename="402rdata">rdata</dfn> = <a class="ref fn" href="../sldns/str2wire.h.html#sldns_wirerr_get_rdatawl" title='sldns_wirerr_get_rdatawl' data-ref="sldns_wirerr_get_rdatawl" data-ref-filename="sldns_wirerr_get_rdatawl">sldns_wirerr_get_rdatawl</a>(<a class="local col2 ref" href="#392rr" title='rr' data-ref="392rr" data-ref-filename="392rr">rr</a>, <a class="local col3 ref" href="#393rr_len" title='rr_len' data-ref="393rr_len" data-ref-filename="393rr_len">rr_len</a>, <a class="local col4 ref" href="#394dname_len" title='dname_len' data-ref="394dname_len" data-ref-filename="394dname_len">dname_len</a>);</td></tr>
<tr><th id="1167">1167</th><td></td></tr>
<tr><th id="1168">1168</th><td>	<b>if</b>(<a class="local col9 ref" href="#399rr_class" title='rr_class' data-ref="399rr_class" data-ref-filename="399rr_class">rr_class</a> != <a class="local col1 ref" href="#391z" title='z' data-ref="391z" data-ref-filename="391z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::dclass" title='auth_zone::dclass' data-ref="auth_zone::dclass" data-ref-filename="auth_zone..dclass">dclass</a>) {</td></tr>
<tr><th id="1169">1169</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"wrong class for RR"</q>);</td></tr>
<tr><th id="1170">1170</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1171">1171</th><td>	}</td></tr>
<tr><th id="1172">1172</th><td>	<b>if</b>(!(<a class="local col6 ref" href="#396node" title='node' data-ref="396node" data-ref-filename="396node">node</a>=<a class="tu ref fn" href="#az_domain_find_or_create" title='az_domain_find_or_create' data-use='c' data-ref="az_domain_find_or_create" data-ref-filename="az_domain_find_or_create">az_domain_find_or_create</a>(<a class="local col1 ref" href="#391z" title='z' data-ref="391z" data-ref-filename="391z">z</a>, <a class="local col7 ref" href="#397dname" title='dname' data-ref="397dname" data-ref-filename="397dname">dname</a>, <a class="local col4 ref" href="#394dname_len" title='dname_len' data-ref="394dname_len" data-ref-filename="394dname_len">dname_len</a>))) {</td></tr>
<tr><th id="1173">1173</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"cannot create domain"</q>);</td></tr>
<tr><th id="1174">1174</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1175">1175</th><td>	}</td></tr>
<tr><th id="1176">1176</th><td>	<b>if</b>(!<a class="tu ref fn" href="#az_domain_add_rr" title='az_domain_add_rr' data-use='c' data-ref="az_domain_add_rr" data-ref-filename="az_domain_add_rr">az_domain_add_rr</a>(<a class="local col6 ref" href="#396node" title='node' data-ref="396node" data-ref-filename="396node">node</a>, <a class="local col8 ref" href="#398rr_type" title='rr_type' data-ref="398rr_type" data-ref-filename="398rr_type">rr_type</a>, <a class="local col0 ref" href="#400rr_ttl" title='rr_ttl' data-ref="400rr_ttl" data-ref-filename="400rr_ttl">rr_ttl</a>, <a class="local col2 ref" href="#402rdata" title='rdata' data-ref="402rdata" data-ref-filename="402rdata">rdata</a>, <a class="local col1 ref" href="#401rdatalen" title='rdatalen' data-ref="401rdatalen" data-ref-filename="401rdatalen">rdatalen</a>,</td></tr>
<tr><th id="1177">1177</th><td>		<a class="local col5 ref" href="#395duplicate" title='duplicate' data-ref="395duplicate" data-ref-filename="395duplicate">duplicate</a>)) {</td></tr>
<tr><th id="1178">1178</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"cannot add RR to domain"</q>);</td></tr>
<tr><th id="1179">1179</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1180">1180</th><td>	}</td></tr>
<tr><th id="1181">1181</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1182">1182</th><td>}</td></tr>
<tr><th id="1183">1183</th><td></td></tr>
<tr><th id="1184">1184</th><td><i class="doc" data-doc="az_domain_remove_rr">/** Remove rr from node, ignores nonexisting RRs,</i></td></tr>
<tr><th id="1185">1185</th><td><i class="doc" data-doc="az_domain_remove_rr"> * rdata points to buffer with rdatalen octets, starts with 2bytelength. */</i></td></tr>
<tr><th id="1186">1186</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="1187">1187</th><td><dfn class="tu decl def fn" id="az_domain_remove_rr" title='az_domain_remove_rr' data-type='int az_domain_remove_rr(struct auth_data * node, uint16_t rr_type, uint8_t * rdata, size_t rdatalen, int * nonexist)' data-ref="az_domain_remove_rr" data-ref-filename="az_domain_remove_rr">az_domain_remove_rr</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col3 decl" id="403node" title='node' data-type='struct auth_data *' data-ref="403node" data-ref-filename="403node">node</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col4 decl" id="404rr_type" title='rr_type' data-type='uint16_t' data-ref="404rr_type" data-ref-filename="404rr_type">rr_type</dfn>,</td></tr>
<tr><th id="1188">1188</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col5 decl" id="405rdata" title='rdata' data-type='uint8_t *' data-ref="405rdata" data-ref-filename="405rdata">rdata</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col6 decl" id="406rdatalen" title='rdatalen' data-type='size_t' data-ref="406rdatalen" data-ref-filename="406rdatalen">rdatalen</dfn>, <em>int</em>* <dfn class="local col7 decl" id="407nonexist" title='nonexist' data-type='int *' data-ref="407nonexist" data-ref-filename="407nonexist">nonexist</dfn>)</td></tr>
<tr><th id="1189">1189</th><td>{</td></tr>
<tr><th id="1190">1190</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col8 decl" id="408rrset" title='rrset' data-type='struct auth_rrset *' data-ref="408rrset" data-ref-filename="408rrset">rrset</dfn>;</td></tr>
<tr><th id="1191">1191</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col9 decl" id="409index" title='index' data-type='size_t' data-ref="409index" data-ref-filename="409index">index</dfn> = <var>0</var>;</td></tr>
<tr><th id="1192">1192</th><td></td></tr>
<tr><th id="1193">1193</th><td>	<i>/* find the plain RR of the given type */</i></td></tr>
<tr><th id="1194">1194</th><td>	<b>if</b>((<a class="local col8 ref" href="#408rrset" title='rrset' data-ref="408rrset" data-ref-filename="408rrset">rrset</a>=<a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(<a class="local col3 ref" href="#403node" title='node' data-ref="403node" data-ref-filename="403node">node</a>, <a class="local col4 ref" href="#404rr_type" title='rr_type' data-ref="404rr_type" data-ref-filename="404rr_type">rr_type</a>))!= <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="1195">1195</th><td>		<b>if</b>(<a class="tu ref fn" href="#az_rrset_find_rr" title='az_rrset_find_rr' data-use='c' data-ref="az_rrset_find_rr" data-ref-filename="az_rrset_find_rr">az_rrset_find_rr</a>(<a class="local col8 ref" href="#408rrset" title='rrset' data-ref="408rrset" data-ref-filename="408rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>, <a class="local col5 ref" href="#405rdata" title='rdata' data-ref="405rdata" data-ref-filename="405rdata">rdata</a>, <a class="local col6 ref" href="#406rdatalen" title='rdatalen' data-ref="406rdatalen" data-ref-filename="406rdatalen">rdatalen</a>, &amp;<a class="local col9 ref" href="#409index" title='index' data-ref="409index" data-ref-filename="409index">index</a>)) {</td></tr>
<tr><th id="1196">1196</th><td>			<b>if</b>(<a class="local col8 ref" href="#408rrset" title='rrset' data-ref="408rrset" data-ref-filename="408rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a> == <var>1</var> &amp;&amp;</td></tr>
<tr><th id="1197">1197</th><td>				<a class="local col8 ref" href="#408rrset" title='rrset' data-ref="408rrset" data-ref-filename="408rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a> == <var>0</var>) {</td></tr>
<tr><th id="1198">1198</th><td>				<i>/* last RR, delete the rrset */</i></td></tr>
<tr><th id="1199">1199</th><td>				<a class="tu ref fn" href="#domain_remove_rrset" title='domain_remove_rrset' data-use='c' data-ref="domain_remove_rrset" data-ref-filename="domain_remove_rrset">domain_remove_rrset</a>(<a class="local col3 ref" href="#403node" title='node' data-ref="403node" data-ref-filename="403node">node</a>, <a class="local col4 ref" href="#404rr_type" title='rr_type' data-ref="404rr_type" data-ref-filename="404rr_type">rr_type</a>);</td></tr>
<tr><th id="1200">1200</th><td>			} <b>else</b> <b>if</b>(<a class="local col8 ref" href="#408rrset" title='rrset' data-ref="408rrset" data-ref-filename="408rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a> == <var>1</var> &amp;&amp;</td></tr>
<tr><th id="1201">1201</th><td>				<a class="local col8 ref" href="#408rrset" title='rrset' data-ref="408rrset" data-ref-filename="408rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a> != <var>0</var>) {</td></tr>
<tr><th id="1202">1202</th><td>				<i>/* move RRSIGs to the RRSIG rrset, or</i></td></tr>
<tr><th id="1203">1203</th><td><i>				 * this one becomes that RRset */</i></td></tr>
<tr><th id="1204">1204</th><td>				<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col0 decl" id="410rrsigset" title='rrsigset' data-type='struct auth_rrset *' data-ref="410rrsigset" data-ref-filename="410rrsigset">rrsigset</dfn> = <a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(</td></tr>
<tr><th id="1205">1205</th><td>					<a class="local col3 ref" href="#403node" title='node' data-ref="403node" data-ref-filename="403node">node</a>, <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_RRSIG" title='LDNS_RR_TYPE_RRSIG' data-ref="LDNS_RR_TYPE_RRSIG" data-ref-filename="LDNS_RR_TYPE_RRSIG">LDNS_RR_TYPE_RRSIG</a>);</td></tr>
<tr><th id="1206">1206</th><td>				<b>if</b>(<a class="local col0 ref" href="#410rrsigset" title='rrsigset' data-ref="410rrsigset" data-ref-filename="410rrsigset">rrsigset</a>) {</td></tr>
<tr><th id="1207">1207</th><td>					<i>/* move left over rrsigs to the</i></td></tr>
<tr><th id="1208">1208</th><td><i>					 * existing rrset of type RRSIG */</i></td></tr>
<tr><th id="1209">1209</th><td>					<a class="tu ref fn" href="#rrsigs_copy_from_rrset_to_rrsigset" title='rrsigs_copy_from_rrset_to_rrsigset' data-use='c' data-ref="rrsigs_copy_from_rrset_to_rrsigset" data-ref-filename="rrsigs_copy_from_rrset_to_rrsigset">rrsigs_copy_from_rrset_to_rrsigset</a>(</td></tr>
<tr><th id="1210">1210</th><td>						<a class="local col8 ref" href="#408rrset" title='rrset' data-ref="408rrset" data-ref-filename="408rrset">rrset</a>, <a class="local col0 ref" href="#410rrsigset" title='rrsigset' data-ref="410rrsigset" data-ref-filename="410rrsigset">rrsigset</a>);</td></tr>
<tr><th id="1211">1211</th><td>					<i>/* and then delete the rrset */</i></td></tr>
<tr><th id="1212">1212</th><td>					<a class="tu ref fn" href="#domain_remove_rrset" title='domain_remove_rrset' data-use='c' data-ref="domain_remove_rrset" data-ref-filename="domain_remove_rrset">domain_remove_rrset</a>(<a class="local col3 ref" href="#403node" title='node' data-ref="403node" data-ref-filename="403node">node</a>, <a class="local col4 ref" href="#404rr_type" title='rr_type' data-ref="404rr_type" data-ref-filename="404rr_type">rr_type</a>);</td></tr>
<tr><th id="1213">1213</th><td>				} <b>else</b> {</td></tr>
<tr><th id="1214">1214</th><td>					<i>/* no rrset of type RRSIG, this</i></td></tr>
<tr><th id="1215">1215</th><td><i>					 * set is now of that type,</i></td></tr>
<tr><th id="1216">1216</th><td><i>					 * just remove the rr */</i></td></tr>
<tr><th id="1217">1217</th><td>					<b>if</b>(!<a class="tu ref fn" href="#rrset_remove_rr" title='rrset_remove_rr' data-use='c' data-ref="rrset_remove_rr" data-ref-filename="rrset_remove_rr">rrset_remove_rr</a>(<a class="local col8 ref" href="#408rrset" title='rrset' data-ref="408rrset" data-ref-filename="408rrset">rrset</a>, <a class="local col9 ref" href="#409index" title='index' data-ref="409index" data-ref-filename="409index">index</a>))</td></tr>
<tr><th id="1218">1218</th><td>						<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1219">1219</th><td>					<a class="local col8 ref" href="#408rrset" title='rrset' data-ref="408rrset" data-ref-filename="408rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::type" title='auth_rrset::type' data-ref="auth_rrset::type" data-ref-filename="auth_rrset..type">type</a> = <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_RRSIG" title='LDNS_RR_TYPE_RRSIG' data-ref="LDNS_RR_TYPE_RRSIG" data-ref-filename="LDNS_RR_TYPE_RRSIG">LDNS_RR_TYPE_RRSIG</a>;</td></tr>
<tr><th id="1220">1220</th><td>					<a class="local col8 ref" href="#408rrset" title='rrset' data-ref="408rrset" data-ref-filename="408rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a> = <a class="local col8 ref" href="#408rrset" title='rrset' data-ref="408rrset" data-ref-filename="408rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a>;</td></tr>
<tr><th id="1221">1221</th><td>					<a class="local col8 ref" href="#408rrset" title='rrset' data-ref="408rrset" data-ref-filename="408rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a> = <var>0</var>;</td></tr>
<tr><th id="1222">1222</th><td>				}</td></tr>
<tr><th id="1223">1223</th><td>			} <b>else</b> {</td></tr>
<tr><th id="1224">1224</th><td>				<i>/* remove the RR from the rrset */</i></td></tr>
<tr><th id="1225">1225</th><td>				<b>if</b>(!<a class="tu ref fn" href="#rrset_remove_rr" title='rrset_remove_rr' data-use='c' data-ref="rrset_remove_rr" data-ref-filename="rrset_remove_rr">rrset_remove_rr</a>(<a class="local col8 ref" href="#408rrset" title='rrset' data-ref="408rrset" data-ref-filename="408rrset">rrset</a>, <a class="local col9 ref" href="#409index" title='index' data-ref="409index" data-ref-filename="409index">index</a>))</td></tr>
<tr><th id="1226">1226</th><td>					<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1227">1227</th><td>			}</td></tr>
<tr><th id="1228">1228</th><td>			<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1229">1229</th><td>		}</td></tr>
<tr><th id="1230">1230</th><td>		<i>/* rr not found in rrset */</i></td></tr>
<tr><th id="1231">1231</th><td>	}</td></tr>
<tr><th id="1232">1232</th><td></td></tr>
<tr><th id="1233">1233</th><td>	<i>/* is it a type RRSIG, look under the covered type */</i></td></tr>
<tr><th id="1234">1234</th><td>	<b>if</b>(<a class="local col4 ref" href="#404rr_type" title='rr_type' data-ref="404rr_type" data-ref-filename="404rr_type">rr_type</a> == <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_RRSIG" title='LDNS_RR_TYPE_RRSIG' data-ref="LDNS_RR_TYPE_RRSIG" data-ref-filename="LDNS_RR_TYPE_RRSIG">LDNS_RR_TYPE_RRSIG</a>) {</td></tr>
<tr><th id="1235">1235</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col1 decl" id="411ctype" title='ctype' data-type='uint16_t' data-ref="411ctype" data-ref-filename="411ctype">ctype</dfn> = <a class="tu ref fn" href="#rrsig_rdata_get_type_covered" title='rrsig_rdata_get_type_covered' data-use='c' data-ref="rrsig_rdata_get_type_covered" data-ref-filename="rrsig_rdata_get_type_covered">rrsig_rdata_get_type_covered</a>(<a class="local col5 ref" href="#405rdata" title='rdata' data-ref="405rdata" data-ref-filename="405rdata">rdata</a>, <a class="local col6 ref" href="#406rdatalen" title='rdatalen' data-ref="406rdatalen" data-ref-filename="406rdatalen">rdatalen</a>);</td></tr>
<tr><th id="1236">1236</th><td>		<b>if</b>((<a class="local col8 ref" href="#408rrset" title='rrset' data-ref="408rrset" data-ref-filename="408rrset">rrset</a>=<a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(<a class="local col3 ref" href="#403node" title='node' data-ref="403node" data-ref-filename="403node">node</a>, <a class="local col1 ref" href="#411ctype" title='ctype' data-ref="411ctype" data-ref-filename="411ctype">ctype</a>))!= <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="1237">1237</th><td>			<b>if</b>(<a class="tu ref fn" href="#az_rrset_find_rrsig" title='az_rrset_find_rrsig' data-use='c' data-ref="az_rrset_find_rrsig" data-ref-filename="az_rrset_find_rrsig">az_rrset_find_rrsig</a>(<a class="local col8 ref" href="#408rrset" title='rrset' data-ref="408rrset" data-ref-filename="408rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>, <a class="local col5 ref" href="#405rdata" title='rdata' data-ref="405rdata" data-ref-filename="405rdata">rdata</a>, <a class="local col6 ref" href="#406rdatalen" title='rdatalen' data-ref="406rdatalen" data-ref-filename="406rdatalen">rdatalen</a>,</td></tr>
<tr><th id="1238">1238</th><td>				&amp;<a class="local col9 ref" href="#409index" title='index' data-ref="409index" data-ref-filename="409index">index</a>)) {</td></tr>
<tr><th id="1239">1239</th><td>				<i>/* rrsig should have d-&gt;count &gt; 0, be</i></td></tr>
<tr><th id="1240">1240</th><td><i>				 * over some rr of that type */</i></td></tr>
<tr><th id="1241">1241</th><td>				<i>/* remove the rrsig from the rrsigs list of the</i></td></tr>
<tr><th id="1242">1242</th><td><i>				 * rrset */</i></td></tr>
<tr><th id="1243">1243</th><td>				<b>if</b>(!<a class="tu ref fn" href="#rrset_remove_rr" title='rrset_remove_rr' data-use='c' data-ref="rrset_remove_rr" data-ref-filename="rrset_remove_rr">rrset_remove_rr</a>(<a class="local col8 ref" href="#408rrset" title='rrset' data-ref="408rrset" data-ref-filename="408rrset">rrset</a>, <a class="local col9 ref" href="#409index" title='index' data-ref="409index" data-ref-filename="409index">index</a>))</td></tr>
<tr><th id="1244">1244</th><td>					<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1245">1245</th><td>				<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1246">1246</th><td>			}</td></tr>
<tr><th id="1247">1247</th><td>		}</td></tr>
<tr><th id="1248">1248</th><td>		<i>/* also RRSIG not found */</i></td></tr>
<tr><th id="1249">1249</th><td>	}</td></tr>
<tr><th id="1250">1250</th><td></td></tr>
<tr><th id="1251">1251</th><td>	<i>/* nothing found to delete */</i></td></tr>
<tr><th id="1252">1252</th><td>	<b>if</b>(<a class="local col7 ref" href="#407nonexist" title='nonexist' data-ref="407nonexist" data-ref-filename="407nonexist">nonexist</a>) *<a class="local col7 ref" href="#407nonexist" title='nonexist' data-ref="407nonexist" data-ref-filename="407nonexist">nonexist</a> = <var>1</var>;</td></tr>
<tr><th id="1253">1253</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1254">1254</th><td>}</td></tr>
<tr><th id="1255">1255</th><td></td></tr>
<tr><th id="1256">1256</th><td><i class="doc" data-doc="az_remove_rr">/** remove RR from zone, ignore if it does not exist, false on alloc failure*/</i></td></tr>
<tr><th id="1257">1257</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="1258">1258</th><td><dfn class="tu decl def fn" id="az_remove_rr" title='az_remove_rr' data-type='int az_remove_rr(struct auth_zone * z, uint8_t * rr, size_t rr_len, size_t dname_len, int * nonexist)' data-ref="az_remove_rr" data-ref-filename="az_remove_rr">az_remove_rr</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col2 decl" id="412z" title='z' data-type='struct auth_zone *' data-ref="412z" data-ref-filename="412z">z</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col3 decl" id="413rr" title='rr' data-type='uint8_t *' data-ref="413rr" data-ref-filename="413rr">rr</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col4 decl" id="414rr_len" title='rr_len' data-type='size_t' data-ref="414rr_len" data-ref-filename="414rr_len">rr_len</dfn>,</td></tr>
<tr><th id="1259">1259</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col5 decl" id="415dname_len" title='dname_len' data-type='size_t' data-ref="415dname_len" data-ref-filename="415dname_len">dname_len</dfn>, <em>int</em>* <dfn class="local col6 decl" id="416nonexist" title='nonexist' data-type='int *' data-ref="416nonexist" data-ref-filename="416nonexist">nonexist</dfn>)</td></tr>
<tr><th id="1260">1260</th><td>{</td></tr>
<tr><th id="1261">1261</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col7 decl" id="417node" title='node' data-type='struct auth_data *' data-ref="417node" data-ref-filename="417node">node</dfn>;</td></tr>
<tr><th id="1262">1262</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col8 decl" id="418dname" title='dname' data-type='uint8_t *' data-ref="418dname" data-ref-filename="418dname">dname</dfn> = <a class="local col3 ref" href="#413rr" title='rr' data-ref="413rr" data-ref-filename="413rr">rr</a>;</td></tr>
<tr><th id="1263">1263</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col9 decl" id="419rr_type" title='rr_type' data-type='uint16_t' data-ref="419rr_type" data-ref-filename="419rr_type">rr_type</dfn> = <a class="ref fn" href="../sldns/str2wire.h.html#sldns_wirerr_get_type" title='sldns_wirerr_get_type' data-ref="sldns_wirerr_get_type" data-ref-filename="sldns_wirerr_get_type">sldns_wirerr_get_type</a>(<a class="local col3 ref" href="#413rr" title='rr' data-ref="413rr" data-ref-filename="413rr">rr</a>, <a class="local col4 ref" href="#414rr_len" title='rr_len' data-ref="414rr_len" data-ref-filename="414rr_len">rr_len</a>, <a class="local col5 ref" href="#415dname_len" title='dname_len' data-ref="415dname_len" data-ref-filename="415dname_len">dname_len</a>);</td></tr>
<tr><th id="1264">1264</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col0 decl" id="420rr_class" title='rr_class' data-type='uint16_t' data-ref="420rr_class" data-ref-filename="420rr_class">rr_class</dfn> = <a class="ref fn" href="../sldns/str2wire.h.html#sldns_wirerr_get_class" title='sldns_wirerr_get_class' data-ref="sldns_wirerr_get_class" data-ref-filename="sldns_wirerr_get_class">sldns_wirerr_get_class</a>(<a class="local col3 ref" href="#413rr" title='rr' data-ref="413rr" data-ref-filename="413rr">rr</a>, <a class="local col4 ref" href="#414rr_len" title='rr_len' data-ref="414rr_len" data-ref-filename="414rr_len">rr_len</a>, <a class="local col5 ref" href="#415dname_len" title='dname_len' data-ref="415dname_len" data-ref-filename="415dname_len">dname_len</a>);</td></tr>
<tr><th id="1265">1265</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col1 decl" id="421rdatalen" title='rdatalen' data-type='size_t' data-ref="421rdatalen" data-ref-filename="421rdatalen">rdatalen</dfn> = ((<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>)<a class="ref fn" href="../sldns/str2wire.h.html#sldns_wirerr_get_rdatalen" title='sldns_wirerr_get_rdatalen' data-ref="sldns_wirerr_get_rdatalen" data-ref-filename="sldns_wirerr_get_rdatalen">sldns_wirerr_get_rdatalen</a>(<a class="local col3 ref" href="#413rr" title='rr' data-ref="413rr" data-ref-filename="413rr">rr</a>, <a class="local col4 ref" href="#414rr_len" title='rr_len' data-ref="414rr_len" data-ref-filename="414rr_len">rr_len</a>,</td></tr>
<tr><th id="1266">1266</th><td>		<a class="local col5 ref" href="#415dname_len" title='dname_len' data-ref="415dname_len" data-ref-filename="415dname_len">dname_len</a>))+<var>2</var>;</td></tr>
<tr><th id="1267">1267</th><td>	<i>/* rdata points to rdata prefixed with uint16 rdatalength */</i></td></tr>
<tr><th id="1268">1268</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col2 decl" id="422rdata" title='rdata' data-type='uint8_t *' data-ref="422rdata" data-ref-filename="422rdata">rdata</dfn> = <a class="ref fn" href="../sldns/str2wire.h.html#sldns_wirerr_get_rdatawl" title='sldns_wirerr_get_rdatawl' data-ref="sldns_wirerr_get_rdatawl" data-ref-filename="sldns_wirerr_get_rdatawl">sldns_wirerr_get_rdatawl</a>(<a class="local col3 ref" href="#413rr" title='rr' data-ref="413rr" data-ref-filename="413rr">rr</a>, <a class="local col4 ref" href="#414rr_len" title='rr_len' data-ref="414rr_len" data-ref-filename="414rr_len">rr_len</a>, <a class="local col5 ref" href="#415dname_len" title='dname_len' data-ref="415dname_len" data-ref-filename="415dname_len">dname_len</a>);</td></tr>
<tr><th id="1269">1269</th><td></td></tr>
<tr><th id="1270">1270</th><td>	<b>if</b>(<a class="local col0 ref" href="#420rr_class" title='rr_class' data-ref="420rr_class" data-ref-filename="420rr_class">rr_class</a> != <a class="local col2 ref" href="#412z" title='z' data-ref="412z" data-ref-filename="412z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::dclass" title='auth_zone::dclass' data-ref="auth_zone::dclass" data-ref-filename="auth_zone..dclass">dclass</a>) {</td></tr>
<tr><th id="1271">1271</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"wrong class for RR"</q>);</td></tr>
<tr><th id="1272">1272</th><td>		<i>/* really also a nonexisting entry, because no records</i></td></tr>
<tr><th id="1273">1273</th><td><i>		 * of that class in the zone, but return an error because</i></td></tr>
<tr><th id="1274">1274</th><td><i>		 * getting records of the wrong class is a failure of the</i></td></tr>
<tr><th id="1275">1275</th><td><i>		 * zone transfer */</i></td></tr>
<tr><th id="1276">1276</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1277">1277</th><td>	}</td></tr>
<tr><th id="1278">1278</th><td>	<a class="local col7 ref" href="#417node" title='node' data-ref="417node" data-ref-filename="417node">node</a> = <a class="tu ref fn" href="#az_find_name" title='az_find_name' data-use='c' data-ref="az_find_name" data-ref-filename="az_find_name">az_find_name</a>(<a class="local col2 ref" href="#412z" title='z' data-ref="412z" data-ref-filename="412z">z</a>, <a class="local col8 ref" href="#418dname" title='dname' data-ref="418dname" data-ref-filename="418dname">dname</a>, <a class="local col5 ref" href="#415dname_len" title='dname_len' data-ref="415dname_len" data-ref-filename="415dname_len">dname_len</a>);</td></tr>
<tr><th id="1279">1279</th><td>	<b>if</b>(!<a class="local col7 ref" href="#417node" title='node' data-ref="417node" data-ref-filename="417node">node</a>) {</td></tr>
<tr><th id="1280">1280</th><td>		<i>/* node with that name does not exist */</i></td></tr>
<tr><th id="1281">1281</th><td>		<i>/* nonexisting entry, because no such name */</i></td></tr>
<tr><th id="1282">1282</th><td>		*<a class="local col6 ref" href="#416nonexist" title='nonexist' data-ref="416nonexist" data-ref-filename="416nonexist">nonexist</a> = <var>1</var>;</td></tr>
<tr><th id="1283">1283</th><td>		<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1284">1284</th><td>	}</td></tr>
<tr><th id="1285">1285</th><td>	<b>if</b>(!<a class="tu ref fn" href="#az_domain_remove_rr" title='az_domain_remove_rr' data-use='c' data-ref="az_domain_remove_rr" data-ref-filename="az_domain_remove_rr">az_domain_remove_rr</a>(<a class="local col7 ref" href="#417node" title='node' data-ref="417node" data-ref-filename="417node">node</a>, <a class="local col9 ref" href="#419rr_type" title='rr_type' data-ref="419rr_type" data-ref-filename="419rr_type">rr_type</a>, <a class="local col2 ref" href="#422rdata" title='rdata' data-ref="422rdata" data-ref-filename="422rdata">rdata</a>, <a class="local col1 ref" href="#421rdatalen" title='rdatalen' data-ref="421rdatalen" data-ref-filename="421rdatalen">rdatalen</a>, <a class="local col6 ref" href="#416nonexist" title='nonexist' data-ref="416nonexist" data-ref-filename="416nonexist">nonexist</a>)) {</td></tr>
<tr><th id="1286">1286</th><td>		<i>/* alloc failure or so */</i></td></tr>
<tr><th id="1287">1287</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1288">1288</th><td>	}</td></tr>
<tr><th id="1289">1289</th><td>	<i>/* remove the node, if necessary */</i></td></tr>
<tr><th id="1290">1290</th><td>	<i>/* an rrsets==NULL entry is not kept around for empty nonterminals,</i></td></tr>
<tr><th id="1291">1291</th><td><i>	 * and also parent nodes are not kept around, so we just delete it */</i></td></tr>
<tr><th id="1292">1292</th><td>	<b>if</b>(<a class="local col7 ref" href="#417node" title='node' data-ref="417node" data-ref-filename="417node">node</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::rrsets" title='auth_data::rrsets' data-ref="auth_data::rrsets" data-ref-filename="auth_data..rrsets">rrsets</a> == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="1293">1293</th><td>		(<em>void</em>)<a class="ref fn" href="../util/rbtree.h.html#rbtree_delete" title='rbtree_delete' data-ref="rbtree_delete" data-ref-filename="rbtree_delete">rbtree_delete</a>(&amp;<a class="local col2 ref" href="#412z" title='z' data-ref="412z" data-ref-filename="412z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::data" title='auth_zone::data' data-ref="auth_zone::data" data-ref-filename="auth_zone..data">data</a>, <a class="local col7 ref" href="#417node" title='node' data-ref="417node" data-ref-filename="417node">node</a>);</td></tr>
<tr><th id="1294">1294</th><td>		<a class="tu ref fn" href="#auth_data_delete" title='auth_data_delete' data-use='c' data-ref="auth_data_delete" data-ref-filename="auth_data_delete">auth_data_delete</a>(<a class="local col7 ref" href="#417node" title='node' data-ref="417node" data-ref-filename="417node">node</a>);</td></tr>
<tr><th id="1295">1295</th><td>	}</td></tr>
<tr><th id="1296">1296</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1297">1297</th><td>}</td></tr>
<tr><th id="1298">1298</th><td></td></tr>
<tr><th id="1299">1299</th><td><i class="doc" data-doc="decompress_rr_into_buffer">/** decompress an RR into the buffer where it'll be an uncompressed RR</i></td></tr>
<tr><th id="1300">1300</th><td><i class="doc" data-doc="decompress_rr_into_buffer"> * with uncompressed dname and uncompressed rdata (dnames) */</i></td></tr>
<tr><th id="1301">1301</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="1302">1302</th><td><dfn class="tu decl def fn" id="decompress_rr_into_buffer" title='decompress_rr_into_buffer' data-type='int decompress_rr_into_buffer(struct sldns_buffer * buf, uint8_t * pkt, size_t pktlen, uint8_t * dname, uint16_t rr_type, uint16_t rr_class, uint32_t rr_ttl, uint8_t * rr_data, uint16_t rr_rdlen)' data-ref="decompress_rr_into_buffer" data-ref-filename="decompress_rr_into_buffer">decompress_rr_into_buffer</dfn>(<b>struct</b> <a class="type" href="../sldns/sbuffer.h.html#sldns_buffer" title='sldns_buffer' data-ref="sldns_buffer" data-ref-filename="sldns_buffer">sldns_buffer</a>* <dfn class="local col3 decl" id="423buf" title='buf' data-type='struct sldns_buffer *' data-ref="423buf" data-ref-filename="423buf">buf</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col4 decl" id="424pkt" title='pkt' data-type='uint8_t *' data-ref="424pkt" data-ref-filename="424pkt">pkt</dfn>,</td></tr>
<tr><th id="1303">1303</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col5 decl" id="425pktlen" title='pktlen' data-type='size_t' data-ref="425pktlen" data-ref-filename="425pktlen">pktlen</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col6 decl" id="426dname" title='dname' data-type='uint8_t *' data-ref="426dname" data-ref-filename="426dname">dname</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col7 decl" id="427rr_type" title='rr_type' data-type='uint16_t' data-ref="427rr_type" data-ref-filename="427rr_type">rr_type</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col8 decl" id="428rr_class" title='rr_class' data-type='uint16_t' data-ref="428rr_class" data-ref-filename="428rr_class">rr_class</dfn>,</td></tr>
<tr><th id="1304">1304</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a> <dfn class="local col9 decl" id="429rr_ttl" title='rr_ttl' data-type='uint32_t' data-ref="429rr_ttl" data-ref-filename="429rr_ttl">rr_ttl</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col0 decl" id="430rr_data" title='rr_data' data-type='uint8_t *' data-ref="430rr_data" data-ref-filename="430rr_data">rr_data</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col1 decl" id="431rr_rdlen" title='rr_rdlen' data-type='uint16_t' data-ref="431rr_rdlen" data-ref-filename="431rr_rdlen">rr_rdlen</dfn>)</td></tr>
<tr><th id="1305">1305</th><td>{</td></tr>
<tr><th id="1306">1306</th><td>	<a class="typedef" href="../sldns/sbuffer.h.html#sldns_buffer" title='sldns_buffer' data-type='struct sldns_buffer' data-ref="sldns_buffer" data-ref-filename="sldns_buffer">sldns_buffer</a> <dfn class="local col2 decl" id="432pktbuf" title='pktbuf' data-type='sldns_buffer' data-ref="432pktbuf" data-ref-filename="432pktbuf">pktbuf</dfn>;</td></tr>
<tr><th id="1307">1307</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col3 decl" id="433dname_len" title='dname_len' data-type='size_t' data-ref="433dname_len" data-ref-filename="433dname_len">dname_len</dfn> = <var>0</var>;</td></tr>
<tr><th id="1308">1308</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col4 decl" id="434rdlenpos" title='rdlenpos' data-type='size_t' data-ref="434rdlenpos" data-ref-filename="434rdlenpos">rdlenpos</dfn>;</td></tr>
<tr><th id="1309">1309</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col5 decl" id="435rdlen" title='rdlen' data-type='size_t' data-ref="435rdlen" data-ref-filename="435rdlen">rdlen</dfn>;</td></tr>
<tr><th id="1310">1310</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col6 decl" id="436rd" title='rd' data-type='uint8_t *' data-ref="436rd" data-ref-filename="436rd">rd</dfn>;</td></tr>
<tr><th id="1311">1311</th><td>	<em>const</em> <a class="typedef" href="../sldns/rrdef.h.html#sldns_rr_descriptor" title='sldns_rr_descriptor' data-type='struct sldns_struct_rr_descriptor' data-ref="sldns_rr_descriptor" data-ref-filename="sldns_rr_descriptor">sldns_rr_descriptor</a>* <dfn class="local col7 decl" id="437desc" title='desc' data-type='const sldns_rr_descriptor *' data-ref="437desc" data-ref-filename="437desc">desc</dfn>;</td></tr>
<tr><th id="1312">1312</th><td>	<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_init_frm_data" title='sldns_buffer_init_frm_data' data-ref="sldns_buffer_init_frm_data" data-ref-filename="sldns_buffer_init_frm_data">sldns_buffer_init_frm_data</a>(&amp;<a class="local col2 ref" href="#432pktbuf" title='pktbuf' data-ref="432pktbuf" data-ref-filename="432pktbuf">pktbuf</a>, <a class="local col4 ref" href="#424pkt" title='pkt' data-ref="424pkt" data-ref-filename="424pkt">pkt</a>, <a class="local col5 ref" href="#425pktlen" title='pktlen' data-ref="425pktlen" data-ref-filename="425pktlen">pktlen</a>);</td></tr>
<tr><th id="1313">1313</th><td>	<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_clear" title='sldns_buffer_clear' data-ref="sldns_buffer_clear" data-ref-filename="sldns_buffer_clear">sldns_buffer_clear</a>(<a class="local col3 ref" href="#423buf" title='buf' data-ref="423buf" data-ref-filename="423buf">buf</a>);</td></tr>
<tr><th id="1314">1314</th><td></td></tr>
<tr><th id="1315">1315</th><td>	<i>/* decompress dname */</i></td></tr>
<tr><th id="1316">1316</th><td>	<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_set_position" title='sldns_buffer_set_position' data-ref="sldns_buffer_set_position" data-ref-filename="sldns_buffer_set_position">sldns_buffer_set_position</a>(&amp;<a class="local col2 ref" href="#432pktbuf" title='pktbuf' data-ref="432pktbuf" data-ref-filename="432pktbuf">pktbuf</a>,</td></tr>
<tr><th id="1317">1317</th><td>		(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>)(<a class="local col6 ref" href="#426dname" title='dname' data-ref="426dname" data-ref-filename="426dname">dname</a> - <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_current" title='sldns_buffer_current' data-ref="sldns_buffer_current" data-ref-filename="sldns_buffer_current">sldns_buffer_current</a>(&amp;<a class="local col2 ref" href="#432pktbuf" title='pktbuf' data-ref="432pktbuf" data-ref-filename="432pktbuf">pktbuf</a>)));</td></tr>
<tr><th id="1318">1318</th><td>	<a class="local col3 ref" href="#433dname_len" title='dname_len' data-ref="433dname_len" data-ref-filename="433dname_len">dname_len</a> = <a class="ref fn" href="../util/data/dname.h.html#pkt_dname_len" title='pkt_dname_len' data-ref="pkt_dname_len" data-ref-filename="pkt_dname_len">pkt_dname_len</a>(&amp;<a class="local col2 ref" href="#432pktbuf" title='pktbuf' data-ref="432pktbuf" data-ref-filename="432pktbuf">pktbuf</a>);</td></tr>
<tr><th id="1319">1319</th><td>	<b>if</b>(<a class="local col3 ref" href="#433dname_len" title='dname_len' data-ref="433dname_len" data-ref-filename="433dname_len">dname_len</a> == <var>0</var>) <b>return</b> <var>0</var>; <i>/* parse fail on dname */</i></td></tr>
<tr><th id="1320">1320</th><td>	<b>if</b>(!<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_available" title='sldns_buffer_available' data-ref="sldns_buffer_available" data-ref-filename="sldns_buffer_available">sldns_buffer_available</a>(<a class="local col3 ref" href="#423buf" title='buf' data-ref="423buf" data-ref-filename="423buf">buf</a>, <a class="local col3 ref" href="#433dname_len" title='dname_len' data-ref="433dname_len" data-ref-filename="433dname_len">dname_len</a>)) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="1321">1321</th><td>	<a class="ref fn" href="../util/data/dname.h.html#dname_pkt_copy" title='dname_pkt_copy' data-ref="dname_pkt_copy" data-ref-filename="dname_pkt_copy">dname_pkt_copy</a>(&amp;<a class="local col2 ref" href="#432pktbuf" title='pktbuf' data-ref="432pktbuf" data-ref-filename="432pktbuf">pktbuf</a>, <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_current" title='sldns_buffer_current' data-ref="sldns_buffer_current" data-ref-filename="sldns_buffer_current">sldns_buffer_current</a>(<a class="local col3 ref" href="#423buf" title='buf' data-ref="423buf" data-ref-filename="423buf">buf</a>), <a class="local col6 ref" href="#426dname" title='dname' data-ref="426dname" data-ref-filename="426dname">dname</a>);</td></tr>
<tr><th id="1322">1322</th><td>	<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_skip" title='sldns_buffer_skip' data-ref="sldns_buffer_skip" data-ref-filename="sldns_buffer_skip">sldns_buffer_skip</a>(<a class="local col3 ref" href="#423buf" title='buf' data-ref="423buf" data-ref-filename="423buf">buf</a>, (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#ssize_t" title='ssize_t' data-type='int' data-ref="ssize_t" data-ref-filename="ssize_t">ssize_t</a>)<a class="local col3 ref" href="#433dname_len" title='dname_len' data-ref="433dname_len" data-ref-filename="433dname_len">dname_len</a>);</td></tr>
<tr><th id="1323">1323</th><td></td></tr>
<tr><th id="1324">1324</th><td>	<i>/* type, class, ttl and rdatalength fields */</i></td></tr>
<tr><th id="1325">1325</th><td>	<b>if</b>(!<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_available" title='sldns_buffer_available' data-ref="sldns_buffer_available" data-ref-filename="sldns_buffer_available">sldns_buffer_available</a>(<a class="local col3 ref" href="#423buf" title='buf' data-ref="423buf" data-ref-filename="423buf">buf</a>, <var>10</var>)) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="1326">1326</th><td>	<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_write_u16" title='sldns_buffer_write_u16' data-ref="sldns_buffer_write_u16" data-ref-filename="sldns_buffer_write_u16">sldns_buffer_write_u16</a>(<a class="local col3 ref" href="#423buf" title='buf' data-ref="423buf" data-ref-filename="423buf">buf</a>, <a class="local col7 ref" href="#427rr_type" title='rr_type' data-ref="427rr_type" data-ref-filename="427rr_type">rr_type</a>);</td></tr>
<tr><th id="1327">1327</th><td>	<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_write_u16" title='sldns_buffer_write_u16' data-ref="sldns_buffer_write_u16" data-ref-filename="sldns_buffer_write_u16">sldns_buffer_write_u16</a>(<a class="local col3 ref" href="#423buf" title='buf' data-ref="423buf" data-ref-filename="423buf">buf</a>, <a class="local col8 ref" href="#428rr_class" title='rr_class' data-ref="428rr_class" data-ref-filename="428rr_class">rr_class</a>);</td></tr>
<tr><th id="1328">1328</th><td>	<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_write_u32" title='sldns_buffer_write_u32' data-ref="sldns_buffer_write_u32" data-ref-filename="sldns_buffer_write_u32">sldns_buffer_write_u32</a>(<a class="local col3 ref" href="#423buf" title='buf' data-ref="423buf" data-ref-filename="423buf">buf</a>, <a class="local col9 ref" href="#429rr_ttl" title='rr_ttl' data-ref="429rr_ttl" data-ref-filename="429rr_ttl">rr_ttl</a>);</td></tr>
<tr><th id="1329">1329</th><td>	<a class="local col4 ref" href="#434rdlenpos" title='rdlenpos' data-ref="434rdlenpos" data-ref-filename="434rdlenpos">rdlenpos</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_position" title='sldns_buffer_position' data-ref="sldns_buffer_position" data-ref-filename="sldns_buffer_position">sldns_buffer_position</a>(<a class="local col3 ref" href="#423buf" title='buf' data-ref="423buf" data-ref-filename="423buf">buf</a>);</td></tr>
<tr><th id="1330">1330</th><td>	<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_write_u16" title='sldns_buffer_write_u16' data-ref="sldns_buffer_write_u16" data-ref-filename="sldns_buffer_write_u16">sldns_buffer_write_u16</a>(<a class="local col3 ref" href="#423buf" title='buf' data-ref="423buf" data-ref-filename="423buf">buf</a>, <var>0</var>); <i>/* rd length position */</i></td></tr>
<tr><th id="1331">1331</th><td></td></tr>
<tr><th id="1332">1332</th><td>	<i>/* decompress rdata */</i></td></tr>
<tr><th id="1333">1333</th><td>	<a class="local col7 ref" href="#437desc" title='desc' data-ref="437desc" data-ref-filename="437desc">desc</a> = <a class="ref fn" href="../sldns/rrdef.h.html#sldns_rr_descript" title='sldns_rr_descript' data-ref="sldns_rr_descript" data-ref-filename="sldns_rr_descript">sldns_rr_descript</a>(<a class="local col7 ref" href="#427rr_type" title='rr_type' data-ref="427rr_type" data-ref-filename="427rr_type">rr_type</a>);</td></tr>
<tr><th id="1334">1334</th><td>	<a class="local col6 ref" href="#436rd" title='rd' data-ref="436rd" data-ref-filename="436rd">rd</a> = <a class="local col0 ref" href="#430rr_data" title='rr_data' data-ref="430rr_data" data-ref-filename="430rr_data">rr_data</a>;</td></tr>
<tr><th id="1335">1335</th><td>	<a class="local col5 ref" href="#435rdlen" title='rdlen' data-ref="435rdlen" data-ref-filename="435rdlen">rdlen</a> = <a class="local col1 ref" href="#431rr_rdlen" title='rr_rdlen' data-ref="431rr_rdlen" data-ref-filename="431rr_rdlen">rr_rdlen</a>;</td></tr>
<tr><th id="1336">1336</th><td>	<b>if</b>(<a class="local col5 ref" href="#435rdlen" title='rdlen' data-ref="435rdlen" data-ref-filename="435rdlen">rdlen</a> &gt; <var>0</var> &amp;&amp; <a class="local col7 ref" href="#437desc" title='desc' data-ref="437desc" data-ref-filename="437desc">desc</a> &amp;&amp; <a class="local col7 ref" href="#437desc" title='desc' data-ref="437desc" data-ref-filename="437desc">desc</a>-&gt;<a class="ref field" href="../sldns/rrdef.h.html#sldns_struct_rr_descriptor::_dname_count" title='sldns_struct_rr_descriptor::_dname_count' data-ref="sldns_struct_rr_descriptor::_dname_count" data-ref-filename="sldns_struct_rr_descriptor.._dname_count">_dname_count</a> &gt; <var>0</var>) {</td></tr>
<tr><th id="1337">1337</th><td>		<em>int</em> <dfn class="local col8 decl" id="438count" title='count' data-type='int' data-ref="438count" data-ref-filename="438count">count</dfn> = (<em>int</em>)<a class="local col7 ref" href="#437desc" title='desc' data-ref="437desc" data-ref-filename="437desc">desc</a>-&gt;<a class="ref field" href="../sldns/rrdef.h.html#sldns_struct_rr_descriptor::_dname_count" title='sldns_struct_rr_descriptor::_dname_count' data-ref="sldns_struct_rr_descriptor::_dname_count" data-ref-filename="sldns_struct_rr_descriptor.._dname_count">_dname_count</a>;</td></tr>
<tr><th id="1338">1338</th><td>		<em>int</em> <dfn class="local col9 decl" id="439rdf" title='rdf' data-type='int' data-ref="439rdf" data-ref-filename="439rdf">rdf</dfn> = <var>0</var>;</td></tr>
<tr><th id="1339">1339</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col0 decl" id="440len" title='len' data-type='size_t' data-ref="440len" data-ref-filename="440len">len</dfn>; <i>/* how much rdata to plain copy */</i></td></tr>
<tr><th id="1340">1340</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col1 decl" id="441uncompressed_len" title='uncompressed_len' data-type='size_t' data-ref="441uncompressed_len" data-ref-filename="441uncompressed_len">uncompressed_len</dfn>, <dfn class="local col2 decl" id="442compressed_len" title='compressed_len' data-type='size_t' data-ref="442compressed_len" data-ref-filename="442compressed_len">compressed_len</dfn>;</td></tr>
<tr><th id="1341">1341</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col3 decl" id="443oldpos" title='oldpos' data-type='size_t' data-ref="443oldpos" data-ref-filename="443oldpos">oldpos</dfn>;</td></tr>
<tr><th id="1342">1342</th><td>		<i>/* decompress dnames. */</i></td></tr>
<tr><th id="1343">1343</th><td>		<b>while</b>(<a class="local col5 ref" href="#435rdlen" title='rdlen' data-ref="435rdlen" data-ref-filename="435rdlen">rdlen</a> &gt; <var>0</var> &amp;&amp; <a class="local col8 ref" href="#438count" title='count' data-ref="438count" data-ref-filename="438count">count</a>) {</td></tr>
<tr><th id="1344">1344</th><td>			<b>switch</b>(<a class="local col7 ref" href="#437desc" title='desc' data-ref="437desc" data-ref-filename="437desc">desc</a>-&gt;<a class="ref field" href="../sldns/rrdef.h.html#sldns_struct_rr_descriptor::_wireformat" title='sldns_struct_rr_descriptor::_wireformat' data-ref="sldns_struct_rr_descriptor::_wireformat" data-ref-filename="sldns_struct_rr_descriptor.._wireformat">_wireformat</a>[<a class="local col9 ref" href="#439rdf" title='rdf' data-ref="439rdf" data-ref-filename="439rdf">rdf</a>]) {</td></tr>
<tr><th id="1345">1345</th><td>			<b>case</b> <a class="enum" href="../sldns/rrdef.h.html#LDNS_RDF_TYPE_DNAME" title='LDNS_RDF_TYPE_DNAME' data-ref="LDNS_RDF_TYPE_DNAME" data-ref-filename="LDNS_RDF_TYPE_DNAME">LDNS_RDF_TYPE_DNAME</a>:</td></tr>
<tr><th id="1346">1346</th><td>				<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_set_position" title='sldns_buffer_set_position' data-ref="sldns_buffer_set_position" data-ref-filename="sldns_buffer_set_position">sldns_buffer_set_position</a>(&amp;<a class="local col2 ref" href="#432pktbuf" title='pktbuf' data-ref="432pktbuf" data-ref-filename="432pktbuf">pktbuf</a>,</td></tr>
<tr><th id="1347">1347</th><td>					(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>)(<a class="local col6 ref" href="#436rd" title='rd' data-ref="436rd" data-ref-filename="436rd">rd</a> -</td></tr>
<tr><th id="1348">1348</th><td>					<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_begin" title='sldns_buffer_begin' data-ref="sldns_buffer_begin" data-ref-filename="sldns_buffer_begin">sldns_buffer_begin</a>(&amp;<a class="local col2 ref" href="#432pktbuf" title='pktbuf' data-ref="432pktbuf" data-ref-filename="432pktbuf">pktbuf</a>)));</td></tr>
<tr><th id="1349">1349</th><td>				<a class="local col3 ref" href="#443oldpos" title='oldpos' data-ref="443oldpos" data-ref-filename="443oldpos">oldpos</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_position" title='sldns_buffer_position' data-ref="sldns_buffer_position" data-ref-filename="sldns_buffer_position">sldns_buffer_position</a>(&amp;<a class="local col2 ref" href="#432pktbuf" title='pktbuf' data-ref="432pktbuf" data-ref-filename="432pktbuf">pktbuf</a>);</td></tr>
<tr><th id="1350">1350</th><td>				<i>/* moves pktbuf to right after the</i></td></tr>
<tr><th id="1351">1351</th><td><i>				 * compressed dname, and returns uncompressed</i></td></tr>
<tr><th id="1352">1352</th><td><i>				 * dname length */</i></td></tr>
<tr><th id="1353">1353</th><td>				<a class="local col1 ref" href="#441uncompressed_len" title='uncompressed_len' data-ref="441uncompressed_len" data-ref-filename="441uncompressed_len">uncompressed_len</a> = <a class="ref fn" href="../util/data/dname.h.html#pkt_dname_len" title='pkt_dname_len' data-ref="pkt_dname_len" data-ref-filename="pkt_dname_len">pkt_dname_len</a>(&amp;<a class="local col2 ref" href="#432pktbuf" title='pktbuf' data-ref="432pktbuf" data-ref-filename="432pktbuf">pktbuf</a>);</td></tr>
<tr><th id="1354">1354</th><td>				<b>if</b>(!<a class="local col1 ref" href="#441uncompressed_len" title='uncompressed_len' data-ref="441uncompressed_len" data-ref-filename="441uncompressed_len">uncompressed_len</a>)</td></tr>
<tr><th id="1355">1355</th><td>					<b>return</b> <var>0</var>; <i>/* parse error in dname */</i></td></tr>
<tr><th id="1356">1356</th><td>				<b>if</b>(!<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_available" title='sldns_buffer_available' data-ref="sldns_buffer_available" data-ref-filename="sldns_buffer_available">sldns_buffer_available</a>(<a class="local col3 ref" href="#423buf" title='buf' data-ref="423buf" data-ref-filename="423buf">buf</a>,</td></tr>
<tr><th id="1357">1357</th><td>					<a class="local col1 ref" href="#441uncompressed_len" title='uncompressed_len' data-ref="441uncompressed_len" data-ref-filename="441uncompressed_len">uncompressed_len</a>))</td></tr>
<tr><th id="1358">1358</th><td>					<i>/* dname too long for buffer */</i></td></tr>
<tr><th id="1359">1359</th><td>					<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1360">1360</th><td>				<a class="ref fn" href="../util/data/dname.h.html#dname_pkt_copy" title='dname_pkt_copy' data-ref="dname_pkt_copy" data-ref-filename="dname_pkt_copy">dname_pkt_copy</a>(&amp;<a class="local col2 ref" href="#432pktbuf" title='pktbuf' data-ref="432pktbuf" data-ref-filename="432pktbuf">pktbuf</a>, </td></tr>
<tr><th id="1361">1361</th><td>					<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_current" title='sldns_buffer_current' data-ref="sldns_buffer_current" data-ref-filename="sldns_buffer_current">sldns_buffer_current</a>(<a class="local col3 ref" href="#423buf" title='buf' data-ref="423buf" data-ref-filename="423buf">buf</a>), <a class="local col6 ref" href="#436rd" title='rd' data-ref="436rd" data-ref-filename="436rd">rd</a>);</td></tr>
<tr><th id="1362">1362</th><td>				<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_skip" title='sldns_buffer_skip' data-ref="sldns_buffer_skip" data-ref-filename="sldns_buffer_skip">sldns_buffer_skip</a>(<a class="local col3 ref" href="#423buf" title='buf' data-ref="423buf" data-ref-filename="423buf">buf</a>, (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#ssize_t" title='ssize_t' data-type='int' data-ref="ssize_t" data-ref-filename="ssize_t">ssize_t</a>)<a class="local col1 ref" href="#441uncompressed_len" title='uncompressed_len' data-ref="441uncompressed_len" data-ref-filename="441uncompressed_len">uncompressed_len</a>);</td></tr>
<tr><th id="1363">1363</th><td>				<a class="local col2 ref" href="#442compressed_len" title='compressed_len' data-ref="442compressed_len" data-ref-filename="442compressed_len">compressed_len</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_position" title='sldns_buffer_position' data-ref="sldns_buffer_position" data-ref-filename="sldns_buffer_position">sldns_buffer_position</a>(</td></tr>
<tr><th id="1364">1364</th><td>					&amp;<a class="local col2 ref" href="#432pktbuf" title='pktbuf' data-ref="432pktbuf" data-ref-filename="432pktbuf">pktbuf</a>) - <a class="local col3 ref" href="#443oldpos" title='oldpos' data-ref="443oldpos" data-ref-filename="443oldpos">oldpos</a>;</td></tr>
<tr><th id="1365">1365</th><td>				<a class="local col6 ref" href="#436rd" title='rd' data-ref="436rd" data-ref-filename="436rd">rd</a> += <a class="local col2 ref" href="#442compressed_len" title='compressed_len' data-ref="442compressed_len" data-ref-filename="442compressed_len">compressed_len</a>;</td></tr>
<tr><th id="1366">1366</th><td>				<a class="local col5 ref" href="#435rdlen" title='rdlen' data-ref="435rdlen" data-ref-filename="435rdlen">rdlen</a> -= <a class="local col2 ref" href="#442compressed_len" title='compressed_len' data-ref="442compressed_len" data-ref-filename="442compressed_len">compressed_len</a>;</td></tr>
<tr><th id="1367">1367</th><td>				<a class="local col8 ref" href="#438count" title='count' data-ref="438count" data-ref-filename="438count">count</a>--;</td></tr>
<tr><th id="1368">1368</th><td>				<a class="local col0 ref" href="#440len" title='len' data-ref="440len" data-ref-filename="440len">len</a> = <var>0</var>;</td></tr>
<tr><th id="1369">1369</th><td>				<b>break</b>;</td></tr>
<tr><th id="1370">1370</th><td>			<b>case</b> <a class="enum" href="../sldns/rrdef.h.html#LDNS_RDF_TYPE_STR" title='LDNS_RDF_TYPE_STR' data-ref="LDNS_RDF_TYPE_STR" data-ref-filename="LDNS_RDF_TYPE_STR">LDNS_RDF_TYPE_STR</a>:</td></tr>
<tr><th id="1371">1371</th><td>				<a class="local col0 ref" href="#440len" title='len' data-ref="440len" data-ref-filename="440len">len</a> = <a class="local col6 ref" href="#436rd" title='rd' data-ref="436rd" data-ref-filename="436rd">rd</a>[<var>0</var>] + <var>1</var>;</td></tr>
<tr><th id="1372">1372</th><td>				<b>break</b>;</td></tr>
<tr><th id="1373">1373</th><td>			<b>default</b>:</td></tr>
<tr><th id="1374">1374</th><td>				<a class="local col0 ref" href="#440len" title='len' data-ref="440len" data-ref-filename="440len">len</a> = <a class="ref fn" href="../util/data/msgparse.h.html#get_rdf_size" title='get_rdf_size' data-ref="get_rdf_size" data-ref-filename="get_rdf_size">get_rdf_size</a>(<a class="local col7 ref" href="#437desc" title='desc' data-ref="437desc" data-ref-filename="437desc">desc</a>-&gt;<a class="ref field" href="../sldns/rrdef.h.html#sldns_struct_rr_descriptor::_wireformat" title='sldns_struct_rr_descriptor::_wireformat' data-ref="sldns_struct_rr_descriptor::_wireformat" data-ref-filename="sldns_struct_rr_descriptor.._wireformat">_wireformat</a>[<a class="local col9 ref" href="#439rdf" title='rdf' data-ref="439rdf" data-ref-filename="439rdf">rdf</a>]);</td></tr>
<tr><th id="1375">1375</th><td>				<b>break</b>;</td></tr>
<tr><th id="1376">1376</th><td>			}</td></tr>
<tr><th id="1377">1377</th><td>			<b>if</b>(<a class="local col0 ref" href="#440len" title='len' data-ref="440len" data-ref-filename="440len">len</a>) {</td></tr>
<tr><th id="1378">1378</th><td>				<b>if</b>(!<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_available" title='sldns_buffer_available' data-ref="sldns_buffer_available" data-ref-filename="sldns_buffer_available">sldns_buffer_available</a>(<a class="local col3 ref" href="#423buf" title='buf' data-ref="423buf" data-ref-filename="423buf">buf</a>, <a class="local col0 ref" href="#440len" title='len' data-ref="440len" data-ref-filename="440len">len</a>))</td></tr>
<tr><th id="1379">1379</th><td>					<b>return</b> <var>0</var>; <i>/* too long for buffer */</i></td></tr>
<tr><th id="1380">1380</th><td>				<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_write" title='sldns_buffer_write' data-ref="sldns_buffer_write" data-ref-filename="sldns_buffer_write">sldns_buffer_write</a>(<a class="local col3 ref" href="#423buf" title='buf' data-ref="423buf" data-ref-filename="423buf">buf</a>, <a class="local col6 ref" href="#436rd" title='rd' data-ref="436rd" data-ref-filename="436rd">rd</a>, <a class="local col0 ref" href="#440len" title='len' data-ref="440len" data-ref-filename="440len">len</a>);</td></tr>
<tr><th id="1381">1381</th><td>				<a class="local col6 ref" href="#436rd" title='rd' data-ref="436rd" data-ref-filename="436rd">rd</a> += <a class="local col0 ref" href="#440len" title='len' data-ref="440len" data-ref-filename="440len">len</a>;</td></tr>
<tr><th id="1382">1382</th><td>				<a class="local col5 ref" href="#435rdlen" title='rdlen' data-ref="435rdlen" data-ref-filename="435rdlen">rdlen</a> -= <a class="local col0 ref" href="#440len" title='len' data-ref="440len" data-ref-filename="440len">len</a>;</td></tr>
<tr><th id="1383">1383</th><td>			}</td></tr>
<tr><th id="1384">1384</th><td>			<a class="local col9 ref" href="#439rdf" title='rdf' data-ref="439rdf" data-ref-filename="439rdf">rdf</a>++;</td></tr>
<tr><th id="1385">1385</th><td>		}</td></tr>
<tr><th id="1386">1386</th><td>	}</td></tr>
<tr><th id="1387">1387</th><td>	<i>/* copy remaining data */</i></td></tr>
<tr><th id="1388">1388</th><td>	<b>if</b>(<a class="local col5 ref" href="#435rdlen" title='rdlen' data-ref="435rdlen" data-ref-filename="435rdlen">rdlen</a> &gt; <var>0</var>) {</td></tr>
<tr><th id="1389">1389</th><td>		<b>if</b>(!<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_available" title='sldns_buffer_available' data-ref="sldns_buffer_available" data-ref-filename="sldns_buffer_available">sldns_buffer_available</a>(<a class="local col3 ref" href="#423buf" title='buf' data-ref="423buf" data-ref-filename="423buf">buf</a>, <a class="local col5 ref" href="#435rdlen" title='rdlen' data-ref="435rdlen" data-ref-filename="435rdlen">rdlen</a>)) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="1390">1390</th><td>		<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_write" title='sldns_buffer_write' data-ref="sldns_buffer_write" data-ref-filename="sldns_buffer_write">sldns_buffer_write</a>(<a class="local col3 ref" href="#423buf" title='buf' data-ref="423buf" data-ref-filename="423buf">buf</a>, <a class="local col6 ref" href="#436rd" title='rd' data-ref="436rd" data-ref-filename="436rd">rd</a>, <a class="local col5 ref" href="#435rdlen" title='rdlen' data-ref="435rdlen" data-ref-filename="435rdlen">rdlen</a>);</td></tr>
<tr><th id="1391">1391</th><td>	}</td></tr>
<tr><th id="1392">1392</th><td>	<i>/* fixup rdlength */</i></td></tr>
<tr><th id="1393">1393</th><td>	<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_write_u16_at" title='sldns_buffer_write_u16_at' data-ref="sldns_buffer_write_u16_at" data-ref-filename="sldns_buffer_write_u16_at">sldns_buffer_write_u16_at</a>(<a class="local col3 ref" href="#423buf" title='buf' data-ref="423buf" data-ref-filename="423buf">buf</a>, <a class="local col4 ref" href="#434rdlenpos" title='rdlenpos' data-ref="434rdlenpos" data-ref-filename="434rdlenpos">rdlenpos</a>,</td></tr>
<tr><th id="1394">1394</th><td>		<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_position" title='sldns_buffer_position' data-ref="sldns_buffer_position" data-ref-filename="sldns_buffer_position">sldns_buffer_position</a>(<a class="local col3 ref" href="#423buf" title='buf' data-ref="423buf" data-ref-filename="423buf">buf</a>)-<a class="local col4 ref" href="#434rdlenpos" title='rdlenpos' data-ref="434rdlenpos" data-ref-filename="434rdlenpos">rdlenpos</a>-<var>2</var>);</td></tr>
<tr><th id="1395">1395</th><td>	<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_flip" title='sldns_buffer_flip' data-ref="sldns_buffer_flip" data-ref-filename="sldns_buffer_flip">sldns_buffer_flip</a>(<a class="local col3 ref" href="#423buf" title='buf' data-ref="423buf" data-ref-filename="423buf">buf</a>);</td></tr>
<tr><th id="1396">1396</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1397">1397</th><td>}</td></tr>
<tr><th id="1398">1398</th><td></td></tr>
<tr><th id="1399">1399</th><td><i class="doc" data-doc="az_insert_rr_decompress">/** insert RR into zone, from packet, decompress RR,</i></td></tr>
<tr><th id="1400">1400</th><td><i class="doc" data-doc="az_insert_rr_decompress"> * if duplicate is nonNULL set the flag but otherwise ignore duplicates */</i></td></tr>
<tr><th id="1401">1401</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="1402">1402</th><td><dfn class="tu decl def fn" id="az_insert_rr_decompress" title='az_insert_rr_decompress' data-type='int az_insert_rr_decompress(struct auth_zone * z, uint8_t * pkt, size_t pktlen, struct sldns_buffer * scratch_buffer, uint8_t * dname, uint16_t rr_type, uint16_t rr_class, uint32_t rr_ttl, uint8_t * rr_data, uint16_t rr_rdlen, int * duplicate)' data-ref="az_insert_rr_decompress" data-ref-filename="az_insert_rr_decompress">az_insert_rr_decompress</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col4 decl" id="444z" title='z' data-type='struct auth_zone *' data-ref="444z" data-ref-filename="444z">z</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col5 decl" id="445pkt" title='pkt' data-type='uint8_t *' data-ref="445pkt" data-ref-filename="445pkt">pkt</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col6 decl" id="446pktlen" title='pktlen' data-type='size_t' data-ref="446pktlen" data-ref-filename="446pktlen">pktlen</dfn>,</td></tr>
<tr><th id="1403">1403</th><td>	<b>struct</b> <a class="type" href="../sldns/sbuffer.h.html#sldns_buffer" title='sldns_buffer' data-ref="sldns_buffer" data-ref-filename="sldns_buffer">sldns_buffer</a>* <dfn class="local col7 decl" id="447scratch_buffer" title='scratch_buffer' data-type='struct sldns_buffer *' data-ref="447scratch_buffer" data-ref-filename="447scratch_buffer">scratch_buffer</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col8 decl" id="448dname" title='dname' data-type='uint8_t *' data-ref="448dname" data-ref-filename="448dname">dname</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col9 decl" id="449rr_type" title='rr_type' data-type='uint16_t' data-ref="449rr_type" data-ref-filename="449rr_type">rr_type</dfn>,</td></tr>
<tr><th id="1404">1404</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col0 decl" id="450rr_class" title='rr_class' data-type='uint16_t' data-ref="450rr_class" data-ref-filename="450rr_class">rr_class</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a> <dfn class="local col1 decl" id="451rr_ttl" title='rr_ttl' data-type='uint32_t' data-ref="451rr_ttl" data-ref-filename="451rr_ttl">rr_ttl</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col2 decl" id="452rr_data" title='rr_data' data-type='uint8_t *' data-ref="452rr_data" data-ref-filename="452rr_data">rr_data</dfn>,</td></tr>
<tr><th id="1405">1405</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col3 decl" id="453rr_rdlen" title='rr_rdlen' data-type='uint16_t' data-ref="453rr_rdlen" data-ref-filename="453rr_rdlen">rr_rdlen</dfn>, <em>int</em>* <dfn class="local col4 decl" id="454duplicate" title='duplicate' data-type='int *' data-ref="454duplicate" data-ref-filename="454duplicate">duplicate</dfn>)</td></tr>
<tr><th id="1406">1406</th><td>{</td></tr>
<tr><th id="1407">1407</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col5 decl" id="455rr" title='rr' data-type='uint8_t *' data-ref="455rr" data-ref-filename="455rr">rr</dfn>;</td></tr>
<tr><th id="1408">1408</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col6 decl" id="456rr_len" title='rr_len' data-type='size_t' data-ref="456rr_len" data-ref-filename="456rr_len">rr_len</dfn>;</td></tr>
<tr><th id="1409">1409</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col7 decl" id="457dname_len" title='dname_len' data-type='size_t' data-ref="457dname_len" data-ref-filename="457dname_len">dname_len</dfn>;</td></tr>
<tr><th id="1410">1410</th><td>	<b>if</b>(!<a class="tu ref fn" href="#decompress_rr_into_buffer" title='decompress_rr_into_buffer' data-use='c' data-ref="decompress_rr_into_buffer" data-ref-filename="decompress_rr_into_buffer">decompress_rr_into_buffer</a>(<a class="local col7 ref" href="#447scratch_buffer" title='scratch_buffer' data-ref="447scratch_buffer" data-ref-filename="447scratch_buffer">scratch_buffer</a>, <a class="local col5 ref" href="#445pkt" title='pkt' data-ref="445pkt" data-ref-filename="445pkt">pkt</a>, <a class="local col6 ref" href="#446pktlen" title='pktlen' data-ref="446pktlen" data-ref-filename="446pktlen">pktlen</a>, <a class="local col8 ref" href="#448dname" title='dname' data-ref="448dname" data-ref-filename="448dname">dname</a>,</td></tr>
<tr><th id="1411">1411</th><td>		<a class="local col9 ref" href="#449rr_type" title='rr_type' data-ref="449rr_type" data-ref-filename="449rr_type">rr_type</a>, <a class="local col0 ref" href="#450rr_class" title='rr_class' data-ref="450rr_class" data-ref-filename="450rr_class">rr_class</a>, <a class="local col1 ref" href="#451rr_ttl" title='rr_ttl' data-ref="451rr_ttl" data-ref-filename="451rr_ttl">rr_ttl</a>, <a class="local col2 ref" href="#452rr_data" title='rr_data' data-ref="452rr_data" data-ref-filename="452rr_data">rr_data</a>, <a class="local col3 ref" href="#453rr_rdlen" title='rr_rdlen' data-ref="453rr_rdlen" data-ref-filename="453rr_rdlen">rr_rdlen</a>)) {</td></tr>
<tr><th id="1412">1412</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"could not decompress RR"</q>);</td></tr>
<tr><th id="1413">1413</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1414">1414</th><td>	}</td></tr>
<tr><th id="1415">1415</th><td>	<a class="local col5 ref" href="#455rr" title='rr' data-ref="455rr" data-ref-filename="455rr">rr</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_begin" title='sldns_buffer_begin' data-ref="sldns_buffer_begin" data-ref-filename="sldns_buffer_begin">sldns_buffer_begin</a>(<a class="local col7 ref" href="#447scratch_buffer" title='scratch_buffer' data-ref="447scratch_buffer" data-ref-filename="447scratch_buffer">scratch_buffer</a>);</td></tr>
<tr><th id="1416">1416</th><td>	<a class="local col6 ref" href="#456rr_len" title='rr_len' data-ref="456rr_len" data-ref-filename="456rr_len">rr_len</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_limit" title='sldns_buffer_limit' data-ref="sldns_buffer_limit" data-ref-filename="sldns_buffer_limit">sldns_buffer_limit</a>(<a class="local col7 ref" href="#447scratch_buffer" title='scratch_buffer' data-ref="447scratch_buffer" data-ref-filename="447scratch_buffer">scratch_buffer</a>);</td></tr>
<tr><th id="1417">1417</th><td>	<a class="local col7 ref" href="#457dname_len" title='dname_len' data-ref="457dname_len" data-ref-filename="457dname_len">dname_len</a> = <a class="ref fn" href="../util/data/dname.h.html#dname_valid" title='dname_valid' data-ref="dname_valid" data-ref-filename="dname_valid">dname_valid</a>(<a class="local col5 ref" href="#455rr" title='rr' data-ref="455rr" data-ref-filename="455rr">rr</a>, <a class="local col6 ref" href="#456rr_len" title='rr_len' data-ref="456rr_len" data-ref-filename="456rr_len">rr_len</a>);</td></tr>
<tr><th id="1418">1418</th><td>	<b>return</b> <a class="tu ref fn" href="#az_insert_rr" title='az_insert_rr' data-use='c' data-ref="az_insert_rr" data-ref-filename="az_insert_rr">az_insert_rr</a>(<a class="local col4 ref" href="#444z" title='z' data-ref="444z" data-ref-filename="444z">z</a>, <a class="local col5 ref" href="#455rr" title='rr' data-ref="455rr" data-ref-filename="455rr">rr</a>, <a class="local col6 ref" href="#456rr_len" title='rr_len' data-ref="456rr_len" data-ref-filename="456rr_len">rr_len</a>, <a class="local col7 ref" href="#457dname_len" title='dname_len' data-ref="457dname_len" data-ref-filename="457dname_len">dname_len</a>, <a class="local col4 ref" href="#454duplicate" title='duplicate' data-ref="454duplicate" data-ref-filename="454duplicate">duplicate</a>);</td></tr>
<tr><th id="1419">1419</th><td>}</td></tr>
<tr><th id="1420">1420</th><td></td></tr>
<tr><th id="1421">1421</th><td><i class="doc" data-doc="az_remove_rr_decompress">/** remove RR from zone, from packet, decompress RR,</i></td></tr>
<tr><th id="1422">1422</th><td><i class="doc" data-doc="az_remove_rr_decompress"> * if nonexist is nonNULL set the flag but otherwise ignore nonexisting entries*/</i></td></tr>
<tr><th id="1423">1423</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="1424">1424</th><td><dfn class="tu decl def fn" id="az_remove_rr_decompress" title='az_remove_rr_decompress' data-type='int az_remove_rr_decompress(struct auth_zone * z, uint8_t * pkt, size_t pktlen, struct sldns_buffer * scratch_buffer, uint8_t * dname, uint16_t rr_type, uint16_t rr_class, uint32_t rr_ttl, uint8_t * rr_data, uint16_t rr_rdlen, int * nonexist)' data-ref="az_remove_rr_decompress" data-ref-filename="az_remove_rr_decompress">az_remove_rr_decompress</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col8 decl" id="458z" title='z' data-type='struct auth_zone *' data-ref="458z" data-ref-filename="458z">z</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col9 decl" id="459pkt" title='pkt' data-type='uint8_t *' data-ref="459pkt" data-ref-filename="459pkt">pkt</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col0 decl" id="460pktlen" title='pktlen' data-type='size_t' data-ref="460pktlen" data-ref-filename="460pktlen">pktlen</dfn>,</td></tr>
<tr><th id="1425">1425</th><td>	<b>struct</b> <a class="type" href="../sldns/sbuffer.h.html#sldns_buffer" title='sldns_buffer' data-ref="sldns_buffer" data-ref-filename="sldns_buffer">sldns_buffer</a>* <dfn class="local col1 decl" id="461scratch_buffer" title='scratch_buffer' data-type='struct sldns_buffer *' data-ref="461scratch_buffer" data-ref-filename="461scratch_buffer">scratch_buffer</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col2 decl" id="462dname" title='dname' data-type='uint8_t *' data-ref="462dname" data-ref-filename="462dname">dname</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col3 decl" id="463rr_type" title='rr_type' data-type='uint16_t' data-ref="463rr_type" data-ref-filename="463rr_type">rr_type</dfn>,</td></tr>
<tr><th id="1426">1426</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col4 decl" id="464rr_class" title='rr_class' data-type='uint16_t' data-ref="464rr_class" data-ref-filename="464rr_class">rr_class</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a> <dfn class="local col5 decl" id="465rr_ttl" title='rr_ttl' data-type='uint32_t' data-ref="465rr_ttl" data-ref-filename="465rr_ttl">rr_ttl</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col6 decl" id="466rr_data" title='rr_data' data-type='uint8_t *' data-ref="466rr_data" data-ref-filename="466rr_data">rr_data</dfn>,</td></tr>
<tr><th id="1427">1427</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col7 decl" id="467rr_rdlen" title='rr_rdlen' data-type='uint16_t' data-ref="467rr_rdlen" data-ref-filename="467rr_rdlen">rr_rdlen</dfn>, <em>int</em>* <dfn class="local col8 decl" id="468nonexist" title='nonexist' data-type='int *' data-ref="468nonexist" data-ref-filename="468nonexist">nonexist</dfn>)</td></tr>
<tr><th id="1428">1428</th><td>{</td></tr>
<tr><th id="1429">1429</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col9 decl" id="469rr" title='rr' data-type='uint8_t *' data-ref="469rr" data-ref-filename="469rr">rr</dfn>;</td></tr>
<tr><th id="1430">1430</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col0 decl" id="470rr_len" title='rr_len' data-type='size_t' data-ref="470rr_len" data-ref-filename="470rr_len">rr_len</dfn>;</td></tr>
<tr><th id="1431">1431</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col1 decl" id="471dname_len" title='dname_len' data-type='size_t' data-ref="471dname_len" data-ref-filename="471dname_len">dname_len</dfn>;</td></tr>
<tr><th id="1432">1432</th><td>	<b>if</b>(!<a class="tu ref fn" href="#decompress_rr_into_buffer" title='decompress_rr_into_buffer' data-use='c' data-ref="decompress_rr_into_buffer" data-ref-filename="decompress_rr_into_buffer">decompress_rr_into_buffer</a>(<a class="local col1 ref" href="#461scratch_buffer" title='scratch_buffer' data-ref="461scratch_buffer" data-ref-filename="461scratch_buffer">scratch_buffer</a>, <a class="local col9 ref" href="#459pkt" title='pkt' data-ref="459pkt" data-ref-filename="459pkt">pkt</a>, <a class="local col0 ref" href="#460pktlen" title='pktlen' data-ref="460pktlen" data-ref-filename="460pktlen">pktlen</a>, <a class="local col2 ref" href="#462dname" title='dname' data-ref="462dname" data-ref-filename="462dname">dname</a>,</td></tr>
<tr><th id="1433">1433</th><td>		<a class="local col3 ref" href="#463rr_type" title='rr_type' data-ref="463rr_type" data-ref-filename="463rr_type">rr_type</a>, <a class="local col4 ref" href="#464rr_class" title='rr_class' data-ref="464rr_class" data-ref-filename="464rr_class">rr_class</a>, <a class="local col5 ref" href="#465rr_ttl" title='rr_ttl' data-ref="465rr_ttl" data-ref-filename="465rr_ttl">rr_ttl</a>, <a class="local col6 ref" href="#466rr_data" title='rr_data' data-ref="466rr_data" data-ref-filename="466rr_data">rr_data</a>, <a class="local col7 ref" href="#467rr_rdlen" title='rr_rdlen' data-ref="467rr_rdlen" data-ref-filename="467rr_rdlen">rr_rdlen</a>)) {</td></tr>
<tr><th id="1434">1434</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"could not decompress RR"</q>);</td></tr>
<tr><th id="1435">1435</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1436">1436</th><td>	}</td></tr>
<tr><th id="1437">1437</th><td>	<a class="local col9 ref" href="#469rr" title='rr' data-ref="469rr" data-ref-filename="469rr">rr</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_begin" title='sldns_buffer_begin' data-ref="sldns_buffer_begin" data-ref-filename="sldns_buffer_begin">sldns_buffer_begin</a>(<a class="local col1 ref" href="#461scratch_buffer" title='scratch_buffer' data-ref="461scratch_buffer" data-ref-filename="461scratch_buffer">scratch_buffer</a>);</td></tr>
<tr><th id="1438">1438</th><td>	<a class="local col0 ref" href="#470rr_len" title='rr_len' data-ref="470rr_len" data-ref-filename="470rr_len">rr_len</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_limit" title='sldns_buffer_limit' data-ref="sldns_buffer_limit" data-ref-filename="sldns_buffer_limit">sldns_buffer_limit</a>(<a class="local col1 ref" href="#461scratch_buffer" title='scratch_buffer' data-ref="461scratch_buffer" data-ref-filename="461scratch_buffer">scratch_buffer</a>);</td></tr>
<tr><th id="1439">1439</th><td>	<a class="local col1 ref" href="#471dname_len" title='dname_len' data-ref="471dname_len" data-ref-filename="471dname_len">dname_len</a> = <a class="ref fn" href="../util/data/dname.h.html#dname_valid" title='dname_valid' data-ref="dname_valid" data-ref-filename="dname_valid">dname_valid</a>(<a class="local col9 ref" href="#469rr" title='rr' data-ref="469rr" data-ref-filename="469rr">rr</a>, <a class="local col0 ref" href="#470rr_len" title='rr_len' data-ref="470rr_len" data-ref-filename="470rr_len">rr_len</a>);</td></tr>
<tr><th id="1440">1440</th><td>	<b>return</b> <a class="tu ref fn" href="#az_remove_rr" title='az_remove_rr' data-use='c' data-ref="az_remove_rr" data-ref-filename="az_remove_rr">az_remove_rr</a>(<a class="local col8 ref" href="#458z" title='z' data-ref="458z" data-ref-filename="458z">z</a>, <a class="local col9 ref" href="#469rr" title='rr' data-ref="469rr" data-ref-filename="469rr">rr</a>, <a class="local col0 ref" href="#470rr_len" title='rr_len' data-ref="470rr_len" data-ref-filename="470rr_len">rr_len</a>, <a class="local col1 ref" href="#471dname_len" title='dname_len' data-ref="471dname_len" data-ref-filename="471dname_len">dname_len</a>, <a class="local col8 ref" href="#468nonexist" title='nonexist' data-ref="468nonexist" data-ref-filename="468nonexist">nonexist</a>);</td></tr>
<tr><th id="1441">1441</th><td>}</td></tr>
<tr><th id="1442">1442</th><td></td></tr>
<tr><th id="1443">1443</th><td><i class="doc" data-doc="az_parse_file">/** </i></td></tr>
<tr><th id="1444">1444</th><td><i class="doc" data-doc="az_parse_file"> * Parse zonefile</i></td></tr>
<tr><th id="1445">1445</th><td><i class="doc" data-doc="az_parse_file"> * <span class="command">@param</span> <span class="arg">z:</span> zone to read in.</i></td></tr>
<tr><th id="1446">1446</th><td><i class="doc" data-doc="az_parse_file"> * <span class="command">@param</span> <span class="arg">in:</span> file to read from (just opened).</i></td></tr>
<tr><th id="1447">1447</th><td><i class="doc" data-doc="az_parse_file"> * <span class="command">@param</span> <span class="arg">rr:</span> buffer to use for RRs, 64k.</i></td></tr>
<tr><th id="1448">1448</th><td><i class="doc" data-doc="az_parse_file"> *	passed so that recursive includes can use the same buffer and do</i></td></tr>
<tr><th id="1449">1449</th><td><i class="doc" data-doc="az_parse_file"> *	not grow the stack too much.</i></td></tr>
<tr><th id="1450">1450</th><td><i class="doc" data-doc="az_parse_file"> * <span class="command">@param</span> <span class="arg">rrbuflen:</span> sizeof rr buffer.</i></td></tr>
<tr><th id="1451">1451</th><td><i class="doc" data-doc="az_parse_file"> * <span class="command">@param</span> <span class="arg">state:</span> parse state with $ORIGIN, $TTL and 'prev-dname' and so on,</i></td></tr>
<tr><th id="1452">1452</th><td><i class="doc" data-doc="az_parse_file"> *	that is kept between includes.</i></td></tr>
<tr><th id="1453">1453</th><td><i class="doc" data-doc="az_parse_file"> *	The lineno is set at 1 and then increased by the function.</i></td></tr>
<tr><th id="1454">1454</th><td><i class="doc" data-doc="az_parse_file"> * <span class="command">@param</span> <span class="arg">fname:</span> file name.</i></td></tr>
<tr><th id="1455">1455</th><td><i class="doc" data-doc="az_parse_file"> * <span class="command">@param</span> <span class="arg">depth:</span> recursion depth for includes</i></td></tr>
<tr><th id="1456">1456</th><td><i class="doc" data-doc="az_parse_file"> * <span class="command">@param</span> <span class="arg">cfg:</span> config for chroot.</i></td></tr>
<tr><th id="1457">1457</th><td><i class="doc" data-doc="az_parse_file"> * returns false on failure, has printed an error message</i></td></tr>
<tr><th id="1458">1458</th><td><i class="doc" data-doc="az_parse_file"> */</i></td></tr>
<tr><th id="1459">1459</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="1460">1460</th><td><dfn class="tu decl def fn" id="az_parse_file" title='az_parse_file' data-type='int az_parse_file(struct auth_zone * z, FILE * in, uint8_t * rr, size_t rrbuflen, struct sldns_file_parse_state * state, char * fname, int depth, struct config_file * cfg)' data-ref="az_parse_file" data-ref-filename="az_parse_file">az_parse_file</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col2 decl" id="472z" title='z' data-type='struct auth_zone *' data-ref="472z" data-ref-filename="472z">z</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#FILE" title='FILE' data-type='struct __sFILE' data-ref="FILE" data-ref-filename="FILE">FILE</a>* <dfn class="local col3 decl" id="473in" title='in' data-type='FILE *' data-ref="473in" data-ref-filename="473in">in</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col4 decl" id="474rr" title='rr' data-type='uint8_t *' data-ref="474rr" data-ref-filename="474rr">rr</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col5 decl" id="475rrbuflen" title='rrbuflen' data-type='size_t' data-ref="475rrbuflen" data-ref-filename="475rrbuflen">rrbuflen</dfn>,</td></tr>
<tr><th id="1461">1461</th><td>	<b>struct</b> <a class="type" href="../sldns/str2wire.h.html#sldns_file_parse_state" title='sldns_file_parse_state' data-ref="sldns_file_parse_state" data-ref-filename="sldns_file_parse_state">sldns_file_parse_state</a>* <dfn class="local col6 decl" id="476state" title='state' data-type='struct sldns_file_parse_state *' data-ref="476state" data-ref-filename="476state">state</dfn>, <em>char</em>* <dfn class="local col7 decl" id="477fname" title='fname' data-type='char *' data-ref="477fname" data-ref-filename="477fname">fname</dfn>, <em>int</em> <dfn class="local col8 decl" id="478depth" title='depth' data-type='int' data-ref="478depth" data-ref-filename="478depth">depth</dfn>,</td></tr>
<tr><th id="1462">1462</th><td>	<b>struct</b> <a class="type" href="../util/config_file.h.html#config_file" title='config_file' data-ref="config_file" data-ref-filename="config_file">config_file</a>* <dfn class="local col9 decl" id="479cfg" title='cfg' data-type='struct config_file *' data-ref="479cfg" data-ref-filename="479cfg">cfg</dfn>)</td></tr>
<tr><th id="1463">1463</th><td>{</td></tr>
<tr><th id="1464">1464</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col0 decl" id="480rr_len" title='rr_len' data-type='size_t' data-ref="480rr_len" data-ref-filename="480rr_len">rr_len</dfn>, <dfn class="local col1 decl" id="481dname_len" title='dname_len' data-type='size_t' data-ref="481dname_len" data-ref-filename="481dname_len">dname_len</dfn>;</td></tr>
<tr><th id="1465">1465</th><td>	<em>int</em> <dfn class="local col2 decl" id="482status" title='status' data-type='int' data-ref="482status" data-ref-filename="482status">status</dfn>;</td></tr>
<tr><th id="1466">1466</th><td>	<a class="local col6 ref" href="#476state" title='state' data-ref="476state" data-ref-filename="476state">state</a>-&gt;<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::lineno" title='sldns_file_parse_state::lineno' data-ref="sldns_file_parse_state::lineno" data-ref-filename="sldns_file_parse_state..lineno">lineno</a> = <var>1</var>;</td></tr>
<tr><th id="1467">1467</th><td></td></tr>
<tr><th id="1468">1468</th><td>	<b>while</b>(!<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#492" title="(((in)-&gt;_flags &amp; 0x0020) != 0)" data-ref="_M/feof">feof</a>(<a class="local col3 ref" href="#473in" title='in' data-ref="473in" data-ref-filename="473in">in</a>)) {</td></tr>
<tr><th id="1469">1469</th><td>		<a class="local col0 ref" href="#480rr_len" title='rr_len' data-ref="480rr_len" data-ref-filename="480rr_len">rr_len</a> = <a class="local col5 ref" href="#475rrbuflen" title='rrbuflen' data-ref="475rrbuflen" data-ref-filename="475rrbuflen">rrbuflen</a>;</td></tr>
<tr><th id="1470">1470</th><td>		<a class="local col1 ref" href="#481dname_len" title='dname_len' data-ref="481dname_len" data-ref-filename="481dname_len">dname_len</a> = <var>0</var>;</td></tr>
<tr><th id="1471">1471</th><td>		<a class="local col2 ref" href="#482status" title='status' data-ref="482status" data-ref-filename="482status">status</a> = <a class="ref fn" href="../sldns/str2wire.h.html#sldns_fp2wire_rr_buf" title='sldns_fp2wire_rr_buf' data-ref="sldns_fp2wire_rr_buf" data-ref-filename="sldns_fp2wire_rr_buf">sldns_fp2wire_rr_buf</a>(<a class="local col3 ref" href="#473in" title='in' data-ref="473in" data-ref-filename="473in">in</a>, <a class="local col4 ref" href="#474rr" title='rr' data-ref="474rr" data-ref-filename="474rr">rr</a>, &amp;<a class="local col0 ref" href="#480rr_len" title='rr_len' data-ref="480rr_len" data-ref-filename="480rr_len">rr_len</a>, &amp;<a class="local col1 ref" href="#481dname_len" title='dname_len' data-ref="481dname_len" data-ref-filename="481dname_len">dname_len</a>,</td></tr>
<tr><th id="1472">1472</th><td>			<a class="local col6 ref" href="#476state" title='state' data-ref="476state" data-ref-filename="476state">state</a>);</td></tr>
<tr><th id="1473">1473</th><td>		<b>if</b>(<a class="local col2 ref" href="#482status" title='status' data-ref="482status" data-ref-filename="482status">status</a> == <a class="macro" href="../sldns/str2wire.h.html#205" title="371" data-ref="_M/LDNS_WIREPARSE_ERR_INCLUDE">LDNS_WIREPARSE_ERR_INCLUDE</a> &amp;&amp; <a class="local col0 ref" href="#480rr_len" title='rr_len' data-ref="480rr_len" data-ref-filename="480rr_len">rr_len</a> == <var>0</var>) {</td></tr>
<tr><th id="1474">1474</th><td>			<i>/* we have $INCLUDE or $something */</i></td></tr>
<tr><th id="1475">1475</th><td>			<b>if</b>(<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strncmp" title='strncmp' data-ref="strncmp" data-ref-filename="strncmp">strncmp</a>((<em>char</em>*)<a class="local col4 ref" href="#474rr" title='rr' data-ref="474rr" data-ref-filename="474rr">rr</a>, <q>"$INCLUDE "</q>, <var>9</var>) == <var>0</var> ||</td></tr>
<tr><th id="1476">1476</th><td>			   <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strncmp" title='strncmp' data-ref="strncmp" data-ref-filename="strncmp">strncmp</a>((<em>char</em>*)<a class="local col4 ref" href="#474rr" title='rr' data-ref="474rr" data-ref-filename="474rr">rr</a>, <q>"$INCLUDE\t"</q>, <var>9</var>) == <var>0</var>) {</td></tr>
<tr><th id="1477">1477</th><td>				<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#FILE" title='FILE' data-type='struct __sFILE' data-ref="FILE" data-ref-filename="FILE">FILE</a>* <dfn class="local col3 decl" id="483inc" title='inc' data-type='FILE *' data-ref="483inc" data-ref-filename="483inc">inc</dfn>;</td></tr>
<tr><th id="1478">1478</th><td>				<em>int</em> <dfn class="local col4 decl" id="484lineno_orig" title='lineno_orig' data-type='int' data-ref="484lineno_orig" data-ref-filename="484lineno_orig">lineno_orig</dfn> = <a class="local col6 ref" href="#476state" title='state' data-ref="476state" data-ref-filename="476state">state</a>-&gt;<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::lineno" title='sldns_file_parse_state::lineno' data-ref="sldns_file_parse_state::lineno" data-ref-filename="sldns_file_parse_state..lineno">lineno</a>;</td></tr>
<tr><th id="1479">1479</th><td>				<em>char</em>* <dfn class="local col5 decl" id="485incfile" title='incfile' data-type='char *' data-ref="485incfile" data-ref-filename="485incfile">incfile</dfn> = (<em>char</em>*)<a class="local col4 ref" href="#474rr" title='rr' data-ref="474rr" data-ref-filename="474rr">rr</a> + <var>8</var>;</td></tr>
<tr><th id="1480">1480</th><td>				<b>if</b>(<a class="local col8 ref" href="#478depth" title='depth' data-ref="478depth" data-ref-filename="478depth">depth</a> &gt; <a class="macro" href="#90" title="10" data-ref="_M/MAX_INCLUDE_DEPTH">MAX_INCLUDE_DEPTH</a>) {</td></tr>
<tr><th id="1481">1481</th><td>					<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"%s:%d max include depth"</q></td></tr>
<tr><th id="1482">1482</th><td>					  <q>"exceeded"</q>, <a class="local col7 ref" href="#477fname" title='fname' data-ref="477fname" data-ref-filename="477fname">fname</a>, <a class="local col6 ref" href="#476state" title='state' data-ref="476state" data-ref-filename="476state">state</a>-&gt;<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::lineno" title='sldns_file_parse_state::lineno' data-ref="sldns_file_parse_state::lineno" data-ref-filename="sldns_file_parse_state..lineno">lineno</a>);</td></tr>
<tr><th id="1483">1483</th><td>					<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1484">1484</th><td>				}</td></tr>
<tr><th id="1485">1485</th><td>				<i>/* skip spaces */</i></td></tr>
<tr><th id="1486">1486</th><td>				<b>while</b>(*<a class="local col5 ref" href="#485incfile" title='incfile' data-ref="485incfile" data-ref-filename="485incfile">incfile</a> == <kbd>' '</kbd> || *<a class="local col5 ref" href="#485incfile" title='incfile' data-ref="485incfile" data-ref-filename="485incfile">incfile</a> == <kbd>'\t'</kbd>)</td></tr>
<tr><th id="1487">1487</th><td>					<a class="local col5 ref" href="#485incfile" title='incfile' data-ref="485incfile" data-ref-filename="485incfile">incfile</a>++;</td></tr>
<tr><th id="1488">1488</th><td>				<i>/* adjust for chroot on include file */</i></td></tr>
<tr><th id="1489">1489</th><td>				<b>if</b>(<a class="local col9 ref" href="#479cfg" title='cfg' data-ref="479cfg" data-ref-filename="479cfg">cfg</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_file::chrootdir" title='config_file::chrootdir' data-ref="config_file::chrootdir" data-ref-filename="config_file..chrootdir">chrootdir</a> &amp;&amp; <a class="local col9 ref" href="#479cfg" title='cfg' data-ref="479cfg" data-ref-filename="479cfg">cfg</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_file::chrootdir" title='config_file::chrootdir' data-ref="config_file::chrootdir" data-ref-filename="config_file..chrootdir">chrootdir</a>[<var>0</var>] &amp;&amp;</td></tr>
<tr><th id="1490">1490</th><td>					<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strncmp" title='strncmp' data-ref="strncmp" data-ref-filename="strncmp">strncmp</a>(<a class="local col5 ref" href="#485incfile" title='incfile' data-ref="485incfile" data-ref-filename="485incfile">incfile</a>, <a class="local col9 ref" href="#479cfg" title='cfg' data-ref="479cfg" data-ref-filename="479cfg">cfg</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_file::chrootdir" title='config_file::chrootdir' data-ref="config_file::chrootdir" data-ref-filename="config_file..chrootdir">chrootdir</a>,</td></tr>
<tr><th id="1491">1491</th><td>						<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strlen" title='strlen' data-ref="strlen" data-ref-filename="strlen">strlen</a>(<a class="local col9 ref" href="#479cfg" title='cfg' data-ref="479cfg" data-ref-filename="479cfg">cfg</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_file::chrootdir" title='config_file::chrootdir' data-ref="config_file::chrootdir" data-ref-filename="config_file..chrootdir">chrootdir</a>)) == <var>0</var>)</td></tr>
<tr><th id="1492">1492</th><td>					<a class="local col5 ref" href="#485incfile" title='incfile' data-ref="485incfile" data-ref-filename="485incfile">incfile</a> += <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strlen" title='strlen' data-ref="strlen" data-ref-filename="strlen">strlen</a>(<a class="local col9 ref" href="#479cfg" title='cfg' data-ref="479cfg" data-ref-filename="479cfg">cfg</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_file::chrootdir" title='config_file::chrootdir' data-ref="config_file::chrootdir" data-ref-filename="config_file..chrootdir">chrootdir</a>);</td></tr>
<tr><th id="1493">1493</th><td>				<a class="local col5 ref" href="#485incfile" title='incfile' data-ref="485incfile" data-ref-filename="485incfile">incfile</a> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strdup" title='strdup' data-ref="strdup" data-ref-filename="strdup">strdup</a>(<a class="local col5 ref" href="#485incfile" title='incfile' data-ref="485incfile" data-ref-filename="485incfile">incfile</a>);</td></tr>
<tr><th id="1494">1494</th><td>				<b>if</b>(!<a class="local col5 ref" href="#485incfile" title='incfile' data-ref="485incfile" data-ref-filename="485incfile">incfile</a>) {</td></tr>
<tr><th id="1495">1495</th><td>					<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"malloc failure"</q>);</td></tr>
<tr><th id="1496">1496</th><td>					<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1497">1497</th><td>				}</td></tr>
<tr><th id="1498">1498</th><td>				<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"opening $INCLUDE %s"</q>,</td></tr>
<tr><th id="1499">1499</th><td>					<a class="local col5 ref" href="#485incfile" title='incfile' data-ref="485incfile" data-ref-filename="485incfile">incfile</a>);</td></tr>
<tr><th id="1500">1500</th><td>				<a class="local col3 ref" href="#483inc" title='inc' data-ref="483inc" data-ref-filename="483inc">inc</a> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#fopen" title='fopen' data-ref="fopen" data-ref-filename="fopen">fopen</a>(<a class="local col5 ref" href="#485incfile" title='incfile' data-ref="485incfile" data-ref-filename="485incfile">incfile</a>, <q>"r"</q>);</td></tr>
<tr><th id="1501">1501</th><td>				<b>if</b>(!<a class="local col3 ref" href="#483inc" title='inc' data-ref="483inc" data-ref-filename="483inc">inc</a>) {</td></tr>
<tr><th id="1502">1502</th><td>					<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"%s:%d cannot open include "</q></td></tr>
<tr><th id="1503">1503</th><td>						<q>"file %s: %s"</q>, <a class="local col7 ref" href="#477fname" title='fname' data-ref="477fname" data-ref-filename="477fname">fname</a>,</td></tr>
<tr><th id="1504">1504</th><td>						<a class="local col4 ref" href="#484lineno_orig" title='lineno_orig' data-ref="484lineno_orig" data-ref-filename="484lineno_orig">lineno_orig</a>, <a class="local col5 ref" href="#485incfile" title='incfile' data-ref="485incfile" data-ref-filename="485incfile">incfile</a>,</td></tr>
<tr><th id="1505">1505</th><td>						<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strerror" title='strerror' data-ref="strerror" data-ref-filename="strerror">strerror</a>(<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/errno.h.html#55" title="(*__errno())" data-ref="_M/errno">errno</a>));</td></tr>
<tr><th id="1506">1506</th><td>					<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col5 ref" href="#485incfile" title='incfile' data-ref="485incfile" data-ref-filename="485incfile">incfile</a>);</td></tr>
<tr><th id="1507">1507</th><td>					<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1508">1508</th><td>				}</td></tr>
<tr><th id="1509">1509</th><td>				<i>/* recurse read that file now */</i></td></tr>
<tr><th id="1510">1510</th><td>				<b>if</b>(!<a class="tu ref fn" href="#az_parse_file" title='az_parse_file' data-use='c' data-ref="az_parse_file" data-ref-filename="az_parse_file">az_parse_file</a>(<a class="local col2 ref" href="#472z" title='z' data-ref="472z" data-ref-filename="472z">z</a>, <a class="local col3 ref" href="#483inc" title='inc' data-ref="483inc" data-ref-filename="483inc">inc</a>, <a class="local col4 ref" href="#474rr" title='rr' data-ref="474rr" data-ref-filename="474rr">rr</a>, <a class="local col5 ref" href="#475rrbuflen" title='rrbuflen' data-ref="475rrbuflen" data-ref-filename="475rrbuflen">rrbuflen</a>,</td></tr>
<tr><th id="1511">1511</th><td>					<a class="local col6 ref" href="#476state" title='state' data-ref="476state" data-ref-filename="476state">state</a>, <a class="local col5 ref" href="#485incfile" title='incfile' data-ref="485incfile" data-ref-filename="485incfile">incfile</a>, <a class="local col8 ref" href="#478depth" title='depth' data-ref="478depth" data-ref-filename="478depth">depth</a>+<var>1</var>, <a class="local col9 ref" href="#479cfg" title='cfg' data-ref="479cfg" data-ref-filename="479cfg">cfg</a>)) {</td></tr>
<tr><th id="1512">1512</th><td>					<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"%s:%d cannot parse include "</q></td></tr>
<tr><th id="1513">1513</th><td>						<q>"file %s"</q>, <a class="local col7 ref" href="#477fname" title='fname' data-ref="477fname" data-ref-filename="477fname">fname</a>,</td></tr>
<tr><th id="1514">1514</th><td>						<a class="local col4 ref" href="#484lineno_orig" title='lineno_orig' data-ref="484lineno_orig" data-ref-filename="484lineno_orig">lineno_orig</a>, <a class="local col5 ref" href="#485incfile" title='incfile' data-ref="485incfile" data-ref-filename="485incfile">incfile</a>);</td></tr>
<tr><th id="1515">1515</th><td>					<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#fclose" title='fclose' data-ref="fclose" data-ref-filename="fclose">fclose</a>(<a class="local col3 ref" href="#483inc" title='inc' data-ref="483inc" data-ref-filename="483inc">inc</a>);</td></tr>
<tr><th id="1516">1516</th><td>					<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col5 ref" href="#485incfile" title='incfile' data-ref="485incfile" data-ref-filename="485incfile">incfile</a>);</td></tr>
<tr><th id="1517">1517</th><td>					<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1518">1518</th><td>				}</td></tr>
<tr><th id="1519">1519</th><td>				<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#fclose" title='fclose' data-ref="fclose" data-ref-filename="fclose">fclose</a>(<a class="local col3 ref" href="#483inc" title='inc' data-ref="483inc" data-ref-filename="483inc">inc</a>);</td></tr>
<tr><th id="1520">1520</th><td>				<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"done with $INCLUDE %s"</q>,</td></tr>
<tr><th id="1521">1521</th><td>					<a class="local col5 ref" href="#485incfile" title='incfile' data-ref="485incfile" data-ref-filename="485incfile">incfile</a>);</td></tr>
<tr><th id="1522">1522</th><td>				<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col5 ref" href="#485incfile" title='incfile' data-ref="485incfile" data-ref-filename="485incfile">incfile</a>);</td></tr>
<tr><th id="1523">1523</th><td>				<a class="local col6 ref" href="#476state" title='state' data-ref="476state" data-ref-filename="476state">state</a>-&gt;<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::lineno" title='sldns_file_parse_state::lineno' data-ref="sldns_file_parse_state::lineno" data-ref-filename="sldns_file_parse_state..lineno">lineno</a> = <a class="local col4 ref" href="#484lineno_orig" title='lineno_orig' data-ref="484lineno_orig" data-ref-filename="484lineno_orig">lineno_orig</a>;</td></tr>
<tr><th id="1524">1524</th><td>			}</td></tr>
<tr><th id="1525">1525</th><td>			<b>continue</b>;</td></tr>
<tr><th id="1526">1526</th><td>		}</td></tr>
<tr><th id="1527">1527</th><td>		<b>if</b>(<a class="local col2 ref" href="#482status" title='status' data-ref="482status" data-ref-filename="482status">status</a> != <var>0</var>) {</td></tr>
<tr><th id="1528">1528</th><td>			<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"parse error %s %d:%d: %s"</q>, <a class="local col7 ref" href="#477fname" title='fname' data-ref="477fname" data-ref-filename="477fname">fname</a>,</td></tr>
<tr><th id="1529">1529</th><td>				<a class="local col6 ref" href="#476state" title='state' data-ref="476state" data-ref-filename="476state">state</a>-&gt;<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::lineno" title='sldns_file_parse_state::lineno' data-ref="sldns_file_parse_state::lineno" data-ref-filename="sldns_file_parse_state..lineno">lineno</a>, <a class="macro" href="../sldns/str2wire.h.html#173" title="(((status)&amp;~0x0fff)&gt;&gt;12)" data-ref="_M/LDNS_WIREPARSE_OFFSET">LDNS_WIREPARSE_OFFSET</a>(<a class="local col2 ref" href="#482status" title='status' data-ref="482status" data-ref-filename="482status">status</a>),</td></tr>
<tr><th id="1530">1530</th><td>				<a class="ref fn" href="../sldns/str2wire.h.html#sldns_get_errorstr_parse" title='sldns_get_errorstr_parse' data-ref="sldns_get_errorstr_parse" data-ref-filename="sldns_get_errorstr_parse">sldns_get_errorstr_parse</a>(<a class="local col2 ref" href="#482status" title='status' data-ref="482status" data-ref-filename="482status">status</a>));</td></tr>
<tr><th id="1531">1531</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1532">1532</th><td>		}</td></tr>
<tr><th id="1533">1533</th><td>		<b>if</b>(<a class="local col0 ref" href="#480rr_len" title='rr_len' data-ref="480rr_len" data-ref-filename="480rr_len">rr_len</a> == <var>0</var>) {</td></tr>
<tr><th id="1534">1534</th><td>			<i>/* EMPTY line, TTL or ORIGIN */</i></td></tr>
<tr><th id="1535">1535</th><td>			<b>continue</b>;</td></tr>
<tr><th id="1536">1536</th><td>		}</td></tr>
<tr><th id="1537">1537</th><td>		<i>/* insert wirerr in rrbuf */</i></td></tr>
<tr><th id="1538">1538</th><td>		<b>if</b>(!<a class="tu ref fn" href="#az_insert_rr" title='az_insert_rr' data-use='c' data-ref="az_insert_rr" data-ref-filename="az_insert_rr">az_insert_rr</a>(<a class="local col2 ref" href="#472z" title='z' data-ref="472z" data-ref-filename="472z">z</a>, <a class="local col4 ref" href="#474rr" title='rr' data-ref="474rr" data-ref-filename="474rr">rr</a>, <a class="local col0 ref" href="#480rr_len" title='rr_len' data-ref="480rr_len" data-ref-filename="480rr_len">rr_len</a>, <a class="local col1 ref" href="#481dname_len" title='dname_len' data-ref="481dname_len" data-ref-filename="481dname_len">dname_len</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>)) {</td></tr>
<tr><th id="1539">1539</th><td>			<em>char</em> <dfn class="local col6 decl" id="486buf" title='buf' data-type='char [17]' data-ref="486buf" data-ref-filename="486buf">buf</dfn>[<var>17</var>];</td></tr>
<tr><th id="1540">1540</th><td>			<a class="ref fn" href="../sldns/wire2str.h.html#sldns_wire2str_type_buf" title='sldns_wire2str_type_buf' data-ref="sldns_wire2str_type_buf" data-ref-filename="sldns_wire2str_type_buf">sldns_wire2str_type_buf</a>(<a class="ref fn" href="../sldns/str2wire.h.html#sldns_wirerr_get_type" title='sldns_wirerr_get_type' data-ref="sldns_wirerr_get_type" data-ref-filename="sldns_wirerr_get_type">sldns_wirerr_get_type</a>(<a class="local col4 ref" href="#474rr" title='rr' data-ref="474rr" data-ref-filename="474rr">rr</a>,</td></tr>
<tr><th id="1541">1541</th><td>				<a class="local col0 ref" href="#480rr_len" title='rr_len' data-ref="480rr_len" data-ref-filename="480rr_len">rr_len</a>, <a class="local col1 ref" href="#481dname_len" title='dname_len' data-ref="481dname_len" data-ref-filename="481dname_len">dname_len</a>), <a class="local col6 ref" href="#486buf" title='buf' data-ref="486buf" data-ref-filename="486buf">buf</a>, <b>sizeof</b>(<a class="local col6 ref" href="#486buf" title='buf' data-ref="486buf" data-ref-filename="486buf">buf</a>));</td></tr>
<tr><th id="1542">1542</th><td>			<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"%s:%d cannot insert RR of type %s"</q>,</td></tr>
<tr><th id="1543">1543</th><td>				<a class="local col7 ref" href="#477fname" title='fname' data-ref="477fname" data-ref-filename="477fname">fname</a>, <a class="local col6 ref" href="#476state" title='state' data-ref="476state" data-ref-filename="476state">state</a>-&gt;<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::lineno" title='sldns_file_parse_state::lineno' data-ref="sldns_file_parse_state::lineno" data-ref-filename="sldns_file_parse_state..lineno">lineno</a>, <a class="local col6 ref" href="#486buf" title='buf' data-ref="486buf" data-ref-filename="486buf">buf</a>);</td></tr>
<tr><th id="1544">1544</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1545">1545</th><td>		}</td></tr>
<tr><th id="1546">1546</th><td>	}</td></tr>
<tr><th id="1547">1547</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1548">1548</th><td>}</td></tr>
<tr><th id="1549">1549</th><td></td></tr>
<tr><th id="1550">1550</th><td><em>int</em></td></tr>
<tr><th id="1551">1551</th><td><dfn class="decl def fn" id="auth_zone_read_zonefile" title='auth_zone_read_zonefile' data-ref="auth_zone_read_zonefile" data-ref-filename="auth_zone_read_zonefile">auth_zone_read_zonefile</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col7 decl" id="487z" title='z' data-type='struct auth_zone *' data-ref="487z" data-ref-filename="487z">z</dfn>, <b>struct</b> <a class="type" href="../util/config_file.h.html#config_file" title='config_file' data-ref="config_file" data-ref-filename="config_file">config_file</a>* <dfn class="local col8 decl" id="488cfg" title='cfg' data-type='struct config_file *' data-ref="488cfg" data-ref-filename="488cfg">cfg</dfn>)</td></tr>
<tr><th id="1552">1552</th><td>{</td></tr>
<tr><th id="1553">1553</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a> <dfn class="local col9 decl" id="489rr" title='rr' data-type='uint8_t [65535]' data-ref="489rr" data-ref-filename="489rr">rr</dfn>[<a class="macro" href="../sldns/str2wire.h.html#27" title="65535" data-ref="_M/LDNS_RR_BUF_SIZE">LDNS_RR_BUF_SIZE</a>];</td></tr>
<tr><th id="1554">1554</th><td>	<b>struct</b> <a class="type" href="../sldns/str2wire.h.html#sldns_file_parse_state" title='sldns_file_parse_state' data-ref="sldns_file_parse_state" data-ref-filename="sldns_file_parse_state">sldns_file_parse_state</a> <dfn class="local col0 decl" id="490state" title='state' data-type='struct sldns_file_parse_state' data-ref="490state" data-ref-filename="490state">state</dfn>;</td></tr>
<tr><th id="1555">1555</th><td>	<em>char</em>* <dfn class="local col1 decl" id="491zfilename" title='zfilename' data-type='char *' data-ref="491zfilename" data-ref-filename="491zfilename">zfilename</dfn>;</td></tr>
<tr><th id="1556">1556</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#FILE" title='FILE' data-type='struct __sFILE' data-ref="FILE" data-ref-filename="FILE">FILE</a>* <dfn class="local col2 decl" id="492in" title='in' data-type='FILE *' data-ref="492in" data-ref-filename="492in">in</dfn>;</td></tr>
<tr><th id="1557">1557</th><td>	<b>if</b>(!<a class="local col7 ref" href="#487z" title='z' data-ref="487z" data-ref-filename="487z">z</a> || !<a class="local col7 ref" href="#487z" title='z' data-ref="487z" data-ref-filename="487z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::zonefile" title='auth_zone::zonefile' data-ref="auth_zone::zonefile" data-ref-filename="auth_zone..zonefile">zonefile</a> || <a class="local col7 ref" href="#487z" title='z' data-ref="487z" data-ref-filename="487z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::zonefile" title='auth_zone::zonefile' data-ref="auth_zone::zonefile" data-ref-filename="auth_zone..zonefile">zonefile</a>[<var>0</var>]==<var>0</var>)</td></tr>
<tr><th id="1558">1558</th><td>		<b>return</b> <var>1</var>; <i>/* no file, or "", nothing to read */</i></td></tr>
<tr><th id="1559">1559</th><td>	</td></tr>
<tr><th id="1560">1560</th><td>	<a class="local col1 ref" href="#491zfilename" title='zfilename' data-ref="491zfilename" data-ref-filename="491zfilename">zfilename</a> = <a class="local col7 ref" href="#487z" title='z' data-ref="487z" data-ref-filename="487z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::zonefile" title='auth_zone::zonefile' data-ref="auth_zone::zonefile" data-ref-filename="auth_zone..zonefile">zonefile</a>;</td></tr>
<tr><th id="1561">1561</th><td>	<b>if</b>(<a class="local col8 ref" href="#488cfg" title='cfg' data-ref="488cfg" data-ref-filename="488cfg">cfg</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_file::chrootdir" title='config_file::chrootdir' data-ref="config_file::chrootdir" data-ref-filename="config_file..chrootdir">chrootdir</a> &amp;&amp; <a class="local col8 ref" href="#488cfg" title='cfg' data-ref="488cfg" data-ref-filename="488cfg">cfg</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_file::chrootdir" title='config_file::chrootdir' data-ref="config_file::chrootdir" data-ref-filename="config_file..chrootdir">chrootdir</a>[<var>0</var>] &amp;&amp; <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strncmp" title='strncmp' data-ref="strncmp" data-ref-filename="strncmp">strncmp</a>(<a class="local col1 ref" href="#491zfilename" title='zfilename' data-ref="491zfilename" data-ref-filename="491zfilename">zfilename</a>,</td></tr>
<tr><th id="1562">1562</th><td>		<a class="local col8 ref" href="#488cfg" title='cfg' data-ref="488cfg" data-ref-filename="488cfg">cfg</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_file::chrootdir" title='config_file::chrootdir' data-ref="config_file::chrootdir" data-ref-filename="config_file..chrootdir">chrootdir</a>, <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strlen" title='strlen' data-ref="strlen" data-ref-filename="strlen">strlen</a>(<a class="local col8 ref" href="#488cfg" title='cfg' data-ref="488cfg" data-ref-filename="488cfg">cfg</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_file::chrootdir" title='config_file::chrootdir' data-ref="config_file::chrootdir" data-ref-filename="config_file..chrootdir">chrootdir</a>)) == <var>0</var>)</td></tr>
<tr><th id="1563">1563</th><td>		<a class="local col1 ref" href="#491zfilename" title='zfilename' data-ref="491zfilename" data-ref-filename="491zfilename">zfilename</a> += <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strlen" title='strlen' data-ref="strlen" data-ref-filename="strlen">strlen</a>(<a class="local col8 ref" href="#488cfg" title='cfg' data-ref="488cfg" data-ref-filename="488cfg">cfg</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_file::chrootdir" title='config_file::chrootdir' data-ref="config_file::chrootdir" data-ref-filename="config_file..chrootdir">chrootdir</a>);</td></tr>
<tr><th id="1564">1564</th><td>	<b>if</b>(<a class="ref" href="../util/log.h.html#verbosity" title='verbosity' data-ref="verbosity" data-ref-filename="verbosity">verbosity</a> &gt;= <a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>) {</td></tr>
<tr><th id="1565">1565</th><td>		<em>char</em> <dfn class="local col3 decl" id="493nm" title='nm' data-type='char [256]' data-ref="493nm" data-ref-filename="493nm">nm</dfn>[<var>255</var>+<var>1</var>];</td></tr>
<tr><th id="1566">1566</th><td>		<a class="ref fn" href="../util/data/dname.h.html#dname_str" title='dname_str' data-ref="dname_str" data-ref-filename="dname_str">dname_str</a>(<a class="local col7 ref" href="#487z" title='z' data-ref="487z" data-ref-filename="487z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::name" title='auth_zone::name' data-ref="auth_zone::name" data-ref-filename="auth_zone..name">name</a>, <a class="local col3 ref" href="#493nm" title='nm' data-ref="493nm" data-ref-filename="493nm">nm</a>);</td></tr>
<tr><th id="1567">1567</th><td>		<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"read zonefile %s for %s"</q>, <a class="local col1 ref" href="#491zfilename" title='zfilename' data-ref="491zfilename" data-ref-filename="491zfilename">zfilename</a>, <a class="local col3 ref" href="#493nm" title='nm' data-ref="493nm" data-ref-filename="493nm">nm</a>);</td></tr>
<tr><th id="1568">1568</th><td>	}</td></tr>
<tr><th id="1569">1569</th><td>	<a class="local col2 ref" href="#492in" title='in' data-ref="492in" data-ref-filename="492in">in</a> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#fopen" title='fopen' data-ref="fopen" data-ref-filename="fopen">fopen</a>(<a class="local col1 ref" href="#491zfilename" title='zfilename' data-ref="491zfilename" data-ref-filename="491zfilename">zfilename</a>, <q>"r"</q>);</td></tr>
<tr><th id="1570">1570</th><td>	<b>if</b>(!<a class="local col2 ref" href="#492in" title='in' data-ref="492in" data-ref-filename="492in">in</a>) {</td></tr>
<tr><th id="1571">1571</th><td>		<em>char</em>* <dfn class="local col4 decl" id="494n" title='n' data-type='char *' data-ref="494n" data-ref-filename="494n">n</dfn> = <a class="ref fn" href="../sldns/wire2str.h.html#sldns_wire2str_dname" title='sldns_wire2str_dname' data-ref="sldns_wire2str_dname" data-ref-filename="sldns_wire2str_dname">sldns_wire2str_dname</a>(<a class="local col7 ref" href="#487z" title='z' data-ref="487z" data-ref-filename="487z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::name" title='auth_zone::name' data-ref="auth_zone::name" data-ref-filename="auth_zone..name">name</a>, <a class="local col7 ref" href="#487z" title='z' data-ref="487z" data-ref-filename="487z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::namelen" title='auth_zone::namelen' data-ref="auth_zone::namelen" data-ref-filename="auth_zone..namelen">namelen</a>);</td></tr>
<tr><th id="1572">1572</th><td>		<b>if</b>(<a class="local col7 ref" href="#487z" title='z' data-ref="487z" data-ref-filename="487z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::zone_is_slave" title='auth_zone::zone_is_slave' data-ref="auth_zone::zone_is_slave" data-ref-filename="auth_zone..zone_is_slave">zone_is_slave</a> &amp;&amp; <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/errno.h.html#55" title="(*__errno())" data-ref="_M/errno">errno</a> == <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/errno.h.html#43" title="2" data-ref="_M/ENOENT">ENOENT</a>) {</td></tr>
<tr><th id="1573">1573</th><td>			<i>/* we fetch the zone contents later, no file yet */</i></td></tr>
<tr><th id="1574">1574</th><td>			<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"no zonefile %s for %s"</q>,</td></tr>
<tr><th id="1575">1575</th><td>				<a class="local col1 ref" href="#491zfilename" title='zfilename' data-ref="491zfilename" data-ref-filename="491zfilename">zfilename</a>, <a class="local col4 ref" href="#494n" title='n' data-ref="494n" data-ref-filename="494n">n</a>?<a class="local col4 ref" href="#494n" title='n' data-ref="494n" data-ref-filename="494n">n</a>:<q>"error"</q>);</td></tr>
<tr><th id="1576">1576</th><td>			<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col4 ref" href="#494n" title='n' data-ref="494n" data-ref-filename="494n">n</a>);</td></tr>
<tr><th id="1577">1577</th><td>			<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1578">1578</th><td>		}</td></tr>
<tr><th id="1579">1579</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"cannot open zonefile %s for %s: %s"</q>,</td></tr>
<tr><th id="1580">1580</th><td>			<a class="local col1 ref" href="#491zfilename" title='zfilename' data-ref="491zfilename" data-ref-filename="491zfilename">zfilename</a>, <a class="local col4 ref" href="#494n" title='n' data-ref="494n" data-ref-filename="494n">n</a>?<a class="local col4 ref" href="#494n" title='n' data-ref="494n" data-ref-filename="494n">n</a>:<q>"error"</q>, <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strerror" title='strerror' data-ref="strerror" data-ref-filename="strerror">strerror</a>(<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/errno.h.html#55" title="(*__errno())" data-ref="_M/errno">errno</a>));</td></tr>
<tr><th id="1581">1581</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col4 ref" href="#494n" title='n' data-ref="494n" data-ref-filename="494n">n</a>);</td></tr>
<tr><th id="1582">1582</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1583">1583</th><td>	}</td></tr>
<tr><th id="1584">1584</th><td></td></tr>
<tr><th id="1585">1585</th><td>	<i>/* clear the data tree */</i></td></tr>
<tr><th id="1586">1586</th><td>	<a class="ref fn" href="../util/rbtree.h.html#traverse_postorder" title='traverse_postorder' data-ref="traverse_postorder" data-ref-filename="traverse_postorder">traverse_postorder</a>(&amp;<a class="local col7 ref" href="#487z" title='z' data-ref="487z" data-ref-filename="487z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::data" title='auth_zone::data' data-ref="auth_zone::data" data-ref-filename="auth_zone..data">data</a>, <a class="tu ref fn" href="#auth_data_del" title='auth_data_del' data-use='r' data-ref="auth_data_del" data-ref-filename="auth_data_del">auth_data_del</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="1587">1587</th><td>	<a class="ref fn" href="../util/rbtree.h.html#rbtree_init" title='rbtree_init' data-ref="rbtree_init" data-ref-filename="rbtree_init">rbtree_init</a>(&amp;<a class="local col7 ref" href="#487z" title='z' data-ref="487z" data-ref-filename="487z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::data" title='auth_zone::data' data-ref="auth_zone::data" data-ref-filename="auth_zone..data">data</a>, &amp;<a class="ref fn" href="#auth_data_cmp" title='auth_data_cmp' data-ref="auth_data_cmp" data-ref-filename="auth_data_cmp">auth_data_cmp</a>);</td></tr>
<tr><th id="1588">1588</th><td></td></tr>
<tr><th id="1589">1589</th><td>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#97" title="((__builtin_object_size(&amp;state, 0) != (size_t)-1) ? __builtin___memset_chk(&amp;state, 0, sizeof(state), __builtin_object_size(&amp;state, 0)) : __memset_ichk(&amp;state, 0, sizeof(state)))" data-ref="_M/memset">memset</a>(&amp;<a class="local col0 ref" href="#490state" title='state' data-ref="490state" data-ref-filename="490state">state</a>, <var>0</var>, <b>sizeof</b>(<a class="local col0 ref" href="#490state" title='state' data-ref="490state" data-ref-filename="490state">state</a>));</td></tr>
<tr><th id="1590">1590</th><td>	<i>/* default TTL to 3600 */</i></td></tr>
<tr><th id="1591">1591</th><td>	<a class="local col0 ref" href="#490state" title='state' data-ref="490state" data-ref-filename="490state">state</a>.<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::default_ttl" title='sldns_file_parse_state::default_ttl' data-ref="sldns_file_parse_state::default_ttl" data-ref-filename="sldns_file_parse_state..default_ttl">default_ttl</a> = <var>3600</var>;</td></tr>
<tr><th id="1592">1592</th><td>	<i>/* set $ORIGIN to the zone name */</i></td></tr>
<tr><th id="1593">1593</th><td>	<b>if</b>(<a class="local col7 ref" href="#487z" title='z' data-ref="487z" data-ref-filename="487z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::namelen" title='auth_zone::namelen' data-ref="auth_zone::namelen" data-ref-filename="auth_zone..namelen">namelen</a> &lt;= <b>sizeof</b>(<a class="local col0 ref" href="#490state" title='state' data-ref="490state" data-ref-filename="490state">state</a>.<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::origin" title='sldns_file_parse_state::origin' data-ref="sldns_file_parse_state::origin" data-ref-filename="sldns_file_parse_state..origin">origin</a>)) {</td></tr>
<tr><th id="1594">1594</th><td>		<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#95" title="((__builtin_object_size(state.origin, 0) != (size_t)-1) ? __builtin___memcpy_chk(state.origin, z-&gt;name, z-&gt;namelen, __builtin_object_size(state.origin, 0)) : __memcpy_ichk(state.origin, z-&gt;name, z-&gt;namelen))" data-ref="_M/memcpy">memcpy</a>(<a class="local col0 ref" href="#490state" title='state' data-ref="490state" data-ref-filename="490state">state</a>.<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::origin" title='sldns_file_parse_state::origin' data-ref="sldns_file_parse_state::origin" data-ref-filename="sldns_file_parse_state..origin">origin</a>, <a class="local col7 ref" href="#487z" title='z' data-ref="487z" data-ref-filename="487z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::name" title='auth_zone::name' data-ref="auth_zone::name" data-ref-filename="auth_zone..name">name</a>, <a class="local col7 ref" href="#487z" title='z' data-ref="487z" data-ref-filename="487z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::namelen" title='auth_zone::namelen' data-ref="auth_zone::namelen" data-ref-filename="auth_zone..namelen">namelen</a>);</td></tr>
<tr><th id="1595">1595</th><td>		<a class="local col0 ref" href="#490state" title='state' data-ref="490state" data-ref-filename="490state">state</a>.<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::origin_len" title='sldns_file_parse_state::origin_len' data-ref="sldns_file_parse_state::origin_len" data-ref-filename="sldns_file_parse_state..origin_len">origin_len</a> = <a class="local col7 ref" href="#487z" title='z' data-ref="487z" data-ref-filename="487z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::namelen" title='auth_zone::namelen' data-ref="auth_zone::namelen" data-ref-filename="auth_zone..namelen">namelen</a>;</td></tr>
<tr><th id="1596">1596</th><td>	}</td></tr>
<tr><th id="1597">1597</th><td>	<i>/* parse the (toplevel) file */</i></td></tr>
<tr><th id="1598">1598</th><td>	<b>if</b>(!<a class="tu ref fn" href="#az_parse_file" title='az_parse_file' data-use='c' data-ref="az_parse_file" data-ref-filename="az_parse_file">az_parse_file</a>(<a class="local col7 ref" href="#487z" title='z' data-ref="487z" data-ref-filename="487z">z</a>, <a class="local col2 ref" href="#492in" title='in' data-ref="492in" data-ref-filename="492in">in</a>, <a class="local col9 ref" href="#489rr" title='rr' data-ref="489rr" data-ref-filename="489rr">rr</a>, <b>sizeof</b>(<a class="local col9 ref" href="#489rr" title='rr' data-ref="489rr" data-ref-filename="489rr">rr</a>), &amp;<a class="local col0 ref" href="#490state" title='state' data-ref="490state" data-ref-filename="490state">state</a>, <a class="local col1 ref" href="#491zfilename" title='zfilename' data-ref="491zfilename" data-ref-filename="491zfilename">zfilename</a>, <var>0</var>, <a class="local col8 ref" href="#488cfg" title='cfg' data-ref="488cfg" data-ref-filename="488cfg">cfg</a>)) {</td></tr>
<tr><th id="1599">1599</th><td>		<em>char</em>* <dfn class="local col5 decl" id="495n" title='n' data-type='char *' data-ref="495n" data-ref-filename="495n">n</dfn> = <a class="ref fn" href="../sldns/wire2str.h.html#sldns_wire2str_dname" title='sldns_wire2str_dname' data-ref="sldns_wire2str_dname" data-ref-filename="sldns_wire2str_dname">sldns_wire2str_dname</a>(<a class="local col7 ref" href="#487z" title='z' data-ref="487z" data-ref-filename="487z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::name" title='auth_zone::name' data-ref="auth_zone::name" data-ref-filename="auth_zone..name">name</a>, <a class="local col7 ref" href="#487z" title='z' data-ref="487z" data-ref-filename="487z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::namelen" title='auth_zone::namelen' data-ref="auth_zone::namelen" data-ref-filename="auth_zone..namelen">namelen</a>);</td></tr>
<tr><th id="1600">1600</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"error parsing zonefile %s for %s"</q>,</td></tr>
<tr><th id="1601">1601</th><td>			<a class="local col1 ref" href="#491zfilename" title='zfilename' data-ref="491zfilename" data-ref-filename="491zfilename">zfilename</a>, <a class="local col5 ref" href="#495n" title='n' data-ref="495n" data-ref-filename="495n">n</a>?<a class="local col5 ref" href="#495n" title='n' data-ref="495n" data-ref-filename="495n">n</a>:<q>"error"</q>);</td></tr>
<tr><th id="1602">1602</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col5 ref" href="#495n" title='n' data-ref="495n" data-ref-filename="495n">n</a>);</td></tr>
<tr><th id="1603">1603</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#fclose" title='fclose' data-ref="fclose" data-ref-filename="fclose">fclose</a>(<a class="local col2 ref" href="#492in" title='in' data-ref="492in" data-ref-filename="492in">in</a>);</td></tr>
<tr><th id="1604">1604</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1605">1605</th><td>	}</td></tr>
<tr><th id="1606">1606</th><td>	<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#fclose" title='fclose' data-ref="fclose" data-ref-filename="fclose">fclose</a>(<a class="local col2 ref" href="#492in" title='in' data-ref="492in" data-ref-filename="492in">in</a>);</td></tr>
<tr><th id="1607">1607</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1608">1608</th><td>}</td></tr>
<tr><th id="1609">1609</th><td></td></tr>
<tr><th id="1610">1610</th><td><i class="doc" data-doc="write_out">/** write buffer to file and check return codes */</i></td></tr>
<tr><th id="1611">1611</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="1612">1612</th><td><dfn class="tu decl def fn" id="write_out" title='write_out' data-type='int write_out(FILE * out, const char * str, size_t len)' data-ref="write_out" data-ref-filename="write_out">write_out</dfn>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#FILE" title='FILE' data-type='struct __sFILE' data-ref="FILE" data-ref-filename="FILE">FILE</a>* <dfn class="local col6 decl" id="496out" title='out' data-type='FILE *' data-ref="496out" data-ref-filename="496out">out</dfn>, <em>const</em> <em>char</em>* <dfn class="local col7 decl" id="497str" title='str' data-type='const char *' data-ref="497str" data-ref-filename="497str">str</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col8 decl" id="498len" title='len' data-type='size_t' data-ref="498len" data-ref-filename="498len">len</dfn>)</td></tr>
<tr><th id="1613">1613</th><td>{</td></tr>
<tr><th id="1614">1614</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col9 decl" id="499r" title='r' data-type='size_t' data-ref="499r" data-ref-filename="499r">r</dfn>;</td></tr>
<tr><th id="1615">1615</th><td>	<b>if</b>(<a class="local col8 ref" href="#498len" title='len' data-ref="498len" data-ref-filename="498len">len</a> == <var>0</var>)</td></tr>
<tr><th id="1616">1616</th><td>		<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1617">1617</th><td>	<a class="local col9 ref" href="#499r" title='r' data-ref="499r" data-ref-filename="499r">r</a> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#fwrite" title='fwrite' data-ref="fwrite" data-ref-filename="fwrite">fwrite</a>(<a class="local col7 ref" href="#497str" title='str' data-ref="497str" data-ref-filename="497str">str</a>, <var>1</var>, <a class="local col8 ref" href="#498len" title='len' data-ref="498len" data-ref-filename="498len">len</a>, <a class="local col6 ref" href="#496out" title='out' data-ref="496out" data-ref-filename="496out">out</a>);</td></tr>
<tr><th id="1618">1618</th><td>	<b>if</b>(<a class="local col9 ref" href="#499r" title='r' data-ref="499r" data-ref-filename="499r">r</a> == <var>0</var>) {</td></tr>
<tr><th id="1619">1619</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"write failed: %s"</q>, <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strerror" title='strerror' data-ref="strerror" data-ref-filename="strerror">strerror</a>(<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/errno.h.html#55" title="(*__errno())" data-ref="_M/errno">errno</a>));</td></tr>
<tr><th id="1620">1620</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1621">1621</th><td>	} <b>else</b> <b>if</b>(<a class="local col9 ref" href="#499r" title='r' data-ref="499r" data-ref-filename="499r">r</a> &lt; <a class="local col8 ref" href="#498len" title='len' data-ref="498len" data-ref-filename="498len">len</a>) {</td></tr>
<tr><th id="1622">1622</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"write failed: too short (disk full?)"</q>);</td></tr>
<tr><th id="1623">1623</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1624">1624</th><td>	}</td></tr>
<tr><th id="1625">1625</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1626">1626</th><td>}</td></tr>
<tr><th id="1627">1627</th><td></td></tr>
<tr><th id="1628">1628</th><td><i class="doc" data-doc="auth_rr_to_string">/** convert auth rr to string */</i></td></tr>
<tr><th id="1629">1629</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="1630">1630</th><td><dfn class="tu decl def fn" id="auth_rr_to_string" title='auth_rr_to_string' data-type='int auth_rr_to_string(uint8_t * nm, size_t nmlen, uint16_t tp, uint16_t cl, struct packed_rrset_data * data, size_t i, char * s, size_t buflen)' data-ref="auth_rr_to_string" data-ref-filename="auth_rr_to_string">auth_rr_to_string</dfn>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col0 decl" id="500nm" title='nm' data-type='uint8_t *' data-ref="500nm" data-ref-filename="500nm">nm</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col1 decl" id="501nmlen" title='nmlen' data-type='size_t' data-ref="501nmlen" data-ref-filename="501nmlen">nmlen</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col2 decl" id="502tp" title='tp' data-type='uint16_t' data-ref="502tp" data-ref-filename="502tp">tp</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col3 decl" id="503cl" title='cl' data-type='uint16_t' data-ref="503cl" data-ref-filename="503cl">cl</dfn>,</td></tr>
<tr><th id="1631">1631</th><td>	<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>* <dfn class="local col4 decl" id="504data" title='data' data-type='struct packed_rrset_data *' data-ref="504data" data-ref-filename="504data">data</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col5 decl" id="505i" title='i' data-type='size_t' data-ref="505i" data-ref-filename="505i">i</dfn>, <em>char</em>* <dfn class="local col6 decl" id="506s" title='s' data-type='char *' data-ref="506s" data-ref-filename="506s">s</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col7 decl" id="507buflen" title='buflen' data-type='size_t' data-ref="507buflen" data-ref-filename="507buflen">buflen</dfn>)</td></tr>
<tr><th id="1632">1632</th><td>{</td></tr>
<tr><th id="1633">1633</th><td>	<em>int</em> <dfn class="local col8 decl" id="508w" title='w' data-type='int' data-ref="508w" data-ref-filename="508w">w</dfn> = <var>0</var>;</td></tr>
<tr><th id="1634">1634</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col9 decl" id="509slen" title='slen' data-type='size_t' data-ref="509slen" data-ref-filename="509slen">slen</dfn> = <a class="local col7 ref" href="#507buflen" title='buflen' data-ref="507buflen" data-ref-filename="507buflen">buflen</a>, <dfn class="local col0 decl" id="510datlen" title='datlen' data-type='size_t' data-ref="510datlen" data-ref-filename="510datlen">datlen</dfn>;</td></tr>
<tr><th id="1635">1635</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col1 decl" id="511dat" title='dat' data-type='uint8_t *' data-ref="511dat" data-ref-filename="511dat">dat</dfn>;</td></tr>
<tr><th id="1636">1636</th><td>	<b>if</b>(<a class="local col5 ref" href="#505i" title='i' data-ref="505i" data-ref-filename="505i">i</a> &gt;= <a class="local col4 ref" href="#504data" title='data' data-ref="504data" data-ref-filename="504data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>) <a class="local col2 ref" href="#502tp" title='tp' data-ref="502tp" data-ref-filename="502tp">tp</a> = <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_RRSIG" title='LDNS_RR_TYPE_RRSIG' data-ref="LDNS_RR_TYPE_RRSIG" data-ref-filename="LDNS_RR_TYPE_RRSIG">LDNS_RR_TYPE_RRSIG</a>;</td></tr>
<tr><th id="1637">1637</th><td>	<a class="local col1 ref" href="#511dat" title='dat' data-ref="511dat" data-ref-filename="511dat">dat</a> = <a class="local col0 ref" href="#500nm" title='nm' data-ref="500nm" data-ref-filename="500nm">nm</a>;</td></tr>
<tr><th id="1638">1638</th><td>	<a class="local col0 ref" href="#510datlen" title='datlen' data-ref="510datlen" data-ref-filename="510datlen">datlen</a> = <a class="local col1 ref" href="#501nmlen" title='nmlen' data-ref="501nmlen" data-ref-filename="501nmlen">nmlen</a>;</td></tr>
<tr><th id="1639">1639</th><td>	<a class="local col8 ref" href="#508w" title='w' data-ref="508w" data-ref-filename="508w">w</a> += <a class="ref fn" href="../sldns/wire2str.h.html#sldns_wire2str_dname_scan" title='sldns_wire2str_dname_scan' data-ref="sldns_wire2str_dname_scan" data-ref-filename="sldns_wire2str_dname_scan">sldns_wire2str_dname_scan</a>(&amp;<a class="local col1 ref" href="#511dat" title='dat' data-ref="511dat" data-ref-filename="511dat">dat</a>, &amp;<a class="local col0 ref" href="#510datlen" title='datlen' data-ref="510datlen" data-ref-filename="510datlen">datlen</a>, &amp;<a class="local col6 ref" href="#506s" title='s' data-ref="506s" data-ref-filename="506s">s</a>, &amp;<a class="local col9 ref" href="#509slen" title='slen' data-ref="509slen" data-ref-filename="509slen">slen</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>, <var>0</var>);</td></tr>
<tr><th id="1640">1640</th><td>	<a class="local col8 ref" href="#508w" title='w' data-ref="508w" data-ref-filename="508w">w</a> += <a class="ref fn" href="../sldns/wire2str.h.html#sldns_str_print" title='sldns_str_print' data-ref="sldns_str_print" data-ref-filename="sldns_str_print">sldns_str_print</a>(&amp;<a class="local col6 ref" href="#506s" title='s' data-ref="506s" data-ref-filename="506s">s</a>, &amp;<a class="local col9 ref" href="#509slen" title='slen' data-ref="509slen" data-ref-filename="509slen">slen</a>, <q>"\t"</q>);</td></tr>
<tr><th id="1641">1641</th><td>	<a class="local col8 ref" href="#508w" title='w' data-ref="508w" data-ref-filename="508w">w</a> += <a class="ref fn" href="../sldns/wire2str.h.html#sldns_str_print" title='sldns_str_print' data-ref="sldns_str_print" data-ref-filename="sldns_str_print">sldns_str_print</a>(&amp;<a class="local col6 ref" href="#506s" title='s' data-ref="506s" data-ref-filename="506s">s</a>, &amp;<a class="local col9 ref" href="#509slen" title='slen' data-ref="509slen" data-ref-filename="509slen">slen</a>, <q>"%lu\t"</q>, (<em>unsigned</em> <em>long</em>)<a class="local col4 ref" href="#504data" title='data' data-ref="504data" data-ref-filename="504data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_ttl" title='packed_rrset_data::rr_ttl' data-ref="packed_rrset_data::rr_ttl" data-ref-filename="packed_rrset_data..rr_ttl">rr_ttl</a>[<a class="local col5 ref" href="#505i" title='i' data-ref="505i" data-ref-filename="505i">i</a>]);</td></tr>
<tr><th id="1642">1642</th><td>	<a class="local col8 ref" href="#508w" title='w' data-ref="508w" data-ref-filename="508w">w</a> += <a class="ref fn" href="../sldns/wire2str.h.html#sldns_wire2str_class_print" title='sldns_wire2str_class_print' data-ref="sldns_wire2str_class_print" data-ref-filename="sldns_wire2str_class_print">sldns_wire2str_class_print</a>(&amp;<a class="local col6 ref" href="#506s" title='s' data-ref="506s" data-ref-filename="506s">s</a>, &amp;<a class="local col9 ref" href="#509slen" title='slen' data-ref="509slen" data-ref-filename="509slen">slen</a>, <a class="local col3 ref" href="#503cl" title='cl' data-ref="503cl" data-ref-filename="503cl">cl</a>);</td></tr>
<tr><th id="1643">1643</th><td>	<a class="local col8 ref" href="#508w" title='w' data-ref="508w" data-ref-filename="508w">w</a> += <a class="ref fn" href="../sldns/wire2str.h.html#sldns_str_print" title='sldns_str_print' data-ref="sldns_str_print" data-ref-filename="sldns_str_print">sldns_str_print</a>(&amp;<a class="local col6 ref" href="#506s" title='s' data-ref="506s" data-ref-filename="506s">s</a>, &amp;<a class="local col9 ref" href="#509slen" title='slen' data-ref="509slen" data-ref-filename="509slen">slen</a>, <q>"\t"</q>);</td></tr>
<tr><th id="1644">1644</th><td>	<a class="local col8 ref" href="#508w" title='w' data-ref="508w" data-ref-filename="508w">w</a> += <a class="ref fn" href="../sldns/wire2str.h.html#sldns_wire2str_type_print" title='sldns_wire2str_type_print' data-ref="sldns_wire2str_type_print" data-ref-filename="sldns_wire2str_type_print">sldns_wire2str_type_print</a>(&amp;<a class="local col6 ref" href="#506s" title='s' data-ref="506s" data-ref-filename="506s">s</a>, &amp;<a class="local col9 ref" href="#509slen" title='slen' data-ref="509slen" data-ref-filename="509slen">slen</a>, <a class="local col2 ref" href="#502tp" title='tp' data-ref="502tp" data-ref-filename="502tp">tp</a>);</td></tr>
<tr><th id="1645">1645</th><td>	<a class="local col8 ref" href="#508w" title='w' data-ref="508w" data-ref-filename="508w">w</a> += <a class="ref fn" href="../sldns/wire2str.h.html#sldns_str_print" title='sldns_str_print' data-ref="sldns_str_print" data-ref-filename="sldns_str_print">sldns_str_print</a>(&amp;<a class="local col6 ref" href="#506s" title='s' data-ref="506s" data-ref-filename="506s">s</a>, &amp;<a class="local col9 ref" href="#509slen" title='slen' data-ref="509slen" data-ref-filename="509slen">slen</a>, <q>"\t"</q>);</td></tr>
<tr><th id="1646">1646</th><td>	<a class="local col0 ref" href="#510datlen" title='datlen' data-ref="510datlen" data-ref-filename="510datlen">datlen</a> = <a class="local col4 ref" href="#504data" title='data' data-ref="504data" data-ref-filename="504data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<a class="local col5 ref" href="#505i" title='i' data-ref="505i" data-ref-filename="505i">i</a>]-<var>2</var>;</td></tr>
<tr><th id="1647">1647</th><td>	<a class="local col1 ref" href="#511dat" title='dat' data-ref="511dat" data-ref-filename="511dat">dat</a> = <a class="local col4 ref" href="#504data" title='data' data-ref="504data" data-ref-filename="504data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<a class="local col5 ref" href="#505i" title='i' data-ref="505i" data-ref-filename="505i">i</a>]+<var>2</var>;</td></tr>
<tr><th id="1648">1648</th><td>	<a class="local col8 ref" href="#508w" title='w' data-ref="508w" data-ref-filename="508w">w</a> += <a class="ref fn" href="../sldns/wire2str.h.html#sldns_wire2str_rdata_scan" title='sldns_wire2str_rdata_scan' data-ref="sldns_wire2str_rdata_scan" data-ref-filename="sldns_wire2str_rdata_scan">sldns_wire2str_rdata_scan</a>(&amp;<a class="local col1 ref" href="#511dat" title='dat' data-ref="511dat" data-ref-filename="511dat">dat</a>, &amp;<a class="local col0 ref" href="#510datlen" title='datlen' data-ref="510datlen" data-ref-filename="510datlen">datlen</a>, &amp;<a class="local col6 ref" href="#506s" title='s' data-ref="506s" data-ref-filename="506s">s</a>, &amp;<a class="local col9 ref" href="#509slen" title='slen' data-ref="509slen" data-ref-filename="509slen">slen</a>, <a class="local col2 ref" href="#502tp" title='tp' data-ref="502tp" data-ref-filename="502tp">tp</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>, <var>0</var>);</td></tr>
<tr><th id="1649">1649</th><td></td></tr>
<tr><th id="1650">1650</th><td>	<b>if</b>(<a class="local col2 ref" href="#502tp" title='tp' data-ref="502tp" data-ref-filename="502tp">tp</a> == <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_DNSKEY" title='LDNS_RR_TYPE_DNSKEY' data-ref="LDNS_RR_TYPE_DNSKEY" data-ref-filename="LDNS_RR_TYPE_DNSKEY">LDNS_RR_TYPE_DNSKEY</a>) {</td></tr>
<tr><th id="1651">1651</th><td>		<a class="local col8 ref" href="#508w" title='w' data-ref="508w" data-ref-filename="508w">w</a> += <a class="ref fn" href="../sldns/wire2str.h.html#sldns_str_print" title='sldns_str_print' data-ref="sldns_str_print" data-ref-filename="sldns_str_print">sldns_str_print</a>(&amp;<a class="local col6 ref" href="#506s" title='s' data-ref="506s" data-ref-filename="506s">s</a>, &amp;<a class="local col9 ref" href="#509slen" title='slen' data-ref="509slen" data-ref-filename="509slen">slen</a>, <q>" ;{id = %u}"</q>,</td></tr>
<tr><th id="1652">1652</th><td>			<a class="ref fn" href="../sldns/keyraw.h.html#sldns_calc_keytag_raw" title='sldns_calc_keytag_raw' data-ref="sldns_calc_keytag_raw" data-ref-filename="sldns_calc_keytag_raw">sldns_calc_keytag_raw</a>(<a class="local col4 ref" href="#504data" title='data' data-ref="504data" data-ref-filename="504data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<a class="local col5 ref" href="#505i" title='i' data-ref="505i" data-ref-filename="505i">i</a>]+<var>2</var>,</td></tr>
<tr><th id="1653">1653</th><td>				<a class="local col4 ref" href="#504data" title='data' data-ref="504data" data-ref-filename="504data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<a class="local col5 ref" href="#505i" title='i' data-ref="505i" data-ref-filename="505i">i</a>]-<var>2</var>));</td></tr>
<tr><th id="1654">1654</th><td>	}</td></tr>
<tr><th id="1655">1655</th><td>	<a class="local col8 ref" href="#508w" title='w' data-ref="508w" data-ref-filename="508w">w</a> += <a class="ref fn" href="../sldns/wire2str.h.html#sldns_str_print" title='sldns_str_print' data-ref="sldns_str_print" data-ref-filename="sldns_str_print">sldns_str_print</a>(&amp;<a class="local col6 ref" href="#506s" title='s' data-ref="506s" data-ref-filename="506s">s</a>, &amp;<a class="local col9 ref" href="#509slen" title='slen' data-ref="509slen" data-ref-filename="509slen">slen</a>, <q>"\n"</q>);</td></tr>
<tr><th id="1656">1656</th><td></td></tr>
<tr><th id="1657">1657</th><td>	<b>if</b>(<a class="local col8 ref" href="#508w" title='w' data-ref="508w" data-ref-filename="508w">w</a> &gt; (<em>int</em>)<a class="local col7 ref" href="#507buflen" title='buflen' data-ref="507buflen" data-ref-filename="507buflen">buflen</a>) {</td></tr>
<tr><th id="1658">1658</th><td>		<a class="ref fn" href="../util/net_help.h.html#log_nametypeclass" title='log_nametypeclass' data-ref="log_nametypeclass" data-ref-filename="log_nametypeclass">log_nametypeclass</a>(<var>0</var>, <q>"RR too long to print"</q>, <a class="local col0 ref" href="#500nm" title='nm' data-ref="500nm" data-ref-filename="500nm">nm</a>, <a class="local col2 ref" href="#502tp" title='tp' data-ref="502tp" data-ref-filename="502tp">tp</a>, <a class="local col3 ref" href="#503cl" title='cl' data-ref="503cl" data-ref-filename="503cl">cl</a>);</td></tr>
<tr><th id="1659">1659</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1660">1660</th><td>	}</td></tr>
<tr><th id="1661">1661</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1662">1662</th><td>}</td></tr>
<tr><th id="1663">1663</th><td></td></tr>
<tr><th id="1664">1664</th><td><i class="doc" data-doc="auth_zone_write_rrset">/** write rrset to file */</i></td></tr>
<tr><th id="1665">1665</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="1666">1666</th><td><dfn class="tu decl def fn" id="auth_zone_write_rrset" title='auth_zone_write_rrset' data-type='int auth_zone_write_rrset(struct auth_zone * z, struct auth_data * node, struct auth_rrset * r, FILE * out)' data-ref="auth_zone_write_rrset" data-ref-filename="auth_zone_write_rrset">auth_zone_write_rrset</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col2 decl" id="512z" title='z' data-type='struct auth_zone *' data-ref="512z" data-ref-filename="512z">z</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col3 decl" id="513node" title='node' data-type='struct auth_data *' data-ref="513node" data-ref-filename="513node">node</dfn>,</td></tr>
<tr><th id="1667">1667</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col4 decl" id="514r" title='r' data-type='struct auth_rrset *' data-ref="514r" data-ref-filename="514r">r</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#FILE" title='FILE' data-type='struct __sFILE' data-ref="FILE" data-ref-filename="FILE">FILE</a>* <dfn class="local col5 decl" id="515out" title='out' data-type='FILE *' data-ref="515out" data-ref-filename="515out">out</dfn>)</td></tr>
<tr><th id="1668">1668</th><td>{</td></tr>
<tr><th id="1669">1669</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col6 decl" id="516i" title='i' data-type='size_t' data-ref="516i" data-ref-filename="516i">i</dfn>, <dfn class="local col7 decl" id="517count" title='count' data-type='size_t' data-ref="517count" data-ref-filename="517count">count</dfn> = <a class="local col4 ref" href="#514r" title='r' data-ref="514r" data-ref-filename="514r">r</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a> + <a class="local col4 ref" href="#514r" title='r' data-ref="514r" data-ref-filename="514r">r</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a>;</td></tr>
<tr><th id="1670">1670</th><td>	<em>char</em> <dfn class="local col8 decl" id="518buf" title='buf' data-type='char [65535]' data-ref="518buf" data-ref-filename="518buf">buf</dfn>[<a class="macro" href="../sldns/str2wire.h.html#27" title="65535" data-ref="_M/LDNS_RR_BUF_SIZE">LDNS_RR_BUF_SIZE</a>];</td></tr>
<tr><th id="1671">1671</th><td>	<b>for</b>(<a class="local col6 ref" href="#516i" title='i' data-ref="516i" data-ref-filename="516i">i</a>=<var>0</var>; <a class="local col6 ref" href="#516i" title='i' data-ref="516i" data-ref-filename="516i">i</a>&lt;<a class="local col7 ref" href="#517count" title='count' data-ref="517count" data-ref-filename="517count">count</a>; <a class="local col6 ref" href="#516i" title='i' data-ref="516i" data-ref-filename="516i">i</a>++) {</td></tr>
<tr><th id="1672">1672</th><td>		<b>if</b>(!<a class="tu ref fn" href="#auth_rr_to_string" title='auth_rr_to_string' data-use='c' data-ref="auth_rr_to_string" data-ref-filename="auth_rr_to_string">auth_rr_to_string</a>(<a class="local col3 ref" href="#513node" title='node' data-ref="513node" data-ref-filename="513node">node</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::name" title='auth_data::name' data-ref="auth_data::name" data-ref-filename="auth_data..name">name</a>, <a class="local col3 ref" href="#513node" title='node' data-ref="513node" data-ref-filename="513node">node</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::namelen" title='auth_data::namelen' data-ref="auth_data::namelen" data-ref-filename="auth_data..namelen">namelen</a>, <a class="local col4 ref" href="#514r" title='r' data-ref="514r" data-ref-filename="514r">r</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::type" title='auth_rrset::type' data-ref="auth_rrset::type" data-ref-filename="auth_rrset..type">type</a>,</td></tr>
<tr><th id="1673">1673</th><td>			<a class="local col2 ref" href="#512z" title='z' data-ref="512z" data-ref-filename="512z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::dclass" title='auth_zone::dclass' data-ref="auth_zone::dclass" data-ref-filename="auth_zone..dclass">dclass</a>, <a class="local col4 ref" href="#514r" title='r' data-ref="514r" data-ref-filename="514r">r</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>, <a class="local col6 ref" href="#516i" title='i' data-ref="516i" data-ref-filename="516i">i</a>, <a class="local col8 ref" href="#518buf" title='buf' data-ref="518buf" data-ref-filename="518buf">buf</a>, <b>sizeof</b>(<a class="local col8 ref" href="#518buf" title='buf' data-ref="518buf" data-ref-filename="518buf">buf</a>))) {</td></tr>
<tr><th id="1674">1674</th><td>			<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"failed to rr2str rr %d"</q>, (<em>int</em>)<a class="local col6 ref" href="#516i" title='i' data-ref="516i" data-ref-filename="516i">i</a>);</td></tr>
<tr><th id="1675">1675</th><td>			<b>continue</b>;</td></tr>
<tr><th id="1676">1676</th><td>		}</td></tr>
<tr><th id="1677">1677</th><td>		<b>if</b>(!<a class="tu ref fn" href="#write_out" title='write_out' data-use='c' data-ref="write_out" data-ref-filename="write_out">write_out</a>(<a class="local col5 ref" href="#515out" title='out' data-ref="515out" data-ref-filename="515out">out</a>, <a class="local col8 ref" href="#518buf" title='buf' data-ref="518buf" data-ref-filename="518buf">buf</a>, <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strlen" title='strlen' data-ref="strlen" data-ref-filename="strlen">strlen</a>(<a class="local col8 ref" href="#518buf" title='buf' data-ref="518buf" data-ref-filename="518buf">buf</a>)))</td></tr>
<tr><th id="1678">1678</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1679">1679</th><td>	}</td></tr>
<tr><th id="1680">1680</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1681">1681</th><td>}</td></tr>
<tr><th id="1682">1682</th><td></td></tr>
<tr><th id="1683">1683</th><td><i class="doc" data-doc="auth_zone_write_domain">/** write domain to file */</i></td></tr>
<tr><th id="1684">1684</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="1685">1685</th><td><dfn class="tu decl def fn" id="auth_zone_write_domain" title='auth_zone_write_domain' data-type='int auth_zone_write_domain(struct auth_zone * z, struct auth_data * n, FILE * out)' data-ref="auth_zone_write_domain" data-ref-filename="auth_zone_write_domain">auth_zone_write_domain</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col9 decl" id="519z" title='z' data-type='struct auth_zone *' data-ref="519z" data-ref-filename="519z">z</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col0 decl" id="520n" title='n' data-type='struct auth_data *' data-ref="520n" data-ref-filename="520n">n</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#FILE" title='FILE' data-type='struct __sFILE' data-ref="FILE" data-ref-filename="FILE">FILE</a>* <dfn class="local col1 decl" id="521out" title='out' data-type='FILE *' data-ref="521out" data-ref-filename="521out">out</dfn>)</td></tr>
<tr><th id="1686">1686</th><td>{</td></tr>
<tr><th id="1687">1687</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col2 decl" id="522r" title='r' data-type='struct auth_rrset *' data-ref="522r" data-ref-filename="522r">r</dfn>;</td></tr>
<tr><th id="1688">1688</th><td>	<i>/* if this is zone apex, write SOA first */</i></td></tr>
<tr><th id="1689">1689</th><td>	<b>if</b>(<a class="local col9 ref" href="#519z" title='z' data-ref="519z" data-ref-filename="519z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::namelen" title='auth_zone::namelen' data-ref="auth_zone::namelen" data-ref-filename="auth_zone..namelen">namelen</a> == <a class="local col0 ref" href="#520n" title='n' data-ref="520n" data-ref-filename="520n">n</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::namelen" title='auth_data::namelen' data-ref="auth_data::namelen" data-ref-filename="auth_data..namelen">namelen</a>) {</td></tr>
<tr><th id="1690">1690</th><td>		<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col3 decl" id="523soa" title='soa' data-type='struct auth_rrset *' data-ref="523soa" data-ref-filename="523soa">soa</dfn> = <a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(<a class="local col0 ref" href="#520n" title='n' data-ref="520n" data-ref-filename="520n">n</a>, <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_SOA" title='LDNS_RR_TYPE_SOA' data-ref="LDNS_RR_TYPE_SOA" data-ref-filename="LDNS_RR_TYPE_SOA">LDNS_RR_TYPE_SOA</a>);</td></tr>
<tr><th id="1691">1691</th><td>		<b>if</b>(<a class="local col3 ref" href="#523soa" title='soa' data-ref="523soa" data-ref-filename="523soa">soa</a>) {</td></tr>
<tr><th id="1692">1692</th><td>			<b>if</b>(!<a class="tu ref fn" href="#auth_zone_write_rrset" title='auth_zone_write_rrset' data-use='c' data-ref="auth_zone_write_rrset" data-ref-filename="auth_zone_write_rrset">auth_zone_write_rrset</a>(<a class="local col9 ref" href="#519z" title='z' data-ref="519z" data-ref-filename="519z">z</a>, <a class="local col0 ref" href="#520n" title='n' data-ref="520n" data-ref-filename="520n">n</a>, <a class="local col3 ref" href="#523soa" title='soa' data-ref="523soa" data-ref-filename="523soa">soa</a>, <a class="local col1 ref" href="#521out" title='out' data-ref="521out" data-ref-filename="521out">out</a>))</td></tr>
<tr><th id="1693">1693</th><td>				<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1694">1694</th><td>		}</td></tr>
<tr><th id="1695">1695</th><td>	}</td></tr>
<tr><th id="1696">1696</th><td>	<i>/* write all the RRsets for this domain */</i></td></tr>
<tr><th id="1697">1697</th><td>	<b>for</b>(<a class="local col2 ref" href="#522r" title='r' data-ref="522r" data-ref-filename="522r">r</a> = <a class="local col0 ref" href="#520n" title='n' data-ref="520n" data-ref-filename="520n">n</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::rrsets" title='auth_data::rrsets' data-ref="auth_data::rrsets" data-ref-filename="auth_data..rrsets">rrsets</a>; <a class="local col2 ref" href="#522r" title='r' data-ref="522r" data-ref-filename="522r">r</a>; <a class="local col2 ref" href="#522r" title='r' data-ref="522r" data-ref-filename="522r">r</a> = <a class="local col2 ref" href="#522r" title='r' data-ref="522r" data-ref-filename="522r">r</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::next" title='auth_rrset::next' data-ref="auth_rrset::next" data-ref-filename="auth_rrset..next">next</a>) {</td></tr>
<tr><th id="1698">1698</th><td>		<b>if</b>(<a class="local col9 ref" href="#519z" title='z' data-ref="519z" data-ref-filename="519z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::namelen" title='auth_zone::namelen' data-ref="auth_zone::namelen" data-ref-filename="auth_zone..namelen">namelen</a> == <a class="local col0 ref" href="#520n" title='n' data-ref="520n" data-ref-filename="520n">n</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::namelen" title='auth_data::namelen' data-ref="auth_data::namelen" data-ref-filename="auth_data..namelen">namelen</a> &amp;&amp;</td></tr>
<tr><th id="1699">1699</th><td>			<a class="local col2 ref" href="#522r" title='r' data-ref="522r" data-ref-filename="522r">r</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::type" title='auth_rrset::type' data-ref="auth_rrset::type" data-ref-filename="auth_rrset..type">type</a> == <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_SOA" title='LDNS_RR_TYPE_SOA' data-ref="LDNS_RR_TYPE_SOA" data-ref-filename="LDNS_RR_TYPE_SOA">LDNS_RR_TYPE_SOA</a>)</td></tr>
<tr><th id="1700">1700</th><td>			<b>continue</b>; <i>/* skip SOA here */</i></td></tr>
<tr><th id="1701">1701</th><td>		<b>if</b>(!<a class="tu ref fn" href="#auth_zone_write_rrset" title='auth_zone_write_rrset' data-use='c' data-ref="auth_zone_write_rrset" data-ref-filename="auth_zone_write_rrset">auth_zone_write_rrset</a>(<a class="local col9 ref" href="#519z" title='z' data-ref="519z" data-ref-filename="519z">z</a>, <a class="local col0 ref" href="#520n" title='n' data-ref="520n" data-ref-filename="520n">n</a>, <a class="local col2 ref" href="#522r" title='r' data-ref="522r" data-ref-filename="522r">r</a>, <a class="local col1 ref" href="#521out" title='out' data-ref="521out" data-ref-filename="521out">out</a>))</td></tr>
<tr><th id="1702">1702</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1703">1703</th><td>	}</td></tr>
<tr><th id="1704">1704</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1705">1705</th><td>}</td></tr>
<tr><th id="1706">1706</th><td></td></tr>
<tr><th id="1707">1707</th><td><em>int</em> <dfn class="decl def fn" id="auth_zone_write_file" title='auth_zone_write_file' data-ref="auth_zone_write_file" data-ref-filename="auth_zone_write_file">auth_zone_write_file</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col4 decl" id="524z" title='z' data-type='struct auth_zone *' data-ref="524z" data-ref-filename="524z">z</dfn>, <em>const</em> <em>char</em>* <dfn class="local col5 decl" id="525fname" title='fname' data-type='const char *' data-ref="525fname" data-ref-filename="525fname">fname</dfn>)</td></tr>
<tr><th id="1708">1708</th><td>{</td></tr>
<tr><th id="1709">1709</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#FILE" title='FILE' data-type='struct __sFILE' data-ref="FILE" data-ref-filename="FILE">FILE</a>* <dfn class="local col6 decl" id="526out" title='out' data-type='FILE *' data-ref="526out" data-ref-filename="526out">out</dfn>;</td></tr>
<tr><th id="1710">1710</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col7 decl" id="527n" title='n' data-type='struct auth_data *' data-ref="527n" data-ref-filename="527n">n</dfn>;</td></tr>
<tr><th id="1711">1711</th><td>	<a class="local col6 ref" href="#526out" title='out' data-ref="526out" data-ref-filename="526out">out</a> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#fopen" title='fopen' data-ref="fopen" data-ref-filename="fopen">fopen</a>(<a class="local col5 ref" href="#525fname" title='fname' data-ref="525fname" data-ref-filename="525fname">fname</a>, <q>"w"</q>);</td></tr>
<tr><th id="1712">1712</th><td>	<b>if</b>(!<a class="local col6 ref" href="#526out" title='out' data-ref="526out" data-ref-filename="526out">out</a>) {</td></tr>
<tr><th id="1713">1713</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"could not open %s: %s"</q>, <a class="local col5 ref" href="#525fname" title='fname' data-ref="525fname" data-ref-filename="525fname">fname</a>, <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strerror" title='strerror' data-ref="strerror" data-ref-filename="strerror">strerror</a>(<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/errno.h.html#55" title="(*__errno())" data-ref="_M/errno">errno</a>));</td></tr>
<tr><th id="1714">1714</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1715">1715</th><td>	}</td></tr>
<tr><th id="1716">1716</th><td>	<a class="macro" href="../util/rbtree.h.html#173" title="for(n=(struct auth_data*)rbtree_first(&amp;z-&gt;data); (rbnode_type*)n != &amp;rbtree_null_node; n = (struct auth_data*)rbtree_next((rbnode_type*)n))" data-ref="_M/RBTREE_FOR">RBTREE_FOR</a>(<a class="local col7 ref" href="#527n" title='n' data-ref="527n" data-ref-filename="527n">n</a>, <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>*, &amp;<a class="local col4 ref" href="#524z" title='z' data-ref="524z" data-ref-filename="524z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::data" title='auth_zone::data' data-ref="auth_zone::data" data-ref-filename="auth_zone..data">data</a>) {</td></tr>
<tr><th id="1717">1717</th><td>		<b>if</b>(!<a class="tu ref fn" href="#auth_zone_write_domain" title='auth_zone_write_domain' data-use='c' data-ref="auth_zone_write_domain" data-ref-filename="auth_zone_write_domain">auth_zone_write_domain</a>(<a class="local col4 ref" href="#524z" title='z' data-ref="524z" data-ref-filename="524z">z</a>, <a class="local col7 ref" href="#527n" title='n' data-ref="527n" data-ref-filename="527n">n</a>, <a class="local col6 ref" href="#526out" title='out' data-ref="526out" data-ref-filename="526out">out</a>)) {</td></tr>
<tr><th id="1718">1718</th><td>			<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"could not write domain to %s"</q>, <a class="local col5 ref" href="#525fname" title='fname' data-ref="525fname" data-ref-filename="525fname">fname</a>);</td></tr>
<tr><th id="1719">1719</th><td>			<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#fclose" title='fclose' data-ref="fclose" data-ref-filename="fclose">fclose</a>(<a class="local col6 ref" href="#526out" title='out' data-ref="526out" data-ref-filename="526out">out</a>);</td></tr>
<tr><th id="1720">1720</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1721">1721</th><td>		}</td></tr>
<tr><th id="1722">1722</th><td>	}</td></tr>
<tr><th id="1723">1723</th><td>	<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#fclose" title='fclose' data-ref="fclose" data-ref-filename="fclose">fclose</a>(<a class="local col6 ref" href="#526out" title='out' data-ref="526out" data-ref-filename="526out">out</a>);</td></tr>
<tr><th id="1724">1724</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1725">1725</th><td>}</td></tr>
<tr><th id="1726">1726</th><td></td></tr>
<tr><th id="1727">1727</th><td><i class="doc" data-doc="auth_zones_read_zones">/** read all auth zones from file (if they have) */</i></td></tr>
<tr><th id="1728">1728</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="1729">1729</th><td><dfn class="tu decl def fn" id="auth_zones_read_zones" title='auth_zones_read_zones' data-type='int auth_zones_read_zones(struct auth_zones * az, struct config_file * cfg)' data-ref="auth_zones_read_zones" data-ref-filename="auth_zones_read_zones">auth_zones_read_zones</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zones" title='auth_zones' data-ref="auth_zones" data-ref-filename="auth_zones">auth_zones</a>* <dfn class="local col8 decl" id="528az" title='az' data-type='struct auth_zones *' data-ref="528az" data-ref-filename="528az">az</dfn>, <b>struct</b> <a class="type" href="../util/config_file.h.html#config_file" title='config_file' data-ref="config_file" data-ref-filename="config_file">config_file</a>* <dfn class="local col9 decl" id="529cfg" title='cfg' data-type='struct config_file *' data-ref="529cfg" data-ref-filename="529cfg">cfg</dfn>)</td></tr>
<tr><th id="1730">1730</th><td>{</td></tr>
<tr><th id="1731">1731</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col0 decl" id="530z" title='z' data-type='struct auth_zone *' data-ref="530z" data-ref-filename="530z">z</dfn>;</td></tr>
<tr><th id="1732">1732</th><td>	<a class="macro" href="../util/locks.h.html#120" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_wrlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_wrlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1732, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_wrlock">lock_rw_wrlock</a>(&amp;<a class="local col8 ref" href="#528az" title='az' data-ref="528az" data-ref-filename="528az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="1733">1733</th><td>	<a class="macro" href="../util/rbtree.h.html#173" title="for(z=(struct auth_zone*)rbtree_first(&amp;az-&gt;ztree); (rbnode_type*)z != &amp;rbtree_null_node; z = (struct auth_zone*)rbtree_next((rbnode_type*)z))" data-ref="_M/RBTREE_FOR">RBTREE_FOR</a>(<a class="local col0 ref" href="#530z" title='z' data-ref="530z" data-ref-filename="530z">z</a>, <b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>*, &amp;<a class="local col8 ref" href="#528az" title='az' data-ref="528az" data-ref-filename="528az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::ztree" title='auth_zones::ztree' data-ref="auth_zones::ztree" data-ref-filename="auth_zones..ztree">ztree</a>) {</td></tr>
<tr><th id="1734">1734</th><td>		<a class="macro" href="../util/locks.h.html#120" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_wrlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_wrlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1734, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_wrlock">lock_rw_wrlock</a>(&amp;<a class="local col0 ref" href="#530z" title='z' data-ref="530z" data-ref-filename="530z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="1735">1735</th><td>		<b>if</b>(!<a class="ref fn" href="#auth_zone_read_zonefile" title='auth_zone_read_zonefile' data-ref="auth_zone_read_zonefile" data-ref-filename="auth_zone_read_zonefile">auth_zone_read_zonefile</a>(<a class="local col0 ref" href="#530z" title='z' data-ref="530z" data-ref-filename="530z">z</a>, <a class="local col9 ref" href="#529cfg" title='cfg' data-ref="529cfg" data-ref-filename="529cfg">cfg</a>)) {</td></tr>
<tr><th id="1736">1736</th><td>			<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1736, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col0 ref" href="#530z" title='z' data-ref="530z" data-ref-filename="530z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="1737">1737</th><td>			<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1737, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col8 ref" href="#528az" title='az' data-ref="528az" data-ref-filename="528az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="1738">1738</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1739">1739</th><td>		}</td></tr>
<tr><th id="1740">1740</th><td>		<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1740, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col0 ref" href="#530z" title='z' data-ref="530z" data-ref-filename="530z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="1741">1741</th><td>	}</td></tr>
<tr><th id="1742">1742</th><td>	<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1742, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col8 ref" href="#528az" title='az' data-ref="528az" data-ref-filename="528az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="1743">1743</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1744">1744</th><td>}</td></tr>
<tr><th id="1745">1745</th><td></td></tr>
<tr><th id="1746">1746</th><td><i class="doc">/** find serial number of zone or false if none */</i></td></tr>
<tr><th id="1747">1747</th><td><em>int</em></td></tr>
<tr><th id="1748">1748</th><td><dfn class="decl def fn" id="auth_zone_get_serial" title='auth_zone_get_serial' data-ref="auth_zone_get_serial" data-ref-filename="auth_zone_get_serial">auth_zone_get_serial</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col1 decl" id="531z" title='z' data-type='struct auth_zone *' data-ref="531z" data-ref-filename="531z">z</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a>* <dfn class="local col2 decl" id="532serial" title='serial' data-type='uint32_t *' data-ref="532serial" data-ref-filename="532serial">serial</dfn>)</td></tr>
<tr><th id="1749">1749</th><td>{</td></tr>
<tr><th id="1750">1750</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col3 decl" id="533apex" title='apex' data-type='struct auth_data *' data-ref="533apex" data-ref-filename="533apex">apex</dfn>;</td></tr>
<tr><th id="1751">1751</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col4 decl" id="534soa" title='soa' data-type='struct auth_rrset *' data-ref="534soa" data-ref-filename="534soa">soa</dfn>;</td></tr>
<tr><th id="1752">1752</th><td>	<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>* <dfn class="local col5 decl" id="535d" title='d' data-type='struct packed_rrset_data *' data-ref="535d" data-ref-filename="535d">d</dfn>;</td></tr>
<tr><th id="1753">1753</th><td>	<a class="local col3 ref" href="#533apex" title='apex' data-ref="533apex" data-ref-filename="533apex">apex</a> = <a class="tu ref fn" href="#az_find_name" title='az_find_name' data-use='c' data-ref="az_find_name" data-ref-filename="az_find_name">az_find_name</a>(<a class="local col1 ref" href="#531z" title='z' data-ref="531z" data-ref-filename="531z">z</a>, <a class="local col1 ref" href="#531z" title='z' data-ref="531z" data-ref-filename="531z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::name" title='auth_zone::name' data-ref="auth_zone::name" data-ref-filename="auth_zone..name">name</a>, <a class="local col1 ref" href="#531z" title='z' data-ref="531z" data-ref-filename="531z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::namelen" title='auth_zone::namelen' data-ref="auth_zone::namelen" data-ref-filename="auth_zone..namelen">namelen</a>);</td></tr>
<tr><th id="1754">1754</th><td>	<b>if</b>(!<a class="local col3 ref" href="#533apex" title='apex' data-ref="533apex" data-ref-filename="533apex">apex</a>) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="1755">1755</th><td>	<a class="local col4 ref" href="#534soa" title='soa' data-ref="534soa" data-ref-filename="534soa">soa</a> = <a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(<a class="local col3 ref" href="#533apex" title='apex' data-ref="533apex" data-ref-filename="533apex">apex</a>, <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_SOA" title='LDNS_RR_TYPE_SOA' data-ref="LDNS_RR_TYPE_SOA" data-ref-filename="LDNS_RR_TYPE_SOA">LDNS_RR_TYPE_SOA</a>);</td></tr>
<tr><th id="1756">1756</th><td>	<b>if</b>(!<a class="local col4 ref" href="#534soa" title='soa' data-ref="534soa" data-ref-filename="534soa">soa</a> || <a class="local col4 ref" href="#534soa" title='soa' data-ref="534soa" data-ref-filename="534soa">soa</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>==<var>0</var>)</td></tr>
<tr><th id="1757">1757</th><td>		<b>return</b> <var>0</var>; <i>/* no RRset or no RRs in rrset */</i></td></tr>
<tr><th id="1758">1758</th><td>	<b>if</b>(<a class="local col4 ref" href="#534soa" title='soa' data-ref="534soa" data-ref-filename="534soa">soa</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<var>0</var>] &lt; <var>2</var>+<var>4</var>*<var>5</var>) <b>return</b> <var>0</var>; <i>/* SOA too short */</i></td></tr>
<tr><th id="1759">1759</th><td>	<a class="local col5 ref" href="#535d" title='d' data-ref="535d" data-ref-filename="535d">d</a> = <a class="local col4 ref" href="#534soa" title='soa' data-ref="534soa" data-ref-filename="534soa">soa</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>;</td></tr>
<tr><th id="1760">1760</th><td>	*<a class="local col2 ref" href="#532serial" title='serial' data-ref="532serial" data-ref-filename="532serial">serial</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_read_uint32" title='sldns_read_uint32' data-ref="sldns_read_uint32" data-ref-filename="sldns_read_uint32">sldns_read_uint32</a>(<a class="local col5 ref" href="#535d" title='d' data-ref="535d" data-ref-filename="535d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<var>0</var>]+(<a class="local col5 ref" href="#535d" title='d' data-ref="535d" data-ref-filename="535d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<var>0</var>]-<var>20</var>));</td></tr>
<tr><th id="1761">1761</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1762">1762</th><td>}</td></tr>
<tr><th id="1763">1763</th><td></td></tr>
<tr><th id="1764">1764</th><td><i class="doc" data-doc="xfr_find_soa">/** Find auth_zone SOA and populate the values in xfr(soa values). */</i></td></tr>
<tr><th id="1765">1765</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="1766">1766</th><td><dfn class="tu decl def fn" id="xfr_find_soa" title='xfr_find_soa' data-type='int xfr_find_soa(struct auth_zone * z, struct auth_xfer * xfr)' data-ref="xfr_find_soa" data-ref-filename="xfr_find_soa">xfr_find_soa</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col6 decl" id="536z" title='z' data-type='struct auth_zone *' data-ref="536z" data-ref-filename="536z">z</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col7 decl" id="537xfr" title='xfr' data-type='struct auth_xfer *' data-ref="537xfr" data-ref-filename="537xfr">xfr</dfn>)</td></tr>
<tr><th id="1767">1767</th><td>{</td></tr>
<tr><th id="1768">1768</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col8 decl" id="538apex" title='apex' data-type='struct auth_data *' data-ref="538apex" data-ref-filename="538apex">apex</dfn>;</td></tr>
<tr><th id="1769">1769</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col9 decl" id="539soa" title='soa' data-type='struct auth_rrset *' data-ref="539soa" data-ref-filename="539soa">soa</dfn>;</td></tr>
<tr><th id="1770">1770</th><td>	<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>* <dfn class="local col0 decl" id="540d" title='d' data-type='struct packed_rrset_data *' data-ref="540d" data-ref-filename="540d">d</dfn>;</td></tr>
<tr><th id="1771">1771</th><td>	<a class="local col8 ref" href="#538apex" title='apex' data-ref="538apex" data-ref-filename="538apex">apex</a> = <a class="tu ref fn" href="#az_find_name" title='az_find_name' data-use='c' data-ref="az_find_name" data-ref-filename="az_find_name">az_find_name</a>(<a class="local col6 ref" href="#536z" title='z' data-ref="536z" data-ref-filename="536z">z</a>, <a class="local col6 ref" href="#536z" title='z' data-ref="536z" data-ref-filename="536z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::name" title='auth_zone::name' data-ref="auth_zone::name" data-ref-filename="auth_zone..name">name</a>, <a class="local col6 ref" href="#536z" title='z' data-ref="536z" data-ref-filename="536z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::namelen" title='auth_zone::namelen' data-ref="auth_zone::namelen" data-ref-filename="auth_zone..namelen">namelen</a>);</td></tr>
<tr><th id="1772">1772</th><td>	<b>if</b>(!<a class="local col8 ref" href="#538apex" title='apex' data-ref="538apex" data-ref-filename="538apex">apex</a>) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="1773">1773</th><td>	<a class="local col9 ref" href="#539soa" title='soa' data-ref="539soa" data-ref-filename="539soa">soa</a> = <a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(<a class="local col8 ref" href="#538apex" title='apex' data-ref="538apex" data-ref-filename="538apex">apex</a>, <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_SOA" title='LDNS_RR_TYPE_SOA' data-ref="LDNS_RR_TYPE_SOA" data-ref-filename="LDNS_RR_TYPE_SOA">LDNS_RR_TYPE_SOA</a>);</td></tr>
<tr><th id="1774">1774</th><td>	<b>if</b>(!<a class="local col9 ref" href="#539soa" title='soa' data-ref="539soa" data-ref-filename="539soa">soa</a> || <a class="local col9 ref" href="#539soa" title='soa' data-ref="539soa" data-ref-filename="539soa">soa</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>==<var>0</var>)</td></tr>
<tr><th id="1775">1775</th><td>		<b>return</b> <var>0</var>; <i>/* no RRset or no RRs in rrset */</i></td></tr>
<tr><th id="1776">1776</th><td>	<b>if</b>(<a class="local col9 ref" href="#539soa" title='soa' data-ref="539soa" data-ref-filename="539soa">soa</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<var>0</var>] &lt; <var>2</var>+<var>4</var>*<var>5</var>) <b>return</b> <var>0</var>; <i>/* SOA too short */</i></td></tr>
<tr><th id="1777">1777</th><td>	<i>/* SOA record ends with serial, refresh, retry, expiry, minimum,</i></td></tr>
<tr><th id="1778">1778</th><td><i>	 * as 4 byte fields */</i></td></tr>
<tr><th id="1779">1779</th><td>	<a class="local col0 ref" href="#540d" title='d' data-ref="540d" data-ref-filename="540d">d</a> = <a class="local col9 ref" href="#539soa" title='soa' data-ref="539soa" data-ref-filename="539soa">soa</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>;</td></tr>
<tr><th id="1780">1780</th><td>	<a class="local col7 ref" href="#537xfr" title='xfr' data-ref="537xfr" data-ref-filename="537xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::have_zone" title='auth_xfer::have_zone' data-ref="auth_xfer::have_zone" data-ref-filename="auth_xfer..have_zone">have_zone</a> = <var>1</var>;</td></tr>
<tr><th id="1781">1781</th><td>	<a class="local col7 ref" href="#537xfr" title='xfr' data-ref="537xfr" data-ref-filename="537xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::serial" title='auth_xfer::serial' data-ref="auth_xfer::serial" data-ref-filename="auth_xfer..serial">serial</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_read_uint32" title='sldns_read_uint32' data-ref="sldns_read_uint32" data-ref-filename="sldns_read_uint32">sldns_read_uint32</a>(<a class="local col0 ref" href="#540d" title='d' data-ref="540d" data-ref-filename="540d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<var>0</var>]+(<a class="local col0 ref" href="#540d" title='d' data-ref="540d" data-ref-filename="540d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<var>0</var>]-<var>20</var>));</td></tr>
<tr><th id="1782">1782</th><td>	<a class="local col7 ref" href="#537xfr" title='xfr' data-ref="537xfr" data-ref-filename="537xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::refresh" title='auth_xfer::refresh' data-ref="auth_xfer::refresh" data-ref-filename="auth_xfer..refresh">refresh</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_read_uint32" title='sldns_read_uint32' data-ref="sldns_read_uint32" data-ref-filename="sldns_read_uint32">sldns_read_uint32</a>(<a class="local col0 ref" href="#540d" title='d' data-ref="540d" data-ref-filename="540d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<var>0</var>]+(<a class="local col0 ref" href="#540d" title='d' data-ref="540d" data-ref-filename="540d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<var>0</var>]-<var>16</var>));</td></tr>
<tr><th id="1783">1783</th><td>	<a class="local col7 ref" href="#537xfr" title='xfr' data-ref="537xfr" data-ref-filename="537xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::retry" title='auth_xfer::retry' data-ref="auth_xfer::retry" data-ref-filename="auth_xfer..retry">retry</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_read_uint32" title='sldns_read_uint32' data-ref="sldns_read_uint32" data-ref-filename="sldns_read_uint32">sldns_read_uint32</a>(<a class="local col0 ref" href="#540d" title='d' data-ref="540d" data-ref-filename="540d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<var>0</var>]+(<a class="local col0 ref" href="#540d" title='d' data-ref="540d" data-ref-filename="540d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<var>0</var>]-<var>12</var>));</td></tr>
<tr><th id="1784">1784</th><td>	<a class="local col7 ref" href="#537xfr" title='xfr' data-ref="537xfr" data-ref-filename="537xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::expiry" title='auth_xfer::expiry' data-ref="auth_xfer::expiry" data-ref-filename="auth_xfer..expiry">expiry</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_read_uint32" title='sldns_read_uint32' data-ref="sldns_read_uint32" data-ref-filename="sldns_read_uint32">sldns_read_uint32</a>(<a class="local col0 ref" href="#540d" title='d' data-ref="540d" data-ref-filename="540d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<var>0</var>]+(<a class="local col0 ref" href="#540d" title='d' data-ref="540d" data-ref-filename="540d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<var>0</var>]-<var>8</var>));</td></tr>
<tr><th id="1785">1785</th><td>	<i>/* soa minimum at d-&gt;rr_len[0]-4 */</i></td></tr>
<tr><th id="1786">1786</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1787">1787</th><td>}</td></tr>
<tr><th id="1788">1788</th><td></td></tr>
<tr><th id="1789">1789</th><td><i class="doc" data-doc="auth_xfer_setup">/** </i></td></tr>
<tr><th id="1790">1790</th><td><i class="doc" data-doc="auth_xfer_setup"> * Setup auth_xfer zone</i></td></tr>
<tr><th id="1791">1791</th><td><i class="doc" data-doc="auth_xfer_setup"> * This populates the have_zone, soa values, and so on times.</i></td></tr>
<tr><th id="1792">1792</th><td><i class="doc" data-doc="auth_xfer_setup"> * Doesn't do network traffic yet, can set option flags.</i></td></tr>
<tr><th id="1793">1793</th><td><i class="doc" data-doc="auth_xfer_setup"> * <span class="command">@param</span> <span class="arg">z:</span> locked by caller, and modified for setup</i></td></tr>
<tr><th id="1794">1794</th><td><i class="doc" data-doc="auth_xfer_setup"> * <span class="command">@param</span> <span class="arg">x:</span> locked by caller, and modified.</i></td></tr>
<tr><th id="1795">1795</th><td><i class="doc" data-doc="auth_xfer_setup"> * <span class="command">@return</span> false on failure.</i></td></tr>
<tr><th id="1796">1796</th><td><i class="doc" data-doc="auth_xfer_setup"> */</i></td></tr>
<tr><th id="1797">1797</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="1798">1798</th><td><dfn class="tu decl def fn" id="auth_xfer_setup" title='auth_xfer_setup' data-type='int auth_xfer_setup(struct auth_zone * z, struct auth_xfer * x)' data-ref="auth_xfer_setup" data-ref-filename="auth_xfer_setup">auth_xfer_setup</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col1 decl" id="541z" title='z' data-type='struct auth_zone *' data-ref="541z" data-ref-filename="541z">z</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col2 decl" id="542x" title='x' data-type='struct auth_xfer *' data-ref="542x" data-ref-filename="542x">x</dfn>)</td></tr>
<tr><th id="1799">1799</th><td>{</td></tr>
<tr><th id="1800">1800</th><td>	<i>/* for a zone without zone transfers, x==NULL, so skip them,</i></td></tr>
<tr><th id="1801">1801</th><td><i>	 * i.e. the zone config is fixed with no masters or urls */</i></td></tr>
<tr><th id="1802">1802</th><td>	<b>if</b>(!<a class="local col1 ref" href="#541z" title='z' data-ref="541z" data-ref-filename="541z">z</a> || !<a class="local col2 ref" href="#542x" title='x' data-ref="542x" data-ref-filename="542x">x</a>) <b>return</b> <var>1</var>;</td></tr>
<tr><th id="1803">1803</th><td>	<b>if</b>(!<a class="tu ref fn" href="#xfr_find_soa" title='xfr_find_soa' data-use='c' data-ref="xfr_find_soa" data-ref-filename="xfr_find_soa">xfr_find_soa</a>(<a class="local col1 ref" href="#541z" title='z' data-ref="541z" data-ref-filename="541z">z</a>, <a class="local col2 ref" href="#542x" title='x' data-ref="542x" data-ref-filename="542x">x</a>)) {</td></tr>
<tr><th id="1804">1804</th><td>		<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1805">1805</th><td>	}</td></tr>
<tr><th id="1806">1806</th><td>	<i>/* nothing for probe, nextprobe and transfer tasks */</i></td></tr>
<tr><th id="1807">1807</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1808">1808</th><td>}</td></tr>
<tr><th id="1809">1809</th><td></td></tr>
<tr><th id="1810">1810</th><td><i class="doc" data-doc="auth_zones_setup_zones">/**</i></td></tr>
<tr><th id="1811">1811</th><td><i class="doc" data-doc="auth_zones_setup_zones"> * Setup all zones</i></td></tr>
<tr><th id="1812">1812</th><td><i class="doc" data-doc="auth_zones_setup_zones"> * <span class="command">@param</span> <span class="arg">az:</span> auth zones structure</i></td></tr>
<tr><th id="1813">1813</th><td><i class="doc" data-doc="auth_zones_setup_zones"> * <span class="command">@return</span> false on failure.</i></td></tr>
<tr><th id="1814">1814</th><td><i class="doc" data-doc="auth_zones_setup_zones"> */</i></td></tr>
<tr><th id="1815">1815</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="1816">1816</th><td><dfn class="tu decl def fn" id="auth_zones_setup_zones" title='auth_zones_setup_zones' data-type='int auth_zones_setup_zones(struct auth_zones * az)' data-ref="auth_zones_setup_zones" data-ref-filename="auth_zones_setup_zones">auth_zones_setup_zones</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zones" title='auth_zones' data-ref="auth_zones" data-ref-filename="auth_zones">auth_zones</a>* <dfn class="local col3 decl" id="543az" title='az' data-type='struct auth_zones *' data-ref="543az" data-ref-filename="543az">az</dfn>)</td></tr>
<tr><th id="1817">1817</th><td>{</td></tr>
<tr><th id="1818">1818</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col4 decl" id="544z" title='z' data-type='struct auth_zone *' data-ref="544z" data-ref-filename="544z">z</dfn>;</td></tr>
<tr><th id="1819">1819</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col5 decl" id="545x" title='x' data-type='struct auth_xfer *' data-ref="545x" data-ref-filename="545x">x</dfn>;</td></tr>
<tr><th id="1820">1820</th><td>	<a class="macro" href="../util/locks.h.html#120" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_wrlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_wrlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1820, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_wrlock">lock_rw_wrlock</a>(&amp;<a class="local col3 ref" href="#543az" title='az' data-ref="543az" data-ref-filename="543az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="1821">1821</th><td>	<a class="macro" href="../util/rbtree.h.html#173" title="for(z=(struct auth_zone*)rbtree_first(&amp;az-&gt;ztree); (rbnode_type*)z != &amp;rbtree_null_node; z = (struct auth_zone*)rbtree_next((rbnode_type*)z))" data-ref="_M/RBTREE_FOR">RBTREE_FOR</a>(<a class="local col4 ref" href="#544z" title='z' data-ref="544z" data-ref-filename="544z">z</a>, <b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>*, &amp;<a class="local col3 ref" href="#543az" title='az' data-ref="543az" data-ref-filename="543az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::ztree" title='auth_zones::ztree' data-ref="auth_zones::ztree" data-ref-filename="auth_zones..ztree">ztree</a>) {</td></tr>
<tr><th id="1822">1822</th><td>		<a class="macro" href="../util/locks.h.html#120" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_wrlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_wrlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1822, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_wrlock">lock_rw_wrlock</a>(&amp;<a class="local col4 ref" href="#544z" title='z' data-ref="544z" data-ref-filename="544z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="1823">1823</th><td>		<a class="local col5 ref" href="#545x" title='x' data-ref="545x" data-ref-filename="545x">x</a> = <a class="ref fn" href="#auth_xfer_find" title='auth_xfer_find' data-ref="auth_xfer_find" data-ref-filename="auth_xfer_find">auth_xfer_find</a>(<a class="local col3 ref" href="#543az" title='az' data-ref="543az" data-ref-filename="543az">az</a>, <a class="local col4 ref" href="#544z" title='z' data-ref="544z" data-ref-filename="544z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::name" title='auth_zone::name' data-ref="auth_zone::name" data-ref-filename="auth_zone..name">name</a>, <a class="local col4 ref" href="#544z" title='z' data-ref="544z" data-ref-filename="544z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::namelen" title='auth_zone::namelen' data-ref="auth_zone::namelen" data-ref-filename="auth_zone..namelen">namelen</a>, <a class="local col4 ref" href="#544z" title='z' data-ref="544z" data-ref-filename="544z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::dclass" title='auth_zone::dclass' data-ref="auth_zone::dclass" data-ref-filename="auth_zone..dclass">dclass</a>);</td></tr>
<tr><th id="1824">1824</th><td>		<b>if</b>(<a class="local col5 ref" href="#545x" title='x' data-ref="545x" data-ref-filename="545x">x</a>) {</td></tr>
<tr><th id="1825">1825</th><td>			<a class="macro" href="../util/locks.h.html#102" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_lock(&amp;x-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_lock(&amp;x-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1825, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_lock">lock_basic_lock</a>(&amp;<a class="local col5 ref" href="#545x" title='x' data-ref="545x" data-ref-filename="545x">x</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="1826">1826</th><td>		}</td></tr>
<tr><th id="1827">1827</th><td>		<b>if</b>(!<a class="tu ref fn" href="#auth_xfer_setup" title='auth_xfer_setup' data-use='c' data-ref="auth_xfer_setup" data-ref-filename="auth_xfer_setup">auth_xfer_setup</a>(<a class="local col4 ref" href="#544z" title='z' data-ref="544z" data-ref-filename="544z">z</a>, <a class="local col5 ref" href="#545x" title='x' data-ref="545x" data-ref-filename="545x">x</a>)) {</td></tr>
<tr><th id="1828">1828</th><td>			<b>if</b>(<a class="local col5 ref" href="#545x" title='x' data-ref="545x" data-ref-filename="545x">x</a>) {</td></tr>
<tr><th id="1829">1829</th><td>				<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;x-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;x-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1829, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col5 ref" href="#545x" title='x' data-ref="545x" data-ref-filename="545x">x</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="1830">1830</th><td>			}</td></tr>
<tr><th id="1831">1831</th><td>			<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1831, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col4 ref" href="#544z" title='z' data-ref="544z" data-ref-filename="544z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="1832">1832</th><td>			<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1832, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col3 ref" href="#543az" title='az' data-ref="543az" data-ref-filename="543az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="1833">1833</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1834">1834</th><td>		}</td></tr>
<tr><th id="1835">1835</th><td>		<b>if</b>(<a class="local col5 ref" href="#545x" title='x' data-ref="545x" data-ref-filename="545x">x</a>) {</td></tr>
<tr><th id="1836">1836</th><td>			<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;x-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;x-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1836, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col5 ref" href="#545x" title='x' data-ref="545x" data-ref-filename="545x">x</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="1837">1837</th><td>		}</td></tr>
<tr><th id="1838">1838</th><td>		<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1838, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col4 ref" href="#544z" title='z' data-ref="544z" data-ref-filename="544z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="1839">1839</th><td>	}</td></tr>
<tr><th id="1840">1840</th><td>	<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1840, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col3 ref" href="#543az" title='az' data-ref="543az" data-ref-filename="543az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="1841">1841</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1842">1842</th><td>}</td></tr>
<tr><th id="1843">1843</th><td></td></tr>
<tr><th id="1844">1844</th><td><i class="doc" data-doc="auth_zones_cfg">/** set config items and create zones */</i></td></tr>
<tr><th id="1845">1845</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="1846">1846</th><td><dfn class="tu decl def fn" id="auth_zones_cfg" title='auth_zones_cfg' data-type='int auth_zones_cfg(struct auth_zones * az, struct config_auth * c)' data-ref="auth_zones_cfg" data-ref-filename="auth_zones_cfg">auth_zones_cfg</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zones" title='auth_zones' data-ref="auth_zones" data-ref-filename="auth_zones">auth_zones</a>* <dfn class="local col6 decl" id="546az" title='az' data-type='struct auth_zones *' data-ref="546az" data-ref-filename="546az">az</dfn>, <b>struct</b> <a class="type" href="../util/config_file.h.html#config_auth" title='config_auth' data-ref="config_auth" data-ref-filename="config_auth">config_auth</a>* <dfn class="local col7 decl" id="547c" title='c' data-type='struct config_auth *' data-ref="547c" data-ref-filename="547c">c</dfn>)</td></tr>
<tr><th id="1847">1847</th><td>{</td></tr>
<tr><th id="1848">1848</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col8 decl" id="548z" title='z' data-type='struct auth_zone *' data-ref="548z" data-ref-filename="548z">z</dfn>;</td></tr>
<tr><th id="1849">1849</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col9 decl" id="549x" title='x' data-type='struct auth_xfer *' data-ref="549x" data-ref-filename="549x">x</dfn> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="1850">1850</th><td></td></tr>
<tr><th id="1851">1851</th><td>	<i>/* create zone */</i></td></tr>
<tr><th id="1852">1852</th><td>	<a class="macro" href="../util/locks.h.html#120" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_wrlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_wrlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1852, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_wrlock">lock_rw_wrlock</a>(&amp;<a class="local col6 ref" href="#546az" title='az' data-ref="546az" data-ref-filename="546az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="1853">1853</th><td>	<b>if</b>(!(<a class="local col8 ref" href="#548z" title='z' data-ref="548z" data-ref-filename="548z">z</a>=<a class="tu ref fn" href="#auth_zones_find_or_add_zone" title='auth_zones_find_or_add_zone' data-use='c' data-ref="auth_zones_find_or_add_zone" data-ref-filename="auth_zones_find_or_add_zone">auth_zones_find_or_add_zone</a>(<a class="local col6 ref" href="#546az" title='az' data-ref="546az" data-ref-filename="546az">az</a>, <a class="local col7 ref" href="#547c" title='c' data-ref="547c" data-ref-filename="547c">c</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_auth::name" title='config_auth::name' data-ref="config_auth::name" data-ref-filename="config_auth..name">name</a>))) {</td></tr>
<tr><th id="1854">1854</th><td>		<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1854, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col6 ref" href="#546az" title='az' data-ref="546az" data-ref-filename="546az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="1855">1855</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1856">1856</th><td>	}</td></tr>
<tr><th id="1857">1857</th><td>	<b>if</b>(<a class="local col7 ref" href="#547c" title='c' data-ref="547c" data-ref-filename="547c">c</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_auth::masters" title='config_auth::masters' data-ref="config_auth::masters" data-ref-filename="config_auth..masters">masters</a> || <a class="local col7 ref" href="#547c" title='c' data-ref="547c" data-ref-filename="547c">c</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_auth::urls" title='config_auth::urls' data-ref="config_auth::urls" data-ref-filename="config_auth..urls">urls</a>) {</td></tr>
<tr><th id="1858">1858</th><td>		<b>if</b>(!(<a class="local col9 ref" href="#549x" title='x' data-ref="549x" data-ref-filename="549x">x</a>=<a class="tu ref fn" href="#auth_zones_find_or_add_xfer" title='auth_zones_find_or_add_xfer' data-use='c' data-ref="auth_zones_find_or_add_xfer" data-ref-filename="auth_zones_find_or_add_xfer">auth_zones_find_or_add_xfer</a>(<a class="local col6 ref" href="#546az" title='az' data-ref="546az" data-ref-filename="546az">az</a>, <a class="local col8 ref" href="#548z" title='z' data-ref="548z" data-ref-filename="548z">z</a>))) {</td></tr>
<tr><th id="1859">1859</th><td>			<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1859, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col6 ref" href="#546az" title='az' data-ref="546az" data-ref-filename="546az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="1860">1860</th><td>			<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1860, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col8 ref" href="#548z" title='z' data-ref="548z" data-ref-filename="548z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="1861">1861</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1862">1862</th><td>		}</td></tr>
<tr><th id="1863">1863</th><td>	}</td></tr>
<tr><th id="1864">1864</th><td>	<b>if</b>(<a class="local col7 ref" href="#547c" title='c' data-ref="547c" data-ref-filename="547c">c</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_auth::for_downstream" title='config_auth::for_downstream' data-ref="config_auth::for_downstream" data-ref-filename="config_auth..for_downstream">for_downstream</a>)</td></tr>
<tr><th id="1865">1865</th><td>		<a class="local col6 ref" href="#546az" title='az' data-ref="546az" data-ref-filename="546az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::have_downstream" title='auth_zones::have_downstream' data-ref="auth_zones::have_downstream" data-ref-filename="auth_zones..have_downstream">have_downstream</a> = <var>1</var>;</td></tr>
<tr><th id="1866">1866</th><td>	<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1866, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col6 ref" href="#546az" title='az' data-ref="546az" data-ref-filename="546az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="1867">1867</th><td></td></tr>
<tr><th id="1868">1868</th><td>	<i>/* set options */</i></td></tr>
<tr><th id="1869">1869</th><td>	<a class="local col8 ref" href="#548z" title='z' data-ref="548z" data-ref-filename="548z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::zone_deleted" title='auth_zone::zone_deleted' data-ref="auth_zone::zone_deleted" data-ref-filename="auth_zone..zone_deleted">zone_deleted</a> = <var>0</var>;</td></tr>
<tr><th id="1870">1870</th><td>	<b>if</b>(!<a class="ref fn" href="#auth_zone_set_zonefile" title='auth_zone_set_zonefile' data-ref="auth_zone_set_zonefile" data-ref-filename="auth_zone_set_zonefile">auth_zone_set_zonefile</a>(<a class="local col8 ref" href="#548z" title='z' data-ref="548z" data-ref-filename="548z">z</a>, <a class="local col7 ref" href="#547c" title='c' data-ref="547c" data-ref-filename="547c">c</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_auth::zonefile" title='config_auth::zonefile' data-ref="config_auth::zonefile" data-ref-filename="config_auth..zonefile">zonefile</a>)) {</td></tr>
<tr><th id="1871">1871</th><td>		<b>if</b>(<a class="local col9 ref" href="#549x" title='x' data-ref="549x" data-ref-filename="549x">x</a>) {</td></tr>
<tr><th id="1872">1872</th><td>			<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;x-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;x-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1872, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col9 ref" href="#549x" title='x' data-ref="549x" data-ref-filename="549x">x</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="1873">1873</th><td>		}</td></tr>
<tr><th id="1874">1874</th><td>		<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1874, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col8 ref" href="#548z" title='z' data-ref="548z" data-ref-filename="548z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="1875">1875</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1876">1876</th><td>	}</td></tr>
<tr><th id="1877">1877</th><td>	<a class="local col8 ref" href="#548z" title='z' data-ref="548z" data-ref-filename="548z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::for_downstream" title='auth_zone::for_downstream' data-ref="auth_zone::for_downstream" data-ref-filename="auth_zone..for_downstream">for_downstream</a> = <a class="local col7 ref" href="#547c" title='c' data-ref="547c" data-ref-filename="547c">c</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_auth::for_downstream" title='config_auth::for_downstream' data-ref="config_auth::for_downstream" data-ref-filename="config_auth..for_downstream">for_downstream</a>;</td></tr>
<tr><th id="1878">1878</th><td>	<a class="local col8 ref" href="#548z" title='z' data-ref="548z" data-ref-filename="548z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::for_upstream" title='auth_zone::for_upstream' data-ref="auth_zone::for_upstream" data-ref-filename="auth_zone..for_upstream">for_upstream</a> = <a class="local col7 ref" href="#547c" title='c' data-ref="547c" data-ref-filename="547c">c</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_auth::for_upstream" title='config_auth::for_upstream' data-ref="config_auth::for_upstream" data-ref-filename="config_auth..for_upstream">for_upstream</a>;</td></tr>
<tr><th id="1879">1879</th><td>	<a class="local col8 ref" href="#548z" title='z' data-ref="548z" data-ref-filename="548z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::fallback_enabled" title='auth_zone::fallback_enabled' data-ref="auth_zone::fallback_enabled" data-ref-filename="auth_zone..fallback_enabled">fallback_enabled</a> = <a class="local col7 ref" href="#547c" title='c' data-ref="547c" data-ref-filename="547c">c</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_auth::fallback_enabled" title='config_auth::fallback_enabled' data-ref="config_auth::fallback_enabled" data-ref-filename="config_auth..fallback_enabled">fallback_enabled</a>;</td></tr>
<tr><th id="1880">1880</th><td></td></tr>
<tr><th id="1881">1881</th><td>	<i>/* xfer zone */</i></td></tr>
<tr><th id="1882">1882</th><td>	<b>if</b>(<a class="local col9 ref" href="#549x" title='x' data-ref="549x" data-ref-filename="549x">x</a>) {</td></tr>
<tr><th id="1883">1883</th><td>		<a class="local col8 ref" href="#548z" title='z' data-ref="548z" data-ref-filename="548z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::zone_is_slave" title='auth_zone::zone_is_slave' data-ref="auth_zone::zone_is_slave" data-ref-filename="auth_zone..zone_is_slave">zone_is_slave</a> = <var>1</var>;</td></tr>
<tr><th id="1884">1884</th><td>		<i>/* set options on xfer zone */</i></td></tr>
<tr><th id="1885">1885</th><td>		<b>if</b>(!<a class="ref fn" href="#xfer_set_masters" title='xfer_set_masters' data-ref="xfer_set_masters" data-ref-filename="xfer_set_masters">xfer_set_masters</a>(&amp;<a class="local col9 ref" href="#549x" title='x' data-ref="549x" data-ref-filename="549x">x</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::masters" title='auth_probe::masters' data-ref="auth_probe::masters" data-ref-filename="auth_probe..masters">masters</a>, <a class="local col7 ref" href="#547c" title='c' data-ref="547c" data-ref-filename="547c">c</a>, <var>0</var>)) {</td></tr>
<tr><th id="1886">1886</th><td>			<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;x-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;x-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1886, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col9 ref" href="#549x" title='x' data-ref="549x" data-ref-filename="549x">x</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="1887">1887</th><td>			<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1887, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col8 ref" href="#548z" title='z' data-ref="548z" data-ref-filename="548z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="1888">1888</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1889">1889</th><td>		}</td></tr>
<tr><th id="1890">1890</th><td>		<b>if</b>(!<a class="ref fn" href="#xfer_set_masters" title='xfer_set_masters' data-ref="xfer_set_masters" data-ref-filename="xfer_set_masters">xfer_set_masters</a>(&amp;<a class="local col9 ref" href="#549x" title='x' data-ref="549x" data-ref-filename="549x">x</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::masters" title='auth_transfer::masters' data-ref="auth_transfer::masters" data-ref-filename="auth_transfer..masters">masters</a>, <a class="local col7 ref" href="#547c" title='c' data-ref="547c" data-ref-filename="547c">c</a>, <var>1</var>)) {</td></tr>
<tr><th id="1891">1891</th><td>			<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;x-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;x-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1891, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col9 ref" href="#549x" title='x' data-ref="549x" data-ref-filename="549x">x</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="1892">1892</th><td>			<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1892, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col8 ref" href="#548z" title='z' data-ref="548z" data-ref-filename="548z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="1893">1893</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1894">1894</th><td>		}</td></tr>
<tr><th id="1895">1895</th><td>		<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;x-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;x-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1895, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col9 ref" href="#549x" title='x' data-ref="549x" data-ref-filename="549x">x</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="1896">1896</th><td>	}</td></tr>
<tr><th id="1897">1897</th><td></td></tr>
<tr><th id="1898">1898</th><td>	<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1898, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col8 ref" href="#548z" title='z' data-ref="548z" data-ref-filename="548z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="1899">1899</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1900">1900</th><td>}</td></tr>
<tr><th id="1901">1901</th><td></td></tr>
<tr><th id="1902">1902</th><td><i class="doc" data-doc="az_setall_deleted">/** set all auth zones deleted, then in auth_zones_cfg, it marks them</i></td></tr>
<tr><th id="1903">1903</th><td><i class="doc" data-doc="az_setall_deleted"> * as nondeleted (if they are still in the config), and then later</i></td></tr>
<tr><th id="1904">1904</th><td><i class="doc" data-doc="az_setall_deleted"> * we can find deleted zones */</i></td></tr>
<tr><th id="1905">1905</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="1906">1906</th><td><dfn class="tu decl def fn" id="az_setall_deleted" title='az_setall_deleted' data-type='void az_setall_deleted(struct auth_zones * az)' data-ref="az_setall_deleted" data-ref-filename="az_setall_deleted">az_setall_deleted</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zones" title='auth_zones' data-ref="auth_zones" data-ref-filename="auth_zones">auth_zones</a>* <dfn class="local col0 decl" id="550az" title='az' data-type='struct auth_zones *' data-ref="550az" data-ref-filename="550az">az</dfn>)</td></tr>
<tr><th id="1907">1907</th><td>{</td></tr>
<tr><th id="1908">1908</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col1 decl" id="551z" title='z' data-type='struct auth_zone *' data-ref="551z" data-ref-filename="551z">z</dfn>;</td></tr>
<tr><th id="1909">1909</th><td>	<a class="macro" href="../util/locks.h.html#120" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_wrlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_wrlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1909, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_wrlock">lock_rw_wrlock</a>(&amp;<a class="local col0 ref" href="#550az" title='az' data-ref="550az" data-ref-filename="550az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="1910">1910</th><td>	<a class="macro" href="../util/rbtree.h.html#173" title="for(z=(struct auth_zone*)rbtree_first(&amp;az-&gt;ztree); (rbnode_type*)z != &amp;rbtree_null_node; z = (struct auth_zone*)rbtree_next((rbnode_type*)z))" data-ref="_M/RBTREE_FOR">RBTREE_FOR</a>(<a class="local col1 ref" href="#551z" title='z' data-ref="551z" data-ref-filename="551z">z</a>, <b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>*, &amp;<a class="local col0 ref" href="#550az" title='az' data-ref="550az" data-ref-filename="550az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::ztree" title='auth_zones::ztree' data-ref="auth_zones::ztree" data-ref-filename="auth_zones..ztree">ztree</a>) {</td></tr>
<tr><th id="1911">1911</th><td>		<a class="macro" href="../util/locks.h.html#120" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_wrlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_wrlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1911, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_wrlock">lock_rw_wrlock</a>(&amp;<a class="local col1 ref" href="#551z" title='z' data-ref="551z" data-ref-filename="551z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="1912">1912</th><td>		<a class="local col1 ref" href="#551z" title='z' data-ref="551z" data-ref-filename="551z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::zone_deleted" title='auth_zone::zone_deleted' data-ref="auth_zone::zone_deleted" data-ref-filename="auth_zone..zone_deleted">zone_deleted</a> = <var>1</var>;</td></tr>
<tr><th id="1913">1913</th><td>		<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1913, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col1 ref" href="#551z" title='z' data-ref="551z" data-ref-filename="551z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="1914">1914</th><td>	}</td></tr>
<tr><th id="1915">1915</th><td>	<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1915, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col0 ref" href="#550az" title='az' data-ref="550az" data-ref-filename="550az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="1916">1916</th><td>}</td></tr>
<tr><th id="1917">1917</th><td></td></tr>
<tr><th id="1918">1918</th><td><i class="doc" data-doc="az_delete_deleted_zones">/** find zones that are marked deleted and delete them.</i></td></tr>
<tr><th id="1919">1919</th><td><i class="doc" data-doc="az_delete_deleted_zones"> * This is called from apply_cfg, and there are no threads and no</i></td></tr>
<tr><th id="1920">1920</th><td><i class="doc" data-doc="az_delete_deleted_zones"> * workers, so the xfr can just be deleted. */</i></td></tr>
<tr><th id="1921">1921</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="1922">1922</th><td><dfn class="tu decl def fn" id="az_delete_deleted_zones" title='az_delete_deleted_zones' data-type='void az_delete_deleted_zones(struct auth_zones * az)' data-ref="az_delete_deleted_zones" data-ref-filename="az_delete_deleted_zones">az_delete_deleted_zones</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zones" title='auth_zones' data-ref="auth_zones" data-ref-filename="auth_zones">auth_zones</a>* <dfn class="local col2 decl" id="552az" title='az' data-type='struct auth_zones *' data-ref="552az" data-ref-filename="552az">az</dfn>)</td></tr>
<tr><th id="1923">1923</th><td>{</td></tr>
<tr><th id="1924">1924</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col3 decl" id="553z" title='z' data-type='struct auth_zone *' data-ref="553z" data-ref-filename="553z">z</dfn>;</td></tr>
<tr><th id="1925">1925</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col4 decl" id="554delete_list" title='delete_list' data-type='struct auth_zone *' data-ref="554delete_list" data-ref-filename="554delete_list">delete_list</dfn> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>, *<dfn class="local col5 decl" id="555next" title='next' data-type='struct auth_zone *' data-ref="555next" data-ref-filename="555next">next</dfn>;</td></tr>
<tr><th id="1926">1926</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col6 decl" id="556xfr" title='xfr' data-type='struct auth_xfer *' data-ref="556xfr" data-ref-filename="556xfr">xfr</dfn>;</td></tr>
<tr><th id="1927">1927</th><td>	<a class="macro" href="../util/locks.h.html#120" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_wrlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_wrlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1927, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_wrlock">lock_rw_wrlock</a>(&amp;<a class="local col2 ref" href="#552az" title='az' data-ref="552az" data-ref-filename="552az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="1928">1928</th><td>	<a class="macro" href="../util/rbtree.h.html#173" title="for(z=(struct auth_zone*)rbtree_first(&amp;az-&gt;ztree); (rbnode_type*)z != &amp;rbtree_null_node; z = (struct auth_zone*)rbtree_next((rbnode_type*)z))" data-ref="_M/RBTREE_FOR">RBTREE_FOR</a>(<a class="local col3 ref" href="#553z" title='z' data-ref="553z" data-ref-filename="553z">z</a>, <b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>*, &amp;<a class="local col2 ref" href="#552az" title='az' data-ref="552az" data-ref-filename="552az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::ztree" title='auth_zones::ztree' data-ref="auth_zones::ztree" data-ref-filename="auth_zones..ztree">ztree</a>) {</td></tr>
<tr><th id="1929">1929</th><td>		<a class="macro" href="../util/locks.h.html#120" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_wrlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_wrlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1929, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_wrlock">lock_rw_wrlock</a>(&amp;<a class="local col3 ref" href="#553z" title='z' data-ref="553z" data-ref-filename="553z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="1930">1930</th><td>		<b>if</b>(<a class="local col3 ref" href="#553z" title='z' data-ref="553z" data-ref-filename="553z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::zone_deleted" title='auth_zone::zone_deleted' data-ref="auth_zone::zone_deleted" data-ref-filename="auth_zone..zone_deleted">zone_deleted</a>) {</td></tr>
<tr><th id="1931">1931</th><td>			<i>/* we cannot alter the rbtree right now, but</i></td></tr>
<tr><th id="1932">1932</th><td><i>			 * we can put it on a linked list and then</i></td></tr>
<tr><th id="1933">1933</th><td><i>			 * delete it */</i></td></tr>
<tr><th id="1934">1934</th><td>			<a class="local col3 ref" href="#553z" title='z' data-ref="553z" data-ref-filename="553z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::delete_next" title='auth_zone::delete_next' data-ref="auth_zone::delete_next" data-ref-filename="auth_zone..delete_next">delete_next</a> = <a class="local col4 ref" href="#554delete_list" title='delete_list' data-ref="554delete_list" data-ref-filename="554delete_list">delete_list</a>;</td></tr>
<tr><th id="1935">1935</th><td>			<a class="local col4 ref" href="#554delete_list" title='delete_list' data-ref="554delete_list" data-ref-filename="554delete_list">delete_list</a> = <a class="local col3 ref" href="#553z" title='z' data-ref="553z" data-ref-filename="553z">z</a>;</td></tr>
<tr><th id="1936">1936</th><td>		}</td></tr>
<tr><th id="1937">1937</th><td>		<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1937, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col3 ref" href="#553z" title='z' data-ref="553z" data-ref-filename="553z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="1938">1938</th><td>	}</td></tr>
<tr><th id="1939">1939</th><td>	<i>/* now we are out of the tree loop and we can loop and delete</i></td></tr>
<tr><th id="1940">1940</th><td><i>	 * the zones */</i></td></tr>
<tr><th id="1941">1941</th><td>	<a class="local col3 ref" href="#553z" title='z' data-ref="553z" data-ref-filename="553z">z</a> = <a class="local col4 ref" href="#554delete_list" title='delete_list' data-ref="554delete_list" data-ref-filename="554delete_list">delete_list</a>;</td></tr>
<tr><th id="1942">1942</th><td>	<b>while</b>(<a class="local col3 ref" href="#553z" title='z' data-ref="553z" data-ref-filename="553z">z</a>) {</td></tr>
<tr><th id="1943">1943</th><td>		<a class="local col5 ref" href="#555next" title='next' data-ref="555next" data-ref-filename="555next">next</a> = <a class="local col3 ref" href="#553z" title='z' data-ref="553z" data-ref-filename="553z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::delete_next" title='auth_zone::delete_next' data-ref="auth_zone::delete_next" data-ref-filename="auth_zone..delete_next">delete_next</a>;</td></tr>
<tr><th id="1944">1944</th><td>		<a class="local col6 ref" href="#556xfr" title='xfr' data-ref="556xfr" data-ref-filename="556xfr">xfr</a> = <a class="ref fn" href="#auth_xfer_find" title='auth_xfer_find' data-ref="auth_xfer_find" data-ref-filename="auth_xfer_find">auth_xfer_find</a>(<a class="local col2 ref" href="#552az" title='az' data-ref="552az" data-ref-filename="552az">az</a>, <a class="local col3 ref" href="#553z" title='z' data-ref="553z" data-ref-filename="553z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::name" title='auth_zone::name' data-ref="auth_zone::name" data-ref-filename="auth_zone..name">name</a>, <a class="local col3 ref" href="#553z" title='z' data-ref="553z" data-ref-filename="553z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::namelen" title='auth_zone::namelen' data-ref="auth_zone::namelen" data-ref-filename="auth_zone..namelen">namelen</a>, <a class="local col3 ref" href="#553z" title='z' data-ref="553z" data-ref-filename="553z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::dclass" title='auth_zone::dclass' data-ref="auth_zone::dclass" data-ref-filename="auth_zone..dclass">dclass</a>);</td></tr>
<tr><th id="1945">1945</th><td>		<b>if</b>(<a class="local col6 ref" href="#556xfr" title='xfr' data-ref="556xfr" data-ref-filename="556xfr">xfr</a>) {</td></tr>
<tr><th id="1946">1946</th><td>			(<em>void</em>)<a class="ref fn" href="../util/rbtree.h.html#rbtree_delete" title='rbtree_delete' data-ref="rbtree_delete" data-ref-filename="rbtree_delete">rbtree_delete</a>(&amp;<a class="local col2 ref" href="#552az" title='az' data-ref="552az" data-ref-filename="552az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::xtree" title='auth_zones::xtree' data-ref="auth_zones::xtree" data-ref-filename="auth_zones..xtree">xtree</a>, &amp;<a class="local col6 ref" href="#556xfr" title='xfr' data-ref="556xfr" data-ref-filename="556xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::node" title='auth_xfer::node' data-ref="auth_xfer::node" data-ref-filename="auth_xfer..node">node</a>);</td></tr>
<tr><th id="1947">1947</th><td>			<a class="ref fn" href="#auth_xfer_delete" title='auth_xfer_delete' data-ref="auth_xfer_delete" data-ref-filename="auth_xfer_delete">auth_xfer_delete</a>(<a class="local col6 ref" href="#556xfr" title='xfr' data-ref="556xfr" data-ref-filename="556xfr">xfr</a>);</td></tr>
<tr><th id="1948">1948</th><td>		}</td></tr>
<tr><th id="1949">1949</th><td>		(<em>void</em>)<a class="ref fn" href="../util/rbtree.h.html#rbtree_delete" title='rbtree_delete' data-ref="rbtree_delete" data-ref-filename="rbtree_delete">rbtree_delete</a>(&amp;<a class="local col2 ref" href="#552az" title='az' data-ref="552az" data-ref-filename="552az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::ztree" title='auth_zones::ztree' data-ref="auth_zones::ztree" data-ref-filename="auth_zones..ztree">ztree</a>, &amp;<a class="local col3 ref" href="#553z" title='z' data-ref="553z" data-ref-filename="553z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::node" title='auth_zone::node' data-ref="auth_zone::node" data-ref-filename="auth_zone..node">node</a>);</td></tr>
<tr><th id="1950">1950</th><td>		<a class="tu ref fn" href="#auth_zone_delete" title='auth_zone_delete' data-use='c' data-ref="auth_zone_delete" data-ref-filename="auth_zone_delete">auth_zone_delete</a>(<a class="local col3 ref" href="#553z" title='z' data-ref="553z" data-ref-filename="553z">z</a>);</td></tr>
<tr><th id="1951">1951</th><td>		<a class="local col3 ref" href="#553z" title='z' data-ref="553z" data-ref-filename="553z">z</a> = <a class="local col5 ref" href="#555next" title='next' data-ref="555next" data-ref-filename="555next">next</a>;</td></tr>
<tr><th id="1952">1952</th><td>	}</td></tr>
<tr><th id="1953">1953</th><td>	<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 1953, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col2 ref" href="#552az" title='az' data-ref="552az" data-ref-filename="552az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="1954">1954</th><td>}</td></tr>
<tr><th id="1955">1955</th><td></td></tr>
<tr><th id="1956">1956</th><td><em>int</em> <dfn class="decl def fn" id="auth_zones_apply_cfg" title='auth_zones_apply_cfg' data-ref="auth_zones_apply_cfg" data-ref-filename="auth_zones_apply_cfg">auth_zones_apply_cfg</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zones" title='auth_zones' data-ref="auth_zones" data-ref-filename="auth_zones">auth_zones</a>* <dfn class="local col7 decl" id="557az" title='az' data-type='struct auth_zones *' data-ref="557az" data-ref-filename="557az">az</dfn>, <b>struct</b> <a class="type" href="../util/config_file.h.html#config_file" title='config_file' data-ref="config_file" data-ref-filename="config_file">config_file</a>* <dfn class="local col8 decl" id="558cfg" title='cfg' data-type='struct config_file *' data-ref="558cfg" data-ref-filename="558cfg">cfg</dfn>,</td></tr>
<tr><th id="1957">1957</th><td>	<em>int</em> <dfn class="local col9 decl" id="559setup" title='setup' data-type='int' data-ref="559setup" data-ref-filename="559setup">setup</dfn>)</td></tr>
<tr><th id="1958">1958</th><td>{</td></tr>
<tr><th id="1959">1959</th><td>	<b>struct</b> <a class="type" href="../util/config_file.h.html#config_auth" title='config_auth' data-ref="config_auth" data-ref-filename="config_auth">config_auth</a>* <dfn class="local col0 decl" id="560p" title='p' data-type='struct config_auth *' data-ref="560p" data-ref-filename="560p">p</dfn>;</td></tr>
<tr><th id="1960">1960</th><td>	<a class="tu ref fn" href="#az_setall_deleted" title='az_setall_deleted' data-use='c' data-ref="az_setall_deleted" data-ref-filename="az_setall_deleted">az_setall_deleted</a>(<a class="local col7 ref" href="#557az" title='az' data-ref="557az" data-ref-filename="557az">az</a>);</td></tr>
<tr><th id="1961">1961</th><td>	<b>for</b>(<a class="local col0 ref" href="#560p" title='p' data-ref="560p" data-ref-filename="560p">p</a> = <a class="local col8 ref" href="#558cfg" title='cfg' data-ref="558cfg" data-ref-filename="558cfg">cfg</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_file::auths" title='config_file::auths' data-ref="config_file::auths" data-ref-filename="config_file..auths">auths</a>; <a class="local col0 ref" href="#560p" title='p' data-ref="560p" data-ref-filename="560p">p</a>; <a class="local col0 ref" href="#560p" title='p' data-ref="560p" data-ref-filename="560p">p</a> = <a class="local col0 ref" href="#560p" title='p' data-ref="560p" data-ref-filename="560p">p</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_auth::next" title='config_auth::next' data-ref="config_auth::next" data-ref-filename="config_auth..next">next</a>) {</td></tr>
<tr><th id="1962">1962</th><td>		<b>if</b>(!<a class="local col0 ref" href="#560p" title='p' data-ref="560p" data-ref-filename="560p">p</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_auth::name" title='config_auth::name' data-ref="config_auth::name" data-ref-filename="config_auth..name">name</a> || <a class="local col0 ref" href="#560p" title='p' data-ref="560p" data-ref-filename="560p">p</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_auth::name" title='config_auth::name' data-ref="config_auth::name" data-ref-filename="config_auth..name">name</a>[<var>0</var>] == <var>0</var>) {</td></tr>
<tr><th id="1963">1963</th><td>			<a class="ref fn" href="../util/log.h.html#log_warn" title='log_warn' data-ref="log_warn" data-ref-filename="log_warn">log_warn</a>(<q>"auth-zone without a name, skipped"</q>);</td></tr>
<tr><th id="1964">1964</th><td>			<b>continue</b>;</td></tr>
<tr><th id="1965">1965</th><td>		}</td></tr>
<tr><th id="1966">1966</th><td>		<b>if</b>(!<a class="tu ref fn" href="#auth_zones_cfg" title='auth_zones_cfg' data-use='c' data-ref="auth_zones_cfg" data-ref-filename="auth_zones_cfg">auth_zones_cfg</a>(<a class="local col7 ref" href="#557az" title='az' data-ref="557az" data-ref-filename="557az">az</a>, <a class="local col0 ref" href="#560p" title='p' data-ref="560p" data-ref-filename="560p">p</a>)) {</td></tr>
<tr><th id="1967">1967</th><td>			<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"cannot config auth zone %s"</q>, <a class="local col0 ref" href="#560p" title='p' data-ref="560p" data-ref-filename="560p">p</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_auth::name" title='config_auth::name' data-ref="config_auth::name" data-ref-filename="config_auth..name">name</a>);</td></tr>
<tr><th id="1968">1968</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1969">1969</th><td>		}</td></tr>
<tr><th id="1970">1970</th><td>	}</td></tr>
<tr><th id="1971">1971</th><td>	<a class="tu ref fn" href="#az_delete_deleted_zones" title='az_delete_deleted_zones' data-use='c' data-ref="az_delete_deleted_zones" data-ref-filename="az_delete_deleted_zones">az_delete_deleted_zones</a>(<a class="local col7 ref" href="#557az" title='az' data-ref="557az" data-ref-filename="557az">az</a>);</td></tr>
<tr><th id="1972">1972</th><td>	<b>if</b>(!<a class="tu ref fn" href="#auth_zones_read_zones" title='auth_zones_read_zones' data-use='c' data-ref="auth_zones_read_zones" data-ref-filename="auth_zones_read_zones">auth_zones_read_zones</a>(<a class="local col7 ref" href="#557az" title='az' data-ref="557az" data-ref-filename="557az">az</a>, <a class="local col8 ref" href="#558cfg" title='cfg' data-ref="558cfg" data-ref-filename="558cfg">cfg</a>))</td></tr>
<tr><th id="1973">1973</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1974">1974</th><td>	<b>if</b>(<a class="local col9 ref" href="#559setup" title='setup' data-ref="559setup" data-ref-filename="559setup">setup</a>) {</td></tr>
<tr><th id="1975">1975</th><td>		<b>if</b>(!<a class="tu ref fn" href="#auth_zones_setup_zones" title='auth_zones_setup_zones' data-use='c' data-ref="auth_zones_setup_zones" data-ref-filename="auth_zones_setup_zones">auth_zones_setup_zones</a>(<a class="local col7 ref" href="#557az" title='az' data-ref="557az" data-ref-filename="557az">az</a>))</td></tr>
<tr><th id="1976">1976</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1977">1977</th><td>	}</td></tr>
<tr><th id="1978">1978</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1979">1979</th><td>}</td></tr>
<tr><th id="1980">1980</th><td></td></tr>
<tr><th id="1981">1981</th><td><i class="doc" data-doc="auth_chunks_delete">/** delete chunks</i></td></tr>
<tr><th id="1982">1982</th><td><i class="doc" data-doc="auth_chunks_delete"> * <span class="command">@param</span> <span class="arg">at:</span> transfer structure with chunks list.  The chunks and their</i></td></tr>
<tr><th id="1983">1983</th><td><i class="doc" data-doc="auth_chunks_delete"> * 	data are freed.</i></td></tr>
<tr><th id="1984">1984</th><td><i class="doc" data-doc="auth_chunks_delete"> */</i></td></tr>
<tr><th id="1985">1985</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="1986">1986</th><td><dfn class="tu decl def fn" id="auth_chunks_delete" title='auth_chunks_delete' data-type='void auth_chunks_delete(struct auth_transfer * at)' data-ref="auth_chunks_delete" data-ref-filename="auth_chunks_delete">auth_chunks_delete</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_transfer" title='auth_transfer' data-ref="auth_transfer" data-ref-filename="auth_transfer">auth_transfer</a>* <dfn class="local col1 decl" id="561at" title='at' data-type='struct auth_transfer *' data-ref="561at" data-ref-filename="561at">at</dfn>)</td></tr>
<tr><th id="1987">1987</th><td>{</td></tr>
<tr><th id="1988">1988</th><td>	<b>if</b>(<a class="local col1 ref" href="#561at" title='at' data-ref="561at" data-ref-filename="561at">at</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::chunks_first" title='auth_transfer::chunks_first' data-ref="auth_transfer::chunks_first" data-ref-filename="auth_transfer..chunks_first">chunks_first</a>) {</td></tr>
<tr><th id="1989">1989</th><td>		<b>struct</b> <a class="type" href="authzone.h.html#auth_chunk" title='auth_chunk' data-ref="auth_chunk" data-ref-filename="auth_chunk">auth_chunk</a>* <dfn class="local col2 decl" id="562c" title='c' data-type='struct auth_chunk *' data-ref="562c" data-ref-filename="562c">c</dfn>, *<dfn class="local col3 decl" id="563cn" title='cn' data-type='struct auth_chunk *' data-ref="563cn" data-ref-filename="563cn">cn</dfn>;</td></tr>
<tr><th id="1990">1990</th><td>		<a class="local col2 ref" href="#562c" title='c' data-ref="562c" data-ref-filename="562c">c</a> = <a class="local col1 ref" href="#561at" title='at' data-ref="561at" data-ref-filename="561at">at</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::chunks_first" title='auth_transfer::chunks_first' data-ref="auth_transfer::chunks_first" data-ref-filename="auth_transfer..chunks_first">chunks_first</a>;</td></tr>
<tr><th id="1991">1991</th><td>		<b>while</b>(<a class="local col2 ref" href="#562c" title='c' data-ref="562c" data-ref-filename="562c">c</a>) {</td></tr>
<tr><th id="1992">1992</th><td>			<a class="local col3 ref" href="#563cn" title='cn' data-ref="563cn" data-ref-filename="563cn">cn</a> = <a class="local col2 ref" href="#562c" title='c' data-ref="562c" data-ref-filename="562c">c</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::next" title='auth_chunk::next' data-ref="auth_chunk::next" data-ref-filename="auth_chunk..next">next</a>;</td></tr>
<tr><th id="1993">1993</th><td>			<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col2 ref" href="#562c" title='c' data-ref="562c" data-ref-filename="562c">c</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::data" title='auth_chunk::data' data-ref="auth_chunk::data" data-ref-filename="auth_chunk..data">data</a>);</td></tr>
<tr><th id="1994">1994</th><td>			<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col2 ref" href="#562c" title='c' data-ref="562c" data-ref-filename="562c">c</a>);</td></tr>
<tr><th id="1995">1995</th><td>			<a class="local col2 ref" href="#562c" title='c' data-ref="562c" data-ref-filename="562c">c</a> = <a class="local col3 ref" href="#563cn" title='cn' data-ref="563cn" data-ref-filename="563cn">cn</a>;</td></tr>
<tr><th id="1996">1996</th><td>		}</td></tr>
<tr><th id="1997">1997</th><td>	}</td></tr>
<tr><th id="1998">1998</th><td>	<a class="local col1 ref" href="#561at" title='at' data-ref="561at" data-ref-filename="561at">at</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::chunks_first" title='auth_transfer::chunks_first' data-ref="auth_transfer::chunks_first" data-ref-filename="auth_transfer..chunks_first">chunks_first</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="1999">1999</th><td>	<a class="local col1 ref" href="#561at" title='at' data-ref="561at" data-ref-filename="561at">at</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::chunks_last" title='auth_transfer::chunks_last' data-ref="auth_transfer::chunks_last" data-ref-filename="auth_transfer..chunks_last">chunks_last</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="2000">2000</th><td>}</td></tr>
<tr><th id="2001">2001</th><td></td></tr>
<tr><th id="2002">2002</th><td><i class="doc" data-doc="auth_free_master_addrs">/** free master addr list */</i></td></tr>
<tr><th id="2003">2003</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="2004">2004</th><td><dfn class="tu decl def fn" id="auth_free_master_addrs" title='auth_free_master_addrs' data-type='void auth_free_master_addrs(struct auth_addr * list)' data-ref="auth_free_master_addrs" data-ref-filename="auth_free_master_addrs">auth_free_master_addrs</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_addr" title='auth_addr' data-ref="auth_addr" data-ref-filename="auth_addr">auth_addr</a>* <dfn class="local col4 decl" id="564list" title='list' data-type='struct auth_addr *' data-ref="564list" data-ref-filename="564list">list</dfn>)</td></tr>
<tr><th id="2005">2005</th><td>{</td></tr>
<tr><th id="2006">2006</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_addr" title='auth_addr' data-ref="auth_addr" data-ref-filename="auth_addr">auth_addr</a> *<dfn class="local col5 decl" id="565n" title='n' data-type='struct auth_addr *' data-ref="565n" data-ref-filename="565n">n</dfn>;</td></tr>
<tr><th id="2007">2007</th><td>	<b>while</b>(<a class="local col4 ref" href="#564list" title='list' data-ref="564list" data-ref-filename="564list">list</a>) {</td></tr>
<tr><th id="2008">2008</th><td>		<a class="local col5 ref" href="#565n" title='n' data-ref="565n" data-ref-filename="565n">n</a> = <a class="local col4 ref" href="#564list" title='list' data-ref="564list" data-ref-filename="564list">list</a>-&gt;<a class="ref field" href="authzone.h.html#auth_addr::next" title='auth_addr::next' data-ref="auth_addr::next" data-ref-filename="auth_addr..next">next</a>;</td></tr>
<tr><th id="2009">2009</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col4 ref" href="#564list" title='list' data-ref="564list" data-ref-filename="564list">list</a>);</td></tr>
<tr><th id="2010">2010</th><td>		<a class="local col4 ref" href="#564list" title='list' data-ref="564list" data-ref-filename="564list">list</a> = <a class="local col5 ref" href="#565n" title='n' data-ref="565n" data-ref-filename="565n">n</a>;</td></tr>
<tr><th id="2011">2011</th><td>	}</td></tr>
<tr><th id="2012">2012</th><td>}</td></tr>
<tr><th id="2013">2013</th><td></td></tr>
<tr><th id="2014">2014</th><td><i class="doc" data-doc="auth_free_masters">/** free the masters list */</i></td></tr>
<tr><th id="2015">2015</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="2016">2016</th><td><dfn class="tu decl def fn" id="auth_free_masters" title='auth_free_masters' data-type='void auth_free_masters(struct auth_master * list)' data-ref="auth_free_masters" data-ref-filename="auth_free_masters">auth_free_masters</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>* <dfn class="local col6 decl" id="566list" title='list' data-type='struct auth_master *' data-ref="566list" data-ref-filename="566list">list</dfn>)</td></tr>
<tr><th id="2017">2017</th><td>{</td></tr>
<tr><th id="2018">2018</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>* <dfn class="local col7 decl" id="567n" title='n' data-type='struct auth_master *' data-ref="567n" data-ref-filename="567n">n</dfn>;</td></tr>
<tr><th id="2019">2019</th><td>	<b>while</b>(<a class="local col6 ref" href="#566list" title='list' data-ref="566list" data-ref-filename="566list">list</a>) {</td></tr>
<tr><th id="2020">2020</th><td>		<a class="local col7 ref" href="#567n" title='n' data-ref="567n" data-ref-filename="567n">n</a> = <a class="local col6 ref" href="#566list" title='list' data-ref="566list" data-ref-filename="566list">list</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::next" title='auth_master::next' data-ref="auth_master::next" data-ref-filename="auth_master..next">next</a>;</td></tr>
<tr><th id="2021">2021</th><td>		<a class="tu ref fn" href="#auth_free_master_addrs" title='auth_free_master_addrs' data-use='c' data-ref="auth_free_master_addrs" data-ref-filename="auth_free_master_addrs">auth_free_master_addrs</a>(<a class="local col6 ref" href="#566list" title='list' data-ref="566list" data-ref-filename="566list">list</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::list" title='auth_master::list' data-ref="auth_master::list" data-ref-filename="auth_master..list">list</a>);</td></tr>
<tr><th id="2022">2022</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col6 ref" href="#566list" title='list' data-ref="566list" data-ref-filename="566list">list</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="2023">2023</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col6 ref" href="#566list" title='list' data-ref="566list" data-ref-filename="566list">list</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::file" title='auth_master::file' data-ref="auth_master::file" data-ref-filename="auth_master..file">file</a>);</td></tr>
<tr><th id="2024">2024</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col6 ref" href="#566list" title='list' data-ref="566list" data-ref-filename="566list">list</a>);</td></tr>
<tr><th id="2025">2025</th><td>		<a class="local col6 ref" href="#566list" title='list' data-ref="566list" data-ref-filename="566list">list</a> = <a class="local col7 ref" href="#567n" title='n' data-ref="567n" data-ref-filename="567n">n</a>;</td></tr>
<tr><th id="2026">2026</th><td>	}</td></tr>
<tr><th id="2027">2027</th><td>}</td></tr>
<tr><th id="2028">2028</th><td></td></tr>
<tr><th id="2029">2029</th><td><i class="doc">/** delete auth xfer structure</i></td></tr>
<tr><th id="2030">2030</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">xfr:</span> delete this xfer and its tasks.</i></td></tr>
<tr><th id="2031">2031</th><td><i class="doc"> */</i></td></tr>
<tr><th id="2032">2032</th><td><em>void</em></td></tr>
<tr><th id="2033">2033</th><td><dfn class="decl def fn" id="auth_xfer_delete" title='auth_xfer_delete' data-ref="auth_xfer_delete" data-ref-filename="auth_xfer_delete">auth_xfer_delete</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col8 decl" id="568xfr" title='xfr' data-type='struct auth_xfer *' data-ref="568xfr" data-ref-filename="568xfr">xfr</dfn>)</td></tr>
<tr><th id="2034">2034</th><td>{</td></tr>
<tr><th id="2035">2035</th><td>	<b>if</b>(!<a class="local col8 ref" href="#568xfr" title='xfr' data-ref="568xfr" data-ref-filename="568xfr">xfr</a>) <b>return</b>;</td></tr>
<tr><th id="2036">2036</th><td>	<a class="macro" href="../util/locks.h.html#101" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_destroy(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_destroy(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 2036, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_destroy">lock_basic_destroy</a>(&amp;<a class="local col8 ref" href="#568xfr" title='xfr' data-ref="568xfr" data-ref-filename="568xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="2037">2037</th><td>	<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col8 ref" href="#568xfr" title='xfr' data-ref="568xfr" data-ref-filename="568xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a>);</td></tr>
<tr><th id="2038">2038</th><td>	<b>if</b>(<a class="local col8 ref" href="#568xfr" title='xfr' data-ref="568xfr" data-ref-filename="568xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>) {</td></tr>
<tr><th id="2039">2039</th><td>		<a class="ref fn" href="../util/netevent.h.html#comm_timer_delete" title='comm_timer_delete' data-ref="comm_timer_delete" data-ref-filename="comm_timer_delete">comm_timer_delete</a>(<a class="local col8 ref" href="#568xfr" title='xfr' data-ref="568xfr" data-ref-filename="568xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::timer" title='auth_nextprobe::timer' data-ref="auth_nextprobe::timer" data-ref-filename="auth_nextprobe..timer">timer</a>);</td></tr>
<tr><th id="2040">2040</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col8 ref" href="#568xfr" title='xfr' data-ref="568xfr" data-ref-filename="568xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>);</td></tr>
<tr><th id="2041">2041</th><td>	}</td></tr>
<tr><th id="2042">2042</th><td>	<b>if</b>(<a class="local col8 ref" href="#568xfr" title='xfr' data-ref="568xfr" data-ref-filename="568xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>) {</td></tr>
<tr><th id="2043">2043</th><td>		<a class="tu ref fn" href="#auth_free_masters" title='auth_free_masters' data-use='c' data-ref="auth_free_masters" data-ref-filename="auth_free_masters">auth_free_masters</a>(<a class="local col8 ref" href="#568xfr" title='xfr' data-ref="568xfr" data-ref-filename="568xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::masters" title='auth_probe::masters' data-ref="auth_probe::masters" data-ref-filename="auth_probe..masters">masters</a>);</td></tr>
<tr><th id="2044">2044</th><td>		<a class="ref fn" href="../util/netevent.h.html#comm_point_delete" title='comm_point_delete' data-ref="comm_point_delete" data-ref-filename="comm_point_delete">comm_point_delete</a>(<a class="local col8 ref" href="#568xfr" title='xfr' data-ref="568xfr" data-ref-filename="568xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::cp" title='auth_probe::cp' data-ref="auth_probe::cp" data-ref-filename="auth_probe..cp">cp</a>);</td></tr>
<tr><th id="2045">2045</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col8 ref" href="#568xfr" title='xfr' data-ref="568xfr" data-ref-filename="568xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>);</td></tr>
<tr><th id="2046">2046</th><td>	}</td></tr>
<tr><th id="2047">2047</th><td>	<b>if</b>(<a class="local col8 ref" href="#568xfr" title='xfr' data-ref="568xfr" data-ref-filename="568xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>) {</td></tr>
<tr><th id="2048">2048</th><td>		<a class="tu ref fn" href="#auth_free_masters" title='auth_free_masters' data-use='c' data-ref="auth_free_masters" data-ref-filename="auth_free_masters">auth_free_masters</a>(<a class="local col8 ref" href="#568xfr" title='xfr' data-ref="568xfr" data-ref-filename="568xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::masters" title='auth_transfer::masters' data-ref="auth_transfer::masters" data-ref-filename="auth_transfer..masters">masters</a>);</td></tr>
<tr><th id="2049">2049</th><td>		<a class="ref fn" href="../util/netevent.h.html#comm_point_delete" title='comm_point_delete' data-ref="comm_point_delete" data-ref-filename="comm_point_delete">comm_point_delete</a>(<a class="local col8 ref" href="#568xfr" title='xfr' data-ref="568xfr" data-ref-filename="568xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::cp" title='auth_transfer::cp' data-ref="auth_transfer::cp" data-ref-filename="auth_transfer..cp">cp</a>);</td></tr>
<tr><th id="2050">2050</th><td>		<b>if</b>(<a class="local col8 ref" href="#568xfr" title='xfr' data-ref="568xfr" data-ref-filename="568xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::chunks_first" title='auth_transfer::chunks_first' data-ref="auth_transfer::chunks_first" data-ref-filename="auth_transfer..chunks_first">chunks_first</a>) {</td></tr>
<tr><th id="2051">2051</th><td>			<a class="tu ref fn" href="#auth_chunks_delete" title='auth_chunks_delete' data-use='c' data-ref="auth_chunks_delete" data-ref-filename="auth_chunks_delete">auth_chunks_delete</a>(<a class="local col8 ref" href="#568xfr" title='xfr' data-ref="568xfr" data-ref-filename="568xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>);</td></tr>
<tr><th id="2052">2052</th><td>		}</td></tr>
<tr><th id="2053">2053</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col8 ref" href="#568xfr" title='xfr' data-ref="568xfr" data-ref-filename="568xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>);</td></tr>
<tr><th id="2054">2054</th><td>	}</td></tr>
<tr><th id="2055">2055</th><td>	<a class="tu ref fn" href="#auth_free_masters" title='auth_free_masters' data-use='c' data-ref="auth_free_masters" data-ref-filename="auth_free_masters">auth_free_masters</a>(<a class="local col8 ref" href="#568xfr" title='xfr' data-ref="568xfr" data-ref-filename="568xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::allow_notify_list" title='auth_xfer::allow_notify_list' data-ref="auth_xfer::allow_notify_list" data-ref-filename="auth_xfer..allow_notify_list">allow_notify_list</a>);</td></tr>
<tr><th id="2056">2056</th><td>	<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col8 ref" href="#568xfr" title='xfr' data-ref="568xfr" data-ref-filename="568xfr">xfr</a>);</td></tr>
<tr><th id="2057">2057</th><td>}</td></tr>
<tr><th id="2058">2058</th><td></td></tr>
<tr><th id="2059">2059</th><td><i class="doc" data-doc="auth_zone_del">/** helper traverse to delete zones */</i></td></tr>
<tr><th id="2060">2060</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="2061">2061</th><td><dfn class="tu decl def fn" id="auth_zone_del" title='auth_zone_del' data-type='void auth_zone_del(rbnode_type * n, void * arg)' data-ref="auth_zone_del" data-ref-filename="auth_zone_del">auth_zone_del</dfn>(<a class="typedef" href="../util/rbtree.h.html#rbnode_type" title='rbnode_type' data-type='struct rbnode_type' data-ref="rbnode_type" data-ref-filename="rbnode_type">rbnode_type</a>* <dfn class="local col9 decl" id="569n" title='n' data-type='rbnode_type *' data-ref="569n" data-ref-filename="569n">n</dfn>, <em>void</em>* <a class="macro" href="../../include/config.h.html#1057" title="arg __attribute__((unused))" data-ref="_M/ATTR_UNUSED">ATTR_UNUSED</a>(<dfn class="local col0 decl" id="570arg" title='arg' data-type='void *' data-ref="570arg" data-ref-filename="570arg">arg</dfn>))</td></tr>
<tr><th id="2062">2062</th><td>{</td></tr>
<tr><th id="2063">2063</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col1 decl" id="571z" title='z' data-type='struct auth_zone *' data-ref="571z" data-ref-filename="571z">z</dfn> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>*)<a class="local col9 ref" href="#569n" title='n' data-ref="569n" data-ref-filename="569n">n</a>-&gt;<a class="ref field" href="../util/rbtree.h.html#rbnode_type::key" title='rbnode_type::key' data-ref="rbnode_type::key" data-ref-filename="rbnode_type..key">key</a>;</td></tr>
<tr><th id="2064">2064</th><td>	<a class="tu ref fn" href="#auth_zone_delete" title='auth_zone_delete' data-use='c' data-ref="auth_zone_delete" data-ref-filename="auth_zone_delete">auth_zone_delete</a>(<a class="local col1 ref" href="#571z" title='z' data-ref="571z" data-ref-filename="571z">z</a>);</td></tr>
<tr><th id="2065">2065</th><td>}</td></tr>
<tr><th id="2066">2066</th><td></td></tr>
<tr><th id="2067">2067</th><td><i class="doc" data-doc="auth_xfer_del">/** helper traverse to delete xfer zones */</i></td></tr>
<tr><th id="2068">2068</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="2069">2069</th><td><dfn class="tu decl def fn" id="auth_xfer_del" title='auth_xfer_del' data-type='void auth_xfer_del(rbnode_type * n, void * arg)' data-ref="auth_xfer_del" data-ref-filename="auth_xfer_del">auth_xfer_del</dfn>(<a class="typedef" href="../util/rbtree.h.html#rbnode_type" title='rbnode_type' data-type='struct rbnode_type' data-ref="rbnode_type" data-ref-filename="rbnode_type">rbnode_type</a>* <dfn class="local col2 decl" id="572n" title='n' data-type='rbnode_type *' data-ref="572n" data-ref-filename="572n">n</dfn>, <em>void</em>* <a class="macro" href="../../include/config.h.html#1057" title="arg __attribute__((unused))" data-ref="_M/ATTR_UNUSED">ATTR_UNUSED</a>(<dfn class="local col3 decl" id="573arg" title='arg' data-type='void *' data-ref="573arg" data-ref-filename="573arg">arg</dfn>))</td></tr>
<tr><th id="2070">2070</th><td>{</td></tr>
<tr><th id="2071">2071</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col4 decl" id="574z" title='z' data-type='struct auth_xfer *' data-ref="574z" data-ref-filename="574z">z</dfn> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>*)<a class="local col2 ref" href="#572n" title='n' data-ref="572n" data-ref-filename="572n">n</a>-&gt;<a class="ref field" href="../util/rbtree.h.html#rbnode_type::key" title='rbnode_type::key' data-ref="rbnode_type::key" data-ref-filename="rbnode_type..key">key</a>;</td></tr>
<tr><th id="2072">2072</th><td>	<a class="ref fn" href="#auth_xfer_delete" title='auth_xfer_delete' data-ref="auth_xfer_delete" data-ref-filename="auth_xfer_delete">auth_xfer_delete</a>(<a class="local col4 ref" href="#574z" title='z' data-ref="574z" data-ref-filename="574z">z</a>);</td></tr>
<tr><th id="2073">2073</th><td>}</td></tr>
<tr><th id="2074">2074</th><td></td></tr>
<tr><th id="2075">2075</th><td><em>void</em> <dfn class="decl def fn" id="auth_zones_delete" title='auth_zones_delete' data-ref="auth_zones_delete" data-ref-filename="auth_zones_delete">auth_zones_delete</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zones" title='auth_zones' data-ref="auth_zones" data-ref-filename="auth_zones">auth_zones</a>* <dfn class="local col5 decl" id="575az" title='az' data-type='struct auth_zones *' data-ref="575az" data-ref-filename="575az">az</dfn>)</td></tr>
<tr><th id="2076">2076</th><td>{</td></tr>
<tr><th id="2077">2077</th><td>	<b>if</b>(!<a class="local col5 ref" href="#575az" title='az' data-ref="575az" data-ref-filename="575az">az</a>) <b>return</b>;</td></tr>
<tr><th id="2078">2078</th><td>	<a class="macro" href="../util/locks.h.html#118" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_destroy(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_destroy(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 2078, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_destroy">lock_rw_destroy</a>(&amp;<a class="local col5 ref" href="#575az" title='az' data-ref="575az" data-ref-filename="575az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="2079">2079</th><td>	<a class="ref fn" href="../util/rbtree.h.html#traverse_postorder" title='traverse_postorder' data-ref="traverse_postorder" data-ref-filename="traverse_postorder">traverse_postorder</a>(&amp;<a class="local col5 ref" href="#575az" title='az' data-ref="575az" data-ref-filename="575az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::ztree" title='auth_zones::ztree' data-ref="auth_zones::ztree" data-ref-filename="auth_zones..ztree">ztree</a>, <a class="tu ref fn" href="#auth_zone_del" title='auth_zone_del' data-use='r' data-ref="auth_zone_del" data-ref-filename="auth_zone_del">auth_zone_del</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="2080">2080</th><td>	<a class="ref fn" href="../util/rbtree.h.html#traverse_postorder" title='traverse_postorder' data-ref="traverse_postorder" data-ref-filename="traverse_postorder">traverse_postorder</a>(&amp;<a class="local col5 ref" href="#575az" title='az' data-ref="575az" data-ref-filename="575az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::xtree" title='auth_zones::xtree' data-ref="auth_zones::xtree" data-ref-filename="auth_zones..xtree">xtree</a>, <a class="tu ref fn" href="#auth_xfer_del" title='auth_xfer_del' data-use='r' data-ref="auth_xfer_del" data-ref-filename="auth_xfer_del">auth_xfer_del</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="2081">2081</th><td>	<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col5 ref" href="#575az" title='az' data-ref="575az" data-ref-filename="575az">az</a>);</td></tr>
<tr><th id="2082">2082</th><td>}</td></tr>
<tr><th id="2083">2083</th><td></td></tr>
<tr><th id="2084">2084</th><td><i class="doc" data-doc="domain_has_only_nsec3">/** true if domain has only nsec3 */</i></td></tr>
<tr><th id="2085">2085</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="2086">2086</th><td><dfn class="tu decl def fn" id="domain_has_only_nsec3" title='domain_has_only_nsec3' data-type='int domain_has_only_nsec3(struct auth_data * n)' data-ref="domain_has_only_nsec3" data-ref-filename="domain_has_only_nsec3">domain_has_only_nsec3</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col6 decl" id="576n" title='n' data-type='struct auth_data *' data-ref="576n" data-ref-filename="576n">n</dfn>)</td></tr>
<tr><th id="2087">2087</th><td>{</td></tr>
<tr><th id="2088">2088</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col7 decl" id="577rrset" title='rrset' data-type='struct auth_rrset *' data-ref="577rrset" data-ref-filename="577rrset">rrset</dfn> = <a class="local col6 ref" href="#576n" title='n' data-ref="576n" data-ref-filename="576n">n</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::rrsets" title='auth_data::rrsets' data-ref="auth_data::rrsets" data-ref-filename="auth_data..rrsets">rrsets</a>;</td></tr>
<tr><th id="2089">2089</th><td>	<em>int</em> <dfn class="local col8 decl" id="578nsec3_seen" title='nsec3_seen' data-type='int' data-ref="578nsec3_seen" data-ref-filename="578nsec3_seen">nsec3_seen</dfn> = <var>0</var>;</td></tr>
<tr><th id="2090">2090</th><td>	<b>while</b>(<a class="local col7 ref" href="#577rrset" title='rrset' data-ref="577rrset" data-ref-filename="577rrset">rrset</a>) {</td></tr>
<tr><th id="2091">2091</th><td>		<b>if</b>(<a class="local col7 ref" href="#577rrset" title='rrset' data-ref="577rrset" data-ref-filename="577rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::type" title='auth_rrset::type' data-ref="auth_rrset::type" data-ref-filename="auth_rrset..type">type</a> == <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_NSEC3" title='LDNS_RR_TYPE_NSEC3' data-ref="LDNS_RR_TYPE_NSEC3" data-ref-filename="LDNS_RR_TYPE_NSEC3">LDNS_RR_TYPE_NSEC3</a>) {</td></tr>
<tr><th id="2092">2092</th><td>			<a class="local col8 ref" href="#578nsec3_seen" title='nsec3_seen' data-ref="578nsec3_seen" data-ref-filename="578nsec3_seen">nsec3_seen</a> = <var>1</var>;</td></tr>
<tr><th id="2093">2093</th><td>		} <b>else</b> <b>if</b>(<a class="local col7 ref" href="#577rrset" title='rrset' data-ref="577rrset" data-ref-filename="577rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::type" title='auth_rrset::type' data-ref="auth_rrset::type" data-ref-filename="auth_rrset..type">type</a> != <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_RRSIG" title='LDNS_RR_TYPE_RRSIG' data-ref="LDNS_RR_TYPE_RRSIG" data-ref-filename="LDNS_RR_TYPE_RRSIG">LDNS_RR_TYPE_RRSIG</a>) {</td></tr>
<tr><th id="2094">2094</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2095">2095</th><td>		}</td></tr>
<tr><th id="2096">2096</th><td>		<a class="local col7 ref" href="#577rrset" title='rrset' data-ref="577rrset" data-ref-filename="577rrset">rrset</a> = <a class="local col7 ref" href="#577rrset" title='rrset' data-ref="577rrset" data-ref-filename="577rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::next" title='auth_rrset::next' data-ref="auth_rrset::next" data-ref-filename="auth_rrset..next">next</a>;</td></tr>
<tr><th id="2097">2097</th><td>	}</td></tr>
<tr><th id="2098">2098</th><td>	<b>return</b> <a class="local col8 ref" href="#578nsec3_seen" title='nsec3_seen' data-ref="578nsec3_seen" data-ref-filename="578nsec3_seen">nsec3_seen</a>;</td></tr>
<tr><th id="2099">2099</th><td>}</td></tr>
<tr><th id="2100">2100</th><td></td></tr>
<tr><th id="2101">2101</th><td><i class="doc" data-doc="az_find_wildcard_domain">/** see if the domain has a wildcard child '*.domain' */</i></td></tr>
<tr><th id="2102">2102</th><td><em>static</em> <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>*</td></tr>
<tr><th id="2103">2103</th><td><dfn class="tu decl def fn" id="az_find_wildcard_domain" title='az_find_wildcard_domain' data-type='struct auth_data * az_find_wildcard_domain(struct auth_zone * z, uint8_t * nm, size_t nmlen)' data-ref="az_find_wildcard_domain" data-ref-filename="az_find_wildcard_domain">az_find_wildcard_domain</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col9 decl" id="579z" title='z' data-type='struct auth_zone *' data-ref="579z" data-ref-filename="579z">z</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col0 decl" id="580nm" title='nm' data-type='uint8_t *' data-ref="580nm" data-ref-filename="580nm">nm</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col1 decl" id="581nmlen" title='nmlen' data-type='size_t' data-ref="581nmlen" data-ref-filename="581nmlen">nmlen</dfn>)</td></tr>
<tr><th id="2104">2104</th><td>{</td></tr>
<tr><th id="2105">2105</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a> <dfn class="local col2 decl" id="582wc" title='wc' data-type='uint8_t [255]' data-ref="582wc" data-ref-filename="582wc">wc</dfn>[<a class="macro" href="../sldns/rrdef.h.html#29" title="255" data-ref="_M/LDNS_MAX_DOMAINLEN">LDNS_MAX_DOMAINLEN</a>];</td></tr>
<tr><th id="2106">2106</th><td>	<b>if</b>(<a class="local col1 ref" href="#581nmlen" title='nmlen' data-ref="581nmlen" data-ref-filename="581nmlen">nmlen</a>+<var>2</var> &gt; <b>sizeof</b>(<a class="local col2 ref" href="#582wc" title='wc' data-ref="582wc" data-ref-filename="582wc">wc</a>))</td></tr>
<tr><th id="2107">2107</th><td>		<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>; <i>/* result would be too long */</i></td></tr>
<tr><th id="2108">2108</th><td>	<a class="local col2 ref" href="#582wc" title='wc' data-ref="582wc" data-ref-filename="582wc">wc</a>[<var>0</var>] = <var>1</var>; <i>/* length of wildcard label */</i></td></tr>
<tr><th id="2109">2109</th><td>	<a class="local col2 ref" href="#582wc" title='wc' data-ref="582wc" data-ref-filename="582wc">wc</a>[<var>1</var>] = (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>)<kbd>'*'</kbd>; <i>/* wildcard label */</i></td></tr>
<tr><th id="2110">2110</th><td>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(wc+2, 0) != (size_t)-1) ? __builtin___memmove_chk(wc+2, nm, nmlen, __builtin_object_size(wc+2, 0)) : __memmove_ichk(wc+2, nm, nmlen))" data-ref="_M/memmove">memmove</a>(<a class="local col2 ref" href="#582wc" title='wc' data-ref="582wc" data-ref-filename="582wc">wc</a>+<var>2</var>, <a class="local col0 ref" href="#580nm" title='nm' data-ref="580nm" data-ref-filename="580nm">nm</a>, <a class="local col1 ref" href="#581nmlen" title='nmlen' data-ref="581nmlen" data-ref-filename="581nmlen">nmlen</a>);</td></tr>
<tr><th id="2111">2111</th><td>	<b>return</b> <a class="tu ref fn" href="#az_find_name" title='az_find_name' data-use='c' data-ref="az_find_name" data-ref-filename="az_find_name">az_find_name</a>(<a class="local col9 ref" href="#579z" title='z' data-ref="579z" data-ref-filename="579z">z</a>, <a class="local col2 ref" href="#582wc" title='wc' data-ref="582wc" data-ref-filename="582wc">wc</a>, <a class="local col1 ref" href="#581nmlen" title='nmlen' data-ref="581nmlen" data-ref-filename="581nmlen">nmlen</a>+<var>2</var>);</td></tr>
<tr><th id="2112">2112</th><td>}</td></tr>
<tr><th id="2113">2113</th><td></td></tr>
<tr><th id="2114">2114</th><td><i class="doc" data-doc="az_find_wildcard">/** find wildcard between qname and cename */</i></td></tr>
<tr><th id="2115">2115</th><td><em>static</em> <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>*</td></tr>
<tr><th id="2116">2116</th><td><dfn class="tu decl def fn" id="az_find_wildcard" title='az_find_wildcard' data-type='struct auth_data * az_find_wildcard(struct auth_zone * z, struct query_info * qinfo, struct auth_data * ce)' data-ref="az_find_wildcard" data-ref-filename="az_find_wildcard">az_find_wildcard</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col3 decl" id="583z" title='z' data-type='struct auth_zone *' data-ref="583z" data-ref-filename="583z">z</dfn>, <b>struct</b> <a class="type" href="../util/data/msgreply.h.html#query_info" title='query_info' data-ref="query_info" data-ref-filename="query_info">query_info</a>* <dfn class="local col4 decl" id="584qinfo" title='qinfo' data-type='struct query_info *' data-ref="584qinfo" data-ref-filename="584qinfo">qinfo</dfn>,</td></tr>
<tr><th id="2117">2117</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col5 decl" id="585ce" title='ce' data-type='struct auth_data *' data-ref="585ce" data-ref-filename="585ce">ce</dfn>)</td></tr>
<tr><th id="2118">2118</th><td>{</td></tr>
<tr><th id="2119">2119</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col6 decl" id="586nm" title='nm' data-type='uint8_t *' data-ref="586nm" data-ref-filename="586nm">nm</dfn> = <a class="local col4 ref" href="#584qinfo" title='qinfo' data-ref="584qinfo" data-ref-filename="584qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname" title='query_info::qname' data-ref="query_info::qname" data-ref-filename="query_info..qname">qname</a>;</td></tr>
<tr><th id="2120">2120</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col7 decl" id="587nmlen" title='nmlen' data-type='size_t' data-ref="587nmlen" data-ref-filename="587nmlen">nmlen</dfn> = <a class="local col4 ref" href="#584qinfo" title='qinfo' data-ref="584qinfo" data-ref-filename="584qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname_len" title='query_info::qname_len' data-ref="query_info::qname_len" data-ref-filename="query_info..qname_len">qname_len</a>;</td></tr>
<tr><th id="2121">2121</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col8 decl" id="588node" title='node' data-type='struct auth_data *' data-ref="588node" data-ref-filename="588node">node</dfn>;</td></tr>
<tr><th id="2122">2122</th><td>	<b>if</b>(!<a class="ref fn" href="../util/data/dname.h.html#dname_subdomain_c" title='dname_subdomain_c' data-ref="dname_subdomain_c" data-ref-filename="dname_subdomain_c">dname_subdomain_c</a>(<a class="local col6 ref" href="#586nm" title='nm' data-ref="586nm" data-ref-filename="586nm">nm</a>, <a class="local col3 ref" href="#583z" title='z' data-ref="583z" data-ref-filename="583z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::name" title='auth_zone::name' data-ref="auth_zone::name" data-ref-filename="auth_zone..name">name</a>))</td></tr>
<tr><th id="2123">2123</th><td>		<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>; <i>/* out of zone */</i></td></tr>
<tr><th id="2124">2124</th><td>	<b>while</b>((<a class="local col8 ref" href="#588node" title='node' data-ref="588node" data-ref-filename="588node">node</a>=<a class="tu ref fn" href="#az_find_wildcard_domain" title='az_find_wildcard_domain' data-use='c' data-ref="az_find_wildcard_domain" data-ref-filename="az_find_wildcard_domain">az_find_wildcard_domain</a>(<a class="local col3 ref" href="#583z" title='z' data-ref="583z" data-ref-filename="583z">z</a>, <a class="local col6 ref" href="#586nm" title='nm' data-ref="586nm" data-ref-filename="586nm">nm</a>, <a class="local col7 ref" href="#587nmlen" title='nmlen' data-ref="587nmlen" data-ref-filename="587nmlen">nmlen</a>))==<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="2125">2125</th><td>		<i>/* see if we can go up to find the wildcard */</i></td></tr>
<tr><th id="2126">2126</th><td>		<b>if</b>(<a class="local col7 ref" href="#587nmlen" title='nmlen' data-ref="587nmlen" data-ref-filename="587nmlen">nmlen</a> == <a class="local col3 ref" href="#583z" title='z' data-ref="583z" data-ref-filename="583z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::namelen" title='auth_zone::namelen' data-ref="auth_zone::namelen" data-ref-filename="auth_zone..namelen">namelen</a>)</td></tr>
<tr><th id="2127">2127</th><td>			<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>; <i>/* top of zone reached */</i></td></tr>
<tr><th id="2128">2128</th><td>		<b>if</b>(<a class="local col5 ref" href="#585ce" title='ce' data-ref="585ce" data-ref-filename="585ce">ce</a> &amp;&amp; <a class="local col7 ref" href="#587nmlen" title='nmlen' data-ref="587nmlen" data-ref-filename="587nmlen">nmlen</a> == <a class="local col5 ref" href="#585ce" title='ce' data-ref="585ce" data-ref-filename="585ce">ce</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::namelen" title='auth_data::namelen' data-ref="auth_data::namelen" data-ref-filename="auth_data..namelen">namelen</a>)</td></tr>
<tr><th id="2129">2129</th><td>			<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>; <i>/* ce reached */</i></td></tr>
<tr><th id="2130">2130</th><td>		<b>if</b>(<a class="ref fn" href="../util/data/dname.h.html#dname_is_root" title='dname_is_root' data-ref="dname_is_root" data-ref-filename="dname_is_root">dname_is_root</a>(<a class="local col6 ref" href="#586nm" title='nm' data-ref="586nm" data-ref-filename="586nm">nm</a>))</td></tr>
<tr><th id="2131">2131</th><td>			<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>; <i>/* cannot go up */</i></td></tr>
<tr><th id="2132">2132</th><td>		<a class="ref fn" href="../util/data/dname.h.html#dname_remove_label" title='dname_remove_label' data-ref="dname_remove_label" data-ref-filename="dname_remove_label">dname_remove_label</a>(&amp;<a class="local col6 ref" href="#586nm" title='nm' data-ref="586nm" data-ref-filename="586nm">nm</a>, &amp;<a class="local col7 ref" href="#587nmlen" title='nmlen' data-ref="587nmlen" data-ref-filename="587nmlen">nmlen</a>);</td></tr>
<tr><th id="2133">2133</th><td>	}</td></tr>
<tr><th id="2134">2134</th><td>	<b>return</b> <a class="local col8 ref" href="#588node" title='node' data-ref="588node" data-ref-filename="588node">node</a>;</td></tr>
<tr><th id="2135">2135</th><td>}</td></tr>
<tr><th id="2136">2136</th><td></td></tr>
<tr><th id="2137">2137</th><td><i class="doc" data-doc="az_find_candidate_ce">/** domain is not exact, find first candidate ce (name that matches</i></td></tr>
<tr><th id="2138">2138</th><td><i class="doc" data-doc="az_find_candidate_ce"> * a part of qname) in tree */</i></td></tr>
<tr><th id="2139">2139</th><td><em>static</em> <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>*</td></tr>
<tr><th id="2140">2140</th><td><dfn class="tu decl def fn" id="az_find_candidate_ce" title='az_find_candidate_ce' data-type='struct auth_data * az_find_candidate_ce(struct auth_zone * z, struct query_info * qinfo, struct auth_data * n)' data-ref="az_find_candidate_ce" data-ref-filename="az_find_candidate_ce">az_find_candidate_ce</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col9 decl" id="589z" title='z' data-type='struct auth_zone *' data-ref="589z" data-ref-filename="589z">z</dfn>, <b>struct</b> <a class="type" href="../util/data/msgreply.h.html#query_info" title='query_info' data-ref="query_info" data-ref-filename="query_info">query_info</a>* <dfn class="local col0 decl" id="590qinfo" title='qinfo' data-type='struct query_info *' data-ref="590qinfo" data-ref-filename="590qinfo">qinfo</dfn>,</td></tr>
<tr><th id="2141">2141</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col1 decl" id="591n" title='n' data-type='struct auth_data *' data-ref="591n" data-ref-filename="591n">n</dfn>)</td></tr>
<tr><th id="2142">2142</th><td>{</td></tr>
<tr><th id="2143">2143</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col2 decl" id="592nm" title='nm' data-type='uint8_t *' data-ref="592nm" data-ref-filename="592nm">nm</dfn>;</td></tr>
<tr><th id="2144">2144</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col3 decl" id="593nmlen" title='nmlen' data-type='size_t' data-ref="593nmlen" data-ref-filename="593nmlen">nmlen</dfn>;</td></tr>
<tr><th id="2145">2145</th><td>	<b>if</b>(<a class="local col1 ref" href="#591n" title='n' data-ref="591n" data-ref-filename="591n">n</a>) {</td></tr>
<tr><th id="2146">2146</th><td>		<a class="local col2 ref" href="#592nm" title='nm' data-ref="592nm" data-ref-filename="592nm">nm</a> = <a class="ref fn" href="../util/data/dname.h.html#dname_get_shared_topdomain" title='dname_get_shared_topdomain' data-ref="dname_get_shared_topdomain" data-ref-filename="dname_get_shared_topdomain">dname_get_shared_topdomain</a>(<a class="local col0 ref" href="#590qinfo" title='qinfo' data-ref="590qinfo" data-ref-filename="590qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname" title='query_info::qname' data-ref="query_info::qname" data-ref-filename="query_info..qname">qname</a>, <a class="local col1 ref" href="#591n" title='n' data-ref="591n" data-ref-filename="591n">n</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::name" title='auth_data::name' data-ref="auth_data::name" data-ref-filename="auth_data..name">name</a>);</td></tr>
<tr><th id="2147">2147</th><td>	} <b>else</b> {</td></tr>
<tr><th id="2148">2148</th><td>		<a class="local col2 ref" href="#592nm" title='nm' data-ref="592nm" data-ref-filename="592nm">nm</a> = <a class="local col0 ref" href="#590qinfo" title='qinfo' data-ref="590qinfo" data-ref-filename="590qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname" title='query_info::qname' data-ref="query_info::qname" data-ref-filename="query_info..qname">qname</a>;</td></tr>
<tr><th id="2149">2149</th><td>	}</td></tr>
<tr><th id="2150">2150</th><td>	<a class="ref fn" href="../util/data/dname.h.html#dname_count_size_labels" title='dname_count_size_labels' data-ref="dname_count_size_labels" data-ref-filename="dname_count_size_labels">dname_count_size_labels</a>(<a class="local col2 ref" href="#592nm" title='nm' data-ref="592nm" data-ref-filename="592nm">nm</a>, &amp;<a class="local col3 ref" href="#593nmlen" title='nmlen' data-ref="593nmlen" data-ref-filename="593nmlen">nmlen</a>);</td></tr>
<tr><th id="2151">2151</th><td>	<a class="local col1 ref" href="#591n" title='n' data-ref="591n" data-ref-filename="591n">n</a> = <a class="tu ref fn" href="#az_find_name" title='az_find_name' data-use='c' data-ref="az_find_name" data-ref-filename="az_find_name">az_find_name</a>(<a class="local col9 ref" href="#589z" title='z' data-ref="589z" data-ref-filename="589z">z</a>, <a class="local col2 ref" href="#592nm" title='nm' data-ref="592nm" data-ref-filename="592nm">nm</a>, <a class="local col3 ref" href="#593nmlen" title='nmlen' data-ref="593nmlen" data-ref-filename="593nmlen">nmlen</a>);</td></tr>
<tr><th id="2152">2152</th><td>	<i>/* delete labels and go up on name */</i></td></tr>
<tr><th id="2153">2153</th><td>	<b>while</b>(!<a class="local col1 ref" href="#591n" title='n' data-ref="591n" data-ref-filename="591n">n</a>) {</td></tr>
<tr><th id="2154">2154</th><td>		<b>if</b>(<a class="ref fn" href="../util/data/dname.h.html#dname_is_root" title='dname_is_root' data-ref="dname_is_root" data-ref-filename="dname_is_root">dname_is_root</a>(<a class="local col2 ref" href="#592nm" title='nm' data-ref="592nm" data-ref-filename="592nm">nm</a>))</td></tr>
<tr><th id="2155">2155</th><td>			<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>; <i>/* cannot go up */</i></td></tr>
<tr><th id="2156">2156</th><td>		<a class="ref fn" href="../util/data/dname.h.html#dname_remove_label" title='dname_remove_label' data-ref="dname_remove_label" data-ref-filename="dname_remove_label">dname_remove_label</a>(&amp;<a class="local col2 ref" href="#592nm" title='nm' data-ref="592nm" data-ref-filename="592nm">nm</a>, &amp;<a class="local col3 ref" href="#593nmlen" title='nmlen' data-ref="593nmlen" data-ref-filename="593nmlen">nmlen</a>);</td></tr>
<tr><th id="2157">2157</th><td>		<a class="local col1 ref" href="#591n" title='n' data-ref="591n" data-ref-filename="591n">n</a> = <a class="tu ref fn" href="#az_find_name" title='az_find_name' data-use='c' data-ref="az_find_name" data-ref-filename="az_find_name">az_find_name</a>(<a class="local col9 ref" href="#589z" title='z' data-ref="589z" data-ref-filename="589z">z</a>, <a class="local col2 ref" href="#592nm" title='nm' data-ref="592nm" data-ref-filename="592nm">nm</a>, <a class="local col3 ref" href="#593nmlen" title='nmlen' data-ref="593nmlen" data-ref-filename="593nmlen">nmlen</a>);</td></tr>
<tr><th id="2158">2158</th><td>	}</td></tr>
<tr><th id="2159">2159</th><td>	<b>return</b> <a class="local col1 ref" href="#591n" title='n' data-ref="591n" data-ref-filename="591n">n</a>;</td></tr>
<tr><th id="2160">2160</th><td>}</td></tr>
<tr><th id="2161">2161</th><td></td></tr>
<tr><th id="2162">2162</th><td><i class="doc" data-doc="az_domain_go_up">/** go up the auth tree to next existing name. */</i></td></tr>
<tr><th id="2163">2163</th><td><em>static</em> <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>*</td></tr>
<tr><th id="2164">2164</th><td><dfn class="tu decl def fn" id="az_domain_go_up" title='az_domain_go_up' data-type='struct auth_data * az_domain_go_up(struct auth_zone * z, struct auth_data * n)' data-ref="az_domain_go_up" data-ref-filename="az_domain_go_up">az_domain_go_up</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col4 decl" id="594z" title='z' data-type='struct auth_zone *' data-ref="594z" data-ref-filename="594z">z</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col5 decl" id="595n" title='n' data-type='struct auth_data *' data-ref="595n" data-ref-filename="595n">n</dfn>)</td></tr>
<tr><th id="2165">2165</th><td>{</td></tr>
<tr><th id="2166">2166</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col6 decl" id="596nm" title='nm' data-type='uint8_t *' data-ref="596nm" data-ref-filename="596nm">nm</dfn> = <a class="local col5 ref" href="#595n" title='n' data-ref="595n" data-ref-filename="595n">n</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::name" title='auth_data::name' data-ref="auth_data::name" data-ref-filename="auth_data..name">name</a>;</td></tr>
<tr><th id="2167">2167</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col7 decl" id="597nmlen" title='nmlen' data-type='size_t' data-ref="597nmlen" data-ref-filename="597nmlen">nmlen</dfn> = <a class="local col5 ref" href="#595n" title='n' data-ref="595n" data-ref-filename="595n">n</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::namelen" title='auth_data::namelen' data-ref="auth_data::namelen" data-ref-filename="auth_data..namelen">namelen</a>;</td></tr>
<tr><th id="2168">2168</th><td>	<b>while</b>(!<a class="ref fn" href="../util/data/dname.h.html#dname_is_root" title='dname_is_root' data-ref="dname_is_root" data-ref-filename="dname_is_root">dname_is_root</a>(<a class="local col6 ref" href="#596nm" title='nm' data-ref="596nm" data-ref-filename="596nm">nm</a>)) {</td></tr>
<tr><th id="2169">2169</th><td>		<a class="ref fn" href="../util/data/dname.h.html#dname_remove_label" title='dname_remove_label' data-ref="dname_remove_label" data-ref-filename="dname_remove_label">dname_remove_label</a>(&amp;<a class="local col6 ref" href="#596nm" title='nm' data-ref="596nm" data-ref-filename="596nm">nm</a>, &amp;<a class="local col7 ref" href="#597nmlen" title='nmlen' data-ref="597nmlen" data-ref-filename="597nmlen">nmlen</a>);</td></tr>
<tr><th id="2170">2170</th><td>		<b>if</b>((<a class="local col5 ref" href="#595n" title='n' data-ref="595n" data-ref-filename="595n">n</a>=<a class="tu ref fn" href="#az_find_name" title='az_find_name' data-use='c' data-ref="az_find_name" data-ref-filename="az_find_name">az_find_name</a>(<a class="local col4 ref" href="#594z" title='z' data-ref="594z" data-ref-filename="594z">z</a>, <a class="local col6 ref" href="#596nm" title='nm' data-ref="596nm" data-ref-filename="596nm">nm</a>, <a class="local col7 ref" href="#597nmlen" title='nmlen' data-ref="597nmlen" data-ref-filename="597nmlen">nmlen</a>)) != <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>)</td></tr>
<tr><th id="2171">2171</th><td>			<b>return</b> <a class="local col5 ref" href="#595n" title='n' data-ref="595n" data-ref-filename="595n">n</a>;</td></tr>
<tr><th id="2172">2172</th><td>	}</td></tr>
<tr><th id="2173">2173</th><td>	<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="2174">2174</th><td>}</td></tr>
<tr><th id="2175">2175</th><td></td></tr>
<tr><th id="2176">2176</th><td><i class="doc" data-doc="az_find_ce">/** Find the closest encloser, an name that exists and is above the</i></td></tr>
<tr><th id="2177">2177</th><td><i class="doc" data-doc="az_find_ce"> * qname.</i></td></tr>
<tr><th id="2178">2178</th><td><i class="doc" data-doc="az_find_ce"> * return true if the node (param node) is existing, nonobscured and</i></td></tr>
<tr><th id="2179">2179</th><td><i class="doc" data-doc="az_find_ce"> * 	can be used to generate answers from.  It is then also node_exact.</i></td></tr>
<tr><th id="2180">2180</th><td><i class="doc" data-doc="az_find_ce"> * returns false if the node is not good enough (or it wasn't node_exact)</i></td></tr>
<tr><th id="2181">2181</th><td><i class="doc" data-doc="az_find_ce"> *	in this case the ce can be filled.</i></td></tr>
<tr><th id="2182">2182</th><td><i class="doc" data-doc="az_find_ce"> *	if ce is NULL, no ce exists, and likely the zone is completely empty,</i></td></tr>
<tr><th id="2183">2183</th><td><i class="doc" data-doc="az_find_ce"> *	not even with a zone apex.</i></td></tr>
<tr><th id="2184">2184</th><td><i class="doc" data-doc="az_find_ce"> *	if ce is nonNULL it is the closest enclosing upper name (that exists</i></td></tr>
<tr><th id="2185">2185</th><td><i class="doc" data-doc="az_find_ce"> *	itself for answer purposes).  That name may have DNAME, NS or wildcard</i></td></tr>
<tr><th id="2186">2186</th><td><i class="doc" data-doc="az_find_ce"> *	rrset is the closest DNAME or NS rrset that was found.</i></td></tr>
<tr><th id="2187">2187</th><td><i class="doc" data-doc="az_find_ce"> */</i></td></tr>
<tr><th id="2188">2188</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="2189">2189</th><td><dfn class="tu decl def fn" id="az_find_ce" title='az_find_ce' data-type='int az_find_ce(struct auth_zone * z, struct query_info * qinfo, struct auth_data * node, int node_exact, struct auth_data ** ce, struct auth_rrset ** rrset)' data-ref="az_find_ce" data-ref-filename="az_find_ce">az_find_ce</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col8 decl" id="598z" title='z' data-type='struct auth_zone *' data-ref="598z" data-ref-filename="598z">z</dfn>, <b>struct</b> <a class="type" href="../util/data/msgreply.h.html#query_info" title='query_info' data-ref="query_info" data-ref-filename="query_info">query_info</a>* <dfn class="local col9 decl" id="599qinfo" title='qinfo' data-type='struct query_info *' data-ref="599qinfo" data-ref-filename="599qinfo">qinfo</dfn>,</td></tr>
<tr><th id="2190">2190</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col0 decl" id="600node" title='node' data-type='struct auth_data *' data-ref="600node" data-ref-filename="600node">node</dfn>, <em>int</em> <dfn class="local col1 decl" id="601node_exact" title='node_exact' data-type='int' data-ref="601node_exact" data-ref-filename="601node_exact">node_exact</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>** <dfn class="local col2 decl" id="602ce" title='ce' data-type='struct auth_data **' data-ref="602ce" data-ref-filename="602ce">ce</dfn>,</td></tr>
<tr><th id="2191">2191</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>** <dfn class="local col3 decl" id="603rrset" title='rrset' data-type='struct auth_rrset **' data-ref="603rrset" data-ref-filename="603rrset">rrset</dfn>)</td></tr>
<tr><th id="2192">2192</th><td>{</td></tr>
<tr><th id="2193">2193</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col4 decl" id="604n" title='n' data-type='struct auth_data *' data-ref="604n" data-ref-filename="604n">n</dfn> = <a class="local col0 ref" href="#600node" title='node' data-ref="600node" data-ref-filename="600node">node</a>;</td></tr>
<tr><th id="2194">2194</th><td>	*<a class="local col2 ref" href="#602ce" title='ce' data-ref="602ce" data-ref-filename="602ce">ce</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="2195">2195</th><td>	*<a class="local col3 ref" href="#603rrset" title='rrset' data-ref="603rrset" data-ref-filename="603rrset">rrset</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="2196">2196</th><td>	<b>if</b>(!<a class="local col1 ref" href="#601node_exact" title='node_exact' data-ref="601node_exact" data-ref-filename="601node_exact">node_exact</a>) {</td></tr>
<tr><th id="2197">2197</th><td>		<i>/* if not exact, lookup closest exact match */</i></td></tr>
<tr><th id="2198">2198</th><td>		<a class="local col4 ref" href="#604n" title='n' data-ref="604n" data-ref-filename="604n">n</a> = <a class="tu ref fn" href="#az_find_candidate_ce" title='az_find_candidate_ce' data-use='c' data-ref="az_find_candidate_ce" data-ref-filename="az_find_candidate_ce">az_find_candidate_ce</a>(<a class="local col8 ref" href="#598z" title='z' data-ref="598z" data-ref-filename="598z">z</a>, <a class="local col9 ref" href="#599qinfo" title='qinfo' data-ref="599qinfo" data-ref-filename="599qinfo">qinfo</a>, <a class="local col4 ref" href="#604n" title='n' data-ref="604n" data-ref-filename="604n">n</a>);</td></tr>
<tr><th id="2199">2199</th><td>	} <b>else</b> {</td></tr>
<tr><th id="2200">2200</th><td>		<i>/* if exact, the node itself is the first candidate ce */</i></td></tr>
<tr><th id="2201">2201</th><td>		*<a class="local col2 ref" href="#602ce" title='ce' data-ref="602ce" data-ref-filename="602ce">ce</a> = <a class="local col4 ref" href="#604n" title='n' data-ref="604n" data-ref-filename="604n">n</a>;</td></tr>
<tr><th id="2202">2202</th><td>	}</td></tr>
<tr><th id="2203">2203</th><td></td></tr>
<tr><th id="2204">2204</th><td>	<i>/* no direct answer from nsec3-only domains */</i></td></tr>
<tr><th id="2205">2205</th><td>	<b>if</b>(<a class="local col4 ref" href="#604n" title='n' data-ref="604n" data-ref-filename="604n">n</a> &amp;&amp; <a class="tu ref fn" href="#domain_has_only_nsec3" title='domain_has_only_nsec3' data-use='c' data-ref="domain_has_only_nsec3" data-ref-filename="domain_has_only_nsec3">domain_has_only_nsec3</a>(<a class="local col4 ref" href="#604n" title='n' data-ref="604n" data-ref-filename="604n">n</a>)) {</td></tr>
<tr><th id="2206">2206</th><td>		<a class="local col1 ref" href="#601node_exact" title='node_exact' data-ref="601node_exact" data-ref-filename="601node_exact">node_exact</a> = <var>0</var>;</td></tr>
<tr><th id="2207">2207</th><td>		*<a class="local col2 ref" href="#602ce" title='ce' data-ref="602ce" data-ref-filename="602ce">ce</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="2208">2208</th><td>	}</td></tr>
<tr><th id="2209">2209</th><td></td></tr>
<tr><th id="2210">2210</th><td>	<i>/* with exact matches, walk up the labels until we find the</i></td></tr>
<tr><th id="2211">2211</th><td><i>	 * delegation, or DNAME or zone end */</i></td></tr>
<tr><th id="2212">2212</th><td>	<b>while</b>(<a class="local col4 ref" href="#604n" title='n' data-ref="604n" data-ref-filename="604n">n</a>) {</td></tr>
<tr><th id="2213">2213</th><td>		<i>/* see if the current candidate has issues */</i></td></tr>
<tr><th id="2214">2214</th><td>		<i>/* not zone apex and has type NS */</i></td></tr>
<tr><th id="2215">2215</th><td>		<b>if</b>(<a class="local col4 ref" href="#604n" title='n' data-ref="604n" data-ref-filename="604n">n</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::namelen" title='auth_data::namelen' data-ref="auth_data::namelen" data-ref-filename="auth_data..namelen">namelen</a> != <a class="local col8 ref" href="#598z" title='z' data-ref="598z" data-ref-filename="598z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::namelen" title='auth_zone::namelen' data-ref="auth_zone::namelen" data-ref-filename="auth_zone..namelen">namelen</a> &amp;&amp;</td></tr>
<tr><th id="2216">2216</th><td>			(*<a class="local col3 ref" href="#603rrset" title='rrset' data-ref="603rrset" data-ref-filename="603rrset">rrset</a>=<a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(<a class="local col4 ref" href="#604n" title='n' data-ref="604n" data-ref-filename="604n">n</a>, <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_NS" title='LDNS_RR_TYPE_NS' data-ref="LDNS_RR_TYPE_NS" data-ref-filename="LDNS_RR_TYPE_NS">LDNS_RR_TYPE_NS</a>)) &amp;&amp;</td></tr>
<tr><th id="2217">2217</th><td>			<i>/* delegate here, but DS at exact the dp has notype */</i></td></tr>
<tr><th id="2218">2218</th><td>			(<a class="local col9 ref" href="#599qinfo" title='qinfo' data-ref="599qinfo" data-ref-filename="599qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qtype" title='query_info::qtype' data-ref="query_info::qtype" data-ref-filename="query_info..qtype">qtype</a> != <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_DS" title='LDNS_RR_TYPE_DS' data-ref="LDNS_RR_TYPE_DS" data-ref-filename="LDNS_RR_TYPE_DS">LDNS_RR_TYPE_DS</a> || </td></tr>
<tr><th id="2219">2219</th><td>			<a class="local col4 ref" href="#604n" title='n' data-ref="604n" data-ref-filename="604n">n</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::namelen" title='auth_data::namelen' data-ref="auth_data::namelen" data-ref-filename="auth_data..namelen">namelen</a> != <a class="local col9 ref" href="#599qinfo" title='qinfo' data-ref="599qinfo" data-ref-filename="599qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname_len" title='query_info::qname_len' data-ref="query_info::qname_len" data-ref-filename="query_info..qname_len">qname_len</a>)) {</td></tr>
<tr><th id="2220">2220</th><td>			<i>/* referral */</i></td></tr>
<tr><th id="2221">2221</th><td>			<i>/* this is ce and the lowernode is nonexisting */</i></td></tr>
<tr><th id="2222">2222</th><td>			*<a class="local col2 ref" href="#602ce" title='ce' data-ref="602ce" data-ref-filename="602ce">ce</a> = <a class="local col4 ref" href="#604n" title='n' data-ref="604n" data-ref-filename="604n">n</a>;</td></tr>
<tr><th id="2223">2223</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2224">2224</th><td>		}</td></tr>
<tr><th id="2225">2225</th><td>		<i>/* not equal to qname and has type DNAME */</i></td></tr>
<tr><th id="2226">2226</th><td>		<b>if</b>(<a class="local col4 ref" href="#604n" title='n' data-ref="604n" data-ref-filename="604n">n</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::namelen" title='auth_data::namelen' data-ref="auth_data::namelen" data-ref-filename="auth_data..namelen">namelen</a> != <a class="local col9 ref" href="#599qinfo" title='qinfo' data-ref="599qinfo" data-ref-filename="599qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname_len" title='query_info::qname_len' data-ref="query_info::qname_len" data-ref-filename="query_info..qname_len">qname_len</a> &amp;&amp;</td></tr>
<tr><th id="2227">2227</th><td>			(*<a class="local col3 ref" href="#603rrset" title='rrset' data-ref="603rrset" data-ref-filename="603rrset">rrset</a>=<a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(<a class="local col4 ref" href="#604n" title='n' data-ref="604n" data-ref-filename="604n">n</a>, <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_DNAME" title='LDNS_RR_TYPE_DNAME' data-ref="LDNS_RR_TYPE_DNAME" data-ref-filename="LDNS_RR_TYPE_DNAME">LDNS_RR_TYPE_DNAME</a>))) {</td></tr>
<tr><th id="2228">2228</th><td>			<i>/* this is ce and the lowernode is nonexisting */</i></td></tr>
<tr><th id="2229">2229</th><td>			*<a class="local col2 ref" href="#602ce" title='ce' data-ref="602ce" data-ref-filename="602ce">ce</a> = <a class="local col4 ref" href="#604n" title='n' data-ref="604n" data-ref-filename="604n">n</a>;</td></tr>
<tr><th id="2230">2230</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2231">2231</th><td>		}</td></tr>
<tr><th id="2232">2232</th><td></td></tr>
<tr><th id="2233">2233</th><td>		<b>if</b>(*<a class="local col2 ref" href="#602ce" title='ce' data-ref="602ce" data-ref-filename="602ce">ce</a> == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span> &amp;&amp; !<a class="tu ref fn" href="#domain_has_only_nsec3" title='domain_has_only_nsec3' data-use='c' data-ref="domain_has_only_nsec3" data-ref-filename="domain_has_only_nsec3">domain_has_only_nsec3</a>(<a class="local col4 ref" href="#604n" title='n' data-ref="604n" data-ref-filename="604n">n</a>)) {</td></tr>
<tr><th id="2234">2234</th><td>			<i>/* if not found yet, this exact name must be</i></td></tr>
<tr><th id="2235">2235</th><td><i>			 * our lowest match (but not nsec3onlydomain) */</i></td></tr>
<tr><th id="2236">2236</th><td>			*<a class="local col2 ref" href="#602ce" title='ce' data-ref="602ce" data-ref-filename="602ce">ce</a> = <a class="local col4 ref" href="#604n" title='n' data-ref="604n" data-ref-filename="604n">n</a>;</td></tr>
<tr><th id="2237">2237</th><td>		}</td></tr>
<tr><th id="2238">2238</th><td></td></tr>
<tr><th id="2239">2239</th><td>		<i>/* walk up the tree by removing labels from name and lookup */</i></td></tr>
<tr><th id="2240">2240</th><td>		<a class="local col4 ref" href="#604n" title='n' data-ref="604n" data-ref-filename="604n">n</a> = <a class="tu ref fn" href="#az_domain_go_up" title='az_domain_go_up' data-use='c' data-ref="az_domain_go_up" data-ref-filename="az_domain_go_up">az_domain_go_up</a>(<a class="local col8 ref" href="#598z" title='z' data-ref="598z" data-ref-filename="598z">z</a>, <a class="local col4 ref" href="#604n" title='n' data-ref="604n" data-ref-filename="604n">n</a>);</td></tr>
<tr><th id="2241">2241</th><td>	}</td></tr>
<tr><th id="2242">2242</th><td>	<i>/* found no problems, if it was an exact node, it is fine to use */</i></td></tr>
<tr><th id="2243">2243</th><td>	<b>return</b> <a class="local col1 ref" href="#601node_exact" title='node_exact' data-ref="601node_exact" data-ref-filename="601node_exact">node_exact</a>;</td></tr>
<tr><th id="2244">2244</th><td>}</td></tr>
<tr><th id="2245">2245</th><td></td></tr>
<tr><th id="2246">2246</th><td><i class="doc" data-doc="az_add_additionals_from">/** add additional A/AAAA from domain names in rrset rdata (+offset)</i></td></tr>
<tr><th id="2247">2247</th><td><i class="doc" data-doc="az_add_additionals_from"> * offset is number of bytes in rdata where the dname is located. */</i></td></tr>
<tr><th id="2248">2248</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="2249">2249</th><td><dfn class="tu decl def fn" id="az_add_additionals_from" title='az_add_additionals_from' data-type='int az_add_additionals_from(struct auth_zone * z, struct regional * region, struct dns_msg * msg, struct auth_rrset * rrset, size_t offset)' data-ref="az_add_additionals_from" data-ref-filename="az_add_additionals_from">az_add_additionals_from</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col5 decl" id="605z" title='z' data-type='struct auth_zone *' data-ref="605z" data-ref-filename="605z">z</dfn>, <b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col6 decl" id="606region" title='region' data-type='struct regional *' data-ref="606region" data-ref-filename="606region">region</dfn>,</td></tr>
<tr><th id="2250">2250</th><td>	<b>struct</b> <a class="type" href="cache/dns.h.html#dns_msg" title='dns_msg' data-ref="dns_msg" data-ref-filename="dns_msg">dns_msg</a>* <dfn class="local col7 decl" id="607msg" title='msg' data-type='struct dns_msg *' data-ref="607msg" data-ref-filename="607msg">msg</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col8 decl" id="608rrset" title='rrset' data-type='struct auth_rrset *' data-ref="608rrset" data-ref-filename="608rrset">rrset</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col9 decl" id="609offset" title='offset' data-type='size_t' data-ref="609offset" data-ref-filename="609offset">offset</dfn>)</td></tr>
<tr><th id="2251">2251</th><td>{</td></tr>
<tr><th id="2252">2252</th><td>	<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>* <dfn class="local col0 decl" id="610d" title='d' data-type='struct packed_rrset_data *' data-ref="610d" data-ref-filename="610d">d</dfn> = <a class="local col8 ref" href="#608rrset" title='rrset' data-ref="608rrset" data-ref-filename="608rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>;</td></tr>
<tr><th id="2253">2253</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col1 decl" id="611i" title='i' data-type='size_t' data-ref="611i" data-ref-filename="611i">i</dfn>;</td></tr>
<tr><th id="2254">2254</th><td>	<b>if</b>(!<a class="local col0 ref" href="#610d" title='d' data-ref="610d" data-ref-filename="610d">d</a>) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="2255">2255</th><td>	<b>for</b>(<a class="local col1 ref" href="#611i" title='i' data-ref="611i" data-ref-filename="611i">i</a>=<var>0</var>; <a class="local col1 ref" href="#611i" title='i' data-ref="611i" data-ref-filename="611i">i</a>&lt;<a class="local col0 ref" href="#610d" title='d' data-ref="610d" data-ref-filename="610d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>; <a class="local col1 ref" href="#611i" title='i' data-ref="611i" data-ref-filename="611i">i</a>++) {</td></tr>
<tr><th id="2256">2256</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col2 decl" id="612dlen" title='dlen' data-type='size_t' data-ref="612dlen" data-ref-filename="612dlen">dlen</dfn>;</td></tr>
<tr><th id="2257">2257</th><td>		<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col3 decl" id="613domain" title='domain' data-type='struct auth_data *' data-ref="613domain" data-ref-filename="613domain">domain</dfn>;</td></tr>
<tr><th id="2258">2258</th><td>		<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col4 decl" id="614ref" title='ref' data-type='struct auth_rrset *' data-ref="614ref" data-ref-filename="614ref">ref</dfn>;</td></tr>
<tr><th id="2259">2259</th><td>		<b>if</b>(<a class="local col0 ref" href="#610d" title='d' data-ref="610d" data-ref-filename="610d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<a class="local col1 ref" href="#611i" title='i' data-ref="611i" data-ref-filename="611i">i</a>] &lt; <var>2</var>+<a class="local col9 ref" href="#609offset" title='offset' data-ref="609offset" data-ref-filename="609offset">offset</a>)</td></tr>
<tr><th id="2260">2260</th><td>			<b>continue</b>; <i>/* too short */</i></td></tr>
<tr><th id="2261">2261</th><td>		<b>if</b>(!(<a class="local col2 ref" href="#612dlen" title='dlen' data-ref="612dlen" data-ref-filename="612dlen">dlen</a> = <a class="ref fn" href="../util/data/dname.h.html#dname_valid" title='dname_valid' data-ref="dname_valid" data-ref-filename="dname_valid">dname_valid</a>(<a class="local col0 ref" href="#610d" title='d' data-ref="610d" data-ref-filename="610d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<a class="local col1 ref" href="#611i" title='i' data-ref="611i" data-ref-filename="611i">i</a>]+<var>2</var>+<a class="local col9 ref" href="#609offset" title='offset' data-ref="609offset" data-ref-filename="609offset">offset</a>,</td></tr>
<tr><th id="2262">2262</th><td>			<a class="local col0 ref" href="#610d" title='d' data-ref="610d" data-ref-filename="610d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<a class="local col1 ref" href="#611i" title='i' data-ref="611i" data-ref-filename="611i">i</a>]-<var>2</var>-<a class="local col9 ref" href="#609offset" title='offset' data-ref="609offset" data-ref-filename="609offset">offset</a>)))</td></tr>
<tr><th id="2263">2263</th><td>			<b>continue</b>; <i>/* malformed */</i></td></tr>
<tr><th id="2264">2264</th><td>		<a class="local col3 ref" href="#613domain" title='domain' data-ref="613domain" data-ref-filename="613domain">domain</a> = <a class="tu ref fn" href="#az_find_name" title='az_find_name' data-use='c' data-ref="az_find_name" data-ref-filename="az_find_name">az_find_name</a>(<a class="local col5 ref" href="#605z" title='z' data-ref="605z" data-ref-filename="605z">z</a>, <a class="local col0 ref" href="#610d" title='d' data-ref="610d" data-ref-filename="610d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<a class="local col1 ref" href="#611i" title='i' data-ref="611i" data-ref-filename="611i">i</a>]+<var>2</var>+<a class="local col9 ref" href="#609offset" title='offset' data-ref="609offset" data-ref-filename="609offset">offset</a>, <a class="local col2 ref" href="#612dlen" title='dlen' data-ref="612dlen" data-ref-filename="612dlen">dlen</a>);</td></tr>
<tr><th id="2265">2265</th><td>		<b>if</b>(!<a class="local col3 ref" href="#613domain" title='domain' data-ref="613domain" data-ref-filename="613domain">domain</a>)</td></tr>
<tr><th id="2266">2266</th><td>			<b>continue</b>;</td></tr>
<tr><th id="2267">2267</th><td>		<b>if</b>((<a class="local col4 ref" href="#614ref" title='ref' data-ref="614ref" data-ref-filename="614ref">ref</a>=<a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(<a class="local col3 ref" href="#613domain" title='domain' data-ref="613domain" data-ref-filename="613domain">domain</a>, <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_A" title='LDNS_RR_TYPE_A' data-ref="LDNS_RR_TYPE_A" data-ref-filename="LDNS_RR_TYPE_A">LDNS_RR_TYPE_A</a>)) != <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="2268">2268</th><td>			<b>if</b>(!<a class="tu ref fn" href="#msg_add_rrset_ar" title='msg_add_rrset_ar' data-use='c' data-ref="msg_add_rrset_ar" data-ref-filename="msg_add_rrset_ar">msg_add_rrset_ar</a>(<a class="local col5 ref" href="#605z" title='z' data-ref="605z" data-ref-filename="605z">z</a>, <a class="local col6 ref" href="#606region" title='region' data-ref="606region" data-ref-filename="606region">region</a>, <a class="local col7 ref" href="#607msg" title='msg' data-ref="607msg" data-ref-filename="607msg">msg</a>, <a class="local col3 ref" href="#613domain" title='domain' data-ref="613domain" data-ref-filename="613domain">domain</a>, <a class="local col4 ref" href="#614ref" title='ref' data-ref="614ref" data-ref-filename="614ref">ref</a>))</td></tr>
<tr><th id="2269">2269</th><td>				<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2270">2270</th><td>		}</td></tr>
<tr><th id="2271">2271</th><td>		<b>if</b>((<a class="local col4 ref" href="#614ref" title='ref' data-ref="614ref" data-ref-filename="614ref">ref</a>=<a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(<a class="local col3 ref" href="#613domain" title='domain' data-ref="613domain" data-ref-filename="613domain">domain</a>, <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_AAAA" title='LDNS_RR_TYPE_AAAA' data-ref="LDNS_RR_TYPE_AAAA" data-ref-filename="LDNS_RR_TYPE_AAAA">LDNS_RR_TYPE_AAAA</a>)) != <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="2272">2272</th><td>			<b>if</b>(!<a class="tu ref fn" href="#msg_add_rrset_ar" title='msg_add_rrset_ar' data-use='c' data-ref="msg_add_rrset_ar" data-ref-filename="msg_add_rrset_ar">msg_add_rrset_ar</a>(<a class="local col5 ref" href="#605z" title='z' data-ref="605z" data-ref-filename="605z">z</a>, <a class="local col6 ref" href="#606region" title='region' data-ref="606region" data-ref-filename="606region">region</a>, <a class="local col7 ref" href="#607msg" title='msg' data-ref="607msg" data-ref-filename="607msg">msg</a>, <a class="local col3 ref" href="#613domain" title='domain' data-ref="613domain" data-ref-filename="613domain">domain</a>, <a class="local col4 ref" href="#614ref" title='ref' data-ref="614ref" data-ref-filename="614ref">ref</a>))</td></tr>
<tr><th id="2273">2273</th><td>				<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2274">2274</th><td>		}</td></tr>
<tr><th id="2275">2275</th><td>	}</td></tr>
<tr><th id="2276">2276</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="2277">2277</th><td>}</td></tr>
<tr><th id="2278">2278</th><td></td></tr>
<tr><th id="2279">2279</th><td><i class="doc" data-doc="az_add_negative_soa">/** add negative SOA record (with negative TTL) */</i></td></tr>
<tr><th id="2280">2280</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="2281">2281</th><td><dfn class="tu decl def fn" id="az_add_negative_soa" title='az_add_negative_soa' data-type='int az_add_negative_soa(struct auth_zone * z, struct regional * region, struct dns_msg * msg)' data-ref="az_add_negative_soa" data-ref-filename="az_add_negative_soa">az_add_negative_soa</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col5 decl" id="615z" title='z' data-type='struct auth_zone *' data-ref="615z" data-ref-filename="615z">z</dfn>, <b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col6 decl" id="616region" title='region' data-type='struct regional *' data-ref="616region" data-ref-filename="616region">region</dfn>,</td></tr>
<tr><th id="2282">2282</th><td>	<b>struct</b> <a class="type" href="cache/dns.h.html#dns_msg" title='dns_msg' data-ref="dns_msg" data-ref-filename="dns_msg">dns_msg</a>* <dfn class="local col7 decl" id="617msg" title='msg' data-type='struct dns_msg *' data-ref="617msg" data-ref-filename="617msg">msg</dfn>)</td></tr>
<tr><th id="2283">2283</th><td>{</td></tr>
<tr><th id="2284">2284</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a> <dfn class="local col8 decl" id="618minimum" title='minimum' data-type='uint32_t' data-ref="618minimum" data-ref-filename="618minimum">minimum</dfn>;</td></tr>
<tr><th id="2285">2285</th><td>	<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>* <dfn class="local col9 decl" id="619d" title='d' data-type='struct packed_rrset_data *' data-ref="619d" data-ref-filename="619d">d</dfn>;</td></tr>
<tr><th id="2286">2286</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col0 decl" id="620soa" title='soa' data-type='struct auth_rrset *' data-ref="620soa" data-ref-filename="620soa">soa</dfn>;</td></tr>
<tr><th id="2287">2287</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col1 decl" id="621apex" title='apex' data-type='struct auth_data *' data-ref="621apex" data-ref-filename="621apex">apex</dfn> = <a class="tu ref fn" href="#az_find_name" title='az_find_name' data-use='c' data-ref="az_find_name" data-ref-filename="az_find_name">az_find_name</a>(<a class="local col5 ref" href="#615z" title='z' data-ref="615z" data-ref-filename="615z">z</a>, <a class="local col5 ref" href="#615z" title='z' data-ref="615z" data-ref-filename="615z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::name" title='auth_zone::name' data-ref="auth_zone::name" data-ref-filename="auth_zone..name">name</a>, <a class="local col5 ref" href="#615z" title='z' data-ref="615z" data-ref-filename="615z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::namelen" title='auth_zone::namelen' data-ref="auth_zone::namelen" data-ref-filename="auth_zone..namelen">namelen</a>);</td></tr>
<tr><th id="2288">2288</th><td>	<b>if</b>(!<a class="local col1 ref" href="#621apex" title='apex' data-ref="621apex" data-ref-filename="621apex">apex</a>) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="2289">2289</th><td>	<a class="local col0 ref" href="#620soa" title='soa' data-ref="620soa" data-ref-filename="620soa">soa</a> = <a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(<a class="local col1 ref" href="#621apex" title='apex' data-ref="621apex" data-ref-filename="621apex">apex</a>, <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_SOA" title='LDNS_RR_TYPE_SOA' data-ref="LDNS_RR_TYPE_SOA" data-ref-filename="LDNS_RR_TYPE_SOA">LDNS_RR_TYPE_SOA</a>);</td></tr>
<tr><th id="2290">2290</th><td>	<b>if</b>(!<a class="local col0 ref" href="#620soa" title='soa' data-ref="620soa" data-ref-filename="620soa">soa</a>) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="2291">2291</th><td>	<i>/* must be first to put in message; we want to fix the TTL with</i></td></tr>
<tr><th id="2292">2292</th><td><i>	 * one RRset here, otherwise we'd need to loop over the RRs to get</i></td></tr>
<tr><th id="2293">2293</th><td><i>	 * the resulting lower TTL */</i></td></tr>
<tr><th id="2294">2294</th><td>	<a class="macro" href="../util/log.h.html#211" title="" data-ref="_M/log_assert">log_assert</a>(msg-&gt;rep-&gt;rrset_count == <var>0</var>);</td></tr>
<tr><th id="2295">2295</th><td>	<b>if</b>(!<a class="tu ref fn" href="#msg_add_rrset_ns" title='msg_add_rrset_ns' data-use='c' data-ref="msg_add_rrset_ns" data-ref-filename="msg_add_rrset_ns">msg_add_rrset_ns</a>(<a class="local col5 ref" href="#615z" title='z' data-ref="615z" data-ref-filename="615z">z</a>, <a class="local col6 ref" href="#616region" title='region' data-ref="616region" data-ref-filename="616region">region</a>, <a class="local col7 ref" href="#617msg" title='msg' data-ref="617msg" data-ref-filename="617msg">msg</a>, <a class="local col1 ref" href="#621apex" title='apex' data-ref="621apex" data-ref-filename="621apex">apex</a>, <a class="local col0 ref" href="#620soa" title='soa' data-ref="620soa" data-ref-filename="620soa">soa</a>)) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="2296">2296</th><td>	<i>/* fixup TTL */</i></td></tr>
<tr><th id="2297">2297</th><td>	<a class="local col9 ref" href="#619d" title='d' data-ref="619d" data-ref-filename="619d">d</a> = (<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>*)<a class="local col7 ref" href="#617msg" title='msg' data-ref="617msg" data-ref-filename="617msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrsets" title='reply_info::rrsets' data-ref="reply_info::rrsets" data-ref-filename="reply_info..rrsets">rrsets</a>[<a class="local col7 ref" href="#617msg" title='msg' data-ref="617msg" data-ref-filename="617msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrset_count" title='reply_info::rrset_count' data-ref="reply_info::rrset_count" data-ref-filename="reply_info..rrset_count">rrset_count</a>-<var>1</var>]-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key::entry" title='ub_packed_rrset_key::entry' data-ref="ub_packed_rrset_key::entry" data-ref-filename="ub_packed_rrset_key..entry">entry</a>.<a class="ref field" href="../util/storage/lruhash.h.html#lruhash_entry::data" title='lruhash_entry::data' data-ref="lruhash_entry::data" data-ref-filename="lruhash_entry..data">data</a>;</td></tr>
<tr><th id="2298">2298</th><td>	<i>/* last 4 bytes are minimum ttl in network format */</i></td></tr>
<tr><th id="2299">2299</th><td>	<b>if</b>(<a class="local col9 ref" href="#619d" title='d' data-ref="619d" data-ref-filename="619d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a> == <var>0</var>) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="2300">2300</th><td>	<b>if</b>(<a class="local col9 ref" href="#619d" title='d' data-ref="619d" data-ref-filename="619d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<var>0</var>] &lt; <var>2</var>+<var>4</var>) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="2301">2301</th><td>	<a class="local col8 ref" href="#618minimum" title='minimum' data-ref="618minimum" data-ref-filename="618minimum">minimum</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_read_uint32" title='sldns_read_uint32' data-ref="sldns_read_uint32" data-ref-filename="sldns_read_uint32">sldns_read_uint32</a>(<a class="local col9 ref" href="#619d" title='d' data-ref="619d" data-ref-filename="619d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<var>0</var>]+(<a class="local col9 ref" href="#619d" title='d' data-ref="619d" data-ref-filename="619d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<var>0</var>]-<var>4</var>));</td></tr>
<tr><th id="2302">2302</th><td>	<a class="local col9 ref" href="#619d" title='d' data-ref="619d" data-ref-filename="619d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::ttl" title='packed_rrset_data::ttl' data-ref="packed_rrset_data::ttl" data-ref-filename="packed_rrset_data..ttl">ttl</a> = (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#time_t" title='time_t' data-type='__int64_t' data-ref="time_t" data-ref-filename="time_t">time_t</a>)<a class="local col8 ref" href="#618minimum" title='minimum' data-ref="618minimum" data-ref-filename="618minimum">minimum</a>;</td></tr>
<tr><th id="2303">2303</th><td>	<a class="local col9 ref" href="#619d" title='d' data-ref="619d" data-ref-filename="619d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_ttl" title='packed_rrset_data::rr_ttl' data-ref="packed_rrset_data::rr_ttl" data-ref-filename="packed_rrset_data..rr_ttl">rr_ttl</a>[<var>0</var>] = (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#time_t" title='time_t' data-type='__int64_t' data-ref="time_t" data-ref-filename="time_t">time_t</a>)<a class="local col8 ref" href="#618minimum" title='minimum' data-ref="618minimum" data-ref-filename="618minimum">minimum</a>;</td></tr>
<tr><th id="2304">2304</th><td>	<a class="local col7 ref" href="#617msg" title='msg' data-ref="617msg" data-ref-filename="617msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::ttl" title='reply_info::ttl' data-ref="reply_info::ttl" data-ref-filename="reply_info..ttl">ttl</a> = <a class="tu ref fn" href="#get_rrset_ttl" title='get_rrset_ttl' data-use='c' data-ref="get_rrset_ttl" data-ref-filename="get_rrset_ttl">get_rrset_ttl</a>(<a class="local col7 ref" href="#617msg" title='msg' data-ref="617msg" data-ref-filename="617msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrsets" title='reply_info::rrsets' data-ref="reply_info::rrsets" data-ref-filename="reply_info..rrsets">rrsets</a>[<var>0</var>]);</td></tr>
<tr><th id="2305">2305</th><td>	<a class="local col7 ref" href="#617msg" title='msg' data-ref="617msg" data-ref-filename="617msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::prefetch_ttl" title='reply_info::prefetch_ttl' data-ref="reply_info::prefetch_ttl" data-ref-filename="reply_info..prefetch_ttl">prefetch_ttl</a> = <a class="macro" href="../util/data/msgreply.h.html#63" title="((msg-&gt;rep-&gt;ttl) - (msg-&gt;rep-&gt;ttl)/10)" data-ref="_M/PREFETCH_TTL_CALC">PREFETCH_TTL_CALC</a>(<a class="local col7 ref" href="#617msg" title='msg' data-ref="617msg" data-ref-filename="617msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::ttl" title='reply_info::ttl' data-ref="reply_info::ttl" data-ref-filename="reply_info..ttl">ttl</a>);</td></tr>
<tr><th id="2306">2306</th><td>	<a class="local col7 ref" href="#617msg" title='msg' data-ref="617msg" data-ref-filename="617msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::serve_expired_ttl" title='reply_info::serve_expired_ttl' data-ref="reply_info::serve_expired_ttl" data-ref-filename="reply_info..serve_expired_ttl">serve_expired_ttl</a> = <a class="local col7 ref" href="#617msg" title='msg' data-ref="617msg" data-ref-filename="617msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::ttl" title='reply_info::ttl' data-ref="reply_info::ttl" data-ref-filename="reply_info..ttl">ttl</a> + <a class="ref" href="../util/data/msgparse.h.html#SERVE_EXPIRED_TTL" title='SERVE_EXPIRED_TTL' data-ref="SERVE_EXPIRED_TTL" data-ref-filename="SERVE_EXPIRED_TTL">SERVE_EXPIRED_TTL</a>;</td></tr>
<tr><th id="2307">2307</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="2308">2308</th><td>}</td></tr>
<tr><th id="2309">2309</th><td></td></tr>
<tr><th id="2310">2310</th><td><i class="doc" data-doc="az_empty_nonterminal">/** See if the query goes to empty nonterminal (that has no auth_data,</i></td></tr>
<tr><th id="2311">2311</th><td><i class="doc" data-doc="az_empty_nonterminal"> * but there are nodes underneath.  We already checked that there are</i></td></tr>
<tr><th id="2312">2312</th><td><i class="doc" data-doc="az_empty_nonterminal"> * not NS, or DNAME above, so that we only need to check if some node</i></td></tr>
<tr><th id="2313">2313</th><td><i class="doc" data-doc="az_empty_nonterminal"> * exists below (with nonempty rr list), return true if emptynonterminal */</i></td></tr>
<tr><th id="2314">2314</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="2315">2315</th><td><dfn class="tu decl def fn" id="az_empty_nonterminal" title='az_empty_nonterminal' data-type='int az_empty_nonterminal(struct auth_zone * z, struct query_info * qinfo, struct auth_data * node)' data-ref="az_empty_nonterminal" data-ref-filename="az_empty_nonterminal">az_empty_nonterminal</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col2 decl" id="622z" title='z' data-type='struct auth_zone *' data-ref="622z" data-ref-filename="622z">z</dfn>, <b>struct</b> <a class="type" href="../util/data/msgreply.h.html#query_info" title='query_info' data-ref="query_info" data-ref-filename="query_info">query_info</a>* <dfn class="local col3 decl" id="623qinfo" title='qinfo' data-type='struct query_info *' data-ref="623qinfo" data-ref-filename="623qinfo">qinfo</dfn>,</td></tr>
<tr><th id="2316">2316</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col4 decl" id="624node" title='node' data-type='struct auth_data *' data-ref="624node" data-ref-filename="624node">node</dfn>)</td></tr>
<tr><th id="2317">2317</th><td>{</td></tr>
<tr><th id="2318">2318</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col5 decl" id="625next" title='next' data-type='struct auth_data *' data-ref="625next" data-ref-filename="625next">next</dfn>;</td></tr>
<tr><th id="2319">2319</th><td>	<b>if</b>(!<a class="local col4 ref" href="#624node" title='node' data-ref="624node" data-ref-filename="624node">node</a>) {</td></tr>
<tr><th id="2320">2320</th><td>		<i>/* no smaller was found, use first (smallest) node as the</i></td></tr>
<tr><th id="2321">2321</th><td><i>		 * next one */</i></td></tr>
<tr><th id="2322">2322</th><td>		<a class="local col5 ref" href="#625next" title='next' data-ref="625next" data-ref-filename="625next">next</a> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>*)<a class="ref fn" href="../util/rbtree.h.html#rbtree_first" title='rbtree_first' data-ref="rbtree_first" data-ref-filename="rbtree_first">rbtree_first</a>(&amp;<a class="local col2 ref" href="#622z" title='z' data-ref="622z" data-ref-filename="622z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::data" title='auth_zone::data' data-ref="auth_zone::data" data-ref-filename="auth_zone..data">data</a>);</td></tr>
<tr><th id="2323">2323</th><td>	} <b>else</b> {</td></tr>
<tr><th id="2324">2324</th><td>		<a class="local col5 ref" href="#625next" title='next' data-ref="625next" data-ref-filename="625next">next</a> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>*)<a class="ref fn" href="../util/rbtree.h.html#rbtree_next" title='rbtree_next' data-ref="rbtree_next" data-ref-filename="rbtree_next">rbtree_next</a>(&amp;<a class="local col4 ref" href="#624node" title='node' data-ref="624node" data-ref-filename="624node">node</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::node" title='auth_data::node' data-ref="auth_data::node" data-ref-filename="auth_data..node">node</a>);</td></tr>
<tr><th id="2325">2325</th><td>	}</td></tr>
<tr><th id="2326">2326</th><td>	<b>while</b>(<a class="local col5 ref" href="#625next" title='next' data-ref="625next" data-ref-filename="625next">next</a> &amp;&amp; (<a class="typedef" href="../util/rbtree.h.html#rbnode_type" title='rbnode_type' data-type='struct rbnode_type' data-ref="rbnode_type" data-ref-filename="rbnode_type">rbnode_type</a>*)<a class="local col5 ref" href="#625next" title='next' data-ref="625next" data-ref-filename="625next">next</a> != <a class="macro" href="../util/rbtree.h.html#69" title="&amp;rbtree_null_node" data-ref="_M/RBTREE_NULL">RBTREE_NULL</a> &amp;&amp; <a class="local col5 ref" href="#625next" title='next' data-ref="625next" data-ref-filename="625next">next</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::rrsets" title='auth_data::rrsets' data-ref="auth_data::rrsets" data-ref-filename="auth_data..rrsets">rrsets</a> == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="2327">2327</th><td>		<i>/* the next name has empty rrsets, is an empty nonterminal</i></td></tr>
<tr><th id="2328">2328</th><td><i>		 * itself, see if there exists something below it */</i></td></tr>
<tr><th id="2329">2329</th><td>		<a class="local col5 ref" href="#625next" title='next' data-ref="625next" data-ref-filename="625next">next</a> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>*)<a class="ref fn" href="../util/rbtree.h.html#rbtree_next" title='rbtree_next' data-ref="rbtree_next" data-ref-filename="rbtree_next">rbtree_next</a>(&amp;<a class="local col4 ref" href="#624node" title='node' data-ref="624node" data-ref-filename="624node">node</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::node" title='auth_data::node' data-ref="auth_data::node" data-ref-filename="auth_data..node">node</a>);</td></tr>
<tr><th id="2330">2330</th><td>	}</td></tr>
<tr><th id="2331">2331</th><td>	<b>if</b>((<a class="typedef" href="../util/rbtree.h.html#rbnode_type" title='rbnode_type' data-type='struct rbnode_type' data-ref="rbnode_type" data-ref-filename="rbnode_type">rbnode_type</a>*)<a class="local col5 ref" href="#625next" title='next' data-ref="625next" data-ref-filename="625next">next</a> == <a class="macro" href="../util/rbtree.h.html#69" title="&amp;rbtree_null_node" data-ref="_M/RBTREE_NULL">RBTREE_NULL</a> || !<a class="local col5 ref" href="#625next" title='next' data-ref="625next" data-ref-filename="625next">next</a>) {</td></tr>
<tr><th id="2332">2332</th><td>		<i>/* there is no next node, so something below it cannot</i></td></tr>
<tr><th id="2333">2333</th><td><i>		 * exist */</i></td></tr>
<tr><th id="2334">2334</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2335">2335</th><td>	}</td></tr>
<tr><th id="2336">2336</th><td>	<i>/* a next node exists, if there was something below the query,</i></td></tr>
<tr><th id="2337">2337</th><td><i>	 * this node has to be it.  See if it is below the query name */</i></td></tr>
<tr><th id="2338">2338</th><td>	<b>if</b>(<a class="ref fn" href="../util/data/dname.h.html#dname_strict_subdomain_c" title='dname_strict_subdomain_c' data-ref="dname_strict_subdomain_c" data-ref-filename="dname_strict_subdomain_c">dname_strict_subdomain_c</a>(<a class="local col5 ref" href="#625next" title='next' data-ref="625next" data-ref-filename="625next">next</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::name" title='auth_data::name' data-ref="auth_data::name" data-ref-filename="auth_data..name">name</a>, <a class="local col3 ref" href="#623qinfo" title='qinfo' data-ref="623qinfo" data-ref-filename="623qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname" title='query_info::qname' data-ref="query_info::qname" data-ref-filename="query_info..qname">qname</a>))</td></tr>
<tr><th id="2339">2339</th><td>		<b>return</b> <var>1</var>;</td></tr>
<tr><th id="2340">2340</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2341">2341</th><td>}</td></tr>
<tr><th id="2342">2342</th><td></td></tr>
<tr><th id="2343">2343</th><td><i class="doc" data-doc="synth_cname_buf">/** create synth cname target name in buffer, or fail if too long */</i></td></tr>
<tr><th id="2344">2344</th><td><em>static</em> <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a></td></tr>
<tr><th id="2345">2345</th><td><dfn class="tu decl def fn" id="synth_cname_buf" title='synth_cname_buf' data-type='size_t synth_cname_buf(uint8_t * qname, size_t qname_len, size_t dname_len, uint8_t * dtarg, size_t dtarglen, uint8_t * buf, size_t buflen)' data-ref="synth_cname_buf" data-ref-filename="synth_cname_buf">synth_cname_buf</dfn>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col6 decl" id="626qname" title='qname' data-type='uint8_t *' data-ref="626qname" data-ref-filename="626qname">qname</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col7 decl" id="627qname_len" title='qname_len' data-type='size_t' data-ref="627qname_len" data-ref-filename="627qname_len">qname_len</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col8 decl" id="628dname_len" title='dname_len' data-type='size_t' data-ref="628dname_len" data-ref-filename="628dname_len">dname_len</dfn>,</td></tr>
<tr><th id="2346">2346</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col9 decl" id="629dtarg" title='dtarg' data-type='uint8_t *' data-ref="629dtarg" data-ref-filename="629dtarg">dtarg</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col0 decl" id="630dtarglen" title='dtarglen' data-type='size_t' data-ref="630dtarglen" data-ref-filename="630dtarglen">dtarglen</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col1 decl" id="631buf" title='buf' data-type='uint8_t *' data-ref="631buf" data-ref-filename="631buf">buf</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col2 decl" id="632buflen" title='buflen' data-type='size_t' data-ref="632buflen" data-ref-filename="632buflen">buflen</dfn>)</td></tr>
<tr><th id="2347">2347</th><td>{</td></tr>
<tr><th id="2348">2348</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col3 decl" id="633newlen" title='newlen' data-type='size_t' data-ref="633newlen" data-ref-filename="633newlen">newlen</dfn> = <a class="local col7 ref" href="#627qname_len" title='qname_len' data-ref="627qname_len" data-ref-filename="627qname_len">qname_len</a> + <a class="local col0 ref" href="#630dtarglen" title='dtarglen' data-ref="630dtarglen" data-ref-filename="630dtarglen">dtarglen</a> - <a class="local col8 ref" href="#628dname_len" title='dname_len' data-ref="628dname_len" data-ref-filename="628dname_len">dname_len</a>;</td></tr>
<tr><th id="2349">2349</th><td>	<b>if</b>(<a class="local col3 ref" href="#633newlen" title='newlen' data-ref="633newlen" data-ref-filename="633newlen">newlen</a> &gt; <a class="local col2 ref" href="#632buflen" title='buflen' data-ref="632buflen" data-ref-filename="632buflen">buflen</a>) {</td></tr>
<tr><th id="2350">2350</th><td>		<i>/* YXDOMAIN error */</i></td></tr>
<tr><th id="2351">2351</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2352">2352</th><td>	}</td></tr>
<tr><th id="2353">2353</th><td>	<i>/* new name is concatenation of qname front (without DNAME owner)</i></td></tr>
<tr><th id="2354">2354</th><td><i>	 * and DNAME target name */</i></td></tr>
<tr><th id="2355">2355</th><td>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#95" title="((__builtin_object_size(buf, 0) != (size_t)-1) ? __builtin___memcpy_chk(buf, qname, qname_len-dname_len, __builtin_object_size(buf, 0)) : __memcpy_ichk(buf, qname, qname_len-dname_len))" data-ref="_M/memcpy">memcpy</a>(<a class="local col1 ref" href="#631buf" title='buf' data-ref="631buf" data-ref-filename="631buf">buf</a>, <a class="local col6 ref" href="#626qname" title='qname' data-ref="626qname" data-ref-filename="626qname">qname</a>, <a class="local col7 ref" href="#627qname_len" title='qname_len' data-ref="627qname_len" data-ref-filename="627qname_len">qname_len</a>-<a class="local col8 ref" href="#628dname_len" title='dname_len' data-ref="628dname_len" data-ref-filename="628dname_len">dname_len</a>);</td></tr>
<tr><th id="2356">2356</th><td>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(buf+(qname_len-dname_len), 0) != (size_t)-1) ? __builtin___memmove_chk(buf+(qname_len-dname_len), dtarg, dtarglen, __builtin_object_size(buf+(qname_len-dname_len), 0)) : __memmove_ichk(buf+(qname_len-dname_len), dtarg, dtarglen))" data-ref="_M/memmove">memmove</a>(<a class="local col1 ref" href="#631buf" title='buf' data-ref="631buf" data-ref-filename="631buf">buf</a>+(<a class="local col7 ref" href="#627qname_len" title='qname_len' data-ref="627qname_len" data-ref-filename="627qname_len">qname_len</a>-<a class="local col8 ref" href="#628dname_len" title='dname_len' data-ref="628dname_len" data-ref-filename="628dname_len">dname_len</a>), <a class="local col9 ref" href="#629dtarg" title='dtarg' data-ref="629dtarg" data-ref-filename="629dtarg">dtarg</a>, <a class="local col0 ref" href="#630dtarglen" title='dtarglen' data-ref="630dtarglen" data-ref-filename="630dtarglen">dtarglen</a>);</td></tr>
<tr><th id="2357">2357</th><td>	<b>return</b> <a class="local col3 ref" href="#633newlen" title='newlen' data-ref="633newlen" data-ref-filename="633newlen">newlen</a>;</td></tr>
<tr><th id="2358">2358</th><td>}</td></tr>
<tr><th id="2359">2359</th><td></td></tr>
<tr><th id="2360">2360</th><td><i class="doc" data-doc="create_synth_cname">/** create synthetic CNAME rrset for in a DNAME answer in region,</i></td></tr>
<tr><th id="2361">2361</th><td><i class="doc" data-doc="create_synth_cname"> * false on alloc failure, cname==NULL when name too long. */</i></td></tr>
<tr><th id="2362">2362</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="2363">2363</th><td><dfn class="tu decl def fn" id="create_synth_cname" title='create_synth_cname' data-type='int create_synth_cname(uint8_t * qname, size_t qname_len, struct regional * region, struct auth_data * node, struct auth_rrset * dname, uint16_t dclass, struct ub_packed_rrset_key ** cname)' data-ref="create_synth_cname" data-ref-filename="create_synth_cname">create_synth_cname</dfn>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col4 decl" id="634qname" title='qname' data-type='uint8_t *' data-ref="634qname" data-ref-filename="634qname">qname</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col5 decl" id="635qname_len" title='qname_len' data-type='size_t' data-ref="635qname_len" data-ref-filename="635qname_len">qname_len</dfn>, <b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col6 decl" id="636region" title='region' data-type='struct regional *' data-ref="636region" data-ref-filename="636region">region</dfn>,</td></tr>
<tr><th id="2364">2364</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col7 decl" id="637node" title='node' data-type='struct auth_data *' data-ref="637node" data-ref-filename="637node">node</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col8 decl" id="638dname" title='dname' data-type='struct auth_rrset *' data-ref="638dname" data-ref-filename="638dname">dname</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col9 decl" id="639dclass" title='dclass' data-type='uint16_t' data-ref="639dclass" data-ref-filename="639dclass">dclass</dfn>,</td></tr>
<tr><th id="2365">2365</th><td>	<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key" title='ub_packed_rrset_key' data-ref="ub_packed_rrset_key" data-ref-filename="ub_packed_rrset_key">ub_packed_rrset_key</a>** <dfn class="local col0 decl" id="640cname" title='cname' data-type='struct ub_packed_rrset_key **' data-ref="640cname" data-ref-filename="640cname">cname</dfn>)</td></tr>
<tr><th id="2366">2366</th><td>{</td></tr>
<tr><th id="2367">2367</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a> <dfn class="local col1 decl" id="641buf" title='buf' data-type='uint8_t [255]' data-ref="641buf" data-ref-filename="641buf">buf</dfn>[<a class="macro" href="../sldns/rrdef.h.html#29" title="255" data-ref="_M/LDNS_MAX_DOMAINLEN">LDNS_MAX_DOMAINLEN</a>];</td></tr>
<tr><th id="2368">2368</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col2 decl" id="642dtarg" title='dtarg' data-type='uint8_t *' data-ref="642dtarg" data-ref-filename="642dtarg">dtarg</dfn>;</td></tr>
<tr><th id="2369">2369</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col3 decl" id="643dtarglen" title='dtarglen' data-type='size_t' data-ref="643dtarglen" data-ref-filename="643dtarglen">dtarglen</dfn>, <dfn class="local col4 decl" id="644newlen" title='newlen' data-type='size_t' data-ref="644newlen" data-ref-filename="644newlen">newlen</dfn>;</td></tr>
<tr><th id="2370">2370</th><td>	<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>* <dfn class="local col5 decl" id="645d" title='d' data-type='struct packed_rrset_data *' data-ref="645d" data-ref-filename="645d">d</dfn>;</td></tr>
<tr><th id="2371">2371</th><td></td></tr>
<tr><th id="2372">2372</th><td>	<i>/* get DNAME target name */</i></td></tr>
<tr><th id="2373">2373</th><td>	<b>if</b>(<a class="local col8 ref" href="#638dname" title='dname' data-ref="638dname" data-ref-filename="638dname">dname</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a> &lt; <var>1</var>) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="2374">2374</th><td>	<b>if</b>(<a class="local col8 ref" href="#638dname" title='dname' data-ref="638dname" data-ref-filename="638dname">dname</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<var>0</var>] &lt; <var>3</var>) <b>return</b> <var>0</var>; <i>/* at least rdatalen +1 */</i></td></tr>
<tr><th id="2375">2375</th><td>	<a class="local col2 ref" href="#642dtarg" title='dtarg' data-ref="642dtarg" data-ref-filename="642dtarg">dtarg</a> = <a class="local col8 ref" href="#638dname" title='dname' data-ref="638dname" data-ref-filename="638dname">dname</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<var>0</var>]+<var>2</var>;</td></tr>
<tr><th id="2376">2376</th><td>	<a class="local col3 ref" href="#643dtarglen" title='dtarglen' data-ref="643dtarglen" data-ref-filename="643dtarglen">dtarglen</a> = <a class="local col8 ref" href="#638dname" title='dname' data-ref="638dname" data-ref-filename="638dname">dname</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<var>0</var>]-<var>2</var>;</td></tr>
<tr><th id="2377">2377</th><td>	<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_read_uint16" title='sldns_read_uint16' data-ref="sldns_read_uint16" data-ref-filename="sldns_read_uint16">sldns_read_uint16</a>(<a class="local col8 ref" href="#638dname" title='dname' data-ref="638dname" data-ref-filename="638dname">dname</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<var>0</var>]) != <a class="local col3 ref" href="#643dtarglen" title='dtarglen' data-ref="643dtarglen" data-ref-filename="643dtarglen">dtarglen</a>)</td></tr>
<tr><th id="2378">2378</th><td>		<b>return</b> <var>0</var>; <i>/* rdatalen in DNAME rdata is malformed */</i></td></tr>
<tr><th id="2379">2379</th><td>	<b>if</b>(<a class="ref fn" href="../util/data/dname.h.html#dname_valid" title='dname_valid' data-ref="dname_valid" data-ref-filename="dname_valid">dname_valid</a>(<a class="local col2 ref" href="#642dtarg" title='dtarg' data-ref="642dtarg" data-ref-filename="642dtarg">dtarg</a>, <a class="local col3 ref" href="#643dtarglen" title='dtarglen' data-ref="643dtarglen" data-ref-filename="643dtarglen">dtarglen</a>) != <a class="local col3 ref" href="#643dtarglen" title='dtarglen' data-ref="643dtarglen" data-ref-filename="643dtarglen">dtarglen</a>)</td></tr>
<tr><th id="2380">2380</th><td>		<b>return</b> <var>0</var>; <i>/* DNAME RR has malformed rdata */</i></td></tr>
<tr><th id="2381">2381</th><td></td></tr>
<tr><th id="2382">2382</th><td>	<i>/* synthesize a CNAME */</i></td></tr>
<tr><th id="2383">2383</th><td>	<a class="local col4 ref" href="#644newlen" title='newlen' data-ref="644newlen" data-ref-filename="644newlen">newlen</a> = <a class="tu ref fn" href="#synth_cname_buf" title='synth_cname_buf' data-use='c' data-ref="synth_cname_buf" data-ref-filename="synth_cname_buf">synth_cname_buf</a>(<a class="local col4 ref" href="#634qname" title='qname' data-ref="634qname" data-ref-filename="634qname">qname</a>, <a class="local col5 ref" href="#635qname_len" title='qname_len' data-ref="635qname_len" data-ref-filename="635qname_len">qname_len</a>, <a class="local col7 ref" href="#637node" title='node' data-ref="637node" data-ref-filename="637node">node</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::namelen" title='auth_data::namelen' data-ref="auth_data::namelen" data-ref-filename="auth_data..namelen">namelen</a>,</td></tr>
<tr><th id="2384">2384</th><td>		<a class="local col2 ref" href="#642dtarg" title='dtarg' data-ref="642dtarg" data-ref-filename="642dtarg">dtarg</a>, <a class="local col3 ref" href="#643dtarglen" title='dtarglen' data-ref="643dtarglen" data-ref-filename="643dtarglen">dtarglen</a>, <a class="local col1 ref" href="#641buf" title='buf' data-ref="641buf" data-ref-filename="641buf">buf</a>, <b>sizeof</b>(<a class="local col1 ref" href="#641buf" title='buf' data-ref="641buf" data-ref-filename="641buf">buf</a>));</td></tr>
<tr><th id="2385">2385</th><td>	<b>if</b>(<a class="local col4 ref" href="#644newlen" title='newlen' data-ref="644newlen" data-ref-filename="644newlen">newlen</a> == <var>0</var>) {</td></tr>
<tr><th id="2386">2386</th><td>		<i>/* YXDOMAIN error */</i></td></tr>
<tr><th id="2387">2387</th><td>		*<a class="local col0 ref" href="#640cname" title='cname' data-ref="640cname" data-ref-filename="640cname">cname</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="2388">2388</th><td>		<b>return</b> <var>1</var>;</td></tr>
<tr><th id="2389">2389</th><td>	}</td></tr>
<tr><th id="2390">2390</th><td>	*<a class="local col0 ref" href="#640cname" title='cname' data-ref="640cname" data-ref-filename="640cname">cname</a> = (<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key" title='ub_packed_rrset_key' data-ref="ub_packed_rrset_key" data-ref-filename="ub_packed_rrset_key">ub_packed_rrset_key</a>*)<a class="ref fn" href="../util/regional.h.html#regional_alloc" title='regional_alloc' data-ref="regional_alloc" data-ref-filename="regional_alloc">regional_alloc</a>(<a class="local col6 ref" href="#636region" title='region' data-ref="636region" data-ref-filename="636region">region</a>,</td></tr>
<tr><th id="2391">2391</th><td>		<b>sizeof</b>(<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key" title='ub_packed_rrset_key' data-ref="ub_packed_rrset_key" data-ref-filename="ub_packed_rrset_key">ub_packed_rrset_key</a>));</td></tr>
<tr><th id="2392">2392</th><td>	<b>if</b>(!*<a class="local col0 ref" href="#640cname" title='cname' data-ref="640cname" data-ref-filename="640cname">cname</a>)</td></tr>
<tr><th id="2393">2393</th><td>		<b>return</b> <var>0</var>; <i>/* out of memory */</i></td></tr>
<tr><th id="2394">2394</th><td>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#97" title="((__builtin_object_size(&amp;(*cname)-&gt;entry, 0) != (size_t)-1) ? __builtin___memset_chk(&amp;(*cname)-&gt;entry, 0, sizeof((*cname)-&gt;entry), __builtin_object_size(&amp;(*cname)-&gt;entry, 0)) : __memset_ichk(&amp;(*cname)-&gt;entry, 0, sizeof((*cname)-&gt;entry)))" data-ref="_M/memset">memset</a>(&amp;(*<a class="local col0 ref" href="#640cname" title='cname' data-ref="640cname" data-ref-filename="640cname">cname</a>)-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key::entry" title='ub_packed_rrset_key::entry' data-ref="ub_packed_rrset_key::entry" data-ref-filename="ub_packed_rrset_key..entry">entry</a>, <var>0</var>, <b>sizeof</b>((*<a class="local col0 ref" href="#640cname" title='cname' data-ref="640cname" data-ref-filename="640cname">cname</a>)-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key::entry" title='ub_packed_rrset_key::entry' data-ref="ub_packed_rrset_key::entry" data-ref-filename="ub_packed_rrset_key..entry">entry</a>));</td></tr>
<tr><th id="2395">2395</th><td>	(*<a class="local col0 ref" href="#640cname" title='cname' data-ref="640cname" data-ref-filename="640cname">cname</a>)-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key::entry" title='ub_packed_rrset_key::entry' data-ref="ub_packed_rrset_key::entry" data-ref-filename="ub_packed_rrset_key..entry">entry</a>.<a class="ref field" href="../util/storage/lruhash.h.html#lruhash_entry::key" title='lruhash_entry::key' data-ref="lruhash_entry::key" data-ref-filename="lruhash_entry..key">key</a> = (*<a class="local col0 ref" href="#640cname" title='cname' data-ref="640cname" data-ref-filename="640cname">cname</a>);</td></tr>
<tr><th id="2396">2396</th><td>	(*<a class="local col0 ref" href="#640cname" title='cname' data-ref="640cname" data-ref-filename="640cname">cname</a>)-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key::rk" title='ub_packed_rrset_key::rk' data-ref="ub_packed_rrset_key::rk" data-ref-filename="ub_packed_rrset_key..rk">rk</a>.<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_key::type" title='packed_rrset_key::type' data-ref="packed_rrset_key::type" data-ref-filename="packed_rrset_key..type">type</a> = <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/endian.h.html#128" title="((uint16_t)(__builtin_constant_p((((uint16_t)((LDNS_RR_TYPE_CNAME))))) ? (((uint16_t)(((((((uint16_t)((LDNS_RR_TYPE_CNAME)))) &amp; 0xff00) &gt;&gt; 8) | (((((uint16_t)((LDNS_RR_TYPE_CNAME)))) &amp; 0x00ff) &lt;&lt; 8))))) : __byte_swap_u16_variable(((uint16_t)((LDNS_RR_TYPE_CNAME))))))" data-ref="_M/htons">htons</a>(<a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_CNAME" title='LDNS_RR_TYPE_CNAME' data-ref="LDNS_RR_TYPE_CNAME" data-ref-filename="LDNS_RR_TYPE_CNAME">LDNS_RR_TYPE_CNAME</a>);</td></tr>
<tr><th id="2397">2397</th><td>	(*<a class="local col0 ref" href="#640cname" title='cname' data-ref="640cname" data-ref-filename="640cname">cname</a>)-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key::rk" title='ub_packed_rrset_key::rk' data-ref="ub_packed_rrset_key::rk" data-ref-filename="ub_packed_rrset_key..rk">rk</a>.<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_key::rrset_class" title='packed_rrset_key::rrset_class' data-ref="packed_rrset_key::rrset_class" data-ref-filename="packed_rrset_key..rrset_class">rrset_class</a> = <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/endian.h.html#128" title="((uint16_t)(__builtin_constant_p((((uint16_t)((dclass))))) ? (((uint16_t)(((((((uint16_t)((dclass)))) &amp; 0xff00) &gt;&gt; 8) | (((((uint16_t)((dclass)))) &amp; 0x00ff) &lt;&lt; 8))))) : __byte_swap_u16_variable(((uint16_t)((dclass))))))" data-ref="_M/htons">htons</a>(<a class="local col9 ref" href="#639dclass" title='dclass' data-ref="639dclass" data-ref-filename="639dclass">dclass</a>);</td></tr>
<tr><th id="2398">2398</th><td>	(*<a class="local col0 ref" href="#640cname" title='cname' data-ref="640cname" data-ref-filename="640cname">cname</a>)-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key::rk" title='ub_packed_rrset_key::rk' data-ref="ub_packed_rrset_key::rk" data-ref-filename="ub_packed_rrset_key..rk">rk</a>.<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_key::flags" title='packed_rrset_key::flags' data-ref="packed_rrset_key::flags" data-ref-filename="packed_rrset_key..flags">flags</a> = <var>0</var>;</td></tr>
<tr><th id="2399">2399</th><td>	(*<a class="local col0 ref" href="#640cname" title='cname' data-ref="640cname" data-ref-filename="640cname">cname</a>)-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key::rk" title='ub_packed_rrset_key::rk' data-ref="ub_packed_rrset_key::rk" data-ref-filename="ub_packed_rrset_key..rk">rk</a>.<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_key::dname" title='packed_rrset_key::dname' data-ref="packed_rrset_key::dname" data-ref-filename="packed_rrset_key..dname">dname</a> = <a class="ref fn" href="../util/regional.h.html#regional_alloc_init" title='regional_alloc_init' data-ref="regional_alloc_init" data-ref-filename="regional_alloc_init">regional_alloc_init</a>(<a class="local col6 ref" href="#636region" title='region' data-ref="636region" data-ref-filename="636region">region</a>, <a class="local col4 ref" href="#634qname" title='qname' data-ref="634qname" data-ref-filename="634qname">qname</a>, <a class="local col5 ref" href="#635qname_len" title='qname_len' data-ref="635qname_len" data-ref-filename="635qname_len">qname_len</a>);</td></tr>
<tr><th id="2400">2400</th><td>	<b>if</b>(!(*<a class="local col0 ref" href="#640cname" title='cname' data-ref="640cname" data-ref-filename="640cname">cname</a>)-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key::rk" title='ub_packed_rrset_key::rk' data-ref="ub_packed_rrset_key::rk" data-ref-filename="ub_packed_rrset_key..rk">rk</a>.<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_key::dname" title='packed_rrset_key::dname' data-ref="packed_rrset_key::dname" data-ref-filename="packed_rrset_key..dname">dname</a>)</td></tr>
<tr><th id="2401">2401</th><td>		<b>return</b> <var>0</var>; <i>/* out of memory */</i></td></tr>
<tr><th id="2402">2402</th><td>	(*<a class="local col0 ref" href="#640cname" title='cname' data-ref="640cname" data-ref-filename="640cname">cname</a>)-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key::rk" title='ub_packed_rrset_key::rk' data-ref="ub_packed_rrset_key::rk" data-ref-filename="ub_packed_rrset_key..rk">rk</a>.<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_key::dname_len" title='packed_rrset_key::dname_len' data-ref="packed_rrset_key::dname_len" data-ref-filename="packed_rrset_key..dname_len">dname_len</a> = <a class="local col5 ref" href="#635qname_len" title='qname_len' data-ref="635qname_len" data-ref-filename="635qname_len">qname_len</a>;</td></tr>
<tr><th id="2403">2403</th><td>	(*<a class="local col0 ref" href="#640cname" title='cname' data-ref="640cname" data-ref-filename="640cname">cname</a>)-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key::entry" title='ub_packed_rrset_key::entry' data-ref="ub_packed_rrset_key::entry" data-ref-filename="ub_packed_rrset_key..entry">entry</a>.<a class="ref field" href="../util/storage/lruhash.h.html#lruhash_entry::hash" title='lruhash_entry::hash' data-ref="lruhash_entry::hash" data-ref-filename="lruhash_entry..hash">hash</a> = <a class="ref fn" href="../util/data/packed_rrset.h.html#rrset_key_hash" title='rrset_key_hash' data-ref="rrset_key_hash" data-ref-filename="rrset_key_hash">rrset_key_hash</a>(&amp;(*<a class="local col0 ref" href="#640cname" title='cname' data-ref="640cname" data-ref-filename="640cname">cname</a>)-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key::rk" title='ub_packed_rrset_key::rk' data-ref="ub_packed_rrset_key::rk" data-ref-filename="ub_packed_rrset_key..rk">rk</a>);</td></tr>
<tr><th id="2404">2404</th><td>	<a class="local col5 ref" href="#645d" title='d' data-ref="645d" data-ref-filename="645d">d</a> = (<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>*)<a class="ref fn" href="../util/regional.h.html#regional_alloc_zero" title='regional_alloc_zero' data-ref="regional_alloc_zero" data-ref-filename="regional_alloc_zero">regional_alloc_zero</a>(<a class="local col6 ref" href="#636region" title='region' data-ref="636region" data-ref-filename="636region">region</a>,</td></tr>
<tr><th id="2405">2405</th><td>		<b>sizeof</b>(<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>) + <b>sizeof</b>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>) +</td></tr>
<tr><th id="2406">2406</th><td>		<b>sizeof</b>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>*) + <b>sizeof</b>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#time_t" title='time_t' data-type='__int64_t' data-ref="time_t" data-ref-filename="time_t">time_t</a>) + <b>sizeof</b>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a>)</td></tr>
<tr><th id="2407">2407</th><td>		+ <a class="local col4 ref" href="#644newlen" title='newlen' data-ref="644newlen" data-ref-filename="644newlen">newlen</a>);</td></tr>
<tr><th id="2408">2408</th><td>	<b>if</b>(!<a class="local col5 ref" href="#645d" title='d' data-ref="645d" data-ref-filename="645d">d</a>)</td></tr>
<tr><th id="2409">2409</th><td>		<b>return</b> <var>0</var>; <i>/* out of memory */</i></td></tr>
<tr><th id="2410">2410</th><td>	(*<a class="local col0 ref" href="#640cname" title='cname' data-ref="640cname" data-ref-filename="640cname">cname</a>)-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key::entry" title='ub_packed_rrset_key::entry' data-ref="ub_packed_rrset_key::entry" data-ref-filename="ub_packed_rrset_key..entry">entry</a>.<a class="ref field" href="../util/storage/lruhash.h.html#lruhash_entry::data" title='lruhash_entry::data' data-ref="lruhash_entry::data" data-ref-filename="lruhash_entry..data">data</a> = <a class="local col5 ref" href="#645d" title='d' data-ref="645d" data-ref-filename="645d">d</a>;</td></tr>
<tr><th id="2411">2411</th><td>	<a class="local col5 ref" href="#645d" title='d' data-ref="645d" data-ref-filename="645d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::ttl" title='packed_rrset_data::ttl' data-ref="packed_rrset_data::ttl" data-ref-filename="packed_rrset_data..ttl">ttl</a> = <var>0</var>; <i>/* 0 for synthesized CNAME TTL */</i></td></tr>
<tr><th id="2412">2412</th><td>	<a class="local col5 ref" href="#645d" title='d' data-ref="645d" data-ref-filename="645d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a> = <var>1</var>;</td></tr>
<tr><th id="2413">2413</th><td>	<a class="local col5 ref" href="#645d" title='d' data-ref="645d" data-ref-filename="645d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rrsig_count" title='packed_rrset_data::rrsig_count' data-ref="packed_rrset_data::rrsig_count" data-ref-filename="packed_rrset_data..rrsig_count">rrsig_count</a> = <var>0</var>;</td></tr>
<tr><th id="2414">2414</th><td>	<a class="local col5 ref" href="#645d" title='d' data-ref="645d" data-ref-filename="645d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::trust" title='packed_rrset_data::trust' data-ref="packed_rrset_data::trust" data-ref-filename="packed_rrset_data..trust">trust</a> = <a class="enum" href="../util/data/packed_rrset.h.html#rrset_trust_ans_noAA" title='rrset_trust_ans_noAA' data-ref="rrset_trust_ans_noAA" data-ref-filename="rrset_trust_ans_noAA">rrset_trust_ans_noAA</a>;</td></tr>
<tr><th id="2415">2415</th><td>	<a class="local col5 ref" href="#645d" title='d' data-ref="645d" data-ref-filename="645d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a> = (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>*)((<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>*)<a class="local col5 ref" href="#645d" title='d' data-ref="645d" data-ref-filename="645d">d</a> +</td></tr>
<tr><th id="2416">2416</th><td>		<b>sizeof</b>(<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>));</td></tr>
<tr><th id="2417">2417</th><td>	<a class="local col5 ref" href="#645d" title='d' data-ref="645d" data-ref-filename="645d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<var>0</var>] = <a class="local col4 ref" href="#644newlen" title='newlen' data-ref="644newlen" data-ref-filename="644newlen">newlen</a> + <b>sizeof</b>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a>);</td></tr>
<tr><th id="2418">2418</th><td>	<a class="ref fn" href="../util/data/packed_rrset.h.html#packed_rrset_ptr_fixup" title='packed_rrset_ptr_fixup' data-ref="packed_rrset_ptr_fixup" data-ref-filename="packed_rrset_ptr_fixup">packed_rrset_ptr_fixup</a>(<a class="local col5 ref" href="#645d" title='d' data-ref="645d" data-ref-filename="645d">d</a>);</td></tr>
<tr><th id="2419">2419</th><td>	<a class="local col5 ref" href="#645d" title='d' data-ref="645d" data-ref-filename="645d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_ttl" title='packed_rrset_data::rr_ttl' data-ref="packed_rrset_data::rr_ttl" data-ref-filename="packed_rrset_data..rr_ttl">rr_ttl</a>[<var>0</var>] = <a class="local col5 ref" href="#645d" title='d' data-ref="645d" data-ref-filename="645d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::ttl" title='packed_rrset_data::ttl' data-ref="packed_rrset_data::ttl" data-ref-filename="packed_rrset_data..ttl">ttl</a>;</td></tr>
<tr><th id="2420">2420</th><td>	<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_write_uint16" title='sldns_write_uint16' data-ref="sldns_write_uint16" data-ref-filename="sldns_write_uint16">sldns_write_uint16</a>(<a class="local col5 ref" href="#645d" title='d' data-ref="645d" data-ref-filename="645d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<var>0</var>], <a class="local col4 ref" href="#644newlen" title='newlen' data-ref="644newlen" data-ref-filename="644newlen">newlen</a>);</td></tr>
<tr><th id="2421">2421</th><td>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(d-&gt;rr_data[0] + sizeof(uint16_t), 0) != (size_t)-1) ? __builtin___memmove_chk(d-&gt;rr_data[0] + sizeof(uint16_t), buf, newlen, __builtin_object_size(d-&gt;rr_data[0] + sizeof(uint16_t), 0)) : __memmove_ichk(d-&gt;rr_data[0] + sizeof(uint16_t), buf, newlen))" data-ref="_M/memmove">memmove</a>(<a class="local col5 ref" href="#645d" title='d' data-ref="645d" data-ref-filename="645d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<var>0</var>] + <b>sizeof</b>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a>), <a class="local col1 ref" href="#641buf" title='buf' data-ref="641buf" data-ref-filename="641buf">buf</a>, <a class="local col4 ref" href="#644newlen" title='newlen' data-ref="644newlen" data-ref-filename="644newlen">newlen</a>);</td></tr>
<tr><th id="2422">2422</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="2423">2423</th><td>}</td></tr>
<tr><th id="2424">2424</th><td></td></tr>
<tr><th id="2425">2425</th><td><i class="doc" data-doc="add_synth_cname">/** add a synthesized CNAME to the answer section */</i></td></tr>
<tr><th id="2426">2426</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="2427">2427</th><td><dfn class="tu decl def fn" id="add_synth_cname" title='add_synth_cname' data-type='int add_synth_cname(struct auth_zone * z, uint8_t * qname, size_t qname_len, struct regional * region, struct dns_msg * msg, struct auth_data * dname, struct auth_rrset * rrset)' data-ref="add_synth_cname" data-ref-filename="add_synth_cname">add_synth_cname</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col6 decl" id="646z" title='z' data-type='struct auth_zone *' data-ref="646z" data-ref-filename="646z">z</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col7 decl" id="647qname" title='qname' data-type='uint8_t *' data-ref="647qname" data-ref-filename="647qname">qname</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col8 decl" id="648qname_len" title='qname_len' data-type='size_t' data-ref="648qname_len" data-ref-filename="648qname_len">qname_len</dfn>,</td></tr>
<tr><th id="2428">2428</th><td>	<b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col9 decl" id="649region" title='region' data-type='struct regional *' data-ref="649region" data-ref-filename="649region">region</dfn>, <b>struct</b> <a class="type" href="cache/dns.h.html#dns_msg" title='dns_msg' data-ref="dns_msg" data-ref-filename="dns_msg">dns_msg</a>* <dfn class="local col0 decl" id="650msg" title='msg' data-type='struct dns_msg *' data-ref="650msg" data-ref-filename="650msg">msg</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col1 decl" id="651dname" title='dname' data-type='struct auth_data *' data-ref="651dname" data-ref-filename="651dname">dname</dfn>,</td></tr>
<tr><th id="2429">2429</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col2 decl" id="652rrset" title='rrset' data-type='struct auth_rrset *' data-ref="652rrset" data-ref-filename="652rrset">rrset</dfn>)</td></tr>
<tr><th id="2430">2430</th><td>{</td></tr>
<tr><th id="2431">2431</th><td>	<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key" title='ub_packed_rrset_key' data-ref="ub_packed_rrset_key" data-ref-filename="ub_packed_rrset_key">ub_packed_rrset_key</a>* <dfn class="local col3 decl" id="653cname" title='cname' data-type='struct ub_packed_rrset_key *' data-ref="653cname" data-ref-filename="653cname">cname</dfn>;</td></tr>
<tr><th id="2432">2432</th><td>	<i>/* synthesize a CNAME */</i></td></tr>
<tr><th id="2433">2433</th><td>	<b>if</b>(!<a class="tu ref fn" href="#create_synth_cname" title='create_synth_cname' data-use='c' data-ref="create_synth_cname" data-ref-filename="create_synth_cname">create_synth_cname</a>(<a class="local col7 ref" href="#647qname" title='qname' data-ref="647qname" data-ref-filename="647qname">qname</a>, <a class="local col8 ref" href="#648qname_len" title='qname_len' data-ref="648qname_len" data-ref-filename="648qname_len">qname_len</a>, <a class="local col9 ref" href="#649region" title='region' data-ref="649region" data-ref-filename="649region">region</a>, <a class="local col1 ref" href="#651dname" title='dname' data-ref="651dname" data-ref-filename="651dname">dname</a>, <a class="local col2 ref" href="#652rrset" title='rrset' data-ref="652rrset" data-ref-filename="652rrset">rrset</a>,</td></tr>
<tr><th id="2434">2434</th><td>		<a class="local col6 ref" href="#646z" title='z' data-ref="646z" data-ref-filename="646z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::dclass" title='auth_zone::dclass' data-ref="auth_zone::dclass" data-ref-filename="auth_zone..dclass">dclass</a>, &amp;<a class="local col3 ref" href="#653cname" title='cname' data-ref="653cname" data-ref-filename="653cname">cname</a>)) {</td></tr>
<tr><th id="2435">2435</th><td>		<i>/* out of memory */</i></td></tr>
<tr><th id="2436">2436</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2437">2437</th><td>	}</td></tr>
<tr><th id="2438">2438</th><td>	<b>if</b>(!<a class="local col3 ref" href="#653cname" title='cname' data-ref="653cname" data-ref-filename="653cname">cname</a>) {</td></tr>
<tr><th id="2439">2439</th><td>		<i>/* cname cannot be create because of YXDOMAIN */</i></td></tr>
<tr><th id="2440">2440</th><td>		<a class="local col0 ref" href="#650msg" title='msg' data-ref="650msg" data-ref-filename="650msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::flags" title='reply_info::flags' data-ref="reply_info::flags" data-ref-filename="reply_info..flags">flags</a> |= <a class="enum" href="../sldns/pkthdr.h.html#LDNS_RCODE_YXDOMAIN" title='LDNS_RCODE_YXDOMAIN' data-ref="LDNS_RCODE_YXDOMAIN" data-ref-filename="LDNS_RCODE_YXDOMAIN">LDNS_RCODE_YXDOMAIN</a>;</td></tr>
<tr><th id="2441">2441</th><td>		<b>return</b> <var>1</var>;</td></tr>
<tr><th id="2442">2442</th><td>	}</td></tr>
<tr><th id="2443">2443</th><td>	<i>/* add cname to message */</i></td></tr>
<tr><th id="2444">2444</th><td>	<b>if</b>(!<a class="tu ref fn" href="#msg_grow_array" title='msg_grow_array' data-use='c' data-ref="msg_grow_array" data-ref-filename="msg_grow_array">msg_grow_array</a>(<a class="local col9 ref" href="#649region" title='region' data-ref="649region" data-ref-filename="649region">region</a>, <a class="local col0 ref" href="#650msg" title='msg' data-ref="650msg" data-ref-filename="650msg">msg</a>))</td></tr>
<tr><th id="2445">2445</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2446">2446</th><td>	<a class="local col0 ref" href="#650msg" title='msg' data-ref="650msg" data-ref-filename="650msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrsets" title='reply_info::rrsets' data-ref="reply_info::rrsets" data-ref-filename="reply_info..rrsets">rrsets</a>[<a class="local col0 ref" href="#650msg" title='msg' data-ref="650msg" data-ref-filename="650msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrset_count" title='reply_info::rrset_count' data-ref="reply_info::rrset_count" data-ref-filename="reply_info..rrset_count">rrset_count</a>] = <a class="local col3 ref" href="#653cname" title='cname' data-ref="653cname" data-ref-filename="653cname">cname</a>;</td></tr>
<tr><th id="2447">2447</th><td>	<a class="local col0 ref" href="#650msg" title='msg' data-ref="650msg" data-ref-filename="650msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrset_count" title='reply_info::rrset_count' data-ref="reply_info::rrset_count" data-ref-filename="reply_info..rrset_count">rrset_count</a>++;</td></tr>
<tr><th id="2448">2448</th><td>	<a class="local col0 ref" href="#650msg" title='msg' data-ref="650msg" data-ref-filename="650msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::an_numrrsets" title='reply_info::an_numrrsets' data-ref="reply_info::an_numrrsets" data-ref-filename="reply_info..an_numrrsets">an_numrrsets</a>++;</td></tr>
<tr><th id="2449">2449</th><td>	<a class="tu ref fn" href="#msg_ttl" title='msg_ttl' data-use='c' data-ref="msg_ttl" data-ref-filename="msg_ttl">msg_ttl</a>(<a class="local col0 ref" href="#650msg" title='msg' data-ref="650msg" data-ref-filename="650msg">msg</a>);</td></tr>
<tr><th id="2450">2450</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="2451">2451</th><td>}</td></tr>
<tr><th id="2452">2452</th><td></td></tr>
<tr><th id="2453">2453</th><td><i class="doc" data-doc="az_change_dnames">/** Change a dname to a different one, for wildcard namechange */</i></td></tr>
<tr><th id="2454">2454</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="2455">2455</th><td><dfn class="tu decl def fn" id="az_change_dnames" title='az_change_dnames' data-type='void az_change_dnames(struct dns_msg * msg, uint8_t * oldname, uint8_t * newname, size_t newlen, int an_only)' data-ref="az_change_dnames" data-ref-filename="az_change_dnames">az_change_dnames</dfn>(<b>struct</b> <a class="type" href="cache/dns.h.html#dns_msg" title='dns_msg' data-ref="dns_msg" data-ref-filename="dns_msg">dns_msg</a>* <dfn class="local col4 decl" id="654msg" title='msg' data-type='struct dns_msg *' data-ref="654msg" data-ref-filename="654msg">msg</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col5 decl" id="655oldname" title='oldname' data-type='uint8_t *' data-ref="655oldname" data-ref-filename="655oldname">oldname</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col6 decl" id="656newname" title='newname' data-type='uint8_t *' data-ref="656newname" data-ref-filename="656newname">newname</dfn>,</td></tr>
<tr><th id="2456">2456</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col7 decl" id="657newlen" title='newlen' data-type='size_t' data-ref="657newlen" data-ref-filename="657newlen">newlen</dfn>, <em>int</em> <dfn class="local col8 decl" id="658an_only" title='an_only' data-type='int' data-ref="658an_only" data-ref-filename="658an_only">an_only</dfn>)</td></tr>
<tr><th id="2457">2457</th><td>{</td></tr>
<tr><th id="2458">2458</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col9 decl" id="659i" title='i' data-type='size_t' data-ref="659i" data-ref-filename="659i">i</dfn>;</td></tr>
<tr><th id="2459">2459</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col0 decl" id="660start" title='start' data-type='size_t' data-ref="660start" data-ref-filename="660start">start</dfn> = <var>0</var>, <dfn class="local col1 decl" id="661end" title='end' data-type='size_t' data-ref="661end" data-ref-filename="661end">end</dfn> = <a class="local col4 ref" href="#654msg" title='msg' data-ref="654msg" data-ref-filename="654msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrset_count" title='reply_info::rrset_count' data-ref="reply_info::rrset_count" data-ref-filename="reply_info..rrset_count">rrset_count</a>;</td></tr>
<tr><th id="2460">2460</th><td>	<b>if</b>(!<a class="local col8 ref" href="#658an_only" title='an_only' data-ref="658an_only" data-ref-filename="658an_only">an_only</a>) <a class="local col0 ref" href="#660start" title='start' data-ref="660start" data-ref-filename="660start">start</a> = <a class="local col4 ref" href="#654msg" title='msg' data-ref="654msg" data-ref-filename="654msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::an_numrrsets" title='reply_info::an_numrrsets' data-ref="reply_info::an_numrrsets" data-ref-filename="reply_info..an_numrrsets">an_numrrsets</a>;</td></tr>
<tr><th id="2461">2461</th><td>	<b>if</b>(<a class="local col8 ref" href="#658an_only" title='an_only' data-ref="658an_only" data-ref-filename="658an_only">an_only</a>) <a class="local col1 ref" href="#661end" title='end' data-ref="661end" data-ref-filename="661end">end</a> = <a class="local col4 ref" href="#654msg" title='msg' data-ref="654msg" data-ref-filename="654msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::an_numrrsets" title='reply_info::an_numrrsets' data-ref="reply_info::an_numrrsets" data-ref-filename="reply_info..an_numrrsets">an_numrrsets</a>;</td></tr>
<tr><th id="2462">2462</th><td>	<b>for</b>(<a class="local col9 ref" href="#659i" title='i' data-ref="659i" data-ref-filename="659i">i</a>=<a class="local col0 ref" href="#660start" title='start' data-ref="660start" data-ref-filename="660start">start</a>; <a class="local col9 ref" href="#659i" title='i' data-ref="659i" data-ref-filename="659i">i</a>&lt;<a class="local col1 ref" href="#661end" title='end' data-ref="661end" data-ref-filename="661end">end</a>; <a class="local col9 ref" href="#659i" title='i' data-ref="659i" data-ref-filename="659i">i</a>++) {</td></tr>
<tr><th id="2463">2463</th><td>		<i>/* allocated in region so we can change the ptrs */</i></td></tr>
<tr><th id="2464">2464</th><td>		<b>if</b>(<a class="ref fn" href="../util/data/dname.h.html#query_dname_compare" title='query_dname_compare' data-ref="query_dname_compare" data-ref-filename="query_dname_compare">query_dname_compare</a>(<a class="local col4 ref" href="#654msg" title='msg' data-ref="654msg" data-ref-filename="654msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrsets" title='reply_info::rrsets' data-ref="reply_info::rrsets" data-ref-filename="reply_info..rrsets">rrsets</a>[<a class="local col9 ref" href="#659i" title='i' data-ref="659i" data-ref-filename="659i">i</a>]-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key::rk" title='ub_packed_rrset_key::rk' data-ref="ub_packed_rrset_key::rk" data-ref-filename="ub_packed_rrset_key..rk">rk</a>.<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_key::dname" title='packed_rrset_key::dname' data-ref="packed_rrset_key::dname" data-ref-filename="packed_rrset_key..dname">dname</a>, <a class="local col5 ref" href="#655oldname" title='oldname' data-ref="655oldname" data-ref-filename="655oldname">oldname</a>)</td></tr>
<tr><th id="2465">2465</th><td>			== <var>0</var>) {</td></tr>
<tr><th id="2466">2466</th><td>			<a class="local col4 ref" href="#654msg" title='msg' data-ref="654msg" data-ref-filename="654msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrsets" title='reply_info::rrsets' data-ref="reply_info::rrsets" data-ref-filename="reply_info..rrsets">rrsets</a>[<a class="local col9 ref" href="#659i" title='i' data-ref="659i" data-ref-filename="659i">i</a>]-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key::rk" title='ub_packed_rrset_key::rk' data-ref="ub_packed_rrset_key::rk" data-ref-filename="ub_packed_rrset_key..rk">rk</a>.<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_key::dname" title='packed_rrset_key::dname' data-ref="packed_rrset_key::dname" data-ref-filename="packed_rrset_key..dname">dname</a> = <a class="local col6 ref" href="#656newname" title='newname' data-ref="656newname" data-ref-filename="656newname">newname</a>;</td></tr>
<tr><th id="2467">2467</th><td>			<a class="local col4 ref" href="#654msg" title='msg' data-ref="654msg" data-ref-filename="654msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrsets" title='reply_info::rrsets' data-ref="reply_info::rrsets" data-ref-filename="reply_info..rrsets">rrsets</a>[<a class="local col9 ref" href="#659i" title='i' data-ref="659i" data-ref-filename="659i">i</a>]-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key::rk" title='ub_packed_rrset_key::rk' data-ref="ub_packed_rrset_key::rk" data-ref-filename="ub_packed_rrset_key..rk">rk</a>.<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_key::dname_len" title='packed_rrset_key::dname_len' data-ref="packed_rrset_key::dname_len" data-ref-filename="packed_rrset_key..dname_len">dname_len</a> = <a class="local col7 ref" href="#657newlen" title='newlen' data-ref="657newlen" data-ref-filename="657newlen">newlen</a>;</td></tr>
<tr><th id="2468">2468</th><td>		}</td></tr>
<tr><th id="2469">2469</th><td>	}</td></tr>
<tr><th id="2470">2470</th><td>}</td></tr>
<tr><th id="2471">2471</th><td></td></tr>
<tr><th id="2472">2472</th><td><i class="doc" data-doc="az_find_nsec_cover">/** find NSEC record covering the query */</i></td></tr>
<tr><th id="2473">2473</th><td><em>static</em> <b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>*</td></tr>
<tr><th id="2474">2474</th><td><dfn class="tu decl def fn" id="az_find_nsec_cover" title='az_find_nsec_cover' data-type='struct auth_rrset * az_find_nsec_cover(struct auth_zone * z, struct auth_data ** node)' data-ref="az_find_nsec_cover" data-ref-filename="az_find_nsec_cover">az_find_nsec_cover</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col2 decl" id="662z" title='z' data-type='struct auth_zone *' data-ref="662z" data-ref-filename="662z">z</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>** <dfn class="local col3 decl" id="663node" title='node' data-type='struct auth_data **' data-ref="663node" data-ref-filename="663node">node</dfn>)</td></tr>
<tr><th id="2475">2475</th><td>{</td></tr>
<tr><th id="2476">2476</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col4 decl" id="664nm" title='nm' data-type='uint8_t *' data-ref="664nm" data-ref-filename="664nm">nm</dfn> = (*<a class="local col3 ref" href="#663node" title='node' data-ref="663node" data-ref-filename="663node">node</a>)-&gt;<a class="ref field" href="authzone.h.html#auth_data::name" title='auth_data::name' data-ref="auth_data::name" data-ref-filename="auth_data..name">name</a>;</td></tr>
<tr><th id="2477">2477</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col5 decl" id="665nmlen" title='nmlen' data-type='size_t' data-ref="665nmlen" data-ref-filename="665nmlen">nmlen</dfn> = (*<a class="local col3 ref" href="#663node" title='node' data-ref="663node" data-ref-filename="663node">node</a>)-&gt;<a class="ref field" href="authzone.h.html#auth_data::namelen" title='auth_data::namelen' data-ref="auth_data::namelen" data-ref-filename="auth_data..namelen">namelen</a>;</td></tr>
<tr><th id="2478">2478</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col6 decl" id="666rrset" title='rrset' data-type='struct auth_rrset *' data-ref="666rrset" data-ref-filename="666rrset">rrset</dfn>;</td></tr>
<tr><th id="2479">2479</th><td>	<i>/* find the NSEC for the smallest-or-equal node */</i></td></tr>
<tr><th id="2480">2480</th><td>	<i>/* if node == NULL, we did not find a smaller name.  But the zone</i></td></tr>
<tr><th id="2481">2481</th><td><i>	 * name is the smallest name and should have an NSEC. So there is</i></td></tr>
<tr><th id="2482">2482</th><td><i>	 * no NSEC to return (for a properly signed zone) */</i></td></tr>
<tr><th id="2483">2483</th><td>	<i>/* for empty nonterminals, the auth-data node should not exist,</i></td></tr>
<tr><th id="2484">2484</th><td><i>	 * and thus we don't need to go rbtree_previous here to find</i></td></tr>
<tr><th id="2485">2485</th><td><i>	 * a domain with an NSEC record */</i></td></tr>
<tr><th id="2486">2486</th><td>	<i>/* but there could be glue, and if this is node, then it has no NSEC.</i></td></tr>
<tr><th id="2487">2487</th><td><i>	 * Go up to find nonglue (previous) NSEC-holding nodes */</i></td></tr>
<tr><th id="2488">2488</th><td>	<b>while</b>((<a class="local col6 ref" href="#666rrset" title='rrset' data-ref="666rrset" data-ref-filename="666rrset">rrset</a>=<a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(*<a class="local col3 ref" href="#663node" title='node' data-ref="663node" data-ref-filename="663node">node</a>, <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_NSEC" title='LDNS_RR_TYPE_NSEC' data-ref="LDNS_RR_TYPE_NSEC" data-ref-filename="LDNS_RR_TYPE_NSEC">LDNS_RR_TYPE_NSEC</a>)) == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="2489">2489</th><td>		<b>if</b>(<a class="ref fn" href="../util/data/dname.h.html#dname_is_root" title='dname_is_root' data-ref="dname_is_root" data-ref-filename="dname_is_root">dname_is_root</a>(<a class="local col4 ref" href="#664nm" title='nm' data-ref="664nm" data-ref-filename="664nm">nm</a>)) <b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="2490">2490</th><td>		<b>if</b>(<a class="local col5 ref" href="#665nmlen" title='nmlen' data-ref="665nmlen" data-ref-filename="665nmlen">nmlen</a> == <a class="local col2 ref" href="#662z" title='z' data-ref="662z" data-ref-filename="662z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::namelen" title='auth_zone::namelen' data-ref="auth_zone::namelen" data-ref-filename="auth_zone..namelen">namelen</a>) <b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="2491">2491</th><td>		<a class="ref fn" href="../util/data/dname.h.html#dname_remove_label" title='dname_remove_label' data-ref="dname_remove_label" data-ref-filename="dname_remove_label">dname_remove_label</a>(&amp;<a class="local col4 ref" href="#664nm" title='nm' data-ref="664nm" data-ref-filename="664nm">nm</a>, &amp;<a class="local col5 ref" href="#665nmlen" title='nmlen' data-ref="665nmlen" data-ref-filename="665nmlen">nmlen</a>);</td></tr>
<tr><th id="2492">2492</th><td>		<i>/* adjust *node for the nsec rrset to find in */</i></td></tr>
<tr><th id="2493">2493</th><td>		*<a class="local col3 ref" href="#663node" title='node' data-ref="663node" data-ref-filename="663node">node</a> = <a class="tu ref fn" href="#az_find_name" title='az_find_name' data-use='c' data-ref="az_find_name" data-ref-filename="az_find_name">az_find_name</a>(<a class="local col2 ref" href="#662z" title='z' data-ref="662z" data-ref-filename="662z">z</a>, <a class="local col4 ref" href="#664nm" title='nm' data-ref="664nm" data-ref-filename="664nm">nm</a>, <a class="local col5 ref" href="#665nmlen" title='nmlen' data-ref="665nmlen" data-ref-filename="665nmlen">nmlen</a>);</td></tr>
<tr><th id="2494">2494</th><td>	}</td></tr>
<tr><th id="2495">2495</th><td>	<b>return</b> <a class="local col6 ref" href="#666rrset" title='rrset' data-ref="666rrset" data-ref-filename="666rrset">rrset</a>;</td></tr>
<tr><th id="2496">2496</th><td>}</td></tr>
<tr><th id="2497">2497</th><td></td></tr>
<tr><th id="2498">2498</th><td><i class="doc" data-doc="az_nsec_wildcard_denial">/** Find NSEC and add for wildcard denial */</i></td></tr>
<tr><th id="2499">2499</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="2500">2500</th><td><dfn class="tu decl def fn" id="az_nsec_wildcard_denial" title='az_nsec_wildcard_denial' data-type='int az_nsec_wildcard_denial(struct auth_zone * z, struct regional * region, struct dns_msg * msg, uint8_t * cenm, size_t cenmlen)' data-ref="az_nsec_wildcard_denial" data-ref-filename="az_nsec_wildcard_denial">az_nsec_wildcard_denial</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col7 decl" id="667z" title='z' data-type='struct auth_zone *' data-ref="667z" data-ref-filename="667z">z</dfn>, <b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col8 decl" id="668region" title='region' data-type='struct regional *' data-ref="668region" data-ref-filename="668region">region</dfn>,</td></tr>
<tr><th id="2501">2501</th><td>	<b>struct</b> <a class="type" href="cache/dns.h.html#dns_msg" title='dns_msg' data-ref="dns_msg" data-ref-filename="dns_msg">dns_msg</a>* <dfn class="local col9 decl" id="669msg" title='msg' data-type='struct dns_msg *' data-ref="669msg" data-ref-filename="669msg">msg</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col0 decl" id="670cenm" title='cenm' data-type='uint8_t *' data-ref="670cenm" data-ref-filename="670cenm">cenm</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col1 decl" id="671cenmlen" title='cenmlen' data-type='size_t' data-ref="671cenmlen" data-ref-filename="671cenmlen">cenmlen</dfn>)</td></tr>
<tr><th id="2502">2502</th><td>{</td></tr>
<tr><th id="2503">2503</th><td>	<b>struct</b> <a class="type" href="../util/data/msgreply.h.html#query_info" title='query_info' data-ref="query_info" data-ref-filename="query_info">query_info</a> <dfn class="local col2 decl" id="672qinfo" title='qinfo' data-type='struct query_info' data-ref="672qinfo" data-ref-filename="672qinfo">qinfo</dfn>;</td></tr>
<tr><th id="2504">2504</th><td>	<em>int</em> <dfn class="local col3 decl" id="673node_exact" title='node_exact' data-type='int' data-ref="673node_exact" data-ref-filename="673node_exact">node_exact</dfn>;</td></tr>
<tr><th id="2505">2505</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col4 decl" id="674node" title='node' data-type='struct auth_data *' data-ref="674node" data-ref-filename="674node">node</dfn>;</td></tr>
<tr><th id="2506">2506</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col5 decl" id="675nsec" title='nsec' data-type='struct auth_rrset *' data-ref="675nsec" data-ref-filename="675nsec">nsec</dfn>;</td></tr>
<tr><th id="2507">2507</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a> <dfn class="local col6 decl" id="676wc" title='wc' data-type='uint8_t [255]' data-ref="676wc" data-ref-filename="676wc">wc</dfn>[<a class="macro" href="../sldns/rrdef.h.html#29" title="255" data-ref="_M/LDNS_MAX_DOMAINLEN">LDNS_MAX_DOMAINLEN</a>];</td></tr>
<tr><th id="2508">2508</th><td>	<b>if</b>(<a class="local col1 ref" href="#671cenmlen" title='cenmlen' data-ref="671cenmlen" data-ref-filename="671cenmlen">cenmlen</a>+<var>2</var> &gt; <b>sizeof</b>(<a class="local col6 ref" href="#676wc" title='wc' data-ref="676wc" data-ref-filename="676wc">wc</a>))</td></tr>
<tr><th id="2509">2509</th><td>		<b>return</b> <var>0</var>; <i>/* result would be too long */</i></td></tr>
<tr><th id="2510">2510</th><td>	<a class="local col6 ref" href="#676wc" title='wc' data-ref="676wc" data-ref-filename="676wc">wc</a>[<var>0</var>] = <var>1</var>; <i>/* length of wildcard label */</i></td></tr>
<tr><th id="2511">2511</th><td>	<a class="local col6 ref" href="#676wc" title='wc' data-ref="676wc" data-ref-filename="676wc">wc</a>[<var>1</var>] = (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>)<kbd>'*'</kbd>; <i>/* wildcard label */</i></td></tr>
<tr><th id="2512">2512</th><td>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(wc+2, 0) != (size_t)-1) ? __builtin___memmove_chk(wc+2, cenm, cenmlen, __builtin_object_size(wc+2, 0)) : __memmove_ichk(wc+2, cenm, cenmlen))" data-ref="_M/memmove">memmove</a>(<a class="local col6 ref" href="#676wc" title='wc' data-ref="676wc" data-ref-filename="676wc">wc</a>+<var>2</var>, <a class="local col0 ref" href="#670cenm" title='cenm' data-ref="670cenm" data-ref-filename="670cenm">cenm</a>, <a class="local col1 ref" href="#671cenmlen" title='cenmlen' data-ref="671cenmlen" data-ref-filename="671cenmlen">cenmlen</a>);</td></tr>
<tr><th id="2513">2513</th><td></td></tr>
<tr><th id="2514">2514</th><td>	<i>/* we have '*.ce' in wc wildcard name buffer */</i></td></tr>
<tr><th id="2515">2515</th><td>	<i>/* get nsec cover for that */</i></td></tr>
<tr><th id="2516">2516</th><td>	<a class="local col2 ref" href="#672qinfo" title='qinfo' data-ref="672qinfo" data-ref-filename="672qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname" title='query_info::qname' data-ref="query_info::qname" data-ref-filename="query_info..qname">qname</a> = <a class="local col6 ref" href="#676wc" title='wc' data-ref="676wc" data-ref-filename="676wc">wc</a>;</td></tr>
<tr><th id="2517">2517</th><td>	<a class="local col2 ref" href="#672qinfo" title='qinfo' data-ref="672qinfo" data-ref-filename="672qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname_len" title='query_info::qname_len' data-ref="query_info::qname_len" data-ref-filename="query_info..qname_len">qname_len</a> = <a class="local col1 ref" href="#671cenmlen" title='cenmlen' data-ref="671cenmlen" data-ref-filename="671cenmlen">cenmlen</a>+<var>2</var>;</td></tr>
<tr><th id="2518">2518</th><td>	<a class="local col2 ref" href="#672qinfo" title='qinfo' data-ref="672qinfo" data-ref-filename="672qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qtype" title='query_info::qtype' data-ref="query_info::qtype" data-ref-filename="query_info..qtype">qtype</a> = <var>0</var>;</td></tr>
<tr><th id="2519">2519</th><td>	<a class="local col2 ref" href="#672qinfo" title='qinfo' data-ref="672qinfo" data-ref-filename="672qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qclass" title='query_info::qclass' data-ref="query_info::qclass" data-ref-filename="query_info..qclass">qclass</a> = <var>0</var>;</td></tr>
<tr><th id="2520">2520</th><td>	<a class="tu ref fn" href="#az_find_domain" title='az_find_domain' data-use='c' data-ref="az_find_domain" data-ref-filename="az_find_domain">az_find_domain</a>(<a class="local col7 ref" href="#667z" title='z' data-ref="667z" data-ref-filename="667z">z</a>, &amp;<a class="local col2 ref" href="#672qinfo" title='qinfo' data-ref="672qinfo" data-ref-filename="672qinfo">qinfo</a>, &amp;<a class="local col3 ref" href="#673node_exact" title='node_exact' data-ref="673node_exact" data-ref-filename="673node_exact">node_exact</a>, &amp;<a class="local col4 ref" href="#674node" title='node' data-ref="674node" data-ref-filename="674node">node</a>);</td></tr>
<tr><th id="2521">2521</th><td>	<b>if</b>((<a class="local col5 ref" href="#675nsec" title='nsec' data-ref="675nsec" data-ref-filename="675nsec">nsec</a>=<a class="tu ref fn" href="#az_find_nsec_cover" title='az_find_nsec_cover' data-use='c' data-ref="az_find_nsec_cover" data-ref-filename="az_find_nsec_cover">az_find_nsec_cover</a>(<a class="local col7 ref" href="#667z" title='z' data-ref="667z" data-ref-filename="667z">z</a>, &amp;<a class="local col4 ref" href="#674node" title='node' data-ref="674node" data-ref-filename="674node">node</a>)) != <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="2522">2522</th><td>		<b>if</b>(!<a class="tu ref fn" href="#msg_add_rrset_ns" title='msg_add_rrset_ns' data-use='c' data-ref="msg_add_rrset_ns" data-ref-filename="msg_add_rrset_ns">msg_add_rrset_ns</a>(<a class="local col7 ref" href="#667z" title='z' data-ref="667z" data-ref-filename="667z">z</a>, <a class="local col8 ref" href="#668region" title='region' data-ref="668region" data-ref-filename="668region">region</a>, <a class="local col9 ref" href="#669msg" title='msg' data-ref="669msg" data-ref-filename="669msg">msg</a>, <a class="local col4 ref" href="#674node" title='node' data-ref="674node" data-ref-filename="674node">node</a>, <a class="local col5 ref" href="#675nsec" title='nsec' data-ref="675nsec" data-ref-filename="675nsec">nsec</a>)) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="2523">2523</th><td>	}</td></tr>
<tr><th id="2524">2524</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="2525">2525</th><td>}</td></tr>
<tr><th id="2526">2526</th><td></td></tr>
<tr><th id="2527">2527</th><td><i class="doc" data-doc="az_nsec3_param">/** Find the NSEC3PARAM rrset (if any) and if true you have the parameters */</i></td></tr>
<tr><th id="2528">2528</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="2529">2529</th><td><dfn class="tu decl def fn" id="az_nsec3_param" title='az_nsec3_param' data-type='int az_nsec3_param(struct auth_zone * z, int * algo, size_t * iter, uint8_t ** salt, size_t * saltlen)' data-ref="az_nsec3_param" data-ref-filename="az_nsec3_param">az_nsec3_param</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col7 decl" id="677z" title='z' data-type='struct auth_zone *' data-ref="677z" data-ref-filename="677z">z</dfn>, <em>int</em>* <dfn class="local col8 decl" id="678algo" title='algo' data-type='int *' data-ref="678algo" data-ref-filename="678algo">algo</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>* <dfn class="local col9 decl" id="679iter" title='iter' data-type='size_t *' data-ref="679iter" data-ref-filename="679iter">iter</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>** <dfn class="local col0 decl" id="680salt" title='salt' data-type='uint8_t **' data-ref="680salt" data-ref-filename="680salt">salt</dfn>,</td></tr>
<tr><th id="2530">2530</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>* <dfn class="local col1 decl" id="681saltlen" title='saltlen' data-type='size_t *' data-ref="681saltlen" data-ref-filename="681saltlen">saltlen</dfn>)</td></tr>
<tr><th id="2531">2531</th><td>{</td></tr>
<tr><th id="2532">2532</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col2 decl" id="682apex" title='apex' data-type='struct auth_data *' data-ref="682apex" data-ref-filename="682apex">apex</dfn>;</td></tr>
<tr><th id="2533">2533</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col3 decl" id="683param" title='param' data-type='struct auth_rrset *' data-ref="683param" data-ref-filename="683param">param</dfn>;</td></tr>
<tr><th id="2534">2534</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col4 decl" id="684i" title='i' data-type='size_t' data-ref="684i" data-ref-filename="684i">i</dfn>;</td></tr>
<tr><th id="2535">2535</th><td>	<a class="local col2 ref" href="#682apex" title='apex' data-ref="682apex" data-ref-filename="682apex">apex</a> = <a class="tu ref fn" href="#az_find_name" title='az_find_name' data-use='c' data-ref="az_find_name" data-ref-filename="az_find_name">az_find_name</a>(<a class="local col7 ref" href="#677z" title='z' data-ref="677z" data-ref-filename="677z">z</a>, <a class="local col7 ref" href="#677z" title='z' data-ref="677z" data-ref-filename="677z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::name" title='auth_zone::name' data-ref="auth_zone::name" data-ref-filename="auth_zone..name">name</a>, <a class="local col7 ref" href="#677z" title='z' data-ref="677z" data-ref-filename="677z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::namelen" title='auth_zone::namelen' data-ref="auth_zone::namelen" data-ref-filename="auth_zone..namelen">namelen</a>);</td></tr>
<tr><th id="2536">2536</th><td>	<b>if</b>(!<a class="local col2 ref" href="#682apex" title='apex' data-ref="682apex" data-ref-filename="682apex">apex</a>) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="2537">2537</th><td>	<a class="local col3 ref" href="#683param" title='param' data-ref="683param" data-ref-filename="683param">param</a> = <a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(<a class="local col2 ref" href="#682apex" title='apex' data-ref="682apex" data-ref-filename="682apex">apex</a>, <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_NSEC3PARAM" title='LDNS_RR_TYPE_NSEC3PARAM' data-ref="LDNS_RR_TYPE_NSEC3PARAM" data-ref-filename="LDNS_RR_TYPE_NSEC3PARAM">LDNS_RR_TYPE_NSEC3PARAM</a>);</td></tr>
<tr><th id="2538">2538</th><td>	<b>if</b>(!<a class="local col3 ref" href="#683param" title='param' data-ref="683param" data-ref-filename="683param">param</a> || <a class="local col3 ref" href="#683param" title='param' data-ref="683param" data-ref-filename="683param">param</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>==<var>0</var>)</td></tr>
<tr><th id="2539">2539</th><td>		<b>return</b> <var>0</var>; <i>/* no RRset or no RRs in rrset */</i></td></tr>
<tr><th id="2540">2540</th><td>	<i>/* find out which NSEC3PARAM RR has supported parameters */</i></td></tr>
<tr><th id="2541">2541</th><td>	<i>/* skip unknown flags (dynamic signer is recalculating nsec3 chain) */</i></td></tr>
<tr><th id="2542">2542</th><td>	<b>for</b>(<a class="local col4 ref" href="#684i" title='i' data-ref="684i" data-ref-filename="684i">i</a>=<var>0</var>; <a class="local col4 ref" href="#684i" title='i' data-ref="684i" data-ref-filename="684i">i</a>&lt;<a class="local col3 ref" href="#683param" title='param' data-ref="683param" data-ref-filename="683param">param</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>; <a class="local col4 ref" href="#684i" title='i' data-ref="684i" data-ref-filename="684i">i</a>++) {</td></tr>
<tr><th id="2543">2543</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col5 decl" id="685rdata" title='rdata' data-type='uint8_t *' data-ref="685rdata" data-ref-filename="685rdata">rdata</dfn> = <a class="local col3 ref" href="#683param" title='param' data-ref="683param" data-ref-filename="683param">param</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<a class="local col4 ref" href="#684i" title='i' data-ref="684i" data-ref-filename="684i">i</a>]+<var>2</var>;</td></tr>
<tr><th id="2544">2544</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col6 decl" id="686rdatalen" title='rdatalen' data-type='size_t' data-ref="686rdatalen" data-ref-filename="686rdatalen">rdatalen</dfn> = <a class="local col3 ref" href="#683param" title='param' data-ref="683param" data-ref-filename="683param">param</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<a class="local col4 ref" href="#684i" title='i' data-ref="684i" data-ref-filename="684i">i</a>];</td></tr>
<tr><th id="2545">2545</th><td>		<b>if</b>(<a class="local col6 ref" href="#686rdatalen" title='rdatalen' data-ref="686rdatalen" data-ref-filename="686rdatalen">rdatalen</a> &lt; <var>2</var>+<var>5</var>)</td></tr>
<tr><th id="2546">2546</th><td>			<b>continue</b>; <i>/* too short */</i></td></tr>
<tr><th id="2547">2547</th><td>		<b>if</b>(!<a class="ref fn" href="../validator/val_secalgo.h.html#nsec3_hash_algo_size_supported" title='nsec3_hash_algo_size_supported' data-ref="nsec3_hash_algo_size_supported" data-ref-filename="nsec3_hash_algo_size_supported">nsec3_hash_algo_size_supported</a>((<em>int</em>)(<a class="local col5 ref" href="#685rdata" title='rdata' data-ref="685rdata" data-ref-filename="685rdata">rdata</a>[<var>0</var>])))</td></tr>
<tr><th id="2548">2548</th><td>			<b>continue</b>; <i>/* unsupported algo */</i></td></tr>
<tr><th id="2549">2549</th><td>		<b>if</b>(<a class="local col6 ref" href="#686rdatalen" title='rdatalen' data-ref="686rdatalen" data-ref-filename="686rdatalen">rdatalen</a> &lt; (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>)(<var>2</var>+<var>5</var>+(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>)<a class="local col5 ref" href="#685rdata" title='rdata' data-ref="685rdata" data-ref-filename="685rdata">rdata</a>[<var>4</var>]))</td></tr>
<tr><th id="2550">2550</th><td>			<b>continue</b>; <i>/* salt missing */</i></td></tr>
<tr><th id="2551">2551</th><td>		<b>if</b>((<a class="local col5 ref" href="#685rdata" title='rdata' data-ref="685rdata" data-ref-filename="685rdata">rdata</a>[<var>1</var>]&amp;<a class="macro" href="../validator/val_nsec3.h.html#95" title="0xFE" data-ref="_M/NSEC3_UNKNOWN_FLAGS">NSEC3_UNKNOWN_FLAGS</a>)!=<var>0</var>)</td></tr>
<tr><th id="2552">2552</th><td>			<b>continue</b>; <i>/* unknown flags */</i></td></tr>
<tr><th id="2553">2553</th><td>		*<a class="local col8 ref" href="#678algo" title='algo' data-ref="678algo" data-ref-filename="678algo">algo</a> = (<em>int</em>)(<a class="local col5 ref" href="#685rdata" title='rdata' data-ref="685rdata" data-ref-filename="685rdata">rdata</a>[<var>0</var>]);</td></tr>
<tr><th id="2554">2554</th><td>		*<a class="local col9 ref" href="#679iter" title='iter' data-ref="679iter" data-ref-filename="679iter">iter</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_read_uint16" title='sldns_read_uint16' data-ref="sldns_read_uint16" data-ref-filename="sldns_read_uint16">sldns_read_uint16</a>(<a class="local col5 ref" href="#685rdata" title='rdata' data-ref="685rdata" data-ref-filename="685rdata">rdata</a>+<var>2</var>);</td></tr>
<tr><th id="2555">2555</th><td>		*<a class="local col1 ref" href="#681saltlen" title='saltlen' data-ref="681saltlen" data-ref-filename="681saltlen">saltlen</a> = <a class="local col5 ref" href="#685rdata" title='rdata' data-ref="685rdata" data-ref-filename="685rdata">rdata</a>[<var>4</var>];</td></tr>
<tr><th id="2556">2556</th><td>		<b>if</b>(*<a class="local col1 ref" href="#681saltlen" title='saltlen' data-ref="681saltlen" data-ref-filename="681saltlen">saltlen</a> == <var>0</var>)</td></tr>
<tr><th id="2557">2557</th><td>			*<a class="local col0 ref" href="#680salt" title='salt' data-ref="680salt" data-ref-filename="680salt">salt</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="2558">2558</th><td>		<b>else</b>	*<a class="local col0 ref" href="#680salt" title='salt' data-ref="680salt" data-ref-filename="680salt">salt</a> = <a class="local col5 ref" href="#685rdata" title='rdata' data-ref="685rdata" data-ref-filename="685rdata">rdata</a>+<var>5</var>;</td></tr>
<tr><th id="2559">2559</th><td>		<b>return</b> <var>1</var>;</td></tr>
<tr><th id="2560">2560</th><td>	}</td></tr>
<tr><th id="2561">2561</th><td>	<i>/* no supported params */</i></td></tr>
<tr><th id="2562">2562</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2563">2563</th><td>}</td></tr>
<tr><th id="2564">2564</th><td></td></tr>
<tr><th id="2565">2565</th><td><i class="doc" data-doc="az_nsec3_hash">/** Hash a name with nsec3param into buffer, it has zone name appended.</i></td></tr>
<tr><th id="2566">2566</th><td><i class="doc" data-doc="az_nsec3_hash"> * return length of hash */</i></td></tr>
<tr><th id="2567">2567</th><td><em>static</em> <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a></td></tr>
<tr><th id="2568">2568</th><td><dfn class="tu decl def fn" id="az_nsec3_hash" title='az_nsec3_hash' data-type='size_t az_nsec3_hash(uint8_t * buf, size_t buflen, uint8_t * nm, size_t nmlen, int algo, size_t iter, uint8_t * salt, size_t saltlen)' data-ref="az_nsec3_hash" data-ref-filename="az_nsec3_hash">az_nsec3_hash</dfn>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col7 decl" id="687buf" title='buf' data-type='uint8_t *' data-ref="687buf" data-ref-filename="687buf">buf</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col8 decl" id="688buflen" title='buflen' data-type='size_t' data-ref="688buflen" data-ref-filename="688buflen">buflen</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col9 decl" id="689nm" title='nm' data-type='uint8_t *' data-ref="689nm" data-ref-filename="689nm">nm</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col0 decl" id="690nmlen" title='nmlen' data-type='size_t' data-ref="690nmlen" data-ref-filename="690nmlen">nmlen</dfn>,</td></tr>
<tr><th id="2569">2569</th><td>	<em>int</em> <dfn class="local col1 decl" id="691algo" title='algo' data-type='int' data-ref="691algo" data-ref-filename="691algo">algo</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col2 decl" id="692iter" title='iter' data-type='size_t' data-ref="692iter" data-ref-filename="692iter">iter</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col3 decl" id="693salt" title='salt' data-type='uint8_t *' data-ref="693salt" data-ref-filename="693salt">salt</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col4 decl" id="694saltlen" title='saltlen' data-type='size_t' data-ref="694saltlen" data-ref-filename="694saltlen">saltlen</dfn>)</td></tr>
<tr><th id="2570">2570</th><td>{</td></tr>
<tr><th id="2571">2571</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col5 decl" id="695hlen" title='hlen' data-type='size_t' data-ref="695hlen" data-ref-filename="695hlen">hlen</dfn> = <a class="ref fn" href="../validator/val_secalgo.h.html#nsec3_hash_algo_size_supported" title='nsec3_hash_algo_size_supported' data-ref="nsec3_hash_algo_size_supported" data-ref-filename="nsec3_hash_algo_size_supported">nsec3_hash_algo_size_supported</a>(<a class="local col1 ref" href="#691algo" title='algo' data-ref="691algo" data-ref-filename="691algo">algo</a>);</td></tr>
<tr><th id="2572">2572</th><td>	<i>/* buffer has domain name, nsec3hash, and 256 is for max saltlen</i></td></tr>
<tr><th id="2573">2573</th><td><i>	 * (salt has 0-255 length) */</i></td></tr>
<tr><th id="2574">2574</th><td>	<em>unsigned</em> <em>char</em> <dfn class="local col6 decl" id="696p" title='p' data-type='unsigned char [544]' data-ref="696p" data-ref-filename="696p">p</dfn>[<a class="macro" href="../sldns/rrdef.h.html#29" title="255" data-ref="_M/LDNS_MAX_DOMAINLEN">LDNS_MAX_DOMAINLEN</a>+<var>1</var>+<a class="macro" href="#74" title="32" data-ref="_M/N3HASHBUFLEN">N3HASHBUFLEN</a>+<var>256</var>];</td></tr>
<tr><th id="2575">2575</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col7 decl" id="697i" title='i' data-type='size_t' data-ref="697i" data-ref-filename="697i">i</dfn>;</td></tr>
<tr><th id="2576">2576</th><td>	<b>if</b>(<a class="local col0 ref" href="#690nmlen" title='nmlen' data-ref="690nmlen" data-ref-filename="690nmlen">nmlen</a>+<a class="local col4 ref" href="#694saltlen" title='saltlen' data-ref="694saltlen" data-ref-filename="694saltlen">saltlen</a> &gt; <b>sizeof</b>(<a class="local col6 ref" href="#696p" title='p' data-ref="696p" data-ref-filename="696p">p</a>) || <a class="local col5 ref" href="#695hlen" title='hlen' data-ref="695hlen" data-ref-filename="695hlen">hlen</a>+<a class="local col4 ref" href="#694saltlen" title='saltlen' data-ref="694saltlen" data-ref-filename="694saltlen">saltlen</a> &gt; <b>sizeof</b>(<a class="local col6 ref" href="#696p" title='p' data-ref="696p" data-ref-filename="696p">p</a>))</td></tr>
<tr><th id="2577">2577</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2578">2578</th><td>	<b>if</b>(<a class="local col5 ref" href="#695hlen" title='hlen' data-ref="695hlen" data-ref-filename="695hlen">hlen</a> &gt; <a class="local col8 ref" href="#688buflen" title='buflen' data-ref="688buflen" data-ref-filename="688buflen">buflen</a>)</td></tr>
<tr><th id="2579">2579</th><td>		<b>return</b> <var>0</var>; <i>/* somehow too large for destination buffer */</i></td></tr>
<tr><th id="2580">2580</th><td>	<i>/* hashfunc(name, salt) */</i></td></tr>
<tr><th id="2581">2581</th><td>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(p, 0) != (size_t)-1) ? __builtin___memmove_chk(p, nm, nmlen, __builtin_object_size(p, 0)) : __memmove_ichk(p, nm, nmlen))" data-ref="_M/memmove">memmove</a>(<a class="local col6 ref" href="#696p" title='p' data-ref="696p" data-ref-filename="696p">p</a>, <a class="local col9 ref" href="#689nm" title='nm' data-ref="689nm" data-ref-filename="689nm">nm</a>, <a class="local col0 ref" href="#690nmlen" title='nmlen' data-ref="690nmlen" data-ref-filename="690nmlen">nmlen</a>);</td></tr>
<tr><th id="2582">2582</th><td>	<a class="ref fn" href="../util/data/dname.h.html#query_dname_tolower" title='query_dname_tolower' data-ref="query_dname_tolower" data-ref-filename="query_dname_tolower">query_dname_tolower</a>(<a class="local col6 ref" href="#696p" title='p' data-ref="696p" data-ref-filename="696p">p</a>);</td></tr>
<tr><th id="2583">2583</th><td>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(p+nmlen, 0) != (size_t)-1) ? __builtin___memmove_chk(p+nmlen, salt, saltlen, __builtin_object_size(p+nmlen, 0)) : __memmove_ichk(p+nmlen, salt, saltlen))" data-ref="_M/memmove">memmove</a>(<a class="local col6 ref" href="#696p" title='p' data-ref="696p" data-ref-filename="696p">p</a>+<a class="local col0 ref" href="#690nmlen" title='nmlen' data-ref="690nmlen" data-ref-filename="690nmlen">nmlen</a>, <a class="local col3 ref" href="#693salt" title='salt' data-ref="693salt" data-ref-filename="693salt">salt</a>, <a class="local col4 ref" href="#694saltlen" title='saltlen' data-ref="694saltlen" data-ref-filename="694saltlen">saltlen</a>);</td></tr>
<tr><th id="2584">2584</th><td>	(<em>void</em>)<a class="ref fn" href="../validator/val_secalgo.h.html#secalgo_nsec3_hash" title='secalgo_nsec3_hash' data-ref="secalgo_nsec3_hash" data-ref-filename="secalgo_nsec3_hash">secalgo_nsec3_hash</a>(<a class="local col1 ref" href="#691algo" title='algo' data-ref="691algo" data-ref-filename="691algo">algo</a>, <a class="local col6 ref" href="#696p" title='p' data-ref="696p" data-ref-filename="696p">p</a>, <a class="local col0 ref" href="#690nmlen" title='nmlen' data-ref="690nmlen" data-ref-filename="690nmlen">nmlen</a>+<a class="local col4 ref" href="#694saltlen" title='saltlen' data-ref="694saltlen" data-ref-filename="694saltlen">saltlen</a>, (<em>unsigned</em> <em>char</em>*)<a class="local col7 ref" href="#687buf" title='buf' data-ref="687buf" data-ref-filename="687buf">buf</a>);</td></tr>
<tr><th id="2585">2585</th><td>	<b>for</b>(<a class="local col7 ref" href="#697i" title='i' data-ref="697i" data-ref-filename="697i">i</a>=<var>0</var>; <a class="local col7 ref" href="#697i" title='i' data-ref="697i" data-ref-filename="697i">i</a>&lt;<a class="local col2 ref" href="#692iter" title='iter' data-ref="692iter" data-ref-filename="692iter">iter</a>; <a class="local col7 ref" href="#697i" title='i' data-ref="697i" data-ref-filename="697i">i</a>++) {</td></tr>
<tr><th id="2586">2586</th><td>		<i>/* hashfunc(hash, salt) */</i></td></tr>
<tr><th id="2587">2587</th><td>		<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(p, 0) != (size_t)-1) ? __builtin___memmove_chk(p, buf, hlen, __builtin_object_size(p, 0)) : __memmove_ichk(p, buf, hlen))" data-ref="_M/memmove">memmove</a>(<a class="local col6 ref" href="#696p" title='p' data-ref="696p" data-ref-filename="696p">p</a>, <a class="local col7 ref" href="#687buf" title='buf' data-ref="687buf" data-ref-filename="687buf">buf</a>, <a class="local col5 ref" href="#695hlen" title='hlen' data-ref="695hlen" data-ref-filename="695hlen">hlen</a>);</td></tr>
<tr><th id="2588">2588</th><td>		<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(p+hlen, 0) != (size_t)-1) ? __builtin___memmove_chk(p+hlen, salt, saltlen, __builtin_object_size(p+hlen, 0)) : __memmove_ichk(p+hlen, salt, saltlen))" data-ref="_M/memmove">memmove</a>(<a class="local col6 ref" href="#696p" title='p' data-ref="696p" data-ref-filename="696p">p</a>+<a class="local col5 ref" href="#695hlen" title='hlen' data-ref="695hlen" data-ref-filename="695hlen">hlen</a>, <a class="local col3 ref" href="#693salt" title='salt' data-ref="693salt" data-ref-filename="693salt">salt</a>, <a class="local col4 ref" href="#694saltlen" title='saltlen' data-ref="694saltlen" data-ref-filename="694saltlen">saltlen</a>);</td></tr>
<tr><th id="2589">2589</th><td>		(<em>void</em>)<a class="ref fn" href="../validator/val_secalgo.h.html#secalgo_nsec3_hash" title='secalgo_nsec3_hash' data-ref="secalgo_nsec3_hash" data-ref-filename="secalgo_nsec3_hash">secalgo_nsec3_hash</a>(<a class="local col1 ref" href="#691algo" title='algo' data-ref="691algo" data-ref-filename="691algo">algo</a>, <a class="local col6 ref" href="#696p" title='p' data-ref="696p" data-ref-filename="696p">p</a>, <a class="local col5 ref" href="#695hlen" title='hlen' data-ref="695hlen" data-ref-filename="695hlen">hlen</a>+<a class="local col4 ref" href="#694saltlen" title='saltlen' data-ref="694saltlen" data-ref-filename="694saltlen">saltlen</a>,</td></tr>
<tr><th id="2590">2590</th><td>			(<em>unsigned</em> <em>char</em>*)<a class="local col7 ref" href="#687buf" title='buf' data-ref="687buf" data-ref-filename="687buf">buf</a>);</td></tr>
<tr><th id="2591">2591</th><td>	}</td></tr>
<tr><th id="2592">2592</th><td>	<b>return</b> <a class="local col5 ref" href="#695hlen" title='hlen' data-ref="695hlen" data-ref-filename="695hlen">hlen</a>;</td></tr>
<tr><th id="2593">2593</th><td>}</td></tr>
<tr><th id="2594">2594</th><td></td></tr>
<tr><th id="2595">2595</th><td><i class="doc" data-doc="az_nsec3_hashname">/** Hash name and return b32encoded hashname for lookup, zone name appended */</i></td></tr>
<tr><th id="2596">2596</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="2597">2597</th><td><dfn class="tu decl def fn" id="az_nsec3_hashname" title='az_nsec3_hashname' data-type='int az_nsec3_hashname(struct auth_zone * z, uint8_t * hashname, size_t * hashnmlen, uint8_t * nm, size_t nmlen, int algo, size_t iter, uint8_t * salt, size_t saltlen)' data-ref="az_nsec3_hashname" data-ref-filename="az_nsec3_hashname">az_nsec3_hashname</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col8 decl" id="698z" title='z' data-type='struct auth_zone *' data-ref="698z" data-ref-filename="698z">z</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col9 decl" id="699hashname" title='hashname' data-type='uint8_t *' data-ref="699hashname" data-ref-filename="699hashname">hashname</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>* <dfn class="local col0 decl" id="700hashnmlen" title='hashnmlen' data-type='size_t *' data-ref="700hashnmlen" data-ref-filename="700hashnmlen">hashnmlen</dfn>,</td></tr>
<tr><th id="2598">2598</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col1 decl" id="701nm" title='nm' data-type='uint8_t *' data-ref="701nm" data-ref-filename="701nm">nm</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col2 decl" id="702nmlen" title='nmlen' data-type='size_t' data-ref="702nmlen" data-ref-filename="702nmlen">nmlen</dfn>, <em>int</em> <dfn class="local col3 decl" id="703algo" title='algo' data-type='int' data-ref="703algo" data-ref-filename="703algo">algo</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col4 decl" id="704iter" title='iter' data-type='size_t' data-ref="704iter" data-ref-filename="704iter">iter</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col5 decl" id="705salt" title='salt' data-type='uint8_t *' data-ref="705salt" data-ref-filename="705salt">salt</dfn>,</td></tr>
<tr><th id="2599">2599</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col6 decl" id="706saltlen" title='saltlen' data-type='size_t' data-ref="706saltlen" data-ref-filename="706saltlen">saltlen</dfn>)</td></tr>
<tr><th id="2600">2600</th><td>{</td></tr>
<tr><th id="2601">2601</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a> <dfn class="local col7 decl" id="707hash" title='hash' data-type='uint8_t [32]' data-ref="707hash" data-ref-filename="707hash">hash</dfn>[<a class="macro" href="#74" title="32" data-ref="_M/N3HASHBUFLEN">N3HASHBUFLEN</a>];</td></tr>
<tr><th id="2602">2602</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col8 decl" id="708hlen" title='hlen' data-type='size_t' data-ref="708hlen" data-ref-filename="708hlen">hlen</dfn>;</td></tr>
<tr><th id="2603">2603</th><td>	<em>int</em> <dfn class="local col9 decl" id="709ret" title='ret' data-type='int' data-ref="709ret" data-ref-filename="709ret">ret</dfn>;</td></tr>
<tr><th id="2604">2604</th><td>	<a class="local col8 ref" href="#708hlen" title='hlen' data-ref="708hlen" data-ref-filename="708hlen">hlen</a> = <a class="tu ref fn" href="#az_nsec3_hash" title='az_nsec3_hash' data-use='c' data-ref="az_nsec3_hash" data-ref-filename="az_nsec3_hash">az_nsec3_hash</a>(<a class="local col7 ref" href="#707hash" title='hash' data-ref="707hash" data-ref-filename="707hash">hash</a>, <b>sizeof</b>(<a class="local col7 ref" href="#707hash" title='hash' data-ref="707hash" data-ref-filename="707hash">hash</a>), <a class="local col1 ref" href="#701nm" title='nm' data-ref="701nm" data-ref-filename="701nm">nm</a>, <a class="local col2 ref" href="#702nmlen" title='nmlen' data-ref="702nmlen" data-ref-filename="702nmlen">nmlen</a>, <a class="local col3 ref" href="#703algo" title='algo' data-ref="703algo" data-ref-filename="703algo">algo</a>, <a class="local col4 ref" href="#704iter" title='iter' data-ref="704iter" data-ref-filename="704iter">iter</a>,</td></tr>
<tr><th id="2605">2605</th><td>		<a class="local col5 ref" href="#705salt" title='salt' data-ref="705salt" data-ref-filename="705salt">salt</a>, <a class="local col6 ref" href="#706saltlen" title='saltlen' data-ref="706saltlen" data-ref-filename="706saltlen">saltlen</a>);</td></tr>
<tr><th id="2606">2606</th><td>	<b>if</b>(!<a class="local col8 ref" href="#708hlen" title='hlen' data-ref="708hlen" data-ref-filename="708hlen">hlen</a>) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="2607">2607</th><td>	<i>/* b32 encode */</i></td></tr>
<tr><th id="2608">2608</th><td>	<b>if</b>(*<a class="local col0 ref" href="#700hashnmlen" title='hashnmlen' data-ref="700hashnmlen" data-ref-filename="700hashnmlen">hashnmlen</a> &lt; <a class="local col8 ref" href="#708hlen" title='hlen' data-ref="708hlen" data-ref-filename="708hlen">hlen</a>*<var>2</var>+<var>1</var>+<a class="local col8 ref" href="#698z" title='z' data-ref="698z" data-ref-filename="698z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::namelen" title='auth_zone::namelen' data-ref="auth_zone::namelen" data-ref-filename="auth_zone..namelen">namelen</a>) <i>/* approx b32 as hexb16 */</i></td></tr>
<tr><th id="2609">2609</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2610">2610</th><td>	<a class="local col9 ref" href="#709ret" title='ret' data-ref="709ret" data-ref-filename="709ret">ret</a> = <a class="ref fn" href="../sldns/parseutil.h.html#sldns_b32_ntop_extended_hex" title='sldns_b32_ntop_extended_hex' data-ref="sldns_b32_ntop_extended_hex" data-ref-filename="sldns_b32_ntop_extended_hex">sldns_b32_ntop_extended_hex</a>(<a class="local col7 ref" href="#707hash" title='hash' data-ref="707hash" data-ref-filename="707hash">hash</a>, <a class="local col8 ref" href="#708hlen" title='hlen' data-ref="708hlen" data-ref-filename="708hlen">hlen</a>, (<em>char</em>*)(<a class="local col9 ref" href="#699hashname" title='hashname' data-ref="699hashname" data-ref-filename="699hashname">hashname</a>+<var>1</var>),</td></tr>
<tr><th id="2611">2611</th><td>		(*<a class="local col0 ref" href="#700hashnmlen" title='hashnmlen' data-ref="700hashnmlen" data-ref-filename="700hashnmlen">hashnmlen</a>)-<var>1</var>);</td></tr>
<tr><th id="2612">2612</th><td>	<b>if</b>(<a class="local col9 ref" href="#709ret" title='ret' data-ref="709ret" data-ref-filename="709ret">ret</a>&lt;<var>1</var>)</td></tr>
<tr><th id="2613">2613</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2614">2614</th><td>	<a class="local col9 ref" href="#699hashname" title='hashname' data-ref="699hashname" data-ref-filename="699hashname">hashname</a>[<var>0</var>] = (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>)<a class="local col9 ref" href="#709ret" title='ret' data-ref="709ret" data-ref-filename="709ret">ret</a>;</td></tr>
<tr><th id="2615">2615</th><td>	<a class="local col9 ref" href="#709ret" title='ret' data-ref="709ret" data-ref-filename="709ret">ret</a>++;</td></tr>
<tr><th id="2616">2616</th><td>	<b>if</b>((*<a class="local col0 ref" href="#700hashnmlen" title='hashnmlen' data-ref="700hashnmlen" data-ref-filename="700hashnmlen">hashnmlen</a>) - <a class="local col9 ref" href="#709ret" title='ret' data-ref="709ret" data-ref-filename="709ret">ret</a> &lt; <a class="local col8 ref" href="#698z" title='z' data-ref="698z" data-ref-filename="698z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::namelen" title='auth_zone::namelen' data-ref="auth_zone::namelen" data-ref-filename="auth_zone..namelen">namelen</a>)</td></tr>
<tr><th id="2617">2617</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2618">2618</th><td>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(hashname+ret, 0) != (size_t)-1) ? __builtin___memmove_chk(hashname+ret, z-&gt;name, z-&gt;namelen, __builtin_object_size(hashname+ret, 0)) : __memmove_ichk(hashname+ret, z-&gt;name, z-&gt;namelen))" data-ref="_M/memmove">memmove</a>(<a class="local col9 ref" href="#699hashname" title='hashname' data-ref="699hashname" data-ref-filename="699hashname">hashname</a>+<a class="local col9 ref" href="#709ret" title='ret' data-ref="709ret" data-ref-filename="709ret">ret</a>, <a class="local col8 ref" href="#698z" title='z' data-ref="698z" data-ref-filename="698z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::name" title='auth_zone::name' data-ref="auth_zone::name" data-ref-filename="auth_zone..name">name</a>, <a class="local col8 ref" href="#698z" title='z' data-ref="698z" data-ref-filename="698z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::namelen" title='auth_zone::namelen' data-ref="auth_zone::namelen" data-ref-filename="auth_zone..namelen">namelen</a>);</td></tr>
<tr><th id="2619">2619</th><td>	*<a class="local col0 ref" href="#700hashnmlen" title='hashnmlen' data-ref="700hashnmlen" data-ref-filename="700hashnmlen">hashnmlen</a> = <a class="local col8 ref" href="#698z" title='z' data-ref="698z" data-ref-filename="698z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::namelen" title='auth_zone::namelen' data-ref="auth_zone::namelen" data-ref-filename="auth_zone..namelen">namelen</a>+(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>)<a class="local col9 ref" href="#709ret" title='ret' data-ref="709ret" data-ref-filename="709ret">ret</a>;</td></tr>
<tr><th id="2620">2620</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="2621">2621</th><td>}</td></tr>
<tr><th id="2622">2622</th><td></td></tr>
<tr><th id="2623">2623</th><td><i class="doc" data-doc="az_nsec3_findnode">/** Find the datanode that covers the nsec3hash-name */</i></td></tr>
<tr><th id="2624">2624</th><td><em>static</em> <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>*</td></tr>
<tr><th id="2625">2625</th><td><dfn class="tu decl def fn" id="az_nsec3_findnode" title='az_nsec3_findnode' data-type='struct auth_data * az_nsec3_findnode(struct auth_zone * z, uint8_t * hashnm, size_t hashnmlen)' data-ref="az_nsec3_findnode" data-ref-filename="az_nsec3_findnode">az_nsec3_findnode</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col0 decl" id="710z" title='z' data-type='struct auth_zone *' data-ref="710z" data-ref-filename="710z">z</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col1 decl" id="711hashnm" title='hashnm' data-type='uint8_t *' data-ref="711hashnm" data-ref-filename="711hashnm">hashnm</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col2 decl" id="712hashnmlen" title='hashnmlen' data-type='size_t' data-ref="712hashnmlen" data-ref-filename="712hashnmlen">hashnmlen</dfn>)</td></tr>
<tr><th id="2626">2626</th><td>{</td></tr>
<tr><th id="2627">2627</th><td>	<b>struct</b> <a class="type" href="../util/data/msgreply.h.html#query_info" title='query_info' data-ref="query_info" data-ref-filename="query_info">query_info</a> <dfn class="local col3 decl" id="713qinfo" title='qinfo' data-type='struct query_info' data-ref="713qinfo" data-ref-filename="713qinfo">qinfo</dfn>;</td></tr>
<tr><th id="2628">2628</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col4 decl" id="714node" title='node' data-type='struct auth_data *' data-ref="714node" data-ref-filename="714node">node</dfn>;</td></tr>
<tr><th id="2629">2629</th><td>	<em>int</em> <dfn class="local col5 decl" id="715node_exact" title='node_exact' data-type='int' data-ref="715node_exact" data-ref-filename="715node_exact">node_exact</dfn>;</td></tr>
<tr><th id="2630">2630</th><td>	<a class="local col3 ref" href="#713qinfo" title='qinfo' data-ref="713qinfo" data-ref-filename="713qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qclass" title='query_info::qclass' data-ref="query_info::qclass" data-ref-filename="query_info..qclass">qclass</a> = <var>0</var>;</td></tr>
<tr><th id="2631">2631</th><td>	<a class="local col3 ref" href="#713qinfo" title='qinfo' data-ref="713qinfo" data-ref-filename="713qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qtype" title='query_info::qtype' data-ref="query_info::qtype" data-ref-filename="query_info..qtype">qtype</a> = <var>0</var>;</td></tr>
<tr><th id="2632">2632</th><td>	<a class="local col3 ref" href="#713qinfo" title='qinfo' data-ref="713qinfo" data-ref-filename="713qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname" title='query_info::qname' data-ref="query_info::qname" data-ref-filename="query_info..qname">qname</a> = <a class="local col1 ref" href="#711hashnm" title='hashnm' data-ref="711hashnm" data-ref-filename="711hashnm">hashnm</a>;</td></tr>
<tr><th id="2633">2633</th><td>	<a class="local col3 ref" href="#713qinfo" title='qinfo' data-ref="713qinfo" data-ref-filename="713qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname_len" title='query_info::qname_len' data-ref="query_info::qname_len" data-ref-filename="query_info..qname_len">qname_len</a> = <a class="local col2 ref" href="#712hashnmlen" title='hashnmlen' data-ref="712hashnmlen" data-ref-filename="712hashnmlen">hashnmlen</a>;</td></tr>
<tr><th id="2634">2634</th><td>	<i>/* because canonical ordering and b32 nsec3 ordering are the same.</i></td></tr>
<tr><th id="2635">2635</th><td><i>	 * this is a good lookup to find the nsec3 name. */</i></td></tr>
<tr><th id="2636">2636</th><td>	<a class="tu ref fn" href="#az_find_domain" title='az_find_domain' data-use='c' data-ref="az_find_domain" data-ref-filename="az_find_domain">az_find_domain</a>(<a class="local col0 ref" href="#710z" title='z' data-ref="710z" data-ref-filename="710z">z</a>, &amp;<a class="local col3 ref" href="#713qinfo" title='qinfo' data-ref="713qinfo" data-ref-filename="713qinfo">qinfo</a>, &amp;<a class="local col5 ref" href="#715node_exact" title='node_exact' data-ref="715node_exact" data-ref-filename="715node_exact">node_exact</a>, &amp;<a class="local col4 ref" href="#714node" title='node' data-ref="714node" data-ref-filename="714node">node</a>);</td></tr>
<tr><th id="2637">2637</th><td>	<i>/* but we may have to skip non-nsec3 nodes */</i></td></tr>
<tr><th id="2638">2638</th><td>	<i>/* this may be a lot, the way to speed that up is to have a</i></td></tr>
<tr><th id="2639">2639</th><td><i>	 * separate nsec3 tree with nsec3 nodes */</i></td></tr>
<tr><th id="2640">2640</th><td>	<b>while</b>(<a class="local col4 ref" href="#714node" title='node' data-ref="714node" data-ref-filename="714node">node</a> &amp;&amp; (<a class="typedef" href="../util/rbtree.h.html#rbnode_type" title='rbnode_type' data-type='struct rbnode_type' data-ref="rbnode_type" data-ref-filename="rbnode_type">rbnode_type</a>*)<a class="local col4 ref" href="#714node" title='node' data-ref="714node" data-ref-filename="714node">node</a> != <a class="macro" href="../util/rbtree.h.html#69" title="&amp;rbtree_null_node" data-ref="_M/RBTREE_NULL">RBTREE_NULL</a> &amp;&amp;</td></tr>
<tr><th id="2641">2641</th><td>		!<a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(<a class="local col4 ref" href="#714node" title='node' data-ref="714node" data-ref-filename="714node">node</a>, <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_NSEC3" title='LDNS_RR_TYPE_NSEC3' data-ref="LDNS_RR_TYPE_NSEC3" data-ref-filename="LDNS_RR_TYPE_NSEC3">LDNS_RR_TYPE_NSEC3</a>)) {</td></tr>
<tr><th id="2642">2642</th><td>		<a class="local col4 ref" href="#714node" title='node' data-ref="714node" data-ref-filename="714node">node</a> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>*)<a class="ref fn" href="../util/rbtree.h.html#rbtree_previous" title='rbtree_previous' data-ref="rbtree_previous" data-ref-filename="rbtree_previous">rbtree_previous</a>(&amp;<a class="local col4 ref" href="#714node" title='node' data-ref="714node" data-ref-filename="714node">node</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::node" title='auth_data::node' data-ref="auth_data::node" data-ref-filename="auth_data..node">node</a>);</td></tr>
<tr><th id="2643">2643</th><td>	}</td></tr>
<tr><th id="2644">2644</th><td>	<b>if</b>((<a class="typedef" href="../util/rbtree.h.html#rbnode_type" title='rbnode_type' data-type='struct rbnode_type' data-ref="rbnode_type" data-ref-filename="rbnode_type">rbnode_type</a>*)<a class="local col4 ref" href="#714node" title='node' data-ref="714node" data-ref-filename="714node">node</a> == <a class="macro" href="../util/rbtree.h.html#69" title="&amp;rbtree_null_node" data-ref="_M/RBTREE_NULL">RBTREE_NULL</a>)</td></tr>
<tr><th id="2645">2645</th><td>		<a class="local col4 ref" href="#714node" title='node' data-ref="714node" data-ref-filename="714node">node</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="2646">2646</th><td>	<b>return</b> <a class="local col4 ref" href="#714node" title='node' data-ref="714node" data-ref-filename="714node">node</a>;</td></tr>
<tr><th id="2647">2647</th><td>}</td></tr>
<tr><th id="2648">2648</th><td></td></tr>
<tr><th id="2649">2649</th><td><i class="doc" data-doc="az_nsec3_find_cover">/** Find cover for hashed(nm, nmlen) (or NULL) */</i></td></tr>
<tr><th id="2650">2650</th><td><em>static</em> <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>*</td></tr>
<tr><th id="2651">2651</th><td><dfn class="tu decl def fn" id="az_nsec3_find_cover" title='az_nsec3_find_cover' data-type='struct auth_data * az_nsec3_find_cover(struct auth_zone * z, uint8_t * nm, size_t nmlen, int algo, size_t iter, uint8_t * salt, size_t saltlen)' data-ref="az_nsec3_find_cover" data-ref-filename="az_nsec3_find_cover">az_nsec3_find_cover</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col6 decl" id="716z" title='z' data-type='struct auth_zone *' data-ref="716z" data-ref-filename="716z">z</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col7 decl" id="717nm" title='nm' data-type='uint8_t *' data-ref="717nm" data-ref-filename="717nm">nm</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col8 decl" id="718nmlen" title='nmlen' data-type='size_t' data-ref="718nmlen" data-ref-filename="718nmlen">nmlen</dfn>,</td></tr>
<tr><th id="2652">2652</th><td>	<em>int</em> <dfn class="local col9 decl" id="719algo" title='algo' data-type='int' data-ref="719algo" data-ref-filename="719algo">algo</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col0 decl" id="720iter" title='iter' data-type='size_t' data-ref="720iter" data-ref-filename="720iter">iter</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col1 decl" id="721salt" title='salt' data-type='uint8_t *' data-ref="721salt" data-ref-filename="721salt">salt</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col2 decl" id="722saltlen" title='saltlen' data-type='size_t' data-ref="722saltlen" data-ref-filename="722saltlen">saltlen</dfn>)</td></tr>
<tr><th id="2653">2653</th><td>{</td></tr>
<tr><th id="2654">2654</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col3 decl" id="723node" title='node' data-type='struct auth_data *' data-ref="723node" data-ref-filename="723node">node</dfn>;</td></tr>
<tr><th id="2655">2655</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a> <dfn class="local col4 decl" id="724hname" title='hname' data-type='uint8_t [255]' data-ref="724hname" data-ref-filename="724hname">hname</dfn>[<a class="macro" href="../sldns/rrdef.h.html#29" title="255" data-ref="_M/LDNS_MAX_DOMAINLEN">LDNS_MAX_DOMAINLEN</a>];</td></tr>
<tr><th id="2656">2656</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col5 decl" id="725hlen" title='hlen' data-type='size_t' data-ref="725hlen" data-ref-filename="725hlen">hlen</dfn> = <b>sizeof</b>(<a class="local col4 ref" href="#724hname" title='hname' data-ref="724hname" data-ref-filename="724hname">hname</a>);</td></tr>
<tr><th id="2657">2657</th><td>	<b>if</b>(!<a class="tu ref fn" href="#az_nsec3_hashname" title='az_nsec3_hashname' data-use='c' data-ref="az_nsec3_hashname" data-ref-filename="az_nsec3_hashname">az_nsec3_hashname</a>(<a class="local col6 ref" href="#716z" title='z' data-ref="716z" data-ref-filename="716z">z</a>, <a class="local col4 ref" href="#724hname" title='hname' data-ref="724hname" data-ref-filename="724hname">hname</a>, &amp;<a class="local col5 ref" href="#725hlen" title='hlen' data-ref="725hlen" data-ref-filename="725hlen">hlen</a>, <a class="local col7 ref" href="#717nm" title='nm' data-ref="717nm" data-ref-filename="717nm">nm</a>, <a class="local col8 ref" href="#718nmlen" title='nmlen' data-ref="718nmlen" data-ref-filename="718nmlen">nmlen</a>, <a class="local col9 ref" href="#719algo" title='algo' data-ref="719algo" data-ref-filename="719algo">algo</a>, <a class="local col0 ref" href="#720iter" title='iter' data-ref="720iter" data-ref-filename="720iter">iter</a>,</td></tr>
<tr><th id="2658">2658</th><td>		<a class="local col1 ref" href="#721salt" title='salt' data-ref="721salt" data-ref-filename="721salt">salt</a>, <a class="local col2 ref" href="#722saltlen" title='saltlen' data-ref="722saltlen" data-ref-filename="722saltlen">saltlen</a>))</td></tr>
<tr><th id="2659">2659</th><td>		<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="2660">2660</th><td>	<a class="local col3 ref" href="#723node" title='node' data-ref="723node" data-ref-filename="723node">node</a> = <a class="tu ref fn" href="#az_nsec3_findnode" title='az_nsec3_findnode' data-use='c' data-ref="az_nsec3_findnode" data-ref-filename="az_nsec3_findnode">az_nsec3_findnode</a>(<a class="local col6 ref" href="#716z" title='z' data-ref="716z" data-ref-filename="716z">z</a>, <a class="local col4 ref" href="#724hname" title='hname' data-ref="724hname" data-ref-filename="724hname">hname</a>, <a class="local col5 ref" href="#725hlen" title='hlen' data-ref="725hlen" data-ref-filename="725hlen">hlen</a>);</td></tr>
<tr><th id="2661">2661</th><td>	<b>if</b>(<a class="local col3 ref" href="#723node" title='node' data-ref="723node" data-ref-filename="723node">node</a>)</td></tr>
<tr><th id="2662">2662</th><td>		<b>return</b> <a class="local col3 ref" href="#723node" title='node' data-ref="723node" data-ref-filename="723node">node</a>;</td></tr>
<tr><th id="2663">2663</th><td>	<i>/* we did not find any, perhaps because the NSEC3 hash is before</i></td></tr>
<tr><th id="2664">2664</th><td><i>	 * the first hash, we have to find the 'last hash' in the zone */</i></td></tr>
<tr><th id="2665">2665</th><td>	<a class="local col3 ref" href="#723node" title='node' data-ref="723node" data-ref-filename="723node">node</a> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>*)<a class="ref fn" href="../util/rbtree.h.html#rbtree_last" title='rbtree_last' data-ref="rbtree_last" data-ref-filename="rbtree_last">rbtree_last</a>(&amp;<a class="local col6 ref" href="#716z" title='z' data-ref="716z" data-ref-filename="716z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::data" title='auth_zone::data' data-ref="auth_zone::data" data-ref-filename="auth_zone..data">data</a>);</td></tr>
<tr><th id="2666">2666</th><td>	<b>while</b>(<a class="local col3 ref" href="#723node" title='node' data-ref="723node" data-ref-filename="723node">node</a> &amp;&amp; (<a class="typedef" href="../util/rbtree.h.html#rbnode_type" title='rbnode_type' data-type='struct rbnode_type' data-ref="rbnode_type" data-ref-filename="rbnode_type">rbnode_type</a>*)<a class="local col3 ref" href="#723node" title='node' data-ref="723node" data-ref-filename="723node">node</a> != <a class="macro" href="../util/rbtree.h.html#69" title="&amp;rbtree_null_node" data-ref="_M/RBTREE_NULL">RBTREE_NULL</a> &amp;&amp;</td></tr>
<tr><th id="2667">2667</th><td>		!<a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(<a class="local col3 ref" href="#723node" title='node' data-ref="723node" data-ref-filename="723node">node</a>, <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_NSEC3" title='LDNS_RR_TYPE_NSEC3' data-ref="LDNS_RR_TYPE_NSEC3" data-ref-filename="LDNS_RR_TYPE_NSEC3">LDNS_RR_TYPE_NSEC3</a>)) {</td></tr>
<tr><th id="2668">2668</th><td>		<a class="local col3 ref" href="#723node" title='node' data-ref="723node" data-ref-filename="723node">node</a> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>*)<a class="ref fn" href="../util/rbtree.h.html#rbtree_previous" title='rbtree_previous' data-ref="rbtree_previous" data-ref-filename="rbtree_previous">rbtree_previous</a>(&amp;<a class="local col3 ref" href="#723node" title='node' data-ref="723node" data-ref-filename="723node">node</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::node" title='auth_data::node' data-ref="auth_data::node" data-ref-filename="auth_data..node">node</a>);</td></tr>
<tr><th id="2669">2669</th><td>	}</td></tr>
<tr><th id="2670">2670</th><td>	<b>if</b>((<a class="typedef" href="../util/rbtree.h.html#rbnode_type" title='rbnode_type' data-type='struct rbnode_type' data-ref="rbnode_type" data-ref-filename="rbnode_type">rbnode_type</a>*)<a class="local col3 ref" href="#723node" title='node' data-ref="723node" data-ref-filename="723node">node</a> == <a class="macro" href="../util/rbtree.h.html#69" title="&amp;rbtree_null_node" data-ref="_M/RBTREE_NULL">RBTREE_NULL</a>)</td></tr>
<tr><th id="2671">2671</th><td>		<a class="local col3 ref" href="#723node" title='node' data-ref="723node" data-ref-filename="723node">node</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="2672">2672</th><td>	<b>return</b> <a class="local col3 ref" href="#723node" title='node' data-ref="723node" data-ref-filename="723node">node</a>;</td></tr>
<tr><th id="2673">2673</th><td>}</td></tr>
<tr><th id="2674">2674</th><td></td></tr>
<tr><th id="2675">2675</th><td><i class="doc" data-doc="az_nsec3_find_exact">/** Find exact match for hashed(nm, nmlen) NSEC3 record or NULL */</i></td></tr>
<tr><th id="2676">2676</th><td><em>static</em> <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>*</td></tr>
<tr><th id="2677">2677</th><td><dfn class="tu decl def fn" id="az_nsec3_find_exact" title='az_nsec3_find_exact' data-type='struct auth_data * az_nsec3_find_exact(struct auth_zone * z, uint8_t * nm, size_t nmlen, int algo, size_t iter, uint8_t * salt, size_t saltlen)' data-ref="az_nsec3_find_exact" data-ref-filename="az_nsec3_find_exact">az_nsec3_find_exact</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col6 decl" id="726z" title='z' data-type='struct auth_zone *' data-ref="726z" data-ref-filename="726z">z</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col7 decl" id="727nm" title='nm' data-type='uint8_t *' data-ref="727nm" data-ref-filename="727nm">nm</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col8 decl" id="728nmlen" title='nmlen' data-type='size_t' data-ref="728nmlen" data-ref-filename="728nmlen">nmlen</dfn>,</td></tr>
<tr><th id="2678">2678</th><td>	<em>int</em> <dfn class="local col9 decl" id="729algo" title='algo' data-type='int' data-ref="729algo" data-ref-filename="729algo">algo</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col0 decl" id="730iter" title='iter' data-type='size_t' data-ref="730iter" data-ref-filename="730iter">iter</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col1 decl" id="731salt" title='salt' data-type='uint8_t *' data-ref="731salt" data-ref-filename="731salt">salt</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col2 decl" id="732saltlen" title='saltlen' data-type='size_t' data-ref="732saltlen" data-ref-filename="732saltlen">saltlen</dfn>)</td></tr>
<tr><th id="2679">2679</th><td>{</td></tr>
<tr><th id="2680">2680</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col3 decl" id="733node" title='node' data-type='struct auth_data *' data-ref="733node" data-ref-filename="733node">node</dfn>;</td></tr>
<tr><th id="2681">2681</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a> <dfn class="local col4 decl" id="734hname" title='hname' data-type='uint8_t [255]' data-ref="734hname" data-ref-filename="734hname">hname</dfn>[<a class="macro" href="../sldns/rrdef.h.html#29" title="255" data-ref="_M/LDNS_MAX_DOMAINLEN">LDNS_MAX_DOMAINLEN</a>];</td></tr>
<tr><th id="2682">2682</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col5 decl" id="735hlen" title='hlen' data-type='size_t' data-ref="735hlen" data-ref-filename="735hlen">hlen</dfn> = <b>sizeof</b>(<a class="local col4 ref" href="#734hname" title='hname' data-ref="734hname" data-ref-filename="734hname">hname</a>);</td></tr>
<tr><th id="2683">2683</th><td>	<b>if</b>(!<a class="tu ref fn" href="#az_nsec3_hashname" title='az_nsec3_hashname' data-use='c' data-ref="az_nsec3_hashname" data-ref-filename="az_nsec3_hashname">az_nsec3_hashname</a>(<a class="local col6 ref" href="#726z" title='z' data-ref="726z" data-ref-filename="726z">z</a>, <a class="local col4 ref" href="#734hname" title='hname' data-ref="734hname" data-ref-filename="734hname">hname</a>, &amp;<a class="local col5 ref" href="#735hlen" title='hlen' data-ref="735hlen" data-ref-filename="735hlen">hlen</a>, <a class="local col7 ref" href="#727nm" title='nm' data-ref="727nm" data-ref-filename="727nm">nm</a>, <a class="local col8 ref" href="#728nmlen" title='nmlen' data-ref="728nmlen" data-ref-filename="728nmlen">nmlen</a>, <a class="local col9 ref" href="#729algo" title='algo' data-ref="729algo" data-ref-filename="729algo">algo</a>, <a class="local col0 ref" href="#730iter" title='iter' data-ref="730iter" data-ref-filename="730iter">iter</a>,</td></tr>
<tr><th id="2684">2684</th><td>		<a class="local col1 ref" href="#731salt" title='salt' data-ref="731salt" data-ref-filename="731salt">salt</a>, <a class="local col2 ref" href="#732saltlen" title='saltlen' data-ref="732saltlen" data-ref-filename="732saltlen">saltlen</a>))</td></tr>
<tr><th id="2685">2685</th><td>		<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="2686">2686</th><td>	<a class="local col3 ref" href="#733node" title='node' data-ref="733node" data-ref-filename="733node">node</a> = <a class="tu ref fn" href="#az_find_name" title='az_find_name' data-use='c' data-ref="az_find_name" data-ref-filename="az_find_name">az_find_name</a>(<a class="local col6 ref" href="#726z" title='z' data-ref="726z" data-ref-filename="726z">z</a>, <a class="local col4 ref" href="#734hname" title='hname' data-ref="734hname" data-ref-filename="734hname">hname</a>, <a class="local col5 ref" href="#735hlen" title='hlen' data-ref="735hlen" data-ref-filename="735hlen">hlen</a>);</td></tr>
<tr><th id="2687">2687</th><td>	<b>if</b>(<a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(<a class="local col3 ref" href="#733node" title='node' data-ref="733node" data-ref-filename="733node">node</a>, <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_NSEC3" title='LDNS_RR_TYPE_NSEC3' data-ref="LDNS_RR_TYPE_NSEC3" data-ref-filename="LDNS_RR_TYPE_NSEC3">LDNS_RR_TYPE_NSEC3</a>))</td></tr>
<tr><th id="2688">2688</th><td>		<b>return</b> <a class="local col3 ref" href="#733node" title='node' data-ref="733node" data-ref-filename="733node">node</a>;</td></tr>
<tr><th id="2689">2689</th><td>	<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="2690">2690</th><td>}</td></tr>
<tr><th id="2691">2691</th><td></td></tr>
<tr><th id="2692">2692</th><td><i class="doc" data-doc="az_nsec3_get_nextcloser">/** Return nextcloser name (as a ref into the qname).  This is one label</i></td></tr>
<tr><th id="2693">2693</th><td><i class="doc" data-doc="az_nsec3_get_nextcloser"> * more than the cenm (cename must be a suffix of qname) */</i></td></tr>
<tr><th id="2694">2694</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="2695">2695</th><td><dfn class="tu decl def fn" id="az_nsec3_get_nextcloser" title='az_nsec3_get_nextcloser' data-type='void az_nsec3_get_nextcloser(uint8_t * cenm, uint8_t * qname, size_t qname_len, uint8_t ** nx, size_t * nxlen)' data-ref="az_nsec3_get_nextcloser" data-ref-filename="az_nsec3_get_nextcloser">az_nsec3_get_nextcloser</dfn>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col6 decl" id="736cenm" title='cenm' data-type='uint8_t *' data-ref="736cenm" data-ref-filename="736cenm">cenm</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col7 decl" id="737qname" title='qname' data-type='uint8_t *' data-ref="737qname" data-ref-filename="737qname">qname</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col8 decl" id="738qname_len" title='qname_len' data-type='size_t' data-ref="738qname_len" data-ref-filename="738qname_len">qname_len</dfn>,</td></tr>
<tr><th id="2696">2696</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>** <dfn class="local col9 decl" id="739nx" title='nx' data-type='uint8_t **' data-ref="739nx" data-ref-filename="739nx">nx</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>* <dfn class="local col0 decl" id="740nxlen" title='nxlen' data-type='size_t *' data-ref="740nxlen" data-ref-filename="740nxlen">nxlen</dfn>)</td></tr>
<tr><th id="2697">2697</th><td>{</td></tr>
<tr><th id="2698">2698</th><td>	<em>int</em> <dfn class="local col1 decl" id="741celabs" title='celabs' data-type='int' data-ref="741celabs" data-ref-filename="741celabs">celabs</dfn> = <a class="ref fn" href="../util/data/dname.h.html#dname_count_labels" title='dname_count_labels' data-ref="dname_count_labels" data-ref-filename="dname_count_labels">dname_count_labels</a>(<a class="local col6 ref" href="#736cenm" title='cenm' data-ref="736cenm" data-ref-filename="736cenm">cenm</a>);</td></tr>
<tr><th id="2699">2699</th><td>	<em>int</em> <dfn class="local col2 decl" id="742qlabs" title='qlabs' data-type='int' data-ref="742qlabs" data-ref-filename="742qlabs">qlabs</dfn> = <a class="ref fn" href="../util/data/dname.h.html#dname_count_labels" title='dname_count_labels' data-ref="dname_count_labels" data-ref-filename="dname_count_labels">dname_count_labels</a>(<a class="local col7 ref" href="#737qname" title='qname' data-ref="737qname" data-ref-filename="737qname">qname</a>);</td></tr>
<tr><th id="2700">2700</th><td>	<em>int</em> <dfn class="local col3 decl" id="743strip" title='strip' data-type='int' data-ref="743strip" data-ref-filename="743strip">strip</dfn> = <a class="local col2 ref" href="#742qlabs" title='qlabs' data-ref="742qlabs" data-ref-filename="742qlabs">qlabs</a> - <a class="local col1 ref" href="#741celabs" title='celabs' data-ref="741celabs" data-ref-filename="741celabs">celabs</a> -<var>1</var>;</td></tr>
<tr><th id="2701">2701</th><td>	<a class="macro" href="../util/log.h.html#211" title="" data-ref="_M/log_assert">log_assert</a>(dname_strict_subdomain(qname, qlabs, cenm, celabs));</td></tr>
<tr><th id="2702">2702</th><td>	*<a class="local col9 ref" href="#739nx" title='nx' data-ref="739nx" data-ref-filename="739nx">nx</a> = <a class="local col7 ref" href="#737qname" title='qname' data-ref="737qname" data-ref-filename="737qname">qname</a>;</td></tr>
<tr><th id="2703">2703</th><td>	*<a class="local col0 ref" href="#740nxlen" title='nxlen' data-ref="740nxlen" data-ref-filename="740nxlen">nxlen</a> = <a class="local col8 ref" href="#738qname_len" title='qname_len' data-ref="738qname_len" data-ref-filename="738qname_len">qname_len</a>;</td></tr>
<tr><th id="2704">2704</th><td>	<b>if</b>(<a class="local col3 ref" href="#743strip" title='strip' data-ref="743strip" data-ref-filename="743strip">strip</a>&gt;<var>0</var>)</td></tr>
<tr><th id="2705">2705</th><td>		<a class="ref fn" href="../util/data/dname.h.html#dname_remove_labels" title='dname_remove_labels' data-ref="dname_remove_labels" data-ref-filename="dname_remove_labels">dname_remove_labels</a>(<a class="local col9 ref" href="#739nx" title='nx' data-ref="739nx" data-ref-filename="739nx">nx</a>, <a class="local col0 ref" href="#740nxlen" title='nxlen' data-ref="740nxlen" data-ref-filename="740nxlen">nxlen</a>, <a class="local col3 ref" href="#743strip" title='strip' data-ref="743strip" data-ref-filename="743strip">strip</a>);</td></tr>
<tr><th id="2706">2706</th><td>}</td></tr>
<tr><th id="2707">2707</th><td></td></tr>
<tr><th id="2708">2708</th><td><i class="doc" data-doc="az_nsec3_find_ce">/** Find the closest encloser that has exact NSEC3.</i></td></tr>
<tr><th id="2709">2709</th><td><i class="doc" data-doc="az_nsec3_find_ce"> * updated cenm to the new name. If it went up no-exact-ce is true. */</i></td></tr>
<tr><th id="2710">2710</th><td><em>static</em> <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>*</td></tr>
<tr><th id="2711">2711</th><td><dfn class="tu decl def fn" id="az_nsec3_find_ce" title='az_nsec3_find_ce' data-type='struct auth_data * az_nsec3_find_ce(struct auth_zone * z, uint8_t ** cenm, size_t * cenmlen, int * no_exact_ce, int algo, size_t iter, uint8_t * salt, size_t saltlen)' data-ref="az_nsec3_find_ce" data-ref-filename="az_nsec3_find_ce">az_nsec3_find_ce</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col4 decl" id="744z" title='z' data-type='struct auth_zone *' data-ref="744z" data-ref-filename="744z">z</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>** <dfn class="local col5 decl" id="745cenm" title='cenm' data-type='uint8_t **' data-ref="745cenm" data-ref-filename="745cenm">cenm</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>* <dfn class="local col6 decl" id="746cenmlen" title='cenmlen' data-type='size_t *' data-ref="746cenmlen" data-ref-filename="746cenmlen">cenmlen</dfn>,</td></tr>
<tr><th id="2712">2712</th><td>	<em>int</em>* <dfn class="local col7 decl" id="747no_exact_ce" title='no_exact_ce' data-type='int *' data-ref="747no_exact_ce" data-ref-filename="747no_exact_ce">no_exact_ce</dfn>, <em>int</em> <dfn class="local col8 decl" id="748algo" title='algo' data-type='int' data-ref="748algo" data-ref-filename="748algo">algo</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col9 decl" id="749iter" title='iter' data-type='size_t' data-ref="749iter" data-ref-filename="749iter">iter</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col0 decl" id="750salt" title='salt' data-type='uint8_t *' data-ref="750salt" data-ref-filename="750salt">salt</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col1 decl" id="751saltlen" title='saltlen' data-type='size_t' data-ref="751saltlen" data-ref-filename="751saltlen">saltlen</dfn>)</td></tr>
<tr><th id="2713">2713</th><td>{</td></tr>
<tr><th id="2714">2714</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col2 decl" id="752node" title='node' data-type='struct auth_data *' data-ref="752node" data-ref-filename="752node">node</dfn>;</td></tr>
<tr><th id="2715">2715</th><td>	<b>while</b>((<a class="local col2 ref" href="#752node" title='node' data-ref="752node" data-ref-filename="752node">node</a> = <a class="tu ref fn" href="#az_nsec3_find_exact" title='az_nsec3_find_exact' data-use='c' data-ref="az_nsec3_find_exact" data-ref-filename="az_nsec3_find_exact">az_nsec3_find_exact</a>(<a class="local col4 ref" href="#744z" title='z' data-ref="744z" data-ref-filename="744z">z</a>, *<a class="local col5 ref" href="#745cenm" title='cenm' data-ref="745cenm" data-ref-filename="745cenm">cenm</a>, *<a class="local col6 ref" href="#746cenmlen" title='cenmlen' data-ref="746cenmlen" data-ref-filename="746cenmlen">cenmlen</a>,</td></tr>
<tr><th id="2716">2716</th><td>		<a class="local col8 ref" href="#748algo" title='algo' data-ref="748algo" data-ref-filename="748algo">algo</a>, <a class="local col9 ref" href="#749iter" title='iter' data-ref="749iter" data-ref-filename="749iter">iter</a>, <a class="local col0 ref" href="#750salt" title='salt' data-ref="750salt" data-ref-filename="750salt">salt</a>, <a class="local col1 ref" href="#751saltlen" title='saltlen' data-ref="751saltlen" data-ref-filename="751saltlen">saltlen</a>)) == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="2717">2717</th><td>		<b>if</b>(*<a class="local col6 ref" href="#746cenmlen" title='cenmlen' data-ref="746cenmlen" data-ref-filename="746cenmlen">cenmlen</a> == <a class="local col4 ref" href="#744z" title='z' data-ref="744z" data-ref-filename="744z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::namelen" title='auth_zone::namelen' data-ref="auth_zone::namelen" data-ref-filename="auth_zone..namelen">namelen</a>) {</td></tr>
<tr><th id="2718">2718</th><td>			<i>/* next step up would take us out of the zone. fail */</i></td></tr>
<tr><th id="2719">2719</th><td>			<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="2720">2720</th><td>		}</td></tr>
<tr><th id="2721">2721</th><td>		*<a class="local col7 ref" href="#747no_exact_ce" title='no_exact_ce' data-ref="747no_exact_ce" data-ref-filename="747no_exact_ce">no_exact_ce</a> = <var>1</var>;</td></tr>
<tr><th id="2722">2722</th><td>		<a class="ref fn" href="../util/data/dname.h.html#dname_remove_label" title='dname_remove_label' data-ref="dname_remove_label" data-ref-filename="dname_remove_label">dname_remove_label</a>(<a class="local col5 ref" href="#745cenm" title='cenm' data-ref="745cenm" data-ref-filename="745cenm">cenm</a>, <a class="local col6 ref" href="#746cenmlen" title='cenmlen' data-ref="746cenmlen" data-ref-filename="746cenmlen">cenmlen</a>);</td></tr>
<tr><th id="2723">2723</th><td>	}</td></tr>
<tr><th id="2724">2724</th><td>	<b>return</b> <a class="local col2 ref" href="#752node" title='node' data-ref="752node" data-ref-filename="752node">node</a>;</td></tr>
<tr><th id="2725">2725</th><td>}</td></tr>
<tr><th id="2726">2726</th><td></td></tr>
<tr><th id="2727">2727</th><td><i  data-doc="az_nsec3_insert">/* Insert NSEC3 record in authority section, if NULL does nothing */</i></td></tr>
<tr><th id="2728">2728</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="2729">2729</th><td><dfn class="tu decl def fn" id="az_nsec3_insert" title='az_nsec3_insert' data-type='int az_nsec3_insert(struct auth_zone * z, struct regional * region, struct dns_msg * msg, struct auth_data * node)' data-ref="az_nsec3_insert" data-ref-filename="az_nsec3_insert">az_nsec3_insert</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col3 decl" id="753z" title='z' data-type='struct auth_zone *' data-ref="753z" data-ref-filename="753z">z</dfn>, <b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col4 decl" id="754region" title='region' data-type='struct regional *' data-ref="754region" data-ref-filename="754region">region</dfn>,</td></tr>
<tr><th id="2730">2730</th><td>	<b>struct</b> <a class="type" href="cache/dns.h.html#dns_msg" title='dns_msg' data-ref="dns_msg" data-ref-filename="dns_msg">dns_msg</a>* <dfn class="local col5 decl" id="755msg" title='msg' data-type='struct dns_msg *' data-ref="755msg" data-ref-filename="755msg">msg</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col6 decl" id="756node" title='node' data-type='struct auth_data *' data-ref="756node" data-ref-filename="756node">node</dfn>)</td></tr>
<tr><th id="2731">2731</th><td>{</td></tr>
<tr><th id="2732">2732</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col7 decl" id="757nsec3" title='nsec3' data-type='struct auth_rrset *' data-ref="757nsec3" data-ref-filename="757nsec3">nsec3</dfn>;</td></tr>
<tr><th id="2733">2733</th><td>	<b>if</b>(!<a class="local col6 ref" href="#756node" title='node' data-ref="756node" data-ref-filename="756node">node</a>) <b>return</b> <var>1</var>; <i>/* no node, skip this */</i></td></tr>
<tr><th id="2734">2734</th><td>	<a class="local col7 ref" href="#757nsec3" title='nsec3' data-ref="757nsec3" data-ref-filename="757nsec3">nsec3</a> = <a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(<a class="local col6 ref" href="#756node" title='node' data-ref="756node" data-ref-filename="756node">node</a>, <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_NSEC3" title='LDNS_RR_TYPE_NSEC3' data-ref="LDNS_RR_TYPE_NSEC3" data-ref-filename="LDNS_RR_TYPE_NSEC3">LDNS_RR_TYPE_NSEC3</a>);</td></tr>
<tr><th id="2735">2735</th><td>	<b>if</b>(!<a class="local col7 ref" href="#757nsec3" title='nsec3' data-ref="757nsec3" data-ref-filename="757nsec3">nsec3</a>) <b>return</b> <var>1</var>; <i>/* if no nsec3 RR, skip it */</i></td></tr>
<tr><th id="2736">2736</th><td>	<b>if</b>(!<a class="tu ref fn" href="#msg_add_rrset_ns" title='msg_add_rrset_ns' data-use='c' data-ref="msg_add_rrset_ns" data-ref-filename="msg_add_rrset_ns">msg_add_rrset_ns</a>(<a class="local col3 ref" href="#753z" title='z' data-ref="753z" data-ref-filename="753z">z</a>, <a class="local col4 ref" href="#754region" title='region' data-ref="754region" data-ref-filename="754region">region</a>, <a class="local col5 ref" href="#755msg" title='msg' data-ref="755msg" data-ref-filename="755msg">msg</a>, <a class="local col6 ref" href="#756node" title='node' data-ref="756node" data-ref-filename="756node">node</a>, <a class="local col7 ref" href="#757nsec3" title='nsec3' data-ref="757nsec3" data-ref-filename="757nsec3">nsec3</a>)) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="2737">2737</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="2738">2738</th><td>}</td></tr>
<tr><th id="2739">2739</th><td></td></tr>
<tr><th id="2740">2740</th><td><i class="doc" data-doc="az_add_nsec3_proof">/** add NSEC3 records to the zone for the nsec3 proof.</i></td></tr>
<tr><th id="2741">2741</th><td><i class="doc" data-doc="az_add_nsec3_proof"> * Specify with the flags with parts of the proof are required.</i></td></tr>
<tr><th id="2742">2742</th><td><i class="doc" data-doc="az_add_nsec3_proof"> * the ce is the exact matching name (for notype) but also delegation points.</i></td></tr>
<tr><th id="2743">2743</th><td><i class="doc" data-doc="az_add_nsec3_proof"> * qname is the one where the nextcloser name can be derived from.</i></td></tr>
<tr><th id="2744">2744</th><td><i class="doc" data-doc="az_add_nsec3_proof"> * If NSEC3 is not properly there (in the zone) nothing is added.</i></td></tr>
<tr><th id="2745">2745</th><td><i class="doc" data-doc="az_add_nsec3_proof"> * always enabled: include nsec3 proving about the Closest Encloser.</i></td></tr>
<tr><th id="2746">2746</th><td><i class="doc" data-doc="az_add_nsec3_proof"> * 	that is an exact match that should exist for it.</i></td></tr>
<tr><th id="2747">2747</th><td><i class="doc" data-doc="az_add_nsec3_proof"> * 	If that does not exist, a higher exact match + nxproof is enabled</i></td></tr>
<tr><th id="2748">2748</th><td><i class="doc" data-doc="az_add_nsec3_proof"> * 	(for some sort of opt-out empty nonterminal cases).</i></td></tr>
<tr><th id="2749">2749</th><td><i class="doc" data-doc="az_add_nsec3_proof"> * ceproof: include ce proof NSEC3 (omitted for wildcard replies).</i></td></tr>
<tr><th id="2750">2750</th><td><i class="doc" data-doc="az_add_nsec3_proof"> * nxproof: include denial of the qname.</i></td></tr>
<tr><th id="2751">2751</th><td><i class="doc" data-doc="az_add_nsec3_proof"> * wcproof: include denial of wildcard (wildcard.ce).</i></td></tr>
<tr><th id="2752">2752</th><td><i class="doc" data-doc="az_add_nsec3_proof"> */</i></td></tr>
<tr><th id="2753">2753</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="2754">2754</th><td><dfn class="tu decl def fn" id="az_add_nsec3_proof" title='az_add_nsec3_proof' data-type='int az_add_nsec3_proof(struct auth_zone * z, struct regional * region, struct dns_msg * msg, uint8_t * cenm, size_t cenmlen, uint8_t * qname, size_t qname_len, int ceproof, int nxproof, int wcproof)' data-ref="az_add_nsec3_proof" data-ref-filename="az_add_nsec3_proof">az_add_nsec3_proof</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col8 decl" id="758z" title='z' data-type='struct auth_zone *' data-ref="758z" data-ref-filename="758z">z</dfn>, <b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col9 decl" id="759region" title='region' data-type='struct regional *' data-ref="759region" data-ref-filename="759region">region</dfn>,</td></tr>
<tr><th id="2755">2755</th><td>	<b>struct</b> <a class="type" href="cache/dns.h.html#dns_msg" title='dns_msg' data-ref="dns_msg" data-ref-filename="dns_msg">dns_msg</a>* <dfn class="local col0 decl" id="760msg" title='msg' data-type='struct dns_msg *' data-ref="760msg" data-ref-filename="760msg">msg</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col1 decl" id="761cenm" title='cenm' data-type='uint8_t *' data-ref="761cenm" data-ref-filename="761cenm">cenm</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col2 decl" id="762cenmlen" title='cenmlen' data-type='size_t' data-ref="762cenmlen" data-ref-filename="762cenmlen">cenmlen</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col3 decl" id="763qname" title='qname' data-type='uint8_t *' data-ref="763qname" data-ref-filename="763qname">qname</dfn>,</td></tr>
<tr><th id="2756">2756</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col4 decl" id="764qname_len" title='qname_len' data-type='size_t' data-ref="764qname_len" data-ref-filename="764qname_len">qname_len</dfn>, <em>int</em> <dfn class="local col5 decl" id="765ceproof" title='ceproof' data-type='int' data-ref="765ceproof" data-ref-filename="765ceproof">ceproof</dfn>, <em>int</em> <dfn class="local col6 decl" id="766nxproof" title='nxproof' data-type='int' data-ref="766nxproof" data-ref-filename="766nxproof">nxproof</dfn>, <em>int</em> <dfn class="local col7 decl" id="767wcproof" title='wcproof' data-type='int' data-ref="767wcproof" data-ref-filename="767wcproof">wcproof</dfn>)</td></tr>
<tr><th id="2757">2757</th><td>{</td></tr>
<tr><th id="2758">2758</th><td>	<em>int</em> <dfn class="local col8 decl" id="768algo" title='algo' data-type='int' data-ref="768algo" data-ref-filename="768algo">algo</dfn>;</td></tr>
<tr><th id="2759">2759</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col9 decl" id="769iter" title='iter' data-type='size_t' data-ref="769iter" data-ref-filename="769iter">iter</dfn>, <dfn class="local col0 decl" id="770saltlen" title='saltlen' data-type='size_t' data-ref="770saltlen" data-ref-filename="770saltlen">saltlen</dfn>;</td></tr>
<tr><th id="2760">2760</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col1 decl" id="771salt" title='salt' data-type='uint8_t *' data-ref="771salt" data-ref-filename="771salt">salt</dfn>;</td></tr>
<tr><th id="2761">2761</th><td>	<em>int</em> <dfn class="local col2 decl" id="772no_exact_ce" title='no_exact_ce' data-type='int' data-ref="772no_exact_ce" data-ref-filename="772no_exact_ce">no_exact_ce</dfn> = <var>0</var>;</td></tr>
<tr><th id="2762">2762</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col3 decl" id="773node" title='node' data-type='struct auth_data *' data-ref="773node" data-ref-filename="773node">node</dfn>;</td></tr>
<tr><th id="2763">2763</th><td></td></tr>
<tr><th id="2764">2764</th><td>	<i>/* find parameters of nsec3 proof */</i></td></tr>
<tr><th id="2765">2765</th><td>	<b>if</b>(!<a class="tu ref fn" href="#az_nsec3_param" title='az_nsec3_param' data-use='c' data-ref="az_nsec3_param" data-ref-filename="az_nsec3_param">az_nsec3_param</a>(<a class="local col8 ref" href="#758z" title='z' data-ref="758z" data-ref-filename="758z">z</a>, &amp;<a class="local col8 ref" href="#768algo" title='algo' data-ref="768algo" data-ref-filename="768algo">algo</a>, &amp;<a class="local col9 ref" href="#769iter" title='iter' data-ref="769iter" data-ref-filename="769iter">iter</a>, &amp;<a class="local col1 ref" href="#771salt" title='salt' data-ref="771salt" data-ref-filename="771salt">salt</a>, &amp;<a class="local col0 ref" href="#770saltlen" title='saltlen' data-ref="770saltlen" data-ref-filename="770saltlen">saltlen</a>))</td></tr>
<tr><th id="2766">2766</th><td>		<b>return</b> <var>1</var>; <i>/* no nsec3 */</i></td></tr>
<tr><th id="2767">2767</th><td>	<i>/* find ce that has an NSEC3 */</i></td></tr>
<tr><th id="2768">2768</th><td>	<b>if</b>(<a class="local col5 ref" href="#765ceproof" title='ceproof' data-ref="765ceproof" data-ref-filename="765ceproof">ceproof</a>) {</td></tr>
<tr><th id="2769">2769</th><td>		<a class="local col3 ref" href="#773node" title='node' data-ref="773node" data-ref-filename="773node">node</a> = <a class="tu ref fn" href="#az_nsec3_find_ce" title='az_nsec3_find_ce' data-use='c' data-ref="az_nsec3_find_ce" data-ref-filename="az_nsec3_find_ce">az_nsec3_find_ce</a>(<a class="local col8 ref" href="#758z" title='z' data-ref="758z" data-ref-filename="758z">z</a>, &amp;<a class="local col1 ref" href="#761cenm" title='cenm' data-ref="761cenm" data-ref-filename="761cenm">cenm</a>, &amp;<a class="local col2 ref" href="#762cenmlen" title='cenmlen' data-ref="762cenmlen" data-ref-filename="762cenmlen">cenmlen</a>, &amp;<a class="local col2 ref" href="#772no_exact_ce" title='no_exact_ce' data-ref="772no_exact_ce" data-ref-filename="772no_exact_ce">no_exact_ce</a>,</td></tr>
<tr><th id="2770">2770</th><td>			<a class="local col8 ref" href="#768algo" title='algo' data-ref="768algo" data-ref-filename="768algo">algo</a>, <a class="local col9 ref" href="#769iter" title='iter' data-ref="769iter" data-ref-filename="769iter">iter</a>, <a class="local col1 ref" href="#771salt" title='salt' data-ref="771salt" data-ref-filename="771salt">salt</a>, <a class="local col0 ref" href="#770saltlen" title='saltlen' data-ref="770saltlen" data-ref-filename="770saltlen">saltlen</a>);</td></tr>
<tr><th id="2771">2771</th><td>		<b>if</b>(<a class="local col2 ref" href="#772no_exact_ce" title='no_exact_ce' data-ref="772no_exact_ce" data-ref-filename="772no_exact_ce">no_exact_ce</a>) <a class="local col6 ref" href="#766nxproof" title='nxproof' data-ref="766nxproof" data-ref-filename="766nxproof">nxproof</a> = <var>1</var>;</td></tr>
<tr><th id="2772">2772</th><td>		<b>if</b>(!<a class="tu ref fn" href="#az_nsec3_insert" title='az_nsec3_insert' data-use='c' data-ref="az_nsec3_insert" data-ref-filename="az_nsec3_insert">az_nsec3_insert</a>(<a class="local col8 ref" href="#758z" title='z' data-ref="758z" data-ref-filename="758z">z</a>, <a class="local col9 ref" href="#759region" title='region' data-ref="759region" data-ref-filename="759region">region</a>, <a class="local col0 ref" href="#760msg" title='msg' data-ref="760msg" data-ref-filename="760msg">msg</a>, <a class="local col3 ref" href="#773node" title='node' data-ref="773node" data-ref-filename="773node">node</a>))</td></tr>
<tr><th id="2773">2773</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2774">2774</th><td>	}</td></tr>
<tr><th id="2775">2775</th><td></td></tr>
<tr><th id="2776">2776</th><td>	<b>if</b>(<a class="local col6 ref" href="#766nxproof" title='nxproof' data-ref="766nxproof" data-ref-filename="766nxproof">nxproof</a>) {</td></tr>
<tr><th id="2777">2777</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col4 decl" id="774nx" title='nx' data-type='uint8_t *' data-ref="774nx" data-ref-filename="774nx">nx</dfn>;</td></tr>
<tr><th id="2778">2778</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col5 decl" id="775nxlen" title='nxlen' data-type='size_t' data-ref="775nxlen" data-ref-filename="775nxlen">nxlen</dfn>;</td></tr>
<tr><th id="2779">2779</th><td>		<i>/* create nextcloser domain name */</i></td></tr>
<tr><th id="2780">2780</th><td>		<a class="tu ref fn" href="#az_nsec3_get_nextcloser" title='az_nsec3_get_nextcloser' data-use='c' data-ref="az_nsec3_get_nextcloser" data-ref-filename="az_nsec3_get_nextcloser">az_nsec3_get_nextcloser</a>(<a class="local col1 ref" href="#761cenm" title='cenm' data-ref="761cenm" data-ref-filename="761cenm">cenm</a>, <a class="local col3 ref" href="#763qname" title='qname' data-ref="763qname" data-ref-filename="763qname">qname</a>, <a class="local col4 ref" href="#764qname_len" title='qname_len' data-ref="764qname_len" data-ref-filename="764qname_len">qname_len</a>, &amp;<a class="local col4 ref" href="#774nx" title='nx' data-ref="774nx" data-ref-filename="774nx">nx</a>, &amp;<a class="local col5 ref" href="#775nxlen" title='nxlen' data-ref="775nxlen" data-ref-filename="775nxlen">nxlen</a>);</td></tr>
<tr><th id="2781">2781</th><td>		<i>/* find nsec3 that matches or covers it */</i></td></tr>
<tr><th id="2782">2782</th><td>		<a class="local col3 ref" href="#773node" title='node' data-ref="773node" data-ref-filename="773node">node</a> = <a class="tu ref fn" href="#az_nsec3_find_cover" title='az_nsec3_find_cover' data-use='c' data-ref="az_nsec3_find_cover" data-ref-filename="az_nsec3_find_cover">az_nsec3_find_cover</a>(<a class="local col8 ref" href="#758z" title='z' data-ref="758z" data-ref-filename="758z">z</a>, <a class="local col4 ref" href="#774nx" title='nx' data-ref="774nx" data-ref-filename="774nx">nx</a>, <a class="local col5 ref" href="#775nxlen" title='nxlen' data-ref="775nxlen" data-ref-filename="775nxlen">nxlen</a>, <a class="local col8 ref" href="#768algo" title='algo' data-ref="768algo" data-ref-filename="768algo">algo</a>, <a class="local col9 ref" href="#769iter" title='iter' data-ref="769iter" data-ref-filename="769iter">iter</a>, <a class="local col1 ref" href="#771salt" title='salt' data-ref="771salt" data-ref-filename="771salt">salt</a>,</td></tr>
<tr><th id="2783">2783</th><td>			<a class="local col0 ref" href="#770saltlen" title='saltlen' data-ref="770saltlen" data-ref-filename="770saltlen">saltlen</a>);</td></tr>
<tr><th id="2784">2784</th><td>		<b>if</b>(!<a class="tu ref fn" href="#az_nsec3_insert" title='az_nsec3_insert' data-use='c' data-ref="az_nsec3_insert" data-ref-filename="az_nsec3_insert">az_nsec3_insert</a>(<a class="local col8 ref" href="#758z" title='z' data-ref="758z" data-ref-filename="758z">z</a>, <a class="local col9 ref" href="#759region" title='region' data-ref="759region" data-ref-filename="759region">region</a>, <a class="local col0 ref" href="#760msg" title='msg' data-ref="760msg" data-ref-filename="760msg">msg</a>, <a class="local col3 ref" href="#773node" title='node' data-ref="773node" data-ref-filename="773node">node</a>))</td></tr>
<tr><th id="2785">2785</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2786">2786</th><td>	}</td></tr>
<tr><th id="2787">2787</th><td>	<b>if</b>(<a class="local col7 ref" href="#767wcproof" title='wcproof' data-ref="767wcproof" data-ref-filename="767wcproof">wcproof</a>) {</td></tr>
<tr><th id="2788">2788</th><td>		<i>/* create wildcard name *.ce */</i></td></tr>
<tr><th id="2789">2789</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a> <dfn class="local col6 decl" id="776wc" title='wc' data-type='uint8_t [255]' data-ref="776wc" data-ref-filename="776wc">wc</dfn>[<a class="macro" href="../sldns/rrdef.h.html#29" title="255" data-ref="_M/LDNS_MAX_DOMAINLEN">LDNS_MAX_DOMAINLEN</a>];</td></tr>
<tr><th id="2790">2790</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col7 decl" id="777wclen" title='wclen' data-type='size_t' data-ref="777wclen" data-ref-filename="777wclen">wclen</dfn>;</td></tr>
<tr><th id="2791">2791</th><td>		<b>if</b>(<a class="local col2 ref" href="#762cenmlen" title='cenmlen' data-ref="762cenmlen" data-ref-filename="762cenmlen">cenmlen</a>+<var>2</var> &gt; <b>sizeof</b>(<a class="local col6 ref" href="#776wc" title='wc' data-ref="776wc" data-ref-filename="776wc">wc</a>))</td></tr>
<tr><th id="2792">2792</th><td>			<b>return</b> <var>0</var>; <i>/* result would be too long */</i></td></tr>
<tr><th id="2793">2793</th><td>		<a class="local col6 ref" href="#776wc" title='wc' data-ref="776wc" data-ref-filename="776wc">wc</a>[<var>0</var>] = <var>1</var>; <i>/* length of wildcard label */</i></td></tr>
<tr><th id="2794">2794</th><td>		<a class="local col6 ref" href="#776wc" title='wc' data-ref="776wc" data-ref-filename="776wc">wc</a>[<var>1</var>] = (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>)<kbd>'*'</kbd>; <i>/* wildcard label */</i></td></tr>
<tr><th id="2795">2795</th><td>		<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(wc+2, 0) != (size_t)-1) ? __builtin___memmove_chk(wc+2, cenm, cenmlen, __builtin_object_size(wc+2, 0)) : __memmove_ichk(wc+2, cenm, cenmlen))" data-ref="_M/memmove">memmove</a>(<a class="local col6 ref" href="#776wc" title='wc' data-ref="776wc" data-ref-filename="776wc">wc</a>+<var>2</var>, <a class="local col1 ref" href="#761cenm" title='cenm' data-ref="761cenm" data-ref-filename="761cenm">cenm</a>, <a class="local col2 ref" href="#762cenmlen" title='cenmlen' data-ref="762cenmlen" data-ref-filename="762cenmlen">cenmlen</a>);</td></tr>
<tr><th id="2796">2796</th><td>		<a class="local col7 ref" href="#777wclen" title='wclen' data-ref="777wclen" data-ref-filename="777wclen">wclen</a> = <a class="local col2 ref" href="#762cenmlen" title='cenmlen' data-ref="762cenmlen" data-ref-filename="762cenmlen">cenmlen</a>+<var>2</var>;</td></tr>
<tr><th id="2797">2797</th><td>		<i>/* find nsec3 that matches or covers it */</i></td></tr>
<tr><th id="2798">2798</th><td>		<a class="local col3 ref" href="#773node" title='node' data-ref="773node" data-ref-filename="773node">node</a> = <a class="tu ref fn" href="#az_nsec3_find_cover" title='az_nsec3_find_cover' data-use='c' data-ref="az_nsec3_find_cover" data-ref-filename="az_nsec3_find_cover">az_nsec3_find_cover</a>(<a class="local col8 ref" href="#758z" title='z' data-ref="758z" data-ref-filename="758z">z</a>, <a class="local col6 ref" href="#776wc" title='wc' data-ref="776wc" data-ref-filename="776wc">wc</a>, <a class="local col7 ref" href="#777wclen" title='wclen' data-ref="777wclen" data-ref-filename="777wclen">wclen</a>, <a class="local col8 ref" href="#768algo" title='algo' data-ref="768algo" data-ref-filename="768algo">algo</a>, <a class="local col9 ref" href="#769iter" title='iter' data-ref="769iter" data-ref-filename="769iter">iter</a>, <a class="local col1 ref" href="#771salt" title='salt' data-ref="771salt" data-ref-filename="771salt">salt</a>,</td></tr>
<tr><th id="2799">2799</th><td>			<a class="local col0 ref" href="#770saltlen" title='saltlen' data-ref="770saltlen" data-ref-filename="770saltlen">saltlen</a>);</td></tr>
<tr><th id="2800">2800</th><td>		<b>if</b>(!<a class="tu ref fn" href="#az_nsec3_insert" title='az_nsec3_insert' data-use='c' data-ref="az_nsec3_insert" data-ref-filename="az_nsec3_insert">az_nsec3_insert</a>(<a class="local col8 ref" href="#758z" title='z' data-ref="758z" data-ref-filename="758z">z</a>, <a class="local col9 ref" href="#759region" title='region' data-ref="759region" data-ref-filename="759region">region</a>, <a class="local col0 ref" href="#760msg" title='msg' data-ref="760msg" data-ref-filename="760msg">msg</a>, <a class="local col3 ref" href="#773node" title='node' data-ref="773node" data-ref-filename="773node">node</a>))</td></tr>
<tr><th id="2801">2801</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2802">2802</th><td>	}</td></tr>
<tr><th id="2803">2803</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="2804">2804</th><td>}</td></tr>
<tr><th id="2805">2805</th><td></td></tr>
<tr><th id="2806">2806</th><td><i class="doc" data-doc="az_generate_positive_answer">/** generate answer for positive answer */</i></td></tr>
<tr><th id="2807">2807</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="2808">2808</th><td><dfn class="tu decl def fn" id="az_generate_positive_answer" title='az_generate_positive_answer' data-type='int az_generate_positive_answer(struct auth_zone * z, struct regional * region, struct dns_msg * msg, struct auth_data * node, struct auth_rrset * rrset)' data-ref="az_generate_positive_answer" data-ref-filename="az_generate_positive_answer">az_generate_positive_answer</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col8 decl" id="778z" title='z' data-type='struct auth_zone *' data-ref="778z" data-ref-filename="778z">z</dfn>, <b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col9 decl" id="779region" title='region' data-type='struct regional *' data-ref="779region" data-ref-filename="779region">region</dfn>,</td></tr>
<tr><th id="2809">2809</th><td>	<b>struct</b> <a class="type" href="cache/dns.h.html#dns_msg" title='dns_msg' data-ref="dns_msg" data-ref-filename="dns_msg">dns_msg</a>* <dfn class="local col0 decl" id="780msg" title='msg' data-type='struct dns_msg *' data-ref="780msg" data-ref-filename="780msg">msg</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col1 decl" id="781node" title='node' data-type='struct auth_data *' data-ref="781node" data-ref-filename="781node">node</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col2 decl" id="782rrset" title='rrset' data-type='struct auth_rrset *' data-ref="782rrset" data-ref-filename="782rrset">rrset</dfn>)</td></tr>
<tr><th id="2810">2810</th><td>{</td></tr>
<tr><th id="2811">2811</th><td>	<b>if</b>(!<a class="tu ref fn" href="#msg_add_rrset_an" title='msg_add_rrset_an' data-use='c' data-ref="msg_add_rrset_an" data-ref-filename="msg_add_rrset_an">msg_add_rrset_an</a>(<a class="local col8 ref" href="#778z" title='z' data-ref="778z" data-ref-filename="778z">z</a>, <a class="local col9 ref" href="#779region" title='region' data-ref="779region" data-ref-filename="779region">region</a>, <a class="local col0 ref" href="#780msg" title='msg' data-ref="780msg" data-ref-filename="780msg">msg</a>, <a class="local col1 ref" href="#781node" title='node' data-ref="781node" data-ref-filename="781node">node</a>, <a class="local col2 ref" href="#782rrset" title='rrset' data-ref="782rrset" data-ref-filename="782rrset">rrset</a>)) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="2812">2812</th><td>	<i>/* see if we want additional rrs */</i></td></tr>
<tr><th id="2813">2813</th><td>	<b>if</b>(<a class="local col2 ref" href="#782rrset" title='rrset' data-ref="782rrset" data-ref-filename="782rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::type" title='auth_rrset::type' data-ref="auth_rrset::type" data-ref-filename="auth_rrset..type">type</a> == <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_MX" title='LDNS_RR_TYPE_MX' data-ref="LDNS_RR_TYPE_MX" data-ref-filename="LDNS_RR_TYPE_MX">LDNS_RR_TYPE_MX</a>) {</td></tr>
<tr><th id="2814">2814</th><td>		<b>if</b>(!<a class="tu ref fn" href="#az_add_additionals_from" title='az_add_additionals_from' data-use='c' data-ref="az_add_additionals_from" data-ref-filename="az_add_additionals_from">az_add_additionals_from</a>(<a class="local col8 ref" href="#778z" title='z' data-ref="778z" data-ref-filename="778z">z</a>, <a class="local col9 ref" href="#779region" title='region' data-ref="779region" data-ref-filename="779region">region</a>, <a class="local col0 ref" href="#780msg" title='msg' data-ref="780msg" data-ref-filename="780msg">msg</a>, <a class="local col2 ref" href="#782rrset" title='rrset' data-ref="782rrset" data-ref-filename="782rrset">rrset</a>, <var>2</var>))</td></tr>
<tr><th id="2815">2815</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2816">2816</th><td>	} <b>else</b> <b>if</b>(<a class="local col2 ref" href="#782rrset" title='rrset' data-ref="782rrset" data-ref-filename="782rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::type" title='auth_rrset::type' data-ref="auth_rrset::type" data-ref-filename="auth_rrset..type">type</a> == <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_SRV" title='LDNS_RR_TYPE_SRV' data-ref="LDNS_RR_TYPE_SRV" data-ref-filename="LDNS_RR_TYPE_SRV">LDNS_RR_TYPE_SRV</a>) {</td></tr>
<tr><th id="2817">2817</th><td>		<b>if</b>(!<a class="tu ref fn" href="#az_add_additionals_from" title='az_add_additionals_from' data-use='c' data-ref="az_add_additionals_from" data-ref-filename="az_add_additionals_from">az_add_additionals_from</a>(<a class="local col8 ref" href="#778z" title='z' data-ref="778z" data-ref-filename="778z">z</a>, <a class="local col9 ref" href="#779region" title='region' data-ref="779region" data-ref-filename="779region">region</a>, <a class="local col0 ref" href="#780msg" title='msg' data-ref="780msg" data-ref-filename="780msg">msg</a>, <a class="local col2 ref" href="#782rrset" title='rrset' data-ref="782rrset" data-ref-filename="782rrset">rrset</a>, <var>6</var>))</td></tr>
<tr><th id="2818">2818</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2819">2819</th><td>	} <b>else</b> <b>if</b>(<a class="local col2 ref" href="#782rrset" title='rrset' data-ref="782rrset" data-ref-filename="782rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::type" title='auth_rrset::type' data-ref="auth_rrset::type" data-ref-filename="auth_rrset..type">type</a> == <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_NS" title='LDNS_RR_TYPE_NS' data-ref="LDNS_RR_TYPE_NS" data-ref-filename="LDNS_RR_TYPE_NS">LDNS_RR_TYPE_NS</a>) {</td></tr>
<tr><th id="2820">2820</th><td>		<b>if</b>(!<a class="tu ref fn" href="#az_add_additionals_from" title='az_add_additionals_from' data-use='c' data-ref="az_add_additionals_from" data-ref-filename="az_add_additionals_from">az_add_additionals_from</a>(<a class="local col8 ref" href="#778z" title='z' data-ref="778z" data-ref-filename="778z">z</a>, <a class="local col9 ref" href="#779region" title='region' data-ref="779region" data-ref-filename="779region">region</a>, <a class="local col0 ref" href="#780msg" title='msg' data-ref="780msg" data-ref-filename="780msg">msg</a>, <a class="local col2 ref" href="#782rrset" title='rrset' data-ref="782rrset" data-ref-filename="782rrset">rrset</a>, <var>0</var>))</td></tr>
<tr><th id="2821">2821</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2822">2822</th><td>	}</td></tr>
<tr><th id="2823">2823</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="2824">2824</th><td>}</td></tr>
<tr><th id="2825">2825</th><td></td></tr>
<tr><th id="2826">2826</th><td><i class="doc" data-doc="az_generate_any_answer">/** generate answer for type ANY answer */</i></td></tr>
<tr><th id="2827">2827</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="2828">2828</th><td><dfn class="tu decl def fn" id="az_generate_any_answer" title='az_generate_any_answer' data-type='int az_generate_any_answer(struct auth_zone * z, struct regional * region, struct dns_msg * msg, struct auth_data * node)' data-ref="az_generate_any_answer" data-ref-filename="az_generate_any_answer">az_generate_any_answer</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col3 decl" id="783z" title='z' data-type='struct auth_zone *' data-ref="783z" data-ref-filename="783z">z</dfn>, <b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col4 decl" id="784region" title='region' data-type='struct regional *' data-ref="784region" data-ref-filename="784region">region</dfn>,</td></tr>
<tr><th id="2829">2829</th><td>	<b>struct</b> <a class="type" href="cache/dns.h.html#dns_msg" title='dns_msg' data-ref="dns_msg" data-ref-filename="dns_msg">dns_msg</a>* <dfn class="local col5 decl" id="785msg" title='msg' data-type='struct dns_msg *' data-ref="785msg" data-ref-filename="785msg">msg</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col6 decl" id="786node" title='node' data-type='struct auth_data *' data-ref="786node" data-ref-filename="786node">node</dfn>)</td></tr>
<tr><th id="2830">2830</th><td>{</td></tr>
<tr><th id="2831">2831</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col7 decl" id="787rrset" title='rrset' data-type='struct auth_rrset *' data-ref="787rrset" data-ref-filename="787rrset">rrset</dfn>;</td></tr>
<tr><th id="2832">2832</th><td>	<em>int</em> <dfn class="local col8 decl" id="788added" title='added' data-type='int' data-ref="788added" data-ref-filename="788added">added</dfn> = <var>0</var>;</td></tr>
<tr><th id="2833">2833</th><td>	<i>/* add a couple (at least one) RRs */</i></td></tr>
<tr><th id="2834">2834</th><td>	<b>if</b>((<a class="local col7 ref" href="#787rrset" title='rrset' data-ref="787rrset" data-ref-filename="787rrset">rrset</a>=<a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(<a class="local col6 ref" href="#786node" title='node' data-ref="786node" data-ref-filename="786node">node</a>, <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_SOA" title='LDNS_RR_TYPE_SOA' data-ref="LDNS_RR_TYPE_SOA" data-ref-filename="LDNS_RR_TYPE_SOA">LDNS_RR_TYPE_SOA</a>)) != <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="2835">2835</th><td>		<b>if</b>(!<a class="tu ref fn" href="#msg_add_rrset_an" title='msg_add_rrset_an' data-use='c' data-ref="msg_add_rrset_an" data-ref-filename="msg_add_rrset_an">msg_add_rrset_an</a>(<a class="local col3 ref" href="#783z" title='z' data-ref="783z" data-ref-filename="783z">z</a>, <a class="local col4 ref" href="#784region" title='region' data-ref="784region" data-ref-filename="784region">region</a>, <a class="local col5 ref" href="#785msg" title='msg' data-ref="785msg" data-ref-filename="785msg">msg</a>, <a class="local col6 ref" href="#786node" title='node' data-ref="786node" data-ref-filename="786node">node</a>, <a class="local col7 ref" href="#787rrset" title='rrset' data-ref="787rrset" data-ref-filename="787rrset">rrset</a>)) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="2836">2836</th><td>		<a class="local col8 ref" href="#788added" title='added' data-ref="788added" data-ref-filename="788added">added</a>++;</td></tr>
<tr><th id="2837">2837</th><td>	}</td></tr>
<tr><th id="2838">2838</th><td>	<b>if</b>((<a class="local col7 ref" href="#787rrset" title='rrset' data-ref="787rrset" data-ref-filename="787rrset">rrset</a>=<a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(<a class="local col6 ref" href="#786node" title='node' data-ref="786node" data-ref-filename="786node">node</a>, <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_MX" title='LDNS_RR_TYPE_MX' data-ref="LDNS_RR_TYPE_MX" data-ref-filename="LDNS_RR_TYPE_MX">LDNS_RR_TYPE_MX</a>)) != <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="2839">2839</th><td>		<b>if</b>(!<a class="tu ref fn" href="#msg_add_rrset_an" title='msg_add_rrset_an' data-use='c' data-ref="msg_add_rrset_an" data-ref-filename="msg_add_rrset_an">msg_add_rrset_an</a>(<a class="local col3 ref" href="#783z" title='z' data-ref="783z" data-ref-filename="783z">z</a>, <a class="local col4 ref" href="#784region" title='region' data-ref="784region" data-ref-filename="784region">region</a>, <a class="local col5 ref" href="#785msg" title='msg' data-ref="785msg" data-ref-filename="785msg">msg</a>, <a class="local col6 ref" href="#786node" title='node' data-ref="786node" data-ref-filename="786node">node</a>, <a class="local col7 ref" href="#787rrset" title='rrset' data-ref="787rrset" data-ref-filename="787rrset">rrset</a>)) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="2840">2840</th><td>		<a class="local col8 ref" href="#788added" title='added' data-ref="788added" data-ref-filename="788added">added</a>++;</td></tr>
<tr><th id="2841">2841</th><td>	}</td></tr>
<tr><th id="2842">2842</th><td>	<b>if</b>((<a class="local col7 ref" href="#787rrset" title='rrset' data-ref="787rrset" data-ref-filename="787rrset">rrset</a>=<a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(<a class="local col6 ref" href="#786node" title='node' data-ref="786node" data-ref-filename="786node">node</a>, <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_A" title='LDNS_RR_TYPE_A' data-ref="LDNS_RR_TYPE_A" data-ref-filename="LDNS_RR_TYPE_A">LDNS_RR_TYPE_A</a>)) != <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="2843">2843</th><td>		<b>if</b>(!<a class="tu ref fn" href="#msg_add_rrset_an" title='msg_add_rrset_an' data-use='c' data-ref="msg_add_rrset_an" data-ref-filename="msg_add_rrset_an">msg_add_rrset_an</a>(<a class="local col3 ref" href="#783z" title='z' data-ref="783z" data-ref-filename="783z">z</a>, <a class="local col4 ref" href="#784region" title='region' data-ref="784region" data-ref-filename="784region">region</a>, <a class="local col5 ref" href="#785msg" title='msg' data-ref="785msg" data-ref-filename="785msg">msg</a>, <a class="local col6 ref" href="#786node" title='node' data-ref="786node" data-ref-filename="786node">node</a>, <a class="local col7 ref" href="#787rrset" title='rrset' data-ref="787rrset" data-ref-filename="787rrset">rrset</a>)) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="2844">2844</th><td>		<a class="local col8 ref" href="#788added" title='added' data-ref="788added" data-ref-filename="788added">added</a>++;</td></tr>
<tr><th id="2845">2845</th><td>	}</td></tr>
<tr><th id="2846">2846</th><td>	<b>if</b>((<a class="local col7 ref" href="#787rrset" title='rrset' data-ref="787rrset" data-ref-filename="787rrset">rrset</a>=<a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(<a class="local col6 ref" href="#786node" title='node' data-ref="786node" data-ref-filename="786node">node</a>, <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_AAAA" title='LDNS_RR_TYPE_AAAA' data-ref="LDNS_RR_TYPE_AAAA" data-ref-filename="LDNS_RR_TYPE_AAAA">LDNS_RR_TYPE_AAAA</a>)) != <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="2847">2847</th><td>		<b>if</b>(!<a class="tu ref fn" href="#msg_add_rrset_an" title='msg_add_rrset_an' data-use='c' data-ref="msg_add_rrset_an" data-ref-filename="msg_add_rrset_an">msg_add_rrset_an</a>(<a class="local col3 ref" href="#783z" title='z' data-ref="783z" data-ref-filename="783z">z</a>, <a class="local col4 ref" href="#784region" title='region' data-ref="784region" data-ref-filename="784region">region</a>, <a class="local col5 ref" href="#785msg" title='msg' data-ref="785msg" data-ref-filename="785msg">msg</a>, <a class="local col6 ref" href="#786node" title='node' data-ref="786node" data-ref-filename="786node">node</a>, <a class="local col7 ref" href="#787rrset" title='rrset' data-ref="787rrset" data-ref-filename="787rrset">rrset</a>)) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="2848">2848</th><td>		<a class="local col8 ref" href="#788added" title='added' data-ref="788added" data-ref-filename="788added">added</a>++;</td></tr>
<tr><th id="2849">2849</th><td>	}</td></tr>
<tr><th id="2850">2850</th><td>	<b>if</b>(<a class="local col8 ref" href="#788added" title='added' data-ref="788added" data-ref-filename="788added">added</a> == <var>0</var> &amp;&amp; <a class="local col6 ref" href="#786node" title='node' data-ref="786node" data-ref-filename="786node">node</a> &amp;&amp; <a class="local col6 ref" href="#786node" title='node' data-ref="786node" data-ref-filename="786node">node</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::rrsets" title='auth_data::rrsets' data-ref="auth_data::rrsets" data-ref-filename="auth_data..rrsets">rrsets</a>) {</td></tr>
<tr><th id="2851">2851</th><td>		<b>if</b>(!<a class="tu ref fn" href="#msg_add_rrset_an" title='msg_add_rrset_an' data-use='c' data-ref="msg_add_rrset_an" data-ref-filename="msg_add_rrset_an">msg_add_rrset_an</a>(<a class="local col3 ref" href="#783z" title='z' data-ref="783z" data-ref-filename="783z">z</a>, <a class="local col4 ref" href="#784region" title='region' data-ref="784region" data-ref-filename="784region">region</a>, <a class="local col5 ref" href="#785msg" title='msg' data-ref="785msg" data-ref-filename="785msg">msg</a>, <a class="local col6 ref" href="#786node" title='node' data-ref="786node" data-ref-filename="786node">node</a>,</td></tr>
<tr><th id="2852">2852</th><td>			<a class="local col6 ref" href="#786node" title='node' data-ref="786node" data-ref-filename="786node">node</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::rrsets" title='auth_data::rrsets' data-ref="auth_data::rrsets" data-ref-filename="auth_data..rrsets">rrsets</a>)) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="2853">2853</th><td>	}</td></tr>
<tr><th id="2854">2854</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="2855">2855</th><td>}</td></tr>
<tr><th id="2856">2856</th><td></td></tr>
<tr><th id="2857">2857</th><td><i class="doc" data-doc="follow_cname_chain">/** follow cname chain and add more data to the answer section */</i></td></tr>
<tr><th id="2858">2858</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="2859">2859</th><td><dfn class="tu decl def fn" id="follow_cname_chain" title='follow_cname_chain' data-type='int follow_cname_chain(struct auth_zone * z, uint16_t qtype, struct regional * region, struct dns_msg * msg, struct packed_rrset_data * d)' data-ref="follow_cname_chain" data-ref-filename="follow_cname_chain">follow_cname_chain</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col9 decl" id="789z" title='z' data-type='struct auth_zone *' data-ref="789z" data-ref-filename="789z">z</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col0 decl" id="790qtype" title='qtype' data-type='uint16_t' data-ref="790qtype" data-ref-filename="790qtype">qtype</dfn>,</td></tr>
<tr><th id="2860">2860</th><td>	<b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col1 decl" id="791region" title='region' data-type='struct regional *' data-ref="791region" data-ref-filename="791region">region</dfn>, <b>struct</b> <a class="type" href="cache/dns.h.html#dns_msg" title='dns_msg' data-ref="dns_msg" data-ref-filename="dns_msg">dns_msg</a>* <dfn class="local col2 decl" id="792msg" title='msg' data-type='struct dns_msg *' data-ref="792msg" data-ref-filename="792msg">msg</dfn>,</td></tr>
<tr><th id="2861">2861</th><td>	<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>* <dfn class="local col3 decl" id="793d" title='d' data-type='struct packed_rrset_data *' data-ref="793d" data-ref-filename="793d">d</dfn>)</td></tr>
<tr><th id="2862">2862</th><td>{</td></tr>
<tr><th id="2863">2863</th><td>	<em>int</em> <dfn class="local col4 decl" id="794maxchain" title='maxchain' data-type='int' data-ref="794maxchain" data-ref-filename="794maxchain">maxchain</dfn> = <var>0</var>;</td></tr>
<tr><th id="2864">2864</th><td>	<i>/* see if we can add the target of the CNAME into the answer */</i></td></tr>
<tr><th id="2865">2865</th><td>	<b>while</b>(<a class="local col4 ref" href="#794maxchain" title='maxchain' data-ref="794maxchain" data-ref-filename="794maxchain">maxchain</a>++ &lt; <a class="macro" href="#76" title="8" data-ref="_M/MAX_CNAME_CHAIN">MAX_CNAME_CHAIN</a>) {</td></tr>
<tr><th id="2866">2866</th><td>		<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col5 decl" id="795node" title='node' data-type='struct auth_data *' data-ref="795node" data-ref-filename="795node">node</dfn>;</td></tr>
<tr><th id="2867">2867</th><td>		<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col6 decl" id="796rrset" title='rrset' data-type='struct auth_rrset *' data-ref="796rrset" data-ref-filename="796rrset">rrset</dfn>;</td></tr>
<tr><th id="2868">2868</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col7 decl" id="797clen" title='clen' data-type='size_t' data-ref="797clen" data-ref-filename="797clen">clen</dfn>;</td></tr>
<tr><th id="2869">2869</th><td>		<i>/* d has cname rdata */</i></td></tr>
<tr><th id="2870">2870</th><td>		<b>if</b>(<a class="local col3 ref" href="#793d" title='d' data-ref="793d" data-ref-filename="793d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a> == <var>0</var>) <b>break</b>; <i>/* no CNAME */</i></td></tr>
<tr><th id="2871">2871</th><td>		<b>if</b>(<a class="local col3 ref" href="#793d" title='d' data-ref="793d" data-ref-filename="793d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<var>0</var>] &lt; <var>2</var>+<var>1</var>) <b>break</b>; <i>/* too small */</i></td></tr>
<tr><th id="2872">2872</th><td>		<b>if</b>((<a class="local col7 ref" href="#797clen" title='clen' data-ref="797clen" data-ref-filename="797clen">clen</a>=<a class="ref fn" href="../util/data/dname.h.html#dname_valid" title='dname_valid' data-ref="dname_valid" data-ref-filename="dname_valid">dname_valid</a>(<a class="local col3 ref" href="#793d" title='d' data-ref="793d" data-ref-filename="793d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<var>0</var>]+<var>2</var>, <a class="local col3 ref" href="#793d" title='d' data-ref="793d" data-ref-filename="793d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<var>0</var>]-<var>2</var>))==<var>0</var>)</td></tr>
<tr><th id="2873">2873</th><td>			<b>break</b>; <i>/* malformed */</i></td></tr>
<tr><th id="2874">2874</th><td>		<b>if</b>(!<a class="ref fn" href="../util/data/dname.h.html#dname_subdomain_c" title='dname_subdomain_c' data-ref="dname_subdomain_c" data-ref-filename="dname_subdomain_c">dname_subdomain_c</a>(<a class="local col3 ref" href="#793d" title='d' data-ref="793d" data-ref-filename="793d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<var>0</var>]+<var>2</var>, <a class="local col9 ref" href="#789z" title='z' data-ref="789z" data-ref-filename="789z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::name" title='auth_zone::name' data-ref="auth_zone::name" data-ref-filename="auth_zone..name">name</a>))</td></tr>
<tr><th id="2875">2875</th><td>			<b>break</b>; <i>/* target out of zone */</i></td></tr>
<tr><th id="2876">2876</th><td>		<b>if</b>((<a class="local col5 ref" href="#795node" title='node' data-ref="795node" data-ref-filename="795node">node</a> = <a class="tu ref fn" href="#az_find_name" title='az_find_name' data-use='c' data-ref="az_find_name" data-ref-filename="az_find_name">az_find_name</a>(<a class="local col9 ref" href="#789z" title='z' data-ref="789z" data-ref-filename="789z">z</a>, <a class="local col3 ref" href="#793d" title='d' data-ref="793d" data-ref-filename="793d">d</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<var>0</var>]+<var>2</var>, <a class="local col7 ref" href="#797clen" title='clen' data-ref="797clen" data-ref-filename="797clen">clen</a>))==<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>)</td></tr>
<tr><th id="2877">2877</th><td>			<b>break</b>; <i>/* no such target name */</i></td></tr>
<tr><th id="2878">2878</th><td>		<b>if</b>((<a class="local col6 ref" href="#796rrset" title='rrset' data-ref="796rrset" data-ref-filename="796rrset">rrset</a>=<a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(<a class="local col5 ref" href="#795node" title='node' data-ref="795node" data-ref-filename="795node">node</a>, <a class="local col0 ref" href="#790qtype" title='qtype' data-ref="790qtype" data-ref-filename="790qtype">qtype</a>))!=<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="2879">2879</th><td>			<i>/* done we found the target */</i></td></tr>
<tr><th id="2880">2880</th><td>			<b>if</b>(!<a class="tu ref fn" href="#msg_add_rrset_an" title='msg_add_rrset_an' data-use='c' data-ref="msg_add_rrset_an" data-ref-filename="msg_add_rrset_an">msg_add_rrset_an</a>(<a class="local col9 ref" href="#789z" title='z' data-ref="789z" data-ref-filename="789z">z</a>, <a class="local col1 ref" href="#791region" title='region' data-ref="791region" data-ref-filename="791region">region</a>, <a class="local col2 ref" href="#792msg" title='msg' data-ref="792msg" data-ref-filename="792msg">msg</a>, <a class="local col5 ref" href="#795node" title='node' data-ref="795node" data-ref-filename="795node">node</a>, <a class="local col6 ref" href="#796rrset" title='rrset' data-ref="796rrset" data-ref-filename="796rrset">rrset</a>))</td></tr>
<tr><th id="2881">2881</th><td>				<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2882">2882</th><td>			<b>break</b>;</td></tr>
<tr><th id="2883">2883</th><td>		}</td></tr>
<tr><th id="2884">2884</th><td>		<b>if</b>((<a class="local col6 ref" href="#796rrset" title='rrset' data-ref="796rrset" data-ref-filename="796rrset">rrset</a>=<a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(<a class="local col5 ref" href="#795node" title='node' data-ref="795node" data-ref-filename="795node">node</a>, <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_CNAME" title='LDNS_RR_TYPE_CNAME' data-ref="LDNS_RR_TYPE_CNAME" data-ref-filename="LDNS_RR_TYPE_CNAME">LDNS_RR_TYPE_CNAME</a>))==<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>)</td></tr>
<tr><th id="2885">2885</th><td>			<b>break</b>; <i>/* no further CNAME chain, notype */</i></td></tr>
<tr><th id="2886">2886</th><td>		<b>if</b>(!<a class="tu ref fn" href="#msg_add_rrset_an" title='msg_add_rrset_an' data-use='c' data-ref="msg_add_rrset_an" data-ref-filename="msg_add_rrset_an">msg_add_rrset_an</a>(<a class="local col9 ref" href="#789z" title='z' data-ref="789z" data-ref-filename="789z">z</a>, <a class="local col1 ref" href="#791region" title='region' data-ref="791region" data-ref-filename="791region">region</a>, <a class="local col2 ref" href="#792msg" title='msg' data-ref="792msg" data-ref-filename="792msg">msg</a>, <a class="local col5 ref" href="#795node" title='node' data-ref="795node" data-ref-filename="795node">node</a>, <a class="local col6 ref" href="#796rrset" title='rrset' data-ref="796rrset" data-ref-filename="796rrset">rrset</a>)) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="2887">2887</th><td>		<a class="local col3 ref" href="#793d" title='d' data-ref="793d" data-ref-filename="793d">d</a> = <a class="local col6 ref" href="#796rrset" title='rrset' data-ref="796rrset" data-ref-filename="796rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>;</td></tr>
<tr><th id="2888">2888</th><td>	}</td></tr>
<tr><th id="2889">2889</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="2890">2890</th><td>}</td></tr>
<tr><th id="2891">2891</th><td></td></tr>
<tr><th id="2892">2892</th><td><i class="doc" data-doc="az_generate_cname_answer">/** generate answer for cname answer */</i></td></tr>
<tr><th id="2893">2893</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="2894">2894</th><td><dfn class="tu decl def fn" id="az_generate_cname_answer" title='az_generate_cname_answer' data-type='int az_generate_cname_answer(struct auth_zone * z, struct query_info * qinfo, struct regional * region, struct dns_msg * msg, struct auth_data * node, struct auth_rrset * rrset)' data-ref="az_generate_cname_answer" data-ref-filename="az_generate_cname_answer">az_generate_cname_answer</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col8 decl" id="798z" title='z' data-type='struct auth_zone *' data-ref="798z" data-ref-filename="798z">z</dfn>, <b>struct</b> <a class="type" href="../util/data/msgreply.h.html#query_info" title='query_info' data-ref="query_info" data-ref-filename="query_info">query_info</a>* <dfn class="local col9 decl" id="799qinfo" title='qinfo' data-type='struct query_info *' data-ref="799qinfo" data-ref-filename="799qinfo">qinfo</dfn>,</td></tr>
<tr><th id="2895">2895</th><td>	<b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col0 decl" id="800region" title='region' data-type='struct regional *' data-ref="800region" data-ref-filename="800region">region</dfn>, <b>struct</b> <a class="type" href="cache/dns.h.html#dns_msg" title='dns_msg' data-ref="dns_msg" data-ref-filename="dns_msg">dns_msg</a>* <dfn class="local col1 decl" id="801msg" title='msg' data-type='struct dns_msg *' data-ref="801msg" data-ref-filename="801msg">msg</dfn>,</td></tr>
<tr><th id="2896">2896</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col2 decl" id="802node" title='node' data-type='struct auth_data *' data-ref="802node" data-ref-filename="802node">node</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col3 decl" id="803rrset" title='rrset' data-type='struct auth_rrset *' data-ref="803rrset" data-ref-filename="803rrset">rrset</dfn>)</td></tr>
<tr><th id="2897">2897</th><td>{</td></tr>
<tr><th id="2898">2898</th><td>	<b>if</b>(!<a class="tu ref fn" href="#msg_add_rrset_an" title='msg_add_rrset_an' data-use='c' data-ref="msg_add_rrset_an" data-ref-filename="msg_add_rrset_an">msg_add_rrset_an</a>(<a class="local col8 ref" href="#798z" title='z' data-ref="798z" data-ref-filename="798z">z</a>, <a class="local col0 ref" href="#800region" title='region' data-ref="800region" data-ref-filename="800region">region</a>, <a class="local col1 ref" href="#801msg" title='msg' data-ref="801msg" data-ref-filename="801msg">msg</a>, <a class="local col2 ref" href="#802node" title='node' data-ref="802node" data-ref-filename="802node">node</a>, <a class="local col3 ref" href="#803rrset" title='rrset' data-ref="803rrset" data-ref-filename="803rrset">rrset</a>)) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="2899">2899</th><td>	<b>if</b>(!<a class="local col3 ref" href="#803rrset" title='rrset' data-ref="803rrset" data-ref-filename="803rrset">rrset</a>) <b>return</b> <var>1</var>;</td></tr>
<tr><th id="2900">2900</th><td>	<b>if</b>(!<a class="tu ref fn" href="#follow_cname_chain" title='follow_cname_chain' data-use='c' data-ref="follow_cname_chain" data-ref-filename="follow_cname_chain">follow_cname_chain</a>(<a class="local col8 ref" href="#798z" title='z' data-ref="798z" data-ref-filename="798z">z</a>, <a class="local col9 ref" href="#799qinfo" title='qinfo' data-ref="799qinfo" data-ref-filename="799qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qtype" title='query_info::qtype' data-ref="query_info::qtype" data-ref-filename="query_info..qtype">qtype</a>, <a class="local col0 ref" href="#800region" title='region' data-ref="800region" data-ref-filename="800region">region</a>, <a class="local col1 ref" href="#801msg" title='msg' data-ref="801msg" data-ref-filename="801msg">msg</a>, <a class="local col3 ref" href="#803rrset" title='rrset' data-ref="803rrset" data-ref-filename="803rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>))</td></tr>
<tr><th id="2901">2901</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2902">2902</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="2903">2903</th><td>}</td></tr>
<tr><th id="2904">2904</th><td></td></tr>
<tr><th id="2905">2905</th><td><i class="doc" data-doc="az_generate_notype_answer">/** generate answer for notype answer */</i></td></tr>
<tr><th id="2906">2906</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="2907">2907</th><td><dfn class="tu decl def fn" id="az_generate_notype_answer" title='az_generate_notype_answer' data-type='int az_generate_notype_answer(struct auth_zone * z, struct regional * region, struct dns_msg * msg, struct auth_data * node)' data-ref="az_generate_notype_answer" data-ref-filename="az_generate_notype_answer">az_generate_notype_answer</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col4 decl" id="804z" title='z' data-type='struct auth_zone *' data-ref="804z" data-ref-filename="804z">z</dfn>, <b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col5 decl" id="805region" title='region' data-type='struct regional *' data-ref="805region" data-ref-filename="805region">region</dfn>,</td></tr>
<tr><th id="2908">2908</th><td>	<b>struct</b> <a class="type" href="cache/dns.h.html#dns_msg" title='dns_msg' data-ref="dns_msg" data-ref-filename="dns_msg">dns_msg</a>* <dfn class="local col6 decl" id="806msg" title='msg' data-type='struct dns_msg *' data-ref="806msg" data-ref-filename="806msg">msg</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col7 decl" id="807node" title='node' data-type='struct auth_data *' data-ref="807node" data-ref-filename="807node">node</dfn>)</td></tr>
<tr><th id="2909">2909</th><td>{</td></tr>
<tr><th id="2910">2910</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col8 decl" id="808rrset" title='rrset' data-type='struct auth_rrset *' data-ref="808rrset" data-ref-filename="808rrset">rrset</dfn>;</td></tr>
<tr><th id="2911">2911</th><td>	<b>if</b>(!<a class="tu ref fn" href="#az_add_negative_soa" title='az_add_negative_soa' data-use='c' data-ref="az_add_negative_soa" data-ref-filename="az_add_negative_soa">az_add_negative_soa</a>(<a class="local col4 ref" href="#804z" title='z' data-ref="804z" data-ref-filename="804z">z</a>, <a class="local col5 ref" href="#805region" title='region' data-ref="805region" data-ref-filename="805region">region</a>, <a class="local col6 ref" href="#806msg" title='msg' data-ref="806msg" data-ref-filename="806msg">msg</a>)) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="2912">2912</th><td>	<i>/* DNSSEC denial NSEC */</i></td></tr>
<tr><th id="2913">2913</th><td>	<b>if</b>((<a class="local col8 ref" href="#808rrset" title='rrset' data-ref="808rrset" data-ref-filename="808rrset">rrset</a>=<a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(<a class="local col7 ref" href="#807node" title='node' data-ref="807node" data-ref-filename="807node">node</a>, <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_NSEC" title='LDNS_RR_TYPE_NSEC' data-ref="LDNS_RR_TYPE_NSEC" data-ref-filename="LDNS_RR_TYPE_NSEC">LDNS_RR_TYPE_NSEC</a>))!=<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="2914">2914</th><td>		<b>if</b>(!<a class="tu ref fn" href="#msg_add_rrset_ns" title='msg_add_rrset_ns' data-use='c' data-ref="msg_add_rrset_ns" data-ref-filename="msg_add_rrset_ns">msg_add_rrset_ns</a>(<a class="local col4 ref" href="#804z" title='z' data-ref="804z" data-ref-filename="804z">z</a>, <a class="local col5 ref" href="#805region" title='region' data-ref="805region" data-ref-filename="805region">region</a>, <a class="local col6 ref" href="#806msg" title='msg' data-ref="806msg" data-ref-filename="806msg">msg</a>, <a class="local col7 ref" href="#807node" title='node' data-ref="807node" data-ref-filename="807node">node</a>, <a class="local col8 ref" href="#808rrset" title='rrset' data-ref="808rrset" data-ref-filename="808rrset">rrset</a>)) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="2915">2915</th><td>	} <b>else</b> <b>if</b>(<a class="local col7 ref" href="#807node" title='node' data-ref="807node" data-ref-filename="807node">node</a>) {</td></tr>
<tr><th id="2916">2916</th><td>		<i>/* DNSSEC denial NSEC3 */</i></td></tr>
<tr><th id="2917">2917</th><td>		<b>if</b>(!<a class="tu ref fn" href="#az_add_nsec3_proof" title='az_add_nsec3_proof' data-use='c' data-ref="az_add_nsec3_proof" data-ref-filename="az_add_nsec3_proof">az_add_nsec3_proof</a>(<a class="local col4 ref" href="#804z" title='z' data-ref="804z" data-ref-filename="804z">z</a>, <a class="local col5 ref" href="#805region" title='region' data-ref="805region" data-ref-filename="805region">region</a>, <a class="local col6 ref" href="#806msg" title='msg' data-ref="806msg" data-ref-filename="806msg">msg</a>, <a class="local col7 ref" href="#807node" title='node' data-ref="807node" data-ref-filename="807node">node</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::name" title='auth_data::name' data-ref="auth_data::name" data-ref-filename="auth_data..name">name</a>,</td></tr>
<tr><th id="2918">2918</th><td>			<a class="local col7 ref" href="#807node" title='node' data-ref="807node" data-ref-filename="807node">node</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::namelen" title='auth_data::namelen' data-ref="auth_data::namelen" data-ref-filename="auth_data..namelen">namelen</a>, <a class="local col6 ref" href="#806msg" title='msg' data-ref="806msg" data-ref-filename="806msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::qinfo" title='dns_msg::qinfo' data-ref="dns_msg::qinfo" data-ref-filename="dns_msg..qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname" title='query_info::qname' data-ref="query_info::qname" data-ref-filename="query_info..qname">qname</a>,</td></tr>
<tr><th id="2919">2919</th><td>			<a class="local col6 ref" href="#806msg" title='msg' data-ref="806msg" data-ref-filename="806msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::qinfo" title='dns_msg::qinfo' data-ref="dns_msg::qinfo" data-ref-filename="dns_msg..qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname_len" title='query_info::qname_len' data-ref="query_info::qname_len" data-ref-filename="query_info..qname_len">qname_len</a>, <var>1</var>, <var>0</var>, <var>0</var>))</td></tr>
<tr><th id="2920">2920</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2921">2921</th><td>	}</td></tr>
<tr><th id="2922">2922</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="2923">2923</th><td>}</td></tr>
<tr><th id="2924">2924</th><td></td></tr>
<tr><th id="2925">2925</th><td><i class="doc" data-doc="az_generate_referral_answer">/** generate answer for referral answer */</i></td></tr>
<tr><th id="2926">2926</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="2927">2927</th><td><dfn class="tu decl def fn" id="az_generate_referral_answer" title='az_generate_referral_answer' data-type='int az_generate_referral_answer(struct auth_zone * z, struct regional * region, struct dns_msg * msg, struct auth_data * ce, struct auth_rrset * rrset)' data-ref="az_generate_referral_answer" data-ref-filename="az_generate_referral_answer">az_generate_referral_answer</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col9 decl" id="809z" title='z' data-type='struct auth_zone *' data-ref="809z" data-ref-filename="809z">z</dfn>, <b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col0 decl" id="810region" title='region' data-type='struct regional *' data-ref="810region" data-ref-filename="810region">region</dfn>,</td></tr>
<tr><th id="2928">2928</th><td>	<b>struct</b> <a class="type" href="cache/dns.h.html#dns_msg" title='dns_msg' data-ref="dns_msg" data-ref-filename="dns_msg">dns_msg</a>* <dfn class="local col1 decl" id="811msg" title='msg' data-type='struct dns_msg *' data-ref="811msg" data-ref-filename="811msg">msg</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col2 decl" id="812ce" title='ce' data-type='struct auth_data *' data-ref="812ce" data-ref-filename="812ce">ce</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col3 decl" id="813rrset" title='rrset' data-type='struct auth_rrset *' data-ref="813rrset" data-ref-filename="813rrset">rrset</dfn>)</td></tr>
<tr><th id="2929">2929</th><td>{</td></tr>
<tr><th id="2930">2930</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col4 decl" id="814ds" title='ds' data-type='struct auth_rrset *' data-ref="814ds" data-ref-filename="814ds">ds</dfn>, *<dfn class="local col5 decl" id="815nsec" title='nsec' data-type='struct auth_rrset *' data-ref="815nsec" data-ref-filename="815nsec">nsec</dfn>;</td></tr>
<tr><th id="2931">2931</th><td>	<i>/* turn off AA flag, referral is nonAA because it leaves the zone */</i></td></tr>
<tr><th id="2932">2932</th><td>	<a class="macro" href="../util/log.h.html#211" title="" data-ref="_M/log_assert">log_assert</a>(ce);</td></tr>
<tr><th id="2933">2933</th><td>	<a class="local col1 ref" href="#811msg" title='msg' data-ref="811msg" data-ref-filename="811msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::flags" title='reply_info::flags' data-ref="reply_info::flags" data-ref-filename="reply_info..flags">flags</a> &amp;= ~<a class="macro" href="../util/net_help.h.html#69" title="0x0400" data-ref="_M/BIT_AA">BIT_AA</a>;</td></tr>
<tr><th id="2934">2934</th><td>	<b>if</b>(!<a class="tu ref fn" href="#msg_add_rrset_ns" title='msg_add_rrset_ns' data-use='c' data-ref="msg_add_rrset_ns" data-ref-filename="msg_add_rrset_ns">msg_add_rrset_ns</a>(<a class="local col9 ref" href="#809z" title='z' data-ref="809z" data-ref-filename="809z">z</a>, <a class="local col0 ref" href="#810region" title='region' data-ref="810region" data-ref-filename="810region">region</a>, <a class="local col1 ref" href="#811msg" title='msg' data-ref="811msg" data-ref-filename="811msg">msg</a>, <a class="local col2 ref" href="#812ce" title='ce' data-ref="812ce" data-ref-filename="812ce">ce</a>, <a class="local col3 ref" href="#813rrset" title='rrset' data-ref="813rrset" data-ref-filename="813rrset">rrset</a>)) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="2935">2935</th><td>	<i>/* add DS or deny it */</i></td></tr>
<tr><th id="2936">2936</th><td>	<b>if</b>((<a class="local col4 ref" href="#814ds" title='ds' data-ref="814ds" data-ref-filename="814ds">ds</a>=<a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(<a class="local col2 ref" href="#812ce" title='ce' data-ref="812ce" data-ref-filename="812ce">ce</a>, <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_DS" title='LDNS_RR_TYPE_DS' data-ref="LDNS_RR_TYPE_DS" data-ref-filename="LDNS_RR_TYPE_DS">LDNS_RR_TYPE_DS</a>))!=<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="2937">2937</th><td>		<b>if</b>(!<a class="tu ref fn" href="#msg_add_rrset_ns" title='msg_add_rrset_ns' data-use='c' data-ref="msg_add_rrset_ns" data-ref-filename="msg_add_rrset_ns">msg_add_rrset_ns</a>(<a class="local col9 ref" href="#809z" title='z' data-ref="809z" data-ref-filename="809z">z</a>, <a class="local col0 ref" href="#810region" title='region' data-ref="810region" data-ref-filename="810region">region</a>, <a class="local col1 ref" href="#811msg" title='msg' data-ref="811msg" data-ref-filename="811msg">msg</a>, <a class="local col2 ref" href="#812ce" title='ce' data-ref="812ce" data-ref-filename="812ce">ce</a>, <a class="local col4 ref" href="#814ds" title='ds' data-ref="814ds" data-ref-filename="814ds">ds</a>)) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="2938">2938</th><td>	} <b>else</b> {</td></tr>
<tr><th id="2939">2939</th><td>		<i>/* deny the DS */</i></td></tr>
<tr><th id="2940">2940</th><td>		<b>if</b>((<a class="local col5 ref" href="#815nsec" title='nsec' data-ref="815nsec" data-ref-filename="815nsec">nsec</a>=<a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(<a class="local col2 ref" href="#812ce" title='ce' data-ref="812ce" data-ref-filename="812ce">ce</a>, <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_NSEC" title='LDNS_RR_TYPE_NSEC' data-ref="LDNS_RR_TYPE_NSEC" data-ref-filename="LDNS_RR_TYPE_NSEC">LDNS_RR_TYPE_NSEC</a>))!=<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="2941">2941</th><td>			<b>if</b>(!<a class="tu ref fn" href="#msg_add_rrset_ns" title='msg_add_rrset_ns' data-use='c' data-ref="msg_add_rrset_ns" data-ref-filename="msg_add_rrset_ns">msg_add_rrset_ns</a>(<a class="local col9 ref" href="#809z" title='z' data-ref="809z" data-ref-filename="809z">z</a>, <a class="local col0 ref" href="#810region" title='region' data-ref="810region" data-ref-filename="810region">region</a>, <a class="local col1 ref" href="#811msg" title='msg' data-ref="811msg" data-ref-filename="811msg">msg</a>, <a class="local col2 ref" href="#812ce" title='ce' data-ref="812ce" data-ref-filename="812ce">ce</a>, <a class="local col5 ref" href="#815nsec" title='nsec' data-ref="815nsec" data-ref-filename="815nsec">nsec</a>))</td></tr>
<tr><th id="2942">2942</th><td>				<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2943">2943</th><td>		} <b>else</b> {</td></tr>
<tr><th id="2944">2944</th><td>			<b>if</b>(!<a class="tu ref fn" href="#az_add_nsec3_proof" title='az_add_nsec3_proof' data-use='c' data-ref="az_add_nsec3_proof" data-ref-filename="az_add_nsec3_proof">az_add_nsec3_proof</a>(<a class="local col9 ref" href="#809z" title='z' data-ref="809z" data-ref-filename="809z">z</a>, <a class="local col0 ref" href="#810region" title='region' data-ref="810region" data-ref-filename="810region">region</a>, <a class="local col1 ref" href="#811msg" title='msg' data-ref="811msg" data-ref-filename="811msg">msg</a>, <a class="local col2 ref" href="#812ce" title='ce' data-ref="812ce" data-ref-filename="812ce">ce</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::name" title='auth_data::name' data-ref="auth_data::name" data-ref-filename="auth_data..name">name</a>,</td></tr>
<tr><th id="2945">2945</th><td>				<a class="local col2 ref" href="#812ce" title='ce' data-ref="812ce" data-ref-filename="812ce">ce</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::namelen" title='auth_data::namelen' data-ref="auth_data::namelen" data-ref-filename="auth_data..namelen">namelen</a>, <a class="local col1 ref" href="#811msg" title='msg' data-ref="811msg" data-ref-filename="811msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::qinfo" title='dns_msg::qinfo' data-ref="dns_msg::qinfo" data-ref-filename="dns_msg..qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname" title='query_info::qname' data-ref="query_info::qname" data-ref-filename="query_info..qname">qname</a>,</td></tr>
<tr><th id="2946">2946</th><td>				<a class="local col1 ref" href="#811msg" title='msg' data-ref="811msg" data-ref-filename="811msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::qinfo" title='dns_msg::qinfo' data-ref="dns_msg::qinfo" data-ref-filename="dns_msg..qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname_len" title='query_info::qname_len' data-ref="query_info::qname_len" data-ref-filename="query_info..qname_len">qname_len</a>, <var>1</var>, <var>0</var>, <var>0</var>))</td></tr>
<tr><th id="2947">2947</th><td>				<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2948">2948</th><td>		}</td></tr>
<tr><th id="2949">2949</th><td>	}</td></tr>
<tr><th id="2950">2950</th><td>	<i>/* add additional rrs for type NS */</i></td></tr>
<tr><th id="2951">2951</th><td>	<b>if</b>(!<a class="tu ref fn" href="#az_add_additionals_from" title='az_add_additionals_from' data-use='c' data-ref="az_add_additionals_from" data-ref-filename="az_add_additionals_from">az_add_additionals_from</a>(<a class="local col9 ref" href="#809z" title='z' data-ref="809z" data-ref-filename="809z">z</a>, <a class="local col0 ref" href="#810region" title='region' data-ref="810region" data-ref-filename="810region">region</a>, <a class="local col1 ref" href="#811msg" title='msg' data-ref="811msg" data-ref-filename="811msg">msg</a>, <a class="local col3 ref" href="#813rrset" title='rrset' data-ref="813rrset" data-ref-filename="813rrset">rrset</a>, <var>0</var>)) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="2952">2952</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="2953">2953</th><td>}</td></tr>
<tr><th id="2954">2954</th><td></td></tr>
<tr><th id="2955">2955</th><td><i class="doc" data-doc="az_generate_dname_answer">/** generate answer for DNAME answer */</i></td></tr>
<tr><th id="2956">2956</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="2957">2957</th><td><dfn class="tu decl def fn" id="az_generate_dname_answer" title='az_generate_dname_answer' data-type='int az_generate_dname_answer(struct auth_zone * z, struct query_info * qinfo, struct regional * region, struct dns_msg * msg, struct auth_data * ce, struct auth_rrset * rrset)' data-ref="az_generate_dname_answer" data-ref-filename="az_generate_dname_answer">az_generate_dname_answer</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col6 decl" id="816z" title='z' data-type='struct auth_zone *' data-ref="816z" data-ref-filename="816z">z</dfn>, <b>struct</b> <a class="type" href="../util/data/msgreply.h.html#query_info" title='query_info' data-ref="query_info" data-ref-filename="query_info">query_info</a>* <dfn class="local col7 decl" id="817qinfo" title='qinfo' data-type='struct query_info *' data-ref="817qinfo" data-ref-filename="817qinfo">qinfo</dfn>,</td></tr>
<tr><th id="2958">2958</th><td>	<b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col8 decl" id="818region" title='region' data-type='struct regional *' data-ref="818region" data-ref-filename="818region">region</dfn>, <b>struct</b> <a class="type" href="cache/dns.h.html#dns_msg" title='dns_msg' data-ref="dns_msg" data-ref-filename="dns_msg">dns_msg</a>* <dfn class="local col9 decl" id="819msg" title='msg' data-type='struct dns_msg *' data-ref="819msg" data-ref-filename="819msg">msg</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col0 decl" id="820ce" title='ce' data-type='struct auth_data *' data-ref="820ce" data-ref-filename="820ce">ce</dfn>,</td></tr>
<tr><th id="2959">2959</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col1 decl" id="821rrset" title='rrset' data-type='struct auth_rrset *' data-ref="821rrset" data-ref-filename="821rrset">rrset</dfn>)</td></tr>
<tr><th id="2960">2960</th><td>{</td></tr>
<tr><th id="2961">2961</th><td>	<a class="macro" href="../util/log.h.html#211" title="" data-ref="_M/log_assert">log_assert</a>(ce);</td></tr>
<tr><th id="2962">2962</th><td>	<i>/* add the DNAME and then a CNAME */</i></td></tr>
<tr><th id="2963">2963</th><td>	<b>if</b>(!<a class="tu ref fn" href="#msg_add_rrset_an" title='msg_add_rrset_an' data-use='c' data-ref="msg_add_rrset_an" data-ref-filename="msg_add_rrset_an">msg_add_rrset_an</a>(<a class="local col6 ref" href="#816z" title='z' data-ref="816z" data-ref-filename="816z">z</a>, <a class="local col8 ref" href="#818region" title='region' data-ref="818region" data-ref-filename="818region">region</a>, <a class="local col9 ref" href="#819msg" title='msg' data-ref="819msg" data-ref-filename="819msg">msg</a>, <a class="local col0 ref" href="#820ce" title='ce' data-ref="820ce" data-ref-filename="820ce">ce</a>, <a class="local col1 ref" href="#821rrset" title='rrset' data-ref="821rrset" data-ref-filename="821rrset">rrset</a>)) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="2964">2964</th><td>	<b>if</b>(!<a class="tu ref fn" href="#add_synth_cname" title='add_synth_cname' data-use='c' data-ref="add_synth_cname" data-ref-filename="add_synth_cname">add_synth_cname</a>(<a class="local col6 ref" href="#816z" title='z' data-ref="816z" data-ref-filename="816z">z</a>, <a class="local col7 ref" href="#817qinfo" title='qinfo' data-ref="817qinfo" data-ref-filename="817qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname" title='query_info::qname' data-ref="query_info::qname" data-ref-filename="query_info..qname">qname</a>, <a class="local col7 ref" href="#817qinfo" title='qinfo' data-ref="817qinfo" data-ref-filename="817qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname_len" title='query_info::qname_len' data-ref="query_info::qname_len" data-ref-filename="query_info..qname_len">qname_len</a>, <a class="local col8 ref" href="#818region" title='region' data-ref="818region" data-ref-filename="818region">region</a>,</td></tr>
<tr><th id="2965">2965</th><td>		<a class="local col9 ref" href="#819msg" title='msg' data-ref="819msg" data-ref-filename="819msg">msg</a>, <a class="local col0 ref" href="#820ce" title='ce' data-ref="820ce" data-ref-filename="820ce">ce</a>, <a class="local col1 ref" href="#821rrset" title='rrset' data-ref="821rrset" data-ref-filename="821rrset">rrset</a>)) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="2966">2966</th><td>	<b>if</b>(<a class="macro" href="../util/net_help.h.html#73" title="((msg-&gt;rep-&gt;flags) &amp; 0xf)" data-ref="_M/FLAGS_GET_RCODE">FLAGS_GET_RCODE</a>(<a class="local col9 ref" href="#819msg" title='msg' data-ref="819msg" data-ref-filename="819msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::flags" title='reply_info::flags' data-ref="reply_info::flags" data-ref-filename="reply_info..flags">flags</a>) == <a class="enum" href="../sldns/pkthdr.h.html#LDNS_RCODE_YXDOMAIN" title='LDNS_RCODE_YXDOMAIN' data-ref="LDNS_RCODE_YXDOMAIN" data-ref-filename="LDNS_RCODE_YXDOMAIN">LDNS_RCODE_YXDOMAIN</a>)</td></tr>
<tr><th id="2967">2967</th><td>		<b>return</b> <var>1</var>;</td></tr>
<tr><th id="2968">2968</th><td>	<b>if</b>(<a class="local col9 ref" href="#819msg" title='msg' data-ref="819msg" data-ref-filename="819msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrset_count" title='reply_info::rrset_count' data-ref="reply_info::rrset_count" data-ref-filename="reply_info..rrset_count">rrset_count</a> == <var>0</var> ||</td></tr>
<tr><th id="2969">2969</th><td>		!<a class="local col9 ref" href="#819msg" title='msg' data-ref="819msg" data-ref-filename="819msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrsets" title='reply_info::rrsets' data-ref="reply_info::rrsets" data-ref-filename="reply_info..rrsets">rrsets</a>[<a class="local col9 ref" href="#819msg" title='msg' data-ref="819msg" data-ref-filename="819msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrset_count" title='reply_info::rrset_count' data-ref="reply_info::rrset_count" data-ref-filename="reply_info..rrset_count">rrset_count</a>-<var>1</var>])</td></tr>
<tr><th id="2970">2970</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2971">2971</th><td>	<b>if</b>(!<a class="tu ref fn" href="#follow_cname_chain" title='follow_cname_chain' data-use='c' data-ref="follow_cname_chain" data-ref-filename="follow_cname_chain">follow_cname_chain</a>(<a class="local col6 ref" href="#816z" title='z' data-ref="816z" data-ref-filename="816z">z</a>, <a class="local col7 ref" href="#817qinfo" title='qinfo' data-ref="817qinfo" data-ref-filename="817qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qtype" title='query_info::qtype' data-ref="query_info::qtype" data-ref-filename="query_info..qtype">qtype</a>, <a class="local col8 ref" href="#818region" title='region' data-ref="818region" data-ref-filename="818region">region</a>, <a class="local col9 ref" href="#819msg" title='msg' data-ref="819msg" data-ref-filename="819msg">msg</a>, </td></tr>
<tr><th id="2972">2972</th><td>		(<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>*)<a class="local col9 ref" href="#819msg" title='msg' data-ref="819msg" data-ref-filename="819msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrsets" title='reply_info::rrsets' data-ref="reply_info::rrsets" data-ref-filename="reply_info..rrsets">rrsets</a>[</td></tr>
<tr><th id="2973">2973</th><td>		<a class="local col9 ref" href="#819msg" title='msg' data-ref="819msg" data-ref-filename="819msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::rrset_count" title='reply_info::rrset_count' data-ref="reply_info::rrset_count" data-ref-filename="reply_info..rrset_count">rrset_count</a>-<var>1</var>]-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key::entry" title='ub_packed_rrset_key::entry' data-ref="ub_packed_rrset_key::entry" data-ref-filename="ub_packed_rrset_key..entry">entry</a>.<a class="ref field" href="../util/storage/lruhash.h.html#lruhash_entry::data" title='lruhash_entry::data' data-ref="lruhash_entry::data" data-ref-filename="lruhash_entry..data">data</a>))</td></tr>
<tr><th id="2974">2974</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2975">2975</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="2976">2976</th><td>}</td></tr>
<tr><th id="2977">2977</th><td></td></tr>
<tr><th id="2978">2978</th><td><i class="doc" data-doc="az_generate_wildcard_answer">/** generate answer for wildcard answer */</i></td></tr>
<tr><th id="2979">2979</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="2980">2980</th><td><dfn class="tu decl def fn" id="az_generate_wildcard_answer" title='az_generate_wildcard_answer' data-type='int az_generate_wildcard_answer(struct auth_zone * z, struct query_info * qinfo, struct regional * region, struct dns_msg * msg, struct auth_data * ce, struct auth_data * wildcard, struct auth_data * node)' data-ref="az_generate_wildcard_answer" data-ref-filename="az_generate_wildcard_answer">az_generate_wildcard_answer</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col2 decl" id="822z" title='z' data-type='struct auth_zone *' data-ref="822z" data-ref-filename="822z">z</dfn>, <b>struct</b> <a class="type" href="../util/data/msgreply.h.html#query_info" title='query_info' data-ref="query_info" data-ref-filename="query_info">query_info</a>* <dfn class="local col3 decl" id="823qinfo" title='qinfo' data-type='struct query_info *' data-ref="823qinfo" data-ref-filename="823qinfo">qinfo</dfn>,</td></tr>
<tr><th id="2981">2981</th><td>	<b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col4 decl" id="824region" title='region' data-type='struct regional *' data-ref="824region" data-ref-filename="824region">region</dfn>, <b>struct</b> <a class="type" href="cache/dns.h.html#dns_msg" title='dns_msg' data-ref="dns_msg" data-ref-filename="dns_msg">dns_msg</a>* <dfn class="local col5 decl" id="825msg" title='msg' data-type='struct dns_msg *' data-ref="825msg" data-ref-filename="825msg">msg</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col6 decl" id="826ce" title='ce' data-type='struct auth_data *' data-ref="826ce" data-ref-filename="826ce">ce</dfn>,</td></tr>
<tr><th id="2982">2982</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col7 decl" id="827wildcard" title='wildcard' data-type='struct auth_data *' data-ref="827wildcard" data-ref-filename="827wildcard">wildcard</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col8 decl" id="828node" title='node' data-type='struct auth_data *' data-ref="828node" data-ref-filename="828node">node</dfn>)</td></tr>
<tr><th id="2983">2983</th><td>{</td></tr>
<tr><th id="2984">2984</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col9 decl" id="829rrset" title='rrset' data-type='struct auth_rrset *' data-ref="829rrset" data-ref-filename="829rrset">rrset</dfn>, *<dfn class="local col0 decl" id="830nsec" title='nsec' data-type='struct auth_rrset *' data-ref="830nsec" data-ref-filename="830nsec">nsec</dfn>;</td></tr>
<tr><th id="2985">2985</th><td>	<b>if</b>((<a class="local col9 ref" href="#829rrset" title='rrset' data-ref="829rrset" data-ref-filename="829rrset">rrset</a>=<a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(<a class="local col7 ref" href="#827wildcard" title='wildcard' data-ref="827wildcard" data-ref-filename="827wildcard">wildcard</a>, <a class="local col3 ref" href="#823qinfo" title='qinfo' data-ref="823qinfo" data-ref-filename="823qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qtype" title='query_info::qtype' data-ref="query_info::qtype" data-ref-filename="query_info..qtype">qtype</a>)) != <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="2986">2986</th><td>		<i>/* wildcard has type, add it */</i></td></tr>
<tr><th id="2987">2987</th><td>		<b>if</b>(!<a class="tu ref fn" href="#msg_add_rrset_an" title='msg_add_rrset_an' data-use='c' data-ref="msg_add_rrset_an" data-ref-filename="msg_add_rrset_an">msg_add_rrset_an</a>(<a class="local col2 ref" href="#822z" title='z' data-ref="822z" data-ref-filename="822z">z</a>, <a class="local col4 ref" href="#824region" title='region' data-ref="824region" data-ref-filename="824region">region</a>, <a class="local col5 ref" href="#825msg" title='msg' data-ref="825msg" data-ref-filename="825msg">msg</a>, <a class="local col7 ref" href="#827wildcard" title='wildcard' data-ref="827wildcard" data-ref-filename="827wildcard">wildcard</a>, <a class="local col9 ref" href="#829rrset" title='rrset' data-ref="829rrset" data-ref-filename="829rrset">rrset</a>))</td></tr>
<tr><th id="2988">2988</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2989">2989</th><td>		<a class="tu ref fn" href="#az_change_dnames" title='az_change_dnames' data-use='c' data-ref="az_change_dnames" data-ref-filename="az_change_dnames">az_change_dnames</a>(<a class="local col5 ref" href="#825msg" title='msg' data-ref="825msg" data-ref-filename="825msg">msg</a>, <a class="local col7 ref" href="#827wildcard" title='wildcard' data-ref="827wildcard" data-ref-filename="827wildcard">wildcard</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::name" title='auth_data::name' data-ref="auth_data::name" data-ref-filename="auth_data..name">name</a>, <a class="local col5 ref" href="#825msg" title='msg' data-ref="825msg" data-ref-filename="825msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::qinfo" title='dns_msg::qinfo' data-ref="dns_msg::qinfo" data-ref-filename="dns_msg..qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname" title='query_info::qname' data-ref="query_info::qname" data-ref-filename="query_info..qname">qname</a>,</td></tr>
<tr><th id="2990">2990</th><td>			<a class="local col5 ref" href="#825msg" title='msg' data-ref="825msg" data-ref-filename="825msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::qinfo" title='dns_msg::qinfo' data-ref="dns_msg::qinfo" data-ref-filename="dns_msg..qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname_len" title='query_info::qname_len' data-ref="query_info::qname_len" data-ref-filename="query_info..qname_len">qname_len</a>, <var>1</var>);</td></tr>
<tr><th id="2991">2991</th><td>	} <b>else</b> <b>if</b>((<a class="local col9 ref" href="#829rrset" title='rrset' data-ref="829rrset" data-ref-filename="829rrset">rrset</a>=<a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(<a class="local col7 ref" href="#827wildcard" title='wildcard' data-ref="827wildcard" data-ref-filename="827wildcard">wildcard</a>, <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_CNAME" title='LDNS_RR_TYPE_CNAME' data-ref="LDNS_RR_TYPE_CNAME" data-ref-filename="LDNS_RR_TYPE_CNAME">LDNS_RR_TYPE_CNAME</a>))!=<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="2992">2992</th><td>		<i>/* wildcard has cname instead, do that */</i></td></tr>
<tr><th id="2993">2993</th><td>		<b>if</b>(!<a class="tu ref fn" href="#msg_add_rrset_an" title='msg_add_rrset_an' data-use='c' data-ref="msg_add_rrset_an" data-ref-filename="msg_add_rrset_an">msg_add_rrset_an</a>(<a class="local col2 ref" href="#822z" title='z' data-ref="822z" data-ref-filename="822z">z</a>, <a class="local col4 ref" href="#824region" title='region' data-ref="824region" data-ref-filename="824region">region</a>, <a class="local col5 ref" href="#825msg" title='msg' data-ref="825msg" data-ref-filename="825msg">msg</a>, <a class="local col7 ref" href="#827wildcard" title='wildcard' data-ref="827wildcard" data-ref-filename="827wildcard">wildcard</a>, <a class="local col9 ref" href="#829rrset" title='rrset' data-ref="829rrset" data-ref-filename="829rrset">rrset</a>))</td></tr>
<tr><th id="2994">2994</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2995">2995</th><td>		<a class="tu ref fn" href="#az_change_dnames" title='az_change_dnames' data-use='c' data-ref="az_change_dnames" data-ref-filename="az_change_dnames">az_change_dnames</a>(<a class="local col5 ref" href="#825msg" title='msg' data-ref="825msg" data-ref-filename="825msg">msg</a>, <a class="local col7 ref" href="#827wildcard" title='wildcard' data-ref="827wildcard" data-ref-filename="827wildcard">wildcard</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::name" title='auth_data::name' data-ref="auth_data::name" data-ref-filename="auth_data..name">name</a>, <a class="local col5 ref" href="#825msg" title='msg' data-ref="825msg" data-ref-filename="825msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::qinfo" title='dns_msg::qinfo' data-ref="dns_msg::qinfo" data-ref-filename="dns_msg..qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname" title='query_info::qname' data-ref="query_info::qname" data-ref-filename="query_info..qname">qname</a>,</td></tr>
<tr><th id="2996">2996</th><td>			<a class="local col5 ref" href="#825msg" title='msg' data-ref="825msg" data-ref-filename="825msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::qinfo" title='dns_msg::qinfo' data-ref="dns_msg::qinfo" data-ref-filename="dns_msg..qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname_len" title='query_info::qname_len' data-ref="query_info::qname_len" data-ref-filename="query_info..qname_len">qname_len</a>, <var>1</var>);</td></tr>
<tr><th id="2997">2997</th><td>		<b>if</b>(!<a class="tu ref fn" href="#follow_cname_chain" title='follow_cname_chain' data-use='c' data-ref="follow_cname_chain" data-ref-filename="follow_cname_chain">follow_cname_chain</a>(<a class="local col2 ref" href="#822z" title='z' data-ref="822z" data-ref-filename="822z">z</a>, <a class="local col3 ref" href="#823qinfo" title='qinfo' data-ref="823qinfo" data-ref-filename="823qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qtype" title='query_info::qtype' data-ref="query_info::qtype" data-ref-filename="query_info..qtype">qtype</a>, <a class="local col4 ref" href="#824region" title='region' data-ref="824region" data-ref-filename="824region">region</a>, <a class="local col5 ref" href="#825msg" title='msg' data-ref="825msg" data-ref-filename="825msg">msg</a>,</td></tr>
<tr><th id="2998">2998</th><td>			<a class="local col9 ref" href="#829rrset" title='rrset' data-ref="829rrset" data-ref-filename="829rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::data" title='auth_rrset::data' data-ref="auth_rrset::data" data-ref-filename="auth_rrset..data">data</a>))</td></tr>
<tr><th id="2999">2999</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3000">3000</th><td>	} <b>else</b> <b>if</b>(<a class="local col3 ref" href="#823qinfo" title='qinfo' data-ref="823qinfo" data-ref-filename="823qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qtype" title='query_info::qtype' data-ref="query_info::qtype" data-ref-filename="query_info..qtype">qtype</a> == <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_ANY" title='LDNS_RR_TYPE_ANY' data-ref="LDNS_RR_TYPE_ANY" data-ref-filename="LDNS_RR_TYPE_ANY">LDNS_RR_TYPE_ANY</a> &amp;&amp; <a class="local col7 ref" href="#827wildcard" title='wildcard' data-ref="827wildcard" data-ref-filename="827wildcard">wildcard</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::rrsets" title='auth_data::rrsets' data-ref="auth_data::rrsets" data-ref-filename="auth_data..rrsets">rrsets</a>) {</td></tr>
<tr><th id="3001">3001</th><td>		<i>/* add ANY rrsets from wildcard node */</i></td></tr>
<tr><th id="3002">3002</th><td>		<b>if</b>(!<a class="tu ref fn" href="#az_generate_any_answer" title='az_generate_any_answer' data-use='c' data-ref="az_generate_any_answer" data-ref-filename="az_generate_any_answer">az_generate_any_answer</a>(<a class="local col2 ref" href="#822z" title='z' data-ref="822z" data-ref-filename="822z">z</a>, <a class="local col4 ref" href="#824region" title='region' data-ref="824region" data-ref-filename="824region">region</a>, <a class="local col5 ref" href="#825msg" title='msg' data-ref="825msg" data-ref-filename="825msg">msg</a>, <a class="local col7 ref" href="#827wildcard" title='wildcard' data-ref="827wildcard" data-ref-filename="827wildcard">wildcard</a>))</td></tr>
<tr><th id="3003">3003</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3004">3004</th><td>		<a class="tu ref fn" href="#az_change_dnames" title='az_change_dnames' data-use='c' data-ref="az_change_dnames" data-ref-filename="az_change_dnames">az_change_dnames</a>(<a class="local col5 ref" href="#825msg" title='msg' data-ref="825msg" data-ref-filename="825msg">msg</a>, <a class="local col7 ref" href="#827wildcard" title='wildcard' data-ref="827wildcard" data-ref-filename="827wildcard">wildcard</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::name" title='auth_data::name' data-ref="auth_data::name" data-ref-filename="auth_data..name">name</a>, <a class="local col5 ref" href="#825msg" title='msg' data-ref="825msg" data-ref-filename="825msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::qinfo" title='dns_msg::qinfo' data-ref="dns_msg::qinfo" data-ref-filename="dns_msg..qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname" title='query_info::qname' data-ref="query_info::qname" data-ref-filename="query_info..qname">qname</a>,</td></tr>
<tr><th id="3005">3005</th><td>			<a class="local col5 ref" href="#825msg" title='msg' data-ref="825msg" data-ref-filename="825msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::qinfo" title='dns_msg::qinfo' data-ref="dns_msg::qinfo" data-ref-filename="dns_msg..qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname_len" title='query_info::qname_len' data-ref="query_info::qname_len" data-ref-filename="query_info..qname_len">qname_len</a>, <var>1</var>);</td></tr>
<tr><th id="3006">3006</th><td>	} <b>else</b> {</td></tr>
<tr><th id="3007">3007</th><td>		<i>/* wildcard has nodata, notype answer */</i></td></tr>
<tr><th id="3008">3008</th><td>		<i>/* call other notype routine for dnssec notype denials */</i></td></tr>
<tr><th id="3009">3009</th><td>		<b>if</b>(!<a class="tu ref fn" href="#az_generate_notype_answer" title='az_generate_notype_answer' data-use='c' data-ref="az_generate_notype_answer" data-ref-filename="az_generate_notype_answer">az_generate_notype_answer</a>(<a class="local col2 ref" href="#822z" title='z' data-ref="822z" data-ref-filename="822z">z</a>, <a class="local col4 ref" href="#824region" title='region' data-ref="824region" data-ref-filename="824region">region</a>, <a class="local col5 ref" href="#825msg" title='msg' data-ref="825msg" data-ref-filename="825msg">msg</a>, <a class="local col7 ref" href="#827wildcard" title='wildcard' data-ref="827wildcard" data-ref-filename="827wildcard">wildcard</a>))</td></tr>
<tr><th id="3010">3010</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3011">3011</th><td>	}</td></tr>
<tr><th id="3012">3012</th><td></td></tr>
<tr><th id="3013">3013</th><td>	<i>/* ce and node for dnssec denial of wildcard original name */</i></td></tr>
<tr><th id="3014">3014</th><td>	<b>if</b>((<a class="local col0 ref" href="#830nsec" title='nsec' data-ref="830nsec" data-ref-filename="830nsec">nsec</a>=<a class="tu ref fn" href="#az_find_nsec_cover" title='az_find_nsec_cover' data-use='c' data-ref="az_find_nsec_cover" data-ref-filename="az_find_nsec_cover">az_find_nsec_cover</a>(<a class="local col2 ref" href="#822z" title='z' data-ref="822z" data-ref-filename="822z">z</a>, &amp;<a class="local col8 ref" href="#828node" title='node' data-ref="828node" data-ref-filename="828node">node</a>)) != <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="3015">3015</th><td>		<b>if</b>(!<a class="tu ref fn" href="#msg_add_rrset_ns" title='msg_add_rrset_ns' data-use='c' data-ref="msg_add_rrset_ns" data-ref-filename="msg_add_rrset_ns">msg_add_rrset_ns</a>(<a class="local col2 ref" href="#822z" title='z' data-ref="822z" data-ref-filename="822z">z</a>, <a class="local col4 ref" href="#824region" title='region' data-ref="824region" data-ref-filename="824region">region</a>, <a class="local col5 ref" href="#825msg" title='msg' data-ref="825msg" data-ref-filename="825msg">msg</a>, <a class="local col8 ref" href="#828node" title='node' data-ref="828node" data-ref-filename="828node">node</a>, <a class="local col0 ref" href="#830nsec" title='nsec' data-ref="830nsec" data-ref-filename="830nsec">nsec</a>)) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="3016">3016</th><td>	} <b>else</b> <b>if</b>(<a class="local col6 ref" href="#826ce" title='ce' data-ref="826ce" data-ref-filename="826ce">ce</a>) {</td></tr>
<tr><th id="3017">3017</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col1 decl" id="831wildup" title='wildup' data-type='uint8_t *' data-ref="831wildup" data-ref-filename="831wildup">wildup</dfn> = <a class="local col7 ref" href="#827wildcard" title='wildcard' data-ref="827wildcard" data-ref-filename="827wildcard">wildcard</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::name" title='auth_data::name' data-ref="auth_data::name" data-ref-filename="auth_data..name">name</a>;</td></tr>
<tr><th id="3018">3018</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col2 decl" id="832wilduplen" title='wilduplen' data-type='size_t' data-ref="832wilduplen" data-ref-filename="832wilduplen">wilduplen</dfn>= <a class="local col7 ref" href="#827wildcard" title='wildcard' data-ref="827wildcard" data-ref-filename="827wildcard">wildcard</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::namelen" title='auth_data::namelen' data-ref="auth_data::namelen" data-ref-filename="auth_data..namelen">namelen</a>;</td></tr>
<tr><th id="3019">3019</th><td>		<a class="ref fn" href="../util/data/dname.h.html#dname_remove_label" title='dname_remove_label' data-ref="dname_remove_label" data-ref-filename="dname_remove_label">dname_remove_label</a>(&amp;<a class="local col1 ref" href="#831wildup" title='wildup' data-ref="831wildup" data-ref-filename="831wildup">wildup</a>, &amp;<a class="local col2 ref" href="#832wilduplen" title='wilduplen' data-ref="832wilduplen" data-ref-filename="832wilduplen">wilduplen</a>);</td></tr>
<tr><th id="3020">3020</th><td>		<b>if</b>(!<a class="tu ref fn" href="#az_add_nsec3_proof" title='az_add_nsec3_proof' data-use='c' data-ref="az_add_nsec3_proof" data-ref-filename="az_add_nsec3_proof">az_add_nsec3_proof</a>(<a class="local col2 ref" href="#822z" title='z' data-ref="822z" data-ref-filename="822z">z</a>, <a class="local col4 ref" href="#824region" title='region' data-ref="824region" data-ref-filename="824region">region</a>, <a class="local col5 ref" href="#825msg" title='msg' data-ref="825msg" data-ref-filename="825msg">msg</a>, <a class="local col1 ref" href="#831wildup" title='wildup' data-ref="831wildup" data-ref-filename="831wildup">wildup</a>,</td></tr>
<tr><th id="3021">3021</th><td>			<a class="local col2 ref" href="#832wilduplen" title='wilduplen' data-ref="832wilduplen" data-ref-filename="832wilduplen">wilduplen</a>, <a class="local col5 ref" href="#825msg" title='msg' data-ref="825msg" data-ref-filename="825msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::qinfo" title='dns_msg::qinfo' data-ref="dns_msg::qinfo" data-ref-filename="dns_msg..qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname" title='query_info::qname' data-ref="query_info::qname" data-ref-filename="query_info..qname">qname</a>,</td></tr>
<tr><th id="3022">3022</th><td>			<a class="local col5 ref" href="#825msg" title='msg' data-ref="825msg" data-ref-filename="825msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::qinfo" title='dns_msg::qinfo' data-ref="dns_msg::qinfo" data-ref-filename="dns_msg..qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname_len" title='query_info::qname_len' data-ref="query_info::qname_len" data-ref-filename="query_info..qname_len">qname_len</a>, <var>0</var>, <var>1</var>, <var>0</var>))</td></tr>
<tr><th id="3023">3023</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3024">3024</th><td>	}</td></tr>
<tr><th id="3025">3025</th><td></td></tr>
<tr><th id="3026">3026</th><td>	<i>/* fixup name of wildcard from *.zone to qname, use already allocated</i></td></tr>
<tr><th id="3027">3027</th><td><i>	 * pointer to msg qname */</i></td></tr>
<tr><th id="3028">3028</th><td>	<a class="tu ref fn" href="#az_change_dnames" title='az_change_dnames' data-use='c' data-ref="az_change_dnames" data-ref-filename="az_change_dnames">az_change_dnames</a>(<a class="local col5 ref" href="#825msg" title='msg' data-ref="825msg" data-ref-filename="825msg">msg</a>, <a class="local col7 ref" href="#827wildcard" title='wildcard' data-ref="827wildcard" data-ref-filename="827wildcard">wildcard</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::name" title='auth_data::name' data-ref="auth_data::name" data-ref-filename="auth_data..name">name</a>, <a class="local col5 ref" href="#825msg" title='msg' data-ref="825msg" data-ref-filename="825msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::qinfo" title='dns_msg::qinfo' data-ref="dns_msg::qinfo" data-ref-filename="dns_msg..qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname" title='query_info::qname' data-ref="query_info::qname" data-ref-filename="query_info..qname">qname</a>,</td></tr>
<tr><th id="3029">3029</th><td>		<a class="local col5 ref" href="#825msg" title='msg' data-ref="825msg" data-ref-filename="825msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::qinfo" title='dns_msg::qinfo' data-ref="dns_msg::qinfo" data-ref-filename="dns_msg..qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname_len" title='query_info::qname_len' data-ref="query_info::qname_len" data-ref-filename="query_info..qname_len">qname_len</a>, <var>0</var>);</td></tr>
<tr><th id="3030">3030</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="3031">3031</th><td>}</td></tr>
<tr><th id="3032">3032</th><td></td></tr>
<tr><th id="3033">3033</th><td><i class="doc" data-doc="az_generate_nxdomain_answer">/** generate answer for nxdomain answer */</i></td></tr>
<tr><th id="3034">3034</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="3035">3035</th><td><dfn class="tu decl def fn" id="az_generate_nxdomain_answer" title='az_generate_nxdomain_answer' data-type='int az_generate_nxdomain_answer(struct auth_zone * z, struct regional * region, struct dns_msg * msg, struct auth_data * ce, struct auth_data * node)' data-ref="az_generate_nxdomain_answer" data-ref-filename="az_generate_nxdomain_answer">az_generate_nxdomain_answer</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col3 decl" id="833z" title='z' data-type='struct auth_zone *' data-ref="833z" data-ref-filename="833z">z</dfn>, <b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col4 decl" id="834region" title='region' data-type='struct regional *' data-ref="834region" data-ref-filename="834region">region</dfn>,</td></tr>
<tr><th id="3036">3036</th><td>	<b>struct</b> <a class="type" href="cache/dns.h.html#dns_msg" title='dns_msg' data-ref="dns_msg" data-ref-filename="dns_msg">dns_msg</a>* <dfn class="local col5 decl" id="835msg" title='msg' data-type='struct dns_msg *' data-ref="835msg" data-ref-filename="835msg">msg</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col6 decl" id="836ce" title='ce' data-type='struct auth_data *' data-ref="836ce" data-ref-filename="836ce">ce</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col7 decl" id="837node" title='node' data-type='struct auth_data *' data-ref="837node" data-ref-filename="837node">node</dfn>)</td></tr>
<tr><th id="3037">3037</th><td>{</td></tr>
<tr><th id="3038">3038</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col8 decl" id="838nsec" title='nsec' data-type='struct auth_rrset *' data-ref="838nsec" data-ref-filename="838nsec">nsec</dfn>;</td></tr>
<tr><th id="3039">3039</th><td>	<a class="local col5 ref" href="#835msg" title='msg' data-ref="835msg" data-ref-filename="835msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::flags" title='reply_info::flags' data-ref="reply_info::flags" data-ref-filename="reply_info..flags">flags</a> |= <a class="enum" href="../sldns/pkthdr.h.html#LDNS_RCODE_NXDOMAIN" title='LDNS_RCODE_NXDOMAIN' data-ref="LDNS_RCODE_NXDOMAIN" data-ref-filename="LDNS_RCODE_NXDOMAIN">LDNS_RCODE_NXDOMAIN</a>;</td></tr>
<tr><th id="3040">3040</th><td>	<b>if</b>(!<a class="tu ref fn" href="#az_add_negative_soa" title='az_add_negative_soa' data-use='c' data-ref="az_add_negative_soa" data-ref-filename="az_add_negative_soa">az_add_negative_soa</a>(<a class="local col3 ref" href="#833z" title='z' data-ref="833z" data-ref-filename="833z">z</a>, <a class="local col4 ref" href="#834region" title='region' data-ref="834region" data-ref-filename="834region">region</a>, <a class="local col5 ref" href="#835msg" title='msg' data-ref="835msg" data-ref-filename="835msg">msg</a>)) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="3041">3041</th><td>	<b>if</b>((<a class="local col8 ref" href="#838nsec" title='nsec' data-ref="838nsec" data-ref-filename="838nsec">nsec</a>=<a class="tu ref fn" href="#az_find_nsec_cover" title='az_find_nsec_cover' data-use='c' data-ref="az_find_nsec_cover" data-ref-filename="az_find_nsec_cover">az_find_nsec_cover</a>(<a class="local col3 ref" href="#833z" title='z' data-ref="833z" data-ref-filename="833z">z</a>, &amp;<a class="local col7 ref" href="#837node" title='node' data-ref="837node" data-ref-filename="837node">node</a>)) != <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="3042">3042</th><td>		<b>if</b>(!<a class="tu ref fn" href="#msg_add_rrset_ns" title='msg_add_rrset_ns' data-use='c' data-ref="msg_add_rrset_ns" data-ref-filename="msg_add_rrset_ns">msg_add_rrset_ns</a>(<a class="local col3 ref" href="#833z" title='z' data-ref="833z" data-ref-filename="833z">z</a>, <a class="local col4 ref" href="#834region" title='region' data-ref="834region" data-ref-filename="834region">region</a>, <a class="local col5 ref" href="#835msg" title='msg' data-ref="835msg" data-ref-filename="835msg">msg</a>, <a class="local col7 ref" href="#837node" title='node' data-ref="837node" data-ref-filename="837node">node</a>, <a class="local col8 ref" href="#838nsec" title='nsec' data-ref="838nsec" data-ref-filename="838nsec">nsec</a>)) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="3043">3043</th><td>		<b>if</b>(<a class="local col6 ref" href="#836ce" title='ce' data-ref="836ce" data-ref-filename="836ce">ce</a> &amp;&amp; !<a class="tu ref fn" href="#az_nsec_wildcard_denial" title='az_nsec_wildcard_denial' data-use='c' data-ref="az_nsec_wildcard_denial" data-ref-filename="az_nsec_wildcard_denial">az_nsec_wildcard_denial</a>(<a class="local col3 ref" href="#833z" title='z' data-ref="833z" data-ref-filename="833z">z</a>, <a class="local col4 ref" href="#834region" title='region' data-ref="834region" data-ref-filename="834region">region</a>, <a class="local col5 ref" href="#835msg" title='msg' data-ref="835msg" data-ref-filename="835msg">msg</a>, <a class="local col6 ref" href="#836ce" title='ce' data-ref="836ce" data-ref-filename="836ce">ce</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::name" title='auth_data::name' data-ref="auth_data::name" data-ref-filename="auth_data..name">name</a>,</td></tr>
<tr><th id="3044">3044</th><td>			<a class="local col6 ref" href="#836ce" title='ce' data-ref="836ce" data-ref-filename="836ce">ce</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::namelen" title='auth_data::namelen' data-ref="auth_data::namelen" data-ref-filename="auth_data..namelen">namelen</a>)) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="3045">3045</th><td>	} <b>else</b> <b>if</b>(<a class="local col6 ref" href="#836ce" title='ce' data-ref="836ce" data-ref-filename="836ce">ce</a>) {</td></tr>
<tr><th id="3046">3046</th><td>		<b>if</b>(!<a class="tu ref fn" href="#az_add_nsec3_proof" title='az_add_nsec3_proof' data-use='c' data-ref="az_add_nsec3_proof" data-ref-filename="az_add_nsec3_proof">az_add_nsec3_proof</a>(<a class="local col3 ref" href="#833z" title='z' data-ref="833z" data-ref-filename="833z">z</a>, <a class="local col4 ref" href="#834region" title='region' data-ref="834region" data-ref-filename="834region">region</a>, <a class="local col5 ref" href="#835msg" title='msg' data-ref="835msg" data-ref-filename="835msg">msg</a>, <a class="local col6 ref" href="#836ce" title='ce' data-ref="836ce" data-ref-filename="836ce">ce</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::name" title='auth_data::name' data-ref="auth_data::name" data-ref-filename="auth_data..name">name</a>,</td></tr>
<tr><th id="3047">3047</th><td>			<a class="local col6 ref" href="#836ce" title='ce' data-ref="836ce" data-ref-filename="836ce">ce</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::namelen" title='auth_data::namelen' data-ref="auth_data::namelen" data-ref-filename="auth_data..namelen">namelen</a>, <a class="local col5 ref" href="#835msg" title='msg' data-ref="835msg" data-ref-filename="835msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::qinfo" title='dns_msg::qinfo' data-ref="dns_msg::qinfo" data-ref-filename="dns_msg..qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname" title='query_info::qname' data-ref="query_info::qname" data-ref-filename="query_info..qname">qname</a>,</td></tr>
<tr><th id="3048">3048</th><td>			<a class="local col5 ref" href="#835msg" title='msg' data-ref="835msg" data-ref-filename="835msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::qinfo" title='dns_msg::qinfo' data-ref="dns_msg::qinfo" data-ref-filename="dns_msg..qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname_len" title='query_info::qname_len' data-ref="query_info::qname_len" data-ref-filename="query_info..qname_len">qname_len</a>, <var>1</var>, <var>1</var>, <var>1</var>))</td></tr>
<tr><th id="3049">3049</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3050">3050</th><td>	}</td></tr>
<tr><th id="3051">3051</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="3052">3052</th><td>}</td></tr>
<tr><th id="3053">3053</th><td></td></tr>
<tr><th id="3054">3054</th><td><i class="doc" data-doc="az_generate_answer_with_node">/** Create answers when an exact match exists for the domain name */</i></td></tr>
<tr><th id="3055">3055</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="3056">3056</th><td><dfn class="tu decl def fn" id="az_generate_answer_with_node" title='az_generate_answer_with_node' data-type='int az_generate_answer_with_node(struct auth_zone * z, struct query_info * qinfo, struct regional * region, struct dns_msg * msg, struct auth_data * node)' data-ref="az_generate_answer_with_node" data-ref-filename="az_generate_answer_with_node">az_generate_answer_with_node</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col9 decl" id="839z" title='z' data-type='struct auth_zone *' data-ref="839z" data-ref-filename="839z">z</dfn>, <b>struct</b> <a class="type" href="../util/data/msgreply.h.html#query_info" title='query_info' data-ref="query_info" data-ref-filename="query_info">query_info</a>* <dfn class="local col0 decl" id="840qinfo" title='qinfo' data-type='struct query_info *' data-ref="840qinfo" data-ref-filename="840qinfo">qinfo</dfn>,</td></tr>
<tr><th id="3057">3057</th><td>	<b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col1 decl" id="841region" title='region' data-type='struct regional *' data-ref="841region" data-ref-filename="841region">region</dfn>, <b>struct</b> <a class="type" href="cache/dns.h.html#dns_msg" title='dns_msg' data-ref="dns_msg" data-ref-filename="dns_msg">dns_msg</a>* <dfn class="local col2 decl" id="842msg" title='msg' data-type='struct dns_msg *' data-ref="842msg" data-ref-filename="842msg">msg</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col3 decl" id="843node" title='node' data-type='struct auth_data *' data-ref="843node" data-ref-filename="843node">node</dfn>)</td></tr>
<tr><th id="3058">3058</th><td>{</td></tr>
<tr><th id="3059">3059</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col4 decl" id="844rrset" title='rrset' data-type='struct auth_rrset *' data-ref="844rrset" data-ref-filename="844rrset">rrset</dfn>;</td></tr>
<tr><th id="3060">3060</th><td>	<i>/* positive answer, rrset we are looking for exists */</i></td></tr>
<tr><th id="3061">3061</th><td>	<b>if</b>((<a class="local col4 ref" href="#844rrset" title='rrset' data-ref="844rrset" data-ref-filename="844rrset">rrset</a>=<a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(<a class="local col3 ref" href="#843node" title='node' data-ref="843node" data-ref-filename="843node">node</a>, <a class="local col0 ref" href="#840qinfo" title='qinfo' data-ref="840qinfo" data-ref-filename="840qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qtype" title='query_info::qtype' data-ref="query_info::qtype" data-ref-filename="query_info..qtype">qtype</a>)) != <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="3062">3062</th><td>		<b>return</b> <a class="tu ref fn" href="#az_generate_positive_answer" title='az_generate_positive_answer' data-use='c' data-ref="az_generate_positive_answer" data-ref-filename="az_generate_positive_answer">az_generate_positive_answer</a>(<a class="local col9 ref" href="#839z" title='z' data-ref="839z" data-ref-filename="839z">z</a>, <a class="local col1 ref" href="#841region" title='region' data-ref="841region" data-ref-filename="841region">region</a>, <a class="local col2 ref" href="#842msg" title='msg' data-ref="842msg" data-ref-filename="842msg">msg</a>, <a class="local col3 ref" href="#843node" title='node' data-ref="843node" data-ref-filename="843node">node</a>, <a class="local col4 ref" href="#844rrset" title='rrset' data-ref="844rrset" data-ref-filename="844rrset">rrset</a>);</td></tr>
<tr><th id="3063">3063</th><td>	}</td></tr>
<tr><th id="3064">3064</th><td>	<i>/* CNAME? */</i></td></tr>
<tr><th id="3065">3065</th><td>	<b>if</b>((<a class="local col4 ref" href="#844rrset" title='rrset' data-ref="844rrset" data-ref-filename="844rrset">rrset</a>=<a class="tu ref fn" href="#az_domain_rrset" title='az_domain_rrset' data-use='c' data-ref="az_domain_rrset" data-ref-filename="az_domain_rrset">az_domain_rrset</a>(<a class="local col3 ref" href="#843node" title='node' data-ref="843node" data-ref-filename="843node">node</a>, <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_CNAME" title='LDNS_RR_TYPE_CNAME' data-ref="LDNS_RR_TYPE_CNAME" data-ref-filename="LDNS_RR_TYPE_CNAME">LDNS_RR_TYPE_CNAME</a>)) != <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="3066">3066</th><td>		<b>return</b> <a class="tu ref fn" href="#az_generate_cname_answer" title='az_generate_cname_answer' data-use='c' data-ref="az_generate_cname_answer" data-ref-filename="az_generate_cname_answer">az_generate_cname_answer</a>(<a class="local col9 ref" href="#839z" title='z' data-ref="839z" data-ref-filename="839z">z</a>, <a class="local col0 ref" href="#840qinfo" title='qinfo' data-ref="840qinfo" data-ref-filename="840qinfo">qinfo</a>, <a class="local col1 ref" href="#841region" title='region' data-ref="841region" data-ref-filename="841region">region</a>, <a class="local col2 ref" href="#842msg" title='msg' data-ref="842msg" data-ref-filename="842msg">msg</a>,</td></tr>
<tr><th id="3067">3067</th><td>			<a class="local col3 ref" href="#843node" title='node' data-ref="843node" data-ref-filename="843node">node</a>, <a class="local col4 ref" href="#844rrset" title='rrset' data-ref="844rrset" data-ref-filename="844rrset">rrset</a>);</td></tr>
<tr><th id="3068">3068</th><td>	}</td></tr>
<tr><th id="3069">3069</th><td>	<i>/* type ANY ? */</i></td></tr>
<tr><th id="3070">3070</th><td>	<b>if</b>(<a class="local col0 ref" href="#840qinfo" title='qinfo' data-ref="840qinfo" data-ref-filename="840qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qtype" title='query_info::qtype' data-ref="query_info::qtype" data-ref-filename="query_info..qtype">qtype</a> == <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_ANY" title='LDNS_RR_TYPE_ANY' data-ref="LDNS_RR_TYPE_ANY" data-ref-filename="LDNS_RR_TYPE_ANY">LDNS_RR_TYPE_ANY</a>) {</td></tr>
<tr><th id="3071">3071</th><td>		<b>return</b> <a class="tu ref fn" href="#az_generate_any_answer" title='az_generate_any_answer' data-use='c' data-ref="az_generate_any_answer" data-ref-filename="az_generate_any_answer">az_generate_any_answer</a>(<a class="local col9 ref" href="#839z" title='z' data-ref="839z" data-ref-filename="839z">z</a>, <a class="local col1 ref" href="#841region" title='region' data-ref="841region" data-ref-filename="841region">region</a>, <a class="local col2 ref" href="#842msg" title='msg' data-ref="842msg" data-ref-filename="842msg">msg</a>, <a class="local col3 ref" href="#843node" title='node' data-ref="843node" data-ref-filename="843node">node</a>);</td></tr>
<tr><th id="3072">3072</th><td>	}</td></tr>
<tr><th id="3073">3073</th><td>	<i>/* NOERROR/NODATA (no such type at domain name) */</i></td></tr>
<tr><th id="3074">3074</th><td>	<b>return</b> <a class="tu ref fn" href="#az_generate_notype_answer" title='az_generate_notype_answer' data-use='c' data-ref="az_generate_notype_answer" data-ref-filename="az_generate_notype_answer">az_generate_notype_answer</a>(<a class="local col9 ref" href="#839z" title='z' data-ref="839z" data-ref-filename="839z">z</a>, <a class="local col1 ref" href="#841region" title='region' data-ref="841region" data-ref-filename="841region">region</a>, <a class="local col2 ref" href="#842msg" title='msg' data-ref="842msg" data-ref-filename="842msg">msg</a>, <a class="local col3 ref" href="#843node" title='node' data-ref="843node" data-ref-filename="843node">node</a>);</td></tr>
<tr><th id="3075">3075</th><td>}</td></tr>
<tr><th id="3076">3076</th><td></td></tr>
<tr><th id="3077">3077</th><td><i class="doc" data-doc="az_generate_answer_nonexistnode">/** Generate answer without an existing-node that we can use.</i></td></tr>
<tr><th id="3078">3078</th><td><i class="doc" data-doc="az_generate_answer_nonexistnode"> * So it'll be a referral, DNAME or nxdomain */</i></td></tr>
<tr><th id="3079">3079</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="3080">3080</th><td><dfn class="tu decl def fn" id="az_generate_answer_nonexistnode" title='az_generate_answer_nonexistnode' data-type='int az_generate_answer_nonexistnode(struct auth_zone * z, struct query_info * qinfo, struct regional * region, struct dns_msg * msg, struct auth_data * ce, struct auth_rrset * rrset, struct auth_data * node)' data-ref="az_generate_answer_nonexistnode" data-ref-filename="az_generate_answer_nonexistnode">az_generate_answer_nonexistnode</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col5 decl" id="845z" title='z' data-type='struct auth_zone *' data-ref="845z" data-ref-filename="845z">z</dfn>, <b>struct</b> <a class="type" href="../util/data/msgreply.h.html#query_info" title='query_info' data-ref="query_info" data-ref-filename="query_info">query_info</a>* <dfn class="local col6 decl" id="846qinfo" title='qinfo' data-type='struct query_info *' data-ref="846qinfo" data-ref-filename="846qinfo">qinfo</dfn>,</td></tr>
<tr><th id="3081">3081</th><td>	<b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col7 decl" id="847region" title='region' data-type='struct regional *' data-ref="847region" data-ref-filename="847region">region</dfn>, <b>struct</b> <a class="type" href="cache/dns.h.html#dns_msg" title='dns_msg' data-ref="dns_msg" data-ref-filename="dns_msg">dns_msg</a>* <dfn class="local col8 decl" id="848msg" title='msg' data-type='struct dns_msg *' data-ref="848msg" data-ref-filename="848msg">msg</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col9 decl" id="849ce" title='ce' data-type='struct auth_data *' data-ref="849ce" data-ref-filename="849ce">ce</dfn>,</td></tr>
<tr><th id="3082">3082</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col0 decl" id="850rrset" title='rrset' data-type='struct auth_rrset *' data-ref="850rrset" data-ref-filename="850rrset">rrset</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col1 decl" id="851node" title='node' data-type='struct auth_data *' data-ref="851node" data-ref-filename="851node">node</dfn>)</td></tr>
<tr><th id="3083">3083</th><td>{</td></tr>
<tr><th id="3084">3084</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col2 decl" id="852wildcard" title='wildcard' data-type='struct auth_data *' data-ref="852wildcard" data-ref-filename="852wildcard">wildcard</dfn>;</td></tr>
<tr><th id="3085">3085</th><td></td></tr>
<tr><th id="3086">3086</th><td>	<i>/* we do not have an exact matching name (that exists) */</i></td></tr>
<tr><th id="3087">3087</th><td>	<i>/* see if we have a NS or DNAME in the ce */</i></td></tr>
<tr><th id="3088">3088</th><td>	<b>if</b>(<a class="local col9 ref" href="#849ce" title='ce' data-ref="849ce" data-ref-filename="849ce">ce</a> &amp;&amp; <a class="local col0 ref" href="#850rrset" title='rrset' data-ref="850rrset" data-ref-filename="850rrset">rrset</a> &amp;&amp; <a class="local col0 ref" href="#850rrset" title='rrset' data-ref="850rrset" data-ref-filename="850rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::type" title='auth_rrset::type' data-ref="auth_rrset::type" data-ref-filename="auth_rrset..type">type</a> == <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_NS" title='LDNS_RR_TYPE_NS' data-ref="LDNS_RR_TYPE_NS" data-ref-filename="LDNS_RR_TYPE_NS">LDNS_RR_TYPE_NS</a>) {</td></tr>
<tr><th id="3089">3089</th><td>		<b>return</b> <a class="tu ref fn" href="#az_generate_referral_answer" title='az_generate_referral_answer' data-use='c' data-ref="az_generate_referral_answer" data-ref-filename="az_generate_referral_answer">az_generate_referral_answer</a>(<a class="local col5 ref" href="#845z" title='z' data-ref="845z" data-ref-filename="845z">z</a>, <a class="local col7 ref" href="#847region" title='region' data-ref="847region" data-ref-filename="847region">region</a>, <a class="local col8 ref" href="#848msg" title='msg' data-ref="848msg" data-ref-filename="848msg">msg</a>, <a class="local col9 ref" href="#849ce" title='ce' data-ref="849ce" data-ref-filename="849ce">ce</a>, <a class="local col0 ref" href="#850rrset" title='rrset' data-ref="850rrset" data-ref-filename="850rrset">rrset</a>);</td></tr>
<tr><th id="3090">3090</th><td>	}</td></tr>
<tr><th id="3091">3091</th><td>	<b>if</b>(<a class="local col9 ref" href="#849ce" title='ce' data-ref="849ce" data-ref-filename="849ce">ce</a> &amp;&amp; <a class="local col0 ref" href="#850rrset" title='rrset' data-ref="850rrset" data-ref-filename="850rrset">rrset</a> &amp;&amp; <a class="local col0 ref" href="#850rrset" title='rrset' data-ref="850rrset" data-ref-filename="850rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::type" title='auth_rrset::type' data-ref="auth_rrset::type" data-ref-filename="auth_rrset..type">type</a> == <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_DNAME" title='LDNS_RR_TYPE_DNAME' data-ref="LDNS_RR_TYPE_DNAME" data-ref-filename="LDNS_RR_TYPE_DNAME">LDNS_RR_TYPE_DNAME</a>) {</td></tr>
<tr><th id="3092">3092</th><td>		<b>return</b> <a class="tu ref fn" href="#az_generate_dname_answer" title='az_generate_dname_answer' data-use='c' data-ref="az_generate_dname_answer" data-ref-filename="az_generate_dname_answer">az_generate_dname_answer</a>(<a class="local col5 ref" href="#845z" title='z' data-ref="845z" data-ref-filename="845z">z</a>, <a class="local col6 ref" href="#846qinfo" title='qinfo' data-ref="846qinfo" data-ref-filename="846qinfo">qinfo</a>, <a class="local col7 ref" href="#847region" title='region' data-ref="847region" data-ref-filename="847region">region</a>, <a class="local col8 ref" href="#848msg" title='msg' data-ref="848msg" data-ref-filename="848msg">msg</a>, <a class="local col9 ref" href="#849ce" title='ce' data-ref="849ce" data-ref-filename="849ce">ce</a>,</td></tr>
<tr><th id="3093">3093</th><td>			<a class="local col0 ref" href="#850rrset" title='rrset' data-ref="850rrset" data-ref-filename="850rrset">rrset</a>);</td></tr>
<tr><th id="3094">3094</th><td>	}</td></tr>
<tr><th id="3095">3095</th><td>	<i>/* if there is an empty nonterminal, wildcard and nxdomain don't</i></td></tr>
<tr><th id="3096">3096</th><td><i>	 * happen, it is a notype answer */</i></td></tr>
<tr><th id="3097">3097</th><td>	<b>if</b>(<a class="tu ref fn" href="#az_empty_nonterminal" title='az_empty_nonterminal' data-use='c' data-ref="az_empty_nonterminal" data-ref-filename="az_empty_nonterminal">az_empty_nonterminal</a>(<a class="local col5 ref" href="#845z" title='z' data-ref="845z" data-ref-filename="845z">z</a>, <a class="local col6 ref" href="#846qinfo" title='qinfo' data-ref="846qinfo" data-ref-filename="846qinfo">qinfo</a>, <a class="local col1 ref" href="#851node" title='node' data-ref="851node" data-ref-filename="851node">node</a>)) {</td></tr>
<tr><th id="3098">3098</th><td>		<b>return</b> <a class="tu ref fn" href="#az_generate_notype_answer" title='az_generate_notype_answer' data-use='c' data-ref="az_generate_notype_answer" data-ref-filename="az_generate_notype_answer">az_generate_notype_answer</a>(<a class="local col5 ref" href="#845z" title='z' data-ref="845z" data-ref-filename="845z">z</a>, <a class="local col7 ref" href="#847region" title='region' data-ref="847region" data-ref-filename="847region">region</a>, <a class="local col8 ref" href="#848msg" title='msg' data-ref="848msg" data-ref-filename="848msg">msg</a>, <a class="local col1 ref" href="#851node" title='node' data-ref="851node" data-ref-filename="851node">node</a>);</td></tr>
<tr><th id="3099">3099</th><td>	}</td></tr>
<tr><th id="3100">3100</th><td>	<i>/* see if we have a wildcard under the ce */</i></td></tr>
<tr><th id="3101">3101</th><td>	<b>if</b>((<a class="local col2 ref" href="#852wildcard" title='wildcard' data-ref="852wildcard" data-ref-filename="852wildcard">wildcard</a>=<a class="tu ref fn" href="#az_find_wildcard" title='az_find_wildcard' data-use='c' data-ref="az_find_wildcard" data-ref-filename="az_find_wildcard">az_find_wildcard</a>(<a class="local col5 ref" href="#845z" title='z' data-ref="845z" data-ref-filename="845z">z</a>, <a class="local col6 ref" href="#846qinfo" title='qinfo' data-ref="846qinfo" data-ref-filename="846qinfo">qinfo</a>, <a class="local col9 ref" href="#849ce" title='ce' data-ref="849ce" data-ref-filename="849ce">ce</a>)) != <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="3102">3102</th><td>		<b>return</b> <a class="tu ref fn" href="#az_generate_wildcard_answer" title='az_generate_wildcard_answer' data-use='c' data-ref="az_generate_wildcard_answer" data-ref-filename="az_generate_wildcard_answer">az_generate_wildcard_answer</a>(<a class="local col5 ref" href="#845z" title='z' data-ref="845z" data-ref-filename="845z">z</a>, <a class="local col6 ref" href="#846qinfo" title='qinfo' data-ref="846qinfo" data-ref-filename="846qinfo">qinfo</a>, <a class="local col7 ref" href="#847region" title='region' data-ref="847region" data-ref-filename="847region">region</a>, <a class="local col8 ref" href="#848msg" title='msg' data-ref="848msg" data-ref-filename="848msg">msg</a>,</td></tr>
<tr><th id="3103">3103</th><td>			<a class="local col9 ref" href="#849ce" title='ce' data-ref="849ce" data-ref-filename="849ce">ce</a>, <a class="local col2 ref" href="#852wildcard" title='wildcard' data-ref="852wildcard" data-ref-filename="852wildcard">wildcard</a>, <a class="local col1 ref" href="#851node" title='node' data-ref="851node" data-ref-filename="851node">node</a>);</td></tr>
<tr><th id="3104">3104</th><td>	}</td></tr>
<tr><th id="3105">3105</th><td>	<i>/* generate nxdomain answer */</i></td></tr>
<tr><th id="3106">3106</th><td>	<b>return</b> <a class="tu ref fn" href="#az_generate_nxdomain_answer" title='az_generate_nxdomain_answer' data-use='c' data-ref="az_generate_nxdomain_answer" data-ref-filename="az_generate_nxdomain_answer">az_generate_nxdomain_answer</a>(<a class="local col5 ref" href="#845z" title='z' data-ref="845z" data-ref-filename="845z">z</a>, <a class="local col7 ref" href="#847region" title='region' data-ref="847region" data-ref-filename="847region">region</a>, <a class="local col8 ref" href="#848msg" title='msg' data-ref="848msg" data-ref-filename="848msg">msg</a>, <a class="local col9 ref" href="#849ce" title='ce' data-ref="849ce" data-ref-filename="849ce">ce</a>, <a class="local col1 ref" href="#851node" title='node' data-ref="851node" data-ref-filename="851node">node</a>);</td></tr>
<tr><th id="3107">3107</th><td>}</td></tr>
<tr><th id="3108">3108</th><td></td></tr>
<tr><th id="3109">3109</th><td><i class="doc" data-doc="auth_zone_generate_answer">/** Lookup answer in a zone. */</i></td></tr>
<tr><th id="3110">3110</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="3111">3111</th><td><dfn class="tu decl def fn" id="auth_zone_generate_answer" title='auth_zone_generate_answer' data-type='int auth_zone_generate_answer(struct auth_zone * z, struct query_info * qinfo, struct regional * region, struct dns_msg ** msg, int * fallback)' data-ref="auth_zone_generate_answer" data-ref-filename="auth_zone_generate_answer">auth_zone_generate_answer</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col3 decl" id="853z" title='z' data-type='struct auth_zone *' data-ref="853z" data-ref-filename="853z">z</dfn>, <b>struct</b> <a class="type" href="../util/data/msgreply.h.html#query_info" title='query_info' data-ref="query_info" data-ref-filename="query_info">query_info</a>* <dfn class="local col4 decl" id="854qinfo" title='qinfo' data-type='struct query_info *' data-ref="854qinfo" data-ref-filename="854qinfo">qinfo</dfn>,</td></tr>
<tr><th id="3112">3112</th><td>	<b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col5 decl" id="855region" title='region' data-type='struct regional *' data-ref="855region" data-ref-filename="855region">region</dfn>, <b>struct</b> <a class="type" href="cache/dns.h.html#dns_msg" title='dns_msg' data-ref="dns_msg" data-ref-filename="dns_msg">dns_msg</a>** <dfn class="local col6 decl" id="856msg" title='msg' data-type='struct dns_msg **' data-ref="856msg" data-ref-filename="856msg">msg</dfn>, <em>int</em>* <dfn class="local col7 decl" id="857fallback" title='fallback' data-type='int *' data-ref="857fallback" data-ref-filename="857fallback">fallback</dfn>)</td></tr>
<tr><th id="3113">3113</th><td>{</td></tr>
<tr><th id="3114">3114</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_data" title='auth_data' data-ref="auth_data" data-ref-filename="auth_data">auth_data</a>* <dfn class="local col8 decl" id="858node" title='node' data-type='struct auth_data *' data-ref="858node" data-ref-filename="858node">node</dfn>, *<dfn class="local col9 decl" id="859ce" title='ce' data-type='struct auth_data *' data-ref="859ce" data-ref-filename="859ce">ce</dfn>;</td></tr>
<tr><th id="3115">3115</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_rrset" title='auth_rrset' data-ref="auth_rrset" data-ref-filename="auth_rrset">auth_rrset</a>* <dfn class="local col0 decl" id="860rrset" title='rrset' data-type='struct auth_rrset *' data-ref="860rrset" data-ref-filename="860rrset">rrset</dfn>;</td></tr>
<tr><th id="3116">3116</th><td>	<em>int</em> <dfn class="local col1 decl" id="861node_exact" title='node_exact' data-type='int' data-ref="861node_exact" data-ref-filename="861node_exact">node_exact</dfn>, <dfn class="local col2 decl" id="862node_exists" title='node_exists' data-type='int' data-ref="862node_exists" data-ref-filename="862node_exists">node_exists</dfn>;</td></tr>
<tr><th id="3117">3117</th><td>	<i>/* does the zone want fallback in case of failure? */</i></td></tr>
<tr><th id="3118">3118</th><td>	*<a class="local col7 ref" href="#857fallback" title='fallback' data-ref="857fallback" data-ref-filename="857fallback">fallback</a> = <a class="local col3 ref" href="#853z" title='z' data-ref="853z" data-ref-filename="853z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::fallback_enabled" title='auth_zone::fallback_enabled' data-ref="auth_zone::fallback_enabled" data-ref-filename="auth_zone..fallback_enabled">fallback_enabled</a>;</td></tr>
<tr><th id="3119">3119</th><td>	<b>if</b>(!(*<a class="local col6 ref" href="#856msg" title='msg' data-ref="856msg" data-ref-filename="856msg">msg</a>=<a class="tu ref fn" href="#msg_create" title='msg_create' data-use='c' data-ref="msg_create" data-ref-filename="msg_create">msg_create</a>(<a class="local col5 ref" href="#855region" title='region' data-ref="855region" data-ref-filename="855region">region</a>, <a class="local col4 ref" href="#854qinfo" title='qinfo' data-ref="854qinfo" data-ref-filename="854qinfo">qinfo</a>))) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="3120">3120</th><td></td></tr>
<tr><th id="3121">3121</th><td>	<i>/* lookup if there is a matching domain name for the query */</i></td></tr>
<tr><th id="3122">3122</th><td>	<a class="tu ref fn" href="#az_find_domain" title='az_find_domain' data-use='c' data-ref="az_find_domain" data-ref-filename="az_find_domain">az_find_domain</a>(<a class="local col3 ref" href="#853z" title='z' data-ref="853z" data-ref-filename="853z">z</a>, <a class="local col4 ref" href="#854qinfo" title='qinfo' data-ref="854qinfo" data-ref-filename="854qinfo">qinfo</a>, &amp;<a class="local col1 ref" href="#861node_exact" title='node_exact' data-ref="861node_exact" data-ref-filename="861node_exact">node_exact</a>, &amp;<a class="local col8 ref" href="#858node" title='node' data-ref="858node" data-ref-filename="858node">node</a>);</td></tr>
<tr><th id="3123">3123</th><td></td></tr>
<tr><th id="3124">3124</th><td>	<i>/* see if node exists for generating answers from (i.e. not glue and</i></td></tr>
<tr><th id="3125">3125</th><td><i>	 * obscured by NS or DNAME or NSEC3-only), and also return the</i></td></tr>
<tr><th id="3126">3126</th><td><i>	 * closest-encloser from that, closest node that should be used</i></td></tr>
<tr><th id="3127">3127</th><td><i>	 * to generate answers from that is above the query */</i></td></tr>
<tr><th id="3128">3128</th><td>	<a class="local col2 ref" href="#862node_exists" title='node_exists' data-ref="862node_exists" data-ref-filename="862node_exists">node_exists</a> = <a class="tu ref fn" href="#az_find_ce" title='az_find_ce' data-use='c' data-ref="az_find_ce" data-ref-filename="az_find_ce">az_find_ce</a>(<a class="local col3 ref" href="#853z" title='z' data-ref="853z" data-ref-filename="853z">z</a>, <a class="local col4 ref" href="#854qinfo" title='qinfo' data-ref="854qinfo" data-ref-filename="854qinfo">qinfo</a>, <a class="local col8 ref" href="#858node" title='node' data-ref="858node" data-ref-filename="858node">node</a>, <a class="local col1 ref" href="#861node_exact" title='node_exact' data-ref="861node_exact" data-ref-filename="861node_exact">node_exact</a>, &amp;<a class="local col9 ref" href="#859ce" title='ce' data-ref="859ce" data-ref-filename="859ce">ce</a>, &amp;<a class="local col0 ref" href="#860rrset" title='rrset' data-ref="860rrset" data-ref-filename="860rrset">rrset</a>);</td></tr>
<tr><th id="3129">3129</th><td></td></tr>
<tr><th id="3130">3130</th><td>	<b>if</b>(<a class="ref" href="../util/log.h.html#verbosity" title='verbosity' data-ref="verbosity" data-ref-filename="verbosity">verbosity</a> &gt;= <a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>) {</td></tr>
<tr><th id="3131">3131</th><td>		<em>char</em> <dfn class="local col3 decl" id="863zname" title='zname' data-type='char [256]' data-ref="863zname" data-ref-filename="863zname">zname</dfn>[<var>256</var>], <dfn class="local col4 decl" id="864qname" title='qname' data-type='char [256]' data-ref="864qname" data-ref-filename="864qname">qname</dfn>[<var>256</var>], <dfn class="local col5 decl" id="865nname" title='nname' data-type='char [256]' data-ref="865nname" data-ref-filename="865nname">nname</dfn>[<var>256</var>], <dfn class="local col6 decl" id="866cename" title='cename' data-type='char [256]' data-ref="866cename" data-ref-filename="866cename">cename</dfn>[<var>256</var>],</td></tr>
<tr><th id="3132">3132</th><td>			<dfn class="local col7 decl" id="867tpstr" title='tpstr' data-type='char [32]' data-ref="867tpstr" data-ref-filename="867tpstr">tpstr</dfn>[<var>32</var>], <dfn class="local col8 decl" id="868rrstr" title='rrstr' data-type='char [32]' data-ref="868rrstr" data-ref-filename="868rrstr">rrstr</dfn>[<var>32</var>];</td></tr>
<tr><th id="3133">3133</th><td>		<a class="ref fn" href="../sldns/wire2str.h.html#sldns_wire2str_dname_buf" title='sldns_wire2str_dname_buf' data-ref="sldns_wire2str_dname_buf" data-ref-filename="sldns_wire2str_dname_buf">sldns_wire2str_dname_buf</a>(<a class="local col4 ref" href="#854qinfo" title='qinfo' data-ref="854qinfo" data-ref-filename="854qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname" title='query_info::qname' data-ref="query_info::qname" data-ref-filename="query_info..qname">qname</a>, <a class="local col4 ref" href="#854qinfo" title='qinfo' data-ref="854qinfo" data-ref-filename="854qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname_len" title='query_info::qname_len' data-ref="query_info::qname_len" data-ref-filename="query_info..qname_len">qname_len</a>, <a class="local col4 ref" href="#864qname" title='qname' data-ref="864qname" data-ref-filename="864qname">qname</a>,</td></tr>
<tr><th id="3134">3134</th><td>			<b>sizeof</b>(<a class="local col4 ref" href="#864qname" title='qname' data-ref="864qname" data-ref-filename="864qname">qname</a>));</td></tr>
<tr><th id="3135">3135</th><td>		<a class="ref fn" href="../sldns/wire2str.h.html#sldns_wire2str_type_buf" title='sldns_wire2str_type_buf' data-ref="sldns_wire2str_type_buf" data-ref-filename="sldns_wire2str_type_buf">sldns_wire2str_type_buf</a>(<a class="local col4 ref" href="#854qinfo" title='qinfo' data-ref="854qinfo" data-ref-filename="854qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qtype" title='query_info::qtype' data-ref="query_info::qtype" data-ref-filename="query_info..qtype">qtype</a>, <a class="local col7 ref" href="#867tpstr" title='tpstr' data-ref="867tpstr" data-ref-filename="867tpstr">tpstr</a>, <b>sizeof</b>(<a class="local col7 ref" href="#867tpstr" title='tpstr' data-ref="867tpstr" data-ref-filename="867tpstr">tpstr</a>));</td></tr>
<tr><th id="3136">3136</th><td>		<a class="ref fn" href="../sldns/wire2str.h.html#sldns_wire2str_dname_buf" title='sldns_wire2str_dname_buf' data-ref="sldns_wire2str_dname_buf" data-ref-filename="sldns_wire2str_dname_buf">sldns_wire2str_dname_buf</a>(<a class="local col3 ref" href="#853z" title='z' data-ref="853z" data-ref-filename="853z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::name" title='auth_zone::name' data-ref="auth_zone::name" data-ref-filename="auth_zone..name">name</a>, <a class="local col3 ref" href="#853z" title='z' data-ref="853z" data-ref-filename="853z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::namelen" title='auth_zone::namelen' data-ref="auth_zone::namelen" data-ref-filename="auth_zone..namelen">namelen</a>, <a class="local col3 ref" href="#863zname" title='zname' data-ref="863zname" data-ref-filename="863zname">zname</a>,</td></tr>
<tr><th id="3137">3137</th><td>			<b>sizeof</b>(<a class="local col3 ref" href="#863zname" title='zname' data-ref="863zname" data-ref-filename="863zname">zname</a>));</td></tr>
<tr><th id="3138">3138</th><td>		<b>if</b>(<a class="local col8 ref" href="#858node" title='node' data-ref="858node" data-ref-filename="858node">node</a>)</td></tr>
<tr><th id="3139">3139</th><td>			<a class="ref fn" href="../sldns/wire2str.h.html#sldns_wire2str_dname_buf" title='sldns_wire2str_dname_buf' data-ref="sldns_wire2str_dname_buf" data-ref-filename="sldns_wire2str_dname_buf">sldns_wire2str_dname_buf</a>(<a class="local col8 ref" href="#858node" title='node' data-ref="858node" data-ref-filename="858node">node</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::name" title='auth_data::name' data-ref="auth_data::name" data-ref-filename="auth_data..name">name</a>, <a class="local col8 ref" href="#858node" title='node' data-ref="858node" data-ref-filename="858node">node</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::namelen" title='auth_data::namelen' data-ref="auth_data::namelen" data-ref-filename="auth_data..namelen">namelen</a>,</td></tr>
<tr><th id="3140">3140</th><td>				<a class="local col5 ref" href="#865nname" title='nname' data-ref="865nname" data-ref-filename="865nname">nname</a>, <b>sizeof</b>(<a class="local col5 ref" href="#865nname" title='nname' data-ref="865nname" data-ref-filename="865nname">nname</a>));</td></tr>
<tr><th id="3141">3141</th><td>		<b>else</b>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/stdio.h.html#61" title="__builtin___snprintf_chk(nname, sizeof(nname), 0, __builtin_object_size(nname, 2 &gt; 1), &quot;NULL&quot;)" data-ref="_M/snprintf">snprintf</a>(<a class="local col5 ref" href="#865nname" title='nname' data-ref="865nname" data-ref-filename="865nname">nname</a>, <b>sizeof</b>(<a class="local col5 ref" href="#865nname" title='nname' data-ref="865nname" data-ref-filename="865nname">nname</a>), <q>"NULL"</q>);</td></tr>
<tr><th id="3142">3142</th><td>		<b>if</b>(<a class="local col9 ref" href="#859ce" title='ce' data-ref="859ce" data-ref-filename="859ce">ce</a>)</td></tr>
<tr><th id="3143">3143</th><td>			<a class="ref fn" href="../sldns/wire2str.h.html#sldns_wire2str_dname_buf" title='sldns_wire2str_dname_buf' data-ref="sldns_wire2str_dname_buf" data-ref-filename="sldns_wire2str_dname_buf">sldns_wire2str_dname_buf</a>(<a class="local col9 ref" href="#859ce" title='ce' data-ref="859ce" data-ref-filename="859ce">ce</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::name" title='auth_data::name' data-ref="auth_data::name" data-ref-filename="auth_data..name">name</a>, <a class="local col9 ref" href="#859ce" title='ce' data-ref="859ce" data-ref-filename="859ce">ce</a>-&gt;<a class="ref field" href="authzone.h.html#auth_data::namelen" title='auth_data::namelen' data-ref="auth_data::namelen" data-ref-filename="auth_data..namelen">namelen</a>,</td></tr>
<tr><th id="3144">3144</th><td>				<a class="local col6 ref" href="#866cename" title='cename' data-ref="866cename" data-ref-filename="866cename">cename</a>, <b>sizeof</b>(<a class="local col6 ref" href="#866cename" title='cename' data-ref="866cename" data-ref-filename="866cename">cename</a>));</td></tr>
<tr><th id="3145">3145</th><td>		<b>else</b>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/stdio.h.html#61" title="__builtin___snprintf_chk(cename, sizeof(cename), 0, __builtin_object_size(cename, 2 &gt; 1), &quot;NULL&quot;)" data-ref="_M/snprintf">snprintf</a>(<a class="local col6 ref" href="#866cename" title='cename' data-ref="866cename" data-ref-filename="866cename">cename</a>, <b>sizeof</b>(<a class="local col6 ref" href="#866cename" title='cename' data-ref="866cename" data-ref-filename="866cename">cename</a>), <q>"NULL"</q>);</td></tr>
<tr><th id="3146">3146</th><td>		<b>if</b>(<a class="local col0 ref" href="#860rrset" title='rrset' data-ref="860rrset" data-ref-filename="860rrset">rrset</a>) <a class="ref fn" href="../sldns/wire2str.h.html#sldns_wire2str_type_buf" title='sldns_wire2str_type_buf' data-ref="sldns_wire2str_type_buf" data-ref-filename="sldns_wire2str_type_buf">sldns_wire2str_type_buf</a>(<a class="local col0 ref" href="#860rrset" title='rrset' data-ref="860rrset" data-ref-filename="860rrset">rrset</a>-&gt;<a class="ref field" href="authzone.h.html#auth_rrset::type" title='auth_rrset::type' data-ref="auth_rrset::type" data-ref-filename="auth_rrset..type">type</a>, <a class="local col8 ref" href="#868rrstr" title='rrstr' data-ref="868rrstr" data-ref-filename="868rrstr">rrstr</a>,</td></tr>
<tr><th id="3147">3147</th><td>			<b>sizeof</b>(<a class="local col8 ref" href="#868rrstr" title='rrstr' data-ref="868rrstr" data-ref-filename="868rrstr">rrstr</a>));</td></tr>
<tr><th id="3148">3148</th><td>		<b>else</b>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/stdio.h.html#61" title="__builtin___snprintf_chk(rrstr, sizeof(rrstr), 0, __builtin_object_size(rrstr, 2 &gt; 1), &quot;NULL&quot;)" data-ref="_M/snprintf">snprintf</a>(<a class="local col8 ref" href="#868rrstr" title='rrstr' data-ref="868rrstr" data-ref-filename="868rrstr">rrstr</a>, <b>sizeof</b>(<a class="local col8 ref" href="#868rrstr" title='rrstr' data-ref="868rrstr" data-ref-filename="868rrstr">rrstr</a>), <q>"NULL"</q>);</td></tr>
<tr><th id="3149">3149</th><td>		<a class="ref fn" href="../util/log.h.html#log_info" title='log_info' data-ref="log_info" data-ref-filename="log_info">log_info</a>(<q>"auth_zone %s query %s %s, domain %s %s %s, "</q></td></tr>
<tr><th id="3150">3150</th><td>			<q>"ce %s, rrset %s"</q>, <a class="local col3 ref" href="#863zname" title='zname' data-ref="863zname" data-ref-filename="863zname">zname</a>, <a class="local col4 ref" href="#864qname" title='qname' data-ref="864qname" data-ref-filename="864qname">qname</a>, <a class="local col7 ref" href="#867tpstr" title='tpstr' data-ref="867tpstr" data-ref-filename="867tpstr">tpstr</a>, <a class="local col5 ref" href="#865nname" title='nname' data-ref="865nname" data-ref-filename="865nname">nname</a>,</td></tr>
<tr><th id="3151">3151</th><td>			(<a class="local col1 ref" href="#861node_exact" title='node_exact' data-ref="861node_exact" data-ref-filename="861node_exact">node_exact</a>?<q>"exact"</q>:<q>"notexact"</q>),</td></tr>
<tr><th id="3152">3152</th><td>			(<a class="local col2 ref" href="#862node_exists" title='node_exists' data-ref="862node_exists" data-ref-filename="862node_exists">node_exists</a>?<q>"exist"</q>:<q>"notexist"</q>), <a class="local col6 ref" href="#866cename" title='cename' data-ref="866cename" data-ref-filename="866cename">cename</a>, <a class="local col8 ref" href="#868rrstr" title='rrstr' data-ref="868rrstr" data-ref-filename="868rrstr">rrstr</a>);</td></tr>
<tr><th id="3153">3153</th><td>	}</td></tr>
<tr><th id="3154">3154</th><td></td></tr>
<tr><th id="3155">3155</th><td>	<b>if</b>(<a class="local col2 ref" href="#862node_exists" title='node_exists' data-ref="862node_exists" data-ref-filename="862node_exists">node_exists</a>) {</td></tr>
<tr><th id="3156">3156</th><td>		<i>/* the node is fine, generate answer from node */</i></td></tr>
<tr><th id="3157">3157</th><td>		<b>return</b> <a class="tu ref fn" href="#az_generate_answer_with_node" title='az_generate_answer_with_node' data-use='c' data-ref="az_generate_answer_with_node" data-ref-filename="az_generate_answer_with_node">az_generate_answer_with_node</a>(<a class="local col3 ref" href="#853z" title='z' data-ref="853z" data-ref-filename="853z">z</a>, <a class="local col4 ref" href="#854qinfo" title='qinfo' data-ref="854qinfo" data-ref-filename="854qinfo">qinfo</a>, <a class="local col5 ref" href="#855region" title='region' data-ref="855region" data-ref-filename="855region">region</a>, *<a class="local col6 ref" href="#856msg" title='msg' data-ref="856msg" data-ref-filename="856msg">msg</a>,</td></tr>
<tr><th id="3158">3158</th><td>			<a class="local col8 ref" href="#858node" title='node' data-ref="858node" data-ref-filename="858node">node</a>);</td></tr>
<tr><th id="3159">3159</th><td>	}</td></tr>
<tr><th id="3160">3160</th><td>	<b>return</b> <a class="tu ref fn" href="#az_generate_answer_nonexistnode" title='az_generate_answer_nonexistnode' data-use='c' data-ref="az_generate_answer_nonexistnode" data-ref-filename="az_generate_answer_nonexistnode">az_generate_answer_nonexistnode</a>(<a class="local col3 ref" href="#853z" title='z' data-ref="853z" data-ref-filename="853z">z</a>, <a class="local col4 ref" href="#854qinfo" title='qinfo' data-ref="854qinfo" data-ref-filename="854qinfo">qinfo</a>, <a class="local col5 ref" href="#855region" title='region' data-ref="855region" data-ref-filename="855region">region</a>, *<a class="local col6 ref" href="#856msg" title='msg' data-ref="856msg" data-ref-filename="856msg">msg</a>,</td></tr>
<tr><th id="3161">3161</th><td>		<a class="local col9 ref" href="#859ce" title='ce' data-ref="859ce" data-ref-filename="859ce">ce</a>, <a class="local col0 ref" href="#860rrset" title='rrset' data-ref="860rrset" data-ref-filename="860rrset">rrset</a>, <a class="local col8 ref" href="#858node" title='node' data-ref="858node" data-ref-filename="858node">node</a>);</td></tr>
<tr><th id="3162">3162</th><td>}</td></tr>
<tr><th id="3163">3163</th><td></td></tr>
<tr><th id="3164">3164</th><td><em>int</em> <dfn class="decl def fn" id="auth_zones_lookup" title='auth_zones_lookup' data-ref="auth_zones_lookup" data-ref-filename="auth_zones_lookup">auth_zones_lookup</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zones" title='auth_zones' data-ref="auth_zones" data-ref-filename="auth_zones">auth_zones</a>* <dfn class="local col9 decl" id="869az" title='az' data-type='struct auth_zones *' data-ref="869az" data-ref-filename="869az">az</dfn>, <b>struct</b> <a class="type" href="../util/data/msgreply.h.html#query_info" title='query_info' data-ref="query_info" data-ref-filename="query_info">query_info</a>* <dfn class="local col0 decl" id="870qinfo" title='qinfo' data-type='struct query_info *' data-ref="870qinfo" data-ref-filename="870qinfo">qinfo</dfn>,</td></tr>
<tr><th id="3165">3165</th><td>	<b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col1 decl" id="871region" title='region' data-type='struct regional *' data-ref="871region" data-ref-filename="871region">region</dfn>, <b>struct</b> <a class="type" href="cache/dns.h.html#dns_msg" title='dns_msg' data-ref="dns_msg" data-ref-filename="dns_msg">dns_msg</a>** <dfn class="local col2 decl" id="872msg" title='msg' data-type='struct dns_msg **' data-ref="872msg" data-ref-filename="872msg">msg</dfn>, <em>int</em>* <dfn class="local col3 decl" id="873fallback" title='fallback' data-type='int *' data-ref="873fallback" data-ref-filename="873fallback">fallback</dfn>,</td></tr>
<tr><th id="3166">3166</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col4 decl" id="874dp_nm" title='dp_nm' data-type='uint8_t *' data-ref="874dp_nm" data-ref-filename="874dp_nm">dp_nm</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col5 decl" id="875dp_nmlen" title='dp_nmlen' data-type='size_t' data-ref="875dp_nmlen" data-ref-filename="875dp_nmlen">dp_nmlen</dfn>)</td></tr>
<tr><th id="3167">3167</th><td>{</td></tr>
<tr><th id="3168">3168</th><td>	<em>int</em> <dfn class="local col6 decl" id="876r" title='r' data-type='int' data-ref="876r" data-ref-filename="876r">r</dfn>;</td></tr>
<tr><th id="3169">3169</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col7 decl" id="877z" title='z' data-type='struct auth_zone *' data-ref="877z" data-ref-filename="877z">z</dfn>;</td></tr>
<tr><th id="3170">3170</th><td>	<i>/* find the zone that should contain the answer. */</i></td></tr>
<tr><th id="3171">3171</th><td>	<a class="macro" href="../util/locks.h.html#119" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_rdlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_rdlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3171, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_rdlock">lock_rw_rdlock</a>(&amp;<a class="local col9 ref" href="#869az" title='az' data-ref="869az" data-ref-filename="869az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="3172">3172</th><td>	<a class="local col7 ref" href="#877z" title='z' data-ref="877z" data-ref-filename="877z">z</a> = <a class="ref fn" href="#auth_zone_find" title='auth_zone_find' data-ref="auth_zone_find" data-ref-filename="auth_zone_find">auth_zone_find</a>(<a class="local col9 ref" href="#869az" title='az' data-ref="869az" data-ref-filename="869az">az</a>, <a class="local col4 ref" href="#874dp_nm" title='dp_nm' data-ref="874dp_nm" data-ref-filename="874dp_nm">dp_nm</a>, <a class="local col5 ref" href="#875dp_nmlen" title='dp_nmlen' data-ref="875dp_nmlen" data-ref-filename="875dp_nmlen">dp_nmlen</a>, <a class="local col0 ref" href="#870qinfo" title='qinfo' data-ref="870qinfo" data-ref-filename="870qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qclass" title='query_info::qclass' data-ref="query_info::qclass" data-ref-filename="query_info..qclass">qclass</a>);</td></tr>
<tr><th id="3173">3173</th><td>	<b>if</b>(!<a class="local col7 ref" href="#877z" title='z' data-ref="877z" data-ref-filename="877z">z</a>) {</td></tr>
<tr><th id="3174">3174</th><td>		<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3174, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col9 ref" href="#869az" title='az' data-ref="869az" data-ref-filename="869az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="3175">3175</th><td>		<i>/* no auth zone, fallback to internet */</i></td></tr>
<tr><th id="3176">3176</th><td>		*<a class="local col3 ref" href="#873fallback" title='fallback' data-ref="873fallback" data-ref-filename="873fallback">fallback</a> = <var>1</var>;</td></tr>
<tr><th id="3177">3177</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3178">3178</th><td>	}</td></tr>
<tr><th id="3179">3179</th><td>	<a class="macro" href="../util/locks.h.html#119" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_rdlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_rdlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3179, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_rdlock">lock_rw_rdlock</a>(&amp;<a class="local col7 ref" href="#877z" title='z' data-ref="877z" data-ref-filename="877z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="3180">3180</th><td>	<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3180, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col9 ref" href="#869az" title='az' data-ref="869az" data-ref-filename="869az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="3181">3181</th><td></td></tr>
<tr><th id="3182">3182</th><td>	<i>/* if not for upstream queries, fallback */</i></td></tr>
<tr><th id="3183">3183</th><td>	<b>if</b>(!<a class="local col7 ref" href="#877z" title='z' data-ref="877z" data-ref-filename="877z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::for_upstream" title='auth_zone::for_upstream' data-ref="auth_zone::for_upstream" data-ref-filename="auth_zone..for_upstream">for_upstream</a>) {</td></tr>
<tr><th id="3184">3184</th><td>		<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3184, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col7 ref" href="#877z" title='z' data-ref="877z" data-ref-filename="877z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="3185">3185</th><td>		*<a class="local col3 ref" href="#873fallback" title='fallback' data-ref="873fallback" data-ref-filename="873fallback">fallback</a> = <var>1</var>;</td></tr>
<tr><th id="3186">3186</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3187">3187</th><td>	}</td></tr>
<tr><th id="3188">3188</th><td>	<b>if</b>(<a class="local col7 ref" href="#877z" title='z' data-ref="877z" data-ref-filename="877z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::zone_expired" title='auth_zone::zone_expired' data-ref="auth_zone::zone_expired" data-ref-filename="auth_zone..zone_expired">zone_expired</a>) {</td></tr>
<tr><th id="3189">3189</th><td>		*<a class="local col3 ref" href="#873fallback" title='fallback' data-ref="873fallback" data-ref-filename="873fallback">fallback</a> = <a class="local col7 ref" href="#877z" title='z' data-ref="877z" data-ref-filename="877z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::fallback_enabled" title='auth_zone::fallback_enabled' data-ref="auth_zone::fallback_enabled" data-ref-filename="auth_zone..fallback_enabled">fallback_enabled</a>;</td></tr>
<tr><th id="3190">3190</th><td>		<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3190, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col7 ref" href="#877z" title='z' data-ref="877z" data-ref-filename="877z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="3191">3191</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3192">3192</th><td>	}</td></tr>
<tr><th id="3193">3193</th><td>	<i>/* see what answer that zone would generate */</i></td></tr>
<tr><th id="3194">3194</th><td>	<a class="local col6 ref" href="#876r" title='r' data-ref="876r" data-ref-filename="876r">r</a> = <a class="tu ref fn" href="#auth_zone_generate_answer" title='auth_zone_generate_answer' data-use='c' data-ref="auth_zone_generate_answer" data-ref-filename="auth_zone_generate_answer">auth_zone_generate_answer</a>(<a class="local col7 ref" href="#877z" title='z' data-ref="877z" data-ref-filename="877z">z</a>, <a class="local col0 ref" href="#870qinfo" title='qinfo' data-ref="870qinfo" data-ref-filename="870qinfo">qinfo</a>, <a class="local col1 ref" href="#871region" title='region' data-ref="871region" data-ref-filename="871region">region</a>, <a class="local col2 ref" href="#872msg" title='msg' data-ref="872msg" data-ref-filename="872msg">msg</a>, <a class="local col3 ref" href="#873fallback" title='fallback' data-ref="873fallback" data-ref-filename="873fallback">fallback</a>);</td></tr>
<tr><th id="3195">3195</th><td>	<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3195, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col7 ref" href="#877z" title='z' data-ref="877z" data-ref-filename="877z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="3196">3196</th><td>	<b>return</b> <a class="local col6 ref" href="#876r" title='r' data-ref="876r" data-ref-filename="876r">r</a>;</td></tr>
<tr><th id="3197">3197</th><td>}</td></tr>
<tr><th id="3198">3198</th><td></td></tr>
<tr><th id="3199">3199</th><td><i class="doc" data-doc="auth_answer_encode">/** encode auth answer */</i></td></tr>
<tr><th id="3200">3200</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="3201">3201</th><td><dfn class="tu decl def fn" id="auth_answer_encode" title='auth_answer_encode' data-type='void auth_answer_encode(struct query_info * qinfo, struct module_env * env, struct edns_data * edns, struct comm_reply * repinfo, sldns_buffer * buf, struct regional * temp, struct dns_msg * msg)' data-ref="auth_answer_encode" data-ref-filename="auth_answer_encode">auth_answer_encode</dfn>(<b>struct</b> <a class="type" href="../util/data/msgreply.h.html#query_info" title='query_info' data-ref="query_info" data-ref-filename="query_info">query_info</a>* <dfn class="local col8 decl" id="878qinfo" title='qinfo' data-type='struct query_info *' data-ref="878qinfo" data-ref-filename="878qinfo">qinfo</dfn>, <b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col9 decl" id="879env" title='env' data-type='struct module_env *' data-ref="879env" data-ref-filename="879env">env</dfn>,</td></tr>
<tr><th id="3202">3202</th><td>	<b>struct</b> <a class="type" href="../util/data/msgparse.h.html#edns_data" title='edns_data' data-ref="edns_data" data-ref-filename="edns_data">edns_data</a>* <dfn class="local col0 decl" id="880edns" title='edns' data-type='struct edns_data *' data-ref="880edns" data-ref-filename="880edns">edns</dfn>, <b>struct</b> <a class="type" href="../util/netevent.h.html#comm_reply" title='comm_reply' data-ref="comm_reply" data-ref-filename="comm_reply">comm_reply</a>* <dfn class="local col1 decl" id="881repinfo" title='repinfo' data-type='struct comm_reply *' data-ref="881repinfo" data-ref-filename="881repinfo">repinfo</dfn>, <a class="typedef" href="../sldns/sbuffer.h.html#sldns_buffer" title='sldns_buffer' data-type='struct sldns_buffer' data-ref="sldns_buffer" data-ref-filename="sldns_buffer">sldns_buffer</a>* <dfn class="local col2 decl" id="882buf" title='buf' data-type='sldns_buffer *' data-ref="882buf" data-ref-filename="882buf">buf</dfn>,</td></tr>
<tr><th id="3203">3203</th><td>	<b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col3 decl" id="883temp" title='temp' data-type='struct regional *' data-ref="883temp" data-ref-filename="883temp">temp</dfn>, <b>struct</b> <a class="type" href="cache/dns.h.html#dns_msg" title='dns_msg' data-ref="dns_msg" data-ref-filename="dns_msg">dns_msg</a>* <dfn class="local col4 decl" id="884msg" title='msg' data-type='struct dns_msg *' data-ref="884msg" data-ref-filename="884msg">msg</dfn>)</td></tr>
<tr><th id="3204">3204</th><td>{</td></tr>
<tr><th id="3205">3205</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col5 decl" id="885udpsize" title='udpsize' data-type='uint16_t' data-ref="885udpsize" data-ref-filename="885udpsize">udpsize</dfn>;</td></tr>
<tr><th id="3206">3206</th><td>	<a class="local col5 ref" href="#885udpsize" title='udpsize' data-ref="885udpsize" data-ref-filename="885udpsize">udpsize</a> = <a class="local col0 ref" href="#880edns" title='edns' data-ref="880edns" data-ref-filename="880edns">edns</a>-&gt;<a class="ref field" href="../util/data/msgparse.h.html#edns_data::udp_size" title='edns_data::udp_size' data-ref="edns_data::udp_size" data-ref-filename="edns_data..udp_size">udp_size</a>;</td></tr>
<tr><th id="3207">3207</th><td>	<a class="local col0 ref" href="#880edns" title='edns' data-ref="880edns" data-ref-filename="880edns">edns</a>-&gt;<a class="ref field" href="../util/data/msgparse.h.html#edns_data::edns_version" title='edns_data::edns_version' data-ref="edns_data::edns_version" data-ref-filename="edns_data..edns_version">edns_version</a> = <a class="macro" href="../util/net_help.h.html#82" title="0" data-ref="_M/EDNS_ADVERTISED_VERSION">EDNS_ADVERTISED_VERSION</a>;</td></tr>
<tr><th id="3208">3208</th><td>	<a class="local col0 ref" href="#880edns" title='edns' data-ref="880edns" data-ref-filename="880edns">edns</a>-&gt;<a class="ref field" href="../util/data/msgparse.h.html#edns_data::udp_size" title='edns_data::udp_size' data-ref="edns_data::udp_size" data-ref-filename="edns_data..udp_size">udp_size</a> = <a class="ref" href="../util/net_help.h.html#EDNS_ADVERTISED_SIZE" title='EDNS_ADVERTISED_SIZE' data-ref="EDNS_ADVERTISED_SIZE" data-ref-filename="EDNS_ADVERTISED_SIZE">EDNS_ADVERTISED_SIZE</a>;</td></tr>
<tr><th id="3209">3209</th><td>	<a class="local col0 ref" href="#880edns" title='edns' data-ref="880edns" data-ref-filename="880edns">edns</a>-&gt;<a class="ref field" href="../util/data/msgparse.h.html#edns_data::ext_rcode" title='edns_data::ext_rcode' data-ref="edns_data::ext_rcode" data-ref-filename="edns_data..ext_rcode">ext_rcode</a> = <var>0</var>;</td></tr>
<tr><th id="3210">3210</th><td>	<a class="local col0 ref" href="#880edns" title='edns' data-ref="880edns" data-ref-filename="880edns">edns</a>-&gt;<a class="ref field" href="../util/data/msgparse.h.html#edns_data::bits" title='edns_data::bits' data-ref="edns_data::bits" data-ref-filename="edns_data..bits">bits</a> &amp;= <a class="macro" href="../util/net_help.h.html#86" title="0x8000" data-ref="_M/EDNS_DO">EDNS_DO</a>;</td></tr>
<tr><th id="3211">3211</th><td></td></tr>
<tr><th id="3212">3212</th><td>	<b>if</b>(!<a class="ref fn" href="../util/data/msgreply.h.html#inplace_cb_reply_local_call" title='inplace_cb_reply_local_call' data-ref="inplace_cb_reply_local_call" data-ref-filename="inplace_cb_reply_local_call">inplace_cb_reply_local_call</a>(<a class="local col9 ref" href="#879env" title='env' data-ref="879env" data-ref-filename="879env">env</a>, <a class="local col8 ref" href="#878qinfo" title='qinfo' data-ref="878qinfo" data-ref-filename="878qinfo">qinfo</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>, <a class="local col4 ref" href="#884msg" title='msg' data-ref="884msg" data-ref-filename="884msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>,</td></tr>
<tr><th id="3213">3213</th><td>		(<em>int</em>)<a class="macro" href="../util/net_help.h.html#73" title="((msg-&gt;rep-&gt;flags) &amp; 0xf)" data-ref="_M/FLAGS_GET_RCODE">FLAGS_GET_RCODE</a>(<a class="local col4 ref" href="#884msg" title='msg' data-ref="884msg" data-ref-filename="884msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::flags" title='reply_info::flags' data-ref="reply_info::flags" data-ref-filename="reply_info..flags">flags</a>), <a class="local col0 ref" href="#880edns" title='edns' data-ref="880edns" data-ref-filename="880edns">edns</a>, <a class="local col1 ref" href="#881repinfo" title='repinfo' data-ref="881repinfo" data-ref-filename="881repinfo">repinfo</a>, <a class="local col3 ref" href="#883temp" title='temp' data-ref="883temp" data-ref-filename="883temp">temp</a>)</td></tr>
<tr><th id="3214">3214</th><td>		|| !<a class="ref fn" href="../util/data/msgencode.h.html#reply_info_answer_encode" title='reply_info_answer_encode' data-ref="reply_info_answer_encode" data-ref-filename="reply_info_answer_encode">reply_info_answer_encode</a>(<a class="local col8 ref" href="#878qinfo" title='qinfo' data-ref="878qinfo" data-ref-filename="878qinfo">qinfo</a>, <a class="local col4 ref" href="#884msg" title='msg' data-ref="884msg" data-ref-filename="884msg">msg</a>-&gt;<a class="ref field" href="cache/dns.h.html#dns_msg::rep" title='dns_msg::rep' data-ref="dns_msg::rep" data-ref-filename="dns_msg..rep">rep</a>,</td></tr>
<tr><th id="3215">3215</th><td>		*(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a>*)<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_begin" title='sldns_buffer_begin' data-ref="sldns_buffer_begin" data-ref-filename="sldns_buffer_begin">sldns_buffer_begin</a>(<a class="local col2 ref" href="#882buf" title='buf' data-ref="882buf" data-ref-filename="882buf">buf</a>),</td></tr>
<tr><th id="3216">3216</th><td>		<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u16_at" title='sldns_buffer_read_u16_at' data-ref="sldns_buffer_read_u16_at" data-ref-filename="sldns_buffer_read_u16_at">sldns_buffer_read_u16_at</a>(<a class="local col2 ref" href="#882buf" title='buf' data-ref="882buf" data-ref-filename="882buf">buf</a>, <var>2</var>),</td></tr>
<tr><th id="3217">3217</th><td>		<a class="local col2 ref" href="#882buf" title='buf' data-ref="882buf" data-ref-filename="882buf">buf</a>, <var>0</var>, <var>0</var>, <a class="local col3 ref" href="#883temp" title='temp' data-ref="883temp" data-ref-filename="883temp">temp</a>, <a class="local col5 ref" href="#885udpsize" title='udpsize' data-ref="885udpsize" data-ref-filename="885udpsize">udpsize</a>, <a class="local col0 ref" href="#880edns" title='edns' data-ref="880edns" data-ref-filename="880edns">edns</a>,</td></tr>
<tr><th id="3218">3218</th><td>		(<em>int</em>)(<a class="local col0 ref" href="#880edns" title='edns' data-ref="880edns" data-ref-filename="880edns">edns</a>-&gt;<a class="ref field" href="../util/data/msgparse.h.html#edns_data::bits" title='edns_data::bits' data-ref="edns_data::bits" data-ref-filename="edns_data..bits">bits</a>&amp;<a class="macro" href="../util/net_help.h.html#86" title="0x8000" data-ref="_M/EDNS_DO">EDNS_DO</a>), <var>0</var>)) {</td></tr>
<tr><th id="3219">3219</th><td>		<a class="ref fn" href="../util/data/msgencode.h.html#error_encode" title='error_encode' data-ref="error_encode" data-ref-filename="error_encode">error_encode</a>(<a class="local col2 ref" href="#882buf" title='buf' data-ref="882buf" data-ref-filename="882buf">buf</a>, (<a class="enum" href="../sldns/pkthdr.h.html#LDNS_RCODE_SERVFAIL" title='LDNS_RCODE_SERVFAIL' data-ref="LDNS_RCODE_SERVFAIL" data-ref-filename="LDNS_RCODE_SERVFAIL">LDNS_RCODE_SERVFAIL</a>|<a class="macro" href="../util/net_help.h.html#69" title="0x0400" data-ref="_M/BIT_AA">BIT_AA</a>), <a class="local col8 ref" href="#878qinfo" title='qinfo' data-ref="878qinfo" data-ref-filename="878qinfo">qinfo</a>,</td></tr>
<tr><th id="3220">3220</th><td>			*(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a>*)<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_begin" title='sldns_buffer_begin' data-ref="sldns_buffer_begin" data-ref-filename="sldns_buffer_begin">sldns_buffer_begin</a>(<a class="local col2 ref" href="#882buf" title='buf' data-ref="882buf" data-ref-filename="882buf">buf</a>),</td></tr>
<tr><th id="3221">3221</th><td>			<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u16_at" title='sldns_buffer_read_u16_at' data-ref="sldns_buffer_read_u16_at" data-ref-filename="sldns_buffer_read_u16_at">sldns_buffer_read_u16_at</a>(<a class="local col2 ref" href="#882buf" title='buf' data-ref="882buf" data-ref-filename="882buf">buf</a>, <var>2</var>), <a class="local col0 ref" href="#880edns" title='edns' data-ref="880edns" data-ref-filename="880edns">edns</a>);</td></tr>
<tr><th id="3222">3222</th><td>	}</td></tr>
<tr><th id="3223">3223</th><td>}</td></tr>
<tr><th id="3224">3224</th><td></td></tr>
<tr><th id="3225">3225</th><td><i class="doc" data-doc="auth_error_encode">/** encode auth error answer */</i></td></tr>
<tr><th id="3226">3226</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="3227">3227</th><td><dfn class="tu decl def fn" id="auth_error_encode" title='auth_error_encode' data-type='void auth_error_encode(struct query_info * qinfo, struct module_env * env, struct edns_data * edns, struct comm_reply * repinfo, sldns_buffer * buf, struct regional * temp, int rcode)' data-ref="auth_error_encode" data-ref-filename="auth_error_encode">auth_error_encode</dfn>(<b>struct</b> <a class="type" href="../util/data/msgreply.h.html#query_info" title='query_info' data-ref="query_info" data-ref-filename="query_info">query_info</a>* <dfn class="local col6 decl" id="886qinfo" title='qinfo' data-type='struct query_info *' data-ref="886qinfo" data-ref-filename="886qinfo">qinfo</dfn>, <b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col7 decl" id="887env" title='env' data-type='struct module_env *' data-ref="887env" data-ref-filename="887env">env</dfn>,</td></tr>
<tr><th id="3228">3228</th><td>	<b>struct</b> <a class="type" href="../util/data/msgparse.h.html#edns_data" title='edns_data' data-ref="edns_data" data-ref-filename="edns_data">edns_data</a>* <dfn class="local col8 decl" id="888edns" title='edns' data-type='struct edns_data *' data-ref="888edns" data-ref-filename="888edns">edns</dfn>, <b>struct</b> <a class="type" href="../util/netevent.h.html#comm_reply" title='comm_reply' data-ref="comm_reply" data-ref-filename="comm_reply">comm_reply</a>* <dfn class="local col9 decl" id="889repinfo" title='repinfo' data-type='struct comm_reply *' data-ref="889repinfo" data-ref-filename="889repinfo">repinfo</dfn>, <a class="typedef" href="../sldns/sbuffer.h.html#sldns_buffer" title='sldns_buffer' data-type='struct sldns_buffer' data-ref="sldns_buffer" data-ref-filename="sldns_buffer">sldns_buffer</a>* <dfn class="local col0 decl" id="890buf" title='buf' data-type='sldns_buffer *' data-ref="890buf" data-ref-filename="890buf">buf</dfn>,</td></tr>
<tr><th id="3229">3229</th><td>	<b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col1 decl" id="891temp" title='temp' data-type='struct regional *' data-ref="891temp" data-ref-filename="891temp">temp</dfn>, <em>int</em> <dfn class="local col2 decl" id="892rcode" title='rcode' data-type='int' data-ref="892rcode" data-ref-filename="892rcode">rcode</dfn>)</td></tr>
<tr><th id="3230">3230</th><td>{</td></tr>
<tr><th id="3231">3231</th><td>	<a class="local col8 ref" href="#888edns" title='edns' data-ref="888edns" data-ref-filename="888edns">edns</a>-&gt;<a class="ref field" href="../util/data/msgparse.h.html#edns_data::edns_version" title='edns_data::edns_version' data-ref="edns_data::edns_version" data-ref-filename="edns_data..edns_version">edns_version</a> = <a class="macro" href="../util/net_help.h.html#82" title="0" data-ref="_M/EDNS_ADVERTISED_VERSION">EDNS_ADVERTISED_VERSION</a>;</td></tr>
<tr><th id="3232">3232</th><td>	<a class="local col8 ref" href="#888edns" title='edns' data-ref="888edns" data-ref-filename="888edns">edns</a>-&gt;<a class="ref field" href="../util/data/msgparse.h.html#edns_data::udp_size" title='edns_data::udp_size' data-ref="edns_data::udp_size" data-ref-filename="edns_data..udp_size">udp_size</a> = <a class="ref" href="../util/net_help.h.html#EDNS_ADVERTISED_SIZE" title='EDNS_ADVERTISED_SIZE' data-ref="EDNS_ADVERTISED_SIZE" data-ref-filename="EDNS_ADVERTISED_SIZE">EDNS_ADVERTISED_SIZE</a>;</td></tr>
<tr><th id="3233">3233</th><td>	<a class="local col8 ref" href="#888edns" title='edns' data-ref="888edns" data-ref-filename="888edns">edns</a>-&gt;<a class="ref field" href="../util/data/msgparse.h.html#edns_data::ext_rcode" title='edns_data::ext_rcode' data-ref="edns_data::ext_rcode" data-ref-filename="edns_data..ext_rcode">ext_rcode</a> = <var>0</var>;</td></tr>
<tr><th id="3234">3234</th><td>	<a class="local col8 ref" href="#888edns" title='edns' data-ref="888edns" data-ref-filename="888edns">edns</a>-&gt;<a class="ref field" href="../util/data/msgparse.h.html#edns_data::bits" title='edns_data::bits' data-ref="edns_data::bits" data-ref-filename="edns_data..bits">bits</a> &amp;= <a class="macro" href="../util/net_help.h.html#86" title="0x8000" data-ref="_M/EDNS_DO">EDNS_DO</a>;</td></tr>
<tr><th id="3235">3235</th><td></td></tr>
<tr><th id="3236">3236</th><td>	<b>if</b>(!<a class="ref fn" href="../util/data/msgreply.h.html#inplace_cb_reply_local_call" title='inplace_cb_reply_local_call' data-ref="inplace_cb_reply_local_call" data-ref-filename="inplace_cb_reply_local_call">inplace_cb_reply_local_call</a>(<a class="local col7 ref" href="#887env" title='env' data-ref="887env" data-ref-filename="887env">env</a>, <a class="local col6 ref" href="#886qinfo" title='qinfo' data-ref="886qinfo" data-ref-filename="886qinfo">qinfo</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,</td></tr>
<tr><th id="3237">3237</th><td>		<a class="local col2 ref" href="#892rcode" title='rcode' data-ref="892rcode" data-ref-filename="892rcode">rcode</a>, <a class="local col8 ref" href="#888edns" title='edns' data-ref="888edns" data-ref-filename="888edns">edns</a>, <a class="local col9 ref" href="#889repinfo" title='repinfo' data-ref="889repinfo" data-ref-filename="889repinfo">repinfo</a>, <a class="local col1 ref" href="#891temp" title='temp' data-ref="891temp" data-ref-filename="891temp">temp</a>))</td></tr>
<tr><th id="3238">3238</th><td>		<a class="local col8 ref" href="#888edns" title='edns' data-ref="888edns" data-ref-filename="888edns">edns</a>-&gt;<a class="ref field" href="../util/data/msgparse.h.html#edns_data::opt_list" title='edns_data::opt_list' data-ref="edns_data::opt_list" data-ref-filename="edns_data..opt_list">opt_list</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="3239">3239</th><td>	<a class="ref fn" href="../util/data/msgencode.h.html#error_encode" title='error_encode' data-ref="error_encode" data-ref-filename="error_encode">error_encode</a>(<a class="local col0 ref" href="#890buf" title='buf' data-ref="890buf" data-ref-filename="890buf">buf</a>, <a class="local col2 ref" href="#892rcode" title='rcode' data-ref="892rcode" data-ref-filename="892rcode">rcode</a>|<a class="macro" href="../util/net_help.h.html#69" title="0x0400" data-ref="_M/BIT_AA">BIT_AA</a>, <a class="local col6 ref" href="#886qinfo" title='qinfo' data-ref="886qinfo" data-ref-filename="886qinfo">qinfo</a>,</td></tr>
<tr><th id="3240">3240</th><td>		*(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a>*)<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_begin" title='sldns_buffer_begin' data-ref="sldns_buffer_begin" data-ref-filename="sldns_buffer_begin">sldns_buffer_begin</a>(<a class="local col0 ref" href="#890buf" title='buf' data-ref="890buf" data-ref-filename="890buf">buf</a>),</td></tr>
<tr><th id="3241">3241</th><td>		<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u16_at" title='sldns_buffer_read_u16_at' data-ref="sldns_buffer_read_u16_at" data-ref-filename="sldns_buffer_read_u16_at">sldns_buffer_read_u16_at</a>(<a class="local col0 ref" href="#890buf" title='buf' data-ref="890buf" data-ref-filename="890buf">buf</a>, <var>2</var>), <a class="local col8 ref" href="#888edns" title='edns' data-ref="888edns" data-ref-filename="888edns">edns</a>);</td></tr>
<tr><th id="3242">3242</th><td>}</td></tr>
<tr><th id="3243">3243</th><td></td></tr>
<tr><th id="3244">3244</th><td><em>int</em> <dfn class="decl def fn" id="auth_zones_answer" title='auth_zones_answer' data-ref="auth_zones_answer" data-ref-filename="auth_zones_answer">auth_zones_answer</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zones" title='auth_zones' data-ref="auth_zones" data-ref-filename="auth_zones">auth_zones</a>* <dfn class="local col3 decl" id="893az" title='az' data-type='struct auth_zones *' data-ref="893az" data-ref-filename="893az">az</dfn>, <b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col4 decl" id="894env" title='env' data-type='struct module_env *' data-ref="894env" data-ref-filename="894env">env</dfn>,</td></tr>
<tr><th id="3245">3245</th><td>	<b>struct</b> <a class="type" href="../util/data/msgreply.h.html#query_info" title='query_info' data-ref="query_info" data-ref-filename="query_info">query_info</a>* <dfn class="local col5 decl" id="895qinfo" title='qinfo' data-type='struct query_info *' data-ref="895qinfo" data-ref-filename="895qinfo">qinfo</dfn>, <b>struct</b> <a class="type" href="../util/data/msgparse.h.html#edns_data" title='edns_data' data-ref="edns_data" data-ref-filename="edns_data">edns_data</a>* <dfn class="local col6 decl" id="896edns" title='edns' data-type='struct edns_data *' data-ref="896edns" data-ref-filename="896edns">edns</dfn>,</td></tr>
<tr><th id="3246">3246</th><td>	<b>struct</b> <a class="type" href="../util/netevent.h.html#comm_reply" title='comm_reply' data-ref="comm_reply" data-ref-filename="comm_reply">comm_reply</a>* <dfn class="local col7 decl" id="897repinfo" title='repinfo' data-type='struct comm_reply *' data-ref="897repinfo" data-ref-filename="897repinfo">repinfo</dfn>, <b>struct</b> <a class="type" href="../sldns/sbuffer.h.html#sldns_buffer" title='sldns_buffer' data-ref="sldns_buffer" data-ref-filename="sldns_buffer">sldns_buffer</a>* <dfn class="local col8 decl" id="898buf" title='buf' data-type='struct sldns_buffer *' data-ref="898buf" data-ref-filename="898buf">buf</dfn>, <b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col9 decl" id="899temp" title='temp' data-type='struct regional *' data-ref="899temp" data-ref-filename="899temp">temp</dfn>)</td></tr>
<tr><th id="3247">3247</th><td>{</td></tr>
<tr><th id="3248">3248</th><td>	<b>struct</b> <a class="type" href="cache/dns.h.html#dns_msg" title='dns_msg' data-ref="dns_msg" data-ref-filename="dns_msg">dns_msg</a>* <dfn class="local col0 decl" id="900msg" title='msg' data-type='struct dns_msg *' data-ref="900msg" data-ref-filename="900msg">msg</dfn> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="3249">3249</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col1 decl" id="901z" title='z' data-type='struct auth_zone *' data-ref="901z" data-ref-filename="901z">z</dfn>;</td></tr>
<tr><th id="3250">3250</th><td>	<em>int</em> <dfn class="local col2 decl" id="902r" title='r' data-type='int' data-ref="902r" data-ref-filename="902r">r</dfn>;</td></tr>
<tr><th id="3251">3251</th><td>	<em>int</em> <dfn class="local col3 decl" id="903fallback" title='fallback' data-type='int' data-ref="903fallback" data-ref-filename="903fallback">fallback</dfn> = <var>0</var>;</td></tr>
<tr><th id="3252">3252</th><td></td></tr>
<tr><th id="3253">3253</th><td>	<a class="macro" href="../util/locks.h.html#119" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_rdlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_rdlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3253, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_rdlock">lock_rw_rdlock</a>(&amp;<a class="local col3 ref" href="#893az" title='az' data-ref="893az" data-ref-filename="893az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="3254">3254</th><td>	<b>if</b>(!<a class="local col3 ref" href="#893az" title='az' data-ref="893az" data-ref-filename="893az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::have_downstream" title='auth_zones::have_downstream' data-ref="auth_zones::have_downstream" data-ref-filename="auth_zones..have_downstream">have_downstream</a>) {</td></tr>
<tr><th id="3255">3255</th><td>		<i>/* no downstream auth zones */</i></td></tr>
<tr><th id="3256">3256</th><td>		<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3256, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col3 ref" href="#893az" title='az' data-ref="893az" data-ref-filename="893az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="3257">3257</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3258">3258</th><td>	}</td></tr>
<tr><th id="3259">3259</th><td>	<b>if</b>(<a class="local col5 ref" href="#895qinfo" title='qinfo' data-ref="895qinfo" data-ref-filename="895qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qtype" title='query_info::qtype' data-ref="query_info::qtype" data-ref-filename="query_info..qtype">qtype</a> == <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_DS" title='LDNS_RR_TYPE_DS' data-ref="LDNS_RR_TYPE_DS" data-ref-filename="LDNS_RR_TYPE_DS">LDNS_RR_TYPE_DS</a>) {</td></tr>
<tr><th id="3260">3260</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col4 decl" id="904delname" title='delname' data-type='uint8_t *' data-ref="904delname" data-ref-filename="904delname">delname</dfn> = <a class="local col5 ref" href="#895qinfo" title='qinfo' data-ref="895qinfo" data-ref-filename="895qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname" title='query_info::qname' data-ref="query_info::qname" data-ref-filename="query_info..qname">qname</a>;</td></tr>
<tr><th id="3261">3261</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col5 decl" id="905delnamelen" title='delnamelen' data-type='size_t' data-ref="905delnamelen" data-ref-filename="905delnamelen">delnamelen</dfn> = <a class="local col5 ref" href="#895qinfo" title='qinfo' data-ref="895qinfo" data-ref-filename="895qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname_len" title='query_info::qname_len' data-ref="query_info::qname_len" data-ref-filename="query_info..qname_len">qname_len</a>;</td></tr>
<tr><th id="3262">3262</th><td>		<a class="ref fn" href="../util/data/dname.h.html#dname_remove_label" title='dname_remove_label' data-ref="dname_remove_label" data-ref-filename="dname_remove_label">dname_remove_label</a>(&amp;<a class="local col4 ref" href="#904delname" title='delname' data-ref="904delname" data-ref-filename="904delname">delname</a>, &amp;<a class="local col5 ref" href="#905delnamelen" title='delnamelen' data-ref="905delnamelen" data-ref-filename="905delnamelen">delnamelen</a>);</td></tr>
<tr><th id="3263">3263</th><td>		<a class="local col1 ref" href="#901z" title='z' data-ref="901z" data-ref-filename="901z">z</a> = <a class="ref fn" href="#auth_zones_find_zone" title='auth_zones_find_zone' data-ref="auth_zones_find_zone" data-ref-filename="auth_zones_find_zone">auth_zones_find_zone</a>(<a class="local col3 ref" href="#893az" title='az' data-ref="893az" data-ref-filename="893az">az</a>, <a class="local col4 ref" href="#904delname" title='delname' data-ref="904delname" data-ref-filename="904delname">delname</a>, <a class="local col5 ref" href="#905delnamelen" title='delnamelen' data-ref="905delnamelen" data-ref-filename="905delnamelen">delnamelen</a>,</td></tr>
<tr><th id="3264">3264</th><td>			<a class="local col5 ref" href="#895qinfo" title='qinfo' data-ref="895qinfo" data-ref-filename="895qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qclass" title='query_info::qclass' data-ref="query_info::qclass" data-ref-filename="query_info..qclass">qclass</a>);</td></tr>
<tr><th id="3265">3265</th><td>	} <b>else</b> {</td></tr>
<tr><th id="3266">3266</th><td>		<a class="local col1 ref" href="#901z" title='z' data-ref="901z" data-ref-filename="901z">z</a> = <a class="ref fn" href="#auth_zones_find_zone" title='auth_zones_find_zone' data-ref="auth_zones_find_zone" data-ref-filename="auth_zones_find_zone">auth_zones_find_zone</a>(<a class="local col3 ref" href="#893az" title='az' data-ref="893az" data-ref-filename="893az">az</a>, <a class="local col5 ref" href="#895qinfo" title='qinfo' data-ref="895qinfo" data-ref-filename="895qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname" title='query_info::qname' data-ref="query_info::qname" data-ref-filename="query_info..qname">qname</a>, <a class="local col5 ref" href="#895qinfo" title='qinfo' data-ref="895qinfo" data-ref-filename="895qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname_len" title='query_info::qname_len' data-ref="query_info::qname_len" data-ref-filename="query_info..qname_len">qname_len</a>,</td></tr>
<tr><th id="3267">3267</th><td>			<a class="local col5 ref" href="#895qinfo" title='qinfo' data-ref="895qinfo" data-ref-filename="895qinfo">qinfo</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#query_info::qclass" title='query_info::qclass' data-ref="query_info::qclass" data-ref-filename="query_info..qclass">qclass</a>);</td></tr>
<tr><th id="3268">3268</th><td>	}</td></tr>
<tr><th id="3269">3269</th><td>	<b>if</b>(!<a class="local col1 ref" href="#901z" title='z' data-ref="901z" data-ref-filename="901z">z</a>) {</td></tr>
<tr><th id="3270">3270</th><td>		<i>/* no zone above it */</i></td></tr>
<tr><th id="3271">3271</th><td>		<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3271, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col3 ref" href="#893az" title='az' data-ref="893az" data-ref-filename="893az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="3272">3272</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3273">3273</th><td>	}</td></tr>
<tr><th id="3274">3274</th><td>	<a class="macro" href="../util/locks.h.html#119" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_rdlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_rdlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3274, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_rdlock">lock_rw_rdlock</a>(&amp;<a class="local col1 ref" href="#901z" title='z' data-ref="901z" data-ref-filename="901z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="3275">3275</th><td>	<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3275, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col3 ref" href="#893az" title='az' data-ref="893az" data-ref-filename="893az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="3276">3276</th><td>	<b>if</b>(!<a class="local col1 ref" href="#901z" title='z' data-ref="901z" data-ref-filename="901z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::for_downstream" title='auth_zone::for_downstream' data-ref="auth_zone::for_downstream" data-ref-filename="auth_zone..for_downstream">for_downstream</a>) {</td></tr>
<tr><th id="3277">3277</th><td>		<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3277, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col1 ref" href="#901z" title='z' data-ref="901z" data-ref-filename="901z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="3278">3278</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3279">3279</th><td>	}</td></tr>
<tr><th id="3280">3280</th><td>	<b>if</b>(<a class="local col1 ref" href="#901z" title='z' data-ref="901z" data-ref-filename="901z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::zone_expired" title='auth_zone::zone_expired' data-ref="auth_zone::zone_expired" data-ref-filename="auth_zone..zone_expired">zone_expired</a>) {</td></tr>
<tr><th id="3281">3281</th><td>		<b>if</b>(<a class="local col1 ref" href="#901z" title='z' data-ref="901z" data-ref-filename="901z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::fallback_enabled" title='auth_zone::fallback_enabled' data-ref="auth_zone::fallback_enabled" data-ref-filename="auth_zone..fallback_enabled">fallback_enabled</a>) {</td></tr>
<tr><th id="3282">3282</th><td>			<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3282, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col1 ref" href="#901z" title='z' data-ref="901z" data-ref-filename="901z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="3283">3283</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3284">3284</th><td>		}</td></tr>
<tr><th id="3285">3285</th><td>		<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3285, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col1 ref" href="#901z" title='z' data-ref="901z" data-ref-filename="901z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="3286">3286</th><td>		<a class="macro" href="../util/locks.h.html#120" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_wrlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_wrlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3286, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_wrlock">lock_rw_wrlock</a>(&amp;<a class="local col3 ref" href="#893az" title='az' data-ref="893az" data-ref-filename="893az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="3287">3287</th><td>		<a class="local col3 ref" href="#893az" title='az' data-ref="893az" data-ref-filename="893az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::num_query_down" title='auth_zones::num_query_down' data-ref="auth_zones::num_query_down" data-ref-filename="auth_zones..num_query_down">num_query_down</a>++;</td></tr>
<tr><th id="3288">3288</th><td>		<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3288, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col3 ref" href="#893az" title='az' data-ref="893az" data-ref-filename="893az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="3289">3289</th><td>		<a class="tu ref fn" href="#auth_error_encode" title='auth_error_encode' data-use='c' data-ref="auth_error_encode" data-ref-filename="auth_error_encode">auth_error_encode</a>(<a class="local col5 ref" href="#895qinfo" title='qinfo' data-ref="895qinfo" data-ref-filename="895qinfo">qinfo</a>, <a class="local col4 ref" href="#894env" title='env' data-ref="894env" data-ref-filename="894env">env</a>, <a class="local col6 ref" href="#896edns" title='edns' data-ref="896edns" data-ref-filename="896edns">edns</a>, <a class="local col7 ref" href="#897repinfo" title='repinfo' data-ref="897repinfo" data-ref-filename="897repinfo">repinfo</a>, <a class="local col8 ref" href="#898buf" title='buf' data-ref="898buf" data-ref-filename="898buf">buf</a>, <a class="local col9 ref" href="#899temp" title='temp' data-ref="899temp" data-ref-filename="899temp">temp</a>,</td></tr>
<tr><th id="3290">3290</th><td>			<a class="enum" href="../sldns/pkthdr.h.html#LDNS_RCODE_SERVFAIL" title='LDNS_RCODE_SERVFAIL' data-ref="LDNS_RCODE_SERVFAIL" data-ref-filename="LDNS_RCODE_SERVFAIL">LDNS_RCODE_SERVFAIL</a>);</td></tr>
<tr><th id="3291">3291</th><td>		<b>return</b> <var>1</var>;</td></tr>
<tr><th id="3292">3292</th><td>	}</td></tr>
<tr><th id="3293">3293</th><td></td></tr>
<tr><th id="3294">3294</th><td>	<i>/* answer it from zone z */</i></td></tr>
<tr><th id="3295">3295</th><td>	<a class="local col2 ref" href="#902r" title='r' data-ref="902r" data-ref-filename="902r">r</a> = <a class="tu ref fn" href="#auth_zone_generate_answer" title='auth_zone_generate_answer' data-use='c' data-ref="auth_zone_generate_answer" data-ref-filename="auth_zone_generate_answer">auth_zone_generate_answer</a>(<a class="local col1 ref" href="#901z" title='z' data-ref="901z" data-ref-filename="901z">z</a>, <a class="local col5 ref" href="#895qinfo" title='qinfo' data-ref="895qinfo" data-ref-filename="895qinfo">qinfo</a>, <a class="local col9 ref" href="#899temp" title='temp' data-ref="899temp" data-ref-filename="899temp">temp</a>, &amp;<a class="local col0 ref" href="#900msg" title='msg' data-ref="900msg" data-ref-filename="900msg">msg</a>, &amp;<a class="local col3 ref" href="#903fallback" title='fallback' data-ref="903fallback" data-ref-filename="903fallback">fallback</a>);</td></tr>
<tr><th id="3296">3296</th><td>	<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3296, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col1 ref" href="#901z" title='z' data-ref="901z" data-ref-filename="901z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="3297">3297</th><td>	<b>if</b>(!<a class="local col2 ref" href="#902r" title='r' data-ref="902r" data-ref-filename="902r">r</a> &amp;&amp; <a class="local col3 ref" href="#903fallback" title='fallback' data-ref="903fallback" data-ref-filename="903fallback">fallback</a>) {</td></tr>
<tr><th id="3298">3298</th><td>		<i>/* fallback to regular answering (recursive) */</i></td></tr>
<tr><th id="3299">3299</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3300">3300</th><td>	}</td></tr>
<tr><th id="3301">3301</th><td>	<a class="macro" href="../util/locks.h.html#120" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_wrlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_wrlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3301, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_wrlock">lock_rw_wrlock</a>(&amp;<a class="local col3 ref" href="#893az" title='az' data-ref="893az" data-ref-filename="893az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="3302">3302</th><td>	<a class="local col3 ref" href="#893az" title='az' data-ref="893az" data-ref-filename="893az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::num_query_down" title='auth_zones::num_query_down' data-ref="auth_zones::num_query_down" data-ref-filename="auth_zones..num_query_down">num_query_down</a>++;</td></tr>
<tr><th id="3303">3303</th><td>	<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3303, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col3 ref" href="#893az" title='az' data-ref="893az" data-ref-filename="893az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="3304">3304</th><td></td></tr>
<tr><th id="3305">3305</th><td>	<i>/* encode answer */</i></td></tr>
<tr><th id="3306">3306</th><td>	<b>if</b>(!<a class="local col2 ref" href="#902r" title='r' data-ref="902r" data-ref-filename="902r">r</a>)</td></tr>
<tr><th id="3307">3307</th><td>		<a class="tu ref fn" href="#auth_error_encode" title='auth_error_encode' data-use='c' data-ref="auth_error_encode" data-ref-filename="auth_error_encode">auth_error_encode</a>(<a class="local col5 ref" href="#895qinfo" title='qinfo' data-ref="895qinfo" data-ref-filename="895qinfo">qinfo</a>, <a class="local col4 ref" href="#894env" title='env' data-ref="894env" data-ref-filename="894env">env</a>, <a class="local col6 ref" href="#896edns" title='edns' data-ref="896edns" data-ref-filename="896edns">edns</a>, <a class="local col7 ref" href="#897repinfo" title='repinfo' data-ref="897repinfo" data-ref-filename="897repinfo">repinfo</a>, <a class="local col8 ref" href="#898buf" title='buf' data-ref="898buf" data-ref-filename="898buf">buf</a>, <a class="local col9 ref" href="#899temp" title='temp' data-ref="899temp" data-ref-filename="899temp">temp</a>,</td></tr>
<tr><th id="3308">3308</th><td>			<a class="enum" href="../sldns/pkthdr.h.html#LDNS_RCODE_SERVFAIL" title='LDNS_RCODE_SERVFAIL' data-ref="LDNS_RCODE_SERVFAIL" data-ref-filename="LDNS_RCODE_SERVFAIL">LDNS_RCODE_SERVFAIL</a>);</td></tr>
<tr><th id="3309">3309</th><td>	<b>else</b>	<a class="tu ref fn" href="#auth_answer_encode" title='auth_answer_encode' data-use='c' data-ref="auth_answer_encode" data-ref-filename="auth_answer_encode">auth_answer_encode</a>(<a class="local col5 ref" href="#895qinfo" title='qinfo' data-ref="895qinfo" data-ref-filename="895qinfo">qinfo</a>, <a class="local col4 ref" href="#894env" title='env' data-ref="894env" data-ref-filename="894env">env</a>, <a class="local col6 ref" href="#896edns" title='edns' data-ref="896edns" data-ref-filename="896edns">edns</a>, <a class="local col7 ref" href="#897repinfo" title='repinfo' data-ref="897repinfo" data-ref-filename="897repinfo">repinfo</a>, <a class="local col8 ref" href="#898buf" title='buf' data-ref="898buf" data-ref-filename="898buf">buf</a>, <a class="local col9 ref" href="#899temp" title='temp' data-ref="899temp" data-ref-filename="899temp">temp</a>, <a class="local col0 ref" href="#900msg" title='msg' data-ref="900msg" data-ref-filename="900msg">msg</a>);</td></tr>
<tr><th id="3310">3310</th><td></td></tr>
<tr><th id="3311">3311</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="3312">3312</th><td>}</td></tr>
<tr><th id="3313">3313</th><td></td></tr>
<tr><th id="3314">3314</th><td><em>int</em> <dfn class="decl def fn" id="auth_zones_can_fallback" title='auth_zones_can_fallback' data-ref="auth_zones_can_fallback" data-ref-filename="auth_zones_can_fallback">auth_zones_can_fallback</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zones" title='auth_zones' data-ref="auth_zones" data-ref-filename="auth_zones">auth_zones</a>* <dfn class="local col6 decl" id="906az" title='az' data-type='struct auth_zones *' data-ref="906az" data-ref-filename="906az">az</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col7 decl" id="907nm" title='nm' data-type='uint8_t *' data-ref="907nm" data-ref-filename="907nm">nm</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col8 decl" id="908nmlen" title='nmlen' data-type='size_t' data-ref="908nmlen" data-ref-filename="908nmlen">nmlen</dfn>,</td></tr>
<tr><th id="3315">3315</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col9 decl" id="909dclass" title='dclass' data-type='uint16_t' data-ref="909dclass" data-ref-filename="909dclass">dclass</dfn>)</td></tr>
<tr><th id="3316">3316</th><td>{</td></tr>
<tr><th id="3317">3317</th><td>	<em>int</em> <dfn class="local col0 decl" id="910r" title='r' data-type='int' data-ref="910r" data-ref-filename="910r">r</dfn>;</td></tr>
<tr><th id="3318">3318</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col1 decl" id="911z" title='z' data-type='struct auth_zone *' data-ref="911z" data-ref-filename="911z">z</dfn>;</td></tr>
<tr><th id="3319">3319</th><td>	<a class="macro" href="../util/locks.h.html#119" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_rdlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_rdlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3319, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_rdlock">lock_rw_rdlock</a>(&amp;<a class="local col6 ref" href="#906az" title='az' data-ref="906az" data-ref-filename="906az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="3320">3320</th><td>	<a class="local col1 ref" href="#911z" title='z' data-ref="911z" data-ref-filename="911z">z</a> = <a class="ref fn" href="#auth_zone_find" title='auth_zone_find' data-ref="auth_zone_find" data-ref-filename="auth_zone_find">auth_zone_find</a>(<a class="local col6 ref" href="#906az" title='az' data-ref="906az" data-ref-filename="906az">az</a>, <a class="local col7 ref" href="#907nm" title='nm' data-ref="907nm" data-ref-filename="907nm">nm</a>, <a class="local col8 ref" href="#908nmlen" title='nmlen' data-ref="908nmlen" data-ref-filename="908nmlen">nmlen</a>, <a class="local col9 ref" href="#909dclass" title='dclass' data-ref="909dclass" data-ref-filename="909dclass">dclass</a>);</td></tr>
<tr><th id="3321">3321</th><td>	<b>if</b>(!<a class="local col1 ref" href="#911z" title='z' data-ref="911z" data-ref-filename="911z">z</a>) {</td></tr>
<tr><th id="3322">3322</th><td>		<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3322, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col6 ref" href="#906az" title='az' data-ref="906az" data-ref-filename="906az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="3323">3323</th><td>		<i>/* no such auth zone, fallback */</i></td></tr>
<tr><th id="3324">3324</th><td>		<b>return</b> <var>1</var>;</td></tr>
<tr><th id="3325">3325</th><td>	}</td></tr>
<tr><th id="3326">3326</th><td>	<a class="macro" href="../util/locks.h.html#119" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_rdlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_rdlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3326, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_rdlock">lock_rw_rdlock</a>(&amp;<a class="local col1 ref" href="#911z" title='z' data-ref="911z" data-ref-filename="911z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="3327">3327</th><td>	<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3327, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col6 ref" href="#906az" title='az' data-ref="906az" data-ref-filename="906az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="3328">3328</th><td>	<a class="local col0 ref" href="#910r" title='r' data-ref="910r" data-ref-filename="910r">r</a> = <a class="local col1 ref" href="#911z" title='z' data-ref="911z" data-ref-filename="911z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::fallback_enabled" title='auth_zone::fallback_enabled' data-ref="auth_zone::fallback_enabled" data-ref-filename="auth_zone..fallback_enabled">fallback_enabled</a> || (!<a class="local col1 ref" href="#911z" title='z' data-ref="911z" data-ref-filename="911z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::for_upstream" title='auth_zone::for_upstream' data-ref="auth_zone::for_upstream" data-ref-filename="auth_zone..for_upstream">for_upstream</a>);</td></tr>
<tr><th id="3329">3329</th><td>	<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3329, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col1 ref" href="#911z" title='z' data-ref="911z" data-ref-filename="911z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="3330">3330</th><td>	<b>return</b> <a class="local col0 ref" href="#910r" title='r' data-ref="910r" data-ref-filename="910r">r</a>;</td></tr>
<tr><th id="3331">3331</th><td>}</td></tr>
<tr><th id="3332">3332</th><td></td></tr>
<tr><th id="3333">3333</th><td><em>int</em></td></tr>
<tr><th id="3334">3334</th><td><dfn class="decl def fn" id="auth_zone_parse_notify_serial" title='auth_zone_parse_notify_serial' data-ref="auth_zone_parse_notify_serial" data-ref-filename="auth_zone_parse_notify_serial">auth_zone_parse_notify_serial</dfn>(<a class="typedef" href="../sldns/sbuffer.h.html#sldns_buffer" title='sldns_buffer' data-type='struct sldns_buffer' data-ref="sldns_buffer" data-ref-filename="sldns_buffer">sldns_buffer</a>* <dfn class="local col2 decl" id="912pkt" title='pkt' data-type='sldns_buffer *' data-ref="912pkt" data-ref-filename="912pkt">pkt</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a> *<dfn class="local col3 decl" id="913serial" title='serial' data-type='uint32_t *' data-ref="913serial" data-ref-filename="913serial">serial</dfn>)</td></tr>
<tr><th id="3335">3335</th><td>{</td></tr>
<tr><th id="3336">3336</th><td>	<b>struct</b> <a class="type" href="../util/data/msgreply.h.html#query_info" title='query_info' data-ref="query_info" data-ref-filename="query_info">query_info</a> <dfn class="local col4 decl" id="914q" title='q' data-type='struct query_info' data-ref="914q" data-ref-filename="914q">q</dfn>;</td></tr>
<tr><th id="3337">3337</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col5 decl" id="915rdlen" title='rdlen' data-type='uint16_t' data-ref="915rdlen" data-ref-filename="915rdlen">rdlen</dfn>;</td></tr>
<tr><th id="3338">3338</th><td>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#97" title="((__builtin_object_size(&amp;q, 0) != (size_t)-1) ? __builtin___memset_chk(&amp;q, 0, sizeof(q), __builtin_object_size(&amp;q, 0)) : __memset_ichk(&amp;q, 0, sizeof(q)))" data-ref="_M/memset">memset</a>(&amp;<a class="local col4 ref" href="#914q" title='q' data-ref="914q" data-ref-filename="914q">q</a>, <var>0</var>, <b>sizeof</b>(<a class="local col4 ref" href="#914q" title='q' data-ref="914q" data-ref-filename="914q">q</a>));</td></tr>
<tr><th id="3339">3339</th><td>	<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_set_position" title='sldns_buffer_set_position' data-ref="sldns_buffer_set_position" data-ref-filename="sldns_buffer_set_position">sldns_buffer_set_position</a>(<a class="local col2 ref" href="#912pkt" title='pkt' data-ref="912pkt" data-ref-filename="912pkt">pkt</a>, <var>0</var>);</td></tr>
<tr><th id="3340">3340</th><td>	<b>if</b>(!<a class="ref fn" href="../util/data/msgreply.h.html#query_info_parse" title='query_info_parse' data-ref="query_info_parse" data-ref-filename="query_info_parse">query_info_parse</a>(&amp;<a class="local col4 ref" href="#914q" title='q' data-ref="914q" data-ref-filename="914q">q</a>, <a class="local col2 ref" href="#912pkt" title='pkt' data-ref="912pkt" data-ref-filename="912pkt">pkt</a>)) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="3341">3341</th><td>	<b>if</b>(<a class="macro" href="../sldns/pkthdr.h.html#103" title="(sldns_read_uint16(sldns_buffer_begin(pkt)+6))" data-ref="_M/LDNS_ANCOUNT">LDNS_ANCOUNT</a>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_begin" title='sldns_buffer_begin' data-ref="sldns_buffer_begin" data-ref-filename="sldns_buffer_begin">sldns_buffer_begin</a>(<a class="local col2 ref" href="#912pkt" title='pkt' data-ref="912pkt" data-ref-filename="912pkt">pkt</a>)) == <var>0</var>) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="3342">3342</th><td>	<i>/* skip name of RR in answer section */</i></td></tr>
<tr><th id="3343">3343</th><td>	<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_remaining" title='sldns_buffer_remaining' data-ref="sldns_buffer_remaining" data-ref-filename="sldns_buffer_remaining">sldns_buffer_remaining</a>(<a class="local col2 ref" href="#912pkt" title='pkt' data-ref="912pkt" data-ref-filename="912pkt">pkt</a>) &lt; <var>1</var>) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="3344">3344</th><td>	<b>if</b>(<a class="ref fn" href="../util/data/dname.h.html#pkt_dname_len" title='pkt_dname_len' data-ref="pkt_dname_len" data-ref-filename="pkt_dname_len">pkt_dname_len</a>(<a class="local col2 ref" href="#912pkt" title='pkt' data-ref="912pkt" data-ref-filename="912pkt">pkt</a>) == <var>0</var>) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="3345">3345</th><td>	<i>/* check type */</i></td></tr>
<tr><th id="3346">3346</th><td>	<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_remaining" title='sldns_buffer_remaining' data-ref="sldns_buffer_remaining" data-ref-filename="sldns_buffer_remaining">sldns_buffer_remaining</a>(<a class="local col2 ref" href="#912pkt" title='pkt' data-ref="912pkt" data-ref-filename="912pkt">pkt</a>) &lt; <var>10</var> <i>/* type,class,ttl,rdatalen*/</i>)</td></tr>
<tr><th id="3347">3347</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3348">3348</th><td>	<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u16" title='sldns_buffer_read_u16' data-ref="sldns_buffer_read_u16" data-ref-filename="sldns_buffer_read_u16">sldns_buffer_read_u16</a>(<a class="local col2 ref" href="#912pkt" title='pkt' data-ref="912pkt" data-ref-filename="912pkt">pkt</a>) != <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_SOA" title='LDNS_RR_TYPE_SOA' data-ref="LDNS_RR_TYPE_SOA" data-ref-filename="LDNS_RR_TYPE_SOA">LDNS_RR_TYPE_SOA</a>) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="3349">3349</th><td>	<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_skip" title='sldns_buffer_skip' data-ref="sldns_buffer_skip" data-ref-filename="sldns_buffer_skip">sldns_buffer_skip</a>(<a class="local col2 ref" href="#912pkt" title='pkt' data-ref="912pkt" data-ref-filename="912pkt">pkt</a>, <var>2</var>); <i>/* class */</i></td></tr>
<tr><th id="3350">3350</th><td>	<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_skip" title='sldns_buffer_skip' data-ref="sldns_buffer_skip" data-ref-filename="sldns_buffer_skip">sldns_buffer_skip</a>(<a class="local col2 ref" href="#912pkt" title='pkt' data-ref="912pkt" data-ref-filename="912pkt">pkt</a>, <var>4</var>); <i>/* ttl */</i></td></tr>
<tr><th id="3351">3351</th><td>	<a class="local col5 ref" href="#915rdlen" title='rdlen' data-ref="915rdlen" data-ref-filename="915rdlen">rdlen</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u16" title='sldns_buffer_read_u16' data-ref="sldns_buffer_read_u16" data-ref-filename="sldns_buffer_read_u16">sldns_buffer_read_u16</a>(<a class="local col2 ref" href="#912pkt" title='pkt' data-ref="912pkt" data-ref-filename="912pkt">pkt</a>); <i>/* rdatalen */</i></td></tr>
<tr><th id="3352">3352</th><td>	<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_remaining" title='sldns_buffer_remaining' data-ref="sldns_buffer_remaining" data-ref-filename="sldns_buffer_remaining">sldns_buffer_remaining</a>(<a class="local col2 ref" href="#912pkt" title='pkt' data-ref="912pkt" data-ref-filename="912pkt">pkt</a>) &lt; <a class="local col5 ref" href="#915rdlen" title='rdlen' data-ref="915rdlen" data-ref-filename="915rdlen">rdlen</a>) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="3353">3353</th><td>	<b>if</b>(<a class="local col5 ref" href="#915rdlen" title='rdlen' data-ref="915rdlen" data-ref-filename="915rdlen">rdlen</a> &lt; <var>22</var>) <b>return</b> <var>0</var>; <i>/* bad soa length */</i></td></tr>
<tr><th id="3354">3354</th><td>	<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_skip" title='sldns_buffer_skip' data-ref="sldns_buffer_skip" data-ref-filename="sldns_buffer_skip">sldns_buffer_skip</a>(<a class="local col2 ref" href="#912pkt" title='pkt' data-ref="912pkt" data-ref-filename="912pkt">pkt</a>, (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#ssize_t" title='ssize_t' data-type='int' data-ref="ssize_t" data-ref-filename="ssize_t">ssize_t</a>)(<a class="local col5 ref" href="#915rdlen" title='rdlen' data-ref="915rdlen" data-ref-filename="915rdlen">rdlen</a>-<var>20</var>));</td></tr>
<tr><th id="3355">3355</th><td>	*<a class="local col3 ref" href="#913serial" title='serial' data-ref="913serial" data-ref-filename="913serial">serial</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u32" title='sldns_buffer_read_u32' data-ref="sldns_buffer_read_u32" data-ref-filename="sldns_buffer_read_u32">sldns_buffer_read_u32</a>(<a class="local col2 ref" href="#912pkt" title='pkt' data-ref="912pkt" data-ref-filename="912pkt">pkt</a>);</td></tr>
<tr><th id="3356">3356</th><td>	<i>/* return true when has serial in answer section */</i></td></tr>
<tr><th id="3357">3357</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="3358">3358</th><td>}</td></tr>
<tr><th id="3359">3359</th><td></td></tr>
<tr><th id="3360">3360</th><td><i class="doc" data-doc="addr_in_list">/** see if addr appears in the list */</i></td></tr>
<tr><th id="3361">3361</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="3362">3362</th><td><dfn class="tu decl def fn" id="addr_in_list" title='addr_in_list' data-type='int addr_in_list(struct auth_addr * list, struct sockaddr_storage * addr, __socklen_t addrlen)' data-ref="addr_in_list" data-ref-filename="addr_in_list">addr_in_list</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_addr" title='auth_addr' data-ref="auth_addr" data-ref-filename="auth_addr">auth_addr</a>* <dfn class="local col6 decl" id="916list" title='list' data-type='struct auth_addr *' data-ref="916list" data-ref-filename="916list">list</dfn>, <b>struct</b> <a class="type" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#sockaddr_storage" title='sockaddr_storage' data-ref="sockaddr_storage" data-ref-filename="sockaddr_storage">sockaddr_storage</a>* <dfn class="local col7 decl" id="917addr" title='addr' data-type='struct sockaddr_storage *' data-ref="917addr" data-ref-filename="917addr">addr</dfn>,</td></tr>
<tr><th id="3363">3363</th><td>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#84" title="__socklen_t" data-ref="_M/socklen_t">socklen_t</a> <dfn class="local col8 decl" id="918addrlen" title='addrlen' data-type='__socklen_t' data-ref="918addrlen" data-ref-filename="918addrlen">addrlen</dfn>)</td></tr>
<tr><th id="3364">3364</th><td>{</td></tr>
<tr><th id="3365">3365</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_addr" title='auth_addr' data-ref="auth_addr" data-ref-filename="auth_addr">auth_addr</a>* <dfn class="local col9 decl" id="919p" title='p' data-type='struct auth_addr *' data-ref="919p" data-ref-filename="919p">p</dfn>;</td></tr>
<tr><th id="3366">3366</th><td>	<b>for</b>(<a class="local col9 ref" href="#919p" title='p' data-ref="919p" data-ref-filename="919p">p</a>=<a class="local col6 ref" href="#916list" title='list' data-ref="916list" data-ref-filename="916list">list</a>; <a class="local col9 ref" href="#919p" title='p' data-ref="919p" data-ref-filename="919p">p</a>; <a class="local col9 ref" href="#919p" title='p' data-ref="919p" data-ref-filename="919p">p</a>=<a class="local col9 ref" href="#919p" title='p' data-ref="919p" data-ref-filename="919p">p</a>-&gt;<a class="ref field" href="authzone.h.html#auth_addr::next" title='auth_addr::next' data-ref="auth_addr::next" data-ref-filename="auth_addr..next">next</a>) {</td></tr>
<tr><th id="3367">3367</th><td>		<b>if</b>(<a class="ref fn" href="../util/net_help.h.html#sockaddr_cmp_addr" title='sockaddr_cmp_addr' data-ref="sockaddr_cmp_addr" data-ref-filename="sockaddr_cmp_addr">sockaddr_cmp_addr</a>(<a class="local col7 ref" href="#917addr" title='addr' data-ref="917addr" data-ref-filename="917addr">addr</a>, <a class="local col8 ref" href="#918addrlen" title='addrlen' data-ref="918addrlen" data-ref-filename="918addrlen">addrlen</a>, &amp;<a class="local col9 ref" href="#919p" title='p' data-ref="919p" data-ref-filename="919p">p</a>-&gt;<a class="ref field" href="authzone.h.html#auth_addr::addr" title='auth_addr::addr' data-ref="auth_addr::addr" data-ref-filename="auth_addr..addr">addr</a>, <a class="local col9 ref" href="#919p" title='p' data-ref="919p" data-ref-filename="919p">p</a>-&gt;<a class="ref field" href="authzone.h.html#auth_addr::addrlen" title='auth_addr::addrlen' data-ref="auth_addr::addrlen" data-ref-filename="auth_addr..addrlen">addrlen</a>)==<var>0</var>)</td></tr>
<tr><th id="3368">3368</th><td>			<b>return</b> <var>1</var>;</td></tr>
<tr><th id="3369">3369</th><td>	}</td></tr>
<tr><th id="3370">3370</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3371">3371</th><td>}</td></tr>
<tr><th id="3372">3372</th><td></td></tr>
<tr><th id="3373">3373</th><td><i class="doc" data-doc="addr_matches_master">/** check if an address matches a master specification (or one of its</i></td></tr>
<tr><th id="3374">3374</th><td><i class="doc" data-doc="addr_matches_master"> * addresses in the addr list) */</i></td></tr>
<tr><th id="3375">3375</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="3376">3376</th><td><dfn class="tu decl def fn" id="addr_matches_master" title='addr_matches_master' data-type='int addr_matches_master(struct auth_master * master, struct sockaddr_storage * addr, __socklen_t addrlen, struct auth_master ** fromhost)' data-ref="addr_matches_master" data-ref-filename="addr_matches_master">addr_matches_master</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>* <dfn class="local col0 decl" id="920master" title='master' data-type='struct auth_master *' data-ref="920master" data-ref-filename="920master">master</dfn>, <b>struct</b> <a class="type" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#sockaddr_storage" title='sockaddr_storage' data-ref="sockaddr_storage" data-ref-filename="sockaddr_storage">sockaddr_storage</a>* <dfn class="local col1 decl" id="921addr" title='addr' data-type='struct sockaddr_storage *' data-ref="921addr" data-ref-filename="921addr">addr</dfn>,</td></tr>
<tr><th id="3377">3377</th><td>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#84" title="__socklen_t" data-ref="_M/socklen_t">socklen_t</a> <dfn class="local col2 decl" id="922addrlen" title='addrlen' data-type='__socklen_t' data-ref="922addrlen" data-ref-filename="922addrlen">addrlen</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>** <dfn class="local col3 decl" id="923fromhost" title='fromhost' data-type='struct auth_master **' data-ref="923fromhost" data-ref-filename="923fromhost">fromhost</dfn>)</td></tr>
<tr><th id="3378">3378</th><td>{</td></tr>
<tr><th id="3379">3379</th><td>	<b>struct</b> <a class="type" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#sockaddr_storage" title='sockaddr_storage' data-ref="sockaddr_storage" data-ref-filename="sockaddr_storage">sockaddr_storage</a> <dfn class="local col4 decl" id="924a" title='a' data-type='struct sockaddr_storage' data-ref="924a" data-ref-filename="924a">a</dfn>;</td></tr>
<tr><th id="3380">3380</th><td>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#84" title="__socklen_t" data-ref="_M/socklen_t">socklen_t</a> <dfn class="local col5 decl" id="925alen" title='alen' data-type='__socklen_t' data-ref="925alen" data-ref-filename="925alen">alen</dfn> = <var>0</var>;</td></tr>
<tr><th id="3381">3381</th><td>	<em>int</em> <dfn class="local col6 decl" id="926net" title='net' data-type='int' data-ref="926net" data-ref-filename="926net">net</dfn> = <var>0</var>;</td></tr>
<tr><th id="3382">3382</th><td>	<b>if</b>(<a class="tu ref fn" href="#addr_in_list" title='addr_in_list' data-use='c' data-ref="addr_in_list" data-ref-filename="addr_in_list">addr_in_list</a>(<a class="local col0 ref" href="#920master" title='master' data-ref="920master" data-ref-filename="920master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::list" title='auth_master::list' data-ref="auth_master::list" data-ref-filename="auth_master..list">list</a>, <a class="local col1 ref" href="#921addr" title='addr' data-ref="921addr" data-ref-filename="921addr">addr</a>, <a class="local col2 ref" href="#922addrlen" title='addrlen' data-ref="922addrlen" data-ref-filename="922addrlen">addrlen</a>)) {</td></tr>
<tr><th id="3383">3383</th><td>		*<a class="local col3 ref" href="#923fromhost" title='fromhost' data-ref="923fromhost" data-ref-filename="923fromhost">fromhost</a> = <a class="local col0 ref" href="#920master" title='master' data-ref="920master" data-ref-filename="920master">master</a>;</td></tr>
<tr><th id="3384">3384</th><td>		<b>return</b> <var>1</var>;	</td></tr>
<tr><th id="3385">3385</th><td>	}</td></tr>
<tr><th id="3386">3386</th><td>	<i>/* compare address (but not port number, that is the destination</i></td></tr>
<tr><th id="3387">3387</th><td><i>	 * port of the master, the port number of the received notify is</i></td></tr>
<tr><th id="3388">3388</th><td><i>	 * allowed to by any port on that master) */</i></td></tr>
<tr><th id="3389">3389</th><td>	<b>if</b>(<a class="ref fn" href="../util/net_help.h.html#extstrtoaddr" title='extstrtoaddr' data-ref="extstrtoaddr" data-ref-filename="extstrtoaddr">extstrtoaddr</a>(<a class="local col0 ref" href="#920master" title='master' data-ref="920master" data-ref-filename="920master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>, &amp;<a class="local col4 ref" href="#924a" title='a' data-ref="924a" data-ref-filename="924a">a</a>, &amp;<a class="local col5 ref" href="#925alen" title='alen' data-ref="925alen" data-ref-filename="925alen">alen</a>) &amp;&amp;</td></tr>
<tr><th id="3390">3390</th><td>		<a class="ref fn" href="../util/net_help.h.html#sockaddr_cmp_addr" title='sockaddr_cmp_addr' data-ref="sockaddr_cmp_addr" data-ref-filename="sockaddr_cmp_addr">sockaddr_cmp_addr</a>(<a class="local col1 ref" href="#921addr" title='addr' data-ref="921addr" data-ref-filename="921addr">addr</a>, <a class="local col2 ref" href="#922addrlen" title='addrlen' data-ref="922addrlen" data-ref-filename="922addrlen">addrlen</a>, &amp;<a class="local col4 ref" href="#924a" title='a' data-ref="924a" data-ref-filename="924a">a</a>, <a class="local col5 ref" href="#925alen" title='alen' data-ref="925alen" data-ref-filename="925alen">alen</a>)==<var>0</var>) {</td></tr>
<tr><th id="3391">3391</th><td>		*<a class="local col3 ref" href="#923fromhost" title='fromhost' data-ref="923fromhost" data-ref-filename="923fromhost">fromhost</a> = <a class="local col0 ref" href="#920master" title='master' data-ref="920master" data-ref-filename="920master">master</a>;</td></tr>
<tr><th id="3392">3392</th><td>		<b>return</b> <var>1</var>;</td></tr>
<tr><th id="3393">3393</th><td>	}</td></tr>
<tr><th id="3394">3394</th><td>	<i>/* prefixes, addr/len, like 10.0.0.0/8 */</i></td></tr>
<tr><th id="3395">3395</th><td>	<i>/* not http and has a / and there is one / */</i></td></tr>
<tr><th id="3396">3396</th><td>	<b>if</b>(<a class="local col0 ref" href="#920master" title='master' data-ref="920master" data-ref-filename="920master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::allow_notify" title='auth_master::allow_notify' data-ref="auth_master::allow_notify" data-ref-filename="auth_master..allow_notify">allow_notify</a> &amp;&amp; !<a class="local col0 ref" href="#920master" title='master' data-ref="920master" data-ref-filename="920master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::http" title='auth_master::http' data-ref="auth_master::http" data-ref-filename="auth_master..http">http</a> &amp;&amp;</td></tr>
<tr><th id="3397">3397</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strchr" title='strchr' data-ref="strchr" data-ref-filename="strchr">strchr</a>(<a class="local col0 ref" href="#920master" title='master' data-ref="920master" data-ref-filename="920master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>, <kbd>'/'</kbd>) != <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span> &amp;&amp;</td></tr>
<tr><th id="3398">3398</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strchr" title='strchr' data-ref="strchr" data-ref-filename="strchr">strchr</a>(<a class="local col0 ref" href="#920master" title='master' data-ref="920master" data-ref-filename="920master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>, <kbd>'/'</kbd>) == <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strrchr" title='strrchr' data-ref="strrchr" data-ref-filename="strrchr">strrchr</a>(<a class="local col0 ref" href="#920master" title='master' data-ref="920master" data-ref-filename="920master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>, <kbd>'/'</kbd>) &amp;&amp;</td></tr>
<tr><th id="3399">3399</th><td>		<a class="ref fn" href="../util/net_help.h.html#netblockstrtoaddr" title='netblockstrtoaddr' data-ref="netblockstrtoaddr" data-ref-filename="netblockstrtoaddr">netblockstrtoaddr</a>(<a class="local col0 ref" href="#920master" title='master' data-ref="920master" data-ref-filename="920master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>, <a class="macro" href="../../include/config.h.html#1293" title="53" data-ref="_M/UNBOUND_DNS_PORT">UNBOUND_DNS_PORT</a>, &amp;<a class="local col4 ref" href="#924a" title='a' data-ref="924a" data-ref-filename="924a">a</a>, &amp;<a class="local col5 ref" href="#925alen" title='alen' data-ref="925alen" data-ref-filename="925alen">alen</a>,</td></tr>
<tr><th id="3400">3400</th><td>		&amp;<a class="local col6 ref" href="#926net" title='net' data-ref="926net" data-ref-filename="926net">net</a>) &amp;&amp; <a class="local col5 ref" href="#925alen" title='alen' data-ref="925alen" data-ref-filename="925alen">alen</a> == <a class="local col2 ref" href="#922addrlen" title='addrlen' data-ref="922addrlen" data-ref-filename="922addrlen">addrlen</a>) {</td></tr>
<tr><th id="3401">3401</th><td>		<b>if</b>(<a class="ref fn" href="../util/net_help.h.html#addr_in_common" title='addr_in_common' data-ref="addr_in_common" data-ref-filename="addr_in_common">addr_in_common</a>(<a class="local col1 ref" href="#921addr" title='addr' data-ref="921addr" data-ref-filename="921addr">addr</a>, (<a class="ref fn" href="../util/net_help.h.html#addr_is_ip6" title='addr_is_ip6' data-ref="addr_is_ip6" data-ref-filename="addr_is_ip6">addr_is_ip6</a>(<a class="local col1 ref" href="#921addr" title='addr' data-ref="921addr" data-ref-filename="921addr">addr</a>, <a class="local col2 ref" href="#922addrlen" title='addrlen' data-ref="922addrlen" data-ref-filename="922addrlen">addrlen</a>)?<var>128</var>:<var>32</var>),</td></tr>
<tr><th id="3402">3402</th><td>			&amp;<a class="local col4 ref" href="#924a" title='a' data-ref="924a" data-ref-filename="924a">a</a>, <a class="local col6 ref" href="#926net" title='net' data-ref="926net" data-ref-filename="926net">net</a>, <a class="local col5 ref" href="#925alen" title='alen' data-ref="925alen" data-ref-filename="925alen">alen</a>) &gt;= <a class="local col6 ref" href="#926net" title='net' data-ref="926net" data-ref-filename="926net">net</a>) {</td></tr>
<tr><th id="3403">3403</th><td>			*<a class="local col3 ref" href="#923fromhost" title='fromhost' data-ref="923fromhost" data-ref-filename="923fromhost">fromhost</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>; <i>/* prefix does not have destination</i></td></tr>
<tr><th id="3404">3404</th><td><i>				to send the probe or transfer with */</i></td></tr>
<tr><th id="3405">3405</th><td>			<b>return</b> <var>1</var>; <i>/* matches the netblock */</i></td></tr>
<tr><th id="3406">3406</th><td>		}</td></tr>
<tr><th id="3407">3407</th><td>	}</td></tr>
<tr><th id="3408">3408</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3409">3409</th><td>}</td></tr>
<tr><th id="3410">3410</th><td></td></tr>
<tr><th id="3411">3411</th><td><i class="doc" data-doc="az_xfr_allowed_notify">/** check access list for notifies */</i></td></tr>
<tr><th id="3412">3412</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="3413">3413</th><td><dfn class="tu decl def fn" id="az_xfr_allowed_notify" title='az_xfr_allowed_notify' data-type='int az_xfr_allowed_notify(struct auth_xfer * xfr, struct sockaddr_storage * addr, __socklen_t addrlen, struct auth_master ** fromhost)' data-ref="az_xfr_allowed_notify" data-ref-filename="az_xfr_allowed_notify">az_xfr_allowed_notify</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col7 decl" id="927xfr" title='xfr' data-type='struct auth_xfer *' data-ref="927xfr" data-ref-filename="927xfr">xfr</dfn>, <b>struct</b> <a class="type" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#sockaddr_storage" title='sockaddr_storage' data-ref="sockaddr_storage" data-ref-filename="sockaddr_storage">sockaddr_storage</a>* <dfn class="local col8 decl" id="928addr" title='addr' data-type='struct sockaddr_storage *' data-ref="928addr" data-ref-filename="928addr">addr</dfn>,</td></tr>
<tr><th id="3414">3414</th><td>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#84" title="__socklen_t" data-ref="_M/socklen_t">socklen_t</a> <dfn class="local col9 decl" id="929addrlen" title='addrlen' data-type='__socklen_t' data-ref="929addrlen" data-ref-filename="929addrlen">addrlen</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>** <dfn class="local col0 decl" id="930fromhost" title='fromhost' data-type='struct auth_master **' data-ref="930fromhost" data-ref-filename="930fromhost">fromhost</dfn>)</td></tr>
<tr><th id="3415">3415</th><td>{</td></tr>
<tr><th id="3416">3416</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>* <dfn class="local col1 decl" id="931p" title='p' data-type='struct auth_master *' data-ref="931p" data-ref-filename="931p">p</dfn>;</td></tr>
<tr><th id="3417">3417</th><td>	<b>for</b>(<a class="local col1 ref" href="#931p" title='p' data-ref="931p" data-ref-filename="931p">p</a>=<a class="local col7 ref" href="#927xfr" title='xfr' data-ref="927xfr" data-ref-filename="927xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::allow_notify_list" title='auth_xfer::allow_notify_list' data-ref="auth_xfer::allow_notify_list" data-ref-filename="auth_xfer..allow_notify_list">allow_notify_list</a>; <a class="local col1 ref" href="#931p" title='p' data-ref="931p" data-ref-filename="931p">p</a>; <a class="local col1 ref" href="#931p" title='p' data-ref="931p" data-ref-filename="931p">p</a>=<a class="local col1 ref" href="#931p" title='p' data-ref="931p" data-ref-filename="931p">p</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::next" title='auth_master::next' data-ref="auth_master::next" data-ref-filename="auth_master..next">next</a>) {</td></tr>
<tr><th id="3418">3418</th><td>		<b>if</b>(<a class="tu ref fn" href="#addr_matches_master" title='addr_matches_master' data-use='c' data-ref="addr_matches_master" data-ref-filename="addr_matches_master">addr_matches_master</a>(<a class="local col1 ref" href="#931p" title='p' data-ref="931p" data-ref-filename="931p">p</a>, <a class="local col8 ref" href="#928addr" title='addr' data-ref="928addr" data-ref-filename="928addr">addr</a>, <a class="local col9 ref" href="#929addrlen" title='addrlen' data-ref="929addrlen" data-ref-filename="929addrlen">addrlen</a>, <a class="local col0 ref" href="#930fromhost" title='fromhost' data-ref="930fromhost" data-ref-filename="930fromhost">fromhost</a>)) {</td></tr>
<tr><th id="3419">3419</th><td>			<b>return</b> <var>1</var>;</td></tr>
<tr><th id="3420">3420</th><td>		}</td></tr>
<tr><th id="3421">3421</th><td>	}</td></tr>
<tr><th id="3422">3422</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3423">3423</th><td>}</td></tr>
<tr><th id="3424">3424</th><td></td></tr>
<tr><th id="3425">3425</th><td><i class="doc" data-doc="xfr_serial_means_update">/** see if the serial means the zone has to be updated, i.e. the serial</i></td></tr>
<tr><th id="3426">3426</th><td><i class="doc" data-doc="xfr_serial_means_update"> * is newer than the zone serial, or we have no zone */</i></td></tr>
<tr><th id="3427">3427</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="3428">3428</th><td><dfn class="tu decl def fn" id="xfr_serial_means_update" title='xfr_serial_means_update' data-type='int xfr_serial_means_update(struct auth_xfer * xfr, uint32_t serial)' data-ref="xfr_serial_means_update" data-ref-filename="xfr_serial_means_update">xfr_serial_means_update</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col2 decl" id="932xfr" title='xfr' data-type='struct auth_xfer *' data-ref="932xfr" data-ref-filename="932xfr">xfr</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a> <dfn class="local col3 decl" id="933serial" title='serial' data-type='uint32_t' data-ref="933serial" data-ref-filename="933serial">serial</dfn>)</td></tr>
<tr><th id="3429">3429</th><td>{</td></tr>
<tr><th id="3430">3430</th><td>	<b>if</b>(!<a class="local col2 ref" href="#932xfr" title='xfr' data-ref="932xfr" data-ref-filename="932xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::have_zone" title='auth_xfer::have_zone' data-ref="auth_xfer::have_zone" data-ref-filename="auth_xfer..have_zone">have_zone</a>)</td></tr>
<tr><th id="3431">3431</th><td>		<b>return</b> <var>1</var>; <i>/* no zone, anything is better */</i></td></tr>
<tr><th id="3432">3432</th><td>	<b>if</b>(<a class="local col2 ref" href="#932xfr" title='xfr' data-ref="932xfr" data-ref-filename="932xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::zone_expired" title='auth_xfer::zone_expired' data-ref="auth_xfer::zone_expired" data-ref-filename="auth_xfer..zone_expired">zone_expired</a>)</td></tr>
<tr><th id="3433">3433</th><td>		<b>return</b> <var>1</var>; <i>/* expired, the sent serial is better than expired</i></td></tr>
<tr><th id="3434">3434</th><td><i>			data */</i></td></tr>
<tr><th id="3435">3435</th><td>	<b>if</b>(<a class="ref fn" href="#compare_serial" title='compare_serial' data-ref="compare_serial" data-ref-filename="compare_serial">compare_serial</a>(<a class="local col2 ref" href="#932xfr" title='xfr' data-ref="932xfr" data-ref-filename="932xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::serial" title='auth_xfer::serial' data-ref="auth_xfer::serial" data-ref-filename="auth_xfer..serial">serial</a>, <a class="local col3 ref" href="#933serial" title='serial' data-ref="933serial" data-ref-filename="933serial">serial</a>) &lt; <var>0</var>)</td></tr>
<tr><th id="3436">3436</th><td>		<b>return</b> <var>1</var>; <i>/* our serial is smaller than the sent serial,</i></td></tr>
<tr><th id="3437">3437</th><td><i>			the data is newer, fetch it */</i></td></tr>
<tr><th id="3438">3438</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3439">3439</th><td>}</td></tr>
<tr><th id="3440">3440</th><td></td></tr>
<tr><th id="3441">3441</th><td><i class="doc" data-doc="xfr_note_notify_serial">/** note notify serial, updates the notify information in the xfr struct */</i></td></tr>
<tr><th id="3442">3442</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="3443">3443</th><td><dfn class="tu decl def fn" id="xfr_note_notify_serial" title='xfr_note_notify_serial' data-type='void xfr_note_notify_serial(struct auth_xfer * xfr, int has_serial, uint32_t serial)' data-ref="xfr_note_notify_serial" data-ref-filename="xfr_note_notify_serial">xfr_note_notify_serial</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col4 decl" id="934xfr" title='xfr' data-type='struct auth_xfer *' data-ref="934xfr" data-ref-filename="934xfr">xfr</dfn>, <em>int</em> <dfn class="local col5 decl" id="935has_serial" title='has_serial' data-type='int' data-ref="935has_serial" data-ref-filename="935has_serial">has_serial</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a> <dfn class="local col6 decl" id="936serial" title='serial' data-type='uint32_t' data-ref="936serial" data-ref-filename="936serial">serial</dfn>)</td></tr>
<tr><th id="3444">3444</th><td>{</td></tr>
<tr><th id="3445">3445</th><td>	<b>if</b>(<a class="local col4 ref" href="#934xfr" title='xfr' data-ref="934xfr" data-ref-filename="934xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::notify_received" title='auth_xfer::notify_received' data-ref="auth_xfer::notify_received" data-ref-filename="auth_xfer..notify_received">notify_received</a> &amp;&amp; <a class="local col4 ref" href="#934xfr" title='xfr' data-ref="934xfr" data-ref-filename="934xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::notify_has_serial" title='auth_xfer::notify_has_serial' data-ref="auth_xfer::notify_has_serial" data-ref-filename="auth_xfer..notify_has_serial">notify_has_serial</a> &amp;&amp; <a class="local col5 ref" href="#935has_serial" title='has_serial' data-ref="935has_serial" data-ref-filename="935has_serial">has_serial</a>) {</td></tr>
<tr><th id="3446">3446</th><td>		<i>/* see if this serial is newer */</i></td></tr>
<tr><th id="3447">3447</th><td>		<b>if</b>(<a class="ref fn" href="#compare_serial" title='compare_serial' data-ref="compare_serial" data-ref-filename="compare_serial">compare_serial</a>(<a class="local col4 ref" href="#934xfr" title='xfr' data-ref="934xfr" data-ref-filename="934xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::notify_serial" title='auth_xfer::notify_serial' data-ref="auth_xfer::notify_serial" data-ref-filename="auth_xfer..notify_serial">notify_serial</a>, <a class="local col6 ref" href="#936serial" title='serial' data-ref="936serial" data-ref-filename="936serial">serial</a>) &lt; <var>0</var>)</td></tr>
<tr><th id="3448">3448</th><td>			<a class="local col4 ref" href="#934xfr" title='xfr' data-ref="934xfr" data-ref-filename="934xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::notify_serial" title='auth_xfer::notify_serial' data-ref="auth_xfer::notify_serial" data-ref-filename="auth_xfer..notify_serial">notify_serial</a> = <a class="local col6 ref" href="#936serial" title='serial' data-ref="936serial" data-ref-filename="936serial">serial</a>;</td></tr>
<tr><th id="3449">3449</th><td>	} <b>else</b> <b>if</b>(<a class="local col4 ref" href="#934xfr" title='xfr' data-ref="934xfr" data-ref-filename="934xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::notify_received" title='auth_xfer::notify_received' data-ref="auth_xfer::notify_received" data-ref-filename="auth_xfer..notify_received">notify_received</a> &amp;&amp; <a class="local col4 ref" href="#934xfr" title='xfr' data-ref="934xfr" data-ref-filename="934xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::notify_has_serial" title='auth_xfer::notify_has_serial' data-ref="auth_xfer::notify_has_serial" data-ref-filename="auth_xfer..notify_has_serial">notify_has_serial</a> &amp;&amp;</td></tr>
<tr><th id="3450">3450</th><td>		!<a class="local col5 ref" href="#935has_serial" title='has_serial' data-ref="935has_serial" data-ref-filename="935has_serial">has_serial</a>) {</td></tr>
<tr><th id="3451">3451</th><td>		<i>/* remove serial, we have notify without serial */</i></td></tr>
<tr><th id="3452">3452</th><td>		<a class="local col4 ref" href="#934xfr" title='xfr' data-ref="934xfr" data-ref-filename="934xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::notify_has_serial" title='auth_xfer::notify_has_serial' data-ref="auth_xfer::notify_has_serial" data-ref-filename="auth_xfer..notify_has_serial">notify_has_serial</a> = <var>0</var>;</td></tr>
<tr><th id="3453">3453</th><td>		<a class="local col4 ref" href="#934xfr" title='xfr' data-ref="934xfr" data-ref-filename="934xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::notify_serial" title='auth_xfer::notify_serial' data-ref="auth_xfer::notify_serial" data-ref-filename="auth_xfer..notify_serial">notify_serial</a> = <var>0</var>;</td></tr>
<tr><th id="3454">3454</th><td>	} <b>else</b> <b>if</b>(<a class="local col4 ref" href="#934xfr" title='xfr' data-ref="934xfr" data-ref-filename="934xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::notify_received" title='auth_xfer::notify_received' data-ref="auth_xfer::notify_received" data-ref-filename="auth_xfer..notify_received">notify_received</a> &amp;&amp; !<a class="local col4 ref" href="#934xfr" title='xfr' data-ref="934xfr" data-ref-filename="934xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::notify_has_serial" title='auth_xfer::notify_has_serial' data-ref="auth_xfer::notify_has_serial" data-ref-filename="auth_xfer..notify_has_serial">notify_has_serial</a>) {</td></tr>
<tr><th id="3455">3455</th><td>		<i>/* we already have notify without serial, keep it</i></td></tr>
<tr><th id="3456">3456</th><td><i>		 * that way; no serial check when current operation</i></td></tr>
<tr><th id="3457">3457</th><td><i>		 * is done */</i></td></tr>
<tr><th id="3458">3458</th><td>	} <b>else</b> {</td></tr>
<tr><th id="3459">3459</th><td>		<a class="local col4 ref" href="#934xfr" title='xfr' data-ref="934xfr" data-ref-filename="934xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::notify_received" title='auth_xfer::notify_received' data-ref="auth_xfer::notify_received" data-ref-filename="auth_xfer..notify_received">notify_received</a> = <var>1</var>;</td></tr>
<tr><th id="3460">3460</th><td>		<a class="local col4 ref" href="#934xfr" title='xfr' data-ref="934xfr" data-ref-filename="934xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::notify_has_serial" title='auth_xfer::notify_has_serial' data-ref="auth_xfer::notify_has_serial" data-ref-filename="auth_xfer..notify_has_serial">notify_has_serial</a> = <a class="local col5 ref" href="#935has_serial" title='has_serial' data-ref="935has_serial" data-ref-filename="935has_serial">has_serial</a>;</td></tr>
<tr><th id="3461">3461</th><td>		<a class="local col4 ref" href="#934xfr" title='xfr' data-ref="934xfr" data-ref-filename="934xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::notify_serial" title='auth_xfer::notify_serial' data-ref="auth_xfer::notify_serial" data-ref-filename="auth_xfer..notify_serial">notify_serial</a> = <a class="local col6 ref" href="#936serial" title='serial' data-ref="936serial" data-ref-filename="936serial">serial</a>;</td></tr>
<tr><th id="3462">3462</th><td>	}</td></tr>
<tr><th id="3463">3463</th><td>}</td></tr>
<tr><th id="3464">3464</th><td></td></tr>
<tr><th id="3465">3465</th><td><i class="doc" data-doc="xfr_process_notify">/** process a notify serial, start new probe or note serial. xfr is locked */</i></td></tr>
<tr><th id="3466">3466</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="3467">3467</th><td><dfn class="tu decl def fn" id="xfr_process_notify" title='xfr_process_notify' data-type='void xfr_process_notify(struct auth_xfer * xfr, struct module_env * env, int has_serial, uint32_t serial, struct auth_master * fromhost)' data-ref="xfr_process_notify" data-ref-filename="xfr_process_notify">xfr_process_notify</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col7 decl" id="937xfr" title='xfr' data-type='struct auth_xfer *' data-ref="937xfr" data-ref-filename="937xfr">xfr</dfn>, <b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col8 decl" id="938env" title='env' data-type='struct module_env *' data-ref="938env" data-ref-filename="938env">env</dfn>,</td></tr>
<tr><th id="3468">3468</th><td>	<em>int</em> <dfn class="local col9 decl" id="939has_serial" title='has_serial' data-type='int' data-ref="939has_serial" data-ref-filename="939has_serial">has_serial</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a> <dfn class="local col0 decl" id="940serial" title='serial' data-type='uint32_t' data-ref="940serial" data-ref-filename="940serial">serial</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>* <dfn class="local col1 decl" id="941fromhost" title='fromhost' data-type='struct auth_master *' data-ref="941fromhost" data-ref-filename="941fromhost">fromhost</dfn>)</td></tr>
<tr><th id="3469">3469</th><td>{</td></tr>
<tr><th id="3470">3470</th><td>	<i>/* if the serial of notify is older than we have, don't fetch</i></td></tr>
<tr><th id="3471">3471</th><td><i>	 * a zone, we already have it */</i></td></tr>
<tr><th id="3472">3472</th><td>	<b>if</b>(<a class="local col9 ref" href="#939has_serial" title='has_serial' data-ref="939has_serial" data-ref-filename="939has_serial">has_serial</a> &amp;&amp; !<a class="tu ref fn" href="#xfr_serial_means_update" title='xfr_serial_means_update' data-use='c' data-ref="xfr_serial_means_update" data-ref-filename="xfr_serial_means_update">xfr_serial_means_update</a>(<a class="local col7 ref" href="#937xfr" title='xfr' data-ref="937xfr" data-ref-filename="937xfr">xfr</a>, <a class="local col0 ref" href="#940serial" title='serial' data-ref="940serial" data-ref-filename="940serial">serial</a>)) {</td></tr>
<tr><th id="3473">3473</th><td>		<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3473, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col7 ref" href="#937xfr" title='xfr' data-ref="937xfr" data-ref-filename="937xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="3474">3474</th><td>		<b>return</b>;</td></tr>
<tr><th id="3475">3475</th><td>	}</td></tr>
<tr><th id="3476">3476</th><td>	<i>/* start new probe with this addr src, or note serial */</i></td></tr>
<tr><th id="3477">3477</th><td>	<b>if</b>(!<a class="tu ref fn" href="#xfr_start_probe" title='xfr_start_probe' data-use='c' data-ref="xfr_start_probe" data-ref-filename="xfr_start_probe">xfr_start_probe</a>(<a class="local col7 ref" href="#937xfr" title='xfr' data-ref="937xfr" data-ref-filename="937xfr">xfr</a>, <a class="local col8 ref" href="#938env" title='env' data-ref="938env" data-ref-filename="938env">env</a>, <a class="local col1 ref" href="#941fromhost" title='fromhost' data-ref="941fromhost" data-ref-filename="941fromhost">fromhost</a>)) {</td></tr>
<tr><th id="3478">3478</th><td>		<i>/* not started because already in progress, note the serial */</i></td></tr>
<tr><th id="3479">3479</th><td>		<a class="tu ref fn" href="#xfr_note_notify_serial" title='xfr_note_notify_serial' data-use='c' data-ref="xfr_note_notify_serial" data-ref-filename="xfr_note_notify_serial">xfr_note_notify_serial</a>(<a class="local col7 ref" href="#937xfr" title='xfr' data-ref="937xfr" data-ref-filename="937xfr">xfr</a>, <a class="local col9 ref" href="#939has_serial" title='has_serial' data-ref="939has_serial" data-ref-filename="939has_serial">has_serial</a>, <a class="local col0 ref" href="#940serial" title='serial' data-ref="940serial" data-ref-filename="940serial">serial</a>);</td></tr>
<tr><th id="3480">3480</th><td>		<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3480, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col7 ref" href="#937xfr" title='xfr' data-ref="937xfr" data-ref-filename="937xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="3481">3481</th><td>	}</td></tr>
<tr><th id="3482">3482</th><td>	<i>/* successful end of start_probe unlocked xfr-&gt;lock */</i></td></tr>
<tr><th id="3483">3483</th><td>}</td></tr>
<tr><th id="3484">3484</th><td></td></tr>
<tr><th id="3485">3485</th><td><em>int</em> <dfn class="decl def fn" id="auth_zones_notify" title='auth_zones_notify' data-ref="auth_zones_notify" data-ref-filename="auth_zones_notify">auth_zones_notify</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zones" title='auth_zones' data-ref="auth_zones" data-ref-filename="auth_zones">auth_zones</a>* <dfn class="local col2 decl" id="942az" title='az' data-type='struct auth_zones *' data-ref="942az" data-ref-filename="942az">az</dfn>, <b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col3 decl" id="943env" title='env' data-type='struct module_env *' data-ref="943env" data-ref-filename="943env">env</dfn>,</td></tr>
<tr><th id="3486">3486</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col4 decl" id="944nm" title='nm' data-type='uint8_t *' data-ref="944nm" data-ref-filename="944nm">nm</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col5 decl" id="945nmlen" title='nmlen' data-type='size_t' data-ref="945nmlen" data-ref-filename="945nmlen">nmlen</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col6 decl" id="946dclass" title='dclass' data-type='uint16_t' data-ref="946dclass" data-ref-filename="946dclass">dclass</dfn>,</td></tr>
<tr><th id="3487">3487</th><td>	<b>struct</b> <a class="type" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#sockaddr_storage" title='sockaddr_storage' data-ref="sockaddr_storage" data-ref-filename="sockaddr_storage">sockaddr_storage</a>* <dfn class="local col7 decl" id="947addr" title='addr' data-type='struct sockaddr_storage *' data-ref="947addr" data-ref-filename="947addr">addr</dfn>, <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#84" title="__socklen_t" data-ref="_M/socklen_t">socklen_t</a> <dfn class="local col8 decl" id="948addrlen" title='addrlen' data-type='__socklen_t' data-ref="948addrlen" data-ref-filename="948addrlen">addrlen</dfn>, <em>int</em> <dfn class="local col9 decl" id="949has_serial" title='has_serial' data-type='int' data-ref="949has_serial" data-ref-filename="949has_serial">has_serial</dfn>,</td></tr>
<tr><th id="3488">3488</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a> <dfn class="local col0 decl" id="950serial" title='serial' data-type='uint32_t' data-ref="950serial" data-ref-filename="950serial">serial</dfn>, <em>int</em>* <dfn class="local col1 decl" id="951refused" title='refused' data-type='int *' data-ref="951refused" data-ref-filename="951refused">refused</dfn>)</td></tr>
<tr><th id="3489">3489</th><td>{</td></tr>
<tr><th id="3490">3490</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col2 decl" id="952xfr" title='xfr' data-type='struct auth_xfer *' data-ref="952xfr" data-ref-filename="952xfr">xfr</dfn>;</td></tr>
<tr><th id="3491">3491</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>* <dfn class="local col3 decl" id="953fromhost" title='fromhost' data-type='struct auth_master *' data-ref="953fromhost" data-ref-filename="953fromhost">fromhost</dfn> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="3492">3492</th><td>	<i>/* see which zone this is */</i></td></tr>
<tr><th id="3493">3493</th><td>	<a class="macro" href="../util/locks.h.html#119" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_rdlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_rdlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3493, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_rdlock">lock_rw_rdlock</a>(&amp;<a class="local col2 ref" href="#942az" title='az' data-ref="942az" data-ref-filename="942az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="3494">3494</th><td>	<a class="local col2 ref" href="#952xfr" title='xfr' data-ref="952xfr" data-ref-filename="952xfr">xfr</a> = <a class="ref fn" href="#auth_xfer_find" title='auth_xfer_find' data-ref="auth_xfer_find" data-ref-filename="auth_xfer_find">auth_xfer_find</a>(<a class="local col2 ref" href="#942az" title='az' data-ref="942az" data-ref-filename="942az">az</a>, <a class="local col4 ref" href="#944nm" title='nm' data-ref="944nm" data-ref-filename="944nm">nm</a>, <a class="local col5 ref" href="#945nmlen" title='nmlen' data-ref="945nmlen" data-ref-filename="945nmlen">nmlen</a>, <a class="local col6 ref" href="#946dclass" title='dclass' data-ref="946dclass" data-ref-filename="946dclass">dclass</a>);</td></tr>
<tr><th id="3495">3495</th><td>	<b>if</b>(!<a class="local col2 ref" href="#952xfr" title='xfr' data-ref="952xfr" data-ref-filename="952xfr">xfr</a>) {</td></tr>
<tr><th id="3496">3496</th><td>		<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3496, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col2 ref" href="#942az" title='az' data-ref="942az" data-ref-filename="942az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="3497">3497</th><td>		<i>/* no such zone, refuse the notify */</i></td></tr>
<tr><th id="3498">3498</th><td>		*<a class="local col1 ref" href="#951refused" title='refused' data-ref="951refused" data-ref-filename="951refused">refused</a> = <var>1</var>;</td></tr>
<tr><th id="3499">3499</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3500">3500</th><td>	}</td></tr>
<tr><th id="3501">3501</th><td>	<a class="macro" href="../util/locks.h.html#102" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_lock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_lock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3501, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_lock">lock_basic_lock</a>(&amp;<a class="local col2 ref" href="#952xfr" title='xfr' data-ref="952xfr" data-ref-filename="952xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="3502">3502</th><td>	<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3502, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col2 ref" href="#942az" title='az' data-ref="942az" data-ref-filename="942az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="3503">3503</th><td>	</td></tr>
<tr><th id="3504">3504</th><td>	<i>/* check access list for notifies */</i></td></tr>
<tr><th id="3505">3505</th><td>	<b>if</b>(!<a class="tu ref fn" href="#az_xfr_allowed_notify" title='az_xfr_allowed_notify' data-use='c' data-ref="az_xfr_allowed_notify" data-ref-filename="az_xfr_allowed_notify">az_xfr_allowed_notify</a>(<a class="local col2 ref" href="#952xfr" title='xfr' data-ref="952xfr" data-ref-filename="952xfr">xfr</a>, <a class="local col7 ref" href="#947addr" title='addr' data-ref="947addr" data-ref-filename="947addr">addr</a>, <a class="local col8 ref" href="#948addrlen" title='addrlen' data-ref="948addrlen" data-ref-filename="948addrlen">addrlen</a>, &amp;<a class="local col3 ref" href="#953fromhost" title='fromhost' data-ref="953fromhost" data-ref-filename="953fromhost">fromhost</a>)) {</td></tr>
<tr><th id="3506">3506</th><td>		<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3506, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col2 ref" href="#952xfr" title='xfr' data-ref="952xfr" data-ref-filename="952xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="3507">3507</th><td>		<i>/* notify not allowed, refuse the notify */</i></td></tr>
<tr><th id="3508">3508</th><td>		*<a class="local col1 ref" href="#951refused" title='refused' data-ref="951refused" data-ref-filename="951refused">refused</a> = <var>1</var>;</td></tr>
<tr><th id="3509">3509</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3510">3510</th><td>	}</td></tr>
<tr><th id="3511">3511</th><td></td></tr>
<tr><th id="3512">3512</th><td>	<i>/* process the notify */</i></td></tr>
<tr><th id="3513">3513</th><td>	<a class="tu ref fn" href="#xfr_process_notify" title='xfr_process_notify' data-use='c' data-ref="xfr_process_notify" data-ref-filename="xfr_process_notify">xfr_process_notify</a>(<a class="local col2 ref" href="#952xfr" title='xfr' data-ref="952xfr" data-ref-filename="952xfr">xfr</a>, <a class="local col3 ref" href="#943env" title='env' data-ref="943env" data-ref-filename="943env">env</a>, <a class="local col9 ref" href="#949has_serial" title='has_serial' data-ref="949has_serial" data-ref-filename="949has_serial">has_serial</a>, <a class="local col0 ref" href="#950serial" title='serial' data-ref="950serial" data-ref-filename="950serial">serial</a>, <a class="local col3 ref" href="#953fromhost" title='fromhost' data-ref="953fromhost" data-ref-filename="953fromhost">fromhost</a>);</td></tr>
<tr><th id="3514">3514</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="3515">3515</th><td>}</td></tr>
<tr><th id="3516">3516</th><td></td></tr>
<tr><th id="3517">3517</th><td><em>int</em> <dfn class="decl def fn" id="auth_zones_startprobesequence" title='auth_zones_startprobesequence' data-ref="auth_zones_startprobesequence" data-ref-filename="auth_zones_startprobesequence">auth_zones_startprobesequence</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zones" title='auth_zones' data-ref="auth_zones" data-ref-filename="auth_zones">auth_zones</a>* <dfn class="local col4 decl" id="954az" title='az' data-type='struct auth_zones *' data-ref="954az" data-ref-filename="954az">az</dfn>,</td></tr>
<tr><th id="3518">3518</th><td>	<b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col5 decl" id="955env" title='env' data-type='struct module_env *' data-ref="955env" data-ref-filename="955env">env</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col6 decl" id="956nm" title='nm' data-type='uint8_t *' data-ref="956nm" data-ref-filename="956nm">nm</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col7 decl" id="957nmlen" title='nmlen' data-type='size_t' data-ref="957nmlen" data-ref-filename="957nmlen">nmlen</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col8 decl" id="958dclass" title='dclass' data-type='uint16_t' data-ref="958dclass" data-ref-filename="958dclass">dclass</dfn>)</td></tr>
<tr><th id="3519">3519</th><td>{</td></tr>
<tr><th id="3520">3520</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col9 decl" id="959xfr" title='xfr' data-type='struct auth_xfer *' data-ref="959xfr" data-ref-filename="959xfr">xfr</dfn>;</td></tr>
<tr><th id="3521">3521</th><td>	<a class="macro" href="../util/locks.h.html#119" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_rdlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_rdlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3521, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_rdlock">lock_rw_rdlock</a>(&amp;<a class="local col4 ref" href="#954az" title='az' data-ref="954az" data-ref-filename="954az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="3522">3522</th><td>	<a class="local col9 ref" href="#959xfr" title='xfr' data-ref="959xfr" data-ref-filename="959xfr">xfr</a> = <a class="ref fn" href="#auth_xfer_find" title='auth_xfer_find' data-ref="auth_xfer_find" data-ref-filename="auth_xfer_find">auth_xfer_find</a>(<a class="local col4 ref" href="#954az" title='az' data-ref="954az" data-ref-filename="954az">az</a>, <a class="local col6 ref" href="#956nm" title='nm' data-ref="956nm" data-ref-filename="956nm">nm</a>, <a class="local col7 ref" href="#957nmlen" title='nmlen' data-ref="957nmlen" data-ref-filename="957nmlen">nmlen</a>, <a class="local col8 ref" href="#958dclass" title='dclass' data-ref="958dclass" data-ref-filename="958dclass">dclass</a>);</td></tr>
<tr><th id="3523">3523</th><td>	<b>if</b>(!<a class="local col9 ref" href="#959xfr" title='xfr' data-ref="959xfr" data-ref-filename="959xfr">xfr</a>) {</td></tr>
<tr><th id="3524">3524</th><td>		<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3524, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col4 ref" href="#954az" title='az' data-ref="954az" data-ref-filename="954az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="3525">3525</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3526">3526</th><td>	}</td></tr>
<tr><th id="3527">3527</th><td>	<a class="macro" href="../util/locks.h.html#102" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_lock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_lock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3527, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_lock">lock_basic_lock</a>(&amp;<a class="local col9 ref" href="#959xfr" title='xfr' data-ref="959xfr" data-ref-filename="959xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="3528">3528</th><td>	<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3528, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col4 ref" href="#954az" title='az' data-ref="954az" data-ref-filename="954az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="3529">3529</th><td></td></tr>
<tr><th id="3530">3530</th><td>	<a class="tu ref fn" href="#xfr_process_notify" title='xfr_process_notify' data-use='c' data-ref="xfr_process_notify" data-ref-filename="xfr_process_notify">xfr_process_notify</a>(<a class="local col9 ref" href="#959xfr" title='xfr' data-ref="959xfr" data-ref-filename="959xfr">xfr</a>, <a class="local col5 ref" href="#955env" title='env' data-ref="955env" data-ref-filename="955env">env</a>, <var>0</var>, <var>0</var>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="3531">3531</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="3532">3532</th><td>}</td></tr>
<tr><th id="3533">3533</th><td></td></tr>
<tr><th id="3534">3534</th><td><i class="doc" data-doc="auth_xfer_set_expired">/** set a zone expired */</i></td></tr>
<tr><th id="3535">3535</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="3536">3536</th><td><dfn class="tu decl def fn" id="auth_xfer_set_expired" title='auth_xfer_set_expired' data-type='void auth_xfer_set_expired(struct auth_xfer * xfr, struct module_env * env, int expired)' data-ref="auth_xfer_set_expired" data-ref-filename="auth_xfer_set_expired">auth_xfer_set_expired</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col0 decl" id="960xfr" title='xfr' data-type='struct auth_xfer *' data-ref="960xfr" data-ref-filename="960xfr">xfr</dfn>, <b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col1 decl" id="961env" title='env' data-type='struct module_env *' data-ref="961env" data-ref-filename="961env">env</dfn>,</td></tr>
<tr><th id="3537">3537</th><td>	<em>int</em> <dfn class="local col2 decl" id="962expired" title='expired' data-type='int' data-ref="962expired" data-ref-filename="962expired">expired</dfn>)</td></tr>
<tr><th id="3538">3538</th><td>{</td></tr>
<tr><th id="3539">3539</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col3 decl" id="963z" title='z' data-type='struct auth_zone *' data-ref="963z" data-ref-filename="963z">z</dfn>;</td></tr>
<tr><th id="3540">3540</th><td></td></tr>
<tr><th id="3541">3541</th><td>	<i>/* expire xfr */</i></td></tr>
<tr><th id="3542">3542</th><td>	<a class="macro" href="../util/locks.h.html#102" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_lock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_lock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3542, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_lock">lock_basic_lock</a>(&amp;<a class="local col0 ref" href="#960xfr" title='xfr' data-ref="960xfr" data-ref-filename="960xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="3543">3543</th><td>	<a class="local col0 ref" href="#960xfr" title='xfr' data-ref="960xfr" data-ref-filename="960xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::zone_expired" title='auth_xfer::zone_expired' data-ref="auth_xfer::zone_expired" data-ref-filename="auth_xfer..zone_expired">zone_expired</a> = <a class="local col2 ref" href="#962expired" title='expired' data-ref="962expired" data-ref-filename="962expired">expired</a>;</td></tr>
<tr><th id="3544">3544</th><td>	<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3544, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col0 ref" href="#960xfr" title='xfr' data-ref="960xfr" data-ref-filename="960xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="3545">3545</th><td></td></tr>
<tr><th id="3546">3546</th><td>	<i>/* find auth_zone */</i></td></tr>
<tr><th id="3547">3547</th><td>	<a class="macro" href="../util/locks.h.html#119" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_rdlock(&amp;env-&gt;auth_zones-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_rdlock(&amp;env-&gt;auth_zones-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3547, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_rdlock">lock_rw_rdlock</a>(&amp;<a class="local col1 ref" href="#961env" title='env' data-ref="961env" data-ref-filename="961env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::auth_zones" title='module_env::auth_zones' data-ref="module_env::auth_zones" data-ref-filename="module_env..auth_zones">auth_zones</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="3548">3548</th><td>	<a class="local col3 ref" href="#963z" title='z' data-ref="963z" data-ref-filename="963z">z</a> = <a class="ref fn" href="#auth_zone_find" title='auth_zone_find' data-ref="auth_zone_find" data-ref-filename="auth_zone_find">auth_zone_find</a>(<a class="local col1 ref" href="#961env" title='env' data-ref="961env" data-ref-filename="961env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::auth_zones" title='module_env::auth_zones' data-ref="module_env::auth_zones" data-ref-filename="module_env..auth_zones">auth_zones</a>, <a class="local col0 ref" href="#960xfr" title='xfr' data-ref="960xfr" data-ref-filename="960xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a>, <a class="local col0 ref" href="#960xfr" title='xfr' data-ref="960xfr" data-ref-filename="960xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::namelen" title='auth_xfer::namelen' data-ref="auth_xfer::namelen" data-ref-filename="auth_xfer..namelen">namelen</a>,</td></tr>
<tr><th id="3549">3549</th><td>		<a class="local col0 ref" href="#960xfr" title='xfr' data-ref="960xfr" data-ref-filename="960xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::dclass" title='auth_xfer::dclass' data-ref="auth_xfer::dclass" data-ref-filename="auth_xfer..dclass">dclass</a>);</td></tr>
<tr><th id="3550">3550</th><td>	<b>if</b>(!<a class="local col3 ref" href="#963z" title='z' data-ref="963z" data-ref-filename="963z">z</a>) {</td></tr>
<tr><th id="3551">3551</th><td>		<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;env-&gt;auth_zones-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;env-&gt;auth_zones-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3551, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col1 ref" href="#961env" title='env' data-ref="961env" data-ref-filename="961env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::auth_zones" title='module_env::auth_zones' data-ref="module_env::auth_zones" data-ref-filename="module_env..auth_zones">auth_zones</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="3552">3552</th><td>		<b>return</b>;</td></tr>
<tr><th id="3553">3553</th><td>	}</td></tr>
<tr><th id="3554">3554</th><td>	<a class="macro" href="../util/locks.h.html#120" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_wrlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_wrlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3554, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_wrlock">lock_rw_wrlock</a>(&amp;<a class="local col3 ref" href="#963z" title='z' data-ref="963z" data-ref-filename="963z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="3555">3555</th><td>	<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;env-&gt;auth_zones-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;env-&gt;auth_zones-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3555, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col1 ref" href="#961env" title='env' data-ref="961env" data-ref-filename="961env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::auth_zones" title='module_env::auth_zones' data-ref="module_env::auth_zones" data-ref-filename="module_env..auth_zones">auth_zones</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="3556">3556</th><td></td></tr>
<tr><th id="3557">3557</th><td>	<i>/* expire auth_zone */</i></td></tr>
<tr><th id="3558">3558</th><td>	<a class="local col3 ref" href="#963z" title='z' data-ref="963z" data-ref-filename="963z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::zone_expired" title='auth_zone::zone_expired' data-ref="auth_zone::zone_expired" data-ref-filename="auth_zone..zone_expired">zone_expired</a> = <a class="local col2 ref" href="#962expired" title='expired' data-ref="962expired" data-ref-filename="962expired">expired</a>;</td></tr>
<tr><th id="3559">3559</th><td>	<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 3559, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col3 ref" href="#963z" title='z' data-ref="963z" data-ref-filename="963z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="3560">3560</th><td>}</td></tr>
<tr><th id="3561">3561</th><td></td></tr>
<tr><th id="3562">3562</th><td><i class="doc" data-doc="find_master_by_host">/** find master (from notify or probe) in list of masters */</i></td></tr>
<tr><th id="3563">3563</th><td><em>static</em> <b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>*</td></tr>
<tr><th id="3564">3564</th><td><dfn class="tu decl def fn" id="find_master_by_host" title='find_master_by_host' data-type='struct auth_master * find_master_by_host(struct auth_master * list, char * host)' data-ref="find_master_by_host" data-ref-filename="find_master_by_host">find_master_by_host</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>* <dfn class="local col4 decl" id="964list" title='list' data-type='struct auth_master *' data-ref="964list" data-ref-filename="964list">list</dfn>, <em>char</em>* <dfn class="local col5 decl" id="965host" title='host' data-type='char *' data-ref="965host" data-ref-filename="965host">host</dfn>)</td></tr>
<tr><th id="3565">3565</th><td>{</td></tr>
<tr><th id="3566">3566</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>* <dfn class="local col6 decl" id="966p" title='p' data-type='struct auth_master *' data-ref="966p" data-ref-filename="966p">p</dfn>;</td></tr>
<tr><th id="3567">3567</th><td>	<b>for</b>(<a class="local col6 ref" href="#966p" title='p' data-ref="966p" data-ref-filename="966p">p</a>=<a class="local col4 ref" href="#964list" title='list' data-ref="964list" data-ref-filename="964list">list</a>; <a class="local col6 ref" href="#966p" title='p' data-ref="966p" data-ref-filename="966p">p</a>; <a class="local col6 ref" href="#966p" title='p' data-ref="966p" data-ref-filename="966p">p</a>=<a class="local col6 ref" href="#966p" title='p' data-ref="966p" data-ref-filename="966p">p</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::next" title='auth_master::next' data-ref="auth_master::next" data-ref-filename="auth_master..next">next</a>) {</td></tr>
<tr><th id="3568">3568</th><td>		<b>if</b>(<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strcmp" title='strcmp' data-ref="strcmp" data-ref-filename="strcmp">strcmp</a>(<a class="local col6 ref" href="#966p" title='p' data-ref="966p" data-ref-filename="966p">p</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>, <a class="local col5 ref" href="#965host" title='host' data-ref="965host" data-ref-filename="965host">host</a>) == <var>0</var>)</td></tr>
<tr><th id="3569">3569</th><td>			<b>return</b> <a class="local col6 ref" href="#966p" title='p' data-ref="966p" data-ref-filename="966p">p</a>;</td></tr>
<tr><th id="3570">3570</th><td>	}</td></tr>
<tr><th id="3571">3571</th><td>	<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="3572">3572</th><td>}</td></tr>
<tr><th id="3573">3573</th><td></td></tr>
<tr><th id="3574">3574</th><td><i class="doc" data-doc="xfr_masterlist_free_addrs">/** delete the looked up auth_addrs for all the masters in the list */</i></td></tr>
<tr><th id="3575">3575</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="3576">3576</th><td><dfn class="tu decl def fn" id="xfr_masterlist_free_addrs" title='xfr_masterlist_free_addrs' data-type='void xfr_masterlist_free_addrs(struct auth_master * list)' data-ref="xfr_masterlist_free_addrs" data-ref-filename="xfr_masterlist_free_addrs">xfr_masterlist_free_addrs</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>* <dfn class="local col7 decl" id="967list" title='list' data-type='struct auth_master *' data-ref="967list" data-ref-filename="967list">list</dfn>)</td></tr>
<tr><th id="3577">3577</th><td>{</td></tr>
<tr><th id="3578">3578</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>* <dfn class="local col8 decl" id="968m" title='m' data-type='struct auth_master *' data-ref="968m" data-ref-filename="968m">m</dfn>;</td></tr>
<tr><th id="3579">3579</th><td>	<b>for</b>(<a class="local col8 ref" href="#968m" title='m' data-ref="968m" data-ref-filename="968m">m</a>=<a class="local col7 ref" href="#967list" title='list' data-ref="967list" data-ref-filename="967list">list</a>; <a class="local col8 ref" href="#968m" title='m' data-ref="968m" data-ref-filename="968m">m</a>; <a class="local col8 ref" href="#968m" title='m' data-ref="968m" data-ref-filename="968m">m</a>=<a class="local col8 ref" href="#968m" title='m' data-ref="968m" data-ref-filename="968m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::next" title='auth_master::next' data-ref="auth_master::next" data-ref-filename="auth_master..next">next</a>) {</td></tr>
<tr><th id="3580">3580</th><td>		<b>if</b>(<a class="local col8 ref" href="#968m" title='m' data-ref="968m" data-ref-filename="968m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::list" title='auth_master::list' data-ref="auth_master::list" data-ref-filename="auth_master..list">list</a>) {</td></tr>
<tr><th id="3581">3581</th><td>			<a class="tu ref fn" href="#auth_free_master_addrs" title='auth_free_master_addrs' data-use='c' data-ref="auth_free_master_addrs" data-ref-filename="auth_free_master_addrs">auth_free_master_addrs</a>(<a class="local col8 ref" href="#968m" title='m' data-ref="968m" data-ref-filename="968m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::list" title='auth_master::list' data-ref="auth_master::list" data-ref-filename="auth_master..list">list</a>);</td></tr>
<tr><th id="3582">3582</th><td>			<a class="local col8 ref" href="#968m" title='m' data-ref="968m" data-ref-filename="968m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::list" title='auth_master::list' data-ref="auth_master::list" data-ref-filename="auth_master..list">list</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="3583">3583</th><td>		}</td></tr>
<tr><th id="3584">3584</th><td>	}</td></tr>
<tr><th id="3585">3585</th><td>}</td></tr>
<tr><th id="3586">3586</th><td></td></tr>
<tr><th id="3587">3587</th><td><i class="doc" data-doc="auth_addr_list_copy">/** copy a list of auth_addrs */</i></td></tr>
<tr><th id="3588">3588</th><td><em>static</em> <b>struct</b> <a class="type" href="authzone.h.html#auth_addr" title='auth_addr' data-ref="auth_addr" data-ref-filename="auth_addr">auth_addr</a>*</td></tr>
<tr><th id="3589">3589</th><td><dfn class="tu decl def fn" id="auth_addr_list_copy" title='auth_addr_list_copy' data-type='struct auth_addr * auth_addr_list_copy(struct auth_addr * source)' data-ref="auth_addr_list_copy" data-ref-filename="auth_addr_list_copy">auth_addr_list_copy</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_addr" title='auth_addr' data-ref="auth_addr" data-ref-filename="auth_addr">auth_addr</a>* <dfn class="local col9 decl" id="969source" title='source' data-type='struct auth_addr *' data-ref="969source" data-ref-filename="969source">source</dfn>)</td></tr>
<tr><th id="3590">3590</th><td>{</td></tr>
<tr><th id="3591">3591</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_addr" title='auth_addr' data-ref="auth_addr" data-ref-filename="auth_addr">auth_addr</a>* <dfn class="local col0 decl" id="970list" title='list' data-type='struct auth_addr *' data-ref="970list" data-ref-filename="970list">list</dfn> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>, *<dfn class="local col1 decl" id="971last" title='last' data-type='struct auth_addr *' data-ref="971last" data-ref-filename="971last">last</dfn> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="3592">3592</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_addr" title='auth_addr' data-ref="auth_addr" data-ref-filename="auth_addr">auth_addr</a>* <dfn class="local col2 decl" id="972p" title='p' data-type='struct auth_addr *' data-ref="972p" data-ref-filename="972p">p</dfn>;</td></tr>
<tr><th id="3593">3593</th><td>	<b>for</b>(<a class="local col2 ref" href="#972p" title='p' data-ref="972p" data-ref-filename="972p">p</a>=<a class="local col9 ref" href="#969source" title='source' data-ref="969source" data-ref-filename="969source">source</a>; <a class="local col2 ref" href="#972p" title='p' data-ref="972p" data-ref-filename="972p">p</a>; <a class="local col2 ref" href="#972p" title='p' data-ref="972p" data-ref-filename="972p">p</a>=<a class="local col2 ref" href="#972p" title='p' data-ref="972p" data-ref-filename="972p">p</a>-&gt;<a class="ref field" href="authzone.h.html#auth_addr::next" title='auth_addr::next' data-ref="auth_addr::next" data-ref-filename="auth_addr..next">next</a>) {</td></tr>
<tr><th id="3594">3594</th><td>		<b>struct</b> <a class="type" href="authzone.h.html#auth_addr" title='auth_addr' data-ref="auth_addr" data-ref-filename="auth_addr">auth_addr</a>* <dfn class="local col3 decl" id="973a" title='a' data-type='struct auth_addr *' data-ref="973a" data-ref-filename="973a">a</dfn> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_addr" title='auth_addr' data-ref="auth_addr" data-ref-filename="auth_addr">auth_addr</a>*)<a class="ref fn" href="../util/net_help.h.html#memdup" title='memdup' data-ref="memdup" data-ref-filename="memdup">memdup</a>(<a class="local col2 ref" href="#972p" title='p' data-ref="972p" data-ref-filename="972p">p</a>, <b>sizeof</b>(*<a class="local col2 ref" href="#972p" title='p' data-ref="972p" data-ref-filename="972p">p</a>));</td></tr>
<tr><th id="3595">3595</th><td>		<b>if</b>(!<a class="local col3 ref" href="#973a" title='a' data-ref="973a" data-ref-filename="973a">a</a>) {</td></tr>
<tr><th id="3596">3596</th><td>			<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"malloc failure"</q>);</td></tr>
<tr><th id="3597">3597</th><td>			<a class="tu ref fn" href="#auth_free_master_addrs" title='auth_free_master_addrs' data-use='c' data-ref="auth_free_master_addrs" data-ref-filename="auth_free_master_addrs">auth_free_master_addrs</a>(<a class="local col0 ref" href="#970list" title='list' data-ref="970list" data-ref-filename="970list">list</a>);</td></tr>
<tr><th id="3598">3598</th><td>			<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="3599">3599</th><td>		}</td></tr>
<tr><th id="3600">3600</th><td>		<a class="local col3 ref" href="#973a" title='a' data-ref="973a" data-ref-filename="973a">a</a>-&gt;<a class="ref field" href="authzone.h.html#auth_addr::next" title='auth_addr::next' data-ref="auth_addr::next" data-ref-filename="auth_addr..next">next</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="3601">3601</th><td>		<b>if</b>(<a class="local col1 ref" href="#971last" title='last' data-ref="971last" data-ref-filename="971last">last</a>) <a class="local col1 ref" href="#971last" title='last' data-ref="971last" data-ref-filename="971last">last</a>-&gt;<a class="ref field" href="authzone.h.html#auth_addr::next" title='auth_addr::next' data-ref="auth_addr::next" data-ref-filename="auth_addr..next">next</a> = <a class="local col3 ref" href="#973a" title='a' data-ref="973a" data-ref-filename="973a">a</a>;</td></tr>
<tr><th id="3602">3602</th><td>		<b>if</b>(!<a class="local col0 ref" href="#970list" title='list' data-ref="970list" data-ref-filename="970list">list</a>) <a class="local col0 ref" href="#970list" title='list' data-ref="970list" data-ref-filename="970list">list</a> = <a class="local col3 ref" href="#973a" title='a' data-ref="973a" data-ref-filename="973a">a</a>;</td></tr>
<tr><th id="3603">3603</th><td>		<a class="local col1 ref" href="#971last" title='last' data-ref="971last" data-ref-filename="971last">last</a> = <a class="local col3 ref" href="#973a" title='a' data-ref="973a" data-ref-filename="973a">a</a>;</td></tr>
<tr><th id="3604">3604</th><td>	}</td></tr>
<tr><th id="3605">3605</th><td>	<b>return</b> <a class="local col0 ref" href="#970list" title='list' data-ref="970list" data-ref-filename="970list">list</a>;</td></tr>
<tr><th id="3606">3606</th><td>}</td></tr>
<tr><th id="3607">3607</th><td></td></tr>
<tr><th id="3608">3608</th><td><i class="doc" data-doc="auth_master_copy">/** copy a master to a new structure, NULL on alloc failure */</i></td></tr>
<tr><th id="3609">3609</th><td><em>static</em> <b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>*</td></tr>
<tr><th id="3610">3610</th><td><dfn class="tu decl def fn" id="auth_master_copy" title='auth_master_copy' data-type='struct auth_master * auth_master_copy(struct auth_master * o)' data-ref="auth_master_copy" data-ref-filename="auth_master_copy">auth_master_copy</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>* <dfn class="local col4 decl" id="974o" title='o' data-type='struct auth_master *' data-ref="974o" data-ref-filename="974o">o</dfn>)</td></tr>
<tr><th id="3611">3611</th><td>{</td></tr>
<tr><th id="3612">3612</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>* <dfn class="local col5 decl" id="975m" title='m' data-type='struct auth_master *' data-ref="975m" data-ref-filename="975m">m</dfn>;</td></tr>
<tr><th id="3613">3613</th><td>	<b>if</b>(!<a class="local col4 ref" href="#974o" title='o' data-ref="974o" data-ref-filename="974o">o</a>) <b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="3614">3614</th><td>	<a class="local col5 ref" href="#975m" title='m' data-ref="975m" data-ref-filename="975m">m</a> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>*)<a class="ref fn" href="../util/net_help.h.html#memdup" title='memdup' data-ref="memdup" data-ref-filename="memdup">memdup</a>(<a class="local col4 ref" href="#974o" title='o' data-ref="974o" data-ref-filename="974o">o</a>, <b>sizeof</b>(*<a class="local col4 ref" href="#974o" title='o' data-ref="974o" data-ref-filename="974o">o</a>));</td></tr>
<tr><th id="3615">3615</th><td>	<b>if</b>(!<a class="local col5 ref" href="#975m" title='m' data-ref="975m" data-ref-filename="975m">m</a>) {</td></tr>
<tr><th id="3616">3616</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"malloc failure"</q>);</td></tr>
<tr><th id="3617">3617</th><td>		<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="3618">3618</th><td>	}</td></tr>
<tr><th id="3619">3619</th><td>	<a class="local col5 ref" href="#975m" title='m' data-ref="975m" data-ref-filename="975m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::next" title='auth_master::next' data-ref="auth_master::next" data-ref-filename="auth_master..next">next</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="3620">3620</th><td>	<b>if</b>(<a class="local col5 ref" href="#975m" title='m' data-ref="975m" data-ref-filename="975m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>) {</td></tr>
<tr><th id="3621">3621</th><td>		<a class="local col5 ref" href="#975m" title='m' data-ref="975m" data-ref-filename="975m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strdup" title='strdup' data-ref="strdup" data-ref-filename="strdup">strdup</a>(<a class="local col5 ref" href="#975m" title='m' data-ref="975m" data-ref-filename="975m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="3622">3622</th><td>		<b>if</b>(!<a class="local col5 ref" href="#975m" title='m' data-ref="975m" data-ref-filename="975m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>) {</td></tr>
<tr><th id="3623">3623</th><td>			<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col5 ref" href="#975m" title='m' data-ref="975m" data-ref-filename="975m">m</a>);</td></tr>
<tr><th id="3624">3624</th><td>			<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"malloc failure"</q>);</td></tr>
<tr><th id="3625">3625</th><td>			<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="3626">3626</th><td>		}</td></tr>
<tr><th id="3627">3627</th><td>	}</td></tr>
<tr><th id="3628">3628</th><td>	<b>if</b>(<a class="local col5 ref" href="#975m" title='m' data-ref="975m" data-ref-filename="975m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::file" title='auth_master::file' data-ref="auth_master::file" data-ref-filename="auth_master..file">file</a>) {</td></tr>
<tr><th id="3629">3629</th><td>		<a class="local col5 ref" href="#975m" title='m' data-ref="975m" data-ref-filename="975m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::file" title='auth_master::file' data-ref="auth_master::file" data-ref-filename="auth_master..file">file</a> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strdup" title='strdup' data-ref="strdup" data-ref-filename="strdup">strdup</a>(<a class="local col5 ref" href="#975m" title='m' data-ref="975m" data-ref-filename="975m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::file" title='auth_master::file' data-ref="auth_master::file" data-ref-filename="auth_master..file">file</a>);</td></tr>
<tr><th id="3630">3630</th><td>		<b>if</b>(!<a class="local col5 ref" href="#975m" title='m' data-ref="975m" data-ref-filename="975m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::file" title='auth_master::file' data-ref="auth_master::file" data-ref-filename="auth_master..file">file</a>) {</td></tr>
<tr><th id="3631">3631</th><td>			<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col5 ref" href="#975m" title='m' data-ref="975m" data-ref-filename="975m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="3632">3632</th><td>			<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col5 ref" href="#975m" title='m' data-ref="975m" data-ref-filename="975m">m</a>);</td></tr>
<tr><th id="3633">3633</th><td>			<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"malloc failure"</q>);</td></tr>
<tr><th id="3634">3634</th><td>			<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="3635">3635</th><td>		}</td></tr>
<tr><th id="3636">3636</th><td>	}</td></tr>
<tr><th id="3637">3637</th><td>	<b>if</b>(<a class="local col5 ref" href="#975m" title='m' data-ref="975m" data-ref-filename="975m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::list" title='auth_master::list' data-ref="auth_master::list" data-ref-filename="auth_master..list">list</a>) {</td></tr>
<tr><th id="3638">3638</th><td>		<a class="local col5 ref" href="#975m" title='m' data-ref="975m" data-ref-filename="975m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::list" title='auth_master::list' data-ref="auth_master::list" data-ref-filename="auth_master..list">list</a> = <a class="tu ref fn" href="#auth_addr_list_copy" title='auth_addr_list_copy' data-use='c' data-ref="auth_addr_list_copy" data-ref-filename="auth_addr_list_copy">auth_addr_list_copy</a>(<a class="local col5 ref" href="#975m" title='m' data-ref="975m" data-ref-filename="975m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::list" title='auth_master::list' data-ref="auth_master::list" data-ref-filename="auth_master..list">list</a>);</td></tr>
<tr><th id="3639">3639</th><td>		<b>if</b>(!<a class="local col5 ref" href="#975m" title='m' data-ref="975m" data-ref-filename="975m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::list" title='auth_master::list' data-ref="auth_master::list" data-ref-filename="auth_master..list">list</a>) {</td></tr>
<tr><th id="3640">3640</th><td>			<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col5 ref" href="#975m" title='m' data-ref="975m" data-ref-filename="975m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::file" title='auth_master::file' data-ref="auth_master::file" data-ref-filename="auth_master..file">file</a>);</td></tr>
<tr><th id="3641">3641</th><td>			<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col5 ref" href="#975m" title='m' data-ref="975m" data-ref-filename="975m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="3642">3642</th><td>			<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col5 ref" href="#975m" title='m' data-ref="975m" data-ref-filename="975m">m</a>);</td></tr>
<tr><th id="3643">3643</th><td>			<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="3644">3644</th><td>		}</td></tr>
<tr><th id="3645">3645</th><td>	}</td></tr>
<tr><th id="3646">3646</th><td>	<b>return</b> <a class="local col5 ref" href="#975m" title='m' data-ref="975m" data-ref-filename="975m">m</a>;</td></tr>
<tr><th id="3647">3647</th><td>}</td></tr>
<tr><th id="3648">3648</th><td></td></tr>
<tr><th id="3649">3649</th><td><i class="doc" data-doc="probe_copy_masters_for_allow_notify">/** copy the master addresses from the task_probe lookups to the allow_notify</i></td></tr>
<tr><th id="3650">3650</th><td><i class="doc" data-doc="probe_copy_masters_for_allow_notify"> * list of masters */</i></td></tr>
<tr><th id="3651">3651</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="3652">3652</th><td><dfn class="tu decl def fn" id="probe_copy_masters_for_allow_notify" title='probe_copy_masters_for_allow_notify' data-type='void probe_copy_masters_for_allow_notify(struct auth_xfer * xfr)' data-ref="probe_copy_masters_for_allow_notify" data-ref-filename="probe_copy_masters_for_allow_notify">probe_copy_masters_for_allow_notify</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col6 decl" id="976xfr" title='xfr' data-type='struct auth_xfer *' data-ref="976xfr" data-ref-filename="976xfr">xfr</dfn>)</td></tr>
<tr><th id="3653">3653</th><td>{</td></tr>
<tr><th id="3654">3654</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>* <dfn class="local col7 decl" id="977list" title='list' data-type='struct auth_master *' data-ref="977list" data-ref-filename="977list">list</dfn> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>, *<dfn class="local col8 decl" id="978last" title='last' data-type='struct auth_master *' data-ref="978last" data-ref-filename="978last">last</dfn> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="3655">3655</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>* <dfn class="local col9 decl" id="979p" title='p' data-type='struct auth_master *' data-ref="979p" data-ref-filename="979p">p</dfn>;</td></tr>
<tr><th id="3656">3656</th><td>	<i>/* build up new list with copies */</i></td></tr>
<tr><th id="3657">3657</th><td>	<b>for</b>(<a class="local col9 ref" href="#979p" title='p' data-ref="979p" data-ref-filename="979p">p</a> = <a class="local col6 ref" href="#976xfr" title='xfr' data-ref="976xfr" data-ref-filename="976xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::masters" title='auth_probe::masters' data-ref="auth_probe::masters" data-ref-filename="auth_probe..masters">masters</a>; <a class="local col9 ref" href="#979p" title='p' data-ref="979p" data-ref-filename="979p">p</a>; <a class="local col9 ref" href="#979p" title='p' data-ref="979p" data-ref-filename="979p">p</a>=<a class="local col9 ref" href="#979p" title='p' data-ref="979p" data-ref-filename="979p">p</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::next" title='auth_master::next' data-ref="auth_master::next" data-ref-filename="auth_master..next">next</a>) {</td></tr>
<tr><th id="3658">3658</th><td>		<b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>* <dfn class="local col0 decl" id="980m" title='m' data-type='struct auth_master *' data-ref="980m" data-ref-filename="980m">m</dfn> = <a class="tu ref fn" href="#auth_master_copy" title='auth_master_copy' data-use='c' data-ref="auth_master_copy" data-ref-filename="auth_master_copy">auth_master_copy</a>(<a class="local col9 ref" href="#979p" title='p' data-ref="979p" data-ref-filename="979p">p</a>);</td></tr>
<tr><th id="3659">3659</th><td>		<b>if</b>(!<a class="local col0 ref" href="#980m" title='m' data-ref="980m" data-ref-filename="980m">m</a>) {</td></tr>
<tr><th id="3660">3660</th><td>			<a class="tu ref fn" href="#auth_free_masters" title='auth_free_masters' data-use='c' data-ref="auth_free_masters" data-ref-filename="auth_free_masters">auth_free_masters</a>(<a class="local col7 ref" href="#977list" title='list' data-ref="977list" data-ref-filename="977list">list</a>);</td></tr>
<tr><th id="3661">3661</th><td>			<i>/* failed because of malloc failure, use old list */</i></td></tr>
<tr><th id="3662">3662</th><td>			<b>return</b>;</td></tr>
<tr><th id="3663">3663</th><td>		}</td></tr>
<tr><th id="3664">3664</th><td>		<a class="local col0 ref" href="#980m" title='m' data-ref="980m" data-ref-filename="980m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::next" title='auth_master::next' data-ref="auth_master::next" data-ref-filename="auth_master..next">next</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="3665">3665</th><td>		<b>if</b>(<a class="local col8 ref" href="#978last" title='last' data-ref="978last" data-ref-filename="978last">last</a>) <a class="local col8 ref" href="#978last" title='last' data-ref="978last" data-ref-filename="978last">last</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::next" title='auth_master::next' data-ref="auth_master::next" data-ref-filename="auth_master..next">next</a> = <a class="local col0 ref" href="#980m" title='m' data-ref="980m" data-ref-filename="980m">m</a>;</td></tr>
<tr><th id="3666">3666</th><td>		<b>if</b>(!<a class="local col7 ref" href="#977list" title='list' data-ref="977list" data-ref-filename="977list">list</a>) <a class="local col7 ref" href="#977list" title='list' data-ref="977list" data-ref-filename="977list">list</a> = <a class="local col0 ref" href="#980m" title='m' data-ref="980m" data-ref-filename="980m">m</a>;</td></tr>
<tr><th id="3667">3667</th><td>		<a class="local col8 ref" href="#978last" title='last' data-ref="978last" data-ref-filename="978last">last</a> = <a class="local col0 ref" href="#980m" title='m' data-ref="980m" data-ref-filename="980m">m</a>;</td></tr>
<tr><th id="3668">3668</th><td>	}</td></tr>
<tr><th id="3669">3669</th><td>	<i>/* success, replace list */</i></td></tr>
<tr><th id="3670">3670</th><td>	<a class="tu ref fn" href="#auth_free_masters" title='auth_free_masters' data-use='c' data-ref="auth_free_masters" data-ref-filename="auth_free_masters">auth_free_masters</a>(<a class="local col6 ref" href="#976xfr" title='xfr' data-ref="976xfr" data-ref-filename="976xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::allow_notify_list" title='auth_xfer::allow_notify_list' data-ref="auth_xfer::allow_notify_list" data-ref-filename="auth_xfer..allow_notify_list">allow_notify_list</a>);</td></tr>
<tr><th id="3671">3671</th><td>	<a class="local col6 ref" href="#976xfr" title='xfr' data-ref="976xfr" data-ref-filename="976xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::allow_notify_list" title='auth_xfer::allow_notify_list' data-ref="auth_xfer::allow_notify_list" data-ref-filename="auth_xfer..allow_notify_list">allow_notify_list</a> = <a class="local col7 ref" href="#977list" title='list' data-ref="977list" data-ref-filename="977list">list</a>;</td></tr>
<tr><th id="3672">3672</th><td>}</td></tr>
<tr><th id="3673">3673</th><td></td></tr>
<tr><th id="3674">3674</th><td><i class="doc" data-doc="xfr_transfer_start_lookups">/** start the lookups for task_transfer */</i></td></tr>
<tr><th id="3675">3675</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="3676">3676</th><td><dfn class="tu decl def fn" id="xfr_transfer_start_lookups" title='xfr_transfer_start_lookups' data-type='void xfr_transfer_start_lookups(struct auth_xfer * xfr)' data-ref="xfr_transfer_start_lookups" data-ref-filename="xfr_transfer_start_lookups">xfr_transfer_start_lookups</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col1 decl" id="981xfr" title='xfr' data-type='struct auth_xfer *' data-ref="981xfr" data-ref-filename="981xfr">xfr</dfn>)</td></tr>
<tr><th id="3677">3677</th><td>{</td></tr>
<tr><th id="3678">3678</th><td>	<i>/* delete all the looked up addresses in the list */</i></td></tr>
<tr><th id="3679">3679</th><td>	<a class="tu ref fn" href="#xfr_masterlist_free_addrs" title='xfr_masterlist_free_addrs' data-use='c' data-ref="xfr_masterlist_free_addrs" data-ref-filename="xfr_masterlist_free_addrs">xfr_masterlist_free_addrs</a>(<a class="local col1 ref" href="#981xfr" title='xfr' data-ref="981xfr" data-ref-filename="981xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::masters" title='auth_transfer::masters' data-ref="auth_transfer::masters" data-ref-filename="auth_transfer..masters">masters</a>);</td></tr>
<tr><th id="3680">3680</th><td></td></tr>
<tr><th id="3681">3681</th><td>	<i>/* start lookup at the first master */</i></td></tr>
<tr><th id="3682">3682</th><td>	<a class="local col1 ref" href="#981xfr" title='xfr' data-ref="981xfr" data-ref-filename="981xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::lookup_target" title='auth_transfer::lookup_target' data-ref="auth_transfer::lookup_target" data-ref-filename="auth_transfer..lookup_target">lookup_target</a> = <a class="local col1 ref" href="#981xfr" title='xfr' data-ref="981xfr" data-ref-filename="981xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::masters" title='auth_transfer::masters' data-ref="auth_transfer::masters" data-ref-filename="auth_transfer..masters">masters</a>;</td></tr>
<tr><th id="3683">3683</th><td>	<a class="local col1 ref" href="#981xfr" title='xfr' data-ref="981xfr" data-ref-filename="981xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::lookup_aaaa" title='auth_transfer::lookup_aaaa' data-ref="auth_transfer::lookup_aaaa" data-ref-filename="auth_transfer..lookup_aaaa">lookup_aaaa</a> = <var>0</var>;</td></tr>
<tr><th id="3684">3684</th><td>}</td></tr>
<tr><th id="3685">3685</th><td></td></tr>
<tr><th id="3686">3686</th><td><i class="doc" data-doc="xfr_transfer_move_to_next_lookup">/** move to the next lookup of hostname for task_transfer */</i></td></tr>
<tr><th id="3687">3687</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="3688">3688</th><td><dfn class="tu decl def fn" id="xfr_transfer_move_to_next_lookup" title='xfr_transfer_move_to_next_lookup' data-type='void xfr_transfer_move_to_next_lookup(struct auth_xfer * xfr, struct module_env * env)' data-ref="xfr_transfer_move_to_next_lookup" data-ref-filename="xfr_transfer_move_to_next_lookup">xfr_transfer_move_to_next_lookup</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col2 decl" id="982xfr" title='xfr' data-type='struct auth_xfer *' data-ref="982xfr" data-ref-filename="982xfr">xfr</dfn>, <b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col3 decl" id="983env" title='env' data-type='struct module_env *' data-ref="983env" data-ref-filename="983env">env</dfn>)</td></tr>
<tr><th id="3689">3689</th><td>{</td></tr>
<tr><th id="3690">3690</th><td>	<b>if</b>(!<a class="local col2 ref" href="#982xfr" title='xfr' data-ref="982xfr" data-ref-filename="982xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::lookup_target" title='auth_transfer::lookup_target' data-ref="auth_transfer::lookup_target" data-ref-filename="auth_transfer..lookup_target">lookup_target</a>)</td></tr>
<tr><th id="3691">3691</th><td>		<b>return</b>; <i>/* already at end of list */</i></td></tr>
<tr><th id="3692">3692</th><td>	<b>if</b>(!<a class="local col2 ref" href="#982xfr" title='xfr' data-ref="982xfr" data-ref-filename="982xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::lookup_aaaa" title='auth_transfer::lookup_aaaa' data-ref="auth_transfer::lookup_aaaa" data-ref-filename="auth_transfer..lookup_aaaa">lookup_aaaa</a> &amp;&amp; <a class="local col3 ref" href="#983env" title='env' data-ref="983env" data-ref-filename="983env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::cfg" title='module_env::cfg' data-ref="module_env::cfg" data-ref-filename="module_env..cfg">cfg</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_file::do_ip6" title='config_file::do_ip6' data-ref="config_file::do_ip6" data-ref-filename="config_file..do_ip6">do_ip6</a>) {</td></tr>
<tr><th id="3693">3693</th><td>		<i>/* move to lookup AAAA */</i></td></tr>
<tr><th id="3694">3694</th><td>		<a class="local col2 ref" href="#982xfr" title='xfr' data-ref="982xfr" data-ref-filename="982xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::lookup_aaaa" title='auth_transfer::lookup_aaaa' data-ref="auth_transfer::lookup_aaaa" data-ref-filename="auth_transfer..lookup_aaaa">lookup_aaaa</a> = <var>1</var>;</td></tr>
<tr><th id="3695">3695</th><td>		<b>return</b>;</td></tr>
<tr><th id="3696">3696</th><td>	}</td></tr>
<tr><th id="3697">3697</th><td>	<a class="local col2 ref" href="#982xfr" title='xfr' data-ref="982xfr" data-ref-filename="982xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::lookup_target" title='auth_transfer::lookup_target' data-ref="auth_transfer::lookup_target" data-ref-filename="auth_transfer..lookup_target">lookup_target</a> = </td></tr>
<tr><th id="3698">3698</th><td>		<a class="local col2 ref" href="#982xfr" title='xfr' data-ref="982xfr" data-ref-filename="982xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::lookup_target" title='auth_transfer::lookup_target' data-ref="auth_transfer::lookup_target" data-ref-filename="auth_transfer..lookup_target">lookup_target</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::next" title='auth_master::next' data-ref="auth_master::next" data-ref-filename="auth_master..next">next</a>;</td></tr>
<tr><th id="3699">3699</th><td>	<a class="local col2 ref" href="#982xfr" title='xfr' data-ref="982xfr" data-ref-filename="982xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::lookup_aaaa" title='auth_transfer::lookup_aaaa' data-ref="auth_transfer::lookup_aaaa" data-ref-filename="auth_transfer..lookup_aaaa">lookup_aaaa</a> = <var>0</var>;</td></tr>
<tr><th id="3700">3700</th><td>	<b>if</b>(!<a class="local col3 ref" href="#983env" title='env' data-ref="983env" data-ref-filename="983env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::cfg" title='module_env::cfg' data-ref="module_env::cfg" data-ref-filename="module_env..cfg">cfg</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_file::do_ip4" title='config_file::do_ip4' data-ref="config_file::do_ip4" data-ref-filename="config_file..do_ip4">do_ip4</a> &amp;&amp; <a class="local col2 ref" href="#982xfr" title='xfr' data-ref="982xfr" data-ref-filename="982xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::lookup_target" title='auth_transfer::lookup_target' data-ref="auth_transfer::lookup_target" data-ref-filename="auth_transfer..lookup_target">lookup_target</a>!=<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>)</td></tr>
<tr><th id="3701">3701</th><td>		<a class="local col2 ref" href="#982xfr" title='xfr' data-ref="982xfr" data-ref-filename="982xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::lookup_aaaa" title='auth_transfer::lookup_aaaa' data-ref="auth_transfer::lookup_aaaa" data-ref-filename="auth_transfer..lookup_aaaa">lookup_aaaa</a> = <var>1</var>;</td></tr>
<tr><th id="3702">3702</th><td>}</td></tr>
<tr><th id="3703">3703</th><td></td></tr>
<tr><th id="3704">3704</th><td><i class="doc" data-doc="xfr_probe_start_lookups">/** start the lookups for task_probe */</i></td></tr>
<tr><th id="3705">3705</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="3706">3706</th><td><dfn class="tu decl def fn" id="xfr_probe_start_lookups" title='xfr_probe_start_lookups' data-type='void xfr_probe_start_lookups(struct auth_xfer * xfr)' data-ref="xfr_probe_start_lookups" data-ref-filename="xfr_probe_start_lookups">xfr_probe_start_lookups</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col4 decl" id="984xfr" title='xfr' data-type='struct auth_xfer *' data-ref="984xfr" data-ref-filename="984xfr">xfr</dfn>)</td></tr>
<tr><th id="3707">3707</th><td>{</td></tr>
<tr><th id="3708">3708</th><td>	<i>/* delete all the looked up addresses in the list */</i></td></tr>
<tr><th id="3709">3709</th><td>	<a class="tu ref fn" href="#xfr_masterlist_free_addrs" title='xfr_masterlist_free_addrs' data-use='c' data-ref="xfr_masterlist_free_addrs" data-ref-filename="xfr_masterlist_free_addrs">xfr_masterlist_free_addrs</a>(<a class="local col4 ref" href="#984xfr" title='xfr' data-ref="984xfr" data-ref-filename="984xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::masters" title='auth_probe::masters' data-ref="auth_probe::masters" data-ref-filename="auth_probe..masters">masters</a>);</td></tr>
<tr><th id="3710">3710</th><td></td></tr>
<tr><th id="3711">3711</th><td>	<i>/* start lookup at the first master */</i></td></tr>
<tr><th id="3712">3712</th><td>	<a class="local col4 ref" href="#984xfr" title='xfr' data-ref="984xfr" data-ref-filename="984xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::lookup_target" title='auth_probe::lookup_target' data-ref="auth_probe::lookup_target" data-ref-filename="auth_probe..lookup_target">lookup_target</a> = <a class="local col4 ref" href="#984xfr" title='xfr' data-ref="984xfr" data-ref-filename="984xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::masters" title='auth_probe::masters' data-ref="auth_probe::masters" data-ref-filename="auth_probe..masters">masters</a>;</td></tr>
<tr><th id="3713">3713</th><td>	<a class="local col4 ref" href="#984xfr" title='xfr' data-ref="984xfr" data-ref-filename="984xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::lookup_aaaa" title='auth_probe::lookup_aaaa' data-ref="auth_probe::lookup_aaaa" data-ref-filename="auth_probe..lookup_aaaa">lookup_aaaa</a> = <var>0</var>;</td></tr>
<tr><th id="3714">3714</th><td>}</td></tr>
<tr><th id="3715">3715</th><td></td></tr>
<tr><th id="3716">3716</th><td><i class="doc" data-doc="xfr_probe_move_to_next_lookup">/** move to the next lookup of hostname for task_probe */</i></td></tr>
<tr><th id="3717">3717</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="3718">3718</th><td><dfn class="tu decl def fn" id="xfr_probe_move_to_next_lookup" title='xfr_probe_move_to_next_lookup' data-type='void xfr_probe_move_to_next_lookup(struct auth_xfer * xfr, struct module_env * env)' data-ref="xfr_probe_move_to_next_lookup" data-ref-filename="xfr_probe_move_to_next_lookup">xfr_probe_move_to_next_lookup</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col5 decl" id="985xfr" title='xfr' data-type='struct auth_xfer *' data-ref="985xfr" data-ref-filename="985xfr">xfr</dfn>, <b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col6 decl" id="986env" title='env' data-type='struct module_env *' data-ref="986env" data-ref-filename="986env">env</dfn>)</td></tr>
<tr><th id="3719">3719</th><td>{</td></tr>
<tr><th id="3720">3720</th><td>	<b>if</b>(!<a class="local col5 ref" href="#985xfr" title='xfr' data-ref="985xfr" data-ref-filename="985xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::lookup_target" title='auth_probe::lookup_target' data-ref="auth_probe::lookup_target" data-ref-filename="auth_probe..lookup_target">lookup_target</a>)</td></tr>
<tr><th id="3721">3721</th><td>		<b>return</b>; <i>/* already at end of list */</i></td></tr>
<tr><th id="3722">3722</th><td>	<b>if</b>(!<a class="local col5 ref" href="#985xfr" title='xfr' data-ref="985xfr" data-ref-filename="985xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::lookup_aaaa" title='auth_probe::lookup_aaaa' data-ref="auth_probe::lookup_aaaa" data-ref-filename="auth_probe..lookup_aaaa">lookup_aaaa</a> &amp;&amp; <a class="local col6 ref" href="#986env" title='env' data-ref="986env" data-ref-filename="986env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::cfg" title='module_env::cfg' data-ref="module_env::cfg" data-ref-filename="module_env..cfg">cfg</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_file::do_ip6" title='config_file::do_ip6' data-ref="config_file::do_ip6" data-ref-filename="config_file..do_ip6">do_ip6</a>) {</td></tr>
<tr><th id="3723">3723</th><td>		<i>/* move to lookup AAAA */</i></td></tr>
<tr><th id="3724">3724</th><td>		<a class="local col5 ref" href="#985xfr" title='xfr' data-ref="985xfr" data-ref-filename="985xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::lookup_aaaa" title='auth_probe::lookup_aaaa' data-ref="auth_probe::lookup_aaaa" data-ref-filename="auth_probe..lookup_aaaa">lookup_aaaa</a> = <var>1</var>;</td></tr>
<tr><th id="3725">3725</th><td>		<b>return</b>;</td></tr>
<tr><th id="3726">3726</th><td>	}</td></tr>
<tr><th id="3727">3727</th><td>	<a class="local col5 ref" href="#985xfr" title='xfr' data-ref="985xfr" data-ref-filename="985xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::lookup_target" title='auth_probe::lookup_target' data-ref="auth_probe::lookup_target" data-ref-filename="auth_probe..lookup_target">lookup_target</a> = <a class="local col5 ref" href="#985xfr" title='xfr' data-ref="985xfr" data-ref-filename="985xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::lookup_target" title='auth_probe::lookup_target' data-ref="auth_probe::lookup_target" data-ref-filename="auth_probe..lookup_target">lookup_target</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::next" title='auth_master::next' data-ref="auth_master::next" data-ref-filename="auth_master..next">next</a>;</td></tr>
<tr><th id="3728">3728</th><td>	<a class="local col5 ref" href="#985xfr" title='xfr' data-ref="985xfr" data-ref-filename="985xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::lookup_aaaa" title='auth_probe::lookup_aaaa' data-ref="auth_probe::lookup_aaaa" data-ref-filename="auth_probe..lookup_aaaa">lookup_aaaa</a> = <var>0</var>;</td></tr>
<tr><th id="3729">3729</th><td>	<b>if</b>(!<a class="local col6 ref" href="#986env" title='env' data-ref="986env" data-ref-filename="986env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::cfg" title='module_env::cfg' data-ref="module_env::cfg" data-ref-filename="module_env..cfg">cfg</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_file::do_ip4" title='config_file::do_ip4' data-ref="config_file::do_ip4" data-ref-filename="config_file..do_ip4">do_ip4</a> &amp;&amp; <a class="local col5 ref" href="#985xfr" title='xfr' data-ref="985xfr" data-ref-filename="985xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::lookup_target" title='auth_probe::lookup_target' data-ref="auth_probe::lookup_target" data-ref-filename="auth_probe..lookup_target">lookup_target</a>!=<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>)</td></tr>
<tr><th id="3730">3730</th><td>		<a class="local col5 ref" href="#985xfr" title='xfr' data-ref="985xfr" data-ref-filename="985xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::lookup_aaaa" title='auth_probe::lookup_aaaa' data-ref="auth_probe::lookup_aaaa" data-ref-filename="auth_probe..lookup_aaaa">lookup_aaaa</a> = <var>1</var>;</td></tr>
<tr><th id="3731">3731</th><td>}</td></tr>
<tr><th id="3732">3732</th><td></td></tr>
<tr><th id="3733">3733</th><td><i class="doc" data-doc="xfr_transfer_start_list">/** start the iteration of the task_transfer list of masters */</i></td></tr>
<tr><th id="3734">3734</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="3735">3735</th><td><dfn class="tu decl def fn" id="xfr_transfer_start_list" title='xfr_transfer_start_list' data-type='void xfr_transfer_start_list(struct auth_xfer * xfr, struct auth_master * spec)' data-ref="xfr_transfer_start_list" data-ref-filename="xfr_transfer_start_list">xfr_transfer_start_list</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col7 decl" id="987xfr" title='xfr' data-type='struct auth_xfer *' data-ref="987xfr" data-ref-filename="987xfr">xfr</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>* <dfn class="local col8 decl" id="988spec" title='spec' data-type='struct auth_master *' data-ref="988spec" data-ref-filename="988spec">spec</dfn>) </td></tr>
<tr><th id="3736">3736</th><td>{</td></tr>
<tr><th id="3737">3737</th><td>	<b>if</b>(<a class="local col8 ref" href="#988spec" title='spec' data-ref="988spec" data-ref-filename="988spec">spec</a>) {</td></tr>
<tr><th id="3738">3738</th><td>		<a class="local col7 ref" href="#987xfr" title='xfr' data-ref="987xfr" data-ref-filename="987xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_specific" title='auth_transfer::scan_specific' data-ref="auth_transfer::scan_specific" data-ref-filename="auth_transfer..scan_specific">scan_specific</a> = <a class="tu ref fn" href="#find_master_by_host" title='find_master_by_host' data-use='c' data-ref="find_master_by_host" data-ref-filename="find_master_by_host">find_master_by_host</a>(</td></tr>
<tr><th id="3739">3739</th><td>			<a class="local col7 ref" href="#987xfr" title='xfr' data-ref="987xfr" data-ref-filename="987xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::masters" title='auth_transfer::masters' data-ref="auth_transfer::masters" data-ref-filename="auth_transfer..masters">masters</a>, <a class="local col8 ref" href="#988spec" title='spec' data-ref="988spec" data-ref-filename="988spec">spec</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="3740">3740</th><td>		<b>if</b>(<a class="local col7 ref" href="#987xfr" title='xfr' data-ref="987xfr" data-ref-filename="987xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_specific" title='auth_transfer::scan_specific' data-ref="auth_transfer::scan_specific" data-ref-filename="auth_transfer..scan_specific">scan_specific</a>) {</td></tr>
<tr><th id="3741">3741</th><td>			<a class="local col7 ref" href="#987xfr" title='xfr' data-ref="987xfr" data-ref-filename="987xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_target" title='auth_transfer::scan_target' data-ref="auth_transfer::scan_target" data-ref-filename="auth_transfer..scan_target">scan_target</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="3742">3742</th><td>			<a class="local col7 ref" href="#987xfr" title='xfr' data-ref="987xfr" data-ref-filename="987xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_addr" title='auth_transfer::scan_addr' data-ref="auth_transfer::scan_addr" data-ref-filename="auth_transfer..scan_addr">scan_addr</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="3743">3743</th><td>			<b>if</b>(<a class="local col7 ref" href="#987xfr" title='xfr' data-ref="987xfr" data-ref-filename="987xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_specific" title='auth_transfer::scan_specific' data-ref="auth_transfer::scan_specific" data-ref-filename="auth_transfer..scan_specific">scan_specific</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::list" title='auth_master::list' data-ref="auth_master::list" data-ref-filename="auth_master..list">list</a>)</td></tr>
<tr><th id="3744">3744</th><td>				<a class="local col7 ref" href="#987xfr" title='xfr' data-ref="987xfr" data-ref-filename="987xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_addr" title='auth_transfer::scan_addr' data-ref="auth_transfer::scan_addr" data-ref-filename="auth_transfer..scan_addr">scan_addr</a> =</td></tr>
<tr><th id="3745">3745</th><td>					<a class="local col7 ref" href="#987xfr" title='xfr' data-ref="987xfr" data-ref-filename="987xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_specific" title='auth_transfer::scan_specific' data-ref="auth_transfer::scan_specific" data-ref-filename="auth_transfer..scan_specific">scan_specific</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::list" title='auth_master::list' data-ref="auth_master::list" data-ref-filename="auth_master..list">list</a>;</td></tr>
<tr><th id="3746">3746</th><td>			<b>return</b>;</td></tr>
<tr><th id="3747">3747</th><td>		}</td></tr>
<tr><th id="3748">3748</th><td>	}</td></tr>
<tr><th id="3749">3749</th><td>	<i>/* no specific (notified) host to scan */</i></td></tr>
<tr><th id="3750">3750</th><td>	<a class="local col7 ref" href="#987xfr" title='xfr' data-ref="987xfr" data-ref-filename="987xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_specific" title='auth_transfer::scan_specific' data-ref="auth_transfer::scan_specific" data-ref-filename="auth_transfer..scan_specific">scan_specific</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="3751">3751</th><td>	<a class="local col7 ref" href="#987xfr" title='xfr' data-ref="987xfr" data-ref-filename="987xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_addr" title='auth_transfer::scan_addr' data-ref="auth_transfer::scan_addr" data-ref-filename="auth_transfer..scan_addr">scan_addr</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="3752">3752</th><td>	<i>/* pick up first scan target */</i></td></tr>
<tr><th id="3753">3753</th><td>	<a class="local col7 ref" href="#987xfr" title='xfr' data-ref="987xfr" data-ref-filename="987xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_target" title='auth_transfer::scan_target' data-ref="auth_transfer::scan_target" data-ref-filename="auth_transfer..scan_target">scan_target</a> = <a class="local col7 ref" href="#987xfr" title='xfr' data-ref="987xfr" data-ref-filename="987xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::masters" title='auth_transfer::masters' data-ref="auth_transfer::masters" data-ref-filename="auth_transfer..masters">masters</a>;</td></tr>
<tr><th id="3754">3754</th><td>	<b>if</b>(<a class="local col7 ref" href="#987xfr" title='xfr' data-ref="987xfr" data-ref-filename="987xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_target" title='auth_transfer::scan_target' data-ref="auth_transfer::scan_target" data-ref-filename="auth_transfer..scan_target">scan_target</a> &amp;&amp; <a class="local col7 ref" href="#987xfr" title='xfr' data-ref="987xfr" data-ref-filename="987xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;</td></tr>
<tr><th id="3755">3755</th><td>		<a class="ref field" href="authzone.h.html#auth_transfer::scan_target" title='auth_transfer::scan_target' data-ref="auth_transfer::scan_target" data-ref-filename="auth_transfer..scan_target">scan_target</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::list" title='auth_master::list' data-ref="auth_master::list" data-ref-filename="auth_master..list">list</a>)</td></tr>
<tr><th id="3756">3756</th><td>		<a class="local col7 ref" href="#987xfr" title='xfr' data-ref="987xfr" data-ref-filename="987xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_addr" title='auth_transfer::scan_addr' data-ref="auth_transfer::scan_addr" data-ref-filename="auth_transfer..scan_addr">scan_addr</a> =</td></tr>
<tr><th id="3757">3757</th><td>			<a class="local col7 ref" href="#987xfr" title='xfr' data-ref="987xfr" data-ref-filename="987xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_target" title='auth_transfer::scan_target' data-ref="auth_transfer::scan_target" data-ref-filename="auth_transfer..scan_target">scan_target</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::list" title='auth_master::list' data-ref="auth_master::list" data-ref-filename="auth_master..list">list</a>;</td></tr>
<tr><th id="3758">3758</th><td>}</td></tr>
<tr><th id="3759">3759</th><td></td></tr>
<tr><th id="3760">3760</th><td><i class="doc" data-doc="xfr_probe_start_list">/** start the iteration of the task_probe list of masters */</i></td></tr>
<tr><th id="3761">3761</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="3762">3762</th><td><dfn class="tu decl def fn" id="xfr_probe_start_list" title='xfr_probe_start_list' data-type='void xfr_probe_start_list(struct auth_xfer * xfr, struct auth_master * spec)' data-ref="xfr_probe_start_list" data-ref-filename="xfr_probe_start_list">xfr_probe_start_list</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col9 decl" id="989xfr" title='xfr' data-type='struct auth_xfer *' data-ref="989xfr" data-ref-filename="989xfr">xfr</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>* <dfn class="local col0 decl" id="990spec" title='spec' data-type='struct auth_master *' data-ref="990spec" data-ref-filename="990spec">spec</dfn>) </td></tr>
<tr><th id="3763">3763</th><td>{</td></tr>
<tr><th id="3764">3764</th><td>	<b>if</b>(<a class="local col0 ref" href="#990spec" title='spec' data-ref="990spec" data-ref-filename="990spec">spec</a>) {</td></tr>
<tr><th id="3765">3765</th><td>		<a class="local col9 ref" href="#989xfr" title='xfr' data-ref="989xfr" data-ref-filename="989xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_specific" title='auth_probe::scan_specific' data-ref="auth_probe::scan_specific" data-ref-filename="auth_probe..scan_specific">scan_specific</a> = <a class="tu ref fn" href="#find_master_by_host" title='find_master_by_host' data-use='c' data-ref="find_master_by_host" data-ref-filename="find_master_by_host">find_master_by_host</a>(</td></tr>
<tr><th id="3766">3766</th><td>			<a class="local col9 ref" href="#989xfr" title='xfr' data-ref="989xfr" data-ref-filename="989xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::masters" title='auth_probe::masters' data-ref="auth_probe::masters" data-ref-filename="auth_probe..masters">masters</a>, <a class="local col0 ref" href="#990spec" title='spec' data-ref="990spec" data-ref-filename="990spec">spec</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="3767">3767</th><td>		<b>if</b>(<a class="local col9 ref" href="#989xfr" title='xfr' data-ref="989xfr" data-ref-filename="989xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_specific" title='auth_probe::scan_specific' data-ref="auth_probe::scan_specific" data-ref-filename="auth_probe..scan_specific">scan_specific</a>) {</td></tr>
<tr><th id="3768">3768</th><td>			<a class="local col9 ref" href="#989xfr" title='xfr' data-ref="989xfr" data-ref-filename="989xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_target" title='auth_probe::scan_target' data-ref="auth_probe::scan_target" data-ref-filename="auth_probe..scan_target">scan_target</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="3769">3769</th><td>			<a class="local col9 ref" href="#989xfr" title='xfr' data-ref="989xfr" data-ref-filename="989xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_addr" title='auth_probe::scan_addr' data-ref="auth_probe::scan_addr" data-ref-filename="auth_probe..scan_addr">scan_addr</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="3770">3770</th><td>			<b>if</b>(<a class="local col9 ref" href="#989xfr" title='xfr' data-ref="989xfr" data-ref-filename="989xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_specific" title='auth_probe::scan_specific' data-ref="auth_probe::scan_specific" data-ref-filename="auth_probe..scan_specific">scan_specific</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::list" title='auth_master::list' data-ref="auth_master::list" data-ref-filename="auth_master..list">list</a>)</td></tr>
<tr><th id="3771">3771</th><td>				<a class="local col9 ref" href="#989xfr" title='xfr' data-ref="989xfr" data-ref-filename="989xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_addr" title='auth_probe::scan_addr' data-ref="auth_probe::scan_addr" data-ref-filename="auth_probe..scan_addr">scan_addr</a> =</td></tr>
<tr><th id="3772">3772</th><td>					<a class="local col9 ref" href="#989xfr" title='xfr' data-ref="989xfr" data-ref-filename="989xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_specific" title='auth_probe::scan_specific' data-ref="auth_probe::scan_specific" data-ref-filename="auth_probe..scan_specific">scan_specific</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::list" title='auth_master::list' data-ref="auth_master::list" data-ref-filename="auth_master..list">list</a>;</td></tr>
<tr><th id="3773">3773</th><td>			<b>return</b>;</td></tr>
<tr><th id="3774">3774</th><td>		}</td></tr>
<tr><th id="3775">3775</th><td>	}</td></tr>
<tr><th id="3776">3776</th><td>	<i>/* no specific (notified) host to scan */</i></td></tr>
<tr><th id="3777">3777</th><td>	<a class="local col9 ref" href="#989xfr" title='xfr' data-ref="989xfr" data-ref-filename="989xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_specific" title='auth_probe::scan_specific' data-ref="auth_probe::scan_specific" data-ref-filename="auth_probe..scan_specific">scan_specific</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="3778">3778</th><td>	<a class="local col9 ref" href="#989xfr" title='xfr' data-ref="989xfr" data-ref-filename="989xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_addr" title='auth_probe::scan_addr' data-ref="auth_probe::scan_addr" data-ref-filename="auth_probe..scan_addr">scan_addr</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="3779">3779</th><td>	<i>/* pick up first scan target */</i></td></tr>
<tr><th id="3780">3780</th><td>	<a class="local col9 ref" href="#989xfr" title='xfr' data-ref="989xfr" data-ref-filename="989xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_target" title='auth_probe::scan_target' data-ref="auth_probe::scan_target" data-ref-filename="auth_probe..scan_target">scan_target</a> = <a class="local col9 ref" href="#989xfr" title='xfr' data-ref="989xfr" data-ref-filename="989xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::masters" title='auth_probe::masters' data-ref="auth_probe::masters" data-ref-filename="auth_probe..masters">masters</a>;</td></tr>
<tr><th id="3781">3781</th><td>	<b>if</b>(<a class="local col9 ref" href="#989xfr" title='xfr' data-ref="989xfr" data-ref-filename="989xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_target" title='auth_probe::scan_target' data-ref="auth_probe::scan_target" data-ref-filename="auth_probe..scan_target">scan_target</a> &amp;&amp; <a class="local col9 ref" href="#989xfr" title='xfr' data-ref="989xfr" data-ref-filename="989xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_target" title='auth_probe::scan_target' data-ref="auth_probe::scan_target" data-ref-filename="auth_probe..scan_target">scan_target</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::list" title='auth_master::list' data-ref="auth_master::list" data-ref-filename="auth_master..list">list</a>)</td></tr>
<tr><th id="3782">3782</th><td>		<a class="local col9 ref" href="#989xfr" title='xfr' data-ref="989xfr" data-ref-filename="989xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_addr" title='auth_probe::scan_addr' data-ref="auth_probe::scan_addr" data-ref-filename="auth_probe..scan_addr">scan_addr</a> =</td></tr>
<tr><th id="3783">3783</th><td>			<a class="local col9 ref" href="#989xfr" title='xfr' data-ref="989xfr" data-ref-filename="989xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_target" title='auth_probe::scan_target' data-ref="auth_probe::scan_target" data-ref-filename="auth_probe..scan_target">scan_target</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::list" title='auth_master::list' data-ref="auth_master::list" data-ref-filename="auth_master..list">list</a>;</td></tr>
<tr><th id="3784">3784</th><td>}</td></tr>
<tr><th id="3785">3785</th><td></td></tr>
<tr><th id="3786">3786</th><td><i class="doc" data-doc="xfr_transfer_current_master">/** pick up the master that is being scanned right now, task_transfer */</i></td></tr>
<tr><th id="3787">3787</th><td><em>static</em> <b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>*</td></tr>
<tr><th id="3788">3788</th><td><dfn class="tu decl def fn" id="xfr_transfer_current_master" title='xfr_transfer_current_master' data-type='struct auth_master * xfr_transfer_current_master(struct auth_xfer * xfr)' data-ref="xfr_transfer_current_master" data-ref-filename="xfr_transfer_current_master">xfr_transfer_current_master</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col1 decl" id="991xfr" title='xfr' data-type='struct auth_xfer *' data-ref="991xfr" data-ref-filename="991xfr">xfr</dfn>)</td></tr>
<tr><th id="3789">3789</th><td>{</td></tr>
<tr><th id="3790">3790</th><td>	<b>if</b>(<a class="local col1 ref" href="#991xfr" title='xfr' data-ref="991xfr" data-ref-filename="991xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_specific" title='auth_transfer::scan_specific' data-ref="auth_transfer::scan_specific" data-ref-filename="auth_transfer..scan_specific">scan_specific</a>)</td></tr>
<tr><th id="3791">3791</th><td>		<b>return</b> <a class="local col1 ref" href="#991xfr" title='xfr' data-ref="991xfr" data-ref-filename="991xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_specific" title='auth_transfer::scan_specific' data-ref="auth_transfer::scan_specific" data-ref-filename="auth_transfer..scan_specific">scan_specific</a>;</td></tr>
<tr><th id="3792">3792</th><td>	<b>return</b> <a class="local col1 ref" href="#991xfr" title='xfr' data-ref="991xfr" data-ref-filename="991xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_target" title='auth_transfer::scan_target' data-ref="auth_transfer::scan_target" data-ref-filename="auth_transfer..scan_target">scan_target</a>;</td></tr>
<tr><th id="3793">3793</th><td>}</td></tr>
<tr><th id="3794">3794</th><td></td></tr>
<tr><th id="3795">3795</th><td><i class="doc" data-doc="xfr_probe_current_master">/** pick up the master that is being scanned right now, task_probe */</i></td></tr>
<tr><th id="3796">3796</th><td><em>static</em> <b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>*</td></tr>
<tr><th id="3797">3797</th><td><dfn class="tu decl def fn" id="xfr_probe_current_master" title='xfr_probe_current_master' data-type='struct auth_master * xfr_probe_current_master(struct auth_xfer * xfr)' data-ref="xfr_probe_current_master" data-ref-filename="xfr_probe_current_master">xfr_probe_current_master</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col2 decl" id="992xfr" title='xfr' data-type='struct auth_xfer *' data-ref="992xfr" data-ref-filename="992xfr">xfr</dfn>)</td></tr>
<tr><th id="3798">3798</th><td>{</td></tr>
<tr><th id="3799">3799</th><td>	<b>if</b>(<a class="local col2 ref" href="#992xfr" title='xfr' data-ref="992xfr" data-ref-filename="992xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_specific" title='auth_probe::scan_specific' data-ref="auth_probe::scan_specific" data-ref-filename="auth_probe..scan_specific">scan_specific</a>)</td></tr>
<tr><th id="3800">3800</th><td>		<b>return</b> <a class="local col2 ref" href="#992xfr" title='xfr' data-ref="992xfr" data-ref-filename="992xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_specific" title='auth_probe::scan_specific' data-ref="auth_probe::scan_specific" data-ref-filename="auth_probe..scan_specific">scan_specific</a>;</td></tr>
<tr><th id="3801">3801</th><td>	<b>return</b> <a class="local col2 ref" href="#992xfr" title='xfr' data-ref="992xfr" data-ref-filename="992xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_target" title='auth_probe::scan_target' data-ref="auth_probe::scan_target" data-ref-filename="auth_probe..scan_target">scan_target</a>;</td></tr>
<tr><th id="3802">3802</th><td>}</td></tr>
<tr><th id="3803">3803</th><td></td></tr>
<tr><th id="3804">3804</th><td><i class="doc" data-doc="xfr_transfer_end_of_list">/** true if at end of list, task_transfer */</i></td></tr>
<tr><th id="3805">3805</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="3806">3806</th><td><dfn class="tu decl def fn" id="xfr_transfer_end_of_list" title='xfr_transfer_end_of_list' data-type='int xfr_transfer_end_of_list(struct auth_xfer * xfr)' data-ref="xfr_transfer_end_of_list" data-ref-filename="xfr_transfer_end_of_list">xfr_transfer_end_of_list</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col3 decl" id="993xfr" title='xfr' data-type='struct auth_xfer *' data-ref="993xfr" data-ref-filename="993xfr">xfr</dfn>)</td></tr>
<tr><th id="3807">3807</th><td>{</td></tr>
<tr><th id="3808">3808</th><td>	<b>return</b> !<a class="local col3 ref" href="#993xfr" title='xfr' data-ref="993xfr" data-ref-filename="993xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_specific" title='auth_transfer::scan_specific' data-ref="auth_transfer::scan_specific" data-ref-filename="auth_transfer..scan_specific">scan_specific</a> &amp;&amp;</td></tr>
<tr><th id="3809">3809</th><td>		!<a class="local col3 ref" href="#993xfr" title='xfr' data-ref="993xfr" data-ref-filename="993xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_target" title='auth_transfer::scan_target' data-ref="auth_transfer::scan_target" data-ref-filename="auth_transfer..scan_target">scan_target</a>;</td></tr>
<tr><th id="3810">3810</th><td>}</td></tr>
<tr><th id="3811">3811</th><td></td></tr>
<tr><th id="3812">3812</th><td><i class="doc" data-doc="xfr_probe_end_of_list">/** true if at end of list, task_probe */</i></td></tr>
<tr><th id="3813">3813</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="3814">3814</th><td><dfn class="tu decl def fn" id="xfr_probe_end_of_list" title='xfr_probe_end_of_list' data-type='int xfr_probe_end_of_list(struct auth_xfer * xfr)' data-ref="xfr_probe_end_of_list" data-ref-filename="xfr_probe_end_of_list">xfr_probe_end_of_list</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col4 decl" id="994xfr" title='xfr' data-type='struct auth_xfer *' data-ref="994xfr" data-ref-filename="994xfr">xfr</dfn>)</td></tr>
<tr><th id="3815">3815</th><td>{</td></tr>
<tr><th id="3816">3816</th><td>	<b>return</b> !<a class="local col4 ref" href="#994xfr" title='xfr' data-ref="994xfr" data-ref-filename="994xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_specific" title='auth_probe::scan_specific' data-ref="auth_probe::scan_specific" data-ref-filename="auth_probe..scan_specific">scan_specific</a> &amp;&amp; !<a class="local col4 ref" href="#994xfr" title='xfr' data-ref="994xfr" data-ref-filename="994xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_target" title='auth_probe::scan_target' data-ref="auth_probe::scan_target" data-ref-filename="auth_probe..scan_target">scan_target</a>;</td></tr>
<tr><th id="3817">3817</th><td>}</td></tr>
<tr><th id="3818">3818</th><td></td></tr>
<tr><th id="3819">3819</th><td><i class="doc" data-doc="xfr_transfer_nextmaster">/** move to next master in list, task_transfer */</i></td></tr>
<tr><th id="3820">3820</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="3821">3821</th><td><dfn class="tu decl def fn" id="xfr_transfer_nextmaster" title='xfr_transfer_nextmaster' data-type='void xfr_transfer_nextmaster(struct auth_xfer * xfr)' data-ref="xfr_transfer_nextmaster" data-ref-filename="xfr_transfer_nextmaster">xfr_transfer_nextmaster</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col5 decl" id="995xfr" title='xfr' data-type='struct auth_xfer *' data-ref="995xfr" data-ref-filename="995xfr">xfr</dfn>)</td></tr>
<tr><th id="3822">3822</th><td>{</td></tr>
<tr><th id="3823">3823</th><td>	<b>if</b>(!<a class="local col5 ref" href="#995xfr" title='xfr' data-ref="995xfr" data-ref-filename="995xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_specific" title='auth_transfer::scan_specific' data-ref="auth_transfer::scan_specific" data-ref-filename="auth_transfer..scan_specific">scan_specific</a> &amp;&amp;</td></tr>
<tr><th id="3824">3824</th><td>		!<a class="local col5 ref" href="#995xfr" title='xfr' data-ref="995xfr" data-ref-filename="995xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_target" title='auth_transfer::scan_target' data-ref="auth_transfer::scan_target" data-ref-filename="auth_transfer..scan_target">scan_target</a>)</td></tr>
<tr><th id="3825">3825</th><td>		<b>return</b>;</td></tr>
<tr><th id="3826">3826</th><td>	<b>if</b>(<a class="local col5 ref" href="#995xfr" title='xfr' data-ref="995xfr" data-ref-filename="995xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_addr" title='auth_transfer::scan_addr' data-ref="auth_transfer::scan_addr" data-ref-filename="auth_transfer..scan_addr">scan_addr</a>) {</td></tr>
<tr><th id="3827">3827</th><td>		<a class="local col5 ref" href="#995xfr" title='xfr' data-ref="995xfr" data-ref-filename="995xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_addr" title='auth_transfer::scan_addr' data-ref="auth_transfer::scan_addr" data-ref-filename="auth_transfer..scan_addr">scan_addr</a> =</td></tr>
<tr><th id="3828">3828</th><td>			<a class="local col5 ref" href="#995xfr" title='xfr' data-ref="995xfr" data-ref-filename="995xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_addr" title='auth_transfer::scan_addr' data-ref="auth_transfer::scan_addr" data-ref-filename="auth_transfer..scan_addr">scan_addr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_addr::next" title='auth_addr::next' data-ref="auth_addr::next" data-ref-filename="auth_addr..next">next</a>;</td></tr>
<tr><th id="3829">3829</th><td>		<b>if</b>(<a class="local col5 ref" href="#995xfr" title='xfr' data-ref="995xfr" data-ref-filename="995xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_addr" title='auth_transfer::scan_addr' data-ref="auth_transfer::scan_addr" data-ref-filename="auth_transfer..scan_addr">scan_addr</a>)</td></tr>
<tr><th id="3830">3830</th><td>			<b>return</b>;</td></tr>
<tr><th id="3831">3831</th><td>	}</td></tr>
<tr><th id="3832">3832</th><td>	<b>if</b>(<a class="local col5 ref" href="#995xfr" title='xfr' data-ref="995xfr" data-ref-filename="995xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_specific" title='auth_transfer::scan_specific' data-ref="auth_transfer::scan_specific" data-ref-filename="auth_transfer..scan_specific">scan_specific</a>) {</td></tr>
<tr><th id="3833">3833</th><td>		<a class="local col5 ref" href="#995xfr" title='xfr' data-ref="995xfr" data-ref-filename="995xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_specific" title='auth_transfer::scan_specific' data-ref="auth_transfer::scan_specific" data-ref-filename="auth_transfer..scan_specific">scan_specific</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="3834">3834</th><td>		<a class="local col5 ref" href="#995xfr" title='xfr' data-ref="995xfr" data-ref-filename="995xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_target" title='auth_transfer::scan_target' data-ref="auth_transfer::scan_target" data-ref-filename="auth_transfer..scan_target">scan_target</a> = <a class="local col5 ref" href="#995xfr" title='xfr' data-ref="995xfr" data-ref-filename="995xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::masters" title='auth_transfer::masters' data-ref="auth_transfer::masters" data-ref-filename="auth_transfer..masters">masters</a>;</td></tr>
<tr><th id="3835">3835</th><td>		<b>if</b>(<a class="local col5 ref" href="#995xfr" title='xfr' data-ref="995xfr" data-ref-filename="995xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_target" title='auth_transfer::scan_target' data-ref="auth_transfer::scan_target" data-ref-filename="auth_transfer..scan_target">scan_target</a> &amp;&amp; <a class="local col5 ref" href="#995xfr" title='xfr' data-ref="995xfr" data-ref-filename="995xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;</td></tr>
<tr><th id="3836">3836</th><td>			<a class="ref field" href="authzone.h.html#auth_transfer::scan_target" title='auth_transfer::scan_target' data-ref="auth_transfer::scan_target" data-ref-filename="auth_transfer..scan_target">scan_target</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::list" title='auth_master::list' data-ref="auth_master::list" data-ref-filename="auth_master..list">list</a>)</td></tr>
<tr><th id="3837">3837</th><td>			<a class="local col5 ref" href="#995xfr" title='xfr' data-ref="995xfr" data-ref-filename="995xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_addr" title='auth_transfer::scan_addr' data-ref="auth_transfer::scan_addr" data-ref-filename="auth_transfer..scan_addr">scan_addr</a> =</td></tr>
<tr><th id="3838">3838</th><td>				<a class="local col5 ref" href="#995xfr" title='xfr' data-ref="995xfr" data-ref-filename="995xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_target" title='auth_transfer::scan_target' data-ref="auth_transfer::scan_target" data-ref-filename="auth_transfer..scan_target">scan_target</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::list" title='auth_master::list' data-ref="auth_master::list" data-ref-filename="auth_master..list">list</a>;</td></tr>
<tr><th id="3839">3839</th><td>		<b>return</b>;</td></tr>
<tr><th id="3840">3840</th><td>	}</td></tr>
<tr><th id="3841">3841</th><td>	<b>if</b>(!<a class="local col5 ref" href="#995xfr" title='xfr' data-ref="995xfr" data-ref-filename="995xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_target" title='auth_transfer::scan_target' data-ref="auth_transfer::scan_target" data-ref-filename="auth_transfer..scan_target">scan_target</a>)</td></tr>
<tr><th id="3842">3842</th><td>		<b>return</b>;</td></tr>
<tr><th id="3843">3843</th><td>	<a class="local col5 ref" href="#995xfr" title='xfr' data-ref="995xfr" data-ref-filename="995xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_target" title='auth_transfer::scan_target' data-ref="auth_transfer::scan_target" data-ref-filename="auth_transfer..scan_target">scan_target</a> = <a class="local col5 ref" href="#995xfr" title='xfr' data-ref="995xfr" data-ref-filename="995xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_target" title='auth_transfer::scan_target' data-ref="auth_transfer::scan_target" data-ref-filename="auth_transfer..scan_target">scan_target</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::next" title='auth_master::next' data-ref="auth_master::next" data-ref-filename="auth_master..next">next</a>;</td></tr>
<tr><th id="3844">3844</th><td>	<b>if</b>(<a class="local col5 ref" href="#995xfr" title='xfr' data-ref="995xfr" data-ref-filename="995xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_target" title='auth_transfer::scan_target' data-ref="auth_transfer::scan_target" data-ref-filename="auth_transfer..scan_target">scan_target</a> &amp;&amp; <a class="local col5 ref" href="#995xfr" title='xfr' data-ref="995xfr" data-ref-filename="995xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;</td></tr>
<tr><th id="3845">3845</th><td>		<a class="ref field" href="authzone.h.html#auth_transfer::scan_target" title='auth_transfer::scan_target' data-ref="auth_transfer::scan_target" data-ref-filename="auth_transfer..scan_target">scan_target</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::list" title='auth_master::list' data-ref="auth_master::list" data-ref-filename="auth_master..list">list</a>)</td></tr>
<tr><th id="3846">3846</th><td>		<a class="local col5 ref" href="#995xfr" title='xfr' data-ref="995xfr" data-ref-filename="995xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_addr" title='auth_transfer::scan_addr' data-ref="auth_transfer::scan_addr" data-ref-filename="auth_transfer..scan_addr">scan_addr</a> =</td></tr>
<tr><th id="3847">3847</th><td>			<a class="local col5 ref" href="#995xfr" title='xfr' data-ref="995xfr" data-ref-filename="995xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_target" title='auth_transfer::scan_target' data-ref="auth_transfer::scan_target" data-ref-filename="auth_transfer..scan_target">scan_target</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::list" title='auth_master::list' data-ref="auth_master::list" data-ref-filename="auth_master..list">list</a>;</td></tr>
<tr><th id="3848">3848</th><td>	<b>return</b>;</td></tr>
<tr><th id="3849">3849</th><td>}</td></tr>
<tr><th id="3850">3850</th><td></td></tr>
<tr><th id="3851">3851</th><td><i class="doc" data-doc="xfr_probe_nextmaster">/** move to next master in list, task_probe */</i></td></tr>
<tr><th id="3852">3852</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="3853">3853</th><td><dfn class="tu decl def fn" id="xfr_probe_nextmaster" title='xfr_probe_nextmaster' data-type='void xfr_probe_nextmaster(struct auth_xfer * xfr)' data-ref="xfr_probe_nextmaster" data-ref-filename="xfr_probe_nextmaster">xfr_probe_nextmaster</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col6 decl" id="996xfr" title='xfr' data-type='struct auth_xfer *' data-ref="996xfr" data-ref-filename="996xfr">xfr</dfn>)</td></tr>
<tr><th id="3854">3854</th><td>{</td></tr>
<tr><th id="3855">3855</th><td>	<b>if</b>(!<a class="local col6 ref" href="#996xfr" title='xfr' data-ref="996xfr" data-ref-filename="996xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_specific" title='auth_probe::scan_specific' data-ref="auth_probe::scan_specific" data-ref-filename="auth_probe..scan_specific">scan_specific</a> &amp;&amp; !<a class="local col6 ref" href="#996xfr" title='xfr' data-ref="996xfr" data-ref-filename="996xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_target" title='auth_probe::scan_target' data-ref="auth_probe::scan_target" data-ref-filename="auth_probe..scan_target">scan_target</a>)</td></tr>
<tr><th id="3856">3856</th><td>		<b>return</b>;</td></tr>
<tr><th id="3857">3857</th><td>	<b>if</b>(<a class="local col6 ref" href="#996xfr" title='xfr' data-ref="996xfr" data-ref-filename="996xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_addr" title='auth_probe::scan_addr' data-ref="auth_probe::scan_addr" data-ref-filename="auth_probe..scan_addr">scan_addr</a>) {</td></tr>
<tr><th id="3858">3858</th><td>		<a class="local col6 ref" href="#996xfr" title='xfr' data-ref="996xfr" data-ref-filename="996xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_addr" title='auth_probe::scan_addr' data-ref="auth_probe::scan_addr" data-ref-filename="auth_probe..scan_addr">scan_addr</a> = <a class="local col6 ref" href="#996xfr" title='xfr' data-ref="996xfr" data-ref-filename="996xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_addr" title='auth_probe::scan_addr' data-ref="auth_probe::scan_addr" data-ref-filename="auth_probe..scan_addr">scan_addr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_addr::next" title='auth_addr::next' data-ref="auth_addr::next" data-ref-filename="auth_addr..next">next</a>;</td></tr>
<tr><th id="3859">3859</th><td>		<b>if</b>(<a class="local col6 ref" href="#996xfr" title='xfr' data-ref="996xfr" data-ref-filename="996xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_addr" title='auth_probe::scan_addr' data-ref="auth_probe::scan_addr" data-ref-filename="auth_probe..scan_addr">scan_addr</a>)</td></tr>
<tr><th id="3860">3860</th><td>			<b>return</b>;</td></tr>
<tr><th id="3861">3861</th><td>	}</td></tr>
<tr><th id="3862">3862</th><td>	<b>if</b>(<a class="local col6 ref" href="#996xfr" title='xfr' data-ref="996xfr" data-ref-filename="996xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_specific" title='auth_probe::scan_specific' data-ref="auth_probe::scan_specific" data-ref-filename="auth_probe..scan_specific">scan_specific</a>) {</td></tr>
<tr><th id="3863">3863</th><td>		<a class="local col6 ref" href="#996xfr" title='xfr' data-ref="996xfr" data-ref-filename="996xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_specific" title='auth_probe::scan_specific' data-ref="auth_probe::scan_specific" data-ref-filename="auth_probe..scan_specific">scan_specific</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="3864">3864</th><td>		<a class="local col6 ref" href="#996xfr" title='xfr' data-ref="996xfr" data-ref-filename="996xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_target" title='auth_probe::scan_target' data-ref="auth_probe::scan_target" data-ref-filename="auth_probe..scan_target">scan_target</a> = <a class="local col6 ref" href="#996xfr" title='xfr' data-ref="996xfr" data-ref-filename="996xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::masters" title='auth_probe::masters' data-ref="auth_probe::masters" data-ref-filename="auth_probe..masters">masters</a>;</td></tr>
<tr><th id="3865">3865</th><td>		<b>if</b>(<a class="local col6 ref" href="#996xfr" title='xfr' data-ref="996xfr" data-ref-filename="996xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_target" title='auth_probe::scan_target' data-ref="auth_probe::scan_target" data-ref-filename="auth_probe..scan_target">scan_target</a> &amp;&amp; <a class="local col6 ref" href="#996xfr" title='xfr' data-ref="996xfr" data-ref-filename="996xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;</td></tr>
<tr><th id="3866">3866</th><td>			<a class="ref field" href="authzone.h.html#auth_probe::scan_target" title='auth_probe::scan_target' data-ref="auth_probe::scan_target" data-ref-filename="auth_probe..scan_target">scan_target</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::list" title='auth_master::list' data-ref="auth_master::list" data-ref-filename="auth_master..list">list</a>)</td></tr>
<tr><th id="3867">3867</th><td>			<a class="local col6 ref" href="#996xfr" title='xfr' data-ref="996xfr" data-ref-filename="996xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_addr" title='auth_probe::scan_addr' data-ref="auth_probe::scan_addr" data-ref-filename="auth_probe..scan_addr">scan_addr</a> =</td></tr>
<tr><th id="3868">3868</th><td>				<a class="local col6 ref" href="#996xfr" title='xfr' data-ref="996xfr" data-ref-filename="996xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_target" title='auth_probe::scan_target' data-ref="auth_probe::scan_target" data-ref-filename="auth_probe..scan_target">scan_target</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::list" title='auth_master::list' data-ref="auth_master::list" data-ref-filename="auth_master..list">list</a>;</td></tr>
<tr><th id="3869">3869</th><td>		<b>return</b>;</td></tr>
<tr><th id="3870">3870</th><td>	}</td></tr>
<tr><th id="3871">3871</th><td>	<b>if</b>(!<a class="local col6 ref" href="#996xfr" title='xfr' data-ref="996xfr" data-ref-filename="996xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_target" title='auth_probe::scan_target' data-ref="auth_probe::scan_target" data-ref-filename="auth_probe..scan_target">scan_target</a>)</td></tr>
<tr><th id="3872">3872</th><td>		<b>return</b>;</td></tr>
<tr><th id="3873">3873</th><td>	<a class="local col6 ref" href="#996xfr" title='xfr' data-ref="996xfr" data-ref-filename="996xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_target" title='auth_probe::scan_target' data-ref="auth_probe::scan_target" data-ref-filename="auth_probe..scan_target">scan_target</a> = <a class="local col6 ref" href="#996xfr" title='xfr' data-ref="996xfr" data-ref-filename="996xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_target" title='auth_probe::scan_target' data-ref="auth_probe::scan_target" data-ref-filename="auth_probe..scan_target">scan_target</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::next" title='auth_master::next' data-ref="auth_master::next" data-ref-filename="auth_master..next">next</a>;</td></tr>
<tr><th id="3874">3874</th><td>	<b>if</b>(<a class="local col6 ref" href="#996xfr" title='xfr' data-ref="996xfr" data-ref-filename="996xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_target" title='auth_probe::scan_target' data-ref="auth_probe::scan_target" data-ref-filename="auth_probe..scan_target">scan_target</a> &amp;&amp; <a class="local col6 ref" href="#996xfr" title='xfr' data-ref="996xfr" data-ref-filename="996xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;</td></tr>
<tr><th id="3875">3875</th><td>		<a class="ref field" href="authzone.h.html#auth_probe::scan_target" title='auth_probe::scan_target' data-ref="auth_probe::scan_target" data-ref-filename="auth_probe..scan_target">scan_target</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::list" title='auth_master::list' data-ref="auth_master::list" data-ref-filename="auth_master..list">list</a>)</td></tr>
<tr><th id="3876">3876</th><td>		<a class="local col6 ref" href="#996xfr" title='xfr' data-ref="996xfr" data-ref-filename="996xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_addr" title='auth_probe::scan_addr' data-ref="auth_probe::scan_addr" data-ref-filename="auth_probe..scan_addr">scan_addr</a> =</td></tr>
<tr><th id="3877">3877</th><td>			<a class="local col6 ref" href="#996xfr" title='xfr' data-ref="996xfr" data-ref-filename="996xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_target" title='auth_probe::scan_target' data-ref="auth_probe::scan_target" data-ref-filename="auth_probe..scan_target">scan_target</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::list" title='auth_master::list' data-ref="auth_master::list" data-ref-filename="auth_master..list">list</a>;</td></tr>
<tr><th id="3878">3878</th><td>	<b>return</b>;</td></tr>
<tr><th id="3879">3879</th><td>}</td></tr>
<tr><th id="3880">3880</th><td></td></tr>
<tr><th id="3881">3881</th><td><i class="doc" data-doc="xfr_create_soa_probe_packet">/** create SOA probe packet for xfr */</i></td></tr>
<tr><th id="3882">3882</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="3883">3883</th><td><dfn class="tu decl def fn" id="xfr_create_soa_probe_packet" title='xfr_create_soa_probe_packet' data-type='void xfr_create_soa_probe_packet(struct auth_xfer * xfr, sldns_buffer * buf, uint16_t id)' data-ref="xfr_create_soa_probe_packet" data-ref-filename="xfr_create_soa_probe_packet">xfr_create_soa_probe_packet</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col7 decl" id="997xfr" title='xfr' data-type='struct auth_xfer *' data-ref="997xfr" data-ref-filename="997xfr">xfr</dfn>, <a class="typedef" href="../sldns/sbuffer.h.html#sldns_buffer" title='sldns_buffer' data-type='struct sldns_buffer' data-ref="sldns_buffer" data-ref-filename="sldns_buffer">sldns_buffer</a>* <dfn class="local col8 decl" id="998buf" title='buf' data-type='sldns_buffer *' data-ref="998buf" data-ref-filename="998buf">buf</dfn>, </td></tr>
<tr><th id="3884">3884</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col9 decl" id="999id" title='id' data-type='uint16_t' data-ref="999id" data-ref-filename="999id">id</dfn>)</td></tr>
<tr><th id="3885">3885</th><td>{</td></tr>
<tr><th id="3886">3886</th><td>	<b>struct</b> <a class="type" href="../util/data/msgreply.h.html#query_info" title='query_info' data-ref="query_info" data-ref-filename="query_info">query_info</a> <dfn class="local col0 decl" id="1000qinfo" title='qinfo' data-type='struct query_info' data-ref="1000qinfo" data-ref-filename="1000qinfo">qinfo</dfn>;</td></tr>
<tr><th id="3887">3887</th><td></td></tr>
<tr><th id="3888">3888</th><td>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#97" title="((__builtin_object_size(&amp;qinfo, 0) != (size_t)-1) ? __builtin___memset_chk(&amp;qinfo, 0, sizeof(qinfo), __builtin_object_size(&amp;qinfo, 0)) : __memset_ichk(&amp;qinfo, 0, sizeof(qinfo)))" data-ref="_M/memset">memset</a>(&amp;<a class="local col0 ref" href="#1000qinfo" title='qinfo' data-ref="1000qinfo" data-ref-filename="1000qinfo">qinfo</a>, <var>0</var>, <b>sizeof</b>(<a class="local col0 ref" href="#1000qinfo" title='qinfo' data-ref="1000qinfo" data-ref-filename="1000qinfo">qinfo</a>));</td></tr>
<tr><th id="3889">3889</th><td>	<a class="local col0 ref" href="#1000qinfo" title='qinfo' data-ref="1000qinfo" data-ref-filename="1000qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname" title='query_info::qname' data-ref="query_info::qname" data-ref-filename="query_info..qname">qname</a> = <a class="local col7 ref" href="#997xfr" title='xfr' data-ref="997xfr" data-ref-filename="997xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a>;</td></tr>
<tr><th id="3890">3890</th><td>	<a class="local col0 ref" href="#1000qinfo" title='qinfo' data-ref="1000qinfo" data-ref-filename="1000qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname_len" title='query_info::qname_len' data-ref="query_info::qname_len" data-ref-filename="query_info..qname_len">qname_len</a> = <a class="local col7 ref" href="#997xfr" title='xfr' data-ref="997xfr" data-ref-filename="997xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::namelen" title='auth_xfer::namelen' data-ref="auth_xfer::namelen" data-ref-filename="auth_xfer..namelen">namelen</a>;</td></tr>
<tr><th id="3891">3891</th><td>	<a class="local col0 ref" href="#1000qinfo" title='qinfo' data-ref="1000qinfo" data-ref-filename="1000qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qtype" title='query_info::qtype' data-ref="query_info::qtype" data-ref-filename="query_info..qtype">qtype</a> = <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_SOA" title='LDNS_RR_TYPE_SOA' data-ref="LDNS_RR_TYPE_SOA" data-ref-filename="LDNS_RR_TYPE_SOA">LDNS_RR_TYPE_SOA</a>;</td></tr>
<tr><th id="3892">3892</th><td>	<a class="local col0 ref" href="#1000qinfo" title='qinfo' data-ref="1000qinfo" data-ref-filename="1000qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qclass" title='query_info::qclass' data-ref="query_info::qclass" data-ref-filename="query_info..qclass">qclass</a> = <a class="local col7 ref" href="#997xfr" title='xfr' data-ref="997xfr" data-ref-filename="997xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::dclass" title='auth_xfer::dclass' data-ref="auth_xfer::dclass" data-ref-filename="auth_xfer..dclass">dclass</a>;</td></tr>
<tr><th id="3893">3893</th><td>	<a class="ref fn" href="../util/data/msgencode.h.html#qinfo_query_encode" title='qinfo_query_encode' data-ref="qinfo_query_encode" data-ref-filename="qinfo_query_encode">qinfo_query_encode</a>(<a class="local col8 ref" href="#998buf" title='buf' data-ref="998buf" data-ref-filename="998buf">buf</a>, &amp;<a class="local col0 ref" href="#1000qinfo" title='qinfo' data-ref="1000qinfo" data-ref-filename="1000qinfo">qinfo</a>);</td></tr>
<tr><th id="3894">3894</th><td>	<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_write_u16_at" title='sldns_buffer_write_u16_at' data-ref="sldns_buffer_write_u16_at" data-ref-filename="sldns_buffer_write_u16_at">sldns_buffer_write_u16_at</a>(<a class="local col8 ref" href="#998buf" title='buf' data-ref="998buf" data-ref-filename="998buf">buf</a>, <var>0</var>, <a class="local col9 ref" href="#999id" title='id' data-ref="999id" data-ref-filename="999id">id</a>);</td></tr>
<tr><th id="3895">3895</th><td>}</td></tr>
<tr><th id="3896">3896</th><td></td></tr>
<tr><th id="3897">3897</th><td><i class="doc" data-doc="xfr_create_ixfr_packet">/** create IXFR/AXFR packet for xfr */</i></td></tr>
<tr><th id="3898">3898</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="3899">3899</th><td><dfn class="tu decl def fn" id="xfr_create_ixfr_packet" title='xfr_create_ixfr_packet' data-type='void xfr_create_ixfr_packet(struct auth_xfer * xfr, sldns_buffer * buf, uint16_t id, struct auth_master * master)' data-ref="xfr_create_ixfr_packet" data-ref-filename="xfr_create_ixfr_packet">xfr_create_ixfr_packet</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col1 decl" id="1001xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1001xfr" data-ref-filename="1001xfr">xfr</dfn>, <a class="typedef" href="../sldns/sbuffer.h.html#sldns_buffer" title='sldns_buffer' data-type='struct sldns_buffer' data-ref="sldns_buffer" data-ref-filename="sldns_buffer">sldns_buffer</a>* <dfn class="local col2 decl" id="1002buf" title='buf' data-type='sldns_buffer *' data-ref="1002buf" data-ref-filename="1002buf">buf</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col3 decl" id="1003id" title='id' data-type='uint16_t' data-ref="1003id" data-ref-filename="1003id">id</dfn>,</td></tr>
<tr><th id="3900">3900</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>* <dfn class="local col4 decl" id="1004master" title='master' data-type='struct auth_master *' data-ref="1004master" data-ref-filename="1004master">master</dfn>)</td></tr>
<tr><th id="3901">3901</th><td>{</td></tr>
<tr><th id="3902">3902</th><td>	<b>struct</b> <a class="type" href="../util/data/msgreply.h.html#query_info" title='query_info' data-ref="query_info" data-ref-filename="query_info">query_info</a> <dfn class="local col5 decl" id="1005qinfo" title='qinfo' data-type='struct query_info' data-ref="1005qinfo" data-ref-filename="1005qinfo">qinfo</dfn>;</td></tr>
<tr><th id="3903">3903</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a> <dfn class="local col6 decl" id="1006serial" title='serial' data-type='uint32_t' data-ref="1006serial" data-ref-filename="1006serial">serial</dfn>;</td></tr>
<tr><th id="3904">3904</th><td>	<em>int</em> <dfn class="local col7 decl" id="1007have_zone" title='have_zone' data-type='int' data-ref="1007have_zone" data-ref-filename="1007have_zone">have_zone</dfn>;</td></tr>
<tr><th id="3905">3905</th><td>	<a class="local col7 ref" href="#1007have_zone" title='have_zone' data-ref="1007have_zone" data-ref-filename="1007have_zone">have_zone</a> = <a class="local col1 ref" href="#1001xfr" title='xfr' data-ref="1001xfr" data-ref-filename="1001xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::have_zone" title='auth_xfer::have_zone' data-ref="auth_xfer::have_zone" data-ref-filename="auth_xfer..have_zone">have_zone</a>;</td></tr>
<tr><th id="3906">3906</th><td>	<a class="local col6 ref" href="#1006serial" title='serial' data-ref="1006serial" data-ref-filename="1006serial">serial</a> = <a class="local col1 ref" href="#1001xfr" title='xfr' data-ref="1001xfr" data-ref-filename="1001xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::serial" title='auth_xfer::serial' data-ref="auth_xfer::serial" data-ref-filename="auth_xfer..serial">serial</a>;</td></tr>
<tr><th id="3907">3907</th><td></td></tr>
<tr><th id="3908">3908</th><td>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#97" title="((__builtin_object_size(&amp;qinfo, 0) != (size_t)-1) ? __builtin___memset_chk(&amp;qinfo, 0, sizeof(qinfo), __builtin_object_size(&amp;qinfo, 0)) : __memset_ichk(&amp;qinfo, 0, sizeof(qinfo)))" data-ref="_M/memset">memset</a>(&amp;<a class="local col5 ref" href="#1005qinfo" title='qinfo' data-ref="1005qinfo" data-ref-filename="1005qinfo">qinfo</a>, <var>0</var>, <b>sizeof</b>(<a class="local col5 ref" href="#1005qinfo" title='qinfo' data-ref="1005qinfo" data-ref-filename="1005qinfo">qinfo</a>));</td></tr>
<tr><th id="3909">3909</th><td>	<a class="local col5 ref" href="#1005qinfo" title='qinfo' data-ref="1005qinfo" data-ref-filename="1005qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname" title='query_info::qname' data-ref="query_info::qname" data-ref-filename="query_info..qname">qname</a> = <a class="local col1 ref" href="#1001xfr" title='xfr' data-ref="1001xfr" data-ref-filename="1001xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a>;</td></tr>
<tr><th id="3910">3910</th><td>	<a class="local col5 ref" href="#1005qinfo" title='qinfo' data-ref="1005qinfo" data-ref-filename="1005qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname_len" title='query_info::qname_len' data-ref="query_info::qname_len" data-ref-filename="query_info..qname_len">qname_len</a> = <a class="local col1 ref" href="#1001xfr" title='xfr' data-ref="1001xfr" data-ref-filename="1001xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::namelen" title='auth_xfer::namelen' data-ref="auth_xfer::namelen" data-ref-filename="auth_xfer..namelen">namelen</a>;</td></tr>
<tr><th id="3911">3911</th><td>	<a class="local col1 ref" href="#1001xfr" title='xfr' data-ref="1001xfr" data-ref-filename="1001xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::got_xfr_serial" title='auth_transfer::got_xfr_serial' data-ref="auth_transfer::got_xfr_serial" data-ref-filename="auth_transfer..got_xfr_serial">got_xfr_serial</a> = <var>0</var>;</td></tr>
<tr><th id="3912">3912</th><td>	<a class="local col1 ref" href="#1001xfr" title='xfr' data-ref="1001xfr" data-ref-filename="1001xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::rr_scan_num" title='auth_transfer::rr_scan_num' data-ref="auth_transfer::rr_scan_num" data-ref-filename="auth_transfer..rr_scan_num">rr_scan_num</a> = <var>0</var>;</td></tr>
<tr><th id="3913">3913</th><td>	<a class="local col1 ref" href="#1001xfr" title='xfr' data-ref="1001xfr" data-ref-filename="1001xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::incoming_xfr_serial" title='auth_transfer::incoming_xfr_serial' data-ref="auth_transfer::incoming_xfr_serial" data-ref-filename="auth_transfer..incoming_xfr_serial">incoming_xfr_serial</a> = <var>0</var>;</td></tr>
<tr><th id="3914">3914</th><td>	<a class="local col1 ref" href="#1001xfr" title='xfr' data-ref="1001xfr" data-ref-filename="1001xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::on_ixfr_is_axfr" title='auth_transfer::on_ixfr_is_axfr' data-ref="auth_transfer::on_ixfr_is_axfr" data-ref-filename="auth_transfer..on_ixfr_is_axfr">on_ixfr_is_axfr</a> = <var>0</var>;</td></tr>
<tr><th id="3915">3915</th><td>	<a class="local col1 ref" href="#1001xfr" title='xfr' data-ref="1001xfr" data-ref-filename="1001xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::on_ixfr" title='auth_transfer::on_ixfr' data-ref="auth_transfer::on_ixfr" data-ref-filename="auth_transfer..on_ixfr">on_ixfr</a> = <var>1</var>;</td></tr>
<tr><th id="3916">3916</th><td>	<a class="local col5 ref" href="#1005qinfo" title='qinfo' data-ref="1005qinfo" data-ref-filename="1005qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qtype" title='query_info::qtype' data-ref="query_info::qtype" data-ref-filename="query_info..qtype">qtype</a> = <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_IXFR" title='LDNS_RR_TYPE_IXFR' data-ref="LDNS_RR_TYPE_IXFR" data-ref-filename="LDNS_RR_TYPE_IXFR">LDNS_RR_TYPE_IXFR</a>;</td></tr>
<tr><th id="3917">3917</th><td>	<b>if</b>(!<a class="local col7 ref" href="#1007have_zone" title='have_zone' data-ref="1007have_zone" data-ref-filename="1007have_zone">have_zone</a> || <a class="local col1 ref" href="#1001xfr" title='xfr' data-ref="1001xfr" data-ref-filename="1001xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::ixfr_fail" title='auth_transfer::ixfr_fail' data-ref="auth_transfer::ixfr_fail" data-ref-filename="auth_transfer..ixfr_fail">ixfr_fail</a> || !<a class="local col4 ref" href="#1004master" title='master' data-ref="1004master" data-ref-filename="1004master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::ixfr" title='auth_master::ixfr' data-ref="auth_master::ixfr" data-ref-filename="auth_master..ixfr">ixfr</a>) {</td></tr>
<tr><th id="3918">3918</th><td>		<a class="local col5 ref" href="#1005qinfo" title='qinfo' data-ref="1005qinfo" data-ref-filename="1005qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qtype" title='query_info::qtype' data-ref="query_info::qtype" data-ref-filename="query_info..qtype">qtype</a> = <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_AXFR" title='LDNS_RR_TYPE_AXFR' data-ref="LDNS_RR_TYPE_AXFR" data-ref-filename="LDNS_RR_TYPE_AXFR">LDNS_RR_TYPE_AXFR</a>;</td></tr>
<tr><th id="3919">3919</th><td>		<a class="local col1 ref" href="#1001xfr" title='xfr' data-ref="1001xfr" data-ref-filename="1001xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::ixfr_fail" title='auth_transfer::ixfr_fail' data-ref="auth_transfer::ixfr_fail" data-ref-filename="auth_transfer..ixfr_fail">ixfr_fail</a> = <var>0</var>;</td></tr>
<tr><th id="3920">3920</th><td>		<a class="local col1 ref" href="#1001xfr" title='xfr' data-ref="1001xfr" data-ref-filename="1001xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::on_ixfr" title='auth_transfer::on_ixfr' data-ref="auth_transfer::on_ixfr" data-ref-filename="auth_transfer..on_ixfr">on_ixfr</a> = <var>0</var>;</td></tr>
<tr><th id="3921">3921</th><td>	}</td></tr>
<tr><th id="3922">3922</th><td></td></tr>
<tr><th id="3923">3923</th><td>	<a class="local col5 ref" href="#1005qinfo" title='qinfo' data-ref="1005qinfo" data-ref-filename="1005qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qclass" title='query_info::qclass' data-ref="query_info::qclass" data-ref-filename="query_info..qclass">qclass</a> = <a class="local col1 ref" href="#1001xfr" title='xfr' data-ref="1001xfr" data-ref-filename="1001xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::dclass" title='auth_xfer::dclass' data-ref="auth_xfer::dclass" data-ref-filename="auth_xfer..dclass">dclass</a>;</td></tr>
<tr><th id="3924">3924</th><td>	<a class="ref fn" href="../util/data/msgencode.h.html#qinfo_query_encode" title='qinfo_query_encode' data-ref="qinfo_query_encode" data-ref-filename="qinfo_query_encode">qinfo_query_encode</a>(<a class="local col2 ref" href="#1002buf" title='buf' data-ref="1002buf" data-ref-filename="1002buf">buf</a>, &amp;<a class="local col5 ref" href="#1005qinfo" title='qinfo' data-ref="1005qinfo" data-ref-filename="1005qinfo">qinfo</a>);</td></tr>
<tr><th id="3925">3925</th><td>	<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_write_u16_at" title='sldns_buffer_write_u16_at' data-ref="sldns_buffer_write_u16_at" data-ref-filename="sldns_buffer_write_u16_at">sldns_buffer_write_u16_at</a>(<a class="local col2 ref" href="#1002buf" title='buf' data-ref="1002buf" data-ref-filename="1002buf">buf</a>, <var>0</var>, <a class="local col3 ref" href="#1003id" title='id' data-ref="1003id" data-ref-filename="1003id">id</a>);</td></tr>
<tr><th id="3926">3926</th><td></td></tr>
<tr><th id="3927">3927</th><td>	<i>/* append serial for IXFR */</i></td></tr>
<tr><th id="3928">3928</th><td>	<b>if</b>(<a class="local col5 ref" href="#1005qinfo" title='qinfo' data-ref="1005qinfo" data-ref-filename="1005qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qtype" title='query_info::qtype' data-ref="query_info::qtype" data-ref-filename="query_info..qtype">qtype</a> == <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_IXFR" title='LDNS_RR_TYPE_IXFR' data-ref="LDNS_RR_TYPE_IXFR" data-ref-filename="LDNS_RR_TYPE_IXFR">LDNS_RR_TYPE_IXFR</a>) {</td></tr>
<tr><th id="3929">3929</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col8 decl" id="1008end" title='end' data-type='size_t' data-ref="1008end" data-ref-filename="1008end">end</dfn> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_limit" title='sldns_buffer_limit' data-ref="sldns_buffer_limit" data-ref-filename="sldns_buffer_limit">sldns_buffer_limit</a>(<a class="local col2 ref" href="#1002buf" title='buf' data-ref="1002buf" data-ref-filename="1002buf">buf</a>);</td></tr>
<tr><th id="3930">3930</th><td>		<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_clear" title='sldns_buffer_clear' data-ref="sldns_buffer_clear" data-ref-filename="sldns_buffer_clear">sldns_buffer_clear</a>(<a class="local col2 ref" href="#1002buf" title='buf' data-ref="1002buf" data-ref-filename="1002buf">buf</a>);</td></tr>
<tr><th id="3931">3931</th><td>		<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_set_position" title='sldns_buffer_set_position' data-ref="sldns_buffer_set_position" data-ref-filename="sldns_buffer_set_position">sldns_buffer_set_position</a>(<a class="local col2 ref" href="#1002buf" title='buf' data-ref="1002buf" data-ref-filename="1002buf">buf</a>, <a class="local col8 ref" href="#1008end" title='end' data-ref="1008end" data-ref-filename="1008end">end</a>);</td></tr>
<tr><th id="3932">3932</th><td>		<i>/* auth section count 1 */</i></td></tr>
<tr><th id="3933">3933</th><td>		<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_write_u16_at" title='sldns_buffer_write_u16_at' data-ref="sldns_buffer_write_u16_at" data-ref-filename="sldns_buffer_write_u16_at">sldns_buffer_write_u16_at</a>(<a class="local col2 ref" href="#1002buf" title='buf' data-ref="1002buf" data-ref-filename="1002buf">buf</a>, <a class="macro" href="../sldns/pkthdr.h.html#106" title="8" data-ref="_M/LDNS_NSCOUNT_OFF">LDNS_NSCOUNT_OFF</a>, <var>1</var>);</td></tr>
<tr><th id="3934">3934</th><td>		<i>/* write SOA */</i></td></tr>
<tr><th id="3935">3935</th><td>		<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_write_u8" title='sldns_buffer_write_u8' data-ref="sldns_buffer_write_u8" data-ref-filename="sldns_buffer_write_u8">sldns_buffer_write_u8</a>(<a class="local col2 ref" href="#1002buf" title='buf' data-ref="1002buf" data-ref-filename="1002buf">buf</a>, <var>0xC0</var>); <i>/* compressed ptr to qname */</i></td></tr>
<tr><th id="3936">3936</th><td>		<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_write_u8" title='sldns_buffer_write_u8' data-ref="sldns_buffer_write_u8" data-ref-filename="sldns_buffer_write_u8">sldns_buffer_write_u8</a>(<a class="local col2 ref" href="#1002buf" title='buf' data-ref="1002buf" data-ref-filename="1002buf">buf</a>, <var>0x0C</var>);</td></tr>
<tr><th id="3937">3937</th><td>		<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_write_u16" title='sldns_buffer_write_u16' data-ref="sldns_buffer_write_u16" data-ref-filename="sldns_buffer_write_u16">sldns_buffer_write_u16</a>(<a class="local col2 ref" href="#1002buf" title='buf' data-ref="1002buf" data-ref-filename="1002buf">buf</a>, <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_SOA" title='LDNS_RR_TYPE_SOA' data-ref="LDNS_RR_TYPE_SOA" data-ref-filename="LDNS_RR_TYPE_SOA">LDNS_RR_TYPE_SOA</a>);</td></tr>
<tr><th id="3938">3938</th><td>		<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_write_u16" title='sldns_buffer_write_u16' data-ref="sldns_buffer_write_u16" data-ref-filename="sldns_buffer_write_u16">sldns_buffer_write_u16</a>(<a class="local col2 ref" href="#1002buf" title='buf' data-ref="1002buf" data-ref-filename="1002buf">buf</a>, <a class="local col5 ref" href="#1005qinfo" title='qinfo' data-ref="1005qinfo" data-ref-filename="1005qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qclass" title='query_info::qclass' data-ref="query_info::qclass" data-ref-filename="query_info..qclass">qclass</a>);</td></tr>
<tr><th id="3939">3939</th><td>		<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_write_u32" title='sldns_buffer_write_u32' data-ref="sldns_buffer_write_u32" data-ref-filename="sldns_buffer_write_u32">sldns_buffer_write_u32</a>(<a class="local col2 ref" href="#1002buf" title='buf' data-ref="1002buf" data-ref-filename="1002buf">buf</a>, <var>0</var>); <i>/* ttl */</i></td></tr>
<tr><th id="3940">3940</th><td>		<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_write_u16" title='sldns_buffer_write_u16' data-ref="sldns_buffer_write_u16" data-ref-filename="sldns_buffer_write_u16">sldns_buffer_write_u16</a>(<a class="local col2 ref" href="#1002buf" title='buf' data-ref="1002buf" data-ref-filename="1002buf">buf</a>, <var>22</var>); <i>/* rdata length */</i></td></tr>
<tr><th id="3941">3941</th><td>		<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_write_u8" title='sldns_buffer_write_u8' data-ref="sldns_buffer_write_u8" data-ref-filename="sldns_buffer_write_u8">sldns_buffer_write_u8</a>(<a class="local col2 ref" href="#1002buf" title='buf' data-ref="1002buf" data-ref-filename="1002buf">buf</a>, <var>0</var>); <i>/* . */</i></td></tr>
<tr><th id="3942">3942</th><td>		<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_write_u8" title='sldns_buffer_write_u8' data-ref="sldns_buffer_write_u8" data-ref-filename="sldns_buffer_write_u8">sldns_buffer_write_u8</a>(<a class="local col2 ref" href="#1002buf" title='buf' data-ref="1002buf" data-ref-filename="1002buf">buf</a>, <var>0</var>); <i>/* . */</i></td></tr>
<tr><th id="3943">3943</th><td>		<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_write_u32" title='sldns_buffer_write_u32' data-ref="sldns_buffer_write_u32" data-ref-filename="sldns_buffer_write_u32">sldns_buffer_write_u32</a>(<a class="local col2 ref" href="#1002buf" title='buf' data-ref="1002buf" data-ref-filename="1002buf">buf</a>, <a class="local col6 ref" href="#1006serial" title='serial' data-ref="1006serial" data-ref-filename="1006serial">serial</a>); <i>/* serial */</i></td></tr>
<tr><th id="3944">3944</th><td>		<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_write_u32" title='sldns_buffer_write_u32' data-ref="sldns_buffer_write_u32" data-ref-filename="sldns_buffer_write_u32">sldns_buffer_write_u32</a>(<a class="local col2 ref" href="#1002buf" title='buf' data-ref="1002buf" data-ref-filename="1002buf">buf</a>, <var>0</var>); <i>/* refresh */</i></td></tr>
<tr><th id="3945">3945</th><td>		<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_write_u32" title='sldns_buffer_write_u32' data-ref="sldns_buffer_write_u32" data-ref-filename="sldns_buffer_write_u32">sldns_buffer_write_u32</a>(<a class="local col2 ref" href="#1002buf" title='buf' data-ref="1002buf" data-ref-filename="1002buf">buf</a>, <var>0</var>); <i>/* retry */</i></td></tr>
<tr><th id="3946">3946</th><td>		<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_write_u32" title='sldns_buffer_write_u32' data-ref="sldns_buffer_write_u32" data-ref-filename="sldns_buffer_write_u32">sldns_buffer_write_u32</a>(<a class="local col2 ref" href="#1002buf" title='buf' data-ref="1002buf" data-ref-filename="1002buf">buf</a>, <var>0</var>); <i>/* expire */</i></td></tr>
<tr><th id="3947">3947</th><td>		<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_write_u32" title='sldns_buffer_write_u32' data-ref="sldns_buffer_write_u32" data-ref-filename="sldns_buffer_write_u32">sldns_buffer_write_u32</a>(<a class="local col2 ref" href="#1002buf" title='buf' data-ref="1002buf" data-ref-filename="1002buf">buf</a>, <var>0</var>); <i>/* minimum */</i></td></tr>
<tr><th id="3948">3948</th><td>		<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_flip" title='sldns_buffer_flip' data-ref="sldns_buffer_flip" data-ref-filename="sldns_buffer_flip">sldns_buffer_flip</a>(<a class="local col2 ref" href="#1002buf" title='buf' data-ref="1002buf" data-ref-filename="1002buf">buf</a>);</td></tr>
<tr><th id="3949">3949</th><td>	}</td></tr>
<tr><th id="3950">3950</th><td>}</td></tr>
<tr><th id="3951">3951</th><td></td></tr>
<tr><th id="3952">3952</th><td><i class="doc" data-doc="check_packet_ok">/** check if returned packet is OK */</i></td></tr>
<tr><th id="3953">3953</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="3954">3954</th><td><dfn class="tu decl def fn" id="check_packet_ok" title='check_packet_ok' data-type='int check_packet_ok(sldns_buffer * pkt, uint16_t qtype, struct auth_xfer * xfr, uint32_t * serial)' data-ref="check_packet_ok" data-ref-filename="check_packet_ok">check_packet_ok</dfn>(<a class="typedef" href="../sldns/sbuffer.h.html#sldns_buffer" title='sldns_buffer' data-type='struct sldns_buffer' data-ref="sldns_buffer" data-ref-filename="sldns_buffer">sldns_buffer</a>* <dfn class="local col9 decl" id="1009pkt" title='pkt' data-type='sldns_buffer *' data-ref="1009pkt" data-ref-filename="1009pkt">pkt</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col0 decl" id="1010qtype" title='qtype' data-type='uint16_t' data-ref="1010qtype" data-ref-filename="1010qtype">qtype</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col1 decl" id="1011xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1011xfr" data-ref-filename="1011xfr">xfr</dfn>,</td></tr>
<tr><th id="3955">3955</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a>* <dfn class="local col2 decl" id="1012serial" title='serial' data-type='uint32_t *' data-ref="1012serial" data-ref-filename="1012serial">serial</dfn>)</td></tr>
<tr><th id="3956">3956</th><td>{</td></tr>
<tr><th id="3957">3957</th><td>	<i>/* parse to see if packet worked, valid reply */</i></td></tr>
<tr><th id="3958">3958</th><td></td></tr>
<tr><th id="3959">3959</th><td>	<i>/* check serial number of SOA */</i></td></tr>
<tr><th id="3960">3960</th><td>	<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_limit" title='sldns_buffer_limit' data-ref="sldns_buffer_limit" data-ref-filename="sldns_buffer_limit">sldns_buffer_limit</a>(<a class="local col9 ref" href="#1009pkt" title='pkt' data-ref="1009pkt" data-ref-filename="1009pkt">pkt</a>) &lt; <a class="macro" href="../sldns/pkthdr.h.html#26" title="12" data-ref="_M/LDNS_HEADER_SIZE">LDNS_HEADER_SIZE</a>)</td></tr>
<tr><th id="3961">3961</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3962">3962</th><td></td></tr>
<tr><th id="3963">3963</th><td>	<i>/* check ID */</i></td></tr>
<tr><th id="3964">3964</th><td>	<b>if</b>(<a class="macro" href="../sldns/pkthdr.h.html#91" title="(sldns_read_uint16(sldns_buffer_begin(pkt)))" data-ref="_M/LDNS_ID_WIRE">LDNS_ID_WIRE</a>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_begin" title='sldns_buffer_begin' data-ref="sldns_buffer_begin" data-ref-filename="sldns_buffer_begin">sldns_buffer_begin</a>(<a class="local col9 ref" href="#1009pkt" title='pkt' data-ref="1009pkt" data-ref-filename="1009pkt">pkt</a>)) != <a class="local col1 ref" href="#1011xfr" title='xfr' data-ref="1011xfr" data-ref-filename="1011xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::id" title='auth_probe::id' data-ref="auth_probe::id" data-ref-filename="auth_probe..id">id</a>)</td></tr>
<tr><th id="3965">3965</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3966">3966</th><td></td></tr>
<tr><th id="3967">3967</th><td>	<i>/* check flag bits and rcode */</i></td></tr>
<tr><th id="3968">3968</th><td>	<b>if</b>(!<a class="macro" href="../sldns/pkthdr.h.html#55" title="(*(sldns_buffer_begin(pkt)+2) &amp; 0x80U)" data-ref="_M/LDNS_QR_WIRE">LDNS_QR_WIRE</a>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_begin" title='sldns_buffer_begin' data-ref="sldns_buffer_begin" data-ref-filename="sldns_buffer_begin">sldns_buffer_begin</a>(<a class="local col9 ref" href="#1009pkt" title='pkt' data-ref="1009pkt" data-ref-filename="1009pkt">pkt</a>)))</td></tr>
<tr><th id="3969">3969</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3970">3970</th><td>	<b>if</b>(<a class="macro" href="../sldns/pkthdr.h.html#49" title="((*(sldns_buffer_begin(pkt)+2) &amp; 0x78U) &gt;&gt; 3)" data-ref="_M/LDNS_OPCODE_WIRE">LDNS_OPCODE_WIRE</a>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_begin" title='sldns_buffer_begin' data-ref="sldns_buffer_begin" data-ref-filename="sldns_buffer_begin">sldns_buffer_begin</a>(<a class="local col9 ref" href="#1009pkt" title='pkt' data-ref="1009pkt" data-ref-filename="1009pkt">pkt</a>)) != <a class="enum" href="../sldns/pkthdr.h.html#LDNS_PACKET_QUERY" title='LDNS_PACKET_QUERY' data-ref="LDNS_PACKET_QUERY" data-ref-filename="LDNS_PACKET_QUERY">LDNS_PACKET_QUERY</a>)</td></tr>
<tr><th id="3971">3971</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3972">3972</th><td>	<b>if</b>(<a class="macro" href="../sldns/pkthdr.h.html#62" title="(*(sldns_buffer_begin(pkt)+3) &amp; 0x0fU)" data-ref="_M/LDNS_RCODE_WIRE">LDNS_RCODE_WIRE</a>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_begin" title='sldns_buffer_begin' data-ref="sldns_buffer_begin" data-ref-filename="sldns_buffer_begin">sldns_buffer_begin</a>(<a class="local col9 ref" href="#1009pkt" title='pkt' data-ref="1009pkt" data-ref-filename="1009pkt">pkt</a>)) != <a class="enum" href="../sldns/pkthdr.h.html#LDNS_RCODE_NOERROR" title='LDNS_RCODE_NOERROR' data-ref="LDNS_RCODE_NOERROR" data-ref-filename="LDNS_RCODE_NOERROR">LDNS_RCODE_NOERROR</a>)</td></tr>
<tr><th id="3973">3973</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3974">3974</th><td></td></tr>
<tr><th id="3975">3975</th><td>	<i>/* check qname */</i></td></tr>
<tr><th id="3976">3976</th><td>	<b>if</b>(<a class="macro" href="../sldns/pkthdr.h.html#99" title="(sldns_read_uint16(sldns_buffer_begin(pkt)+4))" data-ref="_M/LDNS_QDCOUNT">LDNS_QDCOUNT</a>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_begin" title='sldns_buffer_begin' data-ref="sldns_buffer_begin" data-ref-filename="sldns_buffer_begin">sldns_buffer_begin</a>(<a class="local col9 ref" href="#1009pkt" title='pkt' data-ref="1009pkt" data-ref-filename="1009pkt">pkt</a>)) != <var>1</var>)</td></tr>
<tr><th id="3977">3977</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3978">3978</th><td>	<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_skip" title='sldns_buffer_skip' data-ref="sldns_buffer_skip" data-ref-filename="sldns_buffer_skip">sldns_buffer_skip</a>(<a class="local col9 ref" href="#1009pkt" title='pkt' data-ref="1009pkt" data-ref-filename="1009pkt">pkt</a>, <a class="macro" href="../sldns/pkthdr.h.html#26" title="12" data-ref="_M/LDNS_HEADER_SIZE">LDNS_HEADER_SIZE</a>);</td></tr>
<tr><th id="3979">3979</th><td>	<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_remaining" title='sldns_buffer_remaining' data-ref="sldns_buffer_remaining" data-ref-filename="sldns_buffer_remaining">sldns_buffer_remaining</a>(<a class="local col9 ref" href="#1009pkt" title='pkt' data-ref="1009pkt" data-ref-filename="1009pkt">pkt</a>) &lt; <a class="local col1 ref" href="#1011xfr" title='xfr' data-ref="1011xfr" data-ref-filename="1011xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::namelen" title='auth_xfer::namelen' data-ref="auth_xfer::namelen" data-ref-filename="auth_xfer..namelen">namelen</a>)</td></tr>
<tr><th id="3980">3980</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3981">3981</th><td>	<b>if</b>(<a class="ref fn" href="../util/data/dname.h.html#query_dname_compare" title='query_dname_compare' data-ref="query_dname_compare" data-ref-filename="query_dname_compare">query_dname_compare</a>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_current" title='sldns_buffer_current' data-ref="sldns_buffer_current" data-ref-filename="sldns_buffer_current">sldns_buffer_current</a>(<a class="local col9 ref" href="#1009pkt" title='pkt' data-ref="1009pkt" data-ref-filename="1009pkt">pkt</a>), <a class="local col1 ref" href="#1011xfr" title='xfr' data-ref="1011xfr" data-ref-filename="1011xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a>) != <var>0</var>)</td></tr>
<tr><th id="3982">3982</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3983">3983</th><td>	<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_skip" title='sldns_buffer_skip' data-ref="sldns_buffer_skip" data-ref-filename="sldns_buffer_skip">sldns_buffer_skip</a>(<a class="local col9 ref" href="#1009pkt" title='pkt' data-ref="1009pkt" data-ref-filename="1009pkt">pkt</a>, (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#ssize_t" title='ssize_t' data-type='int' data-ref="ssize_t" data-ref-filename="ssize_t">ssize_t</a>)<a class="local col1 ref" href="#1011xfr" title='xfr' data-ref="1011xfr" data-ref-filename="1011xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::namelen" title='auth_xfer::namelen' data-ref="auth_xfer::namelen" data-ref-filename="auth_xfer..namelen">namelen</a>);</td></tr>
<tr><th id="3984">3984</th><td></td></tr>
<tr><th id="3985">3985</th><td>	<i>/* check qtype, qclass */</i></td></tr>
<tr><th id="3986">3986</th><td>	<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_remaining" title='sldns_buffer_remaining' data-ref="sldns_buffer_remaining" data-ref-filename="sldns_buffer_remaining">sldns_buffer_remaining</a>(<a class="local col9 ref" href="#1009pkt" title='pkt' data-ref="1009pkt" data-ref-filename="1009pkt">pkt</a>) &lt; <var>4</var>)</td></tr>
<tr><th id="3987">3987</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3988">3988</th><td>	<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u16" title='sldns_buffer_read_u16' data-ref="sldns_buffer_read_u16" data-ref-filename="sldns_buffer_read_u16">sldns_buffer_read_u16</a>(<a class="local col9 ref" href="#1009pkt" title='pkt' data-ref="1009pkt" data-ref-filename="1009pkt">pkt</a>) != <a class="local col0 ref" href="#1010qtype" title='qtype' data-ref="1010qtype" data-ref-filename="1010qtype">qtype</a>)</td></tr>
<tr><th id="3989">3989</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3990">3990</th><td>	<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u16" title='sldns_buffer_read_u16' data-ref="sldns_buffer_read_u16" data-ref-filename="sldns_buffer_read_u16">sldns_buffer_read_u16</a>(<a class="local col9 ref" href="#1009pkt" title='pkt' data-ref="1009pkt" data-ref-filename="1009pkt">pkt</a>) != <a class="local col1 ref" href="#1011xfr" title='xfr' data-ref="1011xfr" data-ref-filename="1011xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::dclass" title='auth_xfer::dclass' data-ref="auth_xfer::dclass" data-ref-filename="auth_xfer..dclass">dclass</a>)</td></tr>
<tr><th id="3991">3991</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3992">3992</th><td></td></tr>
<tr><th id="3993">3993</th><td>	<b>if</b>(<a class="local col2 ref" href="#1012serial" title='serial' data-ref="1012serial" data-ref-filename="1012serial">serial</a>) {</td></tr>
<tr><th id="3994">3994</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col3 decl" id="1013rdlen" title='rdlen' data-type='uint16_t' data-ref="1013rdlen" data-ref-filename="1013rdlen">rdlen</dfn>;</td></tr>
<tr><th id="3995">3995</th><td>		<i>/* read serial number, from answer section SOA */</i></td></tr>
<tr><th id="3996">3996</th><td>		<b>if</b>(<a class="macro" href="../sldns/pkthdr.h.html#103" title="(sldns_read_uint16(sldns_buffer_begin(pkt)+6))" data-ref="_M/LDNS_ANCOUNT">LDNS_ANCOUNT</a>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_begin" title='sldns_buffer_begin' data-ref="sldns_buffer_begin" data-ref-filename="sldns_buffer_begin">sldns_buffer_begin</a>(<a class="local col9 ref" href="#1009pkt" title='pkt' data-ref="1009pkt" data-ref-filename="1009pkt">pkt</a>)) == <var>0</var>)</td></tr>
<tr><th id="3997">3997</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3998">3998</th><td>		<i>/* read from first record SOA record */</i></td></tr>
<tr><th id="3999">3999</th><td>		<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_remaining" title='sldns_buffer_remaining' data-ref="sldns_buffer_remaining" data-ref-filename="sldns_buffer_remaining">sldns_buffer_remaining</a>(<a class="local col9 ref" href="#1009pkt" title='pkt' data-ref="1009pkt" data-ref-filename="1009pkt">pkt</a>) &lt; <var>1</var>)</td></tr>
<tr><th id="4000">4000</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4001">4001</th><td>		<b>if</b>(<a class="ref fn" href="../util/data/dname.h.html#dname_pkt_compare" title='dname_pkt_compare' data-ref="dname_pkt_compare" data-ref-filename="dname_pkt_compare">dname_pkt_compare</a>(<a class="local col9 ref" href="#1009pkt" title='pkt' data-ref="1009pkt" data-ref-filename="1009pkt">pkt</a>, <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_current" title='sldns_buffer_current' data-ref="sldns_buffer_current" data-ref-filename="sldns_buffer_current">sldns_buffer_current</a>(<a class="local col9 ref" href="#1009pkt" title='pkt' data-ref="1009pkt" data-ref-filename="1009pkt">pkt</a>),</td></tr>
<tr><th id="4002">4002</th><td>			<a class="local col1 ref" href="#1011xfr" title='xfr' data-ref="1011xfr" data-ref-filename="1011xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a>) != <var>0</var>)</td></tr>
<tr><th id="4003">4003</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4004">4004</th><td>		<b>if</b>(!<a class="ref fn" href="../util/data/dname.h.html#pkt_dname_len" title='pkt_dname_len' data-ref="pkt_dname_len" data-ref-filename="pkt_dname_len">pkt_dname_len</a>(<a class="local col9 ref" href="#1009pkt" title='pkt' data-ref="1009pkt" data-ref-filename="1009pkt">pkt</a>))</td></tr>
<tr><th id="4005">4005</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4006">4006</th><td>		<i>/* type, class, ttl, rdatalen */</i></td></tr>
<tr><th id="4007">4007</th><td>		<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_remaining" title='sldns_buffer_remaining' data-ref="sldns_buffer_remaining" data-ref-filename="sldns_buffer_remaining">sldns_buffer_remaining</a>(<a class="local col9 ref" href="#1009pkt" title='pkt' data-ref="1009pkt" data-ref-filename="1009pkt">pkt</a>) &lt; <var>4</var>+<var>4</var>+<var>2</var>)</td></tr>
<tr><th id="4008">4008</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4009">4009</th><td>		<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u16" title='sldns_buffer_read_u16' data-ref="sldns_buffer_read_u16" data-ref-filename="sldns_buffer_read_u16">sldns_buffer_read_u16</a>(<a class="local col9 ref" href="#1009pkt" title='pkt' data-ref="1009pkt" data-ref-filename="1009pkt">pkt</a>) != <a class="local col0 ref" href="#1010qtype" title='qtype' data-ref="1010qtype" data-ref-filename="1010qtype">qtype</a>)</td></tr>
<tr><th id="4010">4010</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4011">4011</th><td>		<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u16" title='sldns_buffer_read_u16' data-ref="sldns_buffer_read_u16" data-ref-filename="sldns_buffer_read_u16">sldns_buffer_read_u16</a>(<a class="local col9 ref" href="#1009pkt" title='pkt' data-ref="1009pkt" data-ref-filename="1009pkt">pkt</a>) != <a class="local col1 ref" href="#1011xfr" title='xfr' data-ref="1011xfr" data-ref-filename="1011xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::dclass" title='auth_xfer::dclass' data-ref="auth_xfer::dclass" data-ref-filename="auth_xfer..dclass">dclass</a>)</td></tr>
<tr><th id="4012">4012</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4013">4013</th><td>		<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_skip" title='sldns_buffer_skip' data-ref="sldns_buffer_skip" data-ref-filename="sldns_buffer_skip">sldns_buffer_skip</a>(<a class="local col9 ref" href="#1009pkt" title='pkt' data-ref="1009pkt" data-ref-filename="1009pkt">pkt</a>, <var>4</var>); <i>/* ttl */</i></td></tr>
<tr><th id="4014">4014</th><td>		<a class="local col3 ref" href="#1013rdlen" title='rdlen' data-ref="1013rdlen" data-ref-filename="1013rdlen">rdlen</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u16" title='sldns_buffer_read_u16' data-ref="sldns_buffer_read_u16" data-ref-filename="sldns_buffer_read_u16">sldns_buffer_read_u16</a>(<a class="local col9 ref" href="#1009pkt" title='pkt' data-ref="1009pkt" data-ref-filename="1009pkt">pkt</a>);</td></tr>
<tr><th id="4015">4015</th><td>		<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_remaining" title='sldns_buffer_remaining' data-ref="sldns_buffer_remaining" data-ref-filename="sldns_buffer_remaining">sldns_buffer_remaining</a>(<a class="local col9 ref" href="#1009pkt" title='pkt' data-ref="1009pkt" data-ref-filename="1009pkt">pkt</a>) &lt; <a class="local col3 ref" href="#1013rdlen" title='rdlen' data-ref="1013rdlen" data-ref-filename="1013rdlen">rdlen</a>)</td></tr>
<tr><th id="4016">4016</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4017">4017</th><td>		<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_remaining" title='sldns_buffer_remaining' data-ref="sldns_buffer_remaining" data-ref-filename="sldns_buffer_remaining">sldns_buffer_remaining</a>(<a class="local col9 ref" href="#1009pkt" title='pkt' data-ref="1009pkt" data-ref-filename="1009pkt">pkt</a>) &lt; <var>1</var>)</td></tr>
<tr><th id="4018">4018</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4019">4019</th><td>		<b>if</b>(!<a class="ref fn" href="../util/data/dname.h.html#pkt_dname_len" title='pkt_dname_len' data-ref="pkt_dname_len" data-ref-filename="pkt_dname_len">pkt_dname_len</a>(<a class="local col9 ref" href="#1009pkt" title='pkt' data-ref="1009pkt" data-ref-filename="1009pkt">pkt</a>)) <i>/* soa name */</i></td></tr>
<tr><th id="4020">4020</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4021">4021</th><td>		<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_remaining" title='sldns_buffer_remaining' data-ref="sldns_buffer_remaining" data-ref-filename="sldns_buffer_remaining">sldns_buffer_remaining</a>(<a class="local col9 ref" href="#1009pkt" title='pkt' data-ref="1009pkt" data-ref-filename="1009pkt">pkt</a>) &lt; <var>1</var>)</td></tr>
<tr><th id="4022">4022</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4023">4023</th><td>		<b>if</b>(!<a class="ref fn" href="../util/data/dname.h.html#pkt_dname_len" title='pkt_dname_len' data-ref="pkt_dname_len" data-ref-filename="pkt_dname_len">pkt_dname_len</a>(<a class="local col9 ref" href="#1009pkt" title='pkt' data-ref="1009pkt" data-ref-filename="1009pkt">pkt</a>)) <i>/* soa name */</i></td></tr>
<tr><th id="4024">4024</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4025">4025</th><td>		<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_remaining" title='sldns_buffer_remaining' data-ref="sldns_buffer_remaining" data-ref-filename="sldns_buffer_remaining">sldns_buffer_remaining</a>(<a class="local col9 ref" href="#1009pkt" title='pkt' data-ref="1009pkt" data-ref-filename="1009pkt">pkt</a>) &lt; <var>20</var>)</td></tr>
<tr><th id="4026">4026</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4027">4027</th><td>		*<a class="local col2 ref" href="#1012serial" title='serial' data-ref="1012serial" data-ref-filename="1012serial">serial</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u32" title='sldns_buffer_read_u32' data-ref="sldns_buffer_read_u32" data-ref-filename="sldns_buffer_read_u32">sldns_buffer_read_u32</a>(<a class="local col9 ref" href="#1009pkt" title='pkt' data-ref="1009pkt" data-ref-filename="1009pkt">pkt</a>);</td></tr>
<tr><th id="4028">4028</th><td>	}</td></tr>
<tr><th id="4029">4029</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="4030">4030</th><td>}</td></tr>
<tr><th id="4031">4031</th><td></td></tr>
<tr><th id="4032">4032</th><td><i class="doc" data-doc="chunkline_get_line">/** read one line from chunks into buffer at current position */</i></td></tr>
<tr><th id="4033">4033</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="4034">4034</th><td><dfn class="tu decl def fn" id="chunkline_get_line" title='chunkline_get_line' data-type='int chunkline_get_line(struct auth_chunk ** chunk, size_t * chunk_pos, sldns_buffer * buf)' data-ref="chunkline_get_line" data-ref-filename="chunkline_get_line">chunkline_get_line</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_chunk" title='auth_chunk' data-ref="auth_chunk" data-ref-filename="auth_chunk">auth_chunk</a>** <dfn class="local col4 decl" id="1014chunk" title='chunk' data-type='struct auth_chunk **' data-ref="1014chunk" data-ref-filename="1014chunk">chunk</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>* <dfn class="local col5 decl" id="1015chunk_pos" title='chunk_pos' data-type='size_t *' data-ref="1015chunk_pos" data-ref-filename="1015chunk_pos">chunk_pos</dfn>,</td></tr>
<tr><th id="4035">4035</th><td>	<a class="typedef" href="../sldns/sbuffer.h.html#sldns_buffer" title='sldns_buffer' data-type='struct sldns_buffer' data-ref="sldns_buffer" data-ref-filename="sldns_buffer">sldns_buffer</a>* <dfn class="local col6 decl" id="1016buf" title='buf' data-type='sldns_buffer *' data-ref="1016buf" data-ref-filename="1016buf">buf</dfn>)</td></tr>
<tr><th id="4036">4036</th><td>{</td></tr>
<tr><th id="4037">4037</th><td>	<em>int</em> <dfn class="local col7 decl" id="1017readsome" title='readsome' data-type='int' data-ref="1017readsome" data-ref-filename="1017readsome">readsome</dfn> = <var>0</var>;</td></tr>
<tr><th id="4038">4038</th><td>	<b>while</b>(*<a class="local col4 ref" href="#1014chunk" title='chunk' data-ref="1014chunk" data-ref-filename="1014chunk">chunk</a>) {</td></tr>
<tr><th id="4039">4039</th><td>		<i>/* more text in this chunk? */</i></td></tr>
<tr><th id="4040">4040</th><td>		<b>if</b>(*<a class="local col5 ref" href="#1015chunk_pos" title='chunk_pos' data-ref="1015chunk_pos" data-ref-filename="1015chunk_pos">chunk_pos</a> &lt; (*<a class="local col4 ref" href="#1014chunk" title='chunk' data-ref="1014chunk" data-ref-filename="1014chunk">chunk</a>)-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::len" title='auth_chunk::len' data-ref="auth_chunk::len" data-ref-filename="auth_chunk..len">len</a>) {</td></tr>
<tr><th id="4041">4041</th><td>			<a class="local col7 ref" href="#1017readsome" title='readsome' data-ref="1017readsome" data-ref-filename="1017readsome">readsome</a> = <var>1</var>;</td></tr>
<tr><th id="4042">4042</th><td>			<b>while</b>(*<a class="local col5 ref" href="#1015chunk_pos" title='chunk_pos' data-ref="1015chunk_pos" data-ref-filename="1015chunk_pos">chunk_pos</a> &lt; (*<a class="local col4 ref" href="#1014chunk" title='chunk' data-ref="1014chunk" data-ref-filename="1014chunk">chunk</a>)-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::len" title='auth_chunk::len' data-ref="auth_chunk::len" data-ref-filename="auth_chunk..len">len</a>) {</td></tr>
<tr><th id="4043">4043</th><td>				<em>char</em> <dfn class="local col8 decl" id="1018c" title='c' data-type='char' data-ref="1018c" data-ref-filename="1018c">c</dfn> = (<em>char</em>)((*<a class="local col4 ref" href="#1014chunk" title='chunk' data-ref="1014chunk" data-ref-filename="1014chunk">chunk</a>)-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::data" title='auth_chunk::data' data-ref="auth_chunk::data" data-ref-filename="auth_chunk..data">data</a>[*<a class="local col5 ref" href="#1015chunk_pos" title='chunk_pos' data-ref="1015chunk_pos" data-ref-filename="1015chunk_pos">chunk_pos</a>]);</td></tr>
<tr><th id="4044">4044</th><td>				(*<a class="local col5 ref" href="#1015chunk_pos" title='chunk_pos' data-ref="1015chunk_pos" data-ref-filename="1015chunk_pos">chunk_pos</a>)++;</td></tr>
<tr><th id="4045">4045</th><td>				<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_remaining" title='sldns_buffer_remaining' data-ref="sldns_buffer_remaining" data-ref-filename="sldns_buffer_remaining">sldns_buffer_remaining</a>(<a class="local col6 ref" href="#1016buf" title='buf' data-ref="1016buf" data-ref-filename="1016buf">buf</a>) &lt; <var>2</var>) {</td></tr>
<tr><th id="4046">4046</th><td>					<i>/* buffer too short */</i></td></tr>
<tr><th id="4047">4047</th><td>					<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"http chunkline, "</q></td></tr>
<tr><th id="4048">4048</th><td>						<q>"line too long"</q>);</td></tr>
<tr><th id="4049">4049</th><td>					<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4050">4050</th><td>				}</td></tr>
<tr><th id="4051">4051</th><td>				<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_write_u8" title='sldns_buffer_write_u8' data-ref="sldns_buffer_write_u8" data-ref-filename="sldns_buffer_write_u8">sldns_buffer_write_u8</a>(<a class="local col6 ref" href="#1016buf" title='buf' data-ref="1016buf" data-ref-filename="1016buf">buf</a>, (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>)<a class="local col8 ref" href="#1018c" title='c' data-ref="1018c" data-ref-filename="1018c">c</a>);</td></tr>
<tr><th id="4052">4052</th><td>				<b>if</b>(<a class="local col8 ref" href="#1018c" title='c' data-ref="1018c" data-ref-filename="1018c">c</a> == <kbd>'\n'</kbd>) {</td></tr>
<tr><th id="4053">4053</th><td>					<i>/* we are done */</i></td></tr>
<tr><th id="4054">4054</th><td>					<b>return</b> <var>1</var>;</td></tr>
<tr><th id="4055">4055</th><td>				}</td></tr>
<tr><th id="4056">4056</th><td>			}</td></tr>
<tr><th id="4057">4057</th><td>		}</td></tr>
<tr><th id="4058">4058</th><td>		<i>/* move to next chunk */</i></td></tr>
<tr><th id="4059">4059</th><td>		*<a class="local col4 ref" href="#1014chunk" title='chunk' data-ref="1014chunk" data-ref-filename="1014chunk">chunk</a> = (*<a class="local col4 ref" href="#1014chunk" title='chunk' data-ref="1014chunk" data-ref-filename="1014chunk">chunk</a>)-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::next" title='auth_chunk::next' data-ref="auth_chunk::next" data-ref-filename="auth_chunk..next">next</a>;</td></tr>
<tr><th id="4060">4060</th><td>		*<a class="local col5 ref" href="#1015chunk_pos" title='chunk_pos' data-ref="1015chunk_pos" data-ref-filename="1015chunk_pos">chunk_pos</a> = <var>0</var>;</td></tr>
<tr><th id="4061">4061</th><td>	}</td></tr>
<tr><th id="4062">4062</th><td>	<i>/* no more text */</i></td></tr>
<tr><th id="4063">4063</th><td>	<b>if</b>(<a class="local col7 ref" href="#1017readsome" title='readsome' data-ref="1017readsome" data-ref-filename="1017readsome">readsome</a>) <b>return</b> <var>1</var>;</td></tr>
<tr><th id="4064">4064</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4065">4065</th><td>}</td></tr>
<tr><th id="4066">4066</th><td></td></tr>
<tr><th id="4067">4067</th><td><i class="doc" data-doc="chunkline_count_parens">/** count number of open and closed parenthesis in a chunkline */</i></td></tr>
<tr><th id="4068">4068</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="4069">4069</th><td><dfn class="tu decl def fn" id="chunkline_count_parens" title='chunkline_count_parens' data-type='int chunkline_count_parens(sldns_buffer * buf, size_t start)' data-ref="chunkline_count_parens" data-ref-filename="chunkline_count_parens">chunkline_count_parens</dfn>(<a class="typedef" href="../sldns/sbuffer.h.html#sldns_buffer" title='sldns_buffer' data-type='struct sldns_buffer' data-ref="sldns_buffer" data-ref-filename="sldns_buffer">sldns_buffer</a>* <dfn class="local col9 decl" id="1019buf" title='buf' data-type='sldns_buffer *' data-ref="1019buf" data-ref-filename="1019buf">buf</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col0 decl" id="1020start" title='start' data-type='size_t' data-ref="1020start" data-ref-filename="1020start">start</dfn>)</td></tr>
<tr><th id="4070">4070</th><td>{</td></tr>
<tr><th id="4071">4071</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col1 decl" id="1021end" title='end' data-type='size_t' data-ref="1021end" data-ref-filename="1021end">end</dfn> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_position" title='sldns_buffer_position' data-ref="sldns_buffer_position" data-ref-filename="sldns_buffer_position">sldns_buffer_position</a>(<a class="local col9 ref" href="#1019buf" title='buf' data-ref="1019buf" data-ref-filename="1019buf">buf</a>);</td></tr>
<tr><th id="4072">4072</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col2 decl" id="1022i" title='i' data-type='size_t' data-ref="1022i" data-ref-filename="1022i">i</dfn>;</td></tr>
<tr><th id="4073">4073</th><td>	<em>int</em> <dfn class="local col3 decl" id="1023count" title='count' data-type='int' data-ref="1023count" data-ref-filename="1023count">count</dfn> = <var>0</var>;</td></tr>
<tr><th id="4074">4074</th><td>	<em>int</em> <dfn class="local col4 decl" id="1024squote" title='squote' data-type='int' data-ref="1024squote" data-ref-filename="1024squote">squote</dfn> = <var>0</var>, <dfn class="local col5 decl" id="1025dquote" title='dquote' data-type='int' data-ref="1025dquote" data-ref-filename="1025dquote">dquote</dfn> = <var>0</var>;</td></tr>
<tr><th id="4075">4075</th><td>	<b>for</b>(<a class="local col2 ref" href="#1022i" title='i' data-ref="1022i" data-ref-filename="1022i">i</a>=<a class="local col0 ref" href="#1020start" title='start' data-ref="1020start" data-ref-filename="1020start">start</a>; <a class="local col2 ref" href="#1022i" title='i' data-ref="1022i" data-ref-filename="1022i">i</a>&lt;<a class="local col1 ref" href="#1021end" title='end' data-ref="1021end" data-ref-filename="1021end">end</a>; <a class="local col2 ref" href="#1022i" title='i' data-ref="1022i" data-ref-filename="1022i">i</a>++) {</td></tr>
<tr><th id="4076">4076</th><td>		<em>char</em> <dfn class="local col6 decl" id="1026c" title='c' data-type='char' data-ref="1026c" data-ref-filename="1026c">c</dfn> = (<em>char</em>)<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u8_at" title='sldns_buffer_read_u8_at' data-ref="sldns_buffer_read_u8_at" data-ref-filename="sldns_buffer_read_u8_at">sldns_buffer_read_u8_at</a>(<a class="local col9 ref" href="#1019buf" title='buf' data-ref="1019buf" data-ref-filename="1019buf">buf</a>, <a class="local col2 ref" href="#1022i" title='i' data-ref="1022i" data-ref-filename="1022i">i</a>);</td></tr>
<tr><th id="4077">4077</th><td>		<b>if</b>(<a class="local col4 ref" href="#1024squote" title='squote' data-ref="1024squote" data-ref-filename="1024squote">squote</a> &amp;&amp; <a class="local col6 ref" href="#1026c" title='c' data-ref="1026c" data-ref-filename="1026c">c</a> != <kbd>'\''</kbd>) <b>continue</b>;</td></tr>
<tr><th id="4078">4078</th><td>		<b>if</b>(<a class="local col5 ref" href="#1025dquote" title='dquote' data-ref="1025dquote" data-ref-filename="1025dquote">dquote</a> &amp;&amp; <a class="local col6 ref" href="#1026c" title='c' data-ref="1026c" data-ref-filename="1026c">c</a> != <kbd>'"'</kbd>) <b>continue</b>;</td></tr>
<tr><th id="4079">4079</th><td>		<b>if</b>(<a class="local col6 ref" href="#1026c" title='c' data-ref="1026c" data-ref-filename="1026c">c</a> == <kbd>'"'</kbd>)</td></tr>
<tr><th id="4080">4080</th><td>			<a class="local col5 ref" href="#1025dquote" title='dquote' data-ref="1025dquote" data-ref-filename="1025dquote">dquote</a> = !<a class="local col5 ref" href="#1025dquote" title='dquote' data-ref="1025dquote" data-ref-filename="1025dquote">dquote</a>; <i>/* skip quoted part */</i></td></tr>
<tr><th id="4081">4081</th><td>		<b>else</b> <b>if</b>(<a class="local col6 ref" href="#1026c" title='c' data-ref="1026c" data-ref-filename="1026c">c</a> == <kbd>'\''</kbd>)</td></tr>
<tr><th id="4082">4082</th><td>			<a class="local col4 ref" href="#1024squote" title='squote' data-ref="1024squote" data-ref-filename="1024squote">squote</a> = !<a class="local col4 ref" href="#1024squote" title='squote' data-ref="1024squote" data-ref-filename="1024squote">squote</a>; <i>/* skip quoted part */</i></td></tr>
<tr><th id="4083">4083</th><td>		<b>else</b> <b>if</b>(<a class="local col6 ref" href="#1026c" title='c' data-ref="1026c" data-ref-filename="1026c">c</a> == <kbd>'('</kbd>)</td></tr>
<tr><th id="4084">4084</th><td>			<a class="local col3 ref" href="#1023count" title='count' data-ref="1023count" data-ref-filename="1023count">count</a> ++;</td></tr>
<tr><th id="4085">4085</th><td>		<b>else</b> <b>if</b>(<a class="local col6 ref" href="#1026c" title='c' data-ref="1026c" data-ref-filename="1026c">c</a> == <kbd>')'</kbd>)</td></tr>
<tr><th id="4086">4086</th><td>			<a class="local col3 ref" href="#1023count" title='count' data-ref="1023count" data-ref-filename="1023count">count</a> --;</td></tr>
<tr><th id="4087">4087</th><td>		<b>else</b> <b>if</b>(<a class="local col6 ref" href="#1026c" title='c' data-ref="1026c" data-ref-filename="1026c">c</a> == <kbd>';'</kbd>) {</td></tr>
<tr><th id="4088">4088</th><td>			<i>/* rest is a comment */</i></td></tr>
<tr><th id="4089">4089</th><td>			<b>return</b> <a class="local col3 ref" href="#1023count" title='count' data-ref="1023count" data-ref-filename="1023count">count</a>;</td></tr>
<tr><th id="4090">4090</th><td>		}</td></tr>
<tr><th id="4091">4091</th><td>	}</td></tr>
<tr><th id="4092">4092</th><td>	<b>return</b> <a class="local col3 ref" href="#1023count" title='count' data-ref="1023count" data-ref-filename="1023count">count</a>;</td></tr>
<tr><th id="4093">4093</th><td>}</td></tr>
<tr><th id="4094">4094</th><td></td></tr>
<tr><th id="4095">4095</th><td><i class="doc" data-doc="chunkline_remove_trailcomment">/** remove trailing ;... comment from a line in the chunkline buffer */</i></td></tr>
<tr><th id="4096">4096</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="4097">4097</th><td><dfn class="tu decl def fn" id="chunkline_remove_trailcomment" title='chunkline_remove_trailcomment' data-type='void chunkline_remove_trailcomment(sldns_buffer * buf, size_t start)' data-ref="chunkline_remove_trailcomment" data-ref-filename="chunkline_remove_trailcomment">chunkline_remove_trailcomment</dfn>(<a class="typedef" href="../sldns/sbuffer.h.html#sldns_buffer" title='sldns_buffer' data-type='struct sldns_buffer' data-ref="sldns_buffer" data-ref-filename="sldns_buffer">sldns_buffer</a>* <dfn class="local col7 decl" id="1027buf" title='buf' data-type='sldns_buffer *' data-ref="1027buf" data-ref-filename="1027buf">buf</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col8 decl" id="1028start" title='start' data-type='size_t' data-ref="1028start" data-ref-filename="1028start">start</dfn>)</td></tr>
<tr><th id="4098">4098</th><td>{</td></tr>
<tr><th id="4099">4099</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col9 decl" id="1029end" title='end' data-type='size_t' data-ref="1029end" data-ref-filename="1029end">end</dfn> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_position" title='sldns_buffer_position' data-ref="sldns_buffer_position" data-ref-filename="sldns_buffer_position">sldns_buffer_position</a>(<a class="local col7 ref" href="#1027buf" title='buf' data-ref="1027buf" data-ref-filename="1027buf">buf</a>);</td></tr>
<tr><th id="4100">4100</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col0 decl" id="1030i" title='i' data-type='size_t' data-ref="1030i" data-ref-filename="1030i">i</dfn>;</td></tr>
<tr><th id="4101">4101</th><td>	<em>int</em> <dfn class="local col1 decl" id="1031squote" title='squote' data-type='int' data-ref="1031squote" data-ref-filename="1031squote">squote</dfn> = <var>0</var>, <dfn class="local col2 decl" id="1032dquote" title='dquote' data-type='int' data-ref="1032dquote" data-ref-filename="1032dquote">dquote</dfn> = <var>0</var>;</td></tr>
<tr><th id="4102">4102</th><td>	<b>for</b>(<a class="local col0 ref" href="#1030i" title='i' data-ref="1030i" data-ref-filename="1030i">i</a>=<a class="local col8 ref" href="#1028start" title='start' data-ref="1028start" data-ref-filename="1028start">start</a>; <a class="local col0 ref" href="#1030i" title='i' data-ref="1030i" data-ref-filename="1030i">i</a>&lt;<a class="local col9 ref" href="#1029end" title='end' data-ref="1029end" data-ref-filename="1029end">end</a>; <a class="local col0 ref" href="#1030i" title='i' data-ref="1030i" data-ref-filename="1030i">i</a>++) {</td></tr>
<tr><th id="4103">4103</th><td>		<em>char</em> <dfn class="local col3 decl" id="1033c" title='c' data-type='char' data-ref="1033c" data-ref-filename="1033c">c</dfn> = (<em>char</em>)<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u8_at" title='sldns_buffer_read_u8_at' data-ref="sldns_buffer_read_u8_at" data-ref-filename="sldns_buffer_read_u8_at">sldns_buffer_read_u8_at</a>(<a class="local col7 ref" href="#1027buf" title='buf' data-ref="1027buf" data-ref-filename="1027buf">buf</a>, <a class="local col0 ref" href="#1030i" title='i' data-ref="1030i" data-ref-filename="1030i">i</a>);</td></tr>
<tr><th id="4104">4104</th><td>		<b>if</b>(<a class="local col1 ref" href="#1031squote" title='squote' data-ref="1031squote" data-ref-filename="1031squote">squote</a> &amp;&amp; <a class="local col3 ref" href="#1033c" title='c' data-ref="1033c" data-ref-filename="1033c">c</a> != <kbd>'\''</kbd>) <b>continue</b>;</td></tr>
<tr><th id="4105">4105</th><td>		<b>if</b>(<a class="local col2 ref" href="#1032dquote" title='dquote' data-ref="1032dquote" data-ref-filename="1032dquote">dquote</a> &amp;&amp; <a class="local col3 ref" href="#1033c" title='c' data-ref="1033c" data-ref-filename="1033c">c</a> != <kbd>'"'</kbd>) <b>continue</b>;</td></tr>
<tr><th id="4106">4106</th><td>		<b>if</b>(<a class="local col3 ref" href="#1033c" title='c' data-ref="1033c" data-ref-filename="1033c">c</a> == <kbd>'"'</kbd>)</td></tr>
<tr><th id="4107">4107</th><td>			<a class="local col2 ref" href="#1032dquote" title='dquote' data-ref="1032dquote" data-ref-filename="1032dquote">dquote</a> = !<a class="local col2 ref" href="#1032dquote" title='dquote' data-ref="1032dquote" data-ref-filename="1032dquote">dquote</a>; <i>/* skip quoted part */</i></td></tr>
<tr><th id="4108">4108</th><td>		<b>else</b> <b>if</b>(<a class="local col3 ref" href="#1033c" title='c' data-ref="1033c" data-ref-filename="1033c">c</a> == <kbd>'\''</kbd>)</td></tr>
<tr><th id="4109">4109</th><td>			<a class="local col1 ref" href="#1031squote" title='squote' data-ref="1031squote" data-ref-filename="1031squote">squote</a> = !<a class="local col1 ref" href="#1031squote" title='squote' data-ref="1031squote" data-ref-filename="1031squote">squote</a>; <i>/* skip quoted part */</i></td></tr>
<tr><th id="4110">4110</th><td>		<b>else</b> <b>if</b>(<a class="local col3 ref" href="#1033c" title='c' data-ref="1033c" data-ref-filename="1033c">c</a> == <kbd>';'</kbd>) {</td></tr>
<tr><th id="4111">4111</th><td>			<i>/* rest is a comment */</i></td></tr>
<tr><th id="4112">4112</th><td>			<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_set_position" title='sldns_buffer_set_position' data-ref="sldns_buffer_set_position" data-ref-filename="sldns_buffer_set_position">sldns_buffer_set_position</a>(<a class="local col7 ref" href="#1027buf" title='buf' data-ref="1027buf" data-ref-filename="1027buf">buf</a>, <a class="local col0 ref" href="#1030i" title='i' data-ref="1030i" data-ref-filename="1030i">i</a>);</td></tr>
<tr><th id="4113">4113</th><td>			<b>return</b>;</td></tr>
<tr><th id="4114">4114</th><td>		}</td></tr>
<tr><th id="4115">4115</th><td>	}</td></tr>
<tr><th id="4116">4116</th><td>	<i>/* nothing to remove */</i></td></tr>
<tr><th id="4117">4117</th><td>}</td></tr>
<tr><th id="4118">4118</th><td></td></tr>
<tr><th id="4119">4119</th><td><i class="doc" data-doc="chunkline_is_comment_line_or_empty">/** see if a chunkline is a comment line (or empty line) */</i></td></tr>
<tr><th id="4120">4120</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="4121">4121</th><td><dfn class="tu decl def fn" id="chunkline_is_comment_line_or_empty" title='chunkline_is_comment_line_or_empty' data-type='int chunkline_is_comment_line_or_empty(sldns_buffer * buf)' data-ref="chunkline_is_comment_line_or_empty" data-ref-filename="chunkline_is_comment_line_or_empty">chunkline_is_comment_line_or_empty</dfn>(<a class="typedef" href="../sldns/sbuffer.h.html#sldns_buffer" title='sldns_buffer' data-type='struct sldns_buffer' data-ref="sldns_buffer" data-ref-filename="sldns_buffer">sldns_buffer</a>* <dfn class="local col4 decl" id="1034buf" title='buf' data-type='sldns_buffer *' data-ref="1034buf" data-ref-filename="1034buf">buf</dfn>)</td></tr>
<tr><th id="4122">4122</th><td>{</td></tr>
<tr><th id="4123">4123</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col5 decl" id="1035i" title='i' data-type='size_t' data-ref="1035i" data-ref-filename="1035i">i</dfn>, <dfn class="local col6 decl" id="1036end" title='end' data-type='size_t' data-ref="1036end" data-ref-filename="1036end">end</dfn> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_limit" title='sldns_buffer_limit' data-ref="sldns_buffer_limit" data-ref-filename="sldns_buffer_limit">sldns_buffer_limit</a>(<a class="local col4 ref" href="#1034buf" title='buf' data-ref="1034buf" data-ref-filename="1034buf">buf</a>);</td></tr>
<tr><th id="4124">4124</th><td>	<b>for</b>(<a class="local col5 ref" href="#1035i" title='i' data-ref="1035i" data-ref-filename="1035i">i</a>=<var>0</var>; <a class="local col5 ref" href="#1035i" title='i' data-ref="1035i" data-ref-filename="1035i">i</a>&lt;<a class="local col6 ref" href="#1036end" title='end' data-ref="1036end" data-ref-filename="1036end">end</a>; <a class="local col5 ref" href="#1035i" title='i' data-ref="1035i" data-ref-filename="1035i">i</a>++) {</td></tr>
<tr><th id="4125">4125</th><td>		<em>char</em> <dfn class="local col7 decl" id="1037c" title='c' data-type='char' data-ref="1037c" data-ref-filename="1037c">c</dfn> = (<em>char</em>)<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u8_at" title='sldns_buffer_read_u8_at' data-ref="sldns_buffer_read_u8_at" data-ref-filename="sldns_buffer_read_u8_at">sldns_buffer_read_u8_at</a>(<a class="local col4 ref" href="#1034buf" title='buf' data-ref="1034buf" data-ref-filename="1034buf">buf</a>, <a class="local col5 ref" href="#1035i" title='i' data-ref="1035i" data-ref-filename="1035i">i</a>);</td></tr>
<tr><th id="4126">4126</th><td>		<b>if</b>(<a class="local col7 ref" href="#1037c" title='c' data-ref="1037c" data-ref-filename="1037c">c</a> == <kbd>';'</kbd>)</td></tr>
<tr><th id="4127">4127</th><td>			<b>return</b> <var>1</var>; <i>/* comment */</i></td></tr>
<tr><th id="4128">4128</th><td>		<b>else</b> <b>if</b>(<a class="local col7 ref" href="#1037c" title='c' data-ref="1037c" data-ref-filename="1037c">c</a> != <kbd>' '</kbd> &amp;&amp; <a class="local col7 ref" href="#1037c" title='c' data-ref="1037c" data-ref-filename="1037c">c</a> != <kbd>'\t'</kbd> &amp;&amp; <a class="local col7 ref" href="#1037c" title='c' data-ref="1037c" data-ref-filename="1037c">c</a> != <kbd>'\r'</kbd> &amp;&amp; <a class="local col7 ref" href="#1037c" title='c' data-ref="1037c" data-ref-filename="1037c">c</a> != <kbd>'\n'</kbd>)</td></tr>
<tr><th id="4129">4129</th><td>			<b>return</b> <var>0</var>; <i>/* not a comment */</i></td></tr>
<tr><th id="4130">4130</th><td>	}</td></tr>
<tr><th id="4131">4131</th><td>	<b>return</b> <var>1</var>; <i>/* empty */</i></td></tr>
<tr><th id="4132">4132</th><td>}</td></tr>
<tr><th id="4133">4133</th><td></td></tr>
<tr><th id="4134">4134</th><td><i class="doc" data-doc="chunkline_get_line_collated">/** find a line with ( ) collated */</i></td></tr>
<tr><th id="4135">4135</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="4136">4136</th><td><dfn class="tu decl def fn" id="chunkline_get_line_collated" title='chunkline_get_line_collated' data-type='int chunkline_get_line_collated(struct auth_chunk ** chunk, size_t * chunk_pos, sldns_buffer * buf)' data-ref="chunkline_get_line_collated" data-ref-filename="chunkline_get_line_collated">chunkline_get_line_collated</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_chunk" title='auth_chunk' data-ref="auth_chunk" data-ref-filename="auth_chunk">auth_chunk</a>** <dfn class="local col8 decl" id="1038chunk" title='chunk' data-type='struct auth_chunk **' data-ref="1038chunk" data-ref-filename="1038chunk">chunk</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>* <dfn class="local col9 decl" id="1039chunk_pos" title='chunk_pos' data-type='size_t *' data-ref="1039chunk_pos" data-ref-filename="1039chunk_pos">chunk_pos</dfn>,</td></tr>
<tr><th id="4137">4137</th><td>	<a class="typedef" href="../sldns/sbuffer.h.html#sldns_buffer" title='sldns_buffer' data-type='struct sldns_buffer' data-ref="sldns_buffer" data-ref-filename="sldns_buffer">sldns_buffer</a>* <dfn class="local col0 decl" id="1040buf" title='buf' data-type='sldns_buffer *' data-ref="1040buf" data-ref-filename="1040buf">buf</dfn>)</td></tr>
<tr><th id="4138">4138</th><td>{</td></tr>
<tr><th id="4139">4139</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col1 decl" id="1041pos" title='pos' data-type='size_t' data-ref="1041pos" data-ref-filename="1041pos">pos</dfn>;</td></tr>
<tr><th id="4140">4140</th><td>	<em>int</em> <dfn class="local col2 decl" id="1042parens" title='parens' data-type='int' data-ref="1042parens" data-ref-filename="1042parens">parens</dfn> = <var>0</var>;</td></tr>
<tr><th id="4141">4141</th><td>	<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_clear" title='sldns_buffer_clear' data-ref="sldns_buffer_clear" data-ref-filename="sldns_buffer_clear">sldns_buffer_clear</a>(<a class="local col0 ref" href="#1040buf" title='buf' data-ref="1040buf" data-ref-filename="1040buf">buf</a>);</td></tr>
<tr><th id="4142">4142</th><td>	<a class="local col1 ref" href="#1041pos" title='pos' data-ref="1041pos" data-ref-filename="1041pos">pos</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_position" title='sldns_buffer_position' data-ref="sldns_buffer_position" data-ref-filename="sldns_buffer_position">sldns_buffer_position</a>(<a class="local col0 ref" href="#1040buf" title='buf' data-ref="1040buf" data-ref-filename="1040buf">buf</a>);</td></tr>
<tr><th id="4143">4143</th><td>	<b>if</b>(!<a class="tu ref fn" href="#chunkline_get_line" title='chunkline_get_line' data-use='c' data-ref="chunkline_get_line" data-ref-filename="chunkline_get_line">chunkline_get_line</a>(<a class="local col8 ref" href="#1038chunk" title='chunk' data-ref="1038chunk" data-ref-filename="1038chunk">chunk</a>, <a class="local col9 ref" href="#1039chunk_pos" title='chunk_pos' data-ref="1039chunk_pos" data-ref-filename="1039chunk_pos">chunk_pos</a>, <a class="local col0 ref" href="#1040buf" title='buf' data-ref="1040buf" data-ref-filename="1040buf">buf</a>)) {</td></tr>
<tr><th id="4144">4144</th><td>		<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_position" title='sldns_buffer_position' data-ref="sldns_buffer_position" data-ref-filename="sldns_buffer_position">sldns_buffer_position</a>(<a class="local col0 ref" href="#1040buf" title='buf' data-ref="1040buf" data-ref-filename="1040buf">buf</a>) &lt; <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_limit" title='sldns_buffer_limit' data-ref="sldns_buffer_limit" data-ref-filename="sldns_buffer_limit">sldns_buffer_limit</a>(<a class="local col0 ref" href="#1040buf" title='buf' data-ref="1040buf" data-ref-filename="1040buf">buf</a>))</td></tr>
<tr><th id="4145">4145</th><td>			<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_write_u8_at" title='sldns_buffer_write_u8_at' data-ref="sldns_buffer_write_u8_at" data-ref-filename="sldns_buffer_write_u8_at">sldns_buffer_write_u8_at</a>(<a class="local col0 ref" href="#1040buf" title='buf' data-ref="1040buf" data-ref-filename="1040buf">buf</a>, <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_position" title='sldns_buffer_position' data-ref="sldns_buffer_position" data-ref-filename="sldns_buffer_position">sldns_buffer_position</a>(<a class="local col0 ref" href="#1040buf" title='buf' data-ref="1040buf" data-ref-filename="1040buf">buf</a>), <var>0</var>);</td></tr>
<tr><th id="4146">4146</th><td>		<b>else</b> <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_write_u8_at" title='sldns_buffer_write_u8_at' data-ref="sldns_buffer_write_u8_at" data-ref-filename="sldns_buffer_write_u8_at">sldns_buffer_write_u8_at</a>(<a class="local col0 ref" href="#1040buf" title='buf' data-ref="1040buf" data-ref-filename="1040buf">buf</a>, <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_position" title='sldns_buffer_position' data-ref="sldns_buffer_position" data-ref-filename="sldns_buffer_position">sldns_buffer_position</a>(<a class="local col0 ref" href="#1040buf" title='buf' data-ref="1040buf" data-ref-filename="1040buf">buf</a>)-<var>1</var>, <var>0</var>);</td></tr>
<tr><th id="4147">4147</th><td>		<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_flip" title='sldns_buffer_flip' data-ref="sldns_buffer_flip" data-ref-filename="sldns_buffer_flip">sldns_buffer_flip</a>(<a class="local col0 ref" href="#1040buf" title='buf' data-ref="1040buf" data-ref-filename="1040buf">buf</a>);</td></tr>
<tr><th id="4148">4148</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4149">4149</th><td>	}</td></tr>
<tr><th id="4150">4150</th><td>	<a class="local col2 ref" href="#1042parens" title='parens' data-ref="1042parens" data-ref-filename="1042parens">parens</a> += <a class="tu ref fn" href="#chunkline_count_parens" title='chunkline_count_parens' data-use='c' data-ref="chunkline_count_parens" data-ref-filename="chunkline_count_parens">chunkline_count_parens</a>(<a class="local col0 ref" href="#1040buf" title='buf' data-ref="1040buf" data-ref-filename="1040buf">buf</a>, <a class="local col1 ref" href="#1041pos" title='pos' data-ref="1041pos" data-ref-filename="1041pos">pos</a>);</td></tr>
<tr><th id="4151">4151</th><td>	<b>while</b>(<a class="local col2 ref" href="#1042parens" title='parens' data-ref="1042parens" data-ref-filename="1042parens">parens</a> &gt; <var>0</var>) {</td></tr>
<tr><th id="4152">4152</th><td>		<a class="tu ref fn" href="#chunkline_remove_trailcomment" title='chunkline_remove_trailcomment' data-use='c' data-ref="chunkline_remove_trailcomment" data-ref-filename="chunkline_remove_trailcomment">chunkline_remove_trailcomment</a>(<a class="local col0 ref" href="#1040buf" title='buf' data-ref="1040buf" data-ref-filename="1040buf">buf</a>, <a class="local col1 ref" href="#1041pos" title='pos' data-ref="1041pos" data-ref-filename="1041pos">pos</a>);</td></tr>
<tr><th id="4153">4153</th><td>		<a class="local col1 ref" href="#1041pos" title='pos' data-ref="1041pos" data-ref-filename="1041pos">pos</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_position" title='sldns_buffer_position' data-ref="sldns_buffer_position" data-ref-filename="sldns_buffer_position">sldns_buffer_position</a>(<a class="local col0 ref" href="#1040buf" title='buf' data-ref="1040buf" data-ref-filename="1040buf">buf</a>);</td></tr>
<tr><th id="4154">4154</th><td>		<b>if</b>(!<a class="tu ref fn" href="#chunkline_get_line" title='chunkline_get_line' data-use='c' data-ref="chunkline_get_line" data-ref-filename="chunkline_get_line">chunkline_get_line</a>(<a class="local col8 ref" href="#1038chunk" title='chunk' data-ref="1038chunk" data-ref-filename="1038chunk">chunk</a>, <a class="local col9 ref" href="#1039chunk_pos" title='chunk_pos' data-ref="1039chunk_pos" data-ref-filename="1039chunk_pos">chunk_pos</a>, <a class="local col0 ref" href="#1040buf" title='buf' data-ref="1040buf" data-ref-filename="1040buf">buf</a>)) {</td></tr>
<tr><th id="4155">4155</th><td>			<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_position" title='sldns_buffer_position' data-ref="sldns_buffer_position" data-ref-filename="sldns_buffer_position">sldns_buffer_position</a>(<a class="local col0 ref" href="#1040buf" title='buf' data-ref="1040buf" data-ref-filename="1040buf">buf</a>) &lt; <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_limit" title='sldns_buffer_limit' data-ref="sldns_buffer_limit" data-ref-filename="sldns_buffer_limit">sldns_buffer_limit</a>(<a class="local col0 ref" href="#1040buf" title='buf' data-ref="1040buf" data-ref-filename="1040buf">buf</a>))</td></tr>
<tr><th id="4156">4156</th><td>				<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_write_u8_at" title='sldns_buffer_write_u8_at' data-ref="sldns_buffer_write_u8_at" data-ref-filename="sldns_buffer_write_u8_at">sldns_buffer_write_u8_at</a>(<a class="local col0 ref" href="#1040buf" title='buf' data-ref="1040buf" data-ref-filename="1040buf">buf</a>, <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_position" title='sldns_buffer_position' data-ref="sldns_buffer_position" data-ref-filename="sldns_buffer_position">sldns_buffer_position</a>(<a class="local col0 ref" href="#1040buf" title='buf' data-ref="1040buf" data-ref-filename="1040buf">buf</a>), <var>0</var>);</td></tr>
<tr><th id="4157">4157</th><td>			<b>else</b> <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_write_u8_at" title='sldns_buffer_write_u8_at' data-ref="sldns_buffer_write_u8_at" data-ref-filename="sldns_buffer_write_u8_at">sldns_buffer_write_u8_at</a>(<a class="local col0 ref" href="#1040buf" title='buf' data-ref="1040buf" data-ref-filename="1040buf">buf</a>, <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_position" title='sldns_buffer_position' data-ref="sldns_buffer_position" data-ref-filename="sldns_buffer_position">sldns_buffer_position</a>(<a class="local col0 ref" href="#1040buf" title='buf' data-ref="1040buf" data-ref-filename="1040buf">buf</a>)-<var>1</var>, <var>0</var>);</td></tr>
<tr><th id="4158">4158</th><td>			<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_flip" title='sldns_buffer_flip' data-ref="sldns_buffer_flip" data-ref-filename="sldns_buffer_flip">sldns_buffer_flip</a>(<a class="local col0 ref" href="#1040buf" title='buf' data-ref="1040buf" data-ref-filename="1040buf">buf</a>);</td></tr>
<tr><th id="4159">4159</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4160">4160</th><td>		}</td></tr>
<tr><th id="4161">4161</th><td>		<a class="local col2 ref" href="#1042parens" title='parens' data-ref="1042parens" data-ref-filename="1042parens">parens</a> += <a class="tu ref fn" href="#chunkline_count_parens" title='chunkline_count_parens' data-use='c' data-ref="chunkline_count_parens" data-ref-filename="chunkline_count_parens">chunkline_count_parens</a>(<a class="local col0 ref" href="#1040buf" title='buf' data-ref="1040buf" data-ref-filename="1040buf">buf</a>, <a class="local col1 ref" href="#1041pos" title='pos' data-ref="1041pos" data-ref-filename="1041pos">pos</a>);</td></tr>
<tr><th id="4162">4162</th><td>	}</td></tr>
<tr><th id="4163">4163</th><td></td></tr>
<tr><th id="4164">4164</th><td>	<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_remaining" title='sldns_buffer_remaining' data-ref="sldns_buffer_remaining" data-ref-filename="sldns_buffer_remaining">sldns_buffer_remaining</a>(<a class="local col0 ref" href="#1040buf" title='buf' data-ref="1040buf" data-ref-filename="1040buf">buf</a>) &lt; <var>1</var>) {</td></tr>
<tr><th id="4165">4165</th><td>		<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"http chunkline: "</q></td></tr>
<tr><th id="4166">4166</th><td>			<q>"line too long"</q>);</td></tr>
<tr><th id="4167">4167</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4168">4168</th><td>	}</td></tr>
<tr><th id="4169">4169</th><td>	<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_write_u8_at" title='sldns_buffer_write_u8_at' data-ref="sldns_buffer_write_u8_at" data-ref-filename="sldns_buffer_write_u8_at">sldns_buffer_write_u8_at</a>(<a class="local col0 ref" href="#1040buf" title='buf' data-ref="1040buf" data-ref-filename="1040buf">buf</a>, <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_position" title='sldns_buffer_position' data-ref="sldns_buffer_position" data-ref-filename="sldns_buffer_position">sldns_buffer_position</a>(<a class="local col0 ref" href="#1040buf" title='buf' data-ref="1040buf" data-ref-filename="1040buf">buf</a>), <var>0</var>);</td></tr>
<tr><th id="4170">4170</th><td>	<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_flip" title='sldns_buffer_flip' data-ref="sldns_buffer_flip" data-ref-filename="sldns_buffer_flip">sldns_buffer_flip</a>(<a class="local col0 ref" href="#1040buf" title='buf' data-ref="1040buf" data-ref-filename="1040buf">buf</a>);</td></tr>
<tr><th id="4171">4171</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="4172">4172</th><td>}</td></tr>
<tr><th id="4173">4173</th><td></td></tr>
<tr><th id="4174">4174</th><td><i class="doc" data-doc="http_parse_origin">/** process $ORIGIN for http */</i></td></tr>
<tr><th id="4175">4175</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="4176">4176</th><td><dfn class="tu decl def fn" id="http_parse_origin" title='http_parse_origin' data-type='int http_parse_origin(sldns_buffer * buf, struct sldns_file_parse_state * pstate)' data-ref="http_parse_origin" data-ref-filename="http_parse_origin">http_parse_origin</dfn>(<a class="typedef" href="../sldns/sbuffer.h.html#sldns_buffer" title='sldns_buffer' data-type='struct sldns_buffer' data-ref="sldns_buffer" data-ref-filename="sldns_buffer">sldns_buffer</a>* <dfn class="local col3 decl" id="1043buf" title='buf' data-type='sldns_buffer *' data-ref="1043buf" data-ref-filename="1043buf">buf</dfn>, <b>struct</b> <a class="type" href="../sldns/str2wire.h.html#sldns_file_parse_state" title='sldns_file_parse_state' data-ref="sldns_file_parse_state" data-ref-filename="sldns_file_parse_state">sldns_file_parse_state</a>* <dfn class="local col4 decl" id="1044pstate" title='pstate' data-type='struct sldns_file_parse_state *' data-ref="1044pstate" data-ref-filename="1044pstate">pstate</dfn>)</td></tr>
<tr><th id="4177">4177</th><td>{</td></tr>
<tr><th id="4178">4178</th><td>	<em>char</em>* <dfn class="local col5 decl" id="1045line" title='line' data-type='char *' data-ref="1045line" data-ref-filename="1045line">line</dfn> = (<em>char</em>*)<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_begin" title='sldns_buffer_begin' data-ref="sldns_buffer_begin" data-ref-filename="sldns_buffer_begin">sldns_buffer_begin</a>(<a class="local col3 ref" href="#1043buf" title='buf' data-ref="1043buf" data-ref-filename="1043buf">buf</a>);</td></tr>
<tr><th id="4179">4179</th><td>	<b>if</b>(<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strncmp" title='strncmp' data-ref="strncmp" data-ref-filename="strncmp">strncmp</a>(<a class="local col5 ref" href="#1045line" title='line' data-ref="1045line" data-ref-filename="1045line">line</a>, <q>"$ORIGIN"</q>, <var>7</var>) == <var>0</var> &amp;&amp;</td></tr>
<tr><th id="4180">4180</th><td>		<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/ctype_inline.h.html#56" title="((int)((_ctype_tab_ + 1)[((unsigned char)line[7])] &amp; 0x0040))" data-ref="_M/isspace">isspace</a>((<em>unsigned</em> <em>char</em>)<a class="local col5 ref" href="#1045line" title='line' data-ref="1045line" data-ref-filename="1045line">line</a>[<var>7</var>])) {</td></tr>
<tr><th id="4181">4181</th><td>		<em>int</em> <dfn class="local col6 decl" id="1046s" title='s' data-type='int' data-ref="1046s" data-ref-filename="1046s">s</dfn>;</td></tr>
<tr><th id="4182">4182</th><td>		<a class="local col4 ref" href="#1044pstate" title='pstate' data-ref="1044pstate" data-ref-filename="1044pstate">pstate</a>-&gt;<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::origin_len" title='sldns_file_parse_state::origin_len' data-ref="sldns_file_parse_state::origin_len" data-ref-filename="sldns_file_parse_state..origin_len">origin_len</a> = <b>sizeof</b>(<a class="local col4 ref" href="#1044pstate" title='pstate' data-ref="1044pstate" data-ref-filename="1044pstate">pstate</a>-&gt;<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::origin" title='sldns_file_parse_state::origin' data-ref="sldns_file_parse_state::origin" data-ref-filename="sldns_file_parse_state..origin">origin</a>);</td></tr>
<tr><th id="4183">4183</th><td>		<a class="local col6 ref" href="#1046s" title='s' data-ref="1046s" data-ref-filename="1046s">s</a> = <a class="ref fn" href="../sldns/str2wire.h.html#sldns_str2wire_dname_buf" title='sldns_str2wire_dname_buf' data-ref="sldns_str2wire_dname_buf" data-ref-filename="sldns_str2wire_dname_buf">sldns_str2wire_dname_buf</a>(<a class="ref fn" href="../sldns/str2wire.h.html#sldns_strip_ws" title='sldns_strip_ws' data-ref="sldns_strip_ws" data-ref-filename="sldns_strip_ws">sldns_strip_ws</a>(<a class="local col5 ref" href="#1045line" title='line' data-ref="1045line" data-ref-filename="1045line">line</a>+<var>8</var>),</td></tr>
<tr><th id="4184">4184</th><td>			<a class="local col4 ref" href="#1044pstate" title='pstate' data-ref="1044pstate" data-ref-filename="1044pstate">pstate</a>-&gt;<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::origin" title='sldns_file_parse_state::origin' data-ref="sldns_file_parse_state::origin" data-ref-filename="sldns_file_parse_state..origin">origin</a>, &amp;<a class="local col4 ref" href="#1044pstate" title='pstate' data-ref="1044pstate" data-ref-filename="1044pstate">pstate</a>-&gt;<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::origin_len" title='sldns_file_parse_state::origin_len' data-ref="sldns_file_parse_state::origin_len" data-ref-filename="sldns_file_parse_state..origin_len">origin_len</a>);</td></tr>
<tr><th id="4185">4185</th><td>		<b>if</b>(<a class="local col6 ref" href="#1046s" title='s' data-ref="1046s" data-ref-filename="1046s">s</a>) <a class="local col4 ref" href="#1044pstate" title='pstate' data-ref="1044pstate" data-ref-filename="1044pstate">pstate</a>-&gt;<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::origin_len" title='sldns_file_parse_state::origin_len' data-ref="sldns_file_parse_state::origin_len" data-ref-filename="sldns_file_parse_state..origin_len">origin_len</a> = <var>0</var>;</td></tr>
<tr><th id="4186">4186</th><td>		<b>return</b> <var>1</var>;</td></tr>
<tr><th id="4187">4187</th><td>	}</td></tr>
<tr><th id="4188">4188</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4189">4189</th><td>}</td></tr>
<tr><th id="4190">4190</th><td></td></tr>
<tr><th id="4191">4191</th><td><i class="doc" data-doc="http_parse_ttl">/** process $TTL for http */</i></td></tr>
<tr><th id="4192">4192</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="4193">4193</th><td><dfn class="tu decl def fn" id="http_parse_ttl" title='http_parse_ttl' data-type='int http_parse_ttl(sldns_buffer * buf, struct sldns_file_parse_state * pstate)' data-ref="http_parse_ttl" data-ref-filename="http_parse_ttl">http_parse_ttl</dfn>(<a class="typedef" href="../sldns/sbuffer.h.html#sldns_buffer" title='sldns_buffer' data-type='struct sldns_buffer' data-ref="sldns_buffer" data-ref-filename="sldns_buffer">sldns_buffer</a>* <dfn class="local col7 decl" id="1047buf" title='buf' data-type='sldns_buffer *' data-ref="1047buf" data-ref-filename="1047buf">buf</dfn>, <b>struct</b> <a class="type" href="../sldns/str2wire.h.html#sldns_file_parse_state" title='sldns_file_parse_state' data-ref="sldns_file_parse_state" data-ref-filename="sldns_file_parse_state">sldns_file_parse_state</a>* <dfn class="local col8 decl" id="1048pstate" title='pstate' data-type='struct sldns_file_parse_state *' data-ref="1048pstate" data-ref-filename="1048pstate">pstate</dfn>)</td></tr>
<tr><th id="4194">4194</th><td>{</td></tr>
<tr><th id="4195">4195</th><td>	<em>char</em>* <dfn class="local col9 decl" id="1049line" title='line' data-type='char *' data-ref="1049line" data-ref-filename="1049line">line</dfn> = (<em>char</em>*)<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_begin" title='sldns_buffer_begin' data-ref="sldns_buffer_begin" data-ref-filename="sldns_buffer_begin">sldns_buffer_begin</a>(<a class="local col7 ref" href="#1047buf" title='buf' data-ref="1047buf" data-ref-filename="1047buf">buf</a>);</td></tr>
<tr><th id="4196">4196</th><td>	<b>if</b>(<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strncmp" title='strncmp' data-ref="strncmp" data-ref-filename="strncmp">strncmp</a>(<a class="local col9 ref" href="#1049line" title='line' data-ref="1049line" data-ref-filename="1049line">line</a>, <q>"$TTL"</q>, <var>4</var>) == <var>0</var> &amp;&amp;</td></tr>
<tr><th id="4197">4197</th><td>		<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/ctype_inline.h.html#56" title="((int)((_ctype_tab_ + 1)[((unsigned char)line[4])] &amp; 0x0040))" data-ref="_M/isspace">isspace</a>((<em>unsigned</em> <em>char</em>)<a class="local col9 ref" href="#1049line" title='line' data-ref="1049line" data-ref-filename="1049line">line</a>[<var>4</var>])) {</td></tr>
<tr><th id="4198">4198</th><td>		<em>const</em> <em>char</em>* <dfn class="local col0 decl" id="1050end" title='end' data-type='const char *' data-ref="1050end" data-ref-filename="1050end">end</dfn> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="4199">4199</th><td>		<a class="local col8 ref" href="#1048pstate" title='pstate' data-ref="1048pstate" data-ref-filename="1048pstate">pstate</a>-&gt;<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::default_ttl" title='sldns_file_parse_state::default_ttl' data-ref="sldns_file_parse_state::default_ttl" data-ref-filename="sldns_file_parse_state..default_ttl">default_ttl</a> = <a class="ref fn" href="../sldns/parseutil.h.html#sldns_str2period" title='sldns_str2period' data-ref="sldns_str2period" data-ref-filename="sldns_str2period">sldns_str2period</a>(</td></tr>
<tr><th id="4200">4200</th><td>			<a class="ref fn" href="../sldns/str2wire.h.html#sldns_strip_ws" title='sldns_strip_ws' data-ref="sldns_strip_ws" data-ref-filename="sldns_strip_ws">sldns_strip_ws</a>(<a class="local col9 ref" href="#1049line" title='line' data-ref="1049line" data-ref-filename="1049line">line</a>+<var>5</var>), &amp;<a class="local col0 ref" href="#1050end" title='end' data-ref="1050end" data-ref-filename="1050end">end</a>);</td></tr>
<tr><th id="4201">4201</th><td>		<b>return</b> <var>1</var>;</td></tr>
<tr><th id="4202">4202</th><td>	}</td></tr>
<tr><th id="4203">4203</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4204">4204</th><td>}</td></tr>
<tr><th id="4205">4205</th><td></td></tr>
<tr><th id="4206">4206</th><td><i class="doc" data-doc="chunkline_non_comment_RR">/** find noncomment RR line in chunks, collates lines if ( ) format */</i></td></tr>
<tr><th id="4207">4207</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="4208">4208</th><td><dfn class="tu decl def fn" id="chunkline_non_comment_RR" title='chunkline_non_comment_RR' data-type='int chunkline_non_comment_RR(struct auth_chunk ** chunk, size_t * chunk_pos, sldns_buffer * buf, struct sldns_file_parse_state * pstate)' data-ref="chunkline_non_comment_RR" data-ref-filename="chunkline_non_comment_RR">chunkline_non_comment_RR</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_chunk" title='auth_chunk' data-ref="auth_chunk" data-ref-filename="auth_chunk">auth_chunk</a>** <dfn class="local col1 decl" id="1051chunk" title='chunk' data-type='struct auth_chunk **' data-ref="1051chunk" data-ref-filename="1051chunk">chunk</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>* <dfn class="local col2 decl" id="1052chunk_pos" title='chunk_pos' data-type='size_t *' data-ref="1052chunk_pos" data-ref-filename="1052chunk_pos">chunk_pos</dfn>,</td></tr>
<tr><th id="4209">4209</th><td>	<a class="typedef" href="../sldns/sbuffer.h.html#sldns_buffer" title='sldns_buffer' data-type='struct sldns_buffer' data-ref="sldns_buffer" data-ref-filename="sldns_buffer">sldns_buffer</a>* <dfn class="local col3 decl" id="1053buf" title='buf' data-type='sldns_buffer *' data-ref="1053buf" data-ref-filename="1053buf">buf</dfn>, <b>struct</b> <a class="type" href="../sldns/str2wire.h.html#sldns_file_parse_state" title='sldns_file_parse_state' data-ref="sldns_file_parse_state" data-ref-filename="sldns_file_parse_state">sldns_file_parse_state</a>* <dfn class="local col4 decl" id="1054pstate" title='pstate' data-type='struct sldns_file_parse_state *' data-ref="1054pstate" data-ref-filename="1054pstate">pstate</dfn>)</td></tr>
<tr><th id="4210">4210</th><td>{</td></tr>
<tr><th id="4211">4211</th><td>	<b>while</b>(<a class="tu ref fn" href="#chunkline_get_line_collated" title='chunkline_get_line_collated' data-use='c' data-ref="chunkline_get_line_collated" data-ref-filename="chunkline_get_line_collated">chunkline_get_line_collated</a>(<a class="local col1 ref" href="#1051chunk" title='chunk' data-ref="1051chunk" data-ref-filename="1051chunk">chunk</a>, <a class="local col2 ref" href="#1052chunk_pos" title='chunk_pos' data-ref="1052chunk_pos" data-ref-filename="1052chunk_pos">chunk_pos</a>, <a class="local col3 ref" href="#1053buf" title='buf' data-ref="1053buf" data-ref-filename="1053buf">buf</a>)) {</td></tr>
<tr><th id="4212">4212</th><td>		<b>if</b>(<a class="tu ref fn" href="#chunkline_is_comment_line_or_empty" title='chunkline_is_comment_line_or_empty' data-use='c' data-ref="chunkline_is_comment_line_or_empty" data-ref-filename="chunkline_is_comment_line_or_empty">chunkline_is_comment_line_or_empty</a>(<a class="local col3 ref" href="#1053buf" title='buf' data-ref="1053buf" data-ref-filename="1053buf">buf</a>)) {</td></tr>
<tr><th id="4213">4213</th><td>			<i>/* a comment, go to next line */</i></td></tr>
<tr><th id="4214">4214</th><td>			<b>continue</b>;</td></tr>
<tr><th id="4215">4215</th><td>		}</td></tr>
<tr><th id="4216">4216</th><td>		<b>if</b>(<a class="tu ref fn" href="#http_parse_origin" title='http_parse_origin' data-use='c' data-ref="http_parse_origin" data-ref-filename="http_parse_origin">http_parse_origin</a>(<a class="local col3 ref" href="#1053buf" title='buf' data-ref="1053buf" data-ref-filename="1053buf">buf</a>, <a class="local col4 ref" href="#1054pstate" title='pstate' data-ref="1054pstate" data-ref-filename="1054pstate">pstate</a>)) {</td></tr>
<tr><th id="4217">4217</th><td>			<b>continue</b>; <i>/* $ORIGIN has been handled */</i></td></tr>
<tr><th id="4218">4218</th><td>		}</td></tr>
<tr><th id="4219">4219</th><td>		<b>if</b>(<a class="tu ref fn" href="#http_parse_ttl" title='http_parse_ttl' data-use='c' data-ref="http_parse_ttl" data-ref-filename="http_parse_ttl">http_parse_ttl</a>(<a class="local col3 ref" href="#1053buf" title='buf' data-ref="1053buf" data-ref-filename="1053buf">buf</a>, <a class="local col4 ref" href="#1054pstate" title='pstate' data-ref="1054pstate" data-ref-filename="1054pstate">pstate</a>)) {</td></tr>
<tr><th id="4220">4220</th><td>			<b>continue</b>; <i>/* $TTL has been handled */</i></td></tr>
<tr><th id="4221">4221</th><td>		}</td></tr>
<tr><th id="4222">4222</th><td>		<b>return</b> <var>1</var>;</td></tr>
<tr><th id="4223">4223</th><td>	}</td></tr>
<tr><th id="4224">4224</th><td>	<i>/* no noncomments, fail */</i></td></tr>
<tr><th id="4225">4225</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4226">4226</th><td>}</td></tr>
<tr><th id="4227">4227</th><td></td></tr>
<tr><th id="4228">4228</th><td><i class="doc" data-doc="http_zonefile_syntax_check">/** check syntax of chunklist zonefile, parse first RR, return false on</i></td></tr>
<tr><th id="4229">4229</th><td><i class="doc" data-doc="http_zonefile_syntax_check"> * failure and return a string in the scratch buffer (first RR string)</i></td></tr>
<tr><th id="4230">4230</th><td><i class="doc" data-doc="http_zonefile_syntax_check"> * on failure. */</i></td></tr>
<tr><th id="4231">4231</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="4232">4232</th><td><dfn class="tu decl def fn" id="http_zonefile_syntax_check" title='http_zonefile_syntax_check' data-type='int http_zonefile_syntax_check(struct auth_xfer * xfr, sldns_buffer * buf)' data-ref="http_zonefile_syntax_check" data-ref-filename="http_zonefile_syntax_check">http_zonefile_syntax_check</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col5 decl" id="1055xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1055xfr" data-ref-filename="1055xfr">xfr</dfn>, <a class="typedef" href="../sldns/sbuffer.h.html#sldns_buffer" title='sldns_buffer' data-type='struct sldns_buffer' data-ref="sldns_buffer" data-ref-filename="sldns_buffer">sldns_buffer</a>* <dfn class="local col6 decl" id="1056buf" title='buf' data-type='sldns_buffer *' data-ref="1056buf" data-ref-filename="1056buf">buf</dfn>)</td></tr>
<tr><th id="4233">4233</th><td>{</td></tr>
<tr><th id="4234">4234</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a> <dfn class="local col7 decl" id="1057rr" title='rr' data-type='uint8_t [65535]' data-ref="1057rr" data-ref-filename="1057rr">rr</dfn>[<a class="macro" href="../sldns/str2wire.h.html#27" title="65535" data-ref="_M/LDNS_RR_BUF_SIZE">LDNS_RR_BUF_SIZE</a>];</td></tr>
<tr><th id="4235">4235</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col8 decl" id="1058rr_len" title='rr_len' data-type='size_t' data-ref="1058rr_len" data-ref-filename="1058rr_len">rr_len</dfn>, <dfn class="local col9 decl" id="1059dname_len" title='dname_len' data-type='size_t' data-ref="1059dname_len" data-ref-filename="1059dname_len">dname_len</dfn> = <var>0</var>;</td></tr>
<tr><th id="4236">4236</th><td>	<b>struct</b> <a class="type" href="../sldns/str2wire.h.html#sldns_file_parse_state" title='sldns_file_parse_state' data-ref="sldns_file_parse_state" data-ref-filename="sldns_file_parse_state">sldns_file_parse_state</a> <dfn class="local col0 decl" id="1060pstate" title='pstate' data-type='struct sldns_file_parse_state' data-ref="1060pstate" data-ref-filename="1060pstate">pstate</dfn>;</td></tr>
<tr><th id="4237">4237</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_chunk" title='auth_chunk' data-ref="auth_chunk" data-ref-filename="auth_chunk">auth_chunk</a>* <dfn class="local col1 decl" id="1061chunk" title='chunk' data-type='struct auth_chunk *' data-ref="1061chunk" data-ref-filename="1061chunk">chunk</dfn>;</td></tr>
<tr><th id="4238">4238</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col2 decl" id="1062chunk_pos" title='chunk_pos' data-type='size_t' data-ref="1062chunk_pos" data-ref-filename="1062chunk_pos">chunk_pos</dfn>;</td></tr>
<tr><th id="4239">4239</th><td>	<em>int</em> <dfn class="local col3 decl" id="1063e" title='e' data-type='int' data-ref="1063e" data-ref-filename="1063e">e</dfn>;</td></tr>
<tr><th id="4240">4240</th><td>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#97" title="((__builtin_object_size(&amp;pstate, 0) != (size_t)-1) ? __builtin___memset_chk(&amp;pstate, 0, sizeof(pstate), __builtin_object_size(&amp;pstate, 0)) : __memset_ichk(&amp;pstate, 0, sizeof(pstate)))" data-ref="_M/memset">memset</a>(&amp;<a class="local col0 ref" href="#1060pstate" title='pstate' data-ref="1060pstate" data-ref-filename="1060pstate">pstate</a>, <var>0</var>, <b>sizeof</b>(<a class="local col0 ref" href="#1060pstate" title='pstate' data-ref="1060pstate" data-ref-filename="1060pstate">pstate</a>));</td></tr>
<tr><th id="4241">4241</th><td>	<a class="local col0 ref" href="#1060pstate" title='pstate' data-ref="1060pstate" data-ref-filename="1060pstate">pstate</a>.<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::default_ttl" title='sldns_file_parse_state::default_ttl' data-ref="sldns_file_parse_state::default_ttl" data-ref-filename="sldns_file_parse_state..default_ttl">default_ttl</a> = <var>3600</var>;</td></tr>
<tr><th id="4242">4242</th><td>	<b>if</b>(<a class="local col5 ref" href="#1055xfr" title='xfr' data-ref="1055xfr" data-ref-filename="1055xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::namelen" title='auth_xfer::namelen' data-ref="auth_xfer::namelen" data-ref-filename="auth_xfer..namelen">namelen</a> &lt; <b>sizeof</b>(<a class="local col0 ref" href="#1060pstate" title='pstate' data-ref="1060pstate" data-ref-filename="1060pstate">pstate</a>.<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::origin" title='sldns_file_parse_state::origin' data-ref="sldns_file_parse_state::origin" data-ref-filename="sldns_file_parse_state..origin">origin</a>)) {</td></tr>
<tr><th id="4243">4243</th><td>		<a class="local col0 ref" href="#1060pstate" title='pstate' data-ref="1060pstate" data-ref-filename="1060pstate">pstate</a>.<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::origin_len" title='sldns_file_parse_state::origin_len' data-ref="sldns_file_parse_state::origin_len" data-ref-filename="sldns_file_parse_state..origin_len">origin_len</a> = <a class="local col5 ref" href="#1055xfr" title='xfr' data-ref="1055xfr" data-ref-filename="1055xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::namelen" title='auth_xfer::namelen' data-ref="auth_xfer::namelen" data-ref-filename="auth_xfer..namelen">namelen</a>;</td></tr>
<tr><th id="4244">4244</th><td>		<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(pstate.origin, 0) != (size_t)-1) ? __builtin___memmove_chk(pstate.origin, xfr-&gt;name, xfr-&gt;namelen, __builtin_object_size(pstate.origin, 0)) : __memmove_ichk(pstate.origin, xfr-&gt;name, xfr-&gt;namelen))" data-ref="_M/memmove">memmove</a>(<a class="local col0 ref" href="#1060pstate" title='pstate' data-ref="1060pstate" data-ref-filename="1060pstate">pstate</a>.<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::origin" title='sldns_file_parse_state::origin' data-ref="sldns_file_parse_state::origin" data-ref-filename="sldns_file_parse_state..origin">origin</a>, <a class="local col5 ref" href="#1055xfr" title='xfr' data-ref="1055xfr" data-ref-filename="1055xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a>, <a class="local col5 ref" href="#1055xfr" title='xfr' data-ref="1055xfr" data-ref-filename="1055xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::namelen" title='auth_xfer::namelen' data-ref="auth_xfer::namelen" data-ref-filename="auth_xfer..namelen">namelen</a>);</td></tr>
<tr><th id="4245">4245</th><td>	}</td></tr>
<tr><th id="4246">4246</th><td>	<a class="local col1 ref" href="#1061chunk" title='chunk' data-ref="1061chunk" data-ref-filename="1061chunk">chunk</a> = <a class="local col5 ref" href="#1055xfr" title='xfr' data-ref="1055xfr" data-ref-filename="1055xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::chunks_first" title='auth_transfer::chunks_first' data-ref="auth_transfer::chunks_first" data-ref-filename="auth_transfer..chunks_first">chunks_first</a>;</td></tr>
<tr><th id="4247">4247</th><td>	<a class="local col2 ref" href="#1062chunk_pos" title='chunk_pos' data-ref="1062chunk_pos" data-ref-filename="1062chunk_pos">chunk_pos</a> = <var>0</var>;</td></tr>
<tr><th id="4248">4248</th><td>	<b>if</b>(!<a class="tu ref fn" href="#chunkline_non_comment_RR" title='chunkline_non_comment_RR' data-use='c' data-ref="chunkline_non_comment_RR" data-ref-filename="chunkline_non_comment_RR">chunkline_non_comment_RR</a>(&amp;<a class="local col1 ref" href="#1061chunk" title='chunk' data-ref="1061chunk" data-ref-filename="1061chunk">chunk</a>, &amp;<a class="local col2 ref" href="#1062chunk_pos" title='chunk_pos' data-ref="1062chunk_pos" data-ref-filename="1062chunk_pos">chunk_pos</a>, <a class="local col6 ref" href="#1056buf" title='buf' data-ref="1056buf" data-ref-filename="1056buf">buf</a>, &amp;<a class="local col0 ref" href="#1060pstate" title='pstate' data-ref="1060pstate" data-ref-filename="1060pstate">pstate</a>)) {</td></tr>
<tr><th id="4249">4249</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4250">4250</th><td>	}</td></tr>
<tr><th id="4251">4251</th><td>	<a class="local col8 ref" href="#1058rr_len" title='rr_len' data-ref="1058rr_len" data-ref-filename="1058rr_len">rr_len</a> = <b>sizeof</b>(<a class="local col7 ref" href="#1057rr" title='rr' data-ref="1057rr" data-ref-filename="1057rr">rr</a>);</td></tr>
<tr><th id="4252">4252</th><td>	<a class="local col3 ref" href="#1063e" title='e' data-ref="1063e" data-ref-filename="1063e">e</a>=<a class="ref fn" href="../sldns/str2wire.h.html#sldns_str2wire_rr_buf" title='sldns_str2wire_rr_buf' data-ref="sldns_str2wire_rr_buf" data-ref-filename="sldns_str2wire_rr_buf">sldns_str2wire_rr_buf</a>((<em>char</em>*)<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_begin" title='sldns_buffer_begin' data-ref="sldns_buffer_begin" data-ref-filename="sldns_buffer_begin">sldns_buffer_begin</a>(<a class="local col6 ref" href="#1056buf" title='buf' data-ref="1056buf" data-ref-filename="1056buf">buf</a>), <a class="local col7 ref" href="#1057rr" title='rr' data-ref="1057rr" data-ref-filename="1057rr">rr</a>, &amp;<a class="local col8 ref" href="#1058rr_len" title='rr_len' data-ref="1058rr_len" data-ref-filename="1058rr_len">rr_len</a>,</td></tr>
<tr><th id="4253">4253</th><td>		&amp;<a class="local col9 ref" href="#1059dname_len" title='dname_len' data-ref="1059dname_len" data-ref-filename="1059dname_len">dname_len</a>, <a class="local col0 ref" href="#1060pstate" title='pstate' data-ref="1060pstate" data-ref-filename="1060pstate">pstate</a>.<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::default_ttl" title='sldns_file_parse_state::default_ttl' data-ref="sldns_file_parse_state::default_ttl" data-ref-filename="sldns_file_parse_state..default_ttl">default_ttl</a>,</td></tr>
<tr><th id="4254">4254</th><td>		<a class="local col0 ref" href="#1060pstate" title='pstate' data-ref="1060pstate" data-ref-filename="1060pstate">pstate</a>.<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::origin_len" title='sldns_file_parse_state::origin_len' data-ref="sldns_file_parse_state::origin_len" data-ref-filename="sldns_file_parse_state..origin_len">origin_len</a>?<a class="local col0 ref" href="#1060pstate" title='pstate' data-ref="1060pstate" data-ref-filename="1060pstate">pstate</a>.<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::origin" title='sldns_file_parse_state::origin' data-ref="sldns_file_parse_state::origin" data-ref-filename="sldns_file_parse_state..origin">origin</a>:<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>, <a class="local col0 ref" href="#1060pstate" title='pstate' data-ref="1060pstate" data-ref-filename="1060pstate">pstate</a>.<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::origin_len" title='sldns_file_parse_state::origin_len' data-ref="sldns_file_parse_state::origin_len" data-ref-filename="sldns_file_parse_state..origin_len">origin_len</a>,</td></tr>
<tr><th id="4255">4255</th><td>		<a class="local col0 ref" href="#1060pstate" title='pstate' data-ref="1060pstate" data-ref-filename="1060pstate">pstate</a>.<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::prev_rr_len" title='sldns_file_parse_state::prev_rr_len' data-ref="sldns_file_parse_state::prev_rr_len" data-ref-filename="sldns_file_parse_state..prev_rr_len">prev_rr_len</a>?<a class="local col0 ref" href="#1060pstate" title='pstate' data-ref="1060pstate" data-ref-filename="1060pstate">pstate</a>.<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::prev_rr" title='sldns_file_parse_state::prev_rr' data-ref="sldns_file_parse_state::prev_rr" data-ref-filename="sldns_file_parse_state..prev_rr">prev_rr</a>:<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>, <a class="local col0 ref" href="#1060pstate" title='pstate' data-ref="1060pstate" data-ref-filename="1060pstate">pstate</a>.<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::prev_rr_len" title='sldns_file_parse_state::prev_rr_len' data-ref="sldns_file_parse_state::prev_rr_len" data-ref-filename="sldns_file_parse_state..prev_rr_len">prev_rr_len</a>);</td></tr>
<tr><th id="4256">4256</th><td>	<b>if</b>(<a class="local col3 ref" href="#1063e" title='e' data-ref="1063e" data-ref-filename="1063e">e</a> != <var>0</var>) {</td></tr>
<tr><th id="4257">4257</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"parse failure on first RR[%d]: %s"</q>,</td></tr>
<tr><th id="4258">4258</th><td>			<a class="macro" href="../sldns/str2wire.h.html#173" title="(((e)&amp;~0x0fff)&gt;&gt;12)" data-ref="_M/LDNS_WIREPARSE_OFFSET">LDNS_WIREPARSE_OFFSET</a>(<a class="local col3 ref" href="#1063e" title='e' data-ref="1063e" data-ref-filename="1063e">e</a>),</td></tr>
<tr><th id="4259">4259</th><td>			<a class="ref fn" href="../sldns/str2wire.h.html#sldns_get_errorstr_parse" title='sldns_get_errorstr_parse' data-ref="sldns_get_errorstr_parse" data-ref-filename="sldns_get_errorstr_parse">sldns_get_errorstr_parse</a>(<a class="macro" href="../sldns/str2wire.h.html#172" title="((e)&amp;0x0fff)" data-ref="_M/LDNS_WIREPARSE_ERROR">LDNS_WIREPARSE_ERROR</a>(<a class="local col3 ref" href="#1063e" title='e' data-ref="1063e" data-ref-filename="1063e">e</a>)));</td></tr>
<tr><th id="4260">4260</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4261">4261</th><td>	}</td></tr>
<tr><th id="4262">4262</th><td>	<i>/* check that class is correct */</i></td></tr>
<tr><th id="4263">4263</th><td>	<b>if</b>(<a class="ref fn" href="../sldns/str2wire.h.html#sldns_wirerr_get_class" title='sldns_wirerr_get_class' data-ref="sldns_wirerr_get_class" data-ref-filename="sldns_wirerr_get_class">sldns_wirerr_get_class</a>(<a class="local col7 ref" href="#1057rr" title='rr' data-ref="1057rr" data-ref-filename="1057rr">rr</a>, <a class="local col8 ref" href="#1058rr_len" title='rr_len' data-ref="1058rr_len" data-ref-filename="1058rr_len">rr_len</a>, <a class="local col9 ref" href="#1059dname_len" title='dname_len' data-ref="1059dname_len" data-ref-filename="1059dname_len">dname_len</a>) != <a class="local col5 ref" href="#1055xfr" title='xfr' data-ref="1055xfr" data-ref-filename="1055xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::dclass" title='auth_xfer::dclass' data-ref="auth_xfer::dclass" data-ref-filename="auth_xfer..dclass">dclass</a>) {</td></tr>
<tr><th id="4264">4264</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"parse failure: first record in downloaded zonefile "</q></td></tr>
<tr><th id="4265">4265</th><td>			<q>"from wrong RR class"</q>);</td></tr>
<tr><th id="4266">4266</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4267">4267</th><td>	}</td></tr>
<tr><th id="4268">4268</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="4269">4269</th><td>}</td></tr>
<tr><th id="4270">4270</th><td></td></tr>
<tr><th id="4271">4271</th><td><i class="doc" data-doc="chunklist_sum">/** sum sizes of chunklist */</i></td></tr>
<tr><th id="4272">4272</th><td><em>static</em> <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a></td></tr>
<tr><th id="4273">4273</th><td><dfn class="tu decl def fn" id="chunklist_sum" title='chunklist_sum' data-type='size_t chunklist_sum(struct auth_chunk * list)' data-ref="chunklist_sum" data-ref-filename="chunklist_sum">chunklist_sum</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_chunk" title='auth_chunk' data-ref="auth_chunk" data-ref-filename="auth_chunk">auth_chunk</a>* <dfn class="local col4 decl" id="1064list" title='list' data-type='struct auth_chunk *' data-ref="1064list" data-ref-filename="1064list">list</dfn>)</td></tr>
<tr><th id="4274">4274</th><td>{</td></tr>
<tr><th id="4275">4275</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_chunk" title='auth_chunk' data-ref="auth_chunk" data-ref-filename="auth_chunk">auth_chunk</a>* <dfn class="local col5 decl" id="1065p" title='p' data-type='struct auth_chunk *' data-ref="1065p" data-ref-filename="1065p">p</dfn>;</td></tr>
<tr><th id="4276">4276</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col6 decl" id="1066s" title='s' data-type='size_t' data-ref="1066s" data-ref-filename="1066s">s</dfn> = <var>0</var>;</td></tr>
<tr><th id="4277">4277</th><td>	<b>for</b>(<a class="local col5 ref" href="#1065p" title='p' data-ref="1065p" data-ref-filename="1065p">p</a>=<a class="local col4 ref" href="#1064list" title='list' data-ref="1064list" data-ref-filename="1064list">list</a>; <a class="local col5 ref" href="#1065p" title='p' data-ref="1065p" data-ref-filename="1065p">p</a>; <a class="local col5 ref" href="#1065p" title='p' data-ref="1065p" data-ref-filename="1065p">p</a>=<a class="local col5 ref" href="#1065p" title='p' data-ref="1065p" data-ref-filename="1065p">p</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::next" title='auth_chunk::next' data-ref="auth_chunk::next" data-ref-filename="auth_chunk..next">next</a>) {</td></tr>
<tr><th id="4278">4278</th><td>		<a class="local col6 ref" href="#1066s" title='s' data-ref="1066s" data-ref-filename="1066s">s</a> += <a class="local col5 ref" href="#1065p" title='p' data-ref="1065p" data-ref-filename="1065p">p</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::len" title='auth_chunk::len' data-ref="auth_chunk::len" data-ref-filename="auth_chunk..len">len</a>;</td></tr>
<tr><th id="4279">4279</th><td>	}</td></tr>
<tr><th id="4280">4280</th><td>	<b>return</b> <a class="local col6 ref" href="#1066s" title='s' data-ref="1066s" data-ref-filename="1066s">s</a>;</td></tr>
<tr><th id="4281">4281</th><td>}</td></tr>
<tr><th id="4282">4282</th><td></td></tr>
<tr><th id="4283">4283</th><td><i class="doc" data-doc="chunkline_newline_removal">/** remove newlines from collated line */</i></td></tr>
<tr><th id="4284">4284</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="4285">4285</th><td><dfn class="tu decl def fn" id="chunkline_newline_removal" title='chunkline_newline_removal' data-type='void chunkline_newline_removal(sldns_buffer * buf)' data-ref="chunkline_newline_removal" data-ref-filename="chunkline_newline_removal">chunkline_newline_removal</dfn>(<a class="typedef" href="../sldns/sbuffer.h.html#sldns_buffer" title='sldns_buffer' data-type='struct sldns_buffer' data-ref="sldns_buffer" data-ref-filename="sldns_buffer">sldns_buffer</a>* <dfn class="local col7 decl" id="1067buf" title='buf' data-type='sldns_buffer *' data-ref="1067buf" data-ref-filename="1067buf">buf</dfn>)</td></tr>
<tr><th id="4286">4286</th><td>{</td></tr>
<tr><th id="4287">4287</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col8 decl" id="1068i" title='i' data-type='size_t' data-ref="1068i" data-ref-filename="1068i">i</dfn>, <dfn class="local col9 decl" id="1069end" title='end' data-type='size_t' data-ref="1069end" data-ref-filename="1069end">end</dfn>=<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_limit" title='sldns_buffer_limit' data-ref="sldns_buffer_limit" data-ref-filename="sldns_buffer_limit">sldns_buffer_limit</a>(<a class="local col7 ref" href="#1067buf" title='buf' data-ref="1067buf" data-ref-filename="1067buf">buf</a>);</td></tr>
<tr><th id="4288">4288</th><td>	<b>for</b>(<a class="local col8 ref" href="#1068i" title='i' data-ref="1068i" data-ref-filename="1068i">i</a>=<var>0</var>; <a class="local col8 ref" href="#1068i" title='i' data-ref="1068i" data-ref-filename="1068i">i</a>&lt;<a class="local col9 ref" href="#1069end" title='end' data-ref="1069end" data-ref-filename="1069end">end</a>; <a class="local col8 ref" href="#1068i" title='i' data-ref="1068i" data-ref-filename="1068i">i</a>++) {</td></tr>
<tr><th id="4289">4289</th><td>		<em>char</em> <dfn class="local col0 decl" id="1070c" title='c' data-type='char' data-ref="1070c" data-ref-filename="1070c">c</dfn> = (<em>char</em>)<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u8_at" title='sldns_buffer_read_u8_at' data-ref="sldns_buffer_read_u8_at" data-ref-filename="sldns_buffer_read_u8_at">sldns_buffer_read_u8_at</a>(<a class="local col7 ref" href="#1067buf" title='buf' data-ref="1067buf" data-ref-filename="1067buf">buf</a>, <a class="local col8 ref" href="#1068i" title='i' data-ref="1068i" data-ref-filename="1068i">i</a>);</td></tr>
<tr><th id="4290">4290</th><td>		<b>if</b>(<a class="local col0 ref" href="#1070c" title='c' data-ref="1070c" data-ref-filename="1070c">c</a> == <kbd>'\n'</kbd> &amp;&amp; <a class="local col8 ref" href="#1068i" title='i' data-ref="1068i" data-ref-filename="1068i">i</a>==<a class="local col9 ref" href="#1069end" title='end' data-ref="1069end" data-ref-filename="1069end">end</a>-<var>1</var>) {</td></tr>
<tr><th id="4291">4291</th><td>			<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_write_u8_at" title='sldns_buffer_write_u8_at' data-ref="sldns_buffer_write_u8_at" data-ref-filename="sldns_buffer_write_u8_at">sldns_buffer_write_u8_at</a>(<a class="local col7 ref" href="#1067buf" title='buf' data-ref="1067buf" data-ref-filename="1067buf">buf</a>, <a class="local col8 ref" href="#1068i" title='i' data-ref="1068i" data-ref-filename="1068i">i</a>, <var>0</var>);</td></tr>
<tr><th id="4292">4292</th><td>			<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_set_limit" title='sldns_buffer_set_limit' data-ref="sldns_buffer_set_limit" data-ref-filename="sldns_buffer_set_limit">sldns_buffer_set_limit</a>(<a class="local col7 ref" href="#1067buf" title='buf' data-ref="1067buf" data-ref-filename="1067buf">buf</a>, <a class="local col9 ref" href="#1069end" title='end' data-ref="1069end" data-ref-filename="1069end">end</a>-<var>1</var>);</td></tr>
<tr><th id="4293">4293</th><td>			<b>return</b>;</td></tr>
<tr><th id="4294">4294</th><td>		}</td></tr>
<tr><th id="4295">4295</th><td>		<b>if</b>(<a class="local col0 ref" href="#1070c" title='c' data-ref="1070c" data-ref-filename="1070c">c</a> == <kbd>'\n'</kbd>)</td></tr>
<tr><th id="4296">4296</th><td>			<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_write_u8_at" title='sldns_buffer_write_u8_at' data-ref="sldns_buffer_write_u8_at" data-ref-filename="sldns_buffer_write_u8_at">sldns_buffer_write_u8_at</a>(<a class="local col7 ref" href="#1067buf" title='buf' data-ref="1067buf" data-ref-filename="1067buf">buf</a>, <a class="local col8 ref" href="#1068i" title='i' data-ref="1068i" data-ref-filename="1068i">i</a>, (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>)<kbd>' '</kbd>);</td></tr>
<tr><th id="4297">4297</th><td>	}</td></tr>
<tr><th id="4298">4298</th><td>}</td></tr>
<tr><th id="4299">4299</th><td></td></tr>
<tr><th id="4300">4300</th><td><i class="doc" data-doc="http_parse_add_rr">/** for http download, parse and add RR to zone */</i></td></tr>
<tr><th id="4301">4301</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="4302">4302</th><td><dfn class="tu decl def fn" id="http_parse_add_rr" title='http_parse_add_rr' data-type='int http_parse_add_rr(struct auth_xfer * xfr, struct auth_zone * z, sldns_buffer * buf, struct sldns_file_parse_state * pstate)' data-ref="http_parse_add_rr" data-ref-filename="http_parse_add_rr">http_parse_add_rr</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col1 decl" id="1071xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1071xfr" data-ref-filename="1071xfr">xfr</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col2 decl" id="1072z" title='z' data-type='struct auth_zone *' data-ref="1072z" data-ref-filename="1072z">z</dfn>,</td></tr>
<tr><th id="4303">4303</th><td>	<a class="typedef" href="../sldns/sbuffer.h.html#sldns_buffer" title='sldns_buffer' data-type='struct sldns_buffer' data-ref="sldns_buffer" data-ref-filename="sldns_buffer">sldns_buffer</a>* <dfn class="local col3 decl" id="1073buf" title='buf' data-type='sldns_buffer *' data-ref="1073buf" data-ref-filename="1073buf">buf</dfn>, <b>struct</b> <a class="type" href="../sldns/str2wire.h.html#sldns_file_parse_state" title='sldns_file_parse_state' data-ref="sldns_file_parse_state" data-ref-filename="sldns_file_parse_state">sldns_file_parse_state</a>* <dfn class="local col4 decl" id="1074pstate" title='pstate' data-type='struct sldns_file_parse_state *' data-ref="1074pstate" data-ref-filename="1074pstate">pstate</dfn>)</td></tr>
<tr><th id="4304">4304</th><td>{</td></tr>
<tr><th id="4305">4305</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a> <dfn class="local col5 decl" id="1075rr" title='rr' data-type='uint8_t [65535]' data-ref="1075rr" data-ref-filename="1075rr">rr</dfn>[<a class="macro" href="../sldns/str2wire.h.html#27" title="65535" data-ref="_M/LDNS_RR_BUF_SIZE">LDNS_RR_BUF_SIZE</a>];</td></tr>
<tr><th id="4306">4306</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col6 decl" id="1076rr_len" title='rr_len' data-type='size_t' data-ref="1076rr_len" data-ref-filename="1076rr_len">rr_len</dfn>, <dfn class="local col7 decl" id="1077dname_len" title='dname_len' data-type='size_t' data-ref="1077dname_len" data-ref-filename="1077dname_len">dname_len</dfn> = <var>0</var>;</td></tr>
<tr><th id="4307">4307</th><td>	<em>int</em> <dfn class="local col8 decl" id="1078e" title='e' data-type='int' data-ref="1078e" data-ref-filename="1078e">e</dfn>;</td></tr>
<tr><th id="4308">4308</th><td>	<em>char</em>* <dfn class="local col9 decl" id="1079line" title='line' data-type='char *' data-ref="1079line" data-ref-filename="1079line">line</dfn> = (<em>char</em>*)<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_begin" title='sldns_buffer_begin' data-ref="sldns_buffer_begin" data-ref-filename="sldns_buffer_begin">sldns_buffer_begin</a>(<a class="local col3 ref" href="#1073buf" title='buf' data-ref="1073buf" data-ref-filename="1073buf">buf</a>);</td></tr>
<tr><th id="4309">4309</th><td>	<a class="local col6 ref" href="#1076rr_len" title='rr_len' data-ref="1076rr_len" data-ref-filename="1076rr_len">rr_len</a> = <b>sizeof</b>(<a class="local col5 ref" href="#1075rr" title='rr' data-ref="1075rr" data-ref-filename="1075rr">rr</a>);</td></tr>
<tr><th id="4310">4310</th><td>	<a class="local col8 ref" href="#1078e" title='e' data-ref="1078e" data-ref-filename="1078e">e</a> = <a class="ref fn" href="../sldns/str2wire.h.html#sldns_str2wire_rr_buf" title='sldns_str2wire_rr_buf' data-ref="sldns_str2wire_rr_buf" data-ref-filename="sldns_str2wire_rr_buf">sldns_str2wire_rr_buf</a>(<a class="local col9 ref" href="#1079line" title='line' data-ref="1079line" data-ref-filename="1079line">line</a>, <a class="local col5 ref" href="#1075rr" title='rr' data-ref="1075rr" data-ref-filename="1075rr">rr</a>, &amp;<a class="local col6 ref" href="#1076rr_len" title='rr_len' data-ref="1076rr_len" data-ref-filename="1076rr_len">rr_len</a>, &amp;<a class="local col7 ref" href="#1077dname_len" title='dname_len' data-ref="1077dname_len" data-ref-filename="1077dname_len">dname_len</a>,</td></tr>
<tr><th id="4311">4311</th><td>		<a class="local col4 ref" href="#1074pstate" title='pstate' data-ref="1074pstate" data-ref-filename="1074pstate">pstate</a>-&gt;<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::default_ttl" title='sldns_file_parse_state::default_ttl' data-ref="sldns_file_parse_state::default_ttl" data-ref-filename="sldns_file_parse_state..default_ttl">default_ttl</a>,</td></tr>
<tr><th id="4312">4312</th><td>		<a class="local col4 ref" href="#1074pstate" title='pstate' data-ref="1074pstate" data-ref-filename="1074pstate">pstate</a>-&gt;<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::origin_len" title='sldns_file_parse_state::origin_len' data-ref="sldns_file_parse_state::origin_len" data-ref-filename="sldns_file_parse_state..origin_len">origin_len</a>?<a class="local col4 ref" href="#1074pstate" title='pstate' data-ref="1074pstate" data-ref-filename="1074pstate">pstate</a>-&gt;<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::origin" title='sldns_file_parse_state::origin' data-ref="sldns_file_parse_state::origin" data-ref-filename="sldns_file_parse_state..origin">origin</a>:<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>, <a class="local col4 ref" href="#1074pstate" title='pstate' data-ref="1074pstate" data-ref-filename="1074pstate">pstate</a>-&gt;<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::origin_len" title='sldns_file_parse_state::origin_len' data-ref="sldns_file_parse_state::origin_len" data-ref-filename="sldns_file_parse_state..origin_len">origin_len</a>,</td></tr>
<tr><th id="4313">4313</th><td>		<a class="local col4 ref" href="#1074pstate" title='pstate' data-ref="1074pstate" data-ref-filename="1074pstate">pstate</a>-&gt;<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::prev_rr_len" title='sldns_file_parse_state::prev_rr_len' data-ref="sldns_file_parse_state::prev_rr_len" data-ref-filename="sldns_file_parse_state..prev_rr_len">prev_rr_len</a>?<a class="local col4 ref" href="#1074pstate" title='pstate' data-ref="1074pstate" data-ref-filename="1074pstate">pstate</a>-&gt;<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::prev_rr" title='sldns_file_parse_state::prev_rr' data-ref="sldns_file_parse_state::prev_rr" data-ref-filename="sldns_file_parse_state..prev_rr">prev_rr</a>:<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>, <a class="local col4 ref" href="#1074pstate" title='pstate' data-ref="1074pstate" data-ref-filename="1074pstate">pstate</a>-&gt;<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::prev_rr_len" title='sldns_file_parse_state::prev_rr_len' data-ref="sldns_file_parse_state::prev_rr_len" data-ref-filename="sldns_file_parse_state..prev_rr_len">prev_rr_len</a>);</td></tr>
<tr><th id="4314">4314</th><td>	<b>if</b>(<a class="local col8 ref" href="#1078e" title='e' data-ref="1078e" data-ref-filename="1078e">e</a> != <var>0</var>) {</td></tr>
<tr><th id="4315">4315</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"%s/%s parse failure RR[%d]: %s in '%s'"</q>,</td></tr>
<tr><th id="4316">4316</th><td>			<a class="local col1 ref" href="#1071xfr" title='xfr' data-ref="1071xfr" data-ref-filename="1071xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>,</td></tr>
<tr><th id="4317">4317</th><td>			<a class="local col1 ref" href="#1071xfr" title='xfr' data-ref="1071xfr" data-ref-filename="1071xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::file" title='auth_master::file' data-ref="auth_master::file" data-ref-filename="auth_master..file">file</a>,</td></tr>
<tr><th id="4318">4318</th><td>			<a class="macro" href="../sldns/str2wire.h.html#173" title="(((e)&amp;~0x0fff)&gt;&gt;12)" data-ref="_M/LDNS_WIREPARSE_OFFSET">LDNS_WIREPARSE_OFFSET</a>(<a class="local col8 ref" href="#1078e" title='e' data-ref="1078e" data-ref-filename="1078e">e</a>),</td></tr>
<tr><th id="4319">4319</th><td>			<a class="ref fn" href="../sldns/str2wire.h.html#sldns_get_errorstr_parse" title='sldns_get_errorstr_parse' data-ref="sldns_get_errorstr_parse" data-ref-filename="sldns_get_errorstr_parse">sldns_get_errorstr_parse</a>(<a class="macro" href="../sldns/str2wire.h.html#172" title="((e)&amp;0x0fff)" data-ref="_M/LDNS_WIREPARSE_ERROR">LDNS_WIREPARSE_ERROR</a>(<a class="local col8 ref" href="#1078e" title='e' data-ref="1078e" data-ref-filename="1078e">e</a>)),</td></tr>
<tr><th id="4320">4320</th><td>			<a class="local col9 ref" href="#1079line" title='line' data-ref="1079line" data-ref-filename="1079line">line</a>);</td></tr>
<tr><th id="4321">4321</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4322">4322</th><td>	}</td></tr>
<tr><th id="4323">4323</th><td>	<b>if</b>(<a class="local col6 ref" href="#1076rr_len" title='rr_len' data-ref="1076rr_len" data-ref-filename="1076rr_len">rr_len</a> == <var>0</var>)</td></tr>
<tr><th id="4324">4324</th><td>		<b>return</b> <var>1</var>; <i>/* empty line or so */</i></td></tr>
<tr><th id="4325">4325</th><td></td></tr>
<tr><th id="4326">4326</th><td>	<i>/* set prev */</i></td></tr>
<tr><th id="4327">4327</th><td>	<b>if</b>(<a class="local col7 ref" href="#1077dname_len" title='dname_len' data-ref="1077dname_len" data-ref-filename="1077dname_len">dname_len</a> &lt; <b>sizeof</b>(<a class="local col4 ref" href="#1074pstate" title='pstate' data-ref="1074pstate" data-ref-filename="1074pstate">pstate</a>-&gt;<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::prev_rr" title='sldns_file_parse_state::prev_rr' data-ref="sldns_file_parse_state::prev_rr" data-ref-filename="sldns_file_parse_state..prev_rr">prev_rr</a>)) {</td></tr>
<tr><th id="4328">4328</th><td>		<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(pstate-&gt;prev_rr, 0) != (size_t)-1) ? __builtin___memmove_chk(pstate-&gt;prev_rr, rr, dname_len, __builtin_object_size(pstate-&gt;prev_rr, 0)) : __memmove_ichk(pstate-&gt;prev_rr, rr, dname_len))" data-ref="_M/memmove">memmove</a>(<a class="local col4 ref" href="#1074pstate" title='pstate' data-ref="1074pstate" data-ref-filename="1074pstate">pstate</a>-&gt;<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::prev_rr" title='sldns_file_parse_state::prev_rr' data-ref="sldns_file_parse_state::prev_rr" data-ref-filename="sldns_file_parse_state..prev_rr">prev_rr</a>, <a class="local col5 ref" href="#1075rr" title='rr' data-ref="1075rr" data-ref-filename="1075rr">rr</a>, <a class="local col7 ref" href="#1077dname_len" title='dname_len' data-ref="1077dname_len" data-ref-filename="1077dname_len">dname_len</a>);</td></tr>
<tr><th id="4329">4329</th><td>		<a class="local col4 ref" href="#1074pstate" title='pstate' data-ref="1074pstate" data-ref-filename="1074pstate">pstate</a>-&gt;<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::prev_rr_len" title='sldns_file_parse_state::prev_rr_len' data-ref="sldns_file_parse_state::prev_rr_len" data-ref-filename="sldns_file_parse_state..prev_rr_len">prev_rr_len</a> = <a class="local col7 ref" href="#1077dname_len" title='dname_len' data-ref="1077dname_len" data-ref-filename="1077dname_len">dname_len</a>;</td></tr>
<tr><th id="4330">4330</th><td>	}</td></tr>
<tr><th id="4331">4331</th><td></td></tr>
<tr><th id="4332">4332</th><td>	<b>return</b> <a class="tu ref fn" href="#az_insert_rr" title='az_insert_rr' data-use='c' data-ref="az_insert_rr" data-ref-filename="az_insert_rr">az_insert_rr</a>(<a class="local col2 ref" href="#1072z" title='z' data-ref="1072z" data-ref-filename="1072z">z</a>, <a class="local col5 ref" href="#1075rr" title='rr' data-ref="1075rr" data-ref-filename="1075rr">rr</a>, <a class="local col6 ref" href="#1076rr_len" title='rr_len' data-ref="1076rr_len" data-ref-filename="1076rr_len">rr_len</a>, <a class="local col7 ref" href="#1077dname_len" title='dname_len' data-ref="1077dname_len" data-ref-filename="1077dname_len">dname_len</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="4333">4333</th><td>}</td></tr>
<tr><th id="4334">4334</th><td></td></tr>
<tr><th id="4335">4335</th><td><i class="doc" data-doc="chunk_rrlist_start">/** RR list iterator, returns RRs from answer section one by one from the</i></td></tr>
<tr><th id="4336">4336</th><td><i class="doc" data-doc="chunk_rrlist_start"> * dns packets in the chunklist */</i></td></tr>
<tr><th id="4337">4337</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="4338">4338</th><td><dfn class="tu decl def fn" id="chunk_rrlist_start" title='chunk_rrlist_start' data-type='void chunk_rrlist_start(struct auth_xfer * xfr, struct auth_chunk ** rr_chunk, int * rr_num, size_t * rr_pos)' data-ref="chunk_rrlist_start" data-ref-filename="chunk_rrlist_start">chunk_rrlist_start</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col0 decl" id="1080xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1080xfr" data-ref-filename="1080xfr">xfr</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_chunk" title='auth_chunk' data-ref="auth_chunk" data-ref-filename="auth_chunk">auth_chunk</a>** <dfn class="local col1 decl" id="1081rr_chunk" title='rr_chunk' data-type='struct auth_chunk **' data-ref="1081rr_chunk" data-ref-filename="1081rr_chunk">rr_chunk</dfn>,</td></tr>
<tr><th id="4339">4339</th><td>	<em>int</em>* <dfn class="local col2 decl" id="1082rr_num" title='rr_num' data-type='int *' data-ref="1082rr_num" data-ref-filename="1082rr_num">rr_num</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>* <dfn class="local col3 decl" id="1083rr_pos" title='rr_pos' data-type='size_t *' data-ref="1083rr_pos" data-ref-filename="1083rr_pos">rr_pos</dfn>)</td></tr>
<tr><th id="4340">4340</th><td>{</td></tr>
<tr><th id="4341">4341</th><td>	*<a class="local col1 ref" href="#1081rr_chunk" title='rr_chunk' data-ref="1081rr_chunk" data-ref-filename="1081rr_chunk">rr_chunk</a> = <a class="local col0 ref" href="#1080xfr" title='xfr' data-ref="1080xfr" data-ref-filename="1080xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::chunks_first" title='auth_transfer::chunks_first' data-ref="auth_transfer::chunks_first" data-ref-filename="auth_transfer..chunks_first">chunks_first</a>;</td></tr>
<tr><th id="4342">4342</th><td>	*<a class="local col2 ref" href="#1082rr_num" title='rr_num' data-ref="1082rr_num" data-ref-filename="1082rr_num">rr_num</a> = <var>0</var>;</td></tr>
<tr><th id="4343">4343</th><td>	*<a class="local col3 ref" href="#1083rr_pos" title='rr_pos' data-ref="1083rr_pos" data-ref-filename="1083rr_pos">rr_pos</a> = <var>0</var>;</td></tr>
<tr><th id="4344">4344</th><td>}</td></tr>
<tr><th id="4345">4345</th><td></td></tr>
<tr><th id="4346">4346</th><td><i class="doc" data-doc="chunk_rrlist_end">/** RR list iterator, see if we are at the end of the list */</i></td></tr>
<tr><th id="4347">4347</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="4348">4348</th><td><dfn class="tu decl def fn" id="chunk_rrlist_end" title='chunk_rrlist_end' data-type='int chunk_rrlist_end(struct auth_chunk * rr_chunk, int rr_num)' data-ref="chunk_rrlist_end" data-ref-filename="chunk_rrlist_end">chunk_rrlist_end</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_chunk" title='auth_chunk' data-ref="auth_chunk" data-ref-filename="auth_chunk">auth_chunk</a>* <dfn class="local col4 decl" id="1084rr_chunk" title='rr_chunk' data-type='struct auth_chunk *' data-ref="1084rr_chunk" data-ref-filename="1084rr_chunk">rr_chunk</dfn>, <em>int</em> <dfn class="local col5 decl" id="1085rr_num" title='rr_num' data-type='int' data-ref="1085rr_num" data-ref-filename="1085rr_num">rr_num</dfn>)</td></tr>
<tr><th id="4349">4349</th><td>{</td></tr>
<tr><th id="4350">4350</th><td>	<b>while</b>(<a class="local col4 ref" href="#1084rr_chunk" title='rr_chunk' data-ref="1084rr_chunk" data-ref-filename="1084rr_chunk">rr_chunk</a>) {</td></tr>
<tr><th id="4351">4351</th><td>		<b>if</b>(<a class="local col4 ref" href="#1084rr_chunk" title='rr_chunk' data-ref="1084rr_chunk" data-ref-filename="1084rr_chunk">rr_chunk</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::len" title='auth_chunk::len' data-ref="auth_chunk::len" data-ref-filename="auth_chunk..len">len</a> &lt; <a class="macro" href="../sldns/pkthdr.h.html#26" title="12" data-ref="_M/LDNS_HEADER_SIZE">LDNS_HEADER_SIZE</a>)</td></tr>
<tr><th id="4352">4352</th><td>			<b>return</b> <var>1</var>;</td></tr>
<tr><th id="4353">4353</th><td>		<b>if</b>(<a class="local col5 ref" href="#1085rr_num" title='rr_num' data-ref="1085rr_num" data-ref-filename="1085rr_num">rr_num</a> &lt; (<em>int</em>)<a class="macro" href="../sldns/pkthdr.h.html#103" title="(sldns_read_uint16(rr_chunk-&gt;data+6))" data-ref="_M/LDNS_ANCOUNT">LDNS_ANCOUNT</a>(<a class="local col4 ref" href="#1084rr_chunk" title='rr_chunk' data-ref="1084rr_chunk" data-ref-filename="1084rr_chunk">rr_chunk</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::data" title='auth_chunk::data' data-ref="auth_chunk::data" data-ref-filename="auth_chunk..data">data</a>))</td></tr>
<tr><th id="4354">4354</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4355">4355</th><td>		<i>/* no more RRs in this chunk */</i></td></tr>
<tr><th id="4356">4356</th><td>		<i>/* continue with next chunk, see if it has RRs */</i></td></tr>
<tr><th id="4357">4357</th><td>		<a class="local col4 ref" href="#1084rr_chunk" title='rr_chunk' data-ref="1084rr_chunk" data-ref-filename="1084rr_chunk">rr_chunk</a> = <a class="local col4 ref" href="#1084rr_chunk" title='rr_chunk' data-ref="1084rr_chunk" data-ref-filename="1084rr_chunk">rr_chunk</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::next" title='auth_chunk::next' data-ref="auth_chunk::next" data-ref-filename="auth_chunk..next">next</a>;</td></tr>
<tr><th id="4358">4358</th><td>		<a class="local col5 ref" href="#1085rr_num" title='rr_num' data-ref="1085rr_num" data-ref-filename="1085rr_num">rr_num</a> = <var>0</var>;</td></tr>
<tr><th id="4359">4359</th><td>	}</td></tr>
<tr><th id="4360">4360</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="4361">4361</th><td>}</td></tr>
<tr><th id="4362">4362</th><td></td></tr>
<tr><th id="4363">4363</th><td><i class="doc" data-doc="chunk_rrlist_gonext">/** RR list iterator, move to next RR */</i></td></tr>
<tr><th id="4364">4364</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="4365">4365</th><td><dfn class="tu decl def fn" id="chunk_rrlist_gonext" title='chunk_rrlist_gonext' data-type='void chunk_rrlist_gonext(struct auth_chunk ** rr_chunk, int * rr_num, size_t * rr_pos, size_t rr_nextpos)' data-ref="chunk_rrlist_gonext" data-ref-filename="chunk_rrlist_gonext">chunk_rrlist_gonext</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_chunk" title='auth_chunk' data-ref="auth_chunk" data-ref-filename="auth_chunk">auth_chunk</a>** <dfn class="local col6 decl" id="1086rr_chunk" title='rr_chunk' data-type='struct auth_chunk **' data-ref="1086rr_chunk" data-ref-filename="1086rr_chunk">rr_chunk</dfn>, <em>int</em>* <dfn class="local col7 decl" id="1087rr_num" title='rr_num' data-type='int *' data-ref="1087rr_num" data-ref-filename="1087rr_num">rr_num</dfn>,</td></tr>
<tr><th id="4366">4366</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>* <dfn class="local col8 decl" id="1088rr_pos" title='rr_pos' data-type='size_t *' data-ref="1088rr_pos" data-ref-filename="1088rr_pos">rr_pos</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col9 decl" id="1089rr_nextpos" title='rr_nextpos' data-type='size_t' data-ref="1089rr_nextpos" data-ref-filename="1089rr_nextpos">rr_nextpos</dfn>)</td></tr>
<tr><th id="4367">4367</th><td>{</td></tr>
<tr><th id="4368">4368</th><td>	<i>/* already at end of chunks? */</i></td></tr>
<tr><th id="4369">4369</th><td>	<b>if</b>(!*<a class="local col6 ref" href="#1086rr_chunk" title='rr_chunk' data-ref="1086rr_chunk" data-ref-filename="1086rr_chunk">rr_chunk</a>)</td></tr>
<tr><th id="4370">4370</th><td>		<b>return</b>;</td></tr>
<tr><th id="4371">4371</th><td>	<i>/* move within this chunk */</i></td></tr>
<tr><th id="4372">4372</th><td>	<b>if</b>((*<a class="local col6 ref" href="#1086rr_chunk" title='rr_chunk' data-ref="1086rr_chunk" data-ref-filename="1086rr_chunk">rr_chunk</a>)-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::len" title='auth_chunk::len' data-ref="auth_chunk::len" data-ref-filename="auth_chunk..len">len</a> &gt;= <a class="macro" href="../sldns/pkthdr.h.html#26" title="12" data-ref="_M/LDNS_HEADER_SIZE">LDNS_HEADER_SIZE</a> &amp;&amp;</td></tr>
<tr><th id="4373">4373</th><td>		(*<a class="local col7 ref" href="#1087rr_num" title='rr_num' data-ref="1087rr_num" data-ref-filename="1087rr_num">rr_num</a>)+<var>1</var> &lt; (<em>int</em>)<a class="macro" href="../sldns/pkthdr.h.html#103" title="(sldns_read_uint16((*rr_chunk)-&gt;data+6))" data-ref="_M/LDNS_ANCOUNT">LDNS_ANCOUNT</a>((*<a class="local col6 ref" href="#1086rr_chunk" title='rr_chunk' data-ref="1086rr_chunk" data-ref-filename="1086rr_chunk">rr_chunk</a>)-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::data" title='auth_chunk::data' data-ref="auth_chunk::data" data-ref-filename="auth_chunk..data">data</a>)) {</td></tr>
<tr><th id="4374">4374</th><td>		(*<a class="local col7 ref" href="#1087rr_num" title='rr_num' data-ref="1087rr_num" data-ref-filename="1087rr_num">rr_num</a>) += <var>1</var>;</td></tr>
<tr><th id="4375">4375</th><td>		*<a class="local col8 ref" href="#1088rr_pos" title='rr_pos' data-ref="1088rr_pos" data-ref-filename="1088rr_pos">rr_pos</a> = <a class="local col9 ref" href="#1089rr_nextpos" title='rr_nextpos' data-ref="1089rr_nextpos" data-ref-filename="1089rr_nextpos">rr_nextpos</a>;</td></tr>
<tr><th id="4376">4376</th><td>		<b>return</b>;</td></tr>
<tr><th id="4377">4377</th><td>	}</td></tr>
<tr><th id="4378">4378</th><td>	<i>/* no more RRs in this chunk */</i></td></tr>
<tr><th id="4379">4379</th><td>	<i>/* continue with next chunk, see if it has RRs */</i></td></tr>
<tr><th id="4380">4380</th><td>	<b>if</b>(*<a class="local col6 ref" href="#1086rr_chunk" title='rr_chunk' data-ref="1086rr_chunk" data-ref-filename="1086rr_chunk">rr_chunk</a>)</td></tr>
<tr><th id="4381">4381</th><td>		*<a class="local col6 ref" href="#1086rr_chunk" title='rr_chunk' data-ref="1086rr_chunk" data-ref-filename="1086rr_chunk">rr_chunk</a> = (*<a class="local col6 ref" href="#1086rr_chunk" title='rr_chunk' data-ref="1086rr_chunk" data-ref-filename="1086rr_chunk">rr_chunk</a>)-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::next" title='auth_chunk::next' data-ref="auth_chunk::next" data-ref-filename="auth_chunk..next">next</a>;</td></tr>
<tr><th id="4382">4382</th><td>	<b>while</b>(*<a class="local col6 ref" href="#1086rr_chunk" title='rr_chunk' data-ref="1086rr_chunk" data-ref-filename="1086rr_chunk">rr_chunk</a>) {</td></tr>
<tr><th id="4383">4383</th><td>		*<a class="local col7 ref" href="#1087rr_num" title='rr_num' data-ref="1087rr_num" data-ref-filename="1087rr_num">rr_num</a> = <var>0</var>;</td></tr>
<tr><th id="4384">4384</th><td>		*<a class="local col8 ref" href="#1088rr_pos" title='rr_pos' data-ref="1088rr_pos" data-ref-filename="1088rr_pos">rr_pos</a> = <var>0</var>;</td></tr>
<tr><th id="4385">4385</th><td>		<b>if</b>((*<a class="local col6 ref" href="#1086rr_chunk" title='rr_chunk' data-ref="1086rr_chunk" data-ref-filename="1086rr_chunk">rr_chunk</a>)-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::len" title='auth_chunk::len' data-ref="auth_chunk::len" data-ref-filename="auth_chunk..len">len</a> &gt;= <a class="macro" href="../sldns/pkthdr.h.html#26" title="12" data-ref="_M/LDNS_HEADER_SIZE">LDNS_HEADER_SIZE</a> &amp;&amp;</td></tr>
<tr><th id="4386">4386</th><td>			<a class="macro" href="../sldns/pkthdr.h.html#103" title="(sldns_read_uint16((*rr_chunk)-&gt;data+6))" data-ref="_M/LDNS_ANCOUNT">LDNS_ANCOUNT</a>((*<a class="local col6 ref" href="#1086rr_chunk" title='rr_chunk' data-ref="1086rr_chunk" data-ref-filename="1086rr_chunk">rr_chunk</a>)-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::data" title='auth_chunk::data' data-ref="auth_chunk::data" data-ref-filename="auth_chunk..data">data</a>) &gt; <var>0</var>) {</td></tr>
<tr><th id="4387">4387</th><td>			<b>return</b>;</td></tr>
<tr><th id="4388">4388</th><td>		}</td></tr>
<tr><th id="4389">4389</th><td>		*<a class="local col6 ref" href="#1086rr_chunk" title='rr_chunk' data-ref="1086rr_chunk" data-ref-filename="1086rr_chunk">rr_chunk</a> = (*<a class="local col6 ref" href="#1086rr_chunk" title='rr_chunk' data-ref="1086rr_chunk" data-ref-filename="1086rr_chunk">rr_chunk</a>)-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::next" title='auth_chunk::next' data-ref="auth_chunk::next" data-ref-filename="auth_chunk..next">next</a>;</td></tr>
<tr><th id="4390">4390</th><td>	}</td></tr>
<tr><th id="4391">4391</th><td>}</td></tr>
<tr><th id="4392">4392</th><td></td></tr>
<tr><th id="4393">4393</th><td><i class="doc" data-doc="chunk_rrlist_get_current">/** RR iterator, get current RR information, false on parse error */</i></td></tr>
<tr><th id="4394">4394</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="4395">4395</th><td><dfn class="tu decl def fn" id="chunk_rrlist_get_current" title='chunk_rrlist_get_current' data-type='int chunk_rrlist_get_current(struct auth_chunk * rr_chunk, int rr_num, size_t rr_pos, uint8_t ** rr_dname, uint16_t * rr_type, uint16_t * rr_class, uint32_t * rr_ttl, uint16_t * rr_rdlen, uint8_t ** rr_rdata, size_t * rr_nextpos)' data-ref="chunk_rrlist_get_current" data-ref-filename="chunk_rrlist_get_current">chunk_rrlist_get_current</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_chunk" title='auth_chunk' data-ref="auth_chunk" data-ref-filename="auth_chunk">auth_chunk</a>* <dfn class="local col0 decl" id="1090rr_chunk" title='rr_chunk' data-type='struct auth_chunk *' data-ref="1090rr_chunk" data-ref-filename="1090rr_chunk">rr_chunk</dfn>, <em>int</em> <dfn class="local col1 decl" id="1091rr_num" title='rr_num' data-type='int' data-ref="1091rr_num" data-ref-filename="1091rr_num">rr_num</dfn>,</td></tr>
<tr><th id="4396">4396</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col2 decl" id="1092rr_pos" title='rr_pos' data-type='size_t' data-ref="1092rr_pos" data-ref-filename="1092rr_pos">rr_pos</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>** <dfn class="local col3 decl" id="1093rr_dname" title='rr_dname' data-type='uint8_t **' data-ref="1093rr_dname" data-ref-filename="1093rr_dname">rr_dname</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a>* <dfn class="local col4 decl" id="1094rr_type" title='rr_type' data-type='uint16_t *' data-ref="1094rr_type" data-ref-filename="1094rr_type">rr_type</dfn>,</td></tr>
<tr><th id="4397">4397</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a>* <dfn class="local col5 decl" id="1095rr_class" title='rr_class' data-type='uint16_t *' data-ref="1095rr_class" data-ref-filename="1095rr_class">rr_class</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a>* <dfn class="local col6 decl" id="1096rr_ttl" title='rr_ttl' data-type='uint32_t *' data-ref="1096rr_ttl" data-ref-filename="1096rr_ttl">rr_ttl</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a>* <dfn class="local col7 decl" id="1097rr_rdlen" title='rr_rdlen' data-type='uint16_t *' data-ref="1097rr_rdlen" data-ref-filename="1097rr_rdlen">rr_rdlen</dfn>,</td></tr>
<tr><th id="4398">4398</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>** <dfn class="local col8 decl" id="1098rr_rdata" title='rr_rdata' data-type='uint8_t **' data-ref="1098rr_rdata" data-ref-filename="1098rr_rdata">rr_rdata</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>* <dfn class="local col9 decl" id="1099rr_nextpos" title='rr_nextpos' data-type='size_t *' data-ref="1099rr_nextpos" data-ref-filename="1099rr_nextpos">rr_nextpos</dfn>)</td></tr>
<tr><th id="4399">4399</th><td>{</td></tr>
<tr><th id="4400">4400</th><td>	<a class="typedef" href="../sldns/sbuffer.h.html#sldns_buffer" title='sldns_buffer' data-type='struct sldns_buffer' data-ref="sldns_buffer" data-ref-filename="sldns_buffer">sldns_buffer</a> <dfn class="local col0 decl" id="1100pkt" title='pkt' data-type='sldns_buffer' data-ref="1100pkt" data-ref-filename="1100pkt">pkt</dfn>;</td></tr>
<tr><th id="4401">4401</th><td>	<i>/* integrity checks on position */</i></td></tr>
<tr><th id="4402">4402</th><td>	<b>if</b>(!<a class="local col0 ref" href="#1090rr_chunk" title='rr_chunk' data-ref="1090rr_chunk" data-ref-filename="1090rr_chunk">rr_chunk</a>) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="4403">4403</th><td>	<b>if</b>(<a class="local col0 ref" href="#1090rr_chunk" title='rr_chunk' data-ref="1090rr_chunk" data-ref-filename="1090rr_chunk">rr_chunk</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::len" title='auth_chunk::len' data-ref="auth_chunk::len" data-ref-filename="auth_chunk..len">len</a> &lt; <a class="macro" href="../sldns/pkthdr.h.html#26" title="12" data-ref="_M/LDNS_HEADER_SIZE">LDNS_HEADER_SIZE</a>) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="4404">4404</th><td>	<b>if</b>(<a class="local col1 ref" href="#1091rr_num" title='rr_num' data-ref="1091rr_num" data-ref-filename="1091rr_num">rr_num</a> &gt;= (<em>int</em>)<a class="macro" href="../sldns/pkthdr.h.html#103" title="(sldns_read_uint16(rr_chunk-&gt;data+6))" data-ref="_M/LDNS_ANCOUNT">LDNS_ANCOUNT</a>(<a class="local col0 ref" href="#1090rr_chunk" title='rr_chunk' data-ref="1090rr_chunk" data-ref-filename="1090rr_chunk">rr_chunk</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::data" title='auth_chunk::data' data-ref="auth_chunk::data" data-ref-filename="auth_chunk..data">data</a>)) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="4405">4405</th><td>	<b>if</b>(<a class="local col2 ref" href="#1092rr_pos" title='rr_pos' data-ref="1092rr_pos" data-ref-filename="1092rr_pos">rr_pos</a> &gt;= <a class="local col0 ref" href="#1090rr_chunk" title='rr_chunk' data-ref="1090rr_chunk" data-ref-filename="1090rr_chunk">rr_chunk</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::len" title='auth_chunk::len' data-ref="auth_chunk::len" data-ref-filename="auth_chunk..len">len</a>) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="4406">4406</th><td></td></tr>
<tr><th id="4407">4407</th><td>	<i>/* fetch rr information */</i></td></tr>
<tr><th id="4408">4408</th><td>	<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_init_frm_data" title='sldns_buffer_init_frm_data' data-ref="sldns_buffer_init_frm_data" data-ref-filename="sldns_buffer_init_frm_data">sldns_buffer_init_frm_data</a>(&amp;<a class="local col0 ref" href="#1100pkt" title='pkt' data-ref="1100pkt" data-ref-filename="1100pkt">pkt</a>, <a class="local col0 ref" href="#1090rr_chunk" title='rr_chunk' data-ref="1090rr_chunk" data-ref-filename="1090rr_chunk">rr_chunk</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::data" title='auth_chunk::data' data-ref="auth_chunk::data" data-ref-filename="auth_chunk..data">data</a>, <a class="local col0 ref" href="#1090rr_chunk" title='rr_chunk' data-ref="1090rr_chunk" data-ref-filename="1090rr_chunk">rr_chunk</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::len" title='auth_chunk::len' data-ref="auth_chunk::len" data-ref-filename="auth_chunk..len">len</a>);</td></tr>
<tr><th id="4409">4409</th><td>	<b>if</b>(<a class="local col2 ref" href="#1092rr_pos" title='rr_pos' data-ref="1092rr_pos" data-ref-filename="1092rr_pos">rr_pos</a> == <var>0</var>) {</td></tr>
<tr><th id="4410">4410</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col1 decl" id="1101i" title='i' data-type='size_t' data-ref="1101i" data-ref-filename="1101i">i</dfn>;</td></tr>
<tr><th id="4411">4411</th><td>		<i>/* skip question section */</i></td></tr>
<tr><th id="4412">4412</th><td>		<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_set_position" title='sldns_buffer_set_position' data-ref="sldns_buffer_set_position" data-ref-filename="sldns_buffer_set_position">sldns_buffer_set_position</a>(&amp;<a class="local col0 ref" href="#1100pkt" title='pkt' data-ref="1100pkt" data-ref-filename="1100pkt">pkt</a>, <a class="macro" href="../sldns/pkthdr.h.html#26" title="12" data-ref="_M/LDNS_HEADER_SIZE">LDNS_HEADER_SIZE</a>);</td></tr>
<tr><th id="4413">4413</th><td>		<b>for</b>(<a class="local col1 ref" href="#1101i" title='i' data-ref="1101i" data-ref-filename="1101i">i</a>=<var>0</var>; <a class="local col1 ref" href="#1101i" title='i' data-ref="1101i" data-ref-filename="1101i">i</a>&lt;<a class="macro" href="../sldns/pkthdr.h.html#99" title="(sldns_read_uint16(rr_chunk-&gt;data+4))" data-ref="_M/LDNS_QDCOUNT">LDNS_QDCOUNT</a>(<a class="local col0 ref" href="#1090rr_chunk" title='rr_chunk' data-ref="1090rr_chunk" data-ref-filename="1090rr_chunk">rr_chunk</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::data" title='auth_chunk::data' data-ref="auth_chunk::data" data-ref-filename="auth_chunk..data">data</a>); <a class="local col1 ref" href="#1101i" title='i' data-ref="1101i" data-ref-filename="1101i">i</a>++) {</td></tr>
<tr><th id="4414">4414</th><td>			<b>if</b>(<a class="ref fn" href="../util/data/dname.h.html#pkt_dname_len" title='pkt_dname_len' data-ref="pkt_dname_len" data-ref-filename="pkt_dname_len">pkt_dname_len</a>(&amp;<a class="local col0 ref" href="#1100pkt" title='pkt' data-ref="1100pkt" data-ref-filename="1100pkt">pkt</a>) == <var>0</var>) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="4415">4415</th><td>			<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_remaining" title='sldns_buffer_remaining' data-ref="sldns_buffer_remaining" data-ref-filename="sldns_buffer_remaining">sldns_buffer_remaining</a>(&amp;<a class="local col0 ref" href="#1100pkt" title='pkt' data-ref="1100pkt" data-ref-filename="1100pkt">pkt</a>) &lt; <var>4</var>) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="4416">4416</th><td>			<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_skip" title='sldns_buffer_skip' data-ref="sldns_buffer_skip" data-ref-filename="sldns_buffer_skip">sldns_buffer_skip</a>(&amp;<a class="local col0 ref" href="#1100pkt" title='pkt' data-ref="1100pkt" data-ref-filename="1100pkt">pkt</a>, <var>4</var>); <i>/* type and class */</i></td></tr>
<tr><th id="4417">4417</th><td>		}</td></tr>
<tr><th id="4418">4418</th><td>	} <b>else</b>	{</td></tr>
<tr><th id="4419">4419</th><td>		<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_set_position" title='sldns_buffer_set_position' data-ref="sldns_buffer_set_position" data-ref-filename="sldns_buffer_set_position">sldns_buffer_set_position</a>(&amp;<a class="local col0 ref" href="#1100pkt" title='pkt' data-ref="1100pkt" data-ref-filename="1100pkt">pkt</a>, <a class="local col2 ref" href="#1092rr_pos" title='rr_pos' data-ref="1092rr_pos" data-ref-filename="1092rr_pos">rr_pos</a>);</td></tr>
<tr><th id="4420">4420</th><td>	}</td></tr>
<tr><th id="4421">4421</th><td>	*<a class="local col3 ref" href="#1093rr_dname" title='rr_dname' data-ref="1093rr_dname" data-ref-filename="1093rr_dname">rr_dname</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_current" title='sldns_buffer_current' data-ref="sldns_buffer_current" data-ref-filename="sldns_buffer_current">sldns_buffer_current</a>(&amp;<a class="local col0 ref" href="#1100pkt" title='pkt' data-ref="1100pkt" data-ref-filename="1100pkt">pkt</a>);</td></tr>
<tr><th id="4422">4422</th><td>	<b>if</b>(<a class="ref fn" href="../util/data/dname.h.html#pkt_dname_len" title='pkt_dname_len' data-ref="pkt_dname_len" data-ref-filename="pkt_dname_len">pkt_dname_len</a>(&amp;<a class="local col0 ref" href="#1100pkt" title='pkt' data-ref="1100pkt" data-ref-filename="1100pkt">pkt</a>) == <var>0</var>) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="4423">4423</th><td>	<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_remaining" title='sldns_buffer_remaining' data-ref="sldns_buffer_remaining" data-ref-filename="sldns_buffer_remaining">sldns_buffer_remaining</a>(&amp;<a class="local col0 ref" href="#1100pkt" title='pkt' data-ref="1100pkt" data-ref-filename="1100pkt">pkt</a>) &lt; <var>10</var>) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="4424">4424</th><td>	*<a class="local col4 ref" href="#1094rr_type" title='rr_type' data-ref="1094rr_type" data-ref-filename="1094rr_type">rr_type</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u16" title='sldns_buffer_read_u16' data-ref="sldns_buffer_read_u16" data-ref-filename="sldns_buffer_read_u16">sldns_buffer_read_u16</a>(&amp;<a class="local col0 ref" href="#1100pkt" title='pkt' data-ref="1100pkt" data-ref-filename="1100pkt">pkt</a>);</td></tr>
<tr><th id="4425">4425</th><td>	*<a class="local col5 ref" href="#1095rr_class" title='rr_class' data-ref="1095rr_class" data-ref-filename="1095rr_class">rr_class</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u16" title='sldns_buffer_read_u16' data-ref="sldns_buffer_read_u16" data-ref-filename="sldns_buffer_read_u16">sldns_buffer_read_u16</a>(&amp;<a class="local col0 ref" href="#1100pkt" title='pkt' data-ref="1100pkt" data-ref-filename="1100pkt">pkt</a>);</td></tr>
<tr><th id="4426">4426</th><td>	*<a class="local col6 ref" href="#1096rr_ttl" title='rr_ttl' data-ref="1096rr_ttl" data-ref-filename="1096rr_ttl">rr_ttl</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u32" title='sldns_buffer_read_u32' data-ref="sldns_buffer_read_u32" data-ref-filename="sldns_buffer_read_u32">sldns_buffer_read_u32</a>(&amp;<a class="local col0 ref" href="#1100pkt" title='pkt' data-ref="1100pkt" data-ref-filename="1100pkt">pkt</a>);</td></tr>
<tr><th id="4427">4427</th><td>	*<a class="local col7 ref" href="#1097rr_rdlen" title='rr_rdlen' data-ref="1097rr_rdlen" data-ref-filename="1097rr_rdlen">rr_rdlen</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u16" title='sldns_buffer_read_u16' data-ref="sldns_buffer_read_u16" data-ref-filename="sldns_buffer_read_u16">sldns_buffer_read_u16</a>(&amp;<a class="local col0 ref" href="#1100pkt" title='pkt' data-ref="1100pkt" data-ref-filename="1100pkt">pkt</a>);</td></tr>
<tr><th id="4428">4428</th><td>	<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_remaining" title='sldns_buffer_remaining' data-ref="sldns_buffer_remaining" data-ref-filename="sldns_buffer_remaining">sldns_buffer_remaining</a>(&amp;<a class="local col0 ref" href="#1100pkt" title='pkt' data-ref="1100pkt" data-ref-filename="1100pkt">pkt</a>) &lt; (*<a class="local col7 ref" href="#1097rr_rdlen" title='rr_rdlen' data-ref="1097rr_rdlen" data-ref-filename="1097rr_rdlen">rr_rdlen</a>)) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="4429">4429</th><td>	*<a class="local col8 ref" href="#1098rr_rdata" title='rr_rdata' data-ref="1098rr_rdata" data-ref-filename="1098rr_rdata">rr_rdata</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_current" title='sldns_buffer_current' data-ref="sldns_buffer_current" data-ref-filename="sldns_buffer_current">sldns_buffer_current</a>(&amp;<a class="local col0 ref" href="#1100pkt" title='pkt' data-ref="1100pkt" data-ref-filename="1100pkt">pkt</a>);</td></tr>
<tr><th id="4430">4430</th><td>	<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_skip" title='sldns_buffer_skip' data-ref="sldns_buffer_skip" data-ref-filename="sldns_buffer_skip">sldns_buffer_skip</a>(&amp;<a class="local col0 ref" href="#1100pkt" title='pkt' data-ref="1100pkt" data-ref-filename="1100pkt">pkt</a>, (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#ssize_t" title='ssize_t' data-type='int' data-ref="ssize_t" data-ref-filename="ssize_t">ssize_t</a>)(*<a class="local col7 ref" href="#1097rr_rdlen" title='rr_rdlen' data-ref="1097rr_rdlen" data-ref-filename="1097rr_rdlen">rr_rdlen</a>));</td></tr>
<tr><th id="4431">4431</th><td>	*<a class="local col9 ref" href="#1099rr_nextpos" title='rr_nextpos' data-ref="1099rr_nextpos" data-ref-filename="1099rr_nextpos">rr_nextpos</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_position" title='sldns_buffer_position' data-ref="sldns_buffer_position" data-ref-filename="sldns_buffer_position">sldns_buffer_position</a>(&amp;<a class="local col0 ref" href="#1100pkt" title='pkt' data-ref="1100pkt" data-ref-filename="1100pkt">pkt</a>);</td></tr>
<tr><th id="4432">4432</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="4433">4433</th><td>}</td></tr>
<tr><th id="4434">4434</th><td></td></tr>
<tr><th id="4435">4435</th><td><i class="doc" data-doc="log_rrlist_position">/** print log message where we are in parsing the zone transfer */</i></td></tr>
<tr><th id="4436">4436</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="4437">4437</th><td><dfn class="tu decl def fn" id="log_rrlist_position" title='log_rrlist_position' data-type='void log_rrlist_position(const char * label, struct auth_chunk * rr_chunk, uint8_t * rr_dname, uint16_t rr_type, size_t rr_counter)' data-ref="log_rrlist_position" data-ref-filename="log_rrlist_position">log_rrlist_position</dfn>(<em>const</em> <em>char</em>* <dfn class="local col2 decl" id="1102label" title='label' data-type='const char *' data-ref="1102label" data-ref-filename="1102label">label</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_chunk" title='auth_chunk' data-ref="auth_chunk" data-ref-filename="auth_chunk">auth_chunk</a>* <dfn class="local col3 decl" id="1103rr_chunk" title='rr_chunk' data-type='struct auth_chunk *' data-ref="1103rr_chunk" data-ref-filename="1103rr_chunk">rr_chunk</dfn>,</td></tr>
<tr><th id="4438">4438</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col4 decl" id="1104rr_dname" title='rr_dname' data-type='uint8_t *' data-ref="1104rr_dname" data-ref-filename="1104rr_dname">rr_dname</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col5 decl" id="1105rr_type" title='rr_type' data-type='uint16_t' data-ref="1105rr_type" data-ref-filename="1105rr_type">rr_type</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col6 decl" id="1106rr_counter" title='rr_counter' data-type='size_t' data-ref="1106rr_counter" data-ref-filename="1106rr_counter">rr_counter</dfn>)</td></tr>
<tr><th id="4439">4439</th><td>{</td></tr>
<tr><th id="4440">4440</th><td>	<a class="typedef" href="../sldns/sbuffer.h.html#sldns_buffer" title='sldns_buffer' data-type='struct sldns_buffer' data-ref="sldns_buffer" data-ref-filename="sldns_buffer">sldns_buffer</a> <dfn class="local col7 decl" id="1107pkt" title='pkt' data-type='sldns_buffer' data-ref="1107pkt" data-ref-filename="1107pkt">pkt</dfn>;</td></tr>
<tr><th id="4441">4441</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col8 decl" id="1108dlen" title='dlen' data-type='size_t' data-ref="1108dlen" data-ref-filename="1108dlen">dlen</dfn>;</td></tr>
<tr><th id="4442">4442</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a> <dfn class="local col9 decl" id="1109buf" title='buf' data-type='uint8_t [256]' data-ref="1109buf" data-ref-filename="1109buf">buf</dfn>[<var>256</var>];</td></tr>
<tr><th id="4443">4443</th><td>	<em>char</em> <dfn class="local col0 decl" id="1110str" title='str' data-type='char [256]' data-ref="1110str" data-ref-filename="1110str">str</dfn>[<var>256</var>];</td></tr>
<tr><th id="4444">4444</th><td>	<em>char</em> <dfn class="local col1 decl" id="1111typestr" title='typestr' data-type='char [32]' data-ref="1111typestr" data-ref-filename="1111typestr">typestr</dfn>[<var>32</var>];</td></tr>
<tr><th id="4445">4445</th><td>	<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_init_frm_data" title='sldns_buffer_init_frm_data' data-ref="sldns_buffer_init_frm_data" data-ref-filename="sldns_buffer_init_frm_data">sldns_buffer_init_frm_data</a>(&amp;<a class="local col7 ref" href="#1107pkt" title='pkt' data-ref="1107pkt" data-ref-filename="1107pkt">pkt</a>, <a class="local col3 ref" href="#1103rr_chunk" title='rr_chunk' data-ref="1103rr_chunk" data-ref-filename="1103rr_chunk">rr_chunk</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::data" title='auth_chunk::data' data-ref="auth_chunk::data" data-ref-filename="auth_chunk..data">data</a>, <a class="local col3 ref" href="#1103rr_chunk" title='rr_chunk' data-ref="1103rr_chunk" data-ref-filename="1103rr_chunk">rr_chunk</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::len" title='auth_chunk::len' data-ref="auth_chunk::len" data-ref-filename="auth_chunk..len">len</a>);</td></tr>
<tr><th id="4446">4446</th><td>	<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_set_position" title='sldns_buffer_set_position' data-ref="sldns_buffer_set_position" data-ref-filename="sldns_buffer_set_position">sldns_buffer_set_position</a>(&amp;<a class="local col7 ref" href="#1107pkt" title='pkt' data-ref="1107pkt" data-ref-filename="1107pkt">pkt</a>, (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>)(<a class="local col4 ref" href="#1104rr_dname" title='rr_dname' data-ref="1104rr_dname" data-ref-filename="1104rr_dname">rr_dname</a> -</td></tr>
<tr><th id="4447">4447</th><td>		<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_begin" title='sldns_buffer_begin' data-ref="sldns_buffer_begin" data-ref-filename="sldns_buffer_begin">sldns_buffer_begin</a>(&amp;<a class="local col7 ref" href="#1107pkt" title='pkt' data-ref="1107pkt" data-ref-filename="1107pkt">pkt</a>)));</td></tr>
<tr><th id="4448">4448</th><td>	<b>if</b>((<a class="local col8 ref" href="#1108dlen" title='dlen' data-ref="1108dlen" data-ref-filename="1108dlen">dlen</a>=<a class="ref fn" href="../util/data/dname.h.html#pkt_dname_len" title='pkt_dname_len' data-ref="pkt_dname_len" data-ref-filename="pkt_dname_len">pkt_dname_len</a>(&amp;<a class="local col7 ref" href="#1107pkt" title='pkt' data-ref="1107pkt" data-ref-filename="1107pkt">pkt</a>)) == <var>0</var>) <b>return</b>;</td></tr>
<tr><th id="4449">4449</th><td>	<b>if</b>(<a class="local col8 ref" href="#1108dlen" title='dlen' data-ref="1108dlen" data-ref-filename="1108dlen">dlen</a> &gt;= <b>sizeof</b>(<a class="local col9 ref" href="#1109buf" title='buf' data-ref="1109buf" data-ref-filename="1109buf">buf</a>)) <b>return</b>;</td></tr>
<tr><th id="4450">4450</th><td>	<a class="ref fn" href="../util/data/dname.h.html#dname_pkt_copy" title='dname_pkt_copy' data-ref="dname_pkt_copy" data-ref-filename="dname_pkt_copy">dname_pkt_copy</a>(&amp;<a class="local col7 ref" href="#1107pkt" title='pkt' data-ref="1107pkt" data-ref-filename="1107pkt">pkt</a>, <a class="local col9 ref" href="#1109buf" title='buf' data-ref="1109buf" data-ref-filename="1109buf">buf</a>, <a class="local col4 ref" href="#1104rr_dname" title='rr_dname' data-ref="1104rr_dname" data-ref-filename="1104rr_dname">rr_dname</a>);</td></tr>
<tr><th id="4451">4451</th><td>	<a class="ref fn" href="../util/data/dname.h.html#dname_str" title='dname_str' data-ref="dname_str" data-ref-filename="dname_str">dname_str</a>(<a class="local col9 ref" href="#1109buf" title='buf' data-ref="1109buf" data-ref-filename="1109buf">buf</a>, <a class="local col0 ref" href="#1110str" title='str' data-ref="1110str" data-ref-filename="1110str">str</a>);</td></tr>
<tr><th id="4452">4452</th><td>	(<em>void</em>)<a class="ref fn" href="../sldns/wire2str.h.html#sldns_wire2str_type_buf" title='sldns_wire2str_type_buf' data-ref="sldns_wire2str_type_buf" data-ref-filename="sldns_wire2str_type_buf">sldns_wire2str_type_buf</a>(<a class="local col5 ref" href="#1105rr_type" title='rr_type' data-ref="1105rr_type" data-ref-filename="1105rr_type">rr_type</a>, <a class="local col1 ref" href="#1111typestr" title='typestr' data-ref="1111typestr" data-ref-filename="1111typestr">typestr</a>, <b>sizeof</b>(<a class="local col1 ref" href="#1111typestr" title='typestr' data-ref="1111typestr" data-ref-filename="1111typestr">typestr</a>));</td></tr>
<tr><th id="4453">4453</th><td>	<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"%s at[%d] %s %s"</q>, <a class="local col2 ref" href="#1102label" title='label' data-ref="1102label" data-ref-filename="1102label">label</a>, (<em>int</em>)<a class="local col6 ref" href="#1106rr_counter" title='rr_counter' data-ref="1106rr_counter" data-ref-filename="1106rr_counter">rr_counter</a>,</td></tr>
<tr><th id="4454">4454</th><td>		<a class="local col0 ref" href="#1110str" title='str' data-ref="1110str" data-ref-filename="1110str">str</a>, <a class="local col1 ref" href="#1111typestr" title='typestr' data-ref="1111typestr" data-ref-filename="1111typestr">typestr</a>);</td></tr>
<tr><th id="4455">4455</th><td>}</td></tr>
<tr><th id="4456">4456</th><td></td></tr>
<tr><th id="4457">4457</th><td><i class="doc" data-doc="ixfr_start_serial">/** check that start serial is OK for ixfr. we are at rr_counter == 0,</i></td></tr>
<tr><th id="4458">4458</th><td><i class="doc" data-doc="ixfr_start_serial"> * and we are going to check rr_counter == 1 (has to be type SOA) serial */</i></td></tr>
<tr><th id="4459">4459</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="4460">4460</th><td><dfn class="tu decl def fn" id="ixfr_start_serial" title='ixfr_start_serial' data-type='int ixfr_start_serial(struct auth_chunk * rr_chunk, int rr_num, size_t rr_pos, uint8_t * rr_dname, uint16_t rr_type, uint16_t rr_class, uint32_t rr_ttl, uint16_t rr_rdlen, uint8_t * rr_rdata, size_t rr_nextpos, uint32_t transfer_serial, uint32_t xfr_serial)' data-ref="ixfr_start_serial" data-ref-filename="ixfr_start_serial">ixfr_start_serial</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_chunk" title='auth_chunk' data-ref="auth_chunk" data-ref-filename="auth_chunk">auth_chunk</a>* <dfn class="local col2 decl" id="1112rr_chunk" title='rr_chunk' data-type='struct auth_chunk *' data-ref="1112rr_chunk" data-ref-filename="1112rr_chunk">rr_chunk</dfn>, <em>int</em> <dfn class="local col3 decl" id="1113rr_num" title='rr_num' data-type='int' data-ref="1113rr_num" data-ref-filename="1113rr_num">rr_num</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col4 decl" id="1114rr_pos" title='rr_pos' data-type='size_t' data-ref="1114rr_pos" data-ref-filename="1114rr_pos">rr_pos</dfn>,</td></tr>
<tr><th id="4461">4461</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col5 decl" id="1115rr_dname" title='rr_dname' data-type='uint8_t *' data-ref="1115rr_dname" data-ref-filename="1115rr_dname">rr_dname</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col6 decl" id="1116rr_type" title='rr_type' data-type='uint16_t' data-ref="1116rr_type" data-ref-filename="1116rr_type">rr_type</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col7 decl" id="1117rr_class" title='rr_class' data-type='uint16_t' data-ref="1117rr_class" data-ref-filename="1117rr_class">rr_class</dfn>,</td></tr>
<tr><th id="4462">4462</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a> <dfn class="local col8 decl" id="1118rr_ttl" title='rr_ttl' data-type='uint32_t' data-ref="1118rr_ttl" data-ref-filename="1118rr_ttl">rr_ttl</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col9 decl" id="1119rr_rdlen" title='rr_rdlen' data-type='uint16_t' data-ref="1119rr_rdlen" data-ref-filename="1119rr_rdlen">rr_rdlen</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col0 decl" id="1120rr_rdata" title='rr_rdata' data-type='uint8_t *' data-ref="1120rr_rdata" data-ref-filename="1120rr_rdata">rr_rdata</dfn>,</td></tr>
<tr><th id="4463">4463</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col1 decl" id="1121rr_nextpos" title='rr_nextpos' data-type='size_t' data-ref="1121rr_nextpos" data-ref-filename="1121rr_nextpos">rr_nextpos</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a> <dfn class="local col2 decl" id="1122transfer_serial" title='transfer_serial' data-type='uint32_t' data-ref="1122transfer_serial" data-ref-filename="1122transfer_serial">transfer_serial</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a> <dfn class="local col3 decl" id="1123xfr_serial" title='xfr_serial' data-type='uint32_t' data-ref="1123xfr_serial" data-ref-filename="1123xfr_serial">xfr_serial</dfn>)</td></tr>
<tr><th id="4464">4464</th><td>{</td></tr>
<tr><th id="4465">4465</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a> <dfn class="local col4 decl" id="1124startserial" title='startserial' data-type='uint32_t' data-ref="1124startserial" data-ref-filename="1124startserial">startserial</dfn>;</td></tr>
<tr><th id="4466">4466</th><td>	<i>/* move forward on RR */</i></td></tr>
<tr><th id="4467">4467</th><td>	<a class="tu ref fn" href="#chunk_rrlist_gonext" title='chunk_rrlist_gonext' data-use='c' data-ref="chunk_rrlist_gonext" data-ref-filename="chunk_rrlist_gonext">chunk_rrlist_gonext</a>(&amp;<a class="local col2 ref" href="#1112rr_chunk" title='rr_chunk' data-ref="1112rr_chunk" data-ref-filename="1112rr_chunk">rr_chunk</a>, &amp;<a class="local col3 ref" href="#1113rr_num" title='rr_num' data-ref="1113rr_num" data-ref-filename="1113rr_num">rr_num</a>, &amp;<a class="local col4 ref" href="#1114rr_pos" title='rr_pos' data-ref="1114rr_pos" data-ref-filename="1114rr_pos">rr_pos</a>, <a class="local col1 ref" href="#1121rr_nextpos" title='rr_nextpos' data-ref="1121rr_nextpos" data-ref-filename="1121rr_nextpos">rr_nextpos</a>);</td></tr>
<tr><th id="4468">4468</th><td>	<b>if</b>(<a class="tu ref fn" href="#chunk_rrlist_end" title='chunk_rrlist_end' data-use='c' data-ref="chunk_rrlist_end" data-ref-filename="chunk_rrlist_end">chunk_rrlist_end</a>(<a class="local col2 ref" href="#1112rr_chunk" title='rr_chunk' data-ref="1112rr_chunk" data-ref-filename="1112rr_chunk">rr_chunk</a>, <a class="local col3 ref" href="#1113rr_num" title='rr_num' data-ref="1113rr_num" data-ref-filename="1113rr_num">rr_num</a>)) {</td></tr>
<tr><th id="4469">4469</th><td>		<i>/* no second SOA */</i></td></tr>
<tr><th id="4470">4470</th><td>		<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_OPS" title='VERB_OPS' data-ref="VERB_OPS" data-ref-filename="VERB_OPS">VERB_OPS</a>, <q>"IXFR has no second SOA record"</q>);</td></tr>
<tr><th id="4471">4471</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4472">4472</th><td>	}</td></tr>
<tr><th id="4473">4473</th><td>	<b>if</b>(!<a class="tu ref fn" href="#chunk_rrlist_get_current" title='chunk_rrlist_get_current' data-use='c' data-ref="chunk_rrlist_get_current" data-ref-filename="chunk_rrlist_get_current">chunk_rrlist_get_current</a>(<a class="local col2 ref" href="#1112rr_chunk" title='rr_chunk' data-ref="1112rr_chunk" data-ref-filename="1112rr_chunk">rr_chunk</a>, <a class="local col3 ref" href="#1113rr_num" title='rr_num' data-ref="1113rr_num" data-ref-filename="1113rr_num">rr_num</a>, <a class="local col4 ref" href="#1114rr_pos" title='rr_pos' data-ref="1114rr_pos" data-ref-filename="1114rr_pos">rr_pos</a>,</td></tr>
<tr><th id="4474">4474</th><td>		&amp;<a class="local col5 ref" href="#1115rr_dname" title='rr_dname' data-ref="1115rr_dname" data-ref-filename="1115rr_dname">rr_dname</a>, &amp;<a class="local col6 ref" href="#1116rr_type" title='rr_type' data-ref="1116rr_type" data-ref-filename="1116rr_type">rr_type</a>, &amp;<a class="local col7 ref" href="#1117rr_class" title='rr_class' data-ref="1117rr_class" data-ref-filename="1117rr_class">rr_class</a>, &amp;<a class="local col8 ref" href="#1118rr_ttl" title='rr_ttl' data-ref="1118rr_ttl" data-ref-filename="1118rr_ttl">rr_ttl</a>, &amp;<a class="local col9 ref" href="#1119rr_rdlen" title='rr_rdlen' data-ref="1119rr_rdlen" data-ref-filename="1119rr_rdlen">rr_rdlen</a>,</td></tr>
<tr><th id="4475">4475</th><td>		&amp;<a class="local col0 ref" href="#1120rr_rdata" title='rr_rdata' data-ref="1120rr_rdata" data-ref-filename="1120rr_rdata">rr_rdata</a>, &amp;<a class="local col1 ref" href="#1121rr_nextpos" title='rr_nextpos' data-ref="1121rr_nextpos" data-ref-filename="1121rr_nextpos">rr_nextpos</a>)) {</td></tr>
<tr><th id="4476">4476</th><td>		<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_OPS" title='VERB_OPS' data-ref="VERB_OPS" data-ref-filename="VERB_OPS">VERB_OPS</a>, <q>"IXFR cannot parse second SOA record"</q>);</td></tr>
<tr><th id="4477">4477</th><td>		<i>/* failed to parse RR */</i></td></tr>
<tr><th id="4478">4478</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4479">4479</th><td>	}</td></tr>
<tr><th id="4480">4480</th><td>	<b>if</b>(<a class="local col6 ref" href="#1116rr_type" title='rr_type' data-ref="1116rr_type" data-ref-filename="1116rr_type">rr_type</a> != <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_SOA" title='LDNS_RR_TYPE_SOA' data-ref="LDNS_RR_TYPE_SOA" data-ref-filename="LDNS_RR_TYPE_SOA">LDNS_RR_TYPE_SOA</a>) {</td></tr>
<tr><th id="4481">4481</th><td>		<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_OPS" title='VERB_OPS' data-ref="VERB_OPS" data-ref-filename="VERB_OPS">VERB_OPS</a>, <q>"IXFR second record is not type SOA"</q>);</td></tr>
<tr><th id="4482">4482</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4483">4483</th><td>	}</td></tr>
<tr><th id="4484">4484</th><td>	<b>if</b>(<a class="local col9 ref" href="#1119rr_rdlen" title='rr_rdlen' data-ref="1119rr_rdlen" data-ref-filename="1119rr_rdlen">rr_rdlen</a> &lt; <var>22</var>) {</td></tr>
<tr><th id="4485">4485</th><td>		<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_OPS" title='VERB_OPS' data-ref="VERB_OPS" data-ref-filename="VERB_OPS">VERB_OPS</a>, <q>"IXFR, second SOA has short rdlength"</q>);</td></tr>
<tr><th id="4486">4486</th><td>		<b>return</b> <var>0</var>; <i>/* bad SOA rdlen */</i></td></tr>
<tr><th id="4487">4487</th><td>	}</td></tr>
<tr><th id="4488">4488</th><td>	<a class="local col4 ref" href="#1124startserial" title='startserial' data-ref="1124startserial" data-ref-filename="1124startserial">startserial</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_read_uint32" title='sldns_read_uint32' data-ref="sldns_read_uint32" data-ref-filename="sldns_read_uint32">sldns_read_uint32</a>(<a class="local col0 ref" href="#1120rr_rdata" title='rr_rdata' data-ref="1120rr_rdata" data-ref-filename="1120rr_rdata">rr_rdata</a>+<a class="local col9 ref" href="#1119rr_rdlen" title='rr_rdlen' data-ref="1119rr_rdlen" data-ref-filename="1119rr_rdlen">rr_rdlen</a>-<var>20</var>);</td></tr>
<tr><th id="4489">4489</th><td>	<b>if</b>(<a class="local col4 ref" href="#1124startserial" title='startserial' data-ref="1124startserial" data-ref-filename="1124startserial">startserial</a> == <a class="local col2 ref" href="#1122transfer_serial" title='transfer_serial' data-ref="1122transfer_serial" data-ref-filename="1122transfer_serial">transfer_serial</a>) {</td></tr>
<tr><th id="4490">4490</th><td>		<i>/* empty AXFR, not an IXFR */</i></td></tr>
<tr><th id="4491">4491</th><td>		<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_OPS" title='VERB_OPS' data-ref="VERB_OPS" data-ref-filename="VERB_OPS">VERB_OPS</a>, <q>"IXFR second serial same as first"</q>);</td></tr>
<tr><th id="4492">4492</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4493">4493</th><td>	}</td></tr>
<tr><th id="4494">4494</th><td>	<b>if</b>(<a class="local col4 ref" href="#1124startserial" title='startserial' data-ref="1124startserial" data-ref-filename="1124startserial">startserial</a> != <a class="local col3 ref" href="#1123xfr_serial" title='xfr_serial' data-ref="1123xfr_serial" data-ref-filename="1123xfr_serial">xfr_serial</a>) {</td></tr>
<tr><th id="4495">4495</th><td>		<i>/* wrong start serial, it does not match the serial in</i></td></tr>
<tr><th id="4496">4496</th><td><i>		 * memory */</i></td></tr>
<tr><th id="4497">4497</th><td>		<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_OPS" title='VERB_OPS' data-ref="VERB_OPS" data-ref-filename="VERB_OPS">VERB_OPS</a>, <q>"IXFR is from serial %u to %u but %u "</q></td></tr>
<tr><th id="4498">4498</th><td>			<q>"in memory, rejecting the zone transfer"</q>,</td></tr>
<tr><th id="4499">4499</th><td>			(<em>unsigned</em>)<a class="local col4 ref" href="#1124startserial" title='startserial' data-ref="1124startserial" data-ref-filename="1124startserial">startserial</a>, (<em>unsigned</em>)<a class="local col2 ref" href="#1122transfer_serial" title='transfer_serial' data-ref="1122transfer_serial" data-ref-filename="1122transfer_serial">transfer_serial</a>,</td></tr>
<tr><th id="4500">4500</th><td>			(<em>unsigned</em>)<a class="local col3 ref" href="#1123xfr_serial" title='xfr_serial' data-ref="1123xfr_serial" data-ref-filename="1123xfr_serial">xfr_serial</a>);</td></tr>
<tr><th id="4501">4501</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4502">4502</th><td>	}</td></tr>
<tr><th id="4503">4503</th><td>	<i>/* everything OK in second SOA serial */</i></td></tr>
<tr><th id="4504">4504</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="4505">4505</th><td>}</td></tr>
<tr><th id="4506">4506</th><td></td></tr>
<tr><th id="4507">4507</th><td><i class="doc" data-doc="apply_ixfr">/** apply IXFR to zone in memory. z is locked. false on failure(mallocfail) */</i></td></tr>
<tr><th id="4508">4508</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="4509">4509</th><td><dfn class="tu decl def fn" id="apply_ixfr" title='apply_ixfr' data-type='int apply_ixfr(struct auth_xfer * xfr, struct auth_zone * z, struct sldns_buffer * scratch_buffer)' data-ref="apply_ixfr" data-ref-filename="apply_ixfr">apply_ixfr</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col5 decl" id="1125xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1125xfr" data-ref-filename="1125xfr">xfr</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col6 decl" id="1126z" title='z' data-type='struct auth_zone *' data-ref="1126z" data-ref-filename="1126z">z</dfn>,</td></tr>
<tr><th id="4510">4510</th><td>	<b>struct</b> <a class="type" href="../sldns/sbuffer.h.html#sldns_buffer" title='sldns_buffer' data-ref="sldns_buffer" data-ref-filename="sldns_buffer">sldns_buffer</a>* <dfn class="local col7 decl" id="1127scratch_buffer" title='scratch_buffer' data-type='struct sldns_buffer *' data-ref="1127scratch_buffer" data-ref-filename="1127scratch_buffer">scratch_buffer</dfn>)</td></tr>
<tr><th id="4511">4511</th><td>{</td></tr>
<tr><th id="4512">4512</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_chunk" title='auth_chunk' data-ref="auth_chunk" data-ref-filename="auth_chunk">auth_chunk</a>* <dfn class="local col8 decl" id="1128rr_chunk" title='rr_chunk' data-type='struct auth_chunk *' data-ref="1128rr_chunk" data-ref-filename="1128rr_chunk">rr_chunk</dfn>;</td></tr>
<tr><th id="4513">4513</th><td>	<em>int</em> <dfn class="local col9 decl" id="1129rr_num" title='rr_num' data-type='int' data-ref="1129rr_num" data-ref-filename="1129rr_num">rr_num</dfn>;</td></tr>
<tr><th id="4514">4514</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col0 decl" id="1130rr_pos" title='rr_pos' data-type='size_t' data-ref="1130rr_pos" data-ref-filename="1130rr_pos">rr_pos</dfn>;</td></tr>
<tr><th id="4515">4515</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col1 decl" id="1131rr_dname" title='rr_dname' data-type='uint8_t *' data-ref="1131rr_dname" data-ref-filename="1131rr_dname">rr_dname</dfn>, *<dfn class="local col2 decl" id="1132rr_rdata" title='rr_rdata' data-type='uint8_t *' data-ref="1132rr_rdata" data-ref-filename="1132rr_rdata">rr_rdata</dfn>;</td></tr>
<tr><th id="4516">4516</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col3 decl" id="1133rr_type" title='rr_type' data-type='uint16_t' data-ref="1133rr_type" data-ref-filename="1133rr_type">rr_type</dfn>, <dfn class="local col4 decl" id="1134rr_class" title='rr_class' data-type='uint16_t' data-ref="1134rr_class" data-ref-filename="1134rr_class">rr_class</dfn>, <dfn class="local col5 decl" id="1135rr_rdlen" title='rr_rdlen' data-type='uint16_t' data-ref="1135rr_rdlen" data-ref-filename="1135rr_rdlen">rr_rdlen</dfn>;</td></tr>
<tr><th id="4517">4517</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a> <dfn class="local col6 decl" id="1136rr_ttl" title='rr_ttl' data-type='uint32_t' data-ref="1136rr_ttl" data-ref-filename="1136rr_ttl">rr_ttl</dfn>;</td></tr>
<tr><th id="4518">4518</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col7 decl" id="1137rr_nextpos" title='rr_nextpos' data-type='size_t' data-ref="1137rr_nextpos" data-ref-filename="1137rr_nextpos">rr_nextpos</dfn>;</td></tr>
<tr><th id="4519">4519</th><td>	<em>int</em> <dfn class="local col8 decl" id="1138have_transfer_serial" title='have_transfer_serial' data-type='int' data-ref="1138have_transfer_serial" data-ref-filename="1138have_transfer_serial">have_transfer_serial</dfn> = <var>0</var>;</td></tr>
<tr><th id="4520">4520</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a> <dfn class="local col9 decl" id="1139transfer_serial" title='transfer_serial' data-type='uint32_t' data-ref="1139transfer_serial" data-ref-filename="1139transfer_serial">transfer_serial</dfn> = <var>0</var>;</td></tr>
<tr><th id="4521">4521</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col0 decl" id="1140rr_counter" title='rr_counter' data-type='size_t' data-ref="1140rr_counter" data-ref-filename="1140rr_counter">rr_counter</dfn> = <var>0</var>;</td></tr>
<tr><th id="4522">4522</th><td>	<em>int</em> <dfn class="local col1 decl" id="1141delmode" title='delmode' data-type='int' data-ref="1141delmode" data-ref-filename="1141delmode">delmode</dfn> = <var>0</var>;</td></tr>
<tr><th id="4523">4523</th><td>	<em>int</em> <dfn class="local col2 decl" id="1142softfail" title='softfail' data-type='int' data-ref="1142softfail" data-ref-filename="1142softfail">softfail</dfn> = <var>0</var>;</td></tr>
<tr><th id="4524">4524</th><td></td></tr>
<tr><th id="4525">4525</th><td>	<i>/* start RR iterator over chunklist of packets */</i></td></tr>
<tr><th id="4526">4526</th><td>	<a class="tu ref fn" href="#chunk_rrlist_start" title='chunk_rrlist_start' data-use='c' data-ref="chunk_rrlist_start" data-ref-filename="chunk_rrlist_start">chunk_rrlist_start</a>(<a class="local col5 ref" href="#1125xfr" title='xfr' data-ref="1125xfr" data-ref-filename="1125xfr">xfr</a>, &amp;<a class="local col8 ref" href="#1128rr_chunk" title='rr_chunk' data-ref="1128rr_chunk" data-ref-filename="1128rr_chunk">rr_chunk</a>, &amp;<a class="local col9 ref" href="#1129rr_num" title='rr_num' data-ref="1129rr_num" data-ref-filename="1129rr_num">rr_num</a>, &amp;<a class="local col0 ref" href="#1130rr_pos" title='rr_pos' data-ref="1130rr_pos" data-ref-filename="1130rr_pos">rr_pos</a>);</td></tr>
<tr><th id="4527">4527</th><td>	<b>while</b>(!<a class="tu ref fn" href="#chunk_rrlist_end" title='chunk_rrlist_end' data-use='c' data-ref="chunk_rrlist_end" data-ref-filename="chunk_rrlist_end">chunk_rrlist_end</a>(<a class="local col8 ref" href="#1128rr_chunk" title='rr_chunk' data-ref="1128rr_chunk" data-ref-filename="1128rr_chunk">rr_chunk</a>, <a class="local col9 ref" href="#1129rr_num" title='rr_num' data-ref="1129rr_num" data-ref-filename="1129rr_num">rr_num</a>)) {</td></tr>
<tr><th id="4528">4528</th><td>		<b>if</b>(!<a class="tu ref fn" href="#chunk_rrlist_get_current" title='chunk_rrlist_get_current' data-use='c' data-ref="chunk_rrlist_get_current" data-ref-filename="chunk_rrlist_get_current">chunk_rrlist_get_current</a>(<a class="local col8 ref" href="#1128rr_chunk" title='rr_chunk' data-ref="1128rr_chunk" data-ref-filename="1128rr_chunk">rr_chunk</a>, <a class="local col9 ref" href="#1129rr_num" title='rr_num' data-ref="1129rr_num" data-ref-filename="1129rr_num">rr_num</a>, <a class="local col0 ref" href="#1130rr_pos" title='rr_pos' data-ref="1130rr_pos" data-ref-filename="1130rr_pos">rr_pos</a>,</td></tr>
<tr><th id="4529">4529</th><td>			&amp;<a class="local col1 ref" href="#1131rr_dname" title='rr_dname' data-ref="1131rr_dname" data-ref-filename="1131rr_dname">rr_dname</a>, &amp;<a class="local col3 ref" href="#1133rr_type" title='rr_type' data-ref="1133rr_type" data-ref-filename="1133rr_type">rr_type</a>, &amp;<a class="local col4 ref" href="#1134rr_class" title='rr_class' data-ref="1134rr_class" data-ref-filename="1134rr_class">rr_class</a>, &amp;<a class="local col6 ref" href="#1136rr_ttl" title='rr_ttl' data-ref="1136rr_ttl" data-ref-filename="1136rr_ttl">rr_ttl</a>, &amp;<a class="local col5 ref" href="#1135rr_rdlen" title='rr_rdlen' data-ref="1135rr_rdlen" data-ref-filename="1135rr_rdlen">rr_rdlen</a>,</td></tr>
<tr><th id="4530">4530</th><td>			&amp;<a class="local col2 ref" href="#1132rr_rdata" title='rr_rdata' data-ref="1132rr_rdata" data-ref-filename="1132rr_rdata">rr_rdata</a>, &amp;<a class="local col7 ref" href="#1137rr_nextpos" title='rr_nextpos' data-ref="1137rr_nextpos" data-ref-filename="1137rr_nextpos">rr_nextpos</a>)) {</td></tr>
<tr><th id="4531">4531</th><td>			<i>/* failed to parse RR */</i></td></tr>
<tr><th id="4532">4532</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4533">4533</th><td>		}</td></tr>
<tr><th id="4534">4534</th><td>		<b>if</b>(<a class="ref" href="../util/log.h.html#verbosity" title='verbosity' data-ref="verbosity" data-ref-filename="verbosity">verbosity</a>&gt;=<var>7</var>) <a class="tu ref fn" href="#log_rrlist_position" title='log_rrlist_position' data-use='c' data-ref="log_rrlist_position" data-ref-filename="log_rrlist_position">log_rrlist_position</a>(<q>"apply ixfr"</q>,</td></tr>
<tr><th id="4535">4535</th><td>			<a class="local col8 ref" href="#1128rr_chunk" title='rr_chunk' data-ref="1128rr_chunk" data-ref-filename="1128rr_chunk">rr_chunk</a>, <a class="local col1 ref" href="#1131rr_dname" title='rr_dname' data-ref="1131rr_dname" data-ref-filename="1131rr_dname">rr_dname</a>, <a class="local col3 ref" href="#1133rr_type" title='rr_type' data-ref="1133rr_type" data-ref-filename="1133rr_type">rr_type</a>, <a class="local col0 ref" href="#1140rr_counter" title='rr_counter' data-ref="1140rr_counter" data-ref-filename="1140rr_counter">rr_counter</a>);</td></tr>
<tr><th id="4536">4536</th><td>		<i>/* twiddle add/del mode and check for start and end */</i></td></tr>
<tr><th id="4537">4537</th><td>		<b>if</b>(<a class="local col0 ref" href="#1140rr_counter" title='rr_counter' data-ref="1140rr_counter" data-ref-filename="1140rr_counter">rr_counter</a> == <var>0</var> &amp;&amp; <a class="local col3 ref" href="#1133rr_type" title='rr_type' data-ref="1133rr_type" data-ref-filename="1133rr_type">rr_type</a> != <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_SOA" title='LDNS_RR_TYPE_SOA' data-ref="LDNS_RR_TYPE_SOA" data-ref-filename="LDNS_RR_TYPE_SOA">LDNS_RR_TYPE_SOA</a>)</td></tr>
<tr><th id="4538">4538</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4539">4539</th><td>		<b>if</b>(<a class="local col0 ref" href="#1140rr_counter" title='rr_counter' data-ref="1140rr_counter" data-ref-filename="1140rr_counter">rr_counter</a> == <var>1</var> &amp;&amp; <a class="local col3 ref" href="#1133rr_type" title='rr_type' data-ref="1133rr_type" data-ref-filename="1133rr_type">rr_type</a> != <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_SOA" title='LDNS_RR_TYPE_SOA' data-ref="LDNS_RR_TYPE_SOA" data-ref-filename="LDNS_RR_TYPE_SOA">LDNS_RR_TYPE_SOA</a>) {</td></tr>
<tr><th id="4540">4540</th><td>			<i>/* this is an AXFR returned from the IXFR master */</i></td></tr>
<tr><th id="4541">4541</th><td>			<i>/* but that should already have been detected, by</i></td></tr>
<tr><th id="4542">4542</th><td><i>			 * on_ixfr_is_axfr */</i></td></tr>
<tr><th id="4543">4543</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4544">4544</th><td>		}</td></tr>
<tr><th id="4545">4545</th><td>		<b>if</b>(<a class="local col3 ref" href="#1133rr_type" title='rr_type' data-ref="1133rr_type" data-ref-filename="1133rr_type">rr_type</a> == <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_SOA" title='LDNS_RR_TYPE_SOA' data-ref="LDNS_RR_TYPE_SOA" data-ref-filename="LDNS_RR_TYPE_SOA">LDNS_RR_TYPE_SOA</a>) {</td></tr>
<tr><th id="4546">4546</th><td>			<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a> <dfn class="local col3 decl" id="1143serial" title='serial' data-type='uint32_t' data-ref="1143serial" data-ref-filename="1143serial">serial</dfn>;</td></tr>
<tr><th id="4547">4547</th><td>			<b>if</b>(<a class="local col5 ref" href="#1135rr_rdlen" title='rr_rdlen' data-ref="1135rr_rdlen" data-ref-filename="1135rr_rdlen">rr_rdlen</a> &lt; <var>22</var>) <b>return</b> <var>0</var>; <i>/* bad SOA rdlen */</i></td></tr>
<tr><th id="4548">4548</th><td>			<a class="local col3 ref" href="#1143serial" title='serial' data-ref="1143serial" data-ref-filename="1143serial">serial</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_read_uint32" title='sldns_read_uint32' data-ref="sldns_read_uint32" data-ref-filename="sldns_read_uint32">sldns_read_uint32</a>(<a class="local col2 ref" href="#1132rr_rdata" title='rr_rdata' data-ref="1132rr_rdata" data-ref-filename="1132rr_rdata">rr_rdata</a>+<a class="local col5 ref" href="#1135rr_rdlen" title='rr_rdlen' data-ref="1135rr_rdlen" data-ref-filename="1135rr_rdlen">rr_rdlen</a>-<var>20</var>);</td></tr>
<tr><th id="4549">4549</th><td>			<b>if</b>(<a class="local col8 ref" href="#1138have_transfer_serial" title='have_transfer_serial' data-ref="1138have_transfer_serial" data-ref-filename="1138have_transfer_serial">have_transfer_serial</a> == <var>0</var>) {</td></tr>
<tr><th id="4550">4550</th><td>				<a class="local col8 ref" href="#1138have_transfer_serial" title='have_transfer_serial' data-ref="1138have_transfer_serial" data-ref-filename="1138have_transfer_serial">have_transfer_serial</a> = <var>1</var>;</td></tr>
<tr><th id="4551">4551</th><td>				<a class="local col9 ref" href="#1139transfer_serial" title='transfer_serial' data-ref="1139transfer_serial" data-ref-filename="1139transfer_serial">transfer_serial</a> = <a class="local col3 ref" href="#1143serial" title='serial' data-ref="1143serial" data-ref-filename="1143serial">serial</a>;</td></tr>
<tr><th id="4552">4552</th><td>				<a class="local col1 ref" href="#1141delmode" title='delmode' data-ref="1141delmode" data-ref-filename="1141delmode">delmode</a> = <var>1</var>; <i>/* gets negated below */</i></td></tr>
<tr><th id="4553">4553</th><td>				<i>/* check second RR before going any further */</i></td></tr>
<tr><th id="4554">4554</th><td>				<b>if</b>(!<a class="tu ref fn" href="#ixfr_start_serial" title='ixfr_start_serial' data-use='c' data-ref="ixfr_start_serial" data-ref-filename="ixfr_start_serial">ixfr_start_serial</a>(<a class="local col8 ref" href="#1128rr_chunk" title='rr_chunk' data-ref="1128rr_chunk" data-ref-filename="1128rr_chunk">rr_chunk</a>, <a class="local col9 ref" href="#1129rr_num" title='rr_num' data-ref="1129rr_num" data-ref-filename="1129rr_num">rr_num</a>, <a class="local col0 ref" href="#1130rr_pos" title='rr_pos' data-ref="1130rr_pos" data-ref-filename="1130rr_pos">rr_pos</a>,</td></tr>
<tr><th id="4555">4555</th><td>					<a class="local col1 ref" href="#1131rr_dname" title='rr_dname' data-ref="1131rr_dname" data-ref-filename="1131rr_dname">rr_dname</a>, <a class="local col3 ref" href="#1133rr_type" title='rr_type' data-ref="1133rr_type" data-ref-filename="1133rr_type">rr_type</a>, <a class="local col4 ref" href="#1134rr_class" title='rr_class' data-ref="1134rr_class" data-ref-filename="1134rr_class">rr_class</a>, <a class="local col6 ref" href="#1136rr_ttl" title='rr_ttl' data-ref="1136rr_ttl" data-ref-filename="1136rr_ttl">rr_ttl</a>,</td></tr>
<tr><th id="4556">4556</th><td>					<a class="local col5 ref" href="#1135rr_rdlen" title='rr_rdlen' data-ref="1135rr_rdlen" data-ref-filename="1135rr_rdlen">rr_rdlen</a>, <a class="local col2 ref" href="#1132rr_rdata" title='rr_rdata' data-ref="1132rr_rdata" data-ref-filename="1132rr_rdata">rr_rdata</a>, <a class="local col7 ref" href="#1137rr_nextpos" title='rr_nextpos' data-ref="1137rr_nextpos" data-ref-filename="1137rr_nextpos">rr_nextpos</a>,</td></tr>
<tr><th id="4557">4557</th><td>					<a class="local col9 ref" href="#1139transfer_serial" title='transfer_serial' data-ref="1139transfer_serial" data-ref-filename="1139transfer_serial">transfer_serial</a>, <a class="local col5 ref" href="#1125xfr" title='xfr' data-ref="1125xfr" data-ref-filename="1125xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::serial" title='auth_xfer::serial' data-ref="auth_xfer::serial" data-ref-filename="auth_xfer..serial">serial</a>)) {</td></tr>
<tr><th id="4558">4558</th><td>					<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4559">4559</th><td>				}</td></tr>
<tr><th id="4560">4560</th><td>			} <b>else</b> <b>if</b>(<a class="local col9 ref" href="#1139transfer_serial" title='transfer_serial' data-ref="1139transfer_serial" data-ref-filename="1139transfer_serial">transfer_serial</a> == <a class="local col3 ref" href="#1143serial" title='serial' data-ref="1143serial" data-ref-filename="1143serial">serial</a>) {</td></tr>
<tr><th id="4561">4561</th><td>				<a class="local col8 ref" href="#1138have_transfer_serial" title='have_transfer_serial' data-ref="1138have_transfer_serial" data-ref-filename="1138have_transfer_serial">have_transfer_serial</a>++;</td></tr>
<tr><th id="4562">4562</th><td>				<b>if</b>(<a class="local col0 ref" href="#1140rr_counter" title='rr_counter' data-ref="1140rr_counter" data-ref-filename="1140rr_counter">rr_counter</a> == <var>1</var>) {</td></tr>
<tr><th id="4563">4563</th><td>					<i>/* empty AXFR, with SOA; SOA; */</i></td></tr>
<tr><th id="4564">4564</th><td>					<i>/* should have been detected by</i></td></tr>
<tr><th id="4565">4565</th><td><i>					 * on_ixfr_is_axfr */</i></td></tr>
<tr><th id="4566">4566</th><td>					<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4567">4567</th><td>				}</td></tr>
<tr><th id="4568">4568</th><td>				<b>if</b>(<a class="local col8 ref" href="#1138have_transfer_serial" title='have_transfer_serial' data-ref="1138have_transfer_serial" data-ref-filename="1138have_transfer_serial">have_transfer_serial</a> == <var>3</var>) {</td></tr>
<tr><th id="4569">4569</th><td>					<i>/* see serial three times for end */</i></td></tr>
<tr><th id="4570">4570</th><td>					<i>/* eg. IXFR:</i></td></tr>
<tr><th id="4571">4571</th><td><i>					 *  SOA 3 start</i></td></tr>
<tr><th id="4572">4572</th><td><i>					 *  SOA 1 second RR, followed by del</i></td></tr>
<tr><th id="4573">4573</th><td><i>					 *  SOA 2 followed by add</i></td></tr>
<tr><th id="4574">4574</th><td><i>					 *  SOA 2 followed by del</i></td></tr>
<tr><th id="4575">4575</th><td><i>					 *  SOA 3 followed by add</i></td></tr>
<tr><th id="4576">4576</th><td><i>					 *  SOA 3 end */</i></td></tr>
<tr><th id="4577">4577</th><td>					<i>/* ended by SOA record */</i></td></tr>
<tr><th id="4578">4578</th><td>					<a class="local col5 ref" href="#1125xfr" title='xfr' data-ref="1125xfr" data-ref-filename="1125xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::serial" title='auth_xfer::serial' data-ref="auth_xfer::serial" data-ref-filename="auth_xfer..serial">serial</a> = <a class="local col9 ref" href="#1139transfer_serial" title='transfer_serial' data-ref="1139transfer_serial" data-ref-filename="1139transfer_serial">transfer_serial</a>;</td></tr>
<tr><th id="4579">4579</th><td>					<b>break</b>;</td></tr>
<tr><th id="4580">4580</th><td>				}</td></tr>
<tr><th id="4581">4581</th><td>			}</td></tr>
<tr><th id="4582">4582</th><td>			<i>/* twiddle add/del mode */</i></td></tr>
<tr><th id="4583">4583</th><td>			<i>/* switch from delete part to add part and back again</i></td></tr>
<tr><th id="4584">4584</th><td><i>			 * just before the soa, it gets deleted and added too</i></td></tr>
<tr><th id="4585">4585</th><td><i>			 * this means we switch to delete mode for the final</i></td></tr>
<tr><th id="4586">4586</th><td><i>			 * SOA(so skip that one) */</i></td></tr>
<tr><th id="4587">4587</th><td>			<a class="local col1 ref" href="#1141delmode" title='delmode' data-ref="1141delmode" data-ref-filename="1141delmode">delmode</a> = !<a class="local col1 ref" href="#1141delmode" title='delmode' data-ref="1141delmode" data-ref-filename="1141delmode">delmode</a>;</td></tr>
<tr><th id="4588">4588</th><td>		}</td></tr>
<tr><th id="4589">4589</th><td>		<i>/* process this RR */</i></td></tr>
<tr><th id="4590">4590</th><td>		<i>/* if the RR is deleted twice or added twice, then we </i></td></tr>
<tr><th id="4591">4591</th><td><i>		 * softfail, and continue with the rest of the IXFR, so</i></td></tr>
<tr><th id="4592">4592</th><td><i>		 * that we serve something fairly nice during the refetch */</i></td></tr>
<tr><th id="4593">4593</th><td>		<b>if</b>(<a class="ref" href="../util/log.h.html#verbosity" title='verbosity' data-ref="verbosity" data-ref-filename="verbosity">verbosity</a>&gt;=<var>7</var>) <a class="tu ref fn" href="#log_rrlist_position" title='log_rrlist_position' data-use='c' data-ref="log_rrlist_position" data-ref-filename="log_rrlist_position">log_rrlist_position</a>((<a class="local col1 ref" href="#1141delmode" title='delmode' data-ref="1141delmode" data-ref-filename="1141delmode">delmode</a>?<q>"del"</q>:<q>"add"</q>),</td></tr>
<tr><th id="4594">4594</th><td>			<a class="local col8 ref" href="#1128rr_chunk" title='rr_chunk' data-ref="1128rr_chunk" data-ref-filename="1128rr_chunk">rr_chunk</a>, <a class="local col1 ref" href="#1131rr_dname" title='rr_dname' data-ref="1131rr_dname" data-ref-filename="1131rr_dname">rr_dname</a>, <a class="local col3 ref" href="#1133rr_type" title='rr_type' data-ref="1133rr_type" data-ref-filename="1133rr_type">rr_type</a>, <a class="local col0 ref" href="#1140rr_counter" title='rr_counter' data-ref="1140rr_counter" data-ref-filename="1140rr_counter">rr_counter</a>);</td></tr>
<tr><th id="4595">4595</th><td>		<b>if</b>(<a class="local col1 ref" href="#1141delmode" title='delmode' data-ref="1141delmode" data-ref-filename="1141delmode">delmode</a>) {</td></tr>
<tr><th id="4596">4596</th><td>			<i>/* delete this RR */</i></td></tr>
<tr><th id="4597">4597</th><td>			<em>int</em> <dfn class="local col4 decl" id="1144nonexist" title='nonexist' data-type='int' data-ref="1144nonexist" data-ref-filename="1144nonexist">nonexist</dfn> = <var>0</var>;</td></tr>
<tr><th id="4598">4598</th><td>			<b>if</b>(!<a class="tu ref fn" href="#az_remove_rr_decompress" title='az_remove_rr_decompress' data-use='c' data-ref="az_remove_rr_decompress" data-ref-filename="az_remove_rr_decompress">az_remove_rr_decompress</a>(<a class="local col6 ref" href="#1126z" title='z' data-ref="1126z" data-ref-filename="1126z">z</a>, <a class="local col8 ref" href="#1128rr_chunk" title='rr_chunk' data-ref="1128rr_chunk" data-ref-filename="1128rr_chunk">rr_chunk</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::data" title='auth_chunk::data' data-ref="auth_chunk::data" data-ref-filename="auth_chunk..data">data</a>,</td></tr>
<tr><th id="4599">4599</th><td>				<a class="local col8 ref" href="#1128rr_chunk" title='rr_chunk' data-ref="1128rr_chunk" data-ref-filename="1128rr_chunk">rr_chunk</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::len" title='auth_chunk::len' data-ref="auth_chunk::len" data-ref-filename="auth_chunk..len">len</a>, <a class="local col7 ref" href="#1127scratch_buffer" title='scratch_buffer' data-ref="1127scratch_buffer" data-ref-filename="1127scratch_buffer">scratch_buffer</a>, <a class="local col1 ref" href="#1131rr_dname" title='rr_dname' data-ref="1131rr_dname" data-ref-filename="1131rr_dname">rr_dname</a>,</td></tr>
<tr><th id="4600">4600</th><td>				<a class="local col3 ref" href="#1133rr_type" title='rr_type' data-ref="1133rr_type" data-ref-filename="1133rr_type">rr_type</a>, <a class="local col4 ref" href="#1134rr_class" title='rr_class' data-ref="1134rr_class" data-ref-filename="1134rr_class">rr_class</a>, <a class="local col6 ref" href="#1136rr_ttl" title='rr_ttl' data-ref="1136rr_ttl" data-ref-filename="1136rr_ttl">rr_ttl</a>, <a class="local col2 ref" href="#1132rr_rdata" title='rr_rdata' data-ref="1132rr_rdata" data-ref-filename="1132rr_rdata">rr_rdata</a>, <a class="local col5 ref" href="#1135rr_rdlen" title='rr_rdlen' data-ref="1135rr_rdlen" data-ref-filename="1135rr_rdlen">rr_rdlen</a>,</td></tr>
<tr><th id="4601">4601</th><td>				&amp;<a class="local col4 ref" href="#1144nonexist" title='nonexist' data-ref="1144nonexist" data-ref-filename="1144nonexist">nonexist</a>)) {</td></tr>
<tr><th id="4602">4602</th><td>				<i>/* failed, malloc error or so */</i></td></tr>
<tr><th id="4603">4603</th><td>				<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4604">4604</th><td>			}</td></tr>
<tr><th id="4605">4605</th><td>			<b>if</b>(<a class="local col4 ref" href="#1144nonexist" title='nonexist' data-ref="1144nonexist" data-ref-filename="1144nonexist">nonexist</a>) {</td></tr>
<tr><th id="4606">4606</th><td>				<i>/* it was removal of a nonexisting RR */</i></td></tr>
<tr><th id="4607">4607</th><td>				<b>if</b>(<a class="ref" href="../util/log.h.html#verbosity" title='verbosity' data-ref="verbosity" data-ref-filename="verbosity">verbosity</a>&gt;=<var>4</var>) <a class="tu ref fn" href="#log_rrlist_position" title='log_rrlist_position' data-use='c' data-ref="log_rrlist_position" data-ref-filename="log_rrlist_position">log_rrlist_position</a>(</td></tr>
<tr><th id="4608">4608</th><td>					<q>"IXFR error nonexistent RR"</q>,</td></tr>
<tr><th id="4609">4609</th><td>					<a class="local col8 ref" href="#1128rr_chunk" title='rr_chunk' data-ref="1128rr_chunk" data-ref-filename="1128rr_chunk">rr_chunk</a>, <a class="local col1 ref" href="#1131rr_dname" title='rr_dname' data-ref="1131rr_dname" data-ref-filename="1131rr_dname">rr_dname</a>, <a class="local col3 ref" href="#1133rr_type" title='rr_type' data-ref="1133rr_type" data-ref-filename="1133rr_type">rr_type</a>, <a class="local col0 ref" href="#1140rr_counter" title='rr_counter' data-ref="1140rr_counter" data-ref-filename="1140rr_counter">rr_counter</a>);</td></tr>
<tr><th id="4610">4610</th><td>				<a class="local col2 ref" href="#1142softfail" title='softfail' data-ref="1142softfail" data-ref-filename="1142softfail">softfail</a> = <var>1</var>;</td></tr>
<tr><th id="4611">4611</th><td>			}</td></tr>
<tr><th id="4612">4612</th><td>		} <b>else</b> <b>if</b>(<a class="local col0 ref" href="#1140rr_counter" title='rr_counter' data-ref="1140rr_counter" data-ref-filename="1140rr_counter">rr_counter</a> != <var>0</var>) {</td></tr>
<tr><th id="4613">4613</th><td>			<i>/* skip first SOA RR for addition, it is added in</i></td></tr>
<tr><th id="4614">4614</th><td><i>			 * the addition part near the end of the ixfr, when</i></td></tr>
<tr><th id="4615">4615</th><td><i>			 * that serial is seen the second time. */</i></td></tr>
<tr><th id="4616">4616</th><td>			<em>int</em> <dfn class="local col5 decl" id="1145duplicate" title='duplicate' data-type='int' data-ref="1145duplicate" data-ref-filename="1145duplicate">duplicate</dfn> = <var>0</var>;</td></tr>
<tr><th id="4617">4617</th><td>			<i>/* add this RR */</i></td></tr>
<tr><th id="4618">4618</th><td>			<b>if</b>(!<a class="tu ref fn" href="#az_insert_rr_decompress" title='az_insert_rr_decompress' data-use='c' data-ref="az_insert_rr_decompress" data-ref-filename="az_insert_rr_decompress">az_insert_rr_decompress</a>(<a class="local col6 ref" href="#1126z" title='z' data-ref="1126z" data-ref-filename="1126z">z</a>, <a class="local col8 ref" href="#1128rr_chunk" title='rr_chunk' data-ref="1128rr_chunk" data-ref-filename="1128rr_chunk">rr_chunk</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::data" title='auth_chunk::data' data-ref="auth_chunk::data" data-ref-filename="auth_chunk..data">data</a>,</td></tr>
<tr><th id="4619">4619</th><td>				<a class="local col8 ref" href="#1128rr_chunk" title='rr_chunk' data-ref="1128rr_chunk" data-ref-filename="1128rr_chunk">rr_chunk</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::len" title='auth_chunk::len' data-ref="auth_chunk::len" data-ref-filename="auth_chunk..len">len</a>, <a class="local col7 ref" href="#1127scratch_buffer" title='scratch_buffer' data-ref="1127scratch_buffer" data-ref-filename="1127scratch_buffer">scratch_buffer</a>, <a class="local col1 ref" href="#1131rr_dname" title='rr_dname' data-ref="1131rr_dname" data-ref-filename="1131rr_dname">rr_dname</a>,</td></tr>
<tr><th id="4620">4620</th><td>				<a class="local col3 ref" href="#1133rr_type" title='rr_type' data-ref="1133rr_type" data-ref-filename="1133rr_type">rr_type</a>, <a class="local col4 ref" href="#1134rr_class" title='rr_class' data-ref="1134rr_class" data-ref-filename="1134rr_class">rr_class</a>, <a class="local col6 ref" href="#1136rr_ttl" title='rr_ttl' data-ref="1136rr_ttl" data-ref-filename="1136rr_ttl">rr_ttl</a>, <a class="local col2 ref" href="#1132rr_rdata" title='rr_rdata' data-ref="1132rr_rdata" data-ref-filename="1132rr_rdata">rr_rdata</a>, <a class="local col5 ref" href="#1135rr_rdlen" title='rr_rdlen' data-ref="1135rr_rdlen" data-ref-filename="1135rr_rdlen">rr_rdlen</a>,</td></tr>
<tr><th id="4621">4621</th><td>				&amp;<a class="local col5 ref" href="#1145duplicate" title='duplicate' data-ref="1145duplicate" data-ref-filename="1145duplicate">duplicate</a>)) {</td></tr>
<tr><th id="4622">4622</th><td>				<i>/* failed, malloc error or so */</i></td></tr>
<tr><th id="4623">4623</th><td>				<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4624">4624</th><td>			}</td></tr>
<tr><th id="4625">4625</th><td>			<b>if</b>(<a class="local col5 ref" href="#1145duplicate" title='duplicate' data-ref="1145duplicate" data-ref-filename="1145duplicate">duplicate</a>) {</td></tr>
<tr><th id="4626">4626</th><td>				<i>/* it was a duplicate */</i></td></tr>
<tr><th id="4627">4627</th><td>				<b>if</b>(<a class="ref" href="../util/log.h.html#verbosity" title='verbosity' data-ref="verbosity" data-ref-filename="verbosity">verbosity</a>&gt;=<var>4</var>) <a class="tu ref fn" href="#log_rrlist_position" title='log_rrlist_position' data-use='c' data-ref="log_rrlist_position" data-ref-filename="log_rrlist_position">log_rrlist_position</a>(</td></tr>
<tr><th id="4628">4628</th><td>					<q>"IXFR error duplicate RR"</q>,</td></tr>
<tr><th id="4629">4629</th><td>					<a class="local col8 ref" href="#1128rr_chunk" title='rr_chunk' data-ref="1128rr_chunk" data-ref-filename="1128rr_chunk">rr_chunk</a>, <a class="local col1 ref" href="#1131rr_dname" title='rr_dname' data-ref="1131rr_dname" data-ref-filename="1131rr_dname">rr_dname</a>, <a class="local col3 ref" href="#1133rr_type" title='rr_type' data-ref="1133rr_type" data-ref-filename="1133rr_type">rr_type</a>, <a class="local col0 ref" href="#1140rr_counter" title='rr_counter' data-ref="1140rr_counter" data-ref-filename="1140rr_counter">rr_counter</a>);</td></tr>
<tr><th id="4630">4630</th><td>				<a class="local col2 ref" href="#1142softfail" title='softfail' data-ref="1142softfail" data-ref-filename="1142softfail">softfail</a> = <var>1</var>;</td></tr>
<tr><th id="4631">4631</th><td>			}</td></tr>
<tr><th id="4632">4632</th><td>		}</td></tr>
<tr><th id="4633">4633</th><td></td></tr>
<tr><th id="4634">4634</th><td>		<a class="local col0 ref" href="#1140rr_counter" title='rr_counter' data-ref="1140rr_counter" data-ref-filename="1140rr_counter">rr_counter</a>++;</td></tr>
<tr><th id="4635">4635</th><td>		<a class="tu ref fn" href="#chunk_rrlist_gonext" title='chunk_rrlist_gonext' data-use='c' data-ref="chunk_rrlist_gonext" data-ref-filename="chunk_rrlist_gonext">chunk_rrlist_gonext</a>(&amp;<a class="local col8 ref" href="#1128rr_chunk" title='rr_chunk' data-ref="1128rr_chunk" data-ref-filename="1128rr_chunk">rr_chunk</a>, &amp;<a class="local col9 ref" href="#1129rr_num" title='rr_num' data-ref="1129rr_num" data-ref-filename="1129rr_num">rr_num</a>, &amp;<a class="local col0 ref" href="#1130rr_pos" title='rr_pos' data-ref="1130rr_pos" data-ref-filename="1130rr_pos">rr_pos</a>, <a class="local col7 ref" href="#1137rr_nextpos" title='rr_nextpos' data-ref="1137rr_nextpos" data-ref-filename="1137rr_nextpos">rr_nextpos</a>);</td></tr>
<tr><th id="4636">4636</th><td>	}</td></tr>
<tr><th id="4637">4637</th><td>	<b>if</b>(<a class="local col2 ref" href="#1142softfail" title='softfail' data-ref="1142softfail" data-ref-filename="1142softfail">softfail</a>) {</td></tr>
<tr><th id="4638">4638</th><td>		<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"IXFR did not apply cleanly, fetching full zone"</q>);</td></tr>
<tr><th id="4639">4639</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4640">4640</th><td>	}</td></tr>
<tr><th id="4641">4641</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="4642">4642</th><td>}</td></tr>
<tr><th id="4643">4643</th><td></td></tr>
<tr><th id="4644">4644</th><td><i class="doc" data-doc="apply_axfr">/** apply AXFR to zone in memory. z is locked. false on failure(mallocfail) */</i></td></tr>
<tr><th id="4645">4645</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="4646">4646</th><td><dfn class="tu decl def fn" id="apply_axfr" title='apply_axfr' data-type='int apply_axfr(struct auth_xfer * xfr, struct auth_zone * z, struct sldns_buffer * scratch_buffer)' data-ref="apply_axfr" data-ref-filename="apply_axfr">apply_axfr</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col6 decl" id="1146xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1146xfr" data-ref-filename="1146xfr">xfr</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col7 decl" id="1147z" title='z' data-type='struct auth_zone *' data-ref="1147z" data-ref-filename="1147z">z</dfn>,</td></tr>
<tr><th id="4647">4647</th><td>	<b>struct</b> <a class="type" href="../sldns/sbuffer.h.html#sldns_buffer" title='sldns_buffer' data-ref="sldns_buffer" data-ref-filename="sldns_buffer">sldns_buffer</a>* <dfn class="local col8 decl" id="1148scratch_buffer" title='scratch_buffer' data-type='struct sldns_buffer *' data-ref="1148scratch_buffer" data-ref-filename="1148scratch_buffer">scratch_buffer</dfn>)</td></tr>
<tr><th id="4648">4648</th><td>{</td></tr>
<tr><th id="4649">4649</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_chunk" title='auth_chunk' data-ref="auth_chunk" data-ref-filename="auth_chunk">auth_chunk</a>* <dfn class="local col9 decl" id="1149rr_chunk" title='rr_chunk' data-type='struct auth_chunk *' data-ref="1149rr_chunk" data-ref-filename="1149rr_chunk">rr_chunk</dfn>;</td></tr>
<tr><th id="4650">4650</th><td>	<em>int</em> <dfn class="local col0 decl" id="1150rr_num" title='rr_num' data-type='int' data-ref="1150rr_num" data-ref-filename="1150rr_num">rr_num</dfn>;</td></tr>
<tr><th id="4651">4651</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col1 decl" id="1151rr_pos" title='rr_pos' data-type='size_t' data-ref="1151rr_pos" data-ref-filename="1151rr_pos">rr_pos</dfn>;</td></tr>
<tr><th id="4652">4652</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col2 decl" id="1152rr_dname" title='rr_dname' data-type='uint8_t *' data-ref="1152rr_dname" data-ref-filename="1152rr_dname">rr_dname</dfn>, *<dfn class="local col3 decl" id="1153rr_rdata" title='rr_rdata' data-type='uint8_t *' data-ref="1153rr_rdata" data-ref-filename="1153rr_rdata">rr_rdata</dfn>;</td></tr>
<tr><th id="4653">4653</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col4 decl" id="1154rr_type" title='rr_type' data-type='uint16_t' data-ref="1154rr_type" data-ref-filename="1154rr_type">rr_type</dfn>, <dfn class="local col5 decl" id="1155rr_class" title='rr_class' data-type='uint16_t' data-ref="1155rr_class" data-ref-filename="1155rr_class">rr_class</dfn>, <dfn class="local col6 decl" id="1156rr_rdlen" title='rr_rdlen' data-type='uint16_t' data-ref="1156rr_rdlen" data-ref-filename="1156rr_rdlen">rr_rdlen</dfn>;</td></tr>
<tr><th id="4654">4654</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a> <dfn class="local col7 decl" id="1157rr_ttl" title='rr_ttl' data-type='uint32_t' data-ref="1157rr_ttl" data-ref-filename="1157rr_ttl">rr_ttl</dfn>;</td></tr>
<tr><th id="4655">4655</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a> <dfn class="local col8 decl" id="1158serial" title='serial' data-type='uint32_t' data-ref="1158serial" data-ref-filename="1158serial">serial</dfn> = <var>0</var>;</td></tr>
<tr><th id="4656">4656</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col9 decl" id="1159rr_nextpos" title='rr_nextpos' data-type='size_t' data-ref="1159rr_nextpos" data-ref-filename="1159rr_nextpos">rr_nextpos</dfn>;</td></tr>
<tr><th id="4657">4657</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col0 decl" id="1160rr_counter" title='rr_counter' data-type='size_t' data-ref="1160rr_counter" data-ref-filename="1160rr_counter">rr_counter</dfn> = <var>0</var>;</td></tr>
<tr><th id="4658">4658</th><td>	<em>int</em> <dfn class="local col1 decl" id="1161have_end_soa" title='have_end_soa' data-type='int' data-ref="1161have_end_soa" data-ref-filename="1161have_end_soa">have_end_soa</dfn> = <var>0</var>;</td></tr>
<tr><th id="4659">4659</th><td></td></tr>
<tr><th id="4660">4660</th><td>	<i>/* clear the data tree */</i></td></tr>
<tr><th id="4661">4661</th><td>	<a class="ref fn" href="../util/rbtree.h.html#traverse_postorder" title='traverse_postorder' data-ref="traverse_postorder" data-ref-filename="traverse_postorder">traverse_postorder</a>(&amp;<a class="local col7 ref" href="#1147z" title='z' data-ref="1147z" data-ref-filename="1147z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::data" title='auth_zone::data' data-ref="auth_zone::data" data-ref-filename="auth_zone..data">data</a>, <a class="tu ref fn" href="#auth_data_del" title='auth_data_del' data-use='r' data-ref="auth_data_del" data-ref-filename="auth_data_del">auth_data_del</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="4662">4662</th><td>	<a class="ref fn" href="../util/rbtree.h.html#rbtree_init" title='rbtree_init' data-ref="rbtree_init" data-ref-filename="rbtree_init">rbtree_init</a>(&amp;<a class="local col7 ref" href="#1147z" title='z' data-ref="1147z" data-ref-filename="1147z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::data" title='auth_zone::data' data-ref="auth_zone::data" data-ref-filename="auth_zone..data">data</a>, &amp;<a class="ref fn" href="#auth_data_cmp" title='auth_data_cmp' data-ref="auth_data_cmp" data-ref-filename="auth_data_cmp">auth_data_cmp</a>);</td></tr>
<tr><th id="4663">4663</th><td>	<a class="local col6 ref" href="#1146xfr" title='xfr' data-ref="1146xfr" data-ref-filename="1146xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::have_zone" title='auth_xfer::have_zone' data-ref="auth_xfer::have_zone" data-ref-filename="auth_xfer..have_zone">have_zone</a> = <var>0</var>;</td></tr>
<tr><th id="4664">4664</th><td>	<a class="local col6 ref" href="#1146xfr" title='xfr' data-ref="1146xfr" data-ref-filename="1146xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::serial" title='auth_xfer::serial' data-ref="auth_xfer::serial" data-ref-filename="auth_xfer..serial">serial</a> = <var>0</var>;</td></tr>
<tr><th id="4665">4665</th><td></td></tr>
<tr><th id="4666">4666</th><td>	<i>/* insert all RRs in to the zone */</i></td></tr>
<tr><th id="4667">4667</th><td>	<i>/* insert the SOA only once, skip the last one */</i></td></tr>
<tr><th id="4668">4668</th><td>	<i>/* start RR iterator over chunklist of packets */</i></td></tr>
<tr><th id="4669">4669</th><td>	<a class="tu ref fn" href="#chunk_rrlist_start" title='chunk_rrlist_start' data-use='c' data-ref="chunk_rrlist_start" data-ref-filename="chunk_rrlist_start">chunk_rrlist_start</a>(<a class="local col6 ref" href="#1146xfr" title='xfr' data-ref="1146xfr" data-ref-filename="1146xfr">xfr</a>, &amp;<a class="local col9 ref" href="#1149rr_chunk" title='rr_chunk' data-ref="1149rr_chunk" data-ref-filename="1149rr_chunk">rr_chunk</a>, &amp;<a class="local col0 ref" href="#1150rr_num" title='rr_num' data-ref="1150rr_num" data-ref-filename="1150rr_num">rr_num</a>, &amp;<a class="local col1 ref" href="#1151rr_pos" title='rr_pos' data-ref="1151rr_pos" data-ref-filename="1151rr_pos">rr_pos</a>);</td></tr>
<tr><th id="4670">4670</th><td>	<b>while</b>(!<a class="tu ref fn" href="#chunk_rrlist_end" title='chunk_rrlist_end' data-use='c' data-ref="chunk_rrlist_end" data-ref-filename="chunk_rrlist_end">chunk_rrlist_end</a>(<a class="local col9 ref" href="#1149rr_chunk" title='rr_chunk' data-ref="1149rr_chunk" data-ref-filename="1149rr_chunk">rr_chunk</a>, <a class="local col0 ref" href="#1150rr_num" title='rr_num' data-ref="1150rr_num" data-ref-filename="1150rr_num">rr_num</a>)) {</td></tr>
<tr><th id="4671">4671</th><td>		<b>if</b>(!<a class="tu ref fn" href="#chunk_rrlist_get_current" title='chunk_rrlist_get_current' data-use='c' data-ref="chunk_rrlist_get_current" data-ref-filename="chunk_rrlist_get_current">chunk_rrlist_get_current</a>(<a class="local col9 ref" href="#1149rr_chunk" title='rr_chunk' data-ref="1149rr_chunk" data-ref-filename="1149rr_chunk">rr_chunk</a>, <a class="local col0 ref" href="#1150rr_num" title='rr_num' data-ref="1150rr_num" data-ref-filename="1150rr_num">rr_num</a>, <a class="local col1 ref" href="#1151rr_pos" title='rr_pos' data-ref="1151rr_pos" data-ref-filename="1151rr_pos">rr_pos</a>,</td></tr>
<tr><th id="4672">4672</th><td>			&amp;<a class="local col2 ref" href="#1152rr_dname" title='rr_dname' data-ref="1152rr_dname" data-ref-filename="1152rr_dname">rr_dname</a>, &amp;<a class="local col4 ref" href="#1154rr_type" title='rr_type' data-ref="1154rr_type" data-ref-filename="1154rr_type">rr_type</a>, &amp;<a class="local col5 ref" href="#1155rr_class" title='rr_class' data-ref="1155rr_class" data-ref-filename="1155rr_class">rr_class</a>, &amp;<a class="local col7 ref" href="#1157rr_ttl" title='rr_ttl' data-ref="1157rr_ttl" data-ref-filename="1157rr_ttl">rr_ttl</a>, &amp;<a class="local col6 ref" href="#1156rr_rdlen" title='rr_rdlen' data-ref="1156rr_rdlen" data-ref-filename="1156rr_rdlen">rr_rdlen</a>,</td></tr>
<tr><th id="4673">4673</th><td>			&amp;<a class="local col3 ref" href="#1153rr_rdata" title='rr_rdata' data-ref="1153rr_rdata" data-ref-filename="1153rr_rdata">rr_rdata</a>, &amp;<a class="local col9 ref" href="#1159rr_nextpos" title='rr_nextpos' data-ref="1159rr_nextpos" data-ref-filename="1159rr_nextpos">rr_nextpos</a>)) {</td></tr>
<tr><th id="4674">4674</th><td>			<i>/* failed to parse RR */</i></td></tr>
<tr><th id="4675">4675</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4676">4676</th><td>		}</td></tr>
<tr><th id="4677">4677</th><td>		<b>if</b>(<a class="ref" href="../util/log.h.html#verbosity" title='verbosity' data-ref="verbosity" data-ref-filename="verbosity">verbosity</a>&gt;=<var>7</var>) <a class="tu ref fn" href="#log_rrlist_position" title='log_rrlist_position' data-use='c' data-ref="log_rrlist_position" data-ref-filename="log_rrlist_position">log_rrlist_position</a>(<q>"apply_axfr"</q>,</td></tr>
<tr><th id="4678">4678</th><td>			<a class="local col9 ref" href="#1149rr_chunk" title='rr_chunk' data-ref="1149rr_chunk" data-ref-filename="1149rr_chunk">rr_chunk</a>, <a class="local col2 ref" href="#1152rr_dname" title='rr_dname' data-ref="1152rr_dname" data-ref-filename="1152rr_dname">rr_dname</a>, <a class="local col4 ref" href="#1154rr_type" title='rr_type' data-ref="1154rr_type" data-ref-filename="1154rr_type">rr_type</a>, <a class="local col0 ref" href="#1160rr_counter" title='rr_counter' data-ref="1160rr_counter" data-ref-filename="1160rr_counter">rr_counter</a>);</td></tr>
<tr><th id="4679">4679</th><td>		<b>if</b>(<a class="local col4 ref" href="#1154rr_type" title='rr_type' data-ref="1154rr_type" data-ref-filename="1154rr_type">rr_type</a> == <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_SOA" title='LDNS_RR_TYPE_SOA' data-ref="LDNS_RR_TYPE_SOA" data-ref-filename="LDNS_RR_TYPE_SOA">LDNS_RR_TYPE_SOA</a>) {</td></tr>
<tr><th id="4680">4680</th><td>			<b>if</b>(<a class="local col0 ref" href="#1160rr_counter" title='rr_counter' data-ref="1160rr_counter" data-ref-filename="1160rr_counter">rr_counter</a> != <var>0</var>) {</td></tr>
<tr><th id="4681">4681</th><td>				<i>/* end of the axfr */</i></td></tr>
<tr><th id="4682">4682</th><td>				<a class="local col1 ref" href="#1161have_end_soa" title='have_end_soa' data-ref="1161have_end_soa" data-ref-filename="1161have_end_soa">have_end_soa</a> = <var>1</var>;</td></tr>
<tr><th id="4683">4683</th><td>				<b>break</b>;</td></tr>
<tr><th id="4684">4684</th><td>			}</td></tr>
<tr><th id="4685">4685</th><td>			<b>if</b>(<a class="local col6 ref" href="#1156rr_rdlen" title='rr_rdlen' data-ref="1156rr_rdlen" data-ref-filename="1156rr_rdlen">rr_rdlen</a> &lt; <var>22</var>) <b>return</b> <var>0</var>; <i>/* bad SOA rdlen */</i></td></tr>
<tr><th id="4686">4686</th><td>			<a class="local col8 ref" href="#1158serial" title='serial' data-ref="1158serial" data-ref-filename="1158serial">serial</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_read_uint32" title='sldns_read_uint32' data-ref="sldns_read_uint32" data-ref-filename="sldns_read_uint32">sldns_read_uint32</a>(<a class="local col3 ref" href="#1153rr_rdata" title='rr_rdata' data-ref="1153rr_rdata" data-ref-filename="1153rr_rdata">rr_rdata</a>+<a class="local col6 ref" href="#1156rr_rdlen" title='rr_rdlen' data-ref="1156rr_rdlen" data-ref-filename="1156rr_rdlen">rr_rdlen</a>-<var>20</var>);</td></tr>
<tr><th id="4687">4687</th><td>		}</td></tr>
<tr><th id="4688">4688</th><td></td></tr>
<tr><th id="4689">4689</th><td>		<i>/* add this RR */</i></td></tr>
<tr><th id="4690">4690</th><td>		<b>if</b>(!<a class="tu ref fn" href="#az_insert_rr_decompress" title='az_insert_rr_decompress' data-use='c' data-ref="az_insert_rr_decompress" data-ref-filename="az_insert_rr_decompress">az_insert_rr_decompress</a>(<a class="local col7 ref" href="#1147z" title='z' data-ref="1147z" data-ref-filename="1147z">z</a>, <a class="local col9 ref" href="#1149rr_chunk" title='rr_chunk' data-ref="1149rr_chunk" data-ref-filename="1149rr_chunk">rr_chunk</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::data" title='auth_chunk::data' data-ref="auth_chunk::data" data-ref-filename="auth_chunk..data">data</a>, <a class="local col9 ref" href="#1149rr_chunk" title='rr_chunk' data-ref="1149rr_chunk" data-ref-filename="1149rr_chunk">rr_chunk</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::len" title='auth_chunk::len' data-ref="auth_chunk::len" data-ref-filename="auth_chunk..len">len</a>,</td></tr>
<tr><th id="4691">4691</th><td>			<a class="local col8 ref" href="#1148scratch_buffer" title='scratch_buffer' data-ref="1148scratch_buffer" data-ref-filename="1148scratch_buffer">scratch_buffer</a>, <a class="local col2 ref" href="#1152rr_dname" title='rr_dname' data-ref="1152rr_dname" data-ref-filename="1152rr_dname">rr_dname</a>, <a class="local col4 ref" href="#1154rr_type" title='rr_type' data-ref="1154rr_type" data-ref-filename="1154rr_type">rr_type</a>, <a class="local col5 ref" href="#1155rr_class" title='rr_class' data-ref="1155rr_class" data-ref-filename="1155rr_class">rr_class</a>, <a class="local col7 ref" href="#1157rr_ttl" title='rr_ttl' data-ref="1157rr_ttl" data-ref-filename="1157rr_ttl">rr_ttl</a>,</td></tr>
<tr><th id="4692">4692</th><td>			<a class="local col3 ref" href="#1153rr_rdata" title='rr_rdata' data-ref="1153rr_rdata" data-ref-filename="1153rr_rdata">rr_rdata</a>, <a class="local col6 ref" href="#1156rr_rdlen" title='rr_rdlen' data-ref="1156rr_rdlen" data-ref-filename="1156rr_rdlen">rr_rdlen</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>)) {</td></tr>
<tr><th id="4693">4693</th><td>			<i>/* failed, malloc error or so */</i></td></tr>
<tr><th id="4694">4694</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4695">4695</th><td>		}</td></tr>
<tr><th id="4696">4696</th><td></td></tr>
<tr><th id="4697">4697</th><td>		<a class="local col0 ref" href="#1160rr_counter" title='rr_counter' data-ref="1160rr_counter" data-ref-filename="1160rr_counter">rr_counter</a>++;</td></tr>
<tr><th id="4698">4698</th><td>		<a class="tu ref fn" href="#chunk_rrlist_gonext" title='chunk_rrlist_gonext' data-use='c' data-ref="chunk_rrlist_gonext" data-ref-filename="chunk_rrlist_gonext">chunk_rrlist_gonext</a>(&amp;<a class="local col9 ref" href="#1149rr_chunk" title='rr_chunk' data-ref="1149rr_chunk" data-ref-filename="1149rr_chunk">rr_chunk</a>, &amp;<a class="local col0 ref" href="#1150rr_num" title='rr_num' data-ref="1150rr_num" data-ref-filename="1150rr_num">rr_num</a>, &amp;<a class="local col1 ref" href="#1151rr_pos" title='rr_pos' data-ref="1151rr_pos" data-ref-filename="1151rr_pos">rr_pos</a>, <a class="local col9 ref" href="#1159rr_nextpos" title='rr_nextpos' data-ref="1159rr_nextpos" data-ref-filename="1159rr_nextpos">rr_nextpos</a>);</td></tr>
<tr><th id="4699">4699</th><td>	}</td></tr>
<tr><th id="4700">4700</th><td>	<b>if</b>(!<a class="local col1 ref" href="#1161have_end_soa" title='have_end_soa' data-ref="1161have_end_soa" data-ref-filename="1161have_end_soa">have_end_soa</a>) {</td></tr>
<tr><th id="4701">4701</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"no end SOA record for AXFR"</q>);</td></tr>
<tr><th id="4702">4702</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4703">4703</th><td>	}</td></tr>
<tr><th id="4704">4704</th><td></td></tr>
<tr><th id="4705">4705</th><td>	<a class="local col6 ref" href="#1146xfr" title='xfr' data-ref="1146xfr" data-ref-filename="1146xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::serial" title='auth_xfer::serial' data-ref="auth_xfer::serial" data-ref-filename="auth_xfer..serial">serial</a> = <a class="local col8 ref" href="#1158serial" title='serial' data-ref="1158serial" data-ref-filename="1158serial">serial</a>;</td></tr>
<tr><th id="4706">4706</th><td>	<a class="local col6 ref" href="#1146xfr" title='xfr' data-ref="1146xfr" data-ref-filename="1146xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::have_zone" title='auth_xfer::have_zone' data-ref="auth_xfer::have_zone" data-ref-filename="auth_xfer..have_zone">have_zone</a> = <var>1</var>;</td></tr>
<tr><th id="4707">4707</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="4708">4708</th><td>}</td></tr>
<tr><th id="4709">4709</th><td></td></tr>
<tr><th id="4710">4710</th><td><i class="doc" data-doc="apply_http">/** apply HTTP to zone in memory. z is locked. false on failure(mallocfail) */</i></td></tr>
<tr><th id="4711">4711</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="4712">4712</th><td><dfn class="tu decl def fn" id="apply_http" title='apply_http' data-type='int apply_http(struct auth_xfer * xfr, struct auth_zone * z, struct sldns_buffer * scratch_buffer)' data-ref="apply_http" data-ref-filename="apply_http">apply_http</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col2 decl" id="1162xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1162xfr" data-ref-filename="1162xfr">xfr</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col3 decl" id="1163z" title='z' data-type='struct auth_zone *' data-ref="1163z" data-ref-filename="1163z">z</dfn>,</td></tr>
<tr><th id="4713">4713</th><td>	<b>struct</b> <a class="type" href="../sldns/sbuffer.h.html#sldns_buffer" title='sldns_buffer' data-ref="sldns_buffer" data-ref-filename="sldns_buffer">sldns_buffer</a>* <dfn class="local col4 decl" id="1164scratch_buffer" title='scratch_buffer' data-type='struct sldns_buffer *' data-ref="1164scratch_buffer" data-ref-filename="1164scratch_buffer">scratch_buffer</dfn>)</td></tr>
<tr><th id="4714">4714</th><td>{</td></tr>
<tr><th id="4715">4715</th><td>	<i>/* parse data in chunks */</i></td></tr>
<tr><th id="4716">4716</th><td>	<i>/* parse RR's and read into memory. ignore $INCLUDE from the</i></td></tr>
<tr><th id="4717">4717</th><td><i>	 * downloaded file*/</i></td></tr>
<tr><th id="4718">4718</th><td>	<b>struct</b> <a class="type" href="../sldns/str2wire.h.html#sldns_file_parse_state" title='sldns_file_parse_state' data-ref="sldns_file_parse_state" data-ref-filename="sldns_file_parse_state">sldns_file_parse_state</a> <dfn class="local col5 decl" id="1165pstate" title='pstate' data-type='struct sldns_file_parse_state' data-ref="1165pstate" data-ref-filename="1165pstate">pstate</dfn>;</td></tr>
<tr><th id="4719">4719</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_chunk" title='auth_chunk' data-ref="auth_chunk" data-ref-filename="auth_chunk">auth_chunk</a>* <dfn class="local col6 decl" id="1166chunk" title='chunk' data-type='struct auth_chunk *' data-ref="1166chunk" data-ref-filename="1166chunk">chunk</dfn>;</td></tr>
<tr><th id="4720">4720</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col7 decl" id="1167chunk_pos" title='chunk_pos' data-type='size_t' data-ref="1167chunk_pos" data-ref-filename="1167chunk_pos">chunk_pos</dfn>;</td></tr>
<tr><th id="4721">4721</th><td>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#97" title="((__builtin_object_size(&amp;pstate, 0) != (size_t)-1) ? __builtin___memset_chk(&amp;pstate, 0, sizeof(pstate), __builtin_object_size(&amp;pstate, 0)) : __memset_ichk(&amp;pstate, 0, sizeof(pstate)))" data-ref="_M/memset">memset</a>(&amp;<a class="local col5 ref" href="#1165pstate" title='pstate' data-ref="1165pstate" data-ref-filename="1165pstate">pstate</a>, <var>0</var>, <b>sizeof</b>(<a class="local col5 ref" href="#1165pstate" title='pstate' data-ref="1165pstate" data-ref-filename="1165pstate">pstate</a>));</td></tr>
<tr><th id="4722">4722</th><td>	<a class="local col5 ref" href="#1165pstate" title='pstate' data-ref="1165pstate" data-ref-filename="1165pstate">pstate</a>.<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::default_ttl" title='sldns_file_parse_state::default_ttl' data-ref="sldns_file_parse_state::default_ttl" data-ref-filename="sldns_file_parse_state..default_ttl">default_ttl</a> = <var>3600</var>;</td></tr>
<tr><th id="4723">4723</th><td>	<b>if</b>(<a class="local col2 ref" href="#1162xfr" title='xfr' data-ref="1162xfr" data-ref-filename="1162xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::namelen" title='auth_xfer::namelen' data-ref="auth_xfer::namelen" data-ref-filename="auth_xfer..namelen">namelen</a> &lt; <b>sizeof</b>(<a class="local col5 ref" href="#1165pstate" title='pstate' data-ref="1165pstate" data-ref-filename="1165pstate">pstate</a>.<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::origin" title='sldns_file_parse_state::origin' data-ref="sldns_file_parse_state::origin" data-ref-filename="sldns_file_parse_state..origin">origin</a>)) {</td></tr>
<tr><th id="4724">4724</th><td>		<a class="local col5 ref" href="#1165pstate" title='pstate' data-ref="1165pstate" data-ref-filename="1165pstate">pstate</a>.<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::origin_len" title='sldns_file_parse_state::origin_len' data-ref="sldns_file_parse_state::origin_len" data-ref-filename="sldns_file_parse_state..origin_len">origin_len</a> = <a class="local col2 ref" href="#1162xfr" title='xfr' data-ref="1162xfr" data-ref-filename="1162xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::namelen" title='auth_xfer::namelen' data-ref="auth_xfer::namelen" data-ref-filename="auth_xfer..namelen">namelen</a>;</td></tr>
<tr><th id="4725">4725</th><td>		<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(pstate.origin, 0) != (size_t)-1) ? __builtin___memmove_chk(pstate.origin, xfr-&gt;name, xfr-&gt;namelen, __builtin_object_size(pstate.origin, 0)) : __memmove_ichk(pstate.origin, xfr-&gt;name, xfr-&gt;namelen))" data-ref="_M/memmove">memmove</a>(<a class="local col5 ref" href="#1165pstate" title='pstate' data-ref="1165pstate" data-ref-filename="1165pstate">pstate</a>.<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::origin" title='sldns_file_parse_state::origin' data-ref="sldns_file_parse_state::origin" data-ref-filename="sldns_file_parse_state..origin">origin</a>, <a class="local col2 ref" href="#1162xfr" title='xfr' data-ref="1162xfr" data-ref-filename="1162xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a>, <a class="local col2 ref" href="#1162xfr" title='xfr' data-ref="1162xfr" data-ref-filename="1162xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::namelen" title='auth_xfer::namelen' data-ref="auth_xfer::namelen" data-ref-filename="auth_xfer..namelen">namelen</a>);</td></tr>
<tr><th id="4726">4726</th><td>	}</td></tr>
<tr><th id="4727">4727</th><td></td></tr>
<tr><th id="4728">4728</th><td>	<b>if</b>(<a class="ref" href="../util/log.h.html#verbosity" title='verbosity' data-ref="verbosity" data-ref-filename="verbosity">verbosity</a> &gt;= <a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>)</td></tr>
<tr><th id="4729">4729</th><td>		<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"http download %s of size %d"</q>,</td></tr>
<tr><th id="4730">4730</th><td>		<a class="local col2 ref" href="#1162xfr" title='xfr' data-ref="1162xfr" data-ref-filename="1162xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::file" title='auth_master::file' data-ref="auth_master::file" data-ref-filename="auth_master..file">file</a>,</td></tr>
<tr><th id="4731">4731</th><td>		(<em>int</em>)<a class="tu ref fn" href="#chunklist_sum" title='chunklist_sum' data-use='c' data-ref="chunklist_sum" data-ref-filename="chunklist_sum">chunklist_sum</a>(<a class="local col2 ref" href="#1162xfr" title='xfr' data-ref="1162xfr" data-ref-filename="1162xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::chunks_first" title='auth_transfer::chunks_first' data-ref="auth_transfer::chunks_first" data-ref-filename="auth_transfer..chunks_first">chunks_first</a>));</td></tr>
<tr><th id="4732">4732</th><td>	<b>if</b>(<a class="local col2 ref" href="#1162xfr" title='xfr' data-ref="1162xfr" data-ref-filename="1162xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::chunks_first" title='auth_transfer::chunks_first' data-ref="auth_transfer::chunks_first" data-ref-filename="auth_transfer..chunks_first">chunks_first</a> &amp;&amp; <a class="ref" href="../util/log.h.html#verbosity" title='verbosity' data-ref="verbosity" data-ref-filename="verbosity">verbosity</a> &gt;= <a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>) {</td></tr>
<tr><th id="4733">4733</th><td>		<em>char</em> <dfn class="local col8 decl" id="1168preview" title='preview' data-type='char [1024]' data-ref="1168preview" data-ref-filename="1168preview">preview</dfn>[<var>1024</var>];</td></tr>
<tr><th id="4734">4734</th><td>		<b>if</b>(<a class="local col2 ref" href="#1162xfr" title='xfr' data-ref="1162xfr" data-ref-filename="1162xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::chunks_first" title='auth_transfer::chunks_first' data-ref="auth_transfer::chunks_first" data-ref-filename="auth_transfer..chunks_first">chunks_first</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::len" title='auth_chunk::len' data-ref="auth_chunk::len" data-ref-filename="auth_chunk..len">len</a>+<var>1</var> &gt; <b>sizeof</b>(<a class="local col8 ref" href="#1168preview" title='preview' data-ref="1168preview" data-ref-filename="1168preview">preview</a>)) {</td></tr>
<tr><th id="4735">4735</th><td>			<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(preview, 0) != (size_t)-1) ? __builtin___memmove_chk(preview, xfr-&gt;task_transfer-&gt;chunks_first-&gt;data, sizeof(preview)-1, __builtin_object_size(preview, 0)) : __memmove_ichk(preview, xfr-&gt;task_transfer-&gt;chunks_first-&gt;data, sizeof(preview)-1))" data-ref="_M/memmove">memmove</a>(<a class="local col8 ref" href="#1168preview" title='preview' data-ref="1168preview" data-ref-filename="1168preview">preview</a>, <a class="local col2 ref" href="#1162xfr" title='xfr' data-ref="1162xfr" data-ref-filename="1162xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::chunks_first" title='auth_transfer::chunks_first' data-ref="auth_transfer::chunks_first" data-ref-filename="auth_transfer..chunks_first">chunks_first</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::data" title='auth_chunk::data' data-ref="auth_chunk::data" data-ref-filename="auth_chunk..data">data</a>,</td></tr>
<tr><th id="4736">4736</th><td>				<b>sizeof</b>(<a class="local col8 ref" href="#1168preview" title='preview' data-ref="1168preview" data-ref-filename="1168preview">preview</a>)-<var>1</var>);</td></tr>
<tr><th id="4737">4737</th><td>			<a class="local col8 ref" href="#1168preview" title='preview' data-ref="1168preview" data-ref-filename="1168preview">preview</a>[<b>sizeof</b>(<a class="local col8 ref" href="#1168preview" title='preview' data-ref="1168preview" data-ref-filename="1168preview">preview</a>)-<var>1</var>]=<var>0</var>;</td></tr>
<tr><th id="4738">4738</th><td>		} <b>else</b> {</td></tr>
<tr><th id="4739">4739</th><td>			<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(preview, 0) != (size_t)-1) ? __builtin___memmove_chk(preview, xfr-&gt;task_transfer-&gt;chunks_first-&gt;data, xfr-&gt;task_transfer-&gt;chunks_first-&gt;len, __builtin_object_size(preview, 0)) : __memmove_ichk(preview, xfr-&gt;task_transfer-&gt;chunks_first-&gt;data, xfr-&gt;task_transfer-&gt;chunks_first-&gt;len))" data-ref="_M/memmove">memmove</a>(<a class="local col8 ref" href="#1168preview" title='preview' data-ref="1168preview" data-ref-filename="1168preview">preview</a>, <a class="local col2 ref" href="#1162xfr" title='xfr' data-ref="1162xfr" data-ref-filename="1162xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::chunks_first" title='auth_transfer::chunks_first' data-ref="auth_transfer::chunks_first" data-ref-filename="auth_transfer..chunks_first">chunks_first</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::data" title='auth_chunk::data' data-ref="auth_chunk::data" data-ref-filename="auth_chunk..data">data</a>,</td></tr>
<tr><th id="4740">4740</th><td>				<a class="local col2 ref" href="#1162xfr" title='xfr' data-ref="1162xfr" data-ref-filename="1162xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::chunks_first" title='auth_transfer::chunks_first' data-ref="auth_transfer::chunks_first" data-ref-filename="auth_transfer..chunks_first">chunks_first</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::len" title='auth_chunk::len' data-ref="auth_chunk::len" data-ref-filename="auth_chunk..len">len</a>);</td></tr>
<tr><th id="4741">4741</th><td>			<a class="local col8 ref" href="#1168preview" title='preview' data-ref="1168preview" data-ref-filename="1168preview">preview</a>[<a class="local col2 ref" href="#1162xfr" title='xfr' data-ref="1162xfr" data-ref-filename="1162xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::chunks_first" title='auth_transfer::chunks_first' data-ref="auth_transfer::chunks_first" data-ref-filename="auth_transfer..chunks_first">chunks_first</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::len" title='auth_chunk::len' data-ref="auth_chunk::len" data-ref-filename="auth_chunk..len">len</a>]=<var>0</var>;</td></tr>
<tr><th id="4742">4742</th><td>		}</td></tr>
<tr><th id="4743">4743</th><td>		<a class="ref fn" href="../util/log.h.html#log_info" title='log_info' data-ref="log_info" data-ref-filename="log_info">log_info</a>(<q>"auth zone http downloaded content preview: %s"</q>,</td></tr>
<tr><th id="4744">4744</th><td>			<a class="local col8 ref" href="#1168preview" title='preview' data-ref="1168preview" data-ref-filename="1168preview">preview</a>);</td></tr>
<tr><th id="4745">4745</th><td>	}</td></tr>
<tr><th id="4746">4746</th><td></td></tr>
<tr><th id="4747">4747</th><td>	<i>/* perhaps a little syntax check before we try to apply the data? */</i></td></tr>
<tr><th id="4748">4748</th><td>	<b>if</b>(!<a class="tu ref fn" href="#http_zonefile_syntax_check" title='http_zonefile_syntax_check' data-use='c' data-ref="http_zonefile_syntax_check" data-ref-filename="http_zonefile_syntax_check">http_zonefile_syntax_check</a>(<a class="local col2 ref" href="#1162xfr" title='xfr' data-ref="1162xfr" data-ref-filename="1162xfr">xfr</a>, <a class="local col4 ref" href="#1164scratch_buffer" title='scratch_buffer' data-ref="1164scratch_buffer" data-ref-filename="1164scratch_buffer">scratch_buffer</a>)) {</td></tr>
<tr><th id="4749">4749</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"http download %s/%s does not contain a zonefile, "</q></td></tr>
<tr><th id="4750">4750</th><td>			<q>"but got '%s'"</q>, <a class="local col2 ref" href="#1162xfr" title='xfr' data-ref="1162xfr" data-ref-filename="1162xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>,</td></tr>
<tr><th id="4751">4751</th><td>			<a class="local col2 ref" href="#1162xfr" title='xfr' data-ref="1162xfr" data-ref-filename="1162xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::file" title='auth_master::file' data-ref="auth_master::file" data-ref-filename="auth_master..file">file</a>,</td></tr>
<tr><th id="4752">4752</th><td>			<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_begin" title='sldns_buffer_begin' data-ref="sldns_buffer_begin" data-ref-filename="sldns_buffer_begin">sldns_buffer_begin</a>(<a class="local col4 ref" href="#1164scratch_buffer" title='scratch_buffer' data-ref="1164scratch_buffer" data-ref-filename="1164scratch_buffer">scratch_buffer</a>));</td></tr>
<tr><th id="4753">4753</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4754">4754</th><td>	}</td></tr>
<tr><th id="4755">4755</th><td></td></tr>
<tr><th id="4756">4756</th><td>	<i>/* clear the data tree */</i></td></tr>
<tr><th id="4757">4757</th><td>	<a class="ref fn" href="../util/rbtree.h.html#traverse_postorder" title='traverse_postorder' data-ref="traverse_postorder" data-ref-filename="traverse_postorder">traverse_postorder</a>(&amp;<a class="local col3 ref" href="#1163z" title='z' data-ref="1163z" data-ref-filename="1163z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::data" title='auth_zone::data' data-ref="auth_zone::data" data-ref-filename="auth_zone..data">data</a>, <a class="tu ref fn" href="#auth_data_del" title='auth_data_del' data-use='r' data-ref="auth_data_del" data-ref-filename="auth_data_del">auth_data_del</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="4758">4758</th><td>	<a class="ref fn" href="../util/rbtree.h.html#rbtree_init" title='rbtree_init' data-ref="rbtree_init" data-ref-filename="rbtree_init">rbtree_init</a>(&amp;<a class="local col3 ref" href="#1163z" title='z' data-ref="1163z" data-ref-filename="1163z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::data" title='auth_zone::data' data-ref="auth_zone::data" data-ref-filename="auth_zone..data">data</a>, &amp;<a class="ref fn" href="#auth_data_cmp" title='auth_data_cmp' data-ref="auth_data_cmp" data-ref-filename="auth_data_cmp">auth_data_cmp</a>);</td></tr>
<tr><th id="4759">4759</th><td>	<a class="local col2 ref" href="#1162xfr" title='xfr' data-ref="1162xfr" data-ref-filename="1162xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::have_zone" title='auth_xfer::have_zone' data-ref="auth_xfer::have_zone" data-ref-filename="auth_xfer..have_zone">have_zone</a> = <var>0</var>;</td></tr>
<tr><th id="4760">4760</th><td>	<a class="local col2 ref" href="#1162xfr" title='xfr' data-ref="1162xfr" data-ref-filename="1162xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::serial" title='auth_xfer::serial' data-ref="auth_xfer::serial" data-ref-filename="auth_xfer..serial">serial</a> = <var>0</var>;</td></tr>
<tr><th id="4761">4761</th><td></td></tr>
<tr><th id="4762">4762</th><td>	<a class="local col6 ref" href="#1166chunk" title='chunk' data-ref="1166chunk" data-ref-filename="1166chunk">chunk</a> = <a class="local col2 ref" href="#1162xfr" title='xfr' data-ref="1162xfr" data-ref-filename="1162xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::chunks_first" title='auth_transfer::chunks_first' data-ref="auth_transfer::chunks_first" data-ref-filename="auth_transfer..chunks_first">chunks_first</a>;</td></tr>
<tr><th id="4763">4763</th><td>	<a class="local col7 ref" href="#1167chunk_pos" title='chunk_pos' data-ref="1167chunk_pos" data-ref-filename="1167chunk_pos">chunk_pos</a> = <var>0</var>;</td></tr>
<tr><th id="4764">4764</th><td>	<a class="local col5 ref" href="#1165pstate" title='pstate' data-ref="1165pstate" data-ref-filename="1165pstate">pstate</a>.<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::lineno" title='sldns_file_parse_state::lineno' data-ref="sldns_file_parse_state::lineno" data-ref-filename="sldns_file_parse_state..lineno">lineno</a> = <var>0</var>;</td></tr>
<tr><th id="4765">4765</th><td>	<b>while</b>(<a class="tu ref fn" href="#chunkline_get_line_collated" title='chunkline_get_line_collated' data-use='c' data-ref="chunkline_get_line_collated" data-ref-filename="chunkline_get_line_collated">chunkline_get_line_collated</a>(&amp;<a class="local col6 ref" href="#1166chunk" title='chunk' data-ref="1166chunk" data-ref-filename="1166chunk">chunk</a>, &amp;<a class="local col7 ref" href="#1167chunk_pos" title='chunk_pos' data-ref="1167chunk_pos" data-ref-filename="1167chunk_pos">chunk_pos</a>, <a class="local col4 ref" href="#1164scratch_buffer" title='scratch_buffer' data-ref="1164scratch_buffer" data-ref-filename="1164scratch_buffer">scratch_buffer</a>)) {</td></tr>
<tr><th id="4766">4766</th><td>		<i>/* process this line */</i></td></tr>
<tr><th id="4767">4767</th><td>		<a class="local col5 ref" href="#1165pstate" title='pstate' data-ref="1165pstate" data-ref-filename="1165pstate">pstate</a>.<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::lineno" title='sldns_file_parse_state::lineno' data-ref="sldns_file_parse_state::lineno" data-ref-filename="sldns_file_parse_state..lineno">lineno</a>++;</td></tr>
<tr><th id="4768">4768</th><td>		<a class="tu ref fn" href="#chunkline_newline_removal" title='chunkline_newline_removal' data-use='c' data-ref="chunkline_newline_removal" data-ref-filename="chunkline_newline_removal">chunkline_newline_removal</a>(<a class="local col4 ref" href="#1164scratch_buffer" title='scratch_buffer' data-ref="1164scratch_buffer" data-ref-filename="1164scratch_buffer">scratch_buffer</a>);</td></tr>
<tr><th id="4769">4769</th><td>		<b>if</b>(<a class="tu ref fn" href="#chunkline_is_comment_line_or_empty" title='chunkline_is_comment_line_or_empty' data-use='c' data-ref="chunkline_is_comment_line_or_empty" data-ref-filename="chunkline_is_comment_line_or_empty">chunkline_is_comment_line_or_empty</a>(<a class="local col4 ref" href="#1164scratch_buffer" title='scratch_buffer' data-ref="1164scratch_buffer" data-ref-filename="1164scratch_buffer">scratch_buffer</a>)) {</td></tr>
<tr><th id="4770">4770</th><td>			<b>continue</b>;</td></tr>
<tr><th id="4771">4771</th><td>		}</td></tr>
<tr><th id="4772">4772</th><td>		<i>/* parse line and add RR */</i></td></tr>
<tr><th id="4773">4773</th><td>		<b>if</b>(<a class="tu ref fn" href="#http_parse_origin" title='http_parse_origin' data-use='c' data-ref="http_parse_origin" data-ref-filename="http_parse_origin">http_parse_origin</a>(<a class="local col4 ref" href="#1164scratch_buffer" title='scratch_buffer' data-ref="1164scratch_buffer" data-ref-filename="1164scratch_buffer">scratch_buffer</a>, &amp;<a class="local col5 ref" href="#1165pstate" title='pstate' data-ref="1165pstate" data-ref-filename="1165pstate">pstate</a>)) {</td></tr>
<tr><th id="4774">4774</th><td>			<b>continue</b>; <i>/* $ORIGIN has been handled */</i></td></tr>
<tr><th id="4775">4775</th><td>		}</td></tr>
<tr><th id="4776">4776</th><td>		<b>if</b>(<a class="tu ref fn" href="#http_parse_ttl" title='http_parse_ttl' data-use='c' data-ref="http_parse_ttl" data-ref-filename="http_parse_ttl">http_parse_ttl</a>(<a class="local col4 ref" href="#1164scratch_buffer" title='scratch_buffer' data-ref="1164scratch_buffer" data-ref-filename="1164scratch_buffer">scratch_buffer</a>, &amp;<a class="local col5 ref" href="#1165pstate" title='pstate' data-ref="1165pstate" data-ref-filename="1165pstate">pstate</a>)) {</td></tr>
<tr><th id="4777">4777</th><td>			<b>continue</b>; <i>/* $TTL has been handled */</i></td></tr>
<tr><th id="4778">4778</th><td>		}</td></tr>
<tr><th id="4779">4779</th><td>		<b>if</b>(!<a class="tu ref fn" href="#http_parse_add_rr" title='http_parse_add_rr' data-use='c' data-ref="http_parse_add_rr" data-ref-filename="http_parse_add_rr">http_parse_add_rr</a>(<a class="local col2 ref" href="#1162xfr" title='xfr' data-ref="1162xfr" data-ref-filename="1162xfr">xfr</a>, <a class="local col3 ref" href="#1163z" title='z' data-ref="1163z" data-ref-filename="1163z">z</a>, <a class="local col4 ref" href="#1164scratch_buffer" title='scratch_buffer' data-ref="1164scratch_buffer" data-ref-filename="1164scratch_buffer">scratch_buffer</a>, &amp;<a class="local col5 ref" href="#1165pstate" title='pstate' data-ref="1165pstate" data-ref-filename="1165pstate">pstate</a>)) {</td></tr>
<tr><th id="4780">4780</th><td>			<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"error parsing line [%s:%d] %s"</q>,</td></tr>
<tr><th id="4781">4781</th><td>				<a class="local col2 ref" href="#1162xfr" title='xfr' data-ref="1162xfr" data-ref-filename="1162xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::file" title='auth_master::file' data-ref="auth_master::file" data-ref-filename="auth_master..file">file</a>,</td></tr>
<tr><th id="4782">4782</th><td>				<a class="local col5 ref" href="#1165pstate" title='pstate' data-ref="1165pstate" data-ref-filename="1165pstate">pstate</a>.<a class="ref field" href="../sldns/str2wire.h.html#sldns_file_parse_state::lineno" title='sldns_file_parse_state::lineno' data-ref="sldns_file_parse_state::lineno" data-ref-filename="sldns_file_parse_state..lineno">lineno</a>,</td></tr>
<tr><th id="4783">4783</th><td>				<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_begin" title='sldns_buffer_begin' data-ref="sldns_buffer_begin" data-ref-filename="sldns_buffer_begin">sldns_buffer_begin</a>(<a class="local col4 ref" href="#1164scratch_buffer" title='scratch_buffer' data-ref="1164scratch_buffer" data-ref-filename="1164scratch_buffer">scratch_buffer</a>));</td></tr>
<tr><th id="4784">4784</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4785">4785</th><td>		}</td></tr>
<tr><th id="4786">4786</th><td>	}</td></tr>
<tr><th id="4787">4787</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="4788">4788</th><td>}</td></tr>
<tr><th id="4789">4789</th><td></td></tr>
<tr><th id="4790">4790</th><td><i class="doc" data-doc="auth_zone_write_chunks">/** write http chunks to zonefile to create downloaded file */</i></td></tr>
<tr><th id="4791">4791</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="4792">4792</th><td><dfn class="tu decl def fn" id="auth_zone_write_chunks" title='auth_zone_write_chunks' data-type='int auth_zone_write_chunks(struct auth_xfer * xfr, const char * fname)' data-ref="auth_zone_write_chunks" data-ref-filename="auth_zone_write_chunks">auth_zone_write_chunks</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col9 decl" id="1169xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1169xfr" data-ref-filename="1169xfr">xfr</dfn>, <em>const</em> <em>char</em>* <dfn class="local col0 decl" id="1170fname" title='fname' data-type='const char *' data-ref="1170fname" data-ref-filename="1170fname">fname</dfn>)</td></tr>
<tr><th id="4793">4793</th><td>{</td></tr>
<tr><th id="4794">4794</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#FILE" title='FILE' data-type='struct __sFILE' data-ref="FILE" data-ref-filename="FILE">FILE</a>* <dfn class="local col1 decl" id="1171out" title='out' data-type='FILE *' data-ref="1171out" data-ref-filename="1171out">out</dfn>;</td></tr>
<tr><th id="4795">4795</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_chunk" title='auth_chunk' data-ref="auth_chunk" data-ref-filename="auth_chunk">auth_chunk</a>* <dfn class="local col2 decl" id="1172p" title='p' data-type='struct auth_chunk *' data-ref="1172p" data-ref-filename="1172p">p</dfn>;</td></tr>
<tr><th id="4796">4796</th><td>	<a class="local col1 ref" href="#1171out" title='out' data-ref="1171out" data-ref-filename="1171out">out</a> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#fopen" title='fopen' data-ref="fopen" data-ref-filename="fopen">fopen</a>(<a class="local col0 ref" href="#1170fname" title='fname' data-ref="1170fname" data-ref-filename="1170fname">fname</a>, <q>"w"</q>);</td></tr>
<tr><th id="4797">4797</th><td>	<b>if</b>(!<a class="local col1 ref" href="#1171out" title='out' data-ref="1171out" data-ref-filename="1171out">out</a>) {</td></tr>
<tr><th id="4798">4798</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"could not open %s: %s"</q>, <a class="local col0 ref" href="#1170fname" title='fname' data-ref="1170fname" data-ref-filename="1170fname">fname</a>, <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strerror" title='strerror' data-ref="strerror" data-ref-filename="strerror">strerror</a>(<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/errno.h.html#55" title="(*__errno())" data-ref="_M/errno">errno</a>));</td></tr>
<tr><th id="4799">4799</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4800">4800</th><td>	}</td></tr>
<tr><th id="4801">4801</th><td>	<b>for</b>(<a class="local col2 ref" href="#1172p" title='p' data-ref="1172p" data-ref-filename="1172p">p</a> = <a class="local col9 ref" href="#1169xfr" title='xfr' data-ref="1169xfr" data-ref-filename="1169xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::chunks_first" title='auth_transfer::chunks_first' data-ref="auth_transfer::chunks_first" data-ref-filename="auth_transfer..chunks_first">chunks_first</a>; <a class="local col2 ref" href="#1172p" title='p' data-ref="1172p" data-ref-filename="1172p">p</a> ; <a class="local col2 ref" href="#1172p" title='p' data-ref="1172p" data-ref-filename="1172p">p</a> = <a class="local col2 ref" href="#1172p" title='p' data-ref="1172p" data-ref-filename="1172p">p</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::next" title='auth_chunk::next' data-ref="auth_chunk::next" data-ref-filename="auth_chunk..next">next</a>) {</td></tr>
<tr><th id="4802">4802</th><td>		<b>if</b>(!<a class="tu ref fn" href="#write_out" title='write_out' data-use='c' data-ref="write_out" data-ref-filename="write_out">write_out</a>(<a class="local col1 ref" href="#1171out" title='out' data-ref="1171out" data-ref-filename="1171out">out</a>, (<em>char</em>*)<a class="local col2 ref" href="#1172p" title='p' data-ref="1172p" data-ref-filename="1172p">p</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::data" title='auth_chunk::data' data-ref="auth_chunk::data" data-ref-filename="auth_chunk..data">data</a>, <a class="local col2 ref" href="#1172p" title='p' data-ref="1172p" data-ref-filename="1172p">p</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::len" title='auth_chunk::len' data-ref="auth_chunk::len" data-ref-filename="auth_chunk..len">len</a>)) {</td></tr>
<tr><th id="4803">4803</th><td>			<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"could not write http download to %s"</q>, <a class="local col0 ref" href="#1170fname" title='fname' data-ref="1170fname" data-ref-filename="1170fname">fname</a>);</td></tr>
<tr><th id="4804">4804</th><td>			<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#fclose" title='fclose' data-ref="fclose" data-ref-filename="fclose">fclose</a>(<a class="local col1 ref" href="#1171out" title='out' data-ref="1171out" data-ref-filename="1171out">out</a>);</td></tr>
<tr><th id="4805">4805</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4806">4806</th><td>		}</td></tr>
<tr><th id="4807">4807</th><td>	}</td></tr>
<tr><th id="4808">4808</th><td>	<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#fclose" title='fclose' data-ref="fclose" data-ref-filename="fclose">fclose</a>(<a class="local col1 ref" href="#1171out" title='out' data-ref="1171out" data-ref-filename="1171out">out</a>);</td></tr>
<tr><th id="4809">4809</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="4810">4810</th><td>}</td></tr>
<tr><th id="4811">4811</th><td></td></tr>
<tr><th id="4812">4812</th><td><i class="doc" data-doc="xfr_write_after_update">/** write to zonefile after zone has been updated */</i></td></tr>
<tr><th id="4813">4813</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="4814">4814</th><td><dfn class="tu decl def fn" id="xfr_write_after_update" title='xfr_write_after_update' data-type='void xfr_write_after_update(struct auth_xfer * xfr, struct module_env * env)' data-ref="xfr_write_after_update" data-ref-filename="xfr_write_after_update">xfr_write_after_update</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col3 decl" id="1173xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1173xfr" data-ref-filename="1173xfr">xfr</dfn>, <b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col4 decl" id="1174env" title='env' data-type='struct module_env *' data-ref="1174env" data-ref-filename="1174env">env</dfn>)</td></tr>
<tr><th id="4815">4815</th><td>{</td></tr>
<tr><th id="4816">4816</th><td>	<b>struct</b> <a class="type" href="../util/config_file.h.html#config_file" title='config_file' data-ref="config_file" data-ref-filename="config_file">config_file</a>* <dfn class="local col5 decl" id="1175cfg" title='cfg' data-type='struct config_file *' data-ref="1175cfg" data-ref-filename="1175cfg">cfg</dfn> = <a class="local col4 ref" href="#1174env" title='env' data-ref="1174env" data-ref-filename="1174env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::cfg" title='module_env::cfg' data-ref="module_env::cfg" data-ref-filename="module_env..cfg">cfg</a>;</td></tr>
<tr><th id="4817">4817</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col6 decl" id="1176z" title='z' data-type='struct auth_zone *' data-ref="1176z" data-ref-filename="1176z">z</dfn>;</td></tr>
<tr><th id="4818">4818</th><td>	<em>char</em> <dfn class="local col7 decl" id="1177tmpfile" title='tmpfile' data-type='char [1024]' data-ref="1177tmpfile" data-ref-filename="1177tmpfile">tmpfile</dfn>[<var>1024</var>];</td></tr>
<tr><th id="4819">4819</th><td>	<em>char</em>* <dfn class="local col8 decl" id="1178zfilename" title='zfilename' data-type='char *' data-ref="1178zfilename" data-ref-filename="1178zfilename">zfilename</dfn>;</td></tr>
<tr><th id="4820">4820</th><td>	<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 4820, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col3 ref" href="#1173xfr" title='xfr' data-ref="1173xfr" data-ref-filename="1173xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="4821">4821</th><td></td></tr>
<tr><th id="4822">4822</th><td>	<i>/* get lock again, so it is a readlock and concurrently queries</i></td></tr>
<tr><th id="4823">4823</th><td><i>	 * can be answered */</i></td></tr>
<tr><th id="4824">4824</th><td>	<a class="macro" href="../util/locks.h.html#119" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_rdlock(&amp;env-&gt;auth_zones-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_rdlock(&amp;env-&gt;auth_zones-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 4824, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_rdlock">lock_rw_rdlock</a>(&amp;<a class="local col4 ref" href="#1174env" title='env' data-ref="1174env" data-ref-filename="1174env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::auth_zones" title='module_env::auth_zones' data-ref="module_env::auth_zones" data-ref-filename="module_env..auth_zones">auth_zones</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="4825">4825</th><td>	<a class="local col6 ref" href="#1176z" title='z' data-ref="1176z" data-ref-filename="1176z">z</a> = <a class="ref fn" href="#auth_zone_find" title='auth_zone_find' data-ref="auth_zone_find" data-ref-filename="auth_zone_find">auth_zone_find</a>(<a class="local col4 ref" href="#1174env" title='env' data-ref="1174env" data-ref-filename="1174env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::auth_zones" title='module_env::auth_zones' data-ref="module_env::auth_zones" data-ref-filename="module_env..auth_zones">auth_zones</a>, <a class="local col3 ref" href="#1173xfr" title='xfr' data-ref="1173xfr" data-ref-filename="1173xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a>, <a class="local col3 ref" href="#1173xfr" title='xfr' data-ref="1173xfr" data-ref-filename="1173xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::namelen" title='auth_xfer::namelen' data-ref="auth_xfer::namelen" data-ref-filename="auth_xfer..namelen">namelen</a>,</td></tr>
<tr><th id="4826">4826</th><td>		<a class="local col3 ref" href="#1173xfr" title='xfr' data-ref="1173xfr" data-ref-filename="1173xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::dclass" title='auth_xfer::dclass' data-ref="auth_xfer::dclass" data-ref-filename="auth_xfer..dclass">dclass</a>);</td></tr>
<tr><th id="4827">4827</th><td>	<b>if</b>(!<a class="local col6 ref" href="#1176z" title='z' data-ref="1176z" data-ref-filename="1176z">z</a>) {</td></tr>
<tr><th id="4828">4828</th><td>		<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;env-&gt;auth_zones-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;env-&gt;auth_zones-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 4828, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col4 ref" href="#1174env" title='env' data-ref="1174env" data-ref-filename="1174env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::auth_zones" title='module_env::auth_zones' data-ref="module_env::auth_zones" data-ref-filename="module_env..auth_zones">auth_zones</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="4829">4829</th><td>		<i>/* the zone is gone, ignore xfr results */</i></td></tr>
<tr><th id="4830">4830</th><td>		<a class="macro" href="../util/locks.h.html#102" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_lock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_lock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 4830, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_lock">lock_basic_lock</a>(&amp;<a class="local col3 ref" href="#1173xfr" title='xfr' data-ref="1173xfr" data-ref-filename="1173xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="4831">4831</th><td>		<b>return</b>;</td></tr>
<tr><th id="4832">4832</th><td>	}</td></tr>
<tr><th id="4833">4833</th><td>	<a class="macro" href="../util/locks.h.html#119" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_rdlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_rdlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 4833, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_rdlock">lock_rw_rdlock</a>(&amp;<a class="local col6 ref" href="#1176z" title='z' data-ref="1176z" data-ref-filename="1176z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="4834">4834</th><td>	<a class="macro" href="../util/locks.h.html#102" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_lock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_lock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 4834, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_lock">lock_basic_lock</a>(&amp;<a class="local col3 ref" href="#1173xfr" title='xfr' data-ref="1173xfr" data-ref-filename="1173xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="4835">4835</th><td>	<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;env-&gt;auth_zones-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;env-&gt;auth_zones-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 4835, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col4 ref" href="#1174env" title='env' data-ref="1174env" data-ref-filename="1174env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::auth_zones" title='module_env::auth_zones' data-ref="module_env::auth_zones" data-ref-filename="module_env..auth_zones">auth_zones</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="4836">4836</th><td></td></tr>
<tr><th id="4837">4837</th><td>	<b>if</b>(<a class="local col6 ref" href="#1176z" title='z' data-ref="1176z" data-ref-filename="1176z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::zonefile" title='auth_zone::zonefile' data-ref="auth_zone::zonefile" data-ref-filename="auth_zone..zonefile">zonefile</a> == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span> || <a class="local col6 ref" href="#1176z" title='z' data-ref="1176z" data-ref-filename="1176z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::zonefile" title='auth_zone::zonefile' data-ref="auth_zone::zonefile" data-ref-filename="auth_zone..zonefile">zonefile</a>[<var>0</var>] == <var>0</var>) {</td></tr>
<tr><th id="4838">4838</th><td>		<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 4838, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col6 ref" href="#1176z" title='z' data-ref="1176z" data-ref-filename="1176z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="4839">4839</th><td>		<i>/* no write needed, no zonefile set */</i></td></tr>
<tr><th id="4840">4840</th><td>		<b>return</b>;</td></tr>
<tr><th id="4841">4841</th><td>	}</td></tr>
<tr><th id="4842">4842</th><td>	<a class="local col8 ref" href="#1178zfilename" title='zfilename' data-ref="1178zfilename" data-ref-filename="1178zfilename">zfilename</a> = <a class="local col6 ref" href="#1176z" title='z' data-ref="1176z" data-ref-filename="1176z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::zonefile" title='auth_zone::zonefile' data-ref="auth_zone::zonefile" data-ref-filename="auth_zone..zonefile">zonefile</a>;</td></tr>
<tr><th id="4843">4843</th><td>	<b>if</b>(<a class="local col5 ref" href="#1175cfg" title='cfg' data-ref="1175cfg" data-ref-filename="1175cfg">cfg</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_file::chrootdir" title='config_file::chrootdir' data-ref="config_file::chrootdir" data-ref-filename="config_file..chrootdir">chrootdir</a> &amp;&amp; <a class="local col5 ref" href="#1175cfg" title='cfg' data-ref="1175cfg" data-ref-filename="1175cfg">cfg</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_file::chrootdir" title='config_file::chrootdir' data-ref="config_file::chrootdir" data-ref-filename="config_file..chrootdir">chrootdir</a>[<var>0</var>] &amp;&amp; <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strncmp" title='strncmp' data-ref="strncmp" data-ref-filename="strncmp">strncmp</a>(<a class="local col8 ref" href="#1178zfilename" title='zfilename' data-ref="1178zfilename" data-ref-filename="1178zfilename">zfilename</a>,</td></tr>
<tr><th id="4844">4844</th><td>		<a class="local col5 ref" href="#1175cfg" title='cfg' data-ref="1175cfg" data-ref-filename="1175cfg">cfg</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_file::chrootdir" title='config_file::chrootdir' data-ref="config_file::chrootdir" data-ref-filename="config_file..chrootdir">chrootdir</a>, <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strlen" title='strlen' data-ref="strlen" data-ref-filename="strlen">strlen</a>(<a class="local col5 ref" href="#1175cfg" title='cfg' data-ref="1175cfg" data-ref-filename="1175cfg">cfg</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_file::chrootdir" title='config_file::chrootdir' data-ref="config_file::chrootdir" data-ref-filename="config_file..chrootdir">chrootdir</a>)) == <var>0</var>)</td></tr>
<tr><th id="4845">4845</th><td>		<a class="local col8 ref" href="#1178zfilename" title='zfilename' data-ref="1178zfilename" data-ref-filename="1178zfilename">zfilename</a> += <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strlen" title='strlen' data-ref="strlen" data-ref-filename="strlen">strlen</a>(<a class="local col5 ref" href="#1175cfg" title='cfg' data-ref="1175cfg" data-ref-filename="1175cfg">cfg</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_file::chrootdir" title='config_file::chrootdir' data-ref="config_file::chrootdir" data-ref-filename="config_file..chrootdir">chrootdir</a>);</td></tr>
<tr><th id="4846">4846</th><td></td></tr>
<tr><th id="4847">4847</th><td>	<i>/* write to tempfile first */</i></td></tr>
<tr><th id="4848">4848</th><td>	<b>if</b>((<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>)<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strlen" title='strlen' data-ref="strlen" data-ref-filename="strlen">strlen</a>(<a class="local col8 ref" href="#1178zfilename" title='zfilename' data-ref="1178zfilename" data-ref-filename="1178zfilename">zfilename</a>) + <var>16</var> &gt; <b>sizeof</b>(<a class="local col7 ref" href="#1177tmpfile" title='tmpfile' data-ref="1177tmpfile" data-ref-filename="1177tmpfile">tmpfile</a>)) {</td></tr>
<tr><th id="4849">4849</th><td>		<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"tmpfilename too long, cannot update "</q></td></tr>
<tr><th id="4850">4850</th><td>			<q>" zonefile %s"</q>, <a class="local col8 ref" href="#1178zfilename" title='zfilename' data-ref="1178zfilename" data-ref-filename="1178zfilename">zfilename</a>);</td></tr>
<tr><th id="4851">4851</th><td>		<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 4851, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col6 ref" href="#1176z" title='z' data-ref="1176z" data-ref-filename="1176z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="4852">4852</th><td>		<b>return</b>;</td></tr>
<tr><th id="4853">4853</th><td>	}</td></tr>
<tr><th id="4854">4854</th><td>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/stdio.h.html#61" title="__builtin___snprintf_chk(tmpfile, sizeof(tmpfile), 0, __builtin_object_size(tmpfile, 2 &gt; 1), &quot;%s.tmp%u&quot;, zfilename, (unsigned)getpid())" data-ref="_M/snprintf">snprintf</a>(<a class="local col7 ref" href="#1177tmpfile" title='tmpfile' data-ref="1177tmpfile" data-ref-filename="1177tmpfile">tmpfile</a>, <b>sizeof</b>(<a class="local col7 ref" href="#1177tmpfile" title='tmpfile' data-ref="1177tmpfile" data-ref-filename="1177tmpfile">tmpfile</a>), <q>"%s.tmp%u"</q>, <a class="local col8 ref" href="#1178zfilename" title='zfilename' data-ref="1178zfilename" data-ref-filename="1178zfilename">zfilename</a>,</td></tr>
<tr><th id="4855">4855</th><td>		(<em>unsigned</em>)<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/unistd.h.html#getpid" title='getpid' data-ref="getpid" data-ref-filename="getpid">getpid</a>());</td></tr>
<tr><th id="4856">4856</th><td>	<b>if</b>(<a class="local col3 ref" href="#1173xfr" title='xfr' data-ref="1173xfr" data-ref-filename="1173xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::http" title='auth_master::http' data-ref="auth_master::http" data-ref-filename="auth_master..http">http</a>) {</td></tr>
<tr><th id="4857">4857</th><td>		<i>/* use the stored chunk list to write them */</i></td></tr>
<tr><th id="4858">4858</th><td>		<b>if</b>(!<a class="tu ref fn" href="#auth_zone_write_chunks" title='auth_zone_write_chunks' data-use='c' data-ref="auth_zone_write_chunks" data-ref-filename="auth_zone_write_chunks">auth_zone_write_chunks</a>(<a class="local col3 ref" href="#1173xfr" title='xfr' data-ref="1173xfr" data-ref-filename="1173xfr">xfr</a>, <a class="local col7 ref" href="#1177tmpfile" title='tmpfile' data-ref="1177tmpfile" data-ref-filename="1177tmpfile">tmpfile</a>)) {</td></tr>
<tr><th id="4859">4859</th><td>			<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/unistd.h.html#unlink" title='unlink' data-ref="unlink" data-ref-filename="unlink">unlink</a>(<a class="local col7 ref" href="#1177tmpfile" title='tmpfile' data-ref="1177tmpfile" data-ref-filename="1177tmpfile">tmpfile</a>);</td></tr>
<tr><th id="4860">4860</th><td>			<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 4860, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col6 ref" href="#1176z" title='z' data-ref="1176z" data-ref-filename="1176z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="4861">4861</th><td>		}</td></tr>
<tr><th id="4862">4862</th><td>	} <b>else</b> <b>if</b>(!<a class="ref fn" href="#auth_zone_write_file" title='auth_zone_write_file' data-ref="auth_zone_write_file" data-ref-filename="auth_zone_write_file">auth_zone_write_file</a>(<a class="local col6 ref" href="#1176z" title='z' data-ref="1176z" data-ref-filename="1176z">z</a>, <a class="local col7 ref" href="#1177tmpfile" title='tmpfile' data-ref="1177tmpfile" data-ref-filename="1177tmpfile">tmpfile</a>)) {</td></tr>
<tr><th id="4863">4863</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/unistd.h.html#unlink" title='unlink' data-ref="unlink" data-ref-filename="unlink">unlink</a>(<a class="local col7 ref" href="#1177tmpfile" title='tmpfile' data-ref="1177tmpfile" data-ref-filename="1177tmpfile">tmpfile</a>);</td></tr>
<tr><th id="4864">4864</th><td>		<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 4864, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col6 ref" href="#1176z" title='z' data-ref="1176z" data-ref-filename="1176z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="4865">4865</th><td>		<b>return</b>;</td></tr>
<tr><th id="4866">4866</th><td>	}</td></tr>
<tr><th id="4867">4867</th><td>	<b>if</b>(<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#rename" title='rename' data-ref="rename" data-ref-filename="rename">rename</a>(<a class="local col7 ref" href="#1177tmpfile" title='tmpfile' data-ref="1177tmpfile" data-ref-filename="1177tmpfile">tmpfile</a>, <a class="local col8 ref" href="#1178zfilename" title='zfilename' data-ref="1178zfilename" data-ref-filename="1178zfilename">zfilename</a>) &lt; <var>0</var>) {</td></tr>
<tr><th id="4868">4868</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"could not rename(%s, %s): %s"</q>, <a class="local col7 ref" href="#1177tmpfile" title='tmpfile' data-ref="1177tmpfile" data-ref-filename="1177tmpfile">tmpfile</a>, <a class="local col8 ref" href="#1178zfilename" title='zfilename' data-ref="1178zfilename" data-ref-filename="1178zfilename">zfilename</a>,</td></tr>
<tr><th id="4869">4869</th><td>			<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strerror" title='strerror' data-ref="strerror" data-ref-filename="strerror">strerror</a>(<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/errno.h.html#55" title="(*__errno())" data-ref="_M/errno">errno</a>));</td></tr>
<tr><th id="4870">4870</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/unistd.h.html#unlink" title='unlink' data-ref="unlink" data-ref-filename="unlink">unlink</a>(<a class="local col7 ref" href="#1177tmpfile" title='tmpfile' data-ref="1177tmpfile" data-ref-filename="1177tmpfile">tmpfile</a>);</td></tr>
<tr><th id="4871">4871</th><td>		<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 4871, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col6 ref" href="#1176z" title='z' data-ref="1176z" data-ref-filename="1176z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="4872">4872</th><td>		<b>return</b>;</td></tr>
<tr><th id="4873">4873</th><td>	}</td></tr>
<tr><th id="4874">4874</th><td>	<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 4874, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col6 ref" href="#1176z" title='z' data-ref="1176z" data-ref-filename="1176z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="4875">4875</th><td>}</td></tr>
<tr><th id="4876">4876</th><td></td></tr>
<tr><th id="4877">4877</th><td><i class="doc" data-doc="xfr_process_chunk_list">/** process chunk list and update zone in memory,</i></td></tr>
<tr><th id="4878">4878</th><td><i class="doc" data-doc="xfr_process_chunk_list"> * return false if it did not work */</i></td></tr>
<tr><th id="4879">4879</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="4880">4880</th><td><dfn class="tu decl def fn" id="xfr_process_chunk_list" title='xfr_process_chunk_list' data-type='int xfr_process_chunk_list(struct auth_xfer * xfr, struct module_env * env, int * ixfr_fail)' data-ref="xfr_process_chunk_list" data-ref-filename="xfr_process_chunk_list">xfr_process_chunk_list</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col9 decl" id="1179xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1179xfr" data-ref-filename="1179xfr">xfr</dfn>, <b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col0 decl" id="1180env" title='env' data-type='struct module_env *' data-ref="1180env" data-ref-filename="1180env">env</dfn>,</td></tr>
<tr><th id="4881">4881</th><td>	<em>int</em>* <dfn class="local col1 decl" id="1181ixfr_fail" title='ixfr_fail' data-type='int *' data-ref="1181ixfr_fail" data-ref-filename="1181ixfr_fail">ixfr_fail</dfn>)</td></tr>
<tr><th id="4882">4882</th><td>{</td></tr>
<tr><th id="4883">4883</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col2 decl" id="1182z" title='z' data-type='struct auth_zone *' data-ref="1182z" data-ref-filename="1182z">z</dfn>;</td></tr>
<tr><th id="4884">4884</th><td></td></tr>
<tr><th id="4885">4885</th><td>	<i>/* obtain locks and structures */</i></td></tr>
<tr><th id="4886">4886</th><td>	<i>/* release xfr lock, then, while holding az-&gt;lock grab both</i></td></tr>
<tr><th id="4887">4887</th><td><i>	 * z-&gt;lock and xfr-&gt;lock */</i></td></tr>
<tr><th id="4888">4888</th><td>	<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 4888, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col9 ref" href="#1179xfr" title='xfr' data-ref="1179xfr" data-ref-filename="1179xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="4889">4889</th><td>	<a class="macro" href="../util/locks.h.html#119" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_rdlock(&amp;env-&gt;auth_zones-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_rdlock(&amp;env-&gt;auth_zones-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 4889, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_rdlock">lock_rw_rdlock</a>(&amp;<a class="local col0 ref" href="#1180env" title='env' data-ref="1180env" data-ref-filename="1180env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::auth_zones" title='module_env::auth_zones' data-ref="module_env::auth_zones" data-ref-filename="module_env..auth_zones">auth_zones</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="4890">4890</th><td>	<a class="local col2 ref" href="#1182z" title='z' data-ref="1182z" data-ref-filename="1182z">z</a> = <a class="ref fn" href="#auth_zone_find" title='auth_zone_find' data-ref="auth_zone_find" data-ref-filename="auth_zone_find">auth_zone_find</a>(<a class="local col0 ref" href="#1180env" title='env' data-ref="1180env" data-ref-filename="1180env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::auth_zones" title='module_env::auth_zones' data-ref="module_env::auth_zones" data-ref-filename="module_env..auth_zones">auth_zones</a>, <a class="local col9 ref" href="#1179xfr" title='xfr' data-ref="1179xfr" data-ref-filename="1179xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a>, <a class="local col9 ref" href="#1179xfr" title='xfr' data-ref="1179xfr" data-ref-filename="1179xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::namelen" title='auth_xfer::namelen' data-ref="auth_xfer::namelen" data-ref-filename="auth_xfer..namelen">namelen</a>,</td></tr>
<tr><th id="4891">4891</th><td>		<a class="local col9 ref" href="#1179xfr" title='xfr' data-ref="1179xfr" data-ref-filename="1179xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::dclass" title='auth_xfer::dclass' data-ref="auth_xfer::dclass" data-ref-filename="auth_xfer..dclass">dclass</a>);</td></tr>
<tr><th id="4892">4892</th><td>	<b>if</b>(!<a class="local col2 ref" href="#1182z" title='z' data-ref="1182z" data-ref-filename="1182z">z</a>) {</td></tr>
<tr><th id="4893">4893</th><td>		<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;env-&gt;auth_zones-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;env-&gt;auth_zones-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 4893, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col0 ref" href="#1180env" title='env' data-ref="1180env" data-ref-filename="1180env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::auth_zones" title='module_env::auth_zones' data-ref="module_env::auth_zones" data-ref-filename="module_env..auth_zones">auth_zones</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="4894">4894</th><td>		<i>/* the zone is gone, ignore xfr results */</i></td></tr>
<tr><th id="4895">4895</th><td>		<a class="macro" href="../util/locks.h.html#102" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_lock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_lock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 4895, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_lock">lock_basic_lock</a>(&amp;<a class="local col9 ref" href="#1179xfr" title='xfr' data-ref="1179xfr" data-ref-filename="1179xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="4896">4896</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4897">4897</th><td>	}</td></tr>
<tr><th id="4898">4898</th><td>	<a class="macro" href="../util/locks.h.html#120" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_wrlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_wrlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 4898, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_wrlock">lock_rw_wrlock</a>(&amp;<a class="local col2 ref" href="#1182z" title='z' data-ref="1182z" data-ref-filename="1182z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="4899">4899</th><td>	<a class="macro" href="../util/locks.h.html#102" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_lock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_lock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 4899, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_lock">lock_basic_lock</a>(&amp;<a class="local col9 ref" href="#1179xfr" title='xfr' data-ref="1179xfr" data-ref-filename="1179xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="4900">4900</th><td>	<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;env-&gt;auth_zones-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;env-&gt;auth_zones-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 4900, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col0 ref" href="#1180env" title='env' data-ref="1180env" data-ref-filename="1180env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::auth_zones" title='module_env::auth_zones' data-ref="module_env::auth_zones" data-ref-filename="module_env..auth_zones">auth_zones</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="4901">4901</th><td></td></tr>
<tr><th id="4902">4902</th><td>	<i>/* apply data */</i></td></tr>
<tr><th id="4903">4903</th><td>	<b>if</b>(<a class="local col9 ref" href="#1179xfr" title='xfr' data-ref="1179xfr" data-ref-filename="1179xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::http" title='auth_master::http' data-ref="auth_master::http" data-ref-filename="auth_master..http">http</a>) {</td></tr>
<tr><th id="4904">4904</th><td>		<b>if</b>(!<a class="tu ref fn" href="#apply_http" title='apply_http' data-use='c' data-ref="apply_http" data-ref-filename="apply_http">apply_http</a>(<a class="local col9 ref" href="#1179xfr" title='xfr' data-ref="1179xfr" data-ref-filename="1179xfr">xfr</a>, <a class="local col2 ref" href="#1182z" title='z' data-ref="1182z" data-ref-filename="1182z">z</a>, <a class="local col0 ref" href="#1180env" title='env' data-ref="1180env" data-ref-filename="1180env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::scratch_buffer" title='module_env::scratch_buffer' data-ref="module_env::scratch_buffer" data-ref-filename="module_env..scratch_buffer">scratch_buffer</a>)) {</td></tr>
<tr><th id="4905">4905</th><td>			<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 4905, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col2 ref" href="#1182z" title='z' data-ref="1182z" data-ref-filename="1182z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="4906">4906</th><td>			<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"http from %s: could not store data"</q>,</td></tr>
<tr><th id="4907">4907</th><td>				<a class="local col9 ref" href="#1179xfr" title='xfr' data-ref="1179xfr" data-ref-filename="1179xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="4908">4908</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4909">4909</th><td>		}</td></tr>
<tr><th id="4910">4910</th><td>	} <b>else</b> <b>if</b>(<a class="local col9 ref" href="#1179xfr" title='xfr' data-ref="1179xfr" data-ref-filename="1179xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::on_ixfr" title='auth_transfer::on_ixfr' data-ref="auth_transfer::on_ixfr" data-ref-filename="auth_transfer..on_ixfr">on_ixfr</a> &amp;&amp;</td></tr>
<tr><th id="4911">4911</th><td>		!<a class="local col9 ref" href="#1179xfr" title='xfr' data-ref="1179xfr" data-ref-filename="1179xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::on_ixfr_is_axfr" title='auth_transfer::on_ixfr_is_axfr' data-ref="auth_transfer::on_ixfr_is_axfr" data-ref-filename="auth_transfer..on_ixfr_is_axfr">on_ixfr_is_axfr</a>) {</td></tr>
<tr><th id="4912">4912</th><td>		<b>if</b>(!<a class="tu ref fn" href="#apply_ixfr" title='apply_ixfr' data-use='c' data-ref="apply_ixfr" data-ref-filename="apply_ixfr">apply_ixfr</a>(<a class="local col9 ref" href="#1179xfr" title='xfr' data-ref="1179xfr" data-ref-filename="1179xfr">xfr</a>, <a class="local col2 ref" href="#1182z" title='z' data-ref="1182z" data-ref-filename="1182z">z</a>, <a class="local col0 ref" href="#1180env" title='env' data-ref="1180env" data-ref-filename="1180env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::scratch_buffer" title='module_env::scratch_buffer' data-ref="module_env::scratch_buffer" data-ref-filename="module_env..scratch_buffer">scratch_buffer</a>)) {</td></tr>
<tr><th id="4913">4913</th><td>			<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 4913, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col2 ref" href="#1182z" title='z' data-ref="1182z" data-ref-filename="1182z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="4914">4914</th><td>			<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr from %s: could not store IXFR"</q></td></tr>
<tr><th id="4915">4915</th><td>				<q>" data"</q>, <a class="local col9 ref" href="#1179xfr" title='xfr' data-ref="1179xfr" data-ref-filename="1179xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="4916">4916</th><td>			*<a class="local col1 ref" href="#1181ixfr_fail" title='ixfr_fail' data-ref="1181ixfr_fail" data-ref-filename="1181ixfr_fail">ixfr_fail</a> = <var>1</var>;</td></tr>
<tr><th id="4917">4917</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4918">4918</th><td>		}</td></tr>
<tr><th id="4919">4919</th><td>	} <b>else</b> {</td></tr>
<tr><th id="4920">4920</th><td>		<b>if</b>(!<a class="tu ref fn" href="#apply_axfr" title='apply_axfr' data-use='c' data-ref="apply_axfr" data-ref-filename="apply_axfr">apply_axfr</a>(<a class="local col9 ref" href="#1179xfr" title='xfr' data-ref="1179xfr" data-ref-filename="1179xfr">xfr</a>, <a class="local col2 ref" href="#1182z" title='z' data-ref="1182z" data-ref-filename="1182z">z</a>, <a class="local col0 ref" href="#1180env" title='env' data-ref="1180env" data-ref-filename="1180env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::scratch_buffer" title='module_env::scratch_buffer' data-ref="module_env::scratch_buffer" data-ref-filename="module_env..scratch_buffer">scratch_buffer</a>)) {</td></tr>
<tr><th id="4921">4921</th><td>			<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 4921, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col2 ref" href="#1182z" title='z' data-ref="1182z" data-ref-filename="1182z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="4922">4922</th><td>			<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr from %s: could not store AXFR"</q></td></tr>
<tr><th id="4923">4923</th><td>				<q>" data"</q>, <a class="local col9 ref" href="#1179xfr" title='xfr' data-ref="1179xfr" data-ref-filename="1179xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="4924">4924</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4925">4925</th><td>		}</td></tr>
<tr><th id="4926">4926</th><td>	}</td></tr>
<tr><th id="4927">4927</th><td>	<a class="local col9 ref" href="#1179xfr" title='xfr' data-ref="1179xfr" data-ref-filename="1179xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::zone_expired" title='auth_xfer::zone_expired' data-ref="auth_xfer::zone_expired" data-ref-filename="auth_xfer..zone_expired">zone_expired</a> = <var>0</var>;</td></tr>
<tr><th id="4928">4928</th><td>	<a class="local col2 ref" href="#1182z" title='z' data-ref="1182z" data-ref-filename="1182z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::zone_expired" title='auth_zone::zone_expired' data-ref="auth_zone::zone_expired" data-ref-filename="auth_zone..zone_expired">zone_expired</a> = <var>0</var>;</td></tr>
<tr><th id="4929">4929</th><td>	<b>if</b>(!<a class="tu ref fn" href="#xfr_find_soa" title='xfr_find_soa' data-use='c' data-ref="xfr_find_soa" data-ref-filename="xfr_find_soa">xfr_find_soa</a>(<a class="local col2 ref" href="#1182z" title='z' data-ref="1182z" data-ref-filename="1182z">z</a>, <a class="local col9 ref" href="#1179xfr" title='xfr' data-ref="1179xfr" data-ref-filename="1179xfr">xfr</a>)) {</td></tr>
<tr><th id="4930">4930</th><td>		<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 4930, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col2 ref" href="#1182z" title='z' data-ref="1182z" data-ref-filename="1182z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="4931">4931</th><td>		<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr from %s: no SOA in zone after update"</q></td></tr>
<tr><th id="4932">4932</th><td>			<q>" (or malformed RR)"</q>, <a class="local col9 ref" href="#1179xfr" title='xfr' data-ref="1179xfr" data-ref-filename="1179xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="4933">4933</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4934">4934</th><td>	}</td></tr>
<tr><th id="4935">4935</th><td>	<b>if</b>(<a class="local col9 ref" href="#1179xfr" title='xfr' data-ref="1179xfr" data-ref-filename="1179xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::have_zone" title='auth_xfer::have_zone' data-ref="auth_xfer::have_zone" data-ref-filename="auth_xfer..have_zone">have_zone</a>)</td></tr>
<tr><th id="4936">4936</th><td>		<a class="local col9 ref" href="#1179xfr" title='xfr' data-ref="1179xfr" data-ref-filename="1179xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lease_time" title='auth_xfer::lease_time' data-ref="auth_xfer::lease_time" data-ref-filename="auth_xfer..lease_time">lease_time</a> = *<a class="local col0 ref" href="#1180env" title='env' data-ref="1180env" data-ref-filename="1180env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::now" title='module_env::now' data-ref="module_env::now" data-ref-filename="module_env..now">now</a>;</td></tr>
<tr><th id="4937">4937</th><td></td></tr>
<tr><th id="4938">4938</th><td>	<i>/* unlock */</i></td></tr>
<tr><th id="4939">4939</th><td>	<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;z-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;z-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 4939, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col2 ref" href="#1182z" title='z' data-ref="1182z" data-ref-filename="1182z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::lock" title='auth_zone::lock' data-ref="auth_zone::lock" data-ref-filename="auth_zone..lock">lock</a>);</td></tr>
<tr><th id="4940">4940</th><td></td></tr>
<tr><th id="4941">4941</th><td>	<b>if</b>(<a class="ref" href="../util/log.h.html#verbosity" title='verbosity' data-ref="verbosity" data-ref-filename="verbosity">verbosity</a> &gt;= <a class="enum" href="../util/log.h.html#VERB_QUERY" title='VERB_QUERY' data-ref="VERB_QUERY" data-ref-filename="VERB_QUERY">VERB_QUERY</a> &amp;&amp; <a class="local col9 ref" href="#1179xfr" title='xfr' data-ref="1179xfr" data-ref-filename="1179xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::have_zone" title='auth_xfer::have_zone' data-ref="auth_xfer::have_zone" data-ref-filename="auth_xfer..have_zone">have_zone</a>) {</td></tr>
<tr><th id="4942">4942</th><td>		<em>char</em> <dfn class="local col3 decl" id="1183zname" title='zname' data-type='char [256]' data-ref="1183zname" data-ref-filename="1183zname">zname</dfn>[<var>256</var>];</td></tr>
<tr><th id="4943">4943</th><td>		<a class="ref fn" href="../util/data/dname.h.html#dname_str" title='dname_str' data-ref="dname_str" data-ref-filename="dname_str">dname_str</a>(<a class="local col9 ref" href="#1179xfr" title='xfr' data-ref="1179xfr" data-ref-filename="1179xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a>, <a class="local col3 ref" href="#1183zname" title='zname' data-ref="1183zname" data-ref-filename="1183zname">zname</a>);</td></tr>
<tr><th id="4944">4944</th><td>		<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_QUERY" title='VERB_QUERY' data-ref="VERB_QUERY" data-ref-filename="VERB_QUERY">VERB_QUERY</a>, <q>"auth zone %s updated to serial %u"</q>, <a class="local col3 ref" href="#1183zname" title='zname' data-ref="1183zname" data-ref-filename="1183zname">zname</a>,</td></tr>
<tr><th id="4945">4945</th><td>			(<em>unsigned</em>)<a class="local col9 ref" href="#1179xfr" title='xfr' data-ref="1179xfr" data-ref-filename="1179xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::serial" title='auth_xfer::serial' data-ref="auth_xfer::serial" data-ref-filename="auth_xfer..serial">serial</a>);</td></tr>
<tr><th id="4946">4946</th><td>	}</td></tr>
<tr><th id="4947">4947</th><td>	<i>/* see if we need to write to a zonefile */</i></td></tr>
<tr><th id="4948">4948</th><td>	<a class="tu ref fn" href="#xfr_write_after_update" title='xfr_write_after_update' data-use='c' data-ref="xfr_write_after_update" data-ref-filename="xfr_write_after_update">xfr_write_after_update</a>(<a class="local col9 ref" href="#1179xfr" title='xfr' data-ref="1179xfr" data-ref-filename="1179xfr">xfr</a>, <a class="local col0 ref" href="#1180env" title='env' data-ref="1180env" data-ref-filename="1180env">env</a>);</td></tr>
<tr><th id="4949">4949</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="4950">4950</th><td>}</td></tr>
<tr><th id="4951">4951</th><td></td></tr>
<tr><th id="4952">4952</th><td><i class="doc" data-doc="xfr_transfer_disown">/** disown task_transfer.  caller must hold xfr.lock */</i></td></tr>
<tr><th id="4953">4953</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="4954">4954</th><td><dfn class="tu decl def fn" id="xfr_transfer_disown" title='xfr_transfer_disown' data-type='void xfr_transfer_disown(struct auth_xfer * xfr)' data-ref="xfr_transfer_disown" data-ref-filename="xfr_transfer_disown">xfr_transfer_disown</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col4 decl" id="1184xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1184xfr" data-ref-filename="1184xfr">xfr</dfn>)</td></tr>
<tr><th id="4955">4955</th><td>{</td></tr>
<tr><th id="4956">4956</th><td>	<i>/* remove the commpoint */</i></td></tr>
<tr><th id="4957">4957</th><td>	<a class="ref fn" href="../util/netevent.h.html#comm_point_delete" title='comm_point_delete' data-ref="comm_point_delete" data-ref-filename="comm_point_delete">comm_point_delete</a>(<a class="local col4 ref" href="#1184xfr" title='xfr' data-ref="1184xfr" data-ref-filename="1184xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::cp" title='auth_transfer::cp' data-ref="auth_transfer::cp" data-ref-filename="auth_transfer..cp">cp</a>);</td></tr>
<tr><th id="4958">4958</th><td>	<a class="local col4 ref" href="#1184xfr" title='xfr' data-ref="1184xfr" data-ref-filename="1184xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::cp" title='auth_transfer::cp' data-ref="auth_transfer::cp" data-ref-filename="auth_transfer..cp">cp</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="4959">4959</th><td>	<i>/* we don't own this item anymore */</i></td></tr>
<tr><th id="4960">4960</th><td>	<a class="local col4 ref" href="#1184xfr" title='xfr' data-ref="1184xfr" data-ref-filename="1184xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::worker" title='auth_transfer::worker' data-ref="auth_transfer::worker" data-ref-filename="auth_transfer..worker">worker</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="4961">4961</th><td>	<a class="local col4 ref" href="#1184xfr" title='xfr' data-ref="1184xfr" data-ref-filename="1184xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::env" title='auth_transfer::env' data-ref="auth_transfer::env" data-ref-filename="auth_transfer..env">env</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="4962">4962</th><td>}</td></tr>
<tr><th id="4963">4963</th><td></td></tr>
<tr><th id="4964">4964</th><td><i class="doc" data-doc="xfr_transfer_lookup_host">/** lookup a host name for its addresses, if needed */</i></td></tr>
<tr><th id="4965">4965</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="4966">4966</th><td><dfn class="tu decl def fn" id="xfr_transfer_lookup_host" title='xfr_transfer_lookup_host' data-type='int xfr_transfer_lookup_host(struct auth_xfer * xfr, struct module_env * env)' data-ref="xfr_transfer_lookup_host" data-ref-filename="xfr_transfer_lookup_host">xfr_transfer_lookup_host</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col5 decl" id="1185xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1185xfr" data-ref-filename="1185xfr">xfr</dfn>, <b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col6 decl" id="1186env" title='env' data-type='struct module_env *' data-ref="1186env" data-ref-filename="1186env">env</dfn>)</td></tr>
<tr><th id="4967">4967</th><td>{</td></tr>
<tr><th id="4968">4968</th><td>	<b>struct</b> <a class="type" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#sockaddr_storage" title='sockaddr_storage' data-ref="sockaddr_storage" data-ref-filename="sockaddr_storage">sockaddr_storage</a> <dfn class="local col7 decl" id="1187addr" title='addr' data-type='struct sockaddr_storage' data-ref="1187addr" data-ref-filename="1187addr">addr</dfn>;</td></tr>
<tr><th id="4969">4969</th><td>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#84" title="__socklen_t" data-ref="_M/socklen_t">socklen_t</a> <dfn class="local col8 decl" id="1188addrlen" title='addrlen' data-type='__socklen_t' data-ref="1188addrlen" data-ref-filename="1188addrlen">addrlen</dfn> = <var>0</var>;</td></tr>
<tr><th id="4970">4970</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>* <dfn class="local col9 decl" id="1189master" title='master' data-type='struct auth_master *' data-ref="1189master" data-ref-filename="1189master">master</dfn> = <a class="local col5 ref" href="#1185xfr" title='xfr' data-ref="1185xfr" data-ref-filename="1185xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::lookup_target" title='auth_transfer::lookup_target' data-ref="auth_transfer::lookup_target" data-ref-filename="auth_transfer..lookup_target">lookup_target</a>;</td></tr>
<tr><th id="4971">4971</th><td>	<b>struct</b> <a class="type" href="../util/data/msgreply.h.html#query_info" title='query_info' data-ref="query_info" data-ref-filename="query_info">query_info</a> <dfn class="local col0 decl" id="1190qinfo" title='qinfo' data-type='struct query_info' data-ref="1190qinfo" data-ref-filename="1190qinfo">qinfo</dfn>;</td></tr>
<tr><th id="4972">4972</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col1 decl" id="1191qflags" title='qflags' data-type='uint16_t' data-ref="1191qflags" data-ref-filename="1191qflags">qflags</dfn> = <a class="macro" href="../util/net_help.h.html#65" title="0x0100" data-ref="_M/BIT_RD">BIT_RD</a>;</td></tr>
<tr><th id="4973">4973</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a> <dfn class="local col2 decl" id="1192dname" title='dname' data-type='uint8_t [256]' data-ref="1192dname" data-ref-filename="1192dname">dname</dfn>[<a class="macro" href="../sldns/rrdef.h.html#29" title="255" data-ref="_M/LDNS_MAX_DOMAINLEN">LDNS_MAX_DOMAINLEN</a>+<var>1</var>];</td></tr>
<tr><th id="4974">4974</th><td>	<b>struct</b> <a class="type" href="../util/data/msgparse.h.html#edns_data" title='edns_data' data-ref="edns_data" data-ref-filename="edns_data">edns_data</a> <dfn class="local col3 decl" id="1193edns" title='edns' data-type='struct edns_data' data-ref="1193edns" data-ref-filename="1193edns">edns</dfn>;</td></tr>
<tr><th id="4975">4975</th><td>	<a class="typedef" href="../sldns/sbuffer.h.html#sldns_buffer" title='sldns_buffer' data-type='struct sldns_buffer' data-ref="sldns_buffer" data-ref-filename="sldns_buffer">sldns_buffer</a>* <dfn class="local col4 decl" id="1194buf" title='buf' data-type='sldns_buffer *' data-ref="1194buf" data-ref-filename="1194buf">buf</dfn> = <a class="local col6 ref" href="#1186env" title='env' data-ref="1186env" data-ref-filename="1186env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::scratch_buffer" title='module_env::scratch_buffer' data-ref="module_env::scratch_buffer" data-ref-filename="module_env..scratch_buffer">scratch_buffer</a>;</td></tr>
<tr><th id="4976">4976</th><td>	<b>if</b>(!<a class="local col9 ref" href="#1189master" title='master' data-ref="1189master" data-ref-filename="1189master">master</a>) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="4977">4977</th><td>	<b>if</b>(<a class="ref fn" href="../util/net_help.h.html#extstrtoaddr" title='extstrtoaddr' data-ref="extstrtoaddr" data-ref-filename="extstrtoaddr">extstrtoaddr</a>(<a class="local col9 ref" href="#1189master" title='master' data-ref="1189master" data-ref-filename="1189master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>, &amp;<a class="local col7 ref" href="#1187addr" title='addr' data-ref="1187addr" data-ref-filename="1187addr">addr</a>, &amp;<a class="local col8 ref" href="#1188addrlen" title='addrlen' data-ref="1188addrlen" data-ref-filename="1188addrlen">addrlen</a>)) {</td></tr>
<tr><th id="4978">4978</th><td>		<i>/* not needed, host is in IP addr format */</i></td></tr>
<tr><th id="4979">4979</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4980">4980</th><td>	}</td></tr>
<tr><th id="4981">4981</th><td>	<b>if</b>(<a class="local col9 ref" href="#1189master" title='master' data-ref="1189master" data-ref-filename="1189master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::allow_notify" title='auth_master::allow_notify' data-ref="auth_master::allow_notify" data-ref-filename="auth_master..allow_notify">allow_notify</a>)</td></tr>
<tr><th id="4982">4982</th><td>		<b>return</b> <var>0</var>; <i>/* allow-notifies are not transferred from, no</i></td></tr>
<tr><th id="4983">4983</th><td><i>		lookup is needed */</i></td></tr>
<tr><th id="4984">4984</th><td></td></tr>
<tr><th id="4985">4985</th><td>	<i>/* use mesh_new_callback to probe for non-addr hosts,</i></td></tr>
<tr><th id="4986">4986</th><td><i>	 * and then wait for them to be looked up (in cache, or query) */</i></td></tr>
<tr><th id="4987">4987</th><td>	<a class="local col0 ref" href="#1190qinfo" title='qinfo' data-ref="1190qinfo" data-ref-filename="1190qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname_len" title='query_info::qname_len' data-ref="query_info::qname_len" data-ref-filename="query_info..qname_len">qname_len</a> = <b>sizeof</b>(<a class="local col2 ref" href="#1192dname" title='dname' data-ref="1192dname" data-ref-filename="1192dname">dname</a>);</td></tr>
<tr><th id="4988">4988</th><td>	<b>if</b>(<a class="ref fn" href="../sldns/str2wire.h.html#sldns_str2wire_dname_buf" title='sldns_str2wire_dname_buf' data-ref="sldns_str2wire_dname_buf" data-ref-filename="sldns_str2wire_dname_buf">sldns_str2wire_dname_buf</a>(<a class="local col9 ref" href="#1189master" title='master' data-ref="1189master" data-ref-filename="1189master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>, <a class="local col2 ref" href="#1192dname" title='dname' data-ref="1192dname" data-ref-filename="1192dname">dname</a>, &amp;<a class="local col0 ref" href="#1190qinfo" title='qinfo' data-ref="1190qinfo" data-ref-filename="1190qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname_len" title='query_info::qname_len' data-ref="query_info::qname_len" data-ref-filename="query_info..qname_len">qname_len</a>)</td></tr>
<tr><th id="4989">4989</th><td>		!= <var>0</var>) {</td></tr>
<tr><th id="4990">4990</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"cannot parse host name of master %s"</q>, <a class="local col9 ref" href="#1189master" title='master' data-ref="1189master" data-ref-filename="1189master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="4991">4991</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="4992">4992</th><td>	}</td></tr>
<tr><th id="4993">4993</th><td>	<a class="local col0 ref" href="#1190qinfo" title='qinfo' data-ref="1190qinfo" data-ref-filename="1190qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname" title='query_info::qname' data-ref="query_info::qname" data-ref-filename="query_info..qname">qname</a> = <a class="local col2 ref" href="#1192dname" title='dname' data-ref="1192dname" data-ref-filename="1192dname">dname</a>;</td></tr>
<tr><th id="4994">4994</th><td>	<a class="local col0 ref" href="#1190qinfo" title='qinfo' data-ref="1190qinfo" data-ref-filename="1190qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qclass" title='query_info::qclass' data-ref="query_info::qclass" data-ref-filename="query_info..qclass">qclass</a> = <a class="local col5 ref" href="#1185xfr" title='xfr' data-ref="1185xfr" data-ref-filename="1185xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::dclass" title='auth_xfer::dclass' data-ref="auth_xfer::dclass" data-ref-filename="auth_xfer..dclass">dclass</a>;</td></tr>
<tr><th id="4995">4995</th><td>	<a class="local col0 ref" href="#1190qinfo" title='qinfo' data-ref="1190qinfo" data-ref-filename="1190qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qtype" title='query_info::qtype' data-ref="query_info::qtype" data-ref-filename="query_info..qtype">qtype</a> = <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_A" title='LDNS_RR_TYPE_A' data-ref="LDNS_RR_TYPE_A" data-ref-filename="LDNS_RR_TYPE_A">LDNS_RR_TYPE_A</a>;</td></tr>
<tr><th id="4996">4996</th><td>	<b>if</b>(<a class="local col5 ref" href="#1185xfr" title='xfr' data-ref="1185xfr" data-ref-filename="1185xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::lookup_aaaa" title='auth_transfer::lookup_aaaa' data-ref="auth_transfer::lookup_aaaa" data-ref-filename="auth_transfer..lookup_aaaa">lookup_aaaa</a>)</td></tr>
<tr><th id="4997">4997</th><td>		<a class="local col0 ref" href="#1190qinfo" title='qinfo' data-ref="1190qinfo" data-ref-filename="1190qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qtype" title='query_info::qtype' data-ref="query_info::qtype" data-ref-filename="query_info..qtype">qtype</a> = <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_AAAA" title='LDNS_RR_TYPE_AAAA' data-ref="LDNS_RR_TYPE_AAAA" data-ref-filename="LDNS_RR_TYPE_AAAA">LDNS_RR_TYPE_AAAA</a>;</td></tr>
<tr><th id="4998">4998</th><td>	<a class="local col0 ref" href="#1190qinfo" title='qinfo' data-ref="1190qinfo" data-ref-filename="1190qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::local_alias" title='query_info::local_alias' data-ref="query_info::local_alias" data-ref-filename="query_info..local_alias">local_alias</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="4999">4999</th><td>	<b>if</b>(<a class="ref" href="../util/log.h.html#verbosity" title='verbosity' data-ref="verbosity" data-ref-filename="verbosity">verbosity</a> &gt;= <a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>) {</td></tr>
<tr><th id="5000">5000</th><td>		<em>char</em> <dfn class="local col5 decl" id="1195buf1" title='buf1' data-type='char [512]' data-ref="1195buf1" data-ref-filename="1195buf1">buf1</dfn>[<var>512</var>];</td></tr>
<tr><th id="5001">5001</th><td>		<em>char</em> <dfn class="local col6 decl" id="1196buf2" title='buf2' data-type='char [256]' data-ref="1196buf2" data-ref-filename="1196buf2">buf2</dfn>[<a class="macro" href="../sldns/rrdef.h.html#29" title="255" data-ref="_M/LDNS_MAX_DOMAINLEN">LDNS_MAX_DOMAINLEN</a>+<var>1</var>];</td></tr>
<tr><th id="5002">5002</th><td>		<a class="ref fn" href="../util/data/dname.h.html#dname_str" title='dname_str' data-ref="dname_str" data-ref-filename="dname_str">dname_str</a>(<a class="local col5 ref" href="#1185xfr" title='xfr' data-ref="1185xfr" data-ref-filename="1185xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a>, <a class="local col6 ref" href="#1196buf2" title='buf2' data-ref="1196buf2" data-ref-filename="1196buf2">buf2</a>);</td></tr>
<tr><th id="5003">5003</th><td>		<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/stdio.h.html#61" title="__builtin___snprintf_chk(buf1, sizeof(buf1), 0, __builtin_object_size(buf1, 2 &gt; 1), &quot;auth zone %s: master lookup&quot; &quot; for task_transfer&quot;, buf2)" data-ref="_M/snprintf">snprintf</a>(<a class="local col5 ref" href="#1195buf1" title='buf1' data-ref="1195buf1" data-ref-filename="1195buf1">buf1</a>, <b>sizeof</b>(<a class="local col5 ref" href="#1195buf1" title='buf1' data-ref="1195buf1" data-ref-filename="1195buf1">buf1</a>), <q>"auth zone %s: master lookup"</q></td></tr>
<tr><th id="5004">5004</th><td>			<q>" for task_transfer"</q>, <a class="local col6 ref" href="#1196buf2" title='buf2' data-ref="1196buf2" data-ref-filename="1196buf2">buf2</a>);</td></tr>
<tr><th id="5005">5005</th><td>		<a class="ref fn" href="../util/data/msgreply.h.html#log_query_info" title='log_query_info' data-ref="log_query_info" data-ref-filename="log_query_info">log_query_info</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <a class="local col5 ref" href="#1195buf1" title='buf1' data-ref="1195buf1" data-ref-filename="1195buf1">buf1</a>, &amp;<a class="local col0 ref" href="#1190qinfo" title='qinfo' data-ref="1190qinfo" data-ref-filename="1190qinfo">qinfo</a>);</td></tr>
<tr><th id="5006">5006</th><td>	}</td></tr>
<tr><th id="5007">5007</th><td>	<a class="local col3 ref" href="#1193edns" title='edns' data-ref="1193edns" data-ref-filename="1193edns">edns</a>.<a class="ref field" href="../util/data/msgparse.h.html#edns_data::edns_present" title='edns_data::edns_present' data-ref="edns_data::edns_present" data-ref-filename="edns_data..edns_present">edns_present</a> = <var>1</var>;</td></tr>
<tr><th id="5008">5008</th><td>	<a class="local col3 ref" href="#1193edns" title='edns' data-ref="1193edns" data-ref-filename="1193edns">edns</a>.<a class="ref field" href="../util/data/msgparse.h.html#edns_data::ext_rcode" title='edns_data::ext_rcode' data-ref="edns_data::ext_rcode" data-ref-filename="edns_data..ext_rcode">ext_rcode</a> = <var>0</var>;</td></tr>
<tr><th id="5009">5009</th><td>	<a class="local col3 ref" href="#1193edns" title='edns' data-ref="1193edns" data-ref-filename="1193edns">edns</a>.<a class="ref field" href="../util/data/msgparse.h.html#edns_data::edns_version" title='edns_data::edns_version' data-ref="edns_data::edns_version" data-ref-filename="edns_data..edns_version">edns_version</a> = <var>0</var>;</td></tr>
<tr><th id="5010">5010</th><td>	<a class="local col3 ref" href="#1193edns" title='edns' data-ref="1193edns" data-ref-filename="1193edns">edns</a>.<a class="ref field" href="../util/data/msgparse.h.html#edns_data::bits" title='edns_data::bits' data-ref="edns_data::bits" data-ref-filename="edns_data..bits">bits</a> = <a class="macro" href="../util/net_help.h.html#86" title="0x8000" data-ref="_M/EDNS_DO">EDNS_DO</a>;</td></tr>
<tr><th id="5011">5011</th><td>	<a class="local col3 ref" href="#1193edns" title='edns' data-ref="1193edns" data-ref-filename="1193edns">edns</a>.<a class="ref field" href="../util/data/msgparse.h.html#edns_data::opt_list" title='edns_data::opt_list' data-ref="edns_data::opt_list" data-ref-filename="edns_data..opt_list">opt_list</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="5012">5012</th><td>	<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_capacity" title='sldns_buffer_capacity' data-ref="sldns_buffer_capacity" data-ref-filename="sldns_buffer_capacity">sldns_buffer_capacity</a>(<a class="local col4 ref" href="#1194buf" title='buf' data-ref="1194buf" data-ref-filename="1194buf">buf</a>) &lt; <var>65535</var>)</td></tr>
<tr><th id="5013">5013</th><td>		<a class="local col3 ref" href="#1193edns" title='edns' data-ref="1193edns" data-ref-filename="1193edns">edns</a>.<a class="ref field" href="../util/data/msgparse.h.html#edns_data::udp_size" title='edns_data::udp_size' data-ref="edns_data::udp_size" data-ref-filename="edns_data..udp_size">udp_size</a> = (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a>)<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_capacity" title='sldns_buffer_capacity' data-ref="sldns_buffer_capacity" data-ref-filename="sldns_buffer_capacity">sldns_buffer_capacity</a>(<a class="local col4 ref" href="#1194buf" title='buf' data-ref="1194buf" data-ref-filename="1194buf">buf</a>);</td></tr>
<tr><th id="5014">5014</th><td>	<b>else</b>	<a class="local col3 ref" href="#1193edns" title='edns' data-ref="1193edns" data-ref-filename="1193edns">edns</a>.<a class="ref field" href="../util/data/msgparse.h.html#edns_data::udp_size" title='edns_data::udp_size' data-ref="edns_data::udp_size" data-ref-filename="edns_data..udp_size">udp_size</a> = <var>65535</var>;</td></tr>
<tr><th id="5015">5015</th><td></td></tr>
<tr><th id="5016">5016</th><td>	<i>/* unlock xfr during mesh_new_callback() because the callback can be</i></td></tr>
<tr><th id="5017">5017</th><td><i>	 * called straight away */</i></td></tr>
<tr><th id="5018">5018</th><td>	<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 5018, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col5 ref" href="#1185xfr" title='xfr' data-ref="1185xfr" data-ref-filename="1185xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="5019">5019</th><td>	<b>if</b>(!<a class="ref fn" href="mesh.h.html#mesh_new_callback" title='mesh_new_callback' data-ref="mesh_new_callback" data-ref-filename="mesh_new_callback">mesh_new_callback</a>(<a class="local col6 ref" href="#1186env" title='env' data-ref="1186env" data-ref-filename="1186env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::mesh" title='module_env::mesh' data-ref="module_env::mesh" data-ref-filename="module_env..mesh">mesh</a>, &amp;<a class="local col0 ref" href="#1190qinfo" title='qinfo' data-ref="1190qinfo" data-ref-filename="1190qinfo">qinfo</a>, <a class="local col1 ref" href="#1191qflags" title='qflags' data-ref="1191qflags" data-ref-filename="1191qflags">qflags</a>, &amp;<a class="local col3 ref" href="#1193edns" title='edns' data-ref="1193edns" data-ref-filename="1193edns">edns</a>, <a class="local col4 ref" href="#1194buf" title='buf' data-ref="1194buf" data-ref-filename="1194buf">buf</a>, <var>0</var>,</td></tr>
<tr><th id="5020">5020</th><td>		&amp;<a class="ref fn" href="#auth_xfer_transfer_lookup_callback" title='auth_xfer_transfer_lookup_callback' data-ref="auth_xfer_transfer_lookup_callback" data-ref-filename="auth_xfer_transfer_lookup_callback">auth_xfer_transfer_lookup_callback</a>, <a class="local col5 ref" href="#1185xfr" title='xfr' data-ref="1185xfr" data-ref-filename="1185xfr">xfr</a>)) {</td></tr>
<tr><th id="5021">5021</th><td>		<a class="macro" href="../util/locks.h.html#102" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_lock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_lock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 5021, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_lock">lock_basic_lock</a>(&amp;<a class="local col5 ref" href="#1185xfr" title='xfr' data-ref="1185xfr" data-ref-filename="1185xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="5022">5022</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"out of memory lookup up master %s"</q>, <a class="local col9 ref" href="#1189master" title='master' data-ref="1189master" data-ref-filename="1189master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5023">5023</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5024">5024</th><td>	}</td></tr>
<tr><th id="5025">5025</th><td>	<a class="macro" href="../util/locks.h.html#102" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_lock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_lock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 5025, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_lock">lock_basic_lock</a>(&amp;<a class="local col5 ref" href="#1185xfr" title='xfr' data-ref="1185xfr" data-ref-filename="1185xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="5026">5026</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="5027">5027</th><td>}</td></tr>
<tr><th id="5028">5028</th><td></td></tr>
<tr><th id="5029">5029</th><td><i class="doc" data-doc="xfr_transfer_init_fetch">/** initiate TCP to the target and fetch zone.</i></td></tr>
<tr><th id="5030">5030</th><td><i class="doc" data-doc="xfr_transfer_init_fetch"> * returns true if that was successfully started, and timeout setup. */</i></td></tr>
<tr><th id="5031">5031</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="5032">5032</th><td><dfn class="tu decl def fn" id="xfr_transfer_init_fetch" title='xfr_transfer_init_fetch' data-type='int xfr_transfer_init_fetch(struct auth_xfer * xfr, struct module_env * env)' data-ref="xfr_transfer_init_fetch" data-ref-filename="xfr_transfer_init_fetch">xfr_transfer_init_fetch</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col7 decl" id="1197xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1197xfr" data-ref-filename="1197xfr">xfr</dfn>, <b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col8 decl" id="1198env" title='env' data-type='struct module_env *' data-ref="1198env" data-ref-filename="1198env">env</dfn>)</td></tr>
<tr><th id="5033">5033</th><td>{</td></tr>
<tr><th id="5034">5034</th><td>	<b>struct</b> <a class="type" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#sockaddr_storage" title='sockaddr_storage' data-ref="sockaddr_storage" data-ref-filename="sockaddr_storage">sockaddr_storage</a> <dfn class="local col9 decl" id="1199addr" title='addr' data-type='struct sockaddr_storage' data-ref="1199addr" data-ref-filename="1199addr">addr</dfn>;</td></tr>
<tr><th id="5035">5035</th><td>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#84" title="__socklen_t" data-ref="_M/socklen_t">socklen_t</a> <dfn class="local col0 decl" id="1200addrlen" title='addrlen' data-type='__socklen_t' data-ref="1200addrlen" data-ref-filename="1200addrlen">addrlen</dfn> = <var>0</var>;</td></tr>
<tr><th id="5036">5036</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>* <dfn class="local col1 decl" id="1201master" title='master' data-type='struct auth_master *' data-ref="1201master" data-ref-filename="1201master">master</dfn> = <a class="local col7 ref" href="#1197xfr" title='xfr' data-ref="1197xfr" data-ref-filename="1197xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>;</td></tr>
<tr><th id="5037">5037</th><td>	<b>if</b>(!<a class="local col1 ref" href="#1201master" title='master' data-ref="1201master" data-ref-filename="1201master">master</a>) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="5038">5038</th><td>	<b>if</b>(<a class="local col1 ref" href="#1201master" title='master' data-ref="1201master" data-ref-filename="1201master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::allow_notify" title='auth_master::allow_notify' data-ref="auth_master::allow_notify" data-ref-filename="auth_master..allow_notify">allow_notify</a>) <b>return</b> <var>0</var>; <i>/* only for notify */</i></td></tr>
<tr><th id="5039">5039</th><td></td></tr>
<tr><th id="5040">5040</th><td>	<i>/* get master addr */</i></td></tr>
<tr><th id="5041">5041</th><td>	<b>if</b>(<a class="local col7 ref" href="#1197xfr" title='xfr' data-ref="1197xfr" data-ref-filename="1197xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_addr" title='auth_transfer::scan_addr' data-ref="auth_transfer::scan_addr" data-ref-filename="auth_transfer..scan_addr">scan_addr</a>) {</td></tr>
<tr><th id="5042">5042</th><td>		<a class="local col0 ref" href="#1200addrlen" title='addrlen' data-ref="1200addrlen" data-ref-filename="1200addrlen">addrlen</a> = <a class="local col7 ref" href="#1197xfr" title='xfr' data-ref="1197xfr" data-ref-filename="1197xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_addr" title='auth_transfer::scan_addr' data-ref="auth_transfer::scan_addr" data-ref-filename="auth_transfer..scan_addr">scan_addr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_addr::addrlen" title='auth_addr::addrlen' data-ref="auth_addr::addrlen" data-ref-filename="auth_addr..addrlen">addrlen</a>;</td></tr>
<tr><th id="5043">5043</th><td>		<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(&amp;addr, 0) != (size_t)-1) ? __builtin___memmove_chk(&amp;addr, &amp;xfr-&gt;task_transfer-&gt;scan_addr-&gt;addr, addrlen, __builtin_object_size(&amp;addr, 0)) : __memmove_ichk(&amp;addr, &amp;xfr-&gt;task_transfer-&gt;scan_addr-&gt;addr, addrlen))" data-ref="_M/memmove">memmove</a>(&amp;<a class="local col9 ref" href="#1199addr" title='addr' data-ref="1199addr" data-ref-filename="1199addr">addr</a>, &amp;<a class="local col7 ref" href="#1197xfr" title='xfr' data-ref="1197xfr" data-ref-filename="1197xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_addr" title='auth_transfer::scan_addr' data-ref="auth_transfer::scan_addr" data-ref-filename="auth_transfer..scan_addr">scan_addr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_addr::addr" title='auth_addr::addr' data-ref="auth_addr::addr" data-ref-filename="auth_addr..addr">addr</a>, <a class="local col0 ref" href="#1200addrlen" title='addrlen' data-ref="1200addrlen" data-ref-filename="1200addrlen">addrlen</a>);</td></tr>
<tr><th id="5044">5044</th><td>	} <b>else</b> {</td></tr>
<tr><th id="5045">5045</th><td>		<b>if</b>(!<a class="ref fn" href="../util/net_help.h.html#extstrtoaddr" title='extstrtoaddr' data-ref="extstrtoaddr" data-ref-filename="extstrtoaddr">extstrtoaddr</a>(<a class="local col1 ref" href="#1201master" title='master' data-ref="1201master" data-ref-filename="1201master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>, &amp;<a class="local col9 ref" href="#1199addr" title='addr' data-ref="1199addr" data-ref-filename="1199addr">addr</a>, &amp;<a class="local col0 ref" href="#1200addrlen" title='addrlen' data-ref="1200addrlen" data-ref-filename="1200addrlen">addrlen</a>)) {</td></tr>
<tr><th id="5046">5046</th><td>			<i>/* the ones that are not in addr format are supposed</i></td></tr>
<tr><th id="5047">5047</th><td><i>			 * to be looked up.  The lookup has failed however,</i></td></tr>
<tr><th id="5048">5048</th><td><i>			 * so skip them */</i></td></tr>
<tr><th id="5049">5049</th><td>			<em>char</em> <dfn class="local col2 decl" id="1202zname" title='zname' data-type='char [256]' data-ref="1202zname" data-ref-filename="1202zname">zname</dfn>[<var>255</var>+<var>1</var>];</td></tr>
<tr><th id="5050">5050</th><td>			<a class="ref fn" href="../util/data/dname.h.html#dname_str" title='dname_str' data-ref="dname_str" data-ref-filename="dname_str">dname_str</a>(<a class="local col7 ref" href="#1197xfr" title='xfr' data-ref="1197xfr" data-ref-filename="1197xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a>, <a class="local col2 ref" href="#1202zname" title='zname' data-ref="1202zname" data-ref-filename="1202zname">zname</a>);</td></tr>
<tr><th id="5051">5051</th><td>			<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"%s: failed lookup, cannot transfer from master %s"</q>,</td></tr>
<tr><th id="5052">5052</th><td>				<a class="local col2 ref" href="#1202zname" title='zname' data-ref="1202zname" data-ref-filename="1202zname">zname</a>, <a class="local col1 ref" href="#1201master" title='master' data-ref="1201master" data-ref-filename="1201master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5053">5053</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5054">5054</th><td>		}</td></tr>
<tr><th id="5055">5055</th><td>	}</td></tr>
<tr><th id="5056">5056</th><td></td></tr>
<tr><th id="5057">5057</th><td>	<i>/* remove previous TCP connection (if any) */</i></td></tr>
<tr><th id="5058">5058</th><td>	<b>if</b>(<a class="local col7 ref" href="#1197xfr" title='xfr' data-ref="1197xfr" data-ref-filename="1197xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::cp" title='auth_transfer::cp' data-ref="auth_transfer::cp" data-ref-filename="auth_transfer..cp">cp</a>) {</td></tr>
<tr><th id="5059">5059</th><td>		<a class="ref fn" href="../util/netevent.h.html#comm_point_delete" title='comm_point_delete' data-ref="comm_point_delete" data-ref-filename="comm_point_delete">comm_point_delete</a>(<a class="local col7 ref" href="#1197xfr" title='xfr' data-ref="1197xfr" data-ref-filename="1197xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::cp" title='auth_transfer::cp' data-ref="auth_transfer::cp" data-ref-filename="auth_transfer..cp">cp</a>);</td></tr>
<tr><th id="5060">5060</th><td>		<a class="local col7 ref" href="#1197xfr" title='xfr' data-ref="1197xfr" data-ref-filename="1197xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::cp" title='auth_transfer::cp' data-ref="auth_transfer::cp" data-ref-filename="auth_transfer..cp">cp</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="5061">5061</th><td>	}</td></tr>
<tr><th id="5062">5062</th><td></td></tr>
<tr><th id="5063">5063</th><td>	<b>if</b>(<a class="local col1 ref" href="#1201master" title='master' data-ref="1201master" data-ref-filename="1201master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::http" title='auth_master::http' data-ref="auth_master::http" data-ref-filename="auth_master..http">http</a>) {</td></tr>
<tr><th id="5064">5064</th><td>		<i>/* perform http fetch */</i></td></tr>
<tr><th id="5065">5065</th><td>		<i>/* store http port number into sockaddr,</i></td></tr>
<tr><th id="5066">5066</th><td><i>		 * unless someone used unbound's host@port notation */</i></td></tr>
<tr><th id="5067">5067</th><td>		<b>if</b>(<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strchr" title='strchr' data-ref="strchr" data-ref-filename="strchr">strchr</a>(<a class="local col1 ref" href="#1201master" title='master' data-ref="1201master" data-ref-filename="1201master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>, <kbd>'@'</kbd>) == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>)</td></tr>
<tr><th id="5068">5068</th><td>			<a class="ref fn" href="../util/net_help.h.html#sockaddr_store_port" title='sockaddr_store_port' data-ref="sockaddr_store_port" data-ref-filename="sockaddr_store_port">sockaddr_store_port</a>(&amp;<a class="local col9 ref" href="#1199addr" title='addr' data-ref="1199addr" data-ref-filename="1199addr">addr</a>, <a class="local col0 ref" href="#1200addrlen" title='addrlen' data-ref="1200addrlen" data-ref-filename="1200addrlen">addrlen</a>, <a class="local col1 ref" href="#1201master" title='master' data-ref="1201master" data-ref-filename="1201master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::port" title='auth_master::port' data-ref="auth_master::port" data-ref-filename="auth_master..port">port</a>);</td></tr>
<tr><th id="5069">5069</th><td>		<a class="local col7 ref" href="#1197xfr" title='xfr' data-ref="1197xfr" data-ref-filename="1197xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::cp" title='auth_transfer::cp' data-ref="auth_transfer::cp" data-ref-filename="auth_transfer..cp">cp</a> = <a class="ref fn" href="outside_network.h.html#outnet_comm_point_for_http" title='outnet_comm_point_for_http' data-ref="outnet_comm_point_for_http" data-ref-filename="outnet_comm_point_for_http">outnet_comm_point_for_http</a>(</td></tr>
<tr><th id="5070">5070</th><td>			<a class="local col8 ref" href="#1198env" title='env' data-ref="1198env" data-ref-filename="1198env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::outnet" title='module_env::outnet' data-ref="module_env::outnet" data-ref-filename="module_env..outnet">outnet</a>, <a class="ref fn" href="#auth_xfer_transfer_http_callback" title='auth_xfer_transfer_http_callback' data-ref="auth_xfer_transfer_http_callback" data-ref-filename="auth_xfer_transfer_http_callback">auth_xfer_transfer_http_callback</a>, <a class="local col7 ref" href="#1197xfr" title='xfr' data-ref="1197xfr" data-ref-filename="1197xfr">xfr</a>,</td></tr>
<tr><th id="5071">5071</th><td>			&amp;<a class="local col9 ref" href="#1199addr" title='addr' data-ref="1199addr" data-ref-filename="1199addr">addr</a>, <a class="local col0 ref" href="#1200addrlen" title='addrlen' data-ref="1200addrlen" data-ref-filename="1200addrlen">addrlen</a>, <a class="macro" href="#82" title="10000" data-ref="_M/AUTH_TRANSFER_TIMEOUT">AUTH_TRANSFER_TIMEOUT</a>, <a class="local col1 ref" href="#1201master" title='master' data-ref="1201master" data-ref-filename="1201master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::ssl" title='auth_master::ssl' data-ref="auth_master::ssl" data-ref-filename="auth_master..ssl">ssl</a>,</td></tr>
<tr><th id="5072">5072</th><td>			<a class="local col1 ref" href="#1201master" title='master' data-ref="1201master" data-ref-filename="1201master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>, <a class="local col1 ref" href="#1201master" title='master' data-ref="1201master" data-ref-filename="1201master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::file" title='auth_master::file' data-ref="auth_master::file" data-ref-filename="auth_master..file">file</a>);</td></tr>
<tr><th id="5073">5073</th><td>		<b>if</b>(!<a class="local col7 ref" href="#1197xfr" title='xfr' data-ref="1197xfr" data-ref-filename="1197xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::cp" title='auth_transfer::cp' data-ref="auth_transfer::cp" data-ref-filename="auth_transfer..cp">cp</a>) {</td></tr>
<tr><th id="5074">5074</th><td>			<em>char</em> <dfn class="local col3 decl" id="1203zname" title='zname' data-type='char [256]' data-ref="1203zname" data-ref-filename="1203zname">zname</dfn>[<var>255</var>+<var>1</var>];</td></tr>
<tr><th id="5075">5075</th><td>			<a class="ref fn" href="../util/data/dname.h.html#dname_str" title='dname_str' data-ref="dname_str" data-ref-filename="dname_str">dname_str</a>(<a class="local col7 ref" href="#1197xfr" title='xfr' data-ref="1197xfr" data-ref-filename="1197xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a>, <a class="local col3 ref" href="#1203zname" title='zname' data-ref="1203zname" data-ref-filename="1203zname">zname</a>);</td></tr>
<tr><th id="5076">5076</th><td>			<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"cannot create http cp "</q></td></tr>
<tr><th id="5077">5077</th><td>				<q>"connection for %s to %s"</q>, <a class="local col3 ref" href="#1203zname" title='zname' data-ref="1203zname" data-ref-filename="1203zname">zname</a>,</td></tr>
<tr><th id="5078">5078</th><td>				<a class="local col1 ref" href="#1201master" title='master' data-ref="1201master" data-ref-filename="1201master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5079">5079</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5080">5080</th><td>		}</td></tr>
<tr><th id="5081">5081</th><td>		<b>return</b> <var>1</var>;</td></tr>
<tr><th id="5082">5082</th><td>	}</td></tr>
<tr><th id="5083">5083</th><td></td></tr>
<tr><th id="5084">5084</th><td>	<i>/* perform AXFR/IXFR */</i></td></tr>
<tr><th id="5085">5085</th><td>	<i>/* set the packet to be written */</i></td></tr>
<tr><th id="5086">5086</th><td>	<i>/* create new ID */</i></td></tr>
<tr><th id="5087">5087</th><td>	<a class="local col7 ref" href="#1197xfr" title='xfr' data-ref="1197xfr" data-ref-filename="1197xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::id" title='auth_transfer::id' data-ref="auth_transfer::id" data-ref-filename="auth_transfer..id">id</a> = (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a>)(<a class="ref fn" href="../util/random.h.html#ub_random" title='ub_random' data-ref="ub_random" data-ref-filename="ub_random">ub_random</a>(<a class="local col8 ref" href="#1198env" title='env' data-ref="1198env" data-ref-filename="1198env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::rnd" title='module_env::rnd' data-ref="module_env::rnd" data-ref-filename="module_env..rnd">rnd</a>)&amp;<var>0xffff</var>);</td></tr>
<tr><th id="5088">5088</th><td>	<a class="tu ref fn" href="#xfr_create_ixfr_packet" title='xfr_create_ixfr_packet' data-use='c' data-ref="xfr_create_ixfr_packet" data-ref-filename="xfr_create_ixfr_packet">xfr_create_ixfr_packet</a>(<a class="local col7 ref" href="#1197xfr" title='xfr' data-ref="1197xfr" data-ref-filename="1197xfr">xfr</a>, <a class="local col8 ref" href="#1198env" title='env' data-ref="1198env" data-ref-filename="1198env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::scratch_buffer" title='module_env::scratch_buffer' data-ref="module_env::scratch_buffer" data-ref-filename="module_env..scratch_buffer">scratch_buffer</a>,</td></tr>
<tr><th id="5089">5089</th><td>		<a class="local col7 ref" href="#1197xfr" title='xfr' data-ref="1197xfr" data-ref-filename="1197xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::id" title='auth_transfer::id' data-ref="auth_transfer::id" data-ref-filename="auth_transfer..id">id</a>, <a class="local col1 ref" href="#1201master" title='master' data-ref="1201master" data-ref-filename="1201master">master</a>);</td></tr>
<tr><th id="5090">5090</th><td></td></tr>
<tr><th id="5091">5091</th><td>	<i>/* connect on fd */</i></td></tr>
<tr><th id="5092">5092</th><td>	<a class="local col7 ref" href="#1197xfr" title='xfr' data-ref="1197xfr" data-ref-filename="1197xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::cp" title='auth_transfer::cp' data-ref="auth_transfer::cp" data-ref-filename="auth_transfer..cp">cp</a> = <a class="ref fn" href="outside_network.h.html#outnet_comm_point_for_tcp" title='outnet_comm_point_for_tcp' data-ref="outnet_comm_point_for_tcp" data-ref-filename="outnet_comm_point_for_tcp">outnet_comm_point_for_tcp</a>(<a class="local col8 ref" href="#1198env" title='env' data-ref="1198env" data-ref-filename="1198env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::outnet" title='module_env::outnet' data-ref="module_env::outnet" data-ref-filename="module_env..outnet">outnet</a>,</td></tr>
<tr><th id="5093">5093</th><td>		<a class="ref fn" href="#auth_xfer_transfer_tcp_callback" title='auth_xfer_transfer_tcp_callback' data-ref="auth_xfer_transfer_tcp_callback" data-ref-filename="auth_xfer_transfer_tcp_callback">auth_xfer_transfer_tcp_callback</a>, <a class="local col7 ref" href="#1197xfr" title='xfr' data-ref="1197xfr" data-ref-filename="1197xfr">xfr</a>, &amp;<a class="local col9 ref" href="#1199addr" title='addr' data-ref="1199addr" data-ref-filename="1199addr">addr</a>, <a class="local col0 ref" href="#1200addrlen" title='addrlen' data-ref="1200addrlen" data-ref-filename="1200addrlen">addrlen</a>,</td></tr>
<tr><th id="5094">5094</th><td>		<a class="local col8 ref" href="#1198env" title='env' data-ref="1198env" data-ref-filename="1198env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::scratch_buffer" title='module_env::scratch_buffer' data-ref="module_env::scratch_buffer" data-ref-filename="module_env..scratch_buffer">scratch_buffer</a>, <a class="macro" href="#82" title="10000" data-ref="_M/AUTH_TRANSFER_TIMEOUT">AUTH_TRANSFER_TIMEOUT</a>);</td></tr>
<tr><th id="5095">5095</th><td>	<b>if</b>(!<a class="local col7 ref" href="#1197xfr" title='xfr' data-ref="1197xfr" data-ref-filename="1197xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::cp" title='auth_transfer::cp' data-ref="auth_transfer::cp" data-ref-filename="auth_transfer..cp">cp</a>) {</td></tr>
<tr><th id="5096">5096</th><td>		<em>char</em> <dfn class="local col4 decl" id="1204zname" title='zname' data-type='char [256]' data-ref="1204zname" data-ref-filename="1204zname">zname</dfn>[<var>255</var>+<var>1</var>];</td></tr>
<tr><th id="5097">5097</th><td>		<a class="ref fn" href="../util/data/dname.h.html#dname_str" title='dname_str' data-ref="dname_str" data-ref-filename="dname_str">dname_str</a>(<a class="local col7 ref" href="#1197xfr" title='xfr' data-ref="1197xfr" data-ref-filename="1197xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a>, <a class="local col4 ref" href="#1204zname" title='zname' data-ref="1204zname" data-ref-filename="1204zname">zname</a>);</td></tr>
<tr><th id="5098">5098</th><td>		<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"cannot create tcp cp connection for "</q></td></tr>
<tr><th id="5099">5099</th><td>			<q>"xfr %s to %s"</q>, <a class="local col4 ref" href="#1204zname" title='zname' data-ref="1204zname" data-ref-filename="1204zname">zname</a>, <a class="local col1 ref" href="#1201master" title='master' data-ref="1201master" data-ref-filename="1201master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5100">5100</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5101">5101</th><td>	}</td></tr>
<tr><th id="5102">5102</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="5103">5103</th><td>}</td></tr>
<tr><th id="5104">5104</th><td></td></tr>
<tr><th id="5105">5105</th><td><i class="doc" data-doc="xfr_transfer_nexttarget_or_end">/** perform next lookup, next transfer TCP, or end and resume wait time task */</i></td></tr>
<tr><th id="5106">5106</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="5107">5107</th><td><dfn class="tu decl def fn" id="xfr_transfer_nexttarget_or_end" title='xfr_transfer_nexttarget_or_end' data-type='void xfr_transfer_nexttarget_or_end(struct auth_xfer * xfr, struct module_env * env)' data-ref="xfr_transfer_nexttarget_or_end" data-ref-filename="xfr_transfer_nexttarget_or_end">xfr_transfer_nexttarget_or_end</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col5 decl" id="1205xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1205xfr" data-ref-filename="1205xfr">xfr</dfn>, <b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col6 decl" id="1206env" title='env' data-type='struct module_env *' data-ref="1206env" data-ref-filename="1206env">env</dfn>)</td></tr>
<tr><th id="5108">5108</th><td>{</td></tr>
<tr><th id="5109">5109</th><td>	<a class="macro" href="../util/log.h.html#211" title="" data-ref="_M/log_assert">log_assert</a>(xfr-&gt;task_transfer-&gt;worker == env-&gt;worker);</td></tr>
<tr><th id="5110">5110</th><td></td></tr>
<tr><th id="5111">5111</th><td>	<i>/* are we performing lookups? */</i></td></tr>
<tr><th id="5112">5112</th><td>	<b>while</b>(<a class="local col5 ref" href="#1205xfr" title='xfr' data-ref="1205xfr" data-ref-filename="1205xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::lookup_target" title='auth_transfer::lookup_target' data-ref="auth_transfer::lookup_target" data-ref-filename="auth_transfer..lookup_target">lookup_target</a>) {</td></tr>
<tr><th id="5113">5113</th><td>		<b>if</b>(<a class="tu ref fn" href="#xfr_transfer_lookup_host" title='xfr_transfer_lookup_host' data-use='c' data-ref="xfr_transfer_lookup_host" data-ref-filename="xfr_transfer_lookup_host">xfr_transfer_lookup_host</a>(<a class="local col5 ref" href="#1205xfr" title='xfr' data-ref="1205xfr" data-ref-filename="1205xfr">xfr</a>, <a class="local col6 ref" href="#1206env" title='env' data-ref="1206env" data-ref-filename="1206env">env</a>)) {</td></tr>
<tr><th id="5114">5114</th><td>			<i>/* wait for lookup to finish,</i></td></tr>
<tr><th id="5115">5115</th><td><i>			 * note that the hostname may be in unbound's cache</i></td></tr>
<tr><th id="5116">5116</th><td><i>			 * and we may then get an instant cache response,</i></td></tr>
<tr><th id="5117">5117</th><td><i>			 * and that calls the callback just like a full</i></td></tr>
<tr><th id="5118">5118</th><td><i>			 * lookup and lookup failures also call callback */</i></td></tr>
<tr><th id="5119">5119</th><td>			<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 5119, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col5 ref" href="#1205xfr" title='xfr' data-ref="1205xfr" data-ref-filename="1205xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="5120">5120</th><td>			<b>return</b>;</td></tr>
<tr><th id="5121">5121</th><td>		}</td></tr>
<tr><th id="5122">5122</th><td>		<a class="tu ref fn" href="#xfr_transfer_move_to_next_lookup" title='xfr_transfer_move_to_next_lookup' data-use='c' data-ref="xfr_transfer_move_to_next_lookup" data-ref-filename="xfr_transfer_move_to_next_lookup">xfr_transfer_move_to_next_lookup</a>(<a class="local col5 ref" href="#1205xfr" title='xfr' data-ref="1205xfr" data-ref-filename="1205xfr">xfr</a>, <a class="local col6 ref" href="#1206env" title='env' data-ref="1206env" data-ref-filename="1206env">env</a>);</td></tr>
<tr><th id="5123">5123</th><td>	}</td></tr>
<tr><th id="5124">5124</th><td></td></tr>
<tr><th id="5125">5125</th><td>	<i>/* initiate TCP and fetch the zone from the master */</i></td></tr>
<tr><th id="5126">5126</th><td>	<i>/* and set timeout on it */</i></td></tr>
<tr><th id="5127">5127</th><td>	<b>while</b>(!<a class="tu ref fn" href="#xfr_transfer_end_of_list" title='xfr_transfer_end_of_list' data-use='c' data-ref="xfr_transfer_end_of_list" data-ref-filename="xfr_transfer_end_of_list">xfr_transfer_end_of_list</a>(<a class="local col5 ref" href="#1205xfr" title='xfr' data-ref="1205xfr" data-ref-filename="1205xfr">xfr</a>)) {</td></tr>
<tr><th id="5128">5128</th><td>		<a class="local col5 ref" href="#1205xfr" title='xfr' data-ref="1205xfr" data-ref-filename="1205xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a> = <a class="tu ref fn" href="#xfr_transfer_current_master" title='xfr_transfer_current_master' data-use='c' data-ref="xfr_transfer_current_master" data-ref-filename="xfr_transfer_current_master">xfr_transfer_current_master</a>(<a class="local col5 ref" href="#1205xfr" title='xfr' data-ref="1205xfr" data-ref-filename="1205xfr">xfr</a>);</td></tr>
<tr><th id="5129">5129</th><td>		<b>if</b>(<a class="tu ref fn" href="#xfr_transfer_init_fetch" title='xfr_transfer_init_fetch' data-use='c' data-ref="xfr_transfer_init_fetch" data-ref-filename="xfr_transfer_init_fetch">xfr_transfer_init_fetch</a>(<a class="local col5 ref" href="#1205xfr" title='xfr' data-ref="1205xfr" data-ref-filename="1205xfr">xfr</a>, <a class="local col6 ref" href="#1206env" title='env' data-ref="1206env" data-ref-filename="1206env">env</a>)) {</td></tr>
<tr><th id="5130">5130</th><td>			<i>/* successfully started, wait for callback */</i></td></tr>
<tr><th id="5131">5131</th><td>			<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 5131, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col5 ref" href="#1205xfr" title='xfr' data-ref="1205xfr" data-ref-filename="1205xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="5132">5132</th><td>			<b>return</b>;</td></tr>
<tr><th id="5133">5133</th><td>		}</td></tr>
<tr><th id="5134">5134</th><td>		<i>/* failed to fetch, next master */</i></td></tr>
<tr><th id="5135">5135</th><td>		<a class="tu ref fn" href="#xfr_transfer_nextmaster" title='xfr_transfer_nextmaster' data-use='c' data-ref="xfr_transfer_nextmaster" data-ref-filename="xfr_transfer_nextmaster">xfr_transfer_nextmaster</a>(<a class="local col5 ref" href="#1205xfr" title='xfr' data-ref="1205xfr" data-ref-filename="1205xfr">xfr</a>);</td></tr>
<tr><th id="5136">5136</th><td>	}</td></tr>
<tr><th id="5137">5137</th><td></td></tr>
<tr><th id="5138">5138</th><td>	<i>/* we failed to fetch the zone, move to wait task</i></td></tr>
<tr><th id="5139">5139</th><td><i>	 * use the shorter retry timeout */</i></td></tr>
<tr><th id="5140">5140</th><td>	<a class="tu ref fn" href="#xfr_transfer_disown" title='xfr_transfer_disown' data-use='c' data-ref="xfr_transfer_disown" data-ref-filename="xfr_transfer_disown">xfr_transfer_disown</a>(<a class="local col5 ref" href="#1205xfr" title='xfr' data-ref="1205xfr" data-ref-filename="1205xfr">xfr</a>);</td></tr>
<tr><th id="5141">5141</th><td></td></tr>
<tr><th id="5142">5142</th><td>	<i>/* pick up the nextprobe task and wait */</i></td></tr>
<tr><th id="5143">5143</th><td>	<b>if</b>(<a class="local col5 ref" href="#1205xfr" title='xfr' data-ref="1205xfr" data-ref-filename="1205xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::worker" title='auth_nextprobe::worker' data-ref="auth_nextprobe::worker" data-ref-filename="auth_nextprobe..worker">worker</a> == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>)</td></tr>
<tr><th id="5144">5144</th><td>		<a class="tu ref fn" href="#xfr_set_timeout" title='xfr_set_timeout' data-use='c' data-ref="xfr_set_timeout" data-ref-filename="xfr_set_timeout">xfr_set_timeout</a>(<a class="local col5 ref" href="#1205xfr" title='xfr' data-ref="1205xfr" data-ref-filename="1205xfr">xfr</a>, <a class="local col6 ref" href="#1206env" title='env' data-ref="1206env" data-ref-filename="1206env">env</a>, <var>1</var>, <var>0</var>);</td></tr>
<tr><th id="5145">5145</th><td>	<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 5145, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col5 ref" href="#1205xfr" title='xfr' data-ref="1205xfr" data-ref-filename="1205xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="5146">5146</th><td>}</td></tr>
<tr><th id="5147">5147</th><td></td></tr>
<tr><th id="5148">5148</th><td><i class="doc" data-doc="xfr_master_add_addrs">/** add addrs from A or AAAA rrset to the master */</i></td></tr>
<tr><th id="5149">5149</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="5150">5150</th><td><dfn class="tu decl def fn" id="xfr_master_add_addrs" title='xfr_master_add_addrs' data-type='void xfr_master_add_addrs(struct auth_master * m, struct ub_packed_rrset_key * rrset, uint16_t rrtype)' data-ref="xfr_master_add_addrs" data-ref-filename="xfr_master_add_addrs">xfr_master_add_addrs</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>* <dfn class="local col7 decl" id="1207m" title='m' data-type='struct auth_master *' data-ref="1207m" data-ref-filename="1207m">m</dfn>, <b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key" title='ub_packed_rrset_key' data-ref="ub_packed_rrset_key" data-ref-filename="ub_packed_rrset_key">ub_packed_rrset_key</a>* <dfn class="local col8 decl" id="1208rrset" title='rrset' data-type='struct ub_packed_rrset_key *' data-ref="1208rrset" data-ref-filename="1208rrset">rrset</dfn>,</td></tr>
<tr><th id="5151">5151</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col9 decl" id="1209rrtype" title='rrtype' data-type='uint16_t' data-ref="1209rrtype" data-ref-filename="1209rrtype">rrtype</dfn>)</td></tr>
<tr><th id="5152">5152</th><td>{</td></tr>
<tr><th id="5153">5153</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col0 decl" id="1210i" title='i' data-type='size_t' data-ref="1210i" data-ref-filename="1210i">i</dfn>;</td></tr>
<tr><th id="5154">5154</th><td>	<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>* <dfn class="local col1 decl" id="1211data" title='data' data-type='struct packed_rrset_data *' data-ref="1211data" data-ref-filename="1211data">data</dfn>;</td></tr>
<tr><th id="5155">5155</th><td>	<b>if</b>(!<a class="local col7 ref" href="#1207m" title='m' data-ref="1207m" data-ref-filename="1207m">m</a> || !<a class="local col8 ref" href="#1208rrset" title='rrset' data-ref="1208rrset" data-ref-filename="1208rrset">rrset</a>) <b>return</b>;</td></tr>
<tr><th id="5156">5156</th><td>	<b>if</b>(<a class="local col9 ref" href="#1209rrtype" title='rrtype' data-ref="1209rrtype" data-ref-filename="1209rrtype">rrtype</a> != <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_A" title='LDNS_RR_TYPE_A' data-ref="LDNS_RR_TYPE_A" data-ref-filename="LDNS_RR_TYPE_A">LDNS_RR_TYPE_A</a> &amp;&amp; <a class="local col9 ref" href="#1209rrtype" title='rrtype' data-ref="1209rrtype" data-ref-filename="1209rrtype">rrtype</a> != <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_AAAA" title='LDNS_RR_TYPE_AAAA' data-ref="LDNS_RR_TYPE_AAAA" data-ref-filename="LDNS_RR_TYPE_AAAA">LDNS_RR_TYPE_AAAA</a>)</td></tr>
<tr><th id="5157">5157</th><td>		<b>return</b>;</td></tr>
<tr><th id="5158">5158</th><td>	<a class="local col1 ref" href="#1211data" title='data' data-ref="1211data" data-ref-filename="1211data">data</a> = (<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#packed_rrset_data" title='packed_rrset_data' data-ref="packed_rrset_data" data-ref-filename="packed_rrset_data">packed_rrset_data</a>*)<a class="local col8 ref" href="#1208rrset" title='rrset' data-ref="1208rrset" data-ref-filename="1208rrset">rrset</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key::entry" title='ub_packed_rrset_key::entry' data-ref="ub_packed_rrset_key::entry" data-ref-filename="ub_packed_rrset_key..entry">entry</a>.<a class="ref field" href="../util/storage/lruhash.h.html#lruhash_entry::data" title='lruhash_entry::data' data-ref="lruhash_entry::data" data-ref-filename="lruhash_entry..data">data</a>;</td></tr>
<tr><th id="5159">5159</th><td>	<b>for</b>(<a class="local col0 ref" href="#1210i" title='i' data-ref="1210i" data-ref-filename="1210i">i</a>=<var>0</var>; <a class="local col0 ref" href="#1210i" title='i' data-ref="1210i" data-ref-filename="1210i">i</a>&lt;<a class="local col1 ref" href="#1211data" title='data' data-ref="1211data" data-ref-filename="1211data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::count" title='packed_rrset_data::count' data-ref="packed_rrset_data::count" data-ref-filename="packed_rrset_data..count">count</a>; <a class="local col0 ref" href="#1210i" title='i' data-ref="1210i" data-ref-filename="1210i">i</a>++) {</td></tr>
<tr><th id="5160">5160</th><td>		<b>struct</b> <a class="type" href="authzone.h.html#auth_addr" title='auth_addr' data-ref="auth_addr" data-ref-filename="auth_addr">auth_addr</a>* <dfn class="local col2 decl" id="1212a" title='a' data-type='struct auth_addr *' data-ref="1212a" data-ref-filename="1212a">a</dfn>;</td></tr>
<tr><th id="5161">5161</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col3 decl" id="1213len" title='len' data-type='size_t' data-ref="1213len" data-ref-filename="1213len">len</dfn> = <a class="local col1 ref" href="#1211data" title='data' data-ref="1211data" data-ref-filename="1211data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_len" title='packed_rrset_data::rr_len' data-ref="packed_rrset_data::rr_len" data-ref-filename="packed_rrset_data..rr_len">rr_len</a>[<a class="local col0 ref" href="#1210i" title='i' data-ref="1210i" data-ref-filename="1210i">i</a>] - <var>2</var>;</td></tr>
<tr><th id="5162">5162</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col4 decl" id="1214rdata" title='rdata' data-type='uint8_t *' data-ref="1214rdata" data-ref-filename="1214rdata">rdata</dfn> = <a class="local col1 ref" href="#1211data" title='data' data-ref="1211data" data-ref-filename="1211data">data</a>-&gt;<a class="ref field" href="../util/data/packed_rrset.h.html#packed_rrset_data::rr_data" title='packed_rrset_data::rr_data' data-ref="packed_rrset_data::rr_data" data-ref-filename="packed_rrset_data..rr_data">rr_data</a>[<a class="local col0 ref" href="#1210i" title='i' data-ref="1210i" data-ref-filename="1210i">i</a>]+<var>2</var>;</td></tr>
<tr><th id="5163">5163</th><td>		<b>if</b>(<a class="local col9 ref" href="#1209rrtype" title='rrtype' data-ref="1209rrtype" data-ref-filename="1209rrtype">rrtype</a> == <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_A" title='LDNS_RR_TYPE_A' data-ref="LDNS_RR_TYPE_A" data-ref-filename="LDNS_RR_TYPE_A">LDNS_RR_TYPE_A</a> &amp;&amp; <a class="local col3 ref" href="#1213len" title='len' data-ref="1213len" data-ref-filename="1213len">len</a> != <a class="macro" href="../util/net_help.h.html#88" title="4" data-ref="_M/INET_SIZE">INET_SIZE</a>)</td></tr>
<tr><th id="5164">5164</th><td>			<b>continue</b>; <i>/* wrong length for A */</i></td></tr>
<tr><th id="5165">5165</th><td>		<b>if</b>(<a class="local col9 ref" href="#1209rrtype" title='rrtype' data-ref="1209rrtype" data-ref-filename="1209rrtype">rrtype</a> == <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_AAAA" title='LDNS_RR_TYPE_AAAA' data-ref="LDNS_RR_TYPE_AAAA" data-ref-filename="LDNS_RR_TYPE_AAAA">LDNS_RR_TYPE_AAAA</a> &amp;&amp; <a class="local col3 ref" href="#1213len" title='len' data-ref="1213len" data-ref-filename="1213len">len</a> != <a class="macro" href="../util/net_help.h.html#90" title="16" data-ref="_M/INET6_SIZE">INET6_SIZE</a>)</td></tr>
<tr><th id="5166">5166</th><td>			<b>continue</b>; <i>/* wrong length for AAAA */</i></td></tr>
<tr><th id="5167">5167</th><td>		</td></tr>
<tr><th id="5168">5168</th><td>		<i>/* add and alloc it */</i></td></tr>
<tr><th id="5169">5169</th><td>		<a class="local col2 ref" href="#1212a" title='a' data-ref="1212a" data-ref-filename="1212a">a</a> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_addr" title='auth_addr' data-ref="auth_addr" data-ref-filename="auth_addr">auth_addr</a>*)<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#calloc" title='calloc' data-ref="calloc" data-ref-filename="calloc">calloc</a>(<var>1</var>, <b>sizeof</b>(*<a class="local col2 ref" href="#1212a" title='a' data-ref="1212a" data-ref-filename="1212a">a</a>));</td></tr>
<tr><th id="5170">5170</th><td>		<b>if</b>(!<a class="local col2 ref" href="#1212a" title='a' data-ref="1212a" data-ref-filename="1212a">a</a>) {</td></tr>
<tr><th id="5171">5171</th><td>			<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"out of memory"</q>);</td></tr>
<tr><th id="5172">5172</th><td>			<b>return</b>;</td></tr>
<tr><th id="5173">5173</th><td>		}</td></tr>
<tr><th id="5174">5174</th><td>		<b>if</b>(<a class="local col9 ref" href="#1209rrtype" title='rrtype' data-ref="1209rrtype" data-ref-filename="1209rrtype">rrtype</a> == <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_A" title='LDNS_RR_TYPE_A' data-ref="LDNS_RR_TYPE_A" data-ref-filename="LDNS_RR_TYPE_A">LDNS_RR_TYPE_A</a>) {</td></tr>
<tr><th id="5175">5175</th><td>			<b>struct</b> <a class="type" href="../../../../../objdir.amd64/destdir.amd64/usr/include/netinet/in.h.html#sockaddr_in" title='sockaddr_in' data-ref="sockaddr_in" data-ref-filename="sockaddr_in">sockaddr_in</a>* <dfn class="local col5 decl" id="1215sa" title='sa' data-type='struct sockaddr_in *' data-ref="1215sa" data-ref-filename="1215sa">sa</dfn>;</td></tr>
<tr><th id="5176">5176</th><td>			<a class="local col2 ref" href="#1212a" title='a' data-ref="1212a" data-ref-filename="1212a">a</a>-&gt;<a class="ref field" href="authzone.h.html#auth_addr::addrlen" title='auth_addr::addrlen' data-ref="auth_addr::addrlen" data-ref-filename="auth_addr..addrlen">addrlen</a> = (<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#84" title="__socklen_t" data-ref="_M/socklen_t">socklen_t</a>)<b>sizeof</b>(*<a class="local col5 ref" href="#1215sa" title='sa' data-ref="1215sa" data-ref-filename="1215sa">sa</a>);</td></tr>
<tr><th id="5177">5177</th><td>			<a class="local col5 ref" href="#1215sa" title='sa' data-ref="1215sa" data-ref-filename="1215sa">sa</a> = (<b>struct</b> <a class="type" href="../../../../../objdir.amd64/destdir.amd64/usr/include/netinet/in.h.html#sockaddr_in" title='sockaddr_in' data-ref="sockaddr_in" data-ref-filename="sockaddr_in">sockaddr_in</a>*)&amp;<a class="local col2 ref" href="#1212a" title='a' data-ref="1212a" data-ref-filename="1212a">a</a>-&gt;<a class="ref field" href="authzone.h.html#auth_addr::addr" title='auth_addr::addr' data-ref="auth_addr::addr" data-ref-filename="auth_addr..addr">addr</a>;</td></tr>
<tr><th id="5178">5178</th><td>			<a class="local col5 ref" href="#1215sa" title='sa' data-ref="1215sa" data-ref-filename="1215sa">sa</a>-&gt;<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/netinet/in.h.html#sockaddr_in::sin_family" title='sockaddr_in::sin_family' data-ref="sockaddr_in::sin_family" data-ref-filename="sockaddr_in..sin_family">sin_family</a> = <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#203" title="2" data-ref="_M/AF_INET">AF_INET</a>;</td></tr>
<tr><th id="5179">5179</th><td>			<a class="local col5 ref" href="#1215sa" title='sa' data-ref="1215sa" data-ref-filename="1215sa">sa</a>-&gt;<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/netinet/in.h.html#sockaddr_in::sin_port" title='sockaddr_in::sin_port' data-ref="sockaddr_in::sin_port" data-ref-filename="sockaddr_in..sin_port">sin_port</a> = (<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/endian.h.html#64" title="__in_port_t" data-ref="_M/in_port_t">in_port_t</a>)<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/endian.h.html#128" title="((uint16_t)(__builtin_constant_p((((uint16_t)((53))))) ? (((uint16_t)(((((((uint16_t)((53)))) &amp; 0xff00) &gt;&gt; 8) | (((((uint16_t)((53)))) &amp; 0x00ff) &lt;&lt; 8))))) : __byte_swap_u16_variable(((uint16_t)((53))))))" data-ref="_M/htons">htons</a>(<a class="macro" href="../../include/config.h.html#1293" title="53" data-ref="_M/UNBOUND_DNS_PORT">UNBOUND_DNS_PORT</a>);</td></tr>
<tr><th id="5180">5180</th><td>			<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(&amp;sa-&gt;sin_addr, 0) != (size_t)-1) ? __builtin___memmove_chk(&amp;sa-&gt;sin_addr, rdata, 4, __builtin_object_size(&amp;sa-&gt;sin_addr, 0)) : __memmove_ichk(&amp;sa-&gt;sin_addr, rdata, 4))" data-ref="_M/memmove">memmove</a>(&amp;<a class="local col5 ref" href="#1215sa" title='sa' data-ref="1215sa" data-ref-filename="1215sa">sa</a>-&gt;<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/netinet/in.h.html#sockaddr_in::sin_addr" title='sockaddr_in::sin_addr' data-ref="sockaddr_in::sin_addr" data-ref-filename="sockaddr_in..sin_addr">sin_addr</a>, <a class="local col4 ref" href="#1214rdata" title='rdata' data-ref="1214rdata" data-ref-filename="1214rdata">rdata</a>, <a class="macro" href="../util/net_help.h.html#88" title="4" data-ref="_M/INET_SIZE">INET_SIZE</a>);</td></tr>
<tr><th id="5181">5181</th><td>		} <b>else</b> {</td></tr>
<tr><th id="5182">5182</th><td>			<b>struct</b> <a class="type" href="../../../../../objdir.amd64/destdir.amd64/usr/include/netinet6/in6.h.html#sockaddr_in6" title='sockaddr_in6' data-ref="sockaddr_in6" data-ref-filename="sockaddr_in6">sockaddr_in6</a>* <dfn class="local col6 decl" id="1216sa" title='sa' data-type='struct sockaddr_in6 *' data-ref="1216sa" data-ref-filename="1216sa">sa</dfn>;</td></tr>
<tr><th id="5183">5183</th><td>			<a class="local col2 ref" href="#1212a" title='a' data-ref="1212a" data-ref-filename="1212a">a</a>-&gt;<a class="ref field" href="authzone.h.html#auth_addr::addrlen" title='auth_addr::addrlen' data-ref="auth_addr::addrlen" data-ref-filename="auth_addr..addrlen">addrlen</a> = (<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#84" title="__socklen_t" data-ref="_M/socklen_t">socklen_t</a>)<b>sizeof</b>(*<a class="local col6 ref" href="#1216sa" title='sa' data-ref="1216sa" data-ref-filename="1216sa">sa</a>);</td></tr>
<tr><th id="5184">5184</th><td>			<a class="local col6 ref" href="#1216sa" title='sa' data-ref="1216sa" data-ref-filename="1216sa">sa</a> = (<b>struct</b> <a class="type" href="../../../../../objdir.amd64/destdir.amd64/usr/include/netinet6/in6.h.html#sockaddr_in6" title='sockaddr_in6' data-ref="sockaddr_in6" data-ref-filename="sockaddr_in6">sockaddr_in6</a>*)&amp;<a class="local col2 ref" href="#1212a" title='a' data-ref="1212a" data-ref-filename="1212a">a</a>-&gt;<a class="ref field" href="authzone.h.html#auth_addr::addr" title='auth_addr::addr' data-ref="auth_addr::addr" data-ref-filename="auth_addr..addr">addr</a>;</td></tr>
<tr><th id="5185">5185</th><td>			<a class="local col6 ref" href="#1216sa" title='sa' data-ref="1216sa" data-ref-filename="1216sa">sa</a>-&gt;<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/netinet6/in6.h.html#sockaddr_in6::sin6_family" title='sockaddr_in6::sin6_family' data-ref="sockaddr_in6::sin6_family" data-ref-filename="sockaddr_in6..sin6_family">sin6_family</a> = <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#230" title="24" data-ref="_M/AF_INET6">AF_INET6</a>;</td></tr>
<tr><th id="5186">5186</th><td>			<a class="local col6 ref" href="#1216sa" title='sa' data-ref="1216sa" data-ref-filename="1216sa">sa</a>-&gt;<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/netinet6/in6.h.html#sockaddr_in6::sin6_port" title='sockaddr_in6::sin6_port' data-ref="sockaddr_in6::sin6_port" data-ref-filename="sockaddr_in6..sin6_port">sin6_port</a> = (<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/endian.h.html#64" title="__in_port_t" data-ref="_M/in_port_t">in_port_t</a>)<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/endian.h.html#128" title="((uint16_t)(__builtin_constant_p((((uint16_t)((53))))) ? (((uint16_t)(((((((uint16_t)((53)))) &amp; 0xff00) &gt;&gt; 8) | (((((uint16_t)((53)))) &amp; 0x00ff) &lt;&lt; 8))))) : __byte_swap_u16_variable(((uint16_t)((53))))))" data-ref="_M/htons">htons</a>(<a class="macro" href="../../include/config.h.html#1293" title="53" data-ref="_M/UNBOUND_DNS_PORT">UNBOUND_DNS_PORT</a>);</td></tr>
<tr><th id="5187">5187</th><td>			<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(&amp;sa-&gt;sin6_addr, 0) != (size_t)-1) ? __builtin___memmove_chk(&amp;sa-&gt;sin6_addr, rdata, 16, __builtin_object_size(&amp;sa-&gt;sin6_addr, 0)) : __memmove_ichk(&amp;sa-&gt;sin6_addr, rdata, 16))" data-ref="_M/memmove">memmove</a>(&amp;<a class="local col6 ref" href="#1216sa" title='sa' data-ref="1216sa" data-ref-filename="1216sa">sa</a>-&gt;<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/netinet6/in6.h.html#sockaddr_in6::sin6_addr" title='sockaddr_in6::sin6_addr' data-ref="sockaddr_in6::sin6_addr" data-ref-filename="sockaddr_in6..sin6_addr">sin6_addr</a>, <a class="local col4 ref" href="#1214rdata" title='rdata' data-ref="1214rdata" data-ref-filename="1214rdata">rdata</a>, <a class="macro" href="../util/net_help.h.html#90" title="16" data-ref="_M/INET6_SIZE">INET6_SIZE</a>);</td></tr>
<tr><th id="5188">5188</th><td>		}</td></tr>
<tr><th id="5189">5189</th><td>		<b>if</b>(<a class="ref" href="../util/log.h.html#verbosity" title='verbosity' data-ref="verbosity" data-ref-filename="verbosity">verbosity</a> &gt;= <a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>) {</td></tr>
<tr><th id="5190">5190</th><td>			<em>char</em> <dfn class="local col7 decl" id="1217s" title='s' data-type='char [64]' data-ref="1217s" data-ref-filename="1217s">s</dfn>[<var>64</var>];</td></tr>
<tr><th id="5191">5191</th><td>			<a class="ref fn" href="../util/net_help.h.html#addr_to_str" title='addr_to_str' data-ref="addr_to_str" data-ref-filename="addr_to_str">addr_to_str</a>(&amp;<a class="local col2 ref" href="#1212a" title='a' data-ref="1212a" data-ref-filename="1212a">a</a>-&gt;<a class="ref field" href="authzone.h.html#auth_addr::addr" title='auth_addr::addr' data-ref="auth_addr::addr" data-ref-filename="auth_addr..addr">addr</a>, <a class="local col2 ref" href="#1212a" title='a' data-ref="1212a" data-ref-filename="1212a">a</a>-&gt;<a class="ref field" href="authzone.h.html#auth_addr::addrlen" title='auth_addr::addrlen' data-ref="auth_addr::addrlen" data-ref-filename="auth_addr..addrlen">addrlen</a>, <a class="local col7 ref" href="#1217s" title='s' data-ref="1217s" data-ref-filename="1217s">s</a>, <b>sizeof</b>(<a class="local col7 ref" href="#1217s" title='s' data-ref="1217s" data-ref-filename="1217s">s</a>));</td></tr>
<tr><th id="5192">5192</th><td>			<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"auth host %s lookup %s"</q>,</td></tr>
<tr><th id="5193">5193</th><td>				<a class="local col7 ref" href="#1207m" title='m' data-ref="1207m" data-ref-filename="1207m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>, <a class="local col7 ref" href="#1217s" title='s' data-ref="1217s" data-ref-filename="1217s">s</a>);</td></tr>
<tr><th id="5194">5194</th><td>		}</td></tr>
<tr><th id="5195">5195</th><td>		<i>/* append to list */</i></td></tr>
<tr><th id="5196">5196</th><td>		<a class="local col2 ref" href="#1212a" title='a' data-ref="1212a" data-ref-filename="1212a">a</a>-&gt;<a class="ref field" href="authzone.h.html#auth_addr::next" title='auth_addr::next' data-ref="auth_addr::next" data-ref-filename="auth_addr..next">next</a> = <a class="local col7 ref" href="#1207m" title='m' data-ref="1207m" data-ref-filename="1207m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::list" title='auth_master::list' data-ref="auth_master::list" data-ref-filename="auth_master..list">list</a>;</td></tr>
<tr><th id="5197">5197</th><td>		<a class="local col7 ref" href="#1207m" title='m' data-ref="1207m" data-ref-filename="1207m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::list" title='auth_master::list' data-ref="auth_master::list" data-ref-filename="auth_master..list">list</a> = <a class="local col2 ref" href="#1212a" title='a' data-ref="1212a" data-ref-filename="1212a">a</a>;</td></tr>
<tr><th id="5198">5198</th><td>	}</td></tr>
<tr><th id="5199">5199</th><td>}</td></tr>
<tr><th id="5200">5200</th><td></td></tr>
<tr><th id="5201">5201</th><td><i class="doc">/** callback for task_transfer lookup of host name, of A or AAAA */</i></td></tr>
<tr><th id="5202">5202</th><td><em>void</em> <dfn class="decl def fn" id="auth_xfer_transfer_lookup_callback" title='auth_xfer_transfer_lookup_callback' data-ref="auth_xfer_transfer_lookup_callback" data-ref-filename="auth_xfer_transfer_lookup_callback">auth_xfer_transfer_lookup_callback</dfn>(<em>void</em>* <dfn class="local col8 decl" id="1218arg" title='arg' data-type='void *' data-ref="1218arg" data-ref-filename="1218arg">arg</dfn>, <em>int</em> <dfn class="local col9 decl" id="1219rcode" title='rcode' data-type='int' data-ref="1219rcode" data-ref-filename="1219rcode">rcode</dfn>, <a class="typedef" href="../sldns/sbuffer.h.html#sldns_buffer" title='sldns_buffer' data-type='struct sldns_buffer' data-ref="sldns_buffer" data-ref-filename="sldns_buffer">sldns_buffer</a>* <dfn class="local col0 decl" id="1220buf" title='buf' data-type='sldns_buffer *' data-ref="1220buf" data-ref-filename="1220buf">buf</dfn>,</td></tr>
<tr><th id="5203">5203</th><td>	<b>enum</b> <a class="type" href="../util/data/packed_rrset.h.html#sec_status" title='sec_status' data-ref="sec_status" data-ref-filename="sec_status">sec_status</a> <a class="macro" href="../../include/config.h.html#1057" title="sec __attribute__((unused))" data-ref="_M/ATTR_UNUSED">ATTR_UNUSED</a>(<dfn class="local col1 decl" id="1221sec" title='sec' data-type='enum sec_status' data-ref="1221sec" data-ref-filename="1221sec">sec</dfn>), <em>char</em>* <a class="macro" href="../../include/config.h.html#1057" title="why_bogus __attribute__((unused))" data-ref="_M/ATTR_UNUSED">ATTR_UNUSED</a>(<dfn class="local col2 decl" id="1222why_bogus" title='why_bogus' data-type='char *' data-ref="1222why_bogus" data-ref-filename="1222why_bogus">why_bogus</dfn>),</td></tr>
<tr><th id="5204">5204</th><td>	<em>int</em> <a class="macro" href="../../include/config.h.html#1057" title="was_ratelimited __attribute__((unused))" data-ref="_M/ATTR_UNUSED">ATTR_UNUSED</a>(<dfn class="local col3 decl" id="1223was_ratelimited" title='was_ratelimited' data-type='int' data-ref="1223was_ratelimited" data-ref-filename="1223was_ratelimited">was_ratelimited</dfn>))</td></tr>
<tr><th id="5205">5205</th><td>{</td></tr>
<tr><th id="5206">5206</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col4 decl" id="1224xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1224xfr" data-ref-filename="1224xfr">xfr</dfn> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>*)<a class="local col8 ref" href="#1218arg" title='arg' data-ref="1218arg" data-ref-filename="1218arg">arg</a>;</td></tr>
<tr><th id="5207">5207</th><td>	<b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col5 decl" id="1225env" title='env' data-type='struct module_env *' data-ref="1225env" data-ref-filename="1225env">env</dfn>;</td></tr>
<tr><th id="5208">5208</th><td>	<a class="macro" href="../util/log.h.html#211" title="" data-ref="_M/log_assert">log_assert</a>(xfr-&gt;task_transfer);</td></tr>
<tr><th id="5209">5209</th><td>	<a class="macro" href="../util/locks.h.html#102" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_lock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_lock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 5209, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_lock">lock_basic_lock</a>(&amp;<a class="local col4 ref" href="#1224xfr" title='xfr' data-ref="1224xfr" data-ref-filename="1224xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="5210">5210</th><td>	<a class="local col5 ref" href="#1225env" title='env' data-ref="1225env" data-ref-filename="1225env">env</a> = <a class="local col4 ref" href="#1224xfr" title='xfr' data-ref="1224xfr" data-ref-filename="1224xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::env" title='auth_transfer::env' data-ref="auth_transfer::env" data-ref-filename="auth_transfer..env">env</a>;</td></tr>
<tr><th id="5211">5211</th><td>	<b>if</b>(<a class="local col5 ref" href="#1225env" title='env' data-ref="1225env" data-ref-filename="1225env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::outnet" title='module_env::outnet' data-ref="module_env::outnet" data-ref-filename="module_env..outnet">outnet</a>-&gt;<a class="ref field" href="outside_network.h.html#outside_network::want_to_quit" title='outside_network::want_to_quit' data-ref="outside_network::want_to_quit" data-ref-filename="outside_network..want_to_quit">want_to_quit</a>) {</td></tr>
<tr><th id="5212">5212</th><td>		<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 5212, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col4 ref" href="#1224xfr" title='xfr' data-ref="1224xfr" data-ref-filename="1224xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="5213">5213</th><td>		<b>return</b>; <i>/* stop on quit */</i></td></tr>
<tr><th id="5214">5214</th><td>	}</td></tr>
<tr><th id="5215">5215</th><td></td></tr>
<tr><th id="5216">5216</th><td>	<i>/* process result */</i></td></tr>
<tr><th id="5217">5217</th><td>	<b>if</b>(<a class="local col9 ref" href="#1219rcode" title='rcode' data-ref="1219rcode" data-ref-filename="1219rcode">rcode</a> == <a class="enum" href="../sldns/pkthdr.h.html#LDNS_RCODE_NOERROR" title='LDNS_RCODE_NOERROR' data-ref="LDNS_RCODE_NOERROR" data-ref-filename="LDNS_RCODE_NOERROR">LDNS_RCODE_NOERROR</a>) {</td></tr>
<tr><th id="5218">5218</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col6 decl" id="1226wanted_qtype" title='wanted_qtype' data-type='uint16_t' data-ref="1226wanted_qtype" data-ref-filename="1226wanted_qtype">wanted_qtype</dfn> = <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_A" title='LDNS_RR_TYPE_A' data-ref="LDNS_RR_TYPE_A" data-ref-filename="LDNS_RR_TYPE_A">LDNS_RR_TYPE_A</a>;</td></tr>
<tr><th id="5219">5219</th><td>		<b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col7 decl" id="1227temp" title='temp' data-type='struct regional *' data-ref="1227temp" data-ref-filename="1227temp">temp</dfn> = <a class="local col5 ref" href="#1225env" title='env' data-ref="1225env" data-ref-filename="1225env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::scratch" title='module_env::scratch' data-ref="module_env::scratch" data-ref-filename="module_env..scratch">scratch</a>;</td></tr>
<tr><th id="5220">5220</th><td>		<b>struct</b> <a class="type" href="../util/data/msgreply.h.html#query_info" title='query_info' data-ref="query_info" data-ref-filename="query_info">query_info</a> <dfn class="local col8 decl" id="1228rq" title='rq' data-type='struct query_info' data-ref="1228rq" data-ref-filename="1228rq">rq</dfn>;</td></tr>
<tr><th id="5221">5221</th><td>		<b>struct</b> <a class="type" href="../util/data/msgreply.h.html#reply_info" title='reply_info' data-ref="reply_info" data-ref-filename="reply_info">reply_info</a>* <dfn class="local col9 decl" id="1229rep" title='rep' data-type='struct reply_info *' data-ref="1229rep" data-ref-filename="1229rep">rep</dfn>;</td></tr>
<tr><th id="5222">5222</th><td>		<b>if</b>(<a class="local col4 ref" href="#1224xfr" title='xfr' data-ref="1224xfr" data-ref-filename="1224xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::lookup_aaaa" title='auth_transfer::lookup_aaaa' data-ref="auth_transfer::lookup_aaaa" data-ref-filename="auth_transfer..lookup_aaaa">lookup_aaaa</a>)</td></tr>
<tr><th id="5223">5223</th><td>			<a class="local col6 ref" href="#1226wanted_qtype" title='wanted_qtype' data-ref="1226wanted_qtype" data-ref-filename="1226wanted_qtype">wanted_qtype</a> = <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_AAAA" title='LDNS_RR_TYPE_AAAA' data-ref="LDNS_RR_TYPE_AAAA" data-ref-filename="LDNS_RR_TYPE_AAAA">LDNS_RR_TYPE_AAAA</a>;</td></tr>
<tr><th id="5224">5224</th><td>		<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#97" title="((__builtin_object_size(&amp;rq, 0) != (size_t)-1) ? __builtin___memset_chk(&amp;rq, 0, sizeof(rq), __builtin_object_size(&amp;rq, 0)) : __memset_ichk(&amp;rq, 0, sizeof(rq)))" data-ref="_M/memset">memset</a>(&amp;<a class="local col8 ref" href="#1228rq" title='rq' data-ref="1228rq" data-ref-filename="1228rq">rq</a>, <var>0</var>, <b>sizeof</b>(<a class="local col8 ref" href="#1228rq" title='rq' data-ref="1228rq" data-ref-filename="1228rq">rq</a>));</td></tr>
<tr><th id="5225">5225</th><td>		<a class="local col9 ref" href="#1229rep" title='rep' data-ref="1229rep" data-ref-filename="1229rep">rep</a> = <a class="ref fn" href="../util/data/msgreply.h.html#parse_reply_in_temp_region" title='parse_reply_in_temp_region' data-ref="parse_reply_in_temp_region" data-ref-filename="parse_reply_in_temp_region">parse_reply_in_temp_region</a>(<a class="local col0 ref" href="#1220buf" title='buf' data-ref="1220buf" data-ref-filename="1220buf">buf</a>, <a class="local col7 ref" href="#1227temp" title='temp' data-ref="1227temp" data-ref-filename="1227temp">temp</a>, &amp;<a class="local col8 ref" href="#1228rq" title='rq' data-ref="1228rq" data-ref-filename="1228rq">rq</a>);</td></tr>
<tr><th id="5226">5226</th><td>		<b>if</b>(<a class="local col9 ref" href="#1229rep" title='rep' data-ref="1229rep" data-ref-filename="1229rep">rep</a> &amp;&amp; <a class="local col8 ref" href="#1228rq" title='rq' data-ref="1228rq" data-ref-filename="1228rq">rq</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qtype" title='query_info::qtype' data-ref="query_info::qtype" data-ref-filename="query_info..qtype">qtype</a> == <a class="local col6 ref" href="#1226wanted_qtype" title='wanted_qtype' data-ref="1226wanted_qtype" data-ref-filename="1226wanted_qtype">wanted_qtype</a> &amp;&amp;</td></tr>
<tr><th id="5227">5227</th><td>			<a class="macro" href="../util/net_help.h.html#73" title="((rep-&gt;flags) &amp; 0xf)" data-ref="_M/FLAGS_GET_RCODE">FLAGS_GET_RCODE</a>(<a class="local col9 ref" href="#1229rep" title='rep' data-ref="1229rep" data-ref-filename="1229rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::flags" title='reply_info::flags' data-ref="reply_info::flags" data-ref-filename="reply_info..flags">flags</a>) == <a class="enum" href="../sldns/pkthdr.h.html#LDNS_RCODE_NOERROR" title='LDNS_RCODE_NOERROR' data-ref="LDNS_RCODE_NOERROR" data-ref-filename="LDNS_RCODE_NOERROR">LDNS_RCODE_NOERROR</a>) {</td></tr>
<tr><th id="5228">5228</th><td>			<i>/* parsed successfully */</i></td></tr>
<tr><th id="5229">5229</th><td>			<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key" title='ub_packed_rrset_key' data-ref="ub_packed_rrset_key" data-ref-filename="ub_packed_rrset_key">ub_packed_rrset_key</a>* <dfn class="local col0 decl" id="1230answer" title='answer' data-type='struct ub_packed_rrset_key *' data-ref="1230answer" data-ref-filename="1230answer">answer</dfn> =</td></tr>
<tr><th id="5230">5230</th><td>				<a class="ref fn" href="../util/data/msgreply.h.html#reply_find_answer_rrset" title='reply_find_answer_rrset' data-ref="reply_find_answer_rrset" data-ref-filename="reply_find_answer_rrset">reply_find_answer_rrset</a>(&amp;<a class="local col8 ref" href="#1228rq" title='rq' data-ref="1228rq" data-ref-filename="1228rq">rq</a>, <a class="local col9 ref" href="#1229rep" title='rep' data-ref="1229rep" data-ref-filename="1229rep">rep</a>);</td></tr>
<tr><th id="5231">5231</th><td>			<b>if</b>(<a class="local col0 ref" href="#1230answer" title='answer' data-ref="1230answer" data-ref-filename="1230answer">answer</a>) {</td></tr>
<tr><th id="5232">5232</th><td>				<a class="tu ref fn" href="#xfr_master_add_addrs" title='xfr_master_add_addrs' data-use='c' data-ref="xfr_master_add_addrs" data-ref-filename="xfr_master_add_addrs">xfr_master_add_addrs</a>(<a class="local col4 ref" href="#1224xfr" title='xfr' data-ref="1224xfr" data-ref-filename="1224xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;</td></tr>
<tr><th id="5233">5233</th><td>					<a class="ref field" href="authzone.h.html#auth_transfer::lookup_target" title='auth_transfer::lookup_target' data-ref="auth_transfer::lookup_target" data-ref-filename="auth_transfer..lookup_target">lookup_target</a>, <a class="local col0 ref" href="#1230answer" title='answer' data-ref="1230answer" data-ref-filename="1230answer">answer</a>, <a class="local col6 ref" href="#1226wanted_qtype" title='wanted_qtype' data-ref="1226wanted_qtype" data-ref-filename="1226wanted_qtype">wanted_qtype</a>);</td></tr>
<tr><th id="5234">5234</th><td>			}</td></tr>
<tr><th id="5235">5235</th><td>		}</td></tr>
<tr><th id="5236">5236</th><td>	}</td></tr>
<tr><th id="5237">5237</th><td>	<b>if</b>(<a class="local col4 ref" href="#1224xfr" title='xfr' data-ref="1224xfr" data-ref-filename="1224xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::lookup_target" title='auth_transfer::lookup_target' data-ref="auth_transfer::lookup_target" data-ref-filename="auth_transfer..lookup_target">lookup_target</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::list" title='auth_master::list' data-ref="auth_master::list" data-ref-filename="auth_master..list">list</a> &amp;&amp;</td></tr>
<tr><th id="5238">5238</th><td>		<a class="local col4 ref" href="#1224xfr" title='xfr' data-ref="1224xfr" data-ref-filename="1224xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::lookup_target" title='auth_transfer::lookup_target' data-ref="auth_transfer::lookup_target" data-ref-filename="auth_transfer..lookup_target">lookup_target</a> == <a class="tu ref fn" href="#xfr_transfer_current_master" title='xfr_transfer_current_master' data-use='c' data-ref="xfr_transfer_current_master" data-ref-filename="xfr_transfer_current_master">xfr_transfer_current_master</a>(<a class="local col4 ref" href="#1224xfr" title='xfr' data-ref="1224xfr" data-ref-filename="1224xfr">xfr</a>))</td></tr>
<tr><th id="5239">5239</th><td>		<a class="local col4 ref" href="#1224xfr" title='xfr' data-ref="1224xfr" data-ref-filename="1224xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::scan_addr" title='auth_transfer::scan_addr' data-ref="auth_transfer::scan_addr" data-ref-filename="auth_transfer..scan_addr">scan_addr</a> = <a class="local col4 ref" href="#1224xfr" title='xfr' data-ref="1224xfr" data-ref-filename="1224xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::lookup_target" title='auth_transfer::lookup_target' data-ref="auth_transfer::lookup_target" data-ref-filename="auth_transfer..lookup_target">lookup_target</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::list" title='auth_master::list' data-ref="auth_master::list" data-ref-filename="auth_master..list">list</a>;</td></tr>
<tr><th id="5240">5240</th><td></td></tr>
<tr><th id="5241">5241</th><td>	<i>/* move to lookup AAAA after A lookup, move to next hostname lookup,</i></td></tr>
<tr><th id="5242">5242</th><td><i>	 * or move to fetch the zone, or, if nothing to do, end task_transfer */</i></td></tr>
<tr><th id="5243">5243</th><td>	<a class="tu ref fn" href="#xfr_transfer_move_to_next_lookup" title='xfr_transfer_move_to_next_lookup' data-use='c' data-ref="xfr_transfer_move_to_next_lookup" data-ref-filename="xfr_transfer_move_to_next_lookup">xfr_transfer_move_to_next_lookup</a>(<a class="local col4 ref" href="#1224xfr" title='xfr' data-ref="1224xfr" data-ref-filename="1224xfr">xfr</a>, <a class="local col5 ref" href="#1225env" title='env' data-ref="1225env" data-ref-filename="1225env">env</a>);</td></tr>
<tr><th id="5244">5244</th><td>	<a class="tu ref fn" href="#xfr_transfer_nexttarget_or_end" title='xfr_transfer_nexttarget_or_end' data-use='c' data-ref="xfr_transfer_nexttarget_or_end" data-ref-filename="xfr_transfer_nexttarget_or_end">xfr_transfer_nexttarget_or_end</a>(<a class="local col4 ref" href="#1224xfr" title='xfr' data-ref="1224xfr" data-ref-filename="1224xfr">xfr</a>, <a class="local col5 ref" href="#1225env" title='env' data-ref="1225env" data-ref-filename="1225env">env</a>);</td></tr>
<tr><th id="5245">5245</th><td>}</td></tr>
<tr><th id="5246">5246</th><td></td></tr>
<tr><th id="5247">5247</th><td><i class="doc" data-doc="check_xfer_packet">/** check if xfer (AXFR or IXFR) packet is OK.</i></td></tr>
<tr><th id="5248">5248</th><td><i class="doc" data-doc="check_xfer_packet"> * return false if we lost connection (SERVFAIL, or unreadable).</i></td></tr>
<tr><th id="5249">5249</th><td><i class="doc" data-doc="check_xfer_packet"> * return false if we need to move from IXFR to AXFR, with gonextonfail</i></td></tr>
<tr><th id="5250">5250</th><td><i class="doc" data-doc="check_xfer_packet"> * 	set to false, so the same master is tried again, but with AXFR.</i></td></tr>
<tr><th id="5251">5251</th><td><i class="doc" data-doc="check_xfer_packet"> * return true if fine to link into data.</i></td></tr>
<tr><th id="5252">5252</th><td><i class="doc" data-doc="check_xfer_packet"> * return true with transferdone=true when the transfer has ended.</i></td></tr>
<tr><th id="5253">5253</th><td><i class="doc" data-doc="check_xfer_packet"> */</i></td></tr>
<tr><th id="5254">5254</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="5255">5255</th><td><dfn class="tu decl def fn" id="check_xfer_packet" title='check_xfer_packet' data-type='int check_xfer_packet(sldns_buffer * pkt, struct auth_xfer * xfr, int * gonextonfail, int * transferdone)' data-ref="check_xfer_packet" data-ref-filename="check_xfer_packet">check_xfer_packet</dfn>(<a class="typedef" href="../sldns/sbuffer.h.html#sldns_buffer" title='sldns_buffer' data-type='struct sldns_buffer' data-ref="sldns_buffer" data-ref-filename="sldns_buffer">sldns_buffer</a>* <dfn class="local col1 decl" id="1231pkt" title='pkt' data-type='sldns_buffer *' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col2 decl" id="1232xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</dfn>,</td></tr>
<tr><th id="5256">5256</th><td>	<em>int</em>* <dfn class="local col3 decl" id="1233gonextonfail" title='gonextonfail' data-type='int *' data-ref="1233gonextonfail" data-ref-filename="1233gonextonfail">gonextonfail</dfn>, <em>int</em>* <dfn class="local col4 decl" id="1234transferdone" title='transferdone' data-type='int *' data-ref="1234transferdone" data-ref-filename="1234transferdone">transferdone</dfn>)</td></tr>
<tr><th id="5257">5257</th><td>{</td></tr>
<tr><th id="5258">5258</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col5 decl" id="1235wire" title='wire' data-type='uint8_t *' data-ref="1235wire" data-ref-filename="1235wire">wire</dfn> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_begin" title='sldns_buffer_begin' data-ref="sldns_buffer_begin" data-ref-filename="sldns_buffer_begin">sldns_buffer_begin</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>);</td></tr>
<tr><th id="5259">5259</th><td>	<em>int</em> <dfn class="local col6 decl" id="1236i" title='i' data-type='int' data-ref="1236i" data-ref-filename="1236i">i</dfn>;</td></tr>
<tr><th id="5260">5260</th><td>	<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_limit" title='sldns_buffer_limit' data-ref="sldns_buffer_limit" data-ref-filename="sldns_buffer_limit">sldns_buffer_limit</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>) &lt; <a class="macro" href="../sldns/pkthdr.h.html#26" title="12" data-ref="_M/LDNS_HEADER_SIZE">LDNS_HEADER_SIZE</a>) {</td></tr>
<tr><th id="5261">5261</th><td>		<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr to %s failed, packet too small"</q>,</td></tr>
<tr><th id="5262">5262</th><td>			<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5263">5263</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5264">5264</th><td>	}</td></tr>
<tr><th id="5265">5265</th><td>	<b>if</b>(!<a class="macro" href="../sldns/pkthdr.h.html#55" title="(*(wire+2) &amp; 0x80U)" data-ref="_M/LDNS_QR_WIRE">LDNS_QR_WIRE</a>(<a class="local col5 ref" href="#1235wire" title='wire' data-ref="1235wire" data-ref-filename="1235wire">wire</a>)) {</td></tr>
<tr><th id="5266">5266</th><td>		<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr to %s failed, packet has no QR flag"</q>,</td></tr>
<tr><th id="5267">5267</th><td>			<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5268">5268</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5269">5269</th><td>	}</td></tr>
<tr><th id="5270">5270</th><td>	<b>if</b>(<a class="macro" href="../sldns/pkthdr.h.html#37" title="(*(wire+2) &amp; 0x02U)" data-ref="_M/LDNS_TC_WIRE">LDNS_TC_WIRE</a>(<a class="local col5 ref" href="#1235wire" title='wire' data-ref="1235wire" data-ref-filename="1235wire">wire</a>)) {</td></tr>
<tr><th id="5271">5271</th><td>		<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr to %s failed, packet has TC flag"</q>,</td></tr>
<tr><th id="5272">5272</th><td>			<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5273">5273</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5274">5274</th><td>	}</td></tr>
<tr><th id="5275">5275</th><td>	<i>/* check ID */</i></td></tr>
<tr><th id="5276">5276</th><td>	<b>if</b>(<a class="macro" href="../sldns/pkthdr.h.html#91" title="(sldns_read_uint16(wire))" data-ref="_M/LDNS_ID_WIRE">LDNS_ID_WIRE</a>(<a class="local col5 ref" href="#1235wire" title='wire' data-ref="1235wire" data-ref-filename="1235wire">wire</a>) != <a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::id" title='auth_transfer::id' data-ref="auth_transfer::id" data-ref-filename="auth_transfer..id">id</a>) {</td></tr>
<tr><th id="5277">5277</th><td>		<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr to %s failed, packet wrong ID"</q>,</td></tr>
<tr><th id="5278">5278</th><td>			<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5279">5279</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5280">5280</th><td>	}</td></tr>
<tr><th id="5281">5281</th><td>	<b>if</b>(<a class="macro" href="../sldns/pkthdr.h.html#62" title="(*(wire+3) &amp; 0x0fU)" data-ref="_M/LDNS_RCODE_WIRE">LDNS_RCODE_WIRE</a>(<a class="local col5 ref" href="#1235wire" title='wire' data-ref="1235wire" data-ref-filename="1235wire">wire</a>) != <a class="enum" href="../sldns/pkthdr.h.html#LDNS_RCODE_NOERROR" title='LDNS_RCODE_NOERROR' data-ref="LDNS_RCODE_NOERROR" data-ref-filename="LDNS_RCODE_NOERROR">LDNS_RCODE_NOERROR</a>) {</td></tr>
<tr><th id="5282">5282</th><td>		<em>char</em> <dfn class="local col7 decl" id="1237rcode" title='rcode' data-type='char [32]' data-ref="1237rcode" data-ref-filename="1237rcode">rcode</dfn>[<var>32</var>];</td></tr>
<tr><th id="5283">5283</th><td>		<a class="ref fn" href="../sldns/wire2str.h.html#sldns_wire2str_rcode_buf" title='sldns_wire2str_rcode_buf' data-ref="sldns_wire2str_rcode_buf" data-ref-filename="sldns_wire2str_rcode_buf">sldns_wire2str_rcode_buf</a>((<em>int</em>)<a class="macro" href="../sldns/pkthdr.h.html#62" title="(*(wire+3) &amp; 0x0fU)" data-ref="_M/LDNS_RCODE_WIRE">LDNS_RCODE_WIRE</a>(<a class="local col5 ref" href="#1235wire" title='wire' data-ref="1235wire" data-ref-filename="1235wire">wire</a>), <a class="local col7 ref" href="#1237rcode" title='rcode' data-ref="1237rcode" data-ref-filename="1237rcode">rcode</a>,</td></tr>
<tr><th id="5284">5284</th><td>			<b>sizeof</b>(<a class="local col7 ref" href="#1237rcode" title='rcode' data-ref="1237rcode" data-ref-filename="1237rcode">rcode</a>));</td></tr>
<tr><th id="5285">5285</th><td>		<i>/* if we are doing IXFR, check for fallback */</i></td></tr>
<tr><th id="5286">5286</th><td>		<b>if</b>(<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::on_ixfr" title='auth_transfer::on_ixfr' data-ref="auth_transfer::on_ixfr" data-ref-filename="auth_transfer..on_ixfr">on_ixfr</a>) {</td></tr>
<tr><th id="5287">5287</th><td>			<b>if</b>(<a class="macro" href="../sldns/pkthdr.h.html#62" title="(*(wire+3) &amp; 0x0fU)" data-ref="_M/LDNS_RCODE_WIRE">LDNS_RCODE_WIRE</a>(<a class="local col5 ref" href="#1235wire" title='wire' data-ref="1235wire" data-ref-filename="1235wire">wire</a>) == <a class="enum" href="../sldns/pkthdr.h.html#LDNS_RCODE_NOTIMPL" title='LDNS_RCODE_NOTIMPL' data-ref="LDNS_RCODE_NOTIMPL" data-ref-filename="LDNS_RCODE_NOTIMPL">LDNS_RCODE_NOTIMPL</a> ||</td></tr>
<tr><th id="5288">5288</th><td>				<a class="macro" href="../sldns/pkthdr.h.html#62" title="(*(wire+3) &amp; 0x0fU)" data-ref="_M/LDNS_RCODE_WIRE">LDNS_RCODE_WIRE</a>(<a class="local col5 ref" href="#1235wire" title='wire' data-ref="1235wire" data-ref-filename="1235wire">wire</a>) == <a class="enum" href="../sldns/pkthdr.h.html#LDNS_RCODE_SERVFAIL" title='LDNS_RCODE_SERVFAIL' data-ref="LDNS_RCODE_SERVFAIL" data-ref-filename="LDNS_RCODE_SERVFAIL">LDNS_RCODE_SERVFAIL</a> ||</td></tr>
<tr><th id="5289">5289</th><td>				<a class="macro" href="../sldns/pkthdr.h.html#62" title="(*(wire+3) &amp; 0x0fU)" data-ref="_M/LDNS_RCODE_WIRE">LDNS_RCODE_WIRE</a>(<a class="local col5 ref" href="#1235wire" title='wire' data-ref="1235wire" data-ref-filename="1235wire">wire</a>) == <a class="enum" href="../sldns/pkthdr.h.html#LDNS_RCODE_REFUSED" title='LDNS_RCODE_REFUSED' data-ref="LDNS_RCODE_REFUSED" data-ref-filename="LDNS_RCODE_REFUSED">LDNS_RCODE_REFUSED</a> ||</td></tr>
<tr><th id="5290">5290</th><td>				<a class="macro" href="../sldns/pkthdr.h.html#62" title="(*(wire+3) &amp; 0x0fU)" data-ref="_M/LDNS_RCODE_WIRE">LDNS_RCODE_WIRE</a>(<a class="local col5 ref" href="#1235wire" title='wire' data-ref="1235wire" data-ref-filename="1235wire">wire</a>) == <a class="enum" href="../sldns/pkthdr.h.html#LDNS_RCODE_FORMERR" title='LDNS_RCODE_FORMERR' data-ref="LDNS_RCODE_FORMERR" data-ref-filename="LDNS_RCODE_FORMERR">LDNS_RCODE_FORMERR</a>) {</td></tr>
<tr><th id="5291">5291</th><td>				<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr to %s, fallback "</q></td></tr>
<tr><th id="5292">5292</th><td>					<q>"from IXFR to AXFR (with rcode %s)"</q>,</td></tr>
<tr><th id="5293">5293</th><td>					<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>,</td></tr>
<tr><th id="5294">5294</th><td>					<a class="local col7 ref" href="#1237rcode" title='rcode' data-ref="1237rcode" data-ref-filename="1237rcode">rcode</a>);</td></tr>
<tr><th id="5295">5295</th><td>				<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::ixfr_fail" title='auth_transfer::ixfr_fail' data-ref="auth_transfer::ixfr_fail" data-ref-filename="auth_transfer..ixfr_fail">ixfr_fail</a> = <var>1</var>;</td></tr>
<tr><th id="5296">5296</th><td>				*<a class="local col3 ref" href="#1233gonextonfail" title='gonextonfail' data-ref="1233gonextonfail" data-ref-filename="1233gonextonfail">gonextonfail</a> = <var>0</var>;</td></tr>
<tr><th id="5297">5297</th><td>				<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5298">5298</th><td>			}</td></tr>
<tr><th id="5299">5299</th><td>		}</td></tr>
<tr><th id="5300">5300</th><td>		<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr to %s failed, packet with rcode %s"</q>,</td></tr>
<tr><th id="5301">5301</th><td>			<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>, <a class="local col7 ref" href="#1237rcode" title='rcode' data-ref="1237rcode" data-ref-filename="1237rcode">rcode</a>);</td></tr>
<tr><th id="5302">5302</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5303">5303</th><td>	}</td></tr>
<tr><th id="5304">5304</th><td>	<b>if</b>(<a class="macro" href="../sldns/pkthdr.h.html#49" title="((*(wire+2) &amp; 0x78U) &gt;&gt; 3)" data-ref="_M/LDNS_OPCODE_WIRE">LDNS_OPCODE_WIRE</a>(<a class="local col5 ref" href="#1235wire" title='wire' data-ref="1235wire" data-ref-filename="1235wire">wire</a>) != <a class="enum" href="../sldns/pkthdr.h.html#LDNS_PACKET_QUERY" title='LDNS_PACKET_QUERY' data-ref="LDNS_PACKET_QUERY" data-ref-filename="LDNS_PACKET_QUERY">LDNS_PACKET_QUERY</a>) {</td></tr>
<tr><th id="5305">5305</th><td>		<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr to %s failed, packet with bad opcode"</q>,</td></tr>
<tr><th id="5306">5306</th><td>			<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5307">5307</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5308">5308</th><td>	}</td></tr>
<tr><th id="5309">5309</th><td>	<b>if</b>(<a class="macro" href="../sldns/pkthdr.h.html#99" title="(sldns_read_uint16(wire+4))" data-ref="_M/LDNS_QDCOUNT">LDNS_QDCOUNT</a>(<a class="local col5 ref" href="#1235wire" title='wire' data-ref="1235wire" data-ref-filename="1235wire">wire</a>) &gt; <var>1</var>) {</td></tr>
<tr><th id="5310">5310</th><td>		<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr to %s failed, packet has qdcount %d"</q>,</td></tr>
<tr><th id="5311">5311</th><td>			<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>,</td></tr>
<tr><th id="5312">5312</th><td>			(<em>int</em>)<a class="macro" href="../sldns/pkthdr.h.html#99" title="(sldns_read_uint16(wire+4))" data-ref="_M/LDNS_QDCOUNT">LDNS_QDCOUNT</a>(<a class="local col5 ref" href="#1235wire" title='wire' data-ref="1235wire" data-ref-filename="1235wire">wire</a>));</td></tr>
<tr><th id="5313">5313</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5314">5314</th><td>	}</td></tr>
<tr><th id="5315">5315</th><td></td></tr>
<tr><th id="5316">5316</th><td>	<i>/* check qname */</i></td></tr>
<tr><th id="5317">5317</th><td>	<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_set_position" title='sldns_buffer_set_position' data-ref="sldns_buffer_set_position" data-ref-filename="sldns_buffer_set_position">sldns_buffer_set_position</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>, <a class="macro" href="../sldns/pkthdr.h.html#26" title="12" data-ref="_M/LDNS_HEADER_SIZE">LDNS_HEADER_SIZE</a>);</td></tr>
<tr><th id="5318">5318</th><td>	<b>for</b>(<a class="local col6 ref" href="#1236i" title='i' data-ref="1236i" data-ref-filename="1236i">i</a>=<var>0</var>; <a class="local col6 ref" href="#1236i" title='i' data-ref="1236i" data-ref-filename="1236i">i</a>&lt;(<em>int</em>)<a class="macro" href="../sldns/pkthdr.h.html#99" title="(sldns_read_uint16(wire+4))" data-ref="_M/LDNS_QDCOUNT">LDNS_QDCOUNT</a>(<a class="local col5 ref" href="#1235wire" title='wire' data-ref="1235wire" data-ref-filename="1235wire">wire</a>); <a class="local col6 ref" href="#1236i" title='i' data-ref="1236i" data-ref-filename="1236i">i</a>++) {</td></tr>
<tr><th id="5319">5319</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col8 decl" id="1238pos" title='pos' data-type='size_t' data-ref="1238pos" data-ref-filename="1238pos">pos</dfn> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_position" title='sldns_buffer_position' data-ref="sldns_buffer_position" data-ref-filename="sldns_buffer_position">sldns_buffer_position</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>);</td></tr>
<tr><th id="5320">5320</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col9 decl" id="1239qtype" title='qtype' data-type='uint16_t' data-ref="1239qtype" data-ref-filename="1239qtype">qtype</dfn>, <dfn class="local col0 decl" id="1240qclass" title='qclass' data-type='uint16_t' data-ref="1240qclass" data-ref-filename="1240qclass">qclass</dfn>;</td></tr>
<tr><th id="5321">5321</th><td>		<b>if</b>(<a class="ref fn" href="../util/data/dname.h.html#pkt_dname_len" title='pkt_dname_len' data-ref="pkt_dname_len" data-ref-filename="pkt_dname_len">pkt_dname_len</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>) == <var>0</var>) {</td></tr>
<tr><th id="5322">5322</th><td>			<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr to %s failed, packet with "</q></td></tr>
<tr><th id="5323">5323</th><td>				<q>"malformed dname"</q>,</td></tr>
<tr><th id="5324">5324</th><td>				<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5325">5325</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5326">5326</th><td>		}</td></tr>
<tr><th id="5327">5327</th><td>		<b>if</b>(<a class="ref fn" href="../util/data/dname.h.html#dname_pkt_compare" title='dname_pkt_compare' data-ref="dname_pkt_compare" data-ref-filename="dname_pkt_compare">dname_pkt_compare</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>, <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_at" title='sldns_buffer_at' data-ref="sldns_buffer_at" data-ref-filename="sldns_buffer_at">sldns_buffer_at</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>, <a class="local col8 ref" href="#1238pos" title='pos' data-ref="1238pos" data-ref-filename="1238pos">pos</a>),</td></tr>
<tr><th id="5328">5328</th><td>			<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a>) != <var>0</var>) {</td></tr>
<tr><th id="5329">5329</th><td>			<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr to %s failed, packet with "</q></td></tr>
<tr><th id="5330">5330</th><td>				<q>"wrong qname"</q>,</td></tr>
<tr><th id="5331">5331</th><td>				<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5332">5332</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5333">5333</th><td>		}</td></tr>
<tr><th id="5334">5334</th><td>		<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_remaining" title='sldns_buffer_remaining' data-ref="sldns_buffer_remaining" data-ref-filename="sldns_buffer_remaining">sldns_buffer_remaining</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>) &lt; <var>4</var>) {</td></tr>
<tr><th id="5335">5335</th><td>			<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr to %s failed, packet with "</q></td></tr>
<tr><th id="5336">5336</th><td>				<q>"truncated query RR"</q>,</td></tr>
<tr><th id="5337">5337</th><td>				<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5338">5338</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5339">5339</th><td>		}</td></tr>
<tr><th id="5340">5340</th><td>		<a class="local col9 ref" href="#1239qtype" title='qtype' data-ref="1239qtype" data-ref-filename="1239qtype">qtype</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u16" title='sldns_buffer_read_u16' data-ref="sldns_buffer_read_u16" data-ref-filename="sldns_buffer_read_u16">sldns_buffer_read_u16</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>);</td></tr>
<tr><th id="5341">5341</th><td>		<a class="local col0 ref" href="#1240qclass" title='qclass' data-ref="1240qclass" data-ref-filename="1240qclass">qclass</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u16" title='sldns_buffer_read_u16' data-ref="sldns_buffer_read_u16" data-ref-filename="sldns_buffer_read_u16">sldns_buffer_read_u16</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>);</td></tr>
<tr><th id="5342">5342</th><td>		<b>if</b>(<a class="local col0 ref" href="#1240qclass" title='qclass' data-ref="1240qclass" data-ref-filename="1240qclass">qclass</a> != <a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::dclass" title='auth_xfer::dclass' data-ref="auth_xfer::dclass" data-ref-filename="auth_xfer..dclass">dclass</a>) {</td></tr>
<tr><th id="5343">5343</th><td>			<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr to %s failed, packet with "</q></td></tr>
<tr><th id="5344">5344</th><td>				<q>"wrong qclass"</q>,</td></tr>
<tr><th id="5345">5345</th><td>				<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5346">5346</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5347">5347</th><td>		}</td></tr>
<tr><th id="5348">5348</th><td>		<b>if</b>(<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::on_ixfr" title='auth_transfer::on_ixfr' data-ref="auth_transfer::on_ixfr" data-ref-filename="auth_transfer..on_ixfr">on_ixfr</a>) {</td></tr>
<tr><th id="5349">5349</th><td>			<b>if</b>(<a class="local col9 ref" href="#1239qtype" title='qtype' data-ref="1239qtype" data-ref-filename="1239qtype">qtype</a> != <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_IXFR" title='LDNS_RR_TYPE_IXFR' data-ref="LDNS_RR_TYPE_IXFR" data-ref-filename="LDNS_RR_TYPE_IXFR">LDNS_RR_TYPE_IXFR</a>) {</td></tr>
<tr><th id="5350">5350</th><td>				<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr to %s failed, packet "</q></td></tr>
<tr><th id="5351">5351</th><td>					<q>"with wrong qtype, expected IXFR"</q>,</td></tr>
<tr><th id="5352">5352</th><td>				<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5353">5353</th><td>				<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5354">5354</th><td>			}</td></tr>
<tr><th id="5355">5355</th><td>		} <b>else</b> {</td></tr>
<tr><th id="5356">5356</th><td>			<b>if</b>(<a class="local col9 ref" href="#1239qtype" title='qtype' data-ref="1239qtype" data-ref-filename="1239qtype">qtype</a> != <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_AXFR" title='LDNS_RR_TYPE_AXFR' data-ref="LDNS_RR_TYPE_AXFR" data-ref-filename="LDNS_RR_TYPE_AXFR">LDNS_RR_TYPE_AXFR</a>) {</td></tr>
<tr><th id="5357">5357</th><td>				<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr to %s failed, packet "</q></td></tr>
<tr><th id="5358">5358</th><td>					<q>"with wrong qtype, expected AXFR"</q>,</td></tr>
<tr><th id="5359">5359</th><td>				<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5360">5360</th><td>				<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5361">5361</th><td>			}</td></tr>
<tr><th id="5362">5362</th><td>		}</td></tr>
<tr><th id="5363">5363</th><td>	}</td></tr>
<tr><th id="5364">5364</th><td></td></tr>
<tr><th id="5365">5365</th><td>	<i>/* check parse of RRs in packet, store first SOA serial</i></td></tr>
<tr><th id="5366">5366</th><td><i>	 * to be able to detect last SOA (with that serial) to see if done */</i></td></tr>
<tr><th id="5367">5367</th><td>	<i>/* also check for IXFR 'zone up to date' reply */</i></td></tr>
<tr><th id="5368">5368</th><td>	<b>for</b>(<a class="local col6 ref" href="#1236i" title='i' data-ref="1236i" data-ref-filename="1236i">i</a>=<var>0</var>; <a class="local col6 ref" href="#1236i" title='i' data-ref="1236i" data-ref-filename="1236i">i</a>&lt;(<em>int</em>)<a class="macro" href="../sldns/pkthdr.h.html#103" title="(sldns_read_uint16(wire+6))" data-ref="_M/LDNS_ANCOUNT">LDNS_ANCOUNT</a>(<a class="local col5 ref" href="#1235wire" title='wire' data-ref="1235wire" data-ref-filename="1235wire">wire</a>); <a class="local col6 ref" href="#1236i" title='i' data-ref="1236i" data-ref-filename="1236i">i</a>++) {</td></tr>
<tr><th id="5369">5369</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col1 decl" id="1241pos" title='pos' data-type='size_t' data-ref="1241pos" data-ref-filename="1241pos">pos</dfn> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_position" title='sldns_buffer_position' data-ref="sldns_buffer_position" data-ref-filename="sldns_buffer_position">sldns_buffer_position</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>);</td></tr>
<tr><th id="5370">5370</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col2 decl" id="1242tp" title='tp' data-type='uint16_t' data-ref="1242tp" data-ref-filename="1242tp">tp</dfn>, <dfn class="local col3 decl" id="1243rdlen" title='rdlen' data-type='uint16_t' data-ref="1243rdlen" data-ref-filename="1243rdlen">rdlen</dfn>;</td></tr>
<tr><th id="5371">5371</th><td>		<b>if</b>(<a class="ref fn" href="../util/data/dname.h.html#pkt_dname_len" title='pkt_dname_len' data-ref="pkt_dname_len" data-ref-filename="pkt_dname_len">pkt_dname_len</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>) == <var>0</var>) {</td></tr>
<tr><th id="5372">5372</th><td>			<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr to %s failed, packet with "</q></td></tr>
<tr><th id="5373">5373</th><td>				<q>"malformed dname in answer section"</q>,</td></tr>
<tr><th id="5374">5374</th><td>				<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5375">5375</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5376">5376</th><td>		}</td></tr>
<tr><th id="5377">5377</th><td>		<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_remaining" title='sldns_buffer_remaining' data-ref="sldns_buffer_remaining" data-ref-filename="sldns_buffer_remaining">sldns_buffer_remaining</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>) &lt; <var>10</var>) {</td></tr>
<tr><th id="5378">5378</th><td>			<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr to %s failed, packet with "</q></td></tr>
<tr><th id="5379">5379</th><td>				<q>"truncated RR"</q>,</td></tr>
<tr><th id="5380">5380</th><td>				<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5381">5381</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5382">5382</th><td>		}</td></tr>
<tr><th id="5383">5383</th><td>		<a class="local col2 ref" href="#1242tp" title='tp' data-ref="1242tp" data-ref-filename="1242tp">tp</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u16" title='sldns_buffer_read_u16' data-ref="sldns_buffer_read_u16" data-ref-filename="sldns_buffer_read_u16">sldns_buffer_read_u16</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>);</td></tr>
<tr><th id="5384">5384</th><td>		(<em>void</em>)<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u16" title='sldns_buffer_read_u16' data-ref="sldns_buffer_read_u16" data-ref-filename="sldns_buffer_read_u16">sldns_buffer_read_u16</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>); <i>/* class */</i></td></tr>
<tr><th id="5385">5385</th><td>		(<em>void</em>)<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u32" title='sldns_buffer_read_u32' data-ref="sldns_buffer_read_u32" data-ref-filename="sldns_buffer_read_u32">sldns_buffer_read_u32</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>); <i>/* ttl */</i></td></tr>
<tr><th id="5386">5386</th><td>		<a class="local col3 ref" href="#1243rdlen" title='rdlen' data-ref="1243rdlen" data-ref-filename="1243rdlen">rdlen</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u16" title='sldns_buffer_read_u16' data-ref="sldns_buffer_read_u16" data-ref-filename="sldns_buffer_read_u16">sldns_buffer_read_u16</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>);</td></tr>
<tr><th id="5387">5387</th><td>		<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_remaining" title='sldns_buffer_remaining' data-ref="sldns_buffer_remaining" data-ref-filename="sldns_buffer_remaining">sldns_buffer_remaining</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>) &lt; <a class="local col3 ref" href="#1243rdlen" title='rdlen' data-ref="1243rdlen" data-ref-filename="1243rdlen">rdlen</a>) {</td></tr>
<tr><th id="5388">5388</th><td>			<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr to %s failed, packet with "</q></td></tr>
<tr><th id="5389">5389</th><td>				<q>"truncated RR rdata"</q>,</td></tr>
<tr><th id="5390">5390</th><td>				<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5391">5391</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5392">5392</th><td>		}</td></tr>
<tr><th id="5393">5393</th><td></td></tr>
<tr><th id="5394">5394</th><td>		<i>/* RR parses (haven't checked rdata itself), now look at</i></td></tr>
<tr><th id="5395">5395</th><td><i>		 * SOA records to see serial number */</i></td></tr>
<tr><th id="5396">5396</th><td>		<b>if</b>(<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::rr_scan_num" title='auth_transfer::rr_scan_num' data-ref="auth_transfer::rr_scan_num" data-ref-filename="auth_transfer..rr_scan_num">rr_scan_num</a> == <var>0</var> &amp;&amp;</td></tr>
<tr><th id="5397">5397</th><td>			<a class="local col2 ref" href="#1242tp" title='tp' data-ref="1242tp" data-ref-filename="1242tp">tp</a> != <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_SOA" title='LDNS_RR_TYPE_SOA' data-ref="LDNS_RR_TYPE_SOA" data-ref-filename="LDNS_RR_TYPE_SOA">LDNS_RR_TYPE_SOA</a>) {</td></tr>
<tr><th id="5398">5398</th><td>			<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr to %s failed, packet with "</q></td></tr>
<tr><th id="5399">5399</th><td>				<q>"malformed zone transfer, no start SOA"</q>,</td></tr>
<tr><th id="5400">5400</th><td>				<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5401">5401</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5402">5402</th><td>		}</td></tr>
<tr><th id="5403">5403</th><td>		<b>if</b>(<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::rr_scan_num" title='auth_transfer::rr_scan_num' data-ref="auth_transfer::rr_scan_num" data-ref-filename="auth_transfer..rr_scan_num">rr_scan_num</a> == <var>1</var> &amp;&amp;</td></tr>
<tr><th id="5404">5404</th><td>			<a class="local col2 ref" href="#1242tp" title='tp' data-ref="1242tp" data-ref-filename="1242tp">tp</a> != <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_SOA" title='LDNS_RR_TYPE_SOA' data-ref="LDNS_RR_TYPE_SOA" data-ref-filename="LDNS_RR_TYPE_SOA">LDNS_RR_TYPE_SOA</a>) {</td></tr>
<tr><th id="5405">5405</th><td>			<i>/* second RR is not a SOA record, this is not an IXFR</i></td></tr>
<tr><th id="5406">5406</th><td><i>			 * the master is replying with an AXFR */</i></td></tr>
<tr><th id="5407">5407</th><td>			<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::on_ixfr_is_axfr" title='auth_transfer::on_ixfr_is_axfr' data-ref="auth_transfer::on_ixfr_is_axfr" data-ref-filename="auth_transfer..on_ixfr_is_axfr">on_ixfr_is_axfr</a> = <var>1</var>;</td></tr>
<tr><th id="5408">5408</th><td>		}</td></tr>
<tr><th id="5409">5409</th><td>		<b>if</b>(<a class="local col2 ref" href="#1242tp" title='tp' data-ref="1242tp" data-ref-filename="1242tp">tp</a> == <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_SOA" title='LDNS_RR_TYPE_SOA' data-ref="LDNS_RR_TYPE_SOA" data-ref-filename="LDNS_RR_TYPE_SOA">LDNS_RR_TYPE_SOA</a>) {</td></tr>
<tr><th id="5410">5410</th><td>			<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a> <dfn class="local col4 decl" id="1244serial" title='serial' data-type='uint32_t' data-ref="1244serial" data-ref-filename="1244serial">serial</dfn>;</td></tr>
<tr><th id="5411">5411</th><td>			<b>if</b>(<a class="local col3 ref" href="#1243rdlen" title='rdlen' data-ref="1243rdlen" data-ref-filename="1243rdlen">rdlen</a> &lt; <var>22</var>) {</td></tr>
<tr><th id="5412">5412</th><td>				<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr to %s failed, packet "</q></td></tr>
<tr><th id="5413">5413</th><td>					<q>"with SOA with malformed rdata"</q>,</td></tr>
<tr><th id="5414">5414</th><td>					<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5415">5415</th><td>				<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5416">5416</th><td>			}</td></tr>
<tr><th id="5417">5417</th><td>			<b>if</b>(<a class="ref fn" href="../util/data/dname.h.html#dname_pkt_compare" title='dname_pkt_compare' data-ref="dname_pkt_compare" data-ref-filename="dname_pkt_compare">dname_pkt_compare</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>, <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_at" title='sldns_buffer_at' data-ref="sldns_buffer_at" data-ref-filename="sldns_buffer_at">sldns_buffer_at</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>, <a class="local col1 ref" href="#1241pos" title='pos' data-ref="1241pos" data-ref-filename="1241pos">pos</a>),</td></tr>
<tr><th id="5418">5418</th><td>				<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a>) != <var>0</var>) {</td></tr>
<tr><th id="5419">5419</th><td>				<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr to %s failed, packet "</q></td></tr>
<tr><th id="5420">5420</th><td>					<q>"with SOA with wrong dname"</q>,</td></tr>
<tr><th id="5421">5421</th><td>					<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5422">5422</th><td>				<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5423">5423</th><td>			}</td></tr>
<tr><th id="5424">5424</th><td></td></tr>
<tr><th id="5425">5425</th><td>			<i>/* read serial number of SOA */</i></td></tr>
<tr><th id="5426">5426</th><td>			<a class="local col4 ref" href="#1244serial" title='serial' data-ref="1244serial" data-ref-filename="1244serial">serial</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u32_at" title='sldns_buffer_read_u32_at' data-ref="sldns_buffer_read_u32_at" data-ref-filename="sldns_buffer_read_u32_at">sldns_buffer_read_u32_at</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>,</td></tr>
<tr><th id="5427">5427</th><td>				<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_position" title='sldns_buffer_position' data-ref="sldns_buffer_position" data-ref-filename="sldns_buffer_position">sldns_buffer_position</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>)+<a class="local col3 ref" href="#1243rdlen" title='rdlen' data-ref="1243rdlen" data-ref-filename="1243rdlen">rdlen</a>-<var>20</var>);</td></tr>
<tr><th id="5428">5428</th><td></td></tr>
<tr><th id="5429">5429</th><td>			<i>/* check for IXFR 'zone has SOA x' reply */</i></td></tr>
<tr><th id="5430">5430</th><td>			<b>if</b>(<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::on_ixfr" title='auth_transfer::on_ixfr' data-ref="auth_transfer::on_ixfr" data-ref-filename="auth_transfer..on_ixfr">on_ixfr</a> &amp;&amp;</td></tr>
<tr><th id="5431">5431</th><td>				<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::rr_scan_num" title='auth_transfer::rr_scan_num' data-ref="auth_transfer::rr_scan_num" data-ref-filename="auth_transfer..rr_scan_num">rr_scan_num</a> == <var>0</var> &amp;&amp;</td></tr>
<tr><th id="5432">5432</th><td>				<a class="macro" href="../sldns/pkthdr.h.html#103" title="(sldns_read_uint16(wire+6))" data-ref="_M/LDNS_ANCOUNT">LDNS_ANCOUNT</a>(<a class="local col5 ref" href="#1235wire" title='wire' data-ref="1235wire" data-ref-filename="1235wire">wire</a>)==<var>1</var>) {</td></tr>
<tr><th id="5433">5433</th><td>				<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr to %s ended, "</q></td></tr>
<tr><th id="5434">5434</th><td>					<q>"IXFR reply that zone has serial %u"</q>,</td></tr>
<tr><th id="5435">5435</th><td>					<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>,</td></tr>
<tr><th id="5436">5436</th><td>					(<em>unsigned</em>)<a class="local col4 ref" href="#1244serial" title='serial' data-ref="1244serial" data-ref-filename="1244serial">serial</a>);</td></tr>
<tr><th id="5437">5437</th><td>				<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5438">5438</th><td>			}</td></tr>
<tr><th id="5439">5439</th><td></td></tr>
<tr><th id="5440">5440</th><td>			<i>/* if first SOA, store serial number */</i></td></tr>
<tr><th id="5441">5441</th><td>			<b>if</b>(<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::got_xfr_serial" title='auth_transfer::got_xfr_serial' data-ref="auth_transfer::got_xfr_serial" data-ref-filename="auth_transfer..got_xfr_serial">got_xfr_serial</a> == <var>0</var>) {</td></tr>
<tr><th id="5442">5442</th><td>				<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::got_xfr_serial" title='auth_transfer::got_xfr_serial' data-ref="auth_transfer::got_xfr_serial" data-ref-filename="auth_transfer..got_xfr_serial">got_xfr_serial</a> = <var>1</var>;</td></tr>
<tr><th id="5443">5443</th><td>				<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::incoming_xfr_serial" title='auth_transfer::incoming_xfr_serial' data-ref="auth_transfer::incoming_xfr_serial" data-ref-filename="auth_transfer..incoming_xfr_serial">incoming_xfr_serial</a> =</td></tr>
<tr><th id="5444">5444</th><td>					<a class="local col4 ref" href="#1244serial" title='serial' data-ref="1244serial" data-ref-filename="1244serial">serial</a>;</td></tr>
<tr><th id="5445">5445</th><td>				<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr %s: contains "</q></td></tr>
<tr><th id="5446">5446</th><td>					<q>"SOA serial %u"</q>,</td></tr>
<tr><th id="5447">5447</th><td>					<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>,</td></tr>
<tr><th id="5448">5448</th><td>					(<em>unsigned</em>)<a class="local col4 ref" href="#1244serial" title='serial' data-ref="1244serial" data-ref-filename="1244serial">serial</a>);</td></tr>
<tr><th id="5449">5449</th><td>			<i>/* see if end of AXFR */</i></td></tr>
<tr><th id="5450">5450</th><td>			} <b>else</b> <b>if</b>(!<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::on_ixfr" title='auth_transfer::on_ixfr' data-ref="auth_transfer::on_ixfr" data-ref-filename="auth_transfer..on_ixfr">on_ixfr</a> ||</td></tr>
<tr><th id="5451">5451</th><td>				<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::on_ixfr_is_axfr" title='auth_transfer::on_ixfr_is_axfr' data-ref="auth_transfer::on_ixfr_is_axfr" data-ref-filename="auth_transfer..on_ixfr_is_axfr">on_ixfr_is_axfr</a>) {</td></tr>
<tr><th id="5452">5452</th><td>				<i>/* second SOA with serial is the end</i></td></tr>
<tr><th id="5453">5453</th><td><i>				 * for AXFR */</i></td></tr>
<tr><th id="5454">5454</th><td>				*<a class="local col4 ref" href="#1234transferdone" title='transferdone' data-ref="1234transferdone" data-ref-filename="1234transferdone">transferdone</a> = <var>1</var>;</td></tr>
<tr><th id="5455">5455</th><td>				<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr %s: last AXFR packet"</q>,</td></tr>
<tr><th id="5456">5456</th><td>					<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5457">5457</th><td>			<i>/* for IXFR, count SOA records with that serial */</i></td></tr>
<tr><th id="5458">5458</th><td>			} <b>else</b> <b>if</b>(<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::incoming_xfr_serial" title='auth_transfer::incoming_xfr_serial' data-ref="auth_transfer::incoming_xfr_serial" data-ref-filename="auth_transfer..incoming_xfr_serial">incoming_xfr_serial</a> ==</td></tr>
<tr><th id="5459">5459</th><td>				<a class="local col4 ref" href="#1244serial" title='serial' data-ref="1244serial" data-ref-filename="1244serial">serial</a> &amp;&amp; <a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::got_xfr_serial" title='auth_transfer::got_xfr_serial' data-ref="auth_transfer::got_xfr_serial" data-ref-filename="auth_transfer..got_xfr_serial">got_xfr_serial</a></td></tr>
<tr><th id="5460">5460</th><td>				== <var>1</var>) {</td></tr>
<tr><th id="5461">5461</th><td>				<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::got_xfr_serial" title='auth_transfer::got_xfr_serial' data-ref="auth_transfer::got_xfr_serial" data-ref-filename="auth_transfer..got_xfr_serial">got_xfr_serial</a>++;</td></tr>
<tr><th id="5462">5462</th><td>			<i>/* if not first soa, if serial==firstserial, the</i></td></tr>
<tr><th id="5463">5463</th><td><i>			 * third time we are at the end, for IXFR */</i></td></tr>
<tr><th id="5464">5464</th><td>			} <b>else</b> <b>if</b>(<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::incoming_xfr_serial" title='auth_transfer::incoming_xfr_serial' data-ref="auth_transfer::incoming_xfr_serial" data-ref-filename="auth_transfer..incoming_xfr_serial">incoming_xfr_serial</a> ==</td></tr>
<tr><th id="5465">5465</th><td>				<a class="local col4 ref" href="#1244serial" title='serial' data-ref="1244serial" data-ref-filename="1244serial">serial</a> &amp;&amp; <a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::got_xfr_serial" title='auth_transfer::got_xfr_serial' data-ref="auth_transfer::got_xfr_serial" data-ref-filename="auth_transfer..got_xfr_serial">got_xfr_serial</a></td></tr>
<tr><th id="5466">5466</th><td>				== <var>2</var>) {</td></tr>
<tr><th id="5467">5467</th><td>				<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr %s: last IXFR packet"</q>,</td></tr>
<tr><th id="5468">5468</th><td>					<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5469">5469</th><td>				*<a class="local col4 ref" href="#1234transferdone" title='transferdone' data-ref="1234transferdone" data-ref-filename="1234transferdone">transferdone</a> = <var>1</var>;</td></tr>
<tr><th id="5470">5470</th><td>				<i>/* continue parse check, if that succeeds,</i></td></tr>
<tr><th id="5471">5471</th><td><i>				 * transfer is done */</i></td></tr>
<tr><th id="5472">5472</th><td>			}</td></tr>
<tr><th id="5473">5473</th><td>		}</td></tr>
<tr><th id="5474">5474</th><td>		<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::rr_scan_num" title='auth_transfer::rr_scan_num' data-ref="auth_transfer::rr_scan_num" data-ref-filename="auth_transfer..rr_scan_num">rr_scan_num</a>++;</td></tr>
<tr><th id="5475">5475</th><td></td></tr>
<tr><th id="5476">5476</th><td>		<i>/* skip over RR rdata to go to the next RR */</i></td></tr>
<tr><th id="5477">5477</th><td>		<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_skip" title='sldns_buffer_skip' data-ref="sldns_buffer_skip" data-ref-filename="sldns_buffer_skip">sldns_buffer_skip</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>, (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#ssize_t" title='ssize_t' data-type='int' data-ref="ssize_t" data-ref-filename="ssize_t">ssize_t</a>)<a class="local col3 ref" href="#1243rdlen" title='rdlen' data-ref="1243rdlen" data-ref-filename="1243rdlen">rdlen</a>);</td></tr>
<tr><th id="5478">5478</th><td>	}</td></tr>
<tr><th id="5479">5479</th><td></td></tr>
<tr><th id="5480">5480</th><td>	<i>/* check authority section */</i></td></tr>
<tr><th id="5481">5481</th><td>	<i>/* we skip over the RRs checking packet format */</i></td></tr>
<tr><th id="5482">5482</th><td>	<b>for</b>(<a class="local col6 ref" href="#1236i" title='i' data-ref="1236i" data-ref-filename="1236i">i</a>=<var>0</var>; <a class="local col6 ref" href="#1236i" title='i' data-ref="1236i" data-ref-filename="1236i">i</a>&lt;(<em>int</em>)<a class="macro" href="../sldns/pkthdr.h.html#107" title="(sldns_read_uint16(wire+8))" data-ref="_M/LDNS_NSCOUNT">LDNS_NSCOUNT</a>(<a class="local col5 ref" href="#1235wire" title='wire' data-ref="1235wire" data-ref-filename="1235wire">wire</a>); <a class="local col6 ref" href="#1236i" title='i' data-ref="1236i" data-ref-filename="1236i">i</a>++) {</td></tr>
<tr><th id="5483">5483</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col5 decl" id="1245rdlen" title='rdlen' data-type='uint16_t' data-ref="1245rdlen" data-ref-filename="1245rdlen">rdlen</dfn>;</td></tr>
<tr><th id="5484">5484</th><td>		<b>if</b>(<a class="ref fn" href="../util/data/dname.h.html#pkt_dname_len" title='pkt_dname_len' data-ref="pkt_dname_len" data-ref-filename="pkt_dname_len">pkt_dname_len</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>) == <var>0</var>) {</td></tr>
<tr><th id="5485">5485</th><td>			<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr to %s failed, packet with "</q></td></tr>
<tr><th id="5486">5486</th><td>				<q>"malformed dname in authority section"</q>,</td></tr>
<tr><th id="5487">5487</th><td>				<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5488">5488</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5489">5489</th><td>		}</td></tr>
<tr><th id="5490">5490</th><td>		<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_remaining" title='sldns_buffer_remaining' data-ref="sldns_buffer_remaining" data-ref-filename="sldns_buffer_remaining">sldns_buffer_remaining</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>) &lt; <var>10</var>) {</td></tr>
<tr><th id="5491">5491</th><td>			<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr to %s failed, packet with "</q></td></tr>
<tr><th id="5492">5492</th><td>				<q>"truncated RR"</q>,</td></tr>
<tr><th id="5493">5493</th><td>				<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5494">5494</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5495">5495</th><td>		}</td></tr>
<tr><th id="5496">5496</th><td>		(<em>void</em>)<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u16" title='sldns_buffer_read_u16' data-ref="sldns_buffer_read_u16" data-ref-filename="sldns_buffer_read_u16">sldns_buffer_read_u16</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>); <i>/* type */</i></td></tr>
<tr><th id="5497">5497</th><td>		(<em>void</em>)<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u16" title='sldns_buffer_read_u16' data-ref="sldns_buffer_read_u16" data-ref-filename="sldns_buffer_read_u16">sldns_buffer_read_u16</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>); <i>/* class */</i></td></tr>
<tr><th id="5498">5498</th><td>		(<em>void</em>)<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u32" title='sldns_buffer_read_u32' data-ref="sldns_buffer_read_u32" data-ref-filename="sldns_buffer_read_u32">sldns_buffer_read_u32</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>); <i>/* ttl */</i></td></tr>
<tr><th id="5499">5499</th><td>		<a class="local col5 ref" href="#1245rdlen" title='rdlen' data-ref="1245rdlen" data-ref-filename="1245rdlen">rdlen</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u16" title='sldns_buffer_read_u16' data-ref="sldns_buffer_read_u16" data-ref-filename="sldns_buffer_read_u16">sldns_buffer_read_u16</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>);</td></tr>
<tr><th id="5500">5500</th><td>		<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_remaining" title='sldns_buffer_remaining' data-ref="sldns_buffer_remaining" data-ref-filename="sldns_buffer_remaining">sldns_buffer_remaining</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>) &lt; <a class="local col5 ref" href="#1245rdlen" title='rdlen' data-ref="1245rdlen" data-ref-filename="1245rdlen">rdlen</a>) {</td></tr>
<tr><th id="5501">5501</th><td>			<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr to %s failed, packet with "</q></td></tr>
<tr><th id="5502">5502</th><td>				<q>"truncated RR rdata"</q>,</td></tr>
<tr><th id="5503">5503</th><td>				<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5504">5504</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5505">5505</th><td>		}</td></tr>
<tr><th id="5506">5506</th><td>		<i>/* skip over RR rdata to go to the next RR */</i></td></tr>
<tr><th id="5507">5507</th><td>		<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_skip" title='sldns_buffer_skip' data-ref="sldns_buffer_skip" data-ref-filename="sldns_buffer_skip">sldns_buffer_skip</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>, (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#ssize_t" title='ssize_t' data-type='int' data-ref="ssize_t" data-ref-filename="ssize_t">ssize_t</a>)<a class="local col5 ref" href="#1245rdlen" title='rdlen' data-ref="1245rdlen" data-ref-filename="1245rdlen">rdlen</a>);</td></tr>
<tr><th id="5508">5508</th><td>	}</td></tr>
<tr><th id="5509">5509</th><td></td></tr>
<tr><th id="5510">5510</th><td>	<i>/* check additional section */</i></td></tr>
<tr><th id="5511">5511</th><td>	<b>for</b>(<a class="local col6 ref" href="#1236i" title='i' data-ref="1236i" data-ref-filename="1236i">i</a>=<var>0</var>; <a class="local col6 ref" href="#1236i" title='i' data-ref="1236i" data-ref-filename="1236i">i</a>&lt;(<em>int</em>)<a class="macro" href="../sldns/pkthdr.h.html#111" title="(sldns_read_uint16(wire+10))" data-ref="_M/LDNS_ARCOUNT">LDNS_ARCOUNT</a>(<a class="local col5 ref" href="#1235wire" title='wire' data-ref="1235wire" data-ref-filename="1235wire">wire</a>); <a class="local col6 ref" href="#1236i" title='i' data-ref="1236i" data-ref-filename="1236i">i</a>++) {</td></tr>
<tr><th id="5512">5512</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col6 decl" id="1246rdlen" title='rdlen' data-type='uint16_t' data-ref="1246rdlen" data-ref-filename="1246rdlen">rdlen</dfn>;</td></tr>
<tr><th id="5513">5513</th><td>		<b>if</b>(<a class="ref fn" href="../util/data/dname.h.html#pkt_dname_len" title='pkt_dname_len' data-ref="pkt_dname_len" data-ref-filename="pkt_dname_len">pkt_dname_len</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>) == <var>0</var>) {</td></tr>
<tr><th id="5514">5514</th><td>			<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr to %s failed, packet with "</q></td></tr>
<tr><th id="5515">5515</th><td>				<q>"malformed dname in additional section"</q>,</td></tr>
<tr><th id="5516">5516</th><td>				<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5517">5517</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5518">5518</th><td>		}</td></tr>
<tr><th id="5519">5519</th><td>		<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_remaining" title='sldns_buffer_remaining' data-ref="sldns_buffer_remaining" data-ref-filename="sldns_buffer_remaining">sldns_buffer_remaining</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>) &lt; <var>10</var>) {</td></tr>
<tr><th id="5520">5520</th><td>			<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr to %s failed, packet with "</q></td></tr>
<tr><th id="5521">5521</th><td>				<q>"truncated RR"</q>,</td></tr>
<tr><th id="5522">5522</th><td>				<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5523">5523</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5524">5524</th><td>		}</td></tr>
<tr><th id="5525">5525</th><td>		(<em>void</em>)<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u16" title='sldns_buffer_read_u16' data-ref="sldns_buffer_read_u16" data-ref-filename="sldns_buffer_read_u16">sldns_buffer_read_u16</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>); <i>/* type */</i></td></tr>
<tr><th id="5526">5526</th><td>		(<em>void</em>)<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u16" title='sldns_buffer_read_u16' data-ref="sldns_buffer_read_u16" data-ref-filename="sldns_buffer_read_u16">sldns_buffer_read_u16</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>); <i>/* class */</i></td></tr>
<tr><th id="5527">5527</th><td>		(<em>void</em>)<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u32" title='sldns_buffer_read_u32' data-ref="sldns_buffer_read_u32" data-ref-filename="sldns_buffer_read_u32">sldns_buffer_read_u32</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>); <i>/* ttl */</i></td></tr>
<tr><th id="5528">5528</th><td>		<a class="local col6 ref" href="#1246rdlen" title='rdlen' data-ref="1246rdlen" data-ref-filename="1246rdlen">rdlen</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_read_u16" title='sldns_buffer_read_u16' data-ref="sldns_buffer_read_u16" data-ref-filename="sldns_buffer_read_u16">sldns_buffer_read_u16</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>);</td></tr>
<tr><th id="5529">5529</th><td>		<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_remaining" title='sldns_buffer_remaining' data-ref="sldns_buffer_remaining" data-ref-filename="sldns_buffer_remaining">sldns_buffer_remaining</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>) &lt; <a class="local col6 ref" href="#1246rdlen" title='rdlen' data-ref="1246rdlen" data-ref-filename="1246rdlen">rdlen</a>) {</td></tr>
<tr><th id="5530">5530</th><td>			<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr to %s failed, packet with "</q></td></tr>
<tr><th id="5531">5531</th><td>				<q>"truncated RR rdata"</q>,</td></tr>
<tr><th id="5532">5532</th><td>				<a class="local col2 ref" href="#1232xfr" title='xfr' data-ref="1232xfr" data-ref-filename="1232xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5533">5533</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5534">5534</th><td>		}</td></tr>
<tr><th id="5535">5535</th><td>		<i>/* skip over RR rdata to go to the next RR */</i></td></tr>
<tr><th id="5536">5536</th><td>		<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_skip" title='sldns_buffer_skip' data-ref="sldns_buffer_skip" data-ref-filename="sldns_buffer_skip">sldns_buffer_skip</a>(<a class="local col1 ref" href="#1231pkt" title='pkt' data-ref="1231pkt" data-ref-filename="1231pkt">pkt</a>, (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#ssize_t" title='ssize_t' data-type='int' data-ref="ssize_t" data-ref-filename="ssize_t">ssize_t</a>)<a class="local col6 ref" href="#1246rdlen" title='rdlen' data-ref="1246rdlen" data-ref-filename="1246rdlen">rdlen</a>);</td></tr>
<tr><th id="5537">5537</th><td>	}</td></tr>
<tr><th id="5538">5538</th><td></td></tr>
<tr><th id="5539">5539</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="5540">5540</th><td>}</td></tr>
<tr><th id="5541">5541</th><td></td></tr>
<tr><th id="5542">5542</th><td><i class="doc" data-doc="xfer_link_data">/** Link the data from this packet into the worklist of transferred data */</i></td></tr>
<tr><th id="5543">5543</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="5544">5544</th><td><dfn class="tu decl def fn" id="xfer_link_data" title='xfer_link_data' data-type='int xfer_link_data(sldns_buffer * pkt, struct auth_xfer * xfr)' data-ref="xfer_link_data" data-ref-filename="xfer_link_data">xfer_link_data</dfn>(<a class="typedef" href="../sldns/sbuffer.h.html#sldns_buffer" title='sldns_buffer' data-type='struct sldns_buffer' data-ref="sldns_buffer" data-ref-filename="sldns_buffer">sldns_buffer</a>* <dfn class="local col7 decl" id="1247pkt" title='pkt' data-type='sldns_buffer *' data-ref="1247pkt" data-ref-filename="1247pkt">pkt</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col8 decl" id="1248xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1248xfr" data-ref-filename="1248xfr">xfr</dfn>)</td></tr>
<tr><th id="5545">5545</th><td>{</td></tr>
<tr><th id="5546">5546</th><td>	<i>/* alloc it */</i></td></tr>
<tr><th id="5547">5547</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_chunk" title='auth_chunk' data-ref="auth_chunk" data-ref-filename="auth_chunk">auth_chunk</a>* <dfn class="local col9 decl" id="1249e" title='e' data-type='struct auth_chunk *' data-ref="1249e" data-ref-filename="1249e">e</dfn>;</td></tr>
<tr><th id="5548">5548</th><td>	<a class="local col9 ref" href="#1249e" title='e' data-ref="1249e" data-ref-filename="1249e">e</a> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_chunk" title='auth_chunk' data-ref="auth_chunk" data-ref-filename="auth_chunk">auth_chunk</a>*)<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#calloc" title='calloc' data-ref="calloc" data-ref-filename="calloc">calloc</a>(<var>1</var>, <b>sizeof</b>(*<a class="local col9 ref" href="#1249e" title='e' data-ref="1249e" data-ref-filename="1249e">e</a>));</td></tr>
<tr><th id="5549">5549</th><td>	<b>if</b>(!<a class="local col9 ref" href="#1249e" title='e' data-ref="1249e" data-ref-filename="1249e">e</a>) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="5550">5550</th><td>	<a class="local col9 ref" href="#1249e" title='e' data-ref="1249e" data-ref-filename="1249e">e</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::next" title='auth_chunk::next' data-ref="auth_chunk::next" data-ref-filename="auth_chunk..next">next</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="5551">5551</th><td>	<a class="local col9 ref" href="#1249e" title='e' data-ref="1249e" data-ref-filename="1249e">e</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::len" title='auth_chunk::len' data-ref="auth_chunk::len" data-ref-filename="auth_chunk..len">len</a> = <a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_limit" title='sldns_buffer_limit' data-ref="sldns_buffer_limit" data-ref-filename="sldns_buffer_limit">sldns_buffer_limit</a>(<a class="local col7 ref" href="#1247pkt" title='pkt' data-ref="1247pkt" data-ref-filename="1247pkt">pkt</a>);</td></tr>
<tr><th id="5552">5552</th><td>	<a class="local col9 ref" href="#1249e" title='e' data-ref="1249e" data-ref-filename="1249e">e</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::data" title='auth_chunk::data' data-ref="auth_chunk::data" data-ref-filename="auth_chunk..data">data</a> = <a class="ref fn" href="../util/net_help.h.html#memdup" title='memdup' data-ref="memdup" data-ref-filename="memdup">memdup</a>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_begin" title='sldns_buffer_begin' data-ref="sldns_buffer_begin" data-ref-filename="sldns_buffer_begin">sldns_buffer_begin</a>(<a class="local col7 ref" href="#1247pkt" title='pkt' data-ref="1247pkt" data-ref-filename="1247pkt">pkt</a>), <a class="local col9 ref" href="#1249e" title='e' data-ref="1249e" data-ref-filename="1249e">e</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::len" title='auth_chunk::len' data-ref="auth_chunk::len" data-ref-filename="auth_chunk..len">len</a>);</td></tr>
<tr><th id="5553">5553</th><td>	<b>if</b>(!<a class="local col9 ref" href="#1249e" title='e' data-ref="1249e" data-ref-filename="1249e">e</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::data" title='auth_chunk::data' data-ref="auth_chunk::data" data-ref-filename="auth_chunk..data">data</a>) {</td></tr>
<tr><th id="5554">5554</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col9 ref" href="#1249e" title='e' data-ref="1249e" data-ref-filename="1249e">e</a>);</td></tr>
<tr><th id="5555">5555</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5556">5556</th><td>	}</td></tr>
<tr><th id="5557">5557</th><td></td></tr>
<tr><th id="5558">5558</th><td>	<i>/* alloc succeeded, link into list */</i></td></tr>
<tr><th id="5559">5559</th><td>	<b>if</b>(!<a class="local col8 ref" href="#1248xfr" title='xfr' data-ref="1248xfr" data-ref-filename="1248xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::chunks_first" title='auth_transfer::chunks_first' data-ref="auth_transfer::chunks_first" data-ref-filename="auth_transfer..chunks_first">chunks_first</a>)</td></tr>
<tr><th id="5560">5560</th><td>		<a class="local col8 ref" href="#1248xfr" title='xfr' data-ref="1248xfr" data-ref-filename="1248xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::chunks_first" title='auth_transfer::chunks_first' data-ref="auth_transfer::chunks_first" data-ref-filename="auth_transfer..chunks_first">chunks_first</a> = <a class="local col9 ref" href="#1249e" title='e' data-ref="1249e" data-ref-filename="1249e">e</a>;</td></tr>
<tr><th id="5561">5561</th><td>	<b>if</b>(<a class="local col8 ref" href="#1248xfr" title='xfr' data-ref="1248xfr" data-ref-filename="1248xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::chunks_last" title='auth_transfer::chunks_last' data-ref="auth_transfer::chunks_last" data-ref-filename="auth_transfer..chunks_last">chunks_last</a>)</td></tr>
<tr><th id="5562">5562</th><td>		<a class="local col8 ref" href="#1248xfr" title='xfr' data-ref="1248xfr" data-ref-filename="1248xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::chunks_last" title='auth_transfer::chunks_last' data-ref="auth_transfer::chunks_last" data-ref-filename="auth_transfer..chunks_last">chunks_last</a>-&gt;<a class="ref field" href="authzone.h.html#auth_chunk::next" title='auth_chunk::next' data-ref="auth_chunk::next" data-ref-filename="auth_chunk..next">next</a> = <a class="local col9 ref" href="#1249e" title='e' data-ref="1249e" data-ref-filename="1249e">e</a>;</td></tr>
<tr><th id="5563">5563</th><td>	<a class="local col8 ref" href="#1248xfr" title='xfr' data-ref="1248xfr" data-ref-filename="1248xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::chunks_last" title='auth_transfer::chunks_last' data-ref="auth_transfer::chunks_last" data-ref-filename="auth_transfer..chunks_last">chunks_last</a> = <a class="local col9 ref" href="#1249e" title='e' data-ref="1249e" data-ref-filename="1249e">e</a>;</td></tr>
<tr><th id="5564">5564</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="5565">5565</th><td>}</td></tr>
<tr><th id="5566">5566</th><td></td></tr>
<tr><th id="5567">5567</th><td><i class="doc" data-doc="process_list_end_transfer">/** task transfer.  the list of data is complete. process it and if failed</i></td></tr>
<tr><th id="5568">5568</th><td><i class="doc" data-doc="process_list_end_transfer"> * move to next master, if succeeded, end the task transfer */</i></td></tr>
<tr><th id="5569">5569</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="5570">5570</th><td><dfn class="tu decl def fn" id="process_list_end_transfer" title='process_list_end_transfer' data-type='void process_list_end_transfer(struct auth_xfer * xfr, struct module_env * env)' data-ref="process_list_end_transfer" data-ref-filename="process_list_end_transfer">process_list_end_transfer</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col0 decl" id="1250xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1250xfr" data-ref-filename="1250xfr">xfr</dfn>, <b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col1 decl" id="1251env" title='env' data-type='struct module_env *' data-ref="1251env" data-ref-filename="1251env">env</dfn>)</td></tr>
<tr><th id="5571">5571</th><td>{</td></tr>
<tr><th id="5572">5572</th><td>	<em>int</em> <dfn class="local col2 decl" id="1252ixfr_fail" title='ixfr_fail' data-type='int' data-ref="1252ixfr_fail" data-ref-filename="1252ixfr_fail">ixfr_fail</dfn> = <var>0</var>;</td></tr>
<tr><th id="5573">5573</th><td>	<b>if</b>(<a class="tu ref fn" href="#xfr_process_chunk_list" title='xfr_process_chunk_list' data-use='c' data-ref="xfr_process_chunk_list" data-ref-filename="xfr_process_chunk_list">xfr_process_chunk_list</a>(<a class="local col0 ref" href="#1250xfr" title='xfr' data-ref="1250xfr" data-ref-filename="1250xfr">xfr</a>, <a class="local col1 ref" href="#1251env" title='env' data-ref="1251env" data-ref-filename="1251env">env</a>, &amp;<a class="local col2 ref" href="#1252ixfr_fail" title='ixfr_fail' data-ref="1252ixfr_fail" data-ref-filename="1252ixfr_fail">ixfr_fail</a>)) {</td></tr>
<tr><th id="5574">5574</th><td>		<i>/* it worked! */</i></td></tr>
<tr><th id="5575">5575</th><td>		<a class="tu ref fn" href="#auth_chunks_delete" title='auth_chunks_delete' data-use='c' data-ref="auth_chunks_delete" data-ref-filename="auth_chunks_delete">auth_chunks_delete</a>(<a class="local col0 ref" href="#1250xfr" title='xfr' data-ref="1250xfr" data-ref-filename="1250xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>);</td></tr>
<tr><th id="5576">5576</th><td></td></tr>
<tr><th id="5577">5577</th><td>		<i>/* we fetched the zone, move to wait task */</i></td></tr>
<tr><th id="5578">5578</th><td>		<a class="tu ref fn" href="#xfr_transfer_disown" title='xfr_transfer_disown' data-use='c' data-ref="xfr_transfer_disown" data-ref-filename="xfr_transfer_disown">xfr_transfer_disown</a>(<a class="local col0 ref" href="#1250xfr" title='xfr' data-ref="1250xfr" data-ref-filename="1250xfr">xfr</a>);</td></tr>
<tr><th id="5579">5579</th><td></td></tr>
<tr><th id="5580">5580</th><td>		<b>if</b>(<a class="local col0 ref" href="#1250xfr" title='xfr' data-ref="1250xfr" data-ref-filename="1250xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::notify_received" title='auth_xfer::notify_received' data-ref="auth_xfer::notify_received" data-ref-filename="auth_xfer..notify_received">notify_received</a> &amp;&amp; (!<a class="local col0 ref" href="#1250xfr" title='xfr' data-ref="1250xfr" data-ref-filename="1250xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::notify_has_serial" title='auth_xfer::notify_has_serial' data-ref="auth_xfer::notify_has_serial" data-ref-filename="auth_xfer..notify_has_serial">notify_has_serial</a> ||</td></tr>
<tr><th id="5581">5581</th><td>			(<a class="local col0 ref" href="#1250xfr" title='xfr' data-ref="1250xfr" data-ref-filename="1250xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::notify_has_serial" title='auth_xfer::notify_has_serial' data-ref="auth_xfer::notify_has_serial" data-ref-filename="auth_xfer..notify_has_serial">notify_has_serial</a> &amp;&amp; </td></tr>
<tr><th id="5582">5582</th><td>			<a class="tu ref fn" href="#xfr_serial_means_update" title='xfr_serial_means_update' data-use='c' data-ref="xfr_serial_means_update" data-ref-filename="xfr_serial_means_update">xfr_serial_means_update</a>(<a class="local col0 ref" href="#1250xfr" title='xfr' data-ref="1250xfr" data-ref-filename="1250xfr">xfr</a>, <a class="local col0 ref" href="#1250xfr" title='xfr' data-ref="1250xfr" data-ref-filename="1250xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::notify_serial" title='auth_xfer::notify_serial' data-ref="auth_xfer::notify_serial" data-ref-filename="auth_xfer..notify_serial">notify_serial</a>)))) {</td></tr>
<tr><th id="5583">5583</th><td>			<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a> <dfn class="local col3 decl" id="1253sr" title='sr' data-type='uint32_t' data-ref="1253sr" data-ref-filename="1253sr">sr</dfn> = <a class="local col0 ref" href="#1250xfr" title='xfr' data-ref="1250xfr" data-ref-filename="1250xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::notify_serial" title='auth_xfer::notify_serial' data-ref="auth_xfer::notify_serial" data-ref-filename="auth_xfer..notify_serial">notify_serial</a>;</td></tr>
<tr><th id="5584">5584</th><td>			<em>int</em> <dfn class="local col4 decl" id="1254has_sr" title='has_sr' data-type='int' data-ref="1254has_sr" data-ref-filename="1254has_sr">has_sr</dfn> = <a class="local col0 ref" href="#1250xfr" title='xfr' data-ref="1250xfr" data-ref-filename="1250xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::notify_has_serial" title='auth_xfer::notify_has_serial' data-ref="auth_xfer::notify_has_serial" data-ref-filename="auth_xfer..notify_has_serial">notify_has_serial</a>;</td></tr>
<tr><th id="5585">5585</th><td>			<i>/* we received a notify while probe/transfer was</i></td></tr>
<tr><th id="5586">5586</th><td><i>			 * in progress.  start a new probe and transfer */</i></td></tr>
<tr><th id="5587">5587</th><td>			<a class="local col0 ref" href="#1250xfr" title='xfr' data-ref="1250xfr" data-ref-filename="1250xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::notify_received" title='auth_xfer::notify_received' data-ref="auth_xfer::notify_received" data-ref-filename="auth_xfer..notify_received">notify_received</a> = <var>0</var>;</td></tr>
<tr><th id="5588">5588</th><td>			<a class="local col0 ref" href="#1250xfr" title='xfr' data-ref="1250xfr" data-ref-filename="1250xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::notify_has_serial" title='auth_xfer::notify_has_serial' data-ref="auth_xfer::notify_has_serial" data-ref-filename="auth_xfer..notify_has_serial">notify_has_serial</a> = <var>0</var>;</td></tr>
<tr><th id="5589">5589</th><td>			<a class="local col0 ref" href="#1250xfr" title='xfr' data-ref="1250xfr" data-ref-filename="1250xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::notify_serial" title='auth_xfer::notify_serial' data-ref="auth_xfer::notify_serial" data-ref-filename="auth_xfer..notify_serial">notify_serial</a> = <var>0</var>;</td></tr>
<tr><th id="5590">5590</th><td>			<b>if</b>(!<a class="tu ref fn" href="#xfr_start_probe" title='xfr_start_probe' data-use='c' data-ref="xfr_start_probe" data-ref-filename="xfr_start_probe">xfr_start_probe</a>(<a class="local col0 ref" href="#1250xfr" title='xfr' data-ref="1250xfr" data-ref-filename="1250xfr">xfr</a>, <a class="local col1 ref" href="#1251env" title='env' data-ref="1251env" data-ref-filename="1251env">env</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>)) {</td></tr>
<tr><th id="5591">5591</th><td>				<i>/* if we couldn't start it, already in</i></td></tr>
<tr><th id="5592">5592</th><td><i>				 * progress; restore notify serial,</i></td></tr>
<tr><th id="5593">5593</th><td><i>				 * while xfr still locked */</i></td></tr>
<tr><th id="5594">5594</th><td>				<a class="local col0 ref" href="#1250xfr" title='xfr' data-ref="1250xfr" data-ref-filename="1250xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::notify_received" title='auth_xfer::notify_received' data-ref="auth_xfer::notify_received" data-ref-filename="auth_xfer..notify_received">notify_received</a> = <var>1</var>;</td></tr>
<tr><th id="5595">5595</th><td>				<a class="local col0 ref" href="#1250xfr" title='xfr' data-ref="1250xfr" data-ref-filename="1250xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::notify_has_serial" title='auth_xfer::notify_has_serial' data-ref="auth_xfer::notify_has_serial" data-ref-filename="auth_xfer..notify_has_serial">notify_has_serial</a> = <a class="local col4 ref" href="#1254has_sr" title='has_sr' data-ref="1254has_sr" data-ref-filename="1254has_sr">has_sr</a>;</td></tr>
<tr><th id="5596">5596</th><td>				<a class="local col0 ref" href="#1250xfr" title='xfr' data-ref="1250xfr" data-ref-filename="1250xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::notify_serial" title='auth_xfer::notify_serial' data-ref="auth_xfer::notify_serial" data-ref-filename="auth_xfer..notify_serial">notify_serial</a> = <a class="local col3 ref" href="#1253sr" title='sr' data-ref="1253sr" data-ref-filename="1253sr">sr</a>;</td></tr>
<tr><th id="5597">5597</th><td>				<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 5597, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col0 ref" href="#1250xfr" title='xfr' data-ref="1250xfr" data-ref-filename="1250xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="5598">5598</th><td>			}</td></tr>
<tr><th id="5599">5599</th><td>			<b>return</b>;</td></tr>
<tr><th id="5600">5600</th><td>		} <b>else</b> {</td></tr>
<tr><th id="5601">5601</th><td>			<i>/* pick up the nextprobe task and wait (normail wait time) */</i></td></tr>
<tr><th id="5602">5602</th><td>			<b>if</b>(<a class="local col0 ref" href="#1250xfr" title='xfr' data-ref="1250xfr" data-ref-filename="1250xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::worker" title='auth_nextprobe::worker' data-ref="auth_nextprobe::worker" data-ref-filename="auth_nextprobe..worker">worker</a> == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>)</td></tr>
<tr><th id="5603">5603</th><td>				<a class="tu ref fn" href="#xfr_set_timeout" title='xfr_set_timeout' data-use='c' data-ref="xfr_set_timeout" data-ref-filename="xfr_set_timeout">xfr_set_timeout</a>(<a class="local col0 ref" href="#1250xfr" title='xfr' data-ref="1250xfr" data-ref-filename="1250xfr">xfr</a>, <a class="local col1 ref" href="#1251env" title='env' data-ref="1251env" data-ref-filename="1251env">env</a>, <var>0</var>, <var>0</var>);</td></tr>
<tr><th id="5604">5604</th><td>		}</td></tr>
<tr><th id="5605">5605</th><td>		<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 5605, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col0 ref" href="#1250xfr" title='xfr' data-ref="1250xfr" data-ref-filename="1250xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="5606">5606</th><td>		<b>return</b>;</td></tr>
<tr><th id="5607">5607</th><td>	}</td></tr>
<tr><th id="5608">5608</th><td>	<i>/* processing failed */</i></td></tr>
<tr><th id="5609">5609</th><td>	<i>/* when done, delete data from list */</i></td></tr>
<tr><th id="5610">5610</th><td>	<a class="tu ref fn" href="#auth_chunks_delete" title='auth_chunks_delete' data-use='c' data-ref="auth_chunks_delete" data-ref-filename="auth_chunks_delete">auth_chunks_delete</a>(<a class="local col0 ref" href="#1250xfr" title='xfr' data-ref="1250xfr" data-ref-filename="1250xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>);</td></tr>
<tr><th id="5611">5611</th><td>	<b>if</b>(<a class="local col2 ref" href="#1252ixfr_fail" title='ixfr_fail' data-ref="1252ixfr_fail" data-ref-filename="1252ixfr_fail">ixfr_fail</a>) {</td></tr>
<tr><th id="5612">5612</th><td>		<a class="local col0 ref" href="#1250xfr" title='xfr' data-ref="1250xfr" data-ref-filename="1250xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::ixfr_fail" title='auth_transfer::ixfr_fail' data-ref="auth_transfer::ixfr_fail" data-ref-filename="auth_transfer..ixfr_fail">ixfr_fail</a> = <var>1</var>;</td></tr>
<tr><th id="5613">5613</th><td>	} <b>else</b> {</td></tr>
<tr><th id="5614">5614</th><td>		<a class="tu ref fn" href="#xfr_transfer_nextmaster" title='xfr_transfer_nextmaster' data-use='c' data-ref="xfr_transfer_nextmaster" data-ref-filename="xfr_transfer_nextmaster">xfr_transfer_nextmaster</a>(<a class="local col0 ref" href="#1250xfr" title='xfr' data-ref="1250xfr" data-ref-filename="1250xfr">xfr</a>);</td></tr>
<tr><th id="5615">5615</th><td>	}</td></tr>
<tr><th id="5616">5616</th><td>	<a class="tu ref fn" href="#xfr_transfer_nexttarget_or_end" title='xfr_transfer_nexttarget_or_end' data-use='c' data-ref="xfr_transfer_nexttarget_or_end" data-ref-filename="xfr_transfer_nexttarget_or_end">xfr_transfer_nexttarget_or_end</a>(<a class="local col0 ref" href="#1250xfr" title='xfr' data-ref="1250xfr" data-ref-filename="1250xfr">xfr</a>, <a class="local col1 ref" href="#1251env" title='env' data-ref="1251env" data-ref-filename="1251env">env</a>);</td></tr>
<tr><th id="5617">5617</th><td>}</td></tr>
<tr><th id="5618">5618</th><td></td></tr>
<tr><th id="5619">5619</th><td><i class="doc">/** callback for task_transfer tcp connections */</i></td></tr>
<tr><th id="5620">5620</th><td><em>int</em></td></tr>
<tr><th id="5621">5621</th><td><dfn class="decl def fn" id="auth_xfer_transfer_tcp_callback" title='auth_xfer_transfer_tcp_callback' data-ref="auth_xfer_transfer_tcp_callback" data-ref-filename="auth_xfer_transfer_tcp_callback">auth_xfer_transfer_tcp_callback</dfn>(<b>struct</b> <a class="type" href="../util/netevent.h.html#comm_point" title='comm_point' data-ref="comm_point" data-ref-filename="comm_point">comm_point</a>* <dfn class="local col5 decl" id="1255c" title='c' data-type='struct comm_point *' data-ref="1255c" data-ref-filename="1255c">c</dfn>, <em>void</em>* <dfn class="local col6 decl" id="1256arg" title='arg' data-type='void *' data-ref="1256arg" data-ref-filename="1256arg">arg</dfn>, <em>int</em> <dfn class="local col7 decl" id="1257err" title='err' data-type='int' data-ref="1257err" data-ref-filename="1257err">err</dfn>,</td></tr>
<tr><th id="5622">5622</th><td>	<b>struct</b> <a class="type" href="../util/netevent.h.html#comm_reply" title='comm_reply' data-ref="comm_reply" data-ref-filename="comm_reply">comm_reply</a>* <a class="macro" href="../../include/config.h.html#1057" title="repinfo __attribute__((unused))" data-ref="_M/ATTR_UNUSED">ATTR_UNUSED</a>(<dfn class="local col8 decl" id="1258repinfo" title='repinfo' data-type='struct comm_reply *' data-ref="1258repinfo" data-ref-filename="1258repinfo">repinfo</dfn>))</td></tr>
<tr><th id="5623">5623</th><td>{</td></tr>
<tr><th id="5624">5624</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col9 decl" id="1259xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1259xfr" data-ref-filename="1259xfr">xfr</dfn> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>*)<a class="local col6 ref" href="#1256arg" title='arg' data-ref="1256arg" data-ref-filename="1256arg">arg</a>;</td></tr>
<tr><th id="5625">5625</th><td>	<b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col0 decl" id="1260env" title='env' data-type='struct module_env *' data-ref="1260env" data-ref-filename="1260env">env</dfn>;</td></tr>
<tr><th id="5626">5626</th><td>	<em>int</em> <dfn class="local col1 decl" id="1261gonextonfail" title='gonextonfail' data-type='int' data-ref="1261gonextonfail" data-ref-filename="1261gonextonfail">gonextonfail</dfn> = <var>1</var>;</td></tr>
<tr><th id="5627">5627</th><td>	<em>int</em> <dfn class="local col2 decl" id="1262transferdone" title='transferdone' data-type='int' data-ref="1262transferdone" data-ref-filename="1262transferdone">transferdone</dfn> = <var>0</var>;</td></tr>
<tr><th id="5628">5628</th><td>	<a class="macro" href="../util/log.h.html#211" title="" data-ref="_M/log_assert">log_assert</a>(xfr-&gt;task_transfer);</td></tr>
<tr><th id="5629">5629</th><td>	<a class="macro" href="../util/locks.h.html#102" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_lock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_lock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 5629, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_lock">lock_basic_lock</a>(&amp;<a class="local col9 ref" href="#1259xfr" title='xfr' data-ref="1259xfr" data-ref-filename="1259xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="5630">5630</th><td>	<a class="local col0 ref" href="#1260env" title='env' data-ref="1260env" data-ref-filename="1260env">env</a> = <a class="local col9 ref" href="#1259xfr" title='xfr' data-ref="1259xfr" data-ref-filename="1259xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::env" title='auth_transfer::env' data-ref="auth_transfer::env" data-ref-filename="auth_transfer..env">env</a>;</td></tr>
<tr><th id="5631">5631</th><td>	<b>if</b>(<a class="local col0 ref" href="#1260env" title='env' data-ref="1260env" data-ref-filename="1260env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::outnet" title='module_env::outnet' data-ref="module_env::outnet" data-ref-filename="module_env..outnet">outnet</a>-&gt;<a class="ref field" href="outside_network.h.html#outside_network::want_to_quit" title='outside_network::want_to_quit' data-ref="outside_network::want_to_quit" data-ref-filename="outside_network..want_to_quit">want_to_quit</a>) {</td></tr>
<tr><th id="5632">5632</th><td>		<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 5632, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col9 ref" href="#1259xfr" title='xfr' data-ref="1259xfr" data-ref-filename="1259xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="5633">5633</th><td>		<b>return</b> <var>0</var>; <i>/* stop on quit */</i></td></tr>
<tr><th id="5634">5634</th><td>	}</td></tr>
<tr><th id="5635">5635</th><td></td></tr>
<tr><th id="5636">5636</th><td>	<b>if</b>(<a class="local col7 ref" href="#1257err" title='err' data-ref="1257err" data-ref-filename="1257err">err</a> != <a class="macro" href="../util/netevent.h.html#81" title="0" data-ref="_M/NETEVENT_NOERROR">NETEVENT_NOERROR</a>) {</td></tr>
<tr><th id="5637">5637</th><td>		<i>/* connection failed, closed, or timeout */</i></td></tr>
<tr><th id="5638">5638</th><td>		<i>/* stop this transfer, cleanup </i></td></tr>
<tr><th id="5639">5639</th><td><i>		 * and continue task_transfer*/</i></td></tr>
<tr><th id="5640">5640</th><td>		<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr stopped, connection lost to %s"</q>,</td></tr>
<tr><th id="5641">5641</th><td>			<a class="local col9 ref" href="#1259xfr" title='xfr' data-ref="1259xfr" data-ref-filename="1259xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5642">5642</th><td></td></tr>
<tr><th id="5643">5643</th><td>		<i>/* see if IXFR caused the failure, if so, try AXFR */</i></td></tr>
<tr><th id="5644">5644</th><td>		<b>if</b>(<a class="local col9 ref" href="#1259xfr" title='xfr' data-ref="1259xfr" data-ref-filename="1259xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::on_ixfr" title='auth_transfer::on_ixfr' data-ref="auth_transfer::on_ixfr" data-ref-filename="auth_transfer..on_ixfr">on_ixfr</a>) {</td></tr>
<tr><th id="5645">5645</th><td>			<a class="local col9 ref" href="#1259xfr" title='xfr' data-ref="1259xfr" data-ref-filename="1259xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::ixfr_possible_timeout_count" title='auth_transfer::ixfr_possible_timeout_count' data-ref="auth_transfer::ixfr_possible_timeout_count" data-ref-filename="auth_transfer..ixfr_possible_timeout_count">ixfr_possible_timeout_count</a>++;</td></tr>
<tr><th id="5646">5646</th><td>			<b>if</b>(<a class="local col9 ref" href="#1259xfr" title='xfr' data-ref="1259xfr" data-ref-filename="1259xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::ixfr_possible_timeout_count" title='auth_transfer::ixfr_possible_timeout_count' data-ref="auth_transfer::ixfr_possible_timeout_count" data-ref-filename="auth_transfer..ixfr_possible_timeout_count">ixfr_possible_timeout_count</a> &gt;=</td></tr>
<tr><th id="5647">5647</th><td>				<a class="macro" href="#93" title="3" data-ref="_M/NUM_TIMEOUTS_FALLBACK_IXFR">NUM_TIMEOUTS_FALLBACK_IXFR</a>) {</td></tr>
<tr><th id="5648">5648</th><td>				<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr to %s, fallback "</q></td></tr>
<tr><th id="5649">5649</th><td>					<q>"from IXFR to AXFR (because of timeouts)"</q>,</td></tr>
<tr><th id="5650">5650</th><td>					<a class="local col9 ref" href="#1259xfr" title='xfr' data-ref="1259xfr" data-ref-filename="1259xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5651">5651</th><td>				<a class="local col9 ref" href="#1259xfr" title='xfr' data-ref="1259xfr" data-ref-filename="1259xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::ixfr_fail" title='auth_transfer::ixfr_fail' data-ref="auth_transfer::ixfr_fail" data-ref-filename="auth_transfer..ixfr_fail">ixfr_fail</a> = <var>1</var>;</td></tr>
<tr><th id="5652">5652</th><td>				<a class="local col1 ref" href="#1261gonextonfail" title='gonextonfail' data-ref="1261gonextonfail" data-ref-filename="1261gonextonfail">gonextonfail</a> = <var>0</var>;</td></tr>
<tr><th id="5653">5653</th><td>			}</td></tr>
<tr><th id="5654">5654</th><td>		}</td></tr>
<tr><th id="5655">5655</th><td></td></tr>
<tr><th id="5656">5656</th><td>	<dfn class="lbl" id="1263failed" data-ref="1263failed" data-ref-filename="1263failed">failed</dfn>:</td></tr>
<tr><th id="5657">5657</th><td>		<i>/* delete transferred data from list */</i></td></tr>
<tr><th id="5658">5658</th><td>		<a class="tu ref fn" href="#auth_chunks_delete" title='auth_chunks_delete' data-use='c' data-ref="auth_chunks_delete" data-ref-filename="auth_chunks_delete">auth_chunks_delete</a>(<a class="local col9 ref" href="#1259xfr" title='xfr' data-ref="1259xfr" data-ref-filename="1259xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>);</td></tr>
<tr><th id="5659">5659</th><td>		<a class="ref fn" href="../util/netevent.h.html#comm_point_delete" title='comm_point_delete' data-ref="comm_point_delete" data-ref-filename="comm_point_delete">comm_point_delete</a>(<a class="local col9 ref" href="#1259xfr" title='xfr' data-ref="1259xfr" data-ref-filename="1259xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::cp" title='auth_transfer::cp' data-ref="auth_transfer::cp" data-ref-filename="auth_transfer..cp">cp</a>);</td></tr>
<tr><th id="5660">5660</th><td>		<a class="local col9 ref" href="#1259xfr" title='xfr' data-ref="1259xfr" data-ref-filename="1259xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::cp" title='auth_transfer::cp' data-ref="auth_transfer::cp" data-ref-filename="auth_transfer..cp">cp</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="5661">5661</th><td>		<b>if</b>(<a class="local col1 ref" href="#1261gonextonfail" title='gonextonfail' data-ref="1261gonextonfail" data-ref-filename="1261gonextonfail">gonextonfail</a>)</td></tr>
<tr><th id="5662">5662</th><td>			<a class="tu ref fn" href="#xfr_transfer_nextmaster" title='xfr_transfer_nextmaster' data-use='c' data-ref="xfr_transfer_nextmaster" data-ref-filename="xfr_transfer_nextmaster">xfr_transfer_nextmaster</a>(<a class="local col9 ref" href="#1259xfr" title='xfr' data-ref="1259xfr" data-ref-filename="1259xfr">xfr</a>);</td></tr>
<tr><th id="5663">5663</th><td>		<a class="tu ref fn" href="#xfr_transfer_nexttarget_or_end" title='xfr_transfer_nexttarget_or_end' data-use='c' data-ref="xfr_transfer_nexttarget_or_end" data-ref-filename="xfr_transfer_nexttarget_or_end">xfr_transfer_nexttarget_or_end</a>(<a class="local col9 ref" href="#1259xfr" title='xfr' data-ref="1259xfr" data-ref-filename="1259xfr">xfr</a>, <a class="local col0 ref" href="#1260env" title='env' data-ref="1260env" data-ref-filename="1260env">env</a>);</td></tr>
<tr><th id="5664">5664</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5665">5665</th><td>	}</td></tr>
<tr><th id="5666">5666</th><td>	<i>/* note that IXFR worked without timeout */</i></td></tr>
<tr><th id="5667">5667</th><td>	<b>if</b>(<a class="local col9 ref" href="#1259xfr" title='xfr' data-ref="1259xfr" data-ref-filename="1259xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::on_ixfr" title='auth_transfer::on_ixfr' data-ref="auth_transfer::on_ixfr" data-ref-filename="auth_transfer..on_ixfr">on_ixfr</a>)</td></tr>
<tr><th id="5668">5668</th><td>		<a class="local col9 ref" href="#1259xfr" title='xfr' data-ref="1259xfr" data-ref-filename="1259xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::ixfr_possible_timeout_count" title='auth_transfer::ixfr_possible_timeout_count' data-ref="auth_transfer::ixfr_possible_timeout_count" data-ref-filename="auth_transfer..ixfr_possible_timeout_count">ixfr_possible_timeout_count</a> = <var>0</var>;</td></tr>
<tr><th id="5669">5669</th><td></td></tr>
<tr><th id="5670">5670</th><td>	<i>/* handle returned packet */</i></td></tr>
<tr><th id="5671">5671</th><td>	<i>/* if it fails, cleanup and end this transfer */</i></td></tr>
<tr><th id="5672">5672</th><td>	<i>/* if it needs to fallback from IXFR to AXFR, do that */</i></td></tr>
<tr><th id="5673">5673</th><td>	<b>if</b>(!<a class="tu ref fn" href="#check_xfer_packet" title='check_xfer_packet' data-use='c' data-ref="check_xfer_packet" data-ref-filename="check_xfer_packet">check_xfer_packet</a>(<a class="local col5 ref" href="#1255c" title='c' data-ref="1255c" data-ref-filename="1255c">c</a>-&gt;<a class="ref field" href="../util/netevent.h.html#comm_point::buffer" title='comm_point::buffer' data-ref="comm_point::buffer" data-ref-filename="comm_point..buffer">buffer</a>, <a class="local col9 ref" href="#1259xfr" title='xfr' data-ref="1259xfr" data-ref-filename="1259xfr">xfr</a>, &amp;<a class="local col1 ref" href="#1261gonextonfail" title='gonextonfail' data-ref="1261gonextonfail" data-ref-filename="1261gonextonfail">gonextonfail</a>, &amp;<a class="local col2 ref" href="#1262transferdone" title='transferdone' data-ref="1262transferdone" data-ref-filename="1262transferdone">transferdone</a>)) {</td></tr>
<tr><th id="5674">5674</th><td>		<b>goto</b> <a class="lbl" href="#1263failed" data-ref="1263failed" data-ref-filename="1263failed">failed</a>;</td></tr>
<tr><th id="5675">5675</th><td>	}</td></tr>
<tr><th id="5676">5676</th><td>	<i>/* if it is good, link it into the list of data */</i></td></tr>
<tr><th id="5677">5677</th><td>	<i>/* if the link into list of data fails (malloc fail) cleanup and end */</i></td></tr>
<tr><th id="5678">5678</th><td>	<b>if</b>(!<a class="tu ref fn" href="#xfer_link_data" title='xfer_link_data' data-use='c' data-ref="xfer_link_data" data-ref-filename="xfer_link_data">xfer_link_data</a>(<a class="local col5 ref" href="#1255c" title='c' data-ref="1255c" data-ref-filename="1255c">c</a>-&gt;<a class="ref field" href="../util/netevent.h.html#comm_point::buffer" title='comm_point::buffer' data-ref="comm_point::buffer" data-ref-filename="comm_point..buffer">buffer</a>, <a class="local col9 ref" href="#1259xfr" title='xfr' data-ref="1259xfr" data-ref-filename="1259xfr">xfr</a>)) {</td></tr>
<tr><th id="5679">5679</th><td>		<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"xfr stopped to %s, malloc failed"</q>,</td></tr>
<tr><th id="5680">5680</th><td>			<a class="local col9 ref" href="#1259xfr" title='xfr' data-ref="1259xfr" data-ref-filename="1259xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5681">5681</th><td>		<b>goto</b> <a class="lbl" href="#1263failed" data-ref="1263failed" data-ref-filename="1263failed">failed</a>;</td></tr>
<tr><th id="5682">5682</th><td>	}</td></tr>
<tr><th id="5683">5683</th><td>	<i>/* if the transfer is done now, disconnect and process the list */</i></td></tr>
<tr><th id="5684">5684</th><td>	<b>if</b>(<a class="local col2 ref" href="#1262transferdone" title='transferdone' data-ref="1262transferdone" data-ref-filename="1262transferdone">transferdone</a>) {</td></tr>
<tr><th id="5685">5685</th><td>		<a class="ref fn" href="../util/netevent.h.html#comm_point_delete" title='comm_point_delete' data-ref="comm_point_delete" data-ref-filename="comm_point_delete">comm_point_delete</a>(<a class="local col9 ref" href="#1259xfr" title='xfr' data-ref="1259xfr" data-ref-filename="1259xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::cp" title='auth_transfer::cp' data-ref="auth_transfer::cp" data-ref-filename="auth_transfer..cp">cp</a>);</td></tr>
<tr><th id="5686">5686</th><td>		<a class="local col9 ref" href="#1259xfr" title='xfr' data-ref="1259xfr" data-ref-filename="1259xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::cp" title='auth_transfer::cp' data-ref="auth_transfer::cp" data-ref-filename="auth_transfer..cp">cp</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="5687">5687</th><td>		<a class="tu ref fn" href="#process_list_end_transfer" title='process_list_end_transfer' data-use='c' data-ref="process_list_end_transfer" data-ref-filename="process_list_end_transfer">process_list_end_transfer</a>(<a class="local col9 ref" href="#1259xfr" title='xfr' data-ref="1259xfr" data-ref-filename="1259xfr">xfr</a>, <a class="local col0 ref" href="#1260env" title='env' data-ref="1260env" data-ref-filename="1260env">env</a>);</td></tr>
<tr><th id="5688">5688</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5689">5689</th><td>	}</td></tr>
<tr><th id="5690">5690</th><td></td></tr>
<tr><th id="5691">5691</th><td>	<i>/* if we want to read more messages, setup the commpoint to read</i></td></tr>
<tr><th id="5692">5692</th><td><i>	 * a DNS packet, and the timeout */</i></td></tr>
<tr><th id="5693">5693</th><td>	<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 5693, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col9 ref" href="#1259xfr" title='xfr' data-ref="1259xfr" data-ref-filename="1259xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="5694">5694</th><td>	<a class="local col5 ref" href="#1255c" title='c' data-ref="1255c" data-ref-filename="1255c">c</a>-&gt;<a class="ref field" href="../util/netevent.h.html#comm_point::tcp_is_reading" title='comm_point::tcp_is_reading' data-ref="comm_point::tcp_is_reading" data-ref-filename="comm_point..tcp_is_reading">tcp_is_reading</a> = <var>1</var>;</td></tr>
<tr><th id="5695">5695</th><td>	<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_clear" title='sldns_buffer_clear' data-ref="sldns_buffer_clear" data-ref-filename="sldns_buffer_clear">sldns_buffer_clear</a>(<a class="local col5 ref" href="#1255c" title='c' data-ref="1255c" data-ref-filename="1255c">c</a>-&gt;<a class="ref field" href="../util/netevent.h.html#comm_point::buffer" title='comm_point::buffer' data-ref="comm_point::buffer" data-ref-filename="comm_point..buffer">buffer</a>);</td></tr>
<tr><th id="5696">5696</th><td>	<a class="ref fn" href="../util/netevent.h.html#comm_point_start_listening" title='comm_point_start_listening' data-ref="comm_point_start_listening" data-ref-filename="comm_point_start_listening">comm_point_start_listening</a>(<a class="local col5 ref" href="#1255c" title='c' data-ref="1255c" data-ref-filename="1255c">c</a>, -<var>1</var>, <a class="macro" href="#82" title="10000" data-ref="_M/AUTH_TRANSFER_TIMEOUT">AUTH_TRANSFER_TIMEOUT</a>);</td></tr>
<tr><th id="5697">5697</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5698">5698</th><td>}</td></tr>
<tr><th id="5699">5699</th><td></td></tr>
<tr><th id="5700">5700</th><td><i class="doc">/** callback for task_transfer http connections */</i></td></tr>
<tr><th id="5701">5701</th><td><em>int</em></td></tr>
<tr><th id="5702">5702</th><td><dfn class="decl def fn" id="auth_xfer_transfer_http_callback" title='auth_xfer_transfer_http_callback' data-ref="auth_xfer_transfer_http_callback" data-ref-filename="auth_xfer_transfer_http_callback">auth_xfer_transfer_http_callback</dfn>(<b>struct</b> <a class="type" href="../util/netevent.h.html#comm_point" title='comm_point' data-ref="comm_point" data-ref-filename="comm_point">comm_point</a>* <dfn class="local col4 decl" id="1264c" title='c' data-type='struct comm_point *' data-ref="1264c" data-ref-filename="1264c">c</dfn>, <em>void</em>* <dfn class="local col5 decl" id="1265arg" title='arg' data-type='void *' data-ref="1265arg" data-ref-filename="1265arg">arg</dfn>, <em>int</em> <dfn class="local col6 decl" id="1266err" title='err' data-type='int' data-ref="1266err" data-ref-filename="1266err">err</dfn>,</td></tr>
<tr><th id="5703">5703</th><td>	<b>struct</b> <a class="type" href="../util/netevent.h.html#comm_reply" title='comm_reply' data-ref="comm_reply" data-ref-filename="comm_reply">comm_reply</a>* <dfn class="local col7 decl" id="1267repinfo" title='repinfo' data-type='struct comm_reply *' data-ref="1267repinfo" data-ref-filename="1267repinfo">repinfo</dfn>)</td></tr>
<tr><th id="5704">5704</th><td>{</td></tr>
<tr><th id="5705">5705</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col8 decl" id="1268xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1268xfr" data-ref-filename="1268xfr">xfr</dfn> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>*)<a class="local col5 ref" href="#1265arg" title='arg' data-ref="1265arg" data-ref-filename="1265arg">arg</a>;</td></tr>
<tr><th id="5706">5706</th><td>	<b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col9 decl" id="1269env" title='env' data-type='struct module_env *' data-ref="1269env" data-ref-filename="1269env">env</dfn>;</td></tr>
<tr><th id="5707">5707</th><td>	<a class="macro" href="../util/log.h.html#211" title="" data-ref="_M/log_assert">log_assert</a>(xfr-&gt;task_transfer);</td></tr>
<tr><th id="5708">5708</th><td>	<a class="macro" href="../util/locks.h.html#102" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_lock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_lock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 5708, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_lock">lock_basic_lock</a>(&amp;<a class="local col8 ref" href="#1268xfr" title='xfr' data-ref="1268xfr" data-ref-filename="1268xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="5709">5709</th><td>	<a class="local col9 ref" href="#1269env" title='env' data-ref="1269env" data-ref-filename="1269env">env</a> = <a class="local col8 ref" href="#1268xfr" title='xfr' data-ref="1268xfr" data-ref-filename="1268xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::env" title='auth_transfer::env' data-ref="auth_transfer::env" data-ref-filename="auth_transfer..env">env</a>;</td></tr>
<tr><th id="5710">5710</th><td>	<b>if</b>(<a class="local col9 ref" href="#1269env" title='env' data-ref="1269env" data-ref-filename="1269env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::outnet" title='module_env::outnet' data-ref="module_env::outnet" data-ref-filename="module_env..outnet">outnet</a>-&gt;<a class="ref field" href="outside_network.h.html#outside_network::want_to_quit" title='outside_network::want_to_quit' data-ref="outside_network::want_to_quit" data-ref-filename="outside_network..want_to_quit">want_to_quit</a>) {</td></tr>
<tr><th id="5711">5711</th><td>		<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 5711, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col8 ref" href="#1268xfr" title='xfr' data-ref="1268xfr" data-ref-filename="1268xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="5712">5712</th><td>		<b>return</b> <var>0</var>; <i>/* stop on quit */</i></td></tr>
<tr><th id="5713">5713</th><td>	}</td></tr>
<tr><th id="5714">5714</th><td>	<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"auth zone transfer http callback"</q>);</td></tr>
<tr><th id="5715">5715</th><td></td></tr>
<tr><th id="5716">5716</th><td>	<b>if</b>(<a class="local col6 ref" href="#1266err" title='err' data-ref="1266err" data-ref-filename="1266err">err</a> != <a class="macro" href="../util/netevent.h.html#81" title="0" data-ref="_M/NETEVENT_NOERROR">NETEVENT_NOERROR</a> &amp;&amp; <a class="local col6 ref" href="#1266err" title='err' data-ref="1266err" data-ref-filename="1266err">err</a> != <a class="macro" href="../util/netevent.h.html#89" title="-4" data-ref="_M/NETEVENT_DONE">NETEVENT_DONE</a>) {</td></tr>
<tr><th id="5717">5717</th><td>		<i>/* connection failed, closed, or timeout */</i></td></tr>
<tr><th id="5718">5718</th><td>		<i>/* stop this transfer, cleanup </i></td></tr>
<tr><th id="5719">5719</th><td><i>		 * and continue task_transfer*/</i></td></tr>
<tr><th id="5720">5720</th><td>		<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"http stopped, connection lost to %s"</q>,</td></tr>
<tr><th id="5721">5721</th><td>			<a class="local col8 ref" href="#1268xfr" title='xfr' data-ref="1268xfr" data-ref-filename="1268xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5722">5722</th><td>	<dfn class="lbl" id="1270failed" data-ref="1270failed" data-ref-filename="1270failed">failed</dfn>:</td></tr>
<tr><th id="5723">5723</th><td>		<i>/* delete transferred data from list */</i></td></tr>
<tr><th id="5724">5724</th><td>		<a class="tu ref fn" href="#auth_chunks_delete" title='auth_chunks_delete' data-use='c' data-ref="auth_chunks_delete" data-ref-filename="auth_chunks_delete">auth_chunks_delete</a>(<a class="local col8 ref" href="#1268xfr" title='xfr' data-ref="1268xfr" data-ref-filename="1268xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>);</td></tr>
<tr><th id="5725">5725</th><td>		<b>if</b>(<a class="local col7 ref" href="#1267repinfo" title='repinfo' data-ref="1267repinfo" data-ref-filename="1267repinfo">repinfo</a>) <a class="local col7 ref" href="#1267repinfo" title='repinfo' data-ref="1267repinfo" data-ref-filename="1267repinfo">repinfo</a>-&gt;<a class="ref field" href="../util/netevent.h.html#comm_reply::c" title='comm_reply::c' data-ref="comm_reply::c" data-ref-filename="comm_reply..c">c</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>; <i>/* signal cp deleted to</i></td></tr>
<tr><th id="5726">5726</th><td><i>				the routine calling this callback */</i></td></tr>
<tr><th id="5727">5727</th><td>		<a class="ref fn" href="../util/netevent.h.html#comm_point_delete" title='comm_point_delete' data-ref="comm_point_delete" data-ref-filename="comm_point_delete">comm_point_delete</a>(<a class="local col8 ref" href="#1268xfr" title='xfr' data-ref="1268xfr" data-ref-filename="1268xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::cp" title='auth_transfer::cp' data-ref="auth_transfer::cp" data-ref-filename="auth_transfer..cp">cp</a>);</td></tr>
<tr><th id="5728">5728</th><td>		<a class="local col8 ref" href="#1268xfr" title='xfr' data-ref="1268xfr" data-ref-filename="1268xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::cp" title='auth_transfer::cp' data-ref="auth_transfer::cp" data-ref-filename="auth_transfer..cp">cp</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="5729">5729</th><td>		<a class="tu ref fn" href="#xfr_transfer_nextmaster" title='xfr_transfer_nextmaster' data-use='c' data-ref="xfr_transfer_nextmaster" data-ref-filename="xfr_transfer_nextmaster">xfr_transfer_nextmaster</a>(<a class="local col8 ref" href="#1268xfr" title='xfr' data-ref="1268xfr" data-ref-filename="1268xfr">xfr</a>);</td></tr>
<tr><th id="5730">5730</th><td>		<a class="tu ref fn" href="#xfr_transfer_nexttarget_or_end" title='xfr_transfer_nexttarget_or_end' data-use='c' data-ref="xfr_transfer_nexttarget_or_end" data-ref-filename="xfr_transfer_nexttarget_or_end">xfr_transfer_nexttarget_or_end</a>(<a class="local col8 ref" href="#1268xfr" title='xfr' data-ref="1268xfr" data-ref-filename="1268xfr">xfr</a>, <a class="local col9 ref" href="#1269env" title='env' data-ref="1269env" data-ref-filename="1269env">env</a>);</td></tr>
<tr><th id="5731">5731</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5732">5732</th><td>	}</td></tr>
<tr><th id="5733">5733</th><td></td></tr>
<tr><th id="5734">5734</th><td>	<i>/* if it is good, link it into the list of data */</i></td></tr>
<tr><th id="5735">5735</th><td>	<i>/* if the link into list of data fails (malloc fail) cleanup and end */</i></td></tr>
<tr><th id="5736">5736</th><td>	<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_limit" title='sldns_buffer_limit' data-ref="sldns_buffer_limit" data-ref-filename="sldns_buffer_limit">sldns_buffer_limit</a>(<a class="local col4 ref" href="#1264c" title='c' data-ref="1264c" data-ref-filename="1264c">c</a>-&gt;<a class="ref field" href="../util/netevent.h.html#comm_point::buffer" title='comm_point::buffer' data-ref="comm_point::buffer" data-ref-filename="comm_point..buffer">buffer</a>) &gt; <var>0</var>) {</td></tr>
<tr><th id="5737">5737</th><td>		<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"auth zone http queued up %d bytes"</q>,</td></tr>
<tr><th id="5738">5738</th><td>			(<em>int</em>)<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_limit" title='sldns_buffer_limit' data-ref="sldns_buffer_limit" data-ref-filename="sldns_buffer_limit">sldns_buffer_limit</a>(<a class="local col4 ref" href="#1264c" title='c' data-ref="1264c" data-ref-filename="1264c">c</a>-&gt;<a class="ref field" href="../util/netevent.h.html#comm_point::buffer" title='comm_point::buffer' data-ref="comm_point::buffer" data-ref-filename="comm_point..buffer">buffer</a>));</td></tr>
<tr><th id="5739">5739</th><td>		<b>if</b>(!<a class="tu ref fn" href="#xfer_link_data" title='xfer_link_data' data-use='c' data-ref="xfer_link_data" data-ref-filename="xfer_link_data">xfer_link_data</a>(<a class="local col4 ref" href="#1264c" title='c' data-ref="1264c" data-ref-filename="1264c">c</a>-&gt;<a class="ref field" href="../util/netevent.h.html#comm_point::buffer" title='comm_point::buffer' data-ref="comm_point::buffer" data-ref-filename="comm_point..buffer">buffer</a>, <a class="local col8 ref" href="#1268xfr" title='xfr' data-ref="1268xfr" data-ref-filename="1268xfr">xfr</a>)) {</td></tr>
<tr><th id="5740">5740</th><td>			<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"http stopped to %s, malloc failed"</q>,</td></tr>
<tr><th id="5741">5741</th><td>				<a class="local col8 ref" href="#1268xfr" title='xfr' data-ref="1268xfr" data-ref-filename="1268xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::master" title='auth_transfer::master' data-ref="auth_transfer::master" data-ref-filename="auth_transfer..master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5742">5742</th><td>			<b>goto</b> <a class="lbl" href="#1270failed" data-ref="1270failed" data-ref-filename="1270failed">failed</a>;</td></tr>
<tr><th id="5743">5743</th><td>		}</td></tr>
<tr><th id="5744">5744</th><td>	}</td></tr>
<tr><th id="5745">5745</th><td>	<i>/* if the transfer is done now, disconnect and process the list */</i></td></tr>
<tr><th id="5746">5746</th><td>	<b>if</b>(<a class="local col6 ref" href="#1266err" title='err' data-ref="1266err" data-ref-filename="1266err">err</a> == <a class="macro" href="../util/netevent.h.html#89" title="-4" data-ref="_M/NETEVENT_DONE">NETEVENT_DONE</a>) {</td></tr>
<tr><th id="5747">5747</th><td>		<b>if</b>(<a class="local col7 ref" href="#1267repinfo" title='repinfo' data-ref="1267repinfo" data-ref-filename="1267repinfo">repinfo</a>) <a class="local col7 ref" href="#1267repinfo" title='repinfo' data-ref="1267repinfo" data-ref-filename="1267repinfo">repinfo</a>-&gt;<a class="ref field" href="../util/netevent.h.html#comm_reply::c" title='comm_reply::c' data-ref="comm_reply::c" data-ref-filename="comm_reply..c">c</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>; <i>/* signal cp deleted to</i></td></tr>
<tr><th id="5748">5748</th><td><i>				the routine calling this callback */</i></td></tr>
<tr><th id="5749">5749</th><td>		<a class="ref fn" href="../util/netevent.h.html#comm_point_delete" title='comm_point_delete' data-ref="comm_point_delete" data-ref-filename="comm_point_delete">comm_point_delete</a>(<a class="local col8 ref" href="#1268xfr" title='xfr' data-ref="1268xfr" data-ref-filename="1268xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::cp" title='auth_transfer::cp' data-ref="auth_transfer::cp" data-ref-filename="auth_transfer..cp">cp</a>);</td></tr>
<tr><th id="5750">5750</th><td>		<a class="local col8 ref" href="#1268xfr" title='xfr' data-ref="1268xfr" data-ref-filename="1268xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::cp" title='auth_transfer::cp' data-ref="auth_transfer::cp" data-ref-filename="auth_transfer..cp">cp</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="5751">5751</th><td>		<a class="tu ref fn" href="#process_list_end_transfer" title='process_list_end_transfer' data-use='c' data-ref="process_list_end_transfer" data-ref-filename="process_list_end_transfer">process_list_end_transfer</a>(<a class="local col8 ref" href="#1268xfr" title='xfr' data-ref="1268xfr" data-ref-filename="1268xfr">xfr</a>, <a class="local col9 ref" href="#1269env" title='env' data-ref="1269env" data-ref-filename="1269env">env</a>);</td></tr>
<tr><th id="5752">5752</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5753">5753</th><td>	}</td></tr>
<tr><th id="5754">5754</th><td></td></tr>
<tr><th id="5755">5755</th><td>	<i>/* if we want to read more messages, setup the commpoint to read</i></td></tr>
<tr><th id="5756">5756</th><td><i>	 * a DNS packet, and the timeout */</i></td></tr>
<tr><th id="5757">5757</th><td>	<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 5757, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col8 ref" href="#1268xfr" title='xfr' data-ref="1268xfr" data-ref-filename="1268xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="5758">5758</th><td>	<a class="local col4 ref" href="#1264c" title='c' data-ref="1264c" data-ref-filename="1264c">c</a>-&gt;<a class="ref field" href="../util/netevent.h.html#comm_point::tcp_is_reading" title='comm_point::tcp_is_reading' data-ref="comm_point::tcp_is_reading" data-ref-filename="comm_point..tcp_is_reading">tcp_is_reading</a> = <var>1</var>;</td></tr>
<tr><th id="5759">5759</th><td>	<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_clear" title='sldns_buffer_clear' data-ref="sldns_buffer_clear" data-ref-filename="sldns_buffer_clear">sldns_buffer_clear</a>(<a class="local col4 ref" href="#1264c" title='c' data-ref="1264c" data-ref-filename="1264c">c</a>-&gt;<a class="ref field" href="../util/netevent.h.html#comm_point::buffer" title='comm_point::buffer' data-ref="comm_point::buffer" data-ref-filename="comm_point..buffer">buffer</a>);</td></tr>
<tr><th id="5760">5760</th><td>	<a class="ref fn" href="../util/netevent.h.html#comm_point_start_listening" title='comm_point_start_listening' data-ref="comm_point_start_listening" data-ref-filename="comm_point_start_listening">comm_point_start_listening</a>(<a class="local col4 ref" href="#1264c" title='c' data-ref="1264c" data-ref-filename="1264c">c</a>, -<var>1</var>, <a class="macro" href="#82" title="10000" data-ref="_M/AUTH_TRANSFER_TIMEOUT">AUTH_TRANSFER_TIMEOUT</a>);</td></tr>
<tr><th id="5761">5761</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5762">5762</th><td>}</td></tr>
<tr><th id="5763">5763</th><td></td></tr>
<tr><th id="5764">5764</th><td></td></tr>
<tr><th id="5765">5765</th><td><i class="doc" data-doc="xfr_start_transfer">/** start transfer task by this worker , xfr is locked. */</i></td></tr>
<tr><th id="5766">5766</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="5767">5767</th><td><dfn class="tu decl def fn" id="xfr_start_transfer" title='xfr_start_transfer' data-type='void xfr_start_transfer(struct auth_xfer * xfr, struct module_env * env, struct auth_master * master)' data-ref="xfr_start_transfer" data-ref-filename="xfr_start_transfer">xfr_start_transfer</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col1 decl" id="1271xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1271xfr" data-ref-filename="1271xfr">xfr</dfn>, <b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col2 decl" id="1272env" title='env' data-type='struct module_env *' data-ref="1272env" data-ref-filename="1272env">env</dfn>,</td></tr>
<tr><th id="5768">5768</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>* <dfn class="local col3 decl" id="1273master" title='master' data-type='struct auth_master *' data-ref="1273master" data-ref-filename="1273master">master</dfn>)</td></tr>
<tr><th id="5769">5769</th><td>{</td></tr>
<tr><th id="5770">5770</th><td>	<a class="macro" href="../util/log.h.html#211" title="" data-ref="_M/log_assert">log_assert</a>(xfr-&gt;task_transfer != NULL);</td></tr>
<tr><th id="5771">5771</th><td>	<a class="macro" href="../util/log.h.html#211" title="" data-ref="_M/log_assert">log_assert</a>(xfr-&gt;task_transfer-&gt;worker == NULL);</td></tr>
<tr><th id="5772">5772</th><td>	<a class="macro" href="../util/log.h.html#211" title="" data-ref="_M/log_assert">log_assert</a>(xfr-&gt;task_transfer-&gt;chunks_first == NULL);</td></tr>
<tr><th id="5773">5773</th><td>	<a class="macro" href="../util/log.h.html#211" title="" data-ref="_M/log_assert">log_assert</a>(xfr-&gt;task_transfer-&gt;chunks_last == NULL);</td></tr>
<tr><th id="5774">5774</th><td>	<a class="local col1 ref" href="#1271xfr" title='xfr' data-ref="1271xfr" data-ref-filename="1271xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::worker" title='auth_transfer::worker' data-ref="auth_transfer::worker" data-ref-filename="auth_transfer..worker">worker</a> = <a class="local col2 ref" href="#1272env" title='env' data-ref="1272env" data-ref-filename="1272env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::worker" title='module_env::worker' data-ref="module_env::worker" data-ref-filename="module_env..worker">worker</a>;</td></tr>
<tr><th id="5775">5775</th><td>	<a class="local col1 ref" href="#1271xfr" title='xfr' data-ref="1271xfr" data-ref-filename="1271xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::env" title='auth_transfer::env' data-ref="auth_transfer::env" data-ref-filename="auth_transfer..env">env</a> = <a class="local col2 ref" href="#1272env" title='env' data-ref="1272env" data-ref-filename="1272env">env</a>;</td></tr>
<tr><th id="5776">5776</th><td></td></tr>
<tr><th id="5777">5777</th><td>	<i>/* init transfer process */</i></td></tr>
<tr><th id="5778">5778</th><td>	<i>/* find that master in the transfer's list of masters? */</i></td></tr>
<tr><th id="5779">5779</th><td>	<a class="tu ref fn" href="#xfr_transfer_start_list" title='xfr_transfer_start_list' data-use='c' data-ref="xfr_transfer_start_list" data-ref-filename="xfr_transfer_start_list">xfr_transfer_start_list</a>(<a class="local col1 ref" href="#1271xfr" title='xfr' data-ref="1271xfr" data-ref-filename="1271xfr">xfr</a>, <a class="local col3 ref" href="#1273master" title='master' data-ref="1273master" data-ref-filename="1273master">master</a>);</td></tr>
<tr><th id="5780">5780</th><td>	<i>/* start lookup for hostnames in transfer master list */</i></td></tr>
<tr><th id="5781">5781</th><td>	<a class="tu ref fn" href="#xfr_transfer_start_lookups" title='xfr_transfer_start_lookups' data-use='c' data-ref="xfr_transfer_start_lookups" data-ref-filename="xfr_transfer_start_lookups">xfr_transfer_start_lookups</a>(<a class="local col1 ref" href="#1271xfr" title='xfr' data-ref="1271xfr" data-ref-filename="1271xfr">xfr</a>);</td></tr>
<tr><th id="5782">5782</th><td></td></tr>
<tr><th id="5783">5783</th><td>	<i>/* initiate TCP, and set timeout on it */</i></td></tr>
<tr><th id="5784">5784</th><td>	<a class="tu ref fn" href="#xfr_transfer_nexttarget_or_end" title='xfr_transfer_nexttarget_or_end' data-use='c' data-ref="xfr_transfer_nexttarget_or_end" data-ref-filename="xfr_transfer_nexttarget_or_end">xfr_transfer_nexttarget_or_end</a>(<a class="local col1 ref" href="#1271xfr" title='xfr' data-ref="1271xfr" data-ref-filename="1271xfr">xfr</a>, <a class="local col2 ref" href="#1272env" title='env' data-ref="1272env" data-ref-filename="1272env">env</a>);</td></tr>
<tr><th id="5785">5785</th><td>}</td></tr>
<tr><th id="5786">5786</th><td></td></tr>
<tr><th id="5787">5787</th><td><i class="doc" data-doc="xfr_probe_disown">/** disown task_probe.  caller must hold xfr.lock */</i></td></tr>
<tr><th id="5788">5788</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="5789">5789</th><td><dfn class="tu decl def fn" id="xfr_probe_disown" title='xfr_probe_disown' data-type='void xfr_probe_disown(struct auth_xfer * xfr)' data-ref="xfr_probe_disown" data-ref-filename="xfr_probe_disown">xfr_probe_disown</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col4 decl" id="1274xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1274xfr" data-ref-filename="1274xfr">xfr</dfn>)</td></tr>
<tr><th id="5790">5790</th><td>{</td></tr>
<tr><th id="5791">5791</th><td>	<i>/* remove timer (from this worker's event base) */</i></td></tr>
<tr><th id="5792">5792</th><td>	<a class="ref fn" href="../util/netevent.h.html#comm_timer_delete" title='comm_timer_delete' data-ref="comm_timer_delete" data-ref-filename="comm_timer_delete">comm_timer_delete</a>(<a class="local col4 ref" href="#1274xfr" title='xfr' data-ref="1274xfr" data-ref-filename="1274xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::timer" title='auth_probe::timer' data-ref="auth_probe::timer" data-ref-filename="auth_probe..timer">timer</a>);</td></tr>
<tr><th id="5793">5793</th><td>	<a class="local col4 ref" href="#1274xfr" title='xfr' data-ref="1274xfr" data-ref-filename="1274xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::timer" title='auth_probe::timer' data-ref="auth_probe::timer" data-ref-filename="auth_probe..timer">timer</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="5794">5794</th><td>	<i>/* remove the commpoint */</i></td></tr>
<tr><th id="5795">5795</th><td>	<a class="ref fn" href="../util/netevent.h.html#comm_point_delete" title='comm_point_delete' data-ref="comm_point_delete" data-ref-filename="comm_point_delete">comm_point_delete</a>(<a class="local col4 ref" href="#1274xfr" title='xfr' data-ref="1274xfr" data-ref-filename="1274xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::cp" title='auth_probe::cp' data-ref="auth_probe::cp" data-ref-filename="auth_probe..cp">cp</a>);</td></tr>
<tr><th id="5796">5796</th><td>	<a class="local col4 ref" href="#1274xfr" title='xfr' data-ref="1274xfr" data-ref-filename="1274xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::cp" title='auth_probe::cp' data-ref="auth_probe::cp" data-ref-filename="auth_probe..cp">cp</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="5797">5797</th><td>	<i>/* we don't own this item anymore */</i></td></tr>
<tr><th id="5798">5798</th><td>	<a class="local col4 ref" href="#1274xfr" title='xfr' data-ref="1274xfr" data-ref-filename="1274xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::worker" title='auth_probe::worker' data-ref="auth_probe::worker" data-ref-filename="auth_probe..worker">worker</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="5799">5799</th><td>	<a class="local col4 ref" href="#1274xfr" title='xfr' data-ref="1274xfr" data-ref-filename="1274xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::env" title='auth_probe::env' data-ref="auth_probe::env" data-ref-filename="auth_probe..env">env</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="5800">5800</th><td>}</td></tr>
<tr><th id="5801">5801</th><td></td></tr>
<tr><th id="5802">5802</th><td><i class="doc" data-doc="xfr_probe_send_probe">/** send the UDP probe to the master, this is part of task_probe */</i></td></tr>
<tr><th id="5803">5803</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="5804">5804</th><td><dfn class="tu decl def fn" id="xfr_probe_send_probe" title='xfr_probe_send_probe' data-type='int xfr_probe_send_probe(struct auth_xfer * xfr, struct module_env * env, int timeout)' data-ref="xfr_probe_send_probe" data-ref-filename="xfr_probe_send_probe">xfr_probe_send_probe</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col5 decl" id="1275xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1275xfr" data-ref-filename="1275xfr">xfr</dfn>, <b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col6 decl" id="1276env" title='env' data-type='struct module_env *' data-ref="1276env" data-ref-filename="1276env">env</dfn>,</td></tr>
<tr><th id="5805">5805</th><td>	<em>int</em> <dfn class="local col7 decl" id="1277timeout" title='timeout' data-type='int' data-ref="1277timeout" data-ref-filename="1277timeout">timeout</dfn>)</td></tr>
<tr><th id="5806">5806</th><td>{</td></tr>
<tr><th id="5807">5807</th><td>	<b>struct</b> <a class="type" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#sockaddr_storage" title='sockaddr_storage' data-ref="sockaddr_storage" data-ref-filename="sockaddr_storage">sockaddr_storage</a> <dfn class="local col8 decl" id="1278addr" title='addr' data-type='struct sockaddr_storage' data-ref="1278addr" data-ref-filename="1278addr">addr</dfn>;</td></tr>
<tr><th id="5808">5808</th><td>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#84" title="__socklen_t" data-ref="_M/socklen_t">socklen_t</a> <dfn class="local col9 decl" id="1279addrlen" title='addrlen' data-type='__socklen_t' data-ref="1279addrlen" data-ref-filename="1279addrlen">addrlen</dfn> = <var>0</var>;</td></tr>
<tr><th id="5809">5809</th><td>	<b>struct</b> <a class="type" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/time.h.html#timeval" title='timeval' data-ref="timeval" data-ref-filename="timeval">timeval</a> <dfn class="local col0 decl" id="1280t" title='t' data-type='struct timeval' data-ref="1280t" data-ref-filename="1280t">t</dfn>;</td></tr>
<tr><th id="5810">5810</th><td>	<i>/* pick master */</i></td></tr>
<tr><th id="5811">5811</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>* <dfn class="local col1 decl" id="1281master" title='master' data-type='struct auth_master *' data-ref="1281master" data-ref-filename="1281master">master</dfn> = <a class="tu ref fn" href="#xfr_probe_current_master" title='xfr_probe_current_master' data-use='c' data-ref="xfr_probe_current_master" data-ref-filename="xfr_probe_current_master">xfr_probe_current_master</a>(<a class="local col5 ref" href="#1275xfr" title='xfr' data-ref="1275xfr" data-ref-filename="1275xfr">xfr</a>);</td></tr>
<tr><th id="5812">5812</th><td>	<b>if</b>(!<a class="local col1 ref" href="#1281master" title='master' data-ref="1281master" data-ref-filename="1281master">master</a>) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="5813">5813</th><td>	<b>if</b>(<a class="local col1 ref" href="#1281master" title='master' data-ref="1281master" data-ref-filename="1281master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::allow_notify" title='auth_master::allow_notify' data-ref="auth_master::allow_notify" data-ref-filename="auth_master..allow_notify">allow_notify</a>) <b>return</b> <var>0</var>; <i>/* only for notify */</i></td></tr>
<tr><th id="5814">5814</th><td>	<b>if</b>(<a class="local col1 ref" href="#1281master" title='master' data-ref="1281master" data-ref-filename="1281master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::http" title='auth_master::http' data-ref="auth_master::http" data-ref-filename="auth_master..http">http</a>) <b>return</b> <var>0</var>; <i>/* only masters get SOA UDP probe,</i></td></tr>
<tr><th id="5815">5815</th><td><i>		not urls, if those are in this list */</i></td></tr>
<tr><th id="5816">5816</th><td></td></tr>
<tr><th id="5817">5817</th><td>	<i>/* get master addr */</i></td></tr>
<tr><th id="5818">5818</th><td>	<b>if</b>(<a class="local col5 ref" href="#1275xfr" title='xfr' data-ref="1275xfr" data-ref-filename="1275xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_addr" title='auth_probe::scan_addr' data-ref="auth_probe::scan_addr" data-ref-filename="auth_probe..scan_addr">scan_addr</a>) {</td></tr>
<tr><th id="5819">5819</th><td>		<a class="local col9 ref" href="#1279addrlen" title='addrlen' data-ref="1279addrlen" data-ref-filename="1279addrlen">addrlen</a> = <a class="local col5 ref" href="#1275xfr" title='xfr' data-ref="1275xfr" data-ref-filename="1275xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_addr" title='auth_probe::scan_addr' data-ref="auth_probe::scan_addr" data-ref-filename="auth_probe..scan_addr">scan_addr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_addr::addrlen" title='auth_addr::addrlen' data-ref="auth_addr::addrlen" data-ref-filename="auth_addr..addrlen">addrlen</a>;</td></tr>
<tr><th id="5820">5820</th><td>		<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(&amp;addr, 0) != (size_t)-1) ? __builtin___memmove_chk(&amp;addr, &amp;xfr-&gt;task_probe-&gt;scan_addr-&gt;addr, addrlen, __builtin_object_size(&amp;addr, 0)) : __memmove_ichk(&amp;addr, &amp;xfr-&gt;task_probe-&gt;scan_addr-&gt;addr, addrlen))" data-ref="_M/memmove">memmove</a>(&amp;<a class="local col8 ref" href="#1278addr" title='addr' data-ref="1278addr" data-ref-filename="1278addr">addr</a>, &amp;<a class="local col5 ref" href="#1275xfr" title='xfr' data-ref="1275xfr" data-ref-filename="1275xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_addr" title='auth_probe::scan_addr' data-ref="auth_probe::scan_addr" data-ref-filename="auth_probe..scan_addr">scan_addr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_addr::addr" title='auth_addr::addr' data-ref="auth_addr::addr" data-ref-filename="auth_addr..addr">addr</a>, <a class="local col9 ref" href="#1279addrlen" title='addrlen' data-ref="1279addrlen" data-ref-filename="1279addrlen">addrlen</a>);</td></tr>
<tr><th id="5821">5821</th><td>	} <b>else</b> {</td></tr>
<tr><th id="5822">5822</th><td>		<b>if</b>(!<a class="ref fn" href="../util/net_help.h.html#extstrtoaddr" title='extstrtoaddr' data-ref="extstrtoaddr" data-ref-filename="extstrtoaddr">extstrtoaddr</a>(<a class="local col1 ref" href="#1281master" title='master' data-ref="1281master" data-ref-filename="1281master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>, &amp;<a class="local col8 ref" href="#1278addr" title='addr' data-ref="1278addr" data-ref-filename="1278addr">addr</a>, &amp;<a class="local col9 ref" href="#1279addrlen" title='addrlen' data-ref="1279addrlen" data-ref-filename="1279addrlen">addrlen</a>)) {</td></tr>
<tr><th id="5823">5823</th><td>			<i>/* the ones that are not in addr format are supposed</i></td></tr>
<tr><th id="5824">5824</th><td><i>			 * to be looked up.  The lookup has failed however,</i></td></tr>
<tr><th id="5825">5825</th><td><i>			 * so skip them */</i></td></tr>
<tr><th id="5826">5826</th><td>			<em>char</em> <dfn class="local col2 decl" id="1282zname" title='zname' data-type='char [256]' data-ref="1282zname" data-ref-filename="1282zname">zname</dfn>[<var>255</var>+<var>1</var>];</td></tr>
<tr><th id="5827">5827</th><td>			<a class="ref fn" href="../util/data/dname.h.html#dname_str" title='dname_str' data-ref="dname_str" data-ref-filename="dname_str">dname_str</a>(<a class="local col5 ref" href="#1275xfr" title='xfr' data-ref="1275xfr" data-ref-filename="1275xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a>, <a class="local col2 ref" href="#1282zname" title='zname' data-ref="1282zname" data-ref-filename="1282zname">zname</a>);</td></tr>
<tr><th id="5828">5828</th><td>			<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"%s: failed lookup, cannot probe to master %s"</q>,</td></tr>
<tr><th id="5829">5829</th><td>				<a class="local col2 ref" href="#1282zname" title='zname' data-ref="1282zname" data-ref-filename="1282zname">zname</a>, <a class="local col1 ref" href="#1281master" title='master' data-ref="1281master" data-ref-filename="1281master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5830">5830</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5831">5831</th><td>		}</td></tr>
<tr><th id="5832">5832</th><td>	}</td></tr>
<tr><th id="5833">5833</th><td></td></tr>
<tr><th id="5834">5834</th><td>	<i>/* create packet */</i></td></tr>
<tr><th id="5835">5835</th><td>	<i>/* create new ID for new probes, but not on timeout retries,</i></td></tr>
<tr><th id="5836">5836</th><td><i>	 * this means we'll accept replies to previous retries to same ip */</i></td></tr>
<tr><th id="5837">5837</th><td>	<b>if</b>(<a class="local col7 ref" href="#1277timeout" title='timeout' data-ref="1277timeout" data-ref-filename="1277timeout">timeout</a> == <a class="macro" href="#78" title="100" data-ref="_M/AUTH_PROBE_TIMEOUT">AUTH_PROBE_TIMEOUT</a>)</td></tr>
<tr><th id="5838">5838</th><td>		<a class="local col5 ref" href="#1275xfr" title='xfr' data-ref="1275xfr" data-ref-filename="1275xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::id" title='auth_probe::id' data-ref="auth_probe::id" data-ref-filename="auth_probe..id">id</a> = (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a>)(<a class="ref fn" href="../util/random.h.html#ub_random" title='ub_random' data-ref="ub_random" data-ref-filename="ub_random">ub_random</a>(<a class="local col6 ref" href="#1276env" title='env' data-ref="1276env" data-ref-filename="1276env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::rnd" title='module_env::rnd' data-ref="module_env::rnd" data-ref-filename="module_env..rnd">rnd</a>)&amp;<var>0xffff</var>);</td></tr>
<tr><th id="5839">5839</th><td>	<a class="tu ref fn" href="#xfr_create_soa_probe_packet" title='xfr_create_soa_probe_packet' data-use='c' data-ref="xfr_create_soa_probe_packet" data-ref-filename="xfr_create_soa_probe_packet">xfr_create_soa_probe_packet</a>(<a class="local col5 ref" href="#1275xfr" title='xfr' data-ref="1275xfr" data-ref-filename="1275xfr">xfr</a>, <a class="local col6 ref" href="#1276env" title='env' data-ref="1276env" data-ref-filename="1276env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::scratch_buffer" title='module_env::scratch_buffer' data-ref="module_env::scratch_buffer" data-ref-filename="module_env..scratch_buffer">scratch_buffer</a>, </td></tr>
<tr><th id="5840">5840</th><td>		<a class="local col5 ref" href="#1275xfr" title='xfr' data-ref="1275xfr" data-ref-filename="1275xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::id" title='auth_probe::id' data-ref="auth_probe::id" data-ref-filename="auth_probe..id">id</a>);</td></tr>
<tr><th id="5841">5841</th><td>	<b>if</b>(!<a class="local col5 ref" href="#1275xfr" title='xfr' data-ref="1275xfr" data-ref-filename="1275xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::cp" title='auth_probe::cp' data-ref="auth_probe::cp" data-ref-filename="auth_probe..cp">cp</a>) {</td></tr>
<tr><th id="5842">5842</th><td>		<a class="local col5 ref" href="#1275xfr" title='xfr' data-ref="1275xfr" data-ref-filename="1275xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::cp" title='auth_probe::cp' data-ref="auth_probe::cp" data-ref-filename="auth_probe..cp">cp</a> = <a class="ref fn" href="outside_network.h.html#outnet_comm_point_for_udp" title='outnet_comm_point_for_udp' data-ref="outnet_comm_point_for_udp" data-ref-filename="outnet_comm_point_for_udp">outnet_comm_point_for_udp</a>(<a class="local col6 ref" href="#1276env" title='env' data-ref="1276env" data-ref-filename="1276env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::outnet" title='module_env::outnet' data-ref="module_env::outnet" data-ref-filename="module_env..outnet">outnet</a>,</td></tr>
<tr><th id="5843">5843</th><td>			<a class="ref fn" href="#auth_xfer_probe_udp_callback" title='auth_xfer_probe_udp_callback' data-ref="auth_xfer_probe_udp_callback" data-ref-filename="auth_xfer_probe_udp_callback">auth_xfer_probe_udp_callback</a>, <a class="local col5 ref" href="#1275xfr" title='xfr' data-ref="1275xfr" data-ref-filename="1275xfr">xfr</a>, &amp;<a class="local col8 ref" href="#1278addr" title='addr' data-ref="1278addr" data-ref-filename="1278addr">addr</a>, <a class="local col9 ref" href="#1279addrlen" title='addrlen' data-ref="1279addrlen" data-ref-filename="1279addrlen">addrlen</a>);</td></tr>
<tr><th id="5844">5844</th><td>		<b>if</b>(!<a class="local col5 ref" href="#1275xfr" title='xfr' data-ref="1275xfr" data-ref-filename="1275xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::cp" title='auth_probe::cp' data-ref="auth_probe::cp" data-ref-filename="auth_probe..cp">cp</a>) {</td></tr>
<tr><th id="5845">5845</th><td>			<em>char</em> <dfn class="local col3 decl" id="1283zname" title='zname' data-type='char [256]' data-ref="1283zname" data-ref-filename="1283zname">zname</dfn>[<var>255</var>+<var>1</var>];</td></tr>
<tr><th id="5846">5846</th><td>			<a class="ref fn" href="../util/data/dname.h.html#dname_str" title='dname_str' data-ref="dname_str" data-ref-filename="dname_str">dname_str</a>(<a class="local col5 ref" href="#1275xfr" title='xfr' data-ref="1275xfr" data-ref-filename="1275xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a>, <a class="local col3 ref" href="#1283zname" title='zname' data-ref="1283zname" data-ref-filename="1283zname">zname</a>);</td></tr>
<tr><th id="5847">5847</th><td>			<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"cannot create udp cp for "</q></td></tr>
<tr><th id="5848">5848</th><td>				<q>"probe %s to %s"</q>, <a class="local col3 ref" href="#1283zname" title='zname' data-ref="1283zname" data-ref-filename="1283zname">zname</a>, <a class="local col1 ref" href="#1281master" title='master' data-ref="1281master" data-ref-filename="1281master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5849">5849</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5850">5850</th><td>		}</td></tr>
<tr><th id="5851">5851</th><td>	}</td></tr>
<tr><th id="5852">5852</th><td>	<b>if</b>(!<a class="local col5 ref" href="#1275xfr" title='xfr' data-ref="1275xfr" data-ref-filename="1275xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::timer" title='auth_probe::timer' data-ref="auth_probe::timer" data-ref-filename="auth_probe..timer">timer</a>) {</td></tr>
<tr><th id="5853">5853</th><td>		<a class="local col5 ref" href="#1275xfr" title='xfr' data-ref="1275xfr" data-ref-filename="1275xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::timer" title='auth_probe::timer' data-ref="auth_probe::timer" data-ref-filename="auth_probe..timer">timer</a> = <a class="ref fn" href="../util/netevent.h.html#comm_timer_create" title='comm_timer_create' data-ref="comm_timer_create" data-ref-filename="comm_timer_create">comm_timer_create</a>(<a class="local col6 ref" href="#1276env" title='env' data-ref="1276env" data-ref-filename="1276env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::worker_base" title='module_env::worker_base' data-ref="module_env::worker_base" data-ref-filename="module_env..worker_base">worker_base</a>,</td></tr>
<tr><th id="5854">5854</th><td>			<a class="ref fn" href="#auth_xfer_probe_timer_callback" title='auth_xfer_probe_timer_callback' data-ref="auth_xfer_probe_timer_callback" data-ref-filename="auth_xfer_probe_timer_callback">auth_xfer_probe_timer_callback</a>, <a class="local col5 ref" href="#1275xfr" title='xfr' data-ref="1275xfr" data-ref-filename="1275xfr">xfr</a>);</td></tr>
<tr><th id="5855">5855</th><td>		<b>if</b>(!<a class="local col5 ref" href="#1275xfr" title='xfr' data-ref="1275xfr" data-ref-filename="1275xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::timer" title='auth_probe::timer' data-ref="auth_probe::timer" data-ref-filename="auth_probe..timer">timer</a>) {</td></tr>
<tr><th id="5856">5856</th><td>			<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"malloc failure"</q>);</td></tr>
<tr><th id="5857">5857</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5858">5858</th><td>		}</td></tr>
<tr><th id="5859">5859</th><td>	}</td></tr>
<tr><th id="5860">5860</th><td></td></tr>
<tr><th id="5861">5861</th><td>	<i>/* send udp packet */</i></td></tr>
<tr><th id="5862">5862</th><td>	<b>if</b>(!<a class="ref fn" href="../util/netevent.h.html#comm_point_send_udp_msg" title='comm_point_send_udp_msg' data-ref="comm_point_send_udp_msg" data-ref-filename="comm_point_send_udp_msg">comm_point_send_udp_msg</a>(<a class="local col5 ref" href="#1275xfr" title='xfr' data-ref="1275xfr" data-ref-filename="1275xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::cp" title='auth_probe::cp' data-ref="auth_probe::cp" data-ref-filename="auth_probe..cp">cp</a>, <a class="local col6 ref" href="#1276env" title='env' data-ref="1276env" data-ref-filename="1276env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::scratch_buffer" title='module_env::scratch_buffer' data-ref="module_env::scratch_buffer" data-ref-filename="module_env..scratch_buffer">scratch_buffer</a>,</td></tr>
<tr><th id="5863">5863</th><td>		(<b>struct</b> <a class="type" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#sockaddr" title='sockaddr' data-ref="sockaddr" data-ref-filename="sockaddr">sockaddr</a>*)&amp;<a class="local col8 ref" href="#1278addr" title='addr' data-ref="1278addr" data-ref-filename="1278addr">addr</a>, <a class="local col9 ref" href="#1279addrlen" title='addrlen' data-ref="1279addrlen" data-ref-filename="1279addrlen">addrlen</a>)) {</td></tr>
<tr><th id="5864">5864</th><td>		<em>char</em> <dfn class="local col4 decl" id="1284zname" title='zname' data-type='char [256]' data-ref="1284zname" data-ref-filename="1284zname">zname</dfn>[<var>255</var>+<var>1</var>];</td></tr>
<tr><th id="5865">5865</th><td>		<a class="ref fn" href="../util/data/dname.h.html#dname_str" title='dname_str' data-ref="dname_str" data-ref-filename="dname_str">dname_str</a>(<a class="local col5 ref" href="#1275xfr" title='xfr' data-ref="1275xfr" data-ref-filename="1275xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a>, <a class="local col4 ref" href="#1284zname" title='zname' data-ref="1284zname" data-ref-filename="1284zname">zname</a>);</td></tr>
<tr><th id="5866">5866</th><td>		<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"failed to send soa probe for %s to %s"</q>,</td></tr>
<tr><th id="5867">5867</th><td>			<a class="local col4 ref" href="#1284zname" title='zname' data-ref="1284zname" data-ref-filename="1284zname">zname</a>, <a class="local col1 ref" href="#1281master" title='master' data-ref="1281master" data-ref-filename="1281master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="5868">5868</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5869">5869</th><td>	}</td></tr>
<tr><th id="5870">5870</th><td>	<a class="local col5 ref" href="#1275xfr" title='xfr' data-ref="1275xfr" data-ref-filename="1275xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::timeout" title='auth_probe::timeout' data-ref="auth_probe::timeout" data-ref-filename="auth_probe..timeout">timeout</a> = <a class="local col7 ref" href="#1277timeout" title='timeout' data-ref="1277timeout" data-ref-filename="1277timeout">timeout</a>;</td></tr>
<tr><th id="5871">5871</th><td><u>#<span data-ppcond="5871">ifndef</span> <span class="macro" data-ref="_M/S_SPLINT_S">S_SPLINT_S</span></u></td></tr>
<tr><th id="5872">5872</th><td>	<a class="local col0 ref" href="#1280t" title='t' data-ref="1280t" data-ref-filename="1280t">t</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/time.h.html#timeval::tv_sec" title='timeval::tv_sec' data-ref="timeval::tv_sec" data-ref-filename="timeval..tv_sec">tv_sec</a> = <a class="local col7 ref" href="#1277timeout" title='timeout' data-ref="1277timeout" data-ref-filename="1277timeout">timeout</a>/<var>1000</var>;</td></tr>
<tr><th id="5873">5873</th><td>	<a class="local col0 ref" href="#1280t" title='t' data-ref="1280t" data-ref-filename="1280t">t</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/time.h.html#timeval::tv_usec" title='timeval::tv_usec' data-ref="timeval::tv_usec" data-ref-filename="timeval..tv_usec">tv_usec</a> = (<a class="local col7 ref" href="#1277timeout" title='timeout' data-ref="1277timeout" data-ref-filename="1277timeout">timeout</a>%<var>1000</var>)*<var>1000</var>;</td></tr>
<tr><th id="5874">5874</th><td><u>#<span data-ppcond="5871">endif</span></u></td></tr>
<tr><th id="5875">5875</th><td>	<a class="ref fn" href="../util/netevent.h.html#comm_timer_set" title='comm_timer_set' data-ref="comm_timer_set" data-ref-filename="comm_timer_set">comm_timer_set</a>(<a class="local col5 ref" href="#1275xfr" title='xfr' data-ref="1275xfr" data-ref-filename="1275xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::timer" title='auth_probe::timer' data-ref="auth_probe::timer" data-ref-filename="auth_probe..timer">timer</a>, &amp;<a class="local col0 ref" href="#1280t" title='t' data-ref="1280t" data-ref-filename="1280t">t</a>);</td></tr>
<tr><th id="5876">5876</th><td></td></tr>
<tr><th id="5877">5877</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="5878">5878</th><td>}</td></tr>
<tr><th id="5879">5879</th><td></td></tr>
<tr><th id="5880">5880</th><td><i class="doc">/** callback for task_probe timer */</i></td></tr>
<tr><th id="5881">5881</th><td><em>void</em></td></tr>
<tr><th id="5882">5882</th><td><dfn class="decl def fn" id="auth_xfer_probe_timer_callback" title='auth_xfer_probe_timer_callback' data-ref="auth_xfer_probe_timer_callback" data-ref-filename="auth_xfer_probe_timer_callback">auth_xfer_probe_timer_callback</dfn>(<em>void</em>* <dfn class="local col5 decl" id="1285arg" title='arg' data-type='void *' data-ref="1285arg" data-ref-filename="1285arg">arg</dfn>)</td></tr>
<tr><th id="5883">5883</th><td>{</td></tr>
<tr><th id="5884">5884</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col6 decl" id="1286xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1286xfr" data-ref-filename="1286xfr">xfr</dfn> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>*)<a class="local col5 ref" href="#1285arg" title='arg' data-ref="1285arg" data-ref-filename="1285arg">arg</a>;</td></tr>
<tr><th id="5885">5885</th><td>	<b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col7 decl" id="1287env" title='env' data-type='struct module_env *' data-ref="1287env" data-ref-filename="1287env">env</dfn>;</td></tr>
<tr><th id="5886">5886</th><td>	<a class="macro" href="../util/log.h.html#211" title="" data-ref="_M/log_assert">log_assert</a>(xfr-&gt;task_probe);</td></tr>
<tr><th id="5887">5887</th><td>	<a class="macro" href="../util/locks.h.html#102" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_lock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_lock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 5887, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_lock">lock_basic_lock</a>(&amp;<a class="local col6 ref" href="#1286xfr" title='xfr' data-ref="1286xfr" data-ref-filename="1286xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="5888">5888</th><td>	<a class="local col7 ref" href="#1287env" title='env' data-ref="1287env" data-ref-filename="1287env">env</a> = <a class="local col6 ref" href="#1286xfr" title='xfr' data-ref="1286xfr" data-ref-filename="1286xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::env" title='auth_probe::env' data-ref="auth_probe::env" data-ref-filename="auth_probe..env">env</a>;</td></tr>
<tr><th id="5889">5889</th><td>	<b>if</b>(<a class="local col7 ref" href="#1287env" title='env' data-ref="1287env" data-ref-filename="1287env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::outnet" title='module_env::outnet' data-ref="module_env::outnet" data-ref-filename="module_env..outnet">outnet</a>-&gt;<a class="ref field" href="outside_network.h.html#outside_network::want_to_quit" title='outside_network::want_to_quit' data-ref="outside_network::want_to_quit" data-ref-filename="outside_network..want_to_quit">want_to_quit</a>) {</td></tr>
<tr><th id="5890">5890</th><td>		<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 5890, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col6 ref" href="#1286xfr" title='xfr' data-ref="1286xfr" data-ref-filename="1286xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="5891">5891</th><td>		<b>return</b>; <i>/* stop on quit */</i></td></tr>
<tr><th id="5892">5892</th><td>	}</td></tr>
<tr><th id="5893">5893</th><td></td></tr>
<tr><th id="5894">5894</th><td>	<b>if</b>(<a class="local col6 ref" href="#1286xfr" title='xfr' data-ref="1286xfr" data-ref-filename="1286xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::timeout" title='auth_probe::timeout' data-ref="auth_probe::timeout" data-ref-filename="auth_probe..timeout">timeout</a> &lt;= <a class="macro" href="#80" title="1000" data-ref="_M/AUTH_PROBE_TIMEOUT_STOP">AUTH_PROBE_TIMEOUT_STOP</a>) {</td></tr>
<tr><th id="5895">5895</th><td>		<i>/* try again with bigger timeout */</i></td></tr>
<tr><th id="5896">5896</th><td>		<b>if</b>(<a class="tu ref fn" href="#xfr_probe_send_probe" title='xfr_probe_send_probe' data-use='c' data-ref="xfr_probe_send_probe" data-ref-filename="xfr_probe_send_probe">xfr_probe_send_probe</a>(<a class="local col6 ref" href="#1286xfr" title='xfr' data-ref="1286xfr" data-ref-filename="1286xfr">xfr</a>, <a class="local col7 ref" href="#1287env" title='env' data-ref="1287env" data-ref-filename="1287env">env</a>, <a class="local col6 ref" href="#1286xfr" title='xfr' data-ref="1286xfr" data-ref-filename="1286xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::timeout" title='auth_probe::timeout' data-ref="auth_probe::timeout" data-ref-filename="auth_probe..timeout">timeout</a>*<var>2</var>)) {</td></tr>
<tr><th id="5897">5897</th><td>			<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 5897, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col6 ref" href="#1286xfr" title='xfr' data-ref="1286xfr" data-ref-filename="1286xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="5898">5898</th><td>			<b>return</b>;</td></tr>
<tr><th id="5899">5899</th><td>		}</td></tr>
<tr><th id="5900">5900</th><td>	}</td></tr>
<tr><th id="5901">5901</th><td>	<i>/* delete commpoint so a new one is created, with a fresh port nr */</i></td></tr>
<tr><th id="5902">5902</th><td>	<a class="ref fn" href="../util/netevent.h.html#comm_point_delete" title='comm_point_delete' data-ref="comm_point_delete" data-ref-filename="comm_point_delete">comm_point_delete</a>(<a class="local col6 ref" href="#1286xfr" title='xfr' data-ref="1286xfr" data-ref-filename="1286xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::cp" title='auth_probe::cp' data-ref="auth_probe::cp" data-ref-filename="auth_probe..cp">cp</a>);</td></tr>
<tr><th id="5903">5903</th><td>	<a class="local col6 ref" href="#1286xfr" title='xfr' data-ref="1286xfr" data-ref-filename="1286xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::cp" title='auth_probe::cp' data-ref="auth_probe::cp" data-ref-filename="auth_probe..cp">cp</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="5904">5904</th><td></td></tr>
<tr><th id="5905">5905</th><td>	<i>/* too many timeouts (or fail to send), move to next or end */</i></td></tr>
<tr><th id="5906">5906</th><td>	<a class="tu ref fn" href="#xfr_probe_nextmaster" title='xfr_probe_nextmaster' data-use='c' data-ref="xfr_probe_nextmaster" data-ref-filename="xfr_probe_nextmaster">xfr_probe_nextmaster</a>(<a class="local col6 ref" href="#1286xfr" title='xfr' data-ref="1286xfr" data-ref-filename="1286xfr">xfr</a>);</td></tr>
<tr><th id="5907">5907</th><td>	<a class="tu ref fn" href="#xfr_probe_send_or_end" title='xfr_probe_send_or_end' data-use='c' data-ref="xfr_probe_send_or_end" data-ref-filename="xfr_probe_send_or_end">xfr_probe_send_or_end</a>(<a class="local col6 ref" href="#1286xfr" title='xfr' data-ref="1286xfr" data-ref-filename="1286xfr">xfr</a>, <a class="local col7 ref" href="#1287env" title='env' data-ref="1287env" data-ref-filename="1287env">env</a>);</td></tr>
<tr><th id="5908">5908</th><td>}</td></tr>
<tr><th id="5909">5909</th><td></td></tr>
<tr><th id="5910">5910</th><td><i class="doc">/** callback for task_probe udp packets */</i></td></tr>
<tr><th id="5911">5911</th><td><em>int</em></td></tr>
<tr><th id="5912">5912</th><td><dfn class="decl def fn" id="auth_xfer_probe_udp_callback" title='auth_xfer_probe_udp_callback' data-ref="auth_xfer_probe_udp_callback" data-ref-filename="auth_xfer_probe_udp_callback">auth_xfer_probe_udp_callback</dfn>(<b>struct</b> <a class="type" href="../util/netevent.h.html#comm_point" title='comm_point' data-ref="comm_point" data-ref-filename="comm_point">comm_point</a>* <dfn class="local col8 decl" id="1288c" title='c' data-type='struct comm_point *' data-ref="1288c" data-ref-filename="1288c">c</dfn>, <em>void</em>* <dfn class="local col9 decl" id="1289arg" title='arg' data-type='void *' data-ref="1289arg" data-ref-filename="1289arg">arg</dfn>, <em>int</em> <dfn class="local col0 decl" id="1290err" title='err' data-type='int' data-ref="1290err" data-ref-filename="1290err">err</dfn>,</td></tr>
<tr><th id="5913">5913</th><td>	<b>struct</b> <a class="type" href="../util/netevent.h.html#comm_reply" title='comm_reply' data-ref="comm_reply" data-ref-filename="comm_reply">comm_reply</a>* <dfn class="local col1 decl" id="1291repinfo" title='repinfo' data-type='struct comm_reply *' data-ref="1291repinfo" data-ref-filename="1291repinfo">repinfo</dfn>)</td></tr>
<tr><th id="5914">5914</th><td>{</td></tr>
<tr><th id="5915">5915</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col2 decl" id="1292xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1292xfr" data-ref-filename="1292xfr">xfr</dfn> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>*)<a class="local col9 ref" href="#1289arg" title='arg' data-ref="1289arg" data-ref-filename="1289arg">arg</a>;</td></tr>
<tr><th id="5916">5916</th><td>	<b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col3 decl" id="1293env" title='env' data-type='struct module_env *' data-ref="1293env" data-ref-filename="1293env">env</dfn>;</td></tr>
<tr><th id="5917">5917</th><td>	<a class="macro" href="../util/log.h.html#211" title="" data-ref="_M/log_assert">log_assert</a>(xfr-&gt;task_probe);</td></tr>
<tr><th id="5918">5918</th><td>	<a class="macro" href="../util/locks.h.html#102" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_lock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_lock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 5918, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_lock">lock_basic_lock</a>(&amp;<a class="local col2 ref" href="#1292xfr" title='xfr' data-ref="1292xfr" data-ref-filename="1292xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="5919">5919</th><td>	<a class="local col3 ref" href="#1293env" title='env' data-ref="1293env" data-ref-filename="1293env">env</a> = <a class="local col2 ref" href="#1292xfr" title='xfr' data-ref="1292xfr" data-ref-filename="1292xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::env" title='auth_probe::env' data-ref="auth_probe::env" data-ref-filename="auth_probe..env">env</a>;</td></tr>
<tr><th id="5920">5920</th><td>	<b>if</b>(<a class="local col3 ref" href="#1293env" title='env' data-ref="1293env" data-ref-filename="1293env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::outnet" title='module_env::outnet' data-ref="module_env::outnet" data-ref-filename="module_env..outnet">outnet</a>-&gt;<a class="ref field" href="outside_network.h.html#outside_network::want_to_quit" title='outside_network::want_to_quit' data-ref="outside_network::want_to_quit" data-ref-filename="outside_network..want_to_quit">want_to_quit</a>) {</td></tr>
<tr><th id="5921">5921</th><td>		<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 5921, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col2 ref" href="#1292xfr" title='xfr' data-ref="1292xfr" data-ref-filename="1292xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="5922">5922</th><td>		<b>return</b> <var>0</var>; <i>/* stop on quit */</i></td></tr>
<tr><th id="5923">5923</th><td>	}</td></tr>
<tr><th id="5924">5924</th><td></td></tr>
<tr><th id="5925">5925</th><td>	<i>/* the comm_point_udp_callback is in a for loop for NUM_UDP_PER_SELECT</i></td></tr>
<tr><th id="5926">5926</th><td><i>	 * and we set rep.c=NULL to stop if from looking inside the commpoint*/</i></td></tr>
<tr><th id="5927">5927</th><td>	<a class="local col1 ref" href="#1291repinfo" title='repinfo' data-ref="1291repinfo" data-ref-filename="1291repinfo">repinfo</a>-&gt;<a class="ref field" href="../util/netevent.h.html#comm_reply::c" title='comm_reply::c' data-ref="comm_reply::c" data-ref-filename="comm_reply..c">c</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="5928">5928</th><td>	<i>/* stop the timer */</i></td></tr>
<tr><th id="5929">5929</th><td>	<a class="ref fn" href="../util/netevent.h.html#comm_timer_disable" title='comm_timer_disable' data-ref="comm_timer_disable" data-ref-filename="comm_timer_disable">comm_timer_disable</a>(<a class="local col2 ref" href="#1292xfr" title='xfr' data-ref="1292xfr" data-ref-filename="1292xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::timer" title='auth_probe::timer' data-ref="auth_probe::timer" data-ref-filename="auth_probe..timer">timer</a>);</td></tr>
<tr><th id="5930">5930</th><td></td></tr>
<tr><th id="5931">5931</th><td>	<i>/* see if we got a packet and what that means */</i></td></tr>
<tr><th id="5932">5932</th><td>	<b>if</b>(<a class="local col0 ref" href="#1290err" title='err' data-ref="1290err" data-ref-filename="1290err">err</a> == <a class="macro" href="../util/netevent.h.html#81" title="0" data-ref="_M/NETEVENT_NOERROR">NETEVENT_NOERROR</a>) {</td></tr>
<tr><th id="5933">5933</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a> <dfn class="local col4 decl" id="1294serial" title='serial' data-type='uint32_t' data-ref="1294serial" data-ref-filename="1294serial">serial</dfn> = <var>0</var>;</td></tr>
<tr><th id="5934">5934</th><td>		<b>if</b>(<a class="tu ref fn" href="#check_packet_ok" title='check_packet_ok' data-use='c' data-ref="check_packet_ok" data-ref-filename="check_packet_ok">check_packet_ok</a>(<a class="local col8 ref" href="#1288c" title='c' data-ref="1288c" data-ref-filename="1288c">c</a>-&gt;<a class="ref field" href="../util/netevent.h.html#comm_point::buffer" title='comm_point::buffer' data-ref="comm_point::buffer" data-ref-filename="comm_point..buffer">buffer</a>, <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_SOA" title='LDNS_RR_TYPE_SOA' data-ref="LDNS_RR_TYPE_SOA" data-ref-filename="LDNS_RR_TYPE_SOA">LDNS_RR_TYPE_SOA</a>, <a class="local col2 ref" href="#1292xfr" title='xfr' data-ref="1292xfr" data-ref-filename="1292xfr">xfr</a>,</td></tr>
<tr><th id="5935">5935</th><td>			&amp;<a class="local col4 ref" href="#1294serial" title='serial' data-ref="1294serial" data-ref-filename="1294serial">serial</a>)) {</td></tr>
<tr><th id="5936">5936</th><td>			<i>/* successful lookup */</i></td></tr>
<tr><th id="5937">5937</th><td>			<b>if</b>(<a class="ref" href="../util/log.h.html#verbosity" title='verbosity' data-ref="verbosity" data-ref-filename="verbosity">verbosity</a> &gt;= <a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>) {</td></tr>
<tr><th id="5938">5938</th><td>				<em>char</em> <dfn class="local col5 decl" id="1295buf" title='buf' data-type='char [256]' data-ref="1295buf" data-ref-filename="1295buf">buf</dfn>[<var>256</var>];</td></tr>
<tr><th id="5939">5939</th><td>				<a class="ref fn" href="../util/data/dname.h.html#dname_str" title='dname_str' data-ref="dname_str" data-ref-filename="dname_str">dname_str</a>(<a class="local col2 ref" href="#1292xfr" title='xfr' data-ref="1292xfr" data-ref-filename="1292xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a>, <a class="local col5 ref" href="#1295buf" title='buf' data-ref="1295buf" data-ref-filename="1295buf">buf</a>);</td></tr>
<tr><th id="5940">5940</th><td>				<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"auth zone %s: soa probe "</q></td></tr>
<tr><th id="5941">5941</th><td>					<q>"serial is %u"</q>, <a class="local col5 ref" href="#1295buf" title='buf' data-ref="1295buf" data-ref-filename="1295buf">buf</a>, (<em>unsigned</em>)<a class="local col4 ref" href="#1294serial" title='serial' data-ref="1294serial" data-ref-filename="1294serial">serial</a>);</td></tr>
<tr><th id="5942">5942</th><td>			}</td></tr>
<tr><th id="5943">5943</th><td>			<i>/* see if this serial indicates that the zone has</i></td></tr>
<tr><th id="5944">5944</th><td><i>			 * to be updated */</i></td></tr>
<tr><th id="5945">5945</th><td>			<b>if</b>(<a class="tu ref fn" href="#xfr_serial_means_update" title='xfr_serial_means_update' data-use='c' data-ref="xfr_serial_means_update" data-ref-filename="xfr_serial_means_update">xfr_serial_means_update</a>(<a class="local col2 ref" href="#1292xfr" title='xfr' data-ref="1292xfr" data-ref-filename="1292xfr">xfr</a>, <a class="local col4 ref" href="#1294serial" title='serial' data-ref="1294serial" data-ref-filename="1294serial">serial</a>)) {</td></tr>
<tr><th id="5946">5946</th><td>				<i>/* if updated, start the transfer task, if needed */</i></td></tr>
<tr><th id="5947">5947</th><td>				<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"auth_zone updated, start transfer"</q>);</td></tr>
<tr><th id="5948">5948</th><td>				<b>if</b>(<a class="local col2 ref" href="#1292xfr" title='xfr' data-ref="1292xfr" data-ref-filename="1292xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::worker" title='auth_transfer::worker' data-ref="auth_transfer::worker" data-ref-filename="auth_transfer..worker">worker</a> == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="5949">5949</th><td>					<b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>* <dfn class="local col6 decl" id="1296master" title='master' data-type='struct auth_master *' data-ref="1296master" data-ref-filename="1296master">master</dfn> =</td></tr>
<tr><th id="5950">5950</th><td>						<a class="tu ref fn" href="#xfr_probe_current_master" title='xfr_probe_current_master' data-use='c' data-ref="xfr_probe_current_master" data-ref-filename="xfr_probe_current_master">xfr_probe_current_master</a>(<a class="local col2 ref" href="#1292xfr" title='xfr' data-ref="1292xfr" data-ref-filename="1292xfr">xfr</a>);</td></tr>
<tr><th id="5951">5951</th><td>					<i>/* if we have download URLs use them</i></td></tr>
<tr><th id="5952">5952</th><td><i>					 * in preference to this master we</i></td></tr>
<tr><th id="5953">5953</th><td><i>					 * just probed the SOA from */</i></td></tr>
<tr><th id="5954">5954</th><td>					<b>if</b>(<a class="local col2 ref" href="#1292xfr" title='xfr' data-ref="1292xfr" data-ref-filename="1292xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::masters" title='auth_transfer::masters' data-ref="auth_transfer::masters" data-ref-filename="auth_transfer..masters">masters</a> &amp;&amp;</td></tr>
<tr><th id="5955">5955</th><td>						<a class="local col2 ref" href="#1292xfr" title='xfr' data-ref="1292xfr" data-ref-filename="1292xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::masters" title='auth_transfer::masters' data-ref="auth_transfer::masters" data-ref-filename="auth_transfer..masters">masters</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::http" title='auth_master::http' data-ref="auth_master::http" data-ref-filename="auth_master..http">http</a>)</td></tr>
<tr><th id="5956">5956</th><td>						<a class="local col6 ref" href="#1296master" title='master' data-ref="1296master" data-ref-filename="1296master">master</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="5957">5957</th><td>					<a class="tu ref fn" href="#xfr_probe_disown" title='xfr_probe_disown' data-use='c' data-ref="xfr_probe_disown" data-ref-filename="xfr_probe_disown">xfr_probe_disown</a>(<a class="local col2 ref" href="#1292xfr" title='xfr' data-ref="1292xfr" data-ref-filename="1292xfr">xfr</a>);</td></tr>
<tr><th id="5958">5958</th><td>					<a class="tu ref fn" href="#xfr_start_transfer" title='xfr_start_transfer' data-use='c' data-ref="xfr_start_transfer" data-ref-filename="xfr_start_transfer">xfr_start_transfer</a>(<a class="local col2 ref" href="#1292xfr" title='xfr' data-ref="1292xfr" data-ref-filename="1292xfr">xfr</a>, <a class="local col3 ref" href="#1293env" title='env' data-ref="1293env" data-ref-filename="1293env">env</a>, <a class="local col6 ref" href="#1296master" title='master' data-ref="1296master" data-ref-filename="1296master">master</a>);</td></tr>
<tr><th id="5959">5959</th><td>					<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5960">5960</th><td></td></tr>
<tr><th id="5961">5961</th><td>				}</td></tr>
<tr><th id="5962">5962</th><td>				<i>/* other tasks are running, we don't do this anymore */</i></td></tr>
<tr><th id="5963">5963</th><td>				<a class="tu ref fn" href="#xfr_probe_disown" title='xfr_probe_disown' data-use='c' data-ref="xfr_probe_disown" data-ref-filename="xfr_probe_disown">xfr_probe_disown</a>(<a class="local col2 ref" href="#1292xfr" title='xfr' data-ref="1292xfr" data-ref-filename="1292xfr">xfr</a>);</td></tr>
<tr><th id="5964">5964</th><td>				<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 5964, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col2 ref" href="#1292xfr" title='xfr' data-ref="1292xfr" data-ref-filename="1292xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="5965">5965</th><td>				<i>/* return, we don't sent a reply to this udp packet,</i></td></tr>
<tr><th id="5966">5966</th><td><i>				 * and we setup the tasks to do next */</i></td></tr>
<tr><th id="5967">5967</th><td>				<b>return</b> <var>0</var>;</td></tr>
<tr><th id="5968">5968</th><td>			} <b>else</b> {</td></tr>
<tr><th id="5969">5969</th><td>				<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"auth_zone master reports unchanged soa serial"</q>);</td></tr>
<tr><th id="5970">5970</th><td>				<i>/* we if cannot find updates amongst the</i></td></tr>
<tr><th id="5971">5971</th><td><i>				 * masters, this means we then have a new lease</i></td></tr>
<tr><th id="5972">5972</th><td><i>				 * on the zone */</i></td></tr>
<tr><th id="5973">5973</th><td>				<a class="local col2 ref" href="#1292xfr" title='xfr' data-ref="1292xfr" data-ref-filename="1292xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::have_new_lease" title='auth_probe::have_new_lease' data-ref="auth_probe::have_new_lease" data-ref-filename="auth_probe..have_new_lease">have_new_lease</a> = <var>1</var>;</td></tr>
<tr><th id="5974">5974</th><td>			}</td></tr>
<tr><th id="5975">5975</th><td>		} <b>else</b> {</td></tr>
<tr><th id="5976">5976</th><td>			<b>if</b>(<a class="ref" href="../util/log.h.html#verbosity" title='verbosity' data-ref="verbosity" data-ref-filename="verbosity">verbosity</a> &gt;= <a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>) {</td></tr>
<tr><th id="5977">5977</th><td>				<em>char</em> <dfn class="local col7 decl" id="1297buf" title='buf' data-type='char [256]' data-ref="1297buf" data-ref-filename="1297buf">buf</dfn>[<var>256</var>];</td></tr>
<tr><th id="5978">5978</th><td>				<a class="ref fn" href="../util/data/dname.h.html#dname_str" title='dname_str' data-ref="dname_str" data-ref-filename="dname_str">dname_str</a>(<a class="local col2 ref" href="#1292xfr" title='xfr' data-ref="1292xfr" data-ref-filename="1292xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a>, <a class="local col7 ref" href="#1297buf" title='buf' data-ref="1297buf" data-ref-filename="1297buf">buf</a>);</td></tr>
<tr><th id="5979">5979</th><td>				<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"auth zone %s: bad reply to soa probe"</q>, <a class="local col7 ref" href="#1297buf" title='buf' data-ref="1297buf" data-ref-filename="1297buf">buf</a>);</td></tr>
<tr><th id="5980">5980</th><td>			}</td></tr>
<tr><th id="5981">5981</th><td>		}</td></tr>
<tr><th id="5982">5982</th><td>	} <b>else</b> {</td></tr>
<tr><th id="5983">5983</th><td>		<b>if</b>(<a class="ref" href="../util/log.h.html#verbosity" title='verbosity' data-ref="verbosity" data-ref-filename="verbosity">verbosity</a> &gt;= <a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>) {</td></tr>
<tr><th id="5984">5984</th><td>			<em>char</em> <dfn class="local col8 decl" id="1298buf" title='buf' data-type='char [256]' data-ref="1298buf" data-ref-filename="1298buf">buf</dfn>[<var>256</var>];</td></tr>
<tr><th id="5985">5985</th><td>			<a class="ref fn" href="../util/data/dname.h.html#dname_str" title='dname_str' data-ref="dname_str" data-ref-filename="dname_str">dname_str</a>(<a class="local col2 ref" href="#1292xfr" title='xfr' data-ref="1292xfr" data-ref-filename="1292xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a>, <a class="local col8 ref" href="#1298buf" title='buf' data-ref="1298buf" data-ref-filename="1298buf">buf</a>);</td></tr>
<tr><th id="5986">5986</th><td>			<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"auth zone %s: soa probe failed"</q>, <a class="local col8 ref" href="#1298buf" title='buf' data-ref="1298buf" data-ref-filename="1298buf">buf</a>);</td></tr>
<tr><th id="5987">5987</th><td>		}</td></tr>
<tr><th id="5988">5988</th><td>	}</td></tr>
<tr><th id="5989">5989</th><td>	</td></tr>
<tr><th id="5990">5990</th><td>	<i>/* failed lookup or not an update */</i></td></tr>
<tr><th id="5991">5991</th><td>	<i>/* delete commpoint so a new one is created, with a fresh port nr */</i></td></tr>
<tr><th id="5992">5992</th><td>	<a class="ref fn" href="../util/netevent.h.html#comm_point_delete" title='comm_point_delete' data-ref="comm_point_delete" data-ref-filename="comm_point_delete">comm_point_delete</a>(<a class="local col2 ref" href="#1292xfr" title='xfr' data-ref="1292xfr" data-ref-filename="1292xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::cp" title='auth_probe::cp' data-ref="auth_probe::cp" data-ref-filename="auth_probe..cp">cp</a>);</td></tr>
<tr><th id="5993">5993</th><td>	<a class="local col2 ref" href="#1292xfr" title='xfr' data-ref="1292xfr" data-ref-filename="1292xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::cp" title='auth_probe::cp' data-ref="auth_probe::cp" data-ref-filename="auth_probe..cp">cp</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="5994">5994</th><td></td></tr>
<tr><th id="5995">5995</th><td>	<i>/* if the result was not a successfull probe, we need</i></td></tr>
<tr><th id="5996">5996</th><td><i>	 * to send the next one */</i></td></tr>
<tr><th id="5997">5997</th><td>	<a class="tu ref fn" href="#xfr_probe_nextmaster" title='xfr_probe_nextmaster' data-use='c' data-ref="xfr_probe_nextmaster" data-ref-filename="xfr_probe_nextmaster">xfr_probe_nextmaster</a>(<a class="local col2 ref" href="#1292xfr" title='xfr' data-ref="1292xfr" data-ref-filename="1292xfr">xfr</a>);</td></tr>
<tr><th id="5998">5998</th><td>	<a class="tu ref fn" href="#xfr_probe_send_or_end" title='xfr_probe_send_or_end' data-use='c' data-ref="xfr_probe_send_or_end" data-ref-filename="xfr_probe_send_or_end">xfr_probe_send_or_end</a>(<a class="local col2 ref" href="#1292xfr" title='xfr' data-ref="1292xfr" data-ref-filename="1292xfr">xfr</a>, <a class="local col3 ref" href="#1293env" title='env' data-ref="1293env" data-ref-filename="1293env">env</a>);</td></tr>
<tr><th id="5999">5999</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="6000">6000</th><td>}</td></tr>
<tr><th id="6001">6001</th><td></td></tr>
<tr><th id="6002">6002</th><td><i class="doc" data-doc="xfr_probe_lookup_host">/** lookup a host name for its addresses, if needed */</i></td></tr>
<tr><th id="6003">6003</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="6004">6004</th><td><dfn class="tu decl def fn" id="xfr_probe_lookup_host" title='xfr_probe_lookup_host' data-type='int xfr_probe_lookup_host(struct auth_xfer * xfr, struct module_env * env)' data-ref="xfr_probe_lookup_host" data-ref-filename="xfr_probe_lookup_host">xfr_probe_lookup_host</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col9 decl" id="1299xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1299xfr" data-ref-filename="1299xfr">xfr</dfn>, <b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col0 decl" id="1300env" title='env' data-type='struct module_env *' data-ref="1300env" data-ref-filename="1300env">env</dfn>)</td></tr>
<tr><th id="6005">6005</th><td>{</td></tr>
<tr><th id="6006">6006</th><td>	<b>struct</b> <a class="type" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#sockaddr_storage" title='sockaddr_storage' data-ref="sockaddr_storage" data-ref-filename="sockaddr_storage">sockaddr_storage</a> <dfn class="local col1 decl" id="1301addr" title='addr' data-type='struct sockaddr_storage' data-ref="1301addr" data-ref-filename="1301addr">addr</dfn>;</td></tr>
<tr><th id="6007">6007</th><td>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#84" title="__socklen_t" data-ref="_M/socklen_t">socklen_t</a> <dfn class="local col2 decl" id="1302addrlen" title='addrlen' data-type='__socklen_t' data-ref="1302addrlen" data-ref-filename="1302addrlen">addrlen</dfn> = <var>0</var>;</td></tr>
<tr><th id="6008">6008</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>* <dfn class="local col3 decl" id="1303master" title='master' data-type='struct auth_master *' data-ref="1303master" data-ref-filename="1303master">master</dfn> = <a class="local col9 ref" href="#1299xfr" title='xfr' data-ref="1299xfr" data-ref-filename="1299xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::lookup_target" title='auth_probe::lookup_target' data-ref="auth_probe::lookup_target" data-ref-filename="auth_probe..lookup_target">lookup_target</a>;</td></tr>
<tr><th id="6009">6009</th><td>	<b>struct</b> <a class="type" href="../util/data/msgreply.h.html#query_info" title='query_info' data-ref="query_info" data-ref-filename="query_info">query_info</a> <dfn class="local col4 decl" id="1304qinfo" title='qinfo' data-type='struct query_info' data-ref="1304qinfo" data-ref-filename="1304qinfo">qinfo</dfn>;</td></tr>
<tr><th id="6010">6010</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col5 decl" id="1305qflags" title='qflags' data-type='uint16_t' data-ref="1305qflags" data-ref-filename="1305qflags">qflags</dfn> = <a class="macro" href="../util/net_help.h.html#65" title="0x0100" data-ref="_M/BIT_RD">BIT_RD</a>;</td></tr>
<tr><th id="6011">6011</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a> <dfn class="local col6 decl" id="1306dname" title='dname' data-type='uint8_t [256]' data-ref="1306dname" data-ref-filename="1306dname">dname</dfn>[<a class="macro" href="../sldns/rrdef.h.html#29" title="255" data-ref="_M/LDNS_MAX_DOMAINLEN">LDNS_MAX_DOMAINLEN</a>+<var>1</var>];</td></tr>
<tr><th id="6012">6012</th><td>	<b>struct</b> <a class="type" href="../util/data/msgparse.h.html#edns_data" title='edns_data' data-ref="edns_data" data-ref-filename="edns_data">edns_data</a> <dfn class="local col7 decl" id="1307edns" title='edns' data-type='struct edns_data' data-ref="1307edns" data-ref-filename="1307edns">edns</dfn>;</td></tr>
<tr><th id="6013">6013</th><td>	<a class="typedef" href="../sldns/sbuffer.h.html#sldns_buffer" title='sldns_buffer' data-type='struct sldns_buffer' data-ref="sldns_buffer" data-ref-filename="sldns_buffer">sldns_buffer</a>* <dfn class="local col8 decl" id="1308buf" title='buf' data-type='sldns_buffer *' data-ref="1308buf" data-ref-filename="1308buf">buf</dfn> = <a class="local col0 ref" href="#1300env" title='env' data-ref="1300env" data-ref-filename="1300env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::scratch_buffer" title='module_env::scratch_buffer' data-ref="module_env::scratch_buffer" data-ref-filename="module_env..scratch_buffer">scratch_buffer</a>;</td></tr>
<tr><th id="6014">6014</th><td>	<b>if</b>(!<a class="local col3 ref" href="#1303master" title='master' data-ref="1303master" data-ref-filename="1303master">master</a>) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="6015">6015</th><td>	<b>if</b>(<a class="ref fn" href="../util/net_help.h.html#extstrtoaddr" title='extstrtoaddr' data-ref="extstrtoaddr" data-ref-filename="extstrtoaddr">extstrtoaddr</a>(<a class="local col3 ref" href="#1303master" title='master' data-ref="1303master" data-ref-filename="1303master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>, &amp;<a class="local col1 ref" href="#1301addr" title='addr' data-ref="1301addr" data-ref-filename="1301addr">addr</a>, &amp;<a class="local col2 ref" href="#1302addrlen" title='addrlen' data-ref="1302addrlen" data-ref-filename="1302addrlen">addrlen</a>)) {</td></tr>
<tr><th id="6016">6016</th><td>		<i>/* not needed, host is in IP addr format */</i></td></tr>
<tr><th id="6017">6017</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="6018">6018</th><td>	}</td></tr>
<tr><th id="6019">6019</th><td>	<b>if</b>(<a class="local col3 ref" href="#1303master" title='master' data-ref="1303master" data-ref-filename="1303master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::allow_notify" title='auth_master::allow_notify' data-ref="auth_master::allow_notify" data-ref-filename="auth_master..allow_notify">allow_notify</a> &amp;&amp; !<a class="local col3 ref" href="#1303master" title='master' data-ref="1303master" data-ref-filename="1303master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::http" title='auth_master::http' data-ref="auth_master::http" data-ref-filename="auth_master..http">http</a> &amp;&amp;</td></tr>
<tr><th id="6020">6020</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strchr" title='strchr' data-ref="strchr" data-ref-filename="strchr">strchr</a>(<a class="local col3 ref" href="#1303master" title='master' data-ref="1303master" data-ref-filename="1303master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>, <kbd>'/'</kbd>) != <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span> &amp;&amp;</td></tr>
<tr><th id="6021">6021</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strchr" title='strchr' data-ref="strchr" data-ref-filename="strchr">strchr</a>(<a class="local col3 ref" href="#1303master" title='master' data-ref="1303master" data-ref-filename="1303master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>, <kbd>'/'</kbd>) == <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strrchr" title='strrchr' data-ref="strrchr" data-ref-filename="strrchr">strrchr</a>(<a class="local col3 ref" href="#1303master" title='master' data-ref="1303master" data-ref-filename="1303master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>, <kbd>'/'</kbd>)) {</td></tr>
<tr><th id="6022">6022</th><td>		<b>return</b> <var>0</var>; <i>/* is IP/prefix format, not something to look up */</i></td></tr>
<tr><th id="6023">6023</th><td>	}</td></tr>
<tr><th id="6024">6024</th><td></td></tr>
<tr><th id="6025">6025</th><td>	<i>/* use mesh_new_callback to probe for non-addr hosts,</i></td></tr>
<tr><th id="6026">6026</th><td><i>	 * and then wait for them to be looked up (in cache, or query) */</i></td></tr>
<tr><th id="6027">6027</th><td>	<a class="local col4 ref" href="#1304qinfo" title='qinfo' data-ref="1304qinfo" data-ref-filename="1304qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname_len" title='query_info::qname_len' data-ref="query_info::qname_len" data-ref-filename="query_info..qname_len">qname_len</a> = <b>sizeof</b>(<a class="local col6 ref" href="#1306dname" title='dname' data-ref="1306dname" data-ref-filename="1306dname">dname</a>);</td></tr>
<tr><th id="6028">6028</th><td>	<b>if</b>(<a class="ref fn" href="../sldns/str2wire.h.html#sldns_str2wire_dname_buf" title='sldns_str2wire_dname_buf' data-ref="sldns_str2wire_dname_buf" data-ref-filename="sldns_str2wire_dname_buf">sldns_str2wire_dname_buf</a>(<a class="local col3 ref" href="#1303master" title='master' data-ref="1303master" data-ref-filename="1303master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>, <a class="local col6 ref" href="#1306dname" title='dname' data-ref="1306dname" data-ref-filename="1306dname">dname</a>, &amp;<a class="local col4 ref" href="#1304qinfo" title='qinfo' data-ref="1304qinfo" data-ref-filename="1304qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname_len" title='query_info::qname_len' data-ref="query_info::qname_len" data-ref-filename="query_info..qname_len">qname_len</a>)</td></tr>
<tr><th id="6029">6029</th><td>		!= <var>0</var>) {</td></tr>
<tr><th id="6030">6030</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"cannot parse host name of master %s"</q>, <a class="local col3 ref" href="#1303master" title='master' data-ref="1303master" data-ref-filename="1303master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="6031">6031</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="6032">6032</th><td>	}</td></tr>
<tr><th id="6033">6033</th><td>	<a class="local col4 ref" href="#1304qinfo" title='qinfo' data-ref="1304qinfo" data-ref-filename="1304qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qname" title='query_info::qname' data-ref="query_info::qname" data-ref-filename="query_info..qname">qname</a> = <a class="local col6 ref" href="#1306dname" title='dname' data-ref="1306dname" data-ref-filename="1306dname">dname</a>;</td></tr>
<tr><th id="6034">6034</th><td>	<a class="local col4 ref" href="#1304qinfo" title='qinfo' data-ref="1304qinfo" data-ref-filename="1304qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qclass" title='query_info::qclass' data-ref="query_info::qclass" data-ref-filename="query_info..qclass">qclass</a> = <a class="local col9 ref" href="#1299xfr" title='xfr' data-ref="1299xfr" data-ref-filename="1299xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::dclass" title='auth_xfer::dclass' data-ref="auth_xfer::dclass" data-ref-filename="auth_xfer..dclass">dclass</a>;</td></tr>
<tr><th id="6035">6035</th><td>	<a class="local col4 ref" href="#1304qinfo" title='qinfo' data-ref="1304qinfo" data-ref-filename="1304qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qtype" title='query_info::qtype' data-ref="query_info::qtype" data-ref-filename="query_info..qtype">qtype</a> = <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_A" title='LDNS_RR_TYPE_A' data-ref="LDNS_RR_TYPE_A" data-ref-filename="LDNS_RR_TYPE_A">LDNS_RR_TYPE_A</a>;</td></tr>
<tr><th id="6036">6036</th><td>	<b>if</b>(<a class="local col9 ref" href="#1299xfr" title='xfr' data-ref="1299xfr" data-ref-filename="1299xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::lookup_aaaa" title='auth_probe::lookup_aaaa' data-ref="auth_probe::lookup_aaaa" data-ref-filename="auth_probe..lookup_aaaa">lookup_aaaa</a>)</td></tr>
<tr><th id="6037">6037</th><td>		<a class="local col4 ref" href="#1304qinfo" title='qinfo' data-ref="1304qinfo" data-ref-filename="1304qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qtype" title='query_info::qtype' data-ref="query_info::qtype" data-ref-filename="query_info..qtype">qtype</a> = <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_AAAA" title='LDNS_RR_TYPE_AAAA' data-ref="LDNS_RR_TYPE_AAAA" data-ref-filename="LDNS_RR_TYPE_AAAA">LDNS_RR_TYPE_AAAA</a>;</td></tr>
<tr><th id="6038">6038</th><td>	<a class="local col4 ref" href="#1304qinfo" title='qinfo' data-ref="1304qinfo" data-ref-filename="1304qinfo">qinfo</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::local_alias" title='query_info::local_alias' data-ref="query_info::local_alias" data-ref-filename="query_info..local_alias">local_alias</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="6039">6039</th><td>	<b>if</b>(<a class="ref" href="../util/log.h.html#verbosity" title='verbosity' data-ref="verbosity" data-ref-filename="verbosity">verbosity</a> &gt;= <a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>) {</td></tr>
<tr><th id="6040">6040</th><td>		<em>char</em> <dfn class="local col9 decl" id="1309buf1" title='buf1' data-type='char [512]' data-ref="1309buf1" data-ref-filename="1309buf1">buf1</dfn>[<var>512</var>];</td></tr>
<tr><th id="6041">6041</th><td>		<em>char</em> <dfn class="local col0 decl" id="1310buf2" title='buf2' data-type='char [256]' data-ref="1310buf2" data-ref-filename="1310buf2">buf2</dfn>[<a class="macro" href="../sldns/rrdef.h.html#29" title="255" data-ref="_M/LDNS_MAX_DOMAINLEN">LDNS_MAX_DOMAINLEN</a>+<var>1</var>];</td></tr>
<tr><th id="6042">6042</th><td>		<a class="ref fn" href="../util/data/dname.h.html#dname_str" title='dname_str' data-ref="dname_str" data-ref-filename="dname_str">dname_str</a>(<a class="local col9 ref" href="#1299xfr" title='xfr' data-ref="1299xfr" data-ref-filename="1299xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a>, <a class="local col0 ref" href="#1310buf2" title='buf2' data-ref="1310buf2" data-ref-filename="1310buf2">buf2</a>);</td></tr>
<tr><th id="6043">6043</th><td>		<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/stdio.h.html#61" title="__builtin___snprintf_chk(buf1, sizeof(buf1), 0, __builtin_object_size(buf1, 2 &gt; 1), &quot;auth zone %s: master lookup&quot; &quot; for task_probe&quot;, buf2)" data-ref="_M/snprintf">snprintf</a>(<a class="local col9 ref" href="#1309buf1" title='buf1' data-ref="1309buf1" data-ref-filename="1309buf1">buf1</a>, <b>sizeof</b>(<a class="local col9 ref" href="#1309buf1" title='buf1' data-ref="1309buf1" data-ref-filename="1309buf1">buf1</a>), <q>"auth zone %s: master lookup"</q></td></tr>
<tr><th id="6044">6044</th><td>			<q>" for task_probe"</q>, <a class="local col0 ref" href="#1310buf2" title='buf2' data-ref="1310buf2" data-ref-filename="1310buf2">buf2</a>);</td></tr>
<tr><th id="6045">6045</th><td>		<a class="ref fn" href="../util/data/msgreply.h.html#log_query_info" title='log_query_info' data-ref="log_query_info" data-ref-filename="log_query_info">log_query_info</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <a class="local col9 ref" href="#1309buf1" title='buf1' data-ref="1309buf1" data-ref-filename="1309buf1">buf1</a>, &amp;<a class="local col4 ref" href="#1304qinfo" title='qinfo' data-ref="1304qinfo" data-ref-filename="1304qinfo">qinfo</a>);</td></tr>
<tr><th id="6046">6046</th><td>	}</td></tr>
<tr><th id="6047">6047</th><td>	<a class="local col7 ref" href="#1307edns" title='edns' data-ref="1307edns" data-ref-filename="1307edns">edns</a>.<a class="ref field" href="../util/data/msgparse.h.html#edns_data::edns_present" title='edns_data::edns_present' data-ref="edns_data::edns_present" data-ref-filename="edns_data..edns_present">edns_present</a> = <var>1</var>;</td></tr>
<tr><th id="6048">6048</th><td>	<a class="local col7 ref" href="#1307edns" title='edns' data-ref="1307edns" data-ref-filename="1307edns">edns</a>.<a class="ref field" href="../util/data/msgparse.h.html#edns_data::ext_rcode" title='edns_data::ext_rcode' data-ref="edns_data::ext_rcode" data-ref-filename="edns_data..ext_rcode">ext_rcode</a> = <var>0</var>;</td></tr>
<tr><th id="6049">6049</th><td>	<a class="local col7 ref" href="#1307edns" title='edns' data-ref="1307edns" data-ref-filename="1307edns">edns</a>.<a class="ref field" href="../util/data/msgparse.h.html#edns_data::edns_version" title='edns_data::edns_version' data-ref="edns_data::edns_version" data-ref-filename="edns_data..edns_version">edns_version</a> = <var>0</var>;</td></tr>
<tr><th id="6050">6050</th><td>	<a class="local col7 ref" href="#1307edns" title='edns' data-ref="1307edns" data-ref-filename="1307edns">edns</a>.<a class="ref field" href="../util/data/msgparse.h.html#edns_data::bits" title='edns_data::bits' data-ref="edns_data::bits" data-ref-filename="edns_data..bits">bits</a> = <a class="macro" href="../util/net_help.h.html#86" title="0x8000" data-ref="_M/EDNS_DO">EDNS_DO</a>;</td></tr>
<tr><th id="6051">6051</th><td>	<a class="local col7 ref" href="#1307edns" title='edns' data-ref="1307edns" data-ref-filename="1307edns">edns</a>.<a class="ref field" href="../util/data/msgparse.h.html#edns_data::opt_list" title='edns_data::opt_list' data-ref="edns_data::opt_list" data-ref-filename="edns_data..opt_list">opt_list</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="6052">6052</th><td>	<b>if</b>(<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_capacity" title='sldns_buffer_capacity' data-ref="sldns_buffer_capacity" data-ref-filename="sldns_buffer_capacity">sldns_buffer_capacity</a>(<a class="local col8 ref" href="#1308buf" title='buf' data-ref="1308buf" data-ref-filename="1308buf">buf</a>) &lt; <var>65535</var>)</td></tr>
<tr><th id="6053">6053</th><td>		<a class="local col7 ref" href="#1307edns" title='edns' data-ref="1307edns" data-ref-filename="1307edns">edns</a>.<a class="ref field" href="../util/data/msgparse.h.html#edns_data::udp_size" title='edns_data::udp_size' data-ref="edns_data::udp_size" data-ref-filename="edns_data..udp_size">udp_size</a> = (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a>)<a class="ref fn" href="../sldns/sbuffer.h.html#sldns_buffer_capacity" title='sldns_buffer_capacity' data-ref="sldns_buffer_capacity" data-ref-filename="sldns_buffer_capacity">sldns_buffer_capacity</a>(<a class="local col8 ref" href="#1308buf" title='buf' data-ref="1308buf" data-ref-filename="1308buf">buf</a>);</td></tr>
<tr><th id="6054">6054</th><td>	<b>else</b>	<a class="local col7 ref" href="#1307edns" title='edns' data-ref="1307edns" data-ref-filename="1307edns">edns</a>.<a class="ref field" href="../util/data/msgparse.h.html#edns_data::udp_size" title='edns_data::udp_size' data-ref="edns_data::udp_size" data-ref-filename="edns_data..udp_size">udp_size</a> = <var>65535</var>;</td></tr>
<tr><th id="6055">6055</th><td></td></tr>
<tr><th id="6056">6056</th><td>	<i>/* unlock xfr during mesh_new_callback() because the callback can be</i></td></tr>
<tr><th id="6057">6057</th><td><i>	 * called straight away */</i></td></tr>
<tr><th id="6058">6058</th><td>	<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 6058, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col9 ref" href="#1299xfr" title='xfr' data-ref="1299xfr" data-ref-filename="1299xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="6059">6059</th><td>	<b>if</b>(!<a class="ref fn" href="mesh.h.html#mesh_new_callback" title='mesh_new_callback' data-ref="mesh_new_callback" data-ref-filename="mesh_new_callback">mesh_new_callback</a>(<a class="local col0 ref" href="#1300env" title='env' data-ref="1300env" data-ref-filename="1300env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::mesh" title='module_env::mesh' data-ref="module_env::mesh" data-ref-filename="module_env..mesh">mesh</a>, &amp;<a class="local col4 ref" href="#1304qinfo" title='qinfo' data-ref="1304qinfo" data-ref-filename="1304qinfo">qinfo</a>, <a class="local col5 ref" href="#1305qflags" title='qflags' data-ref="1305qflags" data-ref-filename="1305qflags">qflags</a>, &amp;<a class="local col7 ref" href="#1307edns" title='edns' data-ref="1307edns" data-ref-filename="1307edns">edns</a>, <a class="local col8 ref" href="#1308buf" title='buf' data-ref="1308buf" data-ref-filename="1308buf">buf</a>, <var>0</var>,</td></tr>
<tr><th id="6060">6060</th><td>		&amp;<a class="ref fn" href="#auth_xfer_probe_lookup_callback" title='auth_xfer_probe_lookup_callback' data-ref="auth_xfer_probe_lookup_callback" data-ref-filename="auth_xfer_probe_lookup_callback">auth_xfer_probe_lookup_callback</a>, <a class="local col9 ref" href="#1299xfr" title='xfr' data-ref="1299xfr" data-ref-filename="1299xfr">xfr</a>)) {</td></tr>
<tr><th id="6061">6061</th><td>		<a class="macro" href="../util/locks.h.html#102" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_lock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_lock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 6061, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_lock">lock_basic_lock</a>(&amp;<a class="local col9 ref" href="#1299xfr" title='xfr' data-ref="1299xfr" data-ref-filename="1299xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="6062">6062</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"out of memory lookup up master %s"</q>, <a class="local col3 ref" href="#1303master" title='master' data-ref="1303master" data-ref-filename="1303master">master</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>);</td></tr>
<tr><th id="6063">6063</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="6064">6064</th><td>	}</td></tr>
<tr><th id="6065">6065</th><td>	<a class="macro" href="../util/locks.h.html#102" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_lock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_lock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 6065, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_lock">lock_basic_lock</a>(&amp;<a class="local col9 ref" href="#1299xfr" title='xfr' data-ref="1299xfr" data-ref-filename="1299xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="6066">6066</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="6067">6067</th><td>}</td></tr>
<tr><th id="6068">6068</th><td></td></tr>
<tr><th id="6069">6069</th><td><i class="doc" data-doc="xfr_probe_send_or_end">/** move to sending the probe packets, next if fails. task_probe */</i></td></tr>
<tr><th id="6070">6070</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="6071">6071</th><td><dfn class="tu decl def fn" id="xfr_probe_send_or_end" title='xfr_probe_send_or_end' data-type='void xfr_probe_send_or_end(struct auth_xfer * xfr, struct module_env * env)' data-ref="xfr_probe_send_or_end" data-ref-filename="xfr_probe_send_or_end">xfr_probe_send_or_end</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col1 decl" id="1311xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1311xfr" data-ref-filename="1311xfr">xfr</dfn>, <b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col2 decl" id="1312env" title='env' data-type='struct module_env *' data-ref="1312env" data-ref-filename="1312env">env</dfn>)</td></tr>
<tr><th id="6072">6072</th><td>{</td></tr>
<tr><th id="6073">6073</th><td>	<i>/* are we doing hostname lookups? */</i></td></tr>
<tr><th id="6074">6074</th><td>	<b>while</b>(<a class="local col1 ref" href="#1311xfr" title='xfr' data-ref="1311xfr" data-ref-filename="1311xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::lookup_target" title='auth_probe::lookup_target' data-ref="auth_probe::lookup_target" data-ref-filename="auth_probe..lookup_target">lookup_target</a>) {</td></tr>
<tr><th id="6075">6075</th><td>		<b>if</b>(<a class="tu ref fn" href="#xfr_probe_lookup_host" title='xfr_probe_lookup_host' data-use='c' data-ref="xfr_probe_lookup_host" data-ref-filename="xfr_probe_lookup_host">xfr_probe_lookup_host</a>(<a class="local col1 ref" href="#1311xfr" title='xfr' data-ref="1311xfr" data-ref-filename="1311xfr">xfr</a>, <a class="local col2 ref" href="#1312env" title='env' data-ref="1312env" data-ref-filename="1312env">env</a>)) {</td></tr>
<tr><th id="6076">6076</th><td>			<i>/* wait for lookup to finish,</i></td></tr>
<tr><th id="6077">6077</th><td><i>			 * note that the hostname may be in unbound's cache</i></td></tr>
<tr><th id="6078">6078</th><td><i>			 * and we may then get an instant cache response,</i></td></tr>
<tr><th id="6079">6079</th><td><i>			 * and that calls the callback just like a full</i></td></tr>
<tr><th id="6080">6080</th><td><i>			 * lookup and lookup failures also call callback */</i></td></tr>
<tr><th id="6081">6081</th><td>			<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 6081, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col1 ref" href="#1311xfr" title='xfr' data-ref="1311xfr" data-ref-filename="1311xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="6082">6082</th><td>			<b>return</b>;</td></tr>
<tr><th id="6083">6083</th><td>		}</td></tr>
<tr><th id="6084">6084</th><td>		<a class="tu ref fn" href="#xfr_probe_move_to_next_lookup" title='xfr_probe_move_to_next_lookup' data-use='c' data-ref="xfr_probe_move_to_next_lookup" data-ref-filename="xfr_probe_move_to_next_lookup">xfr_probe_move_to_next_lookup</a>(<a class="local col1 ref" href="#1311xfr" title='xfr' data-ref="1311xfr" data-ref-filename="1311xfr">xfr</a>, <a class="local col2 ref" href="#1312env" title='env' data-ref="1312env" data-ref-filename="1312env">env</a>);</td></tr>
<tr><th id="6085">6085</th><td>	}</td></tr>
<tr><th id="6086">6086</th><td>	<i>/* probe of list has ended.  Create or refresh the list of of</i></td></tr>
<tr><th id="6087">6087</th><td><i>	 * allow_notify addrs */</i></td></tr>
<tr><th id="6088">6088</th><td>	<a class="tu ref fn" href="#probe_copy_masters_for_allow_notify" title='probe_copy_masters_for_allow_notify' data-use='c' data-ref="probe_copy_masters_for_allow_notify" data-ref-filename="probe_copy_masters_for_allow_notify">probe_copy_masters_for_allow_notify</a>(<a class="local col1 ref" href="#1311xfr" title='xfr' data-ref="1311xfr" data-ref-filename="1311xfr">xfr</a>);</td></tr>
<tr><th id="6089">6089</th><td>	<b>if</b>(<a class="local col1 ref" href="#1311xfr" title='xfr' data-ref="1311xfr" data-ref-filename="1311xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::only_lookup" title='auth_probe::only_lookup' data-ref="auth_probe::only_lookup" data-ref-filename="auth_probe..only_lookup">only_lookup</a>) {</td></tr>
<tr><th id="6090">6090</th><td>		<i>/* only wanted lookups for copy, stop probe and start wait */</i></td></tr>
<tr><th id="6091">6091</th><td>		<a class="local col1 ref" href="#1311xfr" title='xfr' data-ref="1311xfr" data-ref-filename="1311xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::only_lookup" title='auth_probe::only_lookup' data-ref="auth_probe::only_lookup" data-ref-filename="auth_probe..only_lookup">only_lookup</a> = <var>0</var>;</td></tr>
<tr><th id="6092">6092</th><td>		<a class="tu ref fn" href="#xfr_probe_disown" title='xfr_probe_disown' data-use='c' data-ref="xfr_probe_disown" data-ref-filename="xfr_probe_disown">xfr_probe_disown</a>(<a class="local col1 ref" href="#1311xfr" title='xfr' data-ref="1311xfr" data-ref-filename="1311xfr">xfr</a>);</td></tr>
<tr><th id="6093">6093</th><td>		<b>if</b>(<a class="local col1 ref" href="#1311xfr" title='xfr' data-ref="1311xfr" data-ref-filename="1311xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::worker" title='auth_nextprobe::worker' data-ref="auth_nextprobe::worker" data-ref-filename="auth_nextprobe..worker">worker</a> == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>)</td></tr>
<tr><th id="6094">6094</th><td>			<a class="tu ref fn" href="#xfr_set_timeout" title='xfr_set_timeout' data-use='c' data-ref="xfr_set_timeout" data-ref-filename="xfr_set_timeout">xfr_set_timeout</a>(<a class="local col1 ref" href="#1311xfr" title='xfr' data-ref="1311xfr" data-ref-filename="1311xfr">xfr</a>, <a class="local col2 ref" href="#1312env" title='env' data-ref="1312env" data-ref-filename="1312env">env</a>, <var>0</var>, <var>0</var>);</td></tr>
<tr><th id="6095">6095</th><td>		<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 6095, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col1 ref" href="#1311xfr" title='xfr' data-ref="1311xfr" data-ref-filename="1311xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="6096">6096</th><td>		<b>return</b>;</td></tr>
<tr><th id="6097">6097</th><td>	}</td></tr>
<tr><th id="6098">6098</th><td></td></tr>
<tr><th id="6099">6099</th><td>	<i>/* send probe packets */</i></td></tr>
<tr><th id="6100">6100</th><td>	<b>while</b>(!<a class="tu ref fn" href="#xfr_probe_end_of_list" title='xfr_probe_end_of_list' data-use='c' data-ref="xfr_probe_end_of_list" data-ref-filename="xfr_probe_end_of_list">xfr_probe_end_of_list</a>(<a class="local col1 ref" href="#1311xfr" title='xfr' data-ref="1311xfr" data-ref-filename="1311xfr">xfr</a>)) {</td></tr>
<tr><th id="6101">6101</th><td>		<b>if</b>(<a class="tu ref fn" href="#xfr_probe_send_probe" title='xfr_probe_send_probe' data-use='c' data-ref="xfr_probe_send_probe" data-ref-filename="xfr_probe_send_probe">xfr_probe_send_probe</a>(<a class="local col1 ref" href="#1311xfr" title='xfr' data-ref="1311xfr" data-ref-filename="1311xfr">xfr</a>, <a class="local col2 ref" href="#1312env" title='env' data-ref="1312env" data-ref-filename="1312env">env</a>, <a class="macro" href="#78" title="100" data-ref="_M/AUTH_PROBE_TIMEOUT">AUTH_PROBE_TIMEOUT</a>)) {</td></tr>
<tr><th id="6102">6102</th><td>			<i>/* successfully sent probe, wait for callback */</i></td></tr>
<tr><th id="6103">6103</th><td>			<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 6103, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col1 ref" href="#1311xfr" title='xfr' data-ref="1311xfr" data-ref-filename="1311xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="6104">6104</th><td>			<b>return</b>;</td></tr>
<tr><th id="6105">6105</th><td>		}</td></tr>
<tr><th id="6106">6106</th><td>		<i>/* failed to send probe, next master */</i></td></tr>
<tr><th id="6107">6107</th><td>		<a class="tu ref fn" href="#xfr_probe_nextmaster" title='xfr_probe_nextmaster' data-use='c' data-ref="xfr_probe_nextmaster" data-ref-filename="xfr_probe_nextmaster">xfr_probe_nextmaster</a>(<a class="local col1 ref" href="#1311xfr" title='xfr' data-ref="1311xfr" data-ref-filename="1311xfr">xfr</a>);</td></tr>
<tr><th id="6108">6108</th><td>	}</td></tr>
<tr><th id="6109">6109</th><td></td></tr>
<tr><th id="6110">6110</th><td>	<i>/* done with probe sequence, wait */</i></td></tr>
<tr><th id="6111">6111</th><td>	<b>if</b>(<a class="local col1 ref" href="#1311xfr" title='xfr' data-ref="1311xfr" data-ref-filename="1311xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::have_new_lease" title='auth_probe::have_new_lease' data-ref="auth_probe::have_new_lease" data-ref-filename="auth_probe..have_new_lease">have_new_lease</a>) {</td></tr>
<tr><th id="6112">6112</th><td>		<i>/* if zone not updated, start the wait timer again */</i></td></tr>
<tr><th id="6113">6113</th><td>		<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"auth_zone unchanged, new lease, wait"</q>);</td></tr>
<tr><th id="6114">6114</th><td>		<a class="tu ref fn" href="#xfr_probe_disown" title='xfr_probe_disown' data-use='c' data-ref="xfr_probe_disown" data-ref-filename="xfr_probe_disown">xfr_probe_disown</a>(<a class="local col1 ref" href="#1311xfr" title='xfr' data-ref="1311xfr" data-ref-filename="1311xfr">xfr</a>);</td></tr>
<tr><th id="6115">6115</th><td>		<b>if</b>(<a class="local col1 ref" href="#1311xfr" title='xfr' data-ref="1311xfr" data-ref-filename="1311xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::have_zone" title='auth_xfer::have_zone' data-ref="auth_xfer::have_zone" data-ref-filename="auth_xfer..have_zone">have_zone</a>)</td></tr>
<tr><th id="6116">6116</th><td>			<a class="local col1 ref" href="#1311xfr" title='xfr' data-ref="1311xfr" data-ref-filename="1311xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lease_time" title='auth_xfer::lease_time' data-ref="auth_xfer::lease_time" data-ref-filename="auth_xfer..lease_time">lease_time</a> = *<a class="local col2 ref" href="#1312env" title='env' data-ref="1312env" data-ref-filename="1312env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::now" title='module_env::now' data-ref="module_env::now" data-ref-filename="module_env..now">now</a>;</td></tr>
<tr><th id="6117">6117</th><td>		<b>if</b>(<a class="local col1 ref" href="#1311xfr" title='xfr' data-ref="1311xfr" data-ref-filename="1311xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::worker" title='auth_nextprobe::worker' data-ref="auth_nextprobe::worker" data-ref-filename="auth_nextprobe..worker">worker</a> == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>)</td></tr>
<tr><th id="6118">6118</th><td>			<a class="tu ref fn" href="#xfr_set_timeout" title='xfr_set_timeout' data-use='c' data-ref="xfr_set_timeout" data-ref-filename="xfr_set_timeout">xfr_set_timeout</a>(<a class="local col1 ref" href="#1311xfr" title='xfr' data-ref="1311xfr" data-ref-filename="1311xfr">xfr</a>, <a class="local col2 ref" href="#1312env" title='env' data-ref="1312env" data-ref-filename="1312env">env</a>, <var>0</var>, <var>0</var>);</td></tr>
<tr><th id="6119">6119</th><td>	} <b>else</b> {</td></tr>
<tr><th id="6120">6120</th><td>		<i>/* we failed to send this as well, move to the wait task,</i></td></tr>
<tr><th id="6121">6121</th><td><i>		 * use the shorter retry timeout */</i></td></tr>
<tr><th id="6122">6122</th><td>		<a class="tu ref fn" href="#xfr_probe_disown" title='xfr_probe_disown' data-use='c' data-ref="xfr_probe_disown" data-ref-filename="xfr_probe_disown">xfr_probe_disown</a>(<a class="local col1 ref" href="#1311xfr" title='xfr' data-ref="1311xfr" data-ref-filename="1311xfr">xfr</a>);</td></tr>
<tr><th id="6123">6123</th><td>		<i>/* pick up the nextprobe task and wait */</i></td></tr>
<tr><th id="6124">6124</th><td>		<b>if</b>(<a class="local col1 ref" href="#1311xfr" title='xfr' data-ref="1311xfr" data-ref-filename="1311xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::worker" title='auth_nextprobe::worker' data-ref="auth_nextprobe::worker" data-ref-filename="auth_nextprobe..worker">worker</a> == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>)</td></tr>
<tr><th id="6125">6125</th><td>			<a class="tu ref fn" href="#xfr_set_timeout" title='xfr_set_timeout' data-use='c' data-ref="xfr_set_timeout" data-ref-filename="xfr_set_timeout">xfr_set_timeout</a>(<a class="local col1 ref" href="#1311xfr" title='xfr' data-ref="1311xfr" data-ref-filename="1311xfr">xfr</a>, <a class="local col2 ref" href="#1312env" title='env' data-ref="1312env" data-ref-filename="1312env">env</a>, <var>1</var>, <var>0</var>);</td></tr>
<tr><th id="6126">6126</th><td>	}</td></tr>
<tr><th id="6127">6127</th><td></td></tr>
<tr><th id="6128">6128</th><td>	<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 6128, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col1 ref" href="#1311xfr" title='xfr' data-ref="1311xfr" data-ref-filename="1311xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="6129">6129</th><td>}</td></tr>
<tr><th id="6130">6130</th><td></td></tr>
<tr><th id="6131">6131</th><td><i class="doc">/** callback for task_probe lookup of host name, of A or AAAA */</i></td></tr>
<tr><th id="6132">6132</th><td><em>void</em> <dfn class="decl def fn" id="auth_xfer_probe_lookup_callback" title='auth_xfer_probe_lookup_callback' data-ref="auth_xfer_probe_lookup_callback" data-ref-filename="auth_xfer_probe_lookup_callback">auth_xfer_probe_lookup_callback</dfn>(<em>void</em>* <dfn class="local col3 decl" id="1313arg" title='arg' data-type='void *' data-ref="1313arg" data-ref-filename="1313arg">arg</dfn>, <em>int</em> <dfn class="local col4 decl" id="1314rcode" title='rcode' data-type='int' data-ref="1314rcode" data-ref-filename="1314rcode">rcode</dfn>, <a class="typedef" href="../sldns/sbuffer.h.html#sldns_buffer" title='sldns_buffer' data-type='struct sldns_buffer' data-ref="sldns_buffer" data-ref-filename="sldns_buffer">sldns_buffer</a>* <dfn class="local col5 decl" id="1315buf" title='buf' data-type='sldns_buffer *' data-ref="1315buf" data-ref-filename="1315buf">buf</dfn>,</td></tr>
<tr><th id="6133">6133</th><td>	<b>enum</b> <a class="type" href="../util/data/packed_rrset.h.html#sec_status" title='sec_status' data-ref="sec_status" data-ref-filename="sec_status">sec_status</a> <a class="macro" href="../../include/config.h.html#1057" title="sec __attribute__((unused))" data-ref="_M/ATTR_UNUSED">ATTR_UNUSED</a>(<dfn class="local col6 decl" id="1316sec" title='sec' data-type='enum sec_status' data-ref="1316sec" data-ref-filename="1316sec">sec</dfn>), <em>char</em>* <a class="macro" href="../../include/config.h.html#1057" title="why_bogus __attribute__((unused))" data-ref="_M/ATTR_UNUSED">ATTR_UNUSED</a>(<dfn class="local col7 decl" id="1317why_bogus" title='why_bogus' data-type='char *' data-ref="1317why_bogus" data-ref-filename="1317why_bogus">why_bogus</dfn>),</td></tr>
<tr><th id="6134">6134</th><td>	<em>int</em> <a class="macro" href="../../include/config.h.html#1057" title="was_ratelimited __attribute__((unused))" data-ref="_M/ATTR_UNUSED">ATTR_UNUSED</a>(<dfn class="local col8 decl" id="1318was_ratelimited" title='was_ratelimited' data-type='int' data-ref="1318was_ratelimited" data-ref-filename="1318was_ratelimited">was_ratelimited</dfn>))</td></tr>
<tr><th id="6135">6135</th><td>{</td></tr>
<tr><th id="6136">6136</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col9 decl" id="1319xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1319xfr" data-ref-filename="1319xfr">xfr</dfn> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>*)<a class="local col3 ref" href="#1313arg" title='arg' data-ref="1313arg" data-ref-filename="1313arg">arg</a>;</td></tr>
<tr><th id="6137">6137</th><td>	<b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col0 decl" id="1320env" title='env' data-type='struct module_env *' data-ref="1320env" data-ref-filename="1320env">env</dfn>;</td></tr>
<tr><th id="6138">6138</th><td>	<a class="macro" href="../util/log.h.html#211" title="" data-ref="_M/log_assert">log_assert</a>(xfr-&gt;task_probe);</td></tr>
<tr><th id="6139">6139</th><td>	<a class="macro" href="../util/locks.h.html#102" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_lock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_lock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 6139, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_lock">lock_basic_lock</a>(&amp;<a class="local col9 ref" href="#1319xfr" title='xfr' data-ref="1319xfr" data-ref-filename="1319xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="6140">6140</th><td>	<a class="local col0 ref" href="#1320env" title='env' data-ref="1320env" data-ref-filename="1320env">env</a> = <a class="local col9 ref" href="#1319xfr" title='xfr' data-ref="1319xfr" data-ref-filename="1319xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::env" title='auth_probe::env' data-ref="auth_probe::env" data-ref-filename="auth_probe..env">env</a>;</td></tr>
<tr><th id="6141">6141</th><td>	<b>if</b>(<a class="local col0 ref" href="#1320env" title='env' data-ref="1320env" data-ref-filename="1320env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::outnet" title='module_env::outnet' data-ref="module_env::outnet" data-ref-filename="module_env..outnet">outnet</a>-&gt;<a class="ref field" href="outside_network.h.html#outside_network::want_to_quit" title='outside_network::want_to_quit' data-ref="outside_network::want_to_quit" data-ref-filename="outside_network..want_to_quit">want_to_quit</a>) {</td></tr>
<tr><th id="6142">6142</th><td>		<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 6142, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col9 ref" href="#1319xfr" title='xfr' data-ref="1319xfr" data-ref-filename="1319xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="6143">6143</th><td>		<b>return</b>; <i>/* stop on quit */</i></td></tr>
<tr><th id="6144">6144</th><td>	}</td></tr>
<tr><th id="6145">6145</th><td></td></tr>
<tr><th id="6146">6146</th><td>	<i>/* process result */</i></td></tr>
<tr><th id="6147">6147</th><td>	<b>if</b>(<a class="local col4 ref" href="#1314rcode" title='rcode' data-ref="1314rcode" data-ref-filename="1314rcode">rcode</a> == <a class="enum" href="../sldns/pkthdr.h.html#LDNS_RCODE_NOERROR" title='LDNS_RCODE_NOERROR' data-ref="LDNS_RCODE_NOERROR" data-ref-filename="LDNS_RCODE_NOERROR">LDNS_RCODE_NOERROR</a>) {</td></tr>
<tr><th id="6148">6148</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col1 decl" id="1321wanted_qtype" title='wanted_qtype' data-type='uint16_t' data-ref="1321wanted_qtype" data-ref-filename="1321wanted_qtype">wanted_qtype</dfn> = <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_A" title='LDNS_RR_TYPE_A' data-ref="LDNS_RR_TYPE_A" data-ref-filename="LDNS_RR_TYPE_A">LDNS_RR_TYPE_A</a>;</td></tr>
<tr><th id="6149">6149</th><td>		<b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col2 decl" id="1322temp" title='temp' data-type='struct regional *' data-ref="1322temp" data-ref-filename="1322temp">temp</dfn> = <a class="local col0 ref" href="#1320env" title='env' data-ref="1320env" data-ref-filename="1320env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::scratch" title='module_env::scratch' data-ref="module_env::scratch" data-ref-filename="module_env..scratch">scratch</a>;</td></tr>
<tr><th id="6150">6150</th><td>		<b>struct</b> <a class="type" href="../util/data/msgreply.h.html#query_info" title='query_info' data-ref="query_info" data-ref-filename="query_info">query_info</a> <dfn class="local col3 decl" id="1323rq" title='rq' data-type='struct query_info' data-ref="1323rq" data-ref-filename="1323rq">rq</dfn>;</td></tr>
<tr><th id="6151">6151</th><td>		<b>struct</b> <a class="type" href="../util/data/msgreply.h.html#reply_info" title='reply_info' data-ref="reply_info" data-ref-filename="reply_info">reply_info</a>* <dfn class="local col4 decl" id="1324rep" title='rep' data-type='struct reply_info *' data-ref="1324rep" data-ref-filename="1324rep">rep</dfn>;</td></tr>
<tr><th id="6152">6152</th><td>		<b>if</b>(<a class="local col9 ref" href="#1319xfr" title='xfr' data-ref="1319xfr" data-ref-filename="1319xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::lookup_aaaa" title='auth_probe::lookup_aaaa' data-ref="auth_probe::lookup_aaaa" data-ref-filename="auth_probe..lookup_aaaa">lookup_aaaa</a>)</td></tr>
<tr><th id="6153">6153</th><td>			<a class="local col1 ref" href="#1321wanted_qtype" title='wanted_qtype' data-ref="1321wanted_qtype" data-ref-filename="1321wanted_qtype">wanted_qtype</a> = <a class="enum" href="../sldns/rrdef.h.html#LDNS_RR_TYPE_AAAA" title='LDNS_RR_TYPE_AAAA' data-ref="LDNS_RR_TYPE_AAAA" data-ref-filename="LDNS_RR_TYPE_AAAA">LDNS_RR_TYPE_AAAA</a>;</td></tr>
<tr><th id="6154">6154</th><td>		<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#97" title="((__builtin_object_size(&amp;rq, 0) != (size_t)-1) ? __builtin___memset_chk(&amp;rq, 0, sizeof(rq), __builtin_object_size(&amp;rq, 0)) : __memset_ichk(&amp;rq, 0, sizeof(rq)))" data-ref="_M/memset">memset</a>(&amp;<a class="local col3 ref" href="#1323rq" title='rq' data-ref="1323rq" data-ref-filename="1323rq">rq</a>, <var>0</var>, <b>sizeof</b>(<a class="local col3 ref" href="#1323rq" title='rq' data-ref="1323rq" data-ref-filename="1323rq">rq</a>));</td></tr>
<tr><th id="6155">6155</th><td>		<a class="local col4 ref" href="#1324rep" title='rep' data-ref="1324rep" data-ref-filename="1324rep">rep</a> = <a class="ref fn" href="../util/data/msgreply.h.html#parse_reply_in_temp_region" title='parse_reply_in_temp_region' data-ref="parse_reply_in_temp_region" data-ref-filename="parse_reply_in_temp_region">parse_reply_in_temp_region</a>(<a class="local col5 ref" href="#1315buf" title='buf' data-ref="1315buf" data-ref-filename="1315buf">buf</a>, <a class="local col2 ref" href="#1322temp" title='temp' data-ref="1322temp" data-ref-filename="1322temp">temp</a>, &amp;<a class="local col3 ref" href="#1323rq" title='rq' data-ref="1323rq" data-ref-filename="1323rq">rq</a>);</td></tr>
<tr><th id="6156">6156</th><td>		<b>if</b>(<a class="local col4 ref" href="#1324rep" title='rep' data-ref="1324rep" data-ref-filename="1324rep">rep</a> &amp;&amp; <a class="local col3 ref" href="#1323rq" title='rq' data-ref="1323rq" data-ref-filename="1323rq">rq</a>.<a class="ref field" href="../util/data/msgreply.h.html#query_info::qtype" title='query_info::qtype' data-ref="query_info::qtype" data-ref-filename="query_info..qtype">qtype</a> == <a class="local col1 ref" href="#1321wanted_qtype" title='wanted_qtype' data-ref="1321wanted_qtype" data-ref-filename="1321wanted_qtype">wanted_qtype</a> &amp;&amp;</td></tr>
<tr><th id="6157">6157</th><td>			<a class="macro" href="../util/net_help.h.html#73" title="((rep-&gt;flags) &amp; 0xf)" data-ref="_M/FLAGS_GET_RCODE">FLAGS_GET_RCODE</a>(<a class="local col4 ref" href="#1324rep" title='rep' data-ref="1324rep" data-ref-filename="1324rep">rep</a>-&gt;<a class="ref field" href="../util/data/msgreply.h.html#reply_info::flags" title='reply_info::flags' data-ref="reply_info::flags" data-ref-filename="reply_info..flags">flags</a>) == <a class="enum" href="../sldns/pkthdr.h.html#LDNS_RCODE_NOERROR" title='LDNS_RCODE_NOERROR' data-ref="LDNS_RCODE_NOERROR" data-ref-filename="LDNS_RCODE_NOERROR">LDNS_RCODE_NOERROR</a>) {</td></tr>
<tr><th id="6158">6158</th><td>			<i>/* parsed successfully */</i></td></tr>
<tr><th id="6159">6159</th><td>			<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key" title='ub_packed_rrset_key' data-ref="ub_packed_rrset_key" data-ref-filename="ub_packed_rrset_key">ub_packed_rrset_key</a>* <dfn class="local col5 decl" id="1325answer" title='answer' data-type='struct ub_packed_rrset_key *' data-ref="1325answer" data-ref-filename="1325answer">answer</dfn> =</td></tr>
<tr><th id="6160">6160</th><td>				<a class="ref fn" href="../util/data/msgreply.h.html#reply_find_answer_rrset" title='reply_find_answer_rrset' data-ref="reply_find_answer_rrset" data-ref-filename="reply_find_answer_rrset">reply_find_answer_rrset</a>(&amp;<a class="local col3 ref" href="#1323rq" title='rq' data-ref="1323rq" data-ref-filename="1323rq">rq</a>, <a class="local col4 ref" href="#1324rep" title='rep' data-ref="1324rep" data-ref-filename="1324rep">rep</a>);</td></tr>
<tr><th id="6161">6161</th><td>			<b>if</b>(<a class="local col5 ref" href="#1325answer" title='answer' data-ref="1325answer" data-ref-filename="1325answer">answer</a>) {</td></tr>
<tr><th id="6162">6162</th><td>				<a class="tu ref fn" href="#xfr_master_add_addrs" title='xfr_master_add_addrs' data-use='c' data-ref="xfr_master_add_addrs" data-ref-filename="xfr_master_add_addrs">xfr_master_add_addrs</a>(<a class="local col9 ref" href="#1319xfr" title='xfr' data-ref="1319xfr" data-ref-filename="1319xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;</td></tr>
<tr><th id="6163">6163</th><td>					<a class="ref field" href="authzone.h.html#auth_probe::lookup_target" title='auth_probe::lookup_target' data-ref="auth_probe::lookup_target" data-ref-filename="auth_probe..lookup_target">lookup_target</a>, <a class="local col5 ref" href="#1325answer" title='answer' data-ref="1325answer" data-ref-filename="1325answer">answer</a>, <a class="local col1 ref" href="#1321wanted_qtype" title='wanted_qtype' data-ref="1321wanted_qtype" data-ref-filename="1321wanted_qtype">wanted_qtype</a>);</td></tr>
<tr><th id="6164">6164</th><td>			}</td></tr>
<tr><th id="6165">6165</th><td>		}</td></tr>
<tr><th id="6166">6166</th><td>	}</td></tr>
<tr><th id="6167">6167</th><td>	<b>if</b>(<a class="local col9 ref" href="#1319xfr" title='xfr' data-ref="1319xfr" data-ref-filename="1319xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::lookup_target" title='auth_probe::lookup_target' data-ref="auth_probe::lookup_target" data-ref-filename="auth_probe..lookup_target">lookup_target</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::list" title='auth_master::list' data-ref="auth_master::list" data-ref-filename="auth_master..list">list</a> &amp;&amp;</td></tr>
<tr><th id="6168">6168</th><td>		<a class="local col9 ref" href="#1319xfr" title='xfr' data-ref="1319xfr" data-ref-filename="1319xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::lookup_target" title='auth_probe::lookup_target' data-ref="auth_probe::lookup_target" data-ref-filename="auth_probe..lookup_target">lookup_target</a> == <a class="tu ref fn" href="#xfr_probe_current_master" title='xfr_probe_current_master' data-use='c' data-ref="xfr_probe_current_master" data-ref-filename="xfr_probe_current_master">xfr_probe_current_master</a>(<a class="local col9 ref" href="#1319xfr" title='xfr' data-ref="1319xfr" data-ref-filename="1319xfr">xfr</a>))</td></tr>
<tr><th id="6169">6169</th><td>		<a class="local col9 ref" href="#1319xfr" title='xfr' data-ref="1319xfr" data-ref-filename="1319xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::scan_addr" title='auth_probe::scan_addr' data-ref="auth_probe::scan_addr" data-ref-filename="auth_probe..scan_addr">scan_addr</a> = <a class="local col9 ref" href="#1319xfr" title='xfr' data-ref="1319xfr" data-ref-filename="1319xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::lookup_target" title='auth_probe::lookup_target' data-ref="auth_probe::lookup_target" data-ref-filename="auth_probe..lookup_target">lookup_target</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::list" title='auth_master::list' data-ref="auth_master::list" data-ref-filename="auth_master..list">list</a>;</td></tr>
<tr><th id="6170">6170</th><td></td></tr>
<tr><th id="6171">6171</th><td>	<i>/* move to lookup AAAA after A lookup, move to next hostname lookup,</i></td></tr>
<tr><th id="6172">6172</th><td><i>	 * or move to send the probes, or, if nothing to do, end task_probe */</i></td></tr>
<tr><th id="6173">6173</th><td>	<a class="tu ref fn" href="#xfr_probe_move_to_next_lookup" title='xfr_probe_move_to_next_lookup' data-use='c' data-ref="xfr_probe_move_to_next_lookup" data-ref-filename="xfr_probe_move_to_next_lookup">xfr_probe_move_to_next_lookup</a>(<a class="local col9 ref" href="#1319xfr" title='xfr' data-ref="1319xfr" data-ref-filename="1319xfr">xfr</a>, <a class="local col0 ref" href="#1320env" title='env' data-ref="1320env" data-ref-filename="1320env">env</a>);</td></tr>
<tr><th id="6174">6174</th><td>	<a class="tu ref fn" href="#xfr_probe_send_or_end" title='xfr_probe_send_or_end' data-use='c' data-ref="xfr_probe_send_or_end" data-ref-filename="xfr_probe_send_or_end">xfr_probe_send_or_end</a>(<a class="local col9 ref" href="#1319xfr" title='xfr' data-ref="1319xfr" data-ref-filename="1319xfr">xfr</a>, <a class="local col0 ref" href="#1320env" title='env' data-ref="1320env" data-ref-filename="1320env">env</a>);</td></tr>
<tr><th id="6175">6175</th><td>}</td></tr>
<tr><th id="6176">6176</th><td></td></tr>
<tr><th id="6177">6177</th><td><i class="doc" data-doc="xfr_nextprobe_disown">/** disown task_nextprobe.  caller must hold xfr.lock */</i></td></tr>
<tr><th id="6178">6178</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="6179">6179</th><td><dfn class="tu decl def fn" id="xfr_nextprobe_disown" title='xfr_nextprobe_disown' data-type='void xfr_nextprobe_disown(struct auth_xfer * xfr)' data-ref="xfr_nextprobe_disown" data-ref-filename="xfr_nextprobe_disown">xfr_nextprobe_disown</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col6 decl" id="1326xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1326xfr" data-ref-filename="1326xfr">xfr</dfn>)</td></tr>
<tr><th id="6180">6180</th><td>{</td></tr>
<tr><th id="6181">6181</th><td>	<i>/* delete the timer, because the next worker to pick this up may</i></td></tr>
<tr><th id="6182">6182</th><td><i>	 * not have the same event base */</i></td></tr>
<tr><th id="6183">6183</th><td>	<a class="ref fn" href="../util/netevent.h.html#comm_timer_delete" title='comm_timer_delete' data-ref="comm_timer_delete" data-ref-filename="comm_timer_delete">comm_timer_delete</a>(<a class="local col6 ref" href="#1326xfr" title='xfr' data-ref="1326xfr" data-ref-filename="1326xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::timer" title='auth_nextprobe::timer' data-ref="auth_nextprobe::timer" data-ref-filename="auth_nextprobe..timer">timer</a>);</td></tr>
<tr><th id="6184">6184</th><td>	<a class="local col6 ref" href="#1326xfr" title='xfr' data-ref="1326xfr" data-ref-filename="1326xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::timer" title='auth_nextprobe::timer' data-ref="auth_nextprobe::timer" data-ref-filename="auth_nextprobe..timer">timer</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="6185">6185</th><td>	<a class="local col6 ref" href="#1326xfr" title='xfr' data-ref="1326xfr" data-ref-filename="1326xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::next_probe" title='auth_nextprobe::next_probe' data-ref="auth_nextprobe::next_probe" data-ref-filename="auth_nextprobe..next_probe">next_probe</a> = <var>0</var>;</td></tr>
<tr><th id="6186">6186</th><td>	<i>/* we don't own this item anymore */</i></td></tr>
<tr><th id="6187">6187</th><td>	<a class="local col6 ref" href="#1326xfr" title='xfr' data-ref="1326xfr" data-ref-filename="1326xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::worker" title='auth_nextprobe::worker' data-ref="auth_nextprobe::worker" data-ref-filename="auth_nextprobe..worker">worker</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="6188">6188</th><td>	<a class="local col6 ref" href="#1326xfr" title='xfr' data-ref="1326xfr" data-ref-filename="1326xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::env" title='auth_nextprobe::env' data-ref="auth_nextprobe::env" data-ref-filename="auth_nextprobe..env">env</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="6189">6189</th><td>}</td></tr>
<tr><th id="6190">6190</th><td></td></tr>
<tr><th id="6191">6191</th><td><i class="doc">/** xfer nextprobe timeout callback, this is part of task_nextprobe */</i></td></tr>
<tr><th id="6192">6192</th><td><em>void</em></td></tr>
<tr><th id="6193">6193</th><td><dfn class="decl def fn" id="auth_xfer_timer" title='auth_xfer_timer' data-ref="auth_xfer_timer" data-ref-filename="auth_xfer_timer">auth_xfer_timer</dfn>(<em>void</em>* <dfn class="local col7 decl" id="1327arg" title='arg' data-type='void *' data-ref="1327arg" data-ref-filename="1327arg">arg</dfn>)</td></tr>
<tr><th id="6194">6194</th><td>{</td></tr>
<tr><th id="6195">6195</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col8 decl" id="1328xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1328xfr" data-ref-filename="1328xfr">xfr</dfn> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>*)<a class="local col7 ref" href="#1327arg" title='arg' data-ref="1327arg" data-ref-filename="1327arg">arg</a>;</td></tr>
<tr><th id="6196">6196</th><td>	<b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col9 decl" id="1329env" title='env' data-type='struct module_env *' data-ref="1329env" data-ref-filename="1329env">env</dfn>;</td></tr>
<tr><th id="6197">6197</th><td>	<a class="macro" href="../util/log.h.html#211" title="" data-ref="_M/log_assert">log_assert</a>(xfr-&gt;task_nextprobe);</td></tr>
<tr><th id="6198">6198</th><td>	<a class="macro" href="../util/locks.h.html#102" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_lock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_lock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 6198, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_lock">lock_basic_lock</a>(&amp;<a class="local col8 ref" href="#1328xfr" title='xfr' data-ref="1328xfr" data-ref-filename="1328xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="6199">6199</th><td>	<a class="local col9 ref" href="#1329env" title='env' data-ref="1329env" data-ref-filename="1329env">env</a> = <a class="local col8 ref" href="#1328xfr" title='xfr' data-ref="1328xfr" data-ref-filename="1328xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::env" title='auth_nextprobe::env' data-ref="auth_nextprobe::env" data-ref-filename="auth_nextprobe..env">env</a>;</td></tr>
<tr><th id="6200">6200</th><td>	<b>if</b>(<a class="local col9 ref" href="#1329env" title='env' data-ref="1329env" data-ref-filename="1329env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::outnet" title='module_env::outnet' data-ref="module_env::outnet" data-ref-filename="module_env..outnet">outnet</a>-&gt;<a class="ref field" href="outside_network.h.html#outside_network::want_to_quit" title='outside_network::want_to_quit' data-ref="outside_network::want_to_quit" data-ref-filename="outside_network..want_to_quit">want_to_quit</a>) {</td></tr>
<tr><th id="6201">6201</th><td>		<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 6201, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col8 ref" href="#1328xfr" title='xfr' data-ref="1328xfr" data-ref-filename="1328xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="6202">6202</th><td>		<b>return</b>; <i>/* stop on quit */</i></td></tr>
<tr><th id="6203">6203</th><td>	}</td></tr>
<tr><th id="6204">6204</th><td></td></tr>
<tr><th id="6205">6205</th><td>	<i>/* see if zone has expired, and if so, also set auth_zone expired */</i></td></tr>
<tr><th id="6206">6206</th><td>	<b>if</b>(<a class="local col8 ref" href="#1328xfr" title='xfr' data-ref="1328xfr" data-ref-filename="1328xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::have_zone" title='auth_xfer::have_zone' data-ref="auth_xfer::have_zone" data-ref-filename="auth_xfer..have_zone">have_zone</a> &amp;&amp; !<a class="local col8 ref" href="#1328xfr" title='xfr' data-ref="1328xfr" data-ref-filename="1328xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::zone_expired" title='auth_xfer::zone_expired' data-ref="auth_xfer::zone_expired" data-ref-filename="auth_xfer..zone_expired">zone_expired</a> &amp;&amp;</td></tr>
<tr><th id="6207">6207</th><td>	   *<a class="local col9 ref" href="#1329env" title='env' data-ref="1329env" data-ref-filename="1329env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::now" title='module_env::now' data-ref="module_env::now" data-ref-filename="module_env..now">now</a> &gt;= <a class="local col8 ref" href="#1328xfr" title='xfr' data-ref="1328xfr" data-ref-filename="1328xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lease_time" title='auth_xfer::lease_time' data-ref="auth_xfer::lease_time" data-ref-filename="auth_xfer..lease_time">lease_time</a> + <a class="local col8 ref" href="#1328xfr" title='xfr' data-ref="1328xfr" data-ref-filename="1328xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::expiry" title='auth_xfer::expiry' data-ref="auth_xfer::expiry" data-ref-filename="auth_xfer..expiry">expiry</a>) {</td></tr>
<tr><th id="6208">6208</th><td>		<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 6208, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col8 ref" href="#1328xfr" title='xfr' data-ref="1328xfr" data-ref-filename="1328xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="6209">6209</th><td>		<a class="tu ref fn" href="#auth_xfer_set_expired" title='auth_xfer_set_expired' data-use='c' data-ref="auth_xfer_set_expired" data-ref-filename="auth_xfer_set_expired">auth_xfer_set_expired</a>(<a class="local col8 ref" href="#1328xfr" title='xfr' data-ref="1328xfr" data-ref-filename="1328xfr">xfr</a>, <a class="local col9 ref" href="#1329env" title='env' data-ref="1329env" data-ref-filename="1329env">env</a>, <var>1</var>);</td></tr>
<tr><th id="6210">6210</th><td>		<a class="macro" href="../util/locks.h.html#102" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_lock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_lock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 6210, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_lock">lock_basic_lock</a>(&amp;<a class="local col8 ref" href="#1328xfr" title='xfr' data-ref="1328xfr" data-ref-filename="1328xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="6211">6211</th><td>	}</td></tr>
<tr><th id="6212">6212</th><td></td></tr>
<tr><th id="6213">6213</th><td>	<a class="tu ref fn" href="#xfr_nextprobe_disown" title='xfr_nextprobe_disown' data-use='c' data-ref="xfr_nextprobe_disown" data-ref-filename="xfr_nextprobe_disown">xfr_nextprobe_disown</a>(<a class="local col8 ref" href="#1328xfr" title='xfr' data-ref="1328xfr" data-ref-filename="1328xfr">xfr</a>);</td></tr>
<tr><th id="6214">6214</th><td></td></tr>
<tr><th id="6215">6215</th><td>	<b>if</b>(!<a class="tu ref fn" href="#xfr_start_probe" title='xfr_start_probe' data-use='c' data-ref="xfr_start_probe" data-ref-filename="xfr_start_probe">xfr_start_probe</a>(<a class="local col8 ref" href="#1328xfr" title='xfr' data-ref="1328xfr" data-ref-filename="1328xfr">xfr</a>, <a class="local col9 ref" href="#1329env" title='env' data-ref="1329env" data-ref-filename="1329env">env</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>)) {</td></tr>
<tr><th id="6216">6216</th><td>		<i>/* not started because already in progress */</i></td></tr>
<tr><th id="6217">6217</th><td>		<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 6217, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col8 ref" href="#1328xfr" title='xfr' data-ref="1328xfr" data-ref-filename="1328xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="6218">6218</th><td>	}</td></tr>
<tr><th id="6219">6219</th><td>}</td></tr>
<tr><th id="6220">6220</th><td></td></tr>
<tr><th id="6221">6221</th><td><i class="doc" data-doc="have_probe_targets">/** return true if there are probe (SOA UDP query) targets in the master list*/</i></td></tr>
<tr><th id="6222">6222</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="6223">6223</th><td><dfn class="tu decl def fn" id="have_probe_targets" title='have_probe_targets' data-type='int have_probe_targets(struct auth_master * list)' data-ref="have_probe_targets" data-ref-filename="have_probe_targets">have_probe_targets</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>* <dfn class="local col0 decl" id="1330list" title='list' data-type='struct auth_master *' data-ref="1330list" data-ref-filename="1330list">list</dfn>)</td></tr>
<tr><th id="6224">6224</th><td>{</td></tr>
<tr><th id="6225">6225</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>* <dfn class="local col1 decl" id="1331p" title='p' data-type='struct auth_master *' data-ref="1331p" data-ref-filename="1331p">p</dfn>;</td></tr>
<tr><th id="6226">6226</th><td>	<b>for</b>(<a class="local col1 ref" href="#1331p" title='p' data-ref="1331p" data-ref-filename="1331p">p</a>=<a class="local col0 ref" href="#1330list" title='list' data-ref="1330list" data-ref-filename="1330list">list</a>; <a class="local col1 ref" href="#1331p" title='p' data-ref="1331p" data-ref-filename="1331p">p</a>; <a class="local col1 ref" href="#1331p" title='p' data-ref="1331p" data-ref-filename="1331p">p</a> = <a class="local col1 ref" href="#1331p" title='p' data-ref="1331p" data-ref-filename="1331p">p</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::next" title='auth_master::next' data-ref="auth_master::next" data-ref-filename="auth_master..next">next</a>) {</td></tr>
<tr><th id="6227">6227</th><td>		<b>if</b>(!<a class="local col1 ref" href="#1331p" title='p' data-ref="1331p" data-ref-filename="1331p">p</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::allow_notify" title='auth_master::allow_notify' data-ref="auth_master::allow_notify" data-ref-filename="auth_master..allow_notify">allow_notify</a> &amp;&amp; <a class="local col1 ref" href="#1331p" title='p' data-ref="1331p" data-ref-filename="1331p">p</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>)</td></tr>
<tr><th id="6228">6228</th><td>			<b>return</b> <var>1</var>;</td></tr>
<tr><th id="6229">6229</th><td>	}</td></tr>
<tr><th id="6230">6230</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="6231">6231</th><td>}</td></tr>
<tr><th id="6232">6232</th><td></td></tr>
<tr><th id="6233">6233</th><td><i class="doc" data-doc="xfr_start_probe">/** start task_probe if possible, if no masters for probe start task_transfer</i></td></tr>
<tr><th id="6234">6234</th><td><i class="doc" data-doc="xfr_start_probe"> * returns true if task has been started, and false if the task is already</i></td></tr>
<tr><th id="6235">6235</th><td><i class="doc" data-doc="xfr_start_probe"> * in progress. */</i></td></tr>
<tr><th id="6236">6236</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="6237">6237</th><td><dfn class="tu decl def fn" id="xfr_start_probe" title='xfr_start_probe' data-type='int xfr_start_probe(struct auth_xfer * xfr, struct module_env * env, struct auth_master * spec)' data-ref="xfr_start_probe" data-ref-filename="xfr_start_probe">xfr_start_probe</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col2 decl" id="1332xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1332xfr" data-ref-filename="1332xfr">xfr</dfn>, <b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col3 decl" id="1333env" title='env' data-type='struct module_env *' data-ref="1333env" data-ref-filename="1333env">env</dfn>,</td></tr>
<tr><th id="6238">6238</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>* <dfn class="local col4 decl" id="1334spec" title='spec' data-type='struct auth_master *' data-ref="1334spec" data-ref-filename="1334spec">spec</dfn>)</td></tr>
<tr><th id="6239">6239</th><td>{</td></tr>
<tr><th id="6240">6240</th><td>	<i>/* see if we need to start a probe (or maybe it is already in</i></td></tr>
<tr><th id="6241">6241</th><td><i>	 * progress (due to notify)) */</i></td></tr>
<tr><th id="6242">6242</th><td>	<b>if</b>(<a class="local col2 ref" href="#1332xfr" title='xfr' data-ref="1332xfr" data-ref-filename="1332xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::worker" title='auth_probe::worker' data-ref="auth_probe::worker" data-ref-filename="auth_probe..worker">worker</a> == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="6243">6243</th><td>		<b>if</b>(!<a class="tu ref fn" href="#have_probe_targets" title='have_probe_targets' data-use='c' data-ref="have_probe_targets" data-ref-filename="have_probe_targets">have_probe_targets</a>(<a class="local col2 ref" href="#1332xfr" title='xfr' data-ref="1332xfr" data-ref-filename="1332xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::masters" title='auth_probe::masters' data-ref="auth_probe::masters" data-ref-filename="auth_probe..masters">masters</a>) &amp;&amp;</td></tr>
<tr><th id="6244">6244</th><td>			!(<a class="local col2 ref" href="#1332xfr" title='xfr' data-ref="1332xfr" data-ref-filename="1332xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::only_lookup" title='auth_probe::only_lookup' data-ref="auth_probe::only_lookup" data-ref-filename="auth_probe..only_lookup">only_lookup</a> &amp;&amp;</td></tr>
<tr><th id="6245">6245</th><td>			<a class="local col2 ref" href="#1332xfr" title='xfr' data-ref="1332xfr" data-ref-filename="1332xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::masters" title='auth_probe::masters' data-ref="auth_probe::masters" data-ref-filename="auth_probe..masters">masters</a> != <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>)) {</td></tr>
<tr><th id="6246">6246</th><td>			<i>/* useless to pick up task_probe, no masters to</i></td></tr>
<tr><th id="6247">6247</th><td><i>			 * probe. Instead attempt to pick up task transfer */</i></td></tr>
<tr><th id="6248">6248</th><td>			<b>if</b>(<a class="local col2 ref" href="#1332xfr" title='xfr' data-ref="1332xfr" data-ref-filename="1332xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::worker" title='auth_transfer::worker' data-ref="auth_transfer::worker" data-ref-filename="auth_transfer..worker">worker</a> == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="6249">6249</th><td>				<a class="tu ref fn" href="#xfr_start_transfer" title='xfr_start_transfer' data-use='c' data-ref="xfr_start_transfer" data-ref-filename="xfr_start_transfer">xfr_start_transfer</a>(<a class="local col2 ref" href="#1332xfr" title='xfr' data-ref="1332xfr" data-ref-filename="1332xfr">xfr</a>, <a class="local col3 ref" href="#1333env" title='env' data-ref="1333env" data-ref-filename="1333env">env</a>, <a class="local col4 ref" href="#1334spec" title='spec' data-ref="1334spec" data-ref-filename="1334spec">spec</a>);</td></tr>
<tr><th id="6250">6250</th><td>				<b>return</b> <var>1</var>;</td></tr>
<tr><th id="6251">6251</th><td>			}</td></tr>
<tr><th id="6252">6252</th><td>			<i>/* task transfer already in progress */</i></td></tr>
<tr><th id="6253">6253</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="6254">6254</th><td>		}</td></tr>
<tr><th id="6255">6255</th><td></td></tr>
<tr><th id="6256">6256</th><td>		<i>/* pick up the probe task ourselves */</i></td></tr>
<tr><th id="6257">6257</th><td>		<a class="local col2 ref" href="#1332xfr" title='xfr' data-ref="1332xfr" data-ref-filename="1332xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::worker" title='auth_probe::worker' data-ref="auth_probe::worker" data-ref-filename="auth_probe..worker">worker</a> = <a class="local col3 ref" href="#1333env" title='env' data-ref="1333env" data-ref-filename="1333env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::worker" title='module_env::worker' data-ref="module_env::worker" data-ref-filename="module_env..worker">worker</a>;</td></tr>
<tr><th id="6258">6258</th><td>		<a class="local col2 ref" href="#1332xfr" title='xfr' data-ref="1332xfr" data-ref-filename="1332xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::env" title='auth_probe::env' data-ref="auth_probe::env" data-ref-filename="auth_probe..env">env</a> = <a class="local col3 ref" href="#1333env" title='env' data-ref="1333env" data-ref-filename="1333env">env</a>;</td></tr>
<tr><th id="6259">6259</th><td>		<a class="local col2 ref" href="#1332xfr" title='xfr' data-ref="1332xfr" data-ref-filename="1332xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::cp" title='auth_probe::cp' data-ref="auth_probe::cp" data-ref-filename="auth_probe..cp">cp</a> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="6260">6260</th><td></td></tr>
<tr><th id="6261">6261</th><td>		<i>/* start the task */</i></td></tr>
<tr><th id="6262">6262</th><td>		<i>/* have not seen a new lease yet, this scan */</i></td></tr>
<tr><th id="6263">6263</th><td>		<a class="local col2 ref" href="#1332xfr" title='xfr' data-ref="1332xfr" data-ref-filename="1332xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::have_new_lease" title='auth_probe::have_new_lease' data-ref="auth_probe::have_new_lease" data-ref-filename="auth_probe..have_new_lease">have_new_lease</a> = <var>0</var>;</td></tr>
<tr><th id="6264">6264</th><td>		<i>/* if this was a timeout, no specific first master to scan */</i></td></tr>
<tr><th id="6265">6265</th><td>		<i>/* otherwise, spec is nonNULL the notified master, scan</i></td></tr>
<tr><th id="6266">6266</th><td><i>		 * first and also transfer first from it */</i></td></tr>
<tr><th id="6267">6267</th><td>		<a class="tu ref fn" href="#xfr_probe_start_list" title='xfr_probe_start_list' data-use='c' data-ref="xfr_probe_start_list" data-ref-filename="xfr_probe_start_list">xfr_probe_start_list</a>(<a class="local col2 ref" href="#1332xfr" title='xfr' data-ref="1332xfr" data-ref-filename="1332xfr">xfr</a>, <a class="local col4 ref" href="#1334spec" title='spec' data-ref="1334spec" data-ref-filename="1334spec">spec</a>);</td></tr>
<tr><th id="6268">6268</th><td>		<i>/* setup to start the lookup of hostnames of masters afresh */</i></td></tr>
<tr><th id="6269">6269</th><td>		<a class="tu ref fn" href="#xfr_probe_start_lookups" title='xfr_probe_start_lookups' data-use='c' data-ref="xfr_probe_start_lookups" data-ref-filename="xfr_probe_start_lookups">xfr_probe_start_lookups</a>(<a class="local col2 ref" href="#1332xfr" title='xfr' data-ref="1332xfr" data-ref-filename="1332xfr">xfr</a>);</td></tr>
<tr><th id="6270">6270</th><td>		<i>/* send the probe packet or next send, or end task */</i></td></tr>
<tr><th id="6271">6271</th><td>		<a class="tu ref fn" href="#xfr_probe_send_or_end" title='xfr_probe_send_or_end' data-use='c' data-ref="xfr_probe_send_or_end" data-ref-filename="xfr_probe_send_or_end">xfr_probe_send_or_end</a>(<a class="local col2 ref" href="#1332xfr" title='xfr' data-ref="1332xfr" data-ref-filename="1332xfr">xfr</a>, <a class="local col3 ref" href="#1333env" title='env' data-ref="1333env" data-ref-filename="1333env">env</a>);</td></tr>
<tr><th id="6272">6272</th><td>		<b>return</b> <var>1</var>;</td></tr>
<tr><th id="6273">6273</th><td>	}</td></tr>
<tr><th id="6274">6274</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="6275">6275</th><td>}</td></tr>
<tr><th id="6276">6276</th><td></td></tr>
<tr><th id="6277">6277</th><td><i class="doc" data-doc="xfr_set_timeout">/** for task_nextprobe.</i></td></tr>
<tr><th id="6278">6278</th><td><i class="doc" data-doc="xfr_set_timeout"> * determine next timeout for auth_xfer. Also (re)sets timer.</i></td></tr>
<tr><th id="6279">6279</th><td><i class="doc" data-doc="xfr_set_timeout"> * <span class="command">@param</span> <span class="arg">xfr:</span> task structure</i></td></tr>
<tr><th id="6280">6280</th><td><i class="doc" data-doc="xfr_set_timeout"> * <span class="command">@param</span> <span class="arg">env:</span> module environment, with worker and time.</i></td></tr>
<tr><th id="6281">6281</th><td><i class="doc" data-doc="xfr_set_timeout"> * <span class="command">@param</span> <span class="arg">failure:</span> set true if timer should be set for failure retry.</i></td></tr>
<tr><th id="6282">6282</th><td><i class="doc" data-doc="xfr_set_timeout"> * <span class="command">@param</span> <span class="arg">lookup_only:</span> only perform lookups when timer done, 0 sec timeout</i></td></tr>
<tr><th id="6283">6283</th><td><i class="doc" data-doc="xfr_set_timeout"> */</i></td></tr>
<tr><th id="6284">6284</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="6285">6285</th><td><dfn class="tu decl def fn" id="xfr_set_timeout" title='xfr_set_timeout' data-type='void xfr_set_timeout(struct auth_xfer * xfr, struct module_env * env, int failure, int lookup_only)' data-ref="xfr_set_timeout" data-ref-filename="xfr_set_timeout">xfr_set_timeout</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col5 decl" id="1335xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</dfn>, <b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col6 decl" id="1336env" title='env' data-type='struct module_env *' data-ref="1336env" data-ref-filename="1336env">env</dfn>,</td></tr>
<tr><th id="6286">6286</th><td>	<em>int</em> <dfn class="local col7 decl" id="1337failure" title='failure' data-type='int' data-ref="1337failure" data-ref-filename="1337failure">failure</dfn>, <em>int</em> <dfn class="local col8 decl" id="1338lookup_only" title='lookup_only' data-type='int' data-ref="1338lookup_only" data-ref-filename="1338lookup_only">lookup_only</dfn>)</td></tr>
<tr><th id="6287">6287</th><td>{</td></tr>
<tr><th id="6288">6288</th><td>	<b>struct</b> <a class="type" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/time.h.html#timeval" title='timeval' data-ref="timeval" data-ref-filename="timeval">timeval</a> <dfn class="local col9 decl" id="1339tv" title='tv' data-type='struct timeval' data-ref="1339tv" data-ref-filename="1339tv">tv</dfn>;</td></tr>
<tr><th id="6289">6289</th><td>	<a class="macro" href="../util/log.h.html#211" title="" data-ref="_M/log_assert">log_assert</a>(xfr-&gt;task_nextprobe != NULL);</td></tr>
<tr><th id="6290">6290</th><td>	<a class="macro" href="../util/log.h.html#211" title="" data-ref="_M/log_assert">log_assert</a>(xfr-&gt;task_nextprobe-&gt;worker == NULL ||</td></tr>
<tr><th id="6291">6291</th><td>		xfr-&gt;task_nextprobe-&gt;worker == env-&gt;worker);</td></tr>
<tr><th id="6292">6292</th><td>	<i>/* normally, nextprobe = startoflease + refresh,</i></td></tr>
<tr><th id="6293">6293</th><td><i>	 * but if expiry is sooner, use that one.</i></td></tr>
<tr><th id="6294">6294</th><td><i>	 * after a failure, use the retry timer instead. */</i></td></tr>
<tr><th id="6295">6295</th><td>	<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::next_probe" title='auth_nextprobe::next_probe' data-ref="auth_nextprobe::next_probe" data-ref-filename="auth_nextprobe..next_probe">next_probe</a> = *<a class="local col6 ref" href="#1336env" title='env' data-ref="1336env" data-ref-filename="1336env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::now" title='module_env::now' data-ref="module_env::now" data-ref-filename="module_env..now">now</a>;</td></tr>
<tr><th id="6296">6296</th><td>	<b>if</b>(<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lease_time" title='auth_xfer::lease_time' data-ref="auth_xfer::lease_time" data-ref-filename="auth_xfer..lease_time">lease_time</a> &amp;&amp; !<a class="local col7 ref" href="#1337failure" title='failure' data-ref="1337failure" data-ref-filename="1337failure">failure</a>)</td></tr>
<tr><th id="6297">6297</th><td>		<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::next_probe" title='auth_nextprobe::next_probe' data-ref="auth_nextprobe::next_probe" data-ref-filename="auth_nextprobe..next_probe">next_probe</a> = <a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lease_time" title='auth_xfer::lease_time' data-ref="auth_xfer::lease_time" data-ref-filename="auth_xfer..lease_time">lease_time</a>;</td></tr>
<tr><th id="6298">6298</th><td>	</td></tr>
<tr><th id="6299">6299</th><td>	<b>if</b>(!<a class="local col7 ref" href="#1337failure" title='failure' data-ref="1337failure" data-ref-filename="1337failure">failure</a>) {</td></tr>
<tr><th id="6300">6300</th><td>		<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::backoff" title='auth_nextprobe::backoff' data-ref="auth_nextprobe::backoff" data-ref-filename="auth_nextprobe..backoff">backoff</a> = <var>0</var>;</td></tr>
<tr><th id="6301">6301</th><td>	} <b>else</b> {</td></tr>
<tr><th id="6302">6302</th><td>		<b>if</b>(<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::backoff" title='auth_nextprobe::backoff' data-ref="auth_nextprobe::backoff" data-ref-filename="auth_nextprobe..backoff">backoff</a> == <var>0</var>)</td></tr>
<tr><th id="6303">6303</th><td>				<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::backoff" title='auth_nextprobe::backoff' data-ref="auth_nextprobe::backoff" data-ref-filename="auth_nextprobe..backoff">backoff</a> = <var>3</var>;</td></tr>
<tr><th id="6304">6304</th><td>		<b>else</b>	<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::backoff" title='auth_nextprobe::backoff' data-ref="auth_nextprobe::backoff" data-ref-filename="auth_nextprobe..backoff">backoff</a> *= <var>2</var>;</td></tr>
<tr><th id="6305">6305</th><td>		<b>if</b>(<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::backoff" title='auth_nextprobe::backoff' data-ref="auth_nextprobe::backoff" data-ref-filename="auth_nextprobe..backoff">backoff</a> &gt; <a class="macro" href="#84" title="86400" data-ref="_M/AUTH_TRANSFER_MAX_BACKOFF">AUTH_TRANSFER_MAX_BACKOFF</a>)</td></tr>
<tr><th id="6306">6306</th><td>			<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::backoff" title='auth_nextprobe::backoff' data-ref="auth_nextprobe::backoff" data-ref-filename="auth_nextprobe..backoff">backoff</a> =</td></tr>
<tr><th id="6307">6307</th><td>				<a class="macro" href="#84" title="86400" data-ref="_M/AUTH_TRANSFER_MAX_BACKOFF">AUTH_TRANSFER_MAX_BACKOFF</a>;</td></tr>
<tr><th id="6308">6308</th><td>	}</td></tr>
<tr><th id="6309">6309</th><td></td></tr>
<tr><th id="6310">6310</th><td>	<b>if</b>(<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::have_zone" title='auth_xfer::have_zone' data-ref="auth_xfer::have_zone" data-ref-filename="auth_xfer..have_zone">have_zone</a>) {</td></tr>
<tr><th id="6311">6311</th><td>		<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#time_t" title='time_t' data-type='__int64_t' data-ref="time_t" data-ref-filename="time_t">time_t</a> <dfn class="local col0 decl" id="1340wait" title='wait' data-type='time_t' data-ref="1340wait" data-ref-filename="1340wait">wait</dfn> = <a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::refresh" title='auth_xfer::refresh' data-ref="auth_xfer::refresh" data-ref-filename="auth_xfer..refresh">refresh</a>;</td></tr>
<tr><th id="6312">6312</th><td>		<b>if</b>(<a class="local col7 ref" href="#1337failure" title='failure' data-ref="1337failure" data-ref-filename="1337failure">failure</a>) <a class="local col0 ref" href="#1340wait" title='wait' data-ref="1340wait" data-ref-filename="1340wait">wait</a> = <a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::retry" title='auth_xfer::retry' data-ref="auth_xfer::retry" data-ref-filename="auth_xfer..retry">retry</a>;</td></tr>
<tr><th id="6313">6313</th><td>		<b>if</b>(<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::expiry" title='auth_xfer::expiry' data-ref="auth_xfer::expiry" data-ref-filename="auth_xfer..expiry">expiry</a> &lt; <a class="local col0 ref" href="#1340wait" title='wait' data-ref="1340wait" data-ref-filename="1340wait">wait</a>)</td></tr>
<tr><th id="6314">6314</th><td>			<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::next_probe" title='auth_nextprobe::next_probe' data-ref="auth_nextprobe::next_probe" data-ref-filename="auth_nextprobe..next_probe">next_probe</a> += <a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::expiry" title='auth_xfer::expiry' data-ref="auth_xfer::expiry" data-ref-filename="auth_xfer..expiry">expiry</a>;</td></tr>
<tr><th id="6315">6315</th><td>		<b>else</b>	<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::next_probe" title='auth_nextprobe::next_probe' data-ref="auth_nextprobe::next_probe" data-ref-filename="auth_nextprobe..next_probe">next_probe</a> += <a class="local col0 ref" href="#1340wait" title='wait' data-ref="1340wait" data-ref-filename="1340wait">wait</a>;</td></tr>
<tr><th id="6316">6316</th><td>		<b>if</b>(<a class="local col7 ref" href="#1337failure" title='failure' data-ref="1337failure" data-ref-filename="1337failure">failure</a>)</td></tr>
<tr><th id="6317">6317</th><td>			<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::next_probe" title='auth_nextprobe::next_probe' data-ref="auth_nextprobe::next_probe" data-ref-filename="auth_nextprobe..next_probe">next_probe</a> +=</td></tr>
<tr><th id="6318">6318</th><td>				<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::backoff" title='auth_nextprobe::backoff' data-ref="auth_nextprobe::backoff" data-ref-filename="auth_nextprobe..backoff">backoff</a>;</td></tr>
<tr><th id="6319">6319</th><td>		<i>/* put the timer exactly on expiry, if possible */</i></td></tr>
<tr><th id="6320">6320</th><td>		<b>if</b>(<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lease_time" title='auth_xfer::lease_time' data-ref="auth_xfer::lease_time" data-ref-filename="auth_xfer..lease_time">lease_time</a> &amp;&amp; <a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lease_time" title='auth_xfer::lease_time' data-ref="auth_xfer::lease_time" data-ref-filename="auth_xfer..lease_time">lease_time</a>+<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::expiry" title='auth_xfer::expiry' data-ref="auth_xfer::expiry" data-ref-filename="auth_xfer..expiry">expiry</a> &lt;</td></tr>
<tr><th id="6321">6321</th><td>			<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::next_probe" title='auth_nextprobe::next_probe' data-ref="auth_nextprobe::next_probe" data-ref-filename="auth_nextprobe..next_probe">next_probe</a> &amp;&amp;</td></tr>
<tr><th id="6322">6322</th><td>			<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lease_time" title='auth_xfer::lease_time' data-ref="auth_xfer::lease_time" data-ref-filename="auth_xfer..lease_time">lease_time</a>+<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::expiry" title='auth_xfer::expiry' data-ref="auth_xfer::expiry" data-ref-filename="auth_xfer..expiry">expiry</a> &gt; *<a class="local col6 ref" href="#1336env" title='env' data-ref="1336env" data-ref-filename="1336env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::now" title='module_env::now' data-ref="module_env::now" data-ref-filename="module_env..now">now</a>)</td></tr>
<tr><th id="6323">6323</th><td>			<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::next_probe" title='auth_nextprobe::next_probe' data-ref="auth_nextprobe::next_probe" data-ref-filename="auth_nextprobe..next_probe">next_probe</a> =</td></tr>
<tr><th id="6324">6324</th><td>				<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lease_time" title='auth_xfer::lease_time' data-ref="auth_xfer::lease_time" data-ref-filename="auth_xfer..lease_time">lease_time</a>+<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::expiry" title='auth_xfer::expiry' data-ref="auth_xfer::expiry" data-ref-filename="auth_xfer..expiry">expiry</a>;</td></tr>
<tr><th id="6325">6325</th><td>	} <b>else</b> {</td></tr>
<tr><th id="6326">6326</th><td>		<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::next_probe" title='auth_nextprobe::next_probe' data-ref="auth_nextprobe::next_probe" data-ref-filename="auth_nextprobe..next_probe">next_probe</a> +=</td></tr>
<tr><th id="6327">6327</th><td>			<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::backoff" title='auth_nextprobe::backoff' data-ref="auth_nextprobe::backoff" data-ref-filename="auth_nextprobe..backoff">backoff</a>;</td></tr>
<tr><th id="6328">6328</th><td>	}</td></tr>
<tr><th id="6329">6329</th><td></td></tr>
<tr><th id="6330">6330</th><td>	<b>if</b>(!<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::timer" title='auth_nextprobe::timer' data-ref="auth_nextprobe::timer" data-ref-filename="auth_nextprobe..timer">timer</a>) {</td></tr>
<tr><th id="6331">6331</th><td>		<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::timer" title='auth_nextprobe::timer' data-ref="auth_nextprobe::timer" data-ref-filename="auth_nextprobe..timer">timer</a> = <a class="ref fn" href="../util/netevent.h.html#comm_timer_create" title='comm_timer_create' data-ref="comm_timer_create" data-ref-filename="comm_timer_create">comm_timer_create</a>(</td></tr>
<tr><th id="6332">6332</th><td>			<a class="local col6 ref" href="#1336env" title='env' data-ref="1336env" data-ref-filename="1336env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::worker_base" title='module_env::worker_base' data-ref="module_env::worker_base" data-ref-filename="module_env..worker_base">worker_base</a>, <a class="ref fn" href="#auth_xfer_timer" title='auth_xfer_timer' data-ref="auth_xfer_timer" data-ref-filename="auth_xfer_timer">auth_xfer_timer</a>, <a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>);</td></tr>
<tr><th id="6333">6333</th><td>		<b>if</b>(!<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::timer" title='auth_nextprobe::timer' data-ref="auth_nextprobe::timer" data-ref-filename="auth_nextprobe..timer">timer</a>) {</td></tr>
<tr><th id="6334">6334</th><td>			<i>/* failed to malloc memory. likely zone transfer</i></td></tr>
<tr><th id="6335">6335</th><td><i>			 * also fails for that. skip the timeout */</i></td></tr>
<tr><th id="6336">6336</th><td>			<em>char</em> <dfn class="local col1 decl" id="1341zname" title='zname' data-type='char [256]' data-ref="1341zname" data-ref-filename="1341zname">zname</dfn>[<var>255</var>+<var>1</var>];</td></tr>
<tr><th id="6337">6337</th><td>			<a class="ref fn" href="../util/data/dname.h.html#dname_str" title='dname_str' data-ref="dname_str" data-ref-filename="dname_str">dname_str</a>(<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a>, <a class="local col1 ref" href="#1341zname" title='zname' data-ref="1341zname" data-ref-filename="1341zname">zname</a>);</td></tr>
<tr><th id="6338">6338</th><td>			<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"cannot allocate timer, no refresh for %s"</q>,</td></tr>
<tr><th id="6339">6339</th><td>				<a class="local col1 ref" href="#1341zname" title='zname' data-ref="1341zname" data-ref-filename="1341zname">zname</a>);</td></tr>
<tr><th id="6340">6340</th><td>			<b>return</b>;</td></tr>
<tr><th id="6341">6341</th><td>		}</td></tr>
<tr><th id="6342">6342</th><td>	}</td></tr>
<tr><th id="6343">6343</th><td>	<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::worker" title='auth_nextprobe::worker' data-ref="auth_nextprobe::worker" data-ref-filename="auth_nextprobe..worker">worker</a> = <a class="local col6 ref" href="#1336env" title='env' data-ref="1336env" data-ref-filename="1336env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::worker" title='module_env::worker' data-ref="module_env::worker" data-ref-filename="module_env..worker">worker</a>;</td></tr>
<tr><th id="6344">6344</th><td>	<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::env" title='auth_nextprobe::env' data-ref="auth_nextprobe::env" data-ref-filename="auth_nextprobe..env">env</a> = <a class="local col6 ref" href="#1336env" title='env' data-ref="1336env" data-ref-filename="1336env">env</a>;</td></tr>
<tr><th id="6345">6345</th><td>	<b>if</b>(*(<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::env" title='auth_nextprobe::env' data-ref="auth_nextprobe::env" data-ref-filename="auth_nextprobe..env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::now" title='module_env::now' data-ref="module_env::now" data-ref-filename="module_env..now">now</a>) &lt;= <a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::next_probe" title='auth_nextprobe::next_probe' data-ref="auth_nextprobe::next_probe" data-ref-filename="auth_nextprobe..next_probe">next_probe</a>)</td></tr>
<tr><th id="6346">6346</th><td>		<a class="local col9 ref" href="#1339tv" title='tv' data-ref="1339tv" data-ref-filename="1339tv">tv</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/time.h.html#timeval::tv_sec" title='timeval::tv_sec' data-ref="timeval::tv_sec" data-ref-filename="timeval..tv_sec">tv_sec</a> = <a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::next_probe" title='auth_nextprobe::next_probe' data-ref="auth_nextprobe::next_probe" data-ref-filename="auth_nextprobe..next_probe">next_probe</a> - </td></tr>
<tr><th id="6347">6347</th><td>			*(<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::env" title='auth_nextprobe::env' data-ref="auth_nextprobe::env" data-ref-filename="auth_nextprobe..env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::now" title='module_env::now' data-ref="module_env::now" data-ref-filename="module_env..now">now</a>);</td></tr>
<tr><th id="6348">6348</th><td>	<b>else</b>	<a class="local col9 ref" href="#1339tv" title='tv' data-ref="1339tv" data-ref-filename="1339tv">tv</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/time.h.html#timeval::tv_sec" title='timeval::tv_sec' data-ref="timeval::tv_sec" data-ref-filename="timeval..tv_sec">tv_sec</a> = <var>0</var>;</td></tr>
<tr><th id="6349">6349</th><td>	<b>if</b>(<a class="local col9 ref" href="#1339tv" title='tv' data-ref="1339tv" data-ref-filename="1339tv">tv</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/time.h.html#timeval::tv_sec" title='timeval::tv_sec' data-ref="timeval::tv_sec" data-ref-filename="timeval..tv_sec">tv_sec</a> != <var>0</var> &amp;&amp; <a class="local col8 ref" href="#1338lookup_only" title='lookup_only' data-ref="1338lookup_only" data-ref-filename="1338lookup_only">lookup_only</a> &amp;&amp; <a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::masters" title='auth_probe::masters' data-ref="auth_probe::masters" data-ref-filename="auth_probe..masters">masters</a>) {</td></tr>
<tr><th id="6350">6350</th><td>		<i>/* don't lookup_only, if lookup timeout is 0 anyway,</i></td></tr>
<tr><th id="6351">6351</th><td><i>		 * or if we don't have masters to lookup */</i></td></tr>
<tr><th id="6352">6352</th><td>		<a class="local col9 ref" href="#1339tv" title='tv' data-ref="1339tv" data-ref-filename="1339tv">tv</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/time.h.html#timeval::tv_sec" title='timeval::tv_sec' data-ref="timeval::tv_sec" data-ref-filename="timeval..tv_sec">tv_sec</a> = <var>0</var>;</td></tr>
<tr><th id="6353">6353</th><td>		<b>if</b>(<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a> &amp;&amp; <a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::worker" title='auth_probe::worker' data-ref="auth_probe::worker" data-ref-filename="auth_probe..worker">worker</a> == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>)</td></tr>
<tr><th id="6354">6354</th><td>			<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::only_lookup" title='auth_probe::only_lookup' data-ref="auth_probe::only_lookup" data-ref-filename="auth_probe..only_lookup">only_lookup</a> = <var>1</var>;</td></tr>
<tr><th id="6355">6355</th><td>	}</td></tr>
<tr><th id="6356">6356</th><td>	<b>if</b>(<a class="ref" href="../util/log.h.html#verbosity" title='verbosity' data-ref="verbosity" data-ref-filename="verbosity">verbosity</a> &gt;= <a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>) {</td></tr>
<tr><th id="6357">6357</th><td>		<em>char</em> <dfn class="local col2 decl" id="1342zname" title='zname' data-type='char [256]' data-ref="1342zname" data-ref-filename="1342zname">zname</dfn>[<var>255</var>+<var>1</var>];</td></tr>
<tr><th id="6358">6358</th><td>		<a class="ref fn" href="../util/data/dname.h.html#dname_str" title='dname_str' data-ref="dname_str" data-ref-filename="dname_str">dname_str</a>(<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a>, <a class="local col2 ref" href="#1342zname" title='zname' data-ref="1342zname" data-ref-filename="1342zname">zname</a>);</td></tr>
<tr><th id="6359">6359</th><td>		<a class="ref fn" href="../util/log.h.html#verbose" title='verbose' data-ref="verbose" data-ref-filename="verbose">verbose</a>(<a class="enum" href="../util/log.h.html#VERB_ALGO" title='VERB_ALGO' data-ref="VERB_ALGO" data-ref-filename="VERB_ALGO">VERB_ALGO</a>, <q>"auth zone %s timeout in %d seconds"</q>,</td></tr>
<tr><th id="6360">6360</th><td>			<a class="local col2 ref" href="#1342zname" title='zname' data-ref="1342zname" data-ref-filename="1342zname">zname</a>, (<em>int</em>)<a class="local col9 ref" href="#1339tv" title='tv' data-ref="1339tv" data-ref-filename="1339tv">tv</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/time.h.html#timeval::tv_sec" title='timeval::tv_sec' data-ref="timeval::tv_sec" data-ref-filename="timeval..tv_sec">tv_sec</a>);</td></tr>
<tr><th id="6361">6361</th><td>	}</td></tr>
<tr><th id="6362">6362</th><td>	<a class="local col9 ref" href="#1339tv" title='tv' data-ref="1339tv" data-ref-filename="1339tv">tv</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/time.h.html#timeval::tv_usec" title='timeval::tv_usec' data-ref="timeval::tv_usec" data-ref-filename="timeval..tv_usec">tv_usec</a> = <var>0</var>;</td></tr>
<tr><th id="6363">6363</th><td>	<a class="ref fn" href="../util/netevent.h.html#comm_timer_set" title='comm_timer_set' data-ref="comm_timer_set" data-ref-filename="comm_timer_set">comm_timer_set</a>(<a class="local col5 ref" href="#1335xfr" title='xfr' data-ref="1335xfr" data-ref-filename="1335xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::timer" title='auth_nextprobe::timer' data-ref="auth_nextprobe::timer" data-ref-filename="auth_nextprobe..timer">timer</a>, &amp;<a class="local col9 ref" href="#1339tv" title='tv' data-ref="1339tv" data-ref-filename="1339tv">tv</a>);</td></tr>
<tr><th id="6364">6364</th><td>}</td></tr>
<tr><th id="6365">6365</th><td></td></tr>
<tr><th id="6366">6366</th><td><i class="doc">/** initial pick up of worker timeouts, ties events to worker event loop */</i></td></tr>
<tr><th id="6367">6367</th><td><em>void</em></td></tr>
<tr><th id="6368">6368</th><td><dfn class="decl def fn" id="auth_xfer_pickup_initial" title='auth_xfer_pickup_initial' data-ref="auth_xfer_pickup_initial" data-ref-filename="auth_xfer_pickup_initial">auth_xfer_pickup_initial</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zones" title='auth_zones' data-ref="auth_zones" data-ref-filename="auth_zones">auth_zones</a>* <dfn class="local col3 decl" id="1343az" title='az' data-type='struct auth_zones *' data-ref="1343az" data-ref-filename="1343az">az</dfn>, <b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col4 decl" id="1344env" title='env' data-type='struct module_env *' data-ref="1344env" data-ref-filename="1344env">env</dfn>)</td></tr>
<tr><th id="6369">6369</th><td>{</td></tr>
<tr><th id="6370">6370</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col5 decl" id="1345x" title='x' data-type='struct auth_xfer *' data-ref="1345x" data-ref-filename="1345x">x</dfn>;</td></tr>
<tr><th id="6371">6371</th><td>	<a class="macro" href="../util/locks.h.html#120" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_wrlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_wrlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 6371, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_wrlock">lock_rw_wrlock</a>(&amp;<a class="local col3 ref" href="#1343az" title='az' data-ref="1343az" data-ref-filename="1343az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="6372">6372</th><td>	<a class="macro" href="../util/rbtree.h.html#173" title="for(x=(struct auth_xfer*)rbtree_first(&amp;az-&gt;xtree); (rbnode_type*)x != &amp;rbtree_null_node; x = (struct auth_xfer*)rbtree_next((rbnode_type*)x))" data-ref="_M/RBTREE_FOR">RBTREE_FOR</a>(<a class="local col5 ref" href="#1345x" title='x' data-ref="1345x" data-ref-filename="1345x">x</a>, <b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>*, &amp;<a class="local col3 ref" href="#1343az" title='az' data-ref="1343az" data-ref-filename="1343az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::xtree" title='auth_zones::xtree' data-ref="auth_zones::xtree" data-ref-filename="auth_zones..xtree">xtree</a>) {</td></tr>
<tr><th id="6373">6373</th><td>		<a class="macro" href="../util/locks.h.html#102" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_lock(&amp;x-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_lock(&amp;x-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 6373, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_lock">lock_basic_lock</a>(&amp;<a class="local col5 ref" href="#1345x" title='x' data-ref="1345x" data-ref-filename="1345x">x</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="6374">6374</th><td>		<i>/* set lease_time, because we now have timestamp in env,</i></td></tr>
<tr><th id="6375">6375</th><td><i>		 * (not earlier during startup and apply_cfg), and this</i></td></tr>
<tr><th id="6376">6376</th><td><i>		 * notes the start time when the data was acquired */</i></td></tr>
<tr><th id="6377">6377</th><td>		<b>if</b>(<a class="local col5 ref" href="#1345x" title='x' data-ref="1345x" data-ref-filename="1345x">x</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::have_zone" title='auth_xfer::have_zone' data-ref="auth_xfer::have_zone" data-ref-filename="auth_xfer..have_zone">have_zone</a>)</td></tr>
<tr><th id="6378">6378</th><td>			<a class="local col5 ref" href="#1345x" title='x' data-ref="1345x" data-ref-filename="1345x">x</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lease_time" title='auth_xfer::lease_time' data-ref="auth_xfer::lease_time" data-ref-filename="auth_xfer..lease_time">lease_time</a> = *<a class="local col4 ref" href="#1344env" title='env' data-ref="1344env" data-ref-filename="1344env">env</a>-&gt;<a class="ref field" href="../util/module.h.html#module_env::now" title='module_env::now' data-ref="module_env::now" data-ref-filename="module_env..now">now</a>;</td></tr>
<tr><th id="6379">6379</th><td>		<b>if</b>(<a class="local col5 ref" href="#1345x" title='x' data-ref="1345x" data-ref-filename="1345x">x</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a> &amp;&amp; <a class="local col5 ref" href="#1345x" title='x' data-ref="1345x" data-ref-filename="1345x">x</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::worker" title='auth_nextprobe::worker' data-ref="auth_nextprobe::worker" data-ref-filename="auth_nextprobe..worker">worker</a> == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="6380">6380</th><td>			<a class="tu ref fn" href="#xfr_set_timeout" title='xfr_set_timeout' data-use='c' data-ref="xfr_set_timeout" data-ref-filename="xfr_set_timeout">xfr_set_timeout</a>(<a class="local col5 ref" href="#1345x" title='x' data-ref="1345x" data-ref-filename="1345x">x</a>, <a class="local col4 ref" href="#1344env" title='env' data-ref="1344env" data-ref-filename="1344env">env</a>, <var>0</var>, <var>1</var>);</td></tr>
<tr><th id="6381">6381</th><td>		}</td></tr>
<tr><th id="6382">6382</th><td>		<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;x-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;x-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 6382, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col5 ref" href="#1345x" title='x' data-ref="1345x" data-ref-filename="1345x">x</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="6383">6383</th><td>	}</td></tr>
<tr><th id="6384">6384</th><td>	<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 6384, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col3 ref" href="#1343az" title='az' data-ref="1343az" data-ref-filename="1343az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="6385">6385</th><td>}</td></tr>
<tr><th id="6386">6386</th><td></td></tr>
<tr><th id="6387">6387</th><td><em>void</em> <dfn class="decl def fn" id="auth_zones_cleanup" title='auth_zones_cleanup' data-ref="auth_zones_cleanup" data-ref-filename="auth_zones_cleanup">auth_zones_cleanup</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zones" title='auth_zones' data-ref="auth_zones" data-ref-filename="auth_zones">auth_zones</a>* <dfn class="local col6 decl" id="1346az" title='az' data-type='struct auth_zones *' data-ref="1346az" data-ref-filename="1346az">az</dfn>)</td></tr>
<tr><th id="6388">6388</th><td>{</td></tr>
<tr><th id="6389">6389</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col7 decl" id="1347x" title='x' data-type='struct auth_xfer *' data-ref="1347x" data-ref-filename="1347x">x</dfn>;</td></tr>
<tr><th id="6390">6390</th><td>	<a class="macro" href="../util/locks.h.html#120" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_wrlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_wrlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 6390, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_wrlock">lock_rw_wrlock</a>(&amp;<a class="local col6 ref" href="#1346az" title='az' data-ref="1346az" data-ref-filename="1346az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="6391">6391</th><td>	<a class="macro" href="../util/rbtree.h.html#173" title="for(x=(struct auth_xfer*)rbtree_first(&amp;az-&gt;xtree); (rbnode_type*)x != &amp;rbtree_null_node; x = (struct auth_xfer*)rbtree_next((rbnode_type*)x))" data-ref="_M/RBTREE_FOR">RBTREE_FOR</a>(<a class="local col7 ref" href="#1347x" title='x' data-ref="1347x" data-ref-filename="1347x">x</a>, <b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>*, &amp;<a class="local col6 ref" href="#1346az" title='az' data-ref="1346az" data-ref-filename="1346az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::xtree" title='auth_zones::xtree' data-ref="auth_zones::xtree" data-ref-filename="auth_zones..xtree">xtree</a>) {</td></tr>
<tr><th id="6392">6392</th><td>		<a class="macro" href="../util/locks.h.html#102" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_lock(&amp;x-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_lock(&amp;x-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 6392, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_lock">lock_basic_lock</a>(&amp;<a class="local col7 ref" href="#1347x" title='x' data-ref="1347x" data-ref-filename="1347x">x</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="6393">6393</th><td>		<b>if</b>(<a class="local col7 ref" href="#1347x" title='x' data-ref="1347x" data-ref-filename="1347x">x</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a> &amp;&amp; <a class="local col7 ref" href="#1347x" title='x' data-ref="1347x" data-ref-filename="1347x">x</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_nextprobe::worker" title='auth_nextprobe::worker' data-ref="auth_nextprobe::worker" data-ref-filename="auth_nextprobe..worker">worker</a> != <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="6394">6394</th><td>			<a class="tu ref fn" href="#xfr_nextprobe_disown" title='xfr_nextprobe_disown' data-use='c' data-ref="xfr_nextprobe_disown" data-ref-filename="xfr_nextprobe_disown">xfr_nextprobe_disown</a>(<a class="local col7 ref" href="#1347x" title='x' data-ref="1347x" data-ref-filename="1347x">x</a>);</td></tr>
<tr><th id="6395">6395</th><td>		}</td></tr>
<tr><th id="6396">6396</th><td>		<b>if</b>(<a class="local col7 ref" href="#1347x" title='x' data-ref="1347x" data-ref-filename="1347x">x</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a> &amp;&amp; <a class="local col7 ref" href="#1347x" title='x' data-ref="1347x" data-ref-filename="1347x">x</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>-&gt;<a class="ref field" href="authzone.h.html#auth_probe::worker" title='auth_probe::worker' data-ref="auth_probe::worker" data-ref-filename="auth_probe..worker">worker</a> != <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="6397">6397</th><td>			<a class="tu ref fn" href="#xfr_probe_disown" title='xfr_probe_disown' data-use='c' data-ref="xfr_probe_disown" data-ref-filename="xfr_probe_disown">xfr_probe_disown</a>(<a class="local col7 ref" href="#1347x" title='x' data-ref="1347x" data-ref-filename="1347x">x</a>);</td></tr>
<tr><th id="6398">6398</th><td>		}</td></tr>
<tr><th id="6399">6399</th><td>		<b>if</b>(<a class="local col7 ref" href="#1347x" title='x' data-ref="1347x" data-ref-filename="1347x">x</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a> &amp;&amp; <a class="local col7 ref" href="#1347x" title='x' data-ref="1347x" data-ref-filename="1347x">x</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>-&gt;<a class="ref field" href="authzone.h.html#auth_transfer::worker" title='auth_transfer::worker' data-ref="auth_transfer::worker" data-ref-filename="auth_transfer..worker">worker</a> != <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="6400">6400</th><td>			<a class="tu ref fn" href="#auth_chunks_delete" title='auth_chunks_delete' data-use='c' data-ref="auth_chunks_delete" data-ref-filename="auth_chunks_delete">auth_chunks_delete</a>(<a class="local col7 ref" href="#1347x" title='x' data-ref="1347x" data-ref-filename="1347x">x</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>);</td></tr>
<tr><th id="6401">6401</th><td>			<a class="tu ref fn" href="#xfr_transfer_disown" title='xfr_transfer_disown' data-use='c' data-ref="xfr_transfer_disown" data-ref-filename="xfr_transfer_disown">xfr_transfer_disown</a>(<a class="local col7 ref" href="#1347x" title='x' data-ref="1347x" data-ref-filename="1347x">x</a>);</td></tr>
<tr><th id="6402">6402</th><td>		}</td></tr>
<tr><th id="6403">6403</th><td>		<a class="macro" href="../util/locks.h.html#103" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_unlock(&amp;x-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_unlock(&amp;x-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 6403, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_unlock">lock_basic_unlock</a>(&amp;<a class="local col7 ref" href="#1347x" title='x' data-ref="1347x" data-ref-filename="1347x">x</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="6404">6404</th><td>	}</td></tr>
<tr><th id="6405">6405</th><td>	<a class="macro" href="../util/locks.h.html#121" title="do { int lockret_err; if( (lockret_err=(__libc_rwlock_unlock(&amp;az-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_rwlock_unlock(&amp;az-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 6405, strerror(lockret_err)); } while(0)" data-ref="_M/lock_rw_unlock">lock_rw_unlock</a>(&amp;<a class="local col6 ref" href="#1346az" title='az' data-ref="1346az" data-ref-filename="1346az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::lock" title='auth_zones::lock' data-ref="auth_zones::lock" data-ref-filename="auth_zones..lock">lock</a>);</td></tr>
<tr><th id="6406">6406</th><td>}</td></tr>
<tr><th id="6407">6407</th><td></td></tr>
<tr><th id="6408">6408</th><td><i class="doc" data-doc="auth_xfer_new">/**</i></td></tr>
<tr><th id="6409">6409</th><td><i class="doc" data-doc="auth_xfer_new"> * malloc the xfer and tasks</i></td></tr>
<tr><th id="6410">6410</th><td><i class="doc" data-doc="auth_xfer_new"> * <span class="command">@param</span> <span class="arg">z:</span> auth_zone with name of zone.</i></td></tr>
<tr><th id="6411">6411</th><td><i class="doc" data-doc="auth_xfer_new"> */</i></td></tr>
<tr><th id="6412">6412</th><td><em>static</em> <b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>*</td></tr>
<tr><th id="6413">6413</th><td><dfn class="tu decl def fn" id="auth_xfer_new" title='auth_xfer_new' data-type='struct auth_xfer * auth_xfer_new(struct auth_zone * z)' data-ref="auth_xfer_new" data-ref-filename="auth_xfer_new">auth_xfer_new</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col8 decl" id="1348z" title='z' data-type='struct auth_zone *' data-ref="1348z" data-ref-filename="1348z">z</dfn>)</td></tr>
<tr><th id="6414">6414</th><td>{</td></tr>
<tr><th id="6415">6415</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col9 decl" id="1349xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1349xfr" data-ref-filename="1349xfr">xfr</dfn>;</td></tr>
<tr><th id="6416">6416</th><td>	<a class="local col9 ref" href="#1349xfr" title='xfr' data-ref="1349xfr" data-ref-filename="1349xfr">xfr</a> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>*)<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#calloc" title='calloc' data-ref="calloc" data-ref-filename="calloc">calloc</a>(<var>1</var>, <b>sizeof</b>(*<a class="local col9 ref" href="#1349xfr" title='xfr' data-ref="1349xfr" data-ref-filename="1349xfr">xfr</a>));</td></tr>
<tr><th id="6417">6417</th><td>	<b>if</b>(!<a class="local col9 ref" href="#1349xfr" title='xfr' data-ref="1349xfr" data-ref-filename="1349xfr">xfr</a>) <b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="6418">6418</th><td>	<a class="local col9 ref" href="#1349xfr" title='xfr' data-ref="1349xfr" data-ref-filename="1349xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a> = <a class="ref fn" href="../util/net_help.h.html#memdup" title='memdup' data-ref="memdup" data-ref-filename="memdup">memdup</a>(<a class="local col8 ref" href="#1348z" title='z' data-ref="1348z" data-ref-filename="1348z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::name" title='auth_zone::name' data-ref="auth_zone::name" data-ref-filename="auth_zone..name">name</a>, <a class="local col8 ref" href="#1348z" title='z' data-ref="1348z" data-ref-filename="1348z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::namelen" title='auth_zone::namelen' data-ref="auth_zone::namelen" data-ref-filename="auth_zone..namelen">namelen</a>);</td></tr>
<tr><th id="6419">6419</th><td>	<b>if</b>(!<a class="local col9 ref" href="#1349xfr" title='xfr' data-ref="1349xfr" data-ref-filename="1349xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a>) {</td></tr>
<tr><th id="6420">6420</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col9 ref" href="#1349xfr" title='xfr' data-ref="1349xfr" data-ref-filename="1349xfr">xfr</a>);</td></tr>
<tr><th id="6421">6421</th><td>		<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="6422">6422</th><td>	}</td></tr>
<tr><th id="6423">6423</th><td>	<a class="local col9 ref" href="#1349xfr" title='xfr' data-ref="1349xfr" data-ref-filename="1349xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::node" title='auth_xfer::node' data-ref="auth_xfer::node" data-ref-filename="auth_xfer..node">node</a>.<a class="ref field" href="../util/rbtree.h.html#rbnode_type::key" title='rbnode_type::key' data-ref="rbnode_type::key" data-ref-filename="rbnode_type..key">key</a> = <a class="local col9 ref" href="#1349xfr" title='xfr' data-ref="1349xfr" data-ref-filename="1349xfr">xfr</a>;</td></tr>
<tr><th id="6424">6424</th><td>	<a class="local col9 ref" href="#1349xfr" title='xfr' data-ref="1349xfr" data-ref-filename="1349xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::namelen" title='auth_xfer::namelen' data-ref="auth_xfer::namelen" data-ref-filename="auth_xfer..namelen">namelen</a> = <a class="local col8 ref" href="#1348z" title='z' data-ref="1348z" data-ref-filename="1348z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::namelen" title='auth_zone::namelen' data-ref="auth_zone::namelen" data-ref-filename="auth_zone..namelen">namelen</a>;</td></tr>
<tr><th id="6425">6425</th><td>	<a class="local col9 ref" href="#1349xfr" title='xfr' data-ref="1349xfr" data-ref-filename="1349xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::namelabs" title='auth_xfer::namelabs' data-ref="auth_xfer::namelabs" data-ref-filename="auth_xfer..namelabs">namelabs</a> = <a class="local col8 ref" href="#1348z" title='z' data-ref="1348z" data-ref-filename="1348z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::namelabs" title='auth_zone::namelabs' data-ref="auth_zone::namelabs" data-ref-filename="auth_zone..namelabs">namelabs</a>;</td></tr>
<tr><th id="6426">6426</th><td>	<a class="local col9 ref" href="#1349xfr" title='xfr' data-ref="1349xfr" data-ref-filename="1349xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::dclass" title='auth_xfer::dclass' data-ref="auth_xfer::dclass" data-ref-filename="auth_xfer..dclass">dclass</a> = <a class="local col8 ref" href="#1348z" title='z' data-ref="1348z" data-ref-filename="1348z">z</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zone::dclass" title='auth_zone::dclass' data-ref="auth_zone::dclass" data-ref-filename="auth_zone..dclass">dclass</a>;</td></tr>
<tr><th id="6427">6427</th><td></td></tr>
<tr><th id="6428">6428</th><td>	<a class="local col9 ref" href="#1349xfr" title='xfr' data-ref="1349xfr" data-ref-filename="1349xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_nextprobe" title='auth_nextprobe' data-ref="auth_nextprobe" data-ref-filename="auth_nextprobe">auth_nextprobe</a>*)<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#calloc" title='calloc' data-ref="calloc" data-ref-filename="calloc">calloc</a>(<var>1</var>,</td></tr>
<tr><th id="6429">6429</th><td>		<b>sizeof</b>(<b>struct</b> <a class="type" href="authzone.h.html#auth_nextprobe" title='auth_nextprobe' data-ref="auth_nextprobe" data-ref-filename="auth_nextprobe">auth_nextprobe</a>));</td></tr>
<tr><th id="6430">6430</th><td>	<b>if</b>(!<a class="local col9 ref" href="#1349xfr" title='xfr' data-ref="1349xfr" data-ref-filename="1349xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>) {</td></tr>
<tr><th id="6431">6431</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col9 ref" href="#1349xfr" title='xfr' data-ref="1349xfr" data-ref-filename="1349xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a>);</td></tr>
<tr><th id="6432">6432</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col9 ref" href="#1349xfr" title='xfr' data-ref="1349xfr" data-ref-filename="1349xfr">xfr</a>);</td></tr>
<tr><th id="6433">6433</th><td>		<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="6434">6434</th><td>	}</td></tr>
<tr><th id="6435">6435</th><td>	<a class="local col9 ref" href="#1349xfr" title='xfr' data-ref="1349xfr" data-ref-filename="1349xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_probe" title='auth_probe' data-ref="auth_probe" data-ref-filename="auth_probe">auth_probe</a>*)<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#calloc" title='calloc' data-ref="calloc" data-ref-filename="calloc">calloc</a>(<var>1</var>,</td></tr>
<tr><th id="6436">6436</th><td>		<b>sizeof</b>(<b>struct</b> <a class="type" href="authzone.h.html#auth_probe" title='auth_probe' data-ref="auth_probe" data-ref-filename="auth_probe">auth_probe</a>));</td></tr>
<tr><th id="6437">6437</th><td>	<b>if</b>(!<a class="local col9 ref" href="#1349xfr" title='xfr' data-ref="1349xfr" data-ref-filename="1349xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>) {</td></tr>
<tr><th id="6438">6438</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col9 ref" href="#1349xfr" title='xfr' data-ref="1349xfr" data-ref-filename="1349xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>);</td></tr>
<tr><th id="6439">6439</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col9 ref" href="#1349xfr" title='xfr' data-ref="1349xfr" data-ref-filename="1349xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a>);</td></tr>
<tr><th id="6440">6440</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col9 ref" href="#1349xfr" title='xfr' data-ref="1349xfr" data-ref-filename="1349xfr">xfr</a>);</td></tr>
<tr><th id="6441">6441</th><td>		<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="6442">6442</th><td>	}</td></tr>
<tr><th id="6443">6443</th><td>	<a class="local col9 ref" href="#1349xfr" title='xfr' data-ref="1349xfr" data-ref-filename="1349xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_transfer" title='auth_transfer' data-ref="auth_transfer" data-ref-filename="auth_transfer">auth_transfer</a>*)<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#calloc" title='calloc' data-ref="calloc" data-ref-filename="calloc">calloc</a>(<var>1</var>,</td></tr>
<tr><th id="6444">6444</th><td>		<b>sizeof</b>(<b>struct</b> <a class="type" href="authzone.h.html#auth_transfer" title='auth_transfer' data-ref="auth_transfer" data-ref-filename="auth_transfer">auth_transfer</a>));</td></tr>
<tr><th id="6445">6445</th><td>	<b>if</b>(!<a class="local col9 ref" href="#1349xfr" title='xfr' data-ref="1349xfr" data-ref-filename="1349xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_transfer" title='auth_xfer::task_transfer' data-ref="auth_xfer::task_transfer" data-ref-filename="auth_xfer..task_transfer">task_transfer</a>) {</td></tr>
<tr><th id="6446">6446</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col9 ref" href="#1349xfr" title='xfr' data-ref="1349xfr" data-ref-filename="1349xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_probe" title='auth_xfer::task_probe' data-ref="auth_xfer::task_probe" data-ref-filename="auth_xfer..task_probe">task_probe</a>);</td></tr>
<tr><th id="6447">6447</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col9 ref" href="#1349xfr" title='xfr' data-ref="1349xfr" data-ref-filename="1349xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::task_nextprobe" title='auth_xfer::task_nextprobe' data-ref="auth_xfer::task_nextprobe" data-ref-filename="auth_xfer..task_nextprobe">task_nextprobe</a>);</td></tr>
<tr><th id="6448">6448</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col9 ref" href="#1349xfr" title='xfr' data-ref="1349xfr" data-ref-filename="1349xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::name" title='auth_xfer::name' data-ref="auth_xfer::name" data-ref-filename="auth_xfer..name">name</a>);</td></tr>
<tr><th id="6449">6449</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col9 ref" href="#1349xfr" title='xfr' data-ref="1349xfr" data-ref-filename="1349xfr">xfr</a>);</td></tr>
<tr><th id="6450">6450</th><td>		<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="6451">6451</th><td>	}</td></tr>
<tr><th id="6452">6452</th><td></td></tr>
<tr><th id="6453">6453</th><td>	<a class="macro" href="../util/locks.h.html#100" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_init(&amp;xfr-&gt;lock, ((void*)0)))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_init(&amp;xfr-&gt;lock, NULL)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 6453, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_init">lock_basic_init</a>(&amp;<a class="local col9 ref" href="#1349xfr" title='xfr' data-ref="1349xfr" data-ref-filename="1349xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="6454">6454</th><td>	<a class="macro" href="../util/locks.h.html#86" title="" data-ref="_M/lock_protect">lock_protect</a>(&amp;xfr-&gt;lock, &amp;xfr-&gt;name, <b>sizeof</b>(xfr-&gt;name));</td></tr>
<tr><th id="6455">6455</th><td>	<a class="macro" href="../util/locks.h.html#86" title="" data-ref="_M/lock_protect">lock_protect</a>(&amp;xfr-&gt;lock, &amp;xfr-&gt;namelen, <b>sizeof</b>(xfr-&gt;namelen));</td></tr>
<tr><th id="6456">6456</th><td>	<a class="macro" href="../util/locks.h.html#86" title="" data-ref="_M/lock_protect">lock_protect</a>(&amp;xfr-&gt;lock, xfr-&gt;name, xfr-&gt;namelen);</td></tr>
<tr><th id="6457">6457</th><td>	<a class="macro" href="../util/locks.h.html#86" title="" data-ref="_M/lock_protect">lock_protect</a>(&amp;xfr-&gt;lock, &amp;xfr-&gt;namelabs, <b>sizeof</b>(xfr-&gt;namelabs));</td></tr>
<tr><th id="6458">6458</th><td>	<a class="macro" href="../util/locks.h.html#86" title="" data-ref="_M/lock_protect">lock_protect</a>(&amp;xfr-&gt;lock, &amp;xfr-&gt;dclass, <b>sizeof</b>(xfr-&gt;dclass));</td></tr>
<tr><th id="6459">6459</th><td>	<a class="macro" href="../util/locks.h.html#86" title="" data-ref="_M/lock_protect">lock_protect</a>(&amp;xfr-&gt;lock, &amp;xfr-&gt;notify_received, <b>sizeof</b>(xfr-&gt;notify_received));</td></tr>
<tr><th id="6460">6460</th><td>	<a class="macro" href="../util/locks.h.html#86" title="" data-ref="_M/lock_protect">lock_protect</a>(&amp;xfr-&gt;lock, &amp;xfr-&gt;notify_serial, <b>sizeof</b>(xfr-&gt;notify_serial));</td></tr>
<tr><th id="6461">6461</th><td>	<a class="macro" href="../util/locks.h.html#86" title="" data-ref="_M/lock_protect">lock_protect</a>(&amp;xfr-&gt;lock, &amp;xfr-&gt;zone_expired, <b>sizeof</b>(xfr-&gt;zone_expired));</td></tr>
<tr><th id="6462">6462</th><td>	<a class="macro" href="../util/locks.h.html#86" title="" data-ref="_M/lock_protect">lock_protect</a>(&amp;xfr-&gt;lock, &amp;xfr-&gt;have_zone, <b>sizeof</b>(xfr-&gt;have_zone));</td></tr>
<tr><th id="6463">6463</th><td>	<a class="macro" href="../util/locks.h.html#86" title="" data-ref="_M/lock_protect">lock_protect</a>(&amp;xfr-&gt;lock, &amp;xfr-&gt;serial, <b>sizeof</b>(xfr-&gt;serial));</td></tr>
<tr><th id="6464">6464</th><td>	<a class="macro" href="../util/locks.h.html#86" title="" data-ref="_M/lock_protect">lock_protect</a>(&amp;xfr-&gt;lock, &amp;xfr-&gt;retry, <b>sizeof</b>(xfr-&gt;retry));</td></tr>
<tr><th id="6465">6465</th><td>	<a class="macro" href="../util/locks.h.html#86" title="" data-ref="_M/lock_protect">lock_protect</a>(&amp;xfr-&gt;lock, &amp;xfr-&gt;refresh, <b>sizeof</b>(xfr-&gt;refresh));</td></tr>
<tr><th id="6466">6466</th><td>	<a class="macro" href="../util/locks.h.html#86" title="" data-ref="_M/lock_protect">lock_protect</a>(&amp;xfr-&gt;lock, &amp;xfr-&gt;expiry, <b>sizeof</b>(xfr-&gt;expiry));</td></tr>
<tr><th id="6467">6467</th><td>	<a class="macro" href="../util/locks.h.html#86" title="" data-ref="_M/lock_protect">lock_protect</a>(&amp;xfr-&gt;lock, &amp;xfr-&gt;lease_time, <b>sizeof</b>(xfr-&gt;lease_time));</td></tr>
<tr><th id="6468">6468</th><td>	<a class="macro" href="../util/locks.h.html#86" title="" data-ref="_M/lock_protect">lock_protect</a>(&amp;xfr-&gt;lock, &amp;xfr-&gt;task_nextprobe-&gt;worker,</td></tr>
<tr><th id="6469">6469</th><td>		<b>sizeof</b>(xfr-&gt;task_nextprobe-&gt;worker));</td></tr>
<tr><th id="6470">6470</th><td>	<a class="macro" href="../util/locks.h.html#86" title="" data-ref="_M/lock_protect">lock_protect</a>(&amp;xfr-&gt;lock, &amp;xfr-&gt;task_probe-&gt;worker,</td></tr>
<tr><th id="6471">6471</th><td>		<b>sizeof</b>(xfr-&gt;task_probe-&gt;worker));</td></tr>
<tr><th id="6472">6472</th><td>	<a class="macro" href="../util/locks.h.html#86" title="" data-ref="_M/lock_protect">lock_protect</a>(&amp;xfr-&gt;lock, &amp;xfr-&gt;task_transfer-&gt;worker,</td></tr>
<tr><th id="6473">6473</th><td>		<b>sizeof</b>(xfr-&gt;task_transfer-&gt;worker));</td></tr>
<tr><th id="6474">6474</th><td>	<a class="macro" href="../util/locks.h.html#102" title="do { int lockret_err; if( (lockret_err=(__libc_mutex_lock(&amp;xfr-&gt;lock))) != 0) log_err(&quot;%s at %d could not &quot; &quot;pthread_mutex_lock(&amp;xfr-&gt;lock)&quot; &quot;: %s&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/compat/amd64/i386/external/bsd/unbound/lib/libunbound/../../../../../../../../../external/bsd/unbound/dist/services/authzone.c&quot;, 6474, strerror(lockret_err)); } while(0)" data-ref="_M/lock_basic_lock">lock_basic_lock</a>(&amp;<a class="local col9 ref" href="#1349xfr" title='xfr' data-ref="1349xfr" data-ref-filename="1349xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::lock" title='auth_xfer::lock' data-ref="auth_xfer::lock" data-ref-filename="auth_xfer..lock">lock</a>);</td></tr>
<tr><th id="6475">6475</th><td>	<b>return</b> <a class="local col9 ref" href="#1349xfr" title='xfr' data-ref="1349xfr" data-ref-filename="1349xfr">xfr</a>;</td></tr>
<tr><th id="6476">6476</th><td>}</td></tr>
<tr><th id="6477">6477</th><td></td></tr>
<tr><th id="6478">6478</th><td><i class="doc">/** Create auth_xfer structure.</i></td></tr>
<tr><th id="6479">6479</th><td><i class="doc"> * This populates the have_zone, soa values, and so on times.</i></td></tr>
<tr><th id="6480">6480</th><td><i class="doc"> * and sets the timeout, if a zone transfer is needed a short timeout is set.</i></td></tr>
<tr><th id="6481">6481</th><td><i class="doc"> * For that the auth_zone itself must exist (and read in zonefile)</i></td></tr>
<tr><th id="6482">6482</th><td><i class="doc"> * returns false on alloc failure. */</i></td></tr>
<tr><th id="6483">6483</th><td><b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>*</td></tr>
<tr><th id="6484">6484</th><td><dfn class="decl def fn" id="auth_xfer_create" title='auth_xfer_create' data-ref="auth_xfer_create" data-ref-filename="auth_xfer_create">auth_xfer_create</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_zones" title='auth_zones' data-ref="auth_zones" data-ref-filename="auth_zones">auth_zones</a>* <dfn class="local col0 decl" id="1350az" title='az' data-type='struct auth_zones *' data-ref="1350az" data-ref-filename="1350az">az</dfn>, <b>struct</b> <a class="type" href="authzone.h.html#auth_zone" title='auth_zone' data-ref="auth_zone" data-ref-filename="auth_zone">auth_zone</a>* <dfn class="local col1 decl" id="1351z" title='z' data-type='struct auth_zone *' data-ref="1351z" data-ref-filename="1351z">z</dfn>)</td></tr>
<tr><th id="6485">6485</th><td>{</td></tr>
<tr><th id="6486">6486</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_xfer" title='auth_xfer' data-ref="auth_xfer" data-ref-filename="auth_xfer">auth_xfer</a>* <dfn class="local col2 decl" id="1352xfr" title='xfr' data-type='struct auth_xfer *' data-ref="1352xfr" data-ref-filename="1352xfr">xfr</dfn>;</td></tr>
<tr><th id="6487">6487</th><td></td></tr>
<tr><th id="6488">6488</th><td>	<i>/* malloc it */</i></td></tr>
<tr><th id="6489">6489</th><td>	<a class="local col2 ref" href="#1352xfr" title='xfr' data-ref="1352xfr" data-ref-filename="1352xfr">xfr</a> = <a class="tu ref fn" href="#auth_xfer_new" title='auth_xfer_new' data-use='c' data-ref="auth_xfer_new" data-ref-filename="auth_xfer_new">auth_xfer_new</a>(<a class="local col1 ref" href="#1351z" title='z' data-ref="1351z" data-ref-filename="1351z">z</a>);</td></tr>
<tr><th id="6490">6490</th><td>	<b>if</b>(!<a class="local col2 ref" href="#1352xfr" title='xfr' data-ref="1352xfr" data-ref-filename="1352xfr">xfr</a>) {</td></tr>
<tr><th id="6491">6491</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"malloc failure"</q>);</td></tr>
<tr><th id="6492">6492</th><td>		<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="6493">6493</th><td>	}</td></tr>
<tr><th id="6494">6494</th><td>	<i>/* insert in tree */</i></td></tr>
<tr><th id="6495">6495</th><td>	(<em>void</em>)<a class="ref fn" href="../util/rbtree.h.html#rbtree_insert" title='rbtree_insert' data-ref="rbtree_insert" data-ref-filename="rbtree_insert">rbtree_insert</a>(&amp;<a class="local col0 ref" href="#1350az" title='az' data-ref="1350az" data-ref-filename="1350az">az</a>-&gt;<a class="ref field" href="authzone.h.html#auth_zones::xtree" title='auth_zones::xtree' data-ref="auth_zones::xtree" data-ref-filename="auth_zones..xtree">xtree</a>, &amp;<a class="local col2 ref" href="#1352xfr" title='xfr' data-ref="1352xfr" data-ref-filename="1352xfr">xfr</a>-&gt;<a class="ref field" href="authzone.h.html#auth_xfer::node" title='auth_xfer::node' data-ref="auth_xfer::node" data-ref-filename="auth_xfer..node">node</a>);</td></tr>
<tr><th id="6496">6496</th><td>	<b>return</b> <a class="local col2 ref" href="#1352xfr" title='xfr' data-ref="1352xfr" data-ref-filename="1352xfr">xfr</a>;</td></tr>
<tr><th id="6497">6497</th><td>}</td></tr>
<tr><th id="6498">6498</th><td></td></tr>
<tr><th id="6499">6499</th><td><i class="doc" data-doc="auth_master_new">/** create new auth_master structure */</i></td></tr>
<tr><th id="6500">6500</th><td><em>static</em> <b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>*</td></tr>
<tr><th id="6501">6501</th><td><dfn class="tu decl def fn" id="auth_master_new" title='auth_master_new' data-type='struct auth_master * auth_master_new(struct auth_master *** list)' data-ref="auth_master_new" data-ref-filename="auth_master_new">auth_master_new</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>*** <dfn class="local col3 decl" id="1353list" title='list' data-type='struct auth_master ***' data-ref="1353list" data-ref-filename="1353list">list</dfn>)</td></tr>
<tr><th id="6502">6502</th><td>{</td></tr>
<tr><th id="6503">6503</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a> *<dfn class="local col4 decl" id="1354m" title='m' data-type='struct auth_master *' data-ref="1354m" data-ref-filename="1354m">m</dfn>;</td></tr>
<tr><th id="6504">6504</th><td>	<a class="local col4 ref" href="#1354m" title='m' data-ref="1354m" data-ref-filename="1354m">m</a> = (<b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>*)<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#calloc" title='calloc' data-ref="calloc" data-ref-filename="calloc">calloc</a>(<var>1</var>, <b>sizeof</b>(*<a class="local col4 ref" href="#1354m" title='m' data-ref="1354m" data-ref-filename="1354m">m</a>));</td></tr>
<tr><th id="6505">6505</th><td>	<b>if</b>(!<a class="local col4 ref" href="#1354m" title='m' data-ref="1354m" data-ref-filename="1354m">m</a>) {</td></tr>
<tr><th id="6506">6506</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"malloc failure"</q>);</td></tr>
<tr><th id="6507">6507</th><td>		<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="6508">6508</th><td>	}</td></tr>
<tr><th id="6509">6509</th><td>	<i>/* set first pointer to m, or next pointer of previous element to m */</i></td></tr>
<tr><th id="6510">6510</th><td>	(**<a class="local col3 ref" href="#1353list" title='list' data-ref="1353list" data-ref-filename="1353list">list</a>) = <a class="local col4 ref" href="#1354m" title='m' data-ref="1354m" data-ref-filename="1354m">m</a>;</td></tr>
<tr><th id="6511">6511</th><td>	<i>/* store m's next pointer as future point to store at */</i></td></tr>
<tr><th id="6512">6512</th><td>	(*<a class="local col3 ref" href="#1353list" title='list' data-ref="1353list" data-ref-filename="1353list">list</a>) = &amp;(<a class="local col4 ref" href="#1354m" title='m' data-ref="1354m" data-ref-filename="1354m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::next" title='auth_master::next' data-ref="auth_master::next" data-ref-filename="auth_master..next">next</a>);</td></tr>
<tr><th id="6513">6513</th><td>	<b>return</b> <a class="local col4 ref" href="#1354m" title='m' data-ref="1354m" data-ref-filename="1354m">m</a>;</td></tr>
<tr><th id="6514">6514</th><td>}</td></tr>
<tr><th id="6515">6515</th><td></td></tr>
<tr><th id="6516">6516</th><td><i class="doc" data-doc="dup_prefix">/** dup_prefix : create string from initial part of other string, malloced */</i></td></tr>
<tr><th id="6517">6517</th><td><em>static</em> <em>char</em>*</td></tr>
<tr><th id="6518">6518</th><td><dfn class="tu decl def fn" id="dup_prefix" title='dup_prefix' data-type='char * dup_prefix(char * str, size_t num)' data-ref="dup_prefix" data-ref-filename="dup_prefix">dup_prefix</dfn>(<em>char</em>* <dfn class="local col5 decl" id="1355str" title='str' data-type='char *' data-ref="1355str" data-ref-filename="1355str">str</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col6 decl" id="1356num" title='num' data-type='size_t' data-ref="1356num" data-ref-filename="1356num">num</dfn>)</td></tr>
<tr><th id="6519">6519</th><td>{</td></tr>
<tr><th id="6520">6520</th><td>	<em>char</em>* <dfn class="local col7 decl" id="1357result" title='result' data-type='char *' data-ref="1357result" data-ref-filename="1357result">result</dfn>;</td></tr>
<tr><th id="6521">6521</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col8 decl" id="1358len" title='len' data-type='size_t' data-ref="1358len" data-ref-filename="1358len">len</dfn> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strlen" title='strlen' data-ref="strlen" data-ref-filename="strlen">strlen</a>(<a class="local col5 ref" href="#1355str" title='str' data-ref="1355str" data-ref-filename="1355str">str</a>);</td></tr>
<tr><th id="6522">6522</th><td>	<b>if</b>(<a class="local col8 ref" href="#1358len" title='len' data-ref="1358len" data-ref-filename="1358len">len</a> &lt; <a class="local col6 ref" href="#1356num" title='num' data-ref="1356num" data-ref-filename="1356num">num</a>) <a class="local col6 ref" href="#1356num" title='num' data-ref="1356num" data-ref-filename="1356num">num</a> = <a class="local col8 ref" href="#1358len" title='len' data-ref="1358len" data-ref-filename="1358len">len</a>; <i>/* not more than strlen */</i></td></tr>
<tr><th id="6523">6523</th><td>	<a class="local col7 ref" href="#1357result" title='result' data-ref="1357result" data-ref-filename="1357result">result</a> = (<em>char</em>*)<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#malloc" title='malloc' data-ref="malloc" data-ref-filename="malloc">malloc</a>(<a class="local col6 ref" href="#1356num" title='num' data-ref="1356num" data-ref-filename="1356num">num</a>+<var>1</var>);</td></tr>
<tr><th id="6524">6524</th><td>	<b>if</b>(!<a class="local col7 ref" href="#1357result" title='result' data-ref="1357result" data-ref-filename="1357result">result</a>) {</td></tr>
<tr><th id="6525">6525</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"malloc failure"</q>);</td></tr>
<tr><th id="6526">6526</th><td>		<b>return</b> <a class="local col7 ref" href="#1357result" title='result' data-ref="1357result" data-ref-filename="1357result">result</a>;</td></tr>
<tr><th id="6527">6527</th><td>	}</td></tr>
<tr><th id="6528">6528</th><td>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/ssp/string.h.html#96" title="((__builtin_object_size(result, 0) != (size_t)-1) ? __builtin___memmove_chk(result, str, num, __builtin_object_size(result, 0)) : __memmove_ichk(result, str, num))" data-ref="_M/memmove">memmove</a>(<a class="local col7 ref" href="#1357result" title='result' data-ref="1357result" data-ref-filename="1357result">result</a>, <a class="local col5 ref" href="#1355str" title='str' data-ref="1355str" data-ref-filename="1355str">str</a>, <a class="local col6 ref" href="#1356num" title='num' data-ref="1356num" data-ref-filename="1356num">num</a>);</td></tr>
<tr><th id="6529">6529</th><td>	<a class="local col7 ref" href="#1357result" title='result' data-ref="1357result" data-ref-filename="1357result">result</a>[<a class="local col6 ref" href="#1356num" title='num' data-ref="1356num" data-ref-filename="1356num">num</a>] = <var>0</var>;</td></tr>
<tr><th id="6530">6530</th><td>	<b>return</b> <a class="local col7 ref" href="#1357result" title='result' data-ref="1357result" data-ref-filename="1357result">result</a>;</td></tr>
<tr><th id="6531">6531</th><td>}</td></tr>
<tr><th id="6532">6532</th><td></td></tr>
<tr><th id="6533">6533</th><td><i class="doc" data-doc="dup_all">/** dup string and print error on error */</i></td></tr>
<tr><th id="6534">6534</th><td><em>static</em> <em>char</em>*</td></tr>
<tr><th id="6535">6535</th><td><dfn class="tu decl def fn" id="dup_all" title='dup_all' data-type='char * dup_all(char * str)' data-ref="dup_all" data-ref-filename="dup_all">dup_all</dfn>(<em>char</em>* <dfn class="local col9 decl" id="1359str" title='str' data-type='char *' data-ref="1359str" data-ref-filename="1359str">str</dfn>)</td></tr>
<tr><th id="6536">6536</th><td>{</td></tr>
<tr><th id="6537">6537</th><td>	<em>char</em>* <dfn class="local col0 decl" id="1360result" title='result' data-type='char *' data-ref="1360result" data-ref-filename="1360result">result</dfn> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strdup" title='strdup' data-ref="strdup" data-ref-filename="strdup">strdup</a>(<a class="local col9 ref" href="#1359str" title='str' data-ref="1359str" data-ref-filename="1359str">str</a>);</td></tr>
<tr><th id="6538">6538</th><td>	<b>if</b>(!<a class="local col0 ref" href="#1360result" title='result' data-ref="1360result" data-ref-filename="1360result">result</a>) {</td></tr>
<tr><th id="6539">6539</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"malloc failure"</q>);</td></tr>
<tr><th id="6540">6540</th><td>		<b>return</b> <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="6541">6541</th><td>	}</td></tr>
<tr><th id="6542">6542</th><td>	<b>return</b> <a class="local col0 ref" href="#1360result" title='result' data-ref="1360result" data-ref-filename="1360result">result</a>;</td></tr>
<tr><th id="6543">6543</th><td>}</td></tr>
<tr><th id="6544">6544</th><td></td></tr>
<tr><th id="6545">6545</th><td><i class="doc" data-doc="str_find_first_of_chars">/** find first of two characters */</i></td></tr>
<tr><th id="6546">6546</th><td><em>static</em> <em>char</em>*</td></tr>
<tr><th id="6547">6547</th><td><dfn class="tu decl def fn" id="str_find_first_of_chars" title='str_find_first_of_chars' data-type='char * str_find_first_of_chars(char * s, char a, char b)' data-ref="str_find_first_of_chars" data-ref-filename="str_find_first_of_chars">str_find_first_of_chars</dfn>(<em>char</em>* <dfn class="local col1 decl" id="1361s" title='s' data-type='char *' data-ref="1361s" data-ref-filename="1361s">s</dfn>, <em>char</em> <dfn class="local col2 decl" id="1362a" title='a' data-type='char' data-ref="1362a" data-ref-filename="1362a">a</dfn>, <em>char</em> <dfn class="local col3 decl" id="1363b" title='b' data-type='char' data-ref="1363b" data-ref-filename="1363b">b</dfn>)</td></tr>
<tr><th id="6548">6548</th><td>{</td></tr>
<tr><th id="6549">6549</th><td>	<em>char</em>* <dfn class="local col4 decl" id="1364ra" title='ra' data-type='char *' data-ref="1364ra" data-ref-filename="1364ra">ra</dfn> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strchr" title='strchr' data-ref="strchr" data-ref-filename="strchr">strchr</a>(<a class="local col1 ref" href="#1361s" title='s' data-ref="1361s" data-ref-filename="1361s">s</a>, <a class="local col2 ref" href="#1362a" title='a' data-ref="1362a" data-ref-filename="1362a">a</a>);</td></tr>
<tr><th id="6550">6550</th><td>	<em>char</em>* <dfn class="local col5 decl" id="1365rb" title='rb' data-type='char *' data-ref="1365rb" data-ref-filename="1365rb">rb</dfn> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strchr" title='strchr' data-ref="strchr" data-ref-filename="strchr">strchr</a>(<a class="local col1 ref" href="#1361s" title='s' data-ref="1361s" data-ref-filename="1361s">s</a>, <a class="local col3 ref" href="#1363b" title='b' data-ref="1363b" data-ref-filename="1363b">b</a>);</td></tr>
<tr><th id="6551">6551</th><td>	<b>if</b>(!<a class="local col4 ref" href="#1364ra" title='ra' data-ref="1364ra" data-ref-filename="1364ra">ra</a>) <b>return</b> <a class="local col5 ref" href="#1365rb" title='rb' data-ref="1365rb" data-ref-filename="1365rb">rb</a>;</td></tr>
<tr><th id="6552">6552</th><td>	<b>if</b>(!<a class="local col5 ref" href="#1365rb" title='rb' data-ref="1365rb" data-ref-filename="1365rb">rb</a>) <b>return</b> <a class="local col4 ref" href="#1364ra" title='ra' data-ref="1364ra" data-ref-filename="1364ra">ra</a>;</td></tr>
<tr><th id="6553">6553</th><td>	<b>if</b>(<a class="local col4 ref" href="#1364ra" title='ra' data-ref="1364ra" data-ref-filename="1364ra">ra</a> &lt; <a class="local col5 ref" href="#1365rb" title='rb' data-ref="1365rb" data-ref-filename="1365rb">rb</a>) <b>return</b> <a class="local col4 ref" href="#1364ra" title='ra' data-ref="1364ra" data-ref-filename="1364ra">ra</a>;</td></tr>
<tr><th id="6554">6554</th><td>	<b>return</b> <a class="local col5 ref" href="#1365rb" title='rb' data-ref="1365rb" data-ref-filename="1365rb">rb</a>;</td></tr>
<tr><th id="6555">6555</th><td>}</td></tr>
<tr><th id="6556">6556</th><td></td></tr>
<tr><th id="6557">6557</th><td><i class="doc" data-doc="parse_url">/** parse URL into host and file parts, false on malloc or parse error */</i></td></tr>
<tr><th id="6558">6558</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="6559">6559</th><td><dfn class="tu decl def fn" id="parse_url" title='parse_url' data-type='int parse_url(char * url, char ** host, char ** file, int * port, int * ssl)' data-ref="parse_url" data-ref-filename="parse_url">parse_url</dfn>(<em>char</em>* <dfn class="local col6 decl" id="1366url" title='url' data-type='char *' data-ref="1366url" data-ref-filename="1366url">url</dfn>, <em>char</em>** <dfn class="local col7 decl" id="1367host" title='host' data-type='char **' data-ref="1367host" data-ref-filename="1367host">host</dfn>, <em>char</em>** <dfn class="local col8 decl" id="1368file" title='file' data-type='char **' data-ref="1368file" data-ref-filename="1368file">file</dfn>, <em>int</em>* <dfn class="local col9 decl" id="1369port" title='port' data-type='int *' data-ref="1369port" data-ref-filename="1369port">port</dfn>, <em>int</em>* <dfn class="local col0 decl" id="1370ssl" title='ssl' data-type='int *' data-ref="1370ssl" data-ref-filename="1370ssl">ssl</dfn>)</td></tr>
<tr><th id="6560">6560</th><td>{</td></tr>
<tr><th id="6561">6561</th><td>	<em>char</em>* <dfn class="local col1 decl" id="1371p" title='p' data-type='char *' data-ref="1371p" data-ref-filename="1371p">p</dfn> = <a class="local col6 ref" href="#1366url" title='url' data-ref="1366url" data-ref-filename="1366url">url</a>;</td></tr>
<tr><th id="6562">6562</th><td>	<i>/* parse <a href="http://www.example.com/file.htm">http://www.example.com/file.htm</a></i></td></tr>
<tr><th id="6563">6563</th><td><i>	 * or <a href="http://127.0.0.1">http://127.0.0.1</a>   (index.html)</i></td></tr>
<tr><th id="6564">6564</th><td><i>	 * or <a href="https://[::1@1234]/a/b/c/d">https://[::1@1234]/a/b/c/d</a> */</i></td></tr>
<tr><th id="6565">6565</th><td>	*<a class="local col0 ref" href="#1370ssl" title='ssl' data-ref="1370ssl" data-ref-filename="1370ssl">ssl</a> = <var>1</var>;</td></tr>
<tr><th id="6566">6566</th><td>	*<a class="local col9 ref" href="#1369port" title='port' data-ref="1369port" data-ref-filename="1369port">port</a> = <a class="macro" href="#88" title="443" data-ref="_M/AUTH_HTTPS_PORT">AUTH_HTTPS_PORT</a>;</td></tr>
<tr><th id="6567">6567</th><td></td></tr>
<tr><th id="6568">6568</th><td>	<i>/* parse <a href="http://">http://</a> or <a href="https://">https://</a> */</i></td></tr>
<tr><th id="6569">6569</th><td>	<b>if</b>(<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strncmp" title='strncmp' data-ref="strncmp" data-ref-filename="strncmp">strncmp</a>(<a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a>, <q>"http://"</q>, <var>7</var>) == <var>0</var>) {</td></tr>
<tr><th id="6570">6570</th><td>		<a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a> += <var>7</var>;</td></tr>
<tr><th id="6571">6571</th><td>		*<a class="local col0 ref" href="#1370ssl" title='ssl' data-ref="1370ssl" data-ref-filename="1370ssl">ssl</a> = <var>0</var>;</td></tr>
<tr><th id="6572">6572</th><td>		*<a class="local col9 ref" href="#1369port" title='port' data-ref="1369port" data-ref-filename="1369port">port</a> = <a class="macro" href="#86" title="80" data-ref="_M/AUTH_HTTP_PORT">AUTH_HTTP_PORT</a>;</td></tr>
<tr><th id="6573">6573</th><td>	} <b>else</b> <b>if</b>(<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strncmp" title='strncmp' data-ref="strncmp" data-ref-filename="strncmp">strncmp</a>(<a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a>, <q>"https://"</q>, <var>8</var>) == <var>0</var>) {</td></tr>
<tr><th id="6574">6574</th><td>		<a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a> += <var>8</var>;</td></tr>
<tr><th id="6575">6575</th><td>	} <b>else</b> <b>if</b>(<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strstr" title='strstr' data-ref="strstr" data-ref-filename="strstr">strstr</a>(<a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a>, <q>"://"</q>) &amp;&amp; <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strchr" title='strchr' data-ref="strchr" data-ref-filename="strchr">strchr</a>(<a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a>, <kbd>'/'</kbd>) &gt; <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strstr" title='strstr' data-ref="strstr" data-ref-filename="strstr">strstr</a>(<a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a>, <q>"://"</q>) &amp;&amp;</td></tr>
<tr><th id="6576">6576</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strchr" title='strchr' data-ref="strchr" data-ref-filename="strchr">strchr</a>(<a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a>, <kbd>':'</kbd>) &gt;= <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strstr" title='strstr' data-ref="strstr" data-ref-filename="strstr">strstr</a>(<a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a>, <q>"://"</q>)) {</td></tr>
<tr><th id="6577">6577</th><td>		<em>char</em>* <dfn class="local col2 decl" id="1372uri" title='uri' data-type='char *' data-ref="1372uri" data-ref-filename="1372uri">uri</dfn> = <a class="tu ref fn" href="#dup_prefix" title='dup_prefix' data-use='c' data-ref="dup_prefix" data-ref-filename="dup_prefix">dup_prefix</a>(<a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a>, (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>)(<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strstr" title='strstr' data-ref="strstr" data-ref-filename="strstr">strstr</a>(<a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a>, <q>"://"</q>)-<a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a>));</td></tr>
<tr><th id="6578">6578</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"protocol %s:// not supported (for url %s)"</q>,</td></tr>
<tr><th id="6579">6579</th><td>			<a class="local col2 ref" href="#1372uri" title='uri' data-ref="1372uri" data-ref-filename="1372uri">uri</a>?<a class="local col2 ref" href="#1372uri" title='uri' data-ref="1372uri" data-ref-filename="1372uri">uri</a>:<q>""</q>, <a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a>);</td></tr>
<tr><th id="6580">6580</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#free" title='free' data-ref="free" data-ref-filename="free">free</a>(<a class="local col2 ref" href="#1372uri" title='uri' data-ref="1372uri" data-ref-filename="1372uri">uri</a>);</td></tr>
<tr><th id="6581">6581</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="6582">6582</th><td>	}</td></tr>
<tr><th id="6583">6583</th><td></td></tr>
<tr><th id="6584">6584</th><td>	<i>/* parse hostname part */</i></td></tr>
<tr><th id="6585">6585</th><td>	<b>if</b>(<a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a>[<var>0</var>] == <kbd>'['</kbd>) {</td></tr>
<tr><th id="6586">6586</th><td>		<em>char</em>* <dfn class="local col3 decl" id="1373end" title='end' data-type='char *' data-ref="1373end" data-ref-filename="1373end">end</dfn> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strchr" title='strchr' data-ref="strchr" data-ref-filename="strchr">strchr</a>(<a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a>, <kbd>']'</kbd>);</td></tr>
<tr><th id="6587">6587</th><td>		<a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a>++; <i>/* skip over [ */</i></td></tr>
<tr><th id="6588">6588</th><td>		<b>if</b>(<a class="local col3 ref" href="#1373end" title='end' data-ref="1373end" data-ref-filename="1373end">end</a>) {</td></tr>
<tr><th id="6589">6589</th><td>			*<a class="local col7 ref" href="#1367host" title='host' data-ref="1367host" data-ref-filename="1367host">host</a> = <a class="tu ref fn" href="#dup_prefix" title='dup_prefix' data-use='c' data-ref="dup_prefix" data-ref-filename="dup_prefix">dup_prefix</a>(<a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a>, (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>)(<a class="local col3 ref" href="#1373end" title='end' data-ref="1373end" data-ref-filename="1373end">end</a>-<a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a>));</td></tr>
<tr><th id="6590">6590</th><td>			<b>if</b>(!*<a class="local col7 ref" href="#1367host" title='host' data-ref="1367host" data-ref-filename="1367host">host</a>) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="6591">6591</th><td>			<a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a> = <a class="local col3 ref" href="#1373end" title='end' data-ref="1373end" data-ref-filename="1373end">end</a>+<var>1</var>; <i>/* skip over ] */</i></td></tr>
<tr><th id="6592">6592</th><td>		} <b>else</b> {</td></tr>
<tr><th id="6593">6593</th><td>			*<a class="local col7 ref" href="#1367host" title='host' data-ref="1367host" data-ref-filename="1367host">host</a> = <a class="tu ref fn" href="#dup_all" title='dup_all' data-use='c' data-ref="dup_all" data-ref-filename="dup_all">dup_all</a>(<a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a>);</td></tr>
<tr><th id="6594">6594</th><td>			<b>if</b>(!*<a class="local col7 ref" href="#1367host" title='host' data-ref="1367host" data-ref-filename="1367host">host</a>) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="6595">6595</th><td>			<a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a> = <a class="local col3 ref" href="#1373end" title='end' data-ref="1373end" data-ref-filename="1373end">end</a>;</td></tr>
<tr><th id="6596">6596</th><td>		}</td></tr>
<tr><th id="6597">6597</th><td>	} <b>else</b> {</td></tr>
<tr><th id="6598">6598</th><td>		<em>char</em>* <dfn class="local col4 decl" id="1374end" title='end' data-type='char *' data-ref="1374end" data-ref-filename="1374end">end</dfn> = <a class="tu ref fn" href="#str_find_first_of_chars" title='str_find_first_of_chars' data-use='c' data-ref="str_find_first_of_chars" data-ref-filename="str_find_first_of_chars">str_find_first_of_chars</a>(<a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a>, <kbd>':'</kbd>, <kbd>'/'</kbd>);</td></tr>
<tr><th id="6599">6599</th><td>		<b>if</b>(<a class="local col4 ref" href="#1374end" title='end' data-ref="1374end" data-ref-filename="1374end">end</a>) {</td></tr>
<tr><th id="6600">6600</th><td>			*<a class="local col7 ref" href="#1367host" title='host' data-ref="1367host" data-ref-filename="1367host">host</a> = <a class="tu ref fn" href="#dup_prefix" title='dup_prefix' data-use='c' data-ref="dup_prefix" data-ref-filename="dup_prefix">dup_prefix</a>(<a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a>, (<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>)(<a class="local col4 ref" href="#1374end" title='end' data-ref="1374end" data-ref-filename="1374end">end</a>-<a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a>));</td></tr>
<tr><th id="6601">6601</th><td>			<b>if</b>(!*<a class="local col7 ref" href="#1367host" title='host' data-ref="1367host" data-ref-filename="1367host">host</a>) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="6602">6602</th><td>		} <b>else</b> {</td></tr>
<tr><th id="6603">6603</th><td>			*<a class="local col7 ref" href="#1367host" title='host' data-ref="1367host" data-ref-filename="1367host">host</a> = <a class="tu ref fn" href="#dup_all" title='dup_all' data-use='c' data-ref="dup_all" data-ref-filename="dup_all">dup_all</a>(<a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a>);</td></tr>
<tr><th id="6604">6604</th><td>			<b>if</b>(!*<a class="local col7 ref" href="#1367host" title='host' data-ref="1367host" data-ref-filename="1367host">host</a>) <b>return</b> <var>0</var>;</td></tr>
<tr><th id="6605">6605</th><td>		}</td></tr>
<tr><th id="6606">6606</th><td>		<a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a> = <a class="local col4 ref" href="#1374end" title='end' data-ref="1374end" data-ref-filename="1374end">end</a>; <i>/* at next : or / or NULL */</i></td></tr>
<tr><th id="6607">6607</th><td>	}</td></tr>
<tr><th id="6608">6608</th><td></td></tr>
<tr><th id="6609">6609</th><td>	<i>/* parse port number */</i></td></tr>
<tr><th id="6610">6610</th><td>	<b>if</b>(<a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a> &amp;&amp; <a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a>[<var>0</var>] == <kbd>':'</kbd>) {</td></tr>
<tr><th id="6611">6611</th><td>		<em>char</em>* <dfn class="local col5 decl" id="1375end" title='end' data-type='char *' data-ref="1375end" data-ref-filename="1375end">end</dfn> = <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="6612">6612</th><td>		*<a class="local col9 ref" href="#1369port" title='port' data-ref="1369port" data-ref-filename="1369port">port</a> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#strtol" title='strtol' data-ref="strtol" data-ref-filename="strtol">strtol</a>(<a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a>+<var>1</var>, &amp;<a class="local col5 ref" href="#1375end" title='end' data-ref="1375end" data-ref-filename="1375end">end</a>, <var>10</var>);</td></tr>
<tr><th id="6613">6613</th><td>		<a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a> = <a class="local col5 ref" href="#1375end" title='end' data-ref="1375end" data-ref-filename="1375end">end</a>;</td></tr>
<tr><th id="6614">6614</th><td>	}</td></tr>
<tr><th id="6615">6615</th><td></td></tr>
<tr><th id="6616">6616</th><td>	<i>/* parse filename part */</i></td></tr>
<tr><th id="6617">6617</th><td>	<b>while</b>(<a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a> &amp;&amp; *<a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a> == <kbd>'/'</kbd>)</td></tr>
<tr><th id="6618">6618</th><td>		<a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a>++;</td></tr>
<tr><th id="6619">6619</th><td>	<b>if</b>(!<a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a> || <a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a>[<var>0</var>] == <var>0</var>)</td></tr>
<tr><th id="6620">6620</th><td>		*<a class="local col8 ref" href="#1368file" title='file' data-ref="1368file" data-ref-filename="1368file">file</a> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strdup" title='strdup' data-ref="strdup" data-ref-filename="strdup">strdup</a>(<q>"index.html"</q>);</td></tr>
<tr><th id="6621">6621</th><td>	<b>else</b>	*<a class="local col8 ref" href="#1368file" title='file' data-ref="1368file" data-ref-filename="1368file">file</a> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strdup" title='strdup' data-ref="strdup" data-ref-filename="strdup">strdup</a>(<a class="local col1 ref" href="#1371p" title='p' data-ref="1371p" data-ref-filename="1371p">p</a>);</td></tr>
<tr><th id="6622">6622</th><td>	<b>if</b>(!*<a class="local col8 ref" href="#1368file" title='file' data-ref="1368file" data-ref-filename="1368file">file</a>) {</td></tr>
<tr><th id="6623">6623</th><td>		<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"malloc failure"</q>);</td></tr>
<tr><th id="6624">6624</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="6625">6625</th><td>	}</td></tr>
<tr><th id="6626">6626</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="6627">6627</th><td>}</td></tr>
<tr><th id="6628">6628</th><td></td></tr>
<tr><th id="6629">6629</th><td><em>int</em></td></tr>
<tr><th id="6630">6630</th><td><dfn class="decl def fn" id="xfer_set_masters" title='xfer_set_masters' data-ref="xfer_set_masters" data-ref-filename="xfer_set_masters">xfer_set_masters</dfn>(<b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>** <dfn class="local col6 decl" id="1376list" title='list' data-type='struct auth_master **' data-ref="1376list" data-ref-filename="1376list">list</dfn>, <b>struct</b> <a class="type" href="../util/config_file.h.html#config_auth" title='config_auth' data-ref="config_auth" data-ref-filename="config_auth">config_auth</a>* <dfn class="local col7 decl" id="1377c" title='c' data-type='struct config_auth *' data-ref="1377c" data-ref-filename="1377c">c</dfn>,</td></tr>
<tr><th id="6631">6631</th><td>	<em>int</em> <dfn class="local col8 decl" id="1378with_http" title='with_http' data-type='int' data-ref="1378with_http" data-ref-filename="1378with_http">with_http</dfn>)</td></tr>
<tr><th id="6632">6632</th><td>{</td></tr>
<tr><th id="6633">6633</th><td>	<b>struct</b> <a class="type" href="authzone.h.html#auth_master" title='auth_master' data-ref="auth_master" data-ref-filename="auth_master">auth_master</a>* <dfn class="local col9 decl" id="1379m" title='m' data-type='struct auth_master *' data-ref="1379m" data-ref-filename="1379m">m</dfn>;</td></tr>
<tr><th id="6634">6634</th><td>	<b>struct</b> <a class="type" href="../util/config_file.h.html#config_strlist" title='config_strlist' data-ref="config_strlist" data-ref-filename="config_strlist">config_strlist</a>* <dfn class="local col0 decl" id="1380p" title='p' data-type='struct config_strlist *' data-ref="1380p" data-ref-filename="1380p">p</dfn>;</td></tr>
<tr><th id="6635">6635</th><td>	<i>/* list points to the first, or next pointer for the new element */</i></td></tr>
<tr><th id="6636">6636</th><td>	<b>while</b>(*<a class="local col6 ref" href="#1376list" title='list' data-ref="1376list" data-ref-filename="1376list">list</a>) {</td></tr>
<tr><th id="6637">6637</th><td>		<a class="local col6 ref" href="#1376list" title='list' data-ref="1376list" data-ref-filename="1376list">list</a> = &amp;( (*<a class="local col6 ref" href="#1376list" title='list' data-ref="1376list" data-ref-filename="1376list">list</a>)-&gt;<a class="ref field" href="authzone.h.html#auth_master::next" title='auth_master::next' data-ref="auth_master::next" data-ref-filename="auth_master..next">next</a> );</td></tr>
<tr><th id="6638">6638</th><td>	}</td></tr>
<tr><th id="6639">6639</th><td>	<b>if</b>(<a class="local col8 ref" href="#1378with_http" title='with_http' data-ref="1378with_http" data-ref-filename="1378with_http">with_http</a>)</td></tr>
<tr><th id="6640">6640</th><td>	  <b>for</b>(<a class="local col0 ref" href="#1380p" title='p' data-ref="1380p" data-ref-filename="1380p">p</a> = <a class="local col7 ref" href="#1377c" title='c' data-ref="1377c" data-ref-filename="1377c">c</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_auth::urls" title='config_auth::urls' data-ref="config_auth::urls" data-ref-filename="config_auth..urls">urls</a>; <a class="local col0 ref" href="#1380p" title='p' data-ref="1380p" data-ref-filename="1380p">p</a>; <a class="local col0 ref" href="#1380p" title='p' data-ref="1380p" data-ref-filename="1380p">p</a> = <a class="local col0 ref" href="#1380p" title='p' data-ref="1380p" data-ref-filename="1380p">p</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_strlist::next" title='config_strlist::next' data-ref="config_strlist::next" data-ref-filename="config_strlist..next">next</a>) {</td></tr>
<tr><th id="6641">6641</th><td>		<a class="local col9 ref" href="#1379m" title='m' data-ref="1379m" data-ref-filename="1379m">m</a> = <a class="tu ref fn" href="#auth_master_new" title='auth_master_new' data-use='c' data-ref="auth_master_new" data-ref-filename="auth_master_new">auth_master_new</a>(&amp;<a class="local col6 ref" href="#1376list" title='list' data-ref="1376list" data-ref-filename="1376list">list</a>);</td></tr>
<tr><th id="6642">6642</th><td>		<a class="local col9 ref" href="#1379m" title='m' data-ref="1379m" data-ref-filename="1379m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::http" title='auth_master::http' data-ref="auth_master::http" data-ref-filename="auth_master..http">http</a> = <var>1</var>;</td></tr>
<tr><th id="6643">6643</th><td>		<b>if</b>(!<a class="tu ref fn" href="#parse_url" title='parse_url' data-use='c' data-ref="parse_url" data-ref-filename="parse_url">parse_url</a>(<a class="local col0 ref" href="#1380p" title='p' data-ref="1380p" data-ref-filename="1380p">p</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_strlist::str" title='config_strlist::str' data-ref="config_strlist::str" data-ref-filename="config_strlist..str">str</a>, &amp;<a class="local col9 ref" href="#1379m" title='m' data-ref="1379m" data-ref-filename="1379m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>, &amp;<a class="local col9 ref" href="#1379m" title='m' data-ref="1379m" data-ref-filename="1379m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::file" title='auth_master::file' data-ref="auth_master::file" data-ref-filename="auth_master..file">file</a>, &amp;<a class="local col9 ref" href="#1379m" title='m' data-ref="1379m" data-ref-filename="1379m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::port" title='auth_master::port' data-ref="auth_master::port" data-ref-filename="auth_master..port">port</a>, &amp;<a class="local col9 ref" href="#1379m" title='m' data-ref="1379m" data-ref-filename="1379m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::ssl" title='auth_master::ssl' data-ref="auth_master::ssl" data-ref-filename="auth_master..ssl">ssl</a>))</td></tr>
<tr><th id="6644">6644</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="6645">6645</th><td>	}</td></tr>
<tr><th id="6646">6646</th><td>	<b>for</b>(<a class="local col0 ref" href="#1380p" title='p' data-ref="1380p" data-ref-filename="1380p">p</a> = <a class="local col7 ref" href="#1377c" title='c' data-ref="1377c" data-ref-filename="1377c">c</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_auth::masters" title='config_auth::masters' data-ref="config_auth::masters" data-ref-filename="config_auth..masters">masters</a>; <a class="local col0 ref" href="#1380p" title='p' data-ref="1380p" data-ref-filename="1380p">p</a>; <a class="local col0 ref" href="#1380p" title='p' data-ref="1380p" data-ref-filename="1380p">p</a> = <a class="local col0 ref" href="#1380p" title='p' data-ref="1380p" data-ref-filename="1380p">p</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_strlist::next" title='config_strlist::next' data-ref="config_strlist::next" data-ref-filename="config_strlist..next">next</a>) {</td></tr>
<tr><th id="6647">6647</th><td>		<a class="local col9 ref" href="#1379m" title='m' data-ref="1379m" data-ref-filename="1379m">m</a> = <a class="tu ref fn" href="#auth_master_new" title='auth_master_new' data-use='c' data-ref="auth_master_new" data-ref-filename="auth_master_new">auth_master_new</a>(&amp;<a class="local col6 ref" href="#1376list" title='list' data-ref="1376list" data-ref-filename="1376list">list</a>);</td></tr>
<tr><th id="6648">6648</th><td>		<a class="local col9 ref" href="#1379m" title='m' data-ref="1379m" data-ref-filename="1379m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::ixfr" title='auth_master::ixfr' data-ref="auth_master::ixfr" data-ref-filename="auth_master..ixfr">ixfr</a> = <var>1</var>; <i>/* this flag is not configurable */</i></td></tr>
<tr><th id="6649">6649</th><td>		<a class="local col9 ref" href="#1379m" title='m' data-ref="1379m" data-ref-filename="1379m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strdup" title='strdup' data-ref="strdup" data-ref-filename="strdup">strdup</a>(<a class="local col0 ref" href="#1380p" title='p' data-ref="1380p" data-ref-filename="1380p">p</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_strlist::str" title='config_strlist::str' data-ref="config_strlist::str" data-ref-filename="config_strlist..str">str</a>);</td></tr>
<tr><th id="6650">6650</th><td>		<b>if</b>(!<a class="local col9 ref" href="#1379m" title='m' data-ref="1379m" data-ref-filename="1379m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>) {</td></tr>
<tr><th id="6651">6651</th><td>			<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"malloc failure"</q>);</td></tr>
<tr><th id="6652">6652</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="6653">6653</th><td>		}</td></tr>
<tr><th id="6654">6654</th><td>	}</td></tr>
<tr><th id="6655">6655</th><td>	<b>for</b>(<a class="local col0 ref" href="#1380p" title='p' data-ref="1380p" data-ref-filename="1380p">p</a> = <a class="local col7 ref" href="#1377c" title='c' data-ref="1377c" data-ref-filename="1377c">c</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_auth::allow_notify" title='config_auth::allow_notify' data-ref="config_auth::allow_notify" data-ref-filename="config_auth..allow_notify">allow_notify</a>; <a class="local col0 ref" href="#1380p" title='p' data-ref="1380p" data-ref-filename="1380p">p</a>; <a class="local col0 ref" href="#1380p" title='p' data-ref="1380p" data-ref-filename="1380p">p</a> = <a class="local col0 ref" href="#1380p" title='p' data-ref="1380p" data-ref-filename="1380p">p</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_strlist::next" title='config_strlist::next' data-ref="config_strlist::next" data-ref-filename="config_strlist..next">next</a>) {</td></tr>
<tr><th id="6656">6656</th><td>		<a class="local col9 ref" href="#1379m" title='m' data-ref="1379m" data-ref-filename="1379m">m</a> = <a class="tu ref fn" href="#auth_master_new" title='auth_master_new' data-use='c' data-ref="auth_master_new" data-ref-filename="auth_master_new">auth_master_new</a>(&amp;<a class="local col6 ref" href="#1376list" title='list' data-ref="1376list" data-ref-filename="1376list">list</a>);</td></tr>
<tr><th id="6657">6657</th><td>		<a class="local col9 ref" href="#1379m" title='m' data-ref="1379m" data-ref-filename="1379m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::allow_notify" title='auth_master::allow_notify' data-ref="auth_master::allow_notify" data-ref-filename="auth_master..allow_notify">allow_notify</a> = <var>1</var>;</td></tr>
<tr><th id="6658">6658</th><td>		<a class="local col9 ref" href="#1379m" title='m' data-ref="1379m" data-ref-filename="1379m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a> = <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#strdup" title='strdup' data-ref="strdup" data-ref-filename="strdup">strdup</a>(<a class="local col0 ref" href="#1380p" title='p' data-ref="1380p" data-ref-filename="1380p">p</a>-&gt;<a class="ref field" href="../util/config_file.h.html#config_strlist::str" title='config_strlist::str' data-ref="config_strlist::str" data-ref-filename="config_strlist..str">str</a>);</td></tr>
<tr><th id="6659">6659</th><td>		<b>if</b>(!<a class="local col9 ref" href="#1379m" title='m' data-ref="1379m" data-ref-filename="1379m">m</a>-&gt;<a class="ref field" href="authzone.h.html#auth_master::host" title='auth_master::host' data-ref="auth_master::host" data-ref-filename="auth_master..host">host</a>) {</td></tr>
<tr><th id="6660">6660</th><td>			<a class="ref fn" href="../util/log.h.html#log_err" title='log_err' data-ref="log_err" data-ref-filename="log_err">log_err</a>(<q>"malloc failure"</q>);</td></tr>
<tr><th id="6661">6661</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="6662">6662</th><td>		}</td></tr>
<tr><th id="6663">6663</th><td>	}</td></tr>
<tr><th id="6664">6664</th><td>	<b>return</b> <var>1</var>;</td></tr>
<tr><th id="6665">6665</th><td>}</td></tr>
<tr><th id="6666">6666</th><td></td></tr>
<tr><th id="6667">6667</th><td><u>#define <dfn class="macro" id="_M/SERIAL_BITS" data-ref="_M/SERIAL_BITS">SERIAL_BITS</dfn>	32</u></td></tr>
<tr><th id="6668">6668</th><td><em>int</em></td></tr>
<tr><th id="6669">6669</th><td><dfn class="decl def fn" id="compare_serial" title='compare_serial' data-ref="compare_serial" data-ref-filename="compare_serial">compare_serial</dfn>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a> <dfn class="local col1 decl" id="1381a" title='a' data-type='uint32_t' data-ref="1381a" data-ref-filename="1381a">a</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a> <dfn class="local col2 decl" id="1382b" title='b' data-type='uint32_t' data-ref="1382b" data-ref-filename="1382b">b</dfn>)</td></tr>
<tr><th id="6670">6670</th><td>{</td></tr>
<tr><th id="6671">6671</th><td>	<em>const</em> <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a> <dfn class="local col3 decl" id="1383cutoff" title='cutoff' data-type='const uint32_t' data-ref="1383cutoff" data-ref-filename="1383cutoff">cutoff</dfn> = ((<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a>) <var>1</var> &lt;&lt; (<a class="macro" href="#6667" title="32" data-ref="_M/SERIAL_BITS">SERIAL_BITS</a> - <var>1</var>));</td></tr>
<tr><th id="6672">6672</th><td></td></tr>
<tr><th id="6673">6673</th><td>	<b>if</b> (<a class="local col1 ref" href="#1381a" title='a' data-ref="1381a" data-ref-filename="1381a">a</a> == <a class="local col2 ref" href="#1382b" title='b' data-ref="1382b" data-ref-filename="1382b">b</a>) {</td></tr>
<tr><th id="6674">6674</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="6675">6675</th><td>	} <b>else</b> <b>if</b> ((<a class="local col1 ref" href="#1381a" title='a' data-ref="1381a" data-ref-filename="1381a">a</a> &lt; <a class="local col2 ref" href="#1382b" title='b' data-ref="1382b" data-ref-filename="1382b">b</a> &amp;&amp; <a class="local col2 ref" href="#1382b" title='b' data-ref="1382b" data-ref-filename="1382b">b</a> - <a class="local col1 ref" href="#1381a" title='a' data-ref="1381a" data-ref-filename="1381a">a</a> &lt; <a class="local col3 ref" href="#1383cutoff" title='cutoff' data-ref="1383cutoff" data-ref-filename="1383cutoff">cutoff</a>) || (<a class="local col1 ref" href="#1381a" title='a' data-ref="1381a" data-ref-filename="1381a">a</a> &gt; <a class="local col2 ref" href="#1382b" title='b' data-ref="1382b" data-ref-filename="1382b">b</a> &amp;&amp; <a class="local col1 ref" href="#1381a" title='a' data-ref="1381a" data-ref-filename="1381a">a</a> - <a class="local col2 ref" href="#1382b" title='b' data-ref="1382b" data-ref-filename="1382b">b</a> &gt; <a class="local col3 ref" href="#1383cutoff" title='cutoff' data-ref="1383cutoff" data-ref-filename="1383cutoff">cutoff</a>)) {</td></tr>
<tr><th id="6676">6676</th><td>		<b>return</b> -<var>1</var>;</td></tr>
<tr><th id="6677">6677</th><td>	} <b>else</b> {</td></tr>
<tr><th id="6678">6678</th><td>		<b>return</b> <var>1</var>;</td></tr>
<tr><th id="6679">6679</th><td>	}</td></tr>
<tr><th id="6680">6680</th><td>}</td></tr>
<tr><th id="6681">6681</th><td></td></tr>
</table><hr/><p id='footer'>
Generated on <em>2019-Jul-19</em> from project netbsd revision <em>f9da89e0d</em><br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 2.1
<br/>Generator usage only permitted with license.</p>
</div></body></html>
