<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>val_utils.h source code [netbsd/external/bsd/unbound/dist/validator/val_utils.h] - Woboq Code Browser</title>
<meta name="woboq:interestingDefinitions" content="val_classification "/>
<link rel="stylesheet" href="https://code.woboq.org/data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="https://code.woboq.org/data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="https://code.woboq.org/data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="https://code.woboq.org/data/jquery/jquery-ui.min.js"></script>
<script>var file = 'netbsd/external/bsd/unbound/dist/validator/val_utils.h'; var root_path = '../../../../../..'; var data_path = 'https://code.woboq.org/data'; var ecma_script_api_version = 2;</script>
<script src='https://code.woboq.org/data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='../../../../..'>netbsd</a>/<a href='../../../..'>external</a>/<a href='../../..'>bsd</a>/<a href='../..'>unbound</a>/<a href='..'>dist</a>/<a href='./'>validator</a>/<a href='val_utils.h.html'>val_utils.h</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>/*</i></td></tr>
<tr><th id="2">2</th><td><i> * validator/val_utils.h - validator utility functions.</i></td></tr>
<tr><th id="3">3</th><td><i> *</i></td></tr>
<tr><th id="4">4</th><td><i> * Copyright (c) 2007, NLnet Labs. All rights reserved.</i></td></tr>
<tr><th id="5">5</th><td><i> *</i></td></tr>
<tr><th id="6">6</th><td><i> * This software is open source.</i></td></tr>
<tr><th id="7">7</th><td><i> * </i></td></tr>
<tr><th id="8">8</th><td><i> * Redistribution and use in source and binary forms, with or without</i></td></tr>
<tr><th id="9">9</th><td><i> * modification, are permitted provided that the following conditions</i></td></tr>
<tr><th id="10">10</th><td><i> * are met:</i></td></tr>
<tr><th id="11">11</th><td><i> * </i></td></tr>
<tr><th id="12">12</th><td><i> * Redistributions of source code must retain the above copyright notice,</i></td></tr>
<tr><th id="13">13</th><td><i> * this list of conditions and the following disclaimer.</i></td></tr>
<tr><th id="14">14</th><td><i> * </i></td></tr>
<tr><th id="15">15</th><td><i> * Redistributions in binary form must reproduce the above copyright notice,</i></td></tr>
<tr><th id="16">16</th><td><i> * this list of conditions and the following disclaimer in the documentation</i></td></tr>
<tr><th id="17">17</th><td><i> * and/or other materials provided with the distribution.</i></td></tr>
<tr><th id="18">18</th><td><i> * </i></td></tr>
<tr><th id="19">19</th><td><i> * Neither the name of the NLNET LABS nor the names of its contributors may</i></td></tr>
<tr><th id="20">20</th><td><i> * be used to endorse or promote products derived from this software without</i></td></tr>
<tr><th id="21">21</th><td><i> * specific prior written permission.</i></td></tr>
<tr><th id="22">22</th><td><i> * </i></td></tr>
<tr><th id="23">23</th><td><i> * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</i></td></tr>
<tr><th id="24">24</th><td><i> * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</i></td></tr>
<tr><th id="25">25</th><td><i> * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</i></td></tr>
<tr><th id="26">26</th><td><i> * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</i></td></tr>
<tr><th id="27">27</th><td><i> * HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</i></td></tr>
<tr><th id="28">28</th><td><i> * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED</i></td></tr>
<tr><th id="29">29</th><td><i> * TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR</i></td></tr>
<tr><th id="30">30</th><td><i> * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF</i></td></tr>
<tr><th id="31">31</th><td><i> * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING</i></td></tr>
<tr><th id="32">32</th><td><i> * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS</i></td></tr>
<tr><th id="33">33</th><td><i> * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</i></td></tr>
<tr><th id="34">34</th><td><i> */</i></td></tr>
<tr><th id="35">35</th><td></td></tr>
<tr><th id="36">36</th><td><i class="doc">/**</i></td></tr>
<tr><th id="37">37</th><td><i class="doc"> *<span class="command"> \file</span></i></td></tr>
<tr><th id="38">38</th><td><i class="doc"> *</i></td></tr>
<tr><th id="39">39</th><td><i class="doc"> * This file contains helper functions for the validator module.</i></td></tr>
<tr><th id="40">40</th><td><i class="doc"> */</i></td></tr>
<tr><th id="41">41</th><td></td></tr>
<tr><th id="42">42</th><td><u>#<span data-ppcond="42">ifndef</span> <span class="macro" data-ref="_M/VALIDATOR_VAL_UTILS_H">VALIDATOR_VAL_UTILS_H</span></u></td></tr>
<tr><th id="43">43</th><td><u>#define <dfn class="macro" id="_M/VALIDATOR_VAL_UTILS_H" data-ref="_M/VALIDATOR_VAL_UTILS_H">VALIDATOR_VAL_UTILS_H</dfn></u></td></tr>
<tr><th id="44">44</th><td><u>#include <a href="../util/data/packed_rrset.h.html">"util/data/packed_rrset.h"</a></u></td></tr>
<tr><th id="45">45</th><td><u>#include <a href="../sldns/pkthdr.h.html">"sldns/pkthdr.h"</a></u></td></tr>
<tr><th id="46">46</th><td><b>struct</b> <a class="type" href="../util/data/msgreply.h.html#query_info" title='query_info' data-ref="query_info" data-ref-filename="query_info" id="query_info">query_info</a>;</td></tr>
<tr><th id="47">47</th><td><b>struct</b> <a class="type" href="../util/data/msgreply.h.html#reply_info" title='reply_info' data-ref="reply_info" data-ref-filename="reply_info" id="reply_info">reply_info</a>;</td></tr>
<tr><th id="48">48</th><td><b>struct</b> <dfn class="type" id="val_env" title='val_env' data-ref="val_env" data-ref-filename="val_env">val_env</dfn>;</td></tr>
<tr><th id="49">49</th><td><b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env" id="module_env">module_env</a>;</td></tr>
<tr><th id="50">50</th><td><b>struct</b> <a class="type" href="../util/module.h.html#module_qstate" title='module_qstate' data-ref="module_qstate" data-ref-filename="module_qstate" id="module_qstate">module_qstate</a>;</td></tr>
<tr><th id="51">51</th><td><b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key" title='ub_packed_rrset_key' data-ref="ub_packed_rrset_key" data-ref-filename="ub_packed_rrset_key" id="ub_packed_rrset_key">ub_packed_rrset_key</a>;</td></tr>
<tr><th id="52">52</th><td><b>struct</b> <a class="type" href="val_kentry.h.html#key_entry_key" title='key_entry_key' data-ref="key_entry_key" data-ref-filename="key_entry_key" id="key_entry_key">key_entry_key</a>;</td></tr>
<tr><th id="53">53</th><td><b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional" id="regional">regional</a>;</td></tr>
<tr><th id="54">54</th><td><b>struct</b> <a class="type" href="val_anchor.h.html#val_anchors" title='val_anchors' data-ref="val_anchors" data-ref-filename="val_anchors" id="val_anchors">val_anchors</a>;</td></tr>
<tr><th id="55">55</th><td><b>struct</b> <a class="type" href="../services/cache/rrset.h.html#rrset_cache" title='rrset_cache' data-ref="rrset_cache" data-ref-filename="rrset_cache" id="rrset_cache">rrset_cache</a>;</td></tr>
<tr><th id="56">56</th><td><b>struct</b> <a class="type" href="../util/module.h.html#sock_list" title='sock_list' data-ref="sock_list" data-ref-filename="sock_list" id="sock_list">sock_list</a>;</td></tr>
<tr><th id="57">57</th><td></td></tr>
<tr><th id="58">58</th><td><i class="doc">/**</i></td></tr>
<tr><th id="59">59</th><td><i class="doc"> * Response classifications for the validator. The different types of proofs.</i></td></tr>
<tr><th id="60">60</th><td><i class="doc"> */</i></td></tr>
<tr><th id="61">61</th><td><b>enum</b> <dfn class="type def" id="val_classification" title='val_classification' data-ref="val_classification" data-ref-filename="val_classification">val_classification</dfn> {</td></tr>
<tr><th id="62">62</th><td>	<i class="doc">/** Not subtyped yet. */</i></td></tr>
<tr><th id="63">63</th><td>	<dfn class="enum" id="VAL_CLASS_UNTYPED" title='VAL_CLASS_UNTYPED' data-ref="VAL_CLASS_UNTYPED" data-ref-filename="VAL_CLASS_UNTYPED">VAL_CLASS_UNTYPED</dfn> = <var>0</var>,</td></tr>
<tr><th id="64">64</th><td>	<i class="doc">/** Not a recognized subtype. */</i></td></tr>
<tr><th id="65">65</th><td>	<dfn class="enum" id="VAL_CLASS_UNKNOWN" title='VAL_CLASS_UNKNOWN' data-ref="VAL_CLASS_UNKNOWN" data-ref-filename="VAL_CLASS_UNKNOWN">VAL_CLASS_UNKNOWN</dfn>,</td></tr>
<tr><th id="66">66</th><td>	<i class="doc">/** A positive, direct, response */</i></td></tr>
<tr><th id="67">67</th><td>	<dfn class="enum" id="VAL_CLASS_POSITIVE" title='VAL_CLASS_POSITIVE' data-ref="VAL_CLASS_POSITIVE" data-ref-filename="VAL_CLASS_POSITIVE">VAL_CLASS_POSITIVE</dfn>,</td></tr>
<tr><th id="68">68</th><td>	<i class="doc">/** A positive response, with a CNAME/DNAME chain. */</i></td></tr>
<tr><th id="69">69</th><td>	<dfn class="enum" id="VAL_CLASS_CNAME" title='VAL_CLASS_CNAME' data-ref="VAL_CLASS_CNAME" data-ref-filename="VAL_CLASS_CNAME">VAL_CLASS_CNAME</dfn>,</td></tr>
<tr><th id="70">70</th><td>	<i class="doc">/** A NOERROR/NODATA response. */</i></td></tr>
<tr><th id="71">71</th><td>	<dfn class="enum" id="VAL_CLASS_NODATA" title='VAL_CLASS_NODATA' data-ref="VAL_CLASS_NODATA" data-ref-filename="VAL_CLASS_NODATA">VAL_CLASS_NODATA</dfn>,</td></tr>
<tr><th id="72">72</th><td>	<i class="doc">/** A NXDOMAIN response. */</i></td></tr>
<tr><th id="73">73</th><td>	<dfn class="enum" id="VAL_CLASS_NAMEERROR" title='VAL_CLASS_NAMEERROR' data-ref="VAL_CLASS_NAMEERROR" data-ref-filename="VAL_CLASS_NAMEERROR">VAL_CLASS_NAMEERROR</dfn>,</td></tr>
<tr><th id="74">74</th><td>	<i class="doc">/** A CNAME/DNAME chain, and the offset is at the end of it,</i></td></tr>
<tr><th id="75">75</th><td><i class="doc">	 * but there is no answer here, it can be NAMEERROR or NODATA. */</i></td></tr>
<tr><th id="76">76</th><td>	<dfn class="enum" id="VAL_CLASS_CNAMENOANSWER" title='VAL_CLASS_CNAMENOANSWER' data-ref="VAL_CLASS_CNAMENOANSWER" data-ref-filename="VAL_CLASS_CNAMENOANSWER">VAL_CLASS_CNAMENOANSWER</dfn>,</td></tr>
<tr><th id="77">77</th><td>	<i class="doc">/** A referral, from cache with a nonRD query. */</i></td></tr>
<tr><th id="78">78</th><td>	<dfn class="enum" id="VAL_CLASS_REFERRAL" title='VAL_CLASS_REFERRAL' data-ref="VAL_CLASS_REFERRAL" data-ref-filename="VAL_CLASS_REFERRAL">VAL_CLASS_REFERRAL</dfn>,</td></tr>
<tr><th id="79">79</th><td>	<i class="doc">/** A response to a qtype=ANY query. */</i></td></tr>
<tr><th id="80">80</th><td>	<dfn class="enum" id="VAL_CLASS_ANY" title='VAL_CLASS_ANY' data-ref="VAL_CLASS_ANY" data-ref-filename="VAL_CLASS_ANY">VAL_CLASS_ANY</dfn></td></tr>
<tr><th id="81">81</th><td>};</td></tr>
<tr><th id="82">82</th><td></td></tr>
<tr><th id="83">83</th><td><i class="doc">/**</i></td></tr>
<tr><th id="84">84</th><td><i class="doc"> * Given a response, classify ANSWER responses into a subtype.</i></td></tr>
<tr><th id="85">85</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">query_flags:</span> query flags for the original query.</i></td></tr>
<tr><th id="86">86</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">origqinf:</span> query info. The original query name.</i></td></tr>
<tr><th id="87">87</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">qinf:</span> query info. The chased query name.</i></td></tr>
<tr><th id="88">88</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">rep:</span> response. The original response.</i></td></tr>
<tr><th id="89">89</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">skip:</span> offset into the original response answer section.</i></td></tr>
<tr><th id="90">90</th><td><i class="doc"> * <span class="command">@return</span> A subtype, all values possible except UNTYPED .</i></td></tr>
<tr><th id="91">91</th><td><i class="doc"> * 	Once CNAME type is returned you can increase skip.</i></td></tr>
<tr><th id="92">92</th><td><i class="doc"> * 	Then, another CNAME type, CNAME_NOANSWER or POSITIVE are possible.</i></td></tr>
<tr><th id="93">93</th><td><i class="doc"> */</i></td></tr>
<tr><th id="94">94</th><td><b>enum</b> <a class="type" href="#val_classification" title='val_classification' data-ref="val_classification" data-ref-filename="val_classification">val_classification</a> <dfn class="decl fn" id="val_classify_response" title='val_classify_response' data-ref="val_classify_response" data-ref-filename="val_classify_response">val_classify_response</dfn>(<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col6 decl" id="306query_flags" title='query_flags' data-type='uint16_t' data-ref="306query_flags" data-ref-filename="306query_flags">query_flags</dfn>,</td></tr>
<tr><th id="95">95</th><td>	<b>struct</b> <a class="type" href="../util/data/msgreply.h.html#query_info" title='query_info' data-ref="query_info" data-ref-filename="query_info">query_info</a>* <dfn class="local col7 decl" id="307origqinf" title='origqinf' data-type='struct query_info *' data-ref="307origqinf" data-ref-filename="307origqinf">origqinf</dfn>, <b>struct</b> <a class="type" href="../util/data/msgreply.h.html#query_info" title='query_info' data-ref="query_info" data-ref-filename="query_info">query_info</a>* <dfn class="local col8 decl" id="308qinf" title='qinf' data-type='struct query_info *' data-ref="308qinf" data-ref-filename="308qinf">qinf</dfn>, </td></tr>
<tr><th id="96">96</th><td>	<b>struct</b> <a class="type" href="../util/data/msgreply.h.html#reply_info" title='reply_info' data-ref="reply_info" data-ref-filename="reply_info">reply_info</a>* <dfn class="local col9 decl" id="309rep" title='rep' data-type='struct reply_info *' data-ref="309rep" data-ref-filename="309rep">rep</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col0 decl" id="310skip" title='skip' data-type='size_t' data-ref="310skip" data-ref-filename="310skip">skip</dfn>);</td></tr>
<tr><th id="97">97</th><td></td></tr>
<tr><th id="98">98</th><td><i class="doc">/**</i></td></tr>
<tr><th id="99">99</th><td><i class="doc"> * Given a response, determine the name of the "signer". This is primarily</i></td></tr>
<tr><th id="100">100</th><td><i class="doc"> * to determine if the response is, in fact, signed at all, and, if so, what</i></td></tr>
<tr><th id="101">101</th><td><i class="doc"> * is the name of the most pertinent keyset.</i></td></tr>
<tr><th id="102">102</th><td><i class="doc"> *</i></td></tr>
<tr><th id="103">103</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">subtype:</span> the type from classify.</i></td></tr>
<tr><th id="104">104</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">qinf:</span> query, the chased query name.</i></td></tr>
<tr><th id="105">105</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">rep:</span> response to that, original response.</i></td></tr>
<tr><th id="106">106</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">cname_skip:</span> how many answer rrsets have been skipped due to CNAME</i></td></tr>
<tr><th id="107">107</th><td><i class="doc"> * 	chains being chased around.</i></td></tr>
<tr><th id="108">108</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">signer_name:</span>  signer name, if the response is signed </i></td></tr>
<tr><th id="109">109</th><td><i class="doc"> * 	(even partially), or null if the response isn't signed.</i></td></tr>
<tr><th id="110">110</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">signer_len:</span> length of signer_name of 0 if signer_name is NULL.</i></td></tr>
<tr><th id="111">111</th><td><i class="doc"> */</i></td></tr>
<tr><th id="112">112</th><td><em>void</em> <dfn class="decl fn" id="val_find_signer" title='val_find_signer' data-ref="val_find_signer" data-ref-filename="val_find_signer">val_find_signer</dfn>(<b>enum</b> <a class="type" href="#val_classification" title='val_classification' data-ref="val_classification" data-ref-filename="val_classification">val_classification</a> <dfn class="local col1 decl" id="311subtype" title='subtype' data-type='enum val_classification' data-ref="311subtype" data-ref-filename="311subtype">subtype</dfn>, </td></tr>
<tr><th id="113">113</th><td>	<b>struct</b> <a class="type" href="../util/data/msgreply.h.html#query_info" title='query_info' data-ref="query_info" data-ref-filename="query_info">query_info</a>* <dfn class="local col2 decl" id="312qinf" title='qinf' data-type='struct query_info *' data-ref="312qinf" data-ref-filename="312qinf">qinf</dfn>, <b>struct</b> <a class="type" href="../util/data/msgreply.h.html#reply_info" title='reply_info' data-ref="reply_info" data-ref-filename="reply_info">reply_info</a>* <dfn class="local col3 decl" id="313rep" title='rep' data-type='struct reply_info *' data-ref="313rep" data-ref-filename="313rep">rep</dfn>,</td></tr>
<tr><th id="114">114</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col4 decl" id="314cname_skip" title='cname_skip' data-type='size_t' data-ref="314cname_skip" data-ref-filename="314cname_skip">cname_skip</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>** <dfn class="local col5 decl" id="315signer_name" title='signer_name' data-type='uint8_t **' data-ref="315signer_name" data-ref-filename="315signer_name">signer_name</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>* <dfn class="local col6 decl" id="316signer_len" title='signer_len' data-type='size_t *' data-ref="316signer_len" data-ref-filename="316signer_len">signer_len</dfn>);</td></tr>
<tr><th id="115">115</th><td></td></tr>
<tr><th id="116">116</th><td><i class="doc">/**</i></td></tr>
<tr><th id="117">117</th><td><i class="doc"> * Verify RRset with keys</i></td></tr>
<tr><th id="118">118</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">env:</span> module environment (scratch buffer)</i></td></tr>
<tr><th id="119">119</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">ve:</span> validator environment (verification settings)</i></td></tr>
<tr><th id="120">120</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">rrset:</span> what to verify</i></td></tr>
<tr><th id="121">121</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">keys:</span> dnskey rrset to verify with.</i></td></tr>
<tr><th id="122">122</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">sigalg:</span> if nonNULL provide downgrade protection otherwise one</i></td></tr>
<tr><th id="123">123</th><td><i class="doc"> *   algorithm is enough.  Algo list is constructed in here.</i></td></tr>
<tr><th id="124">124</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">reason:</span> reason of failure. Fixed string or alloced in scratch.</i></td></tr>
<tr><th id="125">125</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">section:</span> section of packet where this rrset comes from.</i></td></tr>
<tr><th id="126">126</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">qstate:</span> qstate with region.</i></td></tr>
<tr><th id="127">127</th><td><i class="doc"> * <span class="command">@return</span> security status of verification.</i></td></tr>
<tr><th id="128">128</th><td><i class="doc"> */</i></td></tr>
<tr><th id="129">129</th><td><b>enum</b> <a class="type" href="../util/data/packed_rrset.h.html#sec_status" title='sec_status' data-ref="sec_status" data-ref-filename="sec_status">sec_status</a> <dfn class="decl fn" id="val_verify_rrset" title='val_verify_rrset' data-ref="val_verify_rrset" data-ref-filename="val_verify_rrset">val_verify_rrset</dfn>(<b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col7 decl" id="317env" title='env' data-type='struct module_env *' data-ref="317env" data-ref-filename="317env">env</dfn>, <b>struct</b> <a class="type" href="#val_env" title='val_env' data-ref="val_env" data-ref-filename="val_env">val_env</a>* <dfn class="local col8 decl" id="318ve" title='ve' data-type='struct val_env *' data-ref="318ve" data-ref-filename="318ve">ve</dfn>,</td></tr>
<tr><th id="130">130</th><td>	<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key" title='ub_packed_rrset_key' data-ref="ub_packed_rrset_key" data-ref-filename="ub_packed_rrset_key">ub_packed_rrset_key</a>* <dfn class="local col9 decl" id="319rrset" title='rrset' data-type='struct ub_packed_rrset_key *' data-ref="319rrset" data-ref-filename="319rrset">rrset</dfn>, <b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key" title='ub_packed_rrset_key' data-ref="ub_packed_rrset_key" data-ref-filename="ub_packed_rrset_key">ub_packed_rrset_key</a>* <dfn class="local col0 decl" id="320keys" title='keys' data-type='struct ub_packed_rrset_key *' data-ref="320keys" data-ref-filename="320keys">keys</dfn>,</td></tr>
<tr><th id="131">131</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col1 decl" id="321sigalg" title='sigalg' data-type='uint8_t *' data-ref="321sigalg" data-ref-filename="321sigalg">sigalg</dfn>, <em>char</em>** <dfn class="local col2 decl" id="322reason" title='reason' data-type='char **' data-ref="322reason" data-ref-filename="322reason">reason</dfn>, <a class="typedef" href="../sldns/pkthdr.h.html#sldns_pkt_section" title='sldns_pkt_section' data-type='enum sldns_enum_pkt_section' data-ref="sldns_pkt_section" data-ref-filename="sldns_pkt_section">sldns_pkt_section</a> <dfn class="local col3 decl" id="323section" title='section' data-type='sldns_pkt_section' data-ref="323section" data-ref-filename="323section">section</dfn>,</td></tr>
<tr><th id="132">132</th><td>	<b>struct</b> <a class="type" href="../util/module.h.html#module_qstate" title='module_qstate' data-ref="module_qstate" data-ref-filename="module_qstate">module_qstate</a>* <dfn class="local col4 decl" id="324qstate" title='qstate' data-type='struct module_qstate *' data-ref="324qstate" data-ref-filename="324qstate">qstate</dfn>);</td></tr>
<tr><th id="133">133</th><td></td></tr>
<tr><th id="134">134</th><td><i class="doc">/**</i></td></tr>
<tr><th id="135">135</th><td><i class="doc"> * Verify RRset with keys from a keyset.</i></td></tr>
<tr><th id="136">136</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">env:</span> module environment (scratch buffer)</i></td></tr>
<tr><th id="137">137</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">ve:</span> validator environment (verification settings)</i></td></tr>
<tr><th id="138">138</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">rrset:</span> what to verify</i></td></tr>
<tr><th id="139">139</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">kkey:</span> key_entry to verify with.</i></td></tr>
<tr><th id="140">140</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">reason:</span> reason of failure. Fixed string or alloced in scratch.</i></td></tr>
<tr><th id="141">141</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">section:</span> section of packet where this rrset comes from.</i></td></tr>
<tr><th id="142">142</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">qstate:</span> qstate with region.</i></td></tr>
<tr><th id="143">143</th><td><i class="doc"> * <span class="command">@return</span> security status of verification.</i></td></tr>
<tr><th id="144">144</th><td><i class="doc"> */</i></td></tr>
<tr><th id="145">145</th><td><b>enum</b> <a class="type" href="../util/data/packed_rrset.h.html#sec_status" title='sec_status' data-ref="sec_status" data-ref-filename="sec_status">sec_status</a> <dfn class="decl fn" id="val_verify_rrset_entry" title='val_verify_rrset_entry' data-ref="val_verify_rrset_entry" data-ref-filename="val_verify_rrset_entry">val_verify_rrset_entry</dfn>(<b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col5 decl" id="325env" title='env' data-type='struct module_env *' data-ref="325env" data-ref-filename="325env">env</dfn>, </td></tr>
<tr><th id="146">146</th><td>	<b>struct</b> <a class="type" href="#val_env" title='val_env' data-ref="val_env" data-ref-filename="val_env">val_env</a>* <dfn class="local col6 decl" id="326ve" title='ve' data-type='struct val_env *' data-ref="326ve" data-ref-filename="326ve">ve</dfn>, <b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key" title='ub_packed_rrset_key' data-ref="ub_packed_rrset_key" data-ref-filename="ub_packed_rrset_key">ub_packed_rrset_key</a>* <dfn class="local col7 decl" id="327rrset" title='rrset' data-type='struct ub_packed_rrset_key *' data-ref="327rrset" data-ref-filename="327rrset">rrset</dfn>, </td></tr>
<tr><th id="147">147</th><td>	<b>struct</b> <a class="type" href="val_kentry.h.html#key_entry_key" title='key_entry_key' data-ref="key_entry_key" data-ref-filename="key_entry_key">key_entry_key</a>* <dfn class="local col8 decl" id="328kkey" title='kkey' data-type='struct key_entry_key *' data-ref="328kkey" data-ref-filename="328kkey">kkey</dfn>, <em>char</em>** <dfn class="local col9 decl" id="329reason" title='reason' data-type='char **' data-ref="329reason" data-ref-filename="329reason">reason</dfn>, <a class="typedef" href="../sldns/pkthdr.h.html#sldns_pkt_section" title='sldns_pkt_section' data-type='enum sldns_enum_pkt_section' data-ref="sldns_pkt_section" data-ref-filename="sldns_pkt_section">sldns_pkt_section</a> <dfn class="local col0 decl" id="330section" title='section' data-type='sldns_pkt_section' data-ref="330section" data-ref-filename="330section">section</dfn>,</td></tr>
<tr><th id="148">148</th><td>	<b>struct</b> <a class="type" href="../util/module.h.html#module_qstate" title='module_qstate' data-ref="module_qstate" data-ref-filename="module_qstate">module_qstate</a>* <dfn class="local col1 decl" id="331qstate" title='qstate' data-type='struct module_qstate *' data-ref="331qstate" data-ref-filename="331qstate">qstate</dfn>);</td></tr>
<tr><th id="149">149</th><td></td></tr>
<tr><th id="150">150</th><td><i class="doc">/**</i></td></tr>
<tr><th id="151">151</th><td><i class="doc"> * Verify DNSKEYs with DS rrset. Like val_verify_new_DNSKEYs but</i></td></tr>
<tr><th id="152">152</th><td><i class="doc"> * returns a sec_status instead of a key_entry.</i></td></tr>
<tr><th id="153">153</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">env:</span> module environment (scratch buffer)</i></td></tr>
<tr><th id="154">154</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">ve:</span> validator environment (verification settings)</i></td></tr>
<tr><th id="155">155</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">dnskey_rrset:</span> DNSKEY rrset to verify</i></td></tr>
<tr><th id="156">156</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">ds_rrset:</span> DS rrset to verify with.</i></td></tr>
<tr><th id="157">157</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">sigalg:</span> if nonNULL provide downgrade protection otherwise one</i></td></tr>
<tr><th id="158">158</th><td><i class="doc"> *   algorithm is enough.  The list of signalled algorithms is returned,</i></td></tr>
<tr><th id="159">159</th><td><i class="doc"> *   must have enough space for ALGO_NEEDS_MAX+1.</i></td></tr>
<tr><th id="160">160</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">reason:</span> reason of failure. Fixed string or alloced in scratch.</i></td></tr>
<tr><th id="161">161</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">qstate:</span> qstate with region.</i></td></tr>
<tr><th id="162">162</th><td><i class="doc"> * <span class="command">@return</span>: sec_status_secure if a DS matches.</i></td></tr>
<tr><th id="163">163</th><td><i class="doc"> *     sec_status_insecure if end of trust (i.e., unknown algorithms).</i></td></tr>
<tr><th id="164">164</th><td><i class="doc"> *     sec_status_bogus if it fails.</i></td></tr>
<tr><th id="165">165</th><td><i class="doc"> */</i></td></tr>
<tr><th id="166">166</th><td><b>enum</b> <a class="type" href="../util/data/packed_rrset.h.html#sec_status" title='sec_status' data-ref="sec_status" data-ref-filename="sec_status">sec_status</a> <dfn class="decl fn" id="val_verify_DNSKEY_with_DS" title='val_verify_DNSKEY_with_DS' data-ref="val_verify_DNSKEY_with_DS" data-ref-filename="val_verify_DNSKEY_with_DS">val_verify_DNSKEY_with_DS</dfn>(<b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col2 decl" id="332env" title='env' data-type='struct module_env *' data-ref="332env" data-ref-filename="332env">env</dfn>, </td></tr>
<tr><th id="167">167</th><td>	<b>struct</b> <a class="type" href="#val_env" title='val_env' data-ref="val_env" data-ref-filename="val_env">val_env</a>* <dfn class="local col3 decl" id="333ve" title='ve' data-type='struct val_env *' data-ref="333ve" data-ref-filename="333ve">ve</dfn>, <b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key" title='ub_packed_rrset_key' data-ref="ub_packed_rrset_key" data-ref-filename="ub_packed_rrset_key">ub_packed_rrset_key</a>* <dfn class="local col4 decl" id="334dnskey_rrset" title='dnskey_rrset' data-type='struct ub_packed_rrset_key *' data-ref="334dnskey_rrset" data-ref-filename="334dnskey_rrset">dnskey_rrset</dfn>, </td></tr>
<tr><th id="168">168</th><td>	<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key" title='ub_packed_rrset_key' data-ref="ub_packed_rrset_key" data-ref-filename="ub_packed_rrset_key">ub_packed_rrset_key</a>* <dfn class="local col5 decl" id="335ds_rrset" title='ds_rrset' data-type='struct ub_packed_rrset_key *' data-ref="335ds_rrset" data-ref-filename="335ds_rrset">ds_rrset</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col6 decl" id="336sigalg" title='sigalg' data-type='uint8_t *' data-ref="336sigalg" data-ref-filename="336sigalg">sigalg</dfn>, <em>char</em>** <dfn class="local col7 decl" id="337reason" title='reason' data-type='char **' data-ref="337reason" data-ref-filename="337reason">reason</dfn>,</td></tr>
<tr><th id="169">169</th><td>	<b>struct</b> <a class="type" href="../util/module.h.html#module_qstate" title='module_qstate' data-ref="module_qstate" data-ref-filename="module_qstate">module_qstate</a>* <dfn class="local col8 decl" id="338qstate" title='qstate' data-type='struct module_qstate *' data-ref="338qstate" data-ref-filename="338qstate">qstate</dfn>);</td></tr>
<tr><th id="170">170</th><td></td></tr>
<tr><th id="171">171</th><td><i class="doc">/**</i></td></tr>
<tr><th id="172">172</th><td><i class="doc"> * Verify DNSKEYs with DS and DNSKEY rrset.  Like val_verify_DNSKEY_with_DS</i></td></tr>
<tr><th id="173">173</th><td><i class="doc"> * but for a trust anchor.</i></td></tr>
<tr><th id="174">174</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">env:</span> module environment (scratch buffer)</i></td></tr>
<tr><th id="175">175</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">ve:</span> validator environment (verification settings)</i></td></tr>
<tr><th id="176">176</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">dnskey_rrset:</span> DNSKEY rrset to verify</i></td></tr>
<tr><th id="177">177</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">ta_ds:</span> DS rrset to verify with.</i></td></tr>
<tr><th id="178">178</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">ta_dnskey:</span> DNSKEY rrset to verify with.</i></td></tr>
<tr><th id="179">179</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">sigalg:</span> if nonNULL provide downgrade protection otherwise one</i></td></tr>
<tr><th id="180">180</th><td><i class="doc"> *   algorithm is enough.  The list of signalled algorithms is returned,</i></td></tr>
<tr><th id="181">181</th><td><i class="doc"> *   must have enough space for ALGO_NEEDS_MAX+1.</i></td></tr>
<tr><th id="182">182</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">reason:</span> reason of failure. Fixed string or alloced in scratch.</i></td></tr>
<tr><th id="183">183</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">qstate:</span> qstate with region.</i></td></tr>
<tr><th id="184">184</th><td><i class="doc"> * <span class="command">@return</span>: sec_status_secure if a DS matches.</i></td></tr>
<tr><th id="185">185</th><td><i class="doc"> *     sec_status_insecure if end of trust (i.e., unknown algorithms).</i></td></tr>
<tr><th id="186">186</th><td><i class="doc"> *     sec_status_bogus if it fails.</i></td></tr>
<tr><th id="187">187</th><td><i class="doc"> */</i></td></tr>
<tr><th id="188">188</th><td><b>enum</b> <a class="type" href="../util/data/packed_rrset.h.html#sec_status" title='sec_status' data-ref="sec_status" data-ref-filename="sec_status">sec_status</a> <dfn class="decl fn" id="val_verify_DNSKEY_with_TA" title='val_verify_DNSKEY_with_TA' data-ref="val_verify_DNSKEY_with_TA" data-ref-filename="val_verify_DNSKEY_with_TA">val_verify_DNSKEY_with_TA</dfn>(<b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col9 decl" id="339env" title='env' data-type='struct module_env *' data-ref="339env" data-ref-filename="339env">env</dfn>, </td></tr>
<tr><th id="189">189</th><td>	<b>struct</b> <a class="type" href="#val_env" title='val_env' data-ref="val_env" data-ref-filename="val_env">val_env</a>* <dfn class="local col0 decl" id="340ve" title='ve' data-type='struct val_env *' data-ref="340ve" data-ref-filename="340ve">ve</dfn>, <b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key" title='ub_packed_rrset_key' data-ref="ub_packed_rrset_key" data-ref-filename="ub_packed_rrset_key">ub_packed_rrset_key</a>* <dfn class="local col1 decl" id="341dnskey_rrset" title='dnskey_rrset' data-type='struct ub_packed_rrset_key *' data-ref="341dnskey_rrset" data-ref-filename="341dnskey_rrset">dnskey_rrset</dfn>, </td></tr>
<tr><th id="190">190</th><td>	<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key" title='ub_packed_rrset_key' data-ref="ub_packed_rrset_key" data-ref-filename="ub_packed_rrset_key">ub_packed_rrset_key</a>* <dfn class="local col2 decl" id="342ta_ds" title='ta_ds' data-type='struct ub_packed_rrset_key *' data-ref="342ta_ds" data-ref-filename="342ta_ds">ta_ds</dfn>,</td></tr>
<tr><th id="191">191</th><td>	<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key" title='ub_packed_rrset_key' data-ref="ub_packed_rrset_key" data-ref-filename="ub_packed_rrset_key">ub_packed_rrset_key</a>* <dfn class="local col3 decl" id="343ta_dnskey" title='ta_dnskey' data-type='struct ub_packed_rrset_key *' data-ref="343ta_dnskey" data-ref-filename="343ta_dnskey">ta_dnskey</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col4 decl" id="344sigalg" title='sigalg' data-type='uint8_t *' data-ref="344sigalg" data-ref-filename="344sigalg">sigalg</dfn>, <em>char</em>** <dfn class="local col5 decl" id="345reason" title='reason' data-type='char **' data-ref="345reason" data-ref-filename="345reason">reason</dfn>,</td></tr>
<tr><th id="192">192</th><td>	<b>struct</b> <a class="type" href="../util/module.h.html#module_qstate" title='module_qstate' data-ref="module_qstate" data-ref-filename="module_qstate">module_qstate</a>* <dfn class="local col6 decl" id="346qstate" title='qstate' data-type='struct module_qstate *' data-ref="346qstate" data-ref-filename="346qstate">qstate</dfn>);</td></tr>
<tr><th id="193">193</th><td></td></tr>
<tr><th id="194">194</th><td><i class="doc">/**</i></td></tr>
<tr><th id="195">195</th><td><i class="doc"> * Verify new DNSKEYs with DS rrset. The DS contains hash values that should</i></td></tr>
<tr><th id="196">196</th><td><i class="doc"> * match the DNSKEY keys.</i></td></tr>
<tr><th id="197">197</th><td><i class="doc"> * match the DS to a DNSKEY and verify the DNSKEY rrset with that key.</i></td></tr>
<tr><th id="198">198</th><td><i class="doc"> *</i></td></tr>
<tr><th id="199">199</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">region:</span> where to allocate key entry result.</i></td></tr>
<tr><th id="200">200</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">env:</span> module environment (scratch buffer)</i></td></tr>
<tr><th id="201">201</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">ve:</span> validator environment (verification settings)</i></td></tr>
<tr><th id="202">202</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">dnskey_rrset:</span> DNSKEY rrset to verify</i></td></tr>
<tr><th id="203">203</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">ds_rrset:</span> DS rrset to verify with.</i></td></tr>
<tr><th id="204">204</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">downprot:</span> if true provide downgrade protection otherwise one</i></td></tr>
<tr><th id="205">205</th><td><i class="doc"> *   algorithm is enough.</i></td></tr>
<tr><th id="206">206</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">reason:</span> reason of failure. Fixed string or alloced in scratch.</i></td></tr>
<tr><th id="207">207</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">qstate:</span> qstate with region.</i></td></tr>
<tr><th id="208">208</th><td><i class="doc"> * <span class="command">@return</span> a KeyEntry. This will either contain the now trusted</i></td></tr>
<tr><th id="209">209</th><td><i class="doc"> *         dnskey_rrset, a "null" key entry indicating that this DS</i></td></tr>
<tr><th id="210">210</th><td><i class="doc"> *         rrset/DNSKEY pair indicate an secure end to the island of trust</i></td></tr>
<tr><th id="211">211</th><td><i class="doc"> *         (i.e., unknown algorithms), or a "bad" KeyEntry if the dnskey</i></td></tr>
<tr><th id="212">212</th><td><i class="doc"> *         rrset fails to verify. Note that the "null" response should</i></td></tr>
<tr><th id="213">213</th><td><i class="doc"> *         generally only occur in a private algorithm scenario: normally</i></td></tr>
<tr><th id="214">214</th><td><i class="doc"> *         this sort of thing is checked before fetching the matching DNSKEY</i></td></tr>
<tr><th id="215">215</th><td><i class="doc"> *         rrset.</i></td></tr>
<tr><th id="216">216</th><td><i class="doc"> *         if downprot is set, a key entry with an algo list is made.</i></td></tr>
<tr><th id="217">217</th><td><i class="doc"> */</i></td></tr>
<tr><th id="218">218</th><td><b>struct</b> <a class="type" href="val_kentry.h.html#key_entry_key" title='key_entry_key' data-ref="key_entry_key" data-ref-filename="key_entry_key">key_entry_key</a>* <dfn class="decl fn" id="val_verify_new_DNSKEYs" title='val_verify_new_DNSKEYs' data-ref="val_verify_new_DNSKEYs" data-ref-filename="val_verify_new_DNSKEYs">val_verify_new_DNSKEYs</dfn>(<b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col7 decl" id="347region" title='region' data-type='struct regional *' data-ref="347region" data-ref-filename="347region">region</dfn>, </td></tr>
<tr><th id="219">219</th><td>	<b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col8 decl" id="348env" title='env' data-type='struct module_env *' data-ref="348env" data-ref-filename="348env">env</dfn>, <b>struct</b> <a class="type" href="#val_env" title='val_env' data-ref="val_env" data-ref-filename="val_env">val_env</a>* <dfn class="local col9 decl" id="349ve" title='ve' data-type='struct val_env *' data-ref="349ve" data-ref-filename="349ve">ve</dfn>, </td></tr>
<tr><th id="220">220</th><td>	<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key" title='ub_packed_rrset_key' data-ref="ub_packed_rrset_key" data-ref-filename="ub_packed_rrset_key">ub_packed_rrset_key</a>* <dfn class="local col0 decl" id="350dnskey_rrset" title='dnskey_rrset' data-type='struct ub_packed_rrset_key *' data-ref="350dnskey_rrset" data-ref-filename="350dnskey_rrset">dnskey_rrset</dfn>, </td></tr>
<tr><th id="221">221</th><td>	<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key" title='ub_packed_rrset_key' data-ref="ub_packed_rrset_key" data-ref-filename="ub_packed_rrset_key">ub_packed_rrset_key</a>* <dfn class="local col1 decl" id="351ds_rrset" title='ds_rrset' data-type='struct ub_packed_rrset_key *' data-ref="351ds_rrset" data-ref-filename="351ds_rrset">ds_rrset</dfn>, <em>int</em> <dfn class="local col2 decl" id="352downprot" title='downprot' data-type='int' data-ref="352downprot" data-ref-filename="352downprot">downprot</dfn>, <em>char</em>** <dfn class="local col3 decl" id="353reason" title='reason' data-type='char **' data-ref="353reason" data-ref-filename="353reason">reason</dfn>,</td></tr>
<tr><th id="222">222</th><td>	<b>struct</b> <a class="type" href="../util/module.h.html#module_qstate" title='module_qstate' data-ref="module_qstate" data-ref-filename="module_qstate">module_qstate</a>* <dfn class="local col4 decl" id="354qstate" title='qstate' data-type='struct module_qstate *' data-ref="354qstate" data-ref-filename="354qstate">qstate</dfn>);</td></tr>
<tr><th id="223">223</th><td></td></tr>
<tr><th id="224">224</th><td></td></tr>
<tr><th id="225">225</th><td><i class="doc">/**</i></td></tr>
<tr><th id="226">226</th><td><i class="doc"> * Verify rrset with trust anchor: DS and DNSKEY rrset.</i></td></tr>
<tr><th id="227">227</th><td><i class="doc"> *</i></td></tr>
<tr><th id="228">228</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">region:</span> where to allocate key entry result.</i></td></tr>
<tr><th id="229">229</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">env:</span> module environment (scratch buffer)</i></td></tr>
<tr><th id="230">230</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">ve:</span> validator environment (verification settings)</i></td></tr>
<tr><th id="231">231</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">dnskey_rrset:</span> DNSKEY rrset to verify</i></td></tr>
<tr><th id="232">232</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">ta_ds_rrset:</span> DS rrset to verify with.</i></td></tr>
<tr><th id="233">233</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">ta_dnskey_rrset:</span> the DNSKEY rrset to verify with.</i></td></tr>
<tr><th id="234">234</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">downprot:</span> if true provide downgrade protection otherwise one</i></td></tr>
<tr><th id="235">235</th><td><i class="doc"> *   algorithm is enough.</i></td></tr>
<tr><th id="236">236</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">reason:</span> reason of failure. Fixed string or alloced in scratch.</i></td></tr>
<tr><th id="237">237</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">qstate:</span> qstate with region.</i></td></tr>
<tr><th id="238">238</th><td><i class="doc"> * <span class="command">@return</span> a KeyEntry. This will either contain the now trusted</i></td></tr>
<tr><th id="239">239</th><td><i class="doc"> *         dnskey_rrset, a "null" key entry indicating that this DS</i></td></tr>
<tr><th id="240">240</th><td><i class="doc"> *         rrset/DNSKEY pair indicate an secure end to the island of trust</i></td></tr>
<tr><th id="241">241</th><td><i class="doc"> *         (i.e., unknown algorithms), or a "bad" KeyEntry if the dnskey</i></td></tr>
<tr><th id="242">242</th><td><i class="doc"> *         rrset fails to verify. Note that the "null" response should</i></td></tr>
<tr><th id="243">243</th><td><i class="doc"> *         generally only occur in a private algorithm scenario: normally</i></td></tr>
<tr><th id="244">244</th><td><i class="doc"> *         this sort of thing is checked before fetching the matching DNSKEY</i></td></tr>
<tr><th id="245">245</th><td><i class="doc"> *         rrset.</i></td></tr>
<tr><th id="246">246</th><td><i class="doc"> *         if downprot is set, a key entry with an algo list is made.</i></td></tr>
<tr><th id="247">247</th><td><i class="doc"> */</i></td></tr>
<tr><th id="248">248</th><td><b>struct</b> <a class="type" href="val_kentry.h.html#key_entry_key" title='key_entry_key' data-ref="key_entry_key" data-ref-filename="key_entry_key">key_entry_key</a>* <dfn class="decl fn" id="val_verify_new_DNSKEYs_with_ta" title='val_verify_new_DNSKEYs_with_ta' data-ref="val_verify_new_DNSKEYs_with_ta" data-ref-filename="val_verify_new_DNSKEYs_with_ta">val_verify_new_DNSKEYs_with_ta</dfn>(<b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col5 decl" id="355region" title='region' data-type='struct regional *' data-ref="355region" data-ref-filename="355region">region</dfn>, </td></tr>
<tr><th id="249">249</th><td>	<b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col6 decl" id="356env" title='env' data-type='struct module_env *' data-ref="356env" data-ref-filename="356env">env</dfn>, <b>struct</b> <a class="type" href="#val_env" title='val_env' data-ref="val_env" data-ref-filename="val_env">val_env</a>* <dfn class="local col7 decl" id="357ve" title='ve' data-type='struct val_env *' data-ref="357ve" data-ref-filename="357ve">ve</dfn>, </td></tr>
<tr><th id="250">250</th><td>	<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key" title='ub_packed_rrset_key' data-ref="ub_packed_rrset_key" data-ref-filename="ub_packed_rrset_key">ub_packed_rrset_key</a>* <dfn class="local col8 decl" id="358dnskey_rrset" title='dnskey_rrset' data-type='struct ub_packed_rrset_key *' data-ref="358dnskey_rrset" data-ref-filename="358dnskey_rrset">dnskey_rrset</dfn>, </td></tr>
<tr><th id="251">251</th><td>	<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key" title='ub_packed_rrset_key' data-ref="ub_packed_rrset_key" data-ref-filename="ub_packed_rrset_key">ub_packed_rrset_key</a>* <dfn class="local col9 decl" id="359ta_ds_rrset" title='ta_ds_rrset' data-type='struct ub_packed_rrset_key *' data-ref="359ta_ds_rrset" data-ref-filename="359ta_ds_rrset">ta_ds_rrset</dfn>, </td></tr>
<tr><th id="252">252</th><td>	<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key" title='ub_packed_rrset_key' data-ref="ub_packed_rrset_key" data-ref-filename="ub_packed_rrset_key">ub_packed_rrset_key</a>* <dfn class="local col0 decl" id="360ta_dnskey_rrset" title='ta_dnskey_rrset' data-type='struct ub_packed_rrset_key *' data-ref="360ta_dnskey_rrset" data-ref-filename="360ta_dnskey_rrset">ta_dnskey_rrset</dfn>,</td></tr>
<tr><th id="253">253</th><td>	<em>int</em> <dfn class="local col1 decl" id="361downprot" title='downprot' data-type='int' data-ref="361downprot" data-ref-filename="361downprot">downprot</dfn>, <em>char</em>** <dfn class="local col2 decl" id="362reason" title='reason' data-type='char **' data-ref="362reason" data-ref-filename="362reason">reason</dfn>, <b>struct</b> <a class="type" href="../util/module.h.html#module_qstate" title='module_qstate' data-ref="module_qstate" data-ref-filename="module_qstate">module_qstate</a>* <dfn class="local col3 decl" id="363qstate" title='qstate' data-type='struct module_qstate *' data-ref="363qstate" data-ref-filename="363qstate">qstate</dfn>);</td></tr>
<tr><th id="254">254</th><td></td></tr>
<tr><th id="255">255</th><td><i class="doc">/**</i></td></tr>
<tr><th id="256">256</th><td><i class="doc"> * Determine if DS rrset is usable for validator or not.</i></td></tr>
<tr><th id="257">257</th><td><i class="doc"> * Returns true if the algorithms for key and DShash are supported,</i></td></tr>
<tr><th id="258">258</th><td><i class="doc"> * for at least one RR.</i></td></tr>
<tr><th id="259">259</th><td><i class="doc"> *</i></td></tr>
<tr><th id="260">260</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">ds_rrset:</span> the newly received DS rrset.</i></td></tr>
<tr><th id="261">261</th><td><i class="doc"> * <span class="command">@return</span> true or false if not usable.</i></td></tr>
<tr><th id="262">262</th><td><i class="doc"> */</i></td></tr>
<tr><th id="263">263</th><td><em>int</em> <dfn class="decl fn" id="val_dsset_isusable" title='val_dsset_isusable' data-ref="val_dsset_isusable" data-ref-filename="val_dsset_isusable">val_dsset_isusable</dfn>(<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key" title='ub_packed_rrset_key' data-ref="ub_packed_rrset_key" data-ref-filename="ub_packed_rrset_key">ub_packed_rrset_key</a>* <dfn class="local col4 decl" id="364ds_rrset" title='ds_rrset' data-type='struct ub_packed_rrset_key *' data-ref="364ds_rrset" data-ref-filename="364ds_rrset">ds_rrset</dfn>);</td></tr>
<tr><th id="264">264</th><td></td></tr>
<tr><th id="265">265</th><td><i class="doc">/**</i></td></tr>
<tr><th id="266">266</th><td><i class="doc"> * Determine by looking at a signed RRset whether or not the RRset name was</i></td></tr>
<tr><th id="267">267</th><td><i class="doc"> * the result of a wildcard expansion. If so, return the name of the</i></td></tr>
<tr><th id="268">268</th><td><i class="doc"> * generating wildcard.</i></td></tr>
<tr><th id="269">269</th><td><i class="doc"> * </i></td></tr>
<tr><th id="270">270</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">rrset</span> The rrset to check.</i></td></tr>
<tr><th id="271">271</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">wc:</span> the wildcard name, if the rrset was synthesized from a wildcard.</i></td></tr>
<tr><th id="272">272</th><td><i class="doc"> *         unchanged if not.  The wildcard name, without "*." in front, is </i></td></tr>
<tr><th id="273">273</th><td><i class="doc"> *         returned. This is a pointer into the rrset owner name.</i></td></tr>
<tr><th id="274">274</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">wc_len:</span> the length of the returned wildcard name.</i></td></tr>
<tr><th id="275">275</th><td><i class="doc"> * <span class="command">@return</span> false if the signatures are inconsistent in indicating the </i></td></tr>
<tr><th id="276">276</th><td><i class="doc"> * 	wildcard status; possible spoofing of wildcard response for other</i></td></tr>
<tr><th id="277">277</th><td><i class="doc"> * 	responses is being tried. We lost the status which rrsig was verified</i></td></tr>
<tr><th id="278">278</th><td><i class="doc"> * 	after the verification routine finished, so we simply check if</i></td></tr>
<tr><th id="279">279</th><td><i class="doc"> * 	the signatures are consistent; inserting a fake signature is a denial</i></td></tr>
<tr><th id="280">280</th><td><i class="doc"> * 	of service; but in that you could also have removed the real </i></td></tr>
<tr><th id="281">281</th><td><i class="doc"> * 	signature anyway.</i></td></tr>
<tr><th id="282">282</th><td><i class="doc"> */</i></td></tr>
<tr><th id="283">283</th><td><em>int</em> <dfn class="decl fn" id="val_rrset_wildcard" title='val_rrset_wildcard' data-ref="val_rrset_wildcard" data-ref-filename="val_rrset_wildcard">val_rrset_wildcard</dfn>(<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key" title='ub_packed_rrset_key' data-ref="ub_packed_rrset_key" data-ref-filename="ub_packed_rrset_key">ub_packed_rrset_key</a>* <dfn class="local col5 decl" id="365rrset" title='rrset' data-type='struct ub_packed_rrset_key *' data-ref="365rrset" data-ref-filename="365rrset">rrset</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>** <dfn class="local col6 decl" id="366wc" title='wc' data-type='uint8_t **' data-ref="366wc" data-ref-filename="366wc">wc</dfn>,</td></tr>
<tr><th id="284">284</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>* <dfn class="local col7 decl" id="367wc_len" title='wc_len' data-type='size_t *' data-ref="367wc_len" data-ref-filename="367wc_len">wc_len</dfn>);</td></tr>
<tr><th id="285">285</th><td></td></tr>
<tr><th id="286">286</th><td><i class="doc">/**</i></td></tr>
<tr><th id="287">287</th><td><i class="doc"> * Chase the cname to the next query name.</i></td></tr>
<tr><th id="288">288</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">qchase:</span> the current query name, updated to next target.</i></td></tr>
<tr><th id="289">289</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">rep:</span> original message reply to look at CNAMEs.</i></td></tr>
<tr><th id="290">290</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">cname_skip:</span> the skip into the answer section. Updated to skip</i></td></tr>
<tr><th id="291">291</th><td><i class="doc"> * 	DNAME and CNAME to the next part of the answer.</i></td></tr>
<tr><th id="292">292</th><td><i class="doc"> * <span class="command">@return</span> false on error (bad rdata).</i></td></tr>
<tr><th id="293">293</th><td><i class="doc"> */</i></td></tr>
<tr><th id="294">294</th><td><em>int</em> <dfn class="decl fn" id="val_chase_cname" title='val_chase_cname' data-ref="val_chase_cname" data-ref-filename="val_chase_cname">val_chase_cname</dfn>(<b>struct</b> <a class="type" href="../util/data/msgreply.h.html#query_info" title='query_info' data-ref="query_info" data-ref-filename="query_info">query_info</a>* <dfn class="local col8 decl" id="368qchase" title='qchase' data-type='struct query_info *' data-ref="368qchase" data-ref-filename="368qchase">qchase</dfn>, <b>struct</b> <a class="type" href="../util/data/msgreply.h.html#reply_info" title='reply_info' data-ref="reply_info" data-ref-filename="reply_info">reply_info</a>* <dfn class="local col9 decl" id="369rep" title='rep' data-type='struct reply_info *' data-ref="369rep" data-ref-filename="369rep">rep</dfn>,</td></tr>
<tr><th id="295">295</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>* <dfn class="local col0 decl" id="370cname_skip" title='cname_skip' data-type='size_t *' data-ref="370cname_skip" data-ref-filename="370cname_skip">cname_skip</dfn>);</td></tr>
<tr><th id="296">296</th><td></td></tr>
<tr><th id="297">297</th><td><i class="doc">/**</i></td></tr>
<tr><th id="298">298</th><td><i class="doc"> * Fill up the chased reply with the content from the original reply;</i></td></tr>
<tr><th id="299">299</th><td><i class="doc"> * as pointers to those rrsets. Select the part after the cname_skip into</i></td></tr>
<tr><th id="300">300</th><td><i class="doc"> * the answer section, NS and AR sections that are signed with same signer.</i></td></tr>
<tr><th id="301">301</th><td><i class="doc"> *</i></td></tr>
<tr><th id="302">302</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">chase:</span> chased reply, filled up.</i></td></tr>
<tr><th id="303">303</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">orig:</span> original reply.</i></td></tr>
<tr><th id="304">304</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">cname_skip:</span> which part of the answer section to skip.</i></td></tr>
<tr><th id="305">305</th><td><i class="doc"> * 	The skipped part contains CNAME(and DNAME)s that have been chased.</i></td></tr>
<tr><th id="306">306</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">name:</span> the signer name to look for.</i></td></tr>
<tr><th id="307">307</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">len:</span> length of name.</i></td></tr>
<tr><th id="308">308</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">signer:</span> signer name or NULL if an unsigned RRset is considered.</i></td></tr>
<tr><th id="309">309</th><td><i class="doc"> *	If NULL, rrsets with the lookup name are copied over.</i></td></tr>
<tr><th id="310">310</th><td><i class="doc"> */</i></td></tr>
<tr><th id="311">311</th><td><em>void</em> <dfn class="decl fn" id="val_fill_reply" title='val_fill_reply' data-ref="val_fill_reply" data-ref-filename="val_fill_reply">val_fill_reply</dfn>(<b>struct</b> <a class="type" href="../util/data/msgreply.h.html#reply_info" title='reply_info' data-ref="reply_info" data-ref-filename="reply_info">reply_info</a>* <dfn class="local col1 decl" id="371chase" title='chase' data-type='struct reply_info *' data-ref="371chase" data-ref-filename="371chase">chase</dfn>, <b>struct</b> <a class="type" href="../util/data/msgreply.h.html#reply_info" title='reply_info' data-ref="reply_info" data-ref-filename="reply_info">reply_info</a>* <dfn class="local col2 decl" id="372orig" title='orig' data-type='struct reply_info *' data-ref="372orig" data-ref-filename="372orig">orig</dfn>, </td></tr>
<tr><th id="312">312</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col3 decl" id="373cname_skip" title='cname_skip' data-type='size_t' data-ref="373cname_skip" data-ref-filename="373cname_skip">cname_skip</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col4 decl" id="374name" title='name' data-type='uint8_t *' data-ref="374name" data-ref-filename="374name">name</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col5 decl" id="375len" title='len' data-type='size_t' data-ref="375len" data-ref-filename="375len">len</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col6 decl" id="376signer" title='signer' data-type='uint8_t *' data-ref="376signer" data-ref-filename="376signer">signer</dfn>);</td></tr>
<tr><th id="313">313</th><td></td></tr>
<tr><th id="314">314</th><td><i class="doc">/**</i></td></tr>
<tr><th id="315">315</th><td><i class="doc"> * Remove rrset with index from reply, from the authority section.</i></td></tr>
<tr><th id="316">316</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">rep:</span> reply to remove it from.</i></td></tr>
<tr><th id="317">317</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">index:</span> rrset to remove, must be in the authority section.</i></td></tr>
<tr><th id="318">318</th><td><i class="doc"> */</i></td></tr>
<tr><th id="319">319</th><td><em>void</em> <dfn class="decl fn" id="val_reply_remove_auth" title='val_reply_remove_auth' data-ref="val_reply_remove_auth" data-ref-filename="val_reply_remove_auth">val_reply_remove_auth</dfn>(<b>struct</b> <a class="type" href="../util/data/msgreply.h.html#reply_info" title='reply_info' data-ref="reply_info" data-ref-filename="reply_info">reply_info</a>* <dfn class="local col7 decl" id="377rep" title='rep' data-type='struct reply_info *' data-ref="377rep" data-ref-filename="377rep">rep</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col8 decl" id="378index" title='index' data-type='size_t' data-ref="378index" data-ref-filename="378index">index</dfn>);</td></tr>
<tr><th id="320">320</th><td></td></tr>
<tr><th id="321">321</th><td><i class="doc">/**</i></td></tr>
<tr><th id="322">322</th><td><i class="doc"> * Remove all unsigned or non-secure status rrsets from NS and AR sections.</i></td></tr>
<tr><th id="323">323</th><td><i class="doc"> * So that unsigned data does not get let through to clients, when we have</i></td></tr>
<tr><th id="324">324</th><td><i class="doc"> * found the data to be secure.</i></td></tr>
<tr><th id="325">325</th><td><i class="doc"> *</i></td></tr>
<tr><th id="326">326</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">env:</span> environment with cleaning options.</i></td></tr>
<tr><th id="327">327</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">rep:</span> reply to dump all nonsecure stuff out of.</i></td></tr>
<tr><th id="328">328</th><td><i class="doc"> */</i></td></tr>
<tr><th id="329">329</th><td><em>void</em> <dfn class="decl fn" id="val_check_nonsecure" title='val_check_nonsecure' data-ref="val_check_nonsecure" data-ref-filename="val_check_nonsecure">val_check_nonsecure</dfn>(<b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col9 decl" id="379env" title='env' data-type='struct module_env *' data-ref="379env" data-ref-filename="379env">env</dfn>, <b>struct</b> <a class="type" href="../util/data/msgreply.h.html#reply_info" title='reply_info' data-ref="reply_info" data-ref-filename="reply_info">reply_info</a>* <dfn class="local col0 decl" id="380rep" title='rep' data-type='struct reply_info *' data-ref="380rep" data-ref-filename="380rep">rep</dfn>);</td></tr>
<tr><th id="330">330</th><td></td></tr>
<tr><th id="331">331</th><td><i class="doc">/**</i></td></tr>
<tr><th id="332">332</th><td><i class="doc"> * Mark all unchecked rrset entries not below a trust anchor as indeterminate.</i></td></tr>
<tr><th id="333">333</th><td><i class="doc"> * Only security==unchecked rrsets are updated.</i></td></tr>
<tr><th id="334">334</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">rep:</span> the reply with rrsets.</i></td></tr>
<tr><th id="335">335</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">anchors:</span> the trust anchors.</i></td></tr>
<tr><th id="336">336</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">r:</span> rrset cache to store updated security status into.</i></td></tr>
<tr><th id="337">337</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">env:</span> module environment</i></td></tr>
<tr><th id="338">338</th><td><i class="doc"> */</i></td></tr>
<tr><th id="339">339</th><td><em>void</em> <dfn class="decl fn" id="val_mark_indeterminate" title='val_mark_indeterminate' data-ref="val_mark_indeterminate" data-ref-filename="val_mark_indeterminate">val_mark_indeterminate</dfn>(<b>struct</b> <a class="type" href="../util/data/msgreply.h.html#reply_info" title='reply_info' data-ref="reply_info" data-ref-filename="reply_info">reply_info</a>* <dfn class="local col1 decl" id="381rep" title='rep' data-type='struct reply_info *' data-ref="381rep" data-ref-filename="381rep">rep</dfn>, </td></tr>
<tr><th id="340">340</th><td>	<b>struct</b> <a class="type" href="val_anchor.h.html#val_anchors" title='val_anchors' data-ref="val_anchors" data-ref-filename="val_anchors">val_anchors</a>* <dfn class="local col2 decl" id="382anchors" title='anchors' data-type='struct val_anchors *' data-ref="382anchors" data-ref-filename="382anchors">anchors</dfn>, <b>struct</b> <a class="type" href="../services/cache/rrset.h.html#rrset_cache" title='rrset_cache' data-ref="rrset_cache" data-ref-filename="rrset_cache">rrset_cache</a>* <dfn class="local col3 decl" id="383r" title='r' data-type='struct rrset_cache *' data-ref="383r" data-ref-filename="383r">r</dfn>, </td></tr>
<tr><th id="341">341</th><td>	<b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col4 decl" id="384env" title='env' data-type='struct module_env *' data-ref="384env" data-ref-filename="384env">env</dfn>);</td></tr>
<tr><th id="342">342</th><td></td></tr>
<tr><th id="343">343</th><td><i class="doc">/**</i></td></tr>
<tr><th id="344">344</th><td><i class="doc"> * Mark all unchecked rrset entries below a NULL key entry as insecure.</i></td></tr>
<tr><th id="345">345</th><td><i class="doc"> * Only security==unchecked rrsets are updated.</i></td></tr>
<tr><th id="346">346</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">rep:</span> the reply with rrsets.</i></td></tr>
<tr><th id="347">347</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">kname:</span> end of secure space name.</i></td></tr>
<tr><th id="348">348</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">r:</span> rrset cache to store updated security status into.</i></td></tr>
<tr><th id="349">349</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">env:</span> module environment</i></td></tr>
<tr><th id="350">350</th><td><i class="doc"> */</i></td></tr>
<tr><th id="351">351</th><td><em>void</em> <dfn class="decl fn" id="val_mark_insecure" title='val_mark_insecure' data-ref="val_mark_insecure" data-ref-filename="val_mark_insecure">val_mark_insecure</dfn>(<b>struct</b> <a class="type" href="../util/data/msgreply.h.html#reply_info" title='reply_info' data-ref="reply_info" data-ref-filename="reply_info">reply_info</a>* <dfn class="local col5 decl" id="385rep" title='rep' data-type='struct reply_info *' data-ref="385rep" data-ref-filename="385rep">rep</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col6 decl" id="386kname" title='kname' data-type='uint8_t *' data-ref="386kname" data-ref-filename="386kname">kname</dfn>,</td></tr>
<tr><th id="352">352</th><td>	<b>struct</b> <a class="type" href="../services/cache/rrset.h.html#rrset_cache" title='rrset_cache' data-ref="rrset_cache" data-ref-filename="rrset_cache">rrset_cache</a>* <dfn class="local col7 decl" id="387r" title='r' data-type='struct rrset_cache *' data-ref="387r" data-ref-filename="387r">r</dfn>, <b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col8 decl" id="388env" title='env' data-type='struct module_env *' data-ref="388env" data-ref-filename="388env">env</dfn>);</td></tr>
<tr><th id="353">353</th><td></td></tr>
<tr><th id="354">354</th><td><i class="doc">/**</i></td></tr>
<tr><th id="355">355</th><td><i class="doc"> * Find next unchecked rrset position, return it for skip.</i></td></tr>
<tr><th id="356">356</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">rep:</span> the original reply to look into.</i></td></tr>
<tr><th id="357">357</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">skip:</span> the skip now.</i></td></tr>
<tr><th id="358">358</th><td><i class="doc"> * <span class="command">@return</span> new skip, which may be at the rep-&gt;rrset_count position to signal</i></td></tr>
<tr><th id="359">359</th><td><i class="doc"> * 	there are no unchecked items.</i></td></tr>
<tr><th id="360">360</th><td><i class="doc"> */</i></td></tr>
<tr><th id="361">361</th><td><a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="decl fn" id="val_next_unchecked" title='val_next_unchecked' data-ref="val_next_unchecked" data-ref-filename="val_next_unchecked">val_next_unchecked</dfn>(<b>struct</b> <a class="type" href="../util/data/msgreply.h.html#reply_info" title='reply_info' data-ref="reply_info" data-ref-filename="reply_info">reply_info</a>* <dfn class="local col9 decl" id="389rep" title='rep' data-type='struct reply_info *' data-ref="389rep" data-ref-filename="389rep">rep</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col0 decl" id="390skip" title='skip' data-type='size_t' data-ref="390skip" data-ref-filename="390skip">skip</dfn>);</td></tr>
<tr><th id="362">362</th><td></td></tr>
<tr><th id="363">363</th><td><i class="doc">/**</i></td></tr>
<tr><th id="364">364</th><td><i class="doc"> * Find the signer name for an RRset.</i></td></tr>
<tr><th id="365">365</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">rrset:</span> the rrset.</i></td></tr>
<tr><th id="366">366</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">sname:</span> signer name is returned or NULL if not signed.</i></td></tr>
<tr><th id="367">367</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">slen:</span> length of sname (or 0).</i></td></tr>
<tr><th id="368">368</th><td><i class="doc"> */</i></td></tr>
<tr><th id="369">369</th><td><em>void</em> <dfn class="decl fn" id="val_find_rrset_signer" title='val_find_rrset_signer' data-ref="val_find_rrset_signer" data-ref-filename="val_find_rrset_signer">val_find_rrset_signer</dfn>(<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key" title='ub_packed_rrset_key' data-ref="ub_packed_rrset_key" data-ref-filename="ub_packed_rrset_key">ub_packed_rrset_key</a>* <dfn class="local col1 decl" id="391rrset" title='rrset' data-type='struct ub_packed_rrset_key *' data-ref="391rrset" data-ref-filename="391rrset">rrset</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>** <dfn class="local col2 decl" id="392sname" title='sname' data-type='uint8_t **' data-ref="392sname" data-ref-filename="392sname">sname</dfn>,</td></tr>
<tr><th id="370">370</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a>* <dfn class="local col3 decl" id="393slen" title='slen' data-type='size_t *' data-ref="393slen" data-ref-filename="393slen">slen</dfn>);</td></tr>
<tr><th id="371">371</th><td></td></tr>
<tr><th id="372">372</th><td><i class="doc">/**</i></td></tr>
<tr><th id="373">373</th><td><i class="doc"> * Get string to denote the classification result.</i></td></tr>
<tr><th id="374">374</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">subtype:</span> from classification function.</i></td></tr>
<tr><th id="375">375</th><td><i class="doc"> * <span class="command">@return</span> static string to describe the classification.</i></td></tr>
<tr><th id="376">376</th><td><i class="doc"> */</i></td></tr>
<tr><th id="377">377</th><td><em>const</em> <em>char</em>* <dfn class="decl fn" id="val_classification_to_string" title='val_classification_to_string' data-ref="val_classification_to_string" data-ref-filename="val_classification_to_string">val_classification_to_string</dfn>(<b>enum</b> <a class="type" href="#val_classification" title='val_classification' data-ref="val_classification" data-ref-filename="val_classification">val_classification</a> <dfn class="local col4 decl" id="394subtype" title='subtype' data-type='enum val_classification' data-ref="394subtype" data-ref-filename="394subtype">subtype</dfn>);</td></tr>
<tr><th id="378">378</th><td></td></tr>
<tr><th id="379">379</th><td><i class="doc">/**</i></td></tr>
<tr><th id="380">380</th><td><i class="doc"> * Add existing list to blacklist.</i></td></tr>
<tr><th id="381">381</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">blacklist:</span> the blacklist with result</i></td></tr>
<tr><th id="382">382</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">region:</span> the region where blacklist is allocated.</i></td></tr>
<tr><th id="383">383</th><td><i class="doc"> *	Allocation failures are logged.</i></td></tr>
<tr><th id="384">384</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">origin:</span> origin list to add, if NULL, a cache-entry is added to</i></td></tr>
<tr><th id="385">385</th><td><i class="doc"> *   the blacklist to stop cache from being used.</i></td></tr>
<tr><th id="386">386</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">cross:</span> if true this is a cross-qstate copy, and the 'origin'</i></td></tr>
<tr><th id="387">387</th><td><i class="doc"> *   list is not allocated in the same region as the blacklist.</i></td></tr>
<tr><th id="388">388</th><td><i class="doc"> */</i></td></tr>
<tr><th id="389">389</th><td><em>void</em> <dfn class="decl fn" id="val_blacklist" title='val_blacklist' data-ref="val_blacklist" data-ref-filename="val_blacklist">val_blacklist</dfn>(<b>struct</b> <a class="type" href="../util/module.h.html#sock_list" title='sock_list' data-ref="sock_list" data-ref-filename="sock_list">sock_list</a>** <dfn class="local col5 decl" id="395blacklist" title='blacklist' data-type='struct sock_list **' data-ref="395blacklist" data-ref-filename="395blacklist">blacklist</dfn>, <b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col6 decl" id="396region" title='region' data-type='struct regional *' data-ref="396region" data-ref-filename="396region">region</dfn>,</td></tr>
<tr><th id="390">390</th><td>	<b>struct</b> <a class="type" href="../util/module.h.html#sock_list" title='sock_list' data-ref="sock_list" data-ref-filename="sock_list">sock_list</a>* <dfn class="local col7 decl" id="397origin" title='origin' data-type='struct sock_list *' data-ref="397origin" data-ref-filename="397origin">origin</dfn>, <em>int</em> <dfn class="local col8 decl" id="398cross" title='cross' data-type='int' data-ref="398cross" data-ref-filename="398cross">cross</dfn>);</td></tr>
<tr><th id="391">391</th><td></td></tr>
<tr><th id="392">392</th><td><i class="doc">/**</i></td></tr>
<tr><th id="393">393</th><td><i class="doc"> * check if has dnssec info, and if it has signed nsecs. gives error reason.</i></td></tr>
<tr><th id="394">394</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">rep:</span> reply to check.</i></td></tr>
<tr><th id="395">395</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">reason:</span> returned on fail.</i></td></tr>
<tr><th id="396">396</th><td><i class="doc"> * <span class="command">@return</span> false if message has no signed nsecs.  Can not prove negatives.</i></td></tr>
<tr><th id="397">397</th><td><i class="doc"> */</i></td></tr>
<tr><th id="398">398</th><td><em>int</em> <dfn class="decl fn" id="val_has_signed_nsecs" title='val_has_signed_nsecs' data-ref="val_has_signed_nsecs" data-ref-filename="val_has_signed_nsecs">val_has_signed_nsecs</dfn>(<b>struct</b> <a class="type" href="../util/data/msgreply.h.html#reply_info" title='reply_info' data-ref="reply_info" data-ref-filename="reply_info">reply_info</a>* <dfn class="local col9 decl" id="399rep" title='rep' data-type='struct reply_info *' data-ref="399rep" data-ref-filename="399rep">rep</dfn>, <em>char</em>** <dfn class="local col0 decl" id="400reason" title='reason' data-type='char **' data-ref="400reason" data-ref-filename="400reason">reason</dfn>);</td></tr>
<tr><th id="399">399</th><td></td></tr>
<tr><th id="400">400</th><td><i class="doc">/**</i></td></tr>
<tr><th id="401">401</th><td><i class="doc"> * Return algo number for favorite (best) algorithm that we support in DS.</i></td></tr>
<tr><th id="402">402</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">ds_rrset:</span> the DSes in this rrset are inspected and best algo chosen.</i></td></tr>
<tr><th id="403">403</th><td><i class="doc"> * <span class="command">@return</span> algo number or 0 if none supported. 0 is unused as algo number.</i></td></tr>
<tr><th id="404">404</th><td><i class="doc"> */</i></td></tr>
<tr><th id="405">405</th><td><em>int</em> <dfn class="decl fn" id="val_favorite_ds_algo" title='val_favorite_ds_algo' data-ref="val_favorite_ds_algo" data-ref-filename="val_favorite_ds_algo">val_favorite_ds_algo</dfn>(<b>struct</b> <a class="type" href="../util/data/packed_rrset.h.html#ub_packed_rrset_key" title='ub_packed_rrset_key' data-ref="ub_packed_rrset_key" data-ref-filename="ub_packed_rrset_key">ub_packed_rrset_key</a>* <dfn class="local col1 decl" id="401ds_rrset" title='ds_rrset' data-type='struct ub_packed_rrset_key *' data-ref="401ds_rrset" data-ref-filename="401ds_rrset">ds_rrset</dfn>);</td></tr>
<tr><th id="406">406</th><td></td></tr>
<tr><th id="407">407</th><td><i class="doc">/**</i></td></tr>
<tr><th id="408">408</th><td><i class="doc"> * Find DS denial message in cache.  Saves new qstate allocation and allows</i></td></tr>
<tr><th id="409">409</th><td><i class="doc"> * the validator to use partial content which is not enough to construct a</i></td></tr>
<tr><th id="410">410</th><td><i class="doc"> * message for network (or user) consumption.  Without SOA for example,</i></td></tr>
<tr><th id="411">411</th><td><i class="doc"> * which is a common occurrence in the unbound code since the referrals contain</i></td></tr>
<tr><th id="412">412</th><td><i class="doc"> * NSEC/NSEC3 rrs without the SOA element, thus do not allow synthesis of a</i></td></tr>
<tr><th id="413">413</th><td><i class="doc"> * full negative reply, but do allow synthesis of sufficient proof.</i></td></tr>
<tr><th id="414">414</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">env:</span> query env with caches and time.</i></td></tr>
<tr><th id="415">415</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">nm:</span> name of DS record sought.</i></td></tr>
<tr><th id="416">416</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">nmlen:</span> length of name.</i></td></tr>
<tr><th id="417">417</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">c:</span> class of DS RR.</i></td></tr>
<tr><th id="418">418</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">region:</span> where to allocate result.</i></td></tr>
<tr><th id="419">419</th><td><i class="doc"> * <span class="command">@param</span> <span class="arg">topname:</span> name of the key that is currently in use, that will get</i></td></tr>
<tr><th id="420">420</th><td><i class="doc"> *	used to validate the result, and thus no higher entries from the</i></td></tr>
<tr><th id="421">421</th><td><i class="doc"> *	negative cache need to be examined.</i></td></tr>
<tr><th id="422">422</th><td><i class="doc"> * <span class="command">@return</span> a dns_msg on success. NULL on failure.</i></td></tr>
<tr><th id="423">423</th><td><i class="doc"> */</i></td></tr>
<tr><th id="424">424</th><td><b>struct</b> <a class="type" href="../services/cache/dns.h.html#dns_msg" title='dns_msg' data-ref="dns_msg" data-ref-filename="dns_msg">dns_msg</a>* <dfn class="decl fn" id="val_find_DS" title='val_find_DS' data-ref="val_find_DS" data-ref-filename="val_find_DS">val_find_DS</dfn>(<b>struct</b> <a class="type" href="../util/module.h.html#module_env" title='module_env' data-ref="module_env" data-ref-filename="module_env">module_env</a>* <dfn class="local col2 decl" id="402env" title='env' data-type='struct module_env *' data-ref="402env" data-ref-filename="402env">env</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col3 decl" id="403nm" title='nm' data-type='uint8_t *' data-ref="403nm" data-ref-filename="403nm">nm</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#size_t" title='size_t' data-type='unsigned int' data-ref="size_t" data-ref-filename="size_t">size_t</a> <dfn class="local col4 decl" id="404nmlen" title='nmlen' data-type='size_t' data-ref="404nmlen" data-ref-filename="404nmlen">nmlen</dfn>,</td></tr>
<tr><th id="425">425</th><td>	<a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> <dfn class="local col5 decl" id="405c" title='c' data-type='uint16_t' data-ref="405c" data-ref-filename="405c">c</dfn>, <b>struct</b> <a class="type" href="../util/regional.h.html#regional" title='regional' data-ref="regional" data-ref-filename="regional">regional</a>* <dfn class="local col6 decl" id="406region" title='region' data-type='struct regional *' data-ref="406region" data-ref-filename="406region">region</dfn>, <a class="typedef" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a>* <dfn class="local col7 decl" id="407topname" title='topname' data-type='uint8_t *' data-ref="407topname" data-ref-filename="407topname">topname</dfn>);</td></tr>
<tr><th id="426">426</th><td></td></tr>
<tr><th id="427">427</th><td><u>#<span data-ppcond="42">endif</span> /* VALIDATOR_VAL_UTILS_H */</u></td></tr>
<tr><th id="428">428</th><td></td></tr>
</table><hr/><p id='footer'>
Generated while processing <a href='../iterator/iter_utils.c.html'>netbsd/external/bsd/unbound/dist/iterator/iter_utils.c</a><br/>Generated on <em>2019-Jul-19</em> from project netbsd revision <em>f9da89e0d</em><br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 2.1
<br/>Generator usage only permitted with license.</p>
</div></body></html>
