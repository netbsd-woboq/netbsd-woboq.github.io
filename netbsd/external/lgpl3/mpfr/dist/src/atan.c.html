<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>atan.c source code [netbsd/external/lgpl3/mpfr/dist/src/atan.c] - Woboq Code Browser</title>
<link rel="stylesheet" href="https://code.woboq.org/data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="https://code.woboq.org/data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="https://code.woboq.org/data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="https://code.woboq.org/data/jquery/jquery-ui.min.js"></script>
<script>var file = 'netbsd/external/lgpl3/mpfr/dist/src/atan.c'; var root_path = '../../../../../..'; var data_path = 'https://code.woboq.org/data'; var ecma_script_api_version = 2;</script>
<script src='https://code.woboq.org/data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='../../../../..'>netbsd</a>/<a href='../../../..'>external</a>/<a href='../../..'>lgpl3</a>/<a href='../..'>mpfr</a>/<a href='..'>dist</a>/<a href='./'>src</a>/<a href='atan.c.html'>atan.c</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>/* mpfr_atan -- arc-tangent of a floating-point number</i></td></tr>
<tr><th id="2">2</th><td><i></i></td></tr>
<tr><th id="3">3</th><td><i>Copyright 2001-2018 Free Software Foundation, Inc.</i></td></tr>
<tr><th id="4">4</th><td><i>Contributed by the AriC and Caramba projects, INRIA.</i></td></tr>
<tr><th id="5">5</th><td><i></i></td></tr>
<tr><th id="6">6</th><td><i>This file is part of the GNU MPFR Library.</i></td></tr>
<tr><th id="7">7</th><td><i></i></td></tr>
<tr><th id="8">8</th><td><i>The GNU MPFR Library is free software; you can redistribute it and/or modify</i></td></tr>
<tr><th id="9">9</th><td><i>it under the terms of the GNU Lesser General Public License as published by</i></td></tr>
<tr><th id="10">10</th><td><i>the Free Software Foundation; either version 3 of the License, or (at your</i></td></tr>
<tr><th id="11">11</th><td><i>option) any later version.</i></td></tr>
<tr><th id="12">12</th><td><i></i></td></tr>
<tr><th id="13">13</th><td><i>The GNU MPFR Library is distributed in the hope that it will be useful, but</i></td></tr>
<tr><th id="14">14</th><td><i>WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY</i></td></tr>
<tr><th id="15">15</th><td><i>or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public</i></td></tr>
<tr><th id="16">16</th><td><i>License for more details.</i></td></tr>
<tr><th id="17">17</th><td><i></i></td></tr>
<tr><th id="18">18</th><td><i>You should have received a copy of the GNU Lesser General Public License</i></td></tr>
<tr><th id="19">19</th><td><i>along with the GNU MPFR Library; see the file COPYING.LESSER.  If not, see</i></td></tr>
<tr><th id="20">20</th><td><i>http://www.gnu.org/licenses/ or write to the Free Software Foundation, Inc.,</i></td></tr>
<tr><th id="21">21</th><td><i>51 Franklin St, Fifth Floor, Boston, MA 02110-1301, USA. */</i></td></tr>
<tr><th id="22">22</th><td></td></tr>
<tr><th id="23">23</th><td><u>#define <dfn class="macro" id="_M/MPFR_NEED_LONGLONG_H" data-ref="_M/MPFR_NEED_LONGLONG_H">MPFR_NEED_LONGLONG_H</dfn></u></td></tr>
<tr><th id="24">24</th><td><u>#include <a href="mpfr-impl.h.html">"mpfr-impl.h"</a></u></td></tr>
<tr><th id="25">25</th><td></td></tr>
<tr><th id="26">26</th><td><u>#<span data-ppcond="26">if</span> <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#46" title="(64 - 0)" data-ref="_M/GMP_NUMB_BITS">GMP_NUMB_BITS</a> == 64</u></td></tr>
<tr><th id="27">27</th><td><i  data-doc="atan_table">/* for each pair (r,p), we store a 192-bit approximation of atan(x)/x for</i></td></tr>
<tr><th id="28">28</th><td><i  data-doc="atan_table">   x=p/2^r, with lowest limb first.</i></td></tr>
<tr><th id="29">29</th><td><i  data-doc="atan_table">   Sage code:</i></td></tr>
<tr><th id="30">30</th><td><i  data-doc="atan_table">   for p in range(1,2^ceil(r/2)):</i></td></tr>
<tr><th id="31">31</th><td><i  data-doc="atan_table">      x=p/2^r</i></td></tr>
<tr><th id="32">32</th><td><i  data-doc="atan_table">      l=floor(2^192*n(atan(x)/x, 300)).digits(2^64)</i></td></tr>
<tr><th id="33">33</th><td><i  data-doc="atan_table">      print ("{0x%x, 0x%x, 0x%x}, /"+"* (%d,%d) *"+"/") % (l[0],l[1],l[2],r,p)</i></td></tr>
<tr><th id="34">34</th><td><i  data-doc="atan_table">*/</i></td></tr>
<tr><th id="35">35</th><td><em>static</em> <em>const</em> <a class="typedef" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#mp_limb_t" title='mp_limb_t' data-type='unsigned long' data-ref="mp_limb_t" data-ref-filename="mp_limb_t">mp_limb_t</a> <dfn class="tu decl def" id="atan_table" title='atan_table' data-type='const mp_limb_t [20][3]' data-ref="atan_table" data-ref-filename="atan_table">atan_table</dfn>[][<var>3</var>] = {</td></tr>
<tr><th id="36">36</th><td>    {<var>0x6e141587261cdf00</var>, <var>0x6fe445ecbc3a8d03</var>, <var>0xed63382b0dda7b45</var>}, <i>/* (1,1) */</i></td></tr>
<tr><th id="37">37</th><td>    {<var>0xaa7fa90388b3836b</var>, <var>0x6dc79ef5f7a217e5</var>, <var>0xfadbafc96406eb15</var>}, <i>/* (2,1) */</i></td></tr>
<tr><th id="38">38</th><td>    {<var>0x319c12cf59d4b2dc</var>, <var>0xcb2792dc0e2e0d51</var>, <var>0xffaaddb967ef4e36</var>}, <i>/* (4,1) */</i></td></tr>
<tr><th id="39">39</th><td>    {<var>0x8b3957d95d9ad922</var>, <var>0xc897989f3e888ef7</var>, <var>0xfeadd4d5617b6e32</var>}, <i>/* (4,2) */</i></td></tr>
<tr><th id="40">40</th><td>    {<var>0xc4e6abc8af62e439</var>, <var>0x4eb9bf602625f0b4</var>, <var>0xfd0fcdd343cac19b</var>}, <i>/* (4,3) */</i></td></tr>
<tr><th id="41">41</th><td>    {<var>0x7c18baeb9bc95789</var>, <var>0xb12afb6b6d4f7e16</var>, <var>0xffffaaaaddddb94b</var>}, <i>/* (8,1) */</i></td></tr>
<tr><th id="42">42</th><td>    {<var>0x6856a0171a2f001a</var>, <var>0x62351fbbe60af47</var>,  <var>0xfffeaaadddd4b968</var>}, <i>/* (8,2) */</i></td></tr>
<tr><th id="43">43</th><td>    {<var>0x69164c094f49da06</var>, <var>0xd517294f7373d07a</var>, <var>0xfffd001032cb1179</var>}, <i>/* (8,3) */</i></td></tr>
<tr><th id="44">44</th><td>    {<var>0x20ef65c10deef460</var>, <var>0xe78c564015f76048</var>, <var>0xfffaaadddb94d5bb</var>}, <i>/* (8,4) */</i></td></tr>
<tr><th id="45">45</th><td>    {<var>0x3ce233aa002f0344</var>, <var>0x9dd8ea342a65d4cc</var>, <var>0xfff7ab27a1f32f95</var>}, <i>/* (8,5) */</i></td></tr>
<tr><th id="46">46</th><td>    {<var>0xa37f403c7279c5cb</var>, <var>0x13ab53a1c8db8497</var>, <var>0xfff40103192ce74d</var>}, <i>/* (8,6) */</i></td></tr>
<tr><th id="47">47</th><td>    {<var>0xe5a85657103c1aa8</var>, <var>0xb8409e6c914191d3</var>, <var>0xffefac8a9c40a26b</var>}, <i>/* (8,7) */</i></td></tr>
<tr><th id="48">48</th><td>    {<var>0x806d0294c0db8816</var>, <var>0x779d776dda8c6213</var>, <var>0xffeaaddd4bb12542</var>}, <i>/* (8,8) */</i></td></tr>
<tr><th id="49">49</th><td>    {<var>0x5545d1914ef21478</var>, <var>0x3aea58d6660f5a12</var>, <var>0xffe5051f0aebf73a</var>}, <i>/* (8,9) */</i></td></tr>
<tr><th id="50">50</th><td>    {<var>0x6e47a91d015f4133</var>, <var>0xc085ab6b490b7f02</var>, <var>0xffdeb2787d4adac1</var>}, <i>/* (8,10) */</i></td></tr>
<tr><th id="51">51</th><td>    {<var>0x4efc1f931f7ec9b3</var>, <var>0xb7f43cd16195ef4b</var>, <var>0xffd7b61702b09aad</var>}, <i>/* (8,11) */</i></td></tr>
<tr><th id="52">52</th><td>    {<var>0xd27d1dbf55fed60d</var>, <var>0xd812c11d7d473e5e</var>, <var>0xffd0102cb3c1bfbe</var>}, <i>/* (8,12) */</i></td></tr>
<tr><th id="53">53</th><td>    {<var>0xca629e927383fe97</var>, <var>0x8c61aedf58e42206</var>, <var>0xffc7c0f05db9d1b6</var>}, <i>/* (8,13) */</i></td></tr>
<tr><th id="54">54</th><td>    {<var>0x4eff0b53d4e905b7</var>, <var>0x28ac1e800ca31e9d</var>, <var>0xffbec89d7dddd7e9</var>}, <i>/* (8,14) */</i></td></tr>
<tr><th id="55">55</th><td>    {<var>0xb0a7931deec6fe60</var>, <var>0xb46feea78588554b</var>, <var>0xffb527743c8cdd8f</var>}  <i>/* (8,15) */</i></td></tr>
<tr><th id="56">56</th><td>  };</td></tr>
<tr><th id="57">57</th><td></td></tr>
<tr><th id="58">58</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="59">59</th><td><dfn class="tu decl def fn" id="set_table" title='set_table' data-type='void set_table(__mpfr_struct * y, const mp_limb_t * x)' data-ref="set_table" data-ref-filename="set_table">set_table</dfn> (<a class="typedef" href="mpfr.h.html#mpfr_t" title='mpfr_t' data-type='__mpfr_struct [1]' data-ref="mpfr_t" data-ref-filename="mpfr_t">mpfr_t</a> <dfn class="local col1 decl" id="1y" title='y' data-type='__mpfr_struct *' data-ref="1y" data-ref-filename="1y">y</dfn>, <em>const</em> <a class="typedef" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#mp_limb_t" title='mp_limb_t' data-type='unsigned long' data-ref="mp_limb_t" data-ref-filename="mp_limb_t">mp_limb_t</a> <dfn class="local col2 decl" id="2x" title='x' data-type='const mp_limb_t *' data-ref="2x" data-ref-filename="2x">x</dfn>[<var>3</var>])</td></tr>
<tr><th id="60">60</th><td>{</td></tr>
<tr><th id="61">61</th><td>  <a class="typedef" href="mpfr.h.html#mpfr_prec_t" title='mpfr_prec_t' data-type='long' data-ref="mpfr_prec_t" data-ref-filename="mpfr_prec_t">mpfr_prec_t</a> <dfn class="local col3 decl" id="3p" title='p' data-type='mpfr_prec_t' data-ref="3p" data-ref-filename="3p">p</dfn> = <a class="macro" href="mpfr-impl.h.html#831" title="((y)-&gt;_mpfr_prec)" data-ref="_M/MPFR_PREC">MPFR_PREC</a>(<a class="local col1 ref" href="#1y" title='y' data-ref="1y" data-ref-filename="1y">y</a>);</td></tr>
<tr><th id="62">62</th><td>  <a class="typedef" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#mp_size_t" title='mp_size_t' data-type='long' data-ref="mp_size_t" data-ref-filename="mp_size_t">mp_size_t</a> <dfn class="local col4 decl" id="4n" title='n' data-type='mp_size_t' data-ref="4n" data-ref-filename="4n">n</dfn> = <a class="macro" href="mpfr-impl.h.html#828" title="(((void) 0), ((p) - 1) / (64 - 0) + 1)" data-ref="_M/MPFR_PREC2LIMBS">MPFR_PREC2LIMBS</a>(<a class="local col3 ref" href="#3p" title='p' data-ref="3p" data-ref-filename="3p">p</a>);</td></tr>
<tr><th id="63">63</th><td>  <a class="typedef" href="mpfr.h.html#mpfr_prec_t" title='mpfr_prec_t' data-type='long' data-ref="mpfr_prec_t" data-ref-filename="mpfr_prec_t">mpfr_prec_t</a> <dfn class="local col5 decl" id="5sh" title='sh' data-type='mpfr_prec_t' data-ref="5sh" data-ref-filename="5sh">sh</dfn>;</td></tr>
<tr><th id="64">64</th><td>  <a class="typedef" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#mp_limb_t" title='mp_limb_t' data-type='unsigned long' data-ref="mp_limb_t" data-ref-filename="mp_limb_t">mp_limb_t</a> *<dfn class="local col6 decl" id="6yp" title='yp' data-type='mp_limb_t *' data-ref="6yp" data-ref-filename="6yp">yp</dfn> = <a class="macro" href="mpfr-impl.h.html#833" title="((y)-&gt;_mpfr_d)" data-ref="_M/MPFR_MANT">MPFR_MANT</a>(<a class="local col1 ref" href="#1y" title='y' data-ref="1y" data-ref-filename="1y">y</a>);</td></tr>
<tr><th id="65">65</th><td></td></tr>
<tr><th id="66">66</th><td>  <a class="macro" href="mpfr-impl.h.html#1385" title="do { if (((((64 - 0)) &amp; (((64 - 0)) - 1)) == 0)) (sh) = (- (unsigned int) (p)) % (64 - 0); else { (sh) = (p) % (64 - 0); if ((sh) != 0) (sh) = (64 - 0) - (sh); } ((void) 0); } while (0)" data-ref="_M/MPFR_UNSIGNED_MINUS_MODULO">MPFR_UNSIGNED_MINUS_MODULO</a> (<a class="local col5 ref" href="#5sh" title='sh' data-ref="5sh" data-ref-filename="5sh">sh</a>, <a class="local col3 ref" href="#3p" title='p' data-ref="3p" data-ref-filename="3p">p</a>);</td></tr>
<tr><th id="67">67</th><td>  <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#1632" title="__gmpn_copyi" data-ref="_M/mpn_copyi">mpn_copyi</a> (<a class="local col6 ref" href="#6yp" title='yp' data-ref="6yp" data-ref-filename="6yp">yp</a>, <a class="local col2 ref" href="#2x" title='x' data-ref="2x" data-ref-filename="2x">x</a> + <var>3</var> - <a class="local col4 ref" href="#4n" title='n' data-ref="4n" data-ref-filename="4n">n</a>, <a class="local col4 ref" href="#4n" title='n' data-ref="4n" data-ref-filename="4n">n</a>);</td></tr>
<tr><th id="68">68</th><td>  <a class="local col6 ref" href="#6yp" title='yp' data-ref="6yp" data-ref-filename="6yp">yp</a>[<var>0</var>] &amp;= ~<a class="macro" href="mpfr-impl.h.html#1110" title="((((mp_limb_t) 1) &lt;&lt; (sh)) - ((mp_limb_t) 1))" data-ref="_M/MPFR_LIMB_MASK">MPFR_LIMB_MASK</a>(<a class="local col5 ref" href="#5sh" title='sh' data-ref="5sh" data-ref-filename="5sh">sh</a>);</td></tr>
<tr><th id="69">69</th><td>  <a class="macro" href="mpfr-impl.h.html#926" title="((void) (((y)-&gt;_mpfr_exp) = (0)))" data-ref="_M/MPFR_SET_EXP">MPFR_SET_EXP</a>(<a class="local col1 ref" href="#1y" title='y' data-ref="1y" data-ref-filename="1y">y</a>, <var>0</var>);</td></tr>
<tr><th id="70">70</th><td>}</td></tr>
<tr><th id="71">71</th><td><u>#<span data-ppcond="26">endif</span></u></td></tr>
<tr><th id="72">72</th><td></td></tr>
<tr><th id="73">73</th><td><i  data-doc="mpfr_atan_aux">/* If x = p/2^r, put in y an approximation of atan(x)/x using 2^m terms</i></td></tr>
<tr><th id="74">74</th><td><i  data-doc="mpfr_atan_aux">   for the series expansion, with an error of at most 1 ulp.</i></td></tr>
<tr><th id="75">75</th><td><i  data-doc="mpfr_atan_aux">   Assumes 0 &lt; x &lt; 1, thus 1 &lt;= p &lt; 2^r.</i></td></tr>
<tr><th id="76">76</th><td><i  data-doc="mpfr_atan_aux">   More precisely, p consists of the floor(r/2) bits of the binary expansion</i></td></tr>
<tr><th id="77">77</th><td><i  data-doc="mpfr_atan_aux">   of a number 0 &lt; s &lt; 1:</i></td></tr>
<tr><th id="78">78</th><td><i  data-doc="mpfr_atan_aux">   * the bit of weight 2^-1 is for r=1, thus p &lt;= 1</i></td></tr>
<tr><th id="79">79</th><td><i  data-doc="mpfr_atan_aux">   * the bit of weight 2^-2 is for r=2, thus p &lt;= 1</i></td></tr>
<tr><th id="80">80</th><td><i  data-doc="mpfr_atan_aux">   * the two bits of weight 2^-3 and 2^-4 are for r=4, thus p &lt;= 3</i></td></tr>
<tr><th id="81">81</th><td><i  data-doc="mpfr_atan_aux">   * more generally p &lt; 2^(r/2).</i></td></tr>
<tr><th id="82">82</th><td><i  data-doc="mpfr_atan_aux"></i></td></tr>
<tr><th id="83">83</th><td><i  data-doc="mpfr_atan_aux">   If X=x^2, we want 1 - X/3 + X^2/5 - ... + (-1)^k*X^k/(2k+1) + ...</i></td></tr>
<tr><th id="84">84</th><td><i  data-doc="mpfr_atan_aux"></i></td></tr>
<tr><th id="85">85</th><td><i  data-doc="mpfr_atan_aux">   When we sum terms up to x^k/(2k+1), the denominator Q[0] is</i></td></tr>
<tr><th id="86">86</th><td><i  data-doc="mpfr_atan_aux">   3*5*7*...*(2k+1) ~ (2k/e)^k.</i></td></tr>
<tr><th id="87">87</th><td><i  data-doc="mpfr_atan_aux"></i></td></tr>
<tr><th id="88">88</th><td><i  data-doc="mpfr_atan_aux">   The tab[] array should have at least 3*(m+1) entries.</i></td></tr>
<tr><th id="89">89</th><td><i  data-doc="mpfr_atan_aux">*/</i></td></tr>
<tr><th id="90">90</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="91">91</th><td><dfn class="tu decl def fn" id="mpfr_atan_aux" title='mpfr_atan_aux' data-type='void mpfr_atan_aux(mpfr_ptr y, mpz_ptr p, unsigned long r, int m, mpz_t * tab)' data-ref="mpfr_atan_aux" data-ref-filename="mpfr_atan_aux">mpfr_atan_aux</dfn> (<a class="typedef" href="mpfr.h.html#mpfr_ptr" title='mpfr_ptr' data-type='__mpfr_struct *' data-ref="mpfr_ptr" data-ref-filename="mpfr_ptr">mpfr_ptr</a> <dfn class="local col7 decl" id="7y" title='y' data-type='mpfr_ptr' data-ref="7y" data-ref-filename="7y">y</dfn>, <a class="typedef" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#mpz_ptr" title='mpz_ptr' data-type='__mpz_struct *' data-ref="mpz_ptr" data-ref-filename="mpz_ptr">mpz_ptr</a> <dfn class="local col8 decl" id="8p" title='p' data-type='mpz_ptr' data-ref="8p" data-ref-filename="8p">p</dfn>, <em>unsigned</em> <em>long</em> <dfn class="local col9 decl" id="9r" title='r' data-type='unsigned long' data-ref="9r" data-ref-filename="9r">r</dfn>, <em>int</em> <dfn class="local col0 decl" id="10m" title='m' data-type='int' data-ref="10m" data-ref-filename="10m">m</dfn>, <a class="typedef" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#mpz_t" title='mpz_t' data-type='__mpz_struct [1]' data-ref="mpz_t" data-ref-filename="mpz_t">mpz_t</a> *<dfn class="local col1 decl" id="11tab" title='tab' data-type='mpz_t *' data-ref="11tab" data-ref-filename="11tab">tab</dfn>)</td></tr>
<tr><th id="92">92</th><td>{</td></tr>
<tr><th id="93">93</th><td>  <a class="typedef" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#mpz_t" title='mpz_t' data-type='__mpz_struct [1]' data-ref="mpz_t" data-ref-filename="mpz_t">mpz_t</a> *<dfn class="local col2 decl" id="12S" title='S' data-type='mpz_t *' data-ref="12S" data-ref-filename="12S">S</dfn>, *<dfn class="local col3 decl" id="13Q" title='Q' data-type='mpz_t *' data-ref="13Q" data-ref-filename="13Q">Q</dfn>, *<dfn class="local col4 decl" id="14ptoj" title='ptoj' data-type='mpz_t *' data-ref="14ptoj" data-ref-filename="14ptoj">ptoj</dfn>;</td></tr>
<tr><th id="94">94</th><td>  <a class="typedef" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#mp_bitcnt_t" title='mp_bitcnt_t' data-type='unsigned long' data-ref="mp_bitcnt_t" data-ref-filename="mp_bitcnt_t">mp_bitcnt_t</a> <dfn class="local col5 decl" id="15n" title='n' data-type='mp_bitcnt_t' data-ref="15n" data-ref-filename="15n">n</dfn>, <dfn class="local col6 decl" id="16h" title='h' data-type='mp_bitcnt_t' data-ref="16h" data-ref-filename="16h">h</dfn>, <dfn class="local col7 decl" id="17j" title='j' data-type='mp_bitcnt_t' data-ref="17j" data-ref-filename="17j">j</dfn>;  <i>/* unsigned type, which is &gt;= unsigned long */</i></td></tr>
<tr><th id="95">95</th><td>  <a class="typedef" href="mpfr.h.html#mpfr_exp_t" title='mpfr_exp_t' data-type='long' data-ref="mpfr_exp_t" data-ref-filename="mpfr_exp_t">mpfr_exp_t</a> <dfn class="local col8 decl" id="18diff" title='diff' data-type='mpfr_exp_t' data-ref="18diff" data-ref-filename="18diff">diff</dfn>, <dfn class="local col9 decl" id="19expo" title='expo' data-type='mpfr_exp_t' data-ref="19expo" data-ref-filename="19expo">expo</dfn>;</td></tr>
<tr><th id="96">96</th><td>  <em>int</em> <dfn class="local col0 decl" id="20im" title='im' data-type='int' data-ref="20im" data-ref-filename="20im">im</dfn>, <dfn class="local col1 decl" id="21i" title='i' data-type='int' data-ref="21i" data-ref-filename="21i">i</dfn>, <dfn class="local col2 decl" id="22k" title='k' data-type='int' data-ref="22k" data-ref-filename="22k">k</dfn>, <dfn class="local col3 decl" id="23l" title='l' data-type='int' data-ref="23l" data-ref-filename="23l">l</dfn>, <dfn class="local col4 decl" id="24done" title='done' data-type='int' data-ref="24done" data-ref-filename="24done">done</dfn>;</td></tr>
<tr><th id="97">97</th><td>  <a class="typedef" href="mpfr.h.html#mpfr_prec_t" title='mpfr_prec_t' data-type='long' data-ref="mpfr_prec_t" data-ref-filename="mpfr_prec_t">mpfr_prec_t</a> <dfn class="local col5 decl" id="25mult" title='mult' data-type='mpfr_prec_t' data-ref="25mult" data-ref-filename="25mult">mult</dfn>;</td></tr>
<tr><th id="98">98</th><td>  <a class="typedef" href="mpfr.h.html#mpfr_prec_t" title='mpfr_prec_t' data-type='long' data-ref="mpfr_prec_t" data-ref-filename="mpfr_prec_t">mpfr_prec_t</a> <dfn class="local col6 decl" id="26accu" title='accu' data-type='mpfr_prec_t [64]' data-ref="26accu" data-ref-filename="26accu">accu</dfn>[<a class="macro" href="mpfr-impl.h.html#2321" title="64" data-ref="_M/MPFR_PREC_BITS">MPFR_PREC_BITS</a>], <dfn class="local col7 decl" id="27log2_nb_terms" title='log2_nb_terms' data-type='mpfr_prec_t [64]' data-ref="27log2_nb_terms" data-ref-filename="27log2_nb_terms">log2_nb_terms</dfn>[<a class="macro" href="mpfr-impl.h.html#2321" title="64" data-ref="_M/MPFR_PREC_BITS">MPFR_PREC_BITS</a>];</td></tr>
<tr><th id="99">99</th><td>  <a class="typedef" href="mpfr.h.html#mpfr_prec_t" title='mpfr_prec_t' data-type='long' data-ref="mpfr_prec_t" data-ref-filename="mpfr_prec_t">mpfr_prec_t</a> <dfn class="local col8 decl" id="28precy" title='precy' data-type='mpfr_prec_t' data-ref="28precy" data-ref-filename="28precy">precy</dfn> = <a class="macro" href="mpfr-impl.h.html#831" title="((y)-&gt;_mpfr_prec)" data-ref="_M/MPFR_PREC">MPFR_PREC</a>(<a class="local col7 ref" href="#7y" title='y' data-ref="7y" data-ref-filename="7y">y</a>);</td></tr>
<tr><th id="100">100</th><td></td></tr>
<tr><th id="101">101</th><td>  <a class="macro" href="mpfr-impl.h.html#489" title="((void) 0)" data-ref="_M/MPFR_ASSERTD">MPFR_ASSERTD</a>(<a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#2244" title="(__builtin_constant_p (0) &amp;&amp; (0) == 0 ? ((p)-&gt;_mp_size &lt; 0 ? -1 : (p)-&gt;_mp_size &gt; 0) : __gmpz_cmp_ui (p,0))" data-ref="_M/mpz_cmp_ui">mpz_cmp_ui</a> (p, <var>0</var>) != <var>0</var>);</td></tr>
<tr><th id="102">102</th><td>  <a class="macro" href="mpfr-impl.h.html#489" title="((void) 0)" data-ref="_M/MPFR_ASSERTD">MPFR_ASSERTD</a> (m+<var>1</var> &lt;= <a class="macro" href="mpfr-impl.h.html#2321" title="64" data-ref="_M/MPFR_PREC_BITS">MPFR_PREC_BITS</a>);</td></tr>
<tr><th id="103">103</th><td></td></tr>
<tr><th id="104">104</th><td><u>#<span data-ppcond="104">if</span> <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#46" title="(64 - 0)" data-ref="_M/GMP_NUMB_BITS">GMP_NUMB_BITS</a> == 64</u></td></tr>
<tr><th id="105">105</th><td>  <i>/* tabulate values for small precision and small value of r (which are the</i></td></tr>
<tr><th id="106">106</th><td><i>     most expensive to compute) */</i></td></tr>
<tr><th id="107">107</th><td>  <b>if</b> (<a class="local col8 ref" href="#28precy" title='precy' data-ref="28precy" data-ref-filename="28precy">precy</a> &lt;= <var>192</var>)</td></tr>
<tr><th id="108">108</th><td>    {</td></tr>
<tr><th id="109">109</th><td>      <b>switch</b> (<a class="local col9 ref" href="#9r" title='r' data-ref="9r" data-ref-filename="9r">r</a>)</td></tr>
<tr><th id="110">110</th><td>        {</td></tr>
<tr><th id="111">111</th><td>        <b>case</b> <var>1</var>:</td></tr>
<tr><th id="112">112</th><td>          <i>/* p has 1 bit: necessarily p=1 */</i></td></tr>
<tr><th id="113">113</th><td>          <a class="macro" href="mpfr-impl.h.html#489" title="((void) 0)" data-ref="_M/MPFR_ASSERTD">MPFR_ASSERTD</a>(<a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#2244" title="(__builtin_constant_p (1) &amp;&amp; (1) == 0 ? ((p)-&gt;_mp_size &lt; 0 ? -1 : (p)-&gt;_mp_size &gt; 0) : __gmpz_cmp_ui (p,1))" data-ref="_M/mpz_cmp_ui">mpz_cmp_ui</a> (p, <var>1</var>) == <var>0</var>);</td></tr>
<tr><th id="114">114</th><td>          <a class="tu ref fn" href="#set_table" title='set_table' data-use='c' data-ref="set_table" data-ref-filename="set_table">set_table</a> (<a class="local col7 ref" href="#7y" title='y' data-ref="7y" data-ref-filename="7y">y</a>, <a class="tu ref" href="#atan_table" title='atan_table' data-use='r' data-ref="atan_table" data-ref-filename="atan_table">atan_table</a>[<var>0</var>]);</td></tr>
<tr><th id="115">115</th><td>          <b>return</b>;</td></tr>
<tr><th id="116">116</th><td>        <b>case</b> <var>2</var>:</td></tr>
<tr><th id="117">117</th><td>          <i>/* p has 1 bit: necessarily p=1 too */</i></td></tr>
<tr><th id="118">118</th><td>          <a class="macro" href="mpfr-impl.h.html#489" title="((void) 0)" data-ref="_M/MPFR_ASSERTD">MPFR_ASSERTD</a>(<a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#2244" title="(__builtin_constant_p (1) &amp;&amp; (1) == 0 ? ((p)-&gt;_mp_size &lt; 0 ? -1 : (p)-&gt;_mp_size &gt; 0) : __gmpz_cmp_ui (p,1))" data-ref="_M/mpz_cmp_ui">mpz_cmp_ui</a> (p, <var>1</var>) == <var>0</var>);</td></tr>
<tr><th id="119">119</th><td>          <a class="tu ref fn" href="#set_table" title='set_table' data-use='c' data-ref="set_table" data-ref-filename="set_table">set_table</a> (<a class="local col7 ref" href="#7y" title='y' data-ref="7y" data-ref-filename="7y">y</a>, <a class="tu ref" href="#atan_table" title='atan_table' data-use='r' data-ref="atan_table" data-ref-filename="atan_table">atan_table</a>[<var>1</var>]);</td></tr>
<tr><th id="120">120</th><td>          <b>return</b>;</td></tr>
<tr><th id="121">121</th><td>        <b>case</b> <var>4</var>:</td></tr>
<tr><th id="122">122</th><td>          <i>/* p has at most 2 bits: 1 &lt;= p &lt;= 3 */</i></td></tr>
<tr><th id="123">123</th><td>          <a class="macro" href="mpfr-impl.h.html#489" title="((void) 0)" data-ref="_M/MPFR_ASSERTD">MPFR_ASSERTD</a>(<var>1</var> &lt;= <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#831" title="__gmpz_get_ui" data-ref="_M/mpz_get_ui">mpz_get_ui</a> (p) &amp;&amp; <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#831" title="__gmpz_get_ui" data-ref="_M/mpz_get_ui">mpz_get_ui</a> (p) &lt;= <var>3</var>);</td></tr>
<tr><th id="124">124</th><td>          <a class="tu ref fn" href="#set_table" title='set_table' data-use='c' data-ref="set_table" data-ref-filename="set_table">set_table</a> (<a class="local col7 ref" href="#7y" title='y' data-ref="7y" data-ref-filename="7y">y</a>, <a class="tu ref" href="#atan_table" title='atan_table' data-use='r' data-ref="atan_table" data-ref-filename="atan_table">atan_table</a>[<var>1</var> + <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#831" title="__gmpz_get_ui" data-ref="_M/mpz_get_ui">mpz_get_ui</a> (<a class="local col8 ref" href="#8p" title='p' data-ref="8p" data-ref-filename="8p">p</a>)]);</td></tr>
<tr><th id="125">125</th><td>          <b>return</b>;</td></tr>
<tr><th id="126">126</th><td>        <b>case</b> <var>8</var>:</td></tr>
<tr><th id="127">127</th><td>          <i>/* p has at most 4 bits: 1 &lt;= p &lt;= 15 */</i></td></tr>
<tr><th id="128">128</th><td>          <a class="macro" href="mpfr-impl.h.html#489" title="((void) 0)" data-ref="_M/MPFR_ASSERTD">MPFR_ASSERTD</a>(<var>1</var> &lt;= <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#831" title="__gmpz_get_ui" data-ref="_M/mpz_get_ui">mpz_get_ui</a> (p) &amp;&amp; <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#831" title="__gmpz_get_ui" data-ref="_M/mpz_get_ui">mpz_get_ui</a> (p) &lt;= <var>15</var>);</td></tr>
<tr><th id="129">129</th><td>          <a class="tu ref fn" href="#set_table" title='set_table' data-use='c' data-ref="set_table" data-ref-filename="set_table">set_table</a> (<a class="local col7 ref" href="#7y" title='y' data-ref="7y" data-ref-filename="7y">y</a>, <a class="tu ref" href="#atan_table" title='atan_table' data-use='r' data-ref="atan_table" data-ref-filename="atan_table">atan_table</a>[<var>4</var> + <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#831" title="__gmpz_get_ui" data-ref="_M/mpz_get_ui">mpz_get_ui</a> (<a class="local col8 ref" href="#8p" title='p' data-ref="8p" data-ref-filename="8p">p</a>)]);</td></tr>
<tr><th id="130">130</th><td>          <b>return</b>;</td></tr>
<tr><th id="131">131</th><td>        }</td></tr>
<tr><th id="132">132</th><td>    }</td></tr>
<tr><th id="133">133</th><td><u>#<span data-ppcond="104">endif</span></u></td></tr>
<tr><th id="134">134</th><td></td></tr>
<tr><th id="135">135</th><td>  <i>/* Set Tables */</i></td></tr>
<tr><th id="136">136</th><td>  <a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>    = <a class="local col1 ref" href="#11tab" title='tab' data-ref="11tab" data-ref-filename="11tab">tab</a>;           <i>/* S */</i></td></tr>
<tr><th id="137">137</th><td>  <a class="local col4 ref" href="#14ptoj" title='ptoj' data-ref="14ptoj" data-ref-filename="14ptoj">ptoj</a> = <a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a> + <var>1</var>*(<a class="local col0 ref" href="#10m" title='m' data-ref="10m" data-ref-filename="10m">m</a>+<var>1</var>);   <i>/* p^2^j Precomputed table */</i></td></tr>
<tr><th id="138">138</th><td>  <a class="local col3 ref" href="#13Q" title='Q' data-ref="13Q" data-ref-filename="13Q">Q</a>    = <a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a> + <var>2</var>*(<a class="local col0 ref" href="#10m" title='m' data-ref="10m" data-ref-filename="10m">m</a>+<var>1</var>);   <i>/* Product of Odd integer  table  */</i></td></tr>
<tr><th id="139">139</th><td></td></tr>
<tr><th id="140">140</th><td>  <i>/* From p to p^2, and r to 2r */</i></td></tr>
<tr><th id="141">141</th><td>  <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#926" title="__gmpz_mul" data-ref="_M/mpz_mul">mpz_mul</a> (<a class="local col8 ref" href="#8p" title='p' data-ref="8p" data-ref-filename="8p">p</a>, <a class="local col8 ref" href="#8p" title='p' data-ref="8p" data-ref-filename="8p">p</a>, <a class="local col8 ref" href="#8p" title='p' data-ref="8p" data-ref-filename="8p">p</a>);</td></tr>
<tr><th id="142">142</th><td>  <a class="macro" href="mpfr-impl.h.html#489" title="((void) 0)" data-ref="_M/MPFR_ASSERTD">MPFR_ASSERTD</a> (<var>2</var> * r &gt; r);</td></tr>
<tr><th id="143">143</th><td>  <a class="local col9 ref" href="#9r" title='r' data-ref="9r" data-ref-filename="9r">r</a> = <var>2</var> * <a class="local col9 ref" href="#9r" title='r' data-ref="9r" data-ref-filename="9r">r</a>;</td></tr>
<tr><th id="144">144</th><td></td></tr>
<tr><th id="145">145</th><td>  <i>/* Normalize p */</i></td></tr>
<tr><th id="146">146</th><td>  <a class="local col5 ref" href="#15n" title='n' data-ref="15n" data-ref-filename="15n">n</a> = <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#1008" title="__gmpz_scan1" data-ref="_M/mpz_scan1">mpz_scan1</a> (<a class="local col8 ref" href="#8p" title='p' data-ref="8p" data-ref-filename="8p">p</a>, <var>0</var>);</td></tr>
<tr><th id="147">147</th><td>  <b>if</b> (<a class="local col5 ref" href="#15n" title='n' data-ref="15n" data-ref-filename="15n">n</a> &gt; <var>0</var>)</td></tr>
<tr><th id="148">148</th><td>    {</td></tr>
<tr><th id="149">149</th><td>      <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#1075" title="__gmpz_tdiv_q_2exp" data-ref="_M/mpz_tdiv_q_2exp">mpz_tdiv_q_2exp</a> (<a class="local col8 ref" href="#8p" title='p' data-ref="8p" data-ref-filename="8p">p</a>, <a class="local col8 ref" href="#8p" title='p' data-ref="8p" data-ref-filename="8p">p</a>, <a class="local col5 ref" href="#15n" title='n' data-ref="15n" data-ref-filename="15n">n</a>); <i>/* exact */</i></td></tr>
<tr><th id="150">150</th><td>      <a class="macro" href="mpfr-impl.h.html#489" title="((void) 0)" data-ref="_M/MPFR_ASSERTD">MPFR_ASSERTD</a> (r &gt; n);</td></tr>
<tr><th id="151">151</th><td>      <a class="local col9 ref" href="#9r" title='r' data-ref="9r" data-ref-filename="9r">r</a> -= <a class="local col5 ref" href="#15n" title='n' data-ref="15n" data-ref-filename="15n">n</a>;</td></tr>
<tr><th id="152">152</th><td>    }</td></tr>
<tr><th id="153">153</th><td>  <i>/* since |p/2^r| &lt; 1, and p is a non-zero integer, necessarily r &gt; 0 */</i></td></tr>
<tr><th id="154">154</th><td></td></tr>
<tr><th id="155">155</th><td>  <a class="macro" href="mpfr-impl.h.html#489" title="((void) 0)" data-ref="_M/MPFR_ASSERTD">MPFR_ASSERTD</a> (<a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#2238" title="((p)-&gt;_mp_size &lt; 0 ? -1 : (p)-&gt;_mp_size &gt; 0)" data-ref="_M/mpz_sgn">mpz_sgn</a> (p) &gt; <var>0</var>);</td></tr>
<tr><th id="156">156</th><td>  <a class="macro" href="mpfr-impl.h.html#489" title="((void) 0)" data-ref="_M/MPFR_ASSERTD">MPFR_ASSERTD</a> (m &gt; <var>0</var>);</td></tr>
<tr><th id="157">157</th><td></td></tr>
<tr><th id="158">158</th><td>  <i>/* check if p=1 (special case) */</i></td></tr>
<tr><th id="159">159</th><td>  <a class="local col3 ref" href="#23l" title='l' data-ref="23l" data-ref-filename="23l">l</a> = <var>0</var>;</td></tr>
<tr><th id="160">160</th><td>  <i>/*</i></td></tr>
<tr><th id="161">161</th><td><i>    We compute by binary splitting, with X = x^2 = p/2^r:</i></td></tr>
<tr><th id="162">162</th><td><i>    P(a,b) = p if a+1=b, P(a,c)*P(c,b) otherwise</i></td></tr>
<tr><th id="163">163</th><td><i>    Q(a,b) = (2a+1)*2^r if a+1=b [except Q(0,1)=1], Q(a,c)*Q(c,b) otherwise</i></td></tr>
<tr><th id="164">164</th><td><i>    S(a,b) = p*(2a+1) if a+1=b, Q(c,b)*S(a,c)+Q(a,c)*P(a,c)*S(c,b) otherwise</i></td></tr>
<tr><th id="165">165</th><td><i>    Then atan(x)/x ~ S(0,i)/Q(0,i) for i so that (p/2^r)^i/i is small enough.</i></td></tr>
<tr><th id="166">166</th><td><i>    The factor 2^(r*(b-a)) in Q(a,b) is implicit, thus we have to take it</i></td></tr>
<tr><th id="167">167</th><td><i>    into account when we compute with Q.</i></td></tr>
<tr><th id="168">168</th><td><i>  */</i></td></tr>
<tr><th id="169">169</th><td>  <a class="local col6 ref" href="#26accu" title='accu' data-ref="26accu" data-ref-filename="26accu">accu</a>[<var>0</var>] = <var>0</var>; <i>/* accu[k] = Mult[0] + ... + Mult[k], where Mult[j] is the</i></td></tr>
<tr><th id="170">170</th><td><i>                  number of bits of the corresponding term S[j]/Q[j] */</i></td></tr>
<tr><th id="171">171</th><td>  <b>if</b> (<a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#2244" title="(__builtin_constant_p (1) &amp;&amp; (1) == 0 ? ((p)-&gt;_mp_size &lt; 0 ? -1 : (p)-&gt;_mp_size &gt; 0) : __gmpz_cmp_ui (p,1))" data-ref="_M/mpz_cmp_ui">mpz_cmp_ui</a> (<a class="local col8 ref" href="#8p" title='p' data-ref="8p" data-ref-filename="8p">p</a>, <var>1</var>) != <var>0</var>)</td></tr>
<tr><th id="172">172</th><td>    {</td></tr>
<tr><th id="173">173</th><td>      <i>/* p &lt;&gt; 1: precompute ptoj table */</i></td></tr>
<tr><th id="174">174</th><td>      <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#1011" title="__gmpz_set" data-ref="_M/mpz_set">mpz_set</a> (<a class="local col4 ref" href="#14ptoj" title='ptoj' data-ref="14ptoj" data-ref-filename="14ptoj">ptoj</a>[<var>0</var>], <a class="local col8 ref" href="#8p" title='p' data-ref="8p" data-ref-filename="8p">p</a>);</td></tr>
<tr><th id="175">175</th><td>      <b>for</b> (<a class="local col0 ref" href="#20im" title='im' data-ref="20im" data-ref-filename="20im">im</a> = <var>1</var> ; <a class="local col0 ref" href="#20im" title='im' data-ref="20im" data-ref-filename="20im">im</a> &lt;= <a class="local col0 ref" href="#10m" title='m' data-ref="10m" data-ref-filename="10m">m</a> ; <a class="local col0 ref" href="#20im" title='im' data-ref="20im" data-ref-filename="20im">im</a> ++)</td></tr>
<tr><th id="176">176</th><td>        <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#926" title="__gmpz_mul" data-ref="_M/mpz_mul">mpz_mul</a> (<a class="local col4 ref" href="#14ptoj" title='ptoj' data-ref="14ptoj" data-ref-filename="14ptoj">ptoj</a>[<a class="local col0 ref" href="#20im" title='im' data-ref="20im" data-ref-filename="20im">im</a>], <a class="local col4 ref" href="#14ptoj" title='ptoj' data-ref="14ptoj" data-ref-filename="14ptoj">ptoj</a>[<a class="local col0 ref" href="#20im" title='im' data-ref="20im" data-ref-filename="20im">im</a> - <var>1</var>], <a class="local col4 ref" href="#14ptoj" title='ptoj' data-ref="14ptoj" data-ref-filename="14ptoj">ptoj</a>[<a class="local col0 ref" href="#20im" title='im' data-ref="20im" data-ref-filename="20im">im</a> - <var>1</var>]);</td></tr>
<tr><th id="177">177</th><td>      <i>/* main loop */</i></td></tr>
<tr><th id="178">178</th><td>      <a class="local col5 ref" href="#15n" title='n' data-ref="15n" data-ref-filename="15n">n</a> = <var>1UL</var> &lt;&lt; <a class="local col0 ref" href="#10m" title='m' data-ref="10m" data-ref-filename="10m">m</a>;</td></tr>
<tr><th id="179">179</th><td>      <a class="macro" href="mpfr-impl.h.html#468" title="((void) (((__builtin_expect(!!(n != 0), 1))) || (mpfr_assert_fail (&quot;/___NETBSD_SRC___/objdir.amd64/external/lgpl3/mpfr/lib/libmpfr/../../../../../../external/lgpl3/mpfr/dist/src/atan.c&quot;, 179, &quot;n != 0&quot;),((void) 0),0)))" data-ref="_M/MPFR_ASSERTN">MPFR_ASSERTN</a> (<a class="local col5 ref" href="#15n" title='n' data-ref="15n" data-ref-filename="15n">n</a> != <var>0</var>);  <i>/* no overflow */</i></td></tr>
<tr><th id="180">180</th><td>      <i>/* the ith term being X^i/(2i+1) with X=p/2^r, we can stop when</i></td></tr>
<tr><th id="181">181</th><td><i>         p^i/2^(r*i) &lt; 2^(-precy), i.e. r*i &gt; precy + log2(p^i) */</i></td></tr>
<tr><th id="182">182</th><td>      <b>for</b> (<a class="local col1 ref" href="#21i" title='i' data-ref="21i" data-ref-filename="21i">i</a> = <a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a> = <a class="local col4 ref" href="#24done" title='done' data-ref="24done" data-ref-filename="24done">done</a> = <var>0</var>; (<a class="local col1 ref" href="#21i" title='i' data-ref="21i" data-ref-filename="21i">i</a> &lt; <a class="local col5 ref" href="#15n" title='n' data-ref="15n" data-ref-filename="15n">n</a>) &amp;&amp; (<a class="local col4 ref" href="#24done" title='done' data-ref="24done" data-ref-filename="24done">done</a> == <var>0</var>); <a class="local col1 ref" href="#21i" title='i' data-ref="21i" data-ref-filename="21i">i</a> += <var>2</var>, <a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a> ++)</td></tr>
<tr><th id="183">183</th><td>        {</td></tr>
<tr><th id="184">184</th><td>          <i>/* initialize both S[k],Q[k] and S[k+1],Q[k+1] */</i></td></tr>
<tr><th id="185">185</th><td>          <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#1031" title="__gmpz_set_ui" data-ref="_M/mpz_set_ui">mpz_set_ui</a> (<a class="local col3 ref" href="#13Q" title='Q' data-ref="13Q" data-ref-filename="13Q">Q</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>+<var>1</var>], <var>2</var> * <a class="local col1 ref" href="#21i" title='i' data-ref="21i" data-ref-filename="21i">i</a> + <var>3</var>); <i>/* Q(i+1,i+2) */</i></td></tr>
<tr><th id="186">186</th><td>          <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#935" title="__gmpz_mul_ui" data-ref="_M/mpz_mul_ui">mpz_mul_ui</a> (<a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>+<var>1</var>], <a class="local col8 ref" href="#8p" title='p' data-ref="8p" data-ref-filename="8p">p</a>, <var>2</var> * <a class="local col1 ref" href="#21i" title='i' data-ref="21i" data-ref-filename="21i">i</a> + <var>1</var>); <i>/* S(i+1,i+2) */</i></td></tr>
<tr><th id="187">187</th><td>          <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#929" title="__gmpz_mul_2exp" data-ref="_M/mpz_mul_2exp">mpz_mul_2exp</a> (<a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>], <a class="local col3 ref" href="#13Q" title='Q' data-ref="13Q" data-ref-filename="13Q">Q</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>+<var>1</var>], <a class="local col9 ref" href="#9r" title='r' data-ref="9r" data-ref-filename="9r">r</a>);</td></tr>
<tr><th id="188">188</th><td>          <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#1051" title="__gmpz_sub" data-ref="_M/mpz_sub">mpz_sub</a> (<a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>], <a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>], <a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>+<var>1</var>]); <i>/* S(i,i+2) */</i></td></tr>
<tr><th id="189">189</th><td>          <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#935" title="__gmpz_mul_ui" data-ref="_M/mpz_mul_ui">mpz_mul_ui</a> (<a class="local col3 ref" href="#13Q" title='Q' data-ref="13Q" data-ref-filename="13Q">Q</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>], <a class="local col3 ref" href="#13Q" title='Q' data-ref="13Q" data-ref-filename="13Q">Q</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>+<var>1</var>], <var>2</var> * <a class="local col1 ref" href="#21i" title='i' data-ref="21i" data-ref-filename="21i">i</a> + <var>1</var>); <i>/* Q(i,i+2) */</i></td></tr>
<tr><th id="190">190</th><td>          <a class="local col7 ref" href="#27log2_nb_terms" title='log2_nb_terms' data-ref="27log2_nb_terms" data-ref-filename="27log2_nb_terms">log2_nb_terms</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>] = <var>1</var>; <i>/* S[k]/Q[k] corresponds to 2 terms */</i></td></tr>
<tr><th id="191">191</th><td>          <b>for</b> (<a class="local col7 ref" href="#17j" title='j' data-ref="17j" data-ref-filename="17j">j</a> = (<a class="local col1 ref" href="#21i" title='i' data-ref="21i" data-ref-filename="21i">i</a> + <var>2</var>) &gt;&gt; <var>1</var>, <a class="local col3 ref" href="#23l" title='l' data-ref="23l" data-ref-filename="23l">l</a> = <var>1</var>; (<a class="local col7 ref" href="#17j" title='j' data-ref="17j" data-ref-filename="17j">j</a> &amp; <var>1</var>) == <var>0</var>; <a class="local col3 ref" href="#23l" title='l' data-ref="23l" data-ref-filename="23l">l</a> ++, <a class="local col7 ref" href="#17j" title='j' data-ref="17j" data-ref-filename="17j">j</a> &gt;&gt;= <var>1</var>, <a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a> --)</td></tr>
<tr><th id="192">192</th><td>            {</td></tr>
<tr><th id="193">193</th><td>              <i>/* invariant: S[k-1]/Q[k-1] and S[k]/Q[k] correspond</i></td></tr>
<tr><th id="194">194</th><td><i>                 to 2^l terms each. We combine them into S[k-1]/Q[k-1] */</i></td></tr>
<tr><th id="195">195</th><td>              <a class="macro" href="mpfr-impl.h.html#489" title="((void) 0)" data-ref="_M/MPFR_ASSERTD">MPFR_ASSERTD</a> (k &gt; <var>0</var>);</td></tr>
<tr><th id="196">196</th><td>              <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#926" title="__gmpz_mul" data-ref="_M/mpz_mul">mpz_mul</a> (<a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>], <a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>], <a class="local col3 ref" href="#13Q" title='Q' data-ref="13Q" data-ref-filename="13Q">Q</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>-<var>1</var>]);</td></tr>
<tr><th id="197">197</th><td>              <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#926" title="__gmpz_mul" data-ref="_M/mpz_mul">mpz_mul</a> (<a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>], <a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>], <a class="local col4 ref" href="#14ptoj" title='ptoj' data-ref="14ptoj" data-ref-filename="14ptoj">ptoj</a>[<a class="local col3 ref" href="#23l" title='l' data-ref="23l" data-ref-filename="23l">l</a>]);</td></tr>
<tr><th id="198">198</th><td>              <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#926" title="__gmpz_mul" data-ref="_M/mpz_mul">mpz_mul</a> (<a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>-<var>1</var>], <a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>-<var>1</var>], <a class="local col3 ref" href="#13Q" title='Q' data-ref="13Q" data-ref-filename="13Q">Q</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>]);</td></tr>
<tr><th id="199">199</th><td>              <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#929" title="__gmpz_mul_2exp" data-ref="_M/mpz_mul_2exp">mpz_mul_2exp</a> (<a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>-<var>1</var>], <a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>-<var>1</var>], <a class="local col9 ref" href="#9r" title='r' data-ref="9r" data-ref-filename="9r">r</a> &lt;&lt; <a class="local col3 ref" href="#23l" title='l' data-ref="23l" data-ref-filename="23l">l</a>);</td></tr>
<tr><th id="200">200</th><td>              <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#624" title="__gmpz_add" data-ref="_M/mpz_add">mpz_add</a> (<a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>-<var>1</var>], <a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>-<var>1</var>], <a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>]);</td></tr>
<tr><th id="201">201</th><td>              <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#926" title="__gmpz_mul" data-ref="_M/mpz_mul">mpz_mul</a> (<a class="local col3 ref" href="#13Q" title='Q' data-ref="13Q" data-ref-filename="13Q">Q</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>-<var>1</var>], <a class="local col3 ref" href="#13Q" title='Q' data-ref="13Q" data-ref-filename="13Q">Q</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>-<var>1</var>], <a class="local col3 ref" href="#13Q" title='Q' data-ref="13Q" data-ref-filename="13Q">Q</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>]);</td></tr>
<tr><th id="202">202</th><td>              <a class="local col7 ref" href="#27log2_nb_terms" title='log2_nb_terms' data-ref="27log2_nb_terms" data-ref-filename="27log2_nb_terms">log2_nb_terms</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>-<var>1</var>] = <a class="local col3 ref" href="#23l" title='l' data-ref="23l" data-ref-filename="23l">l</a> + <var>1</var>;</td></tr>
<tr><th id="203">203</th><td>              <i>/* now S[k-1]/Q[k-1] corresponds to 2^(l+1) terms */</i></td></tr>
<tr><th id="204">204</th><td>              <a class="macro" href="mpfr-impl.h.html#1418" title="do { int _cnt; mp_size_t _size; ((void) 0); _size = ((((ptoj[l+1])-&gt;_mp_size)) &gt;= 0 ? (((ptoj[l+1])-&gt;_mp_size)) : -(((ptoj[l+1])-&gt;_mp_size))); ((void) 0); do { UDItype __cbtmp; ((void) 0); __asm__ (&quot;bsrq %1,%0&quot; : &quot;=r&quot; (__cbtmp) : &quot;rm&quot; ((UDItype)(((ptoj[l+1])-&gt;_mp_d)[_size-1]))); (_cnt) = __cbtmp ^ 63; } while (0); (mult) = _size * (64 - 0) - _cnt; } while (0)" data-ref="_M/MPFR_MPZ_SIZEINBASE2">MPFR_MPZ_SIZEINBASE2</a>(<a class="local col5 ref" href="#25mult" title='mult' data-ref="25mult" data-ref-filename="25mult">mult</a>, <a class="local col4 ref" href="#14ptoj" title='ptoj' data-ref="14ptoj" data-ref-filename="14ptoj">ptoj</a>[<a class="local col3 ref" href="#23l" title='l' data-ref="23l" data-ref-filename="23l">l</a>+<var>1</var>]);</td></tr>
<tr><th id="205">205</th><td>              <a class="local col5 ref" href="#25mult" title='mult' data-ref="25mult" data-ref-filename="25mult">mult</a> = (<a class="local col9 ref" href="#9r" title='r' data-ref="9r" data-ref-filename="9r">r</a> &lt;&lt; (<a class="local col3 ref" href="#23l" title='l' data-ref="23l" data-ref-filename="23l">l</a> + <var>1</var>)) - <a class="local col5 ref" href="#25mult" title='mult' data-ref="25mult" data-ref-filename="25mult">mult</a> - <var>1</var>;</td></tr>
<tr><th id="206">206</th><td>              <a class="local col6 ref" href="#26accu" title='accu' data-ref="26accu" data-ref-filename="26accu">accu</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>-<var>1</var>] = (<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a> == <var>1</var>) ? <a class="local col5 ref" href="#25mult" title='mult' data-ref="25mult" data-ref-filename="25mult">mult</a> : <a class="local col6 ref" href="#26accu" title='accu' data-ref="26accu" data-ref-filename="26accu">accu</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>-<var>2</var>] + <a class="local col5 ref" href="#25mult" title='mult' data-ref="25mult" data-ref-filename="25mult">mult</a>;</td></tr>
<tr><th id="207">207</th><td>              <b>if</b> (<a class="local col6 ref" href="#26accu" title='accu' data-ref="26accu" data-ref-filename="26accu">accu</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>-<var>1</var>] &gt; <a class="local col8 ref" href="#28precy" title='precy' data-ref="28precy" data-ref-filename="28precy">precy</a>)</td></tr>
<tr><th id="208">208</th><td>                <a class="local col4 ref" href="#24done" title='done' data-ref="24done" data-ref-filename="24done">done</a> = <var>1</var>;</td></tr>
<tr><th id="209">209</th><td>            }</td></tr>
<tr><th id="210">210</th><td>        }</td></tr>
<tr><th id="211">211</th><td>    }</td></tr>
<tr><th id="212">212</th><td>  <b>else</b> <i>/* special case p=1: the ith term being X^i/(2i+1) with X=1/2^r,</i></td></tr>
<tr><th id="213">213</th><td><i>          we can stop when r*i &gt; precy i.e. i &gt; precy/r */</i></td></tr>
<tr><th id="214">214</th><td>    {</td></tr>
<tr><th id="215">215</th><td>      <a class="local col5 ref" href="#15n" title='n' data-ref="15n" data-ref-filename="15n">n</a> = <var>1UL</var> &lt;&lt; <a class="local col0 ref" href="#10m" title='m' data-ref="10m" data-ref-filename="10m">m</a>;</td></tr>
<tr><th id="216">216</th><td>      <b>if</b> (<a class="local col8 ref" href="#28precy" title='precy' data-ref="28precy" data-ref-filename="28precy">precy</a> / <a class="local col9 ref" href="#9r" title='r' data-ref="9r" data-ref-filename="9r">r</a> &lt;= <a class="local col5 ref" href="#15n" title='n' data-ref="15n" data-ref-filename="15n">n</a>)</td></tr>
<tr><th id="217">217</th><td>        <a class="local col5 ref" href="#15n" title='n' data-ref="15n" data-ref-filename="15n">n</a> = (<a class="local col8 ref" href="#28precy" title='precy' data-ref="28precy" data-ref-filename="28precy">precy</a> / <a class="local col9 ref" href="#9r" title='r' data-ref="9r" data-ref-filename="9r">r</a>) + <var>1</var>;</td></tr>
<tr><th id="218">218</th><td>      <a class="macro" href="mpfr-impl.h.html#468" title="((void) (((__builtin_expect(!!(n != 0), 1))) || (mpfr_assert_fail (&quot;/___NETBSD_SRC___/objdir.amd64/external/lgpl3/mpfr/lib/libmpfr/../../../../../../external/lgpl3/mpfr/dist/src/atan.c&quot;, 218, &quot;n != 0&quot;),((void) 0),0)))" data-ref="_M/MPFR_ASSERTN">MPFR_ASSERTN</a> (<a class="local col5 ref" href="#15n" title='n' data-ref="15n" data-ref-filename="15n">n</a> != <var>0</var>);  <i>/* no overflow */</i></td></tr>
<tr><th id="219">219</th><td>      <b>for</b> (<a class="local col1 ref" href="#21i" title='i' data-ref="21i" data-ref-filename="21i">i</a> = <a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a> = <var>0</var>; <a class="local col1 ref" href="#21i" title='i' data-ref="21i" data-ref-filename="21i">i</a> &lt; <a class="local col5 ref" href="#15n" title='n' data-ref="15n" data-ref-filename="15n">n</a>; <a class="local col1 ref" href="#21i" title='i' data-ref="21i" data-ref-filename="21i">i</a> += <var>2</var>, <a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a> ++)</td></tr>
<tr><th id="220">220</th><td>        {</td></tr>
<tr><th id="221">221</th><td>          <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#1031" title="__gmpz_set_ui" data-ref="_M/mpz_set_ui">mpz_set_ui</a> (<a class="local col3 ref" href="#13Q" title='Q' data-ref="13Q" data-ref-filename="13Q">Q</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a> + <var>1</var>], <var>2</var> * <a class="local col1 ref" href="#21i" title='i' data-ref="21i" data-ref-filename="21i">i</a> + <var>3</var>);</td></tr>
<tr><th id="222">222</th><td>          <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#929" title="__gmpz_mul_2exp" data-ref="_M/mpz_mul_2exp">mpz_mul_2exp</a> (<a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>], <a class="local col3 ref" href="#13Q" title='Q' data-ref="13Q" data-ref-filename="13Q">Q</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>+<var>1</var>], <a class="local col9 ref" href="#9r" title='r' data-ref="9r" data-ref-filename="9r">r</a>);</td></tr>
<tr><th id="223">223</th><td>          <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#1054" title="__gmpz_sub_ui" data-ref="_M/mpz_sub_ui">mpz_sub_ui</a> (<a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>], <a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>], <var>1</var> + <var>2</var> * <a class="local col1 ref" href="#21i" title='i' data-ref="21i" data-ref-filename="21i">i</a>);</td></tr>
<tr><th id="224">224</th><td>          <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#935" title="__gmpz_mul_ui" data-ref="_M/mpz_mul_ui">mpz_mul_ui</a> (<a class="local col3 ref" href="#13Q" title='Q' data-ref="13Q" data-ref-filename="13Q">Q</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>], <a class="local col3 ref" href="#13Q" title='Q' data-ref="13Q" data-ref-filename="13Q">Q</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a> + <var>1</var>], <var>1</var> + <var>2</var> * <a class="local col1 ref" href="#21i" title='i' data-ref="21i" data-ref-filename="21i">i</a>);</td></tr>
<tr><th id="225">225</th><td>          <a class="local col7 ref" href="#27log2_nb_terms" title='log2_nb_terms' data-ref="27log2_nb_terms" data-ref-filename="27log2_nb_terms">log2_nb_terms</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>] = <var>1</var>; <i>/* S[k]/Q[k] corresponds to 2 terms */</i></td></tr>
<tr><th id="226">226</th><td>          <b>for</b> (<a class="local col7 ref" href="#17j" title='j' data-ref="17j" data-ref-filename="17j">j</a> = (<a class="local col1 ref" href="#21i" title='i' data-ref="21i" data-ref-filename="21i">i</a> + <var>2</var>) &gt;&gt; <var>1</var>, <a class="local col3 ref" href="#23l" title='l' data-ref="23l" data-ref-filename="23l">l</a> = <var>1</var>; (<a class="local col7 ref" href="#17j" title='j' data-ref="17j" data-ref-filename="17j">j</a> &amp; <var>1</var>) == <var>0</var>; <a class="local col3 ref" href="#23l" title='l' data-ref="23l" data-ref-filename="23l">l</a>++, <a class="local col7 ref" href="#17j" title='j' data-ref="17j" data-ref-filename="17j">j</a> &gt;&gt;= <var>1</var>, <a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a> --)</td></tr>
<tr><th id="227">227</th><td>            {</td></tr>
<tr><th id="228">228</th><td>              <a class="macro" href="mpfr-impl.h.html#489" title="((void) 0)" data-ref="_M/MPFR_ASSERTD">MPFR_ASSERTD</a> (k &gt; <var>0</var>);</td></tr>
<tr><th id="229">229</th><td>              <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#926" title="__gmpz_mul" data-ref="_M/mpz_mul">mpz_mul</a> (<a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>], <a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>], <a class="local col3 ref" href="#13Q" title='Q' data-ref="13Q" data-ref-filename="13Q">Q</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>-<var>1</var>]);</td></tr>
<tr><th id="230">230</th><td>              <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#926" title="__gmpz_mul" data-ref="_M/mpz_mul">mpz_mul</a> (<a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>-<var>1</var>], <a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>-<var>1</var>], <a class="local col3 ref" href="#13Q" title='Q' data-ref="13Q" data-ref-filename="13Q">Q</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>]);</td></tr>
<tr><th id="231">231</th><td>              <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#929" title="__gmpz_mul_2exp" data-ref="_M/mpz_mul_2exp">mpz_mul_2exp</a> (<a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>-<var>1</var>], <a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>-<var>1</var>], <a class="local col9 ref" href="#9r" title='r' data-ref="9r" data-ref-filename="9r">r</a> &lt;&lt; <a class="local col3 ref" href="#23l" title='l' data-ref="23l" data-ref-filename="23l">l</a>);</td></tr>
<tr><th id="232">232</th><td>              <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#624" title="__gmpz_add" data-ref="_M/mpz_add">mpz_add</a> (<a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>-<var>1</var>], <a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>-<var>1</var>], <a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>]);</td></tr>
<tr><th id="233">233</th><td>              <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#926" title="__gmpz_mul" data-ref="_M/mpz_mul">mpz_mul</a> (<a class="local col3 ref" href="#13Q" title='Q' data-ref="13Q" data-ref-filename="13Q">Q</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>-<var>1</var>], <a class="local col3 ref" href="#13Q" title='Q' data-ref="13Q" data-ref-filename="13Q">Q</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>-<var>1</var>], <a class="local col3 ref" href="#13Q" title='Q' data-ref="13Q" data-ref-filename="13Q">Q</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>]);</td></tr>
<tr><th id="234">234</th><td>              <a class="local col7 ref" href="#27log2_nb_terms" title='log2_nb_terms' data-ref="27log2_nb_terms" data-ref-filename="27log2_nb_terms">log2_nb_terms</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>-<var>1</var>] = <a class="local col3 ref" href="#23l" title='l' data-ref="23l" data-ref-filename="23l">l</a> + <var>1</var>;</td></tr>
<tr><th id="235">235</th><td>            }</td></tr>
<tr><th id="236">236</th><td>        }</td></tr>
<tr><th id="237">237</th><td>    }</td></tr>
<tr><th id="238">238</th><td></td></tr>
<tr><th id="239">239</th><td>  <i>/* we need to combine S[0]/Q[0]...S[k-1]/Q[k-1] */</i></td></tr>
<tr><th id="240">240</th><td>  <a class="local col6 ref" href="#16h" title='h' data-ref="16h" data-ref-filename="16h">h</a> = <var>0</var>; <i>/* number of terms accumulated in S[k]/Q[k] */</i></td></tr>
<tr><th id="241">241</th><td>  <b>while</b> (<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a> &gt; <var>1</var>)</td></tr>
<tr><th id="242">242</th><td>    {</td></tr>
<tr><th id="243">243</th><td>      <a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a> --;</td></tr>
<tr><th id="244">244</th><td>      <i>/* combine S[k-1]/Q[k-1] and S[k]/Q[k] */</i></td></tr>
<tr><th id="245">245</th><td>      <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#926" title="__gmpz_mul" data-ref="_M/mpz_mul">mpz_mul</a> (<a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>], <a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>], <a class="local col3 ref" href="#13Q" title='Q' data-ref="13Q" data-ref-filename="13Q">Q</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>-<var>1</var>]);</td></tr>
<tr><th id="246">246</th><td>      <b>if</b> (<a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#2244" title="(__builtin_constant_p (1) &amp;&amp; (1) == 0 ? ((p)-&gt;_mp_size &lt; 0 ? -1 : (p)-&gt;_mp_size &gt; 0) : __gmpz_cmp_ui (p,1))" data-ref="_M/mpz_cmp_ui">mpz_cmp_ui</a> (<a class="local col8 ref" href="#8p" title='p' data-ref="8p" data-ref-filename="8p">p</a>, <var>1</var>) != <var>0</var>)</td></tr>
<tr><th id="247">247</th><td>        <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#926" title="__gmpz_mul" data-ref="_M/mpz_mul">mpz_mul</a> (<a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>], <a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>], <a class="local col4 ref" href="#14ptoj" title='ptoj' data-ref="14ptoj" data-ref-filename="14ptoj">ptoj</a>[<a class="local col7 ref" href="#27log2_nb_terms" title='log2_nb_terms' data-ref="27log2_nb_terms" data-ref-filename="27log2_nb_terms">log2_nb_terms</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>-<var>1</var>]]);</td></tr>
<tr><th id="248">248</th><td>      <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#926" title="__gmpz_mul" data-ref="_M/mpz_mul">mpz_mul</a> (<a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>-<var>1</var>], <a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>-<var>1</var>], <a class="local col3 ref" href="#13Q" title='Q' data-ref="13Q" data-ref-filename="13Q">Q</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>]);</td></tr>
<tr><th id="249">249</th><td>      <a class="local col6 ref" href="#16h" title='h' data-ref="16h" data-ref-filename="16h">h</a> += (<a class="typedef" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#mp_bitcnt_t" title='mp_bitcnt_t' data-type='unsigned long' data-ref="mp_bitcnt_t" data-ref-filename="mp_bitcnt_t">mp_bitcnt_t</a>) <var>1</var> &lt;&lt; <a class="local col7 ref" href="#27log2_nb_terms" title='log2_nb_terms' data-ref="27log2_nb_terms" data-ref-filename="27log2_nb_terms">log2_nb_terms</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>];</td></tr>
<tr><th id="250">250</th><td>      <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#929" title="__gmpz_mul_2exp" data-ref="_M/mpz_mul_2exp">mpz_mul_2exp</a> (<a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>-<var>1</var>], <a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>-<var>1</var>], <a class="local col9 ref" href="#9r" title='r' data-ref="9r" data-ref-filename="9r">r</a> * <a class="local col6 ref" href="#16h" title='h' data-ref="16h" data-ref-filename="16h">h</a>);</td></tr>
<tr><th id="251">251</th><td>      <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#624" title="__gmpz_add" data-ref="_M/mpz_add">mpz_add</a> (<a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>-<var>1</var>], <a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>-<var>1</var>], <a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>]);</td></tr>
<tr><th id="252">252</th><td>      <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#926" title="__gmpz_mul" data-ref="_M/mpz_mul">mpz_mul</a> (<a class="local col3 ref" href="#13Q" title='Q' data-ref="13Q" data-ref-filename="13Q">Q</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>-<var>1</var>], <a class="local col3 ref" href="#13Q" title='Q' data-ref="13Q" data-ref-filename="13Q">Q</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>-<var>1</var>], <a class="local col3 ref" href="#13Q" title='Q' data-ref="13Q" data-ref-filename="13Q">Q</a>[<a class="local col2 ref" href="#22k" title='k' data-ref="22k" data-ref-filename="22k">k</a>]);</td></tr>
<tr><th id="253">253</th><td>    }</td></tr>
<tr><th id="254">254</th><td></td></tr>
<tr><th id="255">255</th><td>  <a class="macro" href="mpfr-impl.h.html#1418" title="do { int _cnt; mp_size_t _size; ((void) 0); _size = ((((S[0])-&gt;_mp_size)) &gt;= 0 ? (((S[0])-&gt;_mp_size)) : -(((S[0])-&gt;_mp_size))); ((void) 0); do { UDItype __cbtmp; ((void) 0); __asm__ (&quot;bsrq %1,%0&quot; : &quot;=r&quot; (__cbtmp) : &quot;rm&quot; ((UDItype)(((S[0])-&gt;_mp_d)[_size-1]))); (_cnt) = __cbtmp ^ 63; } while (0); (diff) = _size * (64 - 0) - _cnt; } while (0)" data-ref="_M/MPFR_MPZ_SIZEINBASE2">MPFR_MPZ_SIZEINBASE2</a> (<a class="local col8 ref" href="#18diff" title='diff' data-ref="18diff" data-ref-filename="18diff">diff</a>, <a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<var>0</var>]);</td></tr>
<tr><th id="256">256</th><td>  <a class="local col8 ref" href="#18diff" title='diff' data-ref="18diff" data-ref-filename="18diff">diff</a> -= <var>2</var> * <a class="local col8 ref" href="#28precy" title='precy' data-ref="28precy" data-ref-filename="28precy">precy</a>;</td></tr>
<tr><th id="257">257</th><td>  <a class="local col9 ref" href="#19expo" title='expo' data-ref="19expo" data-ref-filename="19expo">expo</a> = <a class="local col8 ref" href="#18diff" title='diff' data-ref="18diff" data-ref-filename="18diff">diff</a>;</td></tr>
<tr><th id="258">258</th><td>  <b>if</b> (<a class="local col8 ref" href="#18diff" title='diff' data-ref="18diff" data-ref-filename="18diff">diff</a> &gt;= <var>0</var>)</td></tr>
<tr><th id="259">259</th><td>    <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#1075" title="__gmpz_tdiv_q_2exp" data-ref="_M/mpz_tdiv_q_2exp">mpz_tdiv_q_2exp</a> (<a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<var>0</var>], <a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<var>0</var>], <a class="local col8 ref" href="#18diff" title='diff' data-ref="18diff" data-ref-filename="18diff">diff</a>);</td></tr>
<tr><th id="260">260</th><td>  <b>else</b></td></tr>
<tr><th id="261">261</th><td>    <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#929" title="__gmpz_mul_2exp" data-ref="_M/mpz_mul_2exp">mpz_mul_2exp</a> (<a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<var>0</var>], <a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<var>0</var>], -<a class="local col8 ref" href="#18diff" title='diff' data-ref="18diff" data-ref-filename="18diff">diff</a>);</td></tr>
<tr><th id="262">262</th><td></td></tr>
<tr><th id="263">263</th><td>  <a class="macro" href="mpfr-impl.h.html#1418" title="do { int _cnt; mp_size_t _size; ((void) 0); _size = ((((Q[0])-&gt;_mp_size)) &gt;= 0 ? (((Q[0])-&gt;_mp_size)) : -(((Q[0])-&gt;_mp_size))); ((void) 0); do { UDItype __cbtmp; ((void) 0); __asm__ (&quot;bsrq %1,%0&quot; : &quot;=r&quot; (__cbtmp) : &quot;rm&quot; ((UDItype)(((Q[0])-&gt;_mp_d)[_size-1]))); (_cnt) = __cbtmp ^ 63; } while (0); (diff) = _size * (64 - 0) - _cnt; } while (0)" data-ref="_M/MPFR_MPZ_SIZEINBASE2">MPFR_MPZ_SIZEINBASE2</a> (<a class="local col8 ref" href="#18diff" title='diff' data-ref="18diff" data-ref-filename="18diff">diff</a>, <a class="local col3 ref" href="#13Q" title='Q' data-ref="13Q" data-ref-filename="13Q">Q</a>[<var>0</var>]);</td></tr>
<tr><th id="264">264</th><td>  <a class="local col8 ref" href="#18diff" title='diff' data-ref="18diff" data-ref-filename="18diff">diff</a> -= <a class="local col8 ref" href="#28precy" title='precy' data-ref="28precy" data-ref-filename="28precy">precy</a>;</td></tr>
<tr><th id="265">265</th><td>  <a class="local col9 ref" href="#19expo" title='expo' data-ref="19expo" data-ref-filename="19expo">expo</a> -= <a class="local col8 ref" href="#18diff" title='diff' data-ref="18diff" data-ref-filename="18diff">diff</a>;</td></tr>
<tr><th id="266">266</th><td>  <b>if</b> (<a class="local col8 ref" href="#18diff" title='diff' data-ref="18diff" data-ref-filename="18diff">diff</a> &gt;= <var>0</var>)</td></tr>
<tr><th id="267">267</th><td>    <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#1075" title="__gmpz_tdiv_q_2exp" data-ref="_M/mpz_tdiv_q_2exp">mpz_tdiv_q_2exp</a> (<a class="local col3 ref" href="#13Q" title='Q' data-ref="13Q" data-ref-filename="13Q">Q</a>[<var>0</var>], <a class="local col3 ref" href="#13Q" title='Q' data-ref="13Q" data-ref-filename="13Q">Q</a>[<var>0</var>], <a class="local col8 ref" href="#18diff" title='diff' data-ref="18diff" data-ref-filename="18diff">diff</a>);</td></tr>
<tr><th id="268">268</th><td>  <b>else</b></td></tr>
<tr><th id="269">269</th><td>    <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#929" title="__gmpz_mul_2exp" data-ref="_M/mpz_mul_2exp">mpz_mul_2exp</a> (<a class="local col3 ref" href="#13Q" title='Q' data-ref="13Q" data-ref-filename="13Q">Q</a>[<var>0</var>], <a class="local col3 ref" href="#13Q" title='Q' data-ref="13Q" data-ref-filename="13Q">Q</a>[<var>0</var>], -<a class="local col8 ref" href="#18diff" title='diff' data-ref="18diff" data-ref-filename="18diff">diff</a>);</td></tr>
<tr><th id="270">270</th><td></td></tr>
<tr><th id="271">271</th><td>  <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#1072" title="__gmpz_tdiv_q" data-ref="_M/mpz_tdiv_q">mpz_tdiv_q</a> (<a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<var>0</var>], <a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<var>0</var>], <a class="local col3 ref" href="#13Q" title='Q' data-ref="13Q" data-ref-filename="13Q">Q</a>[<var>0</var>]);</td></tr>
<tr><th id="272">272</th><td>  <a class="ref fn" href="mpfr.h.html#mpfr_set_z" title='mpfr_set_z' data-ref="mpfr_set_z" data-ref-filename="mpfr_set_z">mpfr_set_z</a> (<a class="local col7 ref" href="#7y" title='y' data-ref="7y" data-ref-filename="7y">y</a>, <a class="local col2 ref" href="#12S" title='S' data-ref="12S" data-ref-filename="12S">S</a>[<var>0</var>], <a class="enum" href="mpfr.h.html#MPFR_RNDD" title='MPFR_RNDD' data-ref="MPFR_RNDD" data-ref-filename="MPFR_RNDD">MPFR_RNDD</a>);</td></tr>
<tr><th id="273">273</th><td>  <i>/* TODO: Check/prove that the following expression doesn't overflow. */</i></td></tr>
<tr><th id="274">274</th><td>  <a class="local col9 ref" href="#19expo" title='expo' data-ref="19expo" data-ref-filename="19expo">expo</a> = <a class="macro" href="mpfr-impl.h.html#925" title="((y)-&gt;_mpfr_exp)" data-ref="_M/MPFR_GET_EXP">MPFR_GET_EXP</a> (<a class="local col7 ref" href="#7y" title='y' data-ref="7y" data-ref-filename="7y">y</a>) + <a class="local col9 ref" href="#19expo" title='expo' data-ref="19expo" data-ref-filename="19expo">expo</a> - <a class="local col9 ref" href="#9r" title='r' data-ref="9r" data-ref-filename="9r">r</a> * (<a class="local col1 ref" href="#21i" title='i' data-ref="21i" data-ref-filename="21i">i</a> - <var>1</var>);</td></tr>
<tr><th id="275">275</th><td>  <a class="macro" href="mpfr-impl.h.html#926" title="((void) (((y)-&gt;_mpfr_exp) = (expo)))" data-ref="_M/MPFR_SET_EXP">MPFR_SET_EXP</a> (<a class="local col7 ref" href="#7y" title='y' data-ref="7y" data-ref-filename="7y">y</a>, <a class="local col9 ref" href="#19expo" title='expo' data-ref="19expo" data-ref-filename="19expo">expo</a>);</td></tr>
<tr><th id="276">276</th><td>}</td></tr>
<tr><th id="277">277</th><td></td></tr>
<tr><th id="278">278</th><td><em>int</em></td></tr>
<tr><th id="279">279</th><td><dfn class="decl def fn" id="mpfr_atan" title='mpfr_atan' data-ref="mpfr_atan" data-ref-filename="mpfr_atan">mpfr_atan</dfn> (<a class="typedef" href="mpfr.h.html#mpfr_ptr" title='mpfr_ptr' data-type='__mpfr_struct *' data-ref="mpfr_ptr" data-ref-filename="mpfr_ptr">mpfr_ptr</a> <dfn class="local col9 decl" id="29atan" title='atan' data-type='mpfr_ptr' data-ref="29atan" data-ref-filename="29atan">atan</dfn>, <a class="typedef" href="mpfr.h.html#mpfr_srcptr" title='mpfr_srcptr' data-type='const __mpfr_struct *' data-ref="mpfr_srcptr" data-ref-filename="mpfr_srcptr">mpfr_srcptr</a> <dfn class="local col0 decl" id="30x" title='x' data-type='mpfr_srcptr' data-ref="30x" data-ref-filename="30x">x</dfn>, <a class="typedef" href="mpfr.h.html#mpfr_rnd_t" title='mpfr_rnd_t' data-type='enum mpfr_rnd_t' data-ref="mpfr_rnd_t" data-ref-filename="mpfr_rnd_t">mpfr_rnd_t</a> <dfn class="local col1 decl" id="31rnd_mode" title='rnd_mode' data-type='mpfr_rnd_t' data-ref="31rnd_mode" data-ref-filename="31rnd_mode">rnd_mode</dfn>)</td></tr>
<tr><th id="280">280</th><td>{</td></tr>
<tr><th id="281">281</th><td>  <a class="typedef" href="mpfr.h.html#mpfr_t" title='mpfr_t' data-type='__mpfr_struct [1]' data-ref="mpfr_t" data-ref-filename="mpfr_t">mpfr_t</a> <dfn class="local col2 decl" id="32xp" title='xp' data-type='mpfr_t' data-ref="32xp" data-ref-filename="32xp">xp</dfn>, <dfn class="local col3 decl" id="33arctgt" title='arctgt' data-type='mpfr_t' data-ref="33arctgt" data-ref-filename="33arctgt">arctgt</dfn>, <dfn class="local col4 decl" id="34sk" title='sk' data-type='mpfr_t' data-ref="34sk" data-ref-filename="34sk">sk</dfn>, <dfn class="local col5 decl" id="35tmp" title='tmp' data-type='mpfr_t' data-ref="35tmp" data-ref-filename="35tmp">tmp</dfn>, <dfn class="local col6 decl" id="36tmp2" title='tmp2' data-type='mpfr_t' data-ref="36tmp2" data-ref-filename="36tmp2">tmp2</dfn>;</td></tr>
<tr><th id="282">282</th><td>  <a class="typedef" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#mpz_t" title='mpz_t' data-type='__mpz_struct [1]' data-ref="mpz_t" data-ref-filename="mpz_t">mpz_t</a>  <dfn class="local col7 decl" id="37ukz" title='ukz' data-type='mpz_t' data-ref="37ukz" data-ref-filename="37ukz">ukz</dfn>;</td></tr>
<tr><th id="283">283</th><td>  <a class="typedef" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#mpz_t" title='mpz_t' data-type='__mpz_struct [1]' data-ref="mpz_t" data-ref-filename="mpz_t">mpz_t</a> <dfn class="local col8 decl" id="38tabz" title='tabz' data-type='mpz_t [195]' data-ref="38tabz" data-ref-filename="38tabz">tabz</dfn>[<var>3</var>*(<a class="macro" href="mpfr-impl.h.html#2321" title="64" data-ref="_M/MPFR_PREC_BITS">MPFR_PREC_BITS</a>+<var>1</var>)];</td></tr>
<tr><th id="284">284</th><td>  <a class="typedef" href="mpfr.h.html#mpfr_exp_t" title='mpfr_exp_t' data-type='long' data-ref="mpfr_exp_t" data-ref-filename="mpfr_exp_t">mpfr_exp_t</a> <dfn class="local col9 decl" id="39exptol" title='exptol' data-type='mpfr_exp_t' data-ref="39exptol" data-ref-filename="39exptol">exptol</dfn>;</td></tr>
<tr><th id="285">285</th><td>  <a class="typedef" href="mpfr.h.html#mpfr_prec_t" title='mpfr_prec_t' data-type='long' data-ref="mpfr_prec_t" data-ref-filename="mpfr_prec_t">mpfr_prec_t</a> <dfn class="local col0 decl" id="40prec" title='prec' data-type='mpfr_prec_t' data-ref="40prec" data-ref-filename="40prec">prec</dfn>, <dfn class="local col1 decl" id="41realprec" title='realprec' data-type='mpfr_prec_t' data-ref="41realprec" data-ref-filename="41realprec">realprec</dfn>, <dfn class="local col2 decl" id="42est_lost" title='est_lost' data-type='mpfr_prec_t' data-ref="42est_lost" data-ref-filename="42est_lost">est_lost</dfn>, <dfn class="local col3 decl" id="43lost" title='lost' data-type='mpfr_prec_t' data-ref="43lost" data-ref-filename="43lost">lost</dfn>;</td></tr>
<tr><th id="286">286</th><td>  <em>unsigned</em> <em>long</em> <dfn class="local col4 decl" id="44twopoweri" title='twopoweri' data-type='unsigned long' data-ref="44twopoweri" data-ref-filename="44twopoweri">twopoweri</dfn>, <dfn class="local col5 decl" id="45log2p" title='log2p' data-type='unsigned long' data-ref="45log2p" data-ref-filename="45log2p">log2p</dfn>, <dfn class="local col6 decl" id="46red" title='red' data-type='unsigned long' data-ref="46red" data-ref-filename="46red">red</dfn>;</td></tr>
<tr><th id="287">287</th><td>  <em>int</em> <dfn class="local col7 decl" id="47comparaison" title='comparaison' data-type='int' data-ref="47comparaison" data-ref-filename="47comparaison">comparaison</dfn>, <dfn class="local col8 decl" id="48inexact" title='inexact' data-type='int' data-ref="48inexact" data-ref-filename="48inexact">inexact</dfn>;</td></tr>
<tr><th id="288">288</th><td>  <em>int</em> <dfn class="local col9 decl" id="49i" title='i' data-type='int' data-ref="49i" data-ref-filename="49i">i</dfn>, <dfn class="local col0 decl" id="50n0" title='n0' data-type='int' data-ref="50n0" data-ref-filename="50n0">n0</dfn>, <dfn class="local col1 decl" id="51oldn0" title='oldn0' data-type='int' data-ref="51oldn0" data-ref-filename="51oldn0">oldn0</dfn>;</td></tr>
<tr><th id="289">289</th><td>  <a class="macro" href="mpfr-impl.h.html#2021" title="struct mpfr_group_t group" data-ref="_M/MPFR_GROUP_DECL">MPFR_GROUP_DECL</a> (<dfn class="local col2 decl" id="52group" title='group' data-type='struct mpfr_group_t' data-ref="52group" data-ref-filename="52group">group</dfn>);</td></tr>
<tr><th id="290">290</th><td>  <a class="macro" href="mpfr-impl.h.html#1506" title="mpfr_save_expo_t expo" data-ref="_M/MPFR_SAVE_EXPO_DECL">MPFR_SAVE_EXPO_DECL</a> (<dfn class="local col3 decl" id="53expo" title='expo' data-type='mpfr_save_expo_t' data-ref="53expo" data-ref-filename="53expo">expo</dfn>);</td></tr>
<tr><th id="291">291</th><td>  <a class="macro" href="mpfr-impl.h.html#1827" title="mpfr_prec_t loop" data-ref="_M/MPFR_ZIV_DECL">MPFR_ZIV_DECL</a> (<dfn class="local col4 decl" id="54loop" title='loop' data-type='mpfr_prec_t' data-ref="54loop" data-ref-filename="54loop">loop</dfn>);</td></tr>
<tr><th id="292">292</th><td></td></tr>
<tr><th id="293">293</th><td>  <a class="macro" href="mpfr-impl.h.html#2002" title="" data-ref="_M/MPFR_LOG_FUNC">MPFR_LOG_FUNC</a></td></tr>
<tr><th id="294">294</th><td>    ((<q>"x[%Pu]=%.*Rg rnd=%d"</q>, mpfr_get_prec (x), mpfr_log_prec, x, rnd_mode),</td></tr>
<tr><th id="295">295</th><td>     (<q>"atan[%Pu]=%.*Rg inexact=%d"</q>,</td></tr>
<tr><th id="296">296</th><td>      mpfr_get_prec (atan), mpfr_log_prec, atan, inexact));</td></tr>
<tr><th id="297">297</th><td></td></tr>
<tr><th id="298">298</th><td>  <i>/* Singular cases */</i></td></tr>
<tr><th id="299">299</th><td>  <b>if</b> (<a class="macro" href="mpfr-impl.h.html#1283" title="(__builtin_expect(!!((((x)-&gt;_mpfr_exp) &lt;= (((-9223372036854775807L -1L))+3))), 0))" data-ref="_M/MPFR_UNLIKELY">MPFR_UNLIKELY</a> (<a class="macro" href="mpfr-impl.h.html#964" title="(((x)-&gt;_mpfr_exp) &lt;= (((-9223372036854775807L -1L))+3))" data-ref="_M/MPFR_IS_SINGULAR">MPFR_IS_SINGULAR</a> (<a class="local col0 ref" href="#30x" title='x' data-ref="30x" data-ref-filename="30x">x</a>)))</td></tr>
<tr><th id="300">300</th><td>    {</td></tr>
<tr><th id="301">301</th><td>      <b>if</b> (<a class="macro" href="mpfr-impl.h.html#945" title="(((x)-&gt;_mpfr_exp) == (((-9223372036854775807L -1L))+2))" data-ref="_M/MPFR_IS_NAN">MPFR_IS_NAN</a> (<a class="local col0 ref" href="#30x" title='x' data-ref="30x" data-ref-filename="30x">x</a>))</td></tr>
<tr><th id="302">302</th><td>        {</td></tr>
<tr><th id="303">303</th><td>          <a class="macro" href="mpfr-impl.h.html#946" title="(((atan)-&gt;_mpfr_exp) = (((-9223372036854775807L -1L))+2))" data-ref="_M/MPFR_SET_NAN">MPFR_SET_NAN</a> (<a class="local col9 ref" href="#29atan" title='atan' data-ref="29atan" data-ref-filename="29atan">atan</a>);</td></tr>
<tr><th id="304">304</th><td>          <a class="macro" href="mpfr-impl.h.html#1035" title="return (__gmpfr_flags |= 4), 0" data-ref="_M/MPFR_RET_NAN">MPFR_RET_NAN</a>;</td></tr>
<tr><th id="305">305</th><td>        }</td></tr>
<tr><th id="306">306</th><td>      <b>else</b> <b>if</b> (<a class="macro" href="mpfr-impl.h.html#947" title="(((x)-&gt;_mpfr_exp) == (((-9223372036854775807L -1L))+3))" data-ref="_M/MPFR_IS_INF">MPFR_IS_INF</a> (<a class="local col0 ref" href="#30x" title='x' data-ref="30x" data-ref-filename="30x">x</a>))</td></tr>
<tr><th id="307">307</th><td>        {</td></tr>
<tr><th id="308">308</th><td>          <a class="macro" href="mpfr-impl.h.html#1507" title="((expo).saved_flags = __gmpfr_flags, (expo).saved_emin = __gmpfr_emin, (expo).saved_emax = __gmpfr_emax, __gmpfr_emin = (1-((mpfr_exp_t) 1 &lt;&lt; ((64 - 0)*sizeof(mpfr_exp_t)/sizeof(mp_limb_t)-2))), __gmpfr_emax = (((mpfr_exp_t) 1 &lt;&lt; ((64 - 0)*sizeof(mpfr_exp_t)/sizeof(mp_limb_t)-2))-1))" data-ref="_M/MPFR_SAVE_EXPO_MARK">MPFR_SAVE_EXPO_MARK</a> (<a class="local col3 ref" href="#290" title='expo' data-ref="53expo" data-ref-filename="53expo">expo</a>);</td></tr>
<tr><th id="309">309</th><td>          <b>if</b> (<a class="macro" href="mpfr-impl.h.html#999" title="(((x)-&gt;_mpfr_sign) &gt; 0)" data-ref="_M/MPFR_IS_POS">MPFR_IS_POS</a> (<a class="local col0 ref" href="#30x" title='x' data-ref="30x" data-ref-filename="30x">x</a>))  <i>/* arctan(+inf) = Pi/2 */</i></td></tr>
<tr><th id="310">310</th><td>            <a class="local col8 ref" href="#48inexact" title='inexact' data-ref="48inexact" data-ref-filename="48inexact">inexact</a> = <a class="macro" href="mpfr-impl.h.html#1196" title="mpfr_cache(atan, __gmpfr_cache_const_pi,rnd_mode)" data-ref="_M/mpfr_const_pi">mpfr_const_pi</a> (<a class="local col9 ref" href="#29atan" title='atan' data-ref="29atan" data-ref-filename="29atan">atan</a>, <a class="local col1 ref" href="#31rnd_mode" title='rnd_mode' data-ref="31rnd_mode" data-ref-filename="31rnd_mode">rnd_mode</a>);</td></tr>
<tr><th id="311">311</th><td>          <b>else</b> <i>/* arctan(-inf) = -Pi/2 */</i></td></tr>
<tr><th id="312">312</th><td>            {</td></tr>
<tr><th id="313">313</th><td>              <a class="local col8 ref" href="#48inexact" title='inexact' data-ref="48inexact" data-ref-filename="48inexact">inexact</a> = -<a class="macro" href="mpfr-impl.h.html#1196" title="mpfr_cache(atan, __gmpfr_cache_const_pi,((rnd_mode) == MPFR_RNDU ? MPFR_RNDD : (rnd_mode) == MPFR_RNDD ? MPFR_RNDU : (rnd_mode)))" data-ref="_M/mpfr_const_pi">mpfr_const_pi</a> (<a class="local col9 ref" href="#29atan" title='atan' data-ref="29atan" data-ref-filename="29atan">atan</a>,</td></tr>
<tr><th id="314">314</th><td>                                        <a class="macro" href="mpfr-impl.h.html#1075" title="((rnd_mode) == MPFR_RNDU ? MPFR_RNDD : (rnd_mode) == MPFR_RNDD ? MPFR_RNDU : (rnd_mode))" data-ref="_M/MPFR_INVERT_RND">MPFR_INVERT_RND</a> (<a class="local col1 ref" href="#31rnd_mode" title='rnd_mode' data-ref="31rnd_mode" data-ref-filename="31rnd_mode">rnd_mode</a>));</td></tr>
<tr><th id="315">315</th><td>              <a class="macro" href="mpfr-impl.h.html#1004" title="(((atan)-&gt;_mpfr_sign) = -((atan)-&gt;_mpfr_sign))" data-ref="_M/MPFR_CHANGE_SIGN">MPFR_CHANGE_SIGN</a> (<a class="local col9 ref" href="#29atan" title='atan' data-ref="29atan" data-ref-filename="29atan">atan</a>);</td></tr>
<tr><th id="316">316</th><td>            }</td></tr>
<tr><th id="317">317</th><td>          <a class="ref fn" href="mpfr.h.html#mpfr_div_2ui" title='mpfr_div_2ui' data-ref="mpfr_div_2ui" data-ref-filename="mpfr_div_2ui">mpfr_div_2ui</a> (<a class="local col9 ref" href="#29atan" title='atan' data-ref="29atan" data-ref-filename="29atan">atan</a>, <a class="local col9 ref" href="#29atan" title='atan' data-ref="29atan" data-ref-filename="29atan">atan</a>, <var>1</var>, <a class="local col1 ref" href="#31rnd_mode" title='rnd_mode' data-ref="31rnd_mode" data-ref-filename="31rnd_mode">rnd_mode</a>);  <i>/* exact (no exceptions) */</i></td></tr>
<tr><th id="318">318</th><td>          <a class="macro" href="mpfr-impl.h.html#1513" title="(__gmpfr_flags = (expo).saved_flags, __gmpfr_emin = (expo).saved_emin, __gmpfr_emax = (expo).saved_emax)" data-ref="_M/MPFR_SAVE_EXPO_FREE">MPFR_SAVE_EXPO_FREE</a> (<a class="local col3 ref" href="#290" title='expo' data-ref="53expo" data-ref-filename="53expo">expo</a>);</td></tr>
<tr><th id="319">319</th><td>          <b>return</b> <a class="macro" href="mpfr-impl.h.html#1521" title="((__builtin_expect(!!((((void) 0), (((atan)-&gt;_mpfr_exp)) &gt;= __gmpfr_emin &amp;&amp; (((atan)-&gt;_mpfr_exp)) &lt;= __gmpfr_emax)), 1)) ? ((inexact) ? (__gmpfr_flags |= 8, (inexact)) : 0) : mpfr_check_range(atan,inexact,rnd_mode))" data-ref="_M/mpfr_check_range">mpfr_check_range</a> (<a class="local col9 ref" href="#29atan" title='atan' data-ref="29atan" data-ref-filename="29atan">atan</a>, <a class="local col8 ref" href="#48inexact" title='inexact' data-ref="48inexact" data-ref-filename="48inexact">inexact</a>, <a class="local col1 ref" href="#31rnd_mode" title='rnd_mode' data-ref="31rnd_mode" data-ref-filename="31rnd_mode">rnd_mode</a>);</td></tr>
<tr><th id="320">320</th><td>        }</td></tr>
<tr><th id="321">321</th><td>      <b>else</b> <i>/* x is necessarily 0 */</i></td></tr>
<tr><th id="322">322</th><td>        {</td></tr>
<tr><th id="323">323</th><td>          <a class="macro" href="mpfr-impl.h.html#489" title="((void) 0)" data-ref="_M/MPFR_ASSERTD">MPFR_ASSERTD</a> (<a class="macro" href="mpfr-impl.h.html#949" title="(((x)-&gt;_mpfr_exp) == (((-9223372036854775807L -1L))+1))" data-ref="_M/MPFR_IS_ZERO">MPFR_IS_ZERO</a> (x));</td></tr>
<tr><th id="324">324</th><td>          <a class="macro" href="mpfr-impl.h.html#950" title="(((atan)-&gt;_mpfr_exp) = (((-9223372036854775807L -1L))+1))" data-ref="_M/MPFR_SET_ZERO">MPFR_SET_ZERO</a> (<a class="local col9 ref" href="#29atan" title='atan' data-ref="29atan" data-ref-filename="29atan">atan</a>);</td></tr>
<tr><th id="325">325</th><td>          <a class="macro" href="mpfr-impl.h.html#1005" title="(((atan)-&gt;_mpfr_sign) = ((x)-&gt;_mpfr_sign))" data-ref="_M/MPFR_SET_SAME_SIGN">MPFR_SET_SAME_SIGN</a> (<a class="local col9 ref" href="#29atan" title='atan' data-ref="29atan" data-ref-filename="29atan">atan</a>, <a class="local col0 ref" href="#30x" title='x' data-ref="30x" data-ref-filename="30x">x</a>);</td></tr>
<tr><th id="326">326</th><td>          <a class="macro" href="mpfr-impl.h.html#1033" title="return (0) != 0 ? ((__gmpfr_flags |= 8), (0)) : 0" data-ref="_M/MPFR_RET">MPFR_RET</a> (<var>0</var>);</td></tr>
<tr><th id="327">327</th><td>        }</td></tr>
<tr><th id="328">328</th><td>    }</td></tr>
<tr><th id="329">329</th><td></td></tr>
<tr><th id="330">330</th><td>  <i>/* atan(x) = x - x^3/3 + x^5/5...</i></td></tr>
<tr><th id="331">331</th><td><i>     so the error is &lt; 2^(3*EXP(x)-1)</i></td></tr>
<tr><th id="332">332</th><td><i>     so `EXP(x)-(3*EXP(x)-1)` = -2*EXP(x)+1 */</i></td></tr>
<tr><th id="333">333</th><td>  <a class="macro" href="mpfr-impl.h.html#1758" title="do { mpfr_ptr _y = (atan); mpfr_exp_t _err1 = (-2 * ((x)-&gt;_mpfr_exp)); mpfr_exp_t _err2 = (1); if (_err1 &gt; 0) { mpfr_uexp_t _err = (mpfr_uexp_t) _err1 + _err2; if ((__builtin_expect(!!(_err &gt; ((_y)-&gt;_mpfr_prec) + 1), 0))) { int _inexact = mpfr_round_near_x (_y,(x),_err,(0),(rnd_mode)); if (_inexact != 0) { {}; return _inexact; } } } } while (0)" data-ref="_M/MPFR_FAST_COMPUTE_IF_SMALL_INPUT">MPFR_FAST_COMPUTE_IF_SMALL_INPUT</a> (<a class="local col9 ref" href="#29atan" title='atan' data-ref="29atan" data-ref-filename="29atan">atan</a>, <a class="local col0 ref" href="#30x" title='x' data-ref="30x" data-ref-filename="30x">x</a>, -<var>2</var> * <a class="macro" href="mpfr-impl.h.html#925" title="((x)-&gt;_mpfr_exp)" data-ref="_M/MPFR_GET_EXP">MPFR_GET_EXP</a> (<a class="local col0 ref" href="#30x" title='x' data-ref="30x" data-ref-filename="30x">x</a>), <var>1</var>, <var>0</var>,</td></tr>
<tr><th id="334">334</th><td>                                    <a class="local col1 ref" href="#31rnd_mode" title='rnd_mode' data-ref="31rnd_mode" data-ref-filename="31rnd_mode">rnd_mode</a>, {});</td></tr>
<tr><th id="335">335</th><td></td></tr>
<tr><th id="336">336</th><td>  <i>/* Set x_p=|x| */</i></td></tr>
<tr><th id="337">337</th><td>  <a class="macro" href="mpfr-impl.h.html#1178" title="( ((xp)-&gt;_mpfr_prec) = ((x)-&gt;_mpfr_prec), ((xp)-&gt;_mpfr_d) = ((x)-&gt;_mpfr_d), (((xp)-&gt;_mpfr_sign) = (1)), ((xp)-&gt;_mpfr_exp) = ((x)-&gt;_mpfr_exp))" data-ref="_M/MPFR_TMP_INIT_ABS">MPFR_TMP_INIT_ABS</a> (<a class="local col2 ref" href="#32xp" title='xp' data-ref="32xp" data-ref-filename="32xp">xp</a>, <a class="local col0 ref" href="#30x" title='x' data-ref="30x" data-ref-filename="30x">x</a>);</td></tr>
<tr><th id="338">338</th><td></td></tr>
<tr><th id="339">339</th><td>  <a class="macro" href="mpfr-impl.h.html#1507" title="((expo).saved_flags = __gmpfr_flags, (expo).saved_emin = __gmpfr_emin, (expo).saved_emax = __gmpfr_emax, __gmpfr_emin = (1-((mpfr_exp_t) 1 &lt;&lt; ((64 - 0)*sizeof(mpfr_exp_t)/sizeof(mp_limb_t)-2))), __gmpfr_emax = (((mpfr_exp_t) 1 &lt;&lt; ((64 - 0)*sizeof(mpfr_exp_t)/sizeof(mp_limb_t)-2))-1))" data-ref="_M/MPFR_SAVE_EXPO_MARK">MPFR_SAVE_EXPO_MARK</a> (<a class="local col3 ref" href="#290" title='expo' data-ref="53expo" data-ref-filename="53expo">expo</a>);</td></tr>
<tr><th id="340">340</th><td></td></tr>
<tr><th id="341">341</th><td>  <i>/* Other simple case arctan(-+1)=-+pi/4 */</i></td></tr>
<tr><th id="342">342</th><td>  <a class="local col7 ref" href="#47comparaison" title='comparaison' data-ref="47comparaison" data-ref-filename="47comparaison">comparaison</a> = <a class="macro" href="mpfr.h.html#872" title="(__builtin_constant_p (1) &amp;&amp; (mpfr_ulong) (1) == 0 ? (mpfr_sgn) (xp) : mpfr_cmp_ui_2exp ((xp), (1), 0))" data-ref="_M/mpfr_cmp_ui">mpfr_cmp_ui</a> (<a class="local col2 ref" href="#32xp" title='xp' data-ref="32xp" data-ref-filename="32xp">xp</a>, <var>1</var>);</td></tr>
<tr><th id="343">343</th><td>  <b>if</b> (<a class="macro" href="mpfr-impl.h.html#1283" title="(__builtin_expect(!!(comparaison == 0), 0))" data-ref="_M/MPFR_UNLIKELY">MPFR_UNLIKELY</a> (<a class="local col7 ref" href="#47comparaison" title='comparaison' data-ref="47comparaison" data-ref-filename="47comparaison">comparaison</a> == <var>0</var>))</td></tr>
<tr><th id="344">344</th><td>    {</td></tr>
<tr><th id="345">345</th><td>      <em>int</em> <dfn class="local col5 decl" id="55neg" title='neg' data-type='int' data-ref="55neg" data-ref-filename="55neg">neg</dfn> = <a class="macro" href="mpfr-impl.h.html#998" title="(((x)-&gt;_mpfr_sign) &lt; 0)" data-ref="_M/MPFR_IS_NEG">MPFR_IS_NEG</a> (<a class="local col0 ref" href="#30x" title='x' data-ref="30x" data-ref-filename="30x">x</a>);</td></tr>
<tr><th id="346">346</th><td>      <a class="local col8 ref" href="#48inexact" title='inexact' data-ref="48inexact" data-ref-filename="48inexact">inexact</a> = <a class="macro" href="mpfr-impl.h.html#1196" title="mpfr_cache(atan, __gmpfr_cache_const_pi,(((x)-&gt;_mpfr_sign) &gt; 0) ? rnd_mode : ((rnd_mode) == MPFR_RNDU ? MPFR_RNDD : (rnd_mode) == MPFR_RNDD ? MPFR_RNDU : (rnd_mode)))" data-ref="_M/mpfr_const_pi">mpfr_const_pi</a> (<a class="local col9 ref" href="#29atan" title='atan' data-ref="29atan" data-ref-filename="29atan">atan</a>, <a class="macro" href="mpfr-impl.h.html#999" title="(((x)-&gt;_mpfr_sign) &gt; 0)" data-ref="_M/MPFR_IS_POS">MPFR_IS_POS</a> (<a class="local col0 ref" href="#30x" title='x' data-ref="30x" data-ref-filename="30x">x</a>) ? <a class="local col1 ref" href="#31rnd_mode" title='rnd_mode' data-ref="31rnd_mode" data-ref-filename="31rnd_mode">rnd_mode</a></td></tr>
<tr><th id="347">347</th><td>                               : <a class="macro" href="mpfr-impl.h.html#1075" title="((rnd_mode) == MPFR_RNDU ? MPFR_RNDD : (rnd_mode) == MPFR_RNDD ? MPFR_RNDU : (rnd_mode))" data-ref="_M/MPFR_INVERT_RND">MPFR_INVERT_RND</a> (<a class="local col1 ref" href="#31rnd_mode" title='rnd_mode' data-ref="31rnd_mode" data-ref-filename="31rnd_mode">rnd_mode</a>));</td></tr>
<tr><th id="348">348</th><td>      <b>if</b> (<a class="local col5 ref" href="#55neg" title='neg' data-ref="55neg" data-ref-filename="55neg">neg</a>)</td></tr>
<tr><th id="349">349</th><td>        {</td></tr>
<tr><th id="350">350</th><td>          <a class="local col8 ref" href="#48inexact" title='inexact' data-ref="48inexact" data-ref-filename="48inexact">inexact</a> = -<a class="local col8 ref" href="#48inexact" title='inexact' data-ref="48inexact" data-ref-filename="48inexact">inexact</a>;</td></tr>
<tr><th id="351">351</th><td>          <a class="macro" href="mpfr-impl.h.html#1004" title="(((atan)-&gt;_mpfr_sign) = -((atan)-&gt;_mpfr_sign))" data-ref="_M/MPFR_CHANGE_SIGN">MPFR_CHANGE_SIGN</a> (<a class="local col9 ref" href="#29atan" title='atan' data-ref="29atan" data-ref-filename="29atan">atan</a>);</td></tr>
<tr><th id="352">352</th><td>        }</td></tr>
<tr><th id="353">353</th><td>      <a class="ref fn" href="mpfr.h.html#mpfr_div_2ui" title='mpfr_div_2ui' data-ref="mpfr_div_2ui" data-ref-filename="mpfr_div_2ui">mpfr_div_2ui</a> (<a class="local col9 ref" href="#29atan" title='atan' data-ref="29atan" data-ref-filename="29atan">atan</a>, <a class="local col9 ref" href="#29atan" title='atan' data-ref="29atan" data-ref-filename="29atan">atan</a>, <var>2</var>, <a class="local col1 ref" href="#31rnd_mode" title='rnd_mode' data-ref="31rnd_mode" data-ref-filename="31rnd_mode">rnd_mode</a>);  <i>/* exact (no exceptions) */</i></td></tr>
<tr><th id="354">354</th><td>      <a class="macro" href="mpfr-impl.h.html#1513" title="(__gmpfr_flags = (expo).saved_flags, __gmpfr_emin = (expo).saved_emin, __gmpfr_emax = (expo).saved_emax)" data-ref="_M/MPFR_SAVE_EXPO_FREE">MPFR_SAVE_EXPO_FREE</a> (<a class="local col3 ref" href="#290" title='expo' data-ref="53expo" data-ref-filename="53expo">expo</a>);</td></tr>
<tr><th id="355">355</th><td>      <b>return</b> <a class="macro" href="mpfr-impl.h.html#1521" title="((__builtin_expect(!!((((void) 0), (((atan)-&gt;_mpfr_exp)) &gt;= __gmpfr_emin &amp;&amp; (((atan)-&gt;_mpfr_exp)) &lt;= __gmpfr_emax)), 1)) ? ((inexact) ? (__gmpfr_flags |= 8, (inexact)) : 0) : mpfr_check_range(atan,inexact,rnd_mode))" data-ref="_M/mpfr_check_range">mpfr_check_range</a> (<a class="local col9 ref" href="#29atan" title='atan' data-ref="29atan" data-ref-filename="29atan">atan</a>, <a class="local col8 ref" href="#48inexact" title='inexact' data-ref="48inexact" data-ref-filename="48inexact">inexact</a>, <a class="local col1 ref" href="#31rnd_mode" title='rnd_mode' data-ref="31rnd_mode" data-ref-filename="31rnd_mode">rnd_mode</a>);</td></tr>
<tr><th id="356">356</th><td>    }</td></tr>
<tr><th id="357">357</th><td></td></tr>
<tr><th id="358">358</th><td>  <a class="local col1 ref" href="#41realprec" title='realprec' data-ref="41realprec" data-ref-filename="41realprec">realprec</a> = <a class="macro" href="mpfr-impl.h.html#831" title="((atan)-&gt;_mpfr_prec)" data-ref="_M/MPFR_PREC">MPFR_PREC</a> (<a class="local col9 ref" href="#29atan" title='atan' data-ref="29atan" data-ref-filename="29atan">atan</a>) + <a class="macro" href="mpfr-impl.h.html#1331" title="((__builtin_expect(!!((((atan)-&gt;_mpfr_prec)) == 1), 0)) ? 0 : __extension__ ({ int _b; mp_limb_t _limb; ((void) (((__builtin_expect(!!((((atan)-&gt;_mpfr_prec)) &gt; 1), 1))) || (mpfr_assert_fail (&quot;/___NETBSD_SRC___/objdir.amd64/external/lgpl3/mpfr/lib/libmpfr/../../../../../../external/lgpl3/mpfr/dist/src/atan.c&quot;, 358, &quot;(((atan)-&gt;_mpfr_prec)) &gt; 1&quot;),((void) 0),0))); _limb = (((atan)-&gt;_mpfr_prec)) - 1; ((void) (((__builtin_expect(!!(_limb == (((atan)-&gt;_mpfr_prec)) - 1), 1))) || (mpfr_assert_fail (&quot;/___NETBSD_SRC___/objdir.amd64/external/lgpl3/mpfr/lib/libmpfr/../../../../../../external/lgpl3/mpfr/dist/src/atan.c&quot;, 358, &quot;_limb == (((atan)-&gt;_mpfr_prec)) - 1&quot;),((void) 0),0))); do { UDItype __cbtmp; ((void) 0); __asm__ (&quot;bsrq %1,%0&quot; : &quot;=r&quot; (__cbtmp) : &quot;rm&quot; ((UDItype)(_limb))); (_b) = __cbtmp ^ 63; } while (0); ((64 - 0) - _b); }))" data-ref="_M/MPFR_INT_CEIL_LOG2">MPFR_INT_CEIL_LOG2</a> (<a class="macro" href="mpfr-impl.h.html#831" title="((atan)-&gt;_mpfr_prec)" data-ref="_M/MPFR_PREC">MPFR_PREC</a> (<a class="local col9 ref" href="#29atan" title='atan' data-ref="29atan" data-ref-filename="29atan">atan</a>)) + <var>4</var>;</td></tr>
<tr><th id="359">359</th><td>  <a class="local col0 ref" href="#40prec" title='prec' data-ref="40prec" data-ref-filename="40prec">prec</a> = <a class="local col1 ref" href="#41realprec" title='realprec' data-ref="41realprec" data-ref-filename="41realprec">realprec</a> + <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#46" title="(64 - 0)" data-ref="_M/GMP_NUMB_BITS">GMP_NUMB_BITS</a>;</td></tr>
<tr><th id="360">360</th><td></td></tr>
<tr><th id="361">361</th><td>  <i>/* Initialisation */</i></td></tr>
<tr><th id="362">362</th><td>  <a class="macro" href="mpfr-impl.h.html#2285" title="mpfr_mpz_init2" data-ref="_M/mpz_init2">mpz_init2</a> (<a class="local col7 ref" href="#37ukz" title='ukz' data-ref="37ukz" data-ref-filename="37ukz">ukz</a>, <a class="local col0 ref" href="#40prec" title='prec' data-ref="40prec" data-ref-filename="40prec">prec</a>); <i>/* ukz will need 'prec' bits below */</i></td></tr>
<tr><th id="363">363</th><td>  <a class="macro" href="mpfr-impl.h.html#2064" title="do { mpfr_prec_t _prec = (prec); mp_size_t _size; ((void) 0); if ((__builtin_expect(!!(_prec &gt; ((mpfr_prec_t) ((((mpfr_uprec_t) -1) &gt;&gt; 1) - 256))), 0))) mpfr_abort_prec_max (); _size = (((void) 0), ((_prec) - 1) / (64 - 0) + 1); if (_size * (4) &gt; 16) { (group).alloc = (4) * _size * sizeof (mp_limb_t); (group).mant = (mp_limb_t *) mpfr_allocate_func ((group).alloc); } else { (group).alloc = 0; (group).mant = (group).tab; } ; ( ((sk)-&gt;_mpfr_prec) = (_prec), ((sk)-&gt;_mpfr_d) = ((group).mant + _size * (0)), (((sk)-&gt;_mpfr_sign) = (1)), ((void) 0));( ((tmp)-&gt;_mpfr_prec) = (_prec), ((tmp)-&gt;_mpfr_d) = ((group).mant + _size * (1)), (((tmp)-&gt;_mpfr_sign) = (1)), ((void) 0)); ( ((tmp2)-&gt;_mpfr_prec) = (_prec), ((tmp2)-&gt;_mpfr_d) = ((group).mant + _size * (2)), (((tmp2)-&gt;_mpfr_sign) = (1)), ((void) 0));( ((arctgt)-&gt;_mpfr_prec) = (_prec), ((arctgt)-&gt;_mpfr_d) = ((group).mant + _size * (3)), (((arctgt)-&gt;_mpfr_sign) = (1)), ((void) 0)); } while (0)" data-ref="_M/MPFR_GROUP_INIT_4">MPFR_GROUP_INIT_4</a> (<a class="local col2 ref" href="#289" title='group' data-ref="52group" data-ref-filename="52group">group</a>, <a class="local col0 ref" href="#40prec" title='prec' data-ref="40prec" data-ref-filename="40prec">prec</a>, <a class="local col4 ref" href="#34sk" title='sk' data-ref="34sk" data-ref-filename="34sk">sk</a>, <a class="local col5 ref" href="#35tmp" title='tmp' data-ref="35tmp" data-ref-filename="35tmp">tmp</a>, <a class="local col6 ref" href="#36tmp2" title='tmp2' data-ref="36tmp2" data-ref-filename="36tmp2">tmp2</a>, <a class="local col3 ref" href="#33arctgt" title='arctgt' data-ref="33arctgt" data-ref-filename="33arctgt">arctgt</a>);</td></tr>
<tr><th id="364">364</th><td>  <a class="local col1 ref" href="#51oldn0" title='oldn0' data-ref="51oldn0" data-ref-filename="51oldn0">oldn0</a> = <var>0</var>;</td></tr>
<tr><th id="365">365</th><td></td></tr>
<tr><th id="366">366</th><td>  <a class="macro" href="mpfr-impl.h.html#1828" title="(loop) = (64 - 0)" data-ref="_M/MPFR_ZIV_INIT">MPFR_ZIV_INIT</a> (<a class="local col4 ref" href="#291" title='loop' data-ref="54loop" data-ref-filename="54loop">loop</a>, prec);</td></tr>
<tr><th id="367">367</th><td>  <b>for</b> (;;)</td></tr>
<tr><th id="368">368</th><td>    {</td></tr>
<tr><th id="369">369</th><td>      <i>/* First, if |x| &lt; 1, we need to have more prec to be able to round (sup)</i></td></tr>
<tr><th id="370">370</th><td><i>         n0 = ceil(log(prec_requested + 2 + 1+ln(2.4)/ln(2))/log(2)) */</i></td></tr>
<tr><th id="371">371</th><td>      <a class="typedef" href="mpfr.h.html#mpfr_prec_t" title='mpfr_prec_t' data-type='long' data-ref="mpfr_prec_t" data-ref-filename="mpfr_prec_t">mpfr_prec_t</a> <dfn class="local col6 decl" id="56sup" title='sup' data-type='mpfr_prec_t' data-ref="56sup" data-ref-filename="56sup">sup</dfn>;</td></tr>
<tr><th id="372">372</th><td>      <a class="local col6 ref" href="#56sup" title='sup' data-ref="56sup" data-ref-filename="56sup">sup</a> = <a class="macro" href="mpfr-impl.h.html#925" title="((xp)-&gt;_mpfr_exp)" data-ref="_M/MPFR_GET_EXP">MPFR_GET_EXP</a> (<a class="local col2 ref" href="#32xp" title='xp' data-ref="32xp" data-ref-filename="32xp">xp</a>) &lt; <var>0</var> ? <var>2</var> - <a class="macro" href="mpfr-impl.h.html#925" title="((xp)-&gt;_mpfr_exp)" data-ref="_M/MPFR_GET_EXP">MPFR_GET_EXP</a> (<a class="local col2 ref" href="#32xp" title='xp' data-ref="32xp" data-ref-filename="32xp">xp</a>) : <var>1</var>; <i>/* sup &gt;= 1 */</i></td></tr>
<tr><th id="373">373</th><td></td></tr>
<tr><th id="374">374</th><td>      <a class="local col0 ref" href="#50n0" title='n0' data-ref="50n0" data-ref-filename="50n0">n0</a> = <a class="macro" href="mpfr-impl.h.html#1331" title="((__builtin_expect(!!(((realprec + sup) + 3) == 1), 0)) ? 0 : __extension__ ({ int _b; mp_limb_t _limb; ((void) (((__builtin_expect(!!(((realprec + sup) + 3) &gt; 1), 1))) || (mpfr_assert_fail (&quot;/___NETBSD_SRC___/objdir.amd64/external/lgpl3/mpfr/lib/libmpfr/../../../../../../external/lgpl3/mpfr/dist/src/atan.c&quot;, 374, &quot;((realprec + sup) + 3) &gt; 1&quot;),((void) 0),0))); _limb = ((realprec + sup) + 3) - 1; ((void) (((__builtin_expect(!!(_limb == ((realprec + sup) + 3) - 1), 1))) || (mpfr_assert_fail (&quot;/___NETBSD_SRC___/objdir.amd64/external/lgpl3/mpfr/lib/libmpfr/../../../../../../external/lgpl3/mpfr/dist/src/atan.c&quot;, 374, &quot;_limb == ((realprec + sup) + 3) - 1&quot;),((void) 0),0))); do { UDItype __cbtmp; ((void) 0); __asm__ (&quot;bsrq %1,%0&quot; : &quot;=r&quot; (__cbtmp) : &quot;rm&quot; ((UDItype)(_limb))); (_b) = __cbtmp ^ 63; } while (0); ((64 - 0) - _b); }))" data-ref="_M/MPFR_INT_CEIL_LOG2">MPFR_INT_CEIL_LOG2</a> ((<a class="local col1 ref" href="#41realprec" title='realprec' data-ref="41realprec" data-ref-filename="41realprec">realprec</a> + <a class="local col6 ref" href="#56sup" title='sup' data-ref="56sup" data-ref-filename="56sup">sup</a>) + <var>3</var>);</td></tr>
<tr><th id="375">375</th><td>      <i>/* since realprec &gt;= 4, n0 &gt;= ceil(log2(8)) &gt;= 3, thus 3*n0 &gt; 2 */</i></td></tr>
<tr><th id="376">376</th><td>      <a class="local col0 ref" href="#40prec" title='prec' data-ref="40prec" data-ref-filename="40prec">prec</a> = (<a class="local col1 ref" href="#41realprec" title='realprec' data-ref="41realprec" data-ref-filename="41realprec">realprec</a> + <a class="local col6 ref" href="#56sup" title='sup' data-ref="56sup" data-ref-filename="56sup">sup</a>) + <var>1</var> + <a class="macro" href="mpfr-impl.h.html#1331" title="((__builtin_expect(!!((3*n0-2) == 1), 0)) ? 0 : __extension__ ({ int _b; mp_limb_t _limb; ((void) (((__builtin_expect(!!((3*n0-2) &gt; 1), 1))) || (mpfr_assert_fail (&quot;/___NETBSD_SRC___/objdir.amd64/external/lgpl3/mpfr/lib/libmpfr/../../../../../../external/lgpl3/mpfr/dist/src/atan.c&quot;, 376, &quot;(3*n0-2) &gt; 1&quot;),((void) 0),0))); _limb = (3*n0-2) - 1; ((void) (((__builtin_expect(!!(_limb == (3*n0-2) - 1), 1))) || (mpfr_assert_fail (&quot;/___NETBSD_SRC___/objdir.amd64/external/lgpl3/mpfr/lib/libmpfr/../../../../../../external/lgpl3/mpfr/dist/src/atan.c&quot;, 376, &quot;_limb == (3*n0-2) - 1&quot;),((void) 0),0))); do { UDItype __cbtmp; ((void) 0); __asm__ (&quot;bsrq %1,%0&quot; : &quot;=r&quot; (__cbtmp) : &quot;rm&quot; ((UDItype)(_limb))); (_b) = __cbtmp ^ 63; } while (0); ((64 - 0) - _b); }))" data-ref="_M/MPFR_INT_CEIL_LOG2">MPFR_INT_CEIL_LOG2</a> (<var>3</var>*<a class="local col0 ref" href="#50n0" title='n0' data-ref="50n0" data-ref-filename="50n0">n0</a>-<var>2</var>);</td></tr>
<tr><th id="377">377</th><td></td></tr>
<tr><th id="378">378</th><td>      <i>/* the number of lost bits due to argument reduction is</i></td></tr>
<tr><th id="379">379</th><td><i>         9 - 2 * EXP(sk), which we estimate by 9 + 2*ceil(log2(p))</i></td></tr>
<tr><th id="380">380</th><td><i>         since we manage that sk &lt; 1/p */</i></td></tr>
<tr><th id="381">381</th><td>      <b>if</b> (<a class="macro" href="mpfr-impl.h.html#831" title="((atan)-&gt;_mpfr_prec)" data-ref="_M/MPFR_PREC">MPFR_PREC</a> (<a class="local col9 ref" href="#29atan" title='atan' data-ref="29atan" data-ref-filename="29atan">atan</a>) &gt; <var>100</var>)</td></tr>
<tr><th id="382">382</th><td>        {</td></tr>
<tr><th id="383">383</th><td>          <a class="local col5 ref" href="#45log2p" title='log2p' data-ref="45log2p" data-ref-filename="45log2p">log2p</a> = <a class="macro" href="mpfr-impl.h.html#1331" title="((__builtin_expect(!!((prec) == 1), 0)) ? 0 : __extension__ ({ int _b; mp_limb_t _limb; ((void) (((__builtin_expect(!!((prec) &gt; 1), 1))) || (mpfr_assert_fail (&quot;/___NETBSD_SRC___/objdir.amd64/external/lgpl3/mpfr/lib/libmpfr/../../../../../../external/lgpl3/mpfr/dist/src/atan.c&quot;, 383, &quot;(prec) &gt; 1&quot;),((void) 0),0))); _limb = (prec) - 1; ((void) (((__builtin_expect(!!(_limb == (prec) - 1), 1))) || (mpfr_assert_fail (&quot;/___NETBSD_SRC___/objdir.amd64/external/lgpl3/mpfr/lib/libmpfr/../../../../../../external/lgpl3/mpfr/dist/src/atan.c&quot;, 383, &quot;_limb == (prec) - 1&quot;),((void) 0),0))); do { UDItype __cbtmp; ((void) 0); __asm__ (&quot;bsrq %1,%0&quot; : &quot;=r&quot; (__cbtmp) : &quot;rm&quot; ((UDItype)(_limb))); (_b) = __cbtmp ^ 63; } while (0); ((64 - 0) - _b); }))" data-ref="_M/MPFR_INT_CEIL_LOG2">MPFR_INT_CEIL_LOG2</a>(<a class="local col0 ref" href="#40prec" title='prec' data-ref="40prec" data-ref-filename="40prec">prec</a>) / <var>2</var> - <var>3</var>;</td></tr>
<tr><th id="384">384</th><td>          <a class="local col2 ref" href="#42est_lost" title='est_lost' data-ref="42est_lost" data-ref-filename="42est_lost">est_lost</a> = <var>9</var> + <var>2</var> * <a class="local col5 ref" href="#45log2p" title='log2p' data-ref="45log2p" data-ref-filename="45log2p">log2p</a>;</td></tr>
<tr><th id="385">385</th><td>          <a class="local col0 ref" href="#40prec" title='prec' data-ref="40prec" data-ref-filename="40prec">prec</a> += <a class="local col2 ref" href="#42est_lost" title='est_lost' data-ref="42est_lost" data-ref-filename="42est_lost">est_lost</a>;</td></tr>
<tr><th id="386">386</th><td>        }</td></tr>
<tr><th id="387">387</th><td>      <b>else</b></td></tr>
<tr><th id="388">388</th><td>        <a class="local col5 ref" href="#45log2p" title='log2p' data-ref="45log2p" data-ref-filename="45log2p">log2p</a> = <a class="local col2 ref" href="#42est_lost" title='est_lost' data-ref="42est_lost" data-ref-filename="42est_lost">est_lost</a> = <var>0</var>; <i>/* don't reduce the argument */</i></td></tr>
<tr><th id="389">389</th><td></td></tr>
<tr><th id="390">390</th><td>      <i>/* Initialisation */</i></td></tr>
<tr><th id="391">391</th><td>      <a class="macro" href="mpfr-impl.h.html#2109" title="do { mpfr_prec_t _prec = (prec); size_t _oalloc = (group).alloc; mp_size_t _size; ; ((void) 0); if ((__builtin_expect(!!(_prec &gt; ((mpfr_prec_t) ((((mpfr_uprec_t) -1) &gt;&gt; 1) - 256))), 0))) mpfr_abort_prec_max (); _size = (((void) 0), ((_prec) - 1) / (64 - 0) + 1); (group).alloc = (4) * _size * sizeof (mp_limb_t); if (_oalloc == 0) (group).mant = (mp_limb_t *) mpfr_allocate_func ((group).alloc); else (group).mant = (mp_limb_t *) mpfr_reallocate_func ((group).mant, _oalloc, (group).alloc); ; ( ((sk)-&gt;_mpfr_prec) = (_prec), ((sk)-&gt;_mpfr_d) = ((group).mant + _size * (0)), (((sk)-&gt;_mpfr_sign) = (1)), ((void) 0));( ((tmp)-&gt;_mpfr_prec) = (_prec), ((tmp)-&gt;_mpfr_d) = ((group).mant + _size * (1)), (((tmp)-&gt;_mpfr_sign) = (1)), ((void) 0)); ( ((tmp2)-&gt;_mpfr_prec) = (_prec), ((tmp2)-&gt;_mpfr_d) = ((group).mant + _size * (2)), (((tmp2)-&gt;_mpfr_sign) = (1)), ((void) 0));( ((arctgt)-&gt;_mpfr_prec) = (_prec), ((arctgt)-&gt;_mpfr_d) = ((group).mant + _size * (3)), (((arctgt)-&gt;_mpfr_sign) = (1)), ((void) 0)); } while (0)" data-ref="_M/MPFR_GROUP_REPREC_4">MPFR_GROUP_REPREC_4</a> (<a class="local col2 ref" href="#289" title='group' data-ref="52group" data-ref-filename="52group">group</a>, <a class="local col0 ref" href="#40prec" title='prec' data-ref="40prec" data-ref-filename="40prec">prec</a>, <a class="local col4 ref" href="#34sk" title='sk' data-ref="34sk" data-ref-filename="34sk">sk</a>, <a class="local col5 ref" href="#35tmp" title='tmp' data-ref="35tmp" data-ref-filename="35tmp">tmp</a>, <a class="local col6 ref" href="#36tmp2" title='tmp2' data-ref="36tmp2" data-ref-filename="36tmp2">tmp2</a>, <a class="local col3 ref" href="#33arctgt" title='arctgt' data-ref="33arctgt" data-ref-filename="33arctgt">arctgt</a>);</td></tr>
<tr><th id="392">392</th><td>      <a class="macro" href="mpfr-impl.h.html#489" title="((void) 0)" data-ref="_M/MPFR_ASSERTD">MPFR_ASSERTD</a> (n0 &lt;= <a class="macro" href="mpfr-impl.h.html#2321" title="64" data-ref="_M/MPFR_PREC_BITS">MPFR_PREC_BITS</a>);</td></tr>
<tr><th id="393">393</th><td>      <i>/* Note: the tabz[] entries are used to get a rational approximation</i></td></tr>
<tr><th id="394">394</th><td><i>         of atan(x) to precision 'prec', thus allocating them to 'prec' bits</i></td></tr>
<tr><th id="395">395</th><td><i>         should be good enough. */</i></td></tr>
<tr><th id="396">396</th><td>      <b>for</b> (<a class="local col9 ref" href="#49i" title='i' data-ref="49i" data-ref-filename="49i">i</a> = <a class="local col1 ref" href="#51oldn0" title='oldn0' data-ref="51oldn0" data-ref-filename="51oldn0">oldn0</a>; <a class="local col9 ref" href="#49i" title='i' data-ref="49i" data-ref-filename="49i">i</a> &lt; <var>3</var> * (<a class="local col0 ref" href="#50n0" title='n0' data-ref="50n0" data-ref-filename="50n0">n0</a> + <var>1</var>); <a class="local col9 ref" href="#49i" title='i' data-ref="49i" data-ref-filename="49i">i</a>++)</td></tr>
<tr><th id="397">397</th><td>        <a class="macro" href="mpfr-impl.h.html#2285" title="mpfr_mpz_init2" data-ref="_M/mpz_init2">mpz_init2</a> (<a class="local col8 ref" href="#38tabz" title='tabz' data-ref="38tabz" data-ref-filename="38tabz">tabz</a>[<a class="local col9 ref" href="#49i" title='i' data-ref="49i" data-ref-filename="49i">i</a>], <a class="local col0 ref" href="#40prec" title='prec' data-ref="40prec" data-ref-filename="40prec">prec</a>);</td></tr>
<tr><th id="398">398</th><td>      <a class="local col1 ref" href="#51oldn0" title='oldn0' data-ref="51oldn0" data-ref-filename="51oldn0">oldn0</a> = <var>3</var> * (<a class="local col0 ref" href="#50n0" title='n0' data-ref="50n0" data-ref-filename="50n0">n0</a> + <var>1</var>);</td></tr>
<tr><th id="399">399</th><td></td></tr>
<tr><th id="400">400</th><td>      <i>/* The mpfr_ui_div below mustn't underflow. This is guaranteed by</i></td></tr>
<tr><th id="401">401</th><td><i>         MPFR_SAVE_EXPO_MARK, but let's check that for maintainability. */</i></td></tr>
<tr><th id="402">402</th><td>      <a class="macro" href="mpfr-impl.h.html#489" title="((void) 0)" data-ref="_M/MPFR_ASSERTD">MPFR_ASSERTD</a> (__gmpfr_emax &lt;= <var>1</var> - __gmpfr_emin);</td></tr>
<tr><th id="403">403</th><td></td></tr>
<tr><th id="404">404</th><td>      <b>if</b> (<a class="local col7 ref" href="#47comparaison" title='comparaison' data-ref="47comparaison" data-ref-filename="47comparaison">comparaison</a> &gt; <var>0</var>) <i>/* use atan(xp) = Pi/2 - atan(1/xp) */</i></td></tr>
<tr><th id="405">405</th><td>        <a class="ref fn" href="mpfr.h.html#mpfr_ui_div" title='mpfr_ui_div' data-ref="mpfr_ui_div" data-ref-filename="mpfr_ui_div">mpfr_ui_div</a> (<a class="local col4 ref" href="#34sk" title='sk' data-ref="34sk" data-ref-filename="34sk">sk</a>, <var>1</var>, <a class="local col2 ref" href="#32xp" title='xp' data-ref="32xp" data-ref-filename="32xp">xp</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="406">406</th><td>      <b>else</b></td></tr>
<tr><th id="407">407</th><td>        <a class="macro" href="mpfr.h.html#825" title="mpfr_set4(sk,xp,MPFR_RNDN,((xp)-&gt;_mpfr_sign))" data-ref="_M/mpfr_set">mpfr_set</a> (<a class="local col4 ref" href="#34sk" title='sk' data-ref="34sk" data-ref-filename="34sk">sk</a>, <a class="local col2 ref" href="#32xp" title='xp' data-ref="32xp" data-ref-filename="32xp">xp</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="408">408</th><td></td></tr>
<tr><th id="409">409</th><td>      <i>/* now 0 &lt; sk &lt;= 1 */</i></td></tr>
<tr><th id="410">410</th><td></td></tr>
<tr><th id="411">411</th><td>      <i>/* Argument reduction: atan(x) = 2 atan((sqrt(1+x^2)-1)/x).</i></td></tr>
<tr><th id="412">412</th><td><i>         We want |sk| &lt; k/sqrt(p) where p is the target precision. */</i></td></tr>
<tr><th id="413">413</th><td>      <a class="local col3 ref" href="#43lost" title='lost' data-ref="43lost" data-ref-filename="43lost">lost</a> = <var>0</var>;</td></tr>
<tr><th id="414">414</th><td>      <b>for</b> (<a class="local col6 ref" href="#46red" title='red' data-ref="46red" data-ref-filename="46red">red</a> = <var>0</var>; <a class="macro" href="mpfr-impl.h.html#925" title="((sk)-&gt;_mpfr_exp)" data-ref="_M/MPFR_GET_EXP">MPFR_GET_EXP</a>(<a class="local col4 ref" href="#34sk" title='sk' data-ref="34sk" data-ref-filename="34sk">sk</a>) &gt; - (<a class="typedef" href="mpfr.h.html#mpfr_exp_t" title='mpfr_exp_t' data-type='long' data-ref="mpfr_exp_t" data-ref-filename="mpfr_exp_t">mpfr_exp_t</a>) <a class="local col5 ref" href="#45log2p" title='log2p' data-ref="45log2p" data-ref-filename="45log2p">log2p</a>; <a class="local col6 ref" href="#46red" title='red' data-ref="46red" data-ref-filename="46red">red</a> ++)</td></tr>
<tr><th id="415">415</th><td>        {</td></tr>
<tr><th id="416">416</th><td>          <a class="local col3 ref" href="#43lost" title='lost' data-ref="43lost" data-ref-filename="43lost">lost</a> = <var>9</var> - <var>2</var> * <a class="macro" href="mpfr-impl.h.html#832" title="((sk)-&gt;_mpfr_exp)" data-ref="_M/MPFR_EXP">MPFR_EXP</a>(<a class="local col4 ref" href="#34sk" title='sk' data-ref="34sk" data-ref-filename="34sk">sk</a>);</td></tr>
<tr><th id="417">417</th><td>          <a class="ref fn" href="mpfr.h.html#mpfr_sqr" title='mpfr_sqr' data-ref="mpfr_sqr" data-ref-filename="mpfr_sqr">mpfr_sqr</a> (<a class="local col5 ref" href="#35tmp" title='tmp' data-ref="35tmp" data-ref-filename="35tmp">tmp</a>, <a class="local col4 ref" href="#34sk" title='sk' data-ref="34sk" data-ref-filename="34sk">sk</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="418">418</th><td>          <a class="ref fn" href="mpfr.h.html#mpfr_add_ui" title='mpfr_add_ui' data-ref="mpfr_add_ui" data-ref-filename="mpfr_add_ui">mpfr_add_ui</a> (<a class="local col5 ref" href="#35tmp" title='tmp' data-ref="35tmp" data-ref-filename="35tmp">tmp</a>, <a class="local col5 ref" href="#35tmp" title='tmp' data-ref="35tmp" data-ref-filename="35tmp">tmp</a>, <var>1</var>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="419">419</th><td>          <a class="ref fn" href="mpfr.h.html#mpfr_sqrt" title='mpfr_sqrt' data-ref="mpfr_sqrt" data-ref-filename="mpfr_sqrt">mpfr_sqrt</a> (<a class="local col5 ref" href="#35tmp" title='tmp' data-ref="35tmp" data-ref-filename="35tmp">tmp</a>, <a class="local col5 ref" href="#35tmp" title='tmp' data-ref="35tmp" data-ref-filename="35tmp">tmp</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="420">420</th><td>          <a class="ref fn" href="mpfr.h.html#mpfr_sub_ui" title='mpfr_sub_ui' data-ref="mpfr_sub_ui" data-ref-filename="mpfr_sub_ui">mpfr_sub_ui</a> (<a class="local col5 ref" href="#35tmp" title='tmp' data-ref="35tmp" data-ref-filename="35tmp">tmp</a>, <a class="local col5 ref" href="#35tmp" title='tmp' data-ref="35tmp" data-ref-filename="35tmp">tmp</a>, <var>1</var>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="421">421</th><td>          <b>if</b> (<a class="local col6 ref" href="#46red" title='red' data-ref="46red" data-ref-filename="46red">red</a> == <var>0</var> &amp;&amp; <a class="local col7 ref" href="#47comparaison" title='comparaison' data-ref="47comparaison" data-ref-filename="47comparaison">comparaison</a> &gt; <var>0</var>)</td></tr>
<tr><th id="422">422</th><td>            <i>/* use xp = 1/sk */</i></td></tr>
<tr><th id="423">423</th><td>            <a class="ref fn" href="mpfr.h.html#mpfr_mul" title='mpfr_mul' data-ref="mpfr_mul" data-ref-filename="mpfr_mul">mpfr_mul</a> (<a class="local col4 ref" href="#34sk" title='sk' data-ref="34sk" data-ref-filename="34sk">sk</a>, <a class="local col5 ref" href="#35tmp" title='tmp' data-ref="35tmp" data-ref-filename="35tmp">tmp</a>, <a class="local col2 ref" href="#32xp" title='xp' data-ref="32xp" data-ref-filename="32xp">xp</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="424">424</th><td>          <b>else</b></td></tr>
<tr><th id="425">425</th><td>            <a class="ref fn" href="mpfr.h.html#mpfr_div" title='mpfr_div' data-ref="mpfr_div" data-ref-filename="mpfr_div">mpfr_div</a> (<a class="local col4 ref" href="#34sk" title='sk' data-ref="34sk" data-ref-filename="34sk">sk</a>, <a class="local col5 ref" href="#35tmp" title='tmp' data-ref="35tmp" data-ref-filename="35tmp">tmp</a>, <a class="local col4 ref" href="#34sk" title='sk' data-ref="34sk" data-ref-filename="34sk">sk</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="426">426</th><td>        }</td></tr>
<tr><th id="427">427</th><td></td></tr>
<tr><th id="428">428</th><td>      <i>/* We started from x0 = 1/|x| if |x| &gt; 1, and |x| otherwise, thus</i></td></tr>
<tr><th id="429">429</th><td><i>         we had x0 = min(|x|, 1/|x|) &lt;= 1, and applied 'red' times the</i></td></tr>
<tr><th id="430">430</th><td><i>         argument reduction x -&gt; (sqrt(1+x^2)-1)/x, which keeps 0 &lt; x &lt;= 1 */</i></td></tr>
<tr><th id="431">431</th><td></td></tr>
<tr><th id="432">432</th><td>      <i>/* We first show that if the for-loop is executed at least once, then</i></td></tr>
<tr><th id="433">433</th><td><i>         sk &lt; 1 after the loop. Indeed for 1/2 &lt;= x &lt;= 1, interval</i></td></tr>
<tr><th id="434">434</th><td><i>         arithmetic with precision 5 shows that (sqrt(1+x^2)-1)/x,</i></td></tr>
<tr><th id="435">435</th><td><i>         when evaluated with rounding to nearest, gives a value &lt;= 0.875.</i></td></tr>
<tr><th id="436">436</th><td><i>         Now assume 2^(-k-1) &lt;= x &lt;= 2^(-k) for k &gt;= 1.</i></td></tr>
<tr><th id="437">437</th><td><i>         Then o(x^2) &lt;= 2^(-2k), o(1+x^2) &lt;= 1+2^(-2k),</i></td></tr>
<tr><th id="438">438</th><td><i>         o(sqrt(1+x^2)) &lt;= 1+2^(-2k-1), o(sqrt(1+x^2)-1) &lt;= 2^(-2k-1),</i></td></tr>
<tr><th id="439">439</th><td><i>         and o((sqrt(1+x^2)-1)/x) &lt;= 2^(-k) &lt;= 1/2.</i></td></tr>
<tr><th id="440">440</th><td><i></i></td></tr>
<tr><th id="441">441</th><td><i>         Now if sk=1 before the loop, then EXP(sk)=1 and since log2p &gt;= 0,</i></td></tr>
<tr><th id="442">442</th><td><i>         the loop is performed at least once, thus the case sk=1 cannot</i></td></tr>
<tr><th id="443">443</th><td><i>         happen below.</i></td></tr>
<tr><th id="444">444</th><td><i>      */</i></td></tr>
<tr><th id="445">445</th><td></td></tr>
<tr><th id="446">446</th><td>      <a class="macro" href="mpfr-impl.h.html#489" title="((void) 0)" data-ref="_M/MPFR_ASSERTD">MPFR_ASSERTD</a>(<a class="macro" href="mpfr.h.html#872" title="(__builtin_constant_p (1) &amp;&amp; (mpfr_ulong) (1) == 0 ? (mpfr_sgn) (sk) : mpfr_cmp_ui_2exp ((sk), (1), 0))" data-ref="_M/mpfr_cmp_ui">mpfr_cmp_ui</a> (sk, <var>1</var>) &lt; <var>0</var>);</td></tr>
<tr><th id="447">447</th><td></td></tr>
<tr><th id="448">448</th><td>      <i>/* Assignation  */</i></td></tr>
<tr><th id="449">449</th><td>      <a class="macro" href="mpfr-impl.h.html#950" title="(((arctgt)-&gt;_mpfr_exp) = (((-9223372036854775807L -1L))+1))" data-ref="_M/MPFR_SET_ZERO">MPFR_SET_ZERO</a> (<a class="local col3 ref" href="#33arctgt" title='arctgt' data-ref="33arctgt" data-ref-filename="33arctgt">arctgt</a>);</td></tr>
<tr><th id="450">450</th><td>      <a class="local col4 ref" href="#44twopoweri" title='twopoweri' data-ref="44twopoweri" data-ref-filename="44twopoweri">twopoweri</a> = <var>1</var> &lt;&lt; <var>0</var>;</td></tr>
<tr><th id="451">451</th><td>      <a class="macro" href="mpfr-impl.h.html#489" title="((void) 0)" data-ref="_M/MPFR_ASSERTD">MPFR_ASSERTD</a> (n0 &gt;= <var>4</var>);</td></tr>
<tr><th id="452">452</th><td>      <b>for</b> (<a class="local col9 ref" href="#49i" title='i' data-ref="49i" data-ref-filename="49i">i</a> = <var>0</var> ; <a class="local col9 ref" href="#49i" title='i' data-ref="49i" data-ref-filename="49i">i</a> &lt; <a class="local col0 ref" href="#50n0" title='n0' data-ref="50n0" data-ref-filename="50n0">n0</a>; <a class="local col9 ref" href="#49i" title='i' data-ref="49i" data-ref-filename="49i">i</a>++)</td></tr>
<tr><th id="453">453</th><td>        {</td></tr>
<tr><th id="454">454</th><td>          <b>if</b> (<a class="macro" href="mpfr-impl.h.html#1283" title="(__builtin_expect(!!((((sk)-&gt;_mpfr_exp) == (((-9223372036854775807L -1L))+1))), 0))" data-ref="_M/MPFR_UNLIKELY">MPFR_UNLIKELY</a> (<a class="macro" href="mpfr-impl.h.html#949" title="(((sk)-&gt;_mpfr_exp) == (((-9223372036854775807L -1L))+1))" data-ref="_M/MPFR_IS_ZERO">MPFR_IS_ZERO</a> (<a class="local col4 ref" href="#34sk" title='sk' data-ref="34sk" data-ref-filename="34sk">sk</a>)))</td></tr>
<tr><th id="455">455</th><td>            <b>break</b>;</td></tr>
<tr><th id="456">456</th><td>          <i>/* Calculation of trunc(tmp) --&gt; mpz */</i></td></tr>
<tr><th id="457">457</th><td>          <a class="ref fn" href="mpfr.h.html#mpfr_mul_2ui" title='mpfr_mul_2ui' data-ref="mpfr_mul_2ui" data-ref-filename="mpfr_mul_2ui">mpfr_mul_2ui</a> (<a class="local col5 ref" href="#35tmp" title='tmp' data-ref="35tmp" data-ref-filename="35tmp">tmp</a>, <a class="local col4 ref" href="#34sk" title='sk' data-ref="34sk" data-ref-filename="34sk">sk</a>, <a class="local col4 ref" href="#44twopoweri" title='twopoweri' data-ref="44twopoweri" data-ref-filename="44twopoweri">twopoweri</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="458">458</th><td>          <a class="macro" href="mpfr.h.html#819" title="mpfr_rint((tmp), (tmp), MPFR_RNDZ)" data-ref="_M/mpfr_trunc">mpfr_trunc</a> (<a class="local col5 ref" href="#35tmp" title='tmp' data-ref="35tmp" data-ref-filename="35tmp">tmp</a>, <a class="local col5 ref" href="#35tmp" title='tmp' data-ref="35tmp" data-ref-filename="35tmp">tmp</a>);</td></tr>
<tr><th id="459">459</th><td>          <b>if</b> (!<a class="macro" href="mpfr-impl.h.html#949" title="(((tmp)-&gt;_mpfr_exp) == (((-9223372036854775807L -1L))+1))" data-ref="_M/MPFR_IS_ZERO">MPFR_IS_ZERO</a> (<a class="local col5 ref" href="#35tmp" title='tmp' data-ref="35tmp" data-ref-filename="35tmp">tmp</a>))</td></tr>
<tr><th id="460">460</th><td>            {</td></tr>
<tr><th id="461">461</th><td>              <i>/* tmp = ukz*2^exptol */</i></td></tr>
<tr><th id="462">462</th><td>              <a class="local col9 ref" href="#39exptol" title='exptol' data-ref="39exptol" data-ref-filename="39exptol">exptol</a> = <a class="ref fn" href="mpfr.h.html#mpfr_get_z_2exp" title='mpfr_get_z_2exp' data-ref="mpfr_get_z_2exp" data-ref-filename="mpfr_get_z_2exp">mpfr_get_z_2exp</a> (<a class="local col7 ref" href="#37ukz" title='ukz' data-ref="37ukz" data-ref-filename="37ukz">ukz</a>, <a class="local col5 ref" href="#35tmp" title='tmp' data-ref="35tmp" data-ref-filename="35tmp">tmp</a>);</td></tr>
<tr><th id="463">463</th><td>              <i>/* since the s_k are decreasing (see algorithms.tex),</i></td></tr>
<tr><th id="464">464</th><td><i>                 and s_0 = min(|x|, 1/|x|) &lt; 1, we have sk &lt; 1,</i></td></tr>
<tr><th id="465">465</th><td><i>                 thus exptol &lt; 0 */</i></td></tr>
<tr><th id="466">466</th><td>              <a class="macro" href="mpfr-impl.h.html#489" title="((void) 0)" data-ref="_M/MPFR_ASSERTD">MPFR_ASSERTD</a> (exptol &lt; <var>0</var>);</td></tr>
<tr><th id="467">467</th><td>              <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#1075" title="__gmpz_tdiv_q_2exp" data-ref="_M/mpz_tdiv_q_2exp">mpz_tdiv_q_2exp</a> (<a class="local col7 ref" href="#37ukz" title='ukz' data-ref="37ukz" data-ref-filename="37ukz">ukz</a>, <a class="local col7 ref" href="#37ukz" title='ukz' data-ref="37ukz" data-ref-filename="37ukz">ukz</a>, (<em>unsigned</em> <em>long</em> <em>int</em>) (-<a class="local col9 ref" href="#39exptol" title='exptol' data-ref="39exptol" data-ref-filename="39exptol">exptol</a>));</td></tr>
<tr><th id="468">468</th><td>              <i>/* since tmp is a non-zero integer, and tmp = ukzold*2^exptol,</i></td></tr>
<tr><th id="469">469</th><td><i>                 we now have ukz = tmp, thus ukz is non-zero */</i></td></tr>
<tr><th id="470">470</th><td>              <i>/* Calculation of arctan(Ak) */</i></td></tr>
<tr><th id="471">471</th><td>              <a class="ref fn" href="mpfr.h.html#mpfr_set_z" title='mpfr_set_z' data-ref="mpfr_set_z" data-ref-filename="mpfr_set_z">mpfr_set_z</a> (<a class="local col5 ref" href="#35tmp" title='tmp' data-ref="35tmp" data-ref-filename="35tmp">tmp</a>, <a class="local col7 ref" href="#37ukz" title='ukz' data-ref="37ukz" data-ref-filename="37ukz">ukz</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="472">472</th><td>              <a class="ref fn" href="mpfr.h.html#mpfr_div_2ui" title='mpfr_div_2ui' data-ref="mpfr_div_2ui" data-ref-filename="mpfr_div_2ui">mpfr_div_2ui</a> (<a class="local col5 ref" href="#35tmp" title='tmp' data-ref="35tmp" data-ref-filename="35tmp">tmp</a>, <a class="local col5 ref" href="#35tmp" title='tmp' data-ref="35tmp" data-ref-filename="35tmp">tmp</a>, <a class="local col4 ref" href="#44twopoweri" title='twopoweri' data-ref="44twopoweri" data-ref-filename="44twopoweri">twopoweri</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="473">473</th><td>              <a class="tu ref fn" href="#mpfr_atan_aux" title='mpfr_atan_aux' data-use='c' data-ref="mpfr_atan_aux" data-ref-filename="mpfr_atan_aux">mpfr_atan_aux</a> (<a class="local col6 ref" href="#36tmp2" title='tmp2' data-ref="36tmp2" data-ref-filename="36tmp2">tmp2</a>, <a class="local col7 ref" href="#37ukz" title='ukz' data-ref="37ukz" data-ref-filename="37ukz">ukz</a>, <a class="local col4 ref" href="#44twopoweri" title='twopoweri' data-ref="44twopoweri" data-ref-filename="44twopoweri">twopoweri</a>, <a class="local col0 ref" href="#50n0" title='n0' data-ref="50n0" data-ref-filename="50n0">n0</a> - <a class="local col9 ref" href="#49i" title='i' data-ref="49i" data-ref-filename="49i">i</a>, <a class="local col8 ref" href="#38tabz" title='tabz' data-ref="38tabz" data-ref-filename="38tabz">tabz</a>);</td></tr>
<tr><th id="474">474</th><td>              <a class="ref fn" href="mpfr.h.html#mpfr_mul" title='mpfr_mul' data-ref="mpfr_mul" data-ref-filename="mpfr_mul">mpfr_mul</a> (<a class="local col6 ref" href="#36tmp2" title='tmp2' data-ref="36tmp2" data-ref-filename="36tmp2">tmp2</a>, <a class="local col6 ref" href="#36tmp2" title='tmp2' data-ref="36tmp2" data-ref-filename="36tmp2">tmp2</a>, <a class="local col5 ref" href="#35tmp" title='tmp' data-ref="35tmp" data-ref-filename="35tmp">tmp</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="475">475</th><td>              <i>/* Addition */</i></td></tr>
<tr><th id="476">476</th><td>              <a class="ref fn" href="mpfr.h.html#mpfr_add" title='mpfr_add' data-ref="mpfr_add" data-ref-filename="mpfr_add">mpfr_add</a> (<a class="local col3 ref" href="#33arctgt" title='arctgt' data-ref="33arctgt" data-ref-filename="33arctgt">arctgt</a>, <a class="local col3 ref" href="#33arctgt" title='arctgt' data-ref="33arctgt" data-ref-filename="33arctgt">arctgt</a>, <a class="local col6 ref" href="#36tmp2" title='tmp2' data-ref="36tmp2" data-ref-filename="36tmp2">tmp2</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="477">477</th><td>              <i>/* Next iteration */</i></td></tr>
<tr><th id="478">478</th><td>              <a class="ref fn" href="mpfr.h.html#mpfr_sub" title='mpfr_sub' data-ref="mpfr_sub" data-ref-filename="mpfr_sub">mpfr_sub</a> (<a class="local col6 ref" href="#36tmp2" title='tmp2' data-ref="36tmp2" data-ref-filename="36tmp2">tmp2</a>, <a class="local col4 ref" href="#34sk" title='sk' data-ref="34sk" data-ref-filename="34sk">sk</a>, <a class="local col5 ref" href="#35tmp" title='tmp' data-ref="35tmp" data-ref-filename="35tmp">tmp</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="479">479</th><td>              <a class="ref fn" href="mpfr.h.html#mpfr_mul" title='mpfr_mul' data-ref="mpfr_mul" data-ref-filename="mpfr_mul">mpfr_mul</a> (<a class="local col4 ref" href="#34sk" title='sk' data-ref="34sk" data-ref-filename="34sk">sk</a>, <a class="local col4 ref" href="#34sk" title='sk' data-ref="34sk" data-ref-filename="34sk">sk</a>, <a class="local col5 ref" href="#35tmp" title='tmp' data-ref="35tmp" data-ref-filename="35tmp">tmp</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="480">480</th><td>              <a class="ref fn" href="mpfr.h.html#mpfr_add_ui" title='mpfr_add_ui' data-ref="mpfr_add_ui" data-ref-filename="mpfr_add_ui">mpfr_add_ui</a> (<a class="local col4 ref" href="#34sk" title='sk' data-ref="34sk" data-ref-filename="34sk">sk</a>, <a class="local col4 ref" href="#34sk" title='sk' data-ref="34sk" data-ref-filename="34sk">sk</a>, <var>1</var>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="481">481</th><td>              <a class="ref fn" href="mpfr.h.html#mpfr_div" title='mpfr_div' data-ref="mpfr_div" data-ref-filename="mpfr_div">mpfr_div</a> (<a class="local col4 ref" href="#34sk" title='sk' data-ref="34sk" data-ref-filename="34sk">sk</a>, <a class="local col6 ref" href="#36tmp2" title='tmp2' data-ref="36tmp2" data-ref-filename="36tmp2">tmp2</a>, <a class="local col4 ref" href="#34sk" title='sk' data-ref="34sk" data-ref-filename="34sk">sk</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="482">482</th><td>            }</td></tr>
<tr><th id="483">483</th><td>          <a class="local col4 ref" href="#44twopoweri" title='twopoweri' data-ref="44twopoweri" data-ref-filename="44twopoweri">twopoweri</a> &lt;&lt;= <var>1</var>;</td></tr>
<tr><th id="484">484</th><td>        }</td></tr>
<tr><th id="485">485</th><td>      <i>/* Add last step (Arctan(sk) ~= sk */</i></td></tr>
<tr><th id="486">486</th><td>      <a class="ref fn" href="mpfr.h.html#mpfr_add" title='mpfr_add' data-ref="mpfr_add" data-ref-filename="mpfr_add">mpfr_add</a> (<a class="local col3 ref" href="#33arctgt" title='arctgt' data-ref="33arctgt" data-ref-filename="33arctgt">arctgt</a>, <a class="local col3 ref" href="#33arctgt" title='arctgt' data-ref="33arctgt" data-ref-filename="33arctgt">arctgt</a>, <a class="local col4 ref" href="#34sk" title='sk' data-ref="34sk" data-ref-filename="34sk">sk</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="487">487</th><td></td></tr>
<tr><th id="488">488</th><td>      <i>/* argument reduction */</i></td></tr>
<tr><th id="489">489</th><td>      <a class="macro" href="mpfr.h.html#831" title="mpfr_mul_2ui((arctgt),(arctgt),(red),(MPFR_RNDN))" data-ref="_M/mpfr_mul_2exp">mpfr_mul_2exp</a> (<a class="local col3 ref" href="#33arctgt" title='arctgt' data-ref="33arctgt" data-ref-filename="33arctgt">arctgt</a>, <a class="local col3 ref" href="#33arctgt" title='arctgt' data-ref="33arctgt" data-ref-filename="33arctgt">arctgt</a>, <a class="local col6 ref" href="#46red" title='red' data-ref="46red" data-ref-filename="46red">red</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="490">490</th><td></td></tr>
<tr><th id="491">491</th><td>      <b>if</b> (<a class="local col7 ref" href="#47comparaison" title='comparaison' data-ref="47comparaison" data-ref-filename="47comparaison">comparaison</a> &gt; <var>0</var>)</td></tr>
<tr><th id="492">492</th><td>        { <i>/* atan(x) = Pi/2-atan(1/x) for x &gt; 0 */</i></td></tr>
<tr><th id="493">493</th><td>          <a class="macro" href="mpfr-impl.h.html#1196" title="mpfr_cache(tmp, __gmpfr_cache_const_pi,MPFR_RNDN)" data-ref="_M/mpfr_const_pi">mpfr_const_pi</a> (<a class="local col5 ref" href="#35tmp" title='tmp' data-ref="35tmp" data-ref-filename="35tmp">tmp</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="494">494</th><td>          <a class="ref fn" href="mpfr.h.html#mpfr_div_2ui" title='mpfr_div_2ui' data-ref="mpfr_div_2ui" data-ref-filename="mpfr_div_2ui">mpfr_div_2ui</a> (<a class="local col5 ref" href="#35tmp" title='tmp' data-ref="35tmp" data-ref-filename="35tmp">tmp</a>, <a class="local col5 ref" href="#35tmp" title='tmp' data-ref="35tmp" data-ref-filename="35tmp">tmp</a>, <var>1</var>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="495">495</th><td>          <a class="ref fn" href="mpfr.h.html#mpfr_sub" title='mpfr_sub' data-ref="mpfr_sub" data-ref-filename="mpfr_sub">mpfr_sub</a> (<a class="local col3 ref" href="#33arctgt" title='arctgt' data-ref="33arctgt" data-ref-filename="33arctgt">arctgt</a>, <a class="local col5 ref" href="#35tmp" title='tmp' data-ref="35tmp" data-ref-filename="35tmp">tmp</a>, <a class="local col3 ref" href="#33arctgt" title='arctgt' data-ref="33arctgt" data-ref-filename="33arctgt">arctgt</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="496">496</th><td>        }</td></tr>
<tr><th id="497">497</th><td>      <a class="macro" href="mpfr-impl.h.html#1001" title="(((arctgt)-&gt;_mpfr_sign) = (1))" data-ref="_M/MPFR_SET_POS">MPFR_SET_POS</a> (<a class="local col3 ref" href="#33arctgt" title='arctgt' data-ref="33arctgt" data-ref-filename="33arctgt">arctgt</a>);</td></tr>
<tr><th id="498">498</th><td></td></tr>
<tr><th id="499">499</th><td>      <b>if</b> (<a class="macro" href="mpfr-impl.h.html#1282" title="(__builtin_expect(!!((!(((arctgt)-&gt;_mpfr_exp) &lt;= (((-9223372036854775807L -1L))+3)) &amp;&amp; mpfr_round_p (((arctgt)-&gt;_mpfr_d), ((((((void) 0), (((arctgt)-&gt;_mpfr_prec))) - 1) / (64 - 0)) + 1), (realprec + est_lost - lost), (((atan)-&gt;_mpfr_prec)) + ((rnd_mode)==MPFR_RNDN)))), 1))" data-ref="_M/MPFR_LIKELY">MPFR_LIKELY</a> (<a class="macro" href="mpfr-impl.h.html#1711" title="(!(((arctgt)-&gt;_mpfr_exp) &lt;= (((-9223372036854775807L -1L))+3)) &amp;&amp; mpfr_round_p (((arctgt)-&gt;_mpfr_d), ((((((void) 0), (((arctgt)-&gt;_mpfr_prec))) - 1) / (64 - 0)) + 1), (realprec + est_lost - lost), (((atan)-&gt;_mpfr_prec)) + ((rnd_mode)==MPFR_RNDN)))" data-ref="_M/MPFR_CAN_ROUND">MPFR_CAN_ROUND</a> (<a class="local col3 ref" href="#33arctgt" title='arctgt' data-ref="33arctgt" data-ref-filename="33arctgt">arctgt</a>, <a class="local col1 ref" href="#41realprec" title='realprec' data-ref="41realprec" data-ref-filename="41realprec">realprec</a> + <a class="local col2 ref" href="#42est_lost" title='est_lost' data-ref="42est_lost" data-ref-filename="42est_lost">est_lost</a> - <a class="local col3 ref" href="#43lost" title='lost' data-ref="43lost" data-ref-filename="43lost">lost</a>,</td></tr>
<tr><th id="500">500</th><td>                                       <a class="macro" href="mpfr-impl.h.html#831" title="((atan)-&gt;_mpfr_prec)" data-ref="_M/MPFR_PREC">MPFR_PREC</a> (<a class="local col9 ref" href="#29atan" title='atan' data-ref="29atan" data-ref-filename="29atan">atan</a>), <a class="local col1 ref" href="#31rnd_mode" title='rnd_mode' data-ref="31rnd_mode" data-ref-filename="31rnd_mode">rnd_mode</a>)))</td></tr>
<tr><th id="501">501</th><td>        <b>break</b>;</td></tr>
<tr><th id="502">502</th><td>      <a class="macro" href="mpfr-impl.h.html#1829" title="((realprec) = (((void) (((__builtin_expect(!!((loop) &lt;= ((mpfr_prec_t) ((((mpfr_uprec_t) -1) &gt;&gt; 1) - 256)) - (realprec)), 1))) || (mpfr_assert_fail (&quot;/___NETBSD_SRC___/objdir.amd64/external/lgpl3/mpfr/lib/libmpfr/../../../../../../external/lgpl3/mpfr/dist/src/atan.c&quot;, 502, &quot;(loop) &lt;= ((mpfr_prec_t) ((((mpfr_uprec_t) -1) &gt;&gt; 1) - 256)) - (realprec)&quot;),((void) 0),0))), (realprec) + (loop)), (loop) = (realprec)/2)" data-ref="_M/MPFR_ZIV_NEXT">MPFR_ZIV_NEXT</a> (<a class="local col4 ref" href="#291" title='loop' data-ref="54loop" data-ref-filename="54loop">loop</a>, <a class="local col1 ref" href="#41realprec" title='realprec' data-ref="41realprec" data-ref-filename="41realprec">realprec</a>);</td></tr>
<tr><th id="503">503</th><td>    }</td></tr>
<tr><th id="504">504</th><td>  <a class="macro" href="mpfr-impl.h.html#1830" title="" data-ref="_M/MPFR_ZIV_FREE">MPFR_ZIV_FREE</a> (loop);</td></tr>
<tr><th id="505">505</th><td></td></tr>
<tr><th id="506">506</th><td>  <a class="local col8 ref" href="#48inexact" title='inexact' data-ref="48inexact" data-ref-filename="48inexact">inexact</a> = <a class="ref fn" href="mpfr.h.html#mpfr_set4" title='mpfr_set4' data-ref="mpfr_set4" data-ref-filename="mpfr_set4">mpfr_set4</a> (<a class="local col9 ref" href="#29atan" title='atan' data-ref="29atan" data-ref-filename="29atan">atan</a>, <a class="local col3 ref" href="#33arctgt" title='arctgt' data-ref="33arctgt" data-ref-filename="33arctgt">arctgt</a>, <a class="local col1 ref" href="#31rnd_mode" title='rnd_mode' data-ref="31rnd_mode" data-ref-filename="31rnd_mode">rnd_mode</a>, <a class="macro" href="mpfr.h.html#239" title="((x)-&gt;_mpfr_sign)" data-ref="_M/MPFR_SIGN">MPFR_SIGN</a> (<a class="local col0 ref" href="#30x" title='x' data-ref="30x" data-ref-filename="30x">x</a>));</td></tr>
<tr><th id="507">507</th><td></td></tr>
<tr><th id="508">508</th><td>  <b>for</b> (<a class="local col9 ref" href="#49i" title='i' data-ref="49i" data-ref-filename="49i">i</a> = <var>0</var> ; <a class="local col9 ref" href="#49i" title='i' data-ref="49i" data-ref-filename="49i">i</a> &lt; <a class="local col1 ref" href="#51oldn0" title='oldn0' data-ref="51oldn0" data-ref-filename="51oldn0">oldn0</a> ; <a class="local col9 ref" href="#49i" title='i' data-ref="49i" data-ref-filename="49i">i</a>++)</td></tr>
<tr><th id="509">509</th><td>    <a class="macro" href="mpfr-impl.h.html#2286" title="mpfr_mpz_clear" data-ref="_M/mpz_clear">mpz_clear</a> (<a class="local col8 ref" href="#38tabz" title='tabz' data-ref="38tabz" data-ref-filename="38tabz">tabz</a>[<a class="local col9 ref" href="#49i" title='i' data-ref="49i" data-ref-filename="49i">i</a>]);</td></tr>
<tr><th id="510">510</th><td>  <a class="macro" href="mpfr-impl.h.html#2286" title="mpfr_mpz_clear" data-ref="_M/mpz_clear">mpz_clear</a> (<a class="local col7 ref" href="#37ukz" title='ukz' data-ref="37ukz" data-ref-filename="37ukz">ukz</a>);</td></tr>
<tr><th id="511">511</th><td>  <a class="macro" href="mpfr-impl.h.html#2022" title="do { ; if ((group).alloc != 0) { ((void) 0); mpfr_free_func ((group).mant, (group).alloc); }} while (0)" data-ref="_M/MPFR_GROUP_CLEAR">MPFR_GROUP_CLEAR</a> (<a class="local col2 ref" href="#289" title='group' data-ref="52group" data-ref-filename="52group">group</a>);</td></tr>
<tr><th id="512">512</th><td></td></tr>
<tr><th id="513">513</th><td>  <a class="macro" href="mpfr-impl.h.html#1513" title="(__gmpfr_flags = (expo).saved_flags, __gmpfr_emin = (expo).saved_emin, __gmpfr_emax = (expo).saved_emax)" data-ref="_M/MPFR_SAVE_EXPO_FREE">MPFR_SAVE_EXPO_FREE</a> (<a class="local col3 ref" href="#290" title='expo' data-ref="53expo" data-ref-filename="53expo">expo</a>);</td></tr>
<tr><th id="514">514</th><td>  <b>return</b> <a class="macro" href="mpfr-impl.h.html#1521" title="((__builtin_expect(!!((((void) 0), (((atan)-&gt;_mpfr_exp)) &gt;= __gmpfr_emin &amp;&amp; (((atan)-&gt;_mpfr_exp)) &lt;= __gmpfr_emax)), 1)) ? ((inexact) ? (__gmpfr_flags |= 8, (inexact)) : 0) : mpfr_check_range(atan,inexact,rnd_mode))" data-ref="_M/mpfr_check_range">mpfr_check_range</a> (<a class="local col9 ref" href="#29atan" title='atan' data-ref="29atan" data-ref-filename="29atan">atan</a>, <a class="local col8 ref" href="#48inexact" title='inexact' data-ref="48inexact" data-ref-filename="48inexact">inexact</a>, <a class="local col1 ref" href="#31rnd_mode" title='rnd_mode' data-ref="31rnd_mode" data-ref-filename="31rnd_mode">rnd_mode</a>);</td></tr>
<tr><th id="515">515</th><td>}</td></tr>
<tr><th id="516">516</th><td></td></tr>
</table><hr/><p id='footer'>
Generated on <em>2019-Jul-19</em> from project netbsd revision <em>f9da89e0d</em><br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 2.1
<br/>Generator usage only permitted with license.</p>
</div></body></html>
