<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>lngamma.c source code [netbsd/external/lgpl3/mpfr/dist/src/lngamma.c] - Woboq Code Browser</title>
<link rel="stylesheet" href="https://code.woboq.org/data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="https://code.woboq.org/data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="https://code.woboq.org/data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="https://code.woboq.org/data/jquery/jquery-ui.min.js"></script>
<script>var file = 'netbsd/external/lgpl3/mpfr/dist/src/lngamma.c'; var root_path = '../../../../../..'; var data_path = 'https://code.woboq.org/data'; var ecma_script_api_version = 2;</script>
<script src='https://code.woboq.org/data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='../../../../..'>netbsd</a>/<a href='../../../..'>external</a>/<a href='../../..'>lgpl3</a>/<a href='../..'>mpfr</a>/<a href='..'>dist</a>/<a href='./'>src</a>/<a href='lngamma.c.html'>lngamma.c</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>/* mpfr_lngamma -- lngamma function</i></td></tr>
<tr><th id="2">2</th><td><i></i></td></tr>
<tr><th id="3">3</th><td><i>Copyright 2005-2018 Free Software Foundation, Inc.</i></td></tr>
<tr><th id="4">4</th><td><i>Contributed by the AriC and Caramba projects, INRIA.</i></td></tr>
<tr><th id="5">5</th><td><i></i></td></tr>
<tr><th id="6">6</th><td><i>This file is part of the GNU MPFR Library.</i></td></tr>
<tr><th id="7">7</th><td><i></i></td></tr>
<tr><th id="8">8</th><td><i>The GNU MPFR Library is free software; you can redistribute it and/or modify</i></td></tr>
<tr><th id="9">9</th><td><i>it under the terms of the GNU Lesser General Public License as published by</i></td></tr>
<tr><th id="10">10</th><td><i>the Free Software Foundation; either version 3 of the License, or (at your</i></td></tr>
<tr><th id="11">11</th><td><i>option) any later version.</i></td></tr>
<tr><th id="12">12</th><td><i></i></td></tr>
<tr><th id="13">13</th><td><i>The GNU MPFR Library is distributed in the hope that it will be useful, but</i></td></tr>
<tr><th id="14">14</th><td><i>WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY</i></td></tr>
<tr><th id="15">15</th><td><i>or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public</i></td></tr>
<tr><th id="16">16</th><td><i>License for more details.</i></td></tr>
<tr><th id="17">17</th><td><i></i></td></tr>
<tr><th id="18">18</th><td><i>You should have received a copy of the GNU Lesser General Public License</i></td></tr>
<tr><th id="19">19</th><td><i>along with the GNU MPFR Library; see the file COPYING.LESSER.  If not, see</i></td></tr>
<tr><th id="20">20</th><td><i>http://www.gnu.org/licenses/ or write to the Free Software Foundation, Inc.,</i></td></tr>
<tr><th id="21">21</th><td><i>51 Franklin St, Fifth Floor, Boston, MA 02110-1301, USA. */</i></td></tr>
<tr><th id="22">22</th><td></td></tr>
<tr><th id="23">23</th><td><u>#define <dfn class="macro" id="_M/MPFR_NEED_LONGLONG_H" data-ref="_M/MPFR_NEED_LONGLONG_H">MPFR_NEED_LONGLONG_H</dfn></u></td></tr>
<tr><th id="24">24</th><td><u>#include <a href="mpfr-impl.h.html">"mpfr-impl.h"</a></u></td></tr>
<tr><th id="25">25</th><td></td></tr>
<tr><th id="26">26</th><td><i>/* given a precision p, return alpha, such that the argument reduction</i></td></tr>
<tr><th id="27">27</th><td><i>   will use k = alpha*p*log(2).</i></td></tr>
<tr><th id="28">28</th><td><i></i></td></tr>
<tr><th id="29">29</th><td><i>   Warning: we should always have alpha &gt;= log(2)/(2Pi) ~ 0.11,</i></td></tr>
<tr><th id="30">30</th><td><i>   and the smallest value of alpha multiplied by the smallest working</i></td></tr>
<tr><th id="31">31</th><td><i>   precision should be &gt;= 4.</i></td></tr>
<tr><th id="32">32</th><td><i>*/</i></td></tr>
<tr><th id="33">33</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="34">34</th><td><dfn class="decl def fn" id="mpfr_gamma_alpha" title='mpfr_gamma_alpha' data-ref="mpfr_gamma_alpha" data-ref-filename="mpfr_gamma_alpha">mpfr_gamma_alpha</dfn> (<a class="typedef" href="mpfr.h.html#mpfr_t" title='mpfr_t' data-type='__mpfr_struct [1]' data-ref="mpfr_t" data-ref-filename="mpfr_t">mpfr_t</a> <dfn class="local col1 decl" id="1s" title='s' data-type='__mpfr_struct *' data-ref="1s" data-ref-filename="1s">s</dfn>, <a class="typedef" href="mpfr.h.html#mpfr_prec_t" title='mpfr_prec_t' data-type='long' data-ref="mpfr_prec_t" data-ref-filename="mpfr_prec_t">mpfr_prec_t</a> <dfn class="local col2 decl" id="2p" title='p' data-type='mpfr_prec_t' data-ref="2p" data-ref-filename="2p">p</dfn>)</td></tr>
<tr><th id="35">35</th><td>{</td></tr>
<tr><th id="36">36</th><td>  <a class="macro" href="mpfr-impl.h.html#2002" title="" data-ref="_M/MPFR_LOG_FUNC">MPFR_LOG_FUNC</a></td></tr>
<tr><th id="37">37</th><td>    ((<q>"p=%Pu"</q>, p),</td></tr>
<tr><th id="38">38</th><td>     (<q>"s[%Pu]=%.*Rg"</q>, mpfr_get_prec (s), mpfr_log_prec, s));</td></tr>
<tr><th id="39">39</th><td></td></tr>
<tr><th id="40">40</th><td>  <b>if</b> (<a class="local col2 ref" href="#2p" title='p' data-ref="2p" data-ref-filename="2p">p</a> &lt;= <var>100</var>)</td></tr>
<tr><th id="41">41</th><td>    <a class="ref fn" href="mpfr.h.html#mpfr_set_ui_2exp" title='mpfr_set_ui_2exp' data-ref="mpfr_set_ui_2exp" data-ref-filename="mpfr_set_ui_2exp">mpfr_set_ui_2exp</a> (<a class="local col1 ref" href="#1s" title='s' data-ref="1s" data-ref-filename="1s">s</a>, <var>614</var>, -<var>10</var>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>); <i>/* about 0.6 */</i></td></tr>
<tr><th id="42">42</th><td>  <b>else</b> <b>if</b> (<a class="local col2 ref" href="#2p" title='p' data-ref="2p" data-ref-filename="2p">p</a> &lt;= <var>500</var>)</td></tr>
<tr><th id="43">43</th><td>    <a class="ref fn" href="mpfr.h.html#mpfr_set_ui_2exp" title='mpfr_set_ui_2exp' data-ref="mpfr_set_ui_2exp" data-ref-filename="mpfr_set_ui_2exp">mpfr_set_ui_2exp</a> (<a class="local col1 ref" href="#1s" title='s' data-ref="1s" data-ref-filename="1s">s</a>, <var>819</var>, -<var>10</var>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>); <i>/* about 0.8 */</i></td></tr>
<tr><th id="44">44</th><td>  <b>else</b> <b>if</b> (<a class="local col2 ref" href="#2p" title='p' data-ref="2p" data-ref-filename="2p">p</a> &lt;= <var>1000</var>)</td></tr>
<tr><th id="45">45</th><td>    <a class="ref fn" href="mpfr.h.html#mpfr_set_ui_2exp" title='mpfr_set_ui_2exp' data-ref="mpfr_set_ui_2exp" data-ref-filename="mpfr_set_ui_2exp">mpfr_set_ui_2exp</a> (<a class="local col1 ref" href="#1s" title='s' data-ref="1s" data-ref-filename="1s">s</a>, <var>1331</var>, -<var>10</var>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>); <i>/* about 1.3 */</i></td></tr>
<tr><th id="46">46</th><td>  <b>else</b> <b>if</b> (<a class="local col2 ref" href="#2p" title='p' data-ref="2p" data-ref-filename="2p">p</a> &lt;= <var>2000</var>)</td></tr>
<tr><th id="47">47</th><td>    <a class="ref fn" href="mpfr.h.html#mpfr_set_ui_2exp" title='mpfr_set_ui_2exp' data-ref="mpfr_set_ui_2exp" data-ref-filename="mpfr_set_ui_2exp">mpfr_set_ui_2exp</a> (<a class="local col1 ref" href="#1s" title='s' data-ref="1s" data-ref-filename="1s">s</a>, <var>1741</var>, -<var>10</var>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>); <i>/* about 1.7 */</i></td></tr>
<tr><th id="48">48</th><td>  <b>else</b> <b>if</b> (<a class="local col2 ref" href="#2p" title='p' data-ref="2p" data-ref-filename="2p">p</a> &lt;= <var>5000</var>)</td></tr>
<tr><th id="49">49</th><td>    <a class="ref fn" href="mpfr.h.html#mpfr_set_ui_2exp" title='mpfr_set_ui_2exp' data-ref="mpfr_set_ui_2exp" data-ref-filename="mpfr_set_ui_2exp">mpfr_set_ui_2exp</a> (<a class="local col1 ref" href="#1s" title='s' data-ref="1s" data-ref-filename="1s">s</a>, <var>2253</var>, -<var>10</var>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>); <i>/* about 2.2 */</i></td></tr>
<tr><th id="50">50</th><td>  <b>else</b> <b>if</b> (<a class="local col2 ref" href="#2p" title='p' data-ref="2p" data-ref-filename="2p">p</a> &lt;= <var>10000</var>)</td></tr>
<tr><th id="51">51</th><td>    <a class="ref fn" href="mpfr.h.html#mpfr_set_ui_2exp" title='mpfr_set_ui_2exp' data-ref="mpfr_set_ui_2exp" data-ref-filename="mpfr_set_ui_2exp">mpfr_set_ui_2exp</a> (<a class="local col1 ref" href="#1s" title='s' data-ref="1s" data-ref-filename="1s">s</a>, <var>3482</var>, -<var>10</var>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>); <i>/* about 3.4 */</i></td></tr>
<tr><th id="52">52</th><td>  <b>else</b></td></tr>
<tr><th id="53">53</th><td>    <a class="ref fn" href="mpfr.h.html#mpfr_set_ui_2exp" title='mpfr_set_ui_2exp' data-ref="mpfr_set_ui_2exp" data-ref-filename="mpfr_set_ui_2exp">mpfr_set_ui_2exp</a> (<a class="local col1 ref" href="#1s" title='s' data-ref="1s" data-ref-filename="1s">s</a>, <var>9</var>, -<var>1</var>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>); <i>/* 4.5 */</i></td></tr>
<tr><th id="54">54</th><td>}</td></tr>
<tr><th id="55">55</th><td></td></tr>
<tr><th id="56">56</th><td><u>#<span data-ppcond="56">ifdef</span> <a class="macro" href="gamma.c.html#26" data-ref="_M/IS_GAMMA">IS_GAMMA</a></u></td></tr>
<tr><th id="57">57</th><td></td></tr>
<tr><th id="58">58</th><td><i>/* This function is called in case of intermediate overflow/underflow.</i></td></tr>
<tr><th id="59">59</th><td><i>   The s1 and s2 arguments are temporary MPFR numbers, having the</i></td></tr>
<tr><th id="60">60</th><td><i>   working precision. If the result could be determined, then the</i></td></tr>
<tr><th id="61">61</th><td><i>   flags are updated via pexpo, y is set to the result, and the</i></td></tr>
<tr><th id="62">62</th><td><i>   (non-zero) ternary value is returned. Otherwise 0 is returned</i></td></tr>
<tr><th id="63">63</th><td><i>   in order to perform the next Ziv iteration. */</i></td></tr>
<tr><th id="64">64</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="65">65</th><td><dfn class="decl def fn" id="mpfr_explgamma" title='mpfr_explgamma' data-ref="mpfr_explgamma" data-ref-filename="mpfr_explgamma">mpfr_explgamma</dfn> (<a class="typedef" href="mpfr.h.html#mpfr_ptr" title='mpfr_ptr' data-type='__mpfr_struct *' data-ref="mpfr_ptr" data-ref-filename="mpfr_ptr">mpfr_ptr</a> <dfn class="local col3 decl" id="3y" title='y' data-type='mpfr_ptr' data-ref="3y" data-ref-filename="3y">y</dfn>, <a class="typedef" href="mpfr.h.html#mpfr_srcptr" title='mpfr_srcptr' data-type='const __mpfr_struct *' data-ref="mpfr_srcptr" data-ref-filename="mpfr_srcptr">mpfr_srcptr</a> <dfn class="local col4 decl" id="4x" title='x' data-type='mpfr_srcptr' data-ref="4x" data-ref-filename="4x">x</dfn>, <a class="typedef" href="mpfr-impl.h.html#mpfr_save_expo_t" title='mpfr_save_expo_t' data-type='struct mpfr_save_expo_t' data-ref="mpfr_save_expo_t" data-ref-filename="mpfr_save_expo_t">mpfr_save_expo_t</a> *<dfn class="local col5 decl" id="5pexpo" title='pexpo' data-type='mpfr_save_expo_t *' data-ref="5pexpo" data-ref-filename="5pexpo">pexpo</dfn>,</td></tr>
<tr><th id="66">66</th><td>                <a class="typedef" href="mpfr.h.html#mpfr_ptr" title='mpfr_ptr' data-type='__mpfr_struct *' data-ref="mpfr_ptr" data-ref-filename="mpfr_ptr">mpfr_ptr</a> <dfn class="local col6 decl" id="6s1" title='s1' data-type='mpfr_ptr' data-ref="6s1" data-ref-filename="6s1">s1</dfn>, <a class="typedef" href="mpfr.h.html#mpfr_ptr" title='mpfr_ptr' data-type='__mpfr_struct *' data-ref="mpfr_ptr" data-ref-filename="mpfr_ptr">mpfr_ptr</a> <dfn class="local col7 decl" id="7s2" title='s2' data-type='mpfr_ptr' data-ref="7s2" data-ref-filename="7s2">s2</dfn>, <a class="typedef" href="mpfr.h.html#mpfr_rnd_t" title='mpfr_rnd_t' data-type='enum mpfr_rnd_t' data-ref="mpfr_rnd_t" data-ref-filename="mpfr_rnd_t">mpfr_rnd_t</a> <dfn class="local col8 decl" id="8rnd" title='rnd' data-type='mpfr_rnd_t' data-ref="8rnd" data-ref-filename="8rnd">rnd</dfn>)</td></tr>
<tr><th id="67">67</th><td>{</td></tr>
<tr><th id="68">68</th><td>  <a class="typedef" href="mpfr.h.html#mpfr_t" title='mpfr_t' data-type='__mpfr_struct [1]' data-ref="mpfr_t" data-ref-filename="mpfr_t">mpfr_t</a> <dfn class="local col9 decl" id="9t1" title='t1' data-type='mpfr_t' data-ref="9t1" data-ref-filename="9t1">t1</dfn>, <dfn class="local col0 decl" id="10t2" title='t2' data-type='mpfr_t' data-ref="10t2" data-ref-filename="10t2">t2</dfn>;</td></tr>
<tr><th id="69">69</th><td>  <em>int</em> <dfn class="local col1 decl" id="11inex1" title='inex1' data-type='int' data-ref="11inex1" data-ref-filename="11inex1">inex1</dfn>, <dfn class="local col2 decl" id="12inex2" title='inex2' data-type='int' data-ref="12inex2" data-ref-filename="12inex2">inex2</dfn>, <dfn class="local col3 decl" id="13sign" title='sign' data-type='int' data-ref="13sign" data-ref-filename="13sign">sign</dfn>;</td></tr>
<tr><th id="70">70</th><td>  <a class="macro" href="mpfr-impl.h.html#403" title="mpfr_flags_t flags1" data-ref="_M/MPFR_BLOCK_DECL">MPFR_BLOCK_DECL</a> (<dfn class="local col4 decl" id="14flags1" title='flags1' data-type='mpfr_flags_t' data-ref="14flags1" data-ref-filename="14flags1">flags1</dfn>);</td></tr>
<tr><th id="71">71</th><td>  <a class="macro" href="mpfr-impl.h.html#403" title="mpfr_flags_t flags2" data-ref="_M/MPFR_BLOCK_DECL">MPFR_BLOCK_DECL</a> (<dfn class="local col5 decl" id="15flags2" title='flags2' data-type='mpfr_flags_t' data-ref="15flags2" data-ref-filename="15flags2">flags2</dfn>);</td></tr>
<tr><th id="72">72</th><td>  <a class="macro" href="mpfr-impl.h.html#2021" title="struct mpfr_group_t group" data-ref="_M/MPFR_GROUP_DECL">MPFR_GROUP_DECL</a> (<dfn class="local col6 decl" id="16group" title='group' data-type='struct mpfr_group_t' data-ref="16group" data-ref-filename="16group">group</dfn>);</td></tr>
<tr><th id="73">73</th><td></td></tr>
<tr><th id="74">74</th><td>  <a class="macro" href="mpfr-impl.h.html#407" title="do { do __gmpfr_flags = 0; while (0); inex1 = mpfr_lgamma (s1, &amp;sign, x, MPFR_RNDD); (flags1) = __gmpfr_flags; (void) (flags1); } while (0)" data-ref="_M/MPFR_BLOCK">MPFR_BLOCK</a> (<a class="local col4 ref" href="#70" title='flags1' data-ref="14flags1" data-ref-filename="14flags1">flags1</a>, <a class="local col1 ref" href="#11inex1" title='inex1' data-ref="11inex1" data-ref-filename="11inex1">inex1</a> = <a class="ref fn" href="mpfr.h.html#mpfr_lgamma" title='mpfr_lgamma' data-ref="mpfr_lgamma" data-ref-filename="mpfr_lgamma">mpfr_lgamma</a> (<a class="local col6 ref" href="#6s1" title='s1' data-ref="6s1" data-ref-filename="6s1">s1</a>, &amp;<a class="local col3 ref" href="#13sign" title='sign' data-ref="13sign" data-ref-filename="13sign">sign</a>, <a class="local col4 ref" href="#4x" title='x' data-ref="4x" data-ref-filename="4x">x</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDD" title='MPFR_RNDD' data-ref="MPFR_RNDD" data-ref-filename="MPFR_RNDD">MPFR_RNDD</a>));</td></tr>
<tr><th id="75">75</th><td>  <a class="macro" href="mpfr-impl.h.html#468" title="((void) (((__builtin_expect(!!(inex1 != 0), 1))) || (mpfr_assert_fail (&quot;/___NETBSD_SRC___/external/lgpl3/mpfr/dist/src/lngamma.c&quot;, 75, &quot;inex1 != 0&quot;),((void) 0),0)))" data-ref="_M/MPFR_ASSERTN">MPFR_ASSERTN</a> (<a class="local col1 ref" href="#11inex1" title='inex1' data-ref="11inex1" data-ref-filename="11inex1">inex1</a> != <var>0</var>);</td></tr>
<tr><th id="76">76</th><td>  <i>/* s1 = RNDD(lngamma(x)), inexact */</i></td></tr>
<tr><th id="77">77</th><td>  <b>if</b> (<a class="macro" href="mpfr-impl.h.html#1283" title="(__builtin_expect(!!((__builtin_expect(!!((flags1) &amp; (2)), 0))), 0))" data-ref="_M/MPFR_UNLIKELY">MPFR_UNLIKELY</a> (<a class="macro" href="mpfr-impl.h.html#424" title="(__builtin_expect(!!((flags1) &amp; (2)), 0))" data-ref="_M/MPFR_OVERFLOW">MPFR_OVERFLOW</a> (<a class="local col4 ref" href="#70" title='flags1' data-ref="14flags1" data-ref-filename="14flags1">flags1</a>)))</td></tr>
<tr><th id="78">78</th><td>    {</td></tr>
<tr><th id="79">79</th><td>      <b>if</b> (<a class="macro" href="mpfr-impl.h.html#999" title="(((s1)-&gt;_mpfr_sign) &gt; 0)" data-ref="_M/MPFR_IS_POS">MPFR_IS_POS</a> (<a class="local col6 ref" href="#6s1" title='s1' data-ref="6s1" data-ref-filename="6s1">s1</a>))</td></tr>
<tr><th id="80">80</th><td>        {</td></tr>
<tr><th id="81">81</th><td>          <a class="macro" href="mpfr-impl.h.html#1517" title="(*pexpo).saved_flags |= (2)" data-ref="_M/MPFR_SAVE_EXPO_UPDATE_FLAGS">MPFR_SAVE_EXPO_UPDATE_FLAGS</a> (*<a class="local col5 ref" href="#5pexpo" title='pexpo' data-ref="5pexpo" data-ref-filename="5pexpo">pexpo</a>, <a class="macro" href="mpfr.h.html#74" title="2" data-ref="_M/MPFR_FLAGS_OVERFLOW">MPFR_FLAGS_OVERFLOW</a>);</td></tr>
<tr><th id="82">82</th><td>          <b>return</b> <a class="ref fn" href="mpfr-impl.h.html#mpfr_overflow" title='mpfr_overflow' data-ref="mpfr_overflow" data-ref-filename="mpfr_overflow">mpfr_overflow</a> (<a class="local col3 ref" href="#3y" title='y' data-ref="3y" data-ref-filename="3y">y</a>, <a class="local col8 ref" href="#8rnd" title='rnd' data-ref="8rnd" data-ref-filename="8rnd">rnd</a>, <a class="local col3 ref" href="#13sign" title='sign' data-ref="13sign" data-ref-filename="13sign">sign</a>);</td></tr>
<tr><th id="83">83</th><td>        }</td></tr>
<tr><th id="84">84</th><td>      <b>else</b></td></tr>
<tr><th id="85">85</th><td>        {</td></tr>
<tr><th id="86">86</th><td>          <a class="macro" href="mpfr-impl.h.html#1517" title="(*pexpo).saved_flags |= (1)" data-ref="_M/MPFR_SAVE_EXPO_UPDATE_FLAGS">MPFR_SAVE_EXPO_UPDATE_FLAGS</a> (*<a class="local col5 ref" href="#5pexpo" title='pexpo' data-ref="5pexpo" data-ref-filename="5pexpo">pexpo</a>, <a class="macro" href="mpfr.h.html#73" title="1" data-ref="_M/MPFR_FLAGS_UNDERFLOW">MPFR_FLAGS_UNDERFLOW</a>);</td></tr>
<tr><th id="87">87</th><td>          <b>return</b> <a class="ref fn" href="mpfr-impl.h.html#mpfr_underflow" title='mpfr_underflow' data-ref="mpfr_underflow" data-ref-filename="mpfr_underflow">mpfr_underflow</a> (<a class="local col3 ref" href="#3y" title='y' data-ref="3y" data-ref-filename="3y">y</a>, <a class="local col8 ref" href="#8rnd" title='rnd' data-ref="8rnd" data-ref-filename="8rnd">rnd</a> == <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a> ? <a class="enum" href="mpfr.h.html#MPFR_RNDZ" title='MPFR_RNDZ' data-ref="MPFR_RNDZ" data-ref-filename="MPFR_RNDZ">MPFR_RNDZ</a> : <a class="local col8 ref" href="#8rnd" title='rnd' data-ref="8rnd" data-ref-filename="8rnd">rnd</a>, <a class="local col3 ref" href="#13sign" title='sign' data-ref="13sign" data-ref-filename="13sign">sign</a>);</td></tr>
<tr><th id="88">88</th><td>        }</td></tr>
<tr><th id="89">89</th><td>    }</td></tr>
<tr><th id="90">90</th><td></td></tr>
<tr><th id="91">91</th><td>  <a class="macro" href="mpfr.h.html#825" title="mpfr_set4(s2,s1,MPFR_RNDN,((s1)-&gt;_mpfr_sign))" data-ref="_M/mpfr_set">mpfr_set</a> (<a class="local col7 ref" href="#7s2" title='s2' data-ref="7s2" data-ref-filename="7s2">s2</a>, <a class="local col6 ref" href="#6s1" title='s1' data-ref="6s1" data-ref-filename="6s1">s1</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);     <i>/* exact */</i></td></tr>
<tr><th id="92">92</th><td>  <a class="ref fn" href="mpfr.h.html#mpfr_nextabove" title='mpfr_nextabove' data-ref="mpfr_nextabove" data-ref-filename="mpfr_nextabove">mpfr_nextabove</a> (<a class="local col7 ref" href="#7s2" title='s2' data-ref="7s2" data-ref-filename="7s2">s2</a>);              <i>/* v = RNDU(lngamma(z0)) */</i></td></tr>
<tr><th id="93">93</th><td></td></tr>
<tr><th id="94">94</th><td>  <b>if</b> (<a class="local col3 ref" href="#13sign" title='sign' data-ref="13sign" data-ref-filename="13sign">sign</a> &lt; <var>0</var>)</td></tr>
<tr><th id="95">95</th><td>    <a class="local col8 ref" href="#8rnd" title='rnd' data-ref="8rnd" data-ref-filename="8rnd">rnd</a> = <a class="macro" href="mpfr-impl.h.html#1075" title="((rnd) == MPFR_RNDU ? MPFR_RNDD : (rnd) == MPFR_RNDD ? MPFR_RNDU : (rnd))" data-ref="_M/MPFR_INVERT_RND">MPFR_INVERT_RND</a> (<a class="local col8 ref" href="#8rnd" title='rnd' data-ref="8rnd" data-ref-filename="8rnd">rnd</a>);  <i>/* since the result with be negated */</i></td></tr>
<tr><th id="96">96</th><td>  <a class="macro" href="mpfr-impl.h.html#2057" title="do { mpfr_prec_t _prec = (((y)-&gt;_mpfr_prec)); mp_size_t _size; ((void) 0); if ((__builtin_expect(!!(_prec &gt; ((mpfr_prec_t) ((((mpfr_uprec_t) -1) &gt;&gt; 1) - 256))), 0))) mpfr_abort_prec_max (); _size = (((void) 0), ((_prec) - 1) / (64 - 0) + 1); if (_size * (2) &gt; 16) { (group).alloc = (2) * _size * sizeof (mp_limb_t); (group).mant = (mp_limb_t *) mpfr_allocate_func ((group).alloc); } else { (group).alloc = 0; (group).mant = (group).tab; } ; ( ((t1)-&gt;_mpfr_prec) = (_prec), ((t1)-&gt;_mpfr_d) = ((group).mant + _size * (0)), (((t1)-&gt;_mpfr_sign) = (1)), ((void) 0));( ((t2)-&gt;_mpfr_prec) = (_prec), ((t2)-&gt;_mpfr_d) = ((group).mant + _size * (1)), (((t2)-&gt;_mpfr_sign) = (1)), ((void) 0)); } while (0)" data-ref="_M/MPFR_GROUP_INIT_2">MPFR_GROUP_INIT_2</a> (<a class="local col6 ref" href="#72" title='group' data-ref="16group" data-ref-filename="16group">group</a>, <a class="macro" href="mpfr-impl.h.html#831" title="((y)-&gt;_mpfr_prec)" data-ref="_M/MPFR_PREC">MPFR_PREC</a> (<a class="local col3 ref" href="#3y" title='y' data-ref="3y" data-ref-filename="3y">y</a>), <a class="local col9 ref" href="#9t1" title='t1' data-ref="9t1" data-ref-filename="9t1">t1</a>, <a class="local col0 ref" href="#10t2" title='t2' data-ref="10t2" data-ref-filename="10t2">t2</a>);</td></tr>
<tr><th id="97">97</th><td>  <a class="macro" href="mpfr-impl.h.html#407" title="do { do __gmpfr_flags = 0; while (0); inex1 = mpfr_exp (t1, s1, rnd); (flags1) = __gmpfr_flags; (void) (flags1); } while (0)" data-ref="_M/MPFR_BLOCK">MPFR_BLOCK</a> (<a class="local col4 ref" href="#70" title='flags1' data-ref="14flags1" data-ref-filename="14flags1">flags1</a>, <a class="local col1 ref" href="#11inex1" title='inex1' data-ref="11inex1" data-ref-filename="11inex1">inex1</a> = <a class="ref fn" href="mpfr.h.html#mpfr_exp" title='mpfr_exp' data-ref="mpfr_exp" data-ref-filename="mpfr_exp">mpfr_exp</a> (<a class="local col9 ref" href="#9t1" title='t1' data-ref="9t1" data-ref-filename="9t1">t1</a>, <a class="local col6 ref" href="#6s1" title='s1' data-ref="6s1" data-ref-filename="6s1">s1</a>, <a class="local col8 ref" href="#8rnd" title='rnd' data-ref="8rnd" data-ref-filename="8rnd">rnd</a>));</td></tr>
<tr><th id="98">98</th><td>  <a class="macro" href="mpfr-impl.h.html#407" title="do { do __gmpfr_flags = 0; while (0); inex2 = mpfr_exp (t2, s2, rnd); (flags2) = __gmpfr_flags; (void) (flags2); } while (0)" data-ref="_M/MPFR_BLOCK">MPFR_BLOCK</a> (<a class="local col5 ref" href="#71" title='flags2' data-ref="15flags2" data-ref-filename="15flags2">flags2</a>, <a class="local col2 ref" href="#12inex2" title='inex2' data-ref="12inex2" data-ref-filename="12inex2">inex2</a> = <a class="ref fn" href="mpfr.h.html#mpfr_exp" title='mpfr_exp' data-ref="mpfr_exp" data-ref-filename="mpfr_exp">mpfr_exp</a> (<a class="local col0 ref" href="#10t2" title='t2' data-ref="10t2" data-ref-filename="10t2">t2</a>, <a class="local col7 ref" href="#7s2" title='s2' data-ref="7s2" data-ref-filename="7s2">s2</a>, <a class="local col8 ref" href="#8rnd" title='rnd' data-ref="8rnd" data-ref-filename="8rnd">rnd</a>));</td></tr>
<tr><th id="99">99</th><td>  <i>/* t1 is the rounding with mode 'rnd' of a lower bound on |Gamma(x)|,</i></td></tr>
<tr><th id="100">100</th><td><i>     t2 is the rounding with mode 'rnd' of an upper bound, thus if both</i></td></tr>
<tr><th id="101">101</th><td><i>     are equal, so is the wanted result. If t1 and t2 differ or the flags</i></td></tr>
<tr><th id="102">102</th><td><i>     differ, at some point of Ziv's loop they should agree. */</i></td></tr>
<tr><th id="103">103</th><td>  <b>if</b> (<a class="ref fn" href="mpfr.h.html#mpfr_equal_p" title='mpfr_equal_p' data-ref="mpfr_equal_p" data-ref-filename="mpfr_equal_p">mpfr_equal_p</a> (<a class="local col9 ref" href="#9t1" title='t1' data-ref="9t1" data-ref-filename="9t1">t1</a>, <a class="local col0 ref" href="#10t2" title='t2' data-ref="10t2" data-ref-filename="10t2">t2</a>) &amp;&amp; <a class="local col4 ref" href="#70" title='flags1' data-ref="14flags1" data-ref-filename="14flags1">flags1</a> == <a class="local col5 ref" href="#71" title='flags2' data-ref="15flags2" data-ref-filename="15flags2">flags2</a>)</td></tr>
<tr><th id="104">104</th><td>    {</td></tr>
<tr><th id="105">105</th><td>      <a class="macro" href="mpfr-impl.h.html#468" title="((void) (((__builtin_expect(!!((inex1 &gt; 0 &amp;&amp; inex2 &gt; 0) || (inex1 &lt; 0 &amp;&amp; inex2 &lt; 0)), 1))) || (mpfr_assert_fail (&quot;/___NETBSD_SRC___/external/lgpl3/mpfr/dist/src/lngamma.c&quot;, 105, &quot;(inex1 &gt; 0 &amp;&amp; inex2 &gt; 0) || (inex1 &lt; 0 &amp;&amp; inex2 &lt; 0)&quot;),((void) 0),0)))" data-ref="_M/MPFR_ASSERTN">MPFR_ASSERTN</a> ((<a class="local col1 ref" href="#11inex1" title='inex1' data-ref="11inex1" data-ref-filename="11inex1">inex1</a> &gt; <var>0</var> &amp;&amp; <a class="local col2 ref" href="#12inex2" title='inex2' data-ref="12inex2" data-ref-filename="12inex2">inex2</a> &gt; <var>0</var>) || (<a class="local col1 ref" href="#11inex1" title='inex1' data-ref="11inex1" data-ref-filename="11inex1">inex1</a> &lt; <var>0</var> &amp;&amp; <a class="local col2 ref" href="#12inex2" title='inex2' data-ref="12inex2" data-ref-filename="12inex2">inex2</a> &lt; <var>0</var>));</td></tr>
<tr><th id="106">106</th><td>      <a class="ref fn" href="mpfr.h.html#mpfr_set4" title='mpfr_set4' data-ref="mpfr_set4" data-ref-filename="mpfr_set4">mpfr_set4</a> (<a class="local col3 ref" href="#3y" title='y' data-ref="3y" data-ref-filename="3y">y</a>, <a class="local col9 ref" href="#9t1" title='t1' data-ref="9t1" data-ref-filename="9t1">t1</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>, <a class="local col3 ref" href="#13sign" title='sign' data-ref="13sign" data-ref-filename="13sign">sign</a>);  <i>/* exact */</i></td></tr>
<tr><th id="107">107</th><td>      <b>if</b> (<a class="local col3 ref" href="#13sign" title='sign' data-ref="13sign" data-ref-filename="13sign">sign</a> &lt; <var>0</var>)</td></tr>
<tr><th id="108">108</th><td>        <a class="local col1 ref" href="#11inex1" title='inex1' data-ref="11inex1" data-ref-filename="11inex1">inex1</a> = - <a class="local col1 ref" href="#11inex1" title='inex1' data-ref="11inex1" data-ref-filename="11inex1">inex1</a>;</td></tr>
<tr><th id="109">109</th><td>      <a class="macro" href="mpfr-impl.h.html#1517" title="(*pexpo).saved_flags |= (flags1)" data-ref="_M/MPFR_SAVE_EXPO_UPDATE_FLAGS">MPFR_SAVE_EXPO_UPDATE_FLAGS</a> (*<a class="local col5 ref" href="#5pexpo" title='pexpo' data-ref="5pexpo" data-ref-filename="5pexpo">pexpo</a>, <a class="local col4 ref" href="#70" title='flags1' data-ref="14flags1" data-ref-filename="14flags1">flags1</a>);</td></tr>
<tr><th id="110">110</th><td>    }</td></tr>
<tr><th id="111">111</th><td>  <b>else</b></td></tr>
<tr><th id="112">112</th><td>    <a class="local col1 ref" href="#11inex1" title='inex1' data-ref="11inex1" data-ref-filename="11inex1">inex1</a> = <var>0</var>;  <i>/* couldn't determine the result */</i></td></tr>
<tr><th id="113">113</th><td>  <a class="macro" href="mpfr-impl.h.html#2022" title="do { ; if ((group).alloc != 0) { ((void) 0); mpfr_free_func ((group).mant, (group).alloc); }} while (0)" data-ref="_M/MPFR_GROUP_CLEAR">MPFR_GROUP_CLEAR</a> (<a class="local col6 ref" href="#72" title='group' data-ref="16group" data-ref-filename="16group">group</a>);</td></tr>
<tr><th id="114">114</th><td></td></tr>
<tr><th id="115">115</th><td>  <b>return</b> <a class="local col1 ref" href="#11inex1" title='inex1' data-ref="11inex1" data-ref-filename="11inex1">inex1</a>;</td></tr>
<tr><th id="116">116</th><td>}</td></tr>
<tr><th id="117">117</th><td></td></tr>
<tr><th id="118">118</th><td><u>#<span data-ppcond="56">else</span></u></td></tr>
<tr><th id="119">119</th><td></td></tr>
<tr><th id="120">120</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="121">121</th><td>unit_bit (mpfr_srcptr x)</td></tr>
<tr><th id="122">122</th><td>{</td></tr>
<tr><th id="123">123</th><td>  mpfr_exp_t expo;</td></tr>
<tr><th id="124">124</th><td>  mpfr_prec_t prec;</td></tr>
<tr><th id="125">125</th><td>  mp_limb_t x0;</td></tr>
<tr><th id="126">126</th><td></td></tr>
<tr><th id="127">127</th><td>  expo = MPFR_GET_EXP (x);</td></tr>
<tr><th id="128">128</th><td>  <b>if</b> (expo &lt;= <var>0</var>)</td></tr>
<tr><th id="129">129</th><td>    <b>return</b> <var>0</var>;  <i>/* |x| &lt; 1 */</i></td></tr>
<tr><th id="130">130</th><td></td></tr>
<tr><th id="131">131</th><td>  prec = MPFR_PREC (x);</td></tr>
<tr><th id="132">132</th><td>  <b>if</b> (expo &gt; prec)</td></tr>
<tr><th id="133">133</th><td>    <b>return</b> <var>0</var>;  <i>/* y is a multiple of 2^(expo-prec), thus an even integer */</i></td></tr>
<tr><th id="134">134</th><td></td></tr>
<tr><th id="135">135</th><td>  <i>/* Now, the unit bit is represented. */</i></td></tr>
<tr><th id="136">136</th><td></td></tr>
<tr><th id="137">137</th><td>  prec = MPFR_PREC2LIMBS (prec) * GMP_NUMB_BITS - expo;</td></tr>
<tr><th id="138">138</th><td>  <i>/* number of represented fractional bits (including the trailing 0's) */</i></td></tr>
<tr><th id="139">139</th><td></td></tr>
<tr><th id="140">140</th><td>  x0 = *(MPFR_MANT (x) + prec / GMP_NUMB_BITS);</td></tr>
<tr><th id="141">141</th><td>  <i>/* limb containing the unit bit */</i></td></tr>
<tr><th id="142">142</th><td></td></tr>
<tr><th id="143">143</th><td>  <b>return</b> (x0 &gt;&gt; (prec % GMP_NUMB_BITS)) &amp; <var>1</var>;</td></tr>
<tr><th id="144">144</th><td>}</td></tr>
<tr><th id="145">145</th><td></td></tr>
<tr><th id="146">146</th><td><u>#<span data-ppcond="56">endif</span></u></td></tr>
<tr><th id="147">147</th><td></td></tr>
<tr><th id="148">148</th><td><i>/* FIXME: There is an internal overflow when z is very large.</i></td></tr>
<tr><th id="149">149</th><td><i>   Simple overflow detection with possible false negatives?</i></td></tr>
<tr><th id="150">150</th><td><i>   For the particular cases near the overflow boundary,</i></td></tr>
<tr><th id="151">151</th><td><i>   scaling by a power of two?</i></td></tr>
<tr><th id="152">152</th><td><i>*/</i></td></tr>
<tr><th id="153">153</th><td></td></tr>
<tr><th id="154">154</th><td><i>/* lngamma(x) = log(gamma(x)).</i></td></tr>
<tr><th id="155">155</th><td><i>   We use formula [6.1.40] from Abramowitz&amp;Stegun:</i></td></tr>
<tr><th id="156">156</th><td><i>   lngamma(z) = (z-1/2)*log(z) - z + 1/2*log(2*Pi)</i></td></tr>
<tr><th id="157">157</th><td><i>              + sum (Bernoulli[2m]/(2m)/(2m-1)/z^(2m-1),m=1..infinity)</i></td></tr>
<tr><th id="158">158</th><td><i>   According to [6.1.42], if the sum is truncated after m=n, the error</i></td></tr>
<tr><th id="159">159</th><td><i>   R_n(z) is bounded by |B[2n+2]|*K(z)/(2n+1)/(2n+2)/|z|^(2n+1)</i></td></tr>
<tr><th id="160">160</th><td><i>   where K(z) = max (z^2/(u^2+z^2)) for u &gt;= 0.</i></td></tr>
<tr><th id="161">161</th><td><i>   For z real, |K(z)| &lt;= 1 thus R_n(z) is bounded by the first neglected term.</i></td></tr>
<tr><th id="162">162</th><td><i> */</i></td></tr>
<tr><th id="163">163</th><td><u>#<span data-ppcond="163">ifdef</span> <a class="macro" href="gamma.c.html#26" data-ref="_M/IS_GAMMA">IS_GAMMA</a></u></td></tr>
<tr><th id="164">164</th><td><u>#define <dfn class="macro" id="_M/GAMMA_FUNC" data-ref="_M/GAMMA_FUNC">GAMMA_FUNC</dfn> <dfn class="decl def fn" id="mpfr_gamma_aux" title='mpfr_gamma_aux' data-ref="mpfr_gamma_aux" data-ref-filename="mpfr_gamma_aux">mpfr_gamma_aux</dfn></u></td></tr>
<tr><th id="165">165</th><td><u>#<span data-ppcond="163">else</span></u></td></tr>
<tr><th id="166">166</th><td><u>#define GAMMA_FUNC mpfr_lngamma_aux</u></td></tr>
<tr><th id="167">167</th><td><u>#<span data-ppcond="163">endif</span></u></td></tr>
<tr><th id="168">168</th><td></td></tr>
<tr><th id="169">169</th><td><em>static</em> <em>int</em></td></tr>
<tr><th id="170">170</th><td><a class="macro" href="#164" title="mpfr_gamma_aux" data-ref="_M/GAMMA_FUNC">GAMMA_FUNC</a> (<a class="typedef" href="mpfr.h.html#mpfr_ptr" title='mpfr_ptr' data-type='__mpfr_struct *' data-ref="mpfr_ptr" data-ref-filename="mpfr_ptr">mpfr_ptr</a> <dfn class="local col7 decl" id="17y" title='y' data-type='mpfr_ptr' data-ref="17y" data-ref-filename="17y">y</dfn>, <a class="typedef" href="mpfr.h.html#mpfr_srcptr" title='mpfr_srcptr' data-type='const __mpfr_struct *' data-ref="mpfr_srcptr" data-ref-filename="mpfr_srcptr">mpfr_srcptr</a> <dfn class="local col8 decl" id="18z0" title='z0' data-type='mpfr_srcptr' data-ref="18z0" data-ref-filename="18z0">z0</dfn>, <a class="typedef" href="mpfr.h.html#mpfr_rnd_t" title='mpfr_rnd_t' data-type='enum mpfr_rnd_t' data-ref="mpfr_rnd_t" data-ref-filename="mpfr_rnd_t">mpfr_rnd_t</a> <dfn class="local col9 decl" id="19rnd" title='rnd' data-type='mpfr_rnd_t' data-ref="19rnd" data-ref-filename="19rnd">rnd</dfn>)</td></tr>
<tr><th id="171">171</th><td>{</td></tr>
<tr><th id="172">172</th><td>  <a class="typedef" href="mpfr.h.html#mpfr_prec_t" title='mpfr_prec_t' data-type='long' data-ref="mpfr_prec_t" data-ref-filename="mpfr_prec_t">mpfr_prec_t</a> <dfn class="local col0 decl" id="20precy" title='precy' data-type='mpfr_prec_t' data-ref="20precy" data-ref-filename="20precy">precy</dfn>, <dfn class="local col1 decl" id="21w" title='w' data-type='mpfr_prec_t' data-ref="21w" data-ref-filename="21w">w</dfn>; <i>/* working precision */</i></td></tr>
<tr><th id="173">173</th><td>  <a class="typedef" href="mpfr.h.html#mpfr_t" title='mpfr_t' data-type='__mpfr_struct [1]' data-ref="mpfr_t" data-ref-filename="mpfr_t">mpfr_t</a> <dfn class="local col2 decl" id="22s" title='s' data-type='mpfr_t' data-ref="22s" data-ref-filename="22s">s</dfn>, <dfn class="local col3 decl" id="23t" title='t' data-type='mpfr_t' data-ref="23t" data-ref-filename="23t">t</dfn>, <dfn class="local col4 decl" id="24u" title='u' data-type='mpfr_t' data-ref="24u" data-ref-filename="24u">u</dfn>, <dfn class="local col5 decl" id="25v" title='v' data-type='mpfr_t' data-ref="25v" data-ref-filename="25v">v</dfn>, <dfn class="local col6 decl" id="26z" title='z' data-type='mpfr_t' data-ref="26z" data-ref-filename="26z">z</dfn>;</td></tr>
<tr><th id="174">174</th><td>  <em>unsigned</em> <em>long</em> <dfn class="local col7 decl" id="27m" title='m' data-type='unsigned long' data-ref="27m" data-ref-filename="27m">m</dfn>, <dfn class="local col8 decl" id="28k" title='k' data-type='unsigned long' data-ref="28k" data-ref-filename="28k">k</dfn>, <dfn class="local col9 decl" id="29maxm" title='maxm' data-type='unsigned long' data-ref="29maxm" data-ref-filename="29maxm">maxm</dfn>, <dfn class="local col0 decl" id="30l" title='l' data-type='unsigned long' data-ref="30l" data-ref-filename="30l">l</dfn>;</td></tr>
<tr><th id="175">175</th><td>  <em>int</em> <dfn class="local col1 decl" id="31compared" title='compared' data-type='int' data-ref="31compared" data-ref-filename="31compared">compared</dfn>, <dfn class="local col2 decl" id="32inexact" title='inexact' data-type='int' data-ref="32inexact" data-ref-filename="32inexact">inexact</dfn>;</td></tr>
<tr><th id="176">176</th><td>  <a class="typedef" href="mpfr.h.html#mpfr_exp_t" title='mpfr_exp_t' data-type='long' data-ref="mpfr_exp_t" data-ref-filename="mpfr_exp_t">mpfr_exp_t</a> <dfn class="local col3 decl" id="33err_s" title='err_s' data-type='mpfr_exp_t' data-ref="33err_s" data-ref-filename="33err_s">err_s</dfn>, <dfn class="local col4 decl" id="34err_t" title='err_t' data-type='mpfr_exp_t' data-ref="34err_t" data-ref-filename="34err_t">err_t</dfn>;</td></tr>
<tr><th id="177">177</th><td>  <em>double</em> <dfn class="local col5 decl" id="35d" title='d' data-type='double' data-ref="35d" data-ref-filename="35d">d</dfn>;</td></tr>
<tr><th id="178">178</th><td>  <a class="macro" href="mpfr-impl.h.html#1506" title="mpfr_save_expo_t expo" data-ref="_M/MPFR_SAVE_EXPO_DECL">MPFR_SAVE_EXPO_DECL</a> (<dfn class="local col6 decl" id="36expo" title='expo' data-type='mpfr_save_expo_t' data-ref="36expo" data-ref-filename="36expo">expo</dfn>);</td></tr>
<tr><th id="179">179</th><td>  <a class="macro" href="mpfr-impl.h.html#1827" title="mpfr_prec_t loop" data-ref="_M/MPFR_ZIV_DECL">MPFR_ZIV_DECL</a> (<dfn class="local col7 decl" id="37loop" title='loop' data-type='mpfr_prec_t' data-ref="37loop" data-ref-filename="37loop">loop</dfn>);</td></tr>
<tr><th id="180">180</th><td></td></tr>
<tr><th id="181">181</th><td>  <a class="macro" href="mpfr-impl.h.html#2002" title="" data-ref="_M/MPFR_LOG_FUNC">MPFR_LOG_FUNC</a></td></tr>
<tr><th id="182">182</th><td>    ((<q>"x[%Pu]=%.*Rg rnd=%d"</q>, mpfr_get_prec (z0), mpfr_log_prec, z0, rnd),</td></tr>
<tr><th id="183">183</th><td>     (<q>"y[%Pu]=%.*Rg inexact=%d"</q>,</td></tr>
<tr><th id="184">184</th><td>      mpfr_get_prec (y), mpfr_log_prec, y, inexact));</td></tr>
<tr><th id="185">185</th><td></td></tr>
<tr><th id="186">186</th><td>  <a class="local col1 ref" href="#31compared" title='compared' data-ref="31compared" data-ref-filename="31compared">compared</a> = <a class="macro" href="mpfr.h.html#872" title="(__builtin_constant_p (1) &amp;&amp; (mpfr_ulong) (1) == 0 ? (mpfr_sgn) (z0) : mpfr_cmp_ui_2exp ((z0), (1), 0))" data-ref="_M/mpfr_cmp_ui">mpfr_cmp_ui</a> (<a class="local col8 ref" href="#18z0" title='z0' data-ref="18z0" data-ref-filename="18z0">z0</a>, <var>1</var>);</td></tr>
<tr><th id="187">187</th><td></td></tr>
<tr><th id="188">188</th><td>  <a class="macro" href="mpfr-impl.h.html#1507" title="((expo).saved_flags = __gmpfr_flags, (expo).saved_emin = __gmpfr_emin, (expo).saved_emax = __gmpfr_emax, __gmpfr_emin = (1-((mpfr_exp_t) 1 &lt;&lt; ((64 - 0)*sizeof(mpfr_exp_t)/sizeof(mp_limb_t)-2))), __gmpfr_emax = (((mpfr_exp_t) 1 &lt;&lt; ((64 - 0)*sizeof(mpfr_exp_t)/sizeof(mp_limb_t)-2))-1))" data-ref="_M/MPFR_SAVE_EXPO_MARK">MPFR_SAVE_EXPO_MARK</a> (<a class="local col6 ref" href="#178" title='expo' data-ref="36expo" data-ref-filename="36expo">expo</a>);</td></tr>
<tr><th id="189">189</th><td></td></tr>
<tr><th id="190">190</th><td><u>#<span data-ppcond="190">ifndef</span> <a class="macro" href="gamma.c.html#26" data-ref="_M/IS_GAMMA">IS_GAMMA</a> /* lngamma or lgamma */</u></td></tr>
<tr><th id="191">191</th><td>  <b>if</b> (compared == <var>0</var> || (compared &gt; <var>0</var> &amp;&amp; mpfr_cmp_ui (z0, <var>2</var>) == <var>0</var>))</td></tr>
<tr><th id="192">192</th><td>    {</td></tr>
<tr><th id="193">193</th><td>      MPFR_SAVE_EXPO_FREE (expo);</td></tr>
<tr><th id="194">194</th><td>      <b>return</b> mpfr_set_ui (y, <var>0</var>, MPFR_RNDN);  <i>/* lngamma(1 or 2) = +0 */</i></td></tr>
<tr><th id="195">195</th><td>    }</td></tr>
<tr><th id="196">196</th><td></td></tr>
<tr><th id="197">197</th><td>  <i>/* Deal with very large inputs: according to [6.1.42], if we denote</i></td></tr>
<tr><th id="198">198</th><td><i>     R_n(z) = lngamma(z) - (z-1/2)*log(z) + z - 1/2*log(2*Pi), we have</i></td></tr>
<tr><th id="199">199</th><td><i>     |R_n(z)| &lt;= B_2/2/z, thus for z &gt;= 2 we have</i></td></tr>
<tr><th id="200">200</th><td><i>     |lngamma(z) - [z*(log(z) - 1)]| &lt; 1/2*log(z) + 1. */</i></td></tr>
<tr><th id="201">201</th><td>  <b>if</b> (compared &gt; <var>0</var> &amp;&amp; MPFR_GET_EXP (z0) &gt;= (mpfr_exp_t) MPFR_PREC(y) + <var>2</var>)</td></tr>
<tr><th id="202">202</th><td>    {</td></tr>
<tr><th id="203">203</th><td>      <i>/* Since PREC(y) &gt;= 2, this ensures EXP(z0) &gt;= 4, thus |z0| &gt;= 8,</i></td></tr>
<tr><th id="204">204</th><td><i>         thus 1/2*log(z0) + 1 &lt; log(z0).</i></td></tr>
<tr><th id="205">205</th><td><i>         Since the largest possible z is &lt; 2^(2^62) on a 64-bit machine,</i></td></tr>
<tr><th id="206">206</th><td><i>         the largest value of log(z) is 2^62*log(2.) &lt; 3.2e18 &lt; 2^62,</i></td></tr>
<tr><th id="207">207</th><td><i>         thus if we use at least 62 bits of precision, then log(t)-1 will</i></td></tr>
<tr><th id="208">208</th><td><i>         be exact */</i></td></tr>
<tr><th id="209">209</th><td>      mpfr_init2 (t, MPFR_PREC(y) &gt;= <var>52</var> ? MPFR_PREC(y) + <var>10</var> : <var>62</var>);</td></tr>
<tr><th id="210">210</th><td>      mpfr_log (t, z0, MPFR_RNDU); <i>/* error &lt; 1 ulp */</i></td></tr>
<tr><th id="211">211</th><td>      inexact = mpfr_sub_ui (t, t, <var>1</var>, MPFR_RNDU); <i>/* err &lt; 2 ulps, since the</i></td></tr>
<tr><th id="212">212</th><td><i>                                                     exponent of t might have</i></td></tr>
<tr><th id="213">213</th><td><i>                                                     decreased */</i></td></tr>
<tr><th id="214">214</th><td>      MPFR_ASSERTD(inexact == <var>0</var>);</td></tr>
<tr><th id="215">215</th><td>      mpfr_mul (t, z0, t, MPFR_RNDU); <i>/* err &lt; 1+2*2=5 ulps according to</i></td></tr>
<tr><th id="216">216</th><td><i>                                        "Generic error on multiplication"</i></td></tr>
<tr><th id="217">217</th><td><i>                                        in algorithms.tex */</i></td></tr>
<tr><th id="218">218</th><td>      <b>if</b> (MPFR_IS_INF(t))</td></tr>
<tr><th id="219">219</th><td>        {</td></tr>
<tr><th id="220">220</th><td>          mpfr_clear (t);</td></tr>
<tr><th id="221">221</th><td>          MPFR_SAVE_EXPO_FREE (expo);</td></tr>
<tr><th id="222">222</th><td>          inexact = mpfr_overflow (y, rnd, <var>1</var>);</td></tr>
<tr><th id="223">223</th><td>          <b>return</b> inexact;</td></tr>
<tr><th id="224">224</th><td>        }</td></tr>
<tr><th id="225">225</th><td>      <b>if</b> (MPFR_GET_EXP(t) - MPFR_PREC(t) &gt;= <var>62</var>)</td></tr>
<tr><th id="226">226</th><td>        {</td></tr>
<tr><th id="227">227</th><td>          <i>/* then ulp(t) &gt;= 2^62 &gt; log(z0) thus the total error is bounded</i></td></tr>
<tr><th id="228">228</th><td><i>             by 6 ulp(t) */</i></td></tr>
<tr><th id="229">229</th><td>          <b>if</b> (MPFR_CAN_ROUND (t, MPFR_PREC(t) - <var>3</var>, MPFR_PREC(y), rnd))</td></tr>
<tr><th id="230">230</th><td>            {</td></tr>
<tr><th id="231">231</th><td>              inexact = mpfr_set (y, t, rnd);</td></tr>
<tr><th id="232">232</th><td>              mpfr_clear (t);</td></tr>
<tr><th id="233">233</th><td>              MPFR_SAVE_EXPO_FREE (expo);</td></tr>
<tr><th id="234">234</th><td>              <b>return</b> mpfr_check_range (y, inexact, rnd);</td></tr>
<tr><th id="235">235</th><td>            }</td></tr>
<tr><th id="236">236</th><td>        }</td></tr>
<tr><th id="237">237</th><td>      mpfr_clear (t);</td></tr>
<tr><th id="238">238</th><td>    }</td></tr>
<tr><th id="239">239</th><td></td></tr>
<tr><th id="240">240</th><td>  <i>/* Deal here with tiny inputs. We have for -0.3 &lt;= x &lt;= 0.3:</i></td></tr>
<tr><th id="241">241</th><td><i>     - log|x| - gamma*x &lt;= log|gamma(x)| &lt;= - log|x| - gamma*x + x^2 */</i></td></tr>
<tr><th id="242">242</th><td>  <b>if</b> (MPFR_GET_EXP (z0) &lt;= - (mpfr_exp_t) MPFR_PREC(y))</td></tr>
<tr><th id="243">243</th><td>    {</td></tr>
<tr><th id="244">244</th><td>      mpfr_t l, h, g;</td></tr>
<tr><th id="245">245</th><td>      <em>int</em> ok, inex1, inex2;</td></tr>
<tr><th id="246">246</th><td>      mpfr_prec_t prec = MPFR_PREC(y) + <var>14</var>;</td></tr>
<tr><th id="247">247</th><td>      MPFR_ZIV_DECL (loop);</td></tr>
<tr><th id="248">248</th><td></td></tr>
<tr><th id="249">249</th><td>      MPFR_ZIV_INIT (loop, prec);</td></tr>
<tr><th id="250">250</th><td>      <b>do</b></td></tr>
<tr><th id="251">251</th><td>        {</td></tr>
<tr><th id="252">252</th><td>          mpfr_init2 (l, prec);</td></tr>
<tr><th id="253">253</th><td>          <b>if</b> (MPFR_IS_POS(z0))</td></tr>
<tr><th id="254">254</th><td>            {</td></tr>
<tr><th id="255">255</th><td>              mpfr_log (l, z0, MPFR_RNDU); <i>/* upper bound for log(z0) */</i></td></tr>
<tr><th id="256">256</th><td>              mpfr_init2 (h, MPFR_PREC(l));</td></tr>
<tr><th id="257">257</th><td>            }</td></tr>
<tr><th id="258">258</th><td>          <b>else</b></td></tr>
<tr><th id="259">259</th><td>            {</td></tr>
<tr><th id="260">260</th><td>              mpfr_init2 (h, MPFR_PREC(z0));</td></tr>
<tr><th id="261">261</th><td>              mpfr_neg (h, z0, MPFR_RNDN); <i>/* exact */</i></td></tr>
<tr><th id="262">262</th><td>              mpfr_log (l, h, MPFR_RNDU); <i>/* upper bound for log(-z0) */</i></td></tr>
<tr><th id="263">263</th><td>              mpfr_set_prec (h, MPFR_PREC(l));</td></tr>
<tr><th id="264">264</th><td>            }</td></tr>
<tr><th id="265">265</th><td>          mpfr_neg (l, l, MPFR_RNDD); <i>/* lower bound for -log(|z0|) */</i></td></tr>
<tr><th id="266">266</th><td>          mpfr_set (h, l, MPFR_RNDD); <i>/* exact */</i></td></tr>
<tr><th id="267">267</th><td>          mpfr_nextabove (h); <i>/* upper bound for -log(|z0|), avoids two calls</i></td></tr>
<tr><th id="268">268</th><td><i>                                 to mpfr_log */</i></td></tr>
<tr><th id="269">269</th><td>          mpfr_init2 (g, MPFR_PREC(l));</td></tr>
<tr><th id="270">270</th><td>          <i>/* if z0&gt;0, we need an upper approximation of Euler's constant</i></td></tr>
<tr><th id="271">271</th><td><i>             for the left bound */</i></td></tr>
<tr><th id="272">272</th><td>          mpfr_const_euler (g, MPFR_IS_POS(z0) ? MPFR_RNDU : MPFR_RNDD);</td></tr>
<tr><th id="273">273</th><td>          mpfr_mul (g, g, z0, MPFR_RNDD);</td></tr>
<tr><th id="274">274</th><td>          mpfr_sub (l, l, g, MPFR_RNDD);</td></tr>
<tr><th id="275">275</th><td>          mpfr_const_euler (g, MPFR_IS_POS(z0) ? MPFR_RNDD : MPFR_RNDU); <i>/* cached */</i></td></tr>
<tr><th id="276">276</th><td>          mpfr_mul (g, g, z0, MPFR_RNDU);</td></tr>
<tr><th id="277">277</th><td>          mpfr_sub (h, h, g, MPFR_RNDD);</td></tr>
<tr><th id="278">278</th><td>          mpfr_mul (g, z0, z0, MPFR_RNDU);</td></tr>
<tr><th id="279">279</th><td>          mpfr_add (h, h, g, MPFR_RNDU);</td></tr>
<tr><th id="280">280</th><td>          inex1 = mpfr_prec_round (l, MPFR_PREC(y), rnd);</td></tr>
<tr><th id="281">281</th><td>          inex2 = mpfr_prec_round (h, MPFR_PREC(y), rnd);</td></tr>
<tr><th id="282">282</th><td>          <i>/* Caution: we not only need l = h, but both inexact flags should</i></td></tr>
<tr><th id="283">283</th><td><i>             agree. Indeed, one of the inexact flags might be zero. In that</i></td></tr>
<tr><th id="284">284</th><td><i>             case if we assume lngamma(z0) cannot be exact, the other flag</i></td></tr>
<tr><th id="285">285</th><td><i>             should be correct. We are conservative here and request that both</i></td></tr>
<tr><th id="286">286</th><td><i>             inexact flags agree. */</i></td></tr>
<tr><th id="287">287</th><td>          ok = SAME_SIGN (inex1, inex2) &amp;&amp; mpfr_cmp (l, h) == <var>0</var>;</td></tr>
<tr><th id="288">288</th><td>          <b>if</b> (ok)</td></tr>
<tr><th id="289">289</th><td>            mpfr_set (y, h, rnd); <i>/* exact */</i></td></tr>
<tr><th id="290">290</th><td>          mpfr_clear (l);</td></tr>
<tr><th id="291">291</th><td>          mpfr_clear (h);</td></tr>
<tr><th id="292">292</th><td>          mpfr_clear (g);</td></tr>
<tr><th id="293">293</th><td>          <b>if</b> (ok)</td></tr>
<tr><th id="294">294</th><td>            {</td></tr>
<tr><th id="295">295</th><td>              MPFR_ZIV_FREE (loop);</td></tr>
<tr><th id="296">296</th><td>              MPFR_SAVE_EXPO_FREE (expo);</td></tr>
<tr><th id="297">297</th><td>              <b>return</b> mpfr_check_range (y, inex1, rnd);</td></tr>
<tr><th id="298">298</th><td>            }</td></tr>
<tr><th id="299">299</th><td>          <i>/* since we have log|gamma(x)| = - log|x| - gamma*x + O(x^2),</i></td></tr>
<tr><th id="300">300</th><td><i>             if x ~ 2^(-n), then we have a n-bit approximation, thus</i></td></tr>
<tr><th id="301">301</th><td><i>             we can try again with a working precision of n bits,</i></td></tr>
<tr><th id="302">302</th><td><i>             especially when n &gt;&gt; PREC(y).</i></td></tr>
<tr><th id="303">303</th><td><i>             Otherwise we would use the reflection formula evaluating x-1,</i></td></tr>
<tr><th id="304">304</th><td><i>             which would need precision n. */</i></td></tr>
<tr><th id="305">305</th><td>          MPFR_ZIV_NEXT (loop, prec);</td></tr>
<tr><th id="306">306</th><td>        }</td></tr>
<tr><th id="307">307</th><td>      <b>while</b> (prec &lt;= - MPFR_GET_EXP (z0));</td></tr>
<tr><th id="308">308</th><td>      MPFR_ZIV_FREE (loop);</td></tr>
<tr><th id="309">309</th><td>    }</td></tr>
<tr><th id="310">310</th><td><u>#<span data-ppcond="190">endif</span></u></td></tr>
<tr><th id="311">311</th><td></td></tr>
<tr><th id="312">312</th><td>  <a class="local col0 ref" href="#20precy" title='precy' data-ref="20precy" data-ref-filename="20precy">precy</a> = <a class="macro" href="mpfr-impl.h.html#831" title="((y)-&gt;_mpfr_prec)" data-ref="_M/MPFR_PREC">MPFR_PREC</a>(<a class="local col7 ref" href="#17y" title='y' data-ref="17y" data-ref-filename="17y">y</a>);</td></tr>
<tr><th id="313">313</th><td></td></tr>
<tr><th id="314">314</th><td>  <a class="ref fn" href="mpfr.h.html#mpfr_init2" title='mpfr_init2' data-ref="mpfr_init2" data-ref-filename="mpfr_init2">mpfr_init2</a> (<a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="macro" href="mpfr.h.html#159" title="1" data-ref="_M/MPFR_PREC_MIN">MPFR_PREC_MIN</a>);</td></tr>
<tr><th id="315">315</th><td>  <a class="ref fn" href="mpfr.h.html#mpfr_init2" title='mpfr_init2' data-ref="mpfr_init2" data-ref-filename="mpfr_init2">mpfr_init2</a> (<a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="macro" href="mpfr.h.html#159" title="1" data-ref="_M/MPFR_PREC_MIN">MPFR_PREC_MIN</a>);</td></tr>
<tr><th id="316">316</th><td>  <a class="ref fn" href="mpfr.h.html#mpfr_init2" title='mpfr_init2' data-ref="mpfr_init2" data-ref-filename="mpfr_init2">mpfr_init2</a> (<a class="local col4 ref" href="#24u" title='u' data-ref="24u" data-ref-filename="24u">u</a>, <a class="macro" href="mpfr.h.html#159" title="1" data-ref="_M/MPFR_PREC_MIN">MPFR_PREC_MIN</a>);</td></tr>
<tr><th id="317">317</th><td>  <a class="ref fn" href="mpfr.h.html#mpfr_init2" title='mpfr_init2' data-ref="mpfr_init2" data-ref-filename="mpfr_init2">mpfr_init2</a> (<a class="local col5 ref" href="#25v" title='v' data-ref="25v" data-ref-filename="25v">v</a>, <a class="macro" href="mpfr.h.html#159" title="1" data-ref="_M/MPFR_PREC_MIN">MPFR_PREC_MIN</a>);</td></tr>
<tr><th id="318">318</th><td>  <a class="ref fn" href="mpfr.h.html#mpfr_init2" title='mpfr_init2' data-ref="mpfr_init2" data-ref-filename="mpfr_init2">mpfr_init2</a> (<a class="local col6 ref" href="#26z" title='z' data-ref="26z" data-ref-filename="26z">z</a>, <a class="macro" href="mpfr.h.html#159" title="1" data-ref="_M/MPFR_PREC_MIN">MPFR_PREC_MIN</a>);</td></tr>
<tr><th id="319">319</th><td></td></tr>
<tr><th id="320">320</th><td>  <a class="local col2 ref" href="#32inexact" title='inexact' data-ref="32inexact" data-ref-filename="32inexact">inexact</a> = <var>0</var>; <i>/* 0 means: result y not set yet */</i></td></tr>
<tr><th id="321">321</th><td></td></tr>
<tr><th id="322">322</th><td>  <b>if</b> (<a class="local col1 ref" href="#31compared" title='compared' data-ref="31compared" data-ref-filename="31compared">compared</a> &lt; <var>0</var>)</td></tr>
<tr><th id="323">323</th><td>    {</td></tr>
<tr><th id="324">324</th><td>      <a class="typedef" href="mpfr.h.html#mpfr_exp_t" title='mpfr_exp_t' data-type='long' data-ref="mpfr_exp_t" data-ref-filename="mpfr_exp_t">mpfr_exp_t</a> <dfn class="local col8 decl" id="38err_u" title='err_u' data-type='mpfr_exp_t' data-ref="38err_u" data-ref-filename="38err_u">err_u</dfn>;</td></tr>
<tr><th id="325">325</th><td></td></tr>
<tr><th id="326">326</th><td>      <i>/* use reflection formula:</i></td></tr>
<tr><th id="327">327</th><td><i>         gamma(x) = Pi*(x-1)/sin(Pi*(2-x))/gamma(2-x)</i></td></tr>
<tr><th id="328">328</th><td><i>         thus lngamma(x) = log(Pi*(x-1)/sin(Pi*(2-x))) - lngamma(2-x) */</i></td></tr>
<tr><th id="329">329</th><td></td></tr>
<tr><th id="330">330</th><td>      <a class="local col1 ref" href="#21w" title='w' data-ref="21w" data-ref-filename="21w">w</a> = <a class="local col0 ref" href="#20precy" title='precy' data-ref="20precy" data-ref-filename="20precy">precy</a> + <a class="macro" href="mpfr-impl.h.html#1331" title="((__builtin_expect(!!((precy) == 1), 0)) ? 0 : __extension__ ({ int _b; mp_limb_t _limb; ((void) (((__builtin_expect(!!((precy) &gt; 1), 1))) || (mpfr_assert_fail (&quot;/___NETBSD_SRC___/external/lgpl3/mpfr/dist/src/lngamma.c&quot;, 330, &quot;(precy) &gt; 1&quot;),((void) 0),0))); _limb = (precy) - 1; ((void) (((__builtin_expect(!!(_limb == (precy) - 1), 1))) || (mpfr_assert_fail (&quot;/___NETBSD_SRC___/external/lgpl3/mpfr/dist/src/lngamma.c&quot;, 330, &quot;_limb == (precy) - 1&quot;),((void) 0),0))); do { UDItype __cbtmp; ((void) 0); __asm__ (&quot;bsrq %1,%0&quot; : &quot;=r&quot; (__cbtmp) : &quot;rm&quot; ((UDItype)(_limb))); (_b) = __cbtmp ^ 63; } while (0); ((64 - 0) - _b); }))" data-ref="_M/MPFR_INT_CEIL_LOG2">MPFR_INT_CEIL_LOG2</a> (<a class="local col0 ref" href="#20precy" title='precy' data-ref="20precy" data-ref-filename="20precy">precy</a>);</td></tr>
<tr><th id="331">331</th><td>      <a class="local col1 ref" href="#21w" title='w' data-ref="21w" data-ref-filename="21w">w</a> += <a class="macro" href="mpfr-impl.h.html#1331" title="((__builtin_expect(!!((w) == 1), 0)) ? 0 : __extension__ ({ int _b; mp_limb_t _limb; ((void) (((__builtin_expect(!!((w) &gt; 1), 1))) || (mpfr_assert_fail (&quot;/___NETBSD_SRC___/external/lgpl3/mpfr/dist/src/lngamma.c&quot;, 331, &quot;(w) &gt; 1&quot;),((void) 0),0))); _limb = (w) - 1; ((void) (((__builtin_expect(!!(_limb == (w) - 1), 1))) || (mpfr_assert_fail (&quot;/___NETBSD_SRC___/external/lgpl3/mpfr/dist/src/lngamma.c&quot;, 331, &quot;_limb == (w) - 1&quot;),((void) 0),0))); do { UDItype __cbtmp; ((void) 0); __asm__ (&quot;bsrq %1,%0&quot; : &quot;=r&quot; (__cbtmp) : &quot;rm&quot; ((UDItype)(_limb))); (_b) = __cbtmp ^ 63; } while (0); ((64 - 0) - _b); }))" data-ref="_M/MPFR_INT_CEIL_LOG2">MPFR_INT_CEIL_LOG2</a> (<a class="local col1 ref" href="#21w" title='w' data-ref="21w" data-ref-filename="21w">w</a>) + <var>14</var>;</td></tr>
<tr><th id="332">332</th><td>      <a class="macro" href="mpfr-impl.h.html#1828" title="(loop) = (64 - 0)" data-ref="_M/MPFR_ZIV_INIT">MPFR_ZIV_INIT</a> (<a class="local col7 ref" href="#179" title='loop' data-ref="37loop" data-ref-filename="37loop">loop</a>, w);</td></tr>
<tr><th id="333">333</th><td>      <b>while</b> (<var>1</var>)</td></tr>
<tr><th id="334">334</th><td>        {</td></tr>
<tr><th id="335">335</th><td>          <a class="macro" href="mpfr-impl.h.html#489" title="((void) 0)" data-ref="_M/MPFR_ASSERTD">MPFR_ASSERTD</a>(w &gt;= <var>3</var>);</td></tr>
<tr><th id="336">336</th><td>          <a class="ref fn" href="mpfr.h.html#mpfr_set_prec" title='mpfr_set_prec' data-ref="mpfr_set_prec" data-ref-filename="mpfr_set_prec">mpfr_set_prec</a> (<a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="local col1 ref" href="#21w" title='w' data-ref="21w" data-ref-filename="21w">w</a>);</td></tr>
<tr><th id="337">337</th><td>          <a class="ref fn" href="mpfr.h.html#mpfr_set_prec" title='mpfr_set_prec' data-ref="mpfr_set_prec" data-ref-filename="mpfr_set_prec">mpfr_set_prec</a> (<a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="local col1 ref" href="#21w" title='w' data-ref="21w" data-ref-filename="21w">w</a>);</td></tr>
<tr><th id="338">338</th><td>          <a class="ref fn" href="mpfr.h.html#mpfr_set_prec" title='mpfr_set_prec' data-ref="mpfr_set_prec" data-ref-filename="mpfr_set_prec">mpfr_set_prec</a> (<a class="local col4 ref" href="#24u" title='u' data-ref="24u" data-ref-filename="24u">u</a>, <a class="local col1 ref" href="#21w" title='w' data-ref="21w" data-ref-filename="21w">w</a>);</td></tr>
<tr><th id="339">339</th><td>          <a class="ref fn" href="mpfr.h.html#mpfr_set_prec" title='mpfr_set_prec' data-ref="mpfr_set_prec" data-ref-filename="mpfr_set_prec">mpfr_set_prec</a> (<a class="local col5 ref" href="#25v" title='v' data-ref="25v" data-ref-filename="25v">v</a>, <a class="local col1 ref" href="#21w" title='w' data-ref="21w" data-ref-filename="21w">w</a>);</td></tr>
<tr><th id="340">340</th><td>          <i>/* In the following, we write r for a real of absolute value</i></td></tr>
<tr><th id="341">341</th><td><i>             at most 2^(-w). Different instances of r may represent different</i></td></tr>
<tr><th id="342">342</th><td><i>             values. */</i></td></tr>
<tr><th id="343">343</th><td>          <a class="ref fn" href="mpfr.h.html#mpfr_ui_sub" title='mpfr_ui_sub' data-ref="mpfr_ui_sub" data-ref-filename="mpfr_ui_sub">mpfr_ui_sub</a> (<a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <var>2</var>, <a class="local col8 ref" href="#18z0" title='z0' data-ref="18z0" data-ref-filename="18z0">z0</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDD" title='MPFR_RNDD' data-ref="MPFR_RNDD" data-ref-filename="MPFR_RNDD">MPFR_RNDD</a>); <i>/* s = (2-z0) * (1+2r) &gt;= 1 */</i></td></tr>
<tr><th id="344">344</th><td>          <a class="macro" href="mpfr-impl.h.html#1196" title="mpfr_cache(t, __gmpfr_cache_const_pi,MPFR_RNDN)" data-ref="_M/mpfr_const_pi">mpfr_const_pi</a> (<a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);      <i>/* t = Pi * (1+r) */</i></td></tr>
<tr><th id="345">345</th><td>          <a class="ref fn" href="mpfr.h.html#mpfr_lngamma" title='mpfr_lngamma' data-ref="mpfr_lngamma" data-ref-filename="mpfr_lngamma">mpfr_lngamma</a> (<a class="local col4 ref" href="#24u" title='u' data-ref="24u" data-ref-filename="24u">u</a>, <a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>); <i>/* lngamma(2-x) */</i></td></tr>
<tr><th id="346">346</th><td>          <i>/* Let s = (2-z0) + h. By construction, -(2-z0)*2^(1-w) &lt;= h &lt;= 0.</i></td></tr>
<tr><th id="347">347</th><td><i>             We have lngamma(s) = lngamma(2-z0) + h*Psi(z), z in [2-z0+h,2-z0].</i></td></tr>
<tr><th id="348">348</th><td><i>             Since 2-z0+h = s &gt;= 1 and |Psi(x)| &lt;= max(1,log(x)) for x &gt;= 1,</i></td></tr>
<tr><th id="349">349</th><td><i>             the error on u is bounded by</i></td></tr>
<tr><th id="350">350</th><td><i>             ulp(u)/2 + (2-z0)*max(1,log(2-z0))*2^(1-w)</i></td></tr>
<tr><th id="351">351</th><td><i>             = (1/2 + (2-z0)*max(1,log(2-z0))*2^(1-E(u))) ulp(u) */</i></td></tr>
<tr><th id="352">352</th><td>          <a class="local col5 ref" href="#35d" title='d' data-ref="35d" data-ref-filename="35d">d</a> = (<em>double</em>) <a class="macro" href="mpfr-impl.h.html#925" title="((s)-&gt;_mpfr_exp)" data-ref="_M/MPFR_GET_EXP">MPFR_GET_EXP</a>(<a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>) * <var>0.694</var>; <i>/* upper bound for log(2-z0) */</i></td></tr>
<tr><th id="353">353</th><td>          <b>if</b> (<a class="macro" href="mpfr-impl.h.html#949" title="(((u)-&gt;_mpfr_exp) == (((-9223372036854775807L -1L))+1))" data-ref="_M/MPFR_IS_ZERO">MPFR_IS_ZERO</a>(<a class="local col4 ref" href="#24u" title='u' data-ref="24u" data-ref-filename="24u">u</a>)) <i>/* in that case the error on u is zero */</i></td></tr>
<tr><th id="354">354</th><td>            <a class="local col8 ref" href="#38err_u" title='err_u' data-ref="38err_u" data-ref-filename="38err_u">err_u</a> = <var>0</var>;</td></tr>
<tr><th id="355">355</th><td>          <b>else</b></td></tr>
<tr><th id="356">356</th><td>            <a class="local col8 ref" href="#38err_u" title='err_u' data-ref="38err_u" data-ref-filename="38err_u">err_u</a> = <a class="macro" href="mpfr-impl.h.html#925" title="((s)-&gt;_mpfr_exp)" data-ref="_M/MPFR_GET_EXP">MPFR_GET_EXP</a>(<a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>) + <a class="ref fn" href="mpfr-impl.h.html#__gmpfr_ceil_log2" title='__gmpfr_ceil_log2' data-ref="__gmpfr_ceil_log2" data-ref-filename="__gmpfr_ceil_log2">__gmpfr_ceil_log2</a> (<a class="local col5 ref" href="#35d" title='d' data-ref="35d" data-ref-filename="35d">d</a>) + <var>1</var> - <a class="macro" href="mpfr-impl.h.html#925" title="((u)-&gt;_mpfr_exp)" data-ref="_M/MPFR_GET_EXP">MPFR_GET_EXP</a>(<a class="local col4 ref" href="#24u" title='u' data-ref="24u" data-ref-filename="24u">u</a>);</td></tr>
<tr><th id="357">357</th><td>          <a class="local col8 ref" href="#38err_u" title='err_u' data-ref="38err_u" data-ref-filename="38err_u">err_u</a> = (<a class="local col8 ref" href="#38err_u" title='err_u' data-ref="38err_u" data-ref-filename="38err_u">err_u</a> &gt;= <var>0</var>) ? <a class="local col8 ref" href="#38err_u" title='err_u' data-ref="38err_u" data-ref-filename="38err_u">err_u</a> + <var>1</var> : <var>0</var>;</td></tr>
<tr><th id="358">358</th><td>          <i>/* now the error on u is bounded by 2^err_u ulps */</i></td></tr>
<tr><th id="359">359</th><td></td></tr>
<tr><th id="360">360</th><td>          <a class="ref fn" href="mpfr.h.html#mpfr_mul" title='mpfr_mul' data-ref="mpfr_mul" data-ref-filename="mpfr_mul">mpfr_mul</a> (<a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>); <i>/* Pi*(2-x) * (1+r)^4 */</i></td></tr>
<tr><th id="361">361</th><td>          <a class="local col3 ref" href="#33err_s" title='err_s' data-ref="33err_s" data-ref-filename="33err_s">err_s</a> = <a class="macro" href="mpfr-impl.h.html#925" title="((s)-&gt;_mpfr_exp)" data-ref="_M/MPFR_GET_EXP">MPFR_GET_EXP</a>(<a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>); <i>/* 2-x &lt;= 2^err_s */</i></td></tr>
<tr><th id="362">362</th><td>          <a class="ref fn" href="mpfr.h.html#mpfr_sin" title='mpfr_sin' data-ref="mpfr_sin" data-ref-filename="mpfr_sin">mpfr_sin</a> (<a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>); <i>/* sin(Pi*(2-x)) */</i></td></tr>
<tr><th id="363">363</th><td>          <i>/* the error on s is bounded by 1/2*ulp(s) + [(1+2^(-w))^4-1]*(2-x)</i></td></tr>
<tr><th id="364">364</th><td><i>             &lt;= 1/2*ulp(s) + 5*2^(-w)*(2-x) for w &gt;= 3</i></td></tr>
<tr><th id="365">365</th><td><i>             &lt;= (1/2 + 5 * 2^(-E(s)) * (2-x)) ulp(s) */</i></td></tr>
<tr><th id="366">366</th><td>          <a class="local col3 ref" href="#33err_s" title='err_s' data-ref="33err_s" data-ref-filename="33err_s">err_s</a> += <var>3</var> - <a class="macro" href="mpfr-impl.h.html#925" title="((s)-&gt;_mpfr_exp)" data-ref="_M/MPFR_GET_EXP">MPFR_GET_EXP</a>(<a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>);</td></tr>
<tr><th id="367">367</th><td>          <a class="local col3 ref" href="#33err_s" title='err_s' data-ref="33err_s" data-ref-filename="33err_s">err_s</a> = (<a class="local col3 ref" href="#33err_s" title='err_s' data-ref="33err_s" data-ref-filename="33err_s">err_s</a> &gt;= <var>0</var>) ? <a class="local col3 ref" href="#33err_s" title='err_s' data-ref="33err_s" data-ref-filename="33err_s">err_s</a> + <var>1</var> : <var>0</var>;</td></tr>
<tr><th id="368">368</th><td>          <i>/* the error on s is bounded by 2^err_s ulp(s), thus by</i></td></tr>
<tr><th id="369">369</th><td><i>             2^(err_s+1)*2^(-w)*|s| since ulp(s) &lt;= 2^(1-w)*|s|.</i></td></tr>
<tr><th id="370">370</th><td><i>             Now n*2^(-w) can always be written |(1+r)^n-1| for some</i></td></tr>
<tr><th id="371">371</th><td><i>             |r|&lt;=2^(-w), thus taking n=2^(err_s+1) we see that</i></td></tr>
<tr><th id="372">372</th><td><i>             |S - s| &lt;= |(1+r)^(2^(err_s+1))-1| * |s|, where S is the</i></td></tr>
<tr><th id="373">373</th><td><i>             true value.</i></td></tr>
<tr><th id="374">374</th><td><i>             In fact if ulp(s) &lt;= ulp(S) the same inequality holds for</i></td></tr>
<tr><th id="375">375</th><td><i>             |S| instead of |s| in the right hand side, i.e., we can</i></td></tr>
<tr><th id="376">376</th><td><i>             write s = (1+r)^(2^(err_s+1)) * S.</i></td></tr>
<tr><th id="377">377</th><td><i>             But if ulp(S) &lt; ulp(s), we need to add one ``bit'' to the error,</i></td></tr>
<tr><th id="378">378</th><td><i>             to get s = (1+r)^(2^(err_s+2)) * S. This is true since with</i></td></tr>
<tr><th id="379">379</th><td><i>             E = n*2^(-w) we have |s - S| &lt;= E * |s|, thus</i></td></tr>
<tr><th id="380">380</th><td><i>             |s - S| &lt;= E/(1-E) * |S|.</i></td></tr>
<tr><th id="381">381</th><td><i>             Now E/(1-E) is bounded by 2E as long as E&lt;=1/2,</i></td></tr>
<tr><th id="382">382</th><td><i>             and 2E can be written (1+r)^(2n)-1 as above.</i></td></tr>
<tr><th id="383">383</th><td><i>          */</i></td></tr>
<tr><th id="384">384</th><td>          <a class="local col3 ref" href="#33err_s" title='err_s' data-ref="33err_s" data-ref-filename="33err_s">err_s</a> += <var>2</var>; <i>/* exponent of relative error */</i></td></tr>
<tr><th id="385">385</th><td></td></tr>
<tr><th id="386">386</th><td>          <a class="ref fn" href="mpfr.h.html#mpfr_sub_ui" title='mpfr_sub_ui' data-ref="mpfr_sub_ui" data-ref-filename="mpfr_sub_ui">mpfr_sub_ui</a> (<a class="local col5 ref" href="#25v" title='v' data-ref="25v" data-ref-filename="25v">v</a>, <a class="local col8 ref" href="#18z0" title='z0' data-ref="18z0" data-ref-filename="18z0">z0</a>, <var>1</var>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>); <i>/* v = (x-1) * (1+r) */</i></td></tr>
<tr><th id="387">387</th><td>          <a class="ref fn" href="mpfr.h.html#mpfr_mul" title='mpfr_mul' data-ref="mpfr_mul" data-ref-filename="mpfr_mul">mpfr_mul</a> (<a class="local col5 ref" href="#25v" title='v' data-ref="25v" data-ref-filename="25v">v</a>, <a class="local col5 ref" href="#25v" title='v' data-ref="25v" data-ref-filename="25v">v</a>, <a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>); <i>/* v = Pi*(x-1) * (1+r)^3 */</i></td></tr>
<tr><th id="388">388</th><td>          <a class="ref fn" href="mpfr.h.html#mpfr_div" title='mpfr_div' data-ref="mpfr_div" data-ref-filename="mpfr_div">mpfr_div</a> (<a class="local col5 ref" href="#25v" title='v' data-ref="25v" data-ref-filename="25v">v</a>, <a class="local col5 ref" href="#25v" title='v' data-ref="25v" data-ref-filename="25v">v</a>, <a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>); <i>/* Pi*(x-1)/sin(Pi*(2-x)) */</i></td></tr>
<tr><th id="389">389</th><td>          <a class="macro" href="mpfr.h.html#826" title="mpfr_set4(v,v,MPFR_RNDN,1)" data-ref="_M/mpfr_abs">mpfr_abs</a> (<a class="local col5 ref" href="#25v" title='v' data-ref="25v" data-ref-filename="25v">v</a>, <a class="local col5 ref" href="#25v" title='v' data-ref="25v" data-ref-filename="25v">v</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="390">390</th><td>          <i>/* (1+r)^(3+2^err_s+1) */</i></td></tr>
<tr><th id="391">391</th><td>          <a class="local col3 ref" href="#33err_s" title='err_s' data-ref="33err_s" data-ref-filename="33err_s">err_s</a> = (<a class="local col3 ref" href="#33err_s" title='err_s' data-ref="33err_s" data-ref-filename="33err_s">err_s</a> &lt;= <var>1</var>) ? <var>3</var> : <a class="local col3 ref" href="#33err_s" title='err_s' data-ref="33err_s" data-ref-filename="33err_s">err_s</a> + <var>1</var>;</td></tr>
<tr><th id="392">392</th><td>          <i>/* now (1+r)^M with M &lt;= 2^err_s */</i></td></tr>
<tr><th id="393">393</th><td>          <a class="ref fn" href="mpfr.h.html#mpfr_log" title='mpfr_log' data-ref="mpfr_log" data-ref-filename="mpfr_log">mpfr_log</a> (<a class="local col5 ref" href="#25v" title='v' data-ref="25v" data-ref-filename="25v">v</a>, <a class="local col5 ref" href="#25v" title='v' data-ref="25v" data-ref-filename="25v">v</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="394">394</th><td>          <i>/* log(v*(1+e)) = log(v)+log(1+e) where |e| &lt;= 2^(err_s-w).</i></td></tr>
<tr><th id="395">395</th><td><i>             Since |log(1+e)| &lt;= 2*e for |e| &lt;= 1/4, the error on v is</i></td></tr>
<tr><th id="396">396</th><td><i>             bounded by ulp(v)/2 + 2^(err_s+1-w). */</i></td></tr>
<tr><th id="397">397</th><td>          <b>if</b> (<a class="local col3 ref" href="#33err_s" title='err_s' data-ref="33err_s" data-ref-filename="33err_s">err_s</a> + <var>2</var> &gt; <a class="local col1 ref" href="#21w" title='w' data-ref="21w" data-ref-filename="21w">w</a>)</td></tr>
<tr><th id="398">398</th><td>            {</td></tr>
<tr><th id="399">399</th><td>              <a class="local col1 ref" href="#21w" title='w' data-ref="21w" data-ref-filename="21w">w</a> += <a class="local col3 ref" href="#33err_s" title='err_s' data-ref="33err_s" data-ref-filename="33err_s">err_s</a> + <var>2</var>;</td></tr>
<tr><th id="400">400</th><td>            }</td></tr>
<tr><th id="401">401</th><td>          <b>else</b></td></tr>
<tr><th id="402">402</th><td>            {</td></tr>
<tr><th id="403">403</th><td>              <i>/* if v = 0 here, it was 1 before the call to mpfr_log,</i></td></tr>
<tr><th id="404">404</th><td><i>                 thus the error on v was zero */</i></td></tr>
<tr><th id="405">405</th><td>              <b>if</b> (!<a class="macro" href="mpfr-impl.h.html#949" title="(((v)-&gt;_mpfr_exp) == (((-9223372036854775807L -1L))+1))" data-ref="_M/MPFR_IS_ZERO">MPFR_IS_ZERO</a>(<a class="local col5 ref" href="#25v" title='v' data-ref="25v" data-ref-filename="25v">v</a>))</td></tr>
<tr><th id="406">406</th><td>                <a class="local col3 ref" href="#33err_s" title='err_s' data-ref="33err_s" data-ref-filename="33err_s">err_s</a> += <var>1</var> - <a class="macro" href="mpfr-impl.h.html#925" title="((v)-&gt;_mpfr_exp)" data-ref="_M/MPFR_GET_EXP">MPFR_GET_EXP</a>(<a class="local col5 ref" href="#25v" title='v' data-ref="25v" data-ref-filename="25v">v</a>);</td></tr>
<tr><th id="407">407</th><td>              <a class="local col3 ref" href="#33err_s" title='err_s' data-ref="33err_s" data-ref-filename="33err_s">err_s</a> = (<a class="local col3 ref" href="#33err_s" title='err_s' data-ref="33err_s" data-ref-filename="33err_s">err_s</a> &gt;= <var>0</var>) ? <a class="local col3 ref" href="#33err_s" title='err_s' data-ref="33err_s" data-ref-filename="33err_s">err_s</a> + <var>1</var> : <var>0</var>;</td></tr>
<tr><th id="408">408</th><td>              <i>/* the error on v is bounded by 2^err_s ulps */</i></td></tr>
<tr><th id="409">409</th><td>              <a class="local col8 ref" href="#38err_u" title='err_u' data-ref="38err_u" data-ref-filename="38err_u">err_u</a> += <a class="macro" href="mpfr-impl.h.html#925" title="((u)-&gt;_mpfr_exp)" data-ref="_M/MPFR_GET_EXP">MPFR_GET_EXP</a>(<a class="local col4 ref" href="#24u" title='u' data-ref="24u" data-ref-filename="24u">u</a>); <i>/* absolute error on u */</i></td></tr>
<tr><th id="410">410</th><td>              <b>if</b> (!<a class="macro" href="mpfr-impl.h.html#949" title="(((v)-&gt;_mpfr_exp) == (((-9223372036854775807L -1L))+1))" data-ref="_M/MPFR_IS_ZERO">MPFR_IS_ZERO</a>(<a class="local col5 ref" href="#25v" title='v' data-ref="25v" data-ref-filename="25v">v</a>)) <i>/* same as above */</i></td></tr>
<tr><th id="411">411</th><td>                <a class="local col3 ref" href="#33err_s" title='err_s' data-ref="33err_s" data-ref-filename="33err_s">err_s</a> += <a class="macro" href="mpfr-impl.h.html#925" title="((v)-&gt;_mpfr_exp)" data-ref="_M/MPFR_GET_EXP">MPFR_GET_EXP</a>(<a class="local col5 ref" href="#25v" title='v' data-ref="25v" data-ref-filename="25v">v</a>); <i>/* absolute error on v */</i></td></tr>
<tr><th id="412">412</th><td>              <a class="ref fn" href="mpfr.h.html#mpfr_sub" title='mpfr_sub' data-ref="mpfr_sub" data-ref-filename="mpfr_sub">mpfr_sub</a> (<a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="local col5 ref" href="#25v" title='v' data-ref="25v" data-ref-filename="25v">v</a>, <a class="local col4 ref" href="#24u" title='u' data-ref="24u" data-ref-filename="24u">u</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="413">413</th><td>              <i>/* the total error on s is bounded by ulp(s)/2 + 2^(err_u-w)</i></td></tr>
<tr><th id="414">414</th><td><i>                 + 2^(err_s-w) &lt;= ulp(s)/2 + 2^(max(err_u,err_s)+1-w) */</i></td></tr>
<tr><th id="415">415</th><td>              <a class="local col3 ref" href="#33err_s" title='err_s' data-ref="33err_s" data-ref-filename="33err_s">err_s</a> = (<a class="local col3 ref" href="#33err_s" title='err_s' data-ref="33err_s" data-ref-filename="33err_s">err_s</a> &gt;= <a class="local col8 ref" href="#38err_u" title='err_u' data-ref="38err_u" data-ref-filename="38err_u">err_u</a>) ? <a class="local col3 ref" href="#33err_s" title='err_s' data-ref="33err_s" data-ref-filename="33err_s">err_s</a> : <a class="local col8 ref" href="#38err_u" title='err_u' data-ref="38err_u" data-ref-filename="38err_u">err_u</a>;</td></tr>
<tr><th id="416">416</th><td>              <a class="local col3 ref" href="#33err_s" title='err_s' data-ref="33err_s" data-ref-filename="33err_s">err_s</a> += <var>1</var> - <a class="macro" href="mpfr-impl.h.html#925" title="((s)-&gt;_mpfr_exp)" data-ref="_M/MPFR_GET_EXP">MPFR_GET_EXP</a>(<a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>); <i>/* error is 2^err_s ulp(s) */</i></td></tr>
<tr><th id="417">417</th><td>              <a class="local col3 ref" href="#33err_s" title='err_s' data-ref="33err_s" data-ref-filename="33err_s">err_s</a> = (<a class="local col3 ref" href="#33err_s" title='err_s' data-ref="33err_s" data-ref-filename="33err_s">err_s</a> &gt;= <var>0</var>) ? <a class="local col3 ref" href="#33err_s" title='err_s' data-ref="33err_s" data-ref-filename="33err_s">err_s</a> + <var>1</var> : <var>0</var>;</td></tr>
<tr><th id="418">418</th><td>              <b>if</b> (<a class="macro" href="mpfr-impl.h.html#1711" title="(!(((s)-&gt;_mpfr_exp) &lt;= (((-9223372036854775807L -1L))+3)) &amp;&amp; mpfr_round_p (((s)-&gt;_mpfr_d), ((((((void) 0), (((s)-&gt;_mpfr_prec))) - 1) / (64 - 0)) + 1), (w - err_s), (precy) + ((rnd)==MPFR_RNDN)))" data-ref="_M/MPFR_CAN_ROUND">MPFR_CAN_ROUND</a> (<a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="local col1 ref" href="#21w" title='w' data-ref="21w" data-ref-filename="21w">w</a> - <a class="local col3 ref" href="#33err_s" title='err_s' data-ref="33err_s" data-ref-filename="33err_s">err_s</a>, <a class="local col0 ref" href="#20precy" title='precy' data-ref="20precy" data-ref-filename="20precy">precy</a>, <a class="local col9 ref" href="#19rnd" title='rnd' data-ref="19rnd" data-ref-filename="19rnd">rnd</a>))</td></tr>
<tr><th id="419">419</th><td>                <b>goto</b> <a class="lbl" href="#39end" data-ref="39end" data-ref-filename="39end">end</a>;</td></tr>
<tr><th id="420">420</th><td>            }</td></tr>
<tr><th id="421">421</th><td>          <a class="macro" href="mpfr-impl.h.html#1829" title="((w) = (((void) (((__builtin_expect(!!((loop) &lt;= ((mpfr_prec_t) ((((mpfr_uprec_t) -1) &gt;&gt; 1) - 256)) - (w)), 1))) || (mpfr_assert_fail (&quot;/___NETBSD_SRC___/external/lgpl3/mpfr/dist/src/lngamma.c&quot;, 421, &quot;(loop) &lt;= ((mpfr_prec_t) ((((mpfr_uprec_t) -1) &gt;&gt; 1) - 256)) - (w)&quot;),((void) 0),0))), (w) + (loop)), (loop) = (w)/2)" data-ref="_M/MPFR_ZIV_NEXT">MPFR_ZIV_NEXT</a> (<a class="local col7 ref" href="#179" title='loop' data-ref="37loop" data-ref-filename="37loop">loop</a>, <a class="local col1 ref" href="#21w" title='w' data-ref="21w" data-ref-filename="21w">w</a>);</td></tr>
<tr><th id="422">422</th><td>        }</td></tr>
<tr><th id="423">423</th><td>      <a class="macro" href="mpfr-impl.h.html#1830" title="" data-ref="_M/MPFR_ZIV_FREE">MPFR_ZIV_FREE</a> (loop);</td></tr>
<tr><th id="424">424</th><td>    }</td></tr>
<tr><th id="425">425</th><td></td></tr>
<tr><th id="426">426</th><td>  <i>/* now z0 &gt; 1 */</i></td></tr>
<tr><th id="427">427</th><td></td></tr>
<tr><th id="428">428</th><td>  <a class="macro" href="mpfr-impl.h.html#489" title="((void) 0)" data-ref="_M/MPFR_ASSERTD">MPFR_ASSERTD</a> (compared &gt; <var>0</var>);</td></tr>
<tr><th id="429">429</th><td></td></tr>
<tr><th id="430">430</th><td>  <i>/* since k is O(w), the value of log(z0*...*(z0+k-1)) is about w*log(w),</i></td></tr>
<tr><th id="431">431</th><td><i>     so there is a cancellation of ~log(w) in the argument reconstruction */</i></td></tr>
<tr><th id="432">432</th><td>  <a class="local col1 ref" href="#21w" title='w' data-ref="21w" data-ref-filename="21w">w</a> = <a class="local col0 ref" href="#20precy" title='precy' data-ref="20precy" data-ref-filename="20precy">precy</a> + <a class="macro" href="mpfr-impl.h.html#1331" title="((__builtin_expect(!!((precy) == 1), 0)) ? 0 : __extension__ ({ int _b; mp_limb_t _limb; ((void) (((__builtin_expect(!!((precy) &gt; 1), 1))) || (mpfr_assert_fail (&quot;/___NETBSD_SRC___/external/lgpl3/mpfr/dist/src/lngamma.c&quot;, 432, &quot;(precy) &gt; 1&quot;),((void) 0),0))); _limb = (precy) - 1; ((void) (((__builtin_expect(!!(_limb == (precy) - 1), 1))) || (mpfr_assert_fail (&quot;/___NETBSD_SRC___/external/lgpl3/mpfr/dist/src/lngamma.c&quot;, 432, &quot;_limb == (precy) - 1&quot;),((void) 0),0))); do { UDItype __cbtmp; ((void) 0); __asm__ (&quot;bsrq %1,%0&quot; : &quot;=r&quot; (__cbtmp) : &quot;rm&quot; ((UDItype)(_limb))); (_b) = __cbtmp ^ 63; } while (0); ((64 - 0) - _b); }))" data-ref="_M/MPFR_INT_CEIL_LOG2">MPFR_INT_CEIL_LOG2</a> (<a class="local col0 ref" href="#20precy" title='precy' data-ref="20precy" data-ref-filename="20precy">precy</a>);</td></tr>
<tr><th id="433">433</th><td>  <a class="local col1 ref" href="#21w" title='w' data-ref="21w" data-ref-filename="21w">w</a> += <a class="macro" href="mpfr-impl.h.html#1331" title="((__builtin_expect(!!((w) == 1), 0)) ? 0 : __extension__ ({ int _b; mp_limb_t _limb; ((void) (((__builtin_expect(!!((w) &gt; 1), 1))) || (mpfr_assert_fail (&quot;/___NETBSD_SRC___/external/lgpl3/mpfr/dist/src/lngamma.c&quot;, 433, &quot;(w) &gt; 1&quot;),((void) 0),0))); _limb = (w) - 1; ((void) (((__builtin_expect(!!(_limb == (w) - 1), 1))) || (mpfr_assert_fail (&quot;/___NETBSD_SRC___/external/lgpl3/mpfr/dist/src/lngamma.c&quot;, 433, &quot;_limb == (w) - 1&quot;),((void) 0),0))); do { UDItype __cbtmp; ((void) 0); __asm__ (&quot;bsrq %1,%0&quot; : &quot;=r&quot; (__cbtmp) : &quot;rm&quot; ((UDItype)(_limb))); (_b) = __cbtmp ^ 63; } while (0); ((64 - 0) - _b); }))" data-ref="_M/MPFR_INT_CEIL_LOG2">MPFR_INT_CEIL_LOG2</a> (<a class="local col1 ref" href="#21w" title='w' data-ref="21w" data-ref-filename="21w">w</a>) + <var>13</var>;</td></tr>
<tr><th id="434">434</th><td>  <a class="macro" href="mpfr-impl.h.html#1828" title="(loop) = (64 - 0)" data-ref="_M/MPFR_ZIV_INIT">MPFR_ZIV_INIT</a> (<a class="local col7 ref" href="#179" title='loop' data-ref="37loop" data-ref-filename="37loop">loop</a>, w);</td></tr>
<tr><th id="435">435</th><td>  <b>while</b> (<var>1</var>)</td></tr>
<tr><th id="436">436</th><td>    {</td></tr>
<tr><th id="437">437</th><td>      <a class="macro" href="mpfr-impl.h.html#489" title="((void) 0)" data-ref="_M/MPFR_ASSERTD">MPFR_ASSERTD</a> (w &gt;= <var>3</var>);</td></tr>
<tr><th id="438">438</th><td></td></tr>
<tr><th id="439">439</th><td>      <i>/* argument reduction: we compute gamma(z0 + k), where the series</i></td></tr>
<tr><th id="440">440</th><td><i>         has error term B_{2n}/(z0+k)^(2n) ~ (n/(Pi*e*(z0+k)))^(2n)</i></td></tr>
<tr><th id="441">441</th><td><i>         and we need k steps of argument reconstruction. Assuming k is large</i></td></tr>
<tr><th id="442">442</th><td><i>         with respect to z0, and k = n, we get 1/(Pi*e)^(2n) ~ 2^(-w), i.e.,</i></td></tr>
<tr><th id="443">443</th><td><i>         k ~ w*log(2)/2/log(Pi*e) ~ 0.1616 * w.</i></td></tr>
<tr><th id="444">444</th><td><i>         However, since the series is slightly more expensive to compute,</i></td></tr>
<tr><th id="445">445</th><td><i>         the optimal value seems to be k ~ 0.25 * w experimentally (with</i></td></tr>
<tr><th id="446">446</th><td><i>         caching of Bernoulli numbers).</i></td></tr>
<tr><th id="447">447</th><td><i>         For only one computation of gamma with large precision, it is better</i></td></tr>
<tr><th id="448">448</th><td><i>         to set k to a larger value, say k ~ w. */</i></td></tr>
<tr><th id="449">449</th><td>      <a class="ref fn" href="mpfr.h.html#mpfr_set_prec" title='mpfr_set_prec' data-ref="mpfr_set_prec" data-ref-filename="mpfr_set_prec">mpfr_set_prec</a> (<a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <var>53</var>);</td></tr>
<tr><th id="450">450</th><td>      <a class="ref fn" href="#mpfr_gamma_alpha" title='mpfr_gamma_alpha' data-ref="mpfr_gamma_alpha" data-ref-filename="mpfr_gamma_alpha">mpfr_gamma_alpha</a> (<a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="local col1 ref" href="#21w" title='w' data-ref="21w" data-ref-filename="21w">w</a>);</td></tr>
<tr><th id="451">451</th><td>      <a class="ref fn" href="mpfr.h.html#mpfr_set_ui_2exp" title='mpfr_set_ui_2exp' data-ref="mpfr_set_ui_2exp" data-ref-filename="mpfr_set_ui_2exp">mpfr_set_ui_2exp</a> (<a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <var>4</var>, -<var>4</var>, <a class="enum" href="mpfr.h.html#MPFR_RNDU" title='MPFR_RNDU' data-ref="MPFR_RNDU" data-ref-filename="MPFR_RNDU">MPFR_RNDU</a>);</td></tr>
<tr><th id="452">452</th><td>      <a class="macro" href="mpfr.h.html#905" title="(__builtin_constant_p (w) &amp;&amp; (mpfr_ulong) (w) &gt;= 1 &amp;&amp; ((mpfr_ulong) (w) &amp; ((mpfr_ulong) (w) - 1)) == 0 ? mpfr_mul_2si((s), (s), __builtin_ctzl (w), (MPFR_RNDU)) : mpfr_mul_ui ((s), (s), (w), (MPFR_RNDU)))" data-ref="_M/mpfr_mul_ui">mpfr_mul_ui</a> (<a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="local col1 ref" href="#21w" title='w' data-ref="21w" data-ref-filename="21w">w</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDU" title='MPFR_RNDU' data-ref="MPFR_RNDU" data-ref-filename="MPFR_RNDU">MPFR_RNDU</a>);</td></tr>
<tr><th id="453">453</th><td>      <b>if</b> (<a class="macro" href="mpfr.h.html#830" title="mpfr_cmp3(z0, s, 1)" data-ref="_M/mpfr_cmp">mpfr_cmp</a> (<a class="local col8 ref" href="#18z0" title='z0' data-ref="18z0" data-ref-filename="18z0">z0</a>, <a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>) &lt; <var>0</var>)</td></tr>
<tr><th id="454">454</th><td>        {</td></tr>
<tr><th id="455">455</th><td>          <a class="ref fn" href="mpfr.h.html#mpfr_sub" title='mpfr_sub' data-ref="mpfr_sub" data-ref-filename="mpfr_sub">mpfr_sub</a> (<a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="local col8 ref" href="#18z0" title='z0' data-ref="18z0" data-ref-filename="18z0">z0</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDU" title='MPFR_RNDU' data-ref="MPFR_RNDU" data-ref-filename="MPFR_RNDU">MPFR_RNDU</a>);</td></tr>
<tr><th id="456">456</th><td>          <a class="local col8 ref" href="#28k" title='k' data-ref="28k" data-ref-filename="28k">k</a> = <a class="ref fn" href="mpfr.h.html#mpfr_get_ui" title='mpfr_get_ui' data-ref="mpfr_get_ui" data-ref-filename="mpfr_get_ui">mpfr_get_ui</a> (<a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDU" title='MPFR_RNDU' data-ref="MPFR_RNDU" data-ref-filename="MPFR_RNDU">MPFR_RNDU</a>);</td></tr>
<tr><th id="457">457</th><td>          <b>if</b> (<a class="local col8 ref" href="#28k" title='k' data-ref="28k" data-ref-filename="28k">k</a> &lt; <var>3</var>)</td></tr>
<tr><th id="458">458</th><td>            <a class="local col8 ref" href="#28k" title='k' data-ref="28k" data-ref-filename="28k">k</a> = <var>3</var>;</td></tr>
<tr><th id="459">459</th><td>        }</td></tr>
<tr><th id="460">460</th><td>      <b>else</b></td></tr>
<tr><th id="461">461</th><td>        <a class="local col8 ref" href="#28k" title='k' data-ref="28k" data-ref-filename="28k">k</a> = <var>3</var>;</td></tr>
<tr><th id="462">462</th><td></td></tr>
<tr><th id="463">463</th><td>      <a class="ref fn" href="mpfr.h.html#mpfr_set_prec" title='mpfr_set_prec' data-ref="mpfr_set_prec" data-ref-filename="mpfr_set_prec">mpfr_set_prec</a> (<a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="local col1 ref" href="#21w" title='w' data-ref="21w" data-ref-filename="21w">w</a>);</td></tr>
<tr><th id="464">464</th><td>      <a class="ref fn" href="mpfr.h.html#mpfr_set_prec" title='mpfr_set_prec' data-ref="mpfr_set_prec" data-ref-filename="mpfr_set_prec">mpfr_set_prec</a> (<a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="local col1 ref" href="#21w" title='w' data-ref="21w" data-ref-filename="21w">w</a>);</td></tr>
<tr><th id="465">465</th><td>      <a class="ref fn" href="mpfr.h.html#mpfr_set_prec" title='mpfr_set_prec' data-ref="mpfr_set_prec" data-ref-filename="mpfr_set_prec">mpfr_set_prec</a> (<a class="local col4 ref" href="#24u" title='u' data-ref="24u" data-ref-filename="24u">u</a>, <a class="local col1 ref" href="#21w" title='w' data-ref="21w" data-ref-filename="21w">w</a>);</td></tr>
<tr><th id="466">466</th><td>      <a class="ref fn" href="mpfr.h.html#mpfr_set_prec" title='mpfr_set_prec' data-ref="mpfr_set_prec" data-ref-filename="mpfr_set_prec">mpfr_set_prec</a> (<a class="local col5 ref" href="#25v" title='v' data-ref="25v" data-ref-filename="25v">v</a>, <a class="local col1 ref" href="#21w" title='w' data-ref="21w" data-ref-filename="21w">w</a>);</td></tr>
<tr><th id="467">467</th><td>      <a class="ref fn" href="mpfr.h.html#mpfr_set_prec" title='mpfr_set_prec' data-ref="mpfr_set_prec" data-ref-filename="mpfr_set_prec">mpfr_set_prec</a> (<a class="local col6 ref" href="#26z" title='z' data-ref="26z" data-ref-filename="26z">z</a>, <a class="local col1 ref" href="#21w" title='w' data-ref="21w" data-ref-filename="21w">w</a>);</td></tr>
<tr><th id="468">468</th><td></td></tr>
<tr><th id="469">469</th><td>      <a class="ref fn" href="mpfr.h.html#mpfr_add_ui" title='mpfr_add_ui' data-ref="mpfr_add_ui" data-ref-filename="mpfr_add_ui">mpfr_add_ui</a> (<a class="local col6 ref" href="#26z" title='z' data-ref="26z" data-ref-filename="26z">z</a>, <a class="local col8 ref" href="#18z0" title='z0' data-ref="18z0" data-ref-filename="18z0">z0</a>, <a class="local col8 ref" href="#28k" title='k' data-ref="28k" data-ref-filename="28k">k</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="470">470</th><td>      <i>/* z = (z0+k)*(1+t1) with |t1| &lt;= 2^(-w) */</i></td></tr>
<tr><th id="471">471</th><td></td></tr>
<tr><th id="472">472</th><td>      <i>/* z &gt;= 4 ensures the relative error on log(z) is small,</i></td></tr>
<tr><th id="473">473</th><td><i>         and also (z-1/2)*log(z)-z &gt;= 0 */</i></td></tr>
<tr><th id="474">474</th><td>      <a class="macro" href="mpfr-impl.h.html#489" title="((void) 0)" data-ref="_M/MPFR_ASSERTD">MPFR_ASSERTD</a> (<a class="macro" href="mpfr.h.html#872" title="(__builtin_constant_p (4) &amp;&amp; (mpfr_ulong) (4) == 0 ? (mpfr_sgn) (z) : mpfr_cmp_ui_2exp ((z), (4), 0))" data-ref="_M/mpfr_cmp_ui">mpfr_cmp_ui</a> (z, <var>4</var>) &gt;= <var>0</var>);</td></tr>
<tr><th id="475">475</th><td></td></tr>
<tr><th id="476">476</th><td>      <a class="ref fn" href="mpfr.h.html#mpfr_log" title='mpfr_log' data-ref="mpfr_log" data-ref-filename="mpfr_log">mpfr_log</a> (<a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="local col6 ref" href="#26z" title='z' data-ref="26z" data-ref-filename="26z">z</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>); <i>/* log(z) */</i></td></tr>
<tr><th id="477">477</th><td>      <i>/* we have s = log((z0+k)*(1+t1))*(1+t2) with |t1|, |t2| &lt;= 2^(-w).</i></td></tr>
<tr><th id="478">478</th><td><i>         Since w &gt;= 2 and z0+k &gt;= 4, we can write log((z0+k)*(1+t1))</i></td></tr>
<tr><th id="479">479</th><td><i>         = log(z0+k) * (1+t3) with |t3| &lt;= 2^(-w), thus we have</i></td></tr>
<tr><th id="480">480</th><td><i>         s = log(z0+k) * (1+t4)^2 with |t4| &lt;= 2^(-w) */</i></td></tr>
<tr><th id="481">481</th><td>      <a class="ref fn" href="mpfr.h.html#mpfr_mul_2ui" title='mpfr_mul_2ui' data-ref="mpfr_mul_2ui" data-ref-filename="mpfr_mul_2ui">mpfr_mul_2ui</a> (<a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="local col6 ref" href="#26z" title='z' data-ref="26z" data-ref-filename="26z">z</a>, <var>1</var>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>); <i>/* t = 2z * (1+t5) */</i></td></tr>
<tr><th id="482">482</th><td>      <a class="ref fn" href="mpfr.h.html#mpfr_sub_ui" title='mpfr_sub_ui' data-ref="mpfr_sub_ui" data-ref-filename="mpfr_sub_ui">mpfr_sub_ui</a> (<a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <var>1</var>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>); <i>/* t = 2z-1 * (1+t6)^3 */</i></td></tr>
<tr><th id="483">483</th><td>      <i>/* since we can write 2z*(1+t5) = (2z-1)*(1+t5') with</i></td></tr>
<tr><th id="484">484</th><td><i>         t5' = 2z/(2z-1) * t5, thus |t5'| &lt;= 8/7 * t5 */</i></td></tr>
<tr><th id="485">485</th><td>      <a class="ref fn" href="mpfr.h.html#mpfr_mul" title='mpfr_mul' data-ref="mpfr_mul" data-ref-filename="mpfr_mul">mpfr_mul</a> (<a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>); <i>/* (2z-1)*log(z) * (1+t7)^6 */</i></td></tr>
<tr><th id="486">486</th><td>      <a class="ref fn" href="mpfr.h.html#mpfr_div_2ui" title='mpfr_div_2ui' data-ref="mpfr_div_2ui" data-ref-filename="mpfr_div_2ui">mpfr_div_2ui</a> (<a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <var>1</var>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>); <i>/* (z-1/2)*log(z) * (1+t7)^6 */</i></td></tr>
<tr><th id="487">487</th><td>      <a class="ref fn" href="mpfr.h.html#mpfr_sub" title='mpfr_sub' data-ref="mpfr_sub" data-ref-filename="mpfr_sub">mpfr_sub</a> (<a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="local col6 ref" href="#26z" title='z' data-ref="26z" data-ref-filename="26z">z</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>); <i>/* (z-1/2)*log(z)-z */</i></td></tr>
<tr><th id="488">488</th><td>      <i>/* s = [(z-1/2)*log(z)-z]*(1+u)^14, s &gt;= 1/2 */</i></td></tr>
<tr><th id="489">489</th><td></td></tr>
<tr><th id="490">490</th><td>      <a class="ref fn" href="mpfr.h.html#mpfr_ui_div" title='mpfr_ui_div' data-ref="mpfr_ui_div" data-ref-filename="mpfr_ui_div">mpfr_ui_div</a> (<a class="local col4 ref" href="#24u" title='u' data-ref="24u" data-ref-filename="24u">u</a>, <var>1</var>, <a class="local col6 ref" href="#26z" title='z' data-ref="26z" data-ref-filename="26z">z</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>); <i>/* 1/z * (1+u), u &lt;= 1/4 since z &gt;= 4 */</i></td></tr>
<tr><th id="491">491</th><td></td></tr>
<tr><th id="492">492</th><td>      <i>/* the first term is B[2]/2/z = 1/12/z: t=1/12/z, C[2]=1 */</i></td></tr>
<tr><th id="493">493</th><td>      <a class="macro" href="mpfr.h.html#911" title="(__builtin_constant_p (12) &amp;&amp; (mpfr_ulong) (12) &gt;= 1 &amp;&amp; ((mpfr_ulong) (12) &amp; ((mpfr_ulong) (12) - 1)) == 0 ? mpfr_mul_2si((t), (u), - __builtin_ctzl (12), (MPFR_RNDN)) : mpfr_div_ui ((t), (u), (12), (MPFR_RNDN)))" data-ref="_M/mpfr_div_ui">mpfr_div_ui</a> (<a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="local col4 ref" href="#24u" title='u' data-ref="24u" data-ref-filename="24u">u</a>, <var>12</var>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>); <i>/* 1/(12z) * (1+u)^2, t &lt;= 3/128 */</i></td></tr>
<tr><th id="494">494</th><td>      <a class="macro" href="mpfr.h.html#825" title="mpfr_set4(v,t,MPFR_RNDN,((t)-&gt;_mpfr_sign))" data-ref="_M/mpfr_set">mpfr_set</a> (<a class="local col5 ref" href="#25v" title='v' data-ref="25v" data-ref-filename="25v">v</a>, <a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);        <i>/* (1+u)^2, v &lt; 2^(-5) */</i></td></tr>
<tr><th id="495">495</th><td>      <a class="ref fn" href="mpfr.h.html#mpfr_add" title='mpfr_add' data-ref="mpfr_add" data-ref-filename="mpfr_add">mpfr_add</a> (<a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="local col5 ref" href="#25v" title='v' data-ref="25v" data-ref-filename="25v">v</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);     <i>/* (1+u)^15 */</i></td></tr>
<tr><th id="496">496</th><td></td></tr>
<tr><th id="497">497</th><td>      <a class="ref fn" href="mpfr.h.html#mpfr_mul" title='mpfr_mul' data-ref="mpfr_mul" data-ref-filename="mpfr_mul">mpfr_mul</a> (<a class="local col4 ref" href="#24u" title='u' data-ref="24u" data-ref-filename="24u">u</a>, <a class="local col4 ref" href="#24u" title='u' data-ref="24u" data-ref-filename="24u">u</a>, <a class="local col4 ref" href="#24u" title='u' data-ref="24u" data-ref-filename="24u">u</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>); <i>/* 1/z^2 * (1+u)^3 */</i></td></tr>
<tr><th id="498">498</th><td></td></tr>
<tr><th id="499">499</th><td>      <i>/* m &lt;= maxm ensures that 2*m*(2*m+1) &lt;= ULONG_MAX */</i></td></tr>
<tr><th id="500">500</th><td>      <a class="local col9 ref" href="#29maxm" title='maxm' data-ref="29maxm" data-ref-filename="29maxm">maxm</a> = <var>1UL</var> &lt;&lt; (<b>sizeof</b>(<em>unsigned</em> <em>long</em>) * <span class="macro" title="8" data-ref="_M/CHAR_BIT">CHAR_BIT</span> / <var>2</var> - <var>1</var>);</td></tr>
<tr><th id="501">501</th><td></td></tr>
<tr><th id="502">502</th><td>      <i>/* s:(1+u)^15, t:(1+u)^2, t &lt;= 3/128 */</i></td></tr>
<tr><th id="503">503</th><td></td></tr>
<tr><th id="504">504</th><td>      <b>for</b> (<a class="local col7 ref" href="#27m" title='m' data-ref="27m" data-ref-filename="27m">m</a> = <var>2</var>; <a class="macro" href="mpfr-impl.h.html#925" title="((v)-&gt;_mpfr_exp)" data-ref="_M/MPFR_GET_EXP">MPFR_GET_EXP</a>(<a class="local col5 ref" href="#25v" title='v' data-ref="25v" data-ref-filename="25v">v</a>) + (<a class="typedef" href="mpfr.h.html#mpfr_exp_t" title='mpfr_exp_t' data-type='long' data-ref="mpfr_exp_t" data-ref-filename="mpfr_exp_t">mpfr_exp_t</a>) <a class="local col1 ref" href="#21w" title='w' data-ref="21w" data-ref-filename="21w">w</a> &gt;= <a class="macro" href="mpfr-impl.h.html#925" title="((s)-&gt;_mpfr_exp)" data-ref="_M/MPFR_GET_EXP">MPFR_GET_EXP</a>(<a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>); <a class="local col7 ref" href="#27m" title='m' data-ref="27m" data-ref-filename="27m">m</a>++)</td></tr>
<tr><th id="505">505</th><td>        {</td></tr>
<tr><th id="506">506</th><td>          <a class="ref fn" href="mpfr.h.html#mpfr_mul" title='mpfr_mul' data-ref="mpfr_mul" data-ref-filename="mpfr_mul">mpfr_mul</a> (<a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="local col4 ref" href="#24u" title='u' data-ref="24u" data-ref-filename="24u">u</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>); <i>/* (1+u)^(10m-14) */</i></td></tr>
<tr><th id="507">507</th><td>          <b>if</b> (<a class="local col7 ref" href="#27m" title='m' data-ref="27m" data-ref-filename="27m">m</a> &lt;= <a class="local col9 ref" href="#29maxm" title='maxm' data-ref="29maxm" data-ref-filename="29maxm">maxm</a>)</td></tr>
<tr><th id="508">508</th><td>            {</td></tr>
<tr><th id="509">509</th><td>              <a class="macro" href="mpfr.h.html#905" title="(__builtin_constant_p (2*(m-1)*(2*m-3)) &amp;&amp; (mpfr_ulong) (2*(m-1)*(2*m-3)) &gt;= 1 &amp;&amp; ((mpfr_ulong) (2*(m-1)*(2*m-3)) &amp; ((mpfr_ulong) (2*(m-1)*(2*m-3)) - 1)) == 0 ? mpfr_mul_2si((t), (t), __builtin_ctzl (2*(m-1)*(2*m-3)), (MPFR_RNDN)) : mpfr_mul_ui ((t), (t), (2*(m-1)*(2*m-3)), (MPFR_RNDN)))" data-ref="_M/mpfr_mul_ui">mpfr_mul_ui</a> (<a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <var>2</var>*(<a class="local col7 ref" href="#27m" title='m' data-ref="27m" data-ref-filename="27m">m</a>-<var>1</var>)*(<var>2</var>*<a class="local col7 ref" href="#27m" title='m' data-ref="27m" data-ref-filename="27m">m</a>-<var>3</var>), <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="510">510</th><td>              <a class="macro" href="mpfr.h.html#911" title="(__builtin_constant_p (2*m*(2*m-1)) &amp;&amp; (mpfr_ulong) (2*m*(2*m-1)) &gt;= 1 &amp;&amp; ((mpfr_ulong) (2*m*(2*m-1)) &amp; ((mpfr_ulong) (2*m*(2*m-1)) - 1)) == 0 ? mpfr_mul_2si((t), (t), - __builtin_ctzl (2*m*(2*m-1)), (MPFR_RNDN)) : mpfr_div_ui ((t), (t), (2*m*(2*m-1)), (MPFR_RNDN)))" data-ref="_M/mpfr_div_ui">mpfr_div_ui</a> (<a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <var>2</var>*<a class="local col7 ref" href="#27m" title='m' data-ref="27m" data-ref-filename="27m">m</a>*(<var>2</var>*<a class="local col7 ref" href="#27m" title='m' data-ref="27m" data-ref-filename="27m">m</a>-<var>1</var>), <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="511">511</th><td>              <a class="macro" href="mpfr.h.html#911" title="(__builtin_constant_p (2*m*(2*m+1)) &amp;&amp; (mpfr_ulong) (2*m*(2*m+1)) &gt;= 1 &amp;&amp; ((mpfr_ulong) (2*m*(2*m+1)) &amp; ((mpfr_ulong) (2*m*(2*m+1)) - 1)) == 0 ? mpfr_mul_2si((t), (t), - __builtin_ctzl (2*m*(2*m+1)), (MPFR_RNDN)) : mpfr_div_ui ((t), (t), (2*m*(2*m+1)), (MPFR_RNDN)))" data-ref="_M/mpfr_div_ui">mpfr_div_ui</a> (<a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <var>2</var>*<a class="local col7 ref" href="#27m" title='m' data-ref="27m" data-ref-filename="27m">m</a>*(<var>2</var>*<a class="local col7 ref" href="#27m" title='m' data-ref="27m" data-ref-filename="27m">m</a>+<var>1</var>), <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="512">512</th><td>            }</td></tr>
<tr><th id="513">513</th><td>          <b>else</b></td></tr>
<tr><th id="514">514</th><td>            {</td></tr>
<tr><th id="515">515</th><td>              <a class="macro" href="mpfr.h.html#905" title="(__builtin_constant_p (2*(m-1)) &amp;&amp; (mpfr_ulong) (2*(m-1)) &gt;= 1 &amp;&amp; ((mpfr_ulong) (2*(m-1)) &amp; ((mpfr_ulong) (2*(m-1)) - 1)) == 0 ? mpfr_mul_2si((t), (t), __builtin_ctzl (2*(m-1)), (MPFR_RNDN)) : mpfr_mul_ui ((t), (t), (2*(m-1)), (MPFR_RNDN)))" data-ref="_M/mpfr_mul_ui">mpfr_mul_ui</a> (<a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <var>2</var>*(<a class="local col7 ref" href="#27m" title='m' data-ref="27m" data-ref-filename="27m">m</a>-<var>1</var>), <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="516">516</th><td>              <a class="macro" href="mpfr.h.html#905" title="(__builtin_constant_p (2*m-3) &amp;&amp; (mpfr_ulong) (2*m-3) &gt;= 1 &amp;&amp; ((mpfr_ulong) (2*m-3) &amp; ((mpfr_ulong) (2*m-3) - 1)) == 0 ? mpfr_mul_2si((t), (t), __builtin_ctzl (2*m-3), (MPFR_RNDN)) : mpfr_mul_ui ((t), (t), (2*m-3), (MPFR_RNDN)))" data-ref="_M/mpfr_mul_ui">mpfr_mul_ui</a> (<a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <var>2</var>*<a class="local col7 ref" href="#27m" title='m' data-ref="27m" data-ref-filename="27m">m</a>-<var>3</var>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="517">517</th><td>              <a class="macro" href="mpfr.h.html#911" title="(__builtin_constant_p (2*m) &amp;&amp; (mpfr_ulong) (2*m) &gt;= 1 &amp;&amp; ((mpfr_ulong) (2*m) &amp; ((mpfr_ulong) (2*m) - 1)) == 0 ? mpfr_mul_2si((t), (t), - __builtin_ctzl (2*m), (MPFR_RNDN)) : mpfr_div_ui ((t), (t), (2*m), (MPFR_RNDN)))" data-ref="_M/mpfr_div_ui">mpfr_div_ui</a> (<a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <var>2</var>*<a class="local col7 ref" href="#27m" title='m' data-ref="27m" data-ref-filename="27m">m</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="518">518</th><td>              <a class="macro" href="mpfr.h.html#911" title="(__builtin_constant_p (2*m-1) &amp;&amp; (mpfr_ulong) (2*m-1) &gt;= 1 &amp;&amp; ((mpfr_ulong) (2*m-1) &amp; ((mpfr_ulong) (2*m-1) - 1)) == 0 ? mpfr_mul_2si((t), (t), - __builtin_ctzl (2*m-1), (MPFR_RNDN)) : mpfr_div_ui ((t), (t), (2*m-1), (MPFR_RNDN)))" data-ref="_M/mpfr_div_ui">mpfr_div_ui</a> (<a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <var>2</var>*<a class="local col7 ref" href="#27m" title='m' data-ref="27m" data-ref-filename="27m">m</a>-<var>1</var>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="519">519</th><td>              <a class="macro" href="mpfr.h.html#911" title="(__builtin_constant_p (2*m) &amp;&amp; (mpfr_ulong) (2*m) &gt;= 1 &amp;&amp; ((mpfr_ulong) (2*m) &amp; ((mpfr_ulong) (2*m) - 1)) == 0 ? mpfr_mul_2si((t), (t), - __builtin_ctzl (2*m), (MPFR_RNDN)) : mpfr_div_ui ((t), (t), (2*m), (MPFR_RNDN)))" data-ref="_M/mpfr_div_ui">mpfr_div_ui</a> (<a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <var>2</var>*<a class="local col7 ref" href="#27m" title='m' data-ref="27m" data-ref-filename="27m">m</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="520">520</th><td>              <a class="macro" href="mpfr.h.html#911" title="(__builtin_constant_p (2*m+1) &amp;&amp; (mpfr_ulong) (2*m+1) &gt;= 1 &amp;&amp; ((mpfr_ulong) (2*m+1) &amp; ((mpfr_ulong) (2*m+1) - 1)) == 0 ? mpfr_mul_2si((t), (t), - __builtin_ctzl (2*m+1), (MPFR_RNDN)) : mpfr_div_ui ((t), (t), (2*m+1), (MPFR_RNDN)))" data-ref="_M/mpfr_div_ui">mpfr_div_ui</a> (<a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <var>2</var>*<a class="local col7 ref" href="#27m" title='m' data-ref="27m" data-ref-filename="27m">m</a>+<var>1</var>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="521">521</th><td>            }</td></tr>
<tr><th id="522">522</th><td>          <i>/* (1+u)^(10m-8) */</i></td></tr>
<tr><th id="523">523</th><td>          <i>/* invariant: t=1/(2m)/(2m-1)/z^(2m-1)/(2m+1)! */</i></td></tr>
<tr><th id="524">524</th><td>          <a class="ref fn" href="mpfr.h.html#mpfr_mul_z" title='mpfr_mul_z' data-ref="mpfr_mul_z" data-ref-filename="mpfr_mul_z">mpfr_mul_z</a> (<a class="local col5 ref" href="#25v" title='v' data-ref="25v" data-ref-filename="25v">v</a>, <a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="ref fn" href="mpfr-impl.h.html#mpfr_bernoulli_cache" title='mpfr_bernoulli_cache' data-ref="mpfr_bernoulli_cache" data-ref-filename="mpfr_bernoulli_cache">mpfr_bernoulli_cache</a>(<a class="local col7 ref" href="#27m" title='m' data-ref="27m" data-ref-filename="27m">m</a>), <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>); <i>/* (1+u)^(10m-7) */</i></td></tr>
<tr><th id="525">525</th><td>          <a class="macro" href="mpfr-impl.h.html#489" title="((void) 0)" data-ref="_M/MPFR_ASSERTD">MPFR_ASSERTD</a>(<a class="macro" href="mpfr-impl.h.html#925" title="((v)-&gt;_mpfr_exp)" data-ref="_M/MPFR_GET_EXP">MPFR_GET_EXP</a>(v) &lt;= - (<var>2</var> * m + <var>3</var>));</td></tr>
<tr><th id="526">526</th><td>          <a class="ref fn" href="mpfr.h.html#mpfr_add" title='mpfr_add' data-ref="mpfr_add" data-ref-filename="mpfr_add">mpfr_add</a> (<a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="local col5 ref" href="#25v" title='v' data-ref="25v" data-ref-filename="25v">v</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="527">527</th><td>        }</td></tr>
<tr><th id="528">528</th><td>      <i>/* m &lt;= 1/2*Pi*e*z ensures that |v[m]| &lt; 1/2^(2m+3) */</i></td></tr>
<tr><th id="529">529</th><td>      <a class="macro" href="mpfr-impl.h.html#489" title="((void) 0)" data-ref="_M/MPFR_ASSERTD">MPFR_ASSERTD</a> ((<em>double</em>) m &lt;= <var>4.26</var> * mpfr_get_d (z, MPFR_RNDZ));</td></tr>
<tr><th id="530">530</th><td></td></tr>
<tr><th id="531">531</th><td>      <i>/* We have sum([(1+u)^(10m-7)-1]*1/2^(2m+3), m=2..infinity)</i></td></tr>
<tr><th id="532">532</th><td><i>         &lt;= 1.46*u for u &lt;= 2^(-3).</i></td></tr>
<tr><th id="533">533</th><td><i>         We have 0 &lt; lngamma(z) - [(z - 1/2) ln(z) - z + 1/2 ln(2 Pi)] &lt; 0.021</i></td></tr>
<tr><th id="534">534</th><td><i>         for z &gt;= 4, thus since the initial s &gt;= 0.85, the different values of</i></td></tr>
<tr><th id="535">535</th><td><i>         s differ by at most one binade, and the total rounding error on s</i></td></tr>
<tr><th id="536">536</th><td><i>         in the for-loop is bounded by 2*(m-1)*ulp(final_s).</i></td></tr>
<tr><th id="537">537</th><td><i>         The error coming from the v's is bounded by</i></td></tr>
<tr><th id="538">538</th><td><i>         1.46*2^(-w) &lt;= 2*ulp(final_s).</i></td></tr>
<tr><th id="539">539</th><td><i>         Thus the total error so far is bounded by [(1+u)^15-1]*s+2m*ulp(s)</i></td></tr>
<tr><th id="540">540</th><td><i>         &lt;= (2m+47)*ulp(s).</i></td></tr>
<tr><th id="541">541</th><td><i>         Taking into account the truncation error (which is bounded by the last</i></td></tr>
<tr><th id="542">542</th><td><i>         term v[] according to 6.1.42 in A&amp;S), the bound is (2m+48)*ulp(s).</i></td></tr>
<tr><th id="543">543</th><td><i>      */</i></td></tr>
<tr><th id="544">544</th><td></td></tr>
<tr><th id="545">545</th><td>      <i>/* add 1/2*log(2*Pi) and subtract log(z0*(z0+1)*...*(z0+k-1)) */</i></td></tr>
<tr><th id="546">546</th><td>      <a class="macro" href="mpfr-impl.h.html#1196" title="mpfr_cache(v, __gmpfr_cache_const_pi,MPFR_RNDN)" data-ref="_M/mpfr_const_pi">mpfr_const_pi</a> (<a class="local col5 ref" href="#25v" title='v' data-ref="25v" data-ref-filename="25v">v</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>); <i>/* v = Pi*(1+u) */</i></td></tr>
<tr><th id="547">547</th><td>      <a class="ref fn" href="mpfr.h.html#mpfr_mul_2ui" title='mpfr_mul_2ui' data-ref="mpfr_mul_2ui" data-ref-filename="mpfr_mul_2ui">mpfr_mul_2ui</a> (<a class="local col5 ref" href="#25v" title='v' data-ref="25v" data-ref-filename="25v">v</a>, <a class="local col5 ref" href="#25v" title='v' data-ref="25v" data-ref-filename="25v">v</a>, <var>1</var>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>); <i>/* v = 2*Pi * (1+u) */</i></td></tr>
<tr><th id="548">548</th><td>      <i>/* k &gt;= 3 */</i></td></tr>
<tr><th id="549">549</th><td>      <a class="macro" href="mpfr.h.html#825" title="mpfr_set4(t,z0,MPFR_RNDN,((z0)-&gt;_mpfr_sign))" data-ref="_M/mpfr_set">mpfr_set</a> (<a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="local col8 ref" href="#18z0" title='z0' data-ref="18z0" data-ref-filename="18z0">z0</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>); <i>/* t = z0*(1+u) */</i></td></tr>
<tr><th id="550">550</th><td>      <a class="local col0 ref" href="#30l" title='l' data-ref="30l" data-ref-filename="30l">l</a> = <var>1</var>;</td></tr>
<tr><th id="551">551</th><td></td></tr>
<tr><th id="552">552</th><td><i>/* replace #if 1 by #if 0 for the naive argument reconstruction */</i></td></tr>
<tr><th id="553">553</th><td><u>#<span data-ppcond="553">if</span> 1</u></td></tr>
<tr><th id="554">554</th><td></td></tr>
<tr><th id="555">555</th><td>      <i>/* We multiply by (z0+1)*(z0+2)*...*(z0+k-1) by blocks of j consecutive</i></td></tr>
<tr><th id="556">556</th><td><i>         terms where j ~ sqrt(k).</i></td></tr>
<tr><th id="557">557</th><td><i>         If we multiply naively by z0+1, then by z0+2, ..., then by z0+j,</i></td></tr>
<tr><th id="558">558</th><td><i>         the multiplicative term for the rounding error is (1+u)^(2j).</i></td></tr>
<tr><th id="559">559</th><td><i>         The multiplicative term is not larger when we multiply by</i></td></tr>
<tr><th id="560">560</th><td><i>         Z[j] + c[j-1]*Z[j-1] + ... + c[2]*Z[2] + c[1]*z0 + c[0]</i></td></tr>
<tr><th id="561">561</th><td><i>         with c[p] integers, and Z[p] = z0^p * (1+u)^(p-1).</i></td></tr>
<tr><th id="562">562</th><td><i>         Note that all terms are positive.</i></td></tr>
<tr><th id="563">563</th><td><i>         Indeed, since c[1] is exact, c[1]*z0 corresponds to (1+u),</i></td></tr>
<tr><th id="564">564</th><td><i>         then c[1]*z0 + c[0] corresponds to (1+u)^2,</i></td></tr>
<tr><th id="565">565</th><td><i>         c[2]*Z[2] + c[1]*z0 + c[0] to (1+u)^3, ...,</i></td></tr>
<tr><th id="566">566</th><td><i>         c[j-1]*Z[j-1] + ... + c[0] to (1+u)^j,</i></td></tr>
<tr><th id="567">567</th><td><i>         and Z[j] + c[j-1]*Z[j-1] + ... + c[1]*z0 + c[0] to (1+u)^(j+1).</i></td></tr>
<tr><th id="568">568</th><td><i>         With the accumulation in t, we get (1+u)^(j+2) and j+2 &lt;= 2j. */</i></td></tr>
<tr><th id="569">569</th><td>      {</td></tr>
<tr><th id="570">570</th><td>        <em>unsigned</em> <em>long</em> <dfn class="local col0 decl" id="40j" title='j' data-type='unsigned long' data-ref="40j" data-ref-filename="40j">j</dfn>, <dfn class="local col1 decl" id="41i" title='i' data-type='unsigned long' data-ref="41i" data-ref-filename="41i">i</dfn>, <dfn class="local col2 decl" id="42p" title='p' data-type='unsigned long' data-ref="42p" data-ref-filename="42p">p</dfn>;</td></tr>
<tr><th id="571">571</th><td>        <a class="typedef" href="mpfr.h.html#mpfr_t" title='mpfr_t' data-type='__mpfr_struct [1]' data-ref="mpfr_t" data-ref-filename="mpfr_t">mpfr_t</a> *<dfn class="local col3 decl" id="43Z" title='Z' data-type='mpfr_t *' data-ref="43Z" data-ref-filename="43Z">Z</dfn>;</td></tr>
<tr><th id="572">572</th><td>        <a class="typedef" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#mpz_t" title='mpz_t' data-type='__mpz_struct [1]' data-ref="mpz_t" data-ref-filename="mpz_t">mpz_t</a> *<dfn class="local col4 decl" id="44c" title='c' data-type='mpz_t *' data-ref="44c" data-ref-filename="44c">c</dfn>;</td></tr>
<tr><th id="573">573</th><td>        <b>for</b> (<a class="local col0 ref" href="#40j" title='j' data-ref="40j" data-ref-filename="40j">j</a> = <var>2</var>; (<a class="local col0 ref" href="#40j" title='j' data-ref="40j" data-ref-filename="40j">j</a> + <var>1</var>) * (<a class="local col0 ref" href="#40j" title='j' data-ref="40j" data-ref-filename="40j">j</a> + <var>1</var>) &lt; <a class="local col8 ref" href="#28k" title='k' data-ref="28k" data-ref-filename="28k">k</a>; <a class="local col0 ref" href="#40j" title='j' data-ref="40j" data-ref-filename="40j">j</a>++);</td></tr>
<tr><th id="574">574</th><td>        <i>/* Z[i] stores z0^i for i &lt;= j */</i></td></tr>
<tr><th id="575">575</th><td>        <a class="local col3 ref" href="#43Z" title='Z' data-ref="43Z" data-ref-filename="43Z">Z</a> = (<a class="typedef" href="mpfr.h.html#mpfr_t" title='mpfr_t' data-type='__mpfr_struct [1]' data-ref="mpfr_t" data-ref-filename="mpfr_t">mpfr_t</a> *) <a class="ref fn" href="mpfr-gmp.h.html#mpfr_allocate_func" title='mpfr_allocate_func' data-ref="mpfr_allocate_func" data-ref-filename="mpfr_allocate_func">mpfr_allocate_func</a> ((<a class="local col0 ref" href="#40j" title='j' data-ref="40j" data-ref-filename="40j">j</a> + <var>1</var>) * <b>sizeof</b> (<a class="typedef" href="mpfr.h.html#mpfr_t" title='mpfr_t' data-type='__mpfr_struct [1]' data-ref="mpfr_t" data-ref-filename="mpfr_t">mpfr_t</a>));</td></tr>
<tr><th id="576">576</th><td>        <b>for</b> (<a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a> = <var>2</var>; <a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a> &lt;= <a class="local col0 ref" href="#40j" title='j' data-ref="40j" data-ref-filename="40j">j</a>; <a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a>++)</td></tr>
<tr><th id="577">577</th><td>          <a class="ref fn" href="mpfr.h.html#mpfr_init2" title='mpfr_init2' data-ref="mpfr_init2" data-ref-filename="mpfr_init2">mpfr_init2</a> (<a class="local col3 ref" href="#43Z" title='Z' data-ref="43Z" data-ref-filename="43Z">Z</a>[<a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a>], <a class="local col1 ref" href="#21w" title='w' data-ref="21w" data-ref-filename="21w">w</a>);</td></tr>
<tr><th id="578">578</th><td>        <a class="ref fn" href="mpfr.h.html#mpfr_sqr" title='mpfr_sqr' data-ref="mpfr_sqr" data-ref-filename="mpfr_sqr">mpfr_sqr</a> (<a class="local col3 ref" href="#43Z" title='Z' data-ref="43Z" data-ref-filename="43Z">Z</a>[<var>2</var>], <a class="local col8 ref" href="#18z0" title='z0' data-ref="18z0" data-ref-filename="18z0">z0</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="579">579</th><td>        <b>for</b> (<a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a> = <var>3</var>; <a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a> &lt;= <a class="local col0 ref" href="#40j" title='j' data-ref="40j" data-ref-filename="40j">j</a>; <a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a>++)</td></tr>
<tr><th id="580">580</th><td>          <b>if</b> ((<a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a> &amp; <var>1</var>) == <var>0</var>)</td></tr>
<tr><th id="581">581</th><td>            <a class="ref fn" href="mpfr.h.html#mpfr_sqr" title='mpfr_sqr' data-ref="mpfr_sqr" data-ref-filename="mpfr_sqr">mpfr_sqr</a> (<a class="local col3 ref" href="#43Z" title='Z' data-ref="43Z" data-ref-filename="43Z">Z</a>[<a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a>], <a class="local col3 ref" href="#43Z" title='Z' data-ref="43Z" data-ref-filename="43Z">Z</a>[<a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a> &gt;&gt; <var>1</var>], <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="582">582</th><td>          <b>else</b></td></tr>
<tr><th id="583">583</th><td>            <a class="ref fn" href="mpfr.h.html#mpfr_mul" title='mpfr_mul' data-ref="mpfr_mul" data-ref-filename="mpfr_mul">mpfr_mul</a> (<a class="local col3 ref" href="#43Z" title='Z' data-ref="43Z" data-ref-filename="43Z">Z</a>[<a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a>], <a class="local col3 ref" href="#43Z" title='Z' data-ref="43Z" data-ref-filename="43Z">Z</a>[<a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a>-<var>1</var>], <a class="local col8 ref" href="#18z0" title='z0' data-ref="18z0" data-ref-filename="18z0">z0</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="584">584</th><td>        <a class="local col4 ref" href="#44c" title='c' data-ref="44c" data-ref-filename="44c">c</a> = (<a class="typedef" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#mpz_t" title='mpz_t' data-type='__mpz_struct [1]' data-ref="mpz_t" data-ref-filename="mpz_t">mpz_t</a> *) <a class="ref fn" href="mpfr-gmp.h.html#mpfr_allocate_func" title='mpfr_allocate_func' data-ref="mpfr_allocate_func" data-ref-filename="mpfr_allocate_func">mpfr_allocate_func</a> ((<a class="local col0 ref" href="#40j" title='j' data-ref="40j" data-ref-filename="40j">j</a> + <var>1</var>) * <b>sizeof</b> (<a class="typedef" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#mpz_t" title='mpz_t' data-type='__mpz_struct [1]' data-ref="mpz_t" data-ref-filename="mpz_t">mpz_t</a>));</td></tr>
<tr><th id="585">585</th><td>        <b>for</b> (<a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a> = <var>0</var>; <a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a> &lt;= <a class="local col0 ref" href="#40j" title='j' data-ref="40j" data-ref-filename="40j">j</a>; <a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a>++)</td></tr>
<tr><th id="586">586</th><td>          <a class="macro" href="mpfr-impl.h.html#2284" title="mpfr_mpz_init" data-ref="_M/mpz_init">mpz_init</a> (<a class="local col4 ref" href="#44c" title='c' data-ref="44c" data-ref-filename="44c">c</a>[<a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a>]);</td></tr>
<tr><th id="587">587</th><td>        <b>for</b> (; <a class="local col0 ref" href="#30l" title='l' data-ref="30l" data-ref-filename="30l">l</a> + <a class="local col0 ref" href="#40j" title='j' data-ref="40j" data-ref-filename="40j">j</a> &lt;= <a class="local col8 ref" href="#28k" title='k' data-ref="28k" data-ref-filename="28k">k</a>; <a class="local col0 ref" href="#30l" title='l' data-ref="30l" data-ref-filename="30l">l</a> += <a class="local col0 ref" href="#40j" title='j' data-ref="40j" data-ref-filename="40j">j</a>)</td></tr>
<tr><th id="588">588</th><td>          {</td></tr>
<tr><th id="589">589</th><td>            <i>/* c[i] is the coefficient of x^i in (x+l)*...*(x+l+j-1) */</i></td></tr>
<tr><th id="590">590</th><td>            <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#1031" title="__gmpz_set_ui" data-ref="_M/mpz_set_ui">mpz_set_ui</a> (<a class="local col4 ref" href="#44c" title='c' data-ref="44c" data-ref-filename="44c">c</a>[<var>0</var>], <var>1</var>);</td></tr>
<tr><th id="591">591</th><td>            <b>for</b> (<a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a> = <var>0</var>; <a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a> &lt; <a class="local col0 ref" href="#40j" title='j' data-ref="40j" data-ref-filename="40j">j</a>; <a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a>++)</td></tr>
<tr><th id="592">592</th><td>              <i>/* multiply (x+l)*(x+l+1)*...*(x+l+i-1) by x+l+i:</i></td></tr>
<tr><th id="593">593</th><td><i>                 (b[i]*x^i + b[i-1]*x^(i-1) + ... + b[0])*(x+l+i) =</i></td></tr>
<tr><th id="594">594</th><td><i>                 b[i]*x^(i+1) + (b[i-1]+(l+i)*b[i])*x^i + ...</i></td></tr>
<tr><th id="595">595</th><td><i>                 + (b[0]+(l+i)*b[1])*x + i*b[0] */</i></td></tr>
<tr><th id="596">596</th><td>              {</td></tr>
<tr><th id="597">597</th><td>                <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#1011" title="__gmpz_set" data-ref="_M/mpz_set">mpz_set</a> (<a class="local col4 ref" href="#44c" title='c' data-ref="44c" data-ref-filename="44c">c</a>[<a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a>+<var>1</var>], <a class="local col4 ref" href="#44c" title='c' data-ref="44c" data-ref-filename="44c">c</a>[<a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a>]); <i>/* b[i]*x^(i+1) */</i></td></tr>
<tr><th id="598">598</th><td>                <b>for</b> (<a class="local col2 ref" href="#42p" title='p' data-ref="42p" data-ref-filename="42p">p</a> = <a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a>; <a class="local col2 ref" href="#42p" title='p' data-ref="42p" data-ref-filename="42p">p</a> &gt; <var>0</var>; <a class="local col2 ref" href="#42p" title='p' data-ref="42p" data-ref-filename="42p">p</a>--)</td></tr>
<tr><th id="599">599</th><td>                  {</td></tr>
<tr><th id="600">600</th><td>                    <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#935" title="__gmpz_mul_ui" data-ref="_M/mpz_mul_ui">mpz_mul_ui</a> (<a class="local col4 ref" href="#44c" title='c' data-ref="44c" data-ref-filename="44c">c</a>[<a class="local col2 ref" href="#42p" title='p' data-ref="42p" data-ref-filename="42p">p</a>], <a class="local col4 ref" href="#44c" title='c' data-ref="44c" data-ref-filename="44c">c</a>[<a class="local col2 ref" href="#42p" title='p' data-ref="42p" data-ref-filename="42p">p</a>], <a class="local col0 ref" href="#30l" title='l' data-ref="30l" data-ref-filename="30l">l</a> + <a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a>);</td></tr>
<tr><th id="601">601</th><td>                    <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#624" title="__gmpz_add" data-ref="_M/mpz_add">mpz_add</a> (<a class="local col4 ref" href="#44c" title='c' data-ref="44c" data-ref-filename="44c">c</a>[<a class="local col2 ref" href="#42p" title='p' data-ref="42p" data-ref-filename="42p">p</a>], <a class="local col4 ref" href="#44c" title='c' data-ref="44c" data-ref-filename="44c">c</a>[<a class="local col2 ref" href="#42p" title='p' data-ref="42p" data-ref-filename="42p">p</a>], <a class="local col4 ref" href="#44c" title='c' data-ref="44c" data-ref-filename="44c">c</a>[<a class="local col2 ref" href="#42p" title='p' data-ref="42p" data-ref-filename="42p">p</a>-<var>1</var>]); <i>/* b[p-1]+(l+i)*b[p] */</i></td></tr>
<tr><th id="602">602</th><td>                  }</td></tr>
<tr><th id="603">603</th><td>                <a class="macro" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#935" title="__gmpz_mul_ui" data-ref="_M/mpz_mul_ui">mpz_mul_ui</a> (<a class="local col4 ref" href="#44c" title='c' data-ref="44c" data-ref-filename="44c">c</a>[<var>0</var>], <a class="local col4 ref" href="#44c" title='c' data-ref="44c" data-ref-filename="44c">c</a>[<var>0</var>], <a class="local col0 ref" href="#30l" title='l' data-ref="30l" data-ref-filename="30l">l</a>+<a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a>); <i>/* i*b[0] */</i></td></tr>
<tr><th id="604">604</th><td>              }</td></tr>
<tr><th id="605">605</th><td>            <i>/* now compute z0^j + c[j-1]*z0^(j-1) + ... + c[1]*z0 + c[0] */</i></td></tr>
<tr><th id="606">606</th><td>            <a class="ref fn" href="mpfr.h.html#mpfr_set_z" title='mpfr_set_z' data-ref="mpfr_set_z" data-ref-filename="mpfr_set_z">mpfr_set_z</a> (<a class="local col4 ref" href="#24u" title='u' data-ref="24u" data-ref-filename="24u">u</a>, <a class="local col4 ref" href="#44c" title='c' data-ref="44c" data-ref-filename="44c">c</a>[<var>0</var>], <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="607">607</th><td>            <b>for</b> (<a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a> = <var>0</var>; <a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a> &lt; <a class="local col0 ref" href="#40j" title='j' data-ref="40j" data-ref-filename="40j">j</a>; <a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a>++)</td></tr>
<tr><th id="608">608</th><td>              {</td></tr>
<tr><th id="609">609</th><td>                <a class="ref fn" href="mpfr.h.html#mpfr_mul_z" title='mpfr_mul_z' data-ref="mpfr_mul_z" data-ref-filename="mpfr_mul_z">mpfr_mul_z</a> (<a class="local col6 ref" href="#26z" title='z' data-ref="26z" data-ref-filename="26z">z</a>, (<a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a> == <var>0</var>) ? <a class="local col8 ref" href="#18z0" title='z0' data-ref="18z0" data-ref-filename="18z0">z0</a> : <a class="local col3 ref" href="#43Z" title='Z' data-ref="43Z" data-ref-filename="43Z">Z</a>[<a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a>+<var>1</var>], <a class="local col4 ref" href="#44c" title='c' data-ref="44c" data-ref-filename="44c">c</a>[<a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a>+<var>1</var>], <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="610">610</th><td>                <a class="ref fn" href="mpfr.h.html#mpfr_add" title='mpfr_add' data-ref="mpfr_add" data-ref-filename="mpfr_add">mpfr_add</a> (<a class="local col4 ref" href="#24u" title='u' data-ref="24u" data-ref-filename="24u">u</a>, <a class="local col4 ref" href="#24u" title='u' data-ref="24u" data-ref-filename="24u">u</a>, <a class="local col6 ref" href="#26z" title='z' data-ref="26z" data-ref-filename="26z">z</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="611">611</th><td>              }</td></tr>
<tr><th id="612">612</th><td>            <a class="ref fn" href="mpfr.h.html#mpfr_mul" title='mpfr_mul' data-ref="mpfr_mul" data-ref-filename="mpfr_mul">mpfr_mul</a> (<a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="local col4 ref" href="#24u" title='u' data-ref="24u" data-ref-filename="24u">u</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="613">613</th><td>          }</td></tr>
<tr><th id="614">614</th><td>        <b>for</b> (<a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a> = <var>0</var>; <a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a> &lt;= <a class="local col0 ref" href="#40j" title='j' data-ref="40j" data-ref-filename="40j">j</a>; <a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a>++)</td></tr>
<tr><th id="615">615</th><td>          <a class="macro" href="mpfr-impl.h.html#2286" title="mpfr_mpz_clear" data-ref="_M/mpz_clear">mpz_clear</a> (<a class="local col4 ref" href="#44c" title='c' data-ref="44c" data-ref-filename="44c">c</a>[<a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a>]);</td></tr>
<tr><th id="616">616</th><td>        <a class="ref fn" href="mpfr-gmp.h.html#mpfr_free_func" title='mpfr_free_func' data-ref="mpfr_free_func" data-ref-filename="mpfr_free_func">mpfr_free_func</a> (<a class="local col4 ref" href="#44c" title='c' data-ref="44c" data-ref-filename="44c">c</a>, (<a class="local col0 ref" href="#40j" title='j' data-ref="40j" data-ref-filename="40j">j</a> + <var>1</var>) * <b>sizeof</b> (<a class="typedef" href="../../../gmp/lib/libgmp/arch/x86_64/gmp.h.html#mpz_t" title='mpz_t' data-type='__mpz_struct [1]' data-ref="mpz_t" data-ref-filename="mpz_t">mpz_t</a>));</td></tr>
<tr><th id="617">617</th><td>        <b>for</b> (<a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a> = <var>2</var>; <a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a> &lt;= <a class="local col0 ref" href="#40j" title='j' data-ref="40j" data-ref-filename="40j">j</a>; <a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a>++)</td></tr>
<tr><th id="618">618</th><td>          <a class="ref fn" href="mpfr.h.html#mpfr_clear" title='mpfr_clear' data-ref="mpfr_clear" data-ref-filename="mpfr_clear">mpfr_clear</a> (<a class="local col3 ref" href="#43Z" title='Z' data-ref="43Z" data-ref-filename="43Z">Z</a>[<a class="local col1 ref" href="#41i" title='i' data-ref="41i" data-ref-filename="41i">i</a>]);</td></tr>
<tr><th id="619">619</th><td>        <a class="ref fn" href="mpfr-gmp.h.html#mpfr_free_func" title='mpfr_free_func' data-ref="mpfr_free_func" data-ref-filename="mpfr_free_func">mpfr_free_func</a> (<a class="local col3 ref" href="#43Z" title='Z' data-ref="43Z" data-ref-filename="43Z">Z</a>, (<a class="local col0 ref" href="#40j" title='j' data-ref="40j" data-ref-filename="40j">j</a> + <var>1</var>) * <b>sizeof</b> (<a class="typedef" href="mpfr.h.html#mpfr_t" title='mpfr_t' data-type='__mpfr_struct [1]' data-ref="mpfr_t" data-ref-filename="mpfr_t">mpfr_t</a>));</td></tr>
<tr><th id="620">620</th><td>      }</td></tr>
<tr><th id="621">621</th><td><u>#<span data-ppcond="553">endif</span> /* end of fast argument reconstruction */</u></td></tr>
<tr><th id="622">622</th><td></td></tr>
<tr><th id="623">623</th><td>      <b>for</b> (; <a class="local col0 ref" href="#30l" title='l' data-ref="30l" data-ref-filename="30l">l</a> &lt; <a class="local col8 ref" href="#28k" title='k' data-ref="28k" data-ref-filename="28k">k</a>; <a class="local col0 ref" href="#30l" title='l' data-ref="30l" data-ref-filename="30l">l</a>++)</td></tr>
<tr><th id="624">624</th><td>        {</td></tr>
<tr><th id="625">625</th><td>          <a class="ref fn" href="mpfr.h.html#mpfr_add_ui" title='mpfr_add_ui' data-ref="mpfr_add_ui" data-ref-filename="mpfr_add_ui">mpfr_add_ui</a> (<a class="local col4 ref" href="#24u" title='u' data-ref="24u" data-ref-filename="24u">u</a>, <a class="local col8 ref" href="#18z0" title='z0' data-ref="18z0" data-ref-filename="18z0">z0</a>, <a class="local col0 ref" href="#30l" title='l' data-ref="30l" data-ref-filename="30l">l</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>); <i>/* u = (z0+l)*(1+u) */</i></td></tr>
<tr><th id="626">626</th><td>          <a class="ref fn" href="mpfr.h.html#mpfr_mul" title='mpfr_mul' data-ref="mpfr_mul" data-ref-filename="mpfr_mul">mpfr_mul</a> (<a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="local col4 ref" href="#24u" title='u' data-ref="24u" data-ref-filename="24u">u</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);     <i>/* (1+u)^(2l+1) */</i></td></tr>
<tr><th id="627">627</th><td>        }</td></tr>
<tr><th id="628">628</th><td>      <i>/* now t: (1+u)^(2k-1) */</i></td></tr>
<tr><th id="629">629</th><td>      <i>/* instead of computing log(sqrt(2*Pi)/t), we compute</i></td></tr>
<tr><th id="630">630</th><td><i>         1/2*log(2*Pi/t^2), which trades a square root for a square */</i></td></tr>
<tr><th id="631">631</th><td>      <a class="ref fn" href="mpfr.h.html#mpfr_mul" title='mpfr_mul' data-ref="mpfr_mul" data-ref-filename="mpfr_mul">mpfr_mul</a> (<a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>); <i>/* (z0*...*(z0+k-1))^2, (1+u)^(4k-1) */</i></td></tr>
<tr><th id="632">632</th><td>      <a class="ref fn" href="mpfr.h.html#mpfr_div" title='mpfr_div' data-ref="mpfr_div" data-ref-filename="mpfr_div">mpfr_div</a> (<a class="local col5 ref" href="#25v" title='v' data-ref="25v" data-ref-filename="25v">v</a>, <a class="local col5 ref" href="#25v" title='v' data-ref="25v" data-ref-filename="25v">v</a>, <a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="633">633</th><td>      <i>/* 2*Pi/(z0*...*(z0+k-1))^2 (1+u)^(4k+1) */</i></td></tr>
<tr><th id="634">634</th><td><u>#<span data-ppcond="634">ifdef</span> <a class="macro" href="gamma.c.html#26" data-ref="_M/IS_GAMMA">IS_GAMMA</a></u></td></tr>
<tr><th id="635">635</th><td>      <a class="local col3 ref" href="#33err_s" title='err_s' data-ref="33err_s" data-ref-filename="33err_s">err_s</a> = <a class="macro" href="mpfr-impl.h.html#925" title="((s)-&gt;_mpfr_exp)" data-ref="_M/MPFR_GET_EXP">MPFR_GET_EXP</a>(<a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>);</td></tr>
<tr><th id="636">636</th><td>      <a class="ref fn" href="mpfr.h.html#mpfr_exp" title='mpfr_exp' data-ref="mpfr_exp" data-ref-filename="mpfr_exp">mpfr_exp</a> (<a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="637">637</th><td>      <i>/* If s is +Inf, we compute exp(lngamma(z0)). */</i></td></tr>
<tr><th id="638">638</th><td>      <b>if</b> (<a class="macro" href="mpfr.h.html#799" title="((s)-&gt;_mpfr_exp == (2 - ((mpfr_exp_t) (((mpfr_uexp_t) -1) &gt;&gt; 1))))" data-ref="_M/mpfr_inf_p">mpfr_inf_p</a> (<a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>))</td></tr>
<tr><th id="639">639</th><td>        {</td></tr>
<tr><th id="640">640</th><td>          <a class="local col2 ref" href="#32inexact" title='inexact' data-ref="32inexact" data-ref-filename="32inexact">inexact</a> = <a class="ref fn" href="#mpfr_explgamma" title='mpfr_explgamma' data-ref="mpfr_explgamma" data-ref-filename="mpfr_explgamma">mpfr_explgamma</a> (<a class="local col7 ref" href="#17y" title='y' data-ref="17y" data-ref-filename="17y">y</a>, <a class="local col8 ref" href="#18z0" title='z0' data-ref="18z0" data-ref-filename="18z0">z0</a>, &amp;<a class="local col6 ref" href="#178" title='expo' data-ref="36expo" data-ref-filename="36expo">expo</a>, <a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="local col9 ref" href="#19rnd" title='rnd' data-ref="19rnd" data-ref-filename="19rnd">rnd</a>);</td></tr>
<tr><th id="641">641</th><td>          <b>if</b> (<a class="local col2 ref" href="#32inexact" title='inexact' data-ref="32inexact" data-ref-filename="32inexact">inexact</a>)</td></tr>
<tr><th id="642">642</th><td>            <b>goto</b> <a class="lbl" href="#45end0" data-ref="45end0" data-ref-filename="45end0">end0</a>;</td></tr>
<tr><th id="643">643</th><td>          <b>else</b></td></tr>
<tr><th id="644">644</th><td>            <b>goto</b> <a class="lbl" href="#46ziv_next" data-ref="46ziv_next" data-ref-filename="46ziv_next">ziv_next</a>;</td></tr>
<tr><th id="645">645</th><td>        }</td></tr>
<tr><th id="646">646</th><td>      <i>/* before the exponential, we have s = s0 + h where</i></td></tr>
<tr><th id="647">647</th><td><i>         |h| &lt;= (2m+48)*ulp(s), thus exp(s0) = exp(s) * exp(-h).</i></td></tr>
<tr><th id="648">648</th><td><i>         For |h| &lt;= 1/4, we have |exp(h)-1| &lt;= 1.2*|h| thus</i></td></tr>
<tr><th id="649">649</th><td><i>         |exp(s) - exp(s0)| &lt;= 1.2 * exp(s) * (2m+48)* 2^(EXP(s)-w). */</i></td></tr>
<tr><th id="650">650</th><td>      <i>/* d = 1.2 * (2.0 * (double) m + 48.0); */</i></td></tr>
<tr><th id="651">651</th><td>      <i>/* the error on s is bounded by d*2^err_s * 2^(-w) */</i></td></tr>
<tr><th id="652">652</th><td>      <a class="ref fn" href="mpfr.h.html#mpfr_sqrt" title='mpfr_sqrt' data-ref="mpfr_sqrt" data-ref-filename="mpfr_sqrt">mpfr_sqrt</a> (<a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="local col5 ref" href="#25v" title='v' data-ref="25v" data-ref-filename="25v">v</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="653">653</th><td>      <i>/* let v0 be the exact value of v. We have v = v0*(1+u)^(4k+1),</i></td></tr>
<tr><th id="654">654</th><td><i>         thus t = sqrt(v0)*(1+u)^(2k+3/2). */</i></td></tr>
<tr><th id="655">655</th><td>      <a class="ref fn" href="mpfr.h.html#mpfr_mul" title='mpfr_mul' data-ref="mpfr_mul" data-ref-filename="mpfr_mul">mpfr_mul</a> (<a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>, <a class="enum" href="mpfr.h.html#MPFR_RNDN" title='MPFR_RNDN' data-ref="MPFR_RNDN" data-ref-filename="MPFR_RNDN">MPFR_RNDN</a>);</td></tr>
<tr><th id="656">656</th><td>      <i>/* the error on input s is bounded by (1+u)^(d*2^err_s),</i></td></tr>
<tr><th id="657">657</th><td><i>         and that on t is (1+u)^(2k+3/2), thus the</i></td></tr>
<tr><th id="658">658</th><td><i>         total error is (1+u)^(d*2^err_s+2k+5/2) */</i></td></tr>
<tr><th id="659">659</th><td>      <i>/* err_s += __gmpfr_ceil_log2 (d); */</i></td></tr>
<tr><th id="660">660</th><td>      <i>/* since d = 1.2 * (2m+48), ceil(log2(d)) = 2 + ceil(log2(0.6*m+14.4))</i></td></tr>
<tr><th id="661">661</th><td><i>         &lt;= 2 + ceil(log2(0.6*m+15)) */</i></td></tr>
<tr><th id="662">662</th><td>      {</td></tr>
<tr><th id="663">663</th><td>        <em>unsigned</em> <em>long</em> <dfn class="local col7 decl" id="47mm" title='mm' data-type='unsigned long' data-ref="47mm" data-ref-filename="47mm">mm</dfn> = (<var>1</var> + <a class="local col7 ref" href="#27m" title='m' data-ref="27m" data-ref-filename="27m">m</a> / <var>5</var>) * <var>3</var>; <i>/* 0.6*m &lt;= mm */</i></td></tr>
<tr><th id="664">664</th><td>        <a class="local col3 ref" href="#33err_s" title='err_s' data-ref="33err_s" data-ref-filename="33err_s">err_s</a> += <var>2</var> + <a class="ref fn" href="mpfr-impl.h.html#__gmpfr_int_ceil_log2" title='__gmpfr_int_ceil_log2' data-ref="__gmpfr_int_ceil_log2" data-ref-filename="__gmpfr_int_ceil_log2">__gmpfr_int_ceil_log2</a> (<a class="local col7 ref" href="#47mm" title='mm' data-ref="47mm" data-ref-filename="47mm">mm</a> + <var>15</var>);</td></tr>
<tr><th id="665">665</th><td>      }</td></tr>
<tr><th id="666">666</th><td>      <a class="local col4 ref" href="#34err_t" title='err_t' data-ref="34err_t" data-ref-filename="34err_t">err_t</a> = <a class="ref fn" href="mpfr-impl.h.html#__gmpfr_ceil_log2" title='__gmpfr_ceil_log2' data-ref="__gmpfr_ceil_log2" data-ref-filename="__gmpfr_ceil_log2">__gmpfr_ceil_log2</a> (<var>2.0</var> * (<em>double</em>) <a class="local col8 ref" href="#28k" title='k' data-ref="28k" data-ref-filename="28k">k</a> + <var>2.5</var>);</td></tr>
<tr><th id="667">667</th><td>      <a class="local col3 ref" href="#33err_s" title='err_s' data-ref="33err_s" data-ref-filename="33err_s">err_s</a> = (<a class="local col3 ref" href="#33err_s" title='err_s' data-ref="33err_s" data-ref-filename="33err_s">err_s</a> &gt;= <a class="local col4 ref" href="#34err_t" title='err_t' data-ref="34err_t" data-ref-filename="34err_t">err_t</a>) ? <a class="local col3 ref" href="#33err_s" title='err_s' data-ref="33err_s" data-ref-filename="33err_s">err_s</a> + <var>1</var> : <a class="local col4 ref" href="#34err_t" title='err_t' data-ref="34err_t" data-ref-filename="34err_t">err_t</a> + <var>1</var>;</td></tr>
<tr><th id="668">668</th><td><u>#<span data-ppcond="634">else</span></u></td></tr>
<tr><th id="669">669</th><td>      mpfr_log (t, v, MPFR_RNDN);</td></tr>
<tr><th id="670">670</th><td>      <i>/* let v0 be the exact value of v. We have v = v0*(1+u)^(4k+1),</i></td></tr>
<tr><th id="671">671</th><td><i>         thus log(v) = log(v0) + (4k+1)*log(1+u). Since |log(1+u)/u| &lt;= 1.07</i></td></tr>
<tr><th id="672">672</th><td><i>         for |u| &lt;= 2^(-3), the absolute error on log(v) is bounded by</i></td></tr>
<tr><th id="673">673</th><td><i>         1.07*(4k+1)*u, and the rounding error by ulp(t). */</i></td></tr>
<tr><th id="674">674</th><td>      mpfr_div_2ui (t, t, <var>1</var>, MPFR_RNDN);</td></tr>
<tr><th id="675">675</th><td>      <i>/* the error on t is now bounded by ulp(t) + 0.54*(4k+1)*2^(-w).</i></td></tr>
<tr><th id="676">676</th><td><i>         We have sqrt(2*Pi)/(z0*(z0+1)*...*(z0+k-1)) &lt;= sqrt(2*Pi)/k! &lt;= 0.5</i></td></tr>
<tr><th id="677">677</th><td><i>         since k&gt;=3, thus t &lt;= -0.5 and ulp(t) &gt;= 2^(-w).</i></td></tr>
<tr><th id="678">678</th><td><i>         Thus the error on t is bounded by (2.16*k+1.54)*ulp(t). */</i></td></tr>
<tr><th id="679">679</th><td>      err_t = MPFR_GET_EXP(t) + (mpfr_exp_t)</td></tr>
<tr><th id="680">680</th><td>        __gmpfr_ceil_log2 (<var>2.2</var> * (<em>double</em>) k + <var>1.6</var>);</td></tr>
<tr><th id="681">681</th><td>      err_s = MPFR_GET_EXP(s) + (mpfr_exp_t)</td></tr>
<tr><th id="682">682</th><td>        __gmpfr_ceil_log2 (<var>2.0</var> * (<em>double</em>) m + <var>48.0</var>);</td></tr>
<tr><th id="683">683</th><td>      mpfr_add (s, s, t, MPFR_RNDN); <i>/* this is a subtraction in fact */</i></td></tr>
<tr><th id="684">684</th><td>      <i>/* the final error in ulp(s) is</i></td></tr>
<tr><th id="685">685</th><td><i>         &lt;= 1 + 2^(err_t-EXP(s)) + 2^(err_s-EXP(s))</i></td></tr>
<tr><th id="686">686</th><td><i>         &lt;= 2^(1+max(err_t,err_s)-EXP(s)) if err_t &lt;&gt; err_s</i></td></tr>
<tr><th id="687">687</th><td><i>         &lt;= 2^(2+max(err_t,err_s)-EXP(s)) if err_t = err_s */</i></td></tr>
<tr><th id="688">688</th><td>      err_s = (err_t == err_s) ? <var>1</var> + err_s : ((err_t &gt; err_s) ? err_t : err_s);</td></tr>
<tr><th id="689">689</th><td>      err_s += <var>1</var> - MPFR_GET_EXP(s);</td></tr>
<tr><th id="690">690</th><td><u>#<span data-ppcond="634">endif</span></u></td></tr>
<tr><th id="691">691</th><td>      <b>if</b> (<a class="macro" href="mpfr-impl.h.html#1282" title="(__builtin_expect(!!((!(((s)-&gt;_mpfr_exp) &lt;= (((-9223372036854775807L -1L))+3)) &amp;&amp; mpfr_round_p (((s)-&gt;_mpfr_d), ((((((void) 0), (((s)-&gt;_mpfr_prec))) - 1) / (64 - 0)) + 1), (w - err_s), (precy) + ((rnd)==MPFR_RNDN)))), 1))" data-ref="_M/MPFR_LIKELY">MPFR_LIKELY</a> (<a class="macro" href="mpfr-impl.h.html#1711" title="(!(((s)-&gt;_mpfr_exp) &lt;= (((-9223372036854775807L -1L))+3)) &amp;&amp; mpfr_round_p (((s)-&gt;_mpfr_d), ((((((void) 0), (((s)-&gt;_mpfr_prec))) - 1) / (64 - 0)) + 1), (w - err_s), (precy) + ((rnd)==MPFR_RNDN)))" data-ref="_M/MPFR_CAN_ROUND">MPFR_CAN_ROUND</a> (<a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="local col1 ref" href="#21w" title='w' data-ref="21w" data-ref-filename="21w">w</a> - <a class="local col3 ref" href="#33err_s" title='err_s' data-ref="33err_s" data-ref-filename="33err_s">err_s</a>, <a class="local col0 ref" href="#20precy" title='precy' data-ref="20precy" data-ref-filename="20precy">precy</a>, <a class="local col9 ref" href="#19rnd" title='rnd' data-ref="19rnd" data-ref-filename="19rnd">rnd</a>)))</td></tr>
<tr><th id="692">692</th><td>        <b>break</b>;</td></tr>
<tr><th id="693">693</th><td><u>#<span data-ppcond="693">ifdef</span> <a class="macro" href="gamma.c.html#26" data-ref="_M/IS_GAMMA">IS_GAMMA</a></u></td></tr>
<tr><th id="694">694</th><td>    <dfn class="lbl" id="46ziv_next" data-ref="46ziv_next" data-ref-filename="46ziv_next">ziv_next</dfn>:</td></tr>
<tr><th id="695">695</th><td><u>#<span data-ppcond="693">endif</span></u></td></tr>
<tr><th id="696">696</th><td>      <a class="macro" href="mpfr-impl.h.html#1829" title="((w) = (((void) (((__builtin_expect(!!((loop) &lt;= ((mpfr_prec_t) ((((mpfr_uprec_t) -1) &gt;&gt; 1) - 256)) - (w)), 1))) || (mpfr_assert_fail (&quot;/___NETBSD_SRC___/external/lgpl3/mpfr/dist/src/lngamma.c&quot;, 696, &quot;(loop) &lt;= ((mpfr_prec_t) ((((mpfr_uprec_t) -1) &gt;&gt; 1) - 256)) - (w)&quot;),((void) 0),0))), (w) + (loop)), (loop) = (w)/2)" data-ref="_M/MPFR_ZIV_NEXT">MPFR_ZIV_NEXT</a> (<a class="local col7 ref" href="#179" title='loop' data-ref="37loop" data-ref-filename="37loop">loop</a>, <a class="local col1 ref" href="#21w" title='w' data-ref="21w" data-ref-filename="21w">w</a>);</td></tr>
<tr><th id="697">697</th><td>    }</td></tr>
<tr><th id="698">698</th><td></td></tr>
<tr><th id="699">699</th><td><u>#<span data-ppcond="699">ifdef</span> <a class="macro" href="gamma.c.html#26" data-ref="_M/IS_GAMMA">IS_GAMMA</a></u></td></tr>
<tr><th id="700">700</th><td> <dfn class="lbl" id="45end0" data-ref="45end0" data-ref-filename="45end0">end0</dfn>:</td></tr>
<tr><th id="701">701</th><td><u>#<span data-ppcond="699">endif</span></u></td></tr>
<tr><th id="702">702</th><td></td></tr>
<tr><th id="703">703</th><td> <dfn class="lbl" id="39end" data-ref="39end" data-ref-filename="39end">end</dfn>:</td></tr>
<tr><th id="704">704</th><td>  <b>if</b> (<a class="local col2 ref" href="#32inexact" title='inexact' data-ref="32inexact" data-ref-filename="32inexact">inexact</a> == <var>0</var>)</td></tr>
<tr><th id="705">705</th><td>    <a class="local col2 ref" href="#32inexact" title='inexact' data-ref="32inexact" data-ref-filename="32inexact">inexact</a> = <a class="macro" href="mpfr.h.html#825" title="mpfr_set4(y,s,rnd,((s)-&gt;_mpfr_sign))" data-ref="_M/mpfr_set">mpfr_set</a> (<a class="local col7 ref" href="#17y" title='y' data-ref="17y" data-ref-filename="17y">y</a>, <a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>, <a class="local col9 ref" href="#19rnd" title='rnd' data-ref="19rnd" data-ref-filename="19rnd">rnd</a>);</td></tr>
<tr><th id="706">706</th><td>  <a class="macro" href="mpfr-impl.h.html#1830" title="" data-ref="_M/MPFR_ZIV_FREE">MPFR_ZIV_FREE</a> (loop);</td></tr>
<tr><th id="707">707</th><td></td></tr>
<tr><th id="708">708</th><td>  <a class="ref fn" href="mpfr.h.html#mpfr_clear" title='mpfr_clear' data-ref="mpfr_clear" data-ref-filename="mpfr_clear">mpfr_clear</a> (<a class="local col2 ref" href="#22s" title='s' data-ref="22s" data-ref-filename="22s">s</a>);</td></tr>
<tr><th id="709">709</th><td>  <a class="ref fn" href="mpfr.h.html#mpfr_clear" title='mpfr_clear' data-ref="mpfr_clear" data-ref-filename="mpfr_clear">mpfr_clear</a> (<a class="local col3 ref" href="#23t" title='t' data-ref="23t" data-ref-filename="23t">t</a>);</td></tr>
<tr><th id="710">710</th><td>  <a class="ref fn" href="mpfr.h.html#mpfr_clear" title='mpfr_clear' data-ref="mpfr_clear" data-ref-filename="mpfr_clear">mpfr_clear</a> (<a class="local col4 ref" href="#24u" title='u' data-ref="24u" data-ref-filename="24u">u</a>);</td></tr>
<tr><th id="711">711</th><td>  <a class="ref fn" href="mpfr.h.html#mpfr_clear" title='mpfr_clear' data-ref="mpfr_clear" data-ref-filename="mpfr_clear">mpfr_clear</a> (<a class="local col5 ref" href="#25v" title='v' data-ref="25v" data-ref-filename="25v">v</a>);</td></tr>
<tr><th id="712">712</th><td>  <a class="ref fn" href="mpfr.h.html#mpfr_clear" title='mpfr_clear' data-ref="mpfr_clear" data-ref-filename="mpfr_clear">mpfr_clear</a> (<a class="local col6 ref" href="#26z" title='z' data-ref="26z" data-ref-filename="26z">z</a>);</td></tr>
<tr><th id="713">713</th><td></td></tr>
<tr><th id="714">714</th><td>  <a class="macro" href="mpfr-impl.h.html#1513" title="(__gmpfr_flags = (expo).saved_flags, __gmpfr_emin = (expo).saved_emin, __gmpfr_emax = (expo).saved_emax)" data-ref="_M/MPFR_SAVE_EXPO_FREE">MPFR_SAVE_EXPO_FREE</a> (<a class="local col6 ref" href="#178" title='expo' data-ref="36expo" data-ref-filename="36expo">expo</a>);</td></tr>
<tr><th id="715">715</th><td>  <b>return</b> <a class="macro" href="mpfr-impl.h.html#1521" title="((__builtin_expect(!!((((void) 0), (((y)-&gt;_mpfr_exp)) &gt;= __gmpfr_emin &amp;&amp; (((y)-&gt;_mpfr_exp)) &lt;= __gmpfr_emax)), 1)) ? ((inexact) ? (__gmpfr_flags |= 8, (inexact)) : 0) : mpfr_check_range(y,inexact,rnd))" data-ref="_M/mpfr_check_range">mpfr_check_range</a> (<a class="local col7 ref" href="#17y" title='y' data-ref="17y" data-ref-filename="17y">y</a>, <a class="local col2 ref" href="#32inexact" title='inexact' data-ref="32inexact" data-ref-filename="32inexact">inexact</a>, <a class="local col9 ref" href="#19rnd" title='rnd' data-ref="19rnd" data-ref-filename="19rnd">rnd</a>);</td></tr>
<tr><th id="716">716</th><td>}</td></tr>
<tr><th id="717">717</th><td></td></tr>
<tr><th id="718">718</th><td><u>#<span data-ppcond="718">ifndef</span> <a class="macro" href="gamma.c.html#26" data-ref="_M/IS_GAMMA">IS_GAMMA</a></u></td></tr>
<tr><th id="719">719</th><td></td></tr>
<tr><th id="720">720</th><td><em>int</em></td></tr>
<tr><th id="721">721</th><td>mpfr_lngamma (mpfr_ptr y, mpfr_srcptr x, mpfr_rnd_t rnd)</td></tr>
<tr><th id="722">722</th><td>{</td></tr>
<tr><th id="723">723</th><td>  <em>int</em> inex;</td></tr>
<tr><th id="724">724</th><td></td></tr>
<tr><th id="725">725</th><td>  MPFR_LOG_FUNC</td></tr>
<tr><th id="726">726</th><td>    ((<q>"x[%Pu]=%.*Rg rnd=%d"</q>, mpfr_get_prec (x), mpfr_log_prec, x, rnd),</td></tr>
<tr><th id="727">727</th><td>     (<q>"y[%Pu]=%.*Rg inexact=%d"</q>,</td></tr>
<tr><th id="728">728</th><td>      mpfr_get_prec (y), mpfr_log_prec, y, inex));</td></tr>
<tr><th id="729">729</th><td></td></tr>
<tr><th id="730">730</th><td>  <i>/* special cases */</i></td></tr>
<tr><th id="731">731</th><td>  <b>if</b> (MPFR_UNLIKELY (MPFR_IS_SINGULAR (x) ||</td></tr>
<tr><th id="732">732</th><td>                     (MPFR_IS_NEG (x) &amp;&amp; mpfr_integer_p (x))))</td></tr>
<tr><th id="733">733</th><td>    {</td></tr>
<tr><th id="734">734</th><td>      <b>if</b> (MPFR_IS_NAN (x))</td></tr>
<tr><th id="735">735</th><td>        {</td></tr>
<tr><th id="736">736</th><td>          MPFR_SET_NAN (y);</td></tr>
<tr><th id="737">737</th><td>          MPFR_RET_NAN;</td></tr>
<tr><th id="738">738</th><td>        }</td></tr>
<tr><th id="739">739</th><td>      <b>else</b> <i>/* lngamma(+/-Inf) = lngamma(nonpositive integer) = +Inf */</i></td></tr>
<tr><th id="740">740</th><td>        {</td></tr>
<tr><th id="741">741</th><td>          <b>if</b> (!MPFR_IS_INF (x))</td></tr>
<tr><th id="742">742</th><td>            MPFR_SET_DIVBY0 ();</td></tr>
<tr><th id="743">743</th><td>          MPFR_SET_INF (y);</td></tr>
<tr><th id="744">744</th><td>          MPFR_SET_POS (y);</td></tr>
<tr><th id="745">745</th><td>          MPFR_RET (<var>0</var>);  <i>/* exact */</i></td></tr>
<tr><th id="746">746</th><td>        }</td></tr>
<tr><th id="747">747</th><td>    }</td></tr>
<tr><th id="748">748</th><td></td></tr>
<tr><th id="749">749</th><td>  <i>/* if -2k-1 &lt; x &lt; -2k &lt;= 0, then lngamma(x) = NaN */</i></td></tr>
<tr><th id="750">750</th><td>  <b>if</b> (MPFR_IS_NEG (x) &amp;&amp; unit_bit (x) == <var>0</var>)</td></tr>
<tr><th id="751">751</th><td>    {</td></tr>
<tr><th id="752">752</th><td>      MPFR_SET_NAN (y);</td></tr>
<tr><th id="753">753</th><td>      MPFR_RET_NAN;</td></tr>
<tr><th id="754">754</th><td>    }</td></tr>
<tr><th id="755">755</th><td></td></tr>
<tr><th id="756">756</th><td>  inex = mpfr_lngamma_aux (y, x, rnd);</td></tr>
<tr><th id="757">757</th><td>  <b>return</b> inex;</td></tr>
<tr><th id="758">758</th><td>}</td></tr>
<tr><th id="759">759</th><td></td></tr>
<tr><th id="760">760</th><td><em>int</em></td></tr>
<tr><th id="761">761</th><td>mpfr_lgamma (mpfr_ptr y, <em>int</em> *signp, mpfr_srcptr x, mpfr_rnd_t rnd)</td></tr>
<tr><th id="762">762</th><td>{</td></tr>
<tr><th id="763">763</th><td>  <em>int</em> inex;</td></tr>
<tr><th id="764">764</th><td></td></tr>
<tr><th id="765">765</th><td>  MPFR_LOG_FUNC</td></tr>
<tr><th id="766">766</th><td>    ((<q>"x[%Pu]=%.*Rg rnd=%d"</q>, mpfr_get_prec (x), mpfr_log_prec, x, rnd),</td></tr>
<tr><th id="767">767</th><td>     (<q>"y[%Pu]=%.*Rg signp=%d inexact=%d"</q>,</td></tr>
<tr><th id="768">768</th><td>      mpfr_get_prec (y), mpfr_log_prec, y, *signp, inex));</td></tr>
<tr><th id="769">769</th><td></td></tr>
<tr><th id="770">770</th><td>  *signp = <var>1</var>;  <i>/* most common case */</i></td></tr>
<tr><th id="771">771</th><td></td></tr>
<tr><th id="772">772</th><td>  <b>if</b> (MPFR_UNLIKELY (MPFR_IS_SINGULAR (x)))</td></tr>
<tr><th id="773">773</th><td>    {</td></tr>
<tr><th id="774">774</th><td>      <b>if</b> (MPFR_IS_NAN (x))</td></tr>
<tr><th id="775">775</th><td>        {</td></tr>
<tr><th id="776">776</th><td>          MPFR_SET_NAN (y);</td></tr>
<tr><th id="777">777</th><td>          MPFR_RET_NAN;</td></tr>
<tr><th id="778">778</th><td>        }</td></tr>
<tr><th id="779">779</th><td>      <b>else</b></td></tr>
<tr><th id="780">780</th><td>        {</td></tr>
<tr><th id="781">781</th><td>          <b>if</b> (MPFR_IS_ZERO (x))</td></tr>
<tr><th id="782">782</th><td>            MPFR_SET_DIVBY0 ();</td></tr>
<tr><th id="783">783</th><td>          *signp = MPFR_INT_SIGN (x);</td></tr>
<tr><th id="784">784</th><td>          MPFR_SET_INF (y);</td></tr>
<tr><th id="785">785</th><td>          MPFR_SET_POS (y);</td></tr>
<tr><th id="786">786</th><td>          MPFR_RET (<var>0</var>);</td></tr>
<tr><th id="787">787</th><td>        }</td></tr>
<tr><th id="788">788</th><td>    }</td></tr>
<tr><th id="789">789</th><td></td></tr>
<tr><th id="790">790</th><td>  <b>if</b> (MPFR_IS_NEG (x))</td></tr>
<tr><th id="791">791</th><td>    {</td></tr>
<tr><th id="792">792</th><td>      <b>if</b> (mpfr_integer_p (x))</td></tr>
<tr><th id="793">793</th><td>        {</td></tr>
<tr><th id="794">794</th><td>          MPFR_SET_INF (y);</td></tr>
<tr><th id="795">795</th><td>          MPFR_SET_POS (y);</td></tr>
<tr><th id="796">796</th><td>          MPFR_SET_DIVBY0 ();</td></tr>
<tr><th id="797">797</th><td>          MPFR_RET (<var>0</var>);</td></tr>
<tr><th id="798">798</th><td>        }</td></tr>
<tr><th id="799">799</th><td></td></tr>
<tr><th id="800">800</th><td>      <b>if</b> (unit_bit (x) == <var>0</var>)</td></tr>
<tr><th id="801">801</th><td>        *signp = -<var>1</var>;</td></tr>
<tr><th id="802">802</th><td></td></tr>
<tr><th id="803">803</th><td>      <i>/* For tiny negative x, we have gamma(x) = 1/x - euler + O(x),</i></td></tr>
<tr><th id="804">804</th><td><i>         thus |gamma(x)| = -1/x + euler + O(x), and</i></td></tr>
<tr><th id="805">805</th><td><i>         log |gamma(x)| = -log(-x) - euler*x + O(x^2).</i></td></tr>
<tr><th id="806">806</th><td><i>         More precisely we have for -0.4 &lt;= x &lt; 0:</i></td></tr>
<tr><th id="807">807</th><td><i>         -log(-x) &lt;= log |gamma(x)| &lt;= -log(-x) - x.</i></td></tr>
<tr><th id="808">808</th><td><i>         Since log(x) is not representable, we may have an instance of the</i></td></tr>
<tr><th id="809">809</th><td><i>         Table Maker Dilemma. The only way to ensure correct rounding is to</i></td></tr>
<tr><th id="810">810</th><td><i>         compute an interval [l,h] such that l &lt;= -log(-x) and</i></td></tr>
<tr><th id="811">811</th><td><i>         -log(-x) - x &lt;= h, and check whether l and h round to the same number</i></td></tr>
<tr><th id="812">812</th><td><i>         for the target precision and rounding modes. */</i></td></tr>
<tr><th id="813">813</th><td>      <b>if</b> (MPFR_EXP(x) + <var>1</var> &lt;= - (mpfr_exp_t) MPFR_PREC(y))</td></tr>
<tr><th id="814">814</th><td>        <i>/* since PREC(y) &gt;= 1, this ensures EXP(x) &lt;= -2,</i></td></tr>
<tr><th id="815">815</th><td><i>           thus |x| &lt;= 0.25 &lt; 0.4 */</i></td></tr>
<tr><th id="816">816</th><td>        {</td></tr>
<tr><th id="817">817</th><td>          mpfr_t l, h;</td></tr>
<tr><th id="818">818</th><td>          <em>int</em> ok, inex2;</td></tr>
<tr><th id="819">819</th><td>          mpfr_prec_t w = MPFR_PREC (y) + <var>14</var>;</td></tr>
<tr><th id="820">820</th><td>          mpfr_exp_t expl;</td></tr>
<tr><th id="821">821</th><td>          MPFR_SAVE_EXPO_DECL (expo);</td></tr>
<tr><th id="822">822</th><td></td></tr>
<tr><th id="823">823</th><td>          MPFR_SAVE_EXPO_MARK (expo);</td></tr>
<tr><th id="824">824</th><td></td></tr>
<tr><th id="825">825</th><td>          <b>while</b> (<var>1</var>)</td></tr>
<tr><th id="826">826</th><td>            {</td></tr>
<tr><th id="827">827</th><td>              mpfr_init2 (l, w);</td></tr>
<tr><th id="828">828</th><td>              mpfr_init2 (h, w);</td></tr>
<tr><th id="829">829</th><td>              <i>/* we want a lower bound on -log(-x), thus an upper bound</i></td></tr>
<tr><th id="830">830</th><td><i>                 on log(-x), thus an upper bound on -x. */</i></td></tr>
<tr><th id="831">831</th><td>              mpfr_neg (l, x, MPFR_RNDU); <i>/* upper bound on -x */</i></td></tr>
<tr><th id="832">832</th><td>              mpfr_log (l, l, MPFR_RNDU); <i>/* upper bound for log(-x) */</i></td></tr>
<tr><th id="833">833</th><td>              mpfr_neg (l, l, MPFR_RNDD); <i>/* lower bound for -log(-x) */</i></td></tr>
<tr><th id="834">834</th><td>              mpfr_neg (h, x, MPFR_RNDD); <i>/* lower bound on -x */</i></td></tr>
<tr><th id="835">835</th><td>              mpfr_log (h, h, MPFR_RNDD); <i>/* lower bound on log(-x) */</i></td></tr>
<tr><th id="836">836</th><td>              mpfr_neg (h, h, MPFR_RNDU); <i>/* upper bound for -log(-x) */</i></td></tr>
<tr><th id="837">837</th><td>              mpfr_sub (h, h, x, MPFR_RNDU); <i>/* upper bound for -log(-x) - x */</i></td></tr>
<tr><th id="838">838</th><td>              inex = mpfr_prec_round (l, MPFR_PREC (y), rnd);</td></tr>
<tr><th id="839">839</th><td>              inex2 = mpfr_prec_round (h, MPFR_PREC (y), rnd);</td></tr>
<tr><th id="840">840</th><td>              <i>/* Caution: we not only need l = h, but both inexact flags</i></td></tr>
<tr><th id="841">841</th><td><i>                 should agree. Indeed, one of the inexact flags might be</i></td></tr>
<tr><th id="842">842</th><td><i>                 zero. In that case if we assume ln|gamma(x)| cannot be</i></td></tr>
<tr><th id="843">843</th><td><i>                 exact, the other flag should be correct. We are conservative</i></td></tr>
<tr><th id="844">844</th><td><i>                 here and request that both inexact flags agree. */</i></td></tr>
<tr><th id="845">845</th><td>              ok = SAME_SIGN (inex, inex2) &amp;&amp; mpfr_equal_p (l, h);</td></tr>
<tr><th id="846">846</th><td>              <b>if</b> (ok)</td></tr>
<tr><th id="847">847</th><td>                mpfr_set (y, h, rnd); <i>/* exact */</i></td></tr>
<tr><th id="848">848</th><td>              <b>else</b></td></tr>
<tr><th id="849">849</th><td>                expl = MPFR_EXP (l);</td></tr>
<tr><th id="850">850</th><td>              mpfr_clear (l);</td></tr>
<tr><th id="851">851</th><td>              mpfr_clear (h);</td></tr>
<tr><th id="852">852</th><td>              <b>if</b> (ok)</td></tr>
<tr><th id="853">853</th><td>                {</td></tr>
<tr><th id="854">854</th><td>                  MPFR_SAVE_EXPO_FREE (expo);</td></tr>
<tr><th id="855">855</th><td>                  <b>return</b> mpfr_check_range (y, inex, rnd);</td></tr>
<tr><th id="856">856</th><td>                }</td></tr>
<tr><th id="857">857</th><td>              <i>/* if ulp(log(-x)) &lt;= |x| there is no reason to loop,</i></td></tr>
<tr><th id="858">858</th><td><i>                 since the width of [l, h] will be at least |x| */</i></td></tr>
<tr><th id="859">859</th><td>              <b>if</b> (expl &lt; MPFR_EXP (x) + w)</td></tr>
<tr><th id="860">860</th><td>                <b>break</b>;</td></tr>
<tr><th id="861">861</th><td>              w += MPFR_INT_CEIL_LOG2(w) + <var>3</var>;</td></tr>
<tr><th id="862">862</th><td>            }</td></tr>
<tr><th id="863">863</th><td></td></tr>
<tr><th id="864">864</th><td>          MPFR_SAVE_EXPO_FREE (expo);</td></tr>
<tr><th id="865">865</th><td>        }</td></tr>
<tr><th id="866">866</th><td>    }</td></tr>
<tr><th id="867">867</th><td></td></tr>
<tr><th id="868">868</th><td>  inex = mpfr_lngamma_aux (y, x, rnd);</td></tr>
<tr><th id="869">869</th><td>  <b>return</b> inex;</td></tr>
<tr><th id="870">870</th><td>}</td></tr>
<tr><th id="871">871</th><td></td></tr>
<tr><th id="872">872</th><td><u>#<span data-ppcond="718">endif</span></u></td></tr>
<tr><th id="873">873</th><td></td></tr>
</table><hr/><p id='footer'>
Generated while processing <a href='gamma.c.html'>netbsd/external/lgpl3/mpfr/dist/src/gamma.c</a><br/>Generated on <em>2019-Jul-19</em> from project netbsd revision <em>f9da89e0d</em><br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 2.1
<br/>Generator usage only permitted with license.</p>
</div></body></html>
