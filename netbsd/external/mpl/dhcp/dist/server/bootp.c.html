<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>bootp.c source code [netbsd/external/mpl/dhcp/dist/server/bootp.c] - Woboq Code Browser</title>
<link rel="stylesheet" href="https://code.woboq.org/data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="https://code.woboq.org/data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="https://code.woboq.org/data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="https://code.woboq.org/data/jquery/jquery-ui.min.js"></script>
<script>var file = 'netbsd/external/mpl/dhcp/dist/server/bootp.c'; var root_path = '../../../../../..'; var data_path = 'https://code.woboq.org/data'; var ecma_script_api_version = 2;</script>
<script src='https://code.woboq.org/data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='../../../../..'>netbsd</a>/<a href='../../../..'>external</a>/<a href='../../..'>mpl</a>/<a href='../..'>dhcp</a>/<a href='..'>dist</a>/<a href='./'>server</a>/<a href='bootp.c.html'>bootp.c</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>/*	$NetBSD: bootp.c,v 1.2 2018/04/07 22:37:30 christos Exp $	*/</i></td></tr>
<tr><th id="2">2</th><td></td></tr>
<tr><th id="3">3</th><td><i>/* bootp.c</i></td></tr>
<tr><th id="4">4</th><td><i></i></td></tr>
<tr><th id="5">5</th><td><i>   BOOTP Protocol support. */</i></td></tr>
<tr><th id="6">6</th><td></td></tr>
<tr><th id="7">7</th><td><i>/*</i></td></tr>
<tr><th id="8">8</th><td><i> * Copyright (c) 2004-2017 by Internet Systems Consortium, Inc. ("ISC")</i></td></tr>
<tr><th id="9">9</th><td><i> * Copyright (c) 1995-2003 by Internet Software Consortium</i></td></tr>
<tr><th id="10">10</th><td><i> *</i></td></tr>
<tr><th id="11">11</th><td><i> * This Source Code Form is subject to the terms of the Mozilla Public</i></td></tr>
<tr><th id="12">12</th><td><i> * License, v. 2.0. If a copy of the MPL was not distributed with this</i></td></tr>
<tr><th id="13">13</th><td><i> * file, You can obtain one at <a href="http://mozilla.org/MPL/2.0/">http://mozilla.org/MPL/2.0/</a>.</i></td></tr>
<tr><th id="14">14</th><td><i> *</i></td></tr>
<tr><th id="15">15</th><td><i> * THE SOFTWARE IS PROVIDED "AS IS" AND ISC DISCLAIMS ALL WARRANTIES</i></td></tr>
<tr><th id="16">16</th><td><i> * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF</i></td></tr>
<tr><th id="17">17</th><td><i> * MERCHANTABILITY AND FITNESS.  IN NO EVENT SHALL ISC BE LIABLE FOR</i></td></tr>
<tr><th id="18">18</th><td><i> * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES</i></td></tr>
<tr><th id="19">19</th><td><i> * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN</i></td></tr>
<tr><th id="20">20</th><td><i> * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT</i></td></tr>
<tr><th id="21">21</th><td><i> * OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.</i></td></tr>
<tr><th id="22">22</th><td><i> *</i></td></tr>
<tr><th id="23">23</th><td><i> *   Internet Systems Consortium, Inc.</i></td></tr>
<tr><th id="24">24</th><td><i> *   950 Charter Street</i></td></tr>
<tr><th id="25">25</th><td><i> *   Redwood City, CA 94063</i></td></tr>
<tr><th id="26">26</th><td><i> *   &lt;info@isc.org&gt;</i></td></tr>
<tr><th id="27">27</th><td><i> *   <a href="https://www.isc.org/">https://www.isc.org/</a></i></td></tr>
<tr><th id="28">28</th><td><i> *</i></td></tr>
<tr><th id="29">29</th><td><i> */</i></td></tr>
<tr><th id="30">30</th><td></td></tr>
<tr><th id="31">31</th><td><u>#include <a href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/cdefs.h.html">&lt;sys/cdefs.h&gt;</a></u></td></tr>
<tr><th id="32">32</th><td><a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/cdefs_elf.h.html#151" title="__asm(&quot;.pushsection &quot; &quot;.ident&quot; &quot;\n&quot; &quot;.asciz \&quot;&quot; &quot;$NetBSD: bootp.c,v 1.2 2018/04/07 22:37:30 christos Exp $&quot; &quot;\&quot;\n&quot; &quot;.popsection&quot;)" data-ref="_M/__RCSID">__RCSID</a>(<q>"$NetBSD: bootp.c,v 1.2 2018/04/07 22:37:30 christos Exp $"</q>);</td></tr>
<tr><th id="33">33</th><td></td></tr>
<tr><th id="34">34</th><td><u>#include <a href="../includes/dhcpd.h.html">"dhcpd.h"</a></u></td></tr>
<tr><th id="35">35</th><td><u>#include <a href="../../../../../objdir.amd64/destdir.amd64/usr/include/errno.h.html">&lt;errno.h&gt;</a></u></td></tr>
<tr><th id="36">36</th><td></td></tr>
<tr><th id="37">37</th><td><u>#<span data-ppcond="37">if</span> defined (<a class="macro" href="../../include/config.h.html#172" data-ref="_M/TRACING">TRACING</a>)</u></td></tr>
<tr><th id="38">38</th><td><u># define <dfn class="macro" id="_M/send_packet" data-ref="_M/send_packet">send_packet</dfn> <a class="ref fn" href="../includes/ctrace.h.html#trace_packet_send" title='trace_packet_send' data-ref="trace_packet_send" data-ref-filename="trace_packet_send">trace_packet_send</a></u></td></tr>
<tr><th id="39">39</th><td><u>#<span data-ppcond="37">endif</span></u></td></tr>
<tr><th id="40">40</th><td></td></tr>
<tr><th id="41">41</th><td><em>void</em> <dfn class="decl def fn" id="bootp" title='bootp' data-ref="bootp" data-ref-filename="bootp">bootp</dfn> (packet)</td></tr>
<tr><th id="42">42</th><td>	<b>struct</b> <a class="type" href="../includes/dhcpd.h.html#packet" title='packet' data-ref="packet" data-ref-filename="packet">packet</a> *<dfn class="local col1 decl" id="1packet" title='packet' data-type='struct packet *' data-ref="1packet" data-ref-filename="1packet">packet</dfn>;</td></tr>
<tr><th id="43">43</th><td>{</td></tr>
<tr><th id="44">44</th><td>	<em>int</em> <dfn class="local col2 decl" id="2result" title='result' data-type='int' data-ref="2result" data-ref-filename="2result">result</dfn>;</td></tr>
<tr><th id="45">45</th><td>	<b>struct</b> <a class="type" href="../includes/dhcpd.h.html#host_decl" title='host_decl' data-ref="host_decl" data-ref-filename="host_decl">host_decl</a> *<dfn class="local col3 decl" id="3hp" title='hp' data-type='struct host_decl *' data-ref="3hp" data-ref-filename="3hp">hp</dfn> = (<b>struct</b> <a class="type" href="../includes/dhcpd.h.html#host_decl" title='host_decl' data-ref="host_decl" data-ref-filename="host_decl">host_decl</a> *)<var>0</var>;</td></tr>
<tr><th id="46">46</th><td>	<b>struct</b> <a class="type" href="../includes/dhcpd.h.html#host_decl" title='host_decl' data-ref="host_decl" data-ref-filename="host_decl">host_decl</a> *<dfn class="local col4 decl" id="4host" title='host' data-type='struct host_decl *' data-ref="4host" data-ref-filename="4host">host</dfn> = (<b>struct</b> <a class="type" href="../includes/dhcpd.h.html#host_decl" title='host_decl' data-ref="host_decl" data-ref-filename="host_decl">host_decl</a> *)<var>0</var>;</td></tr>
<tr><th id="47">47</th><td>	<b>struct</b> <a class="type" href="../includes/dhcpd.h.html#packet" title='packet' data-ref="packet" data-ref-filename="packet">packet</a> <dfn class="local col5 decl" id="5outgoing" title='outgoing' data-type='struct packet' data-ref="5outgoing" data-ref-filename="5outgoing">outgoing</dfn>;</td></tr>
<tr><th id="48">48</th><td>	<b>struct</b> <a class="type" href="../includes/dhcp.h.html#dhcp_packet" title='dhcp_packet' data-ref="dhcp_packet" data-ref-filename="dhcp_packet">dhcp_packet</a> <dfn class="local col6 decl" id="6raw" title='raw' data-type='struct dhcp_packet' data-ref="6raw" data-ref-filename="6raw">raw</dfn>;</td></tr>
<tr><th id="49">49</th><td>	<b>struct</b> <a class="type" href="../../../../../objdir.amd64/destdir.amd64/usr/include/netinet/in.h.html#sockaddr_in" title='sockaddr_in' data-ref="sockaddr_in" data-ref-filename="sockaddr_in">sockaddr_in</a> <dfn class="local col7 decl" id="7to" title='to' data-type='struct sockaddr_in' data-ref="7to" data-ref-filename="7to">to</dfn>;</td></tr>
<tr><th id="50">50</th><td>	<b>struct</b> <a class="type" href="../../../../../objdir.amd64/destdir.amd64/usr/include/netinet/in.h.html#in_addr" title='in_addr' data-ref="in_addr" data-ref-filename="in_addr">in_addr</a> <dfn class="local col8 decl" id="8from" title='from' data-type='struct in_addr' data-ref="8from" data-ref-filename="8from">from</dfn>;</td></tr>
<tr><th id="51">51</th><td>	<b>struct</b> <a class="type" href="../includes/dhcpd.h.html#hardware" title='hardware' data-ref="hardware" data-ref-filename="hardware">hardware</a> <dfn class="local col9 decl" id="9hto" title='hto' data-type='struct hardware' data-ref="9hto" data-ref-filename="9hto">hto</dfn>;</td></tr>
<tr><th id="52">52</th><td>	<b>struct</b> <a class="type" href="../includes/dhcpd.h.html#option_state" title='option_state' data-ref="option_state" data-ref-filename="option_state">option_state</a> *<dfn class="local col0 decl" id="10options" title='options' data-type='struct option_state *' data-ref="10options" data-ref-filename="10options">options</dfn> = (<b>struct</b> <a class="type" href="../includes/dhcpd.h.html#option_state" title='option_state' data-ref="option_state" data-ref-filename="option_state">option_state</a> *)<var>0</var>;</td></tr>
<tr><th id="53">53</th><td>	<b>struct</b> <a class="type" href="../includes/dhcpd.h.html#lease" title='lease' data-ref="lease" data-ref-filename="lease">lease</a> *<dfn class="local col1 decl" id="11lease" title='lease' data-type='struct lease *' data-ref="11lease" data-ref-filename="11lease">lease</dfn> = (<b>struct</b> <a class="type" href="../includes/dhcpd.h.html#lease" title='lease' data-ref="lease" data-ref-filename="lease">lease</a> *)<var>0</var>;</td></tr>
<tr><th id="54">54</th><td>	<em>unsigned</em> <dfn class="local col2 decl" id="12i" title='i' data-type='unsigned int' data-ref="12i" data-ref-filename="12i">i</dfn>;</td></tr>
<tr><th id="55">55</th><td>	<b>struct</b> <a class="type" href="../includes/tree.h.html#data_string" title='data_string' data-ref="data_string" data-ref-filename="data_string">data_string</a> <dfn class="local col3 decl" id="13d1" title='d1' data-type='struct data_string' data-ref="13d1" data-ref-filename="13d1">d1</dfn>;</td></tr>
<tr><th id="56">56</th><td>	<b>struct</b> <a class="type" href="../includes/dhcpd.h.html#option_cache" title='option_cache' data-ref="option_cache" data-ref-filename="option_cache">option_cache</a> *<dfn class="local col4 decl" id="14oc" title='oc' data-type='struct option_cache *' data-ref="14oc" data-ref-filename="14oc">oc</dfn>;</td></tr>
<tr><th id="57">57</th><td>	<em>char</em> <dfn class="local col5 decl" id="15msgbuf" title='msgbuf' data-type='char [1024]' data-ref="15msgbuf" data-ref-filename="15msgbuf">msgbuf</dfn> [<var>1024</var>];</td></tr>
<tr><th id="58">58</th><td>	<em>int</em> <dfn class="local col6 decl" id="16ignorep" title='ignorep' data-type='int' data-ref="16ignorep" data-ref-filename="16ignorep">ignorep</dfn>;</td></tr>
<tr><th id="59">59</th><td>	<em>int</em> <dfn class="local col7 decl" id="17peer_has_leases" title='peer_has_leases' data-type='int' data-ref="17peer_has_leases" data-ref-filename="17peer_has_leases">peer_has_leases</dfn> = <var>0</var>;</td></tr>
<tr><th id="60">60</th><td></td></tr>
<tr><th id="61">61</th><td>	<b>if</b> (<a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#packet::raw" title='packet::raw' data-ref="packet::raw" data-ref-filename="packet..raw">raw</a> -&gt; <a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::op" title='dhcp_packet::op' data-ref="dhcp_packet::op" data-ref-filename="dhcp_packet..op">op</a> != <a class="macro" href="../includes/dhcp.h.html#70" title="1" data-ref="_M/BOOTREQUEST">BOOTREQUEST</a>)</td></tr>
<tr><th id="62">62</th><td>		<b>return</b>;</td></tr>
<tr><th id="63">63</th><td></td></tr>
<tr><th id="64">64</th><td>	<i>/* %Audit% This is log output. %2004.06.17,Safe%</i></td></tr>
<tr><th id="65">65</th><td><i>	 * If we truncate we hope the user can get a hint from the log.</i></td></tr>
<tr><th id="66">66</th><td><i>	 */</i></td></tr>
<tr><th id="67">67</th><td>	<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html#snprintf" title='snprintf' data-ref="snprintf" data-ref-filename="snprintf">snprintf</a> (<a class="local col5 ref" href="#15msgbuf" title='msgbuf' data-ref="15msgbuf" data-ref-filename="15msgbuf">msgbuf</a>, <b>sizeof</b> <a class="local col5 ref" href="#15msgbuf" title='msgbuf' data-ref="15msgbuf" data-ref-filename="15msgbuf">msgbuf</a>, <q>"BOOTREQUEST from %s via %s"</q>,</td></tr>
<tr><th id="68">68</th><td>		 <a class="ref fn" href="../includes/dhcpd.h.html#print_hw_addr" title='print_hw_addr' data-ref="print_hw_addr" data-ref-filename="print_hw_addr">print_hw_addr</a> (<a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#packet::raw" title='packet::raw' data-ref="packet::raw" data-ref-filename="packet..raw">raw</a> -&gt; <a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::htype" title='dhcp_packet::htype' data-ref="dhcp_packet::htype" data-ref-filename="dhcp_packet..htype">htype</a>,</td></tr>
<tr><th id="69">69</th><td>				<a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#packet::raw" title='packet::raw' data-ref="packet::raw" data-ref-filename="packet..raw">raw</a> -&gt; <a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::hlen" title='dhcp_packet::hlen' data-ref="dhcp_packet::hlen" data-ref-filename="dhcp_packet..hlen">hlen</a>,</td></tr>
<tr><th id="70">70</th><td>				<a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#packet::raw" title='packet::raw' data-ref="packet::raw" data-ref-filename="packet..raw">raw</a> -&gt; <a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::chaddr" title='dhcp_packet::chaddr' data-ref="dhcp_packet::chaddr" data-ref-filename="dhcp_packet..chaddr">chaddr</a>),</td></tr>
<tr><th id="71">71</th><td>		 <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#packet::raw" title='packet::raw' data-ref="packet::raw" data-ref-filename="packet..raw">raw</a> -&gt; <a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::giaddr" title='dhcp_packet::giaddr' data-ref="dhcp_packet::giaddr" data-ref-filename="dhcp_packet..giaddr">giaddr</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/netinet/in.h.html#in_addr::s_addr" title='in_addr::s_addr' data-ref="in_addr::s_addr" data-ref-filename="in_addr..s_addr">s_addr</a></td></tr>
<tr><th id="72">72</th><td>		 ? <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/arpa/inet.h.html#inet_ntoa" title='inet_ntoa' data-ref="inet_ntoa" data-ref-filename="inet_ntoa">inet_ntoa</a> (<a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#packet::raw" title='packet::raw' data-ref="packet::raw" data-ref-filename="packet..raw">raw</a> -&gt; <a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::giaddr" title='dhcp_packet::giaddr' data-ref="dhcp_packet::giaddr" data-ref-filename="dhcp_packet..giaddr">giaddr</a>)</td></tr>
<tr><th id="73">73</th><td>		 : <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#packet::interface" title='packet::interface' data-ref="packet::interface" data-ref-filename="packet..interface">interface</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#interface_info::name" title='interface_info::name' data-ref="interface_info::name" data-ref-filename="interface_info..name">name</a>);</td></tr>
<tr><th id="74">74</th><td></td></tr>
<tr><th id="75">75</th><td>	<b>if</b> (!<a class="ref fn" href="../includes/dhcpd.h.html#locate_network" title='locate_network' data-ref="locate_network" data-ref-filename="locate_network">locate_network</a> (<a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>)) {</td></tr>
<tr><th id="76">76</th><td>		<a class="ref fn" href="../includes/omapip/omapip_p.h.html#log_info" title='log_info' data-ref="log_info" data-ref-filename="log_info">log_info</a> (<q>"%s: network unknown"</q>, <a class="local col5 ref" href="#15msgbuf" title='msgbuf' data-ref="15msgbuf" data-ref-filename="15msgbuf">msgbuf</a>);</td></tr>
<tr><th id="77">77</th><td>		<b>return</b>;</td></tr>
<tr><th id="78">78</th><td>	}</td></tr>
<tr><th id="79">79</th><td></td></tr>
<tr><th id="80">80</th><td>	<a class="ref fn" href="../includes/dhcpd.h.html#find_lease" title='find_lease' data-ref="find_lease" data-ref-filename="find_lease">find_lease</a> (&amp;<a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>, <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>, <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#packet::shared_network" title='packet::shared_network' data-ref="packet::shared_network" data-ref-filename="packet..shared_network">shared_network</a>,</td></tr>
<tr><th id="81">81</th><td>		    <var>0</var>, <var>0</var>, (<b>struct</b> <a class="type" href="../includes/dhcpd.h.html#lease" title='lease' data-ref="lease" data-ref-filename="lease">lease</a> *)<var>0</var>, <a class="macro" href="../includes/omapip/omapip.h.html#569" title="&quot;/___NETBSD_SRC___/objdir.amd64/external/mpl/dhcp/bin/server/../../../../../../external/mpl/dhcp/dist/server/bootp.c&quot;, 81" data-ref="_M/MDL">MDL</a>);</td></tr>
<tr><th id="82">82</th><td></td></tr>
<tr><th id="83">83</th><td>	<b>if</b> (<a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a> &amp;&amp; <a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#lease::host" title='lease::host' data-ref="lease::host" data-ref-filename="lease..host">host</a>)</td></tr>
<tr><th id="84">84</th><td>		<a class="ref fn" href="../includes/dhcpd.h.html#2487" title='host_reference' data-ref="host_reference" data-ref-filename="host_reference">host_reference</a>(&amp;<a class="local col3 ref" href="#3hp" title='hp' data-ref="3hp" data-ref-filename="3hp">hp</a>, <a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#lease::host" title='lease::host' data-ref="lease::host" data-ref-filename="lease..host">host</a>, <a class="macro" href="../includes/omapip/omapip.h.html#569" title="&quot;/___NETBSD_SRC___/objdir.amd64/external/mpl/dhcp/bin/server/../../../../../../external/mpl/dhcp/dist/server/bootp.c&quot;, 84" data-ref="_M/MDL">MDL</a>);</td></tr>
<tr><th id="85">85</th><td></td></tr>
<tr><th id="86">86</th><td>	<b>if</b> (!<a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a> || ((<a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#lease::flags" title='lease::flags' data-ref="lease::flags" data-ref-filename="lease..flags">flags</a> &amp; <a class="macro" href="../includes/dhcpd.h.html#590" title="1" data-ref="_M/STATIC_LEASE">STATIC_LEASE</a>) == <var>0</var>)) {</td></tr>
<tr><th id="87">87</th><td>		<b>struct</b> <a class="type" href="../includes/dhcpd.h.html#host_decl" title='host_decl' data-ref="host_decl" data-ref-filename="host_decl">host_decl</a> *<dfn class="local col8 decl" id="18h" title='h' data-type='struct host_decl *' data-ref="18h" data-ref-filename="18h">h</dfn>;</td></tr>
<tr><th id="88">88</th><td></td></tr>
<tr><th id="89">89</th><td>		<i>/* We didn't find an applicable fixed-address host</i></td></tr>
<tr><th id="90">90</th><td><i>		   declaration.  Just in case we may be able to dynamically</i></td></tr>
<tr><th id="91">91</th><td><i>		   assign an address, see if there's a host declaration</i></td></tr>
<tr><th id="92">92</th><td><i>		   that doesn't have an ip address associated with it. */</i></td></tr>
<tr><th id="93">93</th><td></td></tr>
<tr><th id="94">94</th><td>		<b>if</b> (!<a class="local col3 ref" href="#3hp" title='hp' data-ref="3hp" data-ref-filename="3hp">hp</a>)</td></tr>
<tr><th id="95">95</th><td>			<a class="ref fn" href="../includes/dhcpd.h.html#find_hosts_by_haddr" title='find_hosts_by_haddr' data-ref="find_hosts_by_haddr" data-ref-filename="find_hosts_by_haddr">find_hosts_by_haddr</a>(&amp;<a class="local col3 ref" href="#3hp" title='hp' data-ref="3hp" data-ref-filename="3hp">hp</a>, <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#packet::raw" title='packet::raw' data-ref="packet::raw" data-ref-filename="packet..raw">raw</a>-&gt;<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::htype" title='dhcp_packet::htype' data-ref="dhcp_packet::htype" data-ref-filename="dhcp_packet..htype">htype</a>,</td></tr>
<tr><th id="96">96</th><td>					    <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#packet::raw" title='packet::raw' data-ref="packet::raw" data-ref-filename="packet..raw">raw</a>-&gt;<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::chaddr" title='dhcp_packet::chaddr' data-ref="dhcp_packet::chaddr" data-ref-filename="dhcp_packet..chaddr">chaddr</a>,</td></tr>
<tr><th id="97">97</th><td>					    <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#packet::raw" title='packet::raw' data-ref="packet::raw" data-ref-filename="packet..raw">raw</a>-&gt;<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::hlen" title='dhcp_packet::hlen' data-ref="dhcp_packet::hlen" data-ref-filename="dhcp_packet..hlen">hlen</a>, <a class="macro" href="../includes/omapip/omapip.h.html#569" title="&quot;/___NETBSD_SRC___/objdir.amd64/external/mpl/dhcp/bin/server/../../../../../../external/mpl/dhcp/dist/server/bootp.c&quot;, 97" data-ref="_M/MDL">MDL</a>);</td></tr>
<tr><th id="98">98</th><td></td></tr>
<tr><th id="99">99</th><td>		<b>for</b> (<a class="local col8 ref" href="#18h" title='h' data-ref="18h" data-ref-filename="18h">h</a> = <a class="local col3 ref" href="#3hp" title='hp' data-ref="3hp" data-ref-filename="3hp">hp</a>; <a class="local col8 ref" href="#18h" title='h' data-ref="18h" data-ref-filename="18h">h</a>; <a class="local col8 ref" href="#18h" title='h' data-ref="18h" data-ref-filename="18h">h</a> = <a class="local col8 ref" href="#18h" title='h' data-ref="18h" data-ref-filename="18h">h</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#host_decl::n_ipaddr" title='host_decl::n_ipaddr' data-ref="host_decl::n_ipaddr" data-ref-filename="host_decl..n_ipaddr">n_ipaddr</a>) {</td></tr>
<tr><th id="100">100</th><td>			<b>if</b> (!<a class="local col8 ref" href="#18h" title='h' data-ref="18h" data-ref-filename="18h">h</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#host_decl::fixed_addr" title='host_decl::fixed_addr' data-ref="host_decl::fixed_addr" data-ref-filename="host_decl..fixed_addr">fixed_addr</a>) {</td></tr>
<tr><th id="101">101</th><td>				<a class="ref fn" href="../includes/dhcpd.h.html#2487" title='host_reference' data-ref="host_reference" data-ref-filename="host_reference">host_reference</a>(&amp;<a class="local col4 ref" href="#4host" title='host' data-ref="4host" data-ref-filename="4host">host</a>, <a class="local col8 ref" href="#18h" title='h' data-ref="18h" data-ref-filename="18h">h</a>, <a class="macro" href="../includes/omapip/omapip.h.html#569" title="&quot;/___NETBSD_SRC___/objdir.amd64/external/mpl/dhcp/bin/server/../../../../../../external/mpl/dhcp/dist/server/bootp.c&quot;, 101" data-ref="_M/MDL">MDL</a>);</td></tr>
<tr><th id="102">102</th><td>				<b>break</b>;</td></tr>
<tr><th id="103">103</th><td>			}</td></tr>
<tr><th id="104">104</th><td>		}</td></tr>
<tr><th id="105">105</th><td></td></tr>
<tr><th id="106">106</th><td>		<b>if</b> (<a class="local col3 ref" href="#3hp" title='hp' data-ref="3hp" data-ref-filename="3hp">hp</a>)</td></tr>
<tr><th id="107">107</th><td>			<a class="ref fn" href="../includes/dhcpd.h.html#2487" title='host_dereference' data-ref="host_dereference" data-ref-filename="host_dereference">host_dereference</a>(&amp;<a class="local col3 ref" href="#3hp" title='hp' data-ref="3hp" data-ref-filename="3hp">hp</a>, <a class="macro" href="../includes/omapip/omapip.h.html#569" title="&quot;/___NETBSD_SRC___/objdir.amd64/external/mpl/dhcp/bin/server/../../../../../../external/mpl/dhcp/dist/server/bootp.c&quot;, 107" data-ref="_M/MDL">MDL</a>);</td></tr>
<tr><th id="108">108</th><td></td></tr>
<tr><th id="109">109</th><td>		<b>if</b> (<a class="local col4 ref" href="#4host" title='host' data-ref="4host" data-ref-filename="4host">host</a>) {</td></tr>
<tr><th id="110">110</th><td>			<a class="ref fn" href="../includes/dhcpd.h.html#2487" title='host_reference' data-ref="host_reference" data-ref-filename="host_reference">host_reference</a>(&amp;<a class="local col3 ref" href="#3hp" title='hp' data-ref="3hp" data-ref-filename="3hp">hp</a>, <a class="local col4 ref" href="#4host" title='host' data-ref="4host" data-ref-filename="4host">host</a>, <a class="macro" href="../includes/omapip/omapip.h.html#569" title="&quot;/___NETBSD_SRC___/objdir.amd64/external/mpl/dhcp/bin/server/../../../../../../external/mpl/dhcp/dist/server/bootp.c&quot;, 110" data-ref="_M/MDL">MDL</a>);</td></tr>
<tr><th id="111">111</th><td>			<a class="ref fn" href="../includes/dhcpd.h.html#2487" title='host_dereference' data-ref="host_dereference" data-ref-filename="host_dereference">host_dereference</a>(&amp;<a class="local col4 ref" href="#4host" title='host' data-ref="4host" data-ref-filename="4host">host</a>, <a class="macro" href="../includes/omapip/omapip.h.html#569" title="&quot;/___NETBSD_SRC___/objdir.amd64/external/mpl/dhcp/bin/server/../../../../../../external/mpl/dhcp/dist/server/bootp.c&quot;, 111" data-ref="_M/MDL">MDL</a>);</td></tr>
<tr><th id="112">112</th><td>		}</td></tr>
<tr><th id="113">113</th><td></td></tr>
<tr><th id="114">114</th><td>		<i>/* Allocate a lease if we have not yet found one. */</i></td></tr>
<tr><th id="115">115</th><td>		<b>if</b> (!<a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>)</td></tr>
<tr><th id="116">116</th><td>			<a class="ref fn" href="../includes/dhcpd.h.html#allocate_lease" title='allocate_lease' data-ref="allocate_lease" data-ref-filename="allocate_lease">allocate_lease</a> (&amp;<a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>, <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>,</td></tr>
<tr><th id="117">117</th><td>					<a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#packet::shared_network" title='packet::shared_network' data-ref="packet::shared_network" data-ref-filename="packet..shared_network">shared_network</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#shared_network::pools" title='shared_network::pools' data-ref="shared_network::pools" data-ref-filename="shared_network..pools">pools</a>,</td></tr>
<tr><th id="118">118</th><td>					&amp;<a class="local col7 ref" href="#17peer_has_leases" title='peer_has_leases' data-ref="17peer_has_leases" data-ref-filename="17peer_has_leases">peer_has_leases</a>);</td></tr>
<tr><th id="119">119</th><td></td></tr>
<tr><th id="120">120</th><td>		<b>if</b> (<a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a> == <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="121">121</th><td>			<a class="ref fn" href="../includes/omapip/omapip_p.h.html#log_info" title='log_info' data-ref="log_info" data-ref-filename="log_info">log_info</a>(<q>"%s: BOOTP from dynamic client and no "</q></td></tr>
<tr><th id="122">122</th><td>				 <q>"dynamic leases"</q>, <a class="local col5 ref" href="#15msgbuf" title='msgbuf' data-ref="15msgbuf" data-ref-filename="15msgbuf">msgbuf</a>);</td></tr>
<tr><th id="123">123</th><td>			<b>goto</b> <a class="lbl" href="#19out" data-ref="19out" data-ref-filename="19out">out</a>;</td></tr>
<tr><th id="124">124</th><td>		}</td></tr>
<tr><th id="125">125</th><td></td></tr>
<tr><th id="126">126</th><td><u>#<span data-ppcond="126">if</span> defined(<a class="macro" href="../../include/config.h.html#34" data-ref="_M/FAILOVER_PROTOCOL">FAILOVER_PROTOCOL</a>)</u></td></tr>
<tr><th id="127">127</th><td>		<b>if</b> ((<a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#lease::pool" title='lease::pool' data-ref="lease::pool" data-ref-filename="lease..pool">pool</a> != <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) &amp;&amp;</td></tr>
<tr><th id="128">128</th><td>		    (<a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#lease::pool" title='lease::pool' data-ref="lease::pool" data-ref-filename="lease..pool">pool</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#pool::failover_peer" title='pool::failover_peer' data-ref="pool::failover_peer" data-ref-filename="pool..failover_peer">failover_peer</a> != <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>)) {</td></tr>
<tr><th id="129">129</th><td>			<a class="typedef" href="../includes/failover.h.html#dhcp_failover_state_t" title='dhcp_failover_state_t' data-type='struct _dhcp_failover_state' data-ref="dhcp_failover_state_t" data-ref-filename="dhcp_failover_state_t">dhcp_failover_state_t</a> *<dfn class="local col0 decl" id="20peer" title='peer' data-type='dhcp_failover_state_t *' data-ref="20peer" data-ref-filename="20peer">peer</dfn>;</td></tr>
<tr><th id="130">130</th><td></td></tr>
<tr><th id="131">131</th><td>			<a class="local col0 ref" href="#20peer" title='peer' data-ref="20peer" data-ref-filename="20peer">peer</a> = <a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#lease::pool" title='lease::pool' data-ref="lease::pool" data-ref-filename="lease..pool">pool</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#pool::failover_peer" title='pool::failover_peer' data-ref="pool::failover_peer" data-ref-filename="pool..failover_peer">failover_peer</a>;</td></tr>
<tr><th id="132">132</th><td></td></tr>
<tr><th id="133">133</th><td>			<i>/* If we are in a failover state that bars us from</i></td></tr>
<tr><th id="134">134</th><td><i>			 * answering, do not do so.</i></td></tr>
<tr><th id="135">135</th><td><i>			 * If we are in a cooperative state, load balance</i></td></tr>
<tr><th id="136">136</th><td><i>			 * (all) responses.</i></td></tr>
<tr><th id="137">137</th><td><i>			 */</i></td></tr>
<tr><th id="138">138</th><td>			<b>if</b> ((<a class="local col0 ref" href="#20peer" title='peer' data-ref="20peer" data-ref-filename="20peer">peer</a>-&gt;<a class="ref field" href="../includes/failover.h.html#_dhcp_failover_state::service_state" title='_dhcp_failover_state::service_state' data-ref="_dhcp_failover_state::service_state" data-ref-filename="_dhcp_failover_state..service_state">service_state</a> == <a class="enum" href="../includes/failover.h.html#not_responding" title='not_responding' data-ref="not_responding" data-ref-filename="not_responding">not_responding</a>) ||</td></tr>
<tr><th id="139">139</th><td>			    (<a class="local col0 ref" href="#20peer" title='peer' data-ref="20peer" data-ref-filename="20peer">peer</a>-&gt;<a class="ref field" href="../includes/failover.h.html#_dhcp_failover_state::service_state" title='_dhcp_failover_state::service_state' data-ref="_dhcp_failover_state::service_state" data-ref-filename="_dhcp_failover_state..service_state">service_state</a> == <a class="enum" href="../includes/failover.h.html#service_startup" title='service_startup' data-ref="service_startup" data-ref-filename="service_startup">service_startup</a>)) {</td></tr>
<tr><th id="140">140</th><td>				<a class="ref fn" href="../includes/omapip/omapip_p.h.html#log_info" title='log_info' data-ref="log_info" data-ref-filename="log_info">log_info</a>(<q>"%s: not responding%s"</q>,</td></tr>
<tr><th id="141">141</th><td>					 <a class="local col5 ref" href="#15msgbuf" title='msgbuf' data-ref="15msgbuf" data-ref-filename="15msgbuf">msgbuf</a>, <a class="local col0 ref" href="#20peer" title='peer' data-ref="20peer" data-ref-filename="20peer">peer</a>-&gt;<a class="ref field" href="../includes/failover.h.html#_dhcp_failover_state::nrr" title='_dhcp_failover_state::nrr' data-ref="_dhcp_failover_state::nrr" data-ref-filename="_dhcp_failover_state..nrr">nrr</a>);</td></tr>
<tr><th id="142">142</th><td>				<b>goto</b> <a class="lbl" href="#19out" data-ref="19out" data-ref-filename="19out">out</a>;</td></tr>
<tr><th id="143">143</th><td>			} <b>else</b> <b>if</b>((<a class="local col0 ref" href="#20peer" title='peer' data-ref="20peer" data-ref-filename="20peer">peer</a>-&gt;<a class="ref field" href="../includes/failover.h.html#_dhcp_failover_state::service_state" title='_dhcp_failover_state::service_state' data-ref="_dhcp_failover_state::service_state" data-ref-filename="_dhcp_failover_state..service_state">service_state</a> == <a class="enum" href="../includes/failover.h.html#cooperating" title='cooperating' data-ref="cooperating" data-ref-filename="cooperating">cooperating</a>) &amp;&amp;</td></tr>
<tr><th id="144">144</th><td>				  !<a class="ref fn" href="../includes/dhcpd.h.html#load_balance_mine" title='load_balance_mine' data-ref="load_balance_mine" data-ref-filename="load_balance_mine">load_balance_mine</a>(<a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>, <a class="local col0 ref" href="#20peer" title='peer' data-ref="20peer" data-ref-filename="20peer">peer</a>)) {</td></tr>
<tr><th id="145">145</th><td>				<a class="ref fn" href="../includes/omapip/omapip_p.h.html#log_info" title='log_info' data-ref="log_info" data-ref-filename="log_info">log_info</a>(<q>"%s: load balance to peer %s"</q>,</td></tr>
<tr><th id="146">146</th><td>					 <a class="local col5 ref" href="#15msgbuf" title='msgbuf' data-ref="15msgbuf" data-ref-filename="15msgbuf">msgbuf</a>, <a class="local col0 ref" href="#20peer" title='peer' data-ref="20peer" data-ref-filename="20peer">peer</a>-&gt;<a class="ref field" href="../includes/failover.h.html#_dhcp_failover_state::name" title='_dhcp_failover_state::name' data-ref="_dhcp_failover_state::name" data-ref-filename="_dhcp_failover_state..name">name</a>);</td></tr>
<tr><th id="147">147</th><td>				<b>goto</b> <a class="lbl" href="#19out" data-ref="19out" data-ref-filename="19out">out</a>;</td></tr>
<tr><th id="148">148</th><td>			}</td></tr>
<tr><th id="149">149</th><td>		}</td></tr>
<tr><th id="150">150</th><td><u>#<span data-ppcond="126">endif</span></u></td></tr>
<tr><th id="151">151</th><td></td></tr>
<tr><th id="152">152</th><td>		<a class="ref fn" href="../includes/dhcpd.h.html#ack_lease" title='ack_lease' data-ref="ack_lease" data-ref-filename="ack_lease">ack_lease</a> (<a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>, <a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>, <var>0</var>, <var>0</var>, <a class="local col5 ref" href="#15msgbuf" title='msgbuf' data-ref="15msgbuf" data-ref-filename="15msgbuf">msgbuf</a>, <var>0</var>, <a class="local col3 ref" href="#3hp" title='hp' data-ref="3hp" data-ref-filename="3hp">hp</a>);</td></tr>
<tr><th id="153">153</th><td>		<b>goto</b> <a class="lbl" href="#19out" data-ref="19out" data-ref-filename="19out">out</a>;</td></tr>
<tr><th id="154">154</th><td>	}</td></tr>
<tr><th id="155">155</th><td></td></tr>
<tr><th id="156">156</th><td>	<i>/* Run the executable statements to compute the client and server</i></td></tr>
<tr><th id="157">157</th><td><i>	   options. */</i></td></tr>
<tr><th id="158">158</th><td>	<a class="ref fn" href="../includes/dhcpd.h.html#option_state_allocate" title='option_state_allocate' data-ref="option_state_allocate" data-ref-filename="option_state_allocate">option_state_allocate</a> (&amp;<a class="local col0 ref" href="#10options" title='options' data-ref="10options" data-ref-filename="10options">options</a>, <a class="macro" href="../includes/omapip/omapip.h.html#569" title="&quot;/___NETBSD_SRC___/objdir.amd64/external/mpl/dhcp/bin/server/../../../../../../external/mpl/dhcp/dist/server/bootp.c&quot;, 158" data-ref="_M/MDL">MDL</a>);</td></tr>
<tr><th id="159">159</th><td></td></tr>
<tr><th id="160">160</th><td>	<i>/* Execute the subnet statements. */</i></td></tr>
<tr><th id="161">161</th><td>	<a class="ref fn" href="../includes/dhcpd.h.html#execute_statements_in_scope" title='execute_statements_in_scope' data-ref="execute_statements_in_scope" data-ref-filename="execute_statements_in_scope">execute_statements_in_scope</a> (<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>, <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>, <a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,</td></tr>
<tr><th id="162">162</th><td>				     <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#packet::options" title='packet::options' data-ref="packet::options" data-ref-filename="packet..options">options</a>, <a class="local col0 ref" href="#10options" title='options' data-ref="10options" data-ref-filename="10options">options</a>,</td></tr>
<tr><th id="163">163</th><td>				     &amp;<a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#lease::scope" title='lease::scope' data-ref="lease::scope" data-ref-filename="lease..scope">scope</a>, <a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#lease::subnet" title='lease::subnet' data-ref="lease::subnet" data-ref-filename="lease..subnet">subnet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#subnet::group" title='subnet::group' data-ref="subnet::group" data-ref-filename="subnet..group">group</a>,</td></tr>
<tr><th id="164">164</th><td>				     <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="165">165</th><td></td></tr>
<tr><th id="166">166</th><td>	<i>/* Execute statements from class scopes. */</i></td></tr>
<tr><th id="167">167</th><td>	<b>for</b> (<a class="local col2 ref" href="#12i" title='i' data-ref="12i" data-ref-filename="12i">i</a> = <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#packet::class_count" title='packet::class_count' data-ref="packet::class_count" data-ref-filename="packet..class_count">class_count</a>; <a class="local col2 ref" href="#12i" title='i' data-ref="12i" data-ref-filename="12i">i</a> &gt; <var>0</var>; <a class="local col2 ref" href="#12i" title='i' data-ref="12i" data-ref-filename="12i">i</a>--) {</td></tr>
<tr><th id="168">168</th><td>		<a class="ref fn" href="../includes/dhcpd.h.html#execute_statements_in_scope" title='execute_statements_in_scope' data-ref="execute_statements_in_scope" data-ref-filename="execute_statements_in_scope">execute_statements_in_scope</a>(<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>, <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>, <a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,</td></tr>
<tr><th id="169">169</th><td>					    <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#packet::options" title='packet::options' data-ref="packet::options" data-ref-filename="packet..options">options</a>, <a class="local col0 ref" href="#10options" title='options' data-ref="10options" data-ref-filename="10options">options</a>,</td></tr>
<tr><th id="170">170</th><td>					    &amp;<a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#lease::scope" title='lease::scope' data-ref="lease::scope" data-ref-filename="lease..scope">scope</a>,</td></tr>
<tr><th id="171">171</th><td>					    <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#packet::classes" title='packet::classes' data-ref="packet::classes" data-ref-filename="packet..classes">classes</a>[<a class="local col2 ref" href="#12i" title='i' data-ref="12i" data-ref-filename="12i">i</a> - <var>1</var>]-&gt;<a class="ref field" href="../includes/dhcpd.h.html#class::group" title='class::group' data-ref="class::group" data-ref-filename="class..group">group</a>,</td></tr>
<tr><th id="172">172</th><td>					    <a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#lease::subnet" title='lease::subnet' data-ref="lease::subnet" data-ref-filename="lease..subnet">subnet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#subnet::group" title='subnet::group' data-ref="subnet::group" data-ref-filename="subnet..group">group</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="173">173</th><td>	}</td></tr>
<tr><th id="174">174</th><td></td></tr>
<tr><th id="175">175</th><td>	<i>/* Execute the host statements. */</i></td></tr>
<tr><th id="176">176</th><td>	<b>if</b> (<a class="local col3 ref" href="#3hp" title='hp' data-ref="3hp" data-ref-filename="3hp">hp</a> != <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) {</td></tr>
<tr><th id="177">177</th><td>		<a class="ref fn" href="../includes/dhcpd.h.html#execute_statements_in_scope" title='execute_statements_in_scope' data-ref="execute_statements_in_scope" data-ref-filename="execute_statements_in_scope">execute_statements_in_scope</a>(<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>, <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>, <a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,</td></tr>
<tr><th id="178">178</th><td>					    <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#packet::options" title='packet::options' data-ref="packet::options" data-ref-filename="packet..options">options</a>, <a class="local col0 ref" href="#10options" title='options' data-ref="10options" data-ref-filename="10options">options</a>,</td></tr>
<tr><th id="179">179</th><td>					    &amp;<a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#lease::scope" title='lease::scope' data-ref="lease::scope" data-ref-filename="lease..scope">scope</a>, <a class="local col3 ref" href="#3hp" title='hp' data-ref="3hp" data-ref-filename="3hp">hp</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#host_decl::group" title='host_decl::group' data-ref="host_decl::group" data-ref-filename="host_decl..group">group</a>,</td></tr>
<tr><th id="180">180</th><td>					    <a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#lease::subnet" title='lease::subnet' data-ref="lease::subnet" data-ref-filename="lease..subnet">subnet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#subnet::group" title='subnet::group' data-ref="subnet::group" data-ref-filename="subnet..group">group</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="181">181</th><td>	}</td></tr>
<tr><th id="182">182</th><td>	</td></tr>
<tr><th id="183">183</th><td>	<i>/* Drop the request if it's not allowed for this client. */</i></td></tr>
<tr><th id="184">184</th><td>	<b>if</b> ((<a class="local col4 ref" href="#14oc" title='oc' data-ref="14oc" data-ref-filename="14oc">oc</a> = <a class="ref fn" href="../includes/dhcpd.h.html#lookup_option" title='lookup_option' data-ref="lookup_option" data-ref-filename="lookup_option">lookup_option</a> (&amp;<a class="ref" href="../includes/dhcpd.h.html#server_universe" title='server_universe' data-ref="server_universe" data-ref-filename="server_universe">server_universe</a>, <a class="local col0 ref" href="#10options" title='options' data-ref="10options" data-ref-filename="10options">options</a>, <a class="macro" href="../includes/dhcpd.h.html#716" title="8" data-ref="_M/SV_ALLOW_BOOTP">SV_ALLOW_BOOTP</a>)) &amp;&amp;</td></tr>
<tr><th id="185">185</th><td>	    !<a class="ref fn" href="../includes/dhcpd.h.html#evaluate_boolean_option_cache" title='evaluate_boolean_option_cache' data-ref="evaluate_boolean_option_cache" data-ref-filename="evaluate_boolean_option_cache">evaluate_boolean_option_cache</a>(&amp;<a class="local col6 ref" href="#16ignorep" title='ignorep' data-ref="16ignorep" data-ref-filename="16ignorep">ignorep</a>, <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>, <a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>,</td></tr>
<tr><th id="186">186</th><td>					   <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,</td></tr>
<tr><th id="187">187</th><td>					   <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#packet::options" title='packet::options' data-ref="packet::options" data-ref-filename="packet..options">options</a>, <a class="local col0 ref" href="#10options" title='options' data-ref="10options" data-ref-filename="10options">options</a>,</td></tr>
<tr><th id="188">188</th><td>					   &amp;<a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#lease::scope" title='lease::scope' data-ref="lease::scope" data-ref-filename="lease..scope">scope</a>, <a class="local col4 ref" href="#14oc" title='oc' data-ref="14oc" data-ref-filename="14oc">oc</a>, <a class="macro" href="../includes/omapip/omapip.h.html#569" title="&quot;/___NETBSD_SRC___/objdir.amd64/external/mpl/dhcp/bin/server/../../../../../../external/mpl/dhcp/dist/server/bootp.c&quot;, 188" data-ref="_M/MDL">MDL</a>)) {</td></tr>
<tr><th id="189">189</th><td>		<b>if</b> (!<a class="local col6 ref" href="#16ignorep" title='ignorep' data-ref="16ignorep" data-ref-filename="16ignorep">ignorep</a>)</td></tr>
<tr><th id="190">190</th><td>			<a class="ref fn" href="../includes/omapip/omapip_p.h.html#log_info" title='log_info' data-ref="log_info" data-ref-filename="log_info">log_info</a> (<q>"%s: bootp disallowed"</q>, <a class="local col5 ref" href="#15msgbuf" title='msgbuf' data-ref="15msgbuf" data-ref-filename="15msgbuf">msgbuf</a>);</td></tr>
<tr><th id="191">191</th><td>		<b>goto</b> <a class="lbl" href="#19out" data-ref="19out" data-ref-filename="19out">out</a>;</td></tr>
<tr><th id="192">192</th><td>	} </td></tr>
<tr><th id="193">193</th><td></td></tr>
<tr><th id="194">194</th><td>	<b>if</b> ((<a class="local col4 ref" href="#14oc" title='oc' data-ref="14oc" data-ref-filename="14oc">oc</a> = <a class="ref fn" href="../includes/dhcpd.h.html#lookup_option" title='lookup_option' data-ref="lookup_option" data-ref-filename="lookup_option">lookup_option</a>(&amp;<a class="ref" href="../includes/dhcpd.h.html#server_universe" title='server_universe' data-ref="server_universe" data-ref-filename="server_universe">server_universe</a>,</td></tr>
<tr><th id="195">195</th><td>				 <a class="local col0 ref" href="#10options" title='options' data-ref="10options" data-ref-filename="10options">options</a>, <a class="macro" href="../includes/dhcpd.h.html#717" title="9" data-ref="_M/SV_ALLOW_BOOTING">SV_ALLOW_BOOTING</a>)) &amp;&amp;</td></tr>
<tr><th id="196">196</th><td>	    !<a class="ref fn" href="../includes/dhcpd.h.html#evaluate_boolean_option_cache" title='evaluate_boolean_option_cache' data-ref="evaluate_boolean_option_cache" data-ref-filename="evaluate_boolean_option_cache">evaluate_boolean_option_cache</a>(&amp;<a class="local col6 ref" href="#16ignorep" title='ignorep' data-ref="16ignorep" data-ref-filename="16ignorep">ignorep</a>, <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>, <a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>,</td></tr>
<tr><th id="197">197</th><td>					   <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,</td></tr>
<tr><th id="198">198</th><td>					   <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#packet::options" title='packet::options' data-ref="packet::options" data-ref-filename="packet..options">options</a>, <a class="local col0 ref" href="#10options" title='options' data-ref="10options" data-ref-filename="10options">options</a>,</td></tr>
<tr><th id="199">199</th><td>					   &amp;<a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#lease::scope" title='lease::scope' data-ref="lease::scope" data-ref-filename="lease..scope">scope</a>, <a class="local col4 ref" href="#14oc" title='oc' data-ref="14oc" data-ref-filename="14oc">oc</a>, <a class="macro" href="../includes/omapip/omapip.h.html#569" title="&quot;/___NETBSD_SRC___/objdir.amd64/external/mpl/dhcp/bin/server/../../../../../../external/mpl/dhcp/dist/server/bootp.c&quot;, 199" data-ref="_M/MDL">MDL</a>)) {</td></tr>
<tr><th id="200">200</th><td>		<b>if</b> (!<a class="local col6 ref" href="#16ignorep" title='ignorep' data-ref="16ignorep" data-ref-filename="16ignorep">ignorep</a>)</td></tr>
<tr><th id="201">201</th><td>			<a class="ref fn" href="../includes/omapip/omapip_p.h.html#log_info" title='log_info' data-ref="log_info" data-ref-filename="log_info">log_info</a> (<q>"%s: booting disallowed"</q>, <a class="local col5 ref" href="#15msgbuf" title='msgbuf' data-ref="15msgbuf" data-ref-filename="15msgbuf">msgbuf</a>);</td></tr>
<tr><th id="202">202</th><td>		<b>goto</b> <a class="lbl" href="#19out" data-ref="19out" data-ref-filename="19out">out</a>;</td></tr>
<tr><th id="203">203</th><td>	}</td></tr>
<tr><th id="204">204</th><td></td></tr>
<tr><th id="205">205</th><td>	<i>/* Set up the outgoing packet... */</i></td></tr>
<tr><th id="206">206</th><td>	<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#memset" title='memset' data-ref="memset" data-ref-filename="memset">memset</a> (&amp;<a class="local col5 ref" href="#5outgoing" title='outgoing' data-ref="5outgoing" data-ref-filename="5outgoing">outgoing</a>, <var>0</var>, <b>sizeof</b> <a class="local col5 ref" href="#5outgoing" title='outgoing' data-ref="5outgoing" data-ref-filename="5outgoing">outgoing</a>);</td></tr>
<tr><th id="207">207</th><td>	<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#memset" title='memset' data-ref="memset" data-ref-filename="memset">memset</a> (&amp;<a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>, <var>0</var>, <b>sizeof</b> <a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>);</td></tr>
<tr><th id="208">208</th><td>	<a class="local col5 ref" href="#5outgoing" title='outgoing' data-ref="5outgoing" data-ref-filename="5outgoing">outgoing</a>.<a class="ref field" href="../includes/dhcpd.h.html#packet::raw" title='packet::raw' data-ref="packet::raw" data-ref-filename="packet..raw">raw</a> = &amp;<a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>;</td></tr>
<tr><th id="209">209</th><td></td></tr>
<tr><th id="210">210</th><td>	<i>/* If we didn't get a known vendor magic number on the way in,</i></td></tr>
<tr><th id="211">211</th><td><i>	   just copy the input options to the output. */</i></td></tr>
<tr><th id="212">212</th><td>	<a class="local col2 ref" href="#12i" title='i' data-ref="12i" data-ref-filename="12i">i</a> = <a class="macro" href="../includes/dhcpd.h.html#728" title="20" data-ref="_M/SV_ALWAYS_REPLY_RFC1048">SV_ALWAYS_REPLY_RFC1048</a>;</td></tr>
<tr><th id="213">213</th><td>	<b>if</b> (!<a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#packet::options_valid" title='packet::options_valid' data-ref="packet::options_valid" data-ref-filename="packet..options_valid">options_valid</a> &amp;&amp;</td></tr>
<tr><th id="214">214</th><td>	    !(<a class="ref fn" href="../includes/dhcpd.h.html#evaluate_boolean_option_cache" title='evaluate_boolean_option_cache' data-ref="evaluate_boolean_option_cache" data-ref-filename="evaluate_boolean_option_cache">evaluate_boolean_option_cache</a>(&amp;<a class="local col6 ref" href="#16ignorep" title='ignorep' data-ref="16ignorep" data-ref-filename="16ignorep">ignorep</a>, <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>, <a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>,</td></tr>
<tr><th id="215">215</th><td>					    <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#packet::options" title='packet::options' data-ref="packet::options" data-ref-filename="packet..options">options</a>, <a class="local col0 ref" href="#10options" title='options' data-ref="10options" data-ref-filename="10options">options</a>,</td></tr>
<tr><th id="216">216</th><td>					    &amp;<a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#lease::scope" title='lease::scope' data-ref="lease::scope" data-ref-filename="lease..scope">scope</a>,</td></tr>
<tr><th id="217">217</th><td>					    <a class="ref fn" href="../includes/dhcpd.h.html#lookup_option" title='lookup_option' data-ref="lookup_option" data-ref-filename="lookup_option">lookup_option</a> (&amp;<a class="ref" href="../includes/dhcpd.h.html#server_universe" title='server_universe' data-ref="server_universe" data-ref-filename="server_universe">server_universe</a>,</td></tr>
<tr><th id="218">218</th><td>							   <a class="local col0 ref" href="#10options" title='options' data-ref="10options" data-ref-filename="10options">options</a>, <a class="local col2 ref" href="#12i" title='i' data-ref="12i" data-ref-filename="12i">i</a>), <a class="macro" href="../includes/omapip/omapip.h.html#569" title="&quot;/___NETBSD_SRC___/objdir.amd64/external/mpl/dhcp/bin/server/../../../../../../external/mpl/dhcp/dist/server/bootp.c&quot;, 218" data-ref="_M/MDL">MDL</a>))) {</td></tr>
<tr><th id="219">219</th><td>		<b>if</b> (<a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#packet::packet_length" title='packet::packet_length' data-ref="packet::packet_length" data-ref-filename="packet..packet_length">packet_length</a> &gt; <a class="macro" href="../includes/dhcp.h.html#38" title="236" data-ref="_M/DHCP_FIXED_NON_UDP">DHCP_FIXED_NON_UDP</a>) {</td></tr>
<tr><th id="220">220</th><td>			<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#memcpy" title='memcpy' data-ref="memcpy" data-ref-filename="memcpy">memcpy</a>(<a class="local col5 ref" href="#5outgoing" title='outgoing' data-ref="5outgoing" data-ref-filename="5outgoing">outgoing</a>.<a class="ref field" href="../includes/dhcpd.h.html#packet::raw" title='packet::raw' data-ref="packet::raw" data-ref-filename="packet..raw">raw</a>-&gt;<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::options" title='dhcp_packet::options' data-ref="dhcp_packet::options" data-ref-filename="dhcp_packet..options">options</a>, <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#packet::raw" title='packet::raw' data-ref="packet::raw" data-ref-filename="packet..raw">raw</a>-&gt;<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::options" title='dhcp_packet::options' data-ref="dhcp_packet::options" data-ref-filename="dhcp_packet..options">options</a>,</td></tr>
<tr><th id="221">221</th><td>			<a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#packet::packet_length" title='packet::packet_length' data-ref="packet::packet_length" data-ref-filename="packet..packet_length">packet_length</a> - <a class="macro" href="../includes/dhcp.h.html#38" title="236" data-ref="_M/DHCP_FIXED_NON_UDP">DHCP_FIXED_NON_UDP</a>);</td></tr>
<tr><th id="222">222</th><td>		}</td></tr>
<tr><th id="223">223</th><td></td></tr>
<tr><th id="224">224</th><td>		<a class="local col5 ref" href="#5outgoing" title='outgoing' data-ref="5outgoing" data-ref-filename="5outgoing">outgoing</a>.<a class="ref field" href="../includes/dhcpd.h.html#packet::packet_length" title='packet::packet_length' data-ref="packet::packet_length" data-ref-filename="packet..packet_length">packet_length</a> =</td></tr>
<tr><th id="225">225</th><td>			(<a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#packet::packet_length" title='packet::packet_length' data-ref="packet::packet_length" data-ref-filename="packet..packet_length">packet_length</a> &lt; <a class="macro" href="../includes/dhcp.h.html#41" title="300" data-ref="_M/BOOTP_MIN_LEN">BOOTP_MIN_LEN</a>)</td></tr>
<tr><th id="226">226</th><td>					       ? <a class="macro" href="../includes/dhcp.h.html#41" title="300" data-ref="_M/BOOTP_MIN_LEN">BOOTP_MIN_LEN</a></td></tr>
<tr><th id="227">227</th><td>					       : <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#packet::packet_length" title='packet::packet_length' data-ref="packet::packet_length" data-ref-filename="packet..packet_length">packet_length</a>;</td></tr>
<tr><th id="228">228</th><td>	} <b>else</b> {</td></tr>
<tr><th id="229">229</th><td></td></tr>
<tr><th id="230">230</th><td>		<i>/* Use the subnet mask from the subnet declaration if no other</i></td></tr>
<tr><th id="231">231</th><td><i>		   mask has been provided. */</i></td></tr>
<tr><th id="232">232</th><td>		<a class="local col4 ref" href="#14oc" title='oc' data-ref="14oc" data-ref-filename="14oc">oc</a> = (<b>struct</b> <a class="type" href="../includes/dhcpd.h.html#option_cache" title='option_cache' data-ref="option_cache" data-ref-filename="option_cache">option_cache</a> *)<var>0</var>;</td></tr>
<tr><th id="233">233</th><td>		<a class="local col2 ref" href="#12i" title='i' data-ref="12i" data-ref-filename="12i">i</a> = <a class="macro" href="../includes/dhcp.h.html#92" title="1" data-ref="_M/DHO_SUBNET_MASK">DHO_SUBNET_MASK</a>;</td></tr>
<tr><th id="234">234</th><td>		<b>if</b> (!<a class="ref fn" href="../includes/dhcpd.h.html#lookup_option" title='lookup_option' data-ref="lookup_option" data-ref-filename="lookup_option">lookup_option</a> (&amp;<a class="ref" href="../includes/dhcpd.h.html#dhcp_universe" title='dhcp_universe' data-ref="dhcp_universe" data-ref-filename="dhcp_universe">dhcp_universe</a>, <a class="local col0 ref" href="#10options" title='options' data-ref="10options" data-ref-filename="10options">options</a>, <a class="local col2 ref" href="#12i" title='i' data-ref="12i" data-ref-filename="12i">i</a>)) {</td></tr>
<tr><th id="235">235</th><td>			<b>if</b> (<a class="ref fn" href="../includes/dhcpd.h.html#option_cache_allocate" title='option_cache_allocate' data-ref="option_cache_allocate" data-ref-filename="option_cache_allocate">option_cache_allocate</a> (&amp;<a class="local col4 ref" href="#14oc" title='oc' data-ref="14oc" data-ref-filename="14oc">oc</a>, <a class="macro" href="../includes/omapip/omapip.h.html#569" title="&quot;/___NETBSD_SRC___/objdir.amd64/external/mpl/dhcp/bin/server/../../../../../../external/mpl/dhcp/dist/server/bootp.c&quot;, 235" data-ref="_M/MDL">MDL</a>)) {</td></tr>
<tr><th id="236">236</th><td>				<b>if</b> (<a class="ref fn" href="../includes/dhcpd.h.html#make_const_data" title='make_const_data' data-ref="make_const_data" data-ref-filename="make_const_data">make_const_data</a></td></tr>
<tr><th id="237">237</th><td>				    (&amp;<a class="local col4 ref" href="#14oc" title='oc' data-ref="14oc" data-ref-filename="14oc">oc</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#option_cache::expression" title='option_cache::expression' data-ref="option_cache::expression" data-ref-filename="option_cache..expression">expression</a>,</td></tr>
<tr><th id="238">238</th><td>				     <a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#lease::subnet" title='lease::subnet' data-ref="lease::subnet" data-ref-filename="lease..subnet">subnet</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#subnet::netmask" title='subnet::netmask' data-ref="subnet::netmask" data-ref-filename="subnet..netmask">netmask</a>.<a class="ref field" href="../includes/inet.h.html#iaddr::iabuf" title='iaddr::iabuf' data-ref="iaddr::iabuf" data-ref-filename="iaddr..iabuf">iabuf</a>,</td></tr>
<tr><th id="239">239</th><td>				     <a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#lease::subnet" title='lease::subnet' data-ref="lease::subnet" data-ref-filename="lease..subnet">subnet</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#subnet::netmask" title='subnet::netmask' data-ref="subnet::netmask" data-ref-filename="subnet..netmask">netmask</a>.<a class="ref field" href="../includes/inet.h.html#iaddr::len" title='iaddr::len' data-ref="iaddr::len" data-ref-filename="iaddr..len">len</a>,</td></tr>
<tr><th id="240">240</th><td>				     <var>0</var>, <var>0</var>, <a class="macro" href="../includes/omapip/omapip.h.html#569" title="&quot;/___NETBSD_SRC___/objdir.amd64/external/mpl/dhcp/bin/server/../../../../../../external/mpl/dhcp/dist/server/bootp.c&quot;, 240" data-ref="_M/MDL">MDL</a>)) {</td></tr>
<tr><th id="241">241</th><td>					<a class="ref fn" href="../includes/dhcpd.h.html#1841" title='option_code_hash_lookup' data-ref="option_code_hash_lookup" data-ref-filename="option_code_hash_lookup">option_code_hash_lookup</a>(&amp;<a class="local col4 ref" href="#14oc" title='oc' data-ref="14oc" data-ref-filename="14oc">oc</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#option_cache::option" title='option_cache::option' data-ref="option_cache::option" data-ref-filename="option_cache..option">option</a>,</td></tr>
<tr><th id="242">242</th><td>							<a class="ref" href="../includes/dhcpd.h.html#dhcp_universe" title='dhcp_universe' data-ref="dhcp_universe" data-ref-filename="dhcp_universe">dhcp_universe</a>.<a class="ref field" href="../includes/tree.h.html#universe::code_hash" title='universe::code_hash' data-ref="universe::code_hash" data-ref-filename="universe..code_hash">code_hash</a>,</td></tr>
<tr><th id="243">243</th><td>								&amp;<a class="local col2 ref" href="#12i" title='i' data-ref="12i" data-ref-filename="12i">i</a>, <var>0</var>, <a class="macro" href="../includes/omapip/omapip.h.html#569" title="&quot;/___NETBSD_SRC___/objdir.amd64/external/mpl/dhcp/bin/server/../../../../../../external/mpl/dhcp/dist/server/bootp.c&quot;, 243" data-ref="_M/MDL">MDL</a>);</td></tr>
<tr><th id="244">244</th><td>					<a class="ref fn" href="../includes/dhcpd.h.html#save_option" title='save_option' data-ref="save_option" data-ref-filename="save_option">save_option</a> (&amp;<a class="ref" href="../includes/dhcpd.h.html#dhcp_universe" title='dhcp_universe' data-ref="dhcp_universe" data-ref-filename="dhcp_universe">dhcp_universe</a>,</td></tr>
<tr><th id="245">245</th><td>						     <a class="local col0 ref" href="#10options" title='options' data-ref="10options" data-ref-filename="10options">options</a>, <a class="local col4 ref" href="#14oc" title='oc' data-ref="14oc" data-ref-filename="14oc">oc</a>);</td></tr>
<tr><th id="246">246</th><td>				}</td></tr>
<tr><th id="247">247</th><td>				<a class="ref fn" href="../includes/dhcpd.h.html#option_cache_dereference" title='option_cache_dereference' data-ref="option_cache_dereference" data-ref-filename="option_cache_dereference">option_cache_dereference</a> (&amp;<a class="local col4 ref" href="#14oc" title='oc' data-ref="14oc" data-ref-filename="14oc">oc</a>, <a class="macro" href="../includes/omapip/omapip.h.html#569" title="&quot;/___NETBSD_SRC___/objdir.amd64/external/mpl/dhcp/bin/server/../../../../../../external/mpl/dhcp/dist/server/bootp.c&quot;, 247" data-ref="_M/MDL">MDL</a>);</td></tr>
<tr><th id="248">248</th><td>			}</td></tr>
<tr><th id="249">249</th><td>		}</td></tr>
<tr><th id="250">250</th><td></td></tr>
<tr><th id="251">251</th><td>		<i>/* If use-host-decl-names is enabled and there is a hostname</i></td></tr>
<tr><th id="252">252</th><td><i>		 * defined in the host delcartion, send it back in hostname</i></td></tr>
<tr><th id="253">253</th><td><i>		 * option */</i></td></tr>
<tr><th id="254">254</th><td>		<a class="ref fn" href="../includes/dhcpd.h.html#use_host_decl_name" title='use_host_decl_name' data-ref="use_host_decl_name" data-ref-filename="use_host_decl_name">use_host_decl_name</a>(<a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>, <a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>, <a class="local col0 ref" href="#10options" title='options' data-ref="10options" data-ref-filename="10options">options</a>);</td></tr>
<tr><th id="255">255</th><td></td></tr>
<tr><th id="256">256</th><td>		<i>/* Pack the options into the buffer.  Unlike DHCP, we</i></td></tr>
<tr><th id="257">257</th><td><i>		   can't pack options into the filename and server</i></td></tr>
<tr><th id="258">258</th><td><i>		   name buffers. */</i></td></tr>
<tr><th id="259">259</th><td></td></tr>
<tr><th id="260">260</th><td>		<a class="local col5 ref" href="#5outgoing" title='outgoing' data-ref="5outgoing" data-ref-filename="5outgoing">outgoing</a>.<a class="ref field" href="../includes/dhcpd.h.html#packet::packet_length" title='packet::packet_length' data-ref="packet::packet_length" data-ref-filename="packet..packet_length">packet_length</a> =</td></tr>
<tr><th id="261">261</th><td>			<a class="ref fn" href="../includes/dhcpd.h.html#cons_options" title='cons_options' data-ref="cons_options" data-ref-filename="cons_options">cons_options</a> (<a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>, <a class="local col5 ref" href="#5outgoing" title='outgoing' data-ref="5outgoing" data-ref-filename="5outgoing">outgoing</a>.<a class="ref field" href="../includes/dhcpd.h.html#packet::raw" title='packet::raw' data-ref="packet::raw" data-ref-filename="packet..raw">raw</a>, <a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>,</td></tr>
<tr><th id="262">262</th><td>				      (<b>struct</b> <a class="type" href="../includes/dhcpd.h.html#client_state" title='client_state' data-ref="client_state" data-ref-filename="client_state">client_state</a> *)<var>0</var>, <var>0</var>,</td></tr>
<tr><th id="263">263</th><td>				      <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#packet::options" title='packet::options' data-ref="packet::options" data-ref-filename="packet..options">options</a>, <a class="local col0 ref" href="#10options" title='options' data-ref="10options" data-ref-filename="10options">options</a>,</td></tr>
<tr><th id="264">264</th><td>				      &amp;<a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#lease::scope" title='lease::scope' data-ref="lease::scope" data-ref-filename="lease..scope">scope</a>,</td></tr>
<tr><th id="265">265</th><td>				      <var>0</var>, <var>0</var>, <var>1</var>, (<b>struct</b> <a class="type" href="../includes/tree.h.html#data_string" title='data_string' data-ref="data_string" data-ref-filename="data_string">data_string</a> *)<var>0</var>,</td></tr>
<tr><th id="266">266</th><td>				      (<em>const</em> <em>char</em> *)<var>0</var>);</td></tr>
<tr><th id="267">267</th><td>		<b>if</b> (<a class="local col5 ref" href="#5outgoing" title='outgoing' data-ref="5outgoing" data-ref-filename="5outgoing">outgoing</a>.<a class="ref field" href="../includes/dhcpd.h.html#packet::packet_length" title='packet::packet_length' data-ref="packet::packet_length" data-ref-filename="packet..packet_length">packet_length</a> &lt; <a class="macro" href="../includes/dhcp.h.html#41" title="300" data-ref="_M/BOOTP_MIN_LEN">BOOTP_MIN_LEN</a>)</td></tr>
<tr><th id="268">268</th><td>			<a class="local col5 ref" href="#5outgoing" title='outgoing' data-ref="5outgoing" data-ref-filename="5outgoing">outgoing</a>.<a class="ref field" href="../includes/dhcpd.h.html#packet::packet_length" title='packet::packet_length' data-ref="packet::packet_length" data-ref-filename="packet..packet_length">packet_length</a> = <a class="macro" href="../includes/dhcp.h.html#41" title="300" data-ref="_M/BOOTP_MIN_LEN">BOOTP_MIN_LEN</a>;</td></tr>
<tr><th id="269">269</th><td>	}</td></tr>
<tr><th id="270">270</th><td></td></tr>
<tr><th id="271">271</th><td>	<i>/* Take the fields that we care about... */</i></td></tr>
<tr><th id="272">272</th><td>	<a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::op" title='dhcp_packet::op' data-ref="dhcp_packet::op" data-ref-filename="dhcp_packet..op">op</a> = <a class="macro" href="../includes/dhcp.h.html#71" title="2" data-ref="_M/BOOTREPLY">BOOTREPLY</a>;</td></tr>
<tr><th id="273">273</th><td>	<a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::htype" title='dhcp_packet::htype' data-ref="dhcp_packet::htype" data-ref-filename="dhcp_packet..htype">htype</a> = <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#packet::raw" title='packet::raw' data-ref="packet::raw" data-ref-filename="packet..raw">raw</a> -&gt; <a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::htype" title='dhcp_packet::htype' data-ref="dhcp_packet::htype" data-ref-filename="dhcp_packet..htype">htype</a>;</td></tr>
<tr><th id="274">274</th><td>	<a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::hlen" title='dhcp_packet::hlen' data-ref="dhcp_packet::hlen" data-ref-filename="dhcp_packet..hlen">hlen</a> = <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#packet::raw" title='packet::raw' data-ref="packet::raw" data-ref-filename="packet..raw">raw</a> -&gt; <a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::hlen" title='dhcp_packet::hlen' data-ref="dhcp_packet::hlen" data-ref-filename="dhcp_packet..hlen">hlen</a>;</td></tr>
<tr><th id="275">275</th><td>	<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#memcpy" title='memcpy' data-ref="memcpy" data-ref-filename="memcpy">memcpy</a> (<a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::chaddr" title='dhcp_packet::chaddr' data-ref="dhcp_packet::chaddr" data-ref-filename="dhcp_packet..chaddr">chaddr</a>, <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#packet::raw" title='packet::raw' data-ref="packet::raw" data-ref-filename="packet..raw">raw</a> -&gt; <a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::chaddr" title='dhcp_packet::chaddr' data-ref="dhcp_packet::chaddr" data-ref-filename="dhcp_packet..chaddr">chaddr</a>, <b>sizeof</b> <a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::chaddr" title='dhcp_packet::chaddr' data-ref="dhcp_packet::chaddr" data-ref-filename="dhcp_packet..chaddr">chaddr</a>);</td></tr>
<tr><th id="276">276</th><td>	<a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::hops" title='dhcp_packet::hops' data-ref="dhcp_packet::hops" data-ref-filename="dhcp_packet..hops">hops</a> = <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#packet::raw" title='packet::raw' data-ref="packet::raw" data-ref-filename="packet..raw">raw</a> -&gt; <a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::hops" title='dhcp_packet::hops' data-ref="dhcp_packet::hops" data-ref-filename="dhcp_packet..hops">hops</a>;</td></tr>
<tr><th id="277">277</th><td>	<a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::xid" title='dhcp_packet::xid' data-ref="dhcp_packet::xid" data-ref-filename="dhcp_packet..xid">xid</a> = <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#packet::raw" title='packet::raw' data-ref="packet::raw" data-ref-filename="packet..raw">raw</a> -&gt; <a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::xid" title='dhcp_packet::xid' data-ref="dhcp_packet::xid" data-ref-filename="dhcp_packet..xid">xid</a>;</td></tr>
<tr><th id="278">278</th><td>	<a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::secs" title='dhcp_packet::secs' data-ref="dhcp_packet::secs" data-ref-filename="dhcp_packet..secs">secs</a> = <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#packet::raw" title='packet::raw' data-ref="packet::raw" data-ref-filename="packet..raw">raw</a> -&gt; <a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::secs" title='dhcp_packet::secs' data-ref="dhcp_packet::secs" data-ref-filename="dhcp_packet..secs">secs</a>;</td></tr>
<tr><th id="279">279</th><td>	<a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::flags" title='dhcp_packet::flags' data-ref="dhcp_packet::flags" data-ref-filename="dhcp_packet..flags">flags</a> = <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#packet::raw" title='packet::raw' data-ref="packet::raw" data-ref-filename="packet..raw">raw</a> -&gt; <a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::flags" title='dhcp_packet::flags' data-ref="dhcp_packet::flags" data-ref-filename="dhcp_packet..flags">flags</a>;</td></tr>
<tr><th id="280">280</th><td>	<a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::ciaddr" title='dhcp_packet::ciaddr' data-ref="dhcp_packet::ciaddr" data-ref-filename="dhcp_packet..ciaddr">ciaddr</a> = <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#packet::raw" title='packet::raw' data-ref="packet::raw" data-ref-filename="packet..raw">raw</a> -&gt; <a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::ciaddr" title='dhcp_packet::ciaddr' data-ref="dhcp_packet::ciaddr" data-ref-filename="dhcp_packet..ciaddr">ciaddr</a>;</td></tr>
<tr><th id="281">281</th><td></td></tr>
<tr><th id="282">282</th><td>	<i>/* yiaddr is an ipv4 address, it must be 4 octets. */</i></td></tr>
<tr><th id="283">283</th><td>	<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#memcpy" title='memcpy' data-ref="memcpy" data-ref-filename="memcpy">memcpy</a> (&amp;<a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::yiaddr" title='dhcp_packet::yiaddr' data-ref="dhcp_packet::yiaddr" data-ref-filename="dhcp_packet..yiaddr">yiaddr</a>, <a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#lease::ip_addr" title='lease::ip_addr' data-ref="lease::ip_addr" data-ref-filename="lease..ip_addr">ip_addr</a>.<a class="ref field" href="../includes/inet.h.html#iaddr::iabuf" title='iaddr::iabuf' data-ref="iaddr::iabuf" data-ref-filename="iaddr..iabuf">iabuf</a>, <var>4</var>);</td></tr>
<tr><th id="284">284</th><td></td></tr>
<tr><th id="285">285</th><td>	<i>/* If we're always supposed to broadcast to this client, set</i></td></tr>
<tr><th id="286">286</th><td><i>	   the broadcast bit in the bootp flags field. */</i></td></tr>
<tr><th id="287">287</th><td>	<b>if</b> ((<a class="local col4 ref" href="#14oc" title='oc' data-ref="14oc" data-ref-filename="14oc">oc</a> = <a class="ref fn" href="../includes/dhcpd.h.html#lookup_option" title='lookup_option' data-ref="lookup_option" data-ref-filename="lookup_option">lookup_option</a> (&amp;<a class="ref" href="../includes/dhcpd.h.html#server_universe" title='server_universe' data-ref="server_universe" data-ref-filename="server_universe">server_universe</a>,</td></tr>
<tr><th id="288">288</th><td>				<a class="local col0 ref" href="#10options" title='options' data-ref="10options" data-ref-filename="10options">options</a>, <a class="macro" href="../includes/dhcpd.h.html#730" title="22" data-ref="_M/SV_ALWAYS_BROADCAST">SV_ALWAYS_BROADCAST</a>)) &amp;&amp;</td></tr>
<tr><th id="289">289</th><td>	    <a class="ref fn" href="../includes/dhcpd.h.html#evaluate_boolean_option_cache" title='evaluate_boolean_option_cache' data-ref="evaluate_boolean_option_cache" data-ref-filename="evaluate_boolean_option_cache">evaluate_boolean_option_cache</a> (&amp;<a class="local col6 ref" href="#16ignorep" title='ignorep' data-ref="16ignorep" data-ref-filename="16ignorep">ignorep</a>, <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>, <a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>,</td></tr>
<tr><th id="290">290</th><td>					   (<b>struct</b> <a class="type" href="../includes/dhcpd.h.html#client_state" title='client_state' data-ref="client_state" data-ref-filename="client_state">client_state</a> *)<var>0</var>,</td></tr>
<tr><th id="291">291</th><td>					   <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#packet::options" title='packet::options' data-ref="packet::options" data-ref-filename="packet..options">options</a>, <a class="local col0 ref" href="#10options" title='options' data-ref="10options" data-ref-filename="10options">options</a>,</td></tr>
<tr><th id="292">292</th><td>					   &amp;<a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#lease::scope" title='lease::scope' data-ref="lease::scope" data-ref-filename="lease..scope">scope</a>, <a class="local col4 ref" href="#14oc" title='oc' data-ref="14oc" data-ref-filename="14oc">oc</a>, <a class="macro" href="../includes/omapip/omapip.h.html#569" title="&quot;/___NETBSD_SRC___/objdir.amd64/external/mpl/dhcp/bin/server/../../../../../../external/mpl/dhcp/dist/server/bootp.c&quot;, 292" data-ref="_M/MDL">MDL</a>))</td></tr>
<tr><th id="293">293</th><td>		<a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::flags" title='dhcp_packet::flags' data-ref="dhcp_packet::flags" data-ref-filename="dhcp_packet..flags">flags</a> |= <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/endian.h.html#128" title="((uint16_t)(__builtin_constant_p((((uint16_t)((32768L))))) ? (((uint16_t)(((((((uint16_t)((32768L)))) &amp; 0xff00) &gt;&gt; 8) | (((((uint16_t)((32768L)))) &amp; 0x00ff) &lt;&lt; 8))))) : __byte_swap_u16_variable(((uint16_t)((32768L))))))" data-ref="_M/htons">htons</a> (<a class="macro" href="../includes/dhcp.h.html#74" title="32768L" data-ref="_M/BOOTP_BROADCAST">BOOTP_BROADCAST</a>);</td></tr>
<tr><th id="294">294</th><td></td></tr>
<tr><th id="295">295</th><td>	<i>/* Figure out the address of the next server. */</i></td></tr>
<tr><th id="296">296</th><td>	<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#memset" title='memset' data-ref="memset" data-ref-filename="memset">memset</a> (&amp;<a class="local col3 ref" href="#13d1" title='d1' data-ref="13d1" data-ref-filename="13d1">d1</a>, <var>0</var>, <b>sizeof</b> <a class="local col3 ref" href="#13d1" title='d1' data-ref="13d1" data-ref-filename="13d1">d1</a>);</td></tr>
<tr><th id="297">297</th><td>	<a class="local col4 ref" href="#14oc" title='oc' data-ref="14oc" data-ref-filename="14oc">oc</a> = <a class="ref fn" href="../includes/dhcpd.h.html#lookup_option" title='lookup_option' data-ref="lookup_option" data-ref-filename="lookup_option">lookup_option</a> (&amp;<a class="ref" href="../includes/dhcpd.h.html#server_universe" title='server_universe' data-ref="server_universe" data-ref-filename="server_universe">server_universe</a>, <a class="local col0 ref" href="#10options" title='options' data-ref="10options" data-ref-filename="10options">options</a>, <a class="macro" href="../includes/dhcpd.h.html#725" title="17" data-ref="_M/SV_NEXT_SERVER">SV_NEXT_SERVER</a>);</td></tr>
<tr><th id="298">298</th><td>	<b>if</b> (<a class="local col4 ref" href="#14oc" title='oc' data-ref="14oc" data-ref-filename="14oc">oc</a> &amp;&amp;</td></tr>
<tr><th id="299">299</th><td>	    <a class="ref fn" href="../includes/dhcpd.h.html#evaluate_option_cache" title='evaluate_option_cache' data-ref="evaluate_option_cache" data-ref-filename="evaluate_option_cache">evaluate_option_cache</a> (&amp;<a class="local col3 ref" href="#13d1" title='d1' data-ref="13d1" data-ref-filename="13d1">d1</a>, <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>, <a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>,</td></tr>
<tr><th id="300">300</th><td>				   (<b>struct</b> <a class="type" href="../includes/dhcpd.h.html#client_state" title='client_state' data-ref="client_state" data-ref-filename="client_state">client_state</a> *)<var>0</var>,</td></tr>
<tr><th id="301">301</th><td>				   <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#packet::options" title='packet::options' data-ref="packet::options" data-ref-filename="packet..options">options</a>, <a class="local col0 ref" href="#10options" title='options' data-ref="10options" data-ref-filename="10options">options</a>,</td></tr>
<tr><th id="302">302</th><td>				   &amp;<a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#lease::scope" title='lease::scope' data-ref="lease::scope" data-ref-filename="lease..scope">scope</a>, <a class="local col4 ref" href="#14oc" title='oc' data-ref="14oc" data-ref-filename="14oc">oc</a>, <a class="macro" href="../includes/omapip/omapip.h.html#569" title="&quot;/___NETBSD_SRC___/objdir.amd64/external/mpl/dhcp/bin/server/../../../../../../external/mpl/dhcp/dist/server/bootp.c&quot;, 302" data-ref="_M/MDL">MDL</a>)) {</td></tr>
<tr><th id="303">303</th><td>		<i>/* If there was more than one answer, take the first. */</i></td></tr>
<tr><th id="304">304</th><td>		<b>if</b> (<a class="local col3 ref" href="#13d1" title='d1' data-ref="13d1" data-ref-filename="13d1">d1</a>.<a class="ref field" href="../includes/tree.h.html#data_string::len" title='data_string::len' data-ref="data_string::len" data-ref-filename="data_string..len">len</a> &gt;= <var>4</var> &amp;&amp; <a class="local col3 ref" href="#13d1" title='d1' data-ref="13d1" data-ref-filename="13d1">d1</a>.<a class="ref field" href="../includes/tree.h.html#data_string::data" title='data_string::data' data-ref="data_string::data" data-ref-filename="data_string..data">data</a>)</td></tr>
<tr><th id="305">305</th><td>			<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#memcpy" title='memcpy' data-ref="memcpy" data-ref-filename="memcpy">memcpy</a> (&amp;<a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::siaddr" title='dhcp_packet::siaddr' data-ref="dhcp_packet::siaddr" data-ref-filename="dhcp_packet..siaddr">siaddr</a>, <a class="local col3 ref" href="#13d1" title='d1' data-ref="13d1" data-ref-filename="13d1">d1</a>.<a class="ref field" href="../includes/tree.h.html#data_string::data" title='data_string::data' data-ref="data_string::data" data-ref-filename="data_string..data">data</a>, <var>4</var>);</td></tr>
<tr><th id="306">306</th><td>		<a class="ref fn" href="../includes/dhcpd.h.html#data_string_forget" title='data_string_forget' data-ref="data_string_forget" data-ref-filename="data_string_forget">data_string_forget</a> (&amp;<a class="local col3 ref" href="#13d1" title='d1' data-ref="13d1" data-ref-filename="13d1">d1</a>, <a class="macro" href="../includes/omapip/omapip.h.html#569" title="&quot;/___NETBSD_SRC___/objdir.amd64/external/mpl/dhcp/bin/server/../../../../../../external/mpl/dhcp/dist/server/bootp.c&quot;, 306" data-ref="_M/MDL">MDL</a>);</td></tr>
<tr><th id="307">307</th><td>	} <b>else</b> {</td></tr>
<tr><th id="308">308</th><td>		<b>if</b> ((<a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#lease::subnet" title='lease::subnet' data-ref="lease::subnet" data-ref-filename="lease..subnet">subnet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#subnet::shared_network" title='subnet::shared_network' data-ref="subnet::shared_network" data-ref-filename="subnet..shared_network">shared_network</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#shared_network::interface" title='shared_network::interface' data-ref="shared_network::interface" data-ref-filename="shared_network..interface">interface</a> != <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) &amp;&amp;</td></tr>
<tr><th id="309">309</th><td>		    <a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#lease::subnet" title='lease::subnet' data-ref="lease::subnet" data-ref-filename="lease..subnet">subnet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#subnet::shared_network" title='subnet::shared_network' data-ref="subnet::shared_network" data-ref-filename="subnet..shared_network">shared_network</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#shared_network::interface" title='shared_network::interface' data-ref="shared_network::interface" data-ref-filename="shared_network..interface">interface</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#interface_info::address_count" title='interface_info::address_count' data-ref="interface_info::address_count" data-ref-filename="interface_info..address_count">address_count</a>)</td></tr>
<tr><th id="310">310</th><td>		    <a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::siaddr" title='dhcp_packet::siaddr' data-ref="dhcp_packet::siaddr" data-ref-filename="dhcp_packet..siaddr">siaddr</a> =</td></tr>
<tr><th id="311">311</th><td>			<a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#lease::subnet" title='lease::subnet' data-ref="lease::subnet" data-ref-filename="lease..subnet">subnet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#subnet::shared_network" title='subnet::shared_network' data-ref="subnet::shared_network" data-ref-filename="subnet..shared_network">shared_network</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#shared_network::interface" title='shared_network::interface' data-ref="shared_network::interface" data-ref-filename="shared_network..interface">interface</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#interface_info::addresses" title='interface_info::addresses' data-ref="interface_info::addresses" data-ref-filename="interface_info..addresses">addresses</a>[<var>0</var>];</td></tr>
<tr><th id="312">312</th><td>		<b>else</b> <b>if</b> (<a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#packet::interface" title='packet::interface' data-ref="packet::interface" data-ref-filename="packet..interface">interface</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#interface_info::address_count" title='interface_info::address_count' data-ref="interface_info::address_count" data-ref-filename="interface_info..address_count">address_count</a>)</td></tr>
<tr><th id="313">313</th><td>			<a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::siaddr" title='dhcp_packet::siaddr' data-ref="dhcp_packet::siaddr" data-ref-filename="dhcp_packet..siaddr">siaddr</a> = <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#packet::interface" title='packet::interface' data-ref="packet::interface" data-ref-filename="packet..interface">interface</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#interface_info::addresses" title='interface_info::addresses' data-ref="interface_info::addresses" data-ref-filename="interface_info..addresses">addresses</a>[<var>0</var>];</td></tr>
<tr><th id="314">314</th><td>	}</td></tr>
<tr><th id="315">315</th><td></td></tr>
<tr><th id="316">316</th><td>	<a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::giaddr" title='dhcp_packet::giaddr' data-ref="dhcp_packet::giaddr" data-ref-filename="dhcp_packet..giaddr">giaddr</a> = <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#packet::raw" title='packet::raw' data-ref="packet::raw" data-ref-filename="packet..raw">raw</a> -&gt; <a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::giaddr" title='dhcp_packet::giaddr' data-ref="dhcp_packet::giaddr" data-ref-filename="dhcp_packet..giaddr">giaddr</a>;</td></tr>
<tr><th id="317">317</th><td></td></tr>
<tr><th id="318">318</th><td>	<i>/* Figure out the filename. */</i></td></tr>
<tr><th id="319">319</th><td>	<a class="local col4 ref" href="#14oc" title='oc' data-ref="14oc" data-ref-filename="14oc">oc</a> = <a class="ref fn" href="../includes/dhcpd.h.html#lookup_option" title='lookup_option' data-ref="lookup_option" data-ref-filename="lookup_option">lookup_option</a> (&amp;<a class="ref" href="../includes/dhcpd.h.html#server_universe" title='server_universe' data-ref="server_universe" data-ref-filename="server_universe">server_universe</a>, <a class="local col0 ref" href="#10options" title='options' data-ref="10options" data-ref-filename="10options">options</a>, <a class="macro" href="../includes/dhcpd.h.html#723" title="15" data-ref="_M/SV_FILENAME">SV_FILENAME</a>);</td></tr>
<tr><th id="320">320</th><td>	<b>if</b> (<a class="local col4 ref" href="#14oc" title='oc' data-ref="14oc" data-ref-filename="14oc">oc</a> &amp;&amp;</td></tr>
<tr><th id="321">321</th><td>	    <a class="ref fn" href="../includes/dhcpd.h.html#evaluate_option_cache" title='evaluate_option_cache' data-ref="evaluate_option_cache" data-ref-filename="evaluate_option_cache">evaluate_option_cache</a> (&amp;<a class="local col3 ref" href="#13d1" title='d1' data-ref="13d1" data-ref-filename="13d1">d1</a>, <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>, <a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>,</td></tr>
<tr><th id="322">322</th><td>				   (<b>struct</b> <a class="type" href="../includes/dhcpd.h.html#client_state" title='client_state' data-ref="client_state" data-ref-filename="client_state">client_state</a> *)<var>0</var>,</td></tr>
<tr><th id="323">323</th><td>				   <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#packet::options" title='packet::options' data-ref="packet::options" data-ref-filename="packet..options">options</a>, <a class="local col0 ref" href="#10options" title='options' data-ref="10options" data-ref-filename="10options">options</a>,</td></tr>
<tr><th id="324">324</th><td>				   &amp;<a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#lease::scope" title='lease::scope' data-ref="lease::scope" data-ref-filename="lease..scope">scope</a>, <a class="local col4 ref" href="#14oc" title='oc' data-ref="14oc" data-ref-filename="14oc">oc</a>, <a class="macro" href="../includes/omapip/omapip.h.html#569" title="&quot;/___NETBSD_SRC___/objdir.amd64/external/mpl/dhcp/bin/server/../../../../../../external/mpl/dhcp/dist/server/bootp.c&quot;, 324" data-ref="_M/MDL">MDL</a>)) {</td></tr>
<tr><th id="325">325</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#memcpy" title='memcpy' data-ref="memcpy" data-ref-filename="memcpy">memcpy</a> (<a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::file" title='dhcp_packet::file' data-ref="dhcp_packet::file" data-ref-filename="dhcp_packet..file">file</a>, <a class="local col3 ref" href="#13d1" title='d1' data-ref="13d1" data-ref-filename="13d1">d1</a>.<a class="ref field" href="../includes/tree.h.html#data_string::data" title='data_string::data' data-ref="data_string::data" data-ref-filename="data_string..data">data</a>,</td></tr>
<tr><th id="326">326</th><td>			<a class="local col3 ref" href="#13d1" title='d1' data-ref="13d1" data-ref-filename="13d1">d1</a>.<a class="ref field" href="../includes/tree.h.html#data_string::len" title='data_string::len' data-ref="data_string::len" data-ref-filename="data_string..len">len</a> &gt; <b>sizeof</b> <a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::file" title='dhcp_packet::file' data-ref="dhcp_packet::file" data-ref-filename="dhcp_packet..file">file</a> ? <b>sizeof</b> <a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::file" title='dhcp_packet::file' data-ref="dhcp_packet::file" data-ref-filename="dhcp_packet..file">file</a> : <a class="local col3 ref" href="#13d1" title='d1' data-ref="13d1" data-ref-filename="13d1">d1</a>.<a class="ref field" href="../includes/tree.h.html#data_string::len" title='data_string::len' data-ref="data_string::len" data-ref-filename="data_string..len">len</a>);</td></tr>
<tr><th id="327">327</th><td>		<b>if</b> (<b>sizeof</b> <a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::file" title='dhcp_packet::file' data-ref="dhcp_packet::file" data-ref-filename="dhcp_packet..file">file</a> &gt; <a class="local col3 ref" href="#13d1" title='d1' data-ref="13d1" data-ref-filename="13d1">d1</a>.<a class="ref field" href="../includes/tree.h.html#data_string::len" title='data_string::len' data-ref="data_string::len" data-ref-filename="data_string..len">len</a>)</td></tr>
<tr><th id="328">328</th><td>			<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#memset" title='memset' data-ref="memset" data-ref-filename="memset">memset</a> (&amp;<a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::file" title='dhcp_packet::file' data-ref="dhcp_packet::file" data-ref-filename="dhcp_packet..file">file</a> [<a class="local col3 ref" href="#13d1" title='d1' data-ref="13d1" data-ref-filename="13d1">d1</a>.<a class="ref field" href="../includes/tree.h.html#data_string::len" title='data_string::len' data-ref="data_string::len" data-ref-filename="data_string..len">len</a>],</td></tr>
<tr><th id="329">329</th><td>				<var>0</var>, (<b>sizeof</b> <a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::file" title='dhcp_packet::file' data-ref="dhcp_packet::file" data-ref-filename="dhcp_packet..file">file</a>) - <a class="local col3 ref" href="#13d1" title='d1' data-ref="13d1" data-ref-filename="13d1">d1</a>.<a class="ref field" href="../includes/tree.h.html#data_string::len" title='data_string::len' data-ref="data_string::len" data-ref-filename="data_string..len">len</a>);</td></tr>
<tr><th id="330">330</th><td>		<a class="ref fn" href="../includes/dhcpd.h.html#data_string_forget" title='data_string_forget' data-ref="data_string_forget" data-ref-filename="data_string_forget">data_string_forget</a> (&amp;<a class="local col3 ref" href="#13d1" title='d1' data-ref="13d1" data-ref-filename="13d1">d1</a>, <a class="macro" href="../includes/omapip/omapip.h.html#569" title="&quot;/___NETBSD_SRC___/objdir.amd64/external/mpl/dhcp/bin/server/../../../../../../external/mpl/dhcp/dist/server/bootp.c&quot;, 330" data-ref="_M/MDL">MDL</a>);</td></tr>
<tr><th id="331">331</th><td>	} <b>else</b></td></tr>
<tr><th id="332">332</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#memcpy" title='memcpy' data-ref="memcpy" data-ref-filename="memcpy">memcpy</a> (<a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::file" title='dhcp_packet::file' data-ref="dhcp_packet::file" data-ref-filename="dhcp_packet..file">file</a>, <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#packet::raw" title='packet::raw' data-ref="packet::raw" data-ref-filename="packet..raw">raw</a> -&gt; <a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::file" title='dhcp_packet::file' data-ref="dhcp_packet::file" data-ref-filename="dhcp_packet..file">file</a>, <b>sizeof</b> <a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::file" title='dhcp_packet::file' data-ref="dhcp_packet::file" data-ref-filename="dhcp_packet..file">file</a>);</td></tr>
<tr><th id="333">333</th><td></td></tr>
<tr><th id="334">334</th><td>	<i>/* Choose a server name as above. */</i></td></tr>
<tr><th id="335">335</th><td>	<a class="local col4 ref" href="#14oc" title='oc' data-ref="14oc" data-ref-filename="14oc">oc</a> = <a class="ref fn" href="../includes/dhcpd.h.html#lookup_option" title='lookup_option' data-ref="lookup_option" data-ref-filename="lookup_option">lookup_option</a> (&amp;<a class="ref" href="../includes/dhcpd.h.html#server_universe" title='server_universe' data-ref="server_universe" data-ref-filename="server_universe">server_universe</a>, <a class="local col0 ref" href="#10options" title='options' data-ref="10options" data-ref-filename="10options">options</a>, <a class="macro" href="../includes/dhcpd.h.html#724" title="16" data-ref="_M/SV_SERVER_NAME">SV_SERVER_NAME</a>);</td></tr>
<tr><th id="336">336</th><td>	<b>if</b> (<a class="local col4 ref" href="#14oc" title='oc' data-ref="14oc" data-ref-filename="14oc">oc</a> &amp;&amp;</td></tr>
<tr><th id="337">337</th><td>	    <a class="ref fn" href="../includes/dhcpd.h.html#evaluate_option_cache" title='evaluate_option_cache' data-ref="evaluate_option_cache" data-ref-filename="evaluate_option_cache">evaluate_option_cache</a> (&amp;<a class="local col3 ref" href="#13d1" title='d1' data-ref="13d1" data-ref-filename="13d1">d1</a>, <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>, <a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>,</td></tr>
<tr><th id="338">338</th><td>				   (<b>struct</b> <a class="type" href="../includes/dhcpd.h.html#client_state" title='client_state' data-ref="client_state" data-ref-filename="client_state">client_state</a> *)<var>0</var>,</td></tr>
<tr><th id="339">339</th><td>				   <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#packet::options" title='packet::options' data-ref="packet::options" data-ref-filename="packet..options">options</a>, <a class="local col0 ref" href="#10options" title='options' data-ref="10options" data-ref-filename="10options">options</a>,</td></tr>
<tr><th id="340">340</th><td>				   &amp;<a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#lease::scope" title='lease::scope' data-ref="lease::scope" data-ref-filename="lease..scope">scope</a>, <a class="local col4 ref" href="#14oc" title='oc' data-ref="14oc" data-ref-filename="14oc">oc</a>, <a class="macro" href="../includes/omapip/omapip.h.html#569" title="&quot;/___NETBSD_SRC___/objdir.amd64/external/mpl/dhcp/bin/server/../../../../../../external/mpl/dhcp/dist/server/bootp.c&quot;, 340" data-ref="_M/MDL">MDL</a>)) {</td></tr>
<tr><th id="341">341</th><td>		<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#memcpy" title='memcpy' data-ref="memcpy" data-ref-filename="memcpy">memcpy</a> (<a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::sname" title='dhcp_packet::sname' data-ref="dhcp_packet::sname" data-ref-filename="dhcp_packet..sname">sname</a>, <a class="local col3 ref" href="#13d1" title='d1' data-ref="13d1" data-ref-filename="13d1">d1</a>.<a class="ref field" href="../includes/tree.h.html#data_string::data" title='data_string::data' data-ref="data_string::data" data-ref-filename="data_string..data">data</a>,</td></tr>
<tr><th id="342">342</th><td>			<a class="local col3 ref" href="#13d1" title='d1' data-ref="13d1" data-ref-filename="13d1">d1</a>.<a class="ref field" href="../includes/tree.h.html#data_string::len" title='data_string::len' data-ref="data_string::len" data-ref-filename="data_string..len">len</a> &gt; <b>sizeof</b> <a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::sname" title='dhcp_packet::sname' data-ref="dhcp_packet::sname" data-ref-filename="dhcp_packet..sname">sname</a> ? <b>sizeof</b> <a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::sname" title='dhcp_packet::sname' data-ref="dhcp_packet::sname" data-ref-filename="dhcp_packet..sname">sname</a> : <a class="local col3 ref" href="#13d1" title='d1' data-ref="13d1" data-ref-filename="13d1">d1</a>.<a class="ref field" href="../includes/tree.h.html#data_string::len" title='data_string::len' data-ref="data_string::len" data-ref-filename="data_string..len">len</a>);</td></tr>
<tr><th id="343">343</th><td>		<b>if</b> (<b>sizeof</b> <a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::sname" title='dhcp_packet::sname' data-ref="dhcp_packet::sname" data-ref-filename="dhcp_packet..sname">sname</a> &gt; <a class="local col3 ref" href="#13d1" title='d1' data-ref="13d1" data-ref-filename="13d1">d1</a>.<a class="ref field" href="../includes/tree.h.html#data_string::len" title='data_string::len' data-ref="data_string::len" data-ref-filename="data_string..len">len</a>)</td></tr>
<tr><th id="344">344</th><td>			<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#memset" title='memset' data-ref="memset" data-ref-filename="memset">memset</a> (&amp;<a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::sname" title='dhcp_packet::sname' data-ref="dhcp_packet::sname" data-ref-filename="dhcp_packet..sname">sname</a> [<a class="local col3 ref" href="#13d1" title='d1' data-ref="13d1" data-ref-filename="13d1">d1</a>.<a class="ref field" href="../includes/tree.h.html#data_string::len" title='data_string::len' data-ref="data_string::len" data-ref-filename="data_string..len">len</a>],</td></tr>
<tr><th id="345">345</th><td>				<var>0</var>, (<b>sizeof</b> <a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::sname" title='dhcp_packet::sname' data-ref="dhcp_packet::sname" data-ref-filename="dhcp_packet..sname">sname</a>) - <a class="local col3 ref" href="#13d1" title='d1' data-ref="13d1" data-ref-filename="13d1">d1</a>.<a class="ref field" href="../includes/tree.h.html#data_string::len" title='data_string::len' data-ref="data_string::len" data-ref-filename="data_string..len">len</a>);</td></tr>
<tr><th id="346">346</th><td>		<a class="ref fn" href="../includes/dhcpd.h.html#data_string_forget" title='data_string_forget' data-ref="data_string_forget" data-ref-filename="data_string_forget">data_string_forget</a> (&amp;<a class="local col3 ref" href="#13d1" title='d1' data-ref="13d1" data-ref-filename="13d1">d1</a>, <a class="macro" href="../includes/omapip/omapip.h.html#569" title="&quot;/___NETBSD_SRC___/objdir.amd64/external/mpl/dhcp/bin/server/../../../../../../external/mpl/dhcp/dist/server/bootp.c&quot;, 346" data-ref="_M/MDL">MDL</a>);</td></tr>
<tr><th id="347">347</th><td>	}</td></tr>
<tr><th id="348">348</th><td></td></tr>
<tr><th id="349">349</th><td>	<i>/* Execute the commit statements, if there are any. */</i></td></tr>
<tr><th id="350">350</th><td>	<a class="ref fn" href="../includes/dhcpd.h.html#execute_statements" title='execute_statements' data-ref="execute_statements" data-ref-filename="execute_statements">execute_statements</a> (<span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>, <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>, <a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>, <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#packet::options" title='packet::options' data-ref="packet::options" data-ref-filename="packet..options">options</a>,</td></tr>
<tr><th id="351">351</th><td>			    <a class="local col0 ref" href="#10options" title='options' data-ref="10options" data-ref-filename="10options">options</a>, &amp;<a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#lease::scope" title='lease::scope' data-ref="lease::scope" data-ref-filename="lease..scope">scope</a>, <a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#lease::on_star" title='lease::on_star' data-ref="lease::on_star" data-ref-filename="lease..on_star">on_star</a>.<a class="ref field" href="../includes/dhcpd.h.html#on_star::on_commit" title='on_star::on_commit' data-ref="on_star::on_commit" data-ref-filename="on_star..on_commit">on_commit</a>,</td></tr>
<tr><th id="352">352</th><td>			    <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="353">353</th><td></td></tr>
<tr><th id="354">354</th><td>	<i>/* We're done with the option state. */</i></td></tr>
<tr><th id="355">355</th><td>	<a class="ref fn" href="../includes/dhcpd.h.html#option_state_dereference" title='option_state_dereference' data-ref="option_state_dereference" data-ref-filename="option_state_dereference">option_state_dereference</a> (&amp;<a class="local col0 ref" href="#10options" title='options' data-ref="10options" data-ref-filename="10options">options</a>, <a class="macro" href="../includes/omapip/omapip.h.html#569" title="&quot;/___NETBSD_SRC___/objdir.amd64/external/mpl/dhcp/bin/server/../../../../../../external/mpl/dhcp/dist/server/bootp.c&quot;, 355" data-ref="_M/MDL">MDL</a>);</td></tr>
<tr><th id="356">356</th><td></td></tr>
<tr><th id="357">357</th><td><u>#<span data-ppcond="357">if</span> defined(<span class="macro" data-ref="_M/DHCPv6">DHCPv6</span>) &amp;&amp; defined(<span class="macro" data-ref="_M/DHCP4o6">DHCP4o6</span>)</u></td></tr>
<tr><th id="358">358</th><td>	<b>if</b> (dhcpv4_over_dhcpv6 &amp;&amp; (packet-&gt;dhcp4o6_response != NULL)) {</td></tr>
<tr><th id="359">359</th><td>		<i>/* Report what we're doing... */</i></td></tr>
<tr><th id="360">360</th><td>		log_info(<q>"%s"</q>, msgbuf);</td></tr>
<tr><th id="361">361</th><td>		log_info(<q>"DHCP4o6 BOOTREPLY for %s to %s (%s) via %s"</q>,</td></tr>
<tr><th id="362">362</th><td>			 piaddr(lease-&gt;ip_addr),</td></tr>
<tr><th id="363">363</th><td>			 ((hp != NULL) &amp;&amp; (hp-&gt;name != NULL)) ?</td></tr>
<tr><th id="364">364</th><td>				hp -&gt; name : <q>"unknown"</q>,</td></tr>
<tr><th id="365">365</th><td>			 print_hw_addr (packet-&gt;raw-&gt;htype,</td></tr>
<tr><th id="366">366</th><td>					packet-&gt;raw-&gt;hlen,</td></tr>
<tr><th id="367">367</th><td>					packet-&gt;raw-&gt;chaddr),</td></tr>
<tr><th id="368">368</th><td>			 piaddr(packet-&gt;client_addr));</td></tr>
<tr><th id="369">369</th><td></td></tr>
<tr><th id="370">370</th><td>		<i>/* fill dhcp4o6_response */</i></td></tr>
<tr><th id="371">371</th><td>		packet-&gt;dhcp4o6_response-&gt;len = outgoing.packet_length;</td></tr>
<tr><th id="372">372</th><td>		packet-&gt;dhcp4o6_response-&gt;buffer = NULL;</td></tr>
<tr><th id="373">373</th><td>		<b>if</b> (!buffer_allocate(&amp;packet-&gt;dhcp4o6_response-&gt;buffer,</td></tr>
<tr><th id="374">374</th><td>				     outgoing.packet_length, MDL)) {</td></tr>
<tr><th id="375">375</th><td>			log_fatal(<q>"No memory to store DHCP4o6 reply."</q>);</td></tr>
<tr><th id="376">376</th><td>		}</td></tr>
<tr><th id="377">377</th><td>		packet-&gt;dhcp4o6_response-&gt;data =</td></tr>
<tr><th id="378">378</th><td>			packet-&gt;dhcp4o6_response-&gt;buffer-&gt;data;</td></tr>
<tr><th id="379">379</th><td>		memcpy(packet-&gt;dhcp4o6_response-&gt;buffer-&gt;data,</td></tr>
<tr><th id="380">380</th><td>		       outgoing.raw, outgoing.packet_length);</td></tr>
<tr><th id="381">381</th><td>		<b>goto</b> out;</td></tr>
<tr><th id="382">382</th><td>	}</td></tr>
<tr><th id="383">383</th><td><u>#<span data-ppcond="357">endif</span></u></td></tr>
<tr><th id="384">384</th><td></td></tr>
<tr><th id="385">385</th><td>	<i>/* Set up the hardware destination address... */</i></td></tr>
<tr><th id="386">386</th><td>	<a class="local col9 ref" href="#9hto" title='hto' data-ref="9hto" data-ref-filename="9hto">hto</a>.<a class="ref field" href="../includes/dhcpd.h.html#hardware::hbuf" title='hardware::hbuf' data-ref="hardware::hbuf" data-ref-filename="hardware..hbuf">hbuf</a> [<var>0</var>] = <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#packet::raw" title='packet::raw' data-ref="packet::raw" data-ref-filename="packet..raw">raw</a> -&gt; <a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::htype" title='dhcp_packet::htype' data-ref="dhcp_packet::htype" data-ref-filename="dhcp_packet..htype">htype</a>;</td></tr>
<tr><th id="387">387</th><td>	<a class="local col9 ref" href="#9hto" title='hto' data-ref="9hto" data-ref-filename="9hto">hto</a>.<a class="ref field" href="../includes/dhcpd.h.html#hardware::hlen" title='hardware::hlen' data-ref="hardware::hlen" data-ref-filename="hardware..hlen">hlen</a> = <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#packet::raw" title='packet::raw' data-ref="packet::raw" data-ref-filename="packet..raw">raw</a> -&gt; <a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::hlen" title='dhcp_packet::hlen' data-ref="dhcp_packet::hlen" data-ref-filename="dhcp_packet..hlen">hlen</a> + <var>1</var>;</td></tr>
<tr><th id="388">388</th><td>	<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#memcpy" title='memcpy' data-ref="memcpy" data-ref-filename="memcpy">memcpy</a> (&amp;<a class="local col9 ref" href="#9hto" title='hto' data-ref="9hto" data-ref-filename="9hto">hto</a>.<a class="ref field" href="../includes/dhcpd.h.html#hardware::hbuf" title='hardware::hbuf' data-ref="hardware::hbuf" data-ref-filename="hardware..hbuf">hbuf</a> [<var>1</var>], <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#packet::raw" title='packet::raw' data-ref="packet::raw" data-ref-filename="packet..raw">raw</a> -&gt; <a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::chaddr" title='dhcp_packet::chaddr' data-ref="dhcp_packet::chaddr" data-ref-filename="dhcp_packet..chaddr">chaddr</a>, <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#packet::raw" title='packet::raw' data-ref="packet::raw" data-ref-filename="packet..raw">raw</a> -&gt; <a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::hlen" title='dhcp_packet::hlen' data-ref="dhcp_packet::hlen" data-ref-filename="dhcp_packet..hlen">hlen</a>);</td></tr>
<tr><th id="389">389</th><td></td></tr>
<tr><th id="390">390</th><td>	<b>if</b> (<a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#packet::interface" title='packet::interface' data-ref="packet::interface" data-ref-filename="packet..interface">interface</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#interface_info::address_count" title='interface_info::address_count' data-ref="interface_info::address_count" data-ref-filename="interface_info..address_count">address_count</a>) {</td></tr>
<tr><th id="391">391</th><td>		<a class="local col8 ref" href="#8from" title='from' data-ref="8from" data-ref-filename="8from">from</a> = <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#packet::interface" title='packet::interface' data-ref="packet::interface" data-ref-filename="packet..interface">interface</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#interface_info::addresses" title='interface_info::addresses' data-ref="interface_info::addresses" data-ref-filename="interface_info..addresses">addresses</a>[<var>0</var>];</td></tr>
<tr><th id="392">392</th><td>	} <b>else</b> {</td></tr>
<tr><th id="393">393</th><td>		<a class="ref fn" href="../includes/omapip/omapip_p.h.html#log_error" title='log_error' data-ref="log_error" data-ref-filename="log_error">log_error</a>(<q>"%s: Interface %s appears to have no IPv4 "</q></td></tr>
<tr><th id="394">394</th><td>			  <q>"addresses, and so dhcpd cannot select a source "</q></td></tr>
<tr><th id="395">395</th><td>			  <q>"address."</q>, <a class="local col5 ref" href="#15msgbuf" title='msgbuf' data-ref="15msgbuf" data-ref-filename="15msgbuf">msgbuf</a>, <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#packet::interface" title='packet::interface' data-ref="packet::interface" data-ref-filename="packet..interface">interface</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#interface_info::name" title='interface_info::name' data-ref="interface_info::name" data-ref-filename="interface_info..name">name</a>);</td></tr>
<tr><th id="396">396</th><td>		<b>goto</b> <a class="lbl" href="#19out" data-ref="19out" data-ref-filename="19out">out</a>;</td></tr>
<tr><th id="397">397</th><td>	}</td></tr>
<tr><th id="398">398</th><td></td></tr>
<tr><th id="399">399</th><td>	<i>/* Report what we're doing... */</i></td></tr>
<tr><th id="400">400</th><td>	<a class="ref fn" href="../includes/omapip/omapip_p.h.html#log_info" title='log_info' data-ref="log_info" data-ref-filename="log_info">log_info</a>(<q>"%s"</q>, <a class="local col5 ref" href="#15msgbuf" title='msgbuf' data-ref="15msgbuf" data-ref-filename="15msgbuf">msgbuf</a>);</td></tr>
<tr><th id="401">401</th><td>	<a class="ref fn" href="../includes/omapip/omapip_p.h.html#log_info" title='log_info' data-ref="log_info" data-ref-filename="log_info">log_info</a>(<q>"BOOTREPLY for %s to %s (%s) via %s"</q>,</td></tr>
<tr><th id="402">402</th><td>		 <a class="ref fn" href="../includes/dhcpd.h.html#piaddr" title='piaddr' data-ref="piaddr" data-ref-filename="piaddr">piaddr</a>(<a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#lease::ip_addr" title='lease::ip_addr' data-ref="lease::ip_addr" data-ref-filename="lease..ip_addr">ip_addr</a>),</td></tr>
<tr><th id="403">403</th><td>		 ((<a class="local col3 ref" href="#3hp" title='hp' data-ref="3hp" data-ref-filename="3hp">hp</a> != <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>) &amp;&amp; (<a class="local col3 ref" href="#3hp" title='hp' data-ref="3hp" data-ref-filename="3hp">hp</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#host_decl::name" title='host_decl::name' data-ref="host_decl::name" data-ref-filename="host_decl..name">name</a> != <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>)) ? <a class="local col3 ref" href="#3hp" title='hp' data-ref="3hp" data-ref-filename="3hp">hp</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#host_decl::name" title='host_decl::name' data-ref="host_decl::name" data-ref-filename="host_decl..name">name</a> : <q>"unknown"</q>,</td></tr>
<tr><th id="404">404</th><td>		 <a class="ref fn" href="../includes/dhcpd.h.html#print_hw_addr" title='print_hw_addr' data-ref="print_hw_addr" data-ref-filename="print_hw_addr">print_hw_addr</a> (<a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#packet::raw" title='packet::raw' data-ref="packet::raw" data-ref-filename="packet..raw">raw</a>-&gt;<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::htype" title='dhcp_packet::htype' data-ref="dhcp_packet::htype" data-ref-filename="dhcp_packet..htype">htype</a>,</td></tr>
<tr><th id="405">405</th><td>				<a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#packet::raw" title='packet::raw' data-ref="packet::raw" data-ref-filename="packet..raw">raw</a>-&gt;<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::hlen" title='dhcp_packet::hlen' data-ref="dhcp_packet::hlen" data-ref-filename="dhcp_packet..hlen">hlen</a>,</td></tr>
<tr><th id="406">406</th><td>				<a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#packet::raw" title='packet::raw' data-ref="packet::raw" data-ref-filename="packet..raw">raw</a>-&gt;<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::chaddr" title='dhcp_packet::chaddr' data-ref="dhcp_packet::chaddr" data-ref-filename="dhcp_packet..chaddr">chaddr</a>),</td></tr>
<tr><th id="407">407</th><td>		 <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#packet::raw" title='packet::raw' data-ref="packet::raw" data-ref-filename="packet..raw">raw</a>-&gt;<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::giaddr" title='dhcp_packet::giaddr' data-ref="dhcp_packet::giaddr" data-ref-filename="dhcp_packet..giaddr">giaddr</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/netinet/in.h.html#in_addr::s_addr" title='in_addr::s_addr' data-ref="in_addr::s_addr" data-ref-filename="in_addr..s_addr">s_addr</a></td></tr>
<tr><th id="408">408</th><td>		 ? <a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/arpa/inet.h.html#inet_ntoa" title='inet_ntoa' data-ref="inet_ntoa" data-ref-filename="inet_ntoa">inet_ntoa</a> (<a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#packet::raw" title='packet::raw' data-ref="packet::raw" data-ref-filename="packet..raw">raw</a>-&gt;<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::giaddr" title='dhcp_packet::giaddr' data-ref="dhcp_packet::giaddr" data-ref-filename="dhcp_packet..giaddr">giaddr</a>)</td></tr>
<tr><th id="409">409</th><td>		 : <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#packet::interface" title='packet::interface' data-ref="packet::interface" data-ref-filename="packet..interface">interface</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#interface_info::name" title='interface_info::name' data-ref="interface_info::name" data-ref-filename="interface_info..name">name</a>);</td></tr>
<tr><th id="410">410</th><td></td></tr>
<tr><th id="411">411</th><td>	<i>/* Set up the parts of the address that are in common. */</i></td></tr>
<tr><th id="412">412</th><td>	<a class="local col7 ref" href="#7to" title='to' data-ref="7to" data-ref-filename="7to">to</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/netinet/in.h.html#sockaddr_in::sin_family" title='sockaddr_in::sin_family' data-ref="sockaddr_in::sin_family" data-ref-filename="sockaddr_in..sin_family">sin_family</a> = <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/socket.h.html#203" title="2" data-ref="_M/AF_INET">AF_INET</a>;</td></tr>
<tr><th id="413">413</th><td><u>#<span data-ppcond="413">ifdef</span> <a class="macro" href="../../include/config.h.html#94" data-ref="_M/HAVE_SA_LEN">HAVE_SA_LEN</a></u></td></tr>
<tr><th id="414">414</th><td>	<a class="local col7 ref" href="#7to" title='to' data-ref="7to" data-ref-filename="7to">to</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/netinet/in.h.html#sockaddr_in::sin_len" title='sockaddr_in::sin_len' data-ref="sockaddr_in::sin_len" data-ref-filename="sockaddr_in..sin_len">sin_len</a> = <b>sizeof</b> <a class="local col7 ref" href="#7to" title='to' data-ref="7to" data-ref-filename="7to">to</a>;</td></tr>
<tr><th id="415">415</th><td><u>#<span data-ppcond="413">endif</span></u></td></tr>
<tr><th id="416">416</th><td>	<a class="ref fn" href="../../../../../objdir.amd64/destdir.amd64/usr/include/string.h.html#memset" title='memset' data-ref="memset" data-ref-filename="memset">memset</a> (<a class="local col7 ref" href="#7to" title='to' data-ref="7to" data-ref-filename="7to">to</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/netinet/in.h.html#sockaddr_in::sin_zero" title='sockaddr_in::sin_zero' data-ref="sockaddr_in::sin_zero" data-ref-filename="sockaddr_in..sin_zero">sin_zero</a>, <var>0</var>, <b>sizeof</b> <a class="local col7 ref" href="#7to" title='to' data-ref="7to" data-ref-filename="7to">to</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/netinet/in.h.html#sockaddr_in::sin_zero" title='sockaddr_in::sin_zero' data-ref="sockaddr_in::sin_zero" data-ref-filename="sockaddr_in..sin_zero">sin_zero</a>);</td></tr>
<tr><th id="417">417</th><td></td></tr>
<tr><th id="418">418</th><td>	<i>/* If this was gatewayed, send it back to the gateway... */</i></td></tr>
<tr><th id="419">419</th><td>	<b>if</b> (<a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::giaddr" title='dhcp_packet::giaddr' data-ref="dhcp_packet::giaddr" data-ref-filename="dhcp_packet..giaddr">giaddr</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/netinet/in.h.html#in_addr::s_addr" title='in_addr::s_addr' data-ref="in_addr::s_addr" data-ref-filename="in_addr..s_addr">s_addr</a>) {</td></tr>
<tr><th id="420">420</th><td>		<a class="local col7 ref" href="#7to" title='to' data-ref="7to" data-ref-filename="7to">to</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/netinet/in.h.html#sockaddr_in::sin_addr" title='sockaddr_in::sin_addr' data-ref="sockaddr_in::sin_addr" data-ref-filename="sockaddr_in..sin_addr">sin_addr</a> = <a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::giaddr" title='dhcp_packet::giaddr' data-ref="dhcp_packet::giaddr" data-ref-filename="dhcp_packet..giaddr">giaddr</a>;</td></tr>
<tr><th id="421">421</th><td>		<a class="local col7 ref" href="#7to" title='to' data-ref="7to" data-ref-filename="7to">to</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/netinet/in.h.html#sockaddr_in::sin_port" title='sockaddr_in::sin_port' data-ref="sockaddr_in::sin_port" data-ref-filename="sockaddr_in..sin_port">sin_port</a> = <a class="ref" href="../includes/dhcpd.h.html#local_port" title='local_port' data-ref="local_port" data-ref-filename="local_port">local_port</a>;</td></tr>
<tr><th id="422">422</th><td></td></tr>
<tr><th id="423">423</th><td>		<b>if</b> (<a class="ref" href="../includes/dhcpd.h.html#fallback_interface" title='fallback_interface' data-ref="fallback_interface" data-ref-filename="fallback_interface">fallback_interface</a>) {</td></tr>
<tr><th id="424">424</th><td>			<a class="local col2 ref" href="#2result" title='result' data-ref="2result" data-ref-filename="2result">result</a> = <a class="macro" href="#38" title="trace_packet_send" data-ref="_M/send_packet">send_packet</a> (<a class="ref" href="../includes/dhcpd.h.html#fallback_interface" title='fallback_interface' data-ref="fallback_interface" data-ref-filename="fallback_interface">fallback_interface</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>, &amp;<a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>,</td></tr>
<tr><th id="425">425</th><td>					      <a class="local col5 ref" href="#5outgoing" title='outgoing' data-ref="5outgoing" data-ref-filename="5outgoing">outgoing</a>.<a class="ref field" href="../includes/dhcpd.h.html#packet::packet_length" title='packet::packet_length' data-ref="packet::packet_length" data-ref-filename="packet..packet_length">packet_length</a>, <a class="local col8 ref" href="#8from" title='from' data-ref="8from" data-ref-filename="8from">from</a>,</td></tr>
<tr><th id="426">426</th><td>					      &amp;<a class="local col7 ref" href="#7to" title='to' data-ref="7to" data-ref-filename="7to">to</a>, &amp;<a class="local col9 ref" href="#9hto" title='hto' data-ref="9hto" data-ref-filename="9hto">hto</a>);</td></tr>
<tr><th id="427">427</th><td>			<b>if</b> (<a class="local col2 ref" href="#2result" title='result' data-ref="2result" data-ref-filename="2result">result</a> &lt; <var>0</var>) {</td></tr>
<tr><th id="428">428</th><td>				<a class="ref fn" href="../includes/omapip/omapip_p.h.html#log_error" title='log_error' data-ref="log_error" data-ref-filename="log_error">log_error</a> (<q>"%s:%d: Failed to send %d byte long "</q></td></tr>
<tr><th id="429">429</th><td>					   <q>"packet over %s interface."</q>, <a class="macro" href="../includes/omapip/omapip.h.html#569" title="&quot;/___NETBSD_SRC___/objdir.amd64/external/mpl/dhcp/bin/server/../../../../../../external/mpl/dhcp/dist/server/bootp.c&quot;, 429" data-ref="_M/MDL">MDL</a>,</td></tr>
<tr><th id="430">430</th><td>					   <a class="local col5 ref" href="#5outgoing" title='outgoing' data-ref="5outgoing" data-ref-filename="5outgoing">outgoing</a>.<a class="ref field" href="../includes/dhcpd.h.html#packet::packet_length" title='packet::packet_length' data-ref="packet::packet_length" data-ref-filename="packet..packet_length">packet_length</a>,</td></tr>
<tr><th id="431">431</th><td>					   <a class="ref" href="../includes/dhcpd.h.html#fallback_interface" title='fallback_interface' data-ref="fallback_interface" data-ref-filename="fallback_interface">fallback_interface</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#interface_info::name" title='interface_info::name' data-ref="interface_info::name" data-ref-filename="interface_info..name">name</a>);</td></tr>
<tr><th id="432">432</th><td>			}</td></tr>
<tr><th id="433">433</th><td></td></tr>
<tr><th id="434">434</th><td>			<b>goto</b> <a class="lbl" href="#19out" data-ref="19out" data-ref-filename="19out">out</a>;</td></tr>
<tr><th id="435">435</th><td>		}</td></tr>
<tr><th id="436">436</th><td></td></tr>
<tr><th id="437">437</th><td>	<i>/* If it comes from a client that already knows its address</i></td></tr>
<tr><th id="438">438</th><td><i>	   and is not requesting a broadcast response, and we can</i></td></tr>
<tr><th id="439">439</th><td><i>	   unicast to a client without using the ARP protocol, sent it</i></td></tr>
<tr><th id="440">440</th><td><i>	   directly to that client. */</i></td></tr>
<tr><th id="441">441</th><td>	} <b>else</b> <b>if</b> (!(<a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::flags" title='dhcp_packet::flags' data-ref="dhcp_packet::flags" data-ref-filename="dhcp_packet..flags">flags</a> &amp; <a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/sys/endian.h.html#128" title="((uint16_t)(__builtin_constant_p((((uint16_t)((32768L))))) ? (((uint16_t)(((((((uint16_t)((32768L)))) &amp; 0xff00) &gt;&gt; 8) | (((((uint16_t)((32768L)))) &amp; 0x00ff) &lt;&lt; 8))))) : __byte_swap_u16_variable(((uint16_t)((32768L))))))" data-ref="_M/htons">htons</a> (<a class="macro" href="../includes/dhcp.h.html#74" title="32768L" data-ref="_M/BOOTP_BROADCAST">BOOTP_BROADCAST</a>)) &amp;&amp;</td></tr>
<tr><th id="442">442</th><td>		   <a class="ref fn" href="../includes/dhcpd.h.html#can_unicast_without_arp" title='can_unicast_without_arp' data-ref="can_unicast_without_arp" data-ref-filename="can_unicast_without_arp">can_unicast_without_arp</a> (<a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a> -&gt; <a class="ref field" href="../includes/dhcpd.h.html#packet::interface" title='packet::interface' data-ref="packet::interface" data-ref-filename="packet..interface">interface</a>)) {</td></tr>
<tr><th id="443">443</th><td>		<a class="local col7 ref" href="#7to" title='to' data-ref="7to" data-ref-filename="7to">to</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/netinet/in.h.html#sockaddr_in::sin_addr" title='sockaddr_in::sin_addr' data-ref="sockaddr_in::sin_addr" data-ref-filename="sockaddr_in..sin_addr">sin_addr</a> = <a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>.<a class="ref field" href="../includes/dhcp.h.html#dhcp_packet::yiaddr" title='dhcp_packet::yiaddr' data-ref="dhcp_packet::yiaddr" data-ref-filename="dhcp_packet..yiaddr">yiaddr</a>;</td></tr>
<tr><th id="444">444</th><td>		<a class="local col7 ref" href="#7to" title='to' data-ref="7to" data-ref-filename="7to">to</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/netinet/in.h.html#sockaddr_in::sin_port" title='sockaddr_in::sin_port' data-ref="sockaddr_in::sin_port" data-ref-filename="sockaddr_in..sin_port">sin_port</a> = <a class="ref" href="../includes/dhcpd.h.html#remote_port" title='remote_port' data-ref="remote_port" data-ref-filename="remote_port">remote_port</a>;</td></tr>
<tr><th id="445">445</th><td></td></tr>
<tr><th id="446">446</th><td>	<i>/* Otherwise, broadcast it on the local network. */</i></td></tr>
<tr><th id="447">447</th><td>	} <b>else</b> {</td></tr>
<tr><th id="448">448</th><td>		<a class="local col7 ref" href="#7to" title='to' data-ref="7to" data-ref-filename="7to">to</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/netinet/in.h.html#sockaddr_in::sin_addr" title='sockaddr_in::sin_addr' data-ref="sockaddr_in::sin_addr" data-ref-filename="sockaddr_in..sin_addr">sin_addr</a> = <a class="ref" href="../includes/dhcpd.h.html#limited_broadcast" title='limited_broadcast' data-ref="limited_broadcast" data-ref-filename="limited_broadcast">limited_broadcast</a>;</td></tr>
<tr><th id="449">449</th><td>		<a class="local col7 ref" href="#7to" title='to' data-ref="7to" data-ref-filename="7to">to</a>.<a class="ref field" href="../../../../../objdir.amd64/destdir.amd64/usr/include/netinet/in.h.html#sockaddr_in::sin_port" title='sockaddr_in::sin_port' data-ref="sockaddr_in::sin_port" data-ref-filename="sockaddr_in..sin_port">sin_port</a> = <a class="ref" href="../includes/dhcpd.h.html#remote_port" title='remote_port' data-ref="remote_port" data-ref-filename="remote_port">remote_port</a>; <i>/* XXX */</i></td></tr>
<tr><th id="450">450</th><td>	}</td></tr>
<tr><th id="451">451</th><td></td></tr>
<tr><th id="452">452</th><td>	<a class="macro" href="../../../../../objdir.amd64/destdir.amd64/usr/include/errno.h.html#55" title="(*__errno())" data-ref="_M/errno">errno</a> = <var>0</var>;</td></tr>
<tr><th id="453">453</th><td>	<a class="local col2 ref" href="#2result" title='result' data-ref="2result" data-ref-filename="2result">result</a> = <a class="macro" href="#38" title="trace_packet_send" data-ref="_M/send_packet">send_packet</a>(<a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#packet::interface" title='packet::interface' data-ref="packet::interface" data-ref-filename="packet..interface">interface</a>, <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>, &amp;<a class="local col6 ref" href="#6raw" title='raw' data-ref="6raw" data-ref-filename="6raw">raw</a>,</td></tr>
<tr><th id="454">454</th><td>			     <a class="local col5 ref" href="#5outgoing" title='outgoing' data-ref="5outgoing" data-ref-filename="5outgoing">outgoing</a>.<a class="ref field" href="../includes/dhcpd.h.html#packet::packet_length" title='packet::packet_length' data-ref="packet::packet_length" data-ref-filename="packet..packet_length">packet_length</a>, <a class="local col8 ref" href="#8from" title='from' data-ref="8from" data-ref-filename="8from">from</a>, &amp;<a class="local col7 ref" href="#7to" title='to' data-ref="7to" data-ref-filename="7to">to</a>, &amp;<a class="local col9 ref" href="#9hto" title='hto' data-ref="9hto" data-ref-filename="9hto">hto</a>);</td></tr>
<tr><th id="455">455</th><td>	<b>if</b> (<a class="local col2 ref" href="#2result" title='result' data-ref="2result" data-ref-filename="2result">result</a> &lt; <var>0</var>) {</td></tr>
<tr><th id="456">456</th><td>		<a class="ref fn" href="../includes/omapip/omapip_p.h.html#log_error" title='log_error' data-ref="log_error" data-ref-filename="log_error">log_error</a> (<q>"%s:%d: Failed to send %d byte long packet over %s"</q></td></tr>
<tr><th id="457">457</th><td>			   <q>" interface."</q>, <a class="macro" href="../includes/omapip/omapip.h.html#569" title="&quot;/___NETBSD_SRC___/objdir.amd64/external/mpl/dhcp/bin/server/../../../../../../external/mpl/dhcp/dist/server/bootp.c&quot;, 457" data-ref="_M/MDL">MDL</a>, <a class="local col5 ref" href="#5outgoing" title='outgoing' data-ref="5outgoing" data-ref-filename="5outgoing">outgoing</a>.<a class="ref field" href="../includes/dhcpd.h.html#packet::packet_length" title='packet::packet_length' data-ref="packet::packet_length" data-ref-filename="packet..packet_length">packet_length</a>,</td></tr>
<tr><th id="458">458</th><td>			   <a class="local col1 ref" href="#1packet" title='packet' data-ref="1packet" data-ref-filename="1packet">packet</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#packet::interface" title='packet::interface' data-ref="packet::interface" data-ref-filename="packet..interface">interface</a>-&gt;<a class="ref field" href="../includes/dhcpd.h.html#interface_info::name" title='interface_info::name' data-ref="interface_info::name" data-ref-filename="interface_info..name">name</a>);</td></tr>
<tr><th id="459">459</th><td>	}</td></tr>
<tr><th id="460">460</th><td></td></tr>
<tr><th id="461">461</th><td>      <dfn class="lbl" id="19out" data-ref="19out" data-ref-filename="19out">out</dfn>:</td></tr>
<tr><th id="462">462</th><td></td></tr>
<tr><th id="463">463</th><td>	<b>if</b> (<a class="local col0 ref" href="#10options" title='options' data-ref="10options" data-ref-filename="10options">options</a>)</td></tr>
<tr><th id="464">464</th><td>		<a class="ref fn" href="../includes/dhcpd.h.html#option_state_dereference" title='option_state_dereference' data-ref="option_state_dereference" data-ref-filename="option_state_dereference">option_state_dereference</a> (&amp;<a class="local col0 ref" href="#10options" title='options' data-ref="10options" data-ref-filename="10options">options</a>, <a class="macro" href="../includes/omapip/omapip.h.html#569" title="&quot;/___NETBSD_SRC___/objdir.amd64/external/mpl/dhcp/bin/server/../../../../../../external/mpl/dhcp/dist/server/bootp.c&quot;, 464" data-ref="_M/MDL">MDL</a>);</td></tr>
<tr><th id="465">465</th><td>	<b>if</b> (<a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>)</td></tr>
<tr><th id="466">466</th><td>		<a class="ref fn" href="../includes/dhcpd.h.html#2483" title='lease_dereference' data-ref="lease_dereference" data-ref-filename="lease_dereference">lease_dereference</a> (&amp;<a class="local col1 ref" href="#11lease" title='lease' data-ref="11lease" data-ref-filename="11lease">lease</a>, <a class="macro" href="../includes/omapip/omapip.h.html#569" title="&quot;/___NETBSD_SRC___/objdir.amd64/external/mpl/dhcp/bin/server/../../../../../../external/mpl/dhcp/dist/server/bootp.c&quot;, 466" data-ref="_M/MDL">MDL</a>);</td></tr>
<tr><th id="467">467</th><td>	<b>if</b> (<a class="local col3 ref" href="#3hp" title='hp' data-ref="3hp" data-ref-filename="3hp">hp</a>)</td></tr>
<tr><th id="468">468</th><td>		<a class="ref fn" href="../includes/dhcpd.h.html#2487" title='host_dereference' data-ref="host_dereference" data-ref-filename="host_dereference">host_dereference</a> (&amp;<a class="local col3 ref" href="#3hp" title='hp' data-ref="3hp" data-ref-filename="3hp">hp</a>, <a class="macro" href="../includes/omapip/omapip.h.html#569" title="&quot;/___NETBSD_SRC___/objdir.amd64/external/mpl/dhcp/bin/server/../../../../../../external/mpl/dhcp/dist/server/bootp.c&quot;, 468" data-ref="_M/MDL">MDL</a>);</td></tr>
<tr><th id="469">469</th><td>	<b>if</b> (<a class="local col4 ref" href="#4host" title='host' data-ref="4host" data-ref-filename="4host">host</a>)</td></tr>
<tr><th id="470">470</th><td>		<a class="ref fn" href="../includes/dhcpd.h.html#2487" title='host_dereference' data-ref="host_dereference" data-ref-filename="host_dereference">host_dereference</a> (&amp;<a class="local col4 ref" href="#4host" title='host' data-ref="4host" data-ref-filename="4host">host</a>, <a class="macro" href="../includes/omapip/omapip.h.html#569" title="&quot;/___NETBSD_SRC___/objdir.amd64/external/mpl/dhcp/bin/server/../../../../../../external/mpl/dhcp/dist/server/bootp.c&quot;, 470" data-ref="_M/MDL">MDL</a>);</td></tr>
<tr><th id="471">471</th><td>}</td></tr>
<tr><th id="472">472</th><td></td></tr>
</table><hr/><p id='footer'>
Generated on <em>2019-Jul-19</em> from project netbsd revision <em>f9da89e0d</em><br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 2.1
<br/>Generator usage only permitted with license.</p>
</div></body></html>
