<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>coda_venus.c source code [netbsd/sys/coda/coda_venus.c] - Woboq Code Browser</title>
<link rel="stylesheet" href="https://code.woboq.org/data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="https://code.woboq.org/data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="https://code.woboq.org/data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="https://code.woboq.org/data/jquery/jquery-ui.min.js"></script>
<script>var file = 'netbsd/sys/coda/coda_venus.c'; var root_path = '../../..'; var data_path = 'https://code.woboq.org/data'; var ecma_script_api_version = 2;</script>
<script src='https://code.woboq.org/data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='../..'>netbsd</a>/<a href='..'>sys</a>/<a href='./'>coda</a>/<a href='coda_venus.c.html'>coda_venus.c</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>/*	$NetBSD: coda_venus.c,v 1.30 2013/10/17 20:56:02 christos Exp $	*/</i></td></tr>
<tr><th id="2">2</th><td></td></tr>
<tr><th id="3">3</th><td><i>/*</i></td></tr>
<tr><th id="4">4</th><td><i> *</i></td></tr>
<tr><th id="5">5</th><td><i> *             Coda: an Experimental Distributed File System</i></td></tr>
<tr><th id="6">6</th><td><i> *                              Release 3.1</i></td></tr>
<tr><th id="7">7</th><td><i> *</i></td></tr>
<tr><th id="8">8</th><td><i> *           Copyright (c) 1987-1998 Carnegie Mellon University</i></td></tr>
<tr><th id="9">9</th><td><i> *                          All Rights Reserved</i></td></tr>
<tr><th id="10">10</th><td><i> *</i></td></tr>
<tr><th id="11">11</th><td><i> * Permission  to  use, copy, modify and distribute this software and its</i></td></tr>
<tr><th id="12">12</th><td><i> * documentation is hereby granted,  provided  that  both  the  copyright</i></td></tr>
<tr><th id="13">13</th><td><i> * notice  and  this  permission  notice  appear  in  all  copies  of the</i></td></tr>
<tr><th id="14">14</th><td><i> * software, derivative works or  modified  versions,  and  any  portions</i></td></tr>
<tr><th id="15">15</th><td><i> * thereof, and that both notices appear in supporting documentation, and</i></td></tr>
<tr><th id="16">16</th><td><i> * that credit is given to Carnegie Mellon University  in  all  documents</i></td></tr>
<tr><th id="17">17</th><td><i> * and publicity pertaining to direct or indirect use of this code or its</i></td></tr>
<tr><th id="18">18</th><td><i> * derivatives.</i></td></tr>
<tr><th id="19">19</th><td><i> *</i></td></tr>
<tr><th id="20">20</th><td><i> * CODA IS AN EXPERIMENTAL SOFTWARE SYSTEM AND IS  KNOWN  TO  HAVE  BUGS,</i></td></tr>
<tr><th id="21">21</th><td><i> * SOME  OF  WHICH MAY HAVE SERIOUS CONSEQUENCES.  CARNEGIE MELLON ALLOWS</i></td></tr>
<tr><th id="22">22</th><td><i> * FREE USE OF THIS SOFTWARE IN ITS "AS IS" CONDITION.   CARNEGIE  MELLON</i></td></tr>
<tr><th id="23">23</th><td><i> * DISCLAIMS  ANY  LIABILITY  OF  ANY  KIND  FOR  ANY  DAMAGES WHATSOEVER</i></td></tr>
<tr><th id="24">24</th><td><i> * RESULTING DIRECTLY OR INDIRECTLY FROM THE USE OF THIS SOFTWARE  OR  OF</i></td></tr>
<tr><th id="25">25</th><td><i> * ANY DERIVATIVE WORK.</i></td></tr>
<tr><th id="26">26</th><td><i> *</i></td></tr>
<tr><th id="27">27</th><td><i> * Carnegie  Mellon  encourages  users  of  this  software  to return any</i></td></tr>
<tr><th id="28">28</th><td><i> * improvements or extensions that  they  make,  and  to  grant  Carnegie</i></td></tr>
<tr><th id="29">29</th><td><i> * Mellon the rights to redistribute these changes without encumbrance.</i></td></tr>
<tr><th id="30">30</th><td><i> *</i></td></tr>
<tr><th id="31">31</th><td><i> * 	@(#) coda/coda_venus.c,v 1.1.1.1 1998/08/29 21:26:45 rvb Exp $</i></td></tr>
<tr><th id="32">32</th><td><i> */</i></td></tr>
<tr><th id="33">33</th><td></td></tr>
<tr><th id="34">34</th><td><u>#include <a href="../sys/cdefs.h.html">&lt;sys/cdefs.h&gt;</a></u></td></tr>
<tr><th id="35">35</th><td><a class="macro" href="../sys/cdefs_elf.h.html#156" title="__asm(&quot;.pushsection &quot; &quot;.ident&quot; &quot;\n&quot; &quot;.asciz \&quot;&quot; &quot;$NetBSD: coda_venus.c,v 1.30 2013/10/17 20:56:02 christos Exp $&quot; &quot;\&quot;\n&quot; &quot;.popsection&quot;)" data-ref="_M/__KERNEL_RCSID">__KERNEL_RCSID</a>(<var>0</var>, <q>"$NetBSD: coda_venus.c,v 1.30 2013/10/17 20:56:02 christos Exp $"</q>);</td></tr>
<tr><th id="36">36</th><td></td></tr>
<tr><th id="37">37</th><td><u>#include <a href="../sys/param.h.html">&lt;sys/param.h&gt;</a></u></td></tr>
<tr><th id="38">38</th><td><u>#include <a href="../sys/systm.h.html">&lt;sys/systm.h&gt;</a></u></td></tr>
<tr><th id="39">39</th><td><u>#include <a href="../sys/malloc.h.html">&lt;sys/malloc.h&gt;</a></u></td></tr>
<tr><th id="40">40</th><td><u>#include <a href="../sys/proc.h.html">&lt;sys/proc.h&gt;</a></u></td></tr>
<tr><th id="41">41</th><td><u>#include <a href="../sys/select.h.html">&lt;sys/select.h&gt;</a></u></td></tr>
<tr><th id="42">42</th><td><u>#include <a href="../sys/ioctl.h.html">&lt;sys/ioctl.h&gt;</a></u></td></tr>
<tr><th id="43">43</th><td><i>/* for CNV_OFLAGS below */</i></td></tr>
<tr><th id="44">44</th><td><u>#include <a href="../sys/fcntl.h.html">&lt;sys/fcntl.h&gt;</a></u></td></tr>
<tr><th id="45">45</th><td><u>#include <a href="../sys/kauth.h.html">&lt;sys/kauth.h&gt;</a></u></td></tr>
<tr><th id="46">46</th><td></td></tr>
<tr><th id="47">47</th><td><u>#include <a href="coda.h.html">&lt;coda/coda.h&gt;</a></u></td></tr>
<tr><th id="48">48</th><td><u>#include <a href="cnode.h.html">&lt;coda/cnode.h&gt;</a></u></td></tr>
<tr><th id="49">49</th><td><u>#include <a href="coda_venus.h.html">&lt;coda/coda_venus.h&gt;</a></u></td></tr>
<tr><th id="50">50</th><td><u>#include <a href="coda_pioctl.h.html">&lt;coda/coda_pioctl.h&gt;</a></u></td></tr>
<tr><th id="51">51</th><td></td></tr>
<tr><th id="52">52</th><td><u>#<span data-ppcond="52">ifdef</span> <span class="macro" data-ref="_M/_KERNEL_OPT">_KERNEL_OPT</span></u></td></tr>
<tr><th id="53">53</th><td><u>#include <a href="../../objdir.amd64/sys/arch/amd64/compile/GENERIC/opt_coda_compat.h.html">"opt_coda_compat.h"</a></u></td></tr>
<tr><th id="54">54</th><td><u>#<span data-ppcond="52">endif</span></u></td></tr>
<tr><th id="55">55</th><td></td></tr>
<tr><th id="56">56</th><td><i>/*</i></td></tr>
<tr><th id="57">57</th><td><i> * Isize and Osize are the sizes of the input and output arguments.</i></td></tr>
<tr><th id="58">58</th><td><i> * SEMI-INVARIANT: name##_size (e.g. coda_readlink_size) is the max of</i></td></tr>
<tr><th id="59">59</th><td><i> * the input and output.  This invariant is not well maintained, but</i></td></tr>
<tr><th id="60">60</th><td><i> * should be true after ALLOC_*.  Isize is modified after allocation</i></td></tr>
<tr><th id="61">61</th><td><i> * by STRCPY below - this is in general unsafe and needs fixing.</i></td></tr>
<tr><th id="62">62</th><td><i> */</i></td></tr>
<tr><th id="63">63</th><td></td></tr>
<tr><th id="64">64</th><td><u>#define <dfn class="macro" id="_M/DECL_NO_IN" data-ref="_M/DECL_NO_IN">DECL_NO_IN</dfn>(name) 				\</u></td></tr>
<tr><th id="65">65</th><td><u>    struct <a class="type" href="coda.h.html#coda_in_hdr" title='coda_in_hdr' data-ref="coda_in_hdr" data-ref-filename="coda_in_hdr">coda_in_hdr</a> *<dfn class="local col6 decl" id="136inp" title='inp' data-type='struct coda_in_hdr *' data-ref="136inp" data-ref-filename="136inp">inp</dfn>;				\</u></td></tr>
<tr><th id="66">66</th><td><u>    struct name ## _out *<dfn class="local col7 decl" id="137outp" title='outp' data-type='struct coda_root_out *' data-ref="137outp" data-ref-filename="137outp">outp</dfn>;				\</u></td></tr>
<tr><th id="67">67</th><td><u>    int name ## _size = sizeof (struct <a class="type" href="coda.h.html#coda_in_hdr" title='coda_in_hdr' data-ref="coda_in_hdr" data-ref-filename="coda_in_hdr">coda_in_hdr</a>);	\</u></td></tr>
<tr><th id="68">68</th><td><u>    int <dfn class="local col8 decl" id="138Isize" title='Isize' data-type='int' data-ref="138Isize" data-ref-filename="138Isize">Isize</dfn> = sizeof (struct <a class="type" href="coda.h.html#coda_in_hdr" title='coda_in_hdr' data-ref="coda_in_hdr" data-ref-filename="coda_in_hdr">coda_in_hdr</a>);		\</u></td></tr>
<tr><th id="69">69</th><td><u>    int <dfn class="local col9 decl" id="139Osize" title='Osize' data-type='int' data-ref="139Osize" data-ref-filename="139Osize">Osize</dfn> = sizeof (struct name ## _out);		\</u></td></tr>
<tr><th id="70">70</th><td><u>    int <dfn class="local col0 decl" id="140error" title='error' data-type='int' data-ref="140error" data-ref-filename="140error">error</dfn></u></td></tr>
<tr><th id="71">71</th><td></td></tr>
<tr><th id="72">72</th><td><u>#define <dfn class="macro" id="_M/DECL" data-ref="_M/DECL">DECL</dfn>(name)					\</u></td></tr>
<tr><th id="73">73</th><td><u>    struct name ## _in *<dfn class="local col9 decl" id="149inp" title='inp' data-type='struct coda_open_in *' data-ref="149inp" data-ref-filename="149inp"><dfn class="local col1 decl" id="171inp" title='inp' data-type='struct coda_ioctl_in *' data-ref="171inp" data-ref-filename="171inp"><dfn class="local col4 decl" id="184inp" title='inp' data-type='struct coda_getattr_in *' data-ref="184inp" data-ref-filename="184inp"><dfn class="local col3 decl" id="213inp" title='inp' data-type='struct coda_readlink_in *' data-ref="213inp" data-ref-filename="213inp"><dfn class="local col6 decl" id="236inp" title='inp' data-type='struct coda_lookup_in *' data-ref="236inp" data-ref-filename="236inp"><dfn class="local col3 decl" id="253inp" title='inp' data-type='struct coda_create_in *' data-ref="253inp" data-ref-filename="253inp"><dfn class="local col5 decl" id="305inp" title='inp' data-type='struct coda_mkdir_in *' data-ref="305inp" data-ref-filename="305inp"><dfn class="local col4 decl" id="344inp" title='inp' data-type='struct coda_readdir_in *' data-ref="344inp" data-ref-filename="344inp"><dfn class="local col4 decl" id="354inp" title='inp' data-type='struct coda_statfs_in *' data-ref="354inp" data-ref-filename="354inp"><dfn class="local col5 decl" id="365inp" title='inp' data-type='struct coda_vget_in *' data-ref="365inp" data-ref-filename="365inp">inp</dfn></dfn></dfn></dfn></dfn></dfn></dfn></dfn></dfn></dfn>;				\</u></td></tr>
<tr><th id="74">74</th><td><u>    struct name ## _out *<dfn class="local col0 decl" id="150outp" title='outp' data-type='struct coda_open_out *' data-ref="150outp" data-ref-filename="150outp"><dfn class="local col2 decl" id="172outp" title='outp' data-type='struct coda_ioctl_out *' data-ref="172outp" data-ref-filename="172outp"><dfn class="local col5 decl" id="185outp" title='outp' data-type='struct coda_getattr_out *' data-ref="185outp" data-ref-filename="185outp"><dfn class="local col4 decl" id="214outp" title='outp' data-type='struct coda_readlink_out *' data-ref="214outp" data-ref-filename="214outp"><dfn class="local col7 decl" id="237outp" title='outp' data-type='struct coda_lookup_out *' data-ref="237outp" data-ref-filename="237outp"><dfn class="local col4 decl" id="254outp" title='outp' data-type='struct coda_create_out *' data-ref="254outp" data-ref-filename="254outp"><dfn class="local col6 decl" id="306outp" title='outp' data-type='struct coda_mkdir_out *' data-ref="306outp" data-ref-filename="306outp"><dfn class="local col5 decl" id="345outp" title='outp' data-type='struct coda_readdir_out *' data-ref="345outp" data-ref-filename="345outp"><dfn class="local col5 decl" id="355outp" title='outp' data-type='struct coda_statfs_out *' data-ref="355outp" data-ref-filename="355outp"><dfn class="local col6 decl" id="366outp" title='outp' data-type='struct coda_vget_out *' data-ref="366outp" data-ref-filename="366outp">outp</dfn></dfn></dfn></dfn></dfn></dfn></dfn></dfn></dfn></dfn>;				\</u></td></tr>
<tr><th id="75">75</th><td><u>    int name ## _size = sizeof (struct name ## _in);	\</u></td></tr>
<tr><th id="76">76</th><td><u>    int <dfn class="local col1 decl" id="151Isize" title='Isize' data-type='int' data-ref="151Isize" data-ref-filename="151Isize"><dfn class="local col3 decl" id="173Isize" title='Isize' data-type='int' data-ref="173Isize" data-ref-filename="173Isize"><dfn class="local col6 decl" id="186Isize" title='Isize' data-type='int' data-ref="186Isize" data-ref-filename="186Isize"><dfn class="local col5 decl" id="215Isize" title='Isize' data-type='int' data-ref="215Isize" data-ref-filename="215Isize"><dfn class="local col8 decl" id="238Isize" title='Isize' data-type='int' data-ref="238Isize" data-ref-filename="238Isize"><dfn class="local col5 decl" id="255Isize" title='Isize' data-type='int' data-ref="255Isize" data-ref-filename="255Isize"><dfn class="local col7 decl" id="307Isize" title='Isize' data-type='int' data-ref="307Isize" data-ref-filename="307Isize"><dfn class="local col6 decl" id="346Isize" title='Isize' data-type='int' data-ref="346Isize" data-ref-filename="346Isize"><dfn class="local col6 decl" id="356Isize" title='Isize' data-type='int' data-ref="356Isize" data-ref-filename="356Isize"><dfn class="local col7 decl" id="367Isize" title='Isize' data-type='int' data-ref="367Isize" data-ref-filename="367Isize">Isize</dfn></dfn></dfn></dfn></dfn></dfn></dfn></dfn></dfn></dfn> = sizeof (struct name ## _in);		\</u></td></tr>
<tr><th id="77">77</th><td><u>    int <dfn class="local col2 decl" id="152Osize" title='Osize' data-type='int' data-ref="152Osize" data-ref-filename="152Osize"><dfn class="local col4 decl" id="174Osize" title='Osize' data-type='int' data-ref="174Osize" data-ref-filename="174Osize"><dfn class="local col7 decl" id="187Osize" title='Osize' data-type='int' data-ref="187Osize" data-ref-filename="187Osize"><dfn class="local col6 decl" id="216Osize" title='Osize' data-type='int' data-ref="216Osize" data-ref-filename="216Osize"><dfn class="local col9 decl" id="239Osize" title='Osize' data-type='int' data-ref="239Osize" data-ref-filename="239Osize"><dfn class="local col6 decl" id="256Osize" title='Osize' data-type='int' data-ref="256Osize" data-ref-filename="256Osize"><dfn class="local col8 decl" id="308Osize" title='Osize' data-type='int' data-ref="308Osize" data-ref-filename="308Osize"><dfn class="local col7 decl" id="347Osize" title='Osize' data-type='int' data-ref="347Osize" data-ref-filename="347Osize"><dfn class="local col7 decl" id="357Osize" title='Osize' data-type='int' data-ref="357Osize" data-ref-filename="357Osize"><dfn class="local col8 decl" id="368Osize" title='Osize' data-type='int' data-ref="368Osize" data-ref-filename="368Osize">Osize</dfn></dfn></dfn></dfn></dfn></dfn></dfn></dfn></dfn></dfn> = sizeof (struct name ## _out);		\</u></td></tr>
<tr><th id="78">78</th><td><u>    int <dfn class="local col3 decl" id="153error" title='error' data-type='int' data-ref="153error" data-ref-filename="153error"><dfn class="local col5 decl" id="175error" title='error' data-type='int' data-ref="175error" data-ref-filename="175error"><dfn class="local col8 decl" id="188error" title='error' data-type='int' data-ref="188error" data-ref-filename="188error"><dfn class="local col7 decl" id="217error" title='error' data-type='int' data-ref="217error" data-ref-filename="217error"><dfn class="local col0 decl" id="240error" title='error' data-type='int' data-ref="240error" data-ref-filename="240error"><dfn class="local col7 decl" id="257error" title='error' data-type='int' data-ref="257error" data-ref-filename="257error"><dfn class="local col9 decl" id="309error" title='error' data-type='int' data-ref="309error" data-ref-filename="309error"><dfn class="local col8 decl" id="348error" title='error' data-type='int' data-ref="348error" data-ref-filename="348error"><dfn class="local col8 decl" id="358error" title='error' data-type='int' data-ref="358error" data-ref-filename="358error"><dfn class="local col9 decl" id="369error" title='error' data-type='int' data-ref="369error" data-ref-filename="369error">error</dfn></dfn></dfn></dfn></dfn></dfn></dfn></dfn></dfn></dfn></u></td></tr>
<tr><th id="79">79</th><td></td></tr>
<tr><th id="80">80</th><td><u>#define <dfn class="macro" id="_M/DECL_NO_OUT" data-ref="_M/DECL_NO_OUT">DECL_NO_OUT</dfn>(name)				\</u></td></tr>
<tr><th id="81">81</th><td><u>    struct name ## _in *<dfn class="local col0 decl" id="160inp" title='inp' data-type='struct coda_close_in *' data-ref="160inp" data-ref-filename="160inp"><dfn class="local col4 decl" id="194inp" title='inp' data-type='struct coda_setattr_in *' data-ref="194inp" data-ref-filename="194inp"><dfn class="local col3 decl" id="203inp" title='inp' data-type='struct coda_access_in *' data-ref="203inp" data-ref-filename="203inp"><dfn class="local col4 decl" id="224inp" title='inp' data-type='struct coda_fsync_in *' data-ref="224inp" data-ref-filename="224inp"><dfn class="local col5 decl" id="265inp" title='inp' data-type='struct coda_remove_in *' data-ref="265inp" data-ref-filename="265inp"><dfn class="local col7 decl" id="277inp" title='inp' data-type='struct coda_link_in *' data-ref="277inp" data-ref-filename="277inp"><dfn class="local col1 decl" id="291inp" title='inp' data-type='struct coda_rename_in *' data-ref="291inp" data-ref-filename="291inp"><dfn class="local col7 decl" id="317inp" title='inp' data-type='struct coda_rmdir_in *' data-ref="317inp" data-ref-filename="317inp"><dfn class="local col1 decl" id="331inp" title='inp' data-type='struct coda_symlink_in *' data-ref="331inp" data-ref-filename="331inp">inp</dfn></dfn></dfn></dfn></dfn></dfn></dfn></dfn></dfn>;				\</u></td></tr>
<tr><th id="82">82</th><td><u>    int name ## _size = sizeof (struct name ## _in);	\</u></td></tr>
<tr><th id="83">83</th><td><u>    int <dfn class="local col1 decl" id="161Isize" title='Isize' data-type='int' data-ref="161Isize" data-ref-filename="161Isize"><dfn class="local col5 decl" id="195Isize" title='Isize' data-type='int' data-ref="195Isize" data-ref-filename="195Isize"><dfn class="local col4 decl" id="204Isize" title='Isize' data-type='int' data-ref="204Isize" data-ref-filename="204Isize"><dfn class="local col5 decl" id="225Isize" title='Isize' data-type='int' data-ref="225Isize" data-ref-filename="225Isize"><dfn class="local col6 decl" id="266Isize" title='Isize' data-type='int' data-ref="266Isize" data-ref-filename="266Isize"><dfn class="local col8 decl" id="278Isize" title='Isize' data-type='int' data-ref="278Isize" data-ref-filename="278Isize"><dfn class="local col2 decl" id="292Isize" title='Isize' data-type='int' data-ref="292Isize" data-ref-filename="292Isize"><dfn class="local col8 decl" id="318Isize" title='Isize' data-type='int' data-ref="318Isize" data-ref-filename="318Isize"><dfn class="local col2 decl" id="332Isize" title='Isize' data-type='int' data-ref="332Isize" data-ref-filename="332Isize">Isize</dfn></dfn></dfn></dfn></dfn></dfn></dfn></dfn></dfn> = sizeof (struct name ## _in);		\</u></td></tr>
<tr><th id="84">84</th><td><u>    int <dfn class="local col2 decl" id="162Osize" title='Osize' data-type='int' data-ref="162Osize" data-ref-filename="162Osize"><dfn class="local col6 decl" id="196Osize" title='Osize' data-type='int' data-ref="196Osize" data-ref-filename="196Osize"><dfn class="local col5 decl" id="205Osize" title='Osize' data-type='int' data-ref="205Osize" data-ref-filename="205Osize"><dfn class="local col6 decl" id="226Osize" title='Osize' data-type='int' data-ref="226Osize" data-ref-filename="226Osize"><dfn class="local col7 decl" id="267Osize" title='Osize' data-type='int' data-ref="267Osize" data-ref-filename="267Osize"><dfn class="local col9 decl" id="279Osize" title='Osize' data-type='int' data-ref="279Osize" data-ref-filename="279Osize"><dfn class="local col3 decl" id="293Osize" title='Osize' data-type='int' data-ref="293Osize" data-ref-filename="293Osize"><dfn class="local col9 decl" id="319Osize" title='Osize' data-type='int' data-ref="319Osize" data-ref-filename="319Osize"><dfn class="local col3 decl" id="333Osize" title='Osize' data-type='int' data-ref="333Osize" data-ref-filename="333Osize">Osize</dfn></dfn></dfn></dfn></dfn></dfn></dfn></dfn></dfn> = sizeof (struct <a class="type" href="coda.h.html#coda_out_hdr" title='coda_out_hdr' data-ref="coda_out_hdr" data-ref-filename="coda_out_hdr">coda_out_hdr</a>);		\</u></td></tr>
<tr><th id="85">85</th><td><u>    int <dfn class="local col3 decl" id="163error" title='error' data-type='int' data-ref="163error" data-ref-filename="163error"><dfn class="local col7 decl" id="197error" title='error' data-type='int' data-ref="197error" data-ref-filename="197error"><dfn class="local col6 decl" id="206error" title='error' data-type='int' data-ref="206error" data-ref-filename="206error"><dfn class="local col7 decl" id="227error" title='error' data-type='int' data-ref="227error" data-ref-filename="227error"><dfn class="local col8 decl" id="268error" title='error' data-type='int' data-ref="268error" data-ref-filename="268error"><dfn class="local col0 decl" id="280error" title='error' data-type='int' data-ref="280error" data-ref-filename="280error"><dfn class="local col4 decl" id="294error" title='error' data-type='int' data-ref="294error" data-ref-filename="294error"><dfn class="local col0 decl" id="320error" title='error' data-type='int' data-ref="320error" data-ref-filename="320error"><dfn class="local col4 decl" id="334error" title='error' data-type='int' data-ref="334error" data-ref-filename="334error">error</dfn></dfn></dfn></dfn></dfn></dfn></dfn></dfn></dfn></u></td></tr>
<tr><th id="86">86</th><td></td></tr>
<tr><th id="87">87</th><td><u>#define <dfn class="macro" id="_M/ALLOC_NO_IN" data-ref="_M/ALLOC_NO_IN">ALLOC_NO_IN</dfn>(name)				\</u></td></tr>
<tr><th id="88">88</th><td><u>    if (<a class="local col9 ref" href="#207" title='Osize' data-ref="139Osize" data-ref-filename="139Osize">Osize</a> &gt; name ## _size)				\</u></td></tr>
<tr><th id="89">89</th><td><u>    	name ## _size = <a class="local col9 ref" href="#207" title='Osize' data-ref="139Osize" data-ref-filename="139Osize">Osize</a>;				\</u></td></tr>
<tr><th id="90">90</th><td><u>    CODA_ALLOC(<a class="local col6 ref" href="#207" title='inp' data-ref="136inp" data-ref-filename="136inp">inp</a>, struct <a class="type" href="coda.h.html#coda_in_hdr" title='coda_in_hdr' data-ref="coda_in_hdr" data-ref-filename="coda_in_hdr">coda_in_hdr</a> *, name ## _size);\</u></td></tr>
<tr><th id="91">91</th><td><u>    <a class="local col7 ref" href="#207" title='outp' data-ref="137outp" data-ref-filename="137outp">outp</a> = (struct name ## _out *) <a class="local col6 ref" href="#207" title='inp' data-ref="136inp" data-ref-filename="136inp">inp</a></u></td></tr>
<tr><th id="92">92</th><td></td></tr>
<tr><th id="93">93</th><td><u>#define <dfn class="macro" id="_M/ALLOC" data-ref="_M/ALLOC">ALLOC</dfn>(name)					\</u></td></tr>
<tr><th id="94">94</th><td><u>    if (<a class="local col2 ref" href="#227" title='Osize' data-ref="152Osize" data-ref-filename="152Osize"><a class="local col4 ref" href="#289" title='Osize' data-ref="174Osize" data-ref-filename="174Osize"><a class="local col7 ref" href="#345" title='Osize' data-ref="187Osize" data-ref-filename="187Osize"><a class="local col6 ref" href="#402" title='Osize' data-ref="216Osize" data-ref-filename="216Osize"><a class="local col9 ref" href="#477" title='Osize' data-ref="239Osize" data-ref-filename="239Osize"><a class="local col6 ref" href="#516" title='Osize' data-ref="256Osize" data-ref-filename="256Osize"><a class="local col8 ref" href="#618" title='Osize' data-ref="308Osize" data-ref-filename="308Osize"><a class="local col7 ref" href="#695" title='Osize' data-ref="347Osize" data-ref-filename="347Osize"><a class="local col7 ref" href="#721" title='Osize' data-ref="357Osize" data-ref-filename="357Osize"><a class="local col8 ref" href="#742" title='Osize' data-ref="368Osize" data-ref-filename="368Osize">Osize</a></a></a></a></a></a></a></a></a></a> &gt; name ## _size)				\</u></td></tr>
<tr><th id="95">95</th><td><u>    	name ## _size = <a class="local col2 ref" href="#227" title='Osize' data-ref="152Osize" data-ref-filename="152Osize"><a class="local col4 ref" href="#289" title='Osize' data-ref="174Osize" data-ref-filename="174Osize"><a class="local col7 ref" href="#345" title='Osize' data-ref="187Osize" data-ref-filename="187Osize"><a class="local col6 ref" href="#402" title='Osize' data-ref="216Osize" data-ref-filename="216Osize"><a class="local col9 ref" href="#477" title='Osize' data-ref="239Osize" data-ref-filename="239Osize"><a class="local col6 ref" href="#516" title='Osize' data-ref="256Osize" data-ref-filename="256Osize"><a class="local col8 ref" href="#618" title='Osize' data-ref="308Osize" data-ref-filename="308Osize"><a class="local col7 ref" href="#695" title='Osize' data-ref="347Osize" data-ref-filename="347Osize"><a class="local col7 ref" href="#721" title='Osize' data-ref="357Osize" data-ref-filename="357Osize"><a class="local col8 ref" href="#742" title='Osize' data-ref="368Osize" data-ref-filename="368Osize">Osize</a></a></a></a></a></a></a></a></a></a>;				\</u></td></tr>
<tr><th id="96">96</th><td><u>    CODA_ALLOC(<a class="local col9 ref" href="#227" title='inp' data-ref="149inp" data-ref-filename="149inp"><a class="local col1 ref" href="#289" title='inp' data-ref="171inp" data-ref-filename="171inp"><a class="local col1 ref" href="#289" title='inp' data-ref="171inp" data-ref-filename="171inp"><a class="local col4 ref" href="#345" title='inp' data-ref="184inp" data-ref-filename="184inp"><a class="local col4 ref" href="#345" title='inp' data-ref="184inp" data-ref-filename="184inp"><a class="local col3 ref" href="#402" title='inp' data-ref="213inp" data-ref-filename="213inp"><a class="local col3 ref" href="#402" title='inp' data-ref="213inp" data-ref-filename="213inp"><a class="local col6 ref" href="#477" title='inp' data-ref="236inp" data-ref-filename="236inp"><a class="local col6 ref" href="#477" title='inp' data-ref="236inp" data-ref-filename="236inp"><a class="local col3 ref" href="#516" title='inp' data-ref="253inp" data-ref-filename="253inp"><a class="local col3 ref" href="#516" title='inp' data-ref="253inp" data-ref-filename="253inp"><a class="local col5 ref" href="#618" title='inp' data-ref="305inp" data-ref-filename="305inp"><a class="local col5 ref" href="#618" title='inp' data-ref="305inp" data-ref-filename="305inp"><a class="local col4 ref" href="#695" title='inp' data-ref="344inp" data-ref-filename="344inp"><a class="local col4 ref" href="#695" title='inp' data-ref="344inp" data-ref-filename="344inp"><a class="local col4 ref" href="#721" title='inp' data-ref="354inp" data-ref-filename="354inp"><a class="local col4 ref" href="#721" title='inp' data-ref="354inp" data-ref-filename="354inp"><a class="local col5 ref" href="#742" title='inp' data-ref="365inp" data-ref-filename="365inp"><a class="local col5 ref" href="#742" title='inp' data-ref="365inp" data-ref-filename="365inp">inp</a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a>, struct name ## _in *, name ## _size);\</u></td></tr>
<tr><th id="97">97</th><td><u>    <a class="local col0 ref" href="#227" title='outp' data-ref="150outp" data-ref-filename="150outp"><a class="local col2 ref" href="#289" title='outp' data-ref="172outp" data-ref-filename="172outp"><a class="local col5 ref" href="#345" title='outp' data-ref="185outp" data-ref-filename="185outp"><a class="local col4 ref" href="#402" title='outp' data-ref="214outp" data-ref-filename="214outp"><a class="local col7 ref" href="#477" title='outp' data-ref="237outp" data-ref-filename="237outp"><a class="local col4 ref" href="#516" title='outp' data-ref="254outp" data-ref-filename="254outp"><a class="local col6 ref" href="#618" title='outp' data-ref="306outp" data-ref-filename="306outp"><a class="local col5 ref" href="#695" title='outp' data-ref="345outp" data-ref-filename="345outp"><a class="local col5 ref" href="#721" title='outp' data-ref="355outp" data-ref-filename="355outp"><a class="local col6 ref" href="#742" title='outp' data-ref="366outp" data-ref-filename="366outp">outp</a></a></a></a></a></a></a></a></a></a> = (struct name ## _out *) <a class="local col9 ref" href="#227" title='inp' data-ref="149inp" data-ref-filename="149inp"><a class="local col1 ref" href="#289" title='inp' data-ref="171inp" data-ref-filename="171inp"><a class="local col4 ref" href="#345" title='inp' data-ref="184inp" data-ref-filename="184inp"><a class="local col3 ref" href="#402" title='inp' data-ref="213inp" data-ref-filename="213inp"><a class="local col6 ref" href="#477" title='inp' data-ref="236inp" data-ref-filename="236inp"><a class="local col3 ref" href="#516" title='inp' data-ref="253inp" data-ref-filename="253inp"><a class="local col5 ref" href="#618" title='inp' data-ref="305inp" data-ref-filename="305inp"><a class="local col4 ref" href="#695" title='inp' data-ref="344inp" data-ref-filename="344inp"><a class="local col4 ref" href="#721" title='inp' data-ref="354inp" data-ref-filename="354inp"><a class="local col5 ref" href="#742" title='inp' data-ref="365inp" data-ref-filename="365inp">inp</a></a></a></a></a></a></a></a></a></a></u></td></tr>
<tr><th id="98">98</th><td></td></tr>
<tr><th id="99">99</th><td><u>#define <dfn class="macro" id="_M/ALLOC_NO_OUT" data-ref="_M/ALLOC_NO_OUT">ALLOC_NO_OUT</dfn>(name)				\</u></td></tr>
<tr><th id="100">100</th><td><u>    if (<a class="local col2 ref" href="#252" title='Osize' data-ref="162Osize" data-ref-filename="162Osize"><a class="local col6 ref" href="#365" title='Osize' data-ref="196Osize" data-ref-filename="196Osize"><a class="local col5 ref" href="#383" title='Osize' data-ref="205Osize" data-ref-filename="205Osize"><a class="local col6 ref" href="#458" title='Osize' data-ref="226Osize" data-ref-filename="226Osize"><a class="local col7 ref" href="#546" title='Osize' data-ref="267Osize" data-ref-filename="267Osize"><a class="local col9 ref" href="#568" title='Osize' data-ref="279Osize" data-ref-filename="279Osize"><a class="local col3 ref" href="#591" title='Osize' data-ref="293Osize" data-ref-filename="293Osize"><a class="local col9 ref" href="#646" title='Osize' data-ref="319Osize" data-ref-filename="319Osize"><a class="local col3 ref" href="#668" title='Osize' data-ref="333Osize" data-ref-filename="333Osize">Osize</a></a></a></a></a></a></a></a></a> &gt; name ## _size)				\</u></td></tr>
<tr><th id="101">101</th><td><u>    	name ## _size = <a class="local col2 ref" href="#252" title='Osize' data-ref="162Osize" data-ref-filename="162Osize"><a class="local col6 ref" href="#365" title='Osize' data-ref="196Osize" data-ref-filename="196Osize"><a class="local col5 ref" href="#383" title='Osize' data-ref="205Osize" data-ref-filename="205Osize"><a class="local col6 ref" href="#458" title='Osize' data-ref="226Osize" data-ref-filename="226Osize"><a class="local col7 ref" href="#546" title='Osize' data-ref="267Osize" data-ref-filename="267Osize"><a class="local col9 ref" href="#568" title='Osize' data-ref="279Osize" data-ref-filename="279Osize"><a class="local col3 ref" href="#591" title='Osize' data-ref="293Osize" data-ref-filename="293Osize"><a class="local col9 ref" href="#646" title='Osize' data-ref="319Osize" data-ref-filename="319Osize"><a class="local col3 ref" href="#668" title='Osize' data-ref="333Osize" data-ref-filename="333Osize">Osize</a></a></a></a></a></a></a></a></a>;				\</u></td></tr>
<tr><th id="102">102</th><td><u>    CODA_ALLOC(<a class="local col0 ref" href="#252" title='inp' data-ref="160inp" data-ref-filename="160inp"><a class="local col4 ref" href="#365" title='inp' data-ref="194inp" data-ref-filename="194inp"><a class="local col4 ref" href="#365" title='inp' data-ref="194inp" data-ref-filename="194inp"><a class="local col3 ref" href="#383" title='inp' data-ref="203inp" data-ref-filename="203inp"><a class="local col3 ref" href="#383" title='inp' data-ref="203inp" data-ref-filename="203inp"><a class="local col4 ref" href="#458" title='inp' data-ref="224inp" data-ref-filename="224inp"><a class="local col4 ref" href="#458" title='inp' data-ref="224inp" data-ref-filename="224inp"><a class="local col5 ref" href="#546" title='inp' data-ref="265inp" data-ref-filename="265inp"><a class="local col5 ref" href="#546" title='inp' data-ref="265inp" data-ref-filename="265inp"><a class="local col7 ref" href="#568" title='inp' data-ref="277inp" data-ref-filename="277inp"><a class="local col7 ref" href="#568" title='inp' data-ref="277inp" data-ref-filename="277inp"><a class="local col1 ref" href="#591" title='inp' data-ref="291inp" data-ref-filename="291inp"><a class="local col1 ref" href="#591" title='inp' data-ref="291inp" data-ref-filename="291inp"><a class="local col7 ref" href="#646" title='inp' data-ref="317inp" data-ref-filename="317inp"><a class="local col7 ref" href="#646" title='inp' data-ref="317inp" data-ref-filename="317inp"><a class="local col1 ref" href="#668" title='inp' data-ref="331inp" data-ref-filename="331inp"><a class="local col1 ref" href="#668" title='inp' data-ref="331inp" data-ref-filename="331inp">inp</a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a>, struct name ## _in *, name ## _size);</u>\</td></tr>
<tr><th id="103">103</th><td></td></tr>
<tr><th id="104">104</th><td><u>#define <dfn class="macro" id="_M/STRCPY" data-ref="_M/STRCPY">STRCPY</dfn>(struc, name, len) \</u></td></tr>
<tr><th id="105">105</th><td><u>    memcpy((char *)<a class="local col6 ref" href="#477" title='inp' data-ref="236inp" data-ref-filename="236inp"><a class="local col3 ref" href="#516" title='inp' data-ref="253inp" data-ref-filename="253inp"><a class="local col5 ref" href="#546" title='inp' data-ref="265inp" data-ref-filename="265inp"><a class="local col7 ref" href="#568" title='inp' data-ref="277inp" data-ref-filename="277inp"><a class="local col1 ref" href="#591" title='inp' data-ref="291inp" data-ref-filename="291inp"><a class="local col1 ref" href="#591" title='inp' data-ref="291inp" data-ref-filename="291inp"><a class="local col5 ref" href="#618" title='inp' data-ref="305inp" data-ref-filename="305inp"><a class="local col7 ref" href="#646" title='inp' data-ref="317inp" data-ref-filename="317inp"><a class="local col1 ref" href="#668" title='inp' data-ref="331inp" data-ref-filename="331inp"><a class="local col1 ref" href="#668" title='inp' data-ref="331inp" data-ref-filename="331inp">inp</a></a></a></a></a></a></a></a></a></a> + (int)<a class="local col6 ref" href="#477" title='inp' data-ref="236inp" data-ref-filename="236inp"><a class="local col3 ref" href="#516" title='inp' data-ref="253inp" data-ref-filename="253inp"><a class="local col5 ref" href="#546" title='inp' data-ref="265inp" data-ref-filename="265inp"><a class="local col7 ref" href="#568" title='inp' data-ref="277inp" data-ref-filename="277inp"><a class="local col1 ref" href="#591" title='inp' data-ref="291inp" data-ref-filename="291inp"><a class="local col1 ref" href="#591" title='inp' data-ref="291inp" data-ref-filename="291inp"><a class="local col5 ref" href="#618" title='inp' data-ref="305inp" data-ref-filename="305inp"><a class="local col7 ref" href="#646" title='inp' data-ref="317inp" data-ref-filename="317inp"><a class="local col1 ref" href="#668" title='inp' data-ref="331inp" data-ref-filename="331inp"><a class="local col1 ref" href="#668" title='inp' data-ref="331inp" data-ref-filename="331inp">inp</a></a></a></a></a></a></a></a></a></a>-&gt;struc, name, len); \</u></td></tr>
<tr><th id="106">106</th><td><u>    ((char*)<a class="local col6 ref" href="#477" title='inp' data-ref="236inp" data-ref-filename="236inp"><a class="local col3 ref" href="#516" title='inp' data-ref="253inp" data-ref-filename="253inp"><a class="local col5 ref" href="#546" title='inp' data-ref="265inp" data-ref-filename="265inp"><a class="local col7 ref" href="#568" title='inp' data-ref="277inp" data-ref-filename="277inp"><a class="local col1 ref" href="#591" title='inp' data-ref="291inp" data-ref-filename="291inp"><a class="local col1 ref" href="#591" title='inp' data-ref="291inp" data-ref-filename="291inp"><a class="local col5 ref" href="#618" title='inp' data-ref="305inp" data-ref-filename="305inp"><a class="local col7 ref" href="#646" title='inp' data-ref="317inp" data-ref-filename="317inp"><a class="local col1 ref" href="#668" title='inp' data-ref="331inp" data-ref-filename="331inp"><a class="local col1 ref" href="#668" title='inp' data-ref="331inp" data-ref-filename="331inp">inp</a></a></a></a></a></a></a></a></a></a> + (int)<a class="local col6 ref" href="#477" title='inp' data-ref="236inp" data-ref-filename="236inp"><a class="local col3 ref" href="#516" title='inp' data-ref="253inp" data-ref-filename="253inp"><a class="local col5 ref" href="#546" title='inp' data-ref="265inp" data-ref-filename="265inp"><a class="local col7 ref" href="#568" title='inp' data-ref="277inp" data-ref-filename="277inp"><a class="local col1 ref" href="#591" title='inp' data-ref="291inp" data-ref-filename="291inp"><a class="local col1 ref" href="#591" title='inp' data-ref="291inp" data-ref-filename="291inp"><a class="local col5 ref" href="#618" title='inp' data-ref="305inp" data-ref-filename="305inp"><a class="local col7 ref" href="#646" title='inp' data-ref="317inp" data-ref-filename="317inp"><a class="local col1 ref" href="#668" title='inp' data-ref="331inp" data-ref-filename="331inp"><a class="local col1 ref" href="#668" title='inp' data-ref="331inp" data-ref-filename="331inp">inp</a></a></a></a></a></a></a></a></a></a>-&gt;struc)[len++] = 0; \</u></td></tr>
<tr><th id="107">107</th><td><u>    <a class="local col8 ref" href="#477" title='Isize' data-ref="238Isize" data-ref-filename="238Isize"><a class="local col5 ref" href="#516" title='Isize' data-ref="255Isize" data-ref-filename="255Isize"><a class="local col6 ref" href="#546" title='Isize' data-ref="266Isize" data-ref-filename="266Isize"><a class="local col8 ref" href="#568" title='Isize' data-ref="278Isize" data-ref-filename="278Isize"><a class="local col2 ref" href="#591" title='Isize' data-ref="292Isize" data-ref-filename="292Isize"><a class="local col2 ref" href="#591" title='Isize' data-ref="292Isize" data-ref-filename="292Isize"><a class="local col7 ref" href="#618" title='Isize' data-ref="307Isize" data-ref-filename="307Isize"><a class="local col8 ref" href="#646" title='Isize' data-ref="318Isize" data-ref-filename="318Isize"><a class="local col2 ref" href="#668" title='Isize' data-ref="332Isize" data-ref-filename="332Isize"><a class="local col2 ref" href="#668" title='Isize' data-ref="332Isize" data-ref-filename="332Isize">Isize</a></a></a></a></a></a></a></a></a></a> += len</u></td></tr>
<tr><th id="108">108</th><td><i>/* XXX verify that Isize has not overrun available storage */</i></td></tr>
<tr><th id="109">109</th><td></td></tr>
<tr><th id="110">110</th><td><u>#<span data-ppcond="110">ifdef</span> <span class="macro" data-ref="_M/CODA_COMPAT_5">CODA_COMPAT_5</span></u></td></tr>
<tr><th id="111">111</th><td></td></tr>
<tr><th id="112">112</th><td><u>#define INIT_IN(in, op, ident, p) \</u></td></tr>
<tr><th id="113">113</th><td><u>	  (in)-&gt;opcode = (op); \</u></td></tr>
<tr><th id="114">114</th><td><u>	  (in)-&gt;pid = p ? p-&gt;p_pid : -1; \</u></td></tr>
<tr><th id="115">115</th><td><u>          (in)-&gt;pgid = p ? p-&gt;p_pgid : -1; \</u></td></tr>
<tr><th id="116">116</th><td><u>          (in)-&gt;sid = (p &amp;&amp; p-&gt;p_session &amp;&amp; p-&gt;p_session-&gt;s_leader) ? \</u></td></tr>
<tr><th id="117">117</th><td><u>		(p-&gt;p_session-&gt;s_leader-&gt;p_pid) : -1; \</u></td></tr>
<tr><th id="118">118</th><td><u>	  KASSERT(cred != NULL); \</u></td></tr>
<tr><th id="119">119</th><td><u>	  KASSERT(cred != FSCRED); \</u></td></tr>
<tr><th id="120">120</th><td><u>          if (ident != NOCRED) {                              \</u></td></tr>
<tr><th id="121">121</th><td><u>	      (in)-&gt;cred.cr_uid = kauth_cred_geteuid(ident);              \</u></td></tr>
<tr><th id="122">122</th><td><u>	      (in)-&gt;cred.cr_groupid = kauth_cred_getegid(ident);          \</u></td></tr>
<tr><th id="123">123</th><td><u>          } else {                                            \</u></td></tr>
<tr><th id="124">124</th><td><u>	      memset(&amp;((in)-&gt;cred), 0, sizeof(struct coda_cred)); \</u></td></tr>
<tr><th id="125">125</th><td><u>	      (in)-&gt;cred.cr_uid = -1;                         \</u></td></tr>
<tr><th id="126">126</th><td><u>	      (in)-&gt;cred.cr_groupid = -1;                     \</u></td></tr>
<tr><th id="127">127</th><td><u>          }</u>                                                   \</td></tr>
<tr><th id="128">128</th><td></td></tr>
<tr><th id="129">129</th><td><u>#<span data-ppcond="110">else</span></u></td></tr>
<tr><th id="130">130</th><td></td></tr>
<tr><th id="131">131</th><td><u>#define <dfn class="macro" id="_M/INIT_IN" data-ref="_M/INIT_IN">INIT_IN</dfn>(in, op, ident, p) 		\</u></td></tr>
<tr><th id="132">132</th><td><u>	  (in)-&gt;<a class="ref field" href="coda.h.html#coda_in_hdr::opcode" title='coda_in_hdr::opcode' data-ref="coda_in_hdr::opcode" data-ref-filename="coda_in_hdr..opcode">opcode</a> = (op); 			\</u></td></tr>
<tr><th id="133">133</th><td><u>	  (in)-&gt;<a class="ref field" href="coda.h.html#coda_in_hdr::pid" title='coda_in_hdr::pid' data-ref="coda_in_hdr::pid" data-ref-filename="coda_in_hdr..pid">pid</a> = p ? p-&gt;<a class="ref field" href="../sys/proc.h.html#proc::p_pid" title='proc::p_pid' data-ref="proc::p_pid" data-ref-filename="proc..p_pid">p_pid</a> : -1;        \</u></td></tr>
<tr><th id="134">134</th><td><u>          (in)-&gt;<a class="ref field" href="coda.h.html#coda_in_hdr::pgid" title='coda_in_hdr::pgid' data-ref="coda_in_hdr::pgid" data-ref-filename="coda_in_hdr..pgid">pgid</a> = p ? p-&gt;p_pgid : -1;	\</u></td></tr>
<tr><th id="135">135</th><td><u>	  KASSERT(<a class="local col3 ref" href="#133cred" title='cred' data-ref="133cred" data-ref-filename="133cred"><a class="local col4 ref" href="#144cred" title='cred' data-ref="144cred" data-ref-filename="144cred"><a class="local col7 ref" href="#157cred" title='cred' data-ref="157cred" data-ref-filename="157cred"><a class="local col9 ref" href="#169cred" title='cred' data-ref="169cred" data-ref-filename="169cred"><a class="local col1 ref" href="#181cred" title='cred' data-ref="181cred" data-ref-filename="181cred"><a class="local col2 ref" href="#192cred" title='cred' data-ref="192cred" data-ref-filename="192cred"><a class="local col1 ref" href="#201cred" title='cred' data-ref="201cred" data-ref-filename="201cred"><a class="local col9 ref" href="#209cred" title='cred' data-ref="209cred" data-ref-filename="209cred"><a class="local col2 ref" href="#222cred" title='cred' data-ref="222cred" data-ref-filename="222cred"><a class="local col2 ref" href="#232cred" title='cred' data-ref="232cred" data-ref-filename="232cred"><a class="local col9 ref" href="#249cred" title='cred' data-ref="249cred" data-ref-filename="249cred"><a class="local col3 ref" href="#263cred" title='cred' data-ref="263cred" data-ref-filename="263cred"><a class="local col5 ref" href="#275cred" title='cred' data-ref="275cred" data-ref-filename="275cred"><a class="local col9 ref" href="#289cred" title='cred' data-ref="289cred" data-ref-filename="289cred"><a class="local col1 ref" href="#301cred" title='cred' data-ref="301cred" data-ref-filename="301cred"><a class="local col5 ref" href="#315cred" title='cred' data-ref="315cred" data-ref-filename="315cred"><a class="local col9 ref" href="#329cred" title='cred' data-ref="329cred" data-ref-filename="329cred"><a class="local col0 ref" href="#340cred" title='cred' data-ref="340cred" data-ref-filename="340cred"><a class="local col1 ref" href="#351cred" title='cred' data-ref="351cred" data-ref-filename="351cred"><a class="local col1 ref" href="#361cred" title='cred' data-ref="361cred" data-ref-filename="361cred">cred</a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a> != NULL); \</u></td></tr>
<tr><th id="136">136</th><td><u>	  KASSERT(<a class="local col3 ref" href="#133cred" title='cred' data-ref="133cred" data-ref-filename="133cred"><a class="local col4 ref" href="#144cred" title='cred' data-ref="144cred" data-ref-filename="144cred"><a class="local col7 ref" href="#157cred" title='cred' data-ref="157cred" data-ref-filename="157cred"><a class="local col9 ref" href="#169cred" title='cred' data-ref="169cred" data-ref-filename="169cred"><a class="local col1 ref" href="#181cred" title='cred' data-ref="181cred" data-ref-filename="181cred"><a class="local col2 ref" href="#192cred" title='cred' data-ref="192cred" data-ref-filename="192cred"><a class="local col1 ref" href="#201cred" title='cred' data-ref="201cred" data-ref-filename="201cred"><a class="local col9 ref" href="#209cred" title='cred' data-ref="209cred" data-ref-filename="209cred"><a class="local col2 ref" href="#222cred" title='cred' data-ref="222cred" data-ref-filename="222cred"><a class="local col2 ref" href="#232cred" title='cred' data-ref="232cred" data-ref-filename="232cred"><a class="local col9 ref" href="#249cred" title='cred' data-ref="249cred" data-ref-filename="249cred"><a class="local col3 ref" href="#263cred" title='cred' data-ref="263cred" data-ref-filename="263cred"><a class="local col5 ref" href="#275cred" title='cred' data-ref="275cred" data-ref-filename="275cred"><a class="local col9 ref" href="#289cred" title='cred' data-ref="289cred" data-ref-filename="289cred"><a class="local col1 ref" href="#301cred" title='cred' data-ref="301cred" data-ref-filename="301cred"><a class="local col5 ref" href="#315cred" title='cred' data-ref="315cred" data-ref-filename="315cred"><a class="local col9 ref" href="#329cred" title='cred' data-ref="329cred" data-ref-filename="329cred"><a class="local col0 ref" href="#340cred" title='cred' data-ref="340cred" data-ref-filename="340cred"><a class="local col1 ref" href="#351cred" title='cred' data-ref="351cred" data-ref-filename="351cred"><a class="local col1 ref" href="#361cred" title='cred' data-ref="361cred" data-ref-filename="361cred">cred</a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a> != FSCRED); \</u></td></tr>
<tr><th id="137">137</th><td><u>          if (ident != NOCRED) {                \</u></td></tr>
<tr><th id="138">138</th><td><u>	      (in)-&gt;<a class="ref field" href="coda.h.html#coda_in_hdr::uid" title='coda_in_hdr::uid' data-ref="coda_in_hdr::uid" data-ref-filename="coda_in_hdr..uid">uid</a> = <a class="ref fn" href="../sys/kauth.h.html#kauth_cred_geteuid" title='kauth_cred_geteuid' data-ref="kauth_cred_geteuid" data-ref-filename="kauth_cred_geteuid">kauth_cred_geteuid</a>(ident);        \</u></td></tr>
<tr><th id="139">139</th><td><u>          } else {                              \</u></td></tr>
<tr><th id="140">140</th><td><u>	      (in)-&gt;<a class="ref field" href="coda.h.html#coda_in_hdr::uid" title='coda_in_hdr::uid' data-ref="coda_in_hdr::uid" data-ref-filename="coda_in_hdr..uid">uid</a> = -1;                   \</u></td></tr>
<tr><th id="141">141</th><td><u>          }</u>                                                   \</td></tr>
<tr><th id="142">142</th><td></td></tr>
<tr><th id="143">143</th><td><u>#<span data-ppcond="110">endif</span></u></td></tr>
<tr><th id="144">144</th><td></td></tr>
<tr><th id="145">145</th><td><u>#define <dfn class="macro" id="_M/INIT_IN_L" data-ref="_M/INIT_IN_L">INIT_IN_L</dfn>(in, op, ident, l)		\</u></td></tr>
<tr><th id="146">146</th><td><u>	INIT_IN(in, op, ident, (l ? l-&gt;<a class="ref field" href="../sys/lwp.h.html#lwp::l_proc" title='lwp::l_proc' data-ref="lwp::l_proc" data-ref-filename="lwp..l_proc">l_proc</a> : NULL))</u></td></tr>
<tr><th id="147">147</th><td></td></tr>
<tr><th id="148">148</th><td><u>#define	<dfn class="macro" id="_M/CNV_OFLAG" data-ref="_M/CNV_OFLAG">CNV_OFLAG</dfn>(to, from) 				\</u></td></tr>
<tr><th id="149">149</th><td><u>    do { 						\</u></td></tr>
<tr><th id="150">150</th><td><u>	  to = 0;					\</u></td></tr>
<tr><th id="151">151</th><td><u>	  if (from &amp; FREAD)   to |= C_O_READ; 		\</u></td></tr>
<tr><th id="152">152</th><td><u>	  if (from &amp; FWRITE)  to |= C_O_WRITE; 		\</u></td></tr>
<tr><th id="153">153</th><td><u>	  if (from &amp; O_TRUNC) to |= C_O_TRUNC; 		\</u></td></tr>
<tr><th id="154">154</th><td><u>	  if (from &amp; O_EXCL)  to |= C_O_EXCL; 		\</u></td></tr>
<tr><th id="155">155</th><td><u>	  if (from &amp; O_CREAT) to |= C_O_CREAT;		\</u></td></tr>
<tr><th id="156">156</th><td><u>    } while (/*CONSTCOND*/ 0)</u></td></tr>
<tr><th id="157">157</th><td></td></tr>
<tr><th id="158">158</th><td><u>#define <dfn class="macro" id="_M/CNV_VV2V_ATTR" data-ref="_M/CNV_VV2V_ATTR">CNV_VV2V_ATTR</dfn>(top, fromp) \</u></td></tr>
<tr><th id="159">159</th><td><u>	do { \</u></td></tr>
<tr><th id="160">160</th><td><u>		(top)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_type" title='vattr::va_type' data-ref="vattr::va_type" data-ref-filename="vattr..va_type">va_type</a> = (fromp)-&gt;<a class="ref field" href="coda.h.html#coda_vattr::va_type" title='coda_vattr::va_type' data-ref="coda_vattr::va_type" data-ref-filename="coda_vattr..va_type">va_type</a>; \</u></td></tr>
<tr><th id="161">161</th><td><u>		(top)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_mode" title='vattr::va_mode' data-ref="vattr::va_mode" data-ref-filename="vattr..va_mode">va_mode</a> = (fromp)-&gt;<a class="ref field" href="coda.h.html#coda_vattr::va_mode" title='coda_vattr::va_mode' data-ref="coda_vattr::va_mode" data-ref-filename="coda_vattr..va_mode">va_mode</a>; \</u></td></tr>
<tr><th id="162">162</th><td><u>		(top)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_nlink" title='vattr::va_nlink' data-ref="vattr::va_nlink" data-ref-filename="vattr..va_nlink">va_nlink</a> = (fromp)-&gt;<a class="ref field" href="coda.h.html#coda_vattr::va_nlink" title='coda_vattr::va_nlink' data-ref="coda_vattr::va_nlink" data-ref-filename="coda_vattr..va_nlink">va_nlink</a>; \</u></td></tr>
<tr><th id="163">163</th><td><u>		(top)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_uid" title='vattr::va_uid' data-ref="vattr::va_uid" data-ref-filename="vattr..va_uid">va_uid</a> = (fromp)-&gt;<a class="ref field" href="coda.h.html#coda_vattr::va_uid" title='coda_vattr::va_uid' data-ref="coda_vattr::va_uid" data-ref-filename="coda_vattr..va_uid">va_uid</a>; \</u></td></tr>
<tr><th id="164">164</th><td><u>		(top)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_gid" title='vattr::va_gid' data-ref="vattr::va_gid" data-ref-filename="vattr..va_gid">va_gid</a> = (fromp)-&gt;<a class="ref field" href="coda.h.html#coda_vattr::va_gid" title='coda_vattr::va_gid' data-ref="coda_vattr::va_gid" data-ref-filename="coda_vattr..va_gid">va_gid</a>; \</u></td></tr>
<tr><th id="165">165</th><td><u>		(top)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_fsid" title='vattr::va_fsid' data-ref="vattr::va_fsid" data-ref-filename="vattr..va_fsid">va_fsid</a> = VNOVAL; \</u></td></tr>
<tr><th id="166">166</th><td><u>		(top)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_fileid" title='vattr::va_fileid' data-ref="vattr::va_fileid" data-ref-filename="vattr..va_fileid">va_fileid</a> = (fromp)-&gt;<a class="ref field" href="coda.h.html#coda_vattr::va_fileid" title='coda_vattr::va_fileid' data-ref="coda_vattr::va_fileid" data-ref-filename="coda_vattr..va_fileid">va_fileid</a>; \</u></td></tr>
<tr><th id="167">167</th><td><u>		(top)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_size" title='vattr::va_size' data-ref="vattr::va_size" data-ref-filename="vattr..va_size">va_size</a> = (fromp)-&gt;<a class="ref field" href="coda.h.html#coda_vattr::va_size" title='coda_vattr::va_size' data-ref="coda_vattr::va_size" data-ref-filename="coda_vattr..va_size">va_size</a>; \</u></td></tr>
<tr><th id="168">168</th><td><u>		(top)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_blocksize" title='vattr::va_blocksize' data-ref="vattr::va_blocksize" data-ref-filename="vattr..va_blocksize">va_blocksize</a> = (fromp)-&gt;<a class="ref field" href="coda.h.html#coda_vattr::va_blocksize" title='coda_vattr::va_blocksize' data-ref="coda_vattr::va_blocksize" data-ref-filename="coda_vattr..va_blocksize">va_blocksize</a>; \</u></td></tr>
<tr><th id="169">169</th><td><u>		(top)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_atime" title='vattr::va_atime' data-ref="vattr::va_atime" data-ref-filename="vattr..va_atime">va_atime</a> = (fromp)-&gt;<a class="ref field" href="coda.h.html#coda_vattr::va_atime" title='coda_vattr::va_atime' data-ref="coda_vattr::va_atime" data-ref-filename="coda_vattr..va_atime">va_atime</a>; \</u></td></tr>
<tr><th id="170">170</th><td><u>		(top)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_mtime" title='vattr::va_mtime' data-ref="vattr::va_mtime" data-ref-filename="vattr..va_mtime">va_mtime</a> = (fromp)-&gt;<a class="ref field" href="coda.h.html#coda_vattr::va_mtime" title='coda_vattr::va_mtime' data-ref="coda_vattr::va_mtime" data-ref-filename="coda_vattr..va_mtime">va_mtime</a>; \</u></td></tr>
<tr><th id="171">171</th><td><u>		(top)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_ctime" title='vattr::va_ctime' data-ref="vattr::va_ctime" data-ref-filename="vattr..va_ctime">va_ctime</a> = (fromp)-&gt;<a class="ref field" href="coda.h.html#coda_vattr::va_ctime" title='coda_vattr::va_ctime' data-ref="coda_vattr::va_ctime" data-ref-filename="coda_vattr..va_ctime">va_ctime</a>; \</u></td></tr>
<tr><th id="172">172</th><td><u>		(top)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_gen" title='vattr::va_gen' data-ref="vattr::va_gen" data-ref-filename="vattr..va_gen">va_gen</a> = (fromp)-&gt;<a class="ref field" href="coda.h.html#coda_vattr::va_gen" title='coda_vattr::va_gen' data-ref="coda_vattr::va_gen" data-ref-filename="coda_vattr..va_gen">va_gen</a>; \</u></td></tr>
<tr><th id="173">173</th><td><u>		(top)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_flags" title='vattr::va_flags' data-ref="vattr::va_flags" data-ref-filename="vattr..va_flags">va_flags</a> = (fromp)-&gt;<a class="ref field" href="coda.h.html#coda_vattr::va_flags" title='coda_vattr::va_flags' data-ref="coda_vattr::va_flags" data-ref-filename="coda_vattr..va_flags">va_flags</a>; \</u></td></tr>
<tr><th id="174">174</th><td><u>		(top)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_rdev" title='vattr::va_rdev' data-ref="vattr::va_rdev" data-ref-filename="vattr..va_rdev">va_rdev</a> = (fromp)-&gt;<a class="ref field" href="coda.h.html#coda_vattr::va_rdev" title='coda_vattr::va_rdev' data-ref="coda_vattr::va_rdev" data-ref-filename="coda_vattr..va_rdev">va_rdev</a>; \</u></td></tr>
<tr><th id="175">175</th><td><u>		(top)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_bytes" title='vattr::va_bytes' data-ref="vattr::va_bytes" data-ref-filename="vattr..va_bytes">va_bytes</a> = (fromp)-&gt;<a class="ref field" href="coda.h.html#coda_vattr::va_bytes" title='coda_vattr::va_bytes' data-ref="coda_vattr::va_bytes" data-ref-filename="coda_vattr..va_bytes">va_bytes</a>; \</u></td></tr>
<tr><th id="176">176</th><td><u>		(top)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_filerev" title='vattr::va_filerev' data-ref="vattr::va_filerev" data-ref-filename="vattr..va_filerev">va_filerev</a> = (fromp)-&gt;<a class="ref field" href="coda.h.html#coda_vattr::va_filerev" title='coda_vattr::va_filerev' data-ref="coda_vattr::va_filerev" data-ref-filename="coda_vattr..va_filerev">va_filerev</a>; \</u></td></tr>
<tr><th id="177">177</th><td><u>		(top)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_vaflags" title='vattr::va_vaflags' data-ref="vattr::va_vaflags" data-ref-filename="vattr..va_vaflags">va_vaflags</a> = VNOVAL; \</u></td></tr>
<tr><th id="178">178</th><td><u>		(top)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_spare" title='vattr::va_spare' data-ref="vattr::va_spare" data-ref-filename="vattr..va_spare">va_spare</a> = VNOVAL; \</u></td></tr>
<tr><th id="179">179</th><td><u>	} while (/*CONSTCOND*/ 0)</u></td></tr>
<tr><th id="180">180</th><td></td></tr>
<tr><th id="181">181</th><td><u>#define <dfn class="macro" id="_M/CNV_V2VV_ATTR" data-ref="_M/CNV_V2VV_ATTR">CNV_V2VV_ATTR</dfn>(top, fromp) \</u></td></tr>
<tr><th id="182">182</th><td><u>	do { \</u></td></tr>
<tr><th id="183">183</th><td><u>		(top)-&gt;<a class="ref field" href="coda.h.html#coda_vattr::va_type" title='coda_vattr::va_type' data-ref="coda_vattr::va_type" data-ref-filename="coda_vattr..va_type">va_type</a> = (fromp)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_type" title='vattr::va_type' data-ref="vattr::va_type" data-ref-filename="vattr..va_type">va_type</a>; \</u></td></tr>
<tr><th id="184">184</th><td><u>		(top)-&gt;<a class="ref field" href="coda.h.html#coda_vattr::va_mode" title='coda_vattr::va_mode' data-ref="coda_vattr::va_mode" data-ref-filename="coda_vattr..va_mode">va_mode</a> = (fromp)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_mode" title='vattr::va_mode' data-ref="vattr::va_mode" data-ref-filename="vattr..va_mode">va_mode</a>; \</u></td></tr>
<tr><th id="185">185</th><td><u>		(top)-&gt;<a class="ref field" href="coda.h.html#coda_vattr::va_nlink" title='coda_vattr::va_nlink' data-ref="coda_vattr::va_nlink" data-ref-filename="coda_vattr..va_nlink">va_nlink</a> = (fromp)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_nlink" title='vattr::va_nlink' data-ref="vattr::va_nlink" data-ref-filename="vattr..va_nlink">va_nlink</a>; \</u></td></tr>
<tr><th id="186">186</th><td><u>		(top)-&gt;<a class="ref field" href="coda.h.html#coda_vattr::va_uid" title='coda_vattr::va_uid' data-ref="coda_vattr::va_uid" data-ref-filename="coda_vattr..va_uid">va_uid</a> = (fromp)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_uid" title='vattr::va_uid' data-ref="vattr::va_uid" data-ref-filename="vattr..va_uid">va_uid</a>; \</u></td></tr>
<tr><th id="187">187</th><td><u>		(top)-&gt;<a class="ref field" href="coda.h.html#coda_vattr::va_gid" title='coda_vattr::va_gid' data-ref="coda_vattr::va_gid" data-ref-filename="coda_vattr..va_gid">va_gid</a> = (fromp)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_gid" title='vattr::va_gid' data-ref="vattr::va_gid" data-ref-filename="vattr..va_gid">va_gid</a>; \</u></td></tr>
<tr><th id="188">188</th><td><u>		(top)-&gt;<a class="ref field" href="coda.h.html#coda_vattr::va_fileid" title='coda_vattr::va_fileid' data-ref="coda_vattr::va_fileid" data-ref-filename="coda_vattr..va_fileid">va_fileid</a> = (fromp)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_fileid" title='vattr::va_fileid' data-ref="vattr::va_fileid" data-ref-filename="vattr..va_fileid">va_fileid</a>; \</u></td></tr>
<tr><th id="189">189</th><td><u>		(top)-&gt;<a class="ref field" href="coda.h.html#coda_vattr::va_size" title='coda_vattr::va_size' data-ref="coda_vattr::va_size" data-ref-filename="coda_vattr..va_size">va_size</a> = (fromp)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_size" title='vattr::va_size' data-ref="vattr::va_size" data-ref-filename="vattr..va_size">va_size</a>; \</u></td></tr>
<tr><th id="190">190</th><td><u>		(top)-&gt;<a class="ref field" href="coda.h.html#coda_vattr::va_blocksize" title='coda_vattr::va_blocksize' data-ref="coda_vattr::va_blocksize" data-ref-filename="coda_vattr..va_blocksize">va_blocksize</a> = (fromp)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_blocksize" title='vattr::va_blocksize' data-ref="vattr::va_blocksize" data-ref-filename="vattr..va_blocksize">va_blocksize</a>; \</u></td></tr>
<tr><th id="191">191</th><td><u>		(top)-&gt;<a class="ref field" href="coda.h.html#coda_vattr::va_atime" title='coda_vattr::va_atime' data-ref="coda_vattr::va_atime" data-ref-filename="coda_vattr..va_atime">va_atime</a> = (fromp)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_atime" title='vattr::va_atime' data-ref="vattr::va_atime" data-ref-filename="vattr..va_atime">va_atime</a>; \</u></td></tr>
<tr><th id="192">192</th><td><u>		(top)-&gt;<a class="ref field" href="coda.h.html#coda_vattr::va_mtime" title='coda_vattr::va_mtime' data-ref="coda_vattr::va_mtime" data-ref-filename="coda_vattr..va_mtime">va_mtime</a> = (fromp)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_mtime" title='vattr::va_mtime' data-ref="vattr::va_mtime" data-ref-filename="vattr..va_mtime">va_mtime</a>; \</u></td></tr>
<tr><th id="193">193</th><td><u>		(top)-&gt;<a class="ref field" href="coda.h.html#coda_vattr::va_ctime" title='coda_vattr::va_ctime' data-ref="coda_vattr::va_ctime" data-ref-filename="coda_vattr..va_ctime">va_ctime</a> = (fromp)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_ctime" title='vattr::va_ctime' data-ref="vattr::va_ctime" data-ref-filename="vattr..va_ctime">va_ctime</a>; \</u></td></tr>
<tr><th id="194">194</th><td><u>		(top)-&gt;<a class="ref field" href="coda.h.html#coda_vattr::va_gen" title='coda_vattr::va_gen' data-ref="coda_vattr::va_gen" data-ref-filename="coda_vattr..va_gen">va_gen</a> = (fromp)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_gen" title='vattr::va_gen' data-ref="vattr::va_gen" data-ref-filename="vattr..va_gen">va_gen</a>; \</u></td></tr>
<tr><th id="195">195</th><td><u>		(top)-&gt;<a class="ref field" href="coda.h.html#coda_vattr::va_flags" title='coda_vattr::va_flags' data-ref="coda_vattr::va_flags" data-ref-filename="coda_vattr..va_flags">va_flags</a> = (fromp)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_flags" title='vattr::va_flags' data-ref="vattr::va_flags" data-ref-filename="vattr..va_flags">va_flags</a>; \</u></td></tr>
<tr><th id="196">196</th><td><u>		(top)-&gt;<a class="ref field" href="coda.h.html#coda_vattr::va_rdev" title='coda_vattr::va_rdev' data-ref="coda_vattr::va_rdev" data-ref-filename="coda_vattr..va_rdev">va_rdev</a> = (fromp)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_rdev" title='vattr::va_rdev' data-ref="vattr::va_rdev" data-ref-filename="vattr..va_rdev">va_rdev</a>; \</u></td></tr>
<tr><th id="197">197</th><td><u>		(top)-&gt;<a class="ref field" href="coda.h.html#coda_vattr::va_bytes" title='coda_vattr::va_bytes' data-ref="coda_vattr::va_bytes" data-ref-filename="coda_vattr..va_bytes">va_bytes</a> = (fromp)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_bytes" title='vattr::va_bytes' data-ref="vattr::va_bytes" data-ref-filename="vattr..va_bytes">va_bytes</a>; \</u></td></tr>
<tr><th id="198">198</th><td><u>		(top)-&gt;<a class="ref field" href="coda.h.html#coda_vattr::va_filerev" title='coda_vattr::va_filerev' data-ref="coda_vattr::va_filerev" data-ref-filename="coda_vattr..va_filerev">va_filerev</a> = (fromp)-&gt;<a class="ref field" href="../sys/vnode.h.html#vattr::va_filerev" title='vattr::va_filerev' data-ref="vattr::va_filerev" data-ref-filename="vattr..va_filerev">va_filerev</a>; \</u></td></tr>
<tr><th id="199">199</th><td><u>	} while (/*CONSTCOND*/ 0)</u></td></tr>
<tr><th id="200">200</th><td></td></tr>
<tr><th id="201">201</th><td></td></tr>
<tr><th id="202">202</th><td><em>int</em></td></tr>
<tr><th id="203">203</th><td><dfn class="decl def fn" id="venus_root" title='venus_root' data-ref="venus_root" data-ref-filename="venus_root">venus_root</dfn>(<em>void</em> *<dfn class="local col2 decl" id="132mdp" title='mdp' data-type='void *' data-ref="132mdp" data-ref-filename="132mdp">mdp</dfn>,</td></tr>
<tr><th id="204">204</th><td>	<a class="typedef" href="../sys/types.h.html#kauth_cred_t" title='kauth_cred_t' data-type='struct kauth_cred *' data-ref="kauth_cred_t" data-ref-filename="kauth_cred_t">kauth_cred_t</a> <dfn class="local col3 decl" id="133cred" title='cred' data-type='kauth_cred_t' data-ref="133cred" data-ref-filename="133cred">cred</dfn>, <b>struct</b> <a class="type" href="../sys/proc.h.html#proc" title='proc' data-ref="proc" data-ref-filename="proc">proc</a> *<dfn class="local col4 decl" id="134p" title='p' data-type='struct proc *' data-ref="134p" data-ref-filename="134p">p</dfn>,</td></tr>
<tr><th id="205">205</th><td><i>/*out*/</i>	<a class="typedef" href="coda.h.html#CodaFid" title='CodaFid' data-type='struct CodaFid' data-ref="CodaFid" data-ref-filename="CodaFid">CodaFid</a> *<dfn class="local col5 decl" id="135VFid" title='VFid' data-type='CodaFid *' data-ref="135VFid" data-ref-filename="135VFid">VFid</dfn>)</td></tr>
<tr><th id="206">206</th><td>{</td></tr>
<tr><th id="207">207</th><td>    <a class="macro" href="#64" title="struct coda_in_hdr *inp; struct coda_root_out *outp; int coda_root_size = sizeof (struct coda_in_hdr); int Isize = sizeof (struct coda_in_hdr); int Osize = sizeof (struct coda_root_out); int error" data-ref="_M/DECL_NO_IN">DECL_NO_IN</a>(coda_root);		<i>/* sets Isize &amp; Osize */</i></td></tr>
<tr><th id="208">208</th><td>    <a class="macro" href="#87" title="if (Osize &gt; coda_root_size) coda_root_size = Osize; do { inp = (struct coda_in_hdr *)kern_malloc((unsigned long) coda_root_size, 0x0000); if (inp == 0) { panic(&quot;kernel malloc returns 0 at %s:%d\n&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 208); } } while ( 0); outp = (struct coda_root_out *) inp" data-ref="_M/ALLOC_NO_IN">ALLOC_NO_IN</a>(coda_root);		<i>/* sets inp &amp; outp */</i></td></tr>
<tr><th id="209">209</th><td></td></tr>
<tr><th id="210">210</th><td>    <i>/* send the open to venus. */</i></td></tr>
<tr><th id="211">211</th><td>    <a class="macro" href="#131" title="(inp)-&gt;opcode = (2); (inp)-&gt;pid = p ? p-&gt;p_pid : -1; (inp)-&gt;pgid = p ? p-&gt;p_pgrp-&gt;pg_id : -1; (__builtin_expect(((cred != ((void *)0))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != NULL&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 211)); (__builtin_expect(((cred != ((kauth_cred_t)-2))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != FSCRED&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 211)); if (cred != ((kauth_cred_t)-1)) { (inp)-&gt;uid = kauth_cred_geteuid(cred); } else { (inp)-&gt;uid = -1; }" data-ref="_M/INIT_IN">INIT_IN</a>(<a class="local col6 ref" href="#207" title='inp' data-ref="136inp" data-ref-filename="136inp">inp</a>, <a class="macro" href="coda.h.html#309" title="2" data-ref="_M/CODA_ROOT">CODA_ROOT</a>, <a class="local col3 ref" href="#133cred" title='cred' data-ref="133cred" data-ref-filename="133cred">cred</a>, <a class="local col4 ref" href="#134p" title='p' data-ref="134p" data-ref-filename="134p">p</a>);</td></tr>
<tr><th id="212">212</th><td></td></tr>
<tr><th id="213">213</th><td>    <a class="local col0 ref" href="#207" title='error' data-ref="140error" data-ref-filename="140error">error</a> = <a class="ref fn" href="cnode.h.html#coda_call" title='coda_call' data-ref="coda_call" data-ref-filename="coda_call">coda_call</a>(<a class="local col2 ref" href="#132mdp" title='mdp' data-ref="132mdp" data-ref-filename="132mdp">mdp</a>, <a class="local col8 ref" href="#207" title='Isize' data-ref="138Isize" data-ref-filename="138Isize">Isize</a>, &amp;<a class="local col9 ref" href="#207" title='Osize' data-ref="139Osize" data-ref-filename="139Osize">Osize</a>, (<em>char</em> *)<a class="local col6 ref" href="#207" title='inp' data-ref="136inp" data-ref-filename="136inp">inp</a>);</td></tr>
<tr><th id="214">214</th><td>    <b>if</b> (!<a class="local col0 ref" href="#207" title='error' data-ref="140error" data-ref-filename="140error">error</a>)</td></tr>
<tr><th id="215">215</th><td>	*<a class="local col5 ref" href="#135VFid" title='VFid' data-ref="135VFid" data-ref-filename="135VFid">VFid</a> = <a class="local col7 ref" href="#207" title='outp' data-ref="137outp" data-ref-filename="137outp">outp</a>-&gt;<a class="ref field" href="coda.h.html#coda_root_out::Fid" title='coda_root_out::Fid' data-ref="coda_root_out::Fid" data-ref-filename="coda_root_out..Fid">Fid</a>;</td></tr>
<tr><th id="216">216</th><td></td></tr>
<tr><th id="217">217</th><td>    <a class="macro" href="cnode.h.html#71" title="kern_free((inp))" data-ref="_M/CODA_FREE">CODA_FREE</a>(<a class="local col6 ref" href="#207" title='inp' data-ref="136inp" data-ref-filename="136inp">inp</a>, coda_root_size);</td></tr>
<tr><th id="218">218</th><td>    <b>return</b> <a class="local col0 ref" href="#207" title='error' data-ref="140error" data-ref-filename="140error">error</a>;</td></tr>
<tr><th id="219">219</th><td>}</td></tr>
<tr><th id="220">220</th><td></td></tr>
<tr><th id="221">221</th><td><em>int</em></td></tr>
<tr><th id="222">222</th><td><dfn class="decl def fn" id="venus_open" title='venus_open' data-ref="venus_open" data-ref-filename="venus_open">venus_open</dfn>(<em>void</em> *<dfn class="local col1 decl" id="141mdp" title='mdp' data-type='void *' data-ref="141mdp" data-ref-filename="141mdp">mdp</dfn>, <a class="typedef" href="coda.h.html#CodaFid" title='CodaFid' data-type='struct CodaFid' data-ref="CodaFid" data-ref-filename="CodaFid">CodaFid</a> *<dfn class="local col2 decl" id="142fid" title='fid' data-type='CodaFid *' data-ref="142fid" data-ref-filename="142fid">fid</dfn>, <em>int</em> <dfn class="local col3 decl" id="143flag" title='flag' data-type='int' data-ref="143flag" data-ref-filename="143flag">flag</dfn>,</td></tr>
<tr><th id="223">223</th><td>	<a class="typedef" href="../sys/types.h.html#kauth_cred_t" title='kauth_cred_t' data-type='struct kauth_cred *' data-ref="kauth_cred_t" data-ref-filename="kauth_cred_t">kauth_cred_t</a> <dfn class="local col4 decl" id="144cred" title='cred' data-type='kauth_cred_t' data-ref="144cred" data-ref-filename="144cred">cred</dfn>, <b>struct</b> <a class="type" href="../sys/lwp.h.html#lwp" title='lwp' data-ref="lwp" data-ref-filename="lwp">lwp</a> *<dfn class="local col5 decl" id="145l" title='l' data-type='struct lwp *' data-ref="145l" data-ref-filename="145l">l</dfn>,</td></tr>
<tr><th id="224">224</th><td><i>/*out*/</i>	<a class="typedef" href="../sys/types.h.html#dev_t" title='dev_t' data-type='uint64_t' data-ref="dev_t" data-ref-filename="dev_t">dev_t</a> *<dfn class="local col6 decl" id="146dev" title='dev' data-type='dev_t *' data-ref="146dev" data-ref-filename="146dev">dev</dfn>, <a class="typedef" href="../sys/types.h.html#ino_t" title='ino_t' data-type='uint64_t' data-ref="ino_t" data-ref-filename="ino_t">ino_t</a> *<dfn class="local col7 decl" id="147inode" title='inode' data-type='ino_t *' data-ref="147inode" data-ref-filename="147inode">inode</dfn>)</td></tr>
<tr><th id="225">225</th><td>{</td></tr>
<tr><th id="226">226</th><td>    <em>int</em> <dfn class="local col8 decl" id="148cflag" title='cflag' data-type='int' data-ref="148cflag" data-ref-filename="148cflag">cflag</dfn>;</td></tr>
<tr><th id="227">227</th><td>    <a class="macro" href="#72" title="struct coda_open_in *inp; struct coda_open_out *outp; int coda_open_size = sizeof (struct coda_open_in); int Isize = sizeof (struct coda_open_in); int Osize = sizeof (struct coda_open_out); int error" data-ref="_M/DECL">DECL</a>(coda_open);			<i>/* sets Isize &amp; Osize */</i></td></tr>
<tr><th id="228">228</th><td>    <a class="macro" href="#93" title="if (Osize &gt; coda_open_size) coda_open_size = Osize; do { inp = (struct coda_open_in *)kern_malloc((unsigned long) coda_open_size, 0x0000); if (inp == 0) { panic(&quot;kernel malloc returns 0 at %s:%d\n&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 228); } } while ( 0); outp = (struct coda_open_out *) inp" data-ref="_M/ALLOC">ALLOC</a>(coda_open);			<i>/* sets inp &amp; outp */</i></td></tr>
<tr><th id="229">229</th><td></td></tr>
<tr><th id="230">230</th><td>    <i>/* send the open to venus. */</i></td></tr>
<tr><th id="231">231</th><td>    <a class="macro" href="#145" title="(&amp;inp-&gt;ih)-&gt;opcode = (4); (&amp;inp-&gt;ih)-&gt;pid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pid : -1; (&amp;inp-&gt;ih)-&gt;pgid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pgrp-&gt;pg_id : -1; (__builtin_expect(((cred != ((void *)0))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != NULL&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 231)); (__builtin_expect(((cred != ((kauth_cred_t)-2))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != FSCRED&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 231)); if (cred != ((kauth_cred_t)-1)) { (&amp;inp-&gt;ih)-&gt;uid = kauth_cred_geteuid(cred); } else { (&amp;inp-&gt;ih)-&gt;uid = -1; }" data-ref="_M/INIT_IN_L">INIT_IN_L</a>(&amp;<a class="local col9 ref" href="#227" title='inp' data-ref="149inp" data-ref-filename="149inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_open_in::ih" title='coda_open_in::ih' data-ref="coda_open_in::ih" data-ref-filename="coda_open_in..ih">ih</a>, <a class="macro" href="coda.h.html#311" title="4" data-ref="_M/CODA_OPEN">CODA_OPEN</a>, <a class="local col4 ref" href="#144cred" title='cred' data-ref="144cred" data-ref-filename="144cred">cred</a>, <a class="local col5 ref" href="#145l" title='l' data-ref="145l" data-ref-filename="145l">l</a>);</td></tr>
<tr><th id="232">232</th><td>    <a class="local col9 ref" href="#227" title='inp' data-ref="149inp" data-ref-filename="149inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_open_in::Fid" title='coda_open_in::Fid' data-ref="coda_open_in::Fid" data-ref-filename="coda_open_in..Fid">Fid</a> = *<a class="local col2 ref" href="#142fid" title='fid' data-ref="142fid" data-ref-filename="142fid">fid</a>;</td></tr>
<tr><th id="233">233</th><td>    <a class="macro" href="#148" title="do { cflag = 0; if (flag &amp; 0x00000001) cflag |= 0x001; if (flag &amp; 0x00000002) cflag |= 0x002; if (flag &amp; 0x00000400) cflag |= 0x010; if (flag &amp; 0x00000800) cflag |= 0x100; if (flag &amp; 0x00000200) cflag |= 0x200; } while ( 0)" data-ref="_M/CNV_OFLAG">CNV_OFLAG</a>(<a class="local col8 ref" href="#148cflag" title='cflag' data-ref="148cflag" data-ref-filename="148cflag">cflag</a>, <a class="local col3 ref" href="#143flag" title='flag' data-ref="143flag" data-ref-filename="143flag">flag</a>);</td></tr>
<tr><th id="234">234</th><td>    <a class="local col9 ref" href="#227" title='inp' data-ref="149inp" data-ref-filename="149inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_open_in::flags" title='coda_open_in::flags' data-ref="coda_open_in::flags" data-ref-filename="coda_open_in..flags">flags</a> = <a class="local col8 ref" href="#148cflag" title='cflag' data-ref="148cflag" data-ref-filename="148cflag">cflag</a>;</td></tr>
<tr><th id="235">235</th><td></td></tr>
<tr><th id="236">236</th><td>    <a class="local col3 ref" href="#227" title='error' data-ref="153error" data-ref-filename="153error">error</a> = <a class="ref fn" href="cnode.h.html#coda_call" title='coda_call' data-ref="coda_call" data-ref-filename="coda_call">coda_call</a>(<a class="local col1 ref" href="#141mdp" title='mdp' data-ref="141mdp" data-ref-filename="141mdp">mdp</a>, <a class="local col1 ref" href="#227" title='Isize' data-ref="151Isize" data-ref-filename="151Isize">Isize</a>, &amp;<a class="local col2 ref" href="#227" title='Osize' data-ref="152Osize" data-ref-filename="152Osize">Osize</a>, (<em>char</em> *)<a class="local col9 ref" href="#227" title='inp' data-ref="149inp" data-ref-filename="149inp">inp</a>);</td></tr>
<tr><th id="237">237</th><td>    <a class="macro" href="../lib/libkern/libkern.h.html#279" title="(__builtin_expect(((outp != ((void *)0))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;outp != NULL&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 237))" data-ref="_M/KASSERT">KASSERT</a>(<a class="local col0 ref" href="#227" title='outp' data-ref="150outp" data-ref-filename="150outp">outp</a> != <a class="macro" href="../sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>);</td></tr>
<tr><th id="238">238</th><td>    <b>if</b> (!<a class="local col3 ref" href="#227" title='error' data-ref="153error" data-ref-filename="153error">error</a>) {</td></tr>
<tr><th id="239">239</th><td>	*<a class="local col6 ref" href="#146dev" title='dev' data-ref="146dev" data-ref-filename="146dev">dev</a> =  <a class="local col0 ref" href="#227" title='outp' data-ref="150outp" data-ref-filename="150outp">outp</a>-&gt;<a class="ref field" href="coda.h.html#coda_open_out::dev" title='coda_open_out::dev' data-ref="coda_open_out::dev" data-ref-filename="coda_open_out..dev">dev</a>;</td></tr>
<tr><th id="240">240</th><td>	*<a class="local col7 ref" href="#147inode" title='inode' data-ref="147inode" data-ref-filename="147inode">inode</a> = <a class="local col0 ref" href="#227" title='outp' data-ref="150outp" data-ref-filename="150outp">outp</a>-&gt;<a class="ref field" href="coda.h.html#coda_open_out::inode" title='coda_open_out::inode' data-ref="coda_open_out::inode" data-ref-filename="coda_open_out..inode">inode</a>;</td></tr>
<tr><th id="241">241</th><td>    }</td></tr>
<tr><th id="242">242</th><td></td></tr>
<tr><th id="243">243</th><td>    <a class="macro" href="cnode.h.html#71" title="kern_free((inp))" data-ref="_M/CODA_FREE">CODA_FREE</a>(<a class="local col9 ref" href="#227" title='inp' data-ref="149inp" data-ref-filename="149inp">inp</a>, coda_open_size);</td></tr>
<tr><th id="244">244</th><td>    <b>return</b> <a class="local col3 ref" href="#227" title='error' data-ref="153error" data-ref-filename="153error">error</a>;</td></tr>
<tr><th id="245">245</th><td>}</td></tr>
<tr><th id="246">246</th><td></td></tr>
<tr><th id="247">247</th><td><em>int</em></td></tr>
<tr><th id="248">248</th><td><dfn class="decl def fn" id="venus_close" title='venus_close' data-ref="venus_close" data-ref-filename="venus_close">venus_close</dfn>(<em>void</em> *<dfn class="local col4 decl" id="154mdp" title='mdp' data-type='void *' data-ref="154mdp" data-ref-filename="154mdp">mdp</dfn>, <a class="typedef" href="coda.h.html#CodaFid" title='CodaFid' data-type='struct CodaFid' data-ref="CodaFid" data-ref-filename="CodaFid">CodaFid</a> *<dfn class="local col5 decl" id="155fid" title='fid' data-type='CodaFid *' data-ref="155fid" data-ref-filename="155fid">fid</dfn>, <em>int</em> <dfn class="local col6 decl" id="156flag" title='flag' data-type='int' data-ref="156flag" data-ref-filename="156flag">flag</dfn>,</td></tr>
<tr><th id="249">249</th><td>	<a class="typedef" href="../sys/types.h.html#kauth_cred_t" title='kauth_cred_t' data-type='struct kauth_cred *' data-ref="kauth_cred_t" data-ref-filename="kauth_cred_t">kauth_cred_t</a> <dfn class="local col7 decl" id="157cred" title='cred' data-type='kauth_cred_t' data-ref="157cred" data-ref-filename="157cred">cred</dfn>, <b>struct</b> <a class="type" href="../sys/lwp.h.html#lwp" title='lwp' data-ref="lwp" data-ref-filename="lwp">lwp</a> *<dfn class="local col8 decl" id="158l" title='l' data-type='struct lwp *' data-ref="158l" data-ref-filename="158l">l</dfn>)</td></tr>
<tr><th id="250">250</th><td>{</td></tr>
<tr><th id="251">251</th><td>    <em>int</em> <dfn class="local col9 decl" id="159cflag" title='cflag' data-type='int' data-ref="159cflag" data-ref-filename="159cflag">cflag</dfn>;</td></tr>
<tr><th id="252">252</th><td>    <a class="macro" href="#80" title="struct coda_close_in *inp; int coda_close_size = sizeof (struct coda_close_in); int Isize = sizeof (struct coda_close_in); int Osize = sizeof (struct coda_out_hdr); int error" data-ref="_M/DECL_NO_OUT">DECL_NO_OUT</a>(coda_close);		<i>/* sets Isize &amp; Osize */</i></td></tr>
<tr><th id="253">253</th><td>    <a class="macro" href="#99" title="if (Osize &gt; coda_close_size) coda_close_size = Osize; do { inp = (struct coda_close_in *)kern_malloc((unsigned long) coda_close_size, 0x0000); if (inp == 0) { panic(&quot;kernel malloc returns 0 at %s:%d\n&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 253); } } while ( 0);" data-ref="_M/ALLOC_NO_OUT">ALLOC_NO_OUT</a>(coda_close);		<i>/* sets inp &amp; outp */</i></td></tr>
<tr><th id="254">254</th><td></td></tr>
<tr><th id="255">255</th><td>    <a class="macro" href="#145" title="(&amp;inp-&gt;ih)-&gt;opcode = (5); (&amp;inp-&gt;ih)-&gt;pid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pid : -1; (&amp;inp-&gt;ih)-&gt;pgid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pgrp-&gt;pg_id : -1; (__builtin_expect(((cred != ((void *)0))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != NULL&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 255)); (__builtin_expect(((cred != ((kauth_cred_t)-2))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != FSCRED&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 255)); if (cred != ((kauth_cred_t)-1)) { (&amp;inp-&gt;ih)-&gt;uid = kauth_cred_geteuid(cred); } else { (&amp;inp-&gt;ih)-&gt;uid = -1; }" data-ref="_M/INIT_IN_L">INIT_IN_L</a>(&amp;<a class="local col0 ref" href="#252" title='inp' data-ref="160inp" data-ref-filename="160inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_close_in::ih" title='coda_close_in::ih' data-ref="coda_close_in::ih" data-ref-filename="coda_close_in..ih">ih</a>, <a class="macro" href="coda.h.html#312" title="5" data-ref="_M/CODA_CLOSE">CODA_CLOSE</a>, <a class="local col7 ref" href="#157cred" title='cred' data-ref="157cred" data-ref-filename="157cred">cred</a>, <a class="local col8 ref" href="#158l" title='l' data-ref="158l" data-ref-filename="158l">l</a>);</td></tr>
<tr><th id="256">256</th><td>    <a class="local col0 ref" href="#252" title='inp' data-ref="160inp" data-ref-filename="160inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_close_in::Fid" title='coda_close_in::Fid' data-ref="coda_close_in::Fid" data-ref-filename="coda_close_in..Fid">Fid</a> = *<a class="local col5 ref" href="#155fid" title='fid' data-ref="155fid" data-ref-filename="155fid">fid</a>;</td></tr>
<tr><th id="257">257</th><td>    <a class="macro" href="#148" title="do { cflag = 0; if (flag &amp; 0x00000001) cflag |= 0x001; if (flag &amp; 0x00000002) cflag |= 0x002; if (flag &amp; 0x00000400) cflag |= 0x010; if (flag &amp; 0x00000800) cflag |= 0x100; if (flag &amp; 0x00000200) cflag |= 0x200; } while ( 0)" data-ref="_M/CNV_OFLAG">CNV_OFLAG</a>(<a class="local col9 ref" href="#159cflag" title='cflag' data-ref="159cflag" data-ref-filename="159cflag">cflag</a>, <a class="local col6 ref" href="#156flag" title='flag' data-ref="156flag" data-ref-filename="156flag">flag</a>);</td></tr>
<tr><th id="258">258</th><td>    <a class="local col0 ref" href="#252" title='inp' data-ref="160inp" data-ref-filename="160inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_close_in::flags" title='coda_close_in::flags' data-ref="coda_close_in::flags" data-ref-filename="coda_close_in..flags">flags</a> = <a class="local col9 ref" href="#159cflag" title='cflag' data-ref="159cflag" data-ref-filename="159cflag">cflag</a>;</td></tr>
<tr><th id="259">259</th><td></td></tr>
<tr><th id="260">260</th><td>    <a class="local col3 ref" href="#252" title='error' data-ref="163error" data-ref-filename="163error">error</a> = <a class="ref fn" href="cnode.h.html#coda_call" title='coda_call' data-ref="coda_call" data-ref-filename="coda_call">coda_call</a>(<a class="local col4 ref" href="#154mdp" title='mdp' data-ref="154mdp" data-ref-filename="154mdp">mdp</a>, <a class="local col1 ref" href="#252" title='Isize' data-ref="161Isize" data-ref-filename="161Isize">Isize</a>, &amp;<a class="local col2 ref" href="#252" title='Osize' data-ref="162Osize" data-ref-filename="162Osize">Osize</a>, (<em>char</em> *)<a class="local col0 ref" href="#252" title='inp' data-ref="160inp" data-ref-filename="160inp">inp</a>);</td></tr>
<tr><th id="261">261</th><td></td></tr>
<tr><th id="262">262</th><td>    <a class="macro" href="cnode.h.html#71" title="kern_free((inp))" data-ref="_M/CODA_FREE">CODA_FREE</a>(<a class="local col0 ref" href="#252" title='inp' data-ref="160inp" data-ref-filename="160inp">inp</a>, coda_close_size);</td></tr>
<tr><th id="263">263</th><td>    <b>return</b> <a class="local col3 ref" href="#252" title='error' data-ref="163error" data-ref-filename="163error">error</a>;</td></tr>
<tr><th id="264">264</th><td>}</td></tr>
<tr><th id="265">265</th><td></td></tr>
<tr><th id="266">266</th><td><i>/*</i></td></tr>
<tr><th id="267">267</th><td><i> * these two calls will not exist!!!  the container file is read/written</i></td></tr>
<tr><th id="268">268</th><td><i> * directly.</i></td></tr>
<tr><th id="269">269</th><td><i> */</i></td></tr>
<tr><th id="270">270</th><td><em>void</em></td></tr>
<tr><th id="271">271</th><td><dfn class="decl def fn" id="venus_read" title='venus_read' data-ref="venus_read" data-ref-filename="venus_read">venus_read</dfn>(<em>void</em>)</td></tr>
<tr><th id="272">272</th><td>{</td></tr>
<tr><th id="273">273</th><td>}</td></tr>
<tr><th id="274">274</th><td></td></tr>
<tr><th id="275">275</th><td><em>void</em></td></tr>
<tr><th id="276">276</th><td><dfn class="decl def fn" id="venus_write" title='venus_write' data-ref="venus_write" data-ref-filename="venus_write">venus_write</dfn>(<em>void</em>)</td></tr>
<tr><th id="277">277</th><td>{</td></tr>
<tr><th id="278">278</th><td>}</td></tr>
<tr><th id="279">279</th><td></td></tr>
<tr><th id="280">280</th><td><i>/*</i></td></tr>
<tr><th id="281">281</th><td><i> * this is a bit sad too.  the ioctl's are for the control file, not for</i></td></tr>
<tr><th id="282">282</th><td><i> * normal files.</i></td></tr>
<tr><th id="283">283</th><td><i> */</i></td></tr>
<tr><th id="284">284</th><td><em>int</em></td></tr>
<tr><th id="285">285</th><td><dfn class="decl def fn" id="venus_ioctl" title='venus_ioctl' data-ref="venus_ioctl" data-ref-filename="venus_ioctl">venus_ioctl</dfn>(<em>void</em> *<dfn class="local col4 decl" id="164mdp" title='mdp' data-type='void *' data-ref="164mdp" data-ref-filename="164mdp">mdp</dfn>, <a class="typedef" href="coda.h.html#CodaFid" title='CodaFid' data-type='struct CodaFid' data-ref="CodaFid" data-ref-filename="CodaFid">CodaFid</a> *<dfn class="local col5 decl" id="165fid" title='fid' data-type='CodaFid *' data-ref="165fid" data-ref-filename="165fid">fid</dfn>,</td></tr>
<tr><th id="286">286</th><td>	<em>int</em> <dfn class="local col6 decl" id="166com" title='com' data-type='int' data-ref="166com" data-ref-filename="166com">com</dfn>, <em>int</em> <dfn class="local col7 decl" id="167flag" title='flag' data-type='int' data-ref="167flag" data-ref-filename="167flag">flag</dfn>, <em>void</em> *<dfn class="local col8 decl" id="168data" title='data' data-type='void *' data-ref="168data" data-ref-filename="168data">data</dfn>,</td></tr>
<tr><th id="287">287</th><td>	<a class="typedef" href="../sys/types.h.html#kauth_cred_t" title='kauth_cred_t' data-type='struct kauth_cred *' data-ref="kauth_cred_t" data-ref-filename="kauth_cred_t">kauth_cred_t</a> <dfn class="local col9 decl" id="169cred" title='cred' data-type='kauth_cred_t' data-ref="169cred" data-ref-filename="169cred">cred</dfn>, <b>struct</b> <a class="type" href="../sys/lwp.h.html#lwp" title='lwp' data-ref="lwp" data-ref-filename="lwp">lwp</a> *<dfn class="local col0 decl" id="170l" title='l' data-type='struct lwp *' data-ref="170l" data-ref-filename="170l">l</dfn>)</td></tr>
<tr><th id="288">288</th><td>{</td></tr>
<tr><th id="289">289</th><td>    <a class="macro" href="#72" title="struct coda_ioctl_in *inp; struct coda_ioctl_out *outp; int coda_ioctl_size = sizeof (struct coda_ioctl_in); int Isize = sizeof (struct coda_ioctl_in); int Osize = sizeof (struct coda_ioctl_out); int error" data-ref="_M/DECL">DECL</a>(coda_ioctl);			<i>/* sets Isize &amp; Osize */</i></td></tr>
<tr><th id="290">290</th><td>    <b>struct</b> <a class="type" href="coda.h.html#PioctlData" title='PioctlData' data-ref="PioctlData" data-ref-filename="PioctlData">PioctlData</a> *<dfn class="local col6 decl" id="176iap" title='iap' data-type='struct PioctlData *' data-ref="176iap" data-ref-filename="176iap">iap</dfn> = (<b>struct</b> <a class="type" href="coda.h.html#PioctlData" title='PioctlData' data-ref="PioctlData" data-ref-filename="PioctlData">PioctlData</a> *)<a class="local col8 ref" href="#168data" title='data' data-ref="168data" data-ref-filename="168data">data</a>;</td></tr>
<tr><th id="291">291</th><td>    <em>int</em> <dfn class="local col7 decl" id="177tmp" title='tmp' data-type='int' data-ref="177tmp" data-ref-filename="177tmp">tmp</dfn>;</td></tr>
<tr><th id="292">292</th><td></td></tr>
<tr><th id="293">293</th><td>    <a class="local col8 ref" href="#289" title='coda_ioctl_size' data-ref="178coda_ioctl_size" data-ref-filename="178coda_ioctl_size">coda_ioctl_size</a> = <a class="macro" href="coda.h.html#346" title="sizeof(union inputArgs)+sizeof(union outputArgs) + 8192" data-ref="_M/VC_MAXMSGSIZE">VC_MAXMSGSIZE</a>;</td></tr>
<tr><th id="294">294</th><td>    <a class="macro" href="#93" title="if (Osize &gt; coda_ioctl_size) coda_ioctl_size = Osize; do { inp = (struct coda_ioctl_in *)kern_malloc((unsigned long) coda_ioctl_size, 0x0000); if (inp == 0) { panic(&quot;kernel malloc returns 0 at %s:%d\n&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 294); } } while ( 0); outp = (struct coda_ioctl_out *) inp" data-ref="_M/ALLOC">ALLOC</a>(coda_ioctl);			<i>/* sets inp &amp; outp */</i></td></tr>
<tr><th id="295">295</th><td></td></tr>
<tr><th id="296">296</th><td>    <a class="macro" href="#145" title="(&amp;inp-&gt;ih)-&gt;opcode = (6); (&amp;inp-&gt;ih)-&gt;pid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pid : -1; (&amp;inp-&gt;ih)-&gt;pgid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pgrp-&gt;pg_id : -1; (__builtin_expect(((cred != ((void *)0))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != NULL&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 296)); (__builtin_expect(((cred != ((kauth_cred_t)-2))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != FSCRED&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 296)); if (cred != ((kauth_cred_t)-1)) { (&amp;inp-&gt;ih)-&gt;uid = kauth_cred_geteuid(cred); } else { (&amp;inp-&gt;ih)-&gt;uid = -1; }" data-ref="_M/INIT_IN_L">INIT_IN_L</a>(&amp;<a class="local col1 ref" href="#289" title='inp' data-ref="171inp" data-ref-filename="171inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_ioctl_in::ih" title='coda_ioctl_in::ih' data-ref="coda_ioctl_in::ih" data-ref-filename="coda_ioctl_in..ih">ih</a>, <a class="macro" href="coda.h.html#313" title="6" data-ref="_M/CODA_IOCTL">CODA_IOCTL</a>, <a class="local col9 ref" href="#169cred" title='cred' data-ref="169cred" data-ref-filename="169cred">cred</a>, <a class="local col0 ref" href="#170l" title='l' data-ref="170l" data-ref-filename="170l">l</a>);</td></tr>
<tr><th id="297">297</th><td>    <a class="local col1 ref" href="#289" title='inp' data-ref="171inp" data-ref-filename="171inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_ioctl_in::Fid" title='coda_ioctl_in::Fid' data-ref="coda_ioctl_in::Fid" data-ref-filename="coda_ioctl_in..Fid">Fid</a> = *<a class="local col5 ref" href="#165fid" title='fid' data-ref="165fid" data-ref-filename="165fid">fid</a>;</td></tr>
<tr><th id="298">298</th><td></td></tr>
<tr><th id="299">299</th><td>    <i>/* command was mutated by increasing its size field to reflect the</i></td></tr>
<tr><th id="300">300</th><td><i>     * path and follow args. we need to subtract that out before sending</i></td></tr>
<tr><th id="301">301</th><td><i>     * the command to venus.</i></td></tr>
<tr><th id="302">302</th><td><i>     */</i></td></tr>
<tr><th id="303">303</th><td>    <a class="local col1 ref" href="#289" title='inp' data-ref="171inp" data-ref-filename="171inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_ioctl_in::cmd" title='coda_ioctl_in::cmd' data-ref="coda_ioctl_in::cmd" data-ref-filename="coda_ioctl_in..cmd">cmd</a> = (<a class="local col6 ref" href="#166com" title='com' data-ref="166com" data-ref-filename="166com">com</a> &amp; ~(<a class="macro" href="../sys/ioccom.h.html#47" title="0x1fff" data-ref="_M/IOCPARM_MASK">IOCPARM_MASK</a> &lt;&lt; <var>16</var>));</td></tr>
<tr><th id="304">304</th><td>    <a class="local col7 ref" href="#177tmp" title='tmp' data-ref="177tmp" data-ref-filename="177tmp">tmp</a> = ((<a class="local col6 ref" href="#166com" title='com' data-ref="166com" data-ref-filename="166com">com</a> &gt;&gt; <var>16</var>) &amp; <a class="macro" href="../sys/ioccom.h.html#47" title="0x1fff" data-ref="_M/IOCPARM_MASK">IOCPARM_MASK</a>) - <b>sizeof</b> (<em>char</em> *) - <b>sizeof</b> (<em>int</em>);</td></tr>
<tr><th id="305">305</th><td>    <a class="local col1 ref" href="#289" title='inp' data-ref="171inp" data-ref-filename="171inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_ioctl_in::cmd" title='coda_ioctl_in::cmd' data-ref="coda_ioctl_in::cmd" data-ref-filename="coda_ioctl_in..cmd">cmd</a> |= (<a class="local col7 ref" href="#177tmp" title='tmp' data-ref="177tmp" data-ref-filename="177tmp">tmp</a> &amp; <a class="macro" href="../sys/ioccom.h.html#47" title="0x1fff" data-ref="_M/IOCPARM_MASK">IOCPARM_MASK</a>) &lt;&lt;	<var>16</var>;</td></tr>
<tr><th id="306">306</th><td></td></tr>
<tr><th id="307">307</th><td>    <b>if</b> (<a class="local col6 ref" href="#176iap" title='iap' data-ref="176iap" data-ref-filename="176iap">iap</a>-&gt;<a class="ref field" href="coda.h.html#PioctlData::vi" title='PioctlData::vi' data-ref="PioctlData::vi" data-ref-filename="PioctlData..vi">vi</a>.<a class="ref field" href="coda.h.html#ViceIoctl::in_size" title='ViceIoctl::in_size' data-ref="ViceIoctl::in_size" data-ref-filename="ViceIoctl..in_size">in_size</a> &gt; <a class="macro" href="coda.h.html#346" title="sizeof(union inputArgs)+sizeof(union outputArgs) + 8192" data-ref="_M/VC_MAXMSGSIZE">VC_MAXMSGSIZE</a> || <a class="local col6 ref" href="#176iap" title='iap' data-ref="176iap" data-ref-filename="176iap">iap</a>-&gt;<a class="ref field" href="coda.h.html#PioctlData::vi" title='PioctlData::vi' data-ref="PioctlData::vi" data-ref-filename="PioctlData..vi">vi</a>.<a class="ref field" href="coda.h.html#ViceIoctl::out_size" title='ViceIoctl::out_size' data-ref="ViceIoctl::out_size" data-ref-filename="ViceIoctl..out_size">out_size</a> &gt; <a class="macro" href="coda.h.html#346" title="sizeof(union inputArgs)+sizeof(union outputArgs) + 8192" data-ref="_M/VC_MAXMSGSIZE">VC_MAXMSGSIZE</a>) {</td></tr>
<tr><th id="308">308</th><td>	<a class="macro" href="cnode.h.html#71" title="kern_free((inp))" data-ref="_M/CODA_FREE">CODA_FREE</a>(<a class="local col1 ref" href="#289" title='inp' data-ref="171inp" data-ref-filename="171inp">inp</a>, coda_ioctl_size);</td></tr>
<tr><th id="309">309</th><td>	<b>return</b> (<a class="macro" href="../sys/errno.h.html#64" title="22" data-ref="_M/EINVAL">EINVAL</a>);</td></tr>
<tr><th id="310">310</th><td>    }</td></tr>
<tr><th id="311">311</th><td></td></tr>
<tr><th id="312">312</th><td>    <a class="local col1 ref" href="#289" title='inp' data-ref="171inp" data-ref-filename="171inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_ioctl_in::rwflag" title='coda_ioctl_in::rwflag' data-ref="coda_ioctl_in::rwflag" data-ref-filename="coda_ioctl_in..rwflag">rwflag</a> = <a class="local col7 ref" href="#167flag" title='flag' data-ref="167flag" data-ref-filename="167flag">flag</a>;</td></tr>
<tr><th id="313">313</th><td>    <a class="local col1 ref" href="#289" title='inp' data-ref="171inp" data-ref-filename="171inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_ioctl_in::len" title='coda_ioctl_in::len' data-ref="coda_ioctl_in::len" data-ref-filename="coda_ioctl_in..len">len</a> = <a class="local col6 ref" href="#176iap" title='iap' data-ref="176iap" data-ref-filename="176iap">iap</a>-&gt;<a class="ref field" href="coda.h.html#PioctlData::vi" title='PioctlData::vi' data-ref="PioctlData::vi" data-ref-filename="PioctlData..vi">vi</a>.<a class="ref field" href="coda.h.html#ViceIoctl::in_size" title='ViceIoctl::in_size' data-ref="ViceIoctl::in_size" data-ref-filename="ViceIoctl..in_size">in_size</a>;</td></tr>
<tr><th id="314">314</th><td>    <a class="local col1 ref" href="#289" title='inp' data-ref="171inp" data-ref-filename="171inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_ioctl_in::data" title='coda_ioctl_in::data' data-ref="coda_ioctl_in::data" data-ref-filename="coda_ioctl_in..data">data</a> = (<em>char</em> *)(<b>sizeof</b> (<b>struct</b> <a class="type" href="coda.h.html#coda_ioctl_in" title='coda_ioctl_in' data-ref="coda_ioctl_in" data-ref-filename="coda_ioctl_in">coda_ioctl_in</a>));</td></tr>
<tr><th id="315">315</th><td></td></tr>
<tr><th id="316">316</th><td>    <a class="local col5 ref" href="#289" title='error' data-ref="175error" data-ref-filename="175error">error</a> = <a class="ref fn" href="../sys/systm.h.html#copyin" title='copyin' data-ref="copyin" data-ref-filename="copyin">copyin</a>(<a class="local col6 ref" href="#176iap" title='iap' data-ref="176iap" data-ref-filename="176iap">iap</a>-&gt;<a class="ref field" href="coda.h.html#PioctlData::vi" title='PioctlData::vi' data-ref="PioctlData::vi" data-ref-filename="PioctlData..vi">vi</a>.<a class="ref field" href="coda.h.html#ViceIoctl::in" title='ViceIoctl::in' data-ref="ViceIoctl::in" data-ref-filename="ViceIoctl..in">in</a>, (<em>char</em>*)<a class="local col1 ref" href="#289" title='inp' data-ref="171inp" data-ref-filename="171inp">inp</a> + (<em>int</em>)(<em>long</em>)<a class="local col1 ref" href="#289" title='inp' data-ref="171inp" data-ref-filename="171inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_ioctl_in::data" title='coda_ioctl_in::data' data-ref="coda_ioctl_in::data" data-ref-filename="coda_ioctl_in..data">data</a>,</td></tr>
<tr><th id="317">317</th><td>		   <a class="local col6 ref" href="#176iap" title='iap' data-ref="176iap" data-ref-filename="176iap">iap</a>-&gt;<a class="ref field" href="coda.h.html#PioctlData::vi" title='PioctlData::vi' data-ref="PioctlData::vi" data-ref-filename="PioctlData..vi">vi</a>.<a class="ref field" href="coda.h.html#ViceIoctl::in_size" title='ViceIoctl::in_size' data-ref="ViceIoctl::in_size" data-ref-filename="ViceIoctl..in_size">in_size</a>);</td></tr>
<tr><th id="318">318</th><td>    <b>if</b> (<a class="local col5 ref" href="#289" title='error' data-ref="175error" data-ref-filename="175error">error</a>) {</td></tr>
<tr><th id="319">319</th><td>	<a class="macro" href="cnode.h.html#71" title="kern_free((inp))" data-ref="_M/CODA_FREE">CODA_FREE</a>(<a class="local col1 ref" href="#289" title='inp' data-ref="171inp" data-ref-filename="171inp">inp</a>, coda_ioctl_size);</td></tr>
<tr><th id="320">320</th><td>	<b>return</b>(<a class="local col5 ref" href="#289" title='error' data-ref="175error" data-ref-filename="175error">error</a>);</td></tr>
<tr><th id="321">321</th><td>    }</td></tr>
<tr><th id="322">322</th><td></td></tr>
<tr><th id="323">323</th><td>    <a class="local col4 ref" href="#289" title='Osize' data-ref="174Osize" data-ref-filename="174Osize">Osize</a> = <a class="macro" href="coda.h.html#346" title="sizeof(union inputArgs)+sizeof(union outputArgs) + 8192" data-ref="_M/VC_MAXMSGSIZE">VC_MAXMSGSIZE</a>;</td></tr>
<tr><th id="324">324</th><td>    <a class="local col5 ref" href="#289" title='error' data-ref="175error" data-ref-filename="175error">error</a> = <a class="ref fn" href="cnode.h.html#coda_call" title='coda_call' data-ref="coda_call" data-ref-filename="coda_call">coda_call</a>(<a class="local col4 ref" href="#164mdp" title='mdp' data-ref="164mdp" data-ref-filename="164mdp">mdp</a>, <a class="local col3 ref" href="#289" title='Isize' data-ref="173Isize" data-ref-filename="173Isize">Isize</a> + <a class="local col6 ref" href="#176iap" title='iap' data-ref="176iap" data-ref-filename="176iap">iap</a>-&gt;<a class="ref field" href="coda.h.html#PioctlData::vi" title='PioctlData::vi' data-ref="PioctlData::vi" data-ref-filename="PioctlData..vi">vi</a>.<a class="ref field" href="coda.h.html#ViceIoctl::in_size" title='ViceIoctl::in_size' data-ref="ViceIoctl::in_size" data-ref-filename="ViceIoctl..in_size">in_size</a>, &amp;<a class="local col4 ref" href="#289" title='Osize' data-ref="174Osize" data-ref-filename="174Osize">Osize</a>, (<em>char</em> *)<a class="local col1 ref" href="#289" title='inp' data-ref="171inp" data-ref-filename="171inp">inp</a>);</td></tr>
<tr><th id="325">325</th><td></td></tr>
<tr><th id="326">326</th><td>	<i>/* copy out the out buffer. */</i></td></tr>
<tr><th id="327">327</th><td>    <b>if</b> (!<a class="local col5 ref" href="#289" title='error' data-ref="175error" data-ref-filename="175error">error</a>) {</td></tr>
<tr><th id="328">328</th><td>	<b>if</b> (<a class="local col2 ref" href="#289" title='outp' data-ref="172outp" data-ref-filename="172outp">outp</a>-&gt;<a class="ref field" href="coda.h.html#coda_ioctl_out::len" title='coda_ioctl_out::len' data-ref="coda_ioctl_out::len" data-ref-filename="coda_ioctl_out..len">len</a> &gt; <a class="local col6 ref" href="#176iap" title='iap' data-ref="176iap" data-ref-filename="176iap">iap</a>-&gt;<a class="ref field" href="coda.h.html#PioctlData::vi" title='PioctlData::vi' data-ref="PioctlData::vi" data-ref-filename="PioctlData..vi">vi</a>.<a class="ref field" href="coda.h.html#ViceIoctl::out_size" title='ViceIoctl::out_size' data-ref="ViceIoctl::out_size" data-ref-filename="ViceIoctl..out_size">out_size</a>) {</td></tr>
<tr><th id="329">329</th><td>	    <a class="local col5 ref" href="#289" title='error' data-ref="175error" data-ref-filename="175error">error</a> = <a class="macro" href="../sys/errno.h.html#64" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="330">330</th><td>	} <b>else</b> {</td></tr>
<tr><th id="331">331</th><td>	    <a class="local col5 ref" href="#289" title='error' data-ref="175error" data-ref-filename="175error">error</a> = <a class="ref fn" href="../sys/systm.h.html#copyout" title='copyout' data-ref="copyout" data-ref-filename="copyout">copyout</a>((<em>char</em> *)<a class="local col2 ref" href="#289" title='outp' data-ref="172outp" data-ref-filename="172outp">outp</a> + (<em>int</em>)(<em>long</em>)<a class="local col2 ref" href="#289" title='outp' data-ref="172outp" data-ref-filename="172outp">outp</a>-&gt;<a class="ref field" href="coda.h.html#coda_ioctl_out::data" title='coda_ioctl_out::data' data-ref="coda_ioctl_out::data" data-ref-filename="coda_ioctl_out..data">data</a>,</td></tr>
<tr><th id="332">332</th><td>			    <a class="local col6 ref" href="#176iap" title='iap' data-ref="176iap" data-ref-filename="176iap">iap</a>-&gt;<a class="ref field" href="coda.h.html#PioctlData::vi" title='PioctlData::vi' data-ref="PioctlData::vi" data-ref-filename="PioctlData..vi">vi</a>.<a class="ref field" href="coda.h.html#ViceIoctl::out" title='ViceIoctl::out' data-ref="ViceIoctl::out" data-ref-filename="ViceIoctl..out">out</a>, <a class="local col6 ref" href="#176iap" title='iap' data-ref="176iap" data-ref-filename="176iap">iap</a>-&gt;<a class="ref field" href="coda.h.html#PioctlData::vi" title='PioctlData::vi' data-ref="PioctlData::vi" data-ref-filename="PioctlData..vi">vi</a>.<a class="ref field" href="coda.h.html#ViceIoctl::out_size" title='ViceIoctl::out_size' data-ref="ViceIoctl::out_size" data-ref-filename="ViceIoctl..out_size">out_size</a>);</td></tr>
<tr><th id="333">333</th><td>	}</td></tr>
<tr><th id="334">334</th><td>    }</td></tr>
<tr><th id="335">335</th><td></td></tr>
<tr><th id="336">336</th><td>    <a class="macro" href="cnode.h.html#71" title="kern_free((inp))" data-ref="_M/CODA_FREE">CODA_FREE</a>(<a class="local col1 ref" href="#289" title='inp' data-ref="171inp" data-ref-filename="171inp">inp</a>, coda_ioctl_size);</td></tr>
<tr><th id="337">337</th><td>    <b>return</b> <a class="local col5 ref" href="#289" title='error' data-ref="175error" data-ref-filename="175error">error</a>;</td></tr>
<tr><th id="338">338</th><td>}</td></tr>
<tr><th id="339">339</th><td></td></tr>
<tr><th id="340">340</th><td><em>int</em></td></tr>
<tr><th id="341">341</th><td><dfn class="decl def fn" id="venus_getattr" title='venus_getattr' data-ref="venus_getattr" data-ref-filename="venus_getattr">venus_getattr</dfn>(<em>void</em> *<dfn class="local col9 decl" id="179mdp" title='mdp' data-type='void *' data-ref="179mdp" data-ref-filename="179mdp">mdp</dfn>, <a class="typedef" href="coda.h.html#CodaFid" title='CodaFid' data-type='struct CodaFid' data-ref="CodaFid" data-ref-filename="CodaFid">CodaFid</a> *<dfn class="local col0 decl" id="180fid" title='fid' data-type='CodaFid *' data-ref="180fid" data-ref-filename="180fid">fid</dfn>,</td></tr>
<tr><th id="342">342</th><td>	<a class="typedef" href="../sys/types.h.html#kauth_cred_t" title='kauth_cred_t' data-type='struct kauth_cred *' data-ref="kauth_cred_t" data-ref-filename="kauth_cred_t">kauth_cred_t</a> <dfn class="local col1 decl" id="181cred" title='cred' data-type='kauth_cred_t' data-ref="181cred" data-ref-filename="181cred">cred</dfn>, <b>struct</b> <a class="type" href="../sys/lwp.h.html#lwp" title='lwp' data-ref="lwp" data-ref-filename="lwp">lwp</a> *<dfn class="local col2 decl" id="182l" title='l' data-type='struct lwp *' data-ref="182l" data-ref-filename="182l">l</dfn>,</td></tr>
<tr><th id="343">343</th><td><i>/*out*/</i>	<b>struct</b> <a class="type" href="../sys/vnode.h.html#vattr" title='vattr' data-ref="vattr" data-ref-filename="vattr">vattr</a> *<dfn class="local col3 decl" id="183vap" title='vap' data-type='struct vattr *' data-ref="183vap" data-ref-filename="183vap">vap</dfn>)</td></tr>
<tr><th id="344">344</th><td>{</td></tr>
<tr><th id="345">345</th><td>    <a class="macro" href="#72" title="struct coda_getattr_in *inp; struct coda_getattr_out *outp; int coda_getattr_size = sizeof (struct coda_getattr_in); int Isize = sizeof (struct coda_getattr_in); int Osize = sizeof (struct coda_getattr_out); int error" data-ref="_M/DECL">DECL</a>(coda_getattr);			<i>/* sets Isize &amp; Osize */</i></td></tr>
<tr><th id="346">346</th><td>    <a class="macro" href="#93" title="if (Osize &gt; coda_getattr_size) coda_getattr_size = Osize; do { inp = (struct coda_getattr_in *)kern_malloc((unsigned long) coda_getattr_size, 0x0000); if (inp == 0) { panic(&quot;kernel malloc returns 0 at %s:%d\n&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 346); } } while ( 0); outp = (struct coda_getattr_out *) inp" data-ref="_M/ALLOC">ALLOC</a>(coda_getattr);			<i>/* sets inp &amp; outp */</i></td></tr>
<tr><th id="347">347</th><td></td></tr>
<tr><th id="348">348</th><td>    <i>/* send the open to venus. */</i></td></tr>
<tr><th id="349">349</th><td>    <a class="macro" href="#145" title="(&amp;inp-&gt;ih)-&gt;opcode = (7); (&amp;inp-&gt;ih)-&gt;pid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pid : -1; (&amp;inp-&gt;ih)-&gt;pgid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pgrp-&gt;pg_id : -1; (__builtin_expect(((cred != ((void *)0))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != NULL&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 349)); (__builtin_expect(((cred != ((kauth_cred_t)-2))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != FSCRED&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 349)); if (cred != ((kauth_cred_t)-1)) { (&amp;inp-&gt;ih)-&gt;uid = kauth_cred_geteuid(cred); } else { (&amp;inp-&gt;ih)-&gt;uid = -1; }" data-ref="_M/INIT_IN_L">INIT_IN_L</a>(&amp;<a class="local col4 ref" href="#345" title='inp' data-ref="184inp" data-ref-filename="184inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_getattr_in::ih" title='coda_getattr_in::ih' data-ref="coda_getattr_in::ih" data-ref-filename="coda_getattr_in..ih">ih</a>, <a class="macro" href="coda.h.html#314" title="7" data-ref="_M/CODA_GETATTR">CODA_GETATTR</a>, <a class="local col1 ref" href="#181cred" title='cred' data-ref="181cred" data-ref-filename="181cred">cred</a>, <a class="local col2 ref" href="#182l" title='l' data-ref="182l" data-ref-filename="182l">l</a>);</td></tr>
<tr><th id="350">350</th><td>    <a class="local col4 ref" href="#345" title='inp' data-ref="184inp" data-ref-filename="184inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_getattr_in::Fid" title='coda_getattr_in::Fid' data-ref="coda_getattr_in::Fid" data-ref-filename="coda_getattr_in..Fid">Fid</a> = *<a class="local col0 ref" href="#180fid" title='fid' data-ref="180fid" data-ref-filename="180fid">fid</a>;</td></tr>
<tr><th id="351">351</th><td></td></tr>
<tr><th id="352">352</th><td>    <a class="local col8 ref" href="#345" title='error' data-ref="188error" data-ref-filename="188error">error</a> = <a class="ref fn" href="cnode.h.html#coda_call" title='coda_call' data-ref="coda_call" data-ref-filename="coda_call">coda_call</a>(<a class="local col9 ref" href="#179mdp" title='mdp' data-ref="179mdp" data-ref-filename="179mdp">mdp</a>, <a class="local col6 ref" href="#345" title='Isize' data-ref="186Isize" data-ref-filename="186Isize">Isize</a>, &amp;<a class="local col7 ref" href="#345" title='Osize' data-ref="187Osize" data-ref-filename="187Osize">Osize</a>, (<em>char</em> *)<a class="local col4 ref" href="#345" title='inp' data-ref="184inp" data-ref-filename="184inp">inp</a>);</td></tr>
<tr><th id="353">353</th><td>    <b>if</b> (!<a class="local col8 ref" href="#345" title='error' data-ref="188error" data-ref-filename="188error">error</a>) {</td></tr>
<tr><th id="354">354</th><td>	<a class="macro" href="#158" title="do { (vap)-&gt;va_type = (&amp;outp-&gt;attr)-&gt;va_type; (vap)-&gt;va_mode = (&amp;outp-&gt;attr)-&gt;va_mode; (vap)-&gt;va_nlink = (&amp;outp-&gt;attr)-&gt;va_nlink; (vap)-&gt;va_uid = (&amp;outp-&gt;attr)-&gt;va_uid; (vap)-&gt;va_gid = (&amp;outp-&gt;attr)-&gt;va_gid; (vap)-&gt;va_fsid = (-1); (vap)-&gt;va_fileid = (&amp;outp-&gt;attr)-&gt;va_fileid; (vap)-&gt;va_size = (&amp;outp-&gt;attr)-&gt;va_size; (vap)-&gt;va_blocksize = (&amp;outp-&gt;attr)-&gt;va_blocksize; (vap)-&gt;va_atime = (&amp;outp-&gt;attr)-&gt;va_atime; (vap)-&gt;va_mtime = (&amp;outp-&gt;attr)-&gt;va_mtime; (vap)-&gt;va_ctime = (&amp;outp-&gt;attr)-&gt;va_ctime; (vap)-&gt;va_gen = (&amp;outp-&gt;attr)-&gt;va_gen; (vap)-&gt;va_flags = (&amp;outp-&gt;attr)-&gt;va_flags; (vap)-&gt;va_rdev = (&amp;outp-&gt;attr)-&gt;va_rdev; (vap)-&gt;va_bytes = (&amp;outp-&gt;attr)-&gt;va_bytes; (vap)-&gt;va_filerev = (&amp;outp-&gt;attr)-&gt;va_filerev; (vap)-&gt;va_vaflags = (-1); (vap)-&gt;va_spare = (-1); } while ( 0)" data-ref="_M/CNV_VV2V_ATTR">CNV_VV2V_ATTR</a>(<a class="local col3 ref" href="#183vap" title='vap' data-ref="183vap" data-ref-filename="183vap">vap</a>, &amp;<a class="local col5 ref" href="#345" title='outp' data-ref="185outp" data-ref-filename="185outp">outp</a>-&gt;<a class="ref field" href="coda.h.html#coda_getattr_out::attr" title='coda_getattr_out::attr' data-ref="coda_getattr_out::attr" data-ref-filename="coda_getattr_out..attr">attr</a>);</td></tr>
<tr><th id="355">355</th><td>    }</td></tr>
<tr><th id="356">356</th><td></td></tr>
<tr><th id="357">357</th><td>    <a class="macro" href="cnode.h.html#71" title="kern_free((inp))" data-ref="_M/CODA_FREE">CODA_FREE</a>(<a class="local col4 ref" href="#345" title='inp' data-ref="184inp" data-ref-filename="184inp">inp</a>, coda_getattr_size);</td></tr>
<tr><th id="358">358</th><td>    <b>return</b> <a class="local col8 ref" href="#345" title='error' data-ref="188error" data-ref-filename="188error">error</a>;</td></tr>
<tr><th id="359">359</th><td>}</td></tr>
<tr><th id="360">360</th><td></td></tr>
<tr><th id="361">361</th><td><em>int</em></td></tr>
<tr><th id="362">362</th><td><dfn class="decl def fn" id="venus_setattr" title='venus_setattr' data-ref="venus_setattr" data-ref-filename="venus_setattr">venus_setattr</dfn>(<em>void</em> *<dfn class="local col9 decl" id="189mdp" title='mdp' data-type='void *' data-ref="189mdp" data-ref-filename="189mdp">mdp</dfn>, <a class="typedef" href="coda.h.html#CodaFid" title='CodaFid' data-type='struct CodaFid' data-ref="CodaFid" data-ref-filename="CodaFid">CodaFid</a> *<dfn class="local col0 decl" id="190fid" title='fid' data-type='CodaFid *' data-ref="190fid" data-ref-filename="190fid">fid</dfn>, <b>struct</b> <a class="type" href="../sys/vnode.h.html#vattr" title='vattr' data-ref="vattr" data-ref-filename="vattr">vattr</a> *<dfn class="local col1 decl" id="191vap" title='vap' data-type='struct vattr *' data-ref="191vap" data-ref-filename="191vap">vap</dfn>,</td></tr>
<tr><th id="363">363</th><td>	<a class="typedef" href="../sys/types.h.html#kauth_cred_t" title='kauth_cred_t' data-type='struct kauth_cred *' data-ref="kauth_cred_t" data-ref-filename="kauth_cred_t">kauth_cred_t</a> <dfn class="local col2 decl" id="192cred" title='cred' data-type='kauth_cred_t' data-ref="192cred" data-ref-filename="192cred">cred</dfn>, <b>struct</b> <a class="type" href="../sys/lwp.h.html#lwp" title='lwp' data-ref="lwp" data-ref-filename="lwp">lwp</a> *<dfn class="local col3 decl" id="193l" title='l' data-type='struct lwp *' data-ref="193l" data-ref-filename="193l">l</dfn>)</td></tr>
<tr><th id="364">364</th><td>{</td></tr>
<tr><th id="365">365</th><td>    <a class="macro" href="#80" title="struct coda_setattr_in *inp; int coda_setattr_size = sizeof (struct coda_setattr_in); int Isize = sizeof (struct coda_setattr_in); int Osize = sizeof (struct coda_out_hdr); int error" data-ref="_M/DECL_NO_OUT">DECL_NO_OUT</a>(coda_setattr);		<i>/* sets Isize &amp; Osize */</i></td></tr>
<tr><th id="366">366</th><td>    <a class="macro" href="#99" title="if (Osize &gt; coda_setattr_size) coda_setattr_size = Osize; do { inp = (struct coda_setattr_in *)kern_malloc((unsigned long) coda_setattr_size, 0x0000); if (inp == 0) { panic(&quot;kernel malloc returns 0 at %s:%d\n&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 366); } } while ( 0);" data-ref="_M/ALLOC_NO_OUT">ALLOC_NO_OUT</a>(coda_setattr);		<i>/* sets inp &amp; outp */</i></td></tr>
<tr><th id="367">367</th><td></td></tr>
<tr><th id="368">368</th><td>    <i>/* send the open to venus. */</i></td></tr>
<tr><th id="369">369</th><td>    <a class="macro" href="#145" title="(&amp;inp-&gt;ih)-&gt;opcode = (8); (&amp;inp-&gt;ih)-&gt;pid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pid : -1; (&amp;inp-&gt;ih)-&gt;pgid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pgrp-&gt;pg_id : -1; (__builtin_expect(((cred != ((void *)0))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != NULL&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 369)); (__builtin_expect(((cred != ((kauth_cred_t)-2))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != FSCRED&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 369)); if (cred != ((kauth_cred_t)-1)) { (&amp;inp-&gt;ih)-&gt;uid = kauth_cred_geteuid(cred); } else { (&amp;inp-&gt;ih)-&gt;uid = -1; }" data-ref="_M/INIT_IN_L">INIT_IN_L</a>(&amp;<a class="local col4 ref" href="#365" title='inp' data-ref="194inp" data-ref-filename="194inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_setattr_in::ih" title='coda_setattr_in::ih' data-ref="coda_setattr_in::ih" data-ref-filename="coda_setattr_in..ih">ih</a>, <a class="macro" href="coda.h.html#315" title="8" data-ref="_M/CODA_SETATTR">CODA_SETATTR</a>, <a class="local col2 ref" href="#192cred" title='cred' data-ref="192cred" data-ref-filename="192cred">cred</a>, <a class="local col3 ref" href="#193l" title='l' data-ref="193l" data-ref-filename="193l">l</a>);</td></tr>
<tr><th id="370">370</th><td>    <a class="local col4 ref" href="#365" title='inp' data-ref="194inp" data-ref-filename="194inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_setattr_in::Fid" title='coda_setattr_in::Fid' data-ref="coda_setattr_in::Fid" data-ref-filename="coda_setattr_in..Fid">Fid</a> = *<a class="local col0 ref" href="#190fid" title='fid' data-ref="190fid" data-ref-filename="190fid">fid</a>;</td></tr>
<tr><th id="371">371</th><td>    <a class="macro" href="#181" title="do { (&amp;inp-&gt;attr)-&gt;va_type = (vap)-&gt;va_type; (&amp;inp-&gt;attr)-&gt;va_mode = (vap)-&gt;va_mode; (&amp;inp-&gt;attr)-&gt;va_nlink = (vap)-&gt;va_nlink; (&amp;inp-&gt;attr)-&gt;va_uid = (vap)-&gt;va_uid; (&amp;inp-&gt;attr)-&gt;va_gid = (vap)-&gt;va_gid; (&amp;inp-&gt;attr)-&gt;va_fileid = (vap)-&gt;va_fileid; (&amp;inp-&gt;attr)-&gt;va_size = (vap)-&gt;va_size; (&amp;inp-&gt;attr)-&gt;va_blocksize = (vap)-&gt;va_blocksize; (&amp;inp-&gt;attr)-&gt;va_atime = (vap)-&gt;va_atime; (&amp;inp-&gt;attr)-&gt;va_mtime = (vap)-&gt;va_mtime; (&amp;inp-&gt;attr)-&gt;va_ctime = (vap)-&gt;va_ctime; (&amp;inp-&gt;attr)-&gt;va_gen = (vap)-&gt;va_gen; (&amp;inp-&gt;attr)-&gt;va_flags = (vap)-&gt;va_flags; (&amp;inp-&gt;attr)-&gt;va_rdev = (vap)-&gt;va_rdev; (&amp;inp-&gt;attr)-&gt;va_bytes = (vap)-&gt;va_bytes; (&amp;inp-&gt;attr)-&gt;va_filerev = (vap)-&gt;va_filerev; } while ( 0)" data-ref="_M/CNV_V2VV_ATTR">CNV_V2VV_ATTR</a>(&amp;<a class="local col4 ref" href="#365" title='inp' data-ref="194inp" data-ref-filename="194inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_setattr_in::attr" title='coda_setattr_in::attr' data-ref="coda_setattr_in::attr" data-ref-filename="coda_setattr_in..attr">attr</a>, <a class="local col1 ref" href="#191vap" title='vap' data-ref="191vap" data-ref-filename="191vap">vap</a>);</td></tr>
<tr><th id="372">372</th><td></td></tr>
<tr><th id="373">373</th><td>    <a class="local col7 ref" href="#365" title='error' data-ref="197error" data-ref-filename="197error">error</a> = <a class="ref fn" href="cnode.h.html#coda_call" title='coda_call' data-ref="coda_call" data-ref-filename="coda_call">coda_call</a>(<a class="local col9 ref" href="#189mdp" title='mdp' data-ref="189mdp" data-ref-filename="189mdp">mdp</a>, <a class="local col5 ref" href="#365" title='Isize' data-ref="195Isize" data-ref-filename="195Isize">Isize</a>, &amp;<a class="local col6 ref" href="#365" title='Osize' data-ref="196Osize" data-ref-filename="196Osize">Osize</a>, (<em>char</em> *)<a class="local col4 ref" href="#365" title='inp' data-ref="194inp" data-ref-filename="194inp">inp</a>);</td></tr>
<tr><th id="374">374</th><td></td></tr>
<tr><th id="375">375</th><td>    <a class="macro" href="cnode.h.html#71" title="kern_free((inp))" data-ref="_M/CODA_FREE">CODA_FREE</a>(<a class="local col4 ref" href="#365" title='inp' data-ref="194inp" data-ref-filename="194inp">inp</a>, coda_setattr_size);</td></tr>
<tr><th id="376">376</th><td>    <b>return</b> <a class="local col7 ref" href="#365" title='error' data-ref="197error" data-ref-filename="197error">error</a>;</td></tr>
<tr><th id="377">377</th><td>}</td></tr>
<tr><th id="378">378</th><td></td></tr>
<tr><th id="379">379</th><td><em>int</em></td></tr>
<tr><th id="380">380</th><td><dfn class="decl def fn" id="venus_access" title='venus_access' data-ref="venus_access" data-ref-filename="venus_access">venus_access</dfn>(<em>void</em> *<dfn class="local col8 decl" id="198mdp" title='mdp' data-type='void *' data-ref="198mdp" data-ref-filename="198mdp">mdp</dfn>, <a class="typedef" href="coda.h.html#CodaFid" title='CodaFid' data-type='struct CodaFid' data-ref="CodaFid" data-ref-filename="CodaFid">CodaFid</a> *<dfn class="local col9 decl" id="199fid" title='fid' data-type='CodaFid *' data-ref="199fid" data-ref-filename="199fid">fid</dfn>, <em>int</em> <dfn class="local col0 decl" id="200mode" title='mode' data-type='int' data-ref="200mode" data-ref-filename="200mode">mode</dfn>,</td></tr>
<tr><th id="381">381</th><td>	<a class="typedef" href="../sys/types.h.html#kauth_cred_t" title='kauth_cred_t' data-type='struct kauth_cred *' data-ref="kauth_cred_t" data-ref-filename="kauth_cred_t">kauth_cred_t</a> <dfn class="local col1 decl" id="201cred" title='cred' data-type='kauth_cred_t' data-ref="201cred" data-ref-filename="201cred">cred</dfn>, <b>struct</b> <a class="type" href="../sys/lwp.h.html#lwp" title='lwp' data-ref="lwp" data-ref-filename="lwp">lwp</a> *<dfn class="local col2 decl" id="202l" title='l' data-type='struct lwp *' data-ref="202l" data-ref-filename="202l">l</dfn>)</td></tr>
<tr><th id="382">382</th><td>{</td></tr>
<tr><th id="383">383</th><td>    <a class="macro" href="#80" title="struct coda_access_in *inp; int coda_access_size = sizeof (struct coda_access_in); int Isize = sizeof (struct coda_access_in); int Osize = sizeof (struct coda_out_hdr); int error" data-ref="_M/DECL_NO_OUT">DECL_NO_OUT</a>(coda_access);		<i>/* sets Isize &amp; Osize */</i></td></tr>
<tr><th id="384">384</th><td>    <a class="macro" href="#99" title="if (Osize &gt; coda_access_size) coda_access_size = Osize; do { inp = (struct coda_access_in *)kern_malloc((unsigned long) coda_access_size, 0x0000); if (inp == 0) { panic(&quot;kernel malloc returns 0 at %s:%d\n&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 384); } } while ( 0);" data-ref="_M/ALLOC_NO_OUT">ALLOC_NO_OUT</a>(coda_access);		<i>/* sets inp &amp; outp */</i></td></tr>
<tr><th id="385">385</th><td></td></tr>
<tr><th id="386">386</th><td>    <i>/* send the open to venus. */</i></td></tr>
<tr><th id="387">387</th><td>    <a class="macro" href="#145" title="(&amp;inp-&gt;ih)-&gt;opcode = (9); (&amp;inp-&gt;ih)-&gt;pid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pid : -1; (&amp;inp-&gt;ih)-&gt;pgid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pgrp-&gt;pg_id : -1; (__builtin_expect(((cred != ((void *)0))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != NULL&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 387)); (__builtin_expect(((cred != ((kauth_cred_t)-2))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != FSCRED&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 387)); if (cred != ((kauth_cred_t)-1)) { (&amp;inp-&gt;ih)-&gt;uid = kauth_cred_geteuid(cred); } else { (&amp;inp-&gt;ih)-&gt;uid = -1; }" data-ref="_M/INIT_IN_L">INIT_IN_L</a>(&amp;<a class="local col3 ref" href="#383" title='inp' data-ref="203inp" data-ref-filename="203inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_access_in::ih" title='coda_access_in::ih' data-ref="coda_access_in::ih" data-ref-filename="coda_access_in..ih">ih</a>, <a class="macro" href="coda.h.html#316" title="9" data-ref="_M/CODA_ACCESS">CODA_ACCESS</a>, <a class="local col1 ref" href="#201cred" title='cred' data-ref="201cred" data-ref-filename="201cred">cred</a>, <a class="local col2 ref" href="#202l" title='l' data-ref="202l" data-ref-filename="202l">l</a>);</td></tr>
<tr><th id="388">388</th><td>    <a class="local col3 ref" href="#383" title='inp' data-ref="203inp" data-ref-filename="203inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_access_in::Fid" title='coda_access_in::Fid' data-ref="coda_access_in::Fid" data-ref-filename="coda_access_in..Fid">Fid</a> = *<a class="local col9 ref" href="#199fid" title='fid' data-ref="199fid" data-ref-filename="199fid">fid</a>;</td></tr>
<tr><th id="389">389</th><td>    <a class="local col3 ref" href="#383" title='inp' data-ref="203inp" data-ref-filename="203inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_access_in::flags" title='coda_access_in::flags' data-ref="coda_access_in::flags" data-ref-filename="coda_access_in..flags">flags</a> = <a class="local col0 ref" href="#200mode" title='mode' data-ref="200mode" data-ref-filename="200mode">mode</a>;</td></tr>
<tr><th id="390">390</th><td></td></tr>
<tr><th id="391">391</th><td>    <a class="local col6 ref" href="#383" title='error' data-ref="206error" data-ref-filename="206error">error</a> = <a class="ref fn" href="cnode.h.html#coda_call" title='coda_call' data-ref="coda_call" data-ref-filename="coda_call">coda_call</a>(<a class="local col8 ref" href="#198mdp" title='mdp' data-ref="198mdp" data-ref-filename="198mdp">mdp</a>, <a class="local col4 ref" href="#383" title='Isize' data-ref="204Isize" data-ref-filename="204Isize">Isize</a>, &amp;<a class="local col5 ref" href="#383" title='Osize' data-ref="205Osize" data-ref-filename="205Osize">Osize</a>, (<em>char</em> *)<a class="local col3 ref" href="#383" title='inp' data-ref="203inp" data-ref-filename="203inp">inp</a>);</td></tr>
<tr><th id="392">392</th><td></td></tr>
<tr><th id="393">393</th><td>    <a class="macro" href="cnode.h.html#71" title="kern_free((inp))" data-ref="_M/CODA_FREE">CODA_FREE</a>(<a class="local col3 ref" href="#383" title='inp' data-ref="203inp" data-ref-filename="203inp">inp</a>, coda_access_size);</td></tr>
<tr><th id="394">394</th><td>    <b>return</b> <a class="local col6 ref" href="#383" title='error' data-ref="206error" data-ref-filename="206error">error</a>;</td></tr>
<tr><th id="395">395</th><td>}</td></tr>
<tr><th id="396">396</th><td></td></tr>
<tr><th id="397">397</th><td><em>int</em></td></tr>
<tr><th id="398">398</th><td><dfn class="decl def fn" id="venus_readlink" title='venus_readlink' data-ref="venus_readlink" data-ref-filename="venus_readlink">venus_readlink</dfn>(<em>void</em> *<dfn class="local col7 decl" id="207mdp" title='mdp' data-type='void *' data-ref="207mdp" data-ref-filename="207mdp">mdp</dfn>, <a class="typedef" href="coda.h.html#CodaFid" title='CodaFid' data-type='struct CodaFid' data-ref="CodaFid" data-ref-filename="CodaFid">CodaFid</a> *<dfn class="local col8 decl" id="208fid" title='fid' data-type='CodaFid *' data-ref="208fid" data-ref-filename="208fid">fid</dfn>,</td></tr>
<tr><th id="399">399</th><td>	<a class="typedef" href="../sys/types.h.html#kauth_cred_t" title='kauth_cred_t' data-type='struct kauth_cred *' data-ref="kauth_cred_t" data-ref-filename="kauth_cred_t">kauth_cred_t</a> <dfn class="local col9 decl" id="209cred" title='cred' data-type='kauth_cred_t' data-ref="209cred" data-ref-filename="209cred">cred</dfn>, <b>struct</b> <a class="type" href="../sys/lwp.h.html#lwp" title='lwp' data-ref="lwp" data-ref-filename="lwp">lwp</a> *<dfn class="local col0 decl" id="210l" title='l' data-type='struct lwp *' data-ref="210l" data-ref-filename="210l">l</dfn>,</td></tr>
<tr><th id="400">400</th><td><i>/*out*/</i>	<em>char</em> **<dfn class="local col1 decl" id="211str" title='str' data-type='char **' data-ref="211str" data-ref-filename="211str">str</dfn>, <em>int</em> *<dfn class="local col2 decl" id="212len" title='len' data-type='int *' data-ref="212len" data-ref-filename="212len">len</dfn>)</td></tr>
<tr><th id="401">401</th><td>{</td></tr>
<tr><th id="402">402</th><td>    <a class="macro" href="#72" title="struct coda_readlink_in *inp; struct coda_readlink_out *outp; int coda_readlink_size = sizeof (struct coda_readlink_in); int Isize = sizeof (struct coda_readlink_in); int Osize = sizeof (struct coda_readlink_out); int error" data-ref="_M/DECL">DECL</a>(coda_readlink);			<i>/* sets Isize &amp; Osize */</i></td></tr>
<tr><th id="403">403</th><td>    <i>/* XXX coda_readlink_size should not be set here */</i></td></tr>
<tr><th id="404">404</th><td>    <a class="local col8 ref" href="#402" title='coda_readlink_size' data-ref="218coda_readlink_size" data-ref-filename="218coda_readlink_size">coda_readlink_size</a> += <a class="macro" href="coda.h.html#133" title="1024" data-ref="_M/CODA_MAXPATHLEN">CODA_MAXPATHLEN</a>;</td></tr>
<tr><th id="405">405</th><td>    <a class="local col6 ref" href="#402" title='Osize' data-ref="216Osize" data-ref-filename="216Osize">Osize</a> += <a class="macro" href="coda.h.html#133" title="1024" data-ref="_M/CODA_MAXPATHLEN">CODA_MAXPATHLEN</a>;</td></tr>
<tr><th id="406">406</th><td>    <a class="macro" href="#93" title="if (Osize &gt; coda_readlink_size) coda_readlink_size = Osize; do { inp = (struct coda_readlink_in *)kern_malloc((unsigned long) coda_readlink_size, 0x0000); if (inp == 0) { panic(&quot;kernel malloc returns 0 at %s:%d\n&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 406); } } while ( 0); outp = (struct coda_readlink_out *) inp" data-ref="_M/ALLOC">ALLOC</a>(coda_readlink);		<i>/* sets inp &amp; outp */</i></td></tr>
<tr><th id="407">407</th><td></td></tr>
<tr><th id="408">408</th><td>    <i>/* send the open to venus. */</i></td></tr>
<tr><th id="409">409</th><td>    <a class="macro" href="#145" title="(&amp;inp-&gt;ih)-&gt;opcode = (19); (&amp;inp-&gt;ih)-&gt;pid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pid : -1; (&amp;inp-&gt;ih)-&gt;pgid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pgrp-&gt;pg_id : -1; (__builtin_expect(((cred != ((void *)0))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != NULL&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 409)); (__builtin_expect(((cred != ((kauth_cred_t)-2))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != FSCRED&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 409)); if (cred != ((kauth_cred_t)-1)) { (&amp;inp-&gt;ih)-&gt;uid = kauth_cred_geteuid(cred); } else { (&amp;inp-&gt;ih)-&gt;uid = -1; }" data-ref="_M/INIT_IN_L">INIT_IN_L</a>(&amp;<a class="local col3 ref" href="#402" title='inp' data-ref="213inp" data-ref-filename="213inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_readlink_in::ih" title='coda_readlink_in::ih' data-ref="coda_readlink_in::ih" data-ref-filename="coda_readlink_in..ih">ih</a>, <a class="macro" href="coda.h.html#326" title="19" data-ref="_M/CODA_READLINK">CODA_READLINK</a>, <a class="local col9 ref" href="#209cred" title='cred' data-ref="209cred" data-ref-filename="209cred">cred</a>, <a class="local col0 ref" href="#210l" title='l' data-ref="210l" data-ref-filename="210l">l</a>);</td></tr>
<tr><th id="410">410</th><td>    <a class="local col3 ref" href="#402" title='inp' data-ref="213inp" data-ref-filename="213inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_readlink_in::Fid" title='coda_readlink_in::Fid' data-ref="coda_readlink_in::Fid" data-ref-filename="coda_readlink_in..Fid">Fid</a> = *<a class="local col8 ref" href="#208fid" title='fid' data-ref="208fid" data-ref-filename="208fid">fid</a>;</td></tr>
<tr><th id="411">411</th><td></td></tr>
<tr><th id="412">412</th><td>    <a class="local col7 ref" href="#402" title='error' data-ref="217error" data-ref-filename="217error">error</a> = <a class="ref fn" href="cnode.h.html#coda_call" title='coda_call' data-ref="coda_call" data-ref-filename="coda_call">coda_call</a>(<a class="local col7 ref" href="#207mdp" title='mdp' data-ref="207mdp" data-ref-filename="207mdp">mdp</a>, <a class="local col5 ref" href="#402" title='Isize' data-ref="215Isize" data-ref-filename="215Isize">Isize</a>, &amp;<a class="local col6 ref" href="#402" title='Osize' data-ref="216Osize" data-ref-filename="216Osize">Osize</a>, (<em>char</em> *)<a class="local col3 ref" href="#402" title='inp' data-ref="213inp" data-ref-filename="213inp">inp</a>);</td></tr>
<tr><th id="413">413</th><td>    <a class="macro" href="../lib/libkern/libkern.h.html#279" title="(__builtin_expect(((outp != ((void *)0))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;outp != NULL&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 413))" data-ref="_M/KASSERT">KASSERT</a>(<a class="local col4 ref" href="#402" title='outp' data-ref="214outp" data-ref-filename="214outp">outp</a> != <a class="macro" href="../sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>);</td></tr>
<tr><th id="414">414</th><td>    <b>if</b> (<a class="local col7 ref" href="#402" title='error' data-ref="217error" data-ref-filename="217error">error</a> != <var>0</var>)</td></tr>
<tr><th id="415">415</th><td>	    <b>goto</b> <a class="lbl" href="#219out" data-ref="219out" data-ref-filename="219out">out</a>;</td></tr>
<tr><th id="416">416</th><td></td></tr>
<tr><th id="417">417</th><td>    <i>/* Check count for reasonableness */</i></td></tr>
<tr><th id="418">418</th><td>    <b>if</b> (<a class="local col4 ref" href="#402" title='outp' data-ref="214outp" data-ref-filename="214outp">outp</a>-&gt;<a class="ref field" href="coda.h.html#coda_readlink_out::count" title='coda_readlink_out::count' data-ref="coda_readlink_out::count" data-ref-filename="coda_readlink_out..count">count</a> &lt;= <var>0</var> || <a class="local col4 ref" href="#402" title='outp' data-ref="214outp" data-ref-filename="214outp">outp</a>-&gt;<a class="ref field" href="coda.h.html#coda_readlink_out::count" title='coda_readlink_out::count' data-ref="coda_readlink_out::count" data-ref-filename="coda_readlink_out..count">count</a> &gt; <a class="macro" href="coda.h.html#133" title="1024" data-ref="_M/CODA_MAXPATHLEN">CODA_MAXPATHLEN</a>) {</td></tr>
<tr><th id="419">419</th><td>	    <a class="ref fn" href="../sys/systm.h.html#printf" title='printf' data-ref="printf" data-ref-filename="printf">printf</a>(<q>"venus_readlink: bad count %d\n"</q>, <a class="local col4 ref" href="#402" title='outp' data-ref="214outp" data-ref-filename="214outp">outp</a>-&gt;<a class="ref field" href="coda.h.html#coda_readlink_out::count" title='coda_readlink_out::count' data-ref="coda_readlink_out::count" data-ref-filename="coda_readlink_out..count">count</a>);</td></tr>
<tr><th id="420">420</th><td>	    <a class="local col7 ref" href="#402" title='error' data-ref="217error" data-ref-filename="217error">error</a> = <a class="macro" href="../sys/errno.h.html#64" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="421">421</th><td>	    <b>goto</b> <a class="lbl" href="#219out" data-ref="219out" data-ref-filename="219out">out</a>;</td></tr>
<tr><th id="422">422</th><td>    }</td></tr>
<tr><th id="423">423</th><td></td></tr>
<tr><th id="424">424</th><td>    <i>/*</i></td></tr>
<tr><th id="425">425</th><td><i>     * Check data pointer for reasonableness.  It must point after</i></td></tr>
<tr><th id="426">426</th><td><i>     * itself, and within the allocated region.</i></td></tr>
<tr><th id="427">427</th><td><i>     */</i></td></tr>
<tr><th id="428">428</th><td>    <b>if</b> ((<a class="typedef" href="../sys/stdint.h.html#intptr_t" title='intptr_t' data-type='__intptr_t' data-ref="intptr_t" data-ref-filename="intptr_t">intptr_t</a>) <a class="local col4 ref" href="#402" title='outp' data-ref="214outp" data-ref-filename="214outp">outp</a>-&gt;<a class="ref field" href="coda.h.html#coda_readlink_out::data" title='coda_readlink_out::data' data-ref="coda_readlink_out::data" data-ref-filename="coda_readlink_out..data">data</a> &lt; <b>sizeof</b>(<b>struct</b> <a class="type" href="coda.h.html#coda_readlink_out" title='coda_readlink_out' data-ref="coda_readlink_out" data-ref-filename="coda_readlink_out">coda_readlink_out</a>) ) {</td></tr>
<tr><th id="429">429</th><td>	    <a class="ref fn" href="../sys/systm.h.html#printf" title='printf' data-ref="printf" data-ref-filename="printf">printf</a>(<q>"venus_readlink: data pointer %lld too low\n"</q>,</td></tr>
<tr><th id="430">430</th><td>		   (<em>long</em> <em>long</em>)((<a class="typedef" href="../sys/stdint.h.html#intptr_t" title='intptr_t' data-type='__intptr_t' data-ref="intptr_t" data-ref-filename="intptr_t">intptr_t</a>) <a class="local col4 ref" href="#402" title='outp' data-ref="214outp" data-ref-filename="214outp">outp</a>-&gt;<a class="ref field" href="coda.h.html#coda_readlink_out::data" title='coda_readlink_out::data' data-ref="coda_readlink_out::data" data-ref-filename="coda_readlink_out..data">data</a>));</td></tr>
<tr><th id="431">431</th><td>	    <a class="local col7 ref" href="#402" title='error' data-ref="217error" data-ref-filename="217error">error</a> = <a class="macro" href="../sys/errno.h.html#64" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="432">432</th><td>	    <b>goto</b> <a class="lbl" href="#219out" data-ref="219out" data-ref-filename="219out">out</a>;</td></tr>
<tr><th id="433">433</th><td>    }</td></tr>
<tr><th id="434">434</th><td>    </td></tr>
<tr><th id="435">435</th><td>    <b>if</b> ((<a class="typedef" href="../sys/stdint.h.html#intptr_t" title='intptr_t' data-type='__intptr_t' data-ref="intptr_t" data-ref-filename="intptr_t">intptr_t</a>) <a class="local col4 ref" href="#402" title='outp' data-ref="214outp" data-ref-filename="214outp">outp</a>-&gt;<a class="ref field" href="coda.h.html#coda_readlink_out::data" title='coda_readlink_out::data' data-ref="coda_readlink_out::data" data-ref-filename="coda_readlink_out..data">data</a> + <a class="local col4 ref" href="#402" title='outp' data-ref="214outp" data-ref-filename="214outp">outp</a>-&gt;<a class="ref field" href="coda.h.html#coda_readlink_out::count" title='coda_readlink_out::count' data-ref="coda_readlink_out::count" data-ref-filename="coda_readlink_out..count">count</a> &gt;</td></tr>
<tr><th id="436">436</th><td>	<b>sizeof</b>(<b>struct</b> <a class="type" href="coda.h.html#coda_readlink_out" title='coda_readlink_out' data-ref="coda_readlink_out" data-ref-filename="coda_readlink_out">coda_readlink_out</a>) + <a class="macro" href="coda.h.html#133" title="1024" data-ref="_M/CODA_MAXPATHLEN">CODA_MAXPATHLEN</a>) {</td></tr>
<tr><th id="437">437</th><td>	    <a class="ref fn" href="../sys/systm.h.html#printf" title='printf' data-ref="printf" data-ref-filename="printf">printf</a>(<q>"venus_readlink: data pointer %lld too high\n"</q>,</td></tr>
<tr><th id="438">438</th><td>		   (<em>long</em> <em>long</em>)((<a class="typedef" href="../sys/stdint.h.html#intptr_t" title='intptr_t' data-type='__intptr_t' data-ref="intptr_t" data-ref-filename="intptr_t">intptr_t</a>) <a class="local col4 ref" href="#402" title='outp' data-ref="214outp" data-ref-filename="214outp">outp</a>-&gt;<a class="ref field" href="coda.h.html#coda_readlink_out::data" title='coda_readlink_out::data' data-ref="coda_readlink_out::data" data-ref-filename="coda_readlink_out..data">data</a>));</td></tr>
<tr><th id="439">439</th><td>	    <a class="local col7 ref" href="#402" title='error' data-ref="217error" data-ref-filename="217error">error</a> = <a class="macro" href="../sys/errno.h.html#64" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="440">440</th><td>	    <b>goto</b> <a class="lbl" href="#219out" data-ref="219out" data-ref-filename="219out">out</a>;</td></tr>
<tr><th id="441">441</th><td>    }</td></tr>
<tr><th id="442">442</th><td></td></tr>
<tr><th id="443">443</th><td>    <b>if</b> (!<a class="local col7 ref" href="#402" title='error' data-ref="217error" data-ref-filename="217error">error</a>) {</td></tr>
<tr><th id="444">444</th><td>	    <a class="macro" href="cnode.h.html#63" title="do { *str = (char *)kern_malloc((unsigned long) outp-&gt;count, 0x0000); if (*str == 0) { panic(&quot;kernel malloc returns 0 at %s:%d\n&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 444); } } while ( 0)" data-ref="_M/CODA_ALLOC">CODA_ALLOC</a>(*<a class="local col1 ref" href="#211str" title='str' data-ref="211str" data-ref-filename="211str">str</a>, <em>char</em> *, <a class="local col4 ref" href="#402" title='outp' data-ref="214outp" data-ref-filename="214outp">outp</a>-&gt;<a class="ref field" href="coda.h.html#coda_readlink_out::count" title='coda_readlink_out::count' data-ref="coda_readlink_out::count" data-ref-filename="coda_readlink_out..count">count</a>);</td></tr>
<tr><th id="445">445</th><td>	    *<a class="local col2 ref" href="#212len" title='len' data-ref="212len" data-ref-filename="212len">len</a> = <a class="local col4 ref" href="#402" title='outp' data-ref="214outp" data-ref-filename="214outp">outp</a>-&gt;<a class="ref field" href="coda.h.html#coda_readlink_out::count" title='coda_readlink_out::count' data-ref="coda_readlink_out::count" data-ref-filename="coda_readlink_out..count">count</a>;</td></tr>
<tr><th id="446">446</th><td>	    <a class="macro" href="../lib/libkern/libkern.h.html#380" title="__builtin_memcpy(*str, (char *)outp + (int)(long)outp-&gt;data, *len)" data-ref="_M/memcpy">memcpy</a>(*<a class="local col1 ref" href="#211str" title='str' data-ref="211str" data-ref-filename="211str">str</a>, (<em>char</em> *)<a class="local col4 ref" href="#402" title='outp' data-ref="214outp" data-ref-filename="214outp">outp</a> + (<em>int</em>)(<em>long</em>)<a class="local col4 ref" href="#402" title='outp' data-ref="214outp" data-ref-filename="214outp">outp</a>-&gt;<a class="ref field" href="coda.h.html#coda_readlink_out::data" title='coda_readlink_out::data' data-ref="coda_readlink_out::data" data-ref-filename="coda_readlink_out..data">data</a>, *<a class="local col2 ref" href="#212len" title='len' data-ref="212len" data-ref-filename="212len">len</a>);</td></tr>
<tr><th id="447">447</th><td>    }</td></tr>
<tr><th id="448">448</th><td></td></tr>
<tr><th id="449">449</th><td><dfn class="lbl" id="219out" data-ref="219out" data-ref-filename="219out">out</dfn>:</td></tr>
<tr><th id="450">450</th><td>    <a class="macro" href="cnode.h.html#71" title="kern_free((inp))" data-ref="_M/CODA_FREE">CODA_FREE</a>(<a class="local col3 ref" href="#402" title='inp' data-ref="213inp" data-ref-filename="213inp">inp</a>, coda_readlink_size);</td></tr>
<tr><th id="451">451</th><td>    <b>return</b> <a class="local col7 ref" href="#402" title='error' data-ref="217error" data-ref-filename="217error">error</a>;</td></tr>
<tr><th id="452">452</th><td>}</td></tr>
<tr><th id="453">453</th><td></td></tr>
<tr><th id="454">454</th><td><em>int</em></td></tr>
<tr><th id="455">455</th><td><dfn class="decl def fn" id="venus_fsync" title='venus_fsync' data-ref="venus_fsync" data-ref-filename="venus_fsync">venus_fsync</dfn>(<em>void</em> *<dfn class="local col0 decl" id="220mdp" title='mdp' data-type='void *' data-ref="220mdp" data-ref-filename="220mdp">mdp</dfn>, <a class="typedef" href="coda.h.html#CodaFid" title='CodaFid' data-type='struct CodaFid' data-ref="CodaFid" data-ref-filename="CodaFid">CodaFid</a> *<dfn class="local col1 decl" id="221fid" title='fid' data-type='CodaFid *' data-ref="221fid" data-ref-filename="221fid">fid</dfn>,</td></tr>
<tr><th id="456">456</th><td>	<a class="typedef" href="../sys/types.h.html#kauth_cred_t" title='kauth_cred_t' data-type='struct kauth_cred *' data-ref="kauth_cred_t" data-ref-filename="kauth_cred_t">kauth_cred_t</a> <dfn class="local col2 decl" id="222cred" title='cred' data-type='kauth_cred_t' data-ref="222cred" data-ref-filename="222cred">cred</dfn>, <b>struct</b> <a class="type" href="../sys/lwp.h.html#lwp" title='lwp' data-ref="lwp" data-ref-filename="lwp">lwp</a> *<dfn class="local col3 decl" id="223l" title='l' data-type='struct lwp *' data-ref="223l" data-ref-filename="223l">l</dfn>)</td></tr>
<tr><th id="457">457</th><td>{</td></tr>
<tr><th id="458">458</th><td>    <a class="macro" href="#80" title="struct coda_fsync_in *inp; int coda_fsync_size = sizeof (struct coda_fsync_in); int Isize = sizeof (struct coda_fsync_in); int Osize = sizeof (struct coda_out_hdr); int error" data-ref="_M/DECL_NO_OUT">DECL_NO_OUT</a>(coda_fsync);		<i>/* sets Isize &amp; Osize */</i></td></tr>
<tr><th id="459">459</th><td>    <a class="macro" href="#99" title="if (Osize &gt; coda_fsync_size) coda_fsync_size = Osize; do { inp = (struct coda_fsync_in *)kern_malloc((unsigned long) coda_fsync_size, 0x0000); if (inp == 0) { panic(&quot;kernel malloc returns 0 at %s:%d\n&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 459); } } while ( 0);" data-ref="_M/ALLOC_NO_OUT">ALLOC_NO_OUT</a>(coda_fsync);		<i>/* sets inp &amp; outp */</i></td></tr>
<tr><th id="460">460</th><td></td></tr>
<tr><th id="461">461</th><td>    <i>/* send the open to venus. */</i></td></tr>
<tr><th id="462">462</th><td>    <a class="macro" href="#145" title="(&amp;inp-&gt;ih)-&gt;opcode = (20); (&amp;inp-&gt;ih)-&gt;pid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pid : -1; (&amp;inp-&gt;ih)-&gt;pgid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pgrp-&gt;pg_id : -1; (__builtin_expect(((cred != ((void *)0))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != NULL&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 462)); (__builtin_expect(((cred != ((kauth_cred_t)-2))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != FSCRED&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 462)); if (cred != ((kauth_cred_t)-1)) { (&amp;inp-&gt;ih)-&gt;uid = kauth_cred_geteuid(cred); } else { (&amp;inp-&gt;ih)-&gt;uid = -1; }" data-ref="_M/INIT_IN_L">INIT_IN_L</a>(&amp;<a class="local col4 ref" href="#458" title='inp' data-ref="224inp" data-ref-filename="224inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_fsync_in::ih" title='coda_fsync_in::ih' data-ref="coda_fsync_in::ih" data-ref-filename="coda_fsync_in..ih">ih</a>, <a class="macro" href="coda.h.html#327" title="20" data-ref="_M/CODA_FSYNC">CODA_FSYNC</a>, <a class="local col2 ref" href="#222cred" title='cred' data-ref="222cred" data-ref-filename="222cred">cred</a>, <a class="local col3 ref" href="#223l" title='l' data-ref="223l" data-ref-filename="223l">l</a>);</td></tr>
<tr><th id="463">463</th><td>    <a class="local col4 ref" href="#458" title='inp' data-ref="224inp" data-ref-filename="224inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_fsync_in::Fid" title='coda_fsync_in::Fid' data-ref="coda_fsync_in::Fid" data-ref-filename="coda_fsync_in..Fid">Fid</a> = *<a class="local col1 ref" href="#221fid" title='fid' data-ref="221fid" data-ref-filename="221fid">fid</a>;</td></tr>
<tr><th id="464">464</th><td></td></tr>
<tr><th id="465">465</th><td>    <a class="local col7 ref" href="#458" title='error' data-ref="227error" data-ref-filename="227error">error</a> = <a class="ref fn" href="cnode.h.html#coda_call" title='coda_call' data-ref="coda_call" data-ref-filename="coda_call">coda_call</a>(<a class="local col0 ref" href="#220mdp" title='mdp' data-ref="220mdp" data-ref-filename="220mdp">mdp</a>, <a class="local col5 ref" href="#458" title='Isize' data-ref="225Isize" data-ref-filename="225Isize">Isize</a>, &amp;<a class="local col6 ref" href="#458" title='Osize' data-ref="226Osize" data-ref-filename="226Osize">Osize</a>, (<em>char</em> *)<a class="local col4 ref" href="#458" title='inp' data-ref="224inp" data-ref-filename="224inp">inp</a>);</td></tr>
<tr><th id="466">466</th><td></td></tr>
<tr><th id="467">467</th><td>    <a class="macro" href="cnode.h.html#71" title="kern_free((inp))" data-ref="_M/CODA_FREE">CODA_FREE</a>(<a class="local col4 ref" href="#458" title='inp' data-ref="224inp" data-ref-filename="224inp">inp</a>, coda_fsync_size);</td></tr>
<tr><th id="468">468</th><td>    <b>return</b> <a class="local col7 ref" href="#458" title='error' data-ref="227error" data-ref-filename="227error">error</a>;</td></tr>
<tr><th id="469">469</th><td>}</td></tr>
<tr><th id="470">470</th><td></td></tr>
<tr><th id="471">471</th><td><em>int</em></td></tr>
<tr><th id="472">472</th><td><dfn class="decl def fn" id="venus_lookup" title='venus_lookup' data-ref="venus_lookup" data-ref-filename="venus_lookup">venus_lookup</dfn>(<em>void</em> *<dfn class="local col8 decl" id="228mdp" title='mdp' data-type='void *' data-ref="228mdp" data-ref-filename="228mdp">mdp</dfn>, <a class="typedef" href="coda.h.html#CodaFid" title='CodaFid' data-type='struct CodaFid' data-ref="CodaFid" data-ref-filename="CodaFid">CodaFid</a> *<dfn class="local col9 decl" id="229fid" title='fid' data-type='CodaFid *' data-ref="229fid" data-ref-filename="229fid">fid</dfn>,</td></tr>
<tr><th id="473">473</th><td>    	<em>const</em> <em>char</em> *<dfn class="local col0 decl" id="230nm" title='nm' data-type='const char *' data-ref="230nm" data-ref-filename="230nm">nm</dfn>, <em>int</em> <dfn class="local col1 decl" id="231len" title='len' data-type='int' data-ref="231len" data-ref-filename="231len">len</dfn>,</td></tr>
<tr><th id="474">474</th><td>	<a class="typedef" href="../sys/types.h.html#kauth_cred_t" title='kauth_cred_t' data-type='struct kauth_cred *' data-ref="kauth_cred_t" data-ref-filename="kauth_cred_t">kauth_cred_t</a> <dfn class="local col2 decl" id="232cred" title='cred' data-type='kauth_cred_t' data-ref="232cred" data-ref-filename="232cred">cred</dfn>, <b>struct</b> <a class="type" href="../sys/lwp.h.html#lwp" title='lwp' data-ref="lwp" data-ref-filename="lwp">lwp</a> *<dfn class="local col3 decl" id="233l" title='l' data-type='struct lwp *' data-ref="233l" data-ref-filename="233l">l</dfn>,</td></tr>
<tr><th id="475">475</th><td><i>/*out*/</i>	<a class="typedef" href="coda.h.html#CodaFid" title='CodaFid' data-type='struct CodaFid' data-ref="CodaFid" data-ref-filename="CodaFid">CodaFid</a> *<dfn class="local col4 decl" id="234VFid" title='VFid' data-type='CodaFid *' data-ref="234VFid" data-ref-filename="234VFid">VFid</dfn>, <em>int</em> *<dfn class="local col5 decl" id="235vtype" title='vtype' data-type='int *' data-ref="235vtype" data-ref-filename="235vtype">vtype</dfn>)</td></tr>
<tr><th id="476">476</th><td>{</td></tr>
<tr><th id="477">477</th><td>    <a class="macro" href="#72" title="struct coda_lookup_in *inp; struct coda_lookup_out *outp; int coda_lookup_size = sizeof (struct coda_lookup_in); int Isize = sizeof (struct coda_lookup_in); int Osize = sizeof (struct coda_lookup_out); int error" data-ref="_M/DECL">DECL</a>(coda_lookup);			<i>/* sets Isize &amp; Osize */</i></td></tr>
<tr><th id="478">478</th><td>    <a class="local col1 ref" href="#477" title='coda_lookup_size' data-ref="241coda_lookup_size" data-ref-filename="241coda_lookup_size">coda_lookup_size</a> += <a class="local col1 ref" href="#231len" title='len' data-ref="231len" data-ref-filename="231len">len</a> + <var>1</var>;</td></tr>
<tr><th id="479">479</th><td>    <a class="macro" href="#93" title="if (Osize &gt; coda_lookup_size) coda_lookup_size = Osize; do { inp = (struct coda_lookup_in *)kern_malloc((unsigned long) coda_lookup_size, 0x0000); if (inp == 0) { panic(&quot;kernel malloc returns 0 at %s:%d\n&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 479); } } while ( 0); outp = (struct coda_lookup_out *) inp" data-ref="_M/ALLOC">ALLOC</a>(coda_lookup);			<i>/* sets inp &amp; outp */</i></td></tr>
<tr><th id="480">480</th><td></td></tr>
<tr><th id="481">481</th><td>    <i>/* send the open to venus. */</i></td></tr>
<tr><th id="482">482</th><td>    <a class="macro" href="#145" title="(&amp;inp-&gt;ih)-&gt;opcode = (10); (&amp;inp-&gt;ih)-&gt;pid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pid : -1; (&amp;inp-&gt;ih)-&gt;pgid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pgrp-&gt;pg_id : -1; (__builtin_expect(((cred != ((void *)0))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != NULL&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 482)); (__builtin_expect(((cred != ((kauth_cred_t)-2))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != FSCRED&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 482)); if (cred != ((kauth_cred_t)-1)) { (&amp;inp-&gt;ih)-&gt;uid = kauth_cred_geteuid(cred); } else { (&amp;inp-&gt;ih)-&gt;uid = -1; }" data-ref="_M/INIT_IN_L">INIT_IN_L</a>(&amp;<a class="local col6 ref" href="#477" title='inp' data-ref="236inp" data-ref-filename="236inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_lookup_in::ih" title='coda_lookup_in::ih' data-ref="coda_lookup_in::ih" data-ref-filename="coda_lookup_in..ih">ih</a>, <a class="macro" href="coda.h.html#317" title="10" data-ref="_M/CODA_LOOKUP">CODA_LOOKUP</a>, <a class="local col2 ref" href="#232cred" title='cred' data-ref="232cred" data-ref-filename="232cred">cred</a>, <a class="local col3 ref" href="#233l" title='l' data-ref="233l" data-ref-filename="233l">l</a>);</td></tr>
<tr><th id="483">483</th><td>    <a class="local col6 ref" href="#477" title='inp' data-ref="236inp" data-ref-filename="236inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_lookup_in::Fid" title='coda_lookup_in::Fid' data-ref="coda_lookup_in::Fid" data-ref-filename="coda_lookup_in..Fid">Fid</a> = *<a class="local col9 ref" href="#229fid" title='fid' data-ref="229fid" data-ref-filename="229fid">fid</a>;</td></tr>
<tr><th id="484">484</th><td></td></tr>
<tr><th id="485">485</th><td>    <i>/* NOTE:</i></td></tr>
<tr><th id="486">486</th><td><i>     * Between version 1 and version 2 we have added an extra flag field</i></td></tr>
<tr><th id="487">487</th><td><i>     * to this structure.  But because the string was at the end and because</i></td></tr>
<tr><th id="488">488</th><td><i>     * of the weird way we represent strings by having the slot point to</i></td></tr>
<tr><th id="489">489</th><td><i>     * where the string characters are in the "heap", we can just slip the</i></td></tr>
<tr><th id="490">490</th><td><i>     * flag parameter in after the string slot pointer and veni that don't</i></td></tr>
<tr><th id="491">491</th><td><i>     * know better won't see this new flag field ...</i></td></tr>
<tr><th id="492">492</th><td><i>     * Otherwise we'd need two different venus_lookup functions.</i></td></tr>
<tr><th id="493">493</th><td><i>     */</i></td></tr>
<tr><th id="494">494</th><td>    <a class="local col6 ref" href="#477" title='inp' data-ref="236inp" data-ref-filename="236inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_lookup_in::name" title='coda_lookup_in::name' data-ref="coda_lookup_in::name" data-ref-filename="coda_lookup_in..name">name</a> = <a class="local col8 ref" href="#477" title='Isize' data-ref="238Isize" data-ref-filename="238Isize">Isize</a>;</td></tr>
<tr><th id="495">495</th><td>    <a class="local col6 ref" href="#477" title='inp' data-ref="236inp" data-ref-filename="236inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_lookup_in::flags" title='coda_lookup_in::flags' data-ref="coda_lookup_in::flags" data-ref-filename="coda_lookup_in..flags">flags</a> = <a class="macro" href="coda.h.html#478" title="0x01" data-ref="_M/CLU_CASE_SENSITIVE">CLU_CASE_SENSITIVE</a>;	<i>/* doesn't really matter for BSD */</i></td></tr>
<tr><th id="496">496</th><td>    <i>/* This is safe because we preallocated len+1 extra. */</i></td></tr>
<tr><th id="497">497</th><td>    <a class="macro" href="#104" title="__builtin_memcpy((char *)inp + (int)inp-&gt;name, nm, len); ((char*)inp + (int)inp-&gt;name)[len++] = 0; Isize += len" data-ref="_M/STRCPY">STRCPY</a>(<a class="ref field" href="coda.h.html#coda_lookup_in::name" title='coda_lookup_in::name' data-ref="coda_lookup_in::name" data-ref-filename="coda_lookup_in..name">name</a>, <a class="local col0 ref" href="#230nm" title='nm' data-ref="230nm" data-ref-filename="230nm">nm</a>, <a class="local col1 ref" href="#231len" title='len' data-ref="231len" data-ref-filename="231len">len</a>);		<i>/* increments Isize */</i></td></tr>
<tr><th id="498">498</th><td></td></tr>
<tr><th id="499">499</th><td>    <a class="local col0 ref" href="#477" title='error' data-ref="240error" data-ref-filename="240error">error</a> = <a class="ref fn" href="cnode.h.html#coda_call" title='coda_call' data-ref="coda_call" data-ref-filename="coda_call">coda_call</a>(<a class="local col8 ref" href="#228mdp" title='mdp' data-ref="228mdp" data-ref-filename="228mdp">mdp</a>, <a class="local col8 ref" href="#477" title='Isize' data-ref="238Isize" data-ref-filename="238Isize">Isize</a>, &amp;<a class="local col9 ref" href="#477" title='Osize' data-ref="239Osize" data-ref-filename="239Osize">Osize</a>, (<em>char</em> *)<a class="local col6 ref" href="#477" title='inp' data-ref="236inp" data-ref-filename="236inp">inp</a>);</td></tr>
<tr><th id="500">500</th><td>    <a class="macro" href="../lib/libkern/libkern.h.html#279" title="(__builtin_expect(((outp != ((void *)0))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;outp != NULL&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 500))" data-ref="_M/KASSERT">KASSERT</a>(<a class="local col7 ref" href="#477" title='outp' data-ref="237outp" data-ref-filename="237outp">outp</a> != <a class="macro" href="../sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>);</td></tr>
<tr><th id="501">501</th><td>    <b>if</b> (!<a class="local col0 ref" href="#477" title='error' data-ref="240error" data-ref-filename="240error">error</a>) {</td></tr>
<tr><th id="502">502</th><td>	*<a class="local col4 ref" href="#234VFid" title='VFid' data-ref="234VFid" data-ref-filename="234VFid">VFid</a> = <a class="local col7 ref" href="#477" title='outp' data-ref="237outp" data-ref-filename="237outp">outp</a>-&gt;<a class="ref field" href="coda.h.html#coda_lookup_out::Fid" title='coda_lookup_out::Fid' data-ref="coda_lookup_out::Fid" data-ref-filename="coda_lookup_out..Fid">Fid</a>;</td></tr>
<tr><th id="503">503</th><td>	*<a class="local col5 ref" href="#235vtype" title='vtype' data-ref="235vtype" data-ref-filename="235vtype">vtype</a> = <a class="local col7 ref" href="#477" title='outp' data-ref="237outp" data-ref-filename="237outp">outp</a>-&gt;<a class="ref field" href="coda.h.html#coda_lookup_out::vtype" title='coda_lookup_out::vtype' data-ref="coda_lookup_out::vtype" data-ref-filename="coda_lookup_out..vtype">vtype</a>;</td></tr>
<tr><th id="504">504</th><td>    }</td></tr>
<tr><th id="505">505</th><td></td></tr>
<tr><th id="506">506</th><td>    <a class="macro" href="cnode.h.html#71" title="kern_free((inp))" data-ref="_M/CODA_FREE">CODA_FREE</a>(<a class="local col6 ref" href="#477" title='inp' data-ref="236inp" data-ref-filename="236inp">inp</a>, coda_lookup_size);</td></tr>
<tr><th id="507">507</th><td>    <b>return</b> <a class="local col0 ref" href="#477" title='error' data-ref="240error" data-ref-filename="240error">error</a>;</td></tr>
<tr><th id="508">508</th><td>}</td></tr>
<tr><th id="509">509</th><td></td></tr>
<tr><th id="510">510</th><td><em>int</em></td></tr>
<tr><th id="511">511</th><td><dfn class="decl def fn" id="venus_create" title='venus_create' data-ref="venus_create" data-ref-filename="venus_create">venus_create</dfn>(<em>void</em> *<dfn class="local col2 decl" id="242mdp" title='mdp' data-type='void *' data-ref="242mdp" data-ref-filename="242mdp">mdp</dfn>, <a class="typedef" href="coda.h.html#CodaFid" title='CodaFid' data-type='struct CodaFid' data-ref="CodaFid" data-ref-filename="CodaFid">CodaFid</a> *<dfn class="local col3 decl" id="243fid" title='fid' data-type='CodaFid *' data-ref="243fid" data-ref-filename="243fid">fid</dfn>,</td></tr>
<tr><th id="512">512</th><td>    	<em>const</em> <em>char</em> *<dfn class="local col4 decl" id="244nm" title='nm' data-type='const char *' data-ref="244nm" data-ref-filename="244nm">nm</dfn>, <em>int</em> <dfn class="local col5 decl" id="245len" title='len' data-type='int' data-ref="245len" data-ref-filename="245len">len</dfn>, <em>int</em> <dfn class="local col6 decl" id="246exclusive" title='exclusive' data-type='int' data-ref="246exclusive" data-ref-filename="246exclusive">exclusive</dfn>, <em>int</em> <dfn class="local col7 decl" id="247mode" title='mode' data-type='int' data-ref="247mode" data-ref-filename="247mode">mode</dfn>, <b>struct</b> <a class="type" href="../sys/vnode.h.html#vattr" title='vattr' data-ref="vattr" data-ref-filename="vattr">vattr</a> *<dfn class="local col8 decl" id="248va" title='va' data-type='struct vattr *' data-ref="248va" data-ref-filename="248va">va</dfn>,</td></tr>
<tr><th id="513">513</th><td>	<a class="typedef" href="../sys/types.h.html#kauth_cred_t" title='kauth_cred_t' data-type='struct kauth_cred *' data-ref="kauth_cred_t" data-ref-filename="kauth_cred_t">kauth_cred_t</a> <dfn class="local col9 decl" id="249cred" title='cred' data-type='kauth_cred_t' data-ref="249cred" data-ref-filename="249cred">cred</dfn>, <b>struct</b> <a class="type" href="../sys/lwp.h.html#lwp" title='lwp' data-ref="lwp" data-ref-filename="lwp">lwp</a> *<dfn class="local col0 decl" id="250l" title='l' data-type='struct lwp *' data-ref="250l" data-ref-filename="250l">l</dfn>,</td></tr>
<tr><th id="514">514</th><td><i>/*out*/</i>	<a class="typedef" href="coda.h.html#CodaFid" title='CodaFid' data-type='struct CodaFid' data-ref="CodaFid" data-ref-filename="CodaFid">CodaFid</a> *<dfn class="local col1 decl" id="251VFid" title='VFid' data-type='CodaFid *' data-ref="251VFid" data-ref-filename="251VFid">VFid</dfn>, <b>struct</b> <a class="type" href="../sys/vnode.h.html#vattr" title='vattr' data-ref="vattr" data-ref-filename="vattr">vattr</a> *<dfn class="local col2 decl" id="252attr" title='attr' data-type='struct vattr *' data-ref="252attr" data-ref-filename="252attr">attr</dfn>)</td></tr>
<tr><th id="515">515</th><td>{</td></tr>
<tr><th id="516">516</th><td>    <a class="macro" href="#72" title="struct coda_create_in *inp; struct coda_create_out *outp; int coda_create_size = sizeof (struct coda_create_in); int Isize = sizeof (struct coda_create_in); int Osize = sizeof (struct coda_create_out); int error" data-ref="_M/DECL">DECL</a>(coda_create);			<i>/* sets Isize &amp; Osize */</i></td></tr>
<tr><th id="517">517</th><td>    <a class="local col8 ref" href="#516" title='coda_create_size' data-ref="258coda_create_size" data-ref-filename="258coda_create_size">coda_create_size</a> += <a class="local col5 ref" href="#245len" title='len' data-ref="245len" data-ref-filename="245len">len</a> + <var>1</var>;</td></tr>
<tr><th id="518">518</th><td>    <a class="macro" href="#93" title="if (Osize &gt; coda_create_size) coda_create_size = Osize; do { inp = (struct coda_create_in *)kern_malloc((unsigned long) coda_create_size, 0x0000); if (inp == 0) { panic(&quot;kernel malloc returns 0 at %s:%d\n&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 518); } } while ( 0); outp = (struct coda_create_out *) inp" data-ref="_M/ALLOC">ALLOC</a>(coda_create);			<i>/* sets inp &amp; outp */</i></td></tr>
<tr><th id="519">519</th><td></td></tr>
<tr><th id="520">520</th><td>    <i>/* send the open to venus. */</i></td></tr>
<tr><th id="521">521</th><td>    <a class="macro" href="#145" title="(&amp;inp-&gt;ih)-&gt;opcode = (11); (&amp;inp-&gt;ih)-&gt;pid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pid : -1; (&amp;inp-&gt;ih)-&gt;pgid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pgrp-&gt;pg_id : -1; (__builtin_expect(((cred != ((void *)0))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != NULL&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 521)); (__builtin_expect(((cred != ((kauth_cred_t)-2))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != FSCRED&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 521)); if (cred != ((kauth_cred_t)-1)) { (&amp;inp-&gt;ih)-&gt;uid = kauth_cred_geteuid(cred); } else { (&amp;inp-&gt;ih)-&gt;uid = -1; }" data-ref="_M/INIT_IN_L">INIT_IN_L</a>(&amp;<a class="local col3 ref" href="#516" title='inp' data-ref="253inp" data-ref-filename="253inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_create_in::ih" title='coda_create_in::ih' data-ref="coda_create_in::ih" data-ref-filename="coda_create_in..ih">ih</a>, <a class="macro" href="coda.h.html#318" title="11" data-ref="_M/CODA_CREATE">CODA_CREATE</a>, <a class="local col9 ref" href="#249cred" title='cred' data-ref="249cred" data-ref-filename="249cred">cred</a>, <a class="local col0 ref" href="#250l" title='l' data-ref="250l" data-ref-filename="250l">l</a>);</td></tr>
<tr><th id="522">522</th><td>    <a class="local col3 ref" href="#516" title='inp' data-ref="253inp" data-ref-filename="253inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_create_in::Fid" title='coda_create_in::Fid' data-ref="coda_create_in::Fid" data-ref-filename="coda_create_in..Fid">Fid</a> = *<a class="local col3 ref" href="#243fid" title='fid' data-ref="243fid" data-ref-filename="243fid">fid</a>;</td></tr>
<tr><th id="523">523</th><td>    <a class="local col3 ref" href="#516" title='inp' data-ref="253inp" data-ref-filename="253inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_create_in::excl" title='coda_create_in::excl' data-ref="coda_create_in::excl" data-ref-filename="coda_create_in..excl">excl</a> = <a class="local col6 ref" href="#246exclusive" title='exclusive' data-ref="246exclusive" data-ref-filename="246exclusive">exclusive</a> ? <a class="macro" href="coda.h.html#142" title="0x100" data-ref="_M/C_O_EXCL">C_O_EXCL</a> : <var>0</var>;</td></tr>
<tr><th id="524">524</th><td>    <a class="local col3 ref" href="#516" title='inp' data-ref="253inp" data-ref-filename="253inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_create_in::mode" title='coda_create_in::mode' data-ref="coda_create_in::mode" data-ref-filename="coda_create_in..mode">mode</a> = <a class="local col7 ref" href="#247mode" title='mode' data-ref="247mode" data-ref-filename="247mode">mode</a>&lt;&lt;<var>6</var>;</td></tr>
<tr><th id="525">525</th><td>    <a class="macro" href="#181" title="do { (&amp;inp-&gt;attr)-&gt;va_type = (va)-&gt;va_type; (&amp;inp-&gt;attr)-&gt;va_mode = (va)-&gt;va_mode; (&amp;inp-&gt;attr)-&gt;va_nlink = (va)-&gt;va_nlink; (&amp;inp-&gt;attr)-&gt;va_uid = (va)-&gt;va_uid; (&amp;inp-&gt;attr)-&gt;va_gid = (va)-&gt;va_gid; (&amp;inp-&gt;attr)-&gt;va_fileid = (va)-&gt;va_fileid; (&amp;inp-&gt;attr)-&gt;va_size = (va)-&gt;va_size; (&amp;inp-&gt;attr)-&gt;va_blocksize = (va)-&gt;va_blocksize; (&amp;inp-&gt;attr)-&gt;va_atime = (va)-&gt;va_atime; (&amp;inp-&gt;attr)-&gt;va_mtime = (va)-&gt;va_mtime; (&amp;inp-&gt;attr)-&gt;va_ctime = (va)-&gt;va_ctime; (&amp;inp-&gt;attr)-&gt;va_gen = (va)-&gt;va_gen; (&amp;inp-&gt;attr)-&gt;va_flags = (va)-&gt;va_flags; (&amp;inp-&gt;attr)-&gt;va_rdev = (va)-&gt;va_rdev; (&amp;inp-&gt;attr)-&gt;va_bytes = (va)-&gt;va_bytes; (&amp;inp-&gt;attr)-&gt;va_filerev = (va)-&gt;va_filerev; } while ( 0)" data-ref="_M/CNV_V2VV_ATTR">CNV_V2VV_ATTR</a>(&amp;<a class="local col3 ref" href="#516" title='inp' data-ref="253inp" data-ref-filename="253inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_create_in::attr" title='coda_create_in::attr' data-ref="coda_create_in::attr" data-ref-filename="coda_create_in..attr">attr</a>, <a class="local col8 ref" href="#248va" title='va' data-ref="248va" data-ref-filename="248va">va</a>);</td></tr>
<tr><th id="526">526</th><td></td></tr>
<tr><th id="527">527</th><td>    <a class="local col3 ref" href="#516" title='inp' data-ref="253inp" data-ref-filename="253inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_create_in::name" title='coda_create_in::name' data-ref="coda_create_in::name" data-ref-filename="coda_create_in..name">name</a> = <a class="local col5 ref" href="#516" title='Isize' data-ref="255Isize" data-ref-filename="255Isize">Isize</a>;</td></tr>
<tr><th id="528">528</th><td>    <a class="macro" href="#104" title="__builtin_memcpy((char *)inp + (int)inp-&gt;name, nm, len); ((char*)inp + (int)inp-&gt;name)[len++] = 0; Isize += len" data-ref="_M/STRCPY">STRCPY</a>(<a class="ref field" href="coda.h.html#coda_create_in::name" title='coda_create_in::name' data-ref="coda_create_in::name" data-ref-filename="coda_create_in..name">name</a>, <a class="local col4 ref" href="#244nm" title='nm' data-ref="244nm" data-ref-filename="244nm">nm</a>, <a class="local col5 ref" href="#245len" title='len' data-ref="245len" data-ref-filename="245len">len</a>);		<i>/* increments Isize */</i></td></tr>
<tr><th id="529">529</th><td></td></tr>
<tr><th id="530">530</th><td>    <a class="local col7 ref" href="#516" title='error' data-ref="257error" data-ref-filename="257error">error</a> = <a class="ref fn" href="cnode.h.html#coda_call" title='coda_call' data-ref="coda_call" data-ref-filename="coda_call">coda_call</a>(<a class="local col2 ref" href="#242mdp" title='mdp' data-ref="242mdp" data-ref-filename="242mdp">mdp</a>, <a class="local col5 ref" href="#516" title='Isize' data-ref="255Isize" data-ref-filename="255Isize">Isize</a>, &amp;<a class="local col6 ref" href="#516" title='Osize' data-ref="256Osize" data-ref-filename="256Osize">Osize</a>, (<em>char</em> *)<a class="local col3 ref" href="#516" title='inp' data-ref="253inp" data-ref-filename="253inp">inp</a>);</td></tr>
<tr><th id="531">531</th><td>    <a class="macro" href="../lib/libkern/libkern.h.html#279" title="(__builtin_expect(((outp != ((void *)0))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;outp != NULL&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 531))" data-ref="_M/KASSERT">KASSERT</a>(<a class="local col4 ref" href="#516" title='outp' data-ref="254outp" data-ref-filename="254outp">outp</a> != <a class="macro" href="../sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>);</td></tr>
<tr><th id="532">532</th><td>    <b>if</b> (!<a class="local col7 ref" href="#516" title='error' data-ref="257error" data-ref-filename="257error">error</a>) {</td></tr>
<tr><th id="533">533</th><td>	*<a class="local col1 ref" href="#251VFid" title='VFid' data-ref="251VFid" data-ref-filename="251VFid">VFid</a> = <a class="local col4 ref" href="#516" title='outp' data-ref="254outp" data-ref-filename="254outp">outp</a>-&gt;<a class="ref field" href="coda.h.html#coda_create_out::Fid" title='coda_create_out::Fid' data-ref="coda_create_out::Fid" data-ref-filename="coda_create_out..Fid">Fid</a>;</td></tr>
<tr><th id="534">534</th><td>	<a class="macro" href="#158" title="do { (attr)-&gt;va_type = (&amp;outp-&gt;attr)-&gt;va_type; (attr)-&gt;va_mode = (&amp;outp-&gt;attr)-&gt;va_mode; (attr)-&gt;va_nlink = (&amp;outp-&gt;attr)-&gt;va_nlink; (attr)-&gt;va_uid = (&amp;outp-&gt;attr)-&gt;va_uid; (attr)-&gt;va_gid = (&amp;outp-&gt;attr)-&gt;va_gid; (attr)-&gt;va_fsid = (-1); (attr)-&gt;va_fileid = (&amp;outp-&gt;attr)-&gt;va_fileid; (attr)-&gt;va_size = (&amp;outp-&gt;attr)-&gt;va_size; (attr)-&gt;va_blocksize = (&amp;outp-&gt;attr)-&gt;va_blocksize; (attr)-&gt;va_atime = (&amp;outp-&gt;attr)-&gt;va_atime; (attr)-&gt;va_mtime = (&amp;outp-&gt;attr)-&gt;va_mtime; (attr)-&gt;va_ctime = (&amp;outp-&gt;attr)-&gt;va_ctime; (attr)-&gt;va_gen = (&amp;outp-&gt;attr)-&gt;va_gen; (attr)-&gt;va_flags = (&amp;outp-&gt;attr)-&gt;va_flags; (attr)-&gt;va_rdev = (&amp;outp-&gt;attr)-&gt;va_rdev; (attr)-&gt;va_bytes = (&amp;outp-&gt;attr)-&gt;va_bytes; (attr)-&gt;va_filerev = (&amp;outp-&gt;attr)-&gt;va_filerev; (attr)-&gt;va_vaflags = (-1); (attr)-&gt;va_spare = (-1); } while ( 0)" data-ref="_M/CNV_VV2V_ATTR">CNV_VV2V_ATTR</a>(<a class="local col2 ref" href="#252attr" title='attr' data-ref="252attr" data-ref-filename="252attr">attr</a>, &amp;<a class="local col4 ref" href="#516" title='outp' data-ref="254outp" data-ref-filename="254outp">outp</a>-&gt;<a class="ref field" href="coda.h.html#coda_create_out::attr" title='coda_create_out::attr' data-ref="coda_create_out::attr" data-ref-filename="coda_create_out..attr">attr</a>);</td></tr>
<tr><th id="535">535</th><td>    }</td></tr>
<tr><th id="536">536</th><td></td></tr>
<tr><th id="537">537</th><td>    <a class="macro" href="cnode.h.html#71" title="kern_free((inp))" data-ref="_M/CODA_FREE">CODA_FREE</a>(<a class="local col3 ref" href="#516" title='inp' data-ref="253inp" data-ref-filename="253inp">inp</a>, coda_create_size);</td></tr>
<tr><th id="538">538</th><td>    <b>return</b> <a class="local col7 ref" href="#516" title='error' data-ref="257error" data-ref-filename="257error">error</a>;</td></tr>
<tr><th id="539">539</th><td>}</td></tr>
<tr><th id="540">540</th><td></td></tr>
<tr><th id="541">541</th><td><em>int</em></td></tr>
<tr><th id="542">542</th><td><dfn class="decl def fn" id="venus_remove" title='venus_remove' data-ref="venus_remove" data-ref-filename="venus_remove">venus_remove</dfn>(<em>void</em> *<dfn class="local col9 decl" id="259mdp" title='mdp' data-type='void *' data-ref="259mdp" data-ref-filename="259mdp">mdp</dfn>, <a class="typedef" href="coda.h.html#CodaFid" title='CodaFid' data-type='struct CodaFid' data-ref="CodaFid" data-ref-filename="CodaFid">CodaFid</a> *<dfn class="local col0 decl" id="260fid" title='fid' data-type='CodaFid *' data-ref="260fid" data-ref-filename="260fid">fid</dfn>,</td></tr>
<tr><th id="543">543</th><td>        <em>const</em> <em>char</em> *<dfn class="local col1 decl" id="261nm" title='nm' data-type='const char *' data-ref="261nm" data-ref-filename="261nm">nm</dfn>, <em>int</em> <dfn class="local col2 decl" id="262len" title='len' data-type='int' data-ref="262len" data-ref-filename="262len">len</dfn>,</td></tr>
<tr><th id="544">544</th><td>	<a class="typedef" href="../sys/types.h.html#kauth_cred_t" title='kauth_cred_t' data-type='struct kauth_cred *' data-ref="kauth_cred_t" data-ref-filename="kauth_cred_t">kauth_cred_t</a> <dfn class="local col3 decl" id="263cred" title='cred' data-type='kauth_cred_t' data-ref="263cred" data-ref-filename="263cred">cred</dfn>, <b>struct</b> <a class="type" href="../sys/lwp.h.html#lwp" title='lwp' data-ref="lwp" data-ref-filename="lwp">lwp</a> *<dfn class="local col4 decl" id="264l" title='l' data-type='struct lwp *' data-ref="264l" data-ref-filename="264l">l</dfn>)</td></tr>
<tr><th id="545">545</th><td>{</td></tr>
<tr><th id="546">546</th><td>    <a class="macro" href="#80" title="struct coda_remove_in *inp; int coda_remove_size = sizeof (struct coda_remove_in); int Isize = sizeof (struct coda_remove_in); int Osize = sizeof (struct coda_out_hdr); int error" data-ref="_M/DECL_NO_OUT">DECL_NO_OUT</a>(coda_remove);		<i>/* sets Isize &amp; Osize */</i></td></tr>
<tr><th id="547">547</th><td>    <a class="local col9 ref" href="#546" title='coda_remove_size' data-ref="269coda_remove_size" data-ref-filename="269coda_remove_size">coda_remove_size</a> += <a class="local col2 ref" href="#262len" title='len' data-ref="262len" data-ref-filename="262len">len</a> + <var>1</var>;</td></tr>
<tr><th id="548">548</th><td>    <a class="macro" href="#99" title="if (Osize &gt; coda_remove_size) coda_remove_size = Osize; do { inp = (struct coda_remove_in *)kern_malloc((unsigned long) coda_remove_size, 0x0000); if (inp == 0) { panic(&quot;kernel malloc returns 0 at %s:%d\n&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 548); } } while ( 0);" data-ref="_M/ALLOC_NO_OUT">ALLOC_NO_OUT</a>(coda_remove);		<i>/* sets inp &amp; outp */</i></td></tr>
<tr><th id="549">549</th><td></td></tr>
<tr><th id="550">550</th><td>    <i>/* send the open to venus. */</i></td></tr>
<tr><th id="551">551</th><td>    <a class="macro" href="#145" title="(&amp;inp-&gt;ih)-&gt;opcode = (12); (&amp;inp-&gt;ih)-&gt;pid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pid : -1; (&amp;inp-&gt;ih)-&gt;pgid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pgrp-&gt;pg_id : -1; (__builtin_expect(((cred != ((void *)0))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != NULL&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 551)); (__builtin_expect(((cred != ((kauth_cred_t)-2))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != FSCRED&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 551)); if (cred != ((kauth_cred_t)-1)) { (&amp;inp-&gt;ih)-&gt;uid = kauth_cred_geteuid(cred); } else { (&amp;inp-&gt;ih)-&gt;uid = -1; }" data-ref="_M/INIT_IN_L">INIT_IN_L</a>(&amp;<a class="local col5 ref" href="#546" title='inp' data-ref="265inp" data-ref-filename="265inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_remove_in::ih" title='coda_remove_in::ih' data-ref="coda_remove_in::ih" data-ref-filename="coda_remove_in..ih">ih</a>, <a class="macro" href="coda.h.html#319" title="12" data-ref="_M/CODA_REMOVE">CODA_REMOVE</a>, <a class="local col3 ref" href="#263cred" title='cred' data-ref="263cred" data-ref-filename="263cred">cred</a>, <a class="local col4 ref" href="#264l" title='l' data-ref="264l" data-ref-filename="264l">l</a>);</td></tr>
<tr><th id="552">552</th><td>    <a class="local col5 ref" href="#546" title='inp' data-ref="265inp" data-ref-filename="265inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_remove_in::Fid" title='coda_remove_in::Fid' data-ref="coda_remove_in::Fid" data-ref-filename="coda_remove_in..Fid">Fid</a> = *<a class="local col0 ref" href="#260fid" title='fid' data-ref="260fid" data-ref-filename="260fid">fid</a>;</td></tr>
<tr><th id="553">553</th><td></td></tr>
<tr><th id="554">554</th><td>    <a class="local col5 ref" href="#546" title='inp' data-ref="265inp" data-ref-filename="265inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_remove_in::name" title='coda_remove_in::name' data-ref="coda_remove_in::name" data-ref-filename="coda_remove_in..name">name</a> = <a class="local col6 ref" href="#546" title='Isize' data-ref="266Isize" data-ref-filename="266Isize">Isize</a>;</td></tr>
<tr><th id="555">555</th><td>    <a class="macro" href="#104" title="__builtin_memcpy((char *)inp + (int)inp-&gt;name, nm, len); ((char*)inp + (int)inp-&gt;name)[len++] = 0; Isize += len" data-ref="_M/STRCPY">STRCPY</a>(<a class="ref field" href="coda.h.html#coda_remove_in::name" title='coda_remove_in::name' data-ref="coda_remove_in::name" data-ref-filename="coda_remove_in..name">name</a>, <a class="local col1 ref" href="#261nm" title='nm' data-ref="261nm" data-ref-filename="261nm">nm</a>, <a class="local col2 ref" href="#262len" title='len' data-ref="262len" data-ref-filename="262len">len</a>);		<i>/* increments Isize */</i></td></tr>
<tr><th id="556">556</th><td></td></tr>
<tr><th id="557">557</th><td>    <a class="local col8 ref" href="#546" title='error' data-ref="268error" data-ref-filename="268error">error</a> = <a class="ref fn" href="cnode.h.html#coda_call" title='coda_call' data-ref="coda_call" data-ref-filename="coda_call">coda_call</a>(<a class="local col9 ref" href="#259mdp" title='mdp' data-ref="259mdp" data-ref-filename="259mdp">mdp</a>, <a class="local col6 ref" href="#546" title='Isize' data-ref="266Isize" data-ref-filename="266Isize">Isize</a>, &amp;<a class="local col7 ref" href="#546" title='Osize' data-ref="267Osize" data-ref-filename="267Osize">Osize</a>, (<em>char</em> *)<a class="local col5 ref" href="#546" title='inp' data-ref="265inp" data-ref-filename="265inp">inp</a>);</td></tr>
<tr><th id="558">558</th><td></td></tr>
<tr><th id="559">559</th><td>    <a class="macro" href="cnode.h.html#71" title="kern_free((inp))" data-ref="_M/CODA_FREE">CODA_FREE</a>(<a class="local col5 ref" href="#546" title='inp' data-ref="265inp" data-ref-filename="265inp">inp</a>, coda_remove_size);</td></tr>
<tr><th id="560">560</th><td>    <b>return</b> <a class="local col8 ref" href="#546" title='error' data-ref="268error" data-ref-filename="268error">error</a>;</td></tr>
<tr><th id="561">561</th><td>}</td></tr>
<tr><th id="562">562</th><td></td></tr>
<tr><th id="563">563</th><td><em>int</em></td></tr>
<tr><th id="564">564</th><td><dfn class="decl def fn" id="venus_link" title='venus_link' data-ref="venus_link" data-ref-filename="venus_link">venus_link</dfn>(<em>void</em> *<dfn class="local col0 decl" id="270mdp" title='mdp' data-type='void *' data-ref="270mdp" data-ref-filename="270mdp">mdp</dfn>, <a class="typedef" href="coda.h.html#CodaFid" title='CodaFid' data-type='struct CodaFid' data-ref="CodaFid" data-ref-filename="CodaFid">CodaFid</a> *<dfn class="local col1 decl" id="271fid" title='fid' data-type='CodaFid *' data-ref="271fid" data-ref-filename="271fid">fid</dfn>, <a class="typedef" href="coda.h.html#CodaFid" title='CodaFid' data-type='struct CodaFid' data-ref="CodaFid" data-ref-filename="CodaFid">CodaFid</a> *<dfn class="local col2 decl" id="272tfid" title='tfid' data-type='CodaFid *' data-ref="272tfid" data-ref-filename="272tfid">tfid</dfn>,</td></tr>
<tr><th id="565">565</th><td>        <em>const</em> <em>char</em> *<dfn class="local col3 decl" id="273nm" title='nm' data-type='const char *' data-ref="273nm" data-ref-filename="273nm">nm</dfn>, <em>int</em> <dfn class="local col4 decl" id="274len" title='len' data-type='int' data-ref="274len" data-ref-filename="274len">len</dfn>,</td></tr>
<tr><th id="566">566</th><td>	<a class="typedef" href="../sys/types.h.html#kauth_cred_t" title='kauth_cred_t' data-type='struct kauth_cred *' data-ref="kauth_cred_t" data-ref-filename="kauth_cred_t">kauth_cred_t</a> <dfn class="local col5 decl" id="275cred" title='cred' data-type='kauth_cred_t' data-ref="275cred" data-ref-filename="275cred">cred</dfn>, <b>struct</b> <a class="type" href="../sys/lwp.h.html#lwp" title='lwp' data-ref="lwp" data-ref-filename="lwp">lwp</a> *<dfn class="local col6 decl" id="276l" title='l' data-type='struct lwp *' data-ref="276l" data-ref-filename="276l">l</dfn>)</td></tr>
<tr><th id="567">567</th><td>{</td></tr>
<tr><th id="568">568</th><td>    <a class="macro" href="#80" title="struct coda_link_in *inp; int coda_link_size = sizeof (struct coda_link_in); int Isize = sizeof (struct coda_link_in); int Osize = sizeof (struct coda_out_hdr); int error" data-ref="_M/DECL_NO_OUT">DECL_NO_OUT</a>(coda_link);		<i>/* sets Isize &amp; Osize */</i></td></tr>
<tr><th id="569">569</th><td>    <a class="local col1 ref" href="#568" title='coda_link_size' data-ref="281coda_link_size" data-ref-filename="281coda_link_size">coda_link_size</a> += <a class="local col4 ref" href="#274len" title='len' data-ref="274len" data-ref-filename="274len">len</a> + <var>1</var>;</td></tr>
<tr><th id="570">570</th><td>    <a class="macro" href="#99" title="if (Osize &gt; coda_link_size) coda_link_size = Osize; do { inp = (struct coda_link_in *)kern_malloc((unsigned long) coda_link_size, 0x0000); if (inp == 0) { panic(&quot;kernel malloc returns 0 at %s:%d\n&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 570); } } while ( 0);" data-ref="_M/ALLOC_NO_OUT">ALLOC_NO_OUT</a>(coda_link);		<i>/* sets inp &amp; outp */</i></td></tr>
<tr><th id="571">571</th><td></td></tr>
<tr><th id="572">572</th><td>    <i>/* send the open to venus. */</i></td></tr>
<tr><th id="573">573</th><td>    <a class="macro" href="#145" title="(&amp;inp-&gt;ih)-&gt;opcode = (13); (&amp;inp-&gt;ih)-&gt;pid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pid : -1; (&amp;inp-&gt;ih)-&gt;pgid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pgrp-&gt;pg_id : -1; (__builtin_expect(((cred != ((void *)0))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != NULL&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 573)); (__builtin_expect(((cred != ((kauth_cred_t)-2))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != FSCRED&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 573)); if (cred != ((kauth_cred_t)-1)) { (&amp;inp-&gt;ih)-&gt;uid = kauth_cred_geteuid(cred); } else { (&amp;inp-&gt;ih)-&gt;uid = -1; }" data-ref="_M/INIT_IN_L">INIT_IN_L</a>(&amp;<a class="local col7 ref" href="#568" title='inp' data-ref="277inp" data-ref-filename="277inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_link_in::ih" title='coda_link_in::ih' data-ref="coda_link_in::ih" data-ref-filename="coda_link_in..ih">ih</a>, <a class="macro" href="coda.h.html#320" title="13" data-ref="_M/CODA_LINK">CODA_LINK</a>, <a class="local col5 ref" href="#275cred" title='cred' data-ref="275cred" data-ref-filename="275cred">cred</a>, <a class="local col6 ref" href="#276l" title='l' data-ref="276l" data-ref-filename="276l">l</a>);</td></tr>
<tr><th id="574">574</th><td>    <a class="local col7 ref" href="#568" title='inp' data-ref="277inp" data-ref-filename="277inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_link_in::sourceFid" title='coda_link_in::sourceFid' data-ref="coda_link_in::sourceFid" data-ref-filename="coda_link_in..sourceFid">sourceFid</a> = *<a class="local col1 ref" href="#271fid" title='fid' data-ref="271fid" data-ref-filename="271fid">fid</a>;</td></tr>
<tr><th id="575">575</th><td>    <a class="local col7 ref" href="#568" title='inp' data-ref="277inp" data-ref-filename="277inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_link_in::destFid" title='coda_link_in::destFid' data-ref="coda_link_in::destFid" data-ref-filename="coda_link_in..destFid">destFid</a> = *<a class="local col2 ref" href="#272tfid" title='tfid' data-ref="272tfid" data-ref-filename="272tfid">tfid</a>;</td></tr>
<tr><th id="576">576</th><td></td></tr>
<tr><th id="577">577</th><td>    <a class="local col7 ref" href="#568" title='inp' data-ref="277inp" data-ref-filename="277inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_link_in::tname" title='coda_link_in::tname' data-ref="coda_link_in::tname" data-ref-filename="coda_link_in..tname">tname</a> = <a class="local col8 ref" href="#568" title='Isize' data-ref="278Isize" data-ref-filename="278Isize">Isize</a>;</td></tr>
<tr><th id="578">578</th><td>    <a class="macro" href="#104" title="__builtin_memcpy((char *)inp + (int)inp-&gt;tname, nm, len); ((char*)inp + (int)inp-&gt;tname)[len++] = 0; Isize += len" data-ref="_M/STRCPY">STRCPY</a>(<a class="ref field" href="coda.h.html#coda_link_in::tname" title='coda_link_in::tname' data-ref="coda_link_in::tname" data-ref-filename="coda_link_in..tname">tname</a>, <a class="local col3 ref" href="#273nm" title='nm' data-ref="273nm" data-ref-filename="273nm">nm</a>, <a class="local col4 ref" href="#274len" title='len' data-ref="274len" data-ref-filename="274len">len</a>);		<i>/* increments Isize */</i></td></tr>
<tr><th id="579">579</th><td></td></tr>
<tr><th id="580">580</th><td>    <a class="local col0 ref" href="#568" title='error' data-ref="280error" data-ref-filename="280error">error</a> = <a class="ref fn" href="cnode.h.html#coda_call" title='coda_call' data-ref="coda_call" data-ref-filename="coda_call">coda_call</a>(<a class="local col0 ref" href="#270mdp" title='mdp' data-ref="270mdp" data-ref-filename="270mdp">mdp</a>, <a class="local col8 ref" href="#568" title='Isize' data-ref="278Isize" data-ref-filename="278Isize">Isize</a>, &amp;<a class="local col9 ref" href="#568" title='Osize' data-ref="279Osize" data-ref-filename="279Osize">Osize</a>, (<em>char</em> *)<a class="local col7 ref" href="#568" title='inp' data-ref="277inp" data-ref-filename="277inp">inp</a>);</td></tr>
<tr><th id="581">581</th><td></td></tr>
<tr><th id="582">582</th><td>    <a class="macro" href="cnode.h.html#71" title="kern_free((inp))" data-ref="_M/CODA_FREE">CODA_FREE</a>(<a class="local col7 ref" href="#568" title='inp' data-ref="277inp" data-ref-filename="277inp">inp</a>, coda_link_size);</td></tr>
<tr><th id="583">583</th><td>    <b>return</b> <a class="local col0 ref" href="#568" title='error' data-ref="280error" data-ref-filename="280error">error</a>;</td></tr>
<tr><th id="584">584</th><td>}</td></tr>
<tr><th id="585">585</th><td></td></tr>
<tr><th id="586">586</th><td><em>int</em></td></tr>
<tr><th id="587">587</th><td><dfn class="decl def fn" id="venus_rename" title='venus_rename' data-ref="venus_rename" data-ref-filename="venus_rename">venus_rename</dfn>(<em>void</em> *<dfn class="local col2 decl" id="282mdp" title='mdp' data-type='void *' data-ref="282mdp" data-ref-filename="282mdp">mdp</dfn>, <a class="typedef" href="coda.h.html#CodaFid" title='CodaFid' data-type='struct CodaFid' data-ref="CodaFid" data-ref-filename="CodaFid">CodaFid</a> *<dfn class="local col3 decl" id="283fid" title='fid' data-type='CodaFid *' data-ref="283fid" data-ref-filename="283fid">fid</dfn>, <a class="typedef" href="coda.h.html#CodaFid" title='CodaFid' data-type='struct CodaFid' data-ref="CodaFid" data-ref-filename="CodaFid">CodaFid</a> *<dfn class="local col4 decl" id="284tfid" title='tfid' data-type='CodaFid *' data-ref="284tfid" data-ref-filename="284tfid">tfid</dfn>,</td></tr>
<tr><th id="588">588</th><td>        <em>const</em> <em>char</em> *<dfn class="local col5 decl" id="285nm" title='nm' data-type='const char *' data-ref="285nm" data-ref-filename="285nm">nm</dfn>, <em>int</em> <dfn class="local col6 decl" id="286len" title='len' data-type='int' data-ref="286len" data-ref-filename="286len">len</dfn>, <em>const</em> <em>char</em> *<dfn class="local col7 decl" id="287tnm" title='tnm' data-type='const char *' data-ref="287tnm" data-ref-filename="287tnm">tnm</dfn>, <em>int</em> <dfn class="local col8 decl" id="288tlen" title='tlen' data-type='int' data-ref="288tlen" data-ref-filename="288tlen">tlen</dfn>,</td></tr>
<tr><th id="589">589</th><td>	<a class="typedef" href="../sys/types.h.html#kauth_cred_t" title='kauth_cred_t' data-type='struct kauth_cred *' data-ref="kauth_cred_t" data-ref-filename="kauth_cred_t">kauth_cred_t</a> <dfn class="local col9 decl" id="289cred" title='cred' data-type='kauth_cred_t' data-ref="289cred" data-ref-filename="289cred">cred</dfn>, <b>struct</b> <a class="type" href="../sys/lwp.h.html#lwp" title='lwp' data-ref="lwp" data-ref-filename="lwp">lwp</a> *<dfn class="local col0 decl" id="290l" title='l' data-type='struct lwp *' data-ref="290l" data-ref-filename="290l">l</dfn>)</td></tr>
<tr><th id="590">590</th><td>{</td></tr>
<tr><th id="591">591</th><td>    <a class="macro" href="#80" title="struct coda_rename_in *inp; int coda_rename_size = sizeof (struct coda_rename_in); int Isize = sizeof (struct coda_rename_in); int Osize = sizeof (struct coda_out_hdr); int error" data-ref="_M/DECL_NO_OUT">DECL_NO_OUT</a>(coda_rename);		<i>/* sets Isize &amp; Osize */</i></td></tr>
<tr><th id="592">592</th><td>    <a class="local col5 ref" href="#591" title='coda_rename_size' data-ref="295coda_rename_size" data-ref-filename="295coda_rename_size">coda_rename_size</a> += <a class="local col6 ref" href="#286len" title='len' data-ref="286len" data-ref-filename="286len">len</a> + <var>1</var> + <a class="local col8 ref" href="#288tlen" title='tlen' data-ref="288tlen" data-ref-filename="288tlen">tlen</a> + <var>1</var>;</td></tr>
<tr><th id="593">593</th><td>    <a class="macro" href="#99" title="if (Osize &gt; coda_rename_size) coda_rename_size = Osize; do { inp = (struct coda_rename_in *)kern_malloc((unsigned long) coda_rename_size, 0x0000); if (inp == 0) { panic(&quot;kernel malloc returns 0 at %s:%d\n&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 593); } } while ( 0);" data-ref="_M/ALLOC_NO_OUT">ALLOC_NO_OUT</a>(coda_rename);		<i>/* sets inp &amp; outp */</i></td></tr>
<tr><th id="594">594</th><td></td></tr>
<tr><th id="595">595</th><td>    <i>/* send the open to venus. */</i></td></tr>
<tr><th id="596">596</th><td>    <a class="macro" href="#145" title="(&amp;inp-&gt;ih)-&gt;opcode = (14); (&amp;inp-&gt;ih)-&gt;pid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pid : -1; (&amp;inp-&gt;ih)-&gt;pgid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pgrp-&gt;pg_id : -1; (__builtin_expect(((cred != ((void *)0))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != NULL&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 596)); (__builtin_expect(((cred != ((kauth_cred_t)-2))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != FSCRED&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 596)); if (cred != ((kauth_cred_t)-1)) { (&amp;inp-&gt;ih)-&gt;uid = kauth_cred_geteuid(cred); } else { (&amp;inp-&gt;ih)-&gt;uid = -1; }" data-ref="_M/INIT_IN_L">INIT_IN_L</a>(&amp;<a class="local col1 ref" href="#591" title='inp' data-ref="291inp" data-ref-filename="291inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_rename_in::ih" title='coda_rename_in::ih' data-ref="coda_rename_in::ih" data-ref-filename="coda_rename_in..ih">ih</a>, <a class="macro" href="coda.h.html#321" title="14" data-ref="_M/CODA_RENAME">CODA_RENAME</a>, <a class="local col9 ref" href="#289cred" title='cred' data-ref="289cred" data-ref-filename="289cred">cred</a>, <a class="local col0 ref" href="#290l" title='l' data-ref="290l" data-ref-filename="290l">l</a>);</td></tr>
<tr><th id="597">597</th><td>    <a class="local col1 ref" href="#591" title='inp' data-ref="291inp" data-ref-filename="291inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_rename_in::sourceFid" title='coda_rename_in::sourceFid' data-ref="coda_rename_in::sourceFid" data-ref-filename="coda_rename_in..sourceFid">sourceFid</a> = *<a class="local col3 ref" href="#283fid" title='fid' data-ref="283fid" data-ref-filename="283fid">fid</a>;</td></tr>
<tr><th id="598">598</th><td>    <a class="local col1 ref" href="#591" title='inp' data-ref="291inp" data-ref-filename="291inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_rename_in::destFid" title='coda_rename_in::destFid' data-ref="coda_rename_in::destFid" data-ref-filename="coda_rename_in..destFid">destFid</a> = *<a class="local col4 ref" href="#284tfid" title='tfid' data-ref="284tfid" data-ref-filename="284tfid">tfid</a>;</td></tr>
<tr><th id="599">599</th><td></td></tr>
<tr><th id="600">600</th><td>    <a class="local col1 ref" href="#591" title='inp' data-ref="291inp" data-ref-filename="291inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_rename_in::srcname" title='coda_rename_in::srcname' data-ref="coda_rename_in::srcname" data-ref-filename="coda_rename_in..srcname">srcname</a> = <a class="local col2 ref" href="#591" title='Isize' data-ref="292Isize" data-ref-filename="292Isize">Isize</a>;</td></tr>
<tr><th id="601">601</th><td>    <a class="macro" href="#104" title="__builtin_memcpy((char *)inp + (int)inp-&gt;srcname, nm, len); ((char*)inp + (int)inp-&gt;srcname)[len++] = 0; Isize += len" data-ref="_M/STRCPY">STRCPY</a>(<a class="ref field" href="coda.h.html#coda_rename_in::srcname" title='coda_rename_in::srcname' data-ref="coda_rename_in::srcname" data-ref-filename="coda_rename_in..srcname">srcname</a>, <a class="local col5 ref" href="#285nm" title='nm' data-ref="285nm" data-ref-filename="285nm">nm</a>, <a class="local col6 ref" href="#286len" title='len' data-ref="286len" data-ref-filename="286len">len</a>);		<i>/* increments Isize */</i></td></tr>
<tr><th id="602">602</th><td></td></tr>
<tr><th id="603">603</th><td>    <a class="local col1 ref" href="#591" title='inp' data-ref="291inp" data-ref-filename="291inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_rename_in::destname" title='coda_rename_in::destname' data-ref="coda_rename_in::destname" data-ref-filename="coda_rename_in..destname">destname</a> = <a class="local col2 ref" href="#591" title='Isize' data-ref="292Isize" data-ref-filename="292Isize">Isize</a>;</td></tr>
<tr><th id="604">604</th><td>    <a class="macro" href="#104" title="__builtin_memcpy((char *)inp + (int)inp-&gt;destname, tnm, tlen); ((char*)inp + (int)inp-&gt;destname)[tlen++] = 0; Isize += tlen" data-ref="_M/STRCPY">STRCPY</a>(<a class="ref field" href="coda.h.html#coda_rename_in::destname" title='coda_rename_in::destname' data-ref="coda_rename_in::destname" data-ref-filename="coda_rename_in..destname">destname</a>, <a class="local col7 ref" href="#287tnm" title='tnm' data-ref="287tnm" data-ref-filename="287tnm">tnm</a>, <a class="local col8 ref" href="#288tlen" title='tlen' data-ref="288tlen" data-ref-filename="288tlen">tlen</a>);	<i>/* increments Isize */</i></td></tr>
<tr><th id="605">605</th><td></td></tr>
<tr><th id="606">606</th><td>    <a class="local col4 ref" href="#591" title='error' data-ref="294error" data-ref-filename="294error">error</a> = <a class="ref fn" href="cnode.h.html#coda_call" title='coda_call' data-ref="coda_call" data-ref-filename="coda_call">coda_call</a>(<a class="local col2 ref" href="#282mdp" title='mdp' data-ref="282mdp" data-ref-filename="282mdp">mdp</a>, <a class="local col2 ref" href="#591" title='Isize' data-ref="292Isize" data-ref-filename="292Isize">Isize</a>, &amp;<a class="local col3 ref" href="#591" title='Osize' data-ref="293Osize" data-ref-filename="293Osize">Osize</a>, (<em>char</em> *)<a class="local col1 ref" href="#591" title='inp' data-ref="291inp" data-ref-filename="291inp">inp</a>);</td></tr>
<tr><th id="607">607</th><td></td></tr>
<tr><th id="608">608</th><td>    <a class="macro" href="cnode.h.html#71" title="kern_free((inp))" data-ref="_M/CODA_FREE">CODA_FREE</a>(<a class="local col1 ref" href="#591" title='inp' data-ref="291inp" data-ref-filename="291inp">inp</a>, coda_rename_size);</td></tr>
<tr><th id="609">609</th><td>    <b>return</b> <a class="local col4 ref" href="#591" title='error' data-ref="294error" data-ref-filename="294error">error</a>;</td></tr>
<tr><th id="610">610</th><td>}</td></tr>
<tr><th id="611">611</th><td></td></tr>
<tr><th id="612">612</th><td><em>int</em></td></tr>
<tr><th id="613">613</th><td><dfn class="decl def fn" id="venus_mkdir" title='venus_mkdir' data-ref="venus_mkdir" data-ref-filename="venus_mkdir">venus_mkdir</dfn>(<em>void</em> *<dfn class="local col6 decl" id="296mdp" title='mdp' data-type='void *' data-ref="296mdp" data-ref-filename="296mdp">mdp</dfn>, <a class="typedef" href="coda.h.html#CodaFid" title='CodaFid' data-type='struct CodaFid' data-ref="CodaFid" data-ref-filename="CodaFid">CodaFid</a> *<dfn class="local col7 decl" id="297fid" title='fid' data-type='CodaFid *' data-ref="297fid" data-ref-filename="297fid">fid</dfn>,</td></tr>
<tr><th id="614">614</th><td>    	<em>const</em> <em>char</em> *<dfn class="local col8 decl" id="298nm" title='nm' data-type='const char *' data-ref="298nm" data-ref-filename="298nm">nm</dfn>, <em>int</em> <dfn class="local col9 decl" id="299len" title='len' data-type='int' data-ref="299len" data-ref-filename="299len">len</dfn>, <b>struct</b> <a class="type" href="../sys/vnode.h.html#vattr" title='vattr' data-ref="vattr" data-ref-filename="vattr">vattr</a> *<dfn class="local col0 decl" id="300va" title='va' data-type='struct vattr *' data-ref="300va" data-ref-filename="300va">va</dfn>,</td></tr>
<tr><th id="615">615</th><td>	<a class="typedef" href="../sys/types.h.html#kauth_cred_t" title='kauth_cred_t' data-type='struct kauth_cred *' data-ref="kauth_cred_t" data-ref-filename="kauth_cred_t">kauth_cred_t</a> <dfn class="local col1 decl" id="301cred" title='cred' data-type='kauth_cred_t' data-ref="301cred" data-ref-filename="301cred">cred</dfn>, <b>struct</b> <a class="type" href="../sys/lwp.h.html#lwp" title='lwp' data-ref="lwp" data-ref-filename="lwp">lwp</a> *<dfn class="local col2 decl" id="302l" title='l' data-type='struct lwp *' data-ref="302l" data-ref-filename="302l">l</dfn>,</td></tr>
<tr><th id="616">616</th><td><i>/*out*/</i>	<a class="typedef" href="coda.h.html#CodaFid" title='CodaFid' data-type='struct CodaFid' data-ref="CodaFid" data-ref-filename="CodaFid">CodaFid</a> *<dfn class="local col3 decl" id="303VFid" title='VFid' data-type='CodaFid *' data-ref="303VFid" data-ref-filename="303VFid">VFid</dfn>, <b>struct</b> <a class="type" href="../sys/vnode.h.html#vattr" title='vattr' data-ref="vattr" data-ref-filename="vattr">vattr</a> *<dfn class="local col4 decl" id="304ova" title='ova' data-type='struct vattr *' data-ref="304ova" data-ref-filename="304ova">ova</dfn>)</td></tr>
<tr><th id="617">617</th><td>{</td></tr>
<tr><th id="618">618</th><td>    <a class="macro" href="#72" title="struct coda_mkdir_in *inp; struct coda_mkdir_out *outp; int coda_mkdir_size = sizeof (struct coda_mkdir_in); int Isize = sizeof (struct coda_mkdir_in); int Osize = sizeof (struct coda_mkdir_out); int error" data-ref="_M/DECL">DECL</a>(coda_mkdir);			<i>/* sets Isize &amp; Osize */</i></td></tr>
<tr><th id="619">619</th><td>    <a class="local col0 ref" href="#618" title='coda_mkdir_size' data-ref="310coda_mkdir_size" data-ref-filename="310coda_mkdir_size">coda_mkdir_size</a> += <a class="local col9 ref" href="#299len" title='len' data-ref="299len" data-ref-filename="299len">len</a> + <var>1</var>;</td></tr>
<tr><th id="620">620</th><td>    <a class="macro" href="#93" title="if (Osize &gt; coda_mkdir_size) coda_mkdir_size = Osize; do { inp = (struct coda_mkdir_in *)kern_malloc((unsigned long) coda_mkdir_size, 0x0000); if (inp == 0) { panic(&quot;kernel malloc returns 0 at %s:%d\n&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 620); } } while ( 0); outp = (struct coda_mkdir_out *) inp" data-ref="_M/ALLOC">ALLOC</a>(coda_mkdir);			<i>/* sets inp &amp; outp */</i></td></tr>
<tr><th id="621">621</th><td></td></tr>
<tr><th id="622">622</th><td>    <i>/* send the open to venus. */</i></td></tr>
<tr><th id="623">623</th><td>    <a class="macro" href="#145" title="(&amp;inp-&gt;ih)-&gt;opcode = (15); (&amp;inp-&gt;ih)-&gt;pid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pid : -1; (&amp;inp-&gt;ih)-&gt;pgid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pgrp-&gt;pg_id : -1; (__builtin_expect(((cred != ((void *)0))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != NULL&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 623)); (__builtin_expect(((cred != ((kauth_cred_t)-2))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != FSCRED&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 623)); if (cred != ((kauth_cred_t)-1)) { (&amp;inp-&gt;ih)-&gt;uid = kauth_cred_geteuid(cred); } else { (&amp;inp-&gt;ih)-&gt;uid = -1; }" data-ref="_M/INIT_IN_L">INIT_IN_L</a>(&amp;<a class="local col5 ref" href="#618" title='inp' data-ref="305inp" data-ref-filename="305inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_mkdir_in::ih" title='coda_mkdir_in::ih' data-ref="coda_mkdir_in::ih" data-ref-filename="coda_mkdir_in..ih">ih</a>, <a class="macro" href="coda.h.html#322" title="15" data-ref="_M/CODA_MKDIR">CODA_MKDIR</a>, <a class="local col1 ref" href="#301cred" title='cred' data-ref="301cred" data-ref-filename="301cred">cred</a>, <a class="local col2 ref" href="#302l" title='l' data-ref="302l" data-ref-filename="302l">l</a>);</td></tr>
<tr><th id="624">624</th><td>    <a class="local col5 ref" href="#618" title='inp' data-ref="305inp" data-ref-filename="305inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_mkdir_in::Fid" title='coda_mkdir_in::Fid' data-ref="coda_mkdir_in::Fid" data-ref-filename="coda_mkdir_in..Fid">Fid</a> = *<a class="local col7 ref" href="#297fid" title='fid' data-ref="297fid" data-ref-filename="297fid">fid</a>;</td></tr>
<tr><th id="625">625</th><td>    <a class="macro" href="#181" title="do { (&amp;inp-&gt;attr)-&gt;va_type = (va)-&gt;va_type; (&amp;inp-&gt;attr)-&gt;va_mode = (va)-&gt;va_mode; (&amp;inp-&gt;attr)-&gt;va_nlink = (va)-&gt;va_nlink; (&amp;inp-&gt;attr)-&gt;va_uid = (va)-&gt;va_uid; (&amp;inp-&gt;attr)-&gt;va_gid = (va)-&gt;va_gid; (&amp;inp-&gt;attr)-&gt;va_fileid = (va)-&gt;va_fileid; (&amp;inp-&gt;attr)-&gt;va_size = (va)-&gt;va_size; (&amp;inp-&gt;attr)-&gt;va_blocksize = (va)-&gt;va_blocksize; (&amp;inp-&gt;attr)-&gt;va_atime = (va)-&gt;va_atime; (&amp;inp-&gt;attr)-&gt;va_mtime = (va)-&gt;va_mtime; (&amp;inp-&gt;attr)-&gt;va_ctime = (va)-&gt;va_ctime; (&amp;inp-&gt;attr)-&gt;va_gen = (va)-&gt;va_gen; (&amp;inp-&gt;attr)-&gt;va_flags = (va)-&gt;va_flags; (&amp;inp-&gt;attr)-&gt;va_rdev = (va)-&gt;va_rdev; (&amp;inp-&gt;attr)-&gt;va_bytes = (va)-&gt;va_bytes; (&amp;inp-&gt;attr)-&gt;va_filerev = (va)-&gt;va_filerev; } while ( 0)" data-ref="_M/CNV_V2VV_ATTR">CNV_V2VV_ATTR</a>(&amp;<a class="local col5 ref" href="#618" title='inp' data-ref="305inp" data-ref-filename="305inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_mkdir_in::attr" title='coda_mkdir_in::attr' data-ref="coda_mkdir_in::attr" data-ref-filename="coda_mkdir_in..attr">attr</a>, <a class="local col0 ref" href="#300va" title='va' data-ref="300va" data-ref-filename="300va">va</a>);</td></tr>
<tr><th id="626">626</th><td></td></tr>
<tr><th id="627">627</th><td>    <a class="local col5 ref" href="#618" title='inp' data-ref="305inp" data-ref-filename="305inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_mkdir_in::name" title='coda_mkdir_in::name' data-ref="coda_mkdir_in::name" data-ref-filename="coda_mkdir_in..name">name</a> = <a class="local col7 ref" href="#618" title='Isize' data-ref="307Isize" data-ref-filename="307Isize">Isize</a>;</td></tr>
<tr><th id="628">628</th><td>    <a class="macro" href="#104" title="__builtin_memcpy((char *)inp + (int)inp-&gt;name, nm, len); ((char*)inp + (int)inp-&gt;name)[len++] = 0; Isize += len" data-ref="_M/STRCPY">STRCPY</a>(<a class="ref field" href="coda.h.html#coda_mkdir_in::name" title='coda_mkdir_in::name' data-ref="coda_mkdir_in::name" data-ref-filename="coda_mkdir_in..name">name</a>, <a class="local col8 ref" href="#298nm" title='nm' data-ref="298nm" data-ref-filename="298nm">nm</a>, <a class="local col9 ref" href="#299len" title='len' data-ref="299len" data-ref-filename="299len">len</a>);		<i>/* increments Isize */</i></td></tr>
<tr><th id="629">629</th><td></td></tr>
<tr><th id="630">630</th><td>    <a class="local col9 ref" href="#618" title='error' data-ref="309error" data-ref-filename="309error">error</a> = <a class="ref fn" href="cnode.h.html#coda_call" title='coda_call' data-ref="coda_call" data-ref-filename="coda_call">coda_call</a>(<a class="local col6 ref" href="#296mdp" title='mdp' data-ref="296mdp" data-ref-filename="296mdp">mdp</a>, <a class="local col7 ref" href="#618" title='Isize' data-ref="307Isize" data-ref-filename="307Isize">Isize</a>, &amp;<a class="local col8 ref" href="#618" title='Osize' data-ref="308Osize" data-ref-filename="308Osize">Osize</a>, (<em>char</em> *)<a class="local col5 ref" href="#618" title='inp' data-ref="305inp" data-ref-filename="305inp">inp</a>);</td></tr>
<tr><th id="631">631</th><td>    <a class="macro" href="../lib/libkern/libkern.h.html#279" title="(__builtin_expect(((outp != ((void *)0))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;outp != NULL&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 631))" data-ref="_M/KASSERT">KASSERT</a>(<a class="local col6 ref" href="#618" title='outp' data-ref="306outp" data-ref-filename="306outp">outp</a> != <a class="macro" href="../sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>);</td></tr>
<tr><th id="632">632</th><td>    <b>if</b> (!<a class="local col9 ref" href="#618" title='error' data-ref="309error" data-ref-filename="309error">error</a>) {</td></tr>
<tr><th id="633">633</th><td>	*<a class="local col3 ref" href="#303VFid" title='VFid' data-ref="303VFid" data-ref-filename="303VFid">VFid</a> = <a class="local col6 ref" href="#618" title='outp' data-ref="306outp" data-ref-filename="306outp">outp</a>-&gt;<a class="ref field" href="coda.h.html#coda_mkdir_out::Fid" title='coda_mkdir_out::Fid' data-ref="coda_mkdir_out::Fid" data-ref-filename="coda_mkdir_out..Fid">Fid</a>;</td></tr>
<tr><th id="634">634</th><td>	<a class="macro" href="#158" title="do { (ova)-&gt;va_type = (&amp;outp-&gt;attr)-&gt;va_type; (ova)-&gt;va_mode = (&amp;outp-&gt;attr)-&gt;va_mode; (ova)-&gt;va_nlink = (&amp;outp-&gt;attr)-&gt;va_nlink; (ova)-&gt;va_uid = (&amp;outp-&gt;attr)-&gt;va_uid; (ova)-&gt;va_gid = (&amp;outp-&gt;attr)-&gt;va_gid; (ova)-&gt;va_fsid = (-1); (ova)-&gt;va_fileid = (&amp;outp-&gt;attr)-&gt;va_fileid; (ova)-&gt;va_size = (&amp;outp-&gt;attr)-&gt;va_size; (ova)-&gt;va_blocksize = (&amp;outp-&gt;attr)-&gt;va_blocksize; (ova)-&gt;va_atime = (&amp;outp-&gt;attr)-&gt;va_atime; (ova)-&gt;va_mtime = (&amp;outp-&gt;attr)-&gt;va_mtime; (ova)-&gt;va_ctime = (&amp;outp-&gt;attr)-&gt;va_ctime; (ova)-&gt;va_gen = (&amp;outp-&gt;attr)-&gt;va_gen; (ova)-&gt;va_flags = (&amp;outp-&gt;attr)-&gt;va_flags; (ova)-&gt;va_rdev = (&amp;outp-&gt;attr)-&gt;va_rdev; (ova)-&gt;va_bytes = (&amp;outp-&gt;attr)-&gt;va_bytes; (ova)-&gt;va_filerev = (&amp;outp-&gt;attr)-&gt;va_filerev; (ova)-&gt;va_vaflags = (-1); (ova)-&gt;va_spare = (-1); } while ( 0)" data-ref="_M/CNV_VV2V_ATTR">CNV_VV2V_ATTR</a>(<a class="local col4 ref" href="#304ova" title='ova' data-ref="304ova" data-ref-filename="304ova">ova</a>, &amp;<a class="local col6 ref" href="#618" title='outp' data-ref="306outp" data-ref-filename="306outp">outp</a>-&gt;<a class="ref field" href="coda.h.html#coda_mkdir_out::attr" title='coda_mkdir_out::attr' data-ref="coda_mkdir_out::attr" data-ref-filename="coda_mkdir_out..attr">attr</a>);</td></tr>
<tr><th id="635">635</th><td>    }</td></tr>
<tr><th id="636">636</th><td></td></tr>
<tr><th id="637">637</th><td>    <a class="macro" href="cnode.h.html#71" title="kern_free((inp))" data-ref="_M/CODA_FREE">CODA_FREE</a>(<a class="local col5 ref" href="#618" title='inp' data-ref="305inp" data-ref-filename="305inp">inp</a>, coda_mkdir_size);</td></tr>
<tr><th id="638">638</th><td>    <b>return</b> <a class="local col9 ref" href="#618" title='error' data-ref="309error" data-ref-filename="309error">error</a>;</td></tr>
<tr><th id="639">639</th><td>}</td></tr>
<tr><th id="640">640</th><td></td></tr>
<tr><th id="641">641</th><td><em>int</em></td></tr>
<tr><th id="642">642</th><td><dfn class="decl def fn" id="venus_rmdir" title='venus_rmdir' data-ref="venus_rmdir" data-ref-filename="venus_rmdir">venus_rmdir</dfn>(<em>void</em> *<dfn class="local col1 decl" id="311mdp" title='mdp' data-type='void *' data-ref="311mdp" data-ref-filename="311mdp">mdp</dfn>, <a class="typedef" href="coda.h.html#CodaFid" title='CodaFid' data-type='struct CodaFid' data-ref="CodaFid" data-ref-filename="CodaFid">CodaFid</a> *<dfn class="local col2 decl" id="312fid" title='fid' data-type='CodaFid *' data-ref="312fid" data-ref-filename="312fid">fid</dfn>,</td></tr>
<tr><th id="643">643</th><td>    	<em>const</em> <em>char</em> *<dfn class="local col3 decl" id="313nm" title='nm' data-type='const char *' data-ref="313nm" data-ref-filename="313nm">nm</dfn>, <em>int</em> <dfn class="local col4 decl" id="314len" title='len' data-type='int' data-ref="314len" data-ref-filename="314len">len</dfn>,</td></tr>
<tr><th id="644">644</th><td>	<a class="typedef" href="../sys/types.h.html#kauth_cred_t" title='kauth_cred_t' data-type='struct kauth_cred *' data-ref="kauth_cred_t" data-ref-filename="kauth_cred_t">kauth_cred_t</a> <dfn class="local col5 decl" id="315cred" title='cred' data-type='kauth_cred_t' data-ref="315cred" data-ref-filename="315cred">cred</dfn>, <b>struct</b> <a class="type" href="../sys/lwp.h.html#lwp" title='lwp' data-ref="lwp" data-ref-filename="lwp">lwp</a> *<dfn class="local col6 decl" id="316l" title='l' data-type='struct lwp *' data-ref="316l" data-ref-filename="316l">l</dfn>)</td></tr>
<tr><th id="645">645</th><td>{</td></tr>
<tr><th id="646">646</th><td>    <a class="macro" href="#80" title="struct coda_rmdir_in *inp; int coda_rmdir_size = sizeof (struct coda_rmdir_in); int Isize = sizeof (struct coda_rmdir_in); int Osize = sizeof (struct coda_out_hdr); int error" data-ref="_M/DECL_NO_OUT">DECL_NO_OUT</a>(coda_rmdir);		<i>/* sets Isize &amp; Osize */</i></td></tr>
<tr><th id="647">647</th><td>    <a class="local col1 ref" href="#646" title='coda_rmdir_size' data-ref="321coda_rmdir_size" data-ref-filename="321coda_rmdir_size">coda_rmdir_size</a> += <a class="local col4 ref" href="#314len" title='len' data-ref="314len" data-ref-filename="314len">len</a> + <var>1</var>;</td></tr>
<tr><th id="648">648</th><td>    <a class="macro" href="#99" title="if (Osize &gt; coda_rmdir_size) coda_rmdir_size = Osize; do { inp = (struct coda_rmdir_in *)kern_malloc((unsigned long) coda_rmdir_size, 0x0000); if (inp == 0) { panic(&quot;kernel malloc returns 0 at %s:%d\n&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 648); } } while ( 0);" data-ref="_M/ALLOC_NO_OUT">ALLOC_NO_OUT</a>(coda_rmdir);		<i>/* sets inp &amp; outp */</i></td></tr>
<tr><th id="649">649</th><td></td></tr>
<tr><th id="650">650</th><td>    <i>/* send the open to venus. */</i></td></tr>
<tr><th id="651">651</th><td>    <a class="macro" href="#145" title="(&amp;inp-&gt;ih)-&gt;opcode = (16); (&amp;inp-&gt;ih)-&gt;pid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pid : -1; (&amp;inp-&gt;ih)-&gt;pgid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pgrp-&gt;pg_id : -1; (__builtin_expect(((cred != ((void *)0))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != NULL&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 651)); (__builtin_expect(((cred != ((kauth_cred_t)-2))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != FSCRED&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 651)); if (cred != ((kauth_cred_t)-1)) { (&amp;inp-&gt;ih)-&gt;uid = kauth_cred_geteuid(cred); } else { (&amp;inp-&gt;ih)-&gt;uid = -1; }" data-ref="_M/INIT_IN_L">INIT_IN_L</a>(&amp;<a class="local col7 ref" href="#646" title='inp' data-ref="317inp" data-ref-filename="317inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_rmdir_in::ih" title='coda_rmdir_in::ih' data-ref="coda_rmdir_in::ih" data-ref-filename="coda_rmdir_in..ih">ih</a>, <a class="macro" href="coda.h.html#323" title="16" data-ref="_M/CODA_RMDIR">CODA_RMDIR</a>, <a class="local col5 ref" href="#315cred" title='cred' data-ref="315cred" data-ref-filename="315cred">cred</a>, <a class="local col6 ref" href="#316l" title='l' data-ref="316l" data-ref-filename="316l">l</a>);</td></tr>
<tr><th id="652">652</th><td>    <a class="local col7 ref" href="#646" title='inp' data-ref="317inp" data-ref-filename="317inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_rmdir_in::Fid" title='coda_rmdir_in::Fid' data-ref="coda_rmdir_in::Fid" data-ref-filename="coda_rmdir_in..Fid">Fid</a> = *<a class="local col2 ref" href="#312fid" title='fid' data-ref="312fid" data-ref-filename="312fid">fid</a>;</td></tr>
<tr><th id="653">653</th><td></td></tr>
<tr><th id="654">654</th><td>    <a class="local col7 ref" href="#646" title='inp' data-ref="317inp" data-ref-filename="317inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_rmdir_in::name" title='coda_rmdir_in::name' data-ref="coda_rmdir_in::name" data-ref-filename="coda_rmdir_in..name">name</a> = <a class="local col8 ref" href="#646" title='Isize' data-ref="318Isize" data-ref-filename="318Isize">Isize</a>;</td></tr>
<tr><th id="655">655</th><td>    <a class="macro" href="#104" title="__builtin_memcpy((char *)inp + (int)inp-&gt;name, nm, len); ((char*)inp + (int)inp-&gt;name)[len++] = 0; Isize += len" data-ref="_M/STRCPY">STRCPY</a>(<a class="ref field" href="coda.h.html#coda_rmdir_in::name" title='coda_rmdir_in::name' data-ref="coda_rmdir_in::name" data-ref-filename="coda_rmdir_in..name">name</a>, <a class="local col3 ref" href="#313nm" title='nm' data-ref="313nm" data-ref-filename="313nm">nm</a>, <a class="local col4 ref" href="#314len" title='len' data-ref="314len" data-ref-filename="314len">len</a>);		<i>/* increments Isize */</i></td></tr>
<tr><th id="656">656</th><td></td></tr>
<tr><th id="657">657</th><td>    <a class="local col0 ref" href="#646" title='error' data-ref="320error" data-ref-filename="320error">error</a> = <a class="ref fn" href="cnode.h.html#coda_call" title='coda_call' data-ref="coda_call" data-ref-filename="coda_call">coda_call</a>(<a class="local col1 ref" href="#311mdp" title='mdp' data-ref="311mdp" data-ref-filename="311mdp">mdp</a>, <a class="local col8 ref" href="#646" title='Isize' data-ref="318Isize" data-ref-filename="318Isize">Isize</a>, &amp;<a class="local col9 ref" href="#646" title='Osize' data-ref="319Osize" data-ref-filename="319Osize">Osize</a>, (<em>char</em> *)<a class="local col7 ref" href="#646" title='inp' data-ref="317inp" data-ref-filename="317inp">inp</a>);</td></tr>
<tr><th id="658">658</th><td></td></tr>
<tr><th id="659">659</th><td>    <a class="macro" href="cnode.h.html#71" title="kern_free((inp))" data-ref="_M/CODA_FREE">CODA_FREE</a>(<a class="local col7 ref" href="#646" title='inp' data-ref="317inp" data-ref-filename="317inp">inp</a>, coda_rmdir_size);</td></tr>
<tr><th id="660">660</th><td>    <b>return</b> <a class="local col0 ref" href="#646" title='error' data-ref="320error" data-ref-filename="320error">error</a>;</td></tr>
<tr><th id="661">661</th><td>}</td></tr>
<tr><th id="662">662</th><td></td></tr>
<tr><th id="663">663</th><td><em>int</em></td></tr>
<tr><th id="664">664</th><td><dfn class="decl def fn" id="venus_symlink" title='venus_symlink' data-ref="venus_symlink" data-ref-filename="venus_symlink">venus_symlink</dfn>(<em>void</em> *<dfn class="local col2 decl" id="322mdp" title='mdp' data-type='void *' data-ref="322mdp" data-ref-filename="322mdp">mdp</dfn>, <a class="typedef" href="coda.h.html#CodaFid" title='CodaFid' data-type='struct CodaFid' data-ref="CodaFid" data-ref-filename="CodaFid">CodaFid</a> *<dfn class="local col3 decl" id="323fid" title='fid' data-type='CodaFid *' data-ref="323fid" data-ref-filename="323fid">fid</dfn>,</td></tr>
<tr><th id="665">665</th><td>        <em>const</em> <em>char</em> *<dfn class="local col4 decl" id="324lnm" title='lnm' data-type='const char *' data-ref="324lnm" data-ref-filename="324lnm">lnm</dfn>, <em>int</em> <dfn class="local col5 decl" id="325llen" title='llen' data-type='int' data-ref="325llen" data-ref-filename="325llen">llen</dfn>, <em>const</em> <em>char</em> *<dfn class="local col6 decl" id="326nm" title='nm' data-type='const char *' data-ref="326nm" data-ref-filename="326nm">nm</dfn>, <em>int</em> <dfn class="local col7 decl" id="327len" title='len' data-type='int' data-ref="327len" data-ref-filename="327len">len</dfn>, <b>struct</b> <a class="type" href="../sys/vnode.h.html#vattr" title='vattr' data-ref="vattr" data-ref-filename="vattr">vattr</a> *<dfn class="local col8 decl" id="328va" title='va' data-type='struct vattr *' data-ref="328va" data-ref-filename="328va">va</dfn>,</td></tr>
<tr><th id="666">666</th><td>	<a class="typedef" href="../sys/types.h.html#kauth_cred_t" title='kauth_cred_t' data-type='struct kauth_cred *' data-ref="kauth_cred_t" data-ref-filename="kauth_cred_t">kauth_cred_t</a> <dfn class="local col9 decl" id="329cred" title='cred' data-type='kauth_cred_t' data-ref="329cred" data-ref-filename="329cred">cred</dfn>, <b>struct</b> <a class="type" href="../sys/lwp.h.html#lwp" title='lwp' data-ref="lwp" data-ref-filename="lwp">lwp</a> *<dfn class="local col0 decl" id="330l" title='l' data-type='struct lwp *' data-ref="330l" data-ref-filename="330l">l</dfn>)</td></tr>
<tr><th id="667">667</th><td>{</td></tr>
<tr><th id="668">668</th><td>    <a class="macro" href="#80" title="struct coda_symlink_in *inp; int coda_symlink_size = sizeof (struct coda_symlink_in); int Isize = sizeof (struct coda_symlink_in); int Osize = sizeof (struct coda_out_hdr); int error" data-ref="_M/DECL_NO_OUT">DECL_NO_OUT</a>(coda_symlink);		<i>/* sets Isize &amp; Osize */</i></td></tr>
<tr><th id="669">669</th><td>    <a class="local col5 ref" href="#668" title='coda_symlink_size' data-ref="335coda_symlink_size" data-ref-filename="335coda_symlink_size">coda_symlink_size</a> += <a class="local col5 ref" href="#325llen" title='llen' data-ref="325llen" data-ref-filename="325llen">llen</a> + <var>1</var> + <a class="local col7 ref" href="#327len" title='len' data-ref="327len" data-ref-filename="327len">len</a> + <var>1</var>;</td></tr>
<tr><th id="670">670</th><td>    <a class="macro" href="#99" title="if (Osize &gt; coda_symlink_size) coda_symlink_size = Osize; do { inp = (struct coda_symlink_in *)kern_malloc((unsigned long) coda_symlink_size, 0x0000); if (inp == 0) { panic(&quot;kernel malloc returns 0 at %s:%d\n&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 670); } } while ( 0);" data-ref="_M/ALLOC_NO_OUT">ALLOC_NO_OUT</a>(coda_symlink);		<i>/* sets inp &amp; outp */</i></td></tr>
<tr><th id="671">671</th><td></td></tr>
<tr><th id="672">672</th><td>    <i>/* send the open to venus. */</i></td></tr>
<tr><th id="673">673</th><td>    <a class="macro" href="#145" title="(&amp;inp-&gt;ih)-&gt;opcode = (18); (&amp;inp-&gt;ih)-&gt;pid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pid : -1; (&amp;inp-&gt;ih)-&gt;pgid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pgrp-&gt;pg_id : -1; (__builtin_expect(((cred != ((void *)0))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != NULL&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 673)); (__builtin_expect(((cred != ((kauth_cred_t)-2))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != FSCRED&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 673)); if (cred != ((kauth_cred_t)-1)) { (&amp;inp-&gt;ih)-&gt;uid = kauth_cred_geteuid(cred); } else { (&amp;inp-&gt;ih)-&gt;uid = -1; }" data-ref="_M/INIT_IN_L">INIT_IN_L</a>(&amp;<a class="local col1 ref" href="#668" title='inp' data-ref="331inp" data-ref-filename="331inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_symlink_in::ih" title='coda_symlink_in::ih' data-ref="coda_symlink_in::ih" data-ref-filename="coda_symlink_in..ih">ih</a>, <a class="macro" href="coda.h.html#325" title="18" data-ref="_M/CODA_SYMLINK">CODA_SYMLINK</a>, <a class="local col9 ref" href="#329cred" title='cred' data-ref="329cred" data-ref-filename="329cred">cred</a>, <a class="local col0 ref" href="#330l" title='l' data-ref="330l" data-ref-filename="330l">l</a>);</td></tr>
<tr><th id="674">674</th><td>    <a class="local col1 ref" href="#668" title='inp' data-ref="331inp" data-ref-filename="331inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_symlink_in::Fid" title='coda_symlink_in::Fid' data-ref="coda_symlink_in::Fid" data-ref-filename="coda_symlink_in..Fid">Fid</a> = *<a class="local col3 ref" href="#323fid" title='fid' data-ref="323fid" data-ref-filename="323fid">fid</a>;</td></tr>
<tr><th id="675">675</th><td>    <a class="macro" href="#181" title="do { (&amp;inp-&gt;attr)-&gt;va_type = (va)-&gt;va_type; (&amp;inp-&gt;attr)-&gt;va_mode = (va)-&gt;va_mode; (&amp;inp-&gt;attr)-&gt;va_nlink = (va)-&gt;va_nlink; (&amp;inp-&gt;attr)-&gt;va_uid = (va)-&gt;va_uid; (&amp;inp-&gt;attr)-&gt;va_gid = (va)-&gt;va_gid; (&amp;inp-&gt;attr)-&gt;va_fileid = (va)-&gt;va_fileid; (&amp;inp-&gt;attr)-&gt;va_size = (va)-&gt;va_size; (&amp;inp-&gt;attr)-&gt;va_blocksize = (va)-&gt;va_blocksize; (&amp;inp-&gt;attr)-&gt;va_atime = (va)-&gt;va_atime; (&amp;inp-&gt;attr)-&gt;va_mtime = (va)-&gt;va_mtime; (&amp;inp-&gt;attr)-&gt;va_ctime = (va)-&gt;va_ctime; (&amp;inp-&gt;attr)-&gt;va_gen = (va)-&gt;va_gen; (&amp;inp-&gt;attr)-&gt;va_flags = (va)-&gt;va_flags; (&amp;inp-&gt;attr)-&gt;va_rdev = (va)-&gt;va_rdev; (&amp;inp-&gt;attr)-&gt;va_bytes = (va)-&gt;va_bytes; (&amp;inp-&gt;attr)-&gt;va_filerev = (va)-&gt;va_filerev; } while ( 0)" data-ref="_M/CNV_V2VV_ATTR">CNV_V2VV_ATTR</a>(&amp;<a class="local col1 ref" href="#668" title='inp' data-ref="331inp" data-ref-filename="331inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_symlink_in::attr" title='coda_symlink_in::attr' data-ref="coda_symlink_in::attr" data-ref-filename="coda_symlink_in..attr">attr</a>, <a class="local col8 ref" href="#328va" title='va' data-ref="328va" data-ref-filename="328va">va</a>);</td></tr>
<tr><th id="676">676</th><td></td></tr>
<tr><th id="677">677</th><td>    <a class="local col1 ref" href="#668" title='inp' data-ref="331inp" data-ref-filename="331inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_symlink_in::srcname" title='coda_symlink_in::srcname' data-ref="coda_symlink_in::srcname" data-ref-filename="coda_symlink_in..srcname">srcname</a> = <a class="local col2 ref" href="#668" title='Isize' data-ref="332Isize" data-ref-filename="332Isize">Isize</a>;</td></tr>
<tr><th id="678">678</th><td>    <a class="macro" href="#104" title="__builtin_memcpy((char *)inp + (int)inp-&gt;srcname, lnm, llen); ((char*)inp + (int)inp-&gt;srcname)[llen++] = 0; Isize += llen" data-ref="_M/STRCPY">STRCPY</a>(<a class="ref field" href="coda.h.html#coda_symlink_in::srcname" title='coda_symlink_in::srcname' data-ref="coda_symlink_in::srcname" data-ref-filename="coda_symlink_in..srcname">srcname</a>, <a class="local col4 ref" href="#324lnm" title='lnm' data-ref="324lnm" data-ref-filename="324lnm">lnm</a>, <a class="local col5 ref" href="#325llen" title='llen' data-ref="325llen" data-ref-filename="325llen">llen</a>);		<i>/* increments Isize */</i></td></tr>
<tr><th id="679">679</th><td></td></tr>
<tr><th id="680">680</th><td>    <a class="local col1 ref" href="#668" title='inp' data-ref="331inp" data-ref-filename="331inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_symlink_in::tname" title='coda_symlink_in::tname' data-ref="coda_symlink_in::tname" data-ref-filename="coda_symlink_in..tname">tname</a> = <a class="local col2 ref" href="#668" title='Isize' data-ref="332Isize" data-ref-filename="332Isize">Isize</a>;</td></tr>
<tr><th id="681">681</th><td>    <a class="macro" href="#104" title="__builtin_memcpy((char *)inp + (int)inp-&gt;tname, nm, len); ((char*)inp + (int)inp-&gt;tname)[len++] = 0; Isize += len" data-ref="_M/STRCPY">STRCPY</a>(<a class="ref field" href="coda.h.html#coda_symlink_in::tname" title='coda_symlink_in::tname' data-ref="coda_symlink_in::tname" data-ref-filename="coda_symlink_in..tname">tname</a>, <a class="local col6 ref" href="#326nm" title='nm' data-ref="326nm" data-ref-filename="326nm">nm</a>, <a class="local col7 ref" href="#327len" title='len' data-ref="327len" data-ref-filename="327len">len</a>);		<i>/* increments Isize */</i></td></tr>
<tr><th id="682">682</th><td></td></tr>
<tr><th id="683">683</th><td>    <a class="local col4 ref" href="#668" title='error' data-ref="334error" data-ref-filename="334error">error</a> = <a class="ref fn" href="cnode.h.html#coda_call" title='coda_call' data-ref="coda_call" data-ref-filename="coda_call">coda_call</a>(<a class="local col2 ref" href="#322mdp" title='mdp' data-ref="322mdp" data-ref-filename="322mdp">mdp</a>, <a class="local col2 ref" href="#668" title='Isize' data-ref="332Isize" data-ref-filename="332Isize">Isize</a>, &amp;<a class="local col3 ref" href="#668" title='Osize' data-ref="333Osize" data-ref-filename="333Osize">Osize</a>, (<em>char</em> *)<a class="local col1 ref" href="#668" title='inp' data-ref="331inp" data-ref-filename="331inp">inp</a>);</td></tr>
<tr><th id="684">684</th><td></td></tr>
<tr><th id="685">685</th><td>    <a class="macro" href="cnode.h.html#71" title="kern_free((inp))" data-ref="_M/CODA_FREE">CODA_FREE</a>(<a class="local col1 ref" href="#668" title='inp' data-ref="331inp" data-ref-filename="331inp">inp</a>, coda_symlink_size);</td></tr>
<tr><th id="686">686</th><td>    <b>return</b> <a class="local col4 ref" href="#668" title='error' data-ref="334error" data-ref-filename="334error">error</a>;</td></tr>
<tr><th id="687">687</th><td>}</td></tr>
<tr><th id="688">688</th><td></td></tr>
<tr><th id="689">689</th><td><em>int</em></td></tr>
<tr><th id="690">690</th><td><dfn class="decl def fn" id="venus_readdir" title='venus_readdir' data-ref="venus_readdir" data-ref-filename="venus_readdir">venus_readdir</dfn>(<em>void</em> *<dfn class="local col6 decl" id="336mdp" title='mdp' data-type='void *' data-ref="336mdp" data-ref-filename="336mdp">mdp</dfn>, <a class="typedef" href="coda.h.html#CodaFid" title='CodaFid' data-type='struct CodaFid' data-ref="CodaFid" data-ref-filename="CodaFid">CodaFid</a> *<dfn class="local col7 decl" id="337fid" title='fid' data-type='CodaFid *' data-ref="337fid" data-ref-filename="337fid">fid</dfn>,</td></tr>
<tr><th id="691">691</th><td>    	<em>int</em> <dfn class="local col8 decl" id="338count" title='count' data-type='int' data-ref="338count" data-ref-filename="338count">count</dfn>, <em>int</em> <dfn class="local col9 decl" id="339offset" title='offset' data-type='int' data-ref="339offset" data-ref-filename="339offset">offset</dfn>,</td></tr>
<tr><th id="692">692</th><td>	<a class="typedef" href="../sys/types.h.html#kauth_cred_t" title='kauth_cred_t' data-type='struct kauth_cred *' data-ref="kauth_cred_t" data-ref-filename="kauth_cred_t">kauth_cred_t</a> <dfn class="local col0 decl" id="340cred" title='cred' data-type='kauth_cred_t' data-ref="340cred" data-ref-filename="340cred">cred</dfn>, <b>struct</b> <a class="type" href="../sys/lwp.h.html#lwp" title='lwp' data-ref="lwp" data-ref-filename="lwp">lwp</a> *<dfn class="local col1 decl" id="341l" title='l' data-type='struct lwp *' data-ref="341l" data-ref-filename="341l">l</dfn>,</td></tr>
<tr><th id="693">693</th><td><i>/*out*/</i>	<em>char</em> *<dfn class="local col2 decl" id="342buffer" title='buffer' data-type='char *' data-ref="342buffer" data-ref-filename="342buffer">buffer</dfn>, <em>int</em> *<dfn class="local col3 decl" id="343len" title='len' data-type='int *' data-ref="343len" data-ref-filename="343len">len</dfn>)</td></tr>
<tr><th id="694">694</th><td>{</td></tr>
<tr><th id="695">695</th><td>    <a class="macro" href="#72" title="struct coda_readdir_in *inp; struct coda_readdir_out *outp; int coda_readdir_size = sizeof (struct coda_readdir_in); int Isize = sizeof (struct coda_readdir_in); int Osize = sizeof (struct coda_readdir_out); int error" data-ref="_M/DECL">DECL</a>(coda_readdir);			<i>/* sets Isize &amp; Osize */</i></td></tr>
<tr><th id="696">696</th><td>    <a class="local col9 ref" href="#695" title='coda_readdir_size' data-ref="349coda_readdir_size" data-ref-filename="349coda_readdir_size">coda_readdir_size</a> = <a class="macro" href="coda.h.html#346" title="sizeof(union inputArgs)+sizeof(union outputArgs) + 8192" data-ref="_M/VC_MAXMSGSIZE">VC_MAXMSGSIZE</a>;</td></tr>
<tr><th id="697">697</th><td>    <a class="macro" href="#93" title="if (Osize &gt; coda_readdir_size) coda_readdir_size = Osize; do { inp = (struct coda_readdir_in *)kern_malloc((unsigned long) coda_readdir_size, 0x0000); if (inp == 0) { panic(&quot;kernel malloc returns 0 at %s:%d\n&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 697); } } while ( 0); outp = (struct coda_readdir_out *) inp" data-ref="_M/ALLOC">ALLOC</a>(coda_readdir);			<i>/* sets inp &amp; outp */</i></td></tr>
<tr><th id="698">698</th><td></td></tr>
<tr><th id="699">699</th><td>    <i>/* send the open to venus. */</i></td></tr>
<tr><th id="700">700</th><td>    <a class="macro" href="#145" title="(&amp;inp-&gt;ih)-&gt;opcode = (17); (&amp;inp-&gt;ih)-&gt;pid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pid : -1; (&amp;inp-&gt;ih)-&gt;pgid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pgrp-&gt;pg_id : -1; (__builtin_expect(((cred != ((void *)0))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != NULL&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 700)); (__builtin_expect(((cred != ((kauth_cred_t)-2))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != FSCRED&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 700)); if (cred != ((kauth_cred_t)-1)) { (&amp;inp-&gt;ih)-&gt;uid = kauth_cred_geteuid(cred); } else { (&amp;inp-&gt;ih)-&gt;uid = -1; }" data-ref="_M/INIT_IN_L">INIT_IN_L</a>(&amp;<a class="local col4 ref" href="#695" title='inp' data-ref="344inp" data-ref-filename="344inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_readdir_in::ih" title='coda_readdir_in::ih' data-ref="coda_readdir_in::ih" data-ref-filename="coda_readdir_in..ih">ih</a>, <a class="macro" href="coda.h.html#324" title="17" data-ref="_M/CODA_READDIR">CODA_READDIR</a>, <a class="local col0 ref" href="#340cred" title='cred' data-ref="340cred" data-ref-filename="340cred">cred</a>, <a class="local col1 ref" href="#341l" title='l' data-ref="341l" data-ref-filename="341l">l</a>);</td></tr>
<tr><th id="701">701</th><td>    <a class="local col4 ref" href="#695" title='inp' data-ref="344inp" data-ref-filename="344inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_readdir_in::Fid" title='coda_readdir_in::Fid' data-ref="coda_readdir_in::Fid" data-ref-filename="coda_readdir_in..Fid">Fid</a> = *<a class="local col7 ref" href="#337fid" title='fid' data-ref="337fid" data-ref-filename="337fid">fid</a>;</td></tr>
<tr><th id="702">702</th><td>    <a class="local col4 ref" href="#695" title='inp' data-ref="344inp" data-ref-filename="344inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_readdir_in::count" title='coda_readdir_in::count' data-ref="coda_readdir_in::count" data-ref-filename="coda_readdir_in..count">count</a> = <a class="local col8 ref" href="#338count" title='count' data-ref="338count" data-ref-filename="338count">count</a>;</td></tr>
<tr><th id="703">703</th><td>    <a class="local col4 ref" href="#695" title='inp' data-ref="344inp" data-ref-filename="344inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_readdir_in::offset" title='coda_readdir_in::offset' data-ref="coda_readdir_in::offset" data-ref-filename="coda_readdir_in..offset">offset</a> = <a class="local col9 ref" href="#339offset" title='offset' data-ref="339offset" data-ref-filename="339offset">offset</a>;</td></tr>
<tr><th id="704">704</th><td></td></tr>
<tr><th id="705">705</th><td>    <a class="local col7 ref" href="#695" title='Osize' data-ref="347Osize" data-ref-filename="347Osize">Osize</a> = <a class="macro" href="coda.h.html#346" title="sizeof(union inputArgs)+sizeof(union outputArgs) + 8192" data-ref="_M/VC_MAXMSGSIZE">VC_MAXMSGSIZE</a>;</td></tr>
<tr><th id="706">706</th><td>    <a class="local col8 ref" href="#695" title='error' data-ref="348error" data-ref-filename="348error">error</a> = <a class="ref fn" href="cnode.h.html#coda_call" title='coda_call' data-ref="coda_call" data-ref-filename="coda_call">coda_call</a>(<a class="local col6 ref" href="#336mdp" title='mdp' data-ref="336mdp" data-ref-filename="336mdp">mdp</a>, <a class="local col6 ref" href="#695" title='Isize' data-ref="346Isize" data-ref-filename="346Isize">Isize</a>, &amp;<a class="local col7 ref" href="#695" title='Osize' data-ref="347Osize" data-ref-filename="347Osize">Osize</a>, (<em>char</em> *)<a class="local col4 ref" href="#695" title='inp' data-ref="344inp" data-ref-filename="344inp">inp</a>);</td></tr>
<tr><th id="707">707</th><td>    <a class="macro" href="../lib/libkern/libkern.h.html#279" title="(__builtin_expect(((outp != ((void *)0))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;outp != NULL&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 707))" data-ref="_M/KASSERT">KASSERT</a>(<a class="local col5 ref" href="#695" title='outp' data-ref="345outp" data-ref-filename="345outp">outp</a> != <a class="macro" href="../sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>);</td></tr>
<tr><th id="708">708</th><td>    <b>if</b> (!<a class="local col8 ref" href="#695" title='error' data-ref="348error" data-ref-filename="348error">error</a>) {</td></tr>
<tr><th id="709">709</th><td>	<a class="macro" href="../lib/libkern/libkern.h.html#380" title="__builtin_memcpy(buffer, (char *)outp + (int)(long)outp-&gt;data, outp-&gt;size)" data-ref="_M/memcpy">memcpy</a>(<a class="local col2 ref" href="#342buffer" title='buffer' data-ref="342buffer" data-ref-filename="342buffer">buffer</a>, (<em>char</em> *)<a class="local col5 ref" href="#695" title='outp' data-ref="345outp" data-ref-filename="345outp">outp</a> + (<em>int</em>)(<em>long</em>)<a class="local col5 ref" href="#695" title='outp' data-ref="345outp" data-ref-filename="345outp">outp</a>-&gt;<a class="ref field" href="coda.h.html#coda_readdir_out::data" title='coda_readdir_out::data' data-ref="coda_readdir_out::data" data-ref-filename="coda_readdir_out..data">data</a>, <a class="local col5 ref" href="#695" title='outp' data-ref="345outp" data-ref-filename="345outp">outp</a>-&gt;<a class="ref field" href="coda.h.html#coda_readdir_out::size" title='coda_readdir_out::size' data-ref="coda_readdir_out::size" data-ref-filename="coda_readdir_out..size">size</a>);</td></tr>
<tr><th id="710">710</th><td>	*<a class="local col3 ref" href="#343len" title='len' data-ref="343len" data-ref-filename="343len">len</a> = <a class="local col5 ref" href="#695" title='outp' data-ref="345outp" data-ref-filename="345outp">outp</a>-&gt;<a class="ref field" href="coda.h.html#coda_readdir_out::size" title='coda_readdir_out::size' data-ref="coda_readdir_out::size" data-ref-filename="coda_readdir_out..size">size</a>;</td></tr>
<tr><th id="711">711</th><td>    }</td></tr>
<tr><th id="712">712</th><td></td></tr>
<tr><th id="713">713</th><td>    <a class="macro" href="cnode.h.html#71" title="kern_free((inp))" data-ref="_M/CODA_FREE">CODA_FREE</a>(<a class="local col4 ref" href="#695" title='inp' data-ref="344inp" data-ref-filename="344inp">inp</a>, coda_readdir_size);</td></tr>
<tr><th id="714">714</th><td>    <b>return</b> <a class="local col8 ref" href="#695" title='error' data-ref="348error" data-ref-filename="348error">error</a>;</td></tr>
<tr><th id="715">715</th><td>}</td></tr>
<tr><th id="716">716</th><td></td></tr>
<tr><th id="717">717</th><td><em>int</em></td></tr>
<tr><th id="718">718</th><td><dfn class="decl def fn" id="venus_statfs" title='venus_statfs' data-ref="venus_statfs" data-ref-filename="venus_statfs">venus_statfs</dfn>(<em>void</em> *<dfn class="local col0 decl" id="350mdp" title='mdp' data-type='void *' data-ref="350mdp" data-ref-filename="350mdp">mdp</dfn>, <a class="typedef" href="../sys/types.h.html#kauth_cred_t" title='kauth_cred_t' data-type='struct kauth_cred *' data-ref="kauth_cred_t" data-ref-filename="kauth_cred_t">kauth_cred_t</a> <dfn class="local col1 decl" id="351cred" title='cred' data-type='kauth_cred_t' data-ref="351cred" data-ref-filename="351cred">cred</dfn>, <b>struct</b> <a class="type" href="../sys/lwp.h.html#lwp" title='lwp' data-ref="lwp" data-ref-filename="lwp">lwp</a> *<dfn class="local col2 decl" id="352l" title='l' data-type='struct lwp *' data-ref="352l" data-ref-filename="352l">l</dfn>,</td></tr>
<tr><th id="719">719</th><td>   <i>/*out*/</i>   <b>struct</b> <a class="type" href="coda.h.html#coda_statfs" title='coda_statfs' data-ref="coda_statfs" data-ref-filename="coda_statfs">coda_statfs</a> *<dfn class="local col3 decl" id="353fsp" title='fsp' data-type='struct coda_statfs *' data-ref="353fsp" data-ref-filename="353fsp">fsp</dfn>)</td></tr>
<tr><th id="720">720</th><td>{</td></tr>
<tr><th id="721">721</th><td>    <a class="macro" href="#72" title="struct coda_statfs_in *inp; struct coda_statfs_out *outp; int coda_statfs_size = sizeof (struct coda_statfs_in); int Isize = sizeof (struct coda_statfs_in); int Osize = sizeof (struct coda_statfs_out); int error" data-ref="_M/DECL">DECL</a>(coda_statfs);			<i>/* sets Isize &amp; Osize */</i></td></tr>
<tr><th id="722">722</th><td>    <a class="macro" href="#93" title="if (Osize &gt; coda_statfs_size) coda_statfs_size = Osize; do { inp = (struct coda_statfs_in *)kern_malloc((unsigned long) coda_statfs_size, 0x0000); if (inp == 0) { panic(&quot;kernel malloc returns 0 at %s:%d\n&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 722); } } while ( 0); outp = (struct coda_statfs_out *) inp" data-ref="_M/ALLOC">ALLOC</a>(coda_statfs);			<i>/* sets inp &amp; outp */</i></td></tr>
<tr><th id="723">723</th><td></td></tr>
<tr><th id="724">724</th><td>    <i>/* send the open to venus. */</i></td></tr>
<tr><th id="725">725</th><td>    <a class="macro" href="#145" title="(&amp;inp-&gt;ih)-&gt;opcode = (34); (&amp;inp-&gt;ih)-&gt;pid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pid : -1; (&amp;inp-&gt;ih)-&gt;pgid = (l ? l-&gt;l_proc : ((void *)0)) ? (l ? l-&gt;l_proc : ((void *)0))-&gt;p_pgrp-&gt;pg_id : -1; (__builtin_expect(((cred != ((void *)0))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != NULL&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 725)); (__builtin_expect(((cred != ((kauth_cred_t)-2))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != FSCRED&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 725)); if (cred != ((kauth_cred_t)-1)) { (&amp;inp-&gt;ih)-&gt;uid = kauth_cred_geteuid(cred); } else { (&amp;inp-&gt;ih)-&gt;uid = -1; }" data-ref="_M/INIT_IN_L">INIT_IN_L</a>(&amp;<a class="local col4 ref" href="#721" title='inp' data-ref="354inp" data-ref-filename="354inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_statfs_in::ih" title='coda_statfs_in::ih' data-ref="coda_statfs_in::ih" data-ref-filename="coda_statfs_in..ih">ih</a>, <a class="macro" href="coda.h.html#340" title="34" data-ref="_M/CODA_STATFS">CODA_STATFS</a>, <a class="local col1 ref" href="#351cred" title='cred' data-ref="351cred" data-ref-filename="351cred">cred</a>, <a class="local col2 ref" href="#352l" title='l' data-ref="352l" data-ref-filename="352l">l</a>);</td></tr>
<tr><th id="726">726</th><td></td></tr>
<tr><th id="727">727</th><td>    <a class="local col8 ref" href="#721" title='error' data-ref="358error" data-ref-filename="358error">error</a> = <a class="ref fn" href="cnode.h.html#coda_call" title='coda_call' data-ref="coda_call" data-ref-filename="coda_call">coda_call</a>(<a class="local col0 ref" href="#350mdp" title='mdp' data-ref="350mdp" data-ref-filename="350mdp">mdp</a>, <a class="local col6 ref" href="#721" title='Isize' data-ref="356Isize" data-ref-filename="356Isize">Isize</a>, &amp;<a class="local col7 ref" href="#721" title='Osize' data-ref="357Osize" data-ref-filename="357Osize">Osize</a>, (<em>char</em> *)<a class="local col4 ref" href="#721" title='inp' data-ref="354inp" data-ref-filename="354inp">inp</a>);</td></tr>
<tr><th id="728">728</th><td>    <a class="macro" href="../lib/libkern/libkern.h.html#279" title="(__builtin_expect(((outp != ((void *)0))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;outp != NULL&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 728))" data-ref="_M/KASSERT">KASSERT</a>(<a class="local col5 ref" href="#721" title='outp' data-ref="355outp" data-ref-filename="355outp">outp</a> != <a class="macro" href="../sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>);</td></tr>
<tr><th id="729">729</th><td>    <b>if</b> (!<a class="local col8 ref" href="#721" title='error' data-ref="358error" data-ref-filename="358error">error</a>) {</td></tr>
<tr><th id="730">730</th><td>        *<a class="local col3 ref" href="#353fsp" title='fsp' data-ref="353fsp" data-ref-filename="353fsp">fsp</a> = <a class="local col5 ref" href="#721" title='outp' data-ref="355outp" data-ref-filename="355outp">outp</a>-&gt;<a class="ref field" href="coda.h.html#coda_statfs_out::stat" title='coda_statfs_out::stat' data-ref="coda_statfs_out::stat" data-ref-filename="coda_statfs_out..stat">stat</a>;</td></tr>
<tr><th id="731">731</th><td>    }</td></tr>
<tr><th id="732">732</th><td></td></tr>
<tr><th id="733">733</th><td>    <a class="macro" href="cnode.h.html#71" title="kern_free((inp))" data-ref="_M/CODA_FREE">CODA_FREE</a>(<a class="local col4 ref" href="#721" title='inp' data-ref="354inp" data-ref-filename="354inp">inp</a>, coda_statfs_size);</td></tr>
<tr><th id="734">734</th><td>    <b>return</b> <a class="local col8 ref" href="#721" title='error' data-ref="358error" data-ref-filename="358error">error</a>;</td></tr>
<tr><th id="735">735</th><td>}</td></tr>
<tr><th id="736">736</th><td></td></tr>
<tr><th id="737">737</th><td><em>int</em></td></tr>
<tr><th id="738">738</th><td><dfn class="decl def fn" id="venus_fhtovp" title='venus_fhtovp' data-ref="venus_fhtovp" data-ref-filename="venus_fhtovp">venus_fhtovp</dfn>(<em>void</em> *<dfn class="local col9 decl" id="359mdp" title='mdp' data-type='void *' data-ref="359mdp" data-ref-filename="359mdp">mdp</dfn>, <a class="typedef" href="coda.h.html#CodaFid" title='CodaFid' data-type='struct CodaFid' data-ref="CodaFid" data-ref-filename="CodaFid">CodaFid</a> *<dfn class="local col0 decl" id="360fid" title='fid' data-type='CodaFid *' data-ref="360fid" data-ref-filename="360fid">fid</dfn>,</td></tr>
<tr><th id="739">739</th><td>	<a class="typedef" href="../sys/types.h.html#kauth_cred_t" title='kauth_cred_t' data-type='struct kauth_cred *' data-ref="kauth_cred_t" data-ref-filename="kauth_cred_t">kauth_cred_t</a> <dfn class="local col1 decl" id="361cred" title='cred' data-type='kauth_cred_t' data-ref="361cred" data-ref-filename="361cred">cred</dfn>, <b>struct</b> <a class="type" href="../sys/proc.h.html#proc" title='proc' data-ref="proc" data-ref-filename="proc">proc</a> *<dfn class="local col2 decl" id="362p" title='p' data-type='struct proc *' data-ref="362p" data-ref-filename="362p">p</dfn>,</td></tr>
<tr><th id="740">740</th><td><i>/*out*/</i>	<a class="typedef" href="coda.h.html#CodaFid" title='CodaFid' data-type='struct CodaFid' data-ref="CodaFid" data-ref-filename="CodaFid">CodaFid</a> *<dfn class="local col3 decl" id="363VFid" title='VFid' data-type='CodaFid *' data-ref="363VFid" data-ref-filename="363VFid">VFid</dfn>, <em>int</em> *<dfn class="local col4 decl" id="364vtype" title='vtype' data-type='int *' data-ref="364vtype" data-ref-filename="364vtype">vtype</dfn>)</td></tr>
<tr><th id="741">741</th><td>{</td></tr>
<tr><th id="742">742</th><td>    <a class="macro" href="#72" title="struct coda_vget_in *inp; struct coda_vget_out *outp; int coda_vget_size = sizeof (struct coda_vget_in); int Isize = sizeof (struct coda_vget_in); int Osize = sizeof (struct coda_vget_out); int error" data-ref="_M/DECL">DECL</a>(coda_vget);			<i>/* sets Isize &amp; Osize */</i></td></tr>
<tr><th id="743">743</th><td>    <a class="macro" href="#93" title="if (Osize &gt; coda_vget_size) coda_vget_size = Osize; do { inp = (struct coda_vget_in *)kern_malloc((unsigned long) coda_vget_size, 0x0000); if (inp == 0) { panic(&quot;kernel malloc returns 0 at %s:%d\n&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 743); } } while ( 0); outp = (struct coda_vget_out *) inp" data-ref="_M/ALLOC">ALLOC</a>(coda_vget);			<i>/* sets inp &amp; outp */</i></td></tr>
<tr><th id="744">744</th><td></td></tr>
<tr><th id="745">745</th><td>    <i>/* Send the open to Venus. */</i></td></tr>
<tr><th id="746">746</th><td>    <a class="macro" href="#131" title="(&amp;inp-&gt;ih)-&gt;opcode = (22); (&amp;inp-&gt;ih)-&gt;pid = p ? p-&gt;p_pid : -1; (&amp;inp-&gt;ih)-&gt;pgid = p ? p-&gt;p_pgrp-&gt;pg_id : -1; (__builtin_expect(((cred != ((void *)0))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != NULL&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 746)); (__builtin_expect(((cred != ((kauth_cred_t)-2))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;cred != FSCRED&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 746)); if (cred != ((kauth_cred_t)-1)) { (&amp;inp-&gt;ih)-&gt;uid = kauth_cred_geteuid(cred); } else { (&amp;inp-&gt;ih)-&gt;uid = -1; }" data-ref="_M/INIT_IN">INIT_IN</a>(&amp;<a class="local col5 ref" href="#742" title='inp' data-ref="365inp" data-ref-filename="365inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_vget_in::ih" title='coda_vget_in::ih' data-ref="coda_vget_in::ih" data-ref-filename="coda_vget_in..ih">ih</a>, <a class="macro" href="coda.h.html#329" title="22" data-ref="_M/CODA_VGET">CODA_VGET</a>, <a class="local col1 ref" href="#361cred" title='cred' data-ref="361cred" data-ref-filename="361cred">cred</a>, <a class="local col2 ref" href="#362p" title='p' data-ref="362p" data-ref-filename="362p">p</a>);</td></tr>
<tr><th id="747">747</th><td>    <a class="local col5 ref" href="#742" title='inp' data-ref="365inp" data-ref-filename="365inp">inp</a>-&gt;<a class="ref field" href="coda.h.html#coda_vget_in::Fid" title='coda_vget_in::Fid' data-ref="coda_vget_in::Fid" data-ref-filename="coda_vget_in..Fid">Fid</a> = *<a class="local col0 ref" href="#360fid" title='fid' data-ref="360fid" data-ref-filename="360fid">fid</a>;</td></tr>
<tr><th id="748">748</th><td></td></tr>
<tr><th id="749">749</th><td>    <a class="local col9 ref" href="#742" title='error' data-ref="369error" data-ref-filename="369error">error</a> = <a class="ref fn" href="cnode.h.html#coda_call" title='coda_call' data-ref="coda_call" data-ref-filename="coda_call">coda_call</a>(<a class="local col9 ref" href="#359mdp" title='mdp' data-ref="359mdp" data-ref-filename="359mdp">mdp</a>, <a class="local col7 ref" href="#742" title='Isize' data-ref="367Isize" data-ref-filename="367Isize">Isize</a>, &amp;<a class="local col8 ref" href="#742" title='Osize' data-ref="368Osize" data-ref-filename="368Osize">Osize</a>, (<em>char</em> *)<a class="local col5 ref" href="#742" title='inp' data-ref="365inp" data-ref-filename="365inp">inp</a>);</td></tr>
<tr><th id="750">750</th><td>    <a class="macro" href="../lib/libkern/libkern.h.html#279" title="(__builtin_expect(((outp != ((void *)0))) != 0, 1) ? (void)0 : kern_assert(&quot;kernel %sassertion \&quot;%s\&quot; failed: file \&quot;%s\&quot;, line %d &quot;, &quot;diagnostic &quot;, &quot;outp != NULL&quot;, &quot;/___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/coda/coda_venus.c&quot;, 750))" data-ref="_M/KASSERT">KASSERT</a>(<a class="local col6 ref" href="#742" title='outp' data-ref="366outp" data-ref-filename="366outp">outp</a> != <a class="macro" href="../sys/null.h.html#13" title="((void *)0)" data-ref="_M/NULL">NULL</a>);</td></tr>
<tr><th id="751">751</th><td>    <b>if</b> (!<a class="local col9 ref" href="#742" title='error' data-ref="369error" data-ref-filename="369error">error</a>) {</td></tr>
<tr><th id="752">752</th><td>	*<a class="local col3 ref" href="#363VFid" title='VFid' data-ref="363VFid" data-ref-filename="363VFid">VFid</a> = <a class="local col6 ref" href="#742" title='outp' data-ref="366outp" data-ref-filename="366outp">outp</a>-&gt;<a class="ref field" href="coda.h.html#coda_vget_out::Fid" title='coda_vget_out::Fid' data-ref="coda_vget_out::Fid" data-ref-filename="coda_vget_out..Fid">Fid</a>;</td></tr>
<tr><th id="753">753</th><td>	*<a class="local col4 ref" href="#364vtype" title='vtype' data-ref="364vtype" data-ref-filename="364vtype">vtype</a> = <a class="local col6 ref" href="#742" title='outp' data-ref="366outp" data-ref-filename="366outp">outp</a>-&gt;<a class="ref field" href="coda.h.html#coda_vget_out::vtype" title='coda_vget_out::vtype' data-ref="coda_vget_out::vtype" data-ref-filename="coda_vget_out..vtype">vtype</a>;</td></tr>
<tr><th id="754">754</th><td>    }</td></tr>
<tr><th id="755">755</th><td></td></tr>
<tr><th id="756">756</th><td>    <a class="macro" href="cnode.h.html#71" title="kern_free((inp))" data-ref="_M/CODA_FREE">CODA_FREE</a>(<a class="local col5 ref" href="#742" title='inp' data-ref="365inp" data-ref-filename="365inp">inp</a>, coda_vget_size);</td></tr>
<tr><th id="757">757</th><td>    <b>return</b> <a class="local col9 ref" href="#742" title='error' data-ref="369error" data-ref-filename="369error">error</a>;</td></tr>
<tr><th id="758">758</th><td>}</td></tr>
<tr><th id="759">759</th><td></td></tr>
</table><hr/><p id='footer'>
Generated on <em>2019-Jul-19</em> from project netbsd revision <em>f9da89e0d</em><br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 2.1
<br/>Generator usage only permitted with license.</p>
</div></body></html>
