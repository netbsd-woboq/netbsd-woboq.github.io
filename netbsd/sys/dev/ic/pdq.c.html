<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>pdq.c source code [netbsd/sys/dev/ic/pdq.c] - Woboq Code Browser</title>
<link rel="stylesheet" href="https://code.woboq.org/data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="https://code.woboq.org/data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="https://code.woboq.org/data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="https://code.woboq.org/data/jquery/jquery-ui.min.js"></script>
<script>var file = 'netbsd/sys/dev/ic/pdq.c'; var root_path = '../../../..'; var data_path = 'https://code.woboq.org/data'; var ecma_script_api_version = 2;</script>
<script src='https://code.woboq.org/data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='../../..'>netbsd</a>/<a href='../..'>sys</a>/<a href='..'>dev</a>/<a href='./'>ic</a>/<a href='pdq.c.html'>pdq.c</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>/*	$NetBSD: pdq.c,v 1.40 2013/09/15 09:26:39 martin Exp $	*/</i></td></tr>
<tr><th id="2">2</th><td></td></tr>
<tr><th id="3">3</th><td><i>/*-</i></td></tr>
<tr><th id="4">4</th><td><i> * Copyright (c) 1995,1996 Matt Thomas &lt;matt@3am-software.com&gt;</i></td></tr>
<tr><th id="5">5</th><td><i> * All rights reserved.</i></td></tr>
<tr><th id="6">6</th><td><i> *</i></td></tr>
<tr><th id="7">7</th><td><i> * Redistribution and use in source and binary forms, with or without</i></td></tr>
<tr><th id="8">8</th><td><i> * modification, are permitted provided that the following conditions</i></td></tr>
<tr><th id="9">9</th><td><i> * are met:</i></td></tr>
<tr><th id="10">10</th><td><i> * 1. Redistributions of source code must retain the above copyright</i></td></tr>
<tr><th id="11">11</th><td><i> *    notice, this list of conditions and the following disclaimer.</i></td></tr>
<tr><th id="12">12</th><td><i> * 2. The name of the author may not be used to endorse or promote products</i></td></tr>
<tr><th id="13">13</th><td><i> *    derived from this software without specific prior written permission</i></td></tr>
<tr><th id="14">14</th><td><i> *</i></td></tr>
<tr><th id="15">15</th><td><i> * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR</i></td></tr>
<tr><th id="16">16</th><td><i> * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES</i></td></tr>
<tr><th id="17">17</th><td><i> * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</i></td></tr>
<tr><th id="18">18</th><td><i> * IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,</i></td></tr>
<tr><th id="19">19</th><td><i> * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT</i></td></tr>
<tr><th id="20">20</th><td><i> * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</i></td></tr>
<tr><th id="21">21</th><td><i> * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</i></td></tr>
<tr><th id="22">22</th><td><i> * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</i></td></tr>
<tr><th id="23">23</th><td><i> * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF</i></td></tr>
<tr><th id="24">24</th><td><i> * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</i></td></tr>
<tr><th id="25">25</th><td><i> *</i></td></tr>
<tr><th id="26">26</th><td><i> * Id: pdq.c,v 1.32 1997/06/05 01:56:35 thomas Exp</i></td></tr>
<tr><th id="27">27</th><td><i> *</i></td></tr>
<tr><th id="28">28</th><td><i> */</i></td></tr>
<tr><th id="29">29</th><td></td></tr>
<tr><th id="30">30</th><td><i>/*</i></td></tr>
<tr><th id="31">31</th><td><i> * DEC PDQ FDDI Controller O/S independent code</i></td></tr>
<tr><th id="32">32</th><td><i> *</i></td></tr>
<tr><th id="33">33</th><td><i> * This module should work any on PDQ based board.  Note that changes for</i></td></tr>
<tr><th id="34">34</th><td><i> * MIPS and Alpha architectures (or any other architecture which requires</i></td></tr>
<tr><th id="35">35</th><td><i> * a flushing of memory or write buffers and/or has incoherent caches)</i></td></tr>
<tr><th id="36">36</th><td><i> * have yet to be made.</i></td></tr>
<tr><th id="37">37</th><td><i> *</i></td></tr>
<tr><th id="38">38</th><td><i> * However, it is expected that the PDQ_CSR_WRITE macro will cause a</i></td></tr>
<tr><th id="39">39</th><td><i> * flushing of the write buffers.</i></td></tr>
<tr><th id="40">40</th><td><i> */</i></td></tr>
<tr><th id="41">41</th><td></td></tr>
<tr><th id="42">42</th><td><u>#include <a href="../../sys/cdefs.h.html">&lt;sys/cdefs.h&gt;</a></u></td></tr>
<tr><th id="43">43</th><td><a class="macro" href="../../sys/cdefs_elf.h.html#156" title="__asm(&quot;.pushsection &quot; &quot;.ident&quot; &quot;\n&quot; &quot;.asciz \&quot;&quot; &quot;$NetBSD: pdq.c,v 1.40 2013/09/15 09:26:39 martin Exp $&quot; &quot;\&quot;\n&quot; &quot;.popsection&quot;)" data-ref="_M/__KERNEL_RCSID">__KERNEL_RCSID</a>(<var>0</var>, <q>"$NetBSD: pdq.c,v 1.40 2013/09/15 09:26:39 martin Exp $"</q>);</td></tr>
<tr><th id="44">44</th><td></td></tr>
<tr><th id="45">45</th><td><u>#define	<dfn class="macro" id="_M/PDQ_HWSUPPORT" data-ref="_M/PDQ_HWSUPPORT">PDQ_HWSUPPORT</dfn>	/* for pdq.h */</u></td></tr>
<tr><th id="46">46</th><td></td></tr>
<tr><th id="47">47</th><td><u>#<span data-ppcond="47">if</span> defined(<span class="macro" data-ref="_M/__FreeBSD__">__FreeBSD__</span>)</u></td></tr>
<tr><th id="48">48</th><td><i>/*</i></td></tr>
<tr><th id="49">49</th><td><i> * What a botch having to specific includes for FreeBSD!</i></td></tr>
<tr><th id="50">50</th><td><i> */</i></td></tr>
<tr><th id="51">51</th><td><u>#include &lt;dev/pdq/pdqvar.h&gt;</u></td></tr>
<tr><th id="52">52</th><td><u>#include &lt;dev/pdq/pdqreg.h&gt;</u></td></tr>
<tr><th id="53">53</th><td><u>#<span data-ppcond="47">else</span></u></td></tr>
<tr><th id="54">54</th><td><u>#include <a href="pdqvar.h.html">"pdqvar.h"</a></u></td></tr>
<tr><th id="55">55</th><td><u>#include <a href="pdqreg.h.html">"pdqreg.h"</a></u></td></tr>
<tr><th id="56">56</th><td><u>#<span data-ppcond="47">endif</span></u></td></tr>
<tr><th id="57">57</th><td></td></tr>
<tr><th id="58">58</th><td><u>#define	<dfn class="macro" id="_M/PDQ_ROUNDUP" data-ref="_M/PDQ_ROUNDUP">PDQ_ROUNDUP</dfn>(n, x)	(((n) + ((x) - 1)) &amp; ~((x) - 1))</u></td></tr>
<tr><th id="59">59</th><td><u>#define	<dfn class="macro" id="_M/PDQ_CMD_RX_ALIGNMENT" data-ref="_M/PDQ_CMD_RX_ALIGNMENT">PDQ_CMD_RX_ALIGNMENT</dfn>	16</u></td></tr>
<tr><th id="60">60</th><td></td></tr>
<tr><th id="61">61</th><td><u>#<span data-ppcond="61">if</span> (defined(<span class="macro" data-ref="_M/PDQTEST">PDQTEST</span>) &amp;&amp; !defined(<span class="macro" data-ref="_M/PDQ_NOPRINTF">PDQ_NOPRINTF</span>)) || defined(<span class="macro" data-ref="_M/PDQVERBOSE">PDQVERBOSE</span>)</u></td></tr>
<tr><th id="62">62</th><td><u>#define	PDQ_PRINTF(x)	printf x</u></td></tr>
<tr><th id="63">63</th><td><u>#<span data-ppcond="61">else</span></u></td></tr>
<tr><th id="64">64</th><td><u>#define	<dfn class="macro" id="_M/PDQ_PRINTF" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</dfn>(x)	do { } while (0)</u></td></tr>
<tr><th id="65">65</th><td><u>#<span data-ppcond="61">endif</span></u></td></tr>
<tr><th id="66">66</th><td></td></tr>
<tr><th id="67">67</th><td><em>static</em> <em>const</em> <em>char</em> * <em>const</em> <dfn class="tu decl def" id="pdq_halt_codes" title='pdq_halt_codes' data-type='const char *const [9]' data-ref="pdq_halt_codes" data-ref-filename="pdq_halt_codes">pdq_halt_codes</dfn>[] = {</td></tr>
<tr><th id="68">68</th><td>    <q>"Selftest Timeout"</q>, <q>"Host Bus Parity Error"</q>, <q>"Host Directed Fault"</q>,</td></tr>
<tr><th id="69">69</th><td>    <q>"Software Fault"</q>, <q>"Hardware Fault"</q>, <q>"PC Trace Path Test"</q>,</td></tr>
<tr><th id="70">70</th><td>    <q>"DMA Error"</q>, <q>"Image CRC Error"</q>, <q>"Adapter Processer Error"</q></td></tr>
<tr><th id="71">71</th><td>};</td></tr>
<tr><th id="72">72</th><td></td></tr>
<tr><th id="73">73</th><td><em>static</em> <em>const</em> <em>char</em> * <em>const</em> <dfn class="tu decl def" id="pdq_adapter_states" title='pdq_adapter_states' data-type='const char *const [8]' data-ref="pdq_adapter_states" data-ref-filename="pdq_adapter_states">pdq_adapter_states</dfn>[] = {</td></tr>
<tr><th id="74">74</th><td>    <q>"Reset"</q>, <q>"Upgrade"</q>, <q>"DMA Unavailable"</q>, <q>"DMA Available"</q>,</td></tr>
<tr><th id="75">75</th><td>    <q>"Link Available"</q>, <q>"Link Unavailable"</q>, <q>"Halted"</q>, <q>"Ring Member"</q></td></tr>
<tr><th id="76">76</th><td>};</td></tr>
<tr><th id="77">77</th><td></td></tr>
<tr><th id="78">78</th><td><i  data-doc="pdq_entities">/*</i></td></tr>
<tr><th id="79">79</th><td><i  data-doc="pdq_entities"> * The following are used in conjunction with</i></td></tr>
<tr><th id="80">80</th><td><i  data-doc="pdq_entities"> * unsolicited events</i></td></tr>
<tr><th id="81">81</th><td><i  data-doc="pdq_entities"> */</i></td></tr>
<tr><th id="82">82</th><td><em>static</em> <em>const</em> <em>char</em> * <em>const</em> <dfn class="tu decl def" id="pdq_entities" title='pdq_entities' data-type='const char *const [3]' data-ref="pdq_entities" data-ref-filename="pdq_entities">pdq_entities</dfn>[] = {</td></tr>
<tr><th id="83">83</th><td>    <q>"Station"</q>, <q>"Link"</q>, <q>"Phy Port"</q></td></tr>
<tr><th id="84">84</th><td>};</td></tr>
<tr><th id="85">85</th><td></td></tr>
<tr><th id="86">86</th><td><em>static</em> <em>const</em> <em>char</em> * <em>const</em> <dfn class="tu decl def" id="pdq_station_events" title='pdq_station_events' data-type='const char *const [2]' data-ref="pdq_station_events" data-ref-filename="pdq_station_events">pdq_station_events</dfn>[] = {</td></tr>
<tr><th id="87">87</th><td>    <q>"Unknown Event #0"</q>,</td></tr>
<tr><th id="88">88</th><td>    <q>"Trace Received"</q></td></tr>
<tr><th id="89">89</th><td>};</td></tr>
<tr><th id="90">90</th><td></td></tr>
<tr><th id="91">91</th><td><em>static</em> <em>const</em> <em>char</em> * <em>const</em> <dfn class="tu decl def" id="pdq_link_events" title='pdq_link_events' data-type='const char *const []' data-ref="pdq_link_events" data-ref-filename="pdq_link_events">pdq_link_events</dfn>[] = {</td></tr>
<tr><th id="92">92</th><td>    <q>"Transmit Underrun"</q>,</td></tr>
<tr><th id="93">93</th><td>    <q>"Transmit Failed"</q>,</td></tr>
<tr><th id="94">94</th><td>    <q>"Block Check Error (CRC)"</q>,</td></tr>
<tr><th id="95">95</th><td>    <q>"Frame Status Error"</q>,</td></tr>
<tr><th id="96">96</th><td>    <q>"PDU Length Error"</q>,</td></tr>
<tr><th id="97">97</th><td>    <span class='error' title="use of undeclared identifier &apos;NULL&apos;">NULL</span>,</td></tr>
<tr><th id="98">98</th><td>    <span class='error' title="use of undeclared identifier &apos;NULL&apos;">NULL</span>,</td></tr>
<tr><th id="99">99</th><td>    <q>"Receive Data Overrun"</q>,</td></tr>
<tr><th id="100">100</th><td>    <span class='error' title="use of undeclared identifier &apos;NULL&apos;">NULL</span>,</td></tr>
<tr><th id="101">101</th><td>    <q>"No User Buffer"</q>,</td></tr>
<tr><th id="102">102</th><td>    <q>"Ring Initialization Initiated"</q>,</td></tr>
<tr><th id="103">103</th><td>    <q>"Ring Initialization Received"</q>,</td></tr>
<tr><th id="104">104</th><td>    <q>"Ring Beacon Initiated"</q>,</td></tr>
<tr><th id="105">105</th><td>    <q>"Duplicate Address Failure"</q>,</td></tr>
<tr><th id="106">106</th><td>    <q>"Duplicate Token Detected"</q>,</td></tr>
<tr><th id="107">107</th><td>    <q>"Ring Purger Error"</q>,</td></tr>
<tr><th id="108">108</th><td>    <q>"FCI Strip Error"</q>,</td></tr>
<tr><th id="109">109</th><td>    <q>"Trace Initiated"</q>,</td></tr>
<tr><th id="110">110</th><td>    <q>"Directed Beacon Received"</q>,</td></tr>
<tr><th id="111">111</th><td>};</td></tr>
<tr><th id="112">112</th><td></td></tr>
<tr><th id="113">113</th><td><u>#<span data-ppcond="113">if</span> 0</u></td></tr>
<tr><th id="114">114</th><td><em>static</em> <em>const</em> <em>char</em> * <em>const</em> pdq_station_arguments[] = {</td></tr>
<tr><th id="115">115</th><td>    <q>"Reason"</q></td></tr>
<tr><th id="116">116</th><td>};</td></tr>
<tr><th id="117">117</th><td></td></tr>
<tr><th id="118">118</th><td><em>static</em> <em>const</em> <em>char</em> * <em>const</em> pdq_link_arguments[] = {</td></tr>
<tr><th id="119">119</th><td>    <q>"Reason"</q>,</td></tr>
<tr><th id="120">120</th><td>    <q>"Data Link Header"</q>,</td></tr>
<tr><th id="121">121</th><td>    <q>"Source"</q>,</td></tr>
<tr><th id="122">122</th><td>    <q>"Upstream Neighbor"</q></td></tr>
<tr><th id="123">123</th><td>};</td></tr>
<tr><th id="124">124</th><td></td></tr>
<tr><th id="125">125</th><td><em>static</em> <em>const</em> <em>char</em> * <em>const</em> pdq_phy_arguments[] = {</td></tr>
<tr><th id="126">126</th><td>    <q>"Direction"</q></td></tr>
<tr><th id="127">127</th><td>};</td></tr>
<tr><th id="128">128</th><td></td></tr>
<tr><th id="129">129</th><td><em>static</em> <em>const</em> <em>char</em> * <em>const</em> * <em>const</em> pdq_event_arguments[] = {</td></tr>
<tr><th id="130">130</th><td>    pdq_station_arguments,</td></tr>
<tr><th id="131">131</th><td>    pdq_link_arguments,</td></tr>
<tr><th id="132">132</th><td>    pdq_phy_arguments</td></tr>
<tr><th id="133">133</th><td>};</td></tr>
<tr><th id="134">134</th><td></td></tr>
<tr><th id="135">135</th><td><u>#<span data-ppcond="113">endif</span></u></td></tr>
<tr><th id="136">136</th><td></td></tr>
<tr><th id="137">137</th><td></td></tr>
<tr><th id="138">138</th><td><em>static</em> <em>const</em> <em>char</em> * <em>const</em> <dfn class="tu decl def" id="pdq_phy_events" title='pdq_phy_events' data-type='const char *const [3]' data-ref="pdq_phy_events" data-ref-filename="pdq_phy_events">pdq_phy_events</dfn>[] = {</td></tr>
<tr><th id="139">139</th><td>    <q>"LEM Error Monitor Reject"</q>,</td></tr>
<tr><th id="140">140</th><td>    <q>"Elasticy Buffer Error"</q>,</td></tr>
<tr><th id="141">141</th><td>    <q>"Link Confidence Test Reject"</q></td></tr>
<tr><th id="142">142</th><td>};</td></tr>
<tr><th id="143">143</th><td></td></tr>
<tr><th id="144">144</th><td><em>static</em> <em>const</em> <em>char</em> * <em>const</em> * <em>const</em> <dfn class="tu decl def" id="pdq_event_codes" title='pdq_event_codes' data-type='const char *const *const [3]' data-ref="pdq_event_codes" data-ref-filename="pdq_event_codes">pdq_event_codes</dfn>[] = {</td></tr>
<tr><th id="145">145</th><td>    <a class="tu ref" href="#pdq_station_events" title='pdq_station_events' data-ref="pdq_station_events" data-ref-filename="pdq_station_events">pdq_station_events</a>,</td></tr>
<tr><th id="146">146</th><td>    <a class="tu ref" href="#pdq_link_events" title='pdq_link_events' data-ref="pdq_link_events" data-ref-filename="pdq_link_events">pdq_link_events</a>,</td></tr>
<tr><th id="147">147</th><td>    <a class="tu ref" href="#pdq_phy_events" title='pdq_phy_events' data-ref="pdq_phy_events" data-ref-filename="pdq_phy_events">pdq_phy_events</a></td></tr>
<tr><th id="148">148</th><td>};</td></tr>
<tr><th id="149">149</th><td></td></tr>
<tr><th id="150">150</th><td><em>static</em> <em>const</em> <em>char</em> * <em>const</em> <dfn class="tu decl def" id="pdq_station_types" title='pdq_station_types' data-type='const char *const [5]' data-ref="pdq_station_types" data-ref-filename="pdq_station_types">pdq_station_types</dfn>[] = {</td></tr>
<tr><th id="151">151</th><td>    <q>"SAS"</q>, <q>"DAC"</q>, <q>"SAC"</q>, <q>"NAC"</q>, <q>"DAS"</q></td></tr>
<tr><th id="152">152</th><td>};</td></tr>
<tr><th id="153">153</th><td></td></tr>
<tr><th id="154">154</th><td><em>static</em> <em>const</em> <em>char</em> * <em>const</em> <dfn class="tu decl def" id="pdq_smt_versions" title='pdq_smt_versions' data-type='const char *const [4]' data-ref="pdq_smt_versions" data-ref-filename="pdq_smt_versions">pdq_smt_versions</dfn>[] = { <q>""</q>, <q>"V6.2"</q>, <q>"V7.2"</q>, <q>"V7.3"</q> };</td></tr>
<tr><th id="155">155</th><td></td></tr>
<tr><th id="156">156</th><td><em>static</em> <em>const</em> <em>char</em> <dfn class="tu decl def" id="pdq_phy_types" title='pdq_phy_types' data-type='const char [5]' data-ref="pdq_phy_types" data-ref-filename="pdq_phy_types">pdq_phy_types</dfn>[] = <q>"ABSM"</q>;</td></tr>
<tr><th id="157">157</th><td></td></tr>
<tr><th id="158">158</th><td><em>static</em> <em>const</em> <em>char</em> * <em>const</em> <dfn class="tu decl def" id="pdq_pmd_types0" title='pdq_pmd_types0' data-type='const char *const [4]' data-ref="pdq_pmd_types0" data-ref-filename="pdq_pmd_types0">pdq_pmd_types0</dfn>[] = {</td></tr>
<tr><th id="159">159</th><td>    <q>"ANSI Multi-Mode"</q>, <q>"ANSI Single-Mode Type 1"</q>, <q>"ANSI Single-Mode Type 2"</q>,</td></tr>
<tr><th id="160">160</th><td>    <q>"ANSI Sonet"</q></td></tr>
<tr><th id="161">161</th><td>};</td></tr>
<tr><th id="162">162</th><td></td></tr>
<tr><th id="163">163</th><td><em>static</em> <em>const</em> <em>char</em> * <em>const</em> <dfn class="tu decl def" id="pdq_pmd_types100" title='pdq_pmd_types100' data-type='const char *const [4]' data-ref="pdq_pmd_types100" data-ref-filename="pdq_pmd_types100">pdq_pmd_types100</dfn>[] = {</td></tr>
<tr><th id="164">164</th><td>    <q>"Low Power"</q>, <q>"Thin Wire"</q>, <q>"Shielded Twisted Pair"</q>,</td></tr>
<tr><th id="165">165</th><td>    <q>"Unshielded Twisted Pair"</q></td></tr>
<tr><th id="166">166</th><td>};</td></tr>
<tr><th id="167">167</th><td></td></tr>
<tr><th id="168">168</th><td><em>static</em> <em>const</em> <em>char</em> * <em>const</em> * <em>const</em> <dfn class="tu decl def" id="pdq_pmd_types" title='pdq_pmd_types' data-type='const char *const *const [2]' data-ref="pdq_pmd_types" data-ref-filename="pdq_pmd_types">pdq_pmd_types</dfn>[] = {</td></tr>
<tr><th id="169">169</th><td>    <a class="tu ref" href="#pdq_pmd_types0" title='pdq_pmd_types0' data-ref="pdq_pmd_types0" data-ref-filename="pdq_pmd_types0">pdq_pmd_types0</a>, <a class="tu ref" href="#pdq_pmd_types100" title='pdq_pmd_types100' data-ref="pdq_pmd_types100" data-ref-filename="pdq_pmd_types100">pdq_pmd_types100</a></td></tr>
<tr><th id="170">170</th><td>};</td></tr>
<tr><th id="171">171</th><td></td></tr>
<tr><th id="172">172</th><td><em>static</em> <em>const</em> <em>char</em> * <em>const</em> <dfn class="tu decl def" id="pdq_descriptions" title='pdq_descriptions' data-type='const char *const [5]' data-ref="pdq_descriptions" data-ref-filename="pdq_descriptions">pdq_descriptions</dfn>[] = {</td></tr>
<tr><th id="173">173</th><td>    <q>"DEFPA PCI"</q>,</td></tr>
<tr><th id="174">174</th><td>    <q>"DEFEA EISA"</q>,</td></tr>
<tr><th id="175">175</th><td>    <q>"DEFTA TC"</q>,</td></tr>
<tr><th id="176">176</th><td>    <q>"DEFAA Futurebus"</q>,</td></tr>
<tr><th id="177">177</th><td>    <q>"DEFQA Q-bus"</q>,</td></tr>
<tr><th id="178">178</th><td>};</td></tr>
<tr><th id="179">179</th><td></td></tr>
<tr><th id="180">180</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="181">181</th><td><dfn class="tu decl def fn" id="pdq_print_fddi_chars" title='pdq_print_fddi_chars' data-type='void pdq_print_fddi_chars(pdq_t * pdq, const pdq_response_status_chars_get_t * rsp)' data-ref="pdq_print_fddi_chars" data-ref-filename="pdq_print_fddi_chars">pdq_print_fddi_chars</dfn>(</td></tr>
<tr><th id="182">182</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_t" title='pdq_t' data-type='struct _pdq_t' data-ref="pdq_t" data-ref-filename="pdq_t">pdq_t</a> *<dfn class="local col3 decl" id="3pdq" title='pdq' data-type='pdq_t *' data-ref="3pdq" data-ref-filename="3pdq">pdq</dfn>,</td></tr>
<tr><th id="183">183</th><td>    <em>const</em> <a class="typedef" href="pdqreg.h.html#pdq_response_status_chars_get_t" title='pdq_response_status_chars_get_t' data-type='struct pdq_response_status_chars_get_t' data-ref="pdq_response_status_chars_get_t" data-ref-filename="pdq_response_status_chars_get_t">pdq_response_status_chars_get_t</a> *<dfn class="local col4 decl" id="4rsp" title='rsp' data-type='const pdq_response_status_chars_get_t *' data-ref="4rsp" data-ref-filename="4rsp">rsp</dfn>)</td></tr>
<tr><th id="184">184</th><td>{</td></tr>
<tr><th id="185">185</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_uint32_t" title='pdq_uint32_t' data-type='unsigned int' data-ref="pdq_uint32_t" data-ref-filename="pdq_uint32_t">pdq_uint32_t</a> <dfn class="local col5 decl" id="5phy_type" title='phy_type' data-type='pdq_uint32_t' data-ref="5phy_type" data-ref-filename="5phy_type">phy_type</dfn>;</td></tr>
<tr><th id="186">186</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_uint32_t" title='pdq_uint32_t' data-type='unsigned int' data-ref="pdq_uint32_t" data-ref-filename="pdq_uint32_t">pdq_uint32_t</a> <dfn class="local col6 decl" id="6pmd_type" title='pmd_type' data-type='pdq_uint32_t' data-ref="6pmd_type" data-ref-filename="6pmd_type">pmd_type</dfn>;</td></tr>
<tr><th id="187">187</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_uint32_t" title='pdq_uint32_t' data-type='unsigned int' data-ref="pdq_uint32_t" data-ref-filename="pdq_uint32_t">pdq_uint32_t</a> <dfn class="local col7 decl" id="7smt_version_id" title='smt_version_id' data-type='pdq_uint32_t' data-ref="7smt_version_id" data-ref-filename="7smt_version_id">smt_version_id</dfn>;</td></tr>
<tr><th id="188">188</th><td>    <a class="typedef" href="pdqreg.h.html#pdq_station_type_t" title='pdq_station_type_t' data-type='enum pdq_station_type_t' data-ref="pdq_station_type_t" data-ref-filename="pdq_station_type_t">pdq_station_type_t</a> <dfn class="local col8 decl" id="8station_type" title='station_type' data-type='pdq_station_type_t' data-ref="8station_type" data-ref-filename="8station_type">station_type</dfn>;</td></tr>
<tr><th id="189">189</th><td></td></tr>
<tr><th id="190">190</th><td>    <span class='error' title="implicit declaration of function &apos;printf&apos; is invalid in C99"><span class='error' title="this function declaration is not a prototype">printf</span></span>(</td></tr>
<tr><th id="191">191</th><td><u>#<span data-ppcond="191">if</span> !defined(<span class="macro" data-ref="_M/__bsdi__">__bsdi__</span>) &amp;&amp; !defined(<span class="macro" data-ref="_M/__NetBSD__">__NetBSD__</span>)</u></td></tr>
<tr><th id="192">192</th><td>	   <span class='error' title="use of undeclared identifier &apos;PDQ_OS_PREFIX&apos;">PDQ_OS_PREFIX</span></td></tr>
<tr><th id="193">193</th><td><u>#<span data-ppcond="191">else</span></u></td></tr>
<tr><th id="194">194</th><td>	   <q>": "</q></td></tr>
<tr><th id="195">195</th><td><u>#<span data-ppcond="191">endif</span></u></td></tr>
<tr><th id="196">196</th><td>	   <q>"DEC %s FDDI %s Controller\n"</q>,</td></tr>
<tr><th id="197">197</th><td><u>#<span data-ppcond="197">if</span> !defined(<span class="macro" data-ref="_M/__bsdi__">__bsdi__</span>) &amp;&amp; !defined(<span class="macro" data-ref="_M/__NetBSD__">__NetBSD__</span>)</u></td></tr>
<tr><th id="198">198</th><td>	   PDQ_OS_PREFIX_ARGS,</td></tr>
<tr><th id="199">199</th><td><u>#<span data-ppcond="197">endif</span></u></td></tr>
<tr><th id="200">200</th><td>	   pdq_descriptions[pdq-&gt;pdq_type],</td></tr>
<tr><th id="201">201</th><td>	   pdq_station_types[le32toh(rsp-&gt;status_chars_get.station_type)]);</td></tr>
<tr><th id="202">202</th><td></td></tr>
<tr><th id="203">203</th><td>    printf(<span class='error' title="use of undeclared identifier &apos;PDQ_OS_PREFIX&apos;">PDQ_OS_PREFIX</span> <q>"FDDI address %c%c:%c%c:%c%c:%c%c:%c%c:%c%c, FW=%c%c%c%c, HW=%c"</q>,</td></tr>
<tr><th id="204">204</th><td>	   PDQ_OS_PREFIX_ARGS,</td></tr>
<tr><th id="205">205</th><td>	   hexdigits[pdq-&gt;pdq_hwaddr.lanaddr_bytes[<var>0</var>] &gt;&gt; <var>4</var>],</td></tr>
<tr><th id="206">206</th><td>	   hexdigits[pdq-&gt;pdq_hwaddr.lanaddr_bytes[<var>0</var>] &amp; <var>0x0F</var>],</td></tr>
<tr><th id="207">207</th><td>	   hexdigits[pdq-&gt;pdq_hwaddr.lanaddr_bytes[<var>1</var>] &gt;&gt; <var>4</var>],</td></tr>
<tr><th id="208">208</th><td>	   hexdigits[pdq-&gt;pdq_hwaddr.lanaddr_bytes[<var>1</var>] &amp; <var>0x0F</var>],</td></tr>
<tr><th id="209">209</th><td>	   hexdigits[pdq-&gt;pdq_hwaddr.lanaddr_bytes[<var>2</var>] &gt;&gt; <var>4</var>],</td></tr>
<tr><th id="210">210</th><td>	   hexdigits[pdq-&gt;pdq_hwaddr.lanaddr_bytes[<var>2</var>] &amp; <var>0x0F</var>],</td></tr>
<tr><th id="211">211</th><td>	   hexdigits[pdq-&gt;pdq_hwaddr.lanaddr_bytes[<var>3</var>] &gt;&gt; <var>4</var>],</td></tr>
<tr><th id="212">212</th><td>	   hexdigits[pdq-&gt;pdq_hwaddr.lanaddr_bytes[<var>3</var>] &amp; <var>0x0F</var>],</td></tr>
<tr><th id="213">213</th><td>	   hexdigits[pdq-&gt;pdq_hwaddr.lanaddr_bytes[<var>4</var>] &gt;&gt; <var>4</var>],</td></tr>
<tr><th id="214">214</th><td>	   hexdigits[pdq-&gt;pdq_hwaddr.lanaddr_bytes[<var>4</var>] &amp; <var>0x0F</var>],</td></tr>
<tr><th id="215">215</th><td>	   hexdigits[pdq-&gt;pdq_hwaddr.lanaddr_bytes[<var>5</var>] &gt;&gt; <var>4</var>],</td></tr>
<tr><th id="216">216</th><td>	   hexdigits[pdq-&gt;pdq_hwaddr.lanaddr_bytes[<var>5</var>] &amp; <var>0x0F</var>],</td></tr>
<tr><th id="217">217</th><td>	   pdq-&gt;pdq_fwrev.fwrev_bytes[<var>0</var>], pdq-&gt;pdq_fwrev.fwrev_bytes[<var>1</var>],</td></tr>
<tr><th id="218">218</th><td>	   pdq-&gt;pdq_fwrev.fwrev_bytes[<var>2</var>], pdq-&gt;pdq_fwrev.fwrev_bytes[<var>3</var>],</td></tr>
<tr><th id="219">219</th><td>	   rsp-&gt;status_chars_get.module_rev.fwrev_bytes[<var>0</var>]);</td></tr>
<tr><th id="220">220</th><td></td></tr>
<tr><th id="221">221</th><td>    <a class="local col5 ref" href="#5phy_type" title='phy_type' data-ref="5phy_type" data-ref-filename="5phy_type">phy_type</a> = <span class='error' title="implicit declaration of function &apos;le32toh&apos; is invalid in C99"><span class='error' title="this function declaration is not a prototype"><a class="ref fn" href="#221" title='le32toh' data-ref="le32toh" data-ref-filename="le32toh">le32toh</a></span></span>(<a class="local col4 ref" href="#4rsp" title='rsp' data-ref="4rsp" data-ref-filename="4rsp">rsp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::status_chars_get" title='(anonymous struct)::status_chars_get' data-ref="(anonymous)::status_chars_get" data-ref-filename="(anonymous)..status_chars_get">status_chars_get</a>.<a class="ref field" href="pdqreg.h.html#(anonymousstruct)::(anonymous)::phy_type" title='(anonymous struct)::(anonymous struct)::phy_type' data-ref="(anonymousstruct)::(anonymous)::phy_type" data-ref-filename="(anonymousstruct)..(anonymous)..phy_type">phy_type</a>[<var>0</var>]);</td></tr>
<tr><th id="222">222</th><td>    <a class="local col6 ref" href="#6pmd_type" title='pmd_type' data-ref="6pmd_type" data-ref-filename="6pmd_type">pmd_type</a> = <a class="ref fn" href="#221" title='le32toh' data-ref="le32toh" data-ref-filename="le32toh">le32toh</a>(<a class="local col4 ref" href="#4rsp" title='rsp' data-ref="4rsp" data-ref-filename="4rsp">rsp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::status_chars_get" title='(anonymous struct)::status_chars_get' data-ref="(anonymous)::status_chars_get" data-ref-filename="(anonymous)..status_chars_get">status_chars_get</a>.<a class="ref field" href="pdqreg.h.html#(anonymousstruct)::(anonymous)::pmd_type" title='(anonymous struct)::(anonymous struct)::pmd_type' data-ref="(anonymousstruct)::(anonymous)::pmd_type" data-ref-filename="(anonymousstruct)..(anonymous)..pmd_type">pmd_type</a>[<var>0</var>]);</td></tr>
<tr><th id="223">223</th><td>    <a class="local col8 ref" href="#8station_type" title='station_type' data-ref="8station_type" data-ref-filename="8station_type">station_type</a> = <a class="ref fn" href="#221" title='le32toh' data-ref="le32toh" data-ref-filename="le32toh">le32toh</a>(<a class="local col4 ref" href="#4rsp" title='rsp' data-ref="4rsp" data-ref-filename="4rsp">rsp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::status_chars_get" title='(anonymous struct)::status_chars_get' data-ref="(anonymous)::status_chars_get" data-ref-filename="(anonymous)..status_chars_get">status_chars_get</a>.<a class="ref field" href="pdqreg.h.html#(anonymousstruct)::(anonymous)::station_type" title='(anonymous struct)::(anonymous struct)::station_type' data-ref="(anonymousstruct)::(anonymous)::station_type" data-ref-filename="(anonymousstruct)..(anonymous)..station_type">station_type</a>);</td></tr>
<tr><th id="224">224</th><td>    <a class="local col7 ref" href="#7smt_version_id" title='smt_version_id' data-ref="7smt_version_id" data-ref-filename="7smt_version_id">smt_version_id</a> = <a class="ref fn" href="#221" title='le32toh' data-ref="le32toh" data-ref-filename="le32toh">le32toh</a>(<a class="local col4 ref" href="#4rsp" title='rsp' data-ref="4rsp" data-ref-filename="4rsp">rsp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::status_chars_get" title='(anonymous struct)::status_chars_get' data-ref="(anonymous)::status_chars_get" data-ref-filename="(anonymous)..status_chars_get">status_chars_get</a>.<a class="ref field" href="pdqreg.h.html#(anonymousstruct)::(anonymous)::smt_version_id" title='(anonymous struct)::(anonymous struct)::smt_version_id' data-ref="(anonymousstruct)::(anonymous)::smt_version_id" data-ref-filename="(anonymousstruct)..(anonymous)..smt_version_id">smt_version_id</a>);</td></tr>
<tr><th id="225">225</th><td></td></tr>
<tr><th id="226">226</th><td>    <b>if</b> (<a class="local col7 ref" href="#7smt_version_id" title='smt_version_id' data-ref="7smt_version_id" data-ref-filename="7smt_version_id">smt_version_id</a> &lt; <a class="macro" href="pdqreg.h.html#51" title="((sizeof(pdq_smt_versions) / sizeof(pdq_smt_versions[0])))" data-ref="_M/PDQ_ARRAY_SIZE">PDQ_ARRAY_SIZE</a>(<a class="tu ref" href="#pdq_smt_versions" title='pdq_smt_versions' data-use='r' data-ref="pdq_smt_versions" data-ref-filename="pdq_smt_versions">pdq_smt_versions</a>))</td></tr>
<tr><th id="227">227</th><td>	<a class="ref fn" href="#190" title='printf' data-ref="printf" data-ref-filename="printf">printf</a>(<q>", SMT %s\n"</q>, <a class="tu ref" href="#pdq_smt_versions" title='pdq_smt_versions' data-use='r' data-ref="pdq_smt_versions" data-ref-filename="pdq_smt_versions">pdq_smt_versions</a>[<a class="local col7 ref" href="#7smt_version_id" title='smt_version_id' data-ref="7smt_version_id" data-ref-filename="7smt_version_id">smt_version_id</a>]);</td></tr>
<tr><th id="228">228</th><td></td></tr>
<tr><th id="229">229</th><td>    printf(<span class='error' title="use of undeclared identifier &apos;PDQ_OS_PREFIX&apos;">PDQ_OS_PREFIX</span> <q>"FDDI Port%s = %c (PMD = %s)"</q>,</td></tr>
<tr><th id="230">230</th><td>	   PDQ_OS_PREFIX_ARGS,</td></tr>
<tr><th id="231">231</th><td>	   le32toh(station_type) == PDQ_STATION_TYPE_DAS ? <q>"[A]"</q> : <q>""</q>,</td></tr>
<tr><th id="232">232</th><td>	   pdq_phy_types[phy_type],</td></tr>
<tr><th id="233">233</th><td>	   pdq_pmd_types[pmd_type / <var>100</var>][pmd_type % <var>100</var>]);</td></tr>
<tr><th id="234">234</th><td></td></tr>
<tr><th id="235">235</th><td>    <b>if</b> (<a class="local col8 ref" href="#8station_type" title='station_type' data-ref="8station_type" data-ref-filename="8station_type">station_type</a> == <a class="enum" href="pdqreg.h.html#PDQ_STATION_TYPE_DAS" title='PDQ_STATION_TYPE_DAS' data-ref="PDQ_STATION_TYPE_DAS" data-ref-filename="PDQ_STATION_TYPE_DAS">PDQ_STATION_TYPE_DAS</a>) {</td></tr>
<tr><th id="236">236</th><td>	<a class="local col5 ref" href="#5phy_type" title='phy_type' data-ref="5phy_type" data-ref-filename="5phy_type">phy_type</a> = <a class="ref fn" href="#221" title='le32toh' data-ref="le32toh" data-ref-filename="le32toh">le32toh</a>(<a class="local col4 ref" href="#4rsp" title='rsp' data-ref="4rsp" data-ref-filename="4rsp">rsp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::status_chars_get" title='(anonymous struct)::status_chars_get' data-ref="(anonymous)::status_chars_get" data-ref-filename="(anonymous)..status_chars_get">status_chars_get</a>.<a class="ref field" href="pdqreg.h.html#(anonymousstruct)::(anonymous)::phy_type" title='(anonymous struct)::(anonymous struct)::phy_type' data-ref="(anonymousstruct)::(anonymous)::phy_type" data-ref-filename="(anonymousstruct)..(anonymous)..phy_type">phy_type</a>[<var>1</var>]);</td></tr>
<tr><th id="237">237</th><td>	<a class="local col6 ref" href="#6pmd_type" title='pmd_type' data-ref="6pmd_type" data-ref-filename="6pmd_type">pmd_type</a> = <a class="ref fn" href="#221" title='le32toh' data-ref="le32toh" data-ref-filename="le32toh">le32toh</a>(<a class="local col4 ref" href="#4rsp" title='rsp' data-ref="4rsp" data-ref-filename="4rsp">rsp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::status_chars_get" title='(anonymous struct)::status_chars_get' data-ref="(anonymous)::status_chars_get" data-ref-filename="(anonymous)..status_chars_get">status_chars_get</a>.<a class="ref field" href="pdqreg.h.html#(anonymousstruct)::(anonymous)::pmd_type" title='(anonymous struct)::(anonymous struct)::pmd_type' data-ref="(anonymousstruct)::(anonymous)::pmd_type" data-ref-filename="(anonymousstruct)..(anonymous)..pmd_type">pmd_type</a>[<var>1</var>]);</td></tr>
<tr><th id="238">238</th><td>	<a class="ref fn" href="#190" title='printf' data-ref="printf" data-ref-filename="printf">printf</a>(<q>", FDDI Port[B] = %c (PMD = %s)"</q>,</td></tr>
<tr><th id="239">239</th><td>	       <a class="tu ref" href="#pdq_phy_types" title='pdq_phy_types' data-use='r' data-ref="pdq_phy_types" data-ref-filename="pdq_phy_types">pdq_phy_types</a>[<a class="local col5 ref" href="#5phy_type" title='phy_type' data-ref="5phy_type" data-ref-filename="5phy_type">phy_type</a>],</td></tr>
<tr><th id="240">240</th><td>	       <a class="tu ref" href="#pdq_pmd_types" title='pdq_pmd_types' data-use='r' data-ref="pdq_pmd_types" data-ref-filename="pdq_pmd_types">pdq_pmd_types</a>[<a class="local col6 ref" href="#6pmd_type" title='pmd_type' data-ref="6pmd_type" data-ref-filename="6pmd_type">pmd_type</a> / <var>100</var>][<a class="local col6 ref" href="#6pmd_type" title='pmd_type' data-ref="6pmd_type" data-ref-filename="6pmd_type">pmd_type</a> % <var>100</var>]);</td></tr>
<tr><th id="241">241</th><td>    }</td></tr>
<tr><th id="242">242</th><td></td></tr>
<tr><th id="243">243</th><td>    <a class="ref fn" href="#190" title='printf' data-ref="printf" data-ref-filename="printf">printf</a>(<q>"\n"</q>);</td></tr>
<tr><th id="244">244</th><td></td></tr>
<tr><th id="245">245</th><td>    <a class="ref fn" href="pdqvar.h.html#pdq_os_update_status" title='pdq_os_update_status' data-ref="pdq_os_update_status" data-ref-filename="pdq_os_update_status">pdq_os_update_status</a>(<a class="local col3 ref" href="#3pdq" title='pdq' data-ref="3pdq" data-ref-filename="3pdq">pdq</a>, <a class="local col4 ref" href="#4rsp" title='rsp' data-ref="4rsp" data-ref-filename="4rsp">rsp</a>);</td></tr>
<tr><th id="246">246</th><td>}</td></tr>
<tr><th id="247">247</th><td></td></tr>
<tr><th id="248">248</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="249">249</th><td><dfn class="tu decl def fn" id="pdq_init_csrs" title='pdq_init_csrs' data-type='void pdq_init_csrs(pdq_csrs_t * csrs, pdq_csrs_t bus, int csr_base, int csrsize)' data-ref="pdq_init_csrs" data-ref-filename="pdq_init_csrs">pdq_init_csrs</dfn>(</td></tr>
<tr><th id="250">250</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_csrs_t" title='pdq_csrs_t' data-type='struct _pdq_csrs_t' data-ref="pdq_csrs_t" data-ref-filename="pdq_csrs_t">pdq_csrs_t</a> *<dfn class="local col9 decl" id="9csrs" title='csrs' data-type='pdq_csrs_t *' data-ref="9csrs" data-ref-filename="9csrs">csrs</dfn>,</td></tr>
<tr><th id="251">251</th><td>    <span class='error' title="unknown type name &apos;pdq_bus_t&apos;; did you mean &apos;pdq_csrs_t&apos;?"><a class="typedef" href="pdqvar.h.html#pdq_csrs_t" title='pdq_csrs_t' data-type='struct _pdq_csrs_t' data-ref="pdq_csrs_t" data-ref-filename="pdq_csrs_t">pdq_bus_t</a></span> <dfn class="local col0 decl" id="10bus" title='bus' data-type='pdq_csrs_t' data-ref="10bus" data-ref-filename="10bus">bus</dfn>,</td></tr>
<tr><th id="252">252</th><td>    <span class='error' title="unknown type name &apos;pdq_bus_memaddr_t&apos;">pdq_bus_memaddr_t</span> <dfn class="local col1 decl" id="11csr_base" title='csr_base' data-type='int' data-ref="11csr_base" data-ref-filename="11csr_base">csr_base</dfn>,</td></tr>
<tr><th id="253">253</th><td>    <span class='error' title="unknown type name &apos;size_t&apos;">size_t</span> <dfn class="local col2 decl" id="12csrsize" title='csrsize' data-type='int' data-ref="12csrsize" data-ref-filename="12csrsize">csrsize</dfn>)</td></tr>
<tr><th id="254">254</th><td>{</td></tr>
<tr><th id="255">255</th><td>    csrs-&gt;csr_bus = bus;</td></tr>
<tr><th id="256">256</th><td>    csrs-&gt;csr_base = csr_base;</td></tr>
<tr><th id="257">257</th><td>    csrs-&gt;csr_port_reset		= <span class='error' title="implicit declaration of function &apos;PDQ_CSR_OFFSET&apos; is invalid in C99"><span class='error' title="this function declaration is not a prototype">PDQ_CSR_OFFSET</span></span>(csr_base,  <var>0</var> * csrsize);</td></tr>
<tr><th id="258">258</th><td>    csrs-&gt;csr_host_data			= PDQ_CSR_OFFSET(csr_base,  <var>1</var> * csrsize);</td></tr>
<tr><th id="259">259</th><td>    csrs-&gt;csr_port_control		= PDQ_CSR_OFFSET(csr_base,  <var>2</var> * csrsize);</td></tr>
<tr><th id="260">260</th><td>    csrs-&gt;csr_port_data_a		= PDQ_CSR_OFFSET(csr_base,  <var>3</var> * csrsize);</td></tr>
<tr><th id="261">261</th><td>    csrs-&gt;csr_port_data_b		= PDQ_CSR_OFFSET(csr_base,  <var>4</var> * csrsize);</td></tr>
<tr><th id="262">262</th><td>    csrs-&gt;csr_port_status		= PDQ_CSR_OFFSET(csr_base,  <var>5</var> * csrsize);</td></tr>
<tr><th id="263">263</th><td>    csrs-&gt;csr_host_int_type_0		= PDQ_CSR_OFFSET(csr_base,  <var>6</var> * csrsize);</td></tr>
<tr><th id="264">264</th><td>    csrs-&gt;csr_host_int_enable		= PDQ_CSR_OFFSET(csr_base,  <var>7</var> * csrsize);</td></tr>
<tr><th id="265">265</th><td>    csrs-&gt;csr_type_2_producer		= PDQ_CSR_OFFSET(csr_base,  <var>8</var> * csrsize);</td></tr>
<tr><th id="266">266</th><td>    csrs-&gt;csr_cmd_response_producer	= PDQ_CSR_OFFSET(csr_base, <var>10</var> * csrsize);</td></tr>
<tr><th id="267">267</th><td>    csrs-&gt;csr_cmd_request_producer	= PDQ_CSR_OFFSET(csr_base, <var>11</var> * csrsize);</td></tr>
<tr><th id="268">268</th><td>    csrs-&gt;csr_host_smt_producer		= PDQ_CSR_OFFSET(csr_base, <var>12</var> * csrsize);</td></tr>
<tr><th id="269">269</th><td>    csrs-&gt;csr_unsolicited_producer	= PDQ_CSR_OFFSET(csr_base, <var>13</var> * csrsize);</td></tr>
<tr><th id="270">270</th><td>}</td></tr>
<tr><th id="271">271</th><td></td></tr>
<tr><th id="272">272</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="273">273</th><td><dfn class="tu decl def fn" id="pdq_init_pci_csrs" title='pdq_init_pci_csrs' data-type='void pdq_init_pci_csrs(pdq_pci_csrs_t * csrs, pdq_csrs_t bus, int csr_base, int csrsize)' data-ref="pdq_init_pci_csrs" data-ref-filename="pdq_init_pci_csrs">pdq_init_pci_csrs</dfn>(</td></tr>
<tr><th id="274">274</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_pci_csrs_t" title='pdq_pci_csrs_t' data-type='struct _pdq_pci_csrs_t' data-ref="pdq_pci_csrs_t" data-ref-filename="pdq_pci_csrs_t">pdq_pci_csrs_t</a> *<dfn class="local col3 decl" id="13csrs" title='csrs' data-type='pdq_pci_csrs_t *' data-ref="13csrs" data-ref-filename="13csrs">csrs</dfn>,</td></tr>
<tr><th id="275">275</th><td>    <span class='error' title="unknown type name &apos;pdq_bus_t&apos;; did you mean &apos;pdq_csrs_t&apos;?"><a class="typedef" href="pdqvar.h.html#pdq_csrs_t" title='pdq_csrs_t' data-type='struct _pdq_csrs_t' data-ref="pdq_csrs_t" data-ref-filename="pdq_csrs_t">pdq_bus_t</a></span> <dfn class="local col4 decl" id="14bus" title='bus' data-type='pdq_csrs_t' data-ref="14bus" data-ref-filename="14bus">bus</dfn>,</td></tr>
<tr><th id="276">276</th><td>    <span class='error' title="unknown type name &apos;pdq_bus_memaddr_t&apos;">pdq_bus_memaddr_t</span> <dfn class="local col5 decl" id="15csr_base" title='csr_base' data-type='int' data-ref="15csr_base" data-ref-filename="15csr_base">csr_base</dfn>,</td></tr>
<tr><th id="277">277</th><td>    <span class='error' title="unknown type name &apos;size_t&apos;">size_t</span> <dfn class="local col6 decl" id="16csrsize" title='csrsize' data-type='int' data-ref="16csrsize" data-ref-filename="16csrsize">csrsize</dfn>)</td></tr>
<tr><th id="278">278</th><td>{</td></tr>
<tr><th id="279">279</th><td>    csrs-&gt;csr_bus = bus;</td></tr>
<tr><th id="280">280</th><td>    csrs-&gt;csr_base = csr_base;</td></tr>
<tr><th id="281">281</th><td>    csrs-&gt;csr_pfi_mode_control	= <span class='error' title="implicit declaration of function &apos;PDQ_CSR_OFFSET&apos; is invalid in C99">PDQ_CSR_OFFSET</span>(csr_base, <var>16</var> * csrsize);</td></tr>
<tr><th id="282">282</th><td>    csrs-&gt;csr_pfi_status	= PDQ_CSR_OFFSET(csr_base, <var>17</var> * csrsize);</td></tr>
<tr><th id="283">283</th><td>    csrs-&gt;csr_fifo_write	= PDQ_CSR_OFFSET(csr_base, <var>18</var> * csrsize);</td></tr>
<tr><th id="284">284</th><td>    csrs-&gt;csr_fifo_read		= PDQ_CSR_OFFSET(csr_base, <var>19</var> * csrsize);</td></tr>
<tr><th id="285">285</th><td>}</td></tr>
<tr><th id="286">286</th><td></td></tr>
<tr><th id="287">287</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="288">288</th><td><dfn class="tu decl def fn" id="pdq_flush_databuf_queue" title='pdq_flush_databuf_queue' data-type='void pdq_flush_databuf_queue(pdq_t * pdq, pdq_databuf_queue_t * q)' data-ref="pdq_flush_databuf_queue" data-ref-filename="pdq_flush_databuf_queue">pdq_flush_databuf_queue</dfn>(</td></tr>
<tr><th id="289">289</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_t" title='pdq_t' data-type='struct _pdq_t' data-ref="pdq_t" data-ref-filename="pdq_t">pdq_t</a> *<dfn class="local col7 decl" id="17pdq" title='pdq' data-type='pdq_t *' data-ref="17pdq" data-ref-filename="17pdq">pdq</dfn>,</td></tr>
<tr><th id="290">290</th><td>    <a class="typedef" href="pdqreg.h.html#pdq_databuf_queue_t" title='pdq_databuf_queue_t' data-type='struct pdq_databuf_queue_t' data-ref="pdq_databuf_queue_t" data-ref-filename="pdq_databuf_queue_t">pdq_databuf_queue_t</a> *<dfn class="local col8 decl" id="18q" title='q' data-type='pdq_databuf_queue_t *' data-ref="18q" data-ref-filename="18q">q</dfn>)</td></tr>
<tr><th id="291">291</th><td>{</td></tr>
<tr><th id="292">292</th><td>    <span class='error' title="use of undeclared identifier &apos;PDQ_OS_DATABUF_T&apos;">PDQ_OS_DATABUF_T</span> *<span class='error' title="use of undeclared identifier &apos;pdu&apos;; did you mean &apos;pdq&apos;?">pdu</span>;</td></tr>
<tr><th id="293">293</th><td>    <b>for</b> (;;) {</td></tr>
<tr><th id="294">294</th><td>	<a class="macro" href="pdqvar.h.html#468" title="do { if (((pdu) = (PDQ_OS_DATABUF_T *) (q)-&gt;q_head) != NULL) { if (((q)-&gt;q_head = PDQ_OS_DATABUF_NEXTPKT(pdu)) == NULL) (q)-&gt;q_tail = NULL; PDQ_OS_DATABUF_NEXTPKT_SET(pdu, NULL); } } while (0)" data-ref="_M/PDQ_OS_DATABUF_DEQUEUE">PDQ_OS_DATABUF_DEQUEUE</a>(q, <span class='error' title="use of undeclared identifier &apos;pdu&apos;; did you mean &apos;pdq&apos;?">pdu</span>);</td></tr>
<tr><th id="295">295</th><td>	<b>if</b> (<span class='error' title="use of undeclared identifier &apos;pdu&apos;">pdu</span> == <span class='error' title="use of undeclared identifier &apos;NULL&apos;">NULL</span>)</td></tr>
<tr><th id="296">296</th><td>	    <b>return</b>;</td></tr>
<tr><th id="297">297</th><td>	<span class='error' title="implicit declaration of function &apos;PDQ_OS_DATABUF_FREE&apos; is invalid in C99"><span class='error' title="this function declaration is not a prototype">PDQ_OS_DATABUF_FREE</span></span>(pdq, <span class='error' title="use of undeclared identifier &apos;pdu&apos;">pdu</span>);</td></tr>
<tr><th id="298">298</th><td>    }</td></tr>
<tr><th id="299">299</th><td>}</td></tr>
<tr><th id="300">300</th><td></td></tr>
<tr><th id="301">301</th><td><em>static</em> <a class="typedef" href="pdqvar.h.html#pdq_boolean_t" title='pdq_boolean_t' data-type='enum _pdq_boolean_t' data-ref="pdq_boolean_t" data-ref-filename="pdq_boolean_t">pdq_boolean_t</a></td></tr>
<tr><th id="302">302</th><td><dfn class="tu decl def fn" id="pdq_do_port_control" title='pdq_do_port_control' data-type='pdq_boolean_t pdq_do_port_control(const pdq_csrs_t *const csrs, pdq_uint32_t cmd)' data-ref="pdq_do_port_control" data-ref-filename="pdq_do_port_control">pdq_do_port_control</dfn>(</td></tr>
<tr><th id="303">303</th><td>    <em>const</em> <a class="typedef" href="pdqvar.h.html#pdq_csrs_t" title='pdq_csrs_t' data-type='struct _pdq_csrs_t' data-ref="pdq_csrs_t" data-ref-filename="pdq_csrs_t">pdq_csrs_t</a> * <em>const</em> <dfn class="local col9 decl" id="19csrs" title='csrs' data-type='const pdq_csrs_t *const' data-ref="19csrs" data-ref-filename="19csrs">csrs</dfn>,</td></tr>
<tr><th id="304">304</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_uint32_t" title='pdq_uint32_t' data-type='unsigned int' data-ref="pdq_uint32_t" data-ref-filename="pdq_uint32_t">pdq_uint32_t</a> <dfn class="local col0 decl" id="20cmd" title='cmd' data-type='pdq_uint32_t' data-ref="20cmd" data-ref-filename="20cmd">cmd</dfn>)</td></tr>
<tr><th id="305">305</th><td>{</td></tr>
<tr><th id="306">306</th><td>    <em>int</em> <dfn class="local col1 decl" id="21cnt" title='cnt' data-type='int' data-ref="21cnt" data-ref-filename="21cnt">cnt</dfn> = <var>0</var>;</td></tr>
<tr><th id="307">307</th><td>    <span class='error' title="implicit declaration of function &apos;PDQ_CSR_WRITE&apos; is invalid in C99"><span class='error' title="this function declaration is not a prototype">PDQ_CSR_WRITE</span></span>(csrs, <span class='error' title="use of undeclared identifier &apos;csr_host_int_type_0&apos;">csr_host_int_type_0</span>, <a class="macro" href="pdqreg.h.html#240" title="0x20" data-ref="_M/PDQ_HOST_INT_CSR_CMD_DONE">PDQ_HOST_INT_CSR_CMD_DONE</a>);</td></tr>
<tr><th id="308">308</th><td>    PDQ_CSR_WRITE(csrs, <span class='error' title="use of undeclared identifier &apos;csr_port_control&apos;">csr_port_control</span>, <a class="macro" href="pdqreg.h.html#178" title="0x8000" data-ref="_M/PDQ_PCTL_CMD_ERROR">PDQ_PCTL_CMD_ERROR</a> | cmd);</td></tr>
<tr><th id="309">309</th><td>    <b>while</b> ((<span class='error' title="implicit declaration of function &apos;PDQ_CSR_READ&apos; is invalid in C99"><span class='error' title="this function declaration is not a prototype">PDQ_CSR_READ</span></span>(csrs, <span class='error' title="use of undeclared identifier &apos;csr_host_int_type_0&apos;">csr_host_int_type_0</span>) &amp; <a class="macro" href="pdqreg.h.html#240" title="0x20" data-ref="_M/PDQ_HOST_INT_CSR_CMD_DONE">PDQ_HOST_INT_CSR_CMD_DONE</a>) == <var>0</var> &amp;&amp; cnt &lt; <var>33000000</var>)</td></tr>
<tr><th id="310">310</th><td>	cnt++;</td></tr>
<tr><th id="311">311</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"CSR cmd spun %d times\n"</q>, cnt));</td></tr>
<tr><th id="312">312</th><td>    <b>if</b> (PDQ_CSR_READ(csrs, <span class='error' title="use of undeclared identifier &apos;csr_host_int_type_0&apos;">csr_host_int_type_0</span>) &amp; <a class="macro" href="pdqreg.h.html#240" title="0x20" data-ref="_M/PDQ_HOST_INT_CSR_CMD_DONE">PDQ_HOST_INT_CSR_CMD_DONE</a>) {</td></tr>
<tr><th id="313">313</th><td>	PDQ_CSR_WRITE(csrs, <span class='error' title="use of undeclared identifier &apos;csr_host_int_type_0&apos;">csr_host_int_type_0</span>, <a class="macro" href="pdqreg.h.html#240" title="0x20" data-ref="_M/PDQ_HOST_INT_CSR_CMD_DONE">PDQ_HOST_INT_CSR_CMD_DONE</a>);</td></tr>
<tr><th id="314">314</th><td>	<b>return</b> (PDQ_CSR_READ(csrs, <span class='error' title="use of undeclared identifier &apos;csr_port_control&apos;">csr_port_control</span>) &amp; <a class="macro" href="pdqreg.h.html#178" title="0x8000" data-ref="_M/PDQ_PCTL_CMD_ERROR">PDQ_PCTL_CMD_ERROR</a>) ? PDQ_FALSE : PDQ_TRUE;</td></tr>
<tr><th id="315">315</th><td>    }</td></tr>
<tr><th id="316">316</th><td>    <i>/* adapter failure */</i></td></tr>
<tr><th id="317">317</th><td>    <a class="macro" href="pdqreg.h.html#47" title="do { } while(0)" data-ref="_M/PDQ_ASSERT">PDQ_ASSERT</a>(<var>0</var>);</td></tr>
<tr><th id="318">318</th><td>    <b>return</b> <a class="enum" href="pdqvar.h.html#PDQ_FALSE" title='PDQ_FALSE' data-ref="PDQ_FALSE" data-ref-filename="PDQ_FALSE">PDQ_FALSE</a>;</td></tr>
<tr><th id="319">319</th><td>}</td></tr>
<tr><th id="320">320</th><td></td></tr>
<tr><th id="321">321</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="322">322</th><td><dfn class="tu decl def fn" id="pdq_read_mla" title='pdq_read_mla' data-type='void pdq_read_mla(const pdq_csrs_t *const csrs, pdq_lanaddr_t * hwaddr)' data-ref="pdq_read_mla" data-ref-filename="pdq_read_mla">pdq_read_mla</dfn>(</td></tr>
<tr><th id="323">323</th><td>    <em>const</em> <a class="typedef" href="pdqvar.h.html#pdq_csrs_t" title='pdq_csrs_t' data-type='struct _pdq_csrs_t' data-ref="pdq_csrs_t" data-ref-filename="pdq_csrs_t">pdq_csrs_t</a> * <em>const</em> <dfn class="local col2 decl" id="22csrs" title='csrs' data-type='const pdq_csrs_t *const' data-ref="22csrs" data-ref-filename="22csrs">csrs</dfn>,</td></tr>
<tr><th id="324">324</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_lanaddr_t" title='pdq_lanaddr_t' data-type='struct _pdq_lanaddr_t' data-ref="pdq_lanaddr_t" data-ref-filename="pdq_lanaddr_t">pdq_lanaddr_t</a> *<dfn class="local col3 decl" id="23hwaddr" title='hwaddr' data-type='pdq_lanaddr_t *' data-ref="23hwaddr" data-ref-filename="23hwaddr">hwaddr</dfn>)</td></tr>
<tr><th id="325">325</th><td>{</td></tr>
<tr><th id="326">326</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_uint32_t" title='pdq_uint32_t' data-type='unsigned int' data-ref="pdq_uint32_t" data-ref-filename="pdq_uint32_t">pdq_uint32_t</a> <dfn class="local col4 decl" id="24data" title='data' data-type='pdq_uint32_t' data-ref="24data" data-ref-filename="24data">data</dfn>;</td></tr>
<tr><th id="327">327</th><td></td></tr>
<tr><th id="328">328</th><td>    <span class='error' title="implicit declaration of function &apos;PDQ_CSR_WRITE&apos; is invalid in C99">PDQ_CSR_WRITE</span>(csrs, <span class='error' title="use of undeclared identifier &apos;csr_port_data_a&apos;">csr_port_data_a</span>, <var>0</var>);</td></tr>
<tr><th id="329">329</th><td>    <a class="tu ref fn" href="#pdq_do_port_control" title='pdq_do_port_control' data-use='c' data-ref="pdq_do_port_control" data-ref-filename="pdq_do_port_control">pdq_do_port_control</a>(<a class="local col2 ref" href="#22csrs" title='csrs' data-ref="22csrs" data-ref-filename="22csrs">csrs</a>, <a class="macro" href="pdqreg.h.html#192" title="0x0008" data-ref="_M/PDQ_PCTL_MLA_READ">PDQ_PCTL_MLA_READ</a>);</td></tr>
<tr><th id="330">330</th><td>    data = <span class='error' title="implicit declaration of function &apos;PDQ_CSR_READ&apos; is invalid in C99">PDQ_CSR_READ</span>(csrs, <span class='error' title="use of undeclared identifier &apos;csr_host_data&apos;">csr_host_data</span>);</td></tr>
<tr><th id="331">331</th><td></td></tr>
<tr><th id="332">332</th><td>    <a class="local col3 ref" href="#23hwaddr" title='hwaddr' data-ref="23hwaddr" data-ref-filename="23hwaddr">hwaddr</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_lanaddr_t::lanaddr_bytes" title='_pdq_lanaddr_t::lanaddr_bytes' data-ref="_pdq_lanaddr_t::lanaddr_bytes" data-ref-filename="_pdq_lanaddr_t..lanaddr_bytes">lanaddr_bytes</a>[<var>0</var>] = (<a class="local col4 ref" href="#24data" title='data' data-ref="24data" data-ref-filename="24data">data</a> &gt;&gt; <var>0</var>) &amp; <var>0xFF</var>;</td></tr>
<tr><th id="333">333</th><td>    <a class="local col3 ref" href="#23hwaddr" title='hwaddr' data-ref="23hwaddr" data-ref-filename="23hwaddr">hwaddr</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_lanaddr_t::lanaddr_bytes" title='_pdq_lanaddr_t::lanaddr_bytes' data-ref="_pdq_lanaddr_t::lanaddr_bytes" data-ref-filename="_pdq_lanaddr_t..lanaddr_bytes">lanaddr_bytes</a>[<var>1</var>] = (<a class="local col4 ref" href="#24data" title='data' data-ref="24data" data-ref-filename="24data">data</a> &gt;&gt; <var>8</var>) &amp; <var>0xFF</var>;</td></tr>
<tr><th id="334">334</th><td>    <a class="local col3 ref" href="#23hwaddr" title='hwaddr' data-ref="23hwaddr" data-ref-filename="23hwaddr">hwaddr</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_lanaddr_t::lanaddr_bytes" title='_pdq_lanaddr_t::lanaddr_bytes' data-ref="_pdq_lanaddr_t::lanaddr_bytes" data-ref-filename="_pdq_lanaddr_t..lanaddr_bytes">lanaddr_bytes</a>[<var>2</var>] = (<a class="local col4 ref" href="#24data" title='data' data-ref="24data" data-ref-filename="24data">data</a> &gt;&gt; <var>16</var>) &amp; <var>0xFF</var>;</td></tr>
<tr><th id="335">335</th><td>    <a class="local col3 ref" href="#23hwaddr" title='hwaddr' data-ref="23hwaddr" data-ref-filename="23hwaddr">hwaddr</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_lanaddr_t::lanaddr_bytes" title='_pdq_lanaddr_t::lanaddr_bytes' data-ref="_pdq_lanaddr_t::lanaddr_bytes" data-ref-filename="_pdq_lanaddr_t..lanaddr_bytes">lanaddr_bytes</a>[<var>3</var>] = (<a class="local col4 ref" href="#24data" title='data' data-ref="24data" data-ref-filename="24data">data</a> &gt;&gt; <var>24</var>) &amp; <var>0xFF</var>;</td></tr>
<tr><th id="336">336</th><td></td></tr>
<tr><th id="337">337</th><td>    PDQ_CSR_WRITE(csrs, <span class='error' title="use of undeclared identifier &apos;csr_port_data_a&apos;">csr_port_data_a</span>, <var>1</var>);</td></tr>
<tr><th id="338">338</th><td>    <a class="tu ref fn" href="#pdq_do_port_control" title='pdq_do_port_control' data-use='c' data-ref="pdq_do_port_control" data-ref-filename="pdq_do_port_control">pdq_do_port_control</a>(<a class="local col2 ref" href="#22csrs" title='csrs' data-ref="22csrs" data-ref-filename="22csrs">csrs</a>, <a class="macro" href="pdqreg.h.html#192" title="0x0008" data-ref="_M/PDQ_PCTL_MLA_READ">PDQ_PCTL_MLA_READ</a>);</td></tr>
<tr><th id="339">339</th><td>    data = PDQ_CSR_READ(csrs, <span class='error' title="use of undeclared identifier &apos;csr_host_data&apos;">csr_host_data</span>);</td></tr>
<tr><th id="340">340</th><td></td></tr>
<tr><th id="341">341</th><td>    <a class="local col3 ref" href="#23hwaddr" title='hwaddr' data-ref="23hwaddr" data-ref-filename="23hwaddr">hwaddr</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_lanaddr_t::lanaddr_bytes" title='_pdq_lanaddr_t::lanaddr_bytes' data-ref="_pdq_lanaddr_t::lanaddr_bytes" data-ref-filename="_pdq_lanaddr_t..lanaddr_bytes">lanaddr_bytes</a>[<var>4</var>] = (<a class="local col4 ref" href="#24data" title='data' data-ref="24data" data-ref-filename="24data">data</a> &gt;&gt; <var>0</var>) &amp; <var>0xFF</var>;</td></tr>
<tr><th id="342">342</th><td>    <a class="local col3 ref" href="#23hwaddr" title='hwaddr' data-ref="23hwaddr" data-ref-filename="23hwaddr">hwaddr</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_lanaddr_t::lanaddr_bytes" title='_pdq_lanaddr_t::lanaddr_bytes' data-ref="_pdq_lanaddr_t::lanaddr_bytes" data-ref-filename="_pdq_lanaddr_t..lanaddr_bytes">lanaddr_bytes</a>[<var>5</var>] = (<a class="local col4 ref" href="#24data" title='data' data-ref="24data" data-ref-filename="24data">data</a> &gt;&gt; <var>8</var>) &amp; <var>0xFF</var>;</td></tr>
<tr><th id="343">343</th><td>}</td></tr>
<tr><th id="344">344</th><td></td></tr>
<tr><th id="345">345</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="346">346</th><td><dfn class="tu decl def fn" id="pdq_read_fwrev" title='pdq_read_fwrev' data-type='void pdq_read_fwrev(const pdq_csrs_t *const csrs, pdq_fwrev_t * fwrev)' data-ref="pdq_read_fwrev" data-ref-filename="pdq_read_fwrev">pdq_read_fwrev</dfn>(</td></tr>
<tr><th id="347">347</th><td>    <em>const</em> <a class="typedef" href="pdqvar.h.html#pdq_csrs_t" title='pdq_csrs_t' data-type='struct _pdq_csrs_t' data-ref="pdq_csrs_t" data-ref-filename="pdq_csrs_t">pdq_csrs_t</a> * <em>const</em> <dfn class="local col5 decl" id="25csrs" title='csrs' data-type='const pdq_csrs_t *const' data-ref="25csrs" data-ref-filename="25csrs">csrs</dfn>,</td></tr>
<tr><th id="348">348</th><td>    <a class="typedef" href="pdqreg.h.html#pdq_fwrev_t" title='pdq_fwrev_t' data-type='struct pdq_fwrev_t' data-ref="pdq_fwrev_t" data-ref-filename="pdq_fwrev_t">pdq_fwrev_t</a> *<dfn class="local col6 decl" id="26fwrev" title='fwrev' data-type='pdq_fwrev_t *' data-ref="26fwrev" data-ref-filename="26fwrev">fwrev</dfn>)</td></tr>
<tr><th id="349">349</th><td>{</td></tr>
<tr><th id="350">350</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_uint32_t" title='pdq_uint32_t' data-type='unsigned int' data-ref="pdq_uint32_t" data-ref-filename="pdq_uint32_t">pdq_uint32_t</a> <dfn class="local col7 decl" id="27data" title='data' data-type='pdq_uint32_t' data-ref="27data" data-ref-filename="27data">data</dfn>;</td></tr>
<tr><th id="351">351</th><td></td></tr>
<tr><th id="352">352</th><td>    <a class="tu ref fn" href="#pdq_do_port_control" title='pdq_do_port_control' data-use='c' data-ref="pdq_do_port_control" data-ref-filename="pdq_do_port_control">pdq_do_port_control</a>(<a class="local col5 ref" href="#25csrs" title='csrs' data-ref="25csrs" data-ref-filename="25csrs">csrs</a>, <a class="macro" href="pdqreg.h.html#193" title="0x0004" data-ref="_M/PDQ_PCTL_FW_REV_READ">PDQ_PCTL_FW_REV_READ</a>);</td></tr>
<tr><th id="353">353</th><td>    data = <span class='error' title="implicit declaration of function &apos;PDQ_CSR_READ&apos; is invalid in C99">PDQ_CSR_READ</span>(csrs, <span class='error' title="use of undeclared identifier &apos;csr_host_data&apos;">csr_host_data</span>);</td></tr>
<tr><th id="354">354</th><td></td></tr>
<tr><th id="355">355</th><td>    <a class="local col6 ref" href="#26fwrev" title='fwrev' data-ref="26fwrev" data-ref-filename="26fwrev">fwrev</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::fwrev_bytes" title='(anonymous struct)::fwrev_bytes' data-ref="(anonymous)::fwrev_bytes" data-ref-filename="(anonymous)..fwrev_bytes">fwrev_bytes</a>[<var>3</var>] = (<a class="local col7 ref" href="#27data" title='data' data-ref="27data" data-ref-filename="27data">data</a> &gt;&gt; <var>0</var>) &amp; <var>0xFF</var>;</td></tr>
<tr><th id="356">356</th><td>    <a class="local col6 ref" href="#26fwrev" title='fwrev' data-ref="26fwrev" data-ref-filename="26fwrev">fwrev</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::fwrev_bytes" title='(anonymous struct)::fwrev_bytes' data-ref="(anonymous)::fwrev_bytes" data-ref-filename="(anonymous)..fwrev_bytes">fwrev_bytes</a>[<var>2</var>] = (<a class="local col7 ref" href="#27data" title='data' data-ref="27data" data-ref-filename="27data">data</a> &gt;&gt; <var>8</var>) &amp; <var>0xFF</var>;</td></tr>
<tr><th id="357">357</th><td>    <a class="local col6 ref" href="#26fwrev" title='fwrev' data-ref="26fwrev" data-ref-filename="26fwrev">fwrev</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::fwrev_bytes" title='(anonymous struct)::fwrev_bytes' data-ref="(anonymous)::fwrev_bytes" data-ref-filename="(anonymous)..fwrev_bytes">fwrev_bytes</a>[<var>1</var>] = (<a class="local col7 ref" href="#27data" title='data' data-ref="27data" data-ref-filename="27data">data</a> &gt;&gt; <var>16</var>) &amp; <var>0xFF</var>;</td></tr>
<tr><th id="358">358</th><td>    <a class="local col6 ref" href="#26fwrev" title='fwrev' data-ref="26fwrev" data-ref-filename="26fwrev">fwrev</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::fwrev_bytes" title='(anonymous struct)::fwrev_bytes' data-ref="(anonymous)::fwrev_bytes" data-ref-filename="(anonymous)..fwrev_bytes">fwrev_bytes</a>[<var>0</var>] = (<a class="local col7 ref" href="#27data" title='data' data-ref="27data" data-ref-filename="27data">data</a> &gt;&gt; <var>24</var>) &amp; <var>0xFF</var>;</td></tr>
<tr><th id="359">359</th><td>}</td></tr>
<tr><th id="360">360</th><td></td></tr>
<tr><th id="361">361</th><td><em>static</em> <a class="typedef" href="pdqvar.h.html#pdq_boolean_t" title='pdq_boolean_t' data-type='enum _pdq_boolean_t' data-ref="pdq_boolean_t" data-ref-filename="pdq_boolean_t">pdq_boolean_t</a></td></tr>
<tr><th id="362">362</th><td><dfn class="tu decl def fn" id="pdq_read_error_log" title='pdq_read_error_log' data-type='pdq_boolean_t pdq_read_error_log(pdq_t * pdq, pdq_response_error_log_get_t * log_entry)' data-ref="pdq_read_error_log" data-ref-filename="pdq_read_error_log">pdq_read_error_log</dfn>(</td></tr>
<tr><th id="363">363</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_t" title='pdq_t' data-type='struct _pdq_t' data-ref="pdq_t" data-ref-filename="pdq_t">pdq_t</a> *<dfn class="local col8 decl" id="28pdq" title='pdq' data-type='pdq_t *' data-ref="28pdq" data-ref-filename="28pdq">pdq</dfn>,</td></tr>
<tr><th id="364">364</th><td>    <a class="typedef" href="pdqreg.h.html#pdq_response_error_log_get_t" title='pdq_response_error_log_get_t' data-type='struct pdq_response_error_log_get_t' data-ref="pdq_response_error_log_get_t" data-ref-filename="pdq_response_error_log_get_t">pdq_response_error_log_get_t</a> *<dfn class="local col9 decl" id="29log_entry" title='log_entry' data-type='pdq_response_error_log_get_t *' data-ref="29log_entry" data-ref-filename="29log_entry">log_entry</dfn>)</td></tr>
<tr><th id="365">365</th><td>{</td></tr>
<tr><th id="366">366</th><td>    <em>const</em> <a class="typedef" href="pdqvar.h.html#pdq_csrs_t" title='pdq_csrs_t' data-type='struct _pdq_csrs_t' data-ref="pdq_csrs_t" data-ref-filename="pdq_csrs_t">pdq_csrs_t</a> * <em>const</em> <dfn class="local col0 decl" id="30csrs" title='csrs' data-type='const pdq_csrs_t *const' data-ref="30csrs" data-ref-filename="30csrs">csrs</dfn> = &amp;pdq-&gt;pdq_csrs;</td></tr>
<tr><th id="367">367</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_uint32_t" title='pdq_uint32_t' data-type='unsigned int' data-ref="pdq_uint32_t" data-ref-filename="pdq_uint32_t">pdq_uint32_t</a> *<dfn class="local col1 decl" id="31ptr" title='ptr' data-type='pdq_uint32_t *' data-ref="31ptr" data-ref-filename="31ptr">ptr</dfn> = (<a class="typedef" href="pdqvar.h.html#pdq_uint32_t" title='pdq_uint32_t' data-type='unsigned int' data-ref="pdq_uint32_t" data-ref-filename="pdq_uint32_t">pdq_uint32_t</a> *) <a class="local col9 ref" href="#29log_entry" title='log_entry' data-ref="29log_entry" data-ref-filename="29log_entry">log_entry</a>;</td></tr>
<tr><th id="368">368</th><td></td></tr>
<tr><th id="369">369</th><td>    <a class="tu ref fn" href="#pdq_do_port_control" title='pdq_do_port_control' data-use='c' data-ref="pdq_do_port_control" data-ref-filename="pdq_do_port_control">pdq_do_port_control</a>(<a class="local col0 ref" href="#30csrs" title='csrs' data-ref="30csrs" data-ref-filename="30csrs">csrs</a>, <a class="macro" href="pdqreg.h.html#182" title="0x0800" data-ref="_M/PDQ_PCTL_ERROR_LOG_START">PDQ_PCTL_ERROR_LOG_START</a>);</td></tr>
<tr><th id="370">370</th><td></td></tr>
<tr><th id="371">371</th><td>    <b>while</b> (<a class="tu ref fn" href="#pdq_do_port_control" title='pdq_do_port_control' data-use='c' data-ref="pdq_do_port_control" data-ref-filename="pdq_do_port_control">pdq_do_port_control</a>(<a class="local col0 ref" href="#30csrs" title='csrs' data-ref="30csrs" data-ref-filename="30csrs">csrs</a>, <a class="macro" href="pdqreg.h.html#193" title="0x0004" data-ref="_M/PDQ_PCTL_FW_REV_READ">PDQ_PCTL_FW_REV_READ</a>) == <a class="enum" href="pdqvar.h.html#PDQ_TRUE" title='PDQ_TRUE' data-ref="PDQ_TRUE" data-ref-filename="PDQ_TRUE">PDQ_TRUE</a>) {</td></tr>
<tr><th id="372">372</th><td>	*ptr++ = <span class='error' title="implicit declaration of function &apos;PDQ_CSR_READ&apos; is invalid in C99">PDQ_CSR_READ</span>(csrs, <span class='error' title="use of undeclared identifier &apos;csr_host_data&apos;">csr_host_data</span>);</td></tr>
<tr><th id="373">373</th><td>	<b>if</b> ((<a class="typedef" href="pdqvar.h.html#pdq_uint8_t" title='pdq_uint8_t' data-type='unsigned char' data-ref="pdq_uint8_t" data-ref-filename="pdq_uint8_t">pdq_uint8_t</a> *) <a class="local col1 ref" href="#31ptr" title='ptr' data-ref="31ptr" data-ref-filename="31ptr">ptr</a> - (<a class="typedef" href="pdqvar.h.html#pdq_uint8_t" title='pdq_uint8_t' data-type='unsigned char' data-ref="pdq_uint8_t" data-ref-filename="pdq_uint8_t">pdq_uint8_t</a> *) <a class="local col9 ref" href="#29log_entry" title='log_entry' data-ref="29log_entry" data-ref-filename="29log_entry">log_entry</a> == <b>sizeof</b>(*<a class="local col9 ref" href="#29log_entry" title='log_entry' data-ref="29log_entry" data-ref-filename="29log_entry">log_entry</a>))</td></tr>
<tr><th id="374">374</th><td>	    <b>break</b>;</td></tr>
<tr><th id="375">375</th><td>    }</td></tr>
<tr><th id="376">376</th><td>    <b>return</b> (<a class="local col1 ref" href="#31ptr" title='ptr' data-ref="31ptr" data-ref-filename="31ptr">ptr</a> == (<a class="typedef" href="pdqvar.h.html#pdq_uint32_t" title='pdq_uint32_t' data-type='unsigned int' data-ref="pdq_uint32_t" data-ref-filename="pdq_uint32_t">pdq_uint32_t</a> *) <a class="local col9 ref" href="#29log_entry" title='log_entry' data-ref="29log_entry" data-ref-filename="29log_entry">log_entry</a>) ? <a class="enum" href="pdqvar.h.html#PDQ_FALSE" title='PDQ_FALSE' data-ref="PDQ_FALSE" data-ref-filename="PDQ_FALSE">PDQ_FALSE</a> : <a class="enum" href="pdqvar.h.html#PDQ_TRUE" title='PDQ_TRUE' data-ref="PDQ_TRUE" data-ref-filename="PDQ_TRUE">PDQ_TRUE</a>;</td></tr>
<tr><th id="377">377</th><td>}</td></tr>
<tr><th id="378">378</th><td></td></tr>
<tr><th id="379">379</th><td><em>static</em> <a class="typedef" href="pdqreg.h.html#pdq_chip_rev_t" title='pdq_chip_rev_t' data-type='enum pdq_chip_rev_t' data-ref="pdq_chip_rev_t" data-ref-filename="pdq_chip_rev_t">pdq_chip_rev_t</a></td></tr>
<tr><th id="380">380</th><td><dfn class="tu decl def fn" id="pdq_read_chiprev" title='pdq_read_chiprev' data-type='pdq_chip_rev_t pdq_read_chiprev(const pdq_csrs_t *const csrs)' data-ref="pdq_read_chiprev" data-ref-filename="pdq_read_chiprev">pdq_read_chiprev</dfn>(</td></tr>
<tr><th id="381">381</th><td>    <em>const</em> <a class="typedef" href="pdqvar.h.html#pdq_csrs_t" title='pdq_csrs_t' data-type='struct _pdq_csrs_t' data-ref="pdq_csrs_t" data-ref-filename="pdq_csrs_t">pdq_csrs_t</a> * <em>const</em> <dfn class="local col2 decl" id="32csrs" title='csrs' data-type='const pdq_csrs_t *const' data-ref="32csrs" data-ref-filename="32csrs">csrs</dfn>)</td></tr>
<tr><th id="382">382</th><td>{</td></tr>
<tr><th id="383">383</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_uint32_t" title='pdq_uint32_t' data-type='unsigned int' data-ref="pdq_uint32_t" data-ref-filename="pdq_uint32_t">pdq_uint32_t</a> <dfn class="local col3 decl" id="33data" title='data' data-type='pdq_uint32_t' data-ref="33data" data-ref-filename="33data">data</dfn>;</td></tr>
<tr><th id="384">384</th><td></td></tr>
<tr><th id="385">385</th><td>    <span class='error' title="implicit declaration of function &apos;PDQ_CSR_WRITE&apos; is invalid in C99">PDQ_CSR_WRITE</span>(csrs, <span class='error' title="use of undeclared identifier &apos;csr_port_data_a&apos;">csr_port_data_a</span>, PDQ_SUB_CMD_PDQ_REV_GET);</td></tr>
<tr><th id="386">386</th><td>    <a class="tu ref fn" href="#pdq_do_port_control" title='pdq_do_port_control' data-use='c' data-ref="pdq_do_port_control" data-ref-filename="pdq_do_port_control">pdq_do_port_control</a>(<a class="local col2 ref" href="#32csrs" title='csrs' data-ref="32csrs" data-ref-filename="32csrs">csrs</a>, <a class="macro" href="pdqreg.h.html#195" title="0x0001" data-ref="_M/PDQ_PCTL_SUB_CMD">PDQ_PCTL_SUB_CMD</a>);</td></tr>
<tr><th id="387">387</th><td>    data = <span class='error' title="implicit declaration of function &apos;PDQ_CSR_READ&apos; is invalid in C99">PDQ_CSR_READ</span>(csrs, <span class='error' title="use of undeclared identifier &apos;csr_host_data&apos;">csr_host_data</span>);</td></tr>
<tr><th id="388">388</th><td></td></tr>
<tr><th id="389">389</th><td>    <b>return</b> (<a class="typedef" href="pdqreg.h.html#pdq_chip_rev_t" title='pdq_chip_rev_t' data-type='enum pdq_chip_rev_t' data-ref="pdq_chip_rev_t" data-ref-filename="pdq_chip_rev_t">pdq_chip_rev_t</a>) <a class="local col3 ref" href="#33data" title='data' data-ref="33data" data-ref-filename="33data">data</a>;</td></tr>
<tr><th id="390">390</th><td>}</td></tr>
<tr><th id="391">391</th><td></td></tr>
<tr><th id="392">392</th><td><em>static</em> <em>const</em> <b>struct</b> {</td></tr>
<tr><th id="393">393</th><td>    <span class='error' title="unknown type name &apos;size_t&apos;">size_t</span> <dfn class="local col4 decl field" id="34cmd_len" title='cmd_len' data-type='int' data-ref="34cmd_len" data-ref-filename="34cmd_len">cmd_len</dfn>;</td></tr>
<tr><th id="394">394</th><td>    <span class='error' title="unknown type name &apos;size_t&apos;">size_t</span> <dfn class="local col5 decl field" id="35rsp_len" title='rsp_len' data-type='int' data-ref="35rsp_len" data-ref-filename="35rsp_len">rsp_len</dfn>;</td></tr>
<tr><th id="395">395</th><td>    <em>const</em> <em>char</em> *<dfn class="local col6 decl field" id="36cmd_name" title='cmd_name' data-type='const char *' data-ref="36cmd_name" data-ref-filename="36cmd_name">cmd_name</dfn>;</td></tr>
<tr><th id="396">396</th><td>} <dfn class="tu decl def" id="pdq_cmd_info" title='pdq_cmd_info' data-type='const struct (anonymous struct at /___NETBSD_SRC___/objdir.amd64/sys/arch/amd64/compile/GENERIC/../../../../../../sys/dev/ic/pdq.c:392:14) []' data-ref="pdq_cmd_info" data-ref-filename="pdq_cmd_info">pdq_cmd_info</dfn>[] = {</td></tr>
<tr><th id="397">397</th><td>    { <b>sizeof</b>(pdq_cmd_generic_t),		<i>/* 0 - PDQC_START */</i></td></tr>
<tr><th id="398">398</th><td>      <b>sizeof</b>(pdq_response_generic_t),</td></tr>
<tr><th id="399">399</th><td>      <q>"Start"</q></td></tr>
<tr><th id="400">400</th><td>    },</td></tr>
<tr><th id="401">401</th><td>    { <b>sizeof</b>(pdq_cmd_filter_set_t),		<i>/* 1 - PDQC_FILTER_SET */</i></td></tr>
<tr><th id="402">402</th><td>      <b>sizeof</b>(pdq_response_generic_t),</td></tr>
<tr><th id="403">403</th><td>      <q>"Filter Set"</q></td></tr>
<tr><th id="404">404</th><td>    },</td></tr>
<tr><th id="405">405</th><td>    { <b>sizeof</b>(pdq_cmd_generic_t),		<i>/* 2 - PDQC_FILTER_GET */</i></td></tr>
<tr><th id="406">406</th><td>      <b>sizeof</b>(pdq_response_filter_get_t),</td></tr>
<tr><th id="407">407</th><td>      <q>"Filter Get"</q></td></tr>
<tr><th id="408">408</th><td>    },</td></tr>
<tr><th id="409">409</th><td>    { <b>sizeof</b>(pdq_cmd_chars_set_t),		<i>/* 3 - PDQC_CHARS_SET */</i></td></tr>
<tr><th id="410">410</th><td>      <b>sizeof</b>(pdq_response_generic_t),</td></tr>
<tr><th id="411">411</th><td>      <q>"Chars Set"</q></td></tr>
<tr><th id="412">412</th><td>    },</td></tr>
<tr><th id="413">413</th><td>    { <b>sizeof</b>(pdq_cmd_generic_t),		<i>/* 4 - PDQC_STATUS_CHARS_GET */</i></td></tr>
<tr><th id="414">414</th><td>      <b>sizeof</b>(pdq_response_status_chars_get_t),</td></tr>
<tr><th id="415">415</th><td>      <q>"Status Chars Get"</q></td></tr>
<tr><th id="416">416</th><td>    },</td></tr>
<tr><th id="417">417</th><td><u>#<span data-ppcond="417">if</span> 0</u></td></tr>
<tr><th id="418">418</th><td>    { <b>sizeof</b>(pdq_cmd_generic_t),		<i>/* 5 - PDQC_COUNTERS_GET */</i></td></tr>
<tr><th id="419">419</th><td>      <b>sizeof</b>(pdq_response_counters_get_t),</td></tr>
<tr><th id="420">420</th><td>      <q>"Counters Get"</q></td></tr>
<tr><th id="421">421</th><td>    },</td></tr>
<tr><th id="422">422</th><td>    { <b>sizeof</b>(pdq_cmd_counters_set_t),		<i>/* 6 - PDQC_COUNTERS_SET */</i></td></tr>
<tr><th id="423">423</th><td>      <b>sizeof</b>(pdq_response_generic_t),</td></tr>
<tr><th id="424">424</th><td>      <q>"Counters Set"</q></td></tr>
<tr><th id="425">425</th><td>    },</td></tr>
<tr><th id="426">426</th><td><u>#<span data-ppcond="417">else</span></u></td></tr>
<tr><th id="427">427</th><td>    { <var>0</var>, <var>0</var>, <q>"Counters Get"</q> },</td></tr>
<tr><th id="428">428</th><td>    { <var>0</var>, <var>0</var>, <q>"Counters Set"</q> },</td></tr>
<tr><th id="429">429</th><td><u>#<span data-ppcond="417">endif</span></u></td></tr>
<tr><th id="430">430</th><td>    { <b>sizeof</b>(pdq_cmd_addr_filter_set_t),	<i>/* 7 - PDQC_ADDR_FILTER_SET */</i></td></tr>
<tr><th id="431">431</th><td>      <b>sizeof</b>(pdq_response_generic_t),</td></tr>
<tr><th id="432">432</th><td>      <q>"Addr Filter Set"</q></td></tr>
<tr><th id="433">433</th><td>    },</td></tr>
<tr><th id="434">434</th><td>    { <b>sizeof</b>(pdq_cmd_generic_t),		<i>/* 8 - PDQC_ADDR_FILTER_GET */</i></td></tr>
<tr><th id="435">435</th><td>      <b>sizeof</b>(pdq_response_addr_filter_get_t),</td></tr>
<tr><th id="436">436</th><td>      <q>"Addr Filter Get"</q></td></tr>
<tr><th id="437">437</th><td>    },</td></tr>
<tr><th id="438">438</th><td>    { <b>sizeof</b>(pdq_cmd_generic_t),		<i>/* 9 - PDQC_ERROR_LOG_CLEAR */</i></td></tr>
<tr><th id="439">439</th><td>      <b>sizeof</b>(pdq_response_generic_t),</td></tr>
<tr><th id="440">440</th><td>      <q>"Error Log Clear"</q></td></tr>
<tr><th id="441">441</th><td>    },</td></tr>
<tr><th id="442">442</th><td>    { <b>sizeof</b>(pdq_cmd_generic_t),		<i>/* 10 - PDQC_ERROR_LOG_SET */</i></td></tr>
<tr><th id="443">443</th><td>      <b>sizeof</b>(pdq_response_generic_t),</td></tr>
<tr><th id="444">444</th><td>      <q>"Error Log Set"</q></td></tr>
<tr><th id="445">445</th><td>    },</td></tr>
<tr><th id="446">446</th><td>    { <b>sizeof</b>(pdq_cmd_generic_t),		<i>/* 11 - PDQC_FDDI_MIB_GET */</i></td></tr>
<tr><th id="447">447</th><td>      <b>sizeof</b>(pdq_response_generic_t),</td></tr>
<tr><th id="448">448</th><td>      <q>"FDDI MIB Get"</q></td></tr>
<tr><th id="449">449</th><td>    },</td></tr>
<tr><th id="450">450</th><td>    { <b>sizeof</b>(pdq_cmd_generic_t),		<i>/* 12 - PDQC_DEC_EXT_MIB_GET */</i></td></tr>
<tr><th id="451">451</th><td>      <b>sizeof</b>(pdq_response_generic_t),</td></tr>
<tr><th id="452">452</th><td>      <q>"DEC Ext MIB Get"</q></td></tr>
<tr><th id="453">453</th><td>    },</td></tr>
<tr><th id="454">454</th><td>    { <b>sizeof</b>(pdq_cmd_generic_t),		<i>/* 13 - PDQC_DEC_SPECIFIC_GET */</i></td></tr>
<tr><th id="455">455</th><td>      <b>sizeof</b>(pdq_response_generic_t),</td></tr>
<tr><th id="456">456</th><td>      <q>"DEC Specific Get"</q></td></tr>
<tr><th id="457">457</th><td>    },</td></tr>
<tr><th id="458">458</th><td>    { <b>sizeof</b>(pdq_cmd_generic_t),		<i>/* 14 - PDQC_SNMP_SET */</i></td></tr>
<tr><th id="459">459</th><td>      <b>sizeof</b>(pdq_response_generic_t),</td></tr>
<tr><th id="460">460</th><td>      <q>"SNMP Set"</q></td></tr>
<tr><th id="461">461</th><td>    },</td></tr>
<tr><th id="462">462</th><td>    { <var>0</var>, <var>0</var>, <q>"N/A"</q> },</td></tr>
<tr><th id="463">463</th><td>    { <b>sizeof</b>(pdq_cmd_generic_t),		<i>/* 16 - PDQC_SMT_MIB_GET */</i></td></tr>
<tr><th id="464">464</th><td>      <b>sizeof</b>(pdq_response_generic_t),</td></tr>
<tr><th id="465">465</th><td>      <q>"SMT MIB Get"</q></td></tr>
<tr><th id="466">466</th><td>    },</td></tr>
<tr><th id="467">467</th><td>    { <b>sizeof</b>(pdq_cmd_generic_t),		<i>/* 17 - PDQC_SMT_MIB_SET */</i></td></tr>
<tr><th id="468">468</th><td>      <b>sizeof</b>(pdq_response_generic_t),</td></tr>
<tr><th id="469">469</th><td>      <q>"SMT MIB Set"</q>,</td></tr>
<tr><th id="470">470</th><td>    },</td></tr>
<tr><th id="471">471</th><td>    { <var>0</var>, <var>0</var>, <q>"Bogus CMD"</q> },</td></tr>
<tr><th id="472">472</th><td>};</td></tr>
<tr><th id="473">473</th><td></td></tr>
<tr><th id="474">474</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="475">475</th><td><dfn class="tu decl def fn" id="pdq_queue_commands" title='pdq_queue_commands' data-type='void pdq_queue_commands(pdq_t * pdq)' data-ref="pdq_queue_commands" data-ref-filename="pdq_queue_commands">pdq_queue_commands</dfn>(</td></tr>
<tr><th id="476">476</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_t" title='pdq_t' data-type='struct _pdq_t' data-ref="pdq_t" data-ref-filename="pdq_t">pdq_t</a> *<dfn class="local col7 decl" id="37pdq" title='pdq' data-type='pdq_t *' data-ref="37pdq" data-ref-filename="37pdq">pdq</dfn>)</td></tr>
<tr><th id="477">477</th><td>{</td></tr>
<tr><th id="478">478</th><td>    <em>const</em> <a class="typedef" href="pdqvar.h.html#pdq_csrs_t" title='pdq_csrs_t' data-type='struct _pdq_csrs_t' data-ref="pdq_csrs_t" data-ref-filename="pdq_csrs_t">pdq_csrs_t</a> * <em>const</em> <dfn class="local col8 decl" id="38csrs" title='csrs' data-type='const pdq_csrs_t *const' data-ref="38csrs" data-ref-filename="38csrs">csrs</dfn> = &amp;pdq-&gt;pdq_csrs;</td></tr>
<tr><th id="479">479</th><td>    <a class="typedef" href="pdqreg.h.html#pdq_command_info_t" title='pdq_command_info_t' data-type='struct pdq_command_info_t' data-ref="pdq_command_info_t" data-ref-filename="pdq_command_info_t">pdq_command_info_t</a> * <em>const</em> <dfn class="local col9 decl" id="39ci" title='ci' data-type='pdq_command_info_t *const' data-ref="39ci" data-ref-filename="39ci">ci</dfn> = &amp;<a class="local col7 ref" href="#37pdq" title='pdq' data-ref="37pdq" data-ref-filename="37pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_command_info" title='_pdq_t::pdq_command_info' data-ref="_pdq_t::pdq_command_info" data-ref-filename="_pdq_t..pdq_command_info">pdq_command_info</a>;</td></tr>
<tr><th id="480">480</th><td>    <a class="typedef" href="pdqreg.h.html#pdq_descriptor_block_t" title='pdq_descriptor_block_t' data-type='struct pdq_descriptor_block_t' data-ref="pdq_descriptor_block_t" data-ref-filename="pdq_descriptor_block_t">pdq_descriptor_block_t</a> * <em>const</em> <dfn class="local col0 decl" id="40dbp" title='dbp' data-type='pdq_descriptor_block_t *const' data-ref="40dbp" data-ref-filename="40dbp">dbp</dfn> = <a class="local col7 ref" href="#37pdq" title='pdq' data-ref="37pdq" data-ref-filename="37pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_dbp" title='_pdq_t::pdq_dbp' data-ref="_pdq_t::pdq_dbp" data-ref-filename="_pdq_t..pdq_dbp">pdq_dbp</a>;</td></tr>
<tr><th id="481">481</th><td>    <a class="typedef" href="pdqreg.h.html#pdq_txdesc_t" title='pdq_txdesc_t' data-type='struct pdq_txdesc_t' data-ref="pdq_txdesc_t" data-ref-filename="pdq_txdesc_t">pdq_txdesc_t</a> * <em>const</em> <dfn class="local col1 decl" id="41txd" title='txd' data-type='pdq_txdesc_t *const' data-ref="41txd" data-ref-filename="41txd">txd</dfn> = &amp;<a class="local col0 ref" href="#40dbp" title='dbp' data-ref="40dbp" data-ref-filename="40dbp">dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_command_requests" title='(anonymous struct)::pdqdb_command_requests' data-ref="(anonymous)::pdqdb_command_requests" data-ref-filename="(anonymous)..pdqdb_command_requests">pdqdb_command_requests</a>[<a class="local col9 ref" href="#39ci" title='ci' data-ref="39ci" data-ref-filename="39ci">ci</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_request_producer" title='(anonymous struct)::ci_request_producer' data-ref="(anonymous)::ci_request_producer" data-ref-filename="(anonymous)..ci_request_producer">ci_request_producer</a>];</td></tr>
<tr><th id="482">482</th><td>    <a class="typedef" href="pdqreg.h.html#pdq_cmd_code_t" title='pdq_cmd_code_t' data-type='enum pdq_cmd_code_t' data-ref="pdq_cmd_code_t" data-ref-filename="pdq_cmd_code_t">pdq_cmd_code_t</a> <dfn class="local col2 decl" id="42op" title='op' data-type='pdq_cmd_code_t' data-ref="42op" data-ref-filename="42op">op</dfn>;</td></tr>
<tr><th id="483">483</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_uint32_t" title='pdq_uint32_t' data-type='unsigned int' data-ref="pdq_uint32_t" data-ref-filename="pdq_uint32_t">pdq_uint32_t</a> <dfn class="local col3 decl" id="43cmdlen" title='cmdlen' data-type='pdq_uint32_t' data-ref="43cmdlen" data-ref-filename="43cmdlen">cmdlen</dfn>, <dfn class="local col4 decl" id="44rsplen" title='rsplen' data-type='pdq_uint32_t' data-ref="44rsplen" data-ref-filename="44rsplen">rsplen</dfn>, <dfn class="local col5 decl" id="45mask" title='mask' data-type='pdq_uint32_t' data-ref="45mask" data-ref-filename="45mask">mask</dfn>;</td></tr>
<tr><th id="484">484</th><td></td></tr>
<tr><th id="485">485</th><td>    <i>/*</i></td></tr>
<tr><th id="486">486</th><td><i>     * If there are commands or responses active or there aren't</i></td></tr>
<tr><th id="487">487</th><td><i>     * any pending commands, then don't queue any more.</i></td></tr>
<tr><th id="488">488</th><td><i>     */</i></td></tr>
<tr><th id="489">489</th><td>    <b>if</b> (<a class="local col9 ref" href="#39ci" title='ci' data-ref="39ci" data-ref-filename="39ci">ci</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_command_active" title='(anonymous struct)::ci_command_active' data-ref="(anonymous)::ci_command_active" data-ref-filename="(anonymous)..ci_command_active">ci_command_active</a> || <a class="local col9 ref" href="#39ci" title='ci' data-ref="39ci" data-ref-filename="39ci">ci</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_pending_commands" title='(anonymous struct)::ci_pending_commands' data-ref="(anonymous)::ci_pending_commands" data-ref-filename="(anonymous)..ci_pending_commands">ci_pending_commands</a> == <var>0</var>)</td></tr>
<tr><th id="490">490</th><td>	<b>return</b>;</td></tr>
<tr><th id="491">491</th><td></td></tr>
<tr><th id="492">492</th><td>    <i>/*</i></td></tr>
<tr><th id="493">493</th><td><i>     * Determine which command needs to be queued.</i></td></tr>
<tr><th id="494">494</th><td><i>     */</i></td></tr>
<tr><th id="495">495</th><td>    <a class="local col2 ref" href="#42op" title='op' data-ref="42op" data-ref-filename="42op">op</a> = <a class="enum" href="pdqreg.h.html#PDQC_SMT_MIB_SET" title='PDQC_SMT_MIB_SET' data-ref="PDQC_SMT_MIB_SET" data-ref-filename="PDQC_SMT_MIB_SET">PDQC_SMT_MIB_SET</a>;</td></tr>
<tr><th id="496">496</th><td>    <b>for</b> (<a class="local col5 ref" href="#45mask" title='mask' data-ref="45mask" data-ref-filename="45mask">mask</a> = <var>1</var> &lt;&lt; ((<em>int</em>) <a class="local col2 ref" href="#42op" title='op' data-ref="42op" data-ref-filename="42op">op</a>); (<a class="local col5 ref" href="#45mask" title='mask' data-ref="45mask" data-ref-filename="45mask">mask</a> &amp; <a class="local col9 ref" href="#39ci" title='ci' data-ref="39ci" data-ref-filename="39ci">ci</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_pending_commands" title='(anonymous struct)::ci_pending_commands' data-ref="(anonymous)::ci_pending_commands" data-ref-filename="(anonymous)..ci_pending_commands">ci_pending_commands</a>) == <var>0</var>; <a class="local col5 ref" href="#45mask" title='mask' data-ref="45mask" data-ref-filename="45mask">mask</a> &gt;&gt;= <var>1</var>)</td></tr>
<tr><th id="497">497</th><td>	<a class="local col2 ref" href="#42op" title='op' data-ref="42op" data-ref-filename="42op">op</a> = (<a class="typedef" href="pdqreg.h.html#pdq_cmd_code_t" title='pdq_cmd_code_t' data-type='enum pdq_cmd_code_t' data-ref="pdq_cmd_code_t" data-ref-filename="pdq_cmd_code_t">pdq_cmd_code_t</a>) ((<em>int</em>) <a class="local col2 ref" href="#42op" title='op' data-ref="42op" data-ref-filename="42op">op</a> - <var>1</var>);</td></tr>
<tr><th id="498">498</th><td>    <i>/*</i></td></tr>
<tr><th id="499">499</th><td><i>     * Obtain the sizes needed for the command and response.</i></td></tr>
<tr><th id="500">500</th><td><i>     * Round up to PDQ_CMD_RX_ALIGNMENT so the receive buffer is</i></td></tr>
<tr><th id="501">501</th><td><i>     * always properly aligned.</i></td></tr>
<tr><th id="502">502</th><td><i>     */</i></td></tr>
<tr><th id="503">503</th><td>    cmdlen = <a class="macro" href="#58" title="(((pdq_cmd_info[op].cmd_len) + ((16) - 1)) &amp; ~((16) - 1))" data-ref="_M/PDQ_ROUNDUP">PDQ_ROUNDUP</a>(pdq_cmd_info[op].cmd_len, <a class="macro" href="#59" title="16" data-ref="_M/PDQ_CMD_RX_ALIGNMENT">PDQ_CMD_RX_ALIGNMENT</a>);</td></tr>
<tr><th id="504">504</th><td>    rsplen = <a class="macro" href="#58" title="(((pdq_cmd_info[op].rsp_len) + ((16) - 1)) &amp; ~((16) - 1))" data-ref="_M/PDQ_ROUNDUP">PDQ_ROUNDUP</a>(pdq_cmd_info[op].rsp_len, <a class="macro" href="#59" title="16" data-ref="_M/PDQ_CMD_RX_ALIGNMENT">PDQ_CMD_RX_ALIGNMENT</a>);</td></tr>
<tr><th id="505">505</th><td>    <b>if</b> (<a class="local col3 ref" href="#43cmdlen" title='cmdlen' data-ref="43cmdlen" data-ref-filename="43cmdlen">cmdlen</a> &lt; <a class="local col4 ref" href="#44rsplen" title='rsplen' data-ref="44rsplen" data-ref-filename="44rsplen">rsplen</a>)</td></tr>
<tr><th id="506">506</th><td>	<a class="local col3 ref" href="#43cmdlen" title='cmdlen' data-ref="43cmdlen" data-ref-filename="43cmdlen">cmdlen</a> = <a class="local col4 ref" href="#44rsplen" title='rsplen' data-ref="44rsplen" data-ref-filename="44rsplen">rsplen</a>;</td></tr>
<tr><th id="507">507</th><td>    <i>/*</i></td></tr>
<tr><th id="508">508</th><td><i>     * Since only one command at a time will be queued, there will always</i></td></tr>
<tr><th id="509">509</th><td><i>     * be enough space.</i></td></tr>
<tr><th id="510">510</th><td><i>     */</i></td></tr>
<tr><th id="511">511</th><td></td></tr>
<tr><th id="512">512</th><td>    <i>/*</i></td></tr>
<tr><th id="513">513</th><td><i>     * Obtain and fill in the descriptor for the command (descriptor is</i></td></tr>
<tr><th id="514">514</th><td><i>     * pre-initialized)</i></td></tr>
<tr><th id="515">515</th><td><i>     */</i></td></tr>
<tr><th id="516">516</th><td>    <a class="local col1 ref" href="#41txd" title='txd' data-ref="41txd" data-ref-filename="41txd">txd</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::txd_pa_hi" title='(anonymous struct)::txd_pa_hi' data-ref="(anonymous)::txd_pa_hi" data-ref-filename="(anonymous)..txd_pa_hi">txd_pa_hi</a> =</td></tr>
<tr><th id="517">517</th><td>	<span class='error' title="implicit declaration of function &apos;htole32&apos; is invalid in C99"><span class='error' title="this function declaration is not a prototype"><a class="ref fn" href="#517" title='htole32' data-ref="htole32" data-ref-filename="htole32">htole32</a></span></span>(<a class="macro" href="pdqreg.h.html#305" title="(((cmdlen) &amp; 0x1fff) &lt;&lt; 16)" data-ref="_M/PDQ_TXDESC_SEG_LEN">PDQ_TXDESC_SEG_LEN</a>(<a class="local col3 ref" href="#43cmdlen" title='cmdlen' data-ref="43cmdlen" data-ref-filename="43cmdlen">cmdlen</a>)|<a class="macro" href="pdqreg.h.html#307" title="0x40000000" data-ref="_M/PDQ_TXDESC_EOP">PDQ_TXDESC_EOP</a>|<a class="macro" href="pdqreg.h.html#308" title="0x80000000" data-ref="_M/PDQ_TXDESC_SOP">PDQ_TXDESC_SOP</a>);</td></tr>
<tr><th id="518">518</th><td></td></tr>
<tr><th id="519">519</th><td>    <i>/*</i></td></tr>
<tr><th id="520">520</th><td><i>     * Clear the command area, set the opcode, and the command from the pending</i></td></tr>
<tr><th id="521">521</th><td><i>     * mask.</i></td></tr>
<tr><th id="522">522</th><td><i>     */</i></td></tr>
<tr><th id="523">523</th><td></td></tr>
<tr><th id="524">524</th><td>    <a class="local col9 ref" href="#39ci" title='ci' data-ref="39ci" data-ref-filename="39ci">ci</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_queued_commands" title='(anonymous struct)::ci_queued_commands' data-ref="(anonymous)::ci_queued_commands" data-ref-filename="(anonymous)..ci_queued_commands">ci_queued_commands</a>[<a class="local col9 ref" href="#39ci" title='ci' data-ref="39ci" data-ref-filename="39ci">ci</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_request_producer" title='(anonymous struct)::ci_request_producer' data-ref="(anonymous)::ci_request_producer" data-ref-filename="(anonymous)..ci_request_producer">ci_request_producer</a>] = <a class="local col2 ref" href="#42op" title='op' data-ref="42op" data-ref-filename="42op">op</a>;</td></tr>
<tr><th id="525">525</th><td><u>#<span data-ppcond="525">if</span> defined(<span class="macro" data-ref="_M/PDQVERBOSE">PDQVERBOSE</span>)</u></td></tr>
<tr><th id="526">526</th><td>    ((pdq_response_generic_t *) ci-&gt;ci_response_bufstart)-&gt;generic_op =</td></tr>
<tr><th id="527">527</th><td>	htole32(PDQC_BOGUS_CMD);</td></tr>
<tr><th id="528">528</th><td><u>#<span data-ppcond="525">endif</span></u></td></tr>
<tr><th id="529">529</th><td>    <span class='error' title="implicit declaration of function &apos;PDQ_OS_MEMZERO&apos; is invalid in C99"><span class='error' title="this function declaration is not a prototype"><a class="ref fn" href="#529" title='PDQ_OS_MEMZERO' data-ref="PDQ_OS_MEMZERO" data-ref-filename="PDQ_OS_MEMZERO">PDQ_OS_MEMZERO</a></span></span>(<a class="local col9 ref" href="#39ci" title='ci' data-ref="39ci" data-ref-filename="39ci">ci</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_request_bufstart" title='(anonymous struct)::ci_request_bufstart' data-ref="(anonymous)::ci_request_bufstart" data-ref-filename="(anonymous)..ci_request_bufstart">ci_request_bufstart</a>, <a class="local col3 ref" href="#43cmdlen" title='cmdlen' data-ref="43cmdlen" data-ref-filename="43cmdlen">cmdlen</a>);</td></tr>
<tr><th id="530">530</th><td>    *(<a class="typedef" href="pdqvar.h.html#pdq_uint32_t" title='pdq_uint32_t' data-type='unsigned int' data-ref="pdq_uint32_t" data-ref-filename="pdq_uint32_t">pdq_uint32_t</a> *) <a class="local col9 ref" href="#39ci" title='ci' data-ref="39ci" data-ref-filename="39ci">ci</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_request_bufstart" title='(anonymous struct)::ci_request_bufstart' data-ref="(anonymous)::ci_request_bufstart" data-ref-filename="(anonymous)..ci_request_bufstart">ci_request_bufstart</a> = <a class="ref fn" href="#517" title='htole32' data-ref="htole32" data-ref-filename="htole32">htole32</a>(<a class="local col2 ref" href="#42op" title='op' data-ref="42op" data-ref-filename="42op">op</a>);</td></tr>
<tr><th id="531">531</th><td>    <a class="local col9 ref" href="#39ci" title='ci' data-ref="39ci" data-ref-filename="39ci">ci</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_pending_commands" title='(anonymous struct)::ci_pending_commands' data-ref="(anonymous)::ci_pending_commands" data-ref-filename="(anonymous)..ci_pending_commands">ci_pending_commands</a> &amp;= ~<a class="local col5 ref" href="#45mask" title='mask' data-ref="45mask" data-ref-filename="45mask">mask</a>;</td></tr>
<tr><th id="532">532</th><td></td></tr>
<tr><th id="533">533</th><td>    <i>/*</i></td></tr>
<tr><th id="534">534</th><td><i>     * Fill in the command area, if needed.</i></td></tr>
<tr><th id="535">535</th><td><i>     */</i></td></tr>
<tr><th id="536">536</th><td>    <b>switch</b> (<a class="local col2 ref" href="#42op" title='op' data-ref="42op" data-ref-filename="42op">op</a>) {</td></tr>
<tr><th id="537">537</th><td>	<b>case</b> <a class="enum" href="pdqreg.h.html#PDQC_FILTER_SET" title='PDQC_FILTER_SET' data-ref="PDQC_FILTER_SET" data-ref-filename="PDQC_FILTER_SET">PDQC_FILTER_SET</a>: {</td></tr>
<tr><th id="538">538</th><td>	    <a class="typedef" href="pdqreg.h.html#pdq_cmd_filter_set_t" title='pdq_cmd_filter_set_t' data-type='struct pdq_cmd_filter_set_t' data-ref="pdq_cmd_filter_set_t" data-ref-filename="pdq_cmd_filter_set_t">pdq_cmd_filter_set_t</a> *<dfn class="local col6 decl" id="46filter_set" title='filter_set' data-type='pdq_cmd_filter_set_t *' data-ref="46filter_set" data-ref-filename="46filter_set">filter_set</dfn> = (<a class="typedef" href="pdqreg.h.html#pdq_cmd_filter_set_t" title='pdq_cmd_filter_set_t' data-type='struct pdq_cmd_filter_set_t' data-ref="pdq_cmd_filter_set_t" data-ref-filename="pdq_cmd_filter_set_t">pdq_cmd_filter_set_t</a> *) <a class="local col9 ref" href="#39ci" title='ci' data-ref="39ci" data-ref-filename="39ci">ci</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_request_bufstart" title='(anonymous struct)::ci_request_bufstart' data-ref="(anonymous)::ci_request_bufstart" data-ref-filename="(anonymous)..ci_request_bufstart">ci_request_bufstart</a>;</td></tr>
<tr><th id="539">539</th><td>	    <em>unsigned</em> <dfn class="local col7 decl" id="47idx" title='idx' data-type='unsigned int' data-ref="47idx" data-ref-filename="47idx">idx</dfn> = <var>0</var>;</td></tr>
<tr><th id="540">540</th><td>	    <a class="local col6 ref" href="#46filter_set" title='filter_set' data-ref="46filter_set" data-ref-filename="46filter_set">filter_set</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::filter_set_items" title='(anonymous struct)::filter_set_items' data-ref="(anonymous)::filter_set_items" data-ref-filename="(anonymous)..filter_set_items">filter_set_items</a>[<a class="local col7 ref" href="#47idx" title='idx' data-ref="47idx" data-ref-filename="47idx">idx</a>].<a class="ref field" href="pdqreg.h.html#(anonymousstruct)::(anonymous)::item_code" title='(anonymous struct)::(anonymous struct)::item_code' data-ref="(anonymousstruct)::(anonymous)::item_code" data-ref-filename="(anonymousstruct)..(anonymous)..item_code">item_code</a> =</td></tr>
<tr><th id="541">541</th><td>		<a class="ref fn" href="#517" title='htole32' data-ref="htole32" data-ref-filename="htole32">htole32</a>(<a class="enum" href="pdqreg.h.html#PDQI_IND_GROUP_PROM" title='PDQI_IND_GROUP_PROM' data-ref="PDQI_IND_GROUP_PROM" data-ref-filename="PDQI_IND_GROUP_PROM">PDQI_IND_GROUP_PROM</a>);</td></tr>
<tr><th id="542">542</th><td>	    <a class="local col6 ref" href="#46filter_set" title='filter_set' data-ref="46filter_set" data-ref-filename="46filter_set">filter_set</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::filter_set_items" title='(anonymous struct)::filter_set_items' data-ref="(anonymous)::filter_set_items" data-ref-filename="(anonymous)..filter_set_items">filter_set_items</a>[<a class="local col7 ref" href="#47idx" title='idx' data-ref="47idx" data-ref-filename="47idx">idx</a>].<a class="ref field" href="pdqreg.h.html#(anonymousstruct)::(anonymous)::filter_state" title='(anonymous struct)::(anonymous struct)::filter_state' data-ref="(anonymousstruct)::(anonymous)::filter_state" data-ref-filename="(anonymousstruct)..(anonymous)..filter_state">filter_state</a> =</td></tr>
<tr><th id="543">543</th><td>		<a class="ref fn" href="#517" title='htole32' data-ref="htole32" data-ref-filename="htole32">htole32</a>(<a class="local col7 ref" href="#37pdq" title='pdq' data-ref="37pdq" data-ref-filename="37pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_flags" title='_pdq_t::pdq_flags' data-ref="_pdq_t::pdq_flags" data-ref-filename="_pdq_t..pdq_flags">pdq_flags</a> &amp; <a class="macro" href="pdqreg.h.html#459" title="0x0001" data-ref="_M/PDQ_PROMISC">PDQ_PROMISC</a> ? <a class="enum" href="pdqreg.h.html#PDQ_FILTER_PASS" title='PDQ_FILTER_PASS' data-ref="PDQ_FILTER_PASS" data-ref-filename="PDQ_FILTER_PASS">PDQ_FILTER_PASS</a> : <a class="enum" href="pdqreg.h.html#PDQ_FILTER_BLOCK" title='PDQ_FILTER_BLOCK' data-ref="PDQ_FILTER_BLOCK" data-ref-filename="PDQ_FILTER_BLOCK">PDQ_FILTER_BLOCK</a>);</td></tr>
<tr><th id="544">544</th><td>	    <a class="local col7 ref" href="#47idx" title='idx' data-ref="47idx" data-ref-filename="47idx">idx</a>++;</td></tr>
<tr><th id="545">545</th><td>	    <a class="local col6 ref" href="#46filter_set" title='filter_set' data-ref="46filter_set" data-ref-filename="46filter_set">filter_set</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::filter_set_items" title='(anonymous struct)::filter_set_items' data-ref="(anonymous)::filter_set_items" data-ref-filename="(anonymous)..filter_set_items">filter_set_items</a>[<a class="local col7 ref" href="#47idx" title='idx' data-ref="47idx" data-ref-filename="47idx">idx</a>].<a class="ref field" href="pdqreg.h.html#(anonymousstruct)::(anonymous)::item_code" title='(anonymous struct)::(anonymous struct)::item_code' data-ref="(anonymousstruct)::(anonymous)::item_code" data-ref-filename="(anonymousstruct)..(anonymous)..item_code">item_code</a> =</td></tr>
<tr><th id="546">546</th><td>		<a class="ref fn" href="#517" title='htole32' data-ref="htole32" data-ref-filename="htole32">htole32</a>(<a class="enum" href="pdqreg.h.html#PDQI_GROUP_PROM" title='PDQI_GROUP_PROM' data-ref="PDQI_GROUP_PROM" data-ref-filename="PDQI_GROUP_PROM">PDQI_GROUP_PROM</a>);</td></tr>
<tr><th id="547">547</th><td>	    <a class="local col6 ref" href="#46filter_set" title='filter_set' data-ref="46filter_set" data-ref-filename="46filter_set">filter_set</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::filter_set_items" title='(anonymous struct)::filter_set_items' data-ref="(anonymous)::filter_set_items" data-ref-filename="(anonymous)..filter_set_items">filter_set_items</a>[<a class="local col7 ref" href="#47idx" title='idx' data-ref="47idx" data-ref-filename="47idx">idx</a>].<a class="ref field" href="pdqreg.h.html#(anonymousstruct)::(anonymous)::filter_state" title='(anonymous struct)::(anonymous struct)::filter_state' data-ref="(anonymousstruct)::(anonymous)::filter_state" data-ref-filename="(anonymousstruct)..(anonymous)..filter_state">filter_state</a> =</td></tr>
<tr><th id="548">548</th><td>		<a class="ref fn" href="#517" title='htole32' data-ref="htole32" data-ref-filename="htole32">htole32</a>(<a class="local col7 ref" href="#37pdq" title='pdq' data-ref="37pdq" data-ref-filename="37pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_flags" title='_pdq_t::pdq_flags' data-ref="_pdq_t::pdq_flags" data-ref-filename="_pdq_t..pdq_flags">pdq_flags</a> &amp; <a class="macro" href="pdqreg.h.html#460" title="0x0002" data-ref="_M/PDQ_ALLMULTI">PDQ_ALLMULTI</a> ? <a class="enum" href="pdqreg.h.html#PDQ_FILTER_PASS" title='PDQ_FILTER_PASS' data-ref="PDQ_FILTER_PASS" data-ref-filename="PDQ_FILTER_PASS">PDQ_FILTER_PASS</a> : <a class="enum" href="pdqreg.h.html#PDQ_FILTER_BLOCK" title='PDQ_FILTER_BLOCK' data-ref="PDQ_FILTER_BLOCK" data-ref-filename="PDQ_FILTER_BLOCK">PDQ_FILTER_BLOCK</a>);</td></tr>
<tr><th id="549">549</th><td>	    <a class="local col7 ref" href="#47idx" title='idx' data-ref="47idx" data-ref-filename="47idx">idx</a>++;</td></tr>
<tr><th id="550">550</th><td>	    <a class="local col6 ref" href="#46filter_set" title='filter_set' data-ref="46filter_set" data-ref-filename="46filter_set">filter_set</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::filter_set_items" title='(anonymous struct)::filter_set_items' data-ref="(anonymous)::filter_set_items" data-ref-filename="(anonymous)..filter_set_items">filter_set_items</a>[<a class="local col7 ref" href="#47idx" title='idx' data-ref="47idx" data-ref-filename="47idx">idx</a>].<a class="ref field" href="pdqreg.h.html#(anonymousstruct)::(anonymous)::item_code" title='(anonymous struct)::(anonymous struct)::item_code' data-ref="(anonymousstruct)::(anonymous)::item_code" data-ref-filename="(anonymousstruct)..(anonymous)..item_code">item_code</a> =</td></tr>
<tr><th id="551">551</th><td>		<a class="ref fn" href="#517" title='htole32' data-ref="htole32" data-ref-filename="htole32">htole32</a>(<a class="enum" href="pdqreg.h.html#PDQI_SMT_PROM" title='PDQI_SMT_PROM' data-ref="PDQI_SMT_PROM" data-ref-filename="PDQI_SMT_PROM">PDQI_SMT_PROM</a>);</td></tr>
<tr><th id="552">552</th><td>	    <a class="local col6 ref" href="#46filter_set" title='filter_set' data-ref="46filter_set" data-ref-filename="46filter_set">filter_set</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::filter_set_items" title='(anonymous struct)::filter_set_items' data-ref="(anonymous)::filter_set_items" data-ref-filename="(anonymous)..filter_set_items">filter_set_items</a>[<a class="local col7 ref" href="#47idx" title='idx' data-ref="47idx" data-ref-filename="47idx">idx</a>].<a class="ref field" href="pdqreg.h.html#(anonymousstruct)::(anonymous)::filter_state" title='(anonymous struct)::(anonymous struct)::filter_state' data-ref="(anonymousstruct)::(anonymous)::filter_state" data-ref-filename="(anonymousstruct)..(anonymous)..filter_state">filter_state</a> =</td></tr>
<tr><th id="553">553</th><td>		<a class="ref fn" href="#517" title='htole32' data-ref="htole32" data-ref-filename="htole32">htole32</a>((<a class="local col7 ref" href="#37pdq" title='pdq' data-ref="37pdq" data-ref-filename="37pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_flags" title='_pdq_t::pdq_flags' data-ref="_pdq_t::pdq_flags" data-ref-filename="_pdq_t..pdq_flags">pdq_flags</a> &amp; (<a class="macro" href="pdqreg.h.html#459" title="0x0001" data-ref="_M/PDQ_PROMISC">PDQ_PROMISC</a>|<a class="macro" href="pdqreg.h.html#461" title="0x0004" data-ref="_M/PDQ_PASS_SMT">PDQ_PASS_SMT</a>)) == (<a class="macro" href="pdqreg.h.html#459" title="0x0001" data-ref="_M/PDQ_PROMISC">PDQ_PROMISC</a>|<a class="macro" href="pdqreg.h.html#461" title="0x0004" data-ref="_M/PDQ_PASS_SMT">PDQ_PASS_SMT</a>) ? <a class="enum" href="pdqreg.h.html#PDQ_FILTER_PASS" title='PDQ_FILTER_PASS' data-ref="PDQ_FILTER_PASS" data-ref-filename="PDQ_FILTER_PASS">PDQ_FILTER_PASS</a> : <a class="enum" href="pdqreg.h.html#PDQ_FILTER_BLOCK" title='PDQ_FILTER_BLOCK' data-ref="PDQ_FILTER_BLOCK" data-ref-filename="PDQ_FILTER_BLOCK">PDQ_FILTER_BLOCK</a>);</td></tr>
<tr><th id="554">554</th><td>	    <a class="local col7 ref" href="#47idx" title='idx' data-ref="47idx" data-ref-filename="47idx">idx</a>++;</td></tr>
<tr><th id="555">555</th><td>	    <a class="local col6 ref" href="#46filter_set" title='filter_set' data-ref="46filter_set" data-ref-filename="46filter_set">filter_set</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::filter_set_items" title='(anonymous struct)::filter_set_items' data-ref="(anonymous)::filter_set_items" data-ref-filename="(anonymous)..filter_set_items">filter_set_items</a>[<a class="local col7 ref" href="#47idx" title='idx' data-ref="47idx" data-ref-filename="47idx">idx</a>].<a class="ref field" href="pdqreg.h.html#(anonymousstruct)::(anonymous)::item_code" title='(anonymous struct)::(anonymous struct)::item_code' data-ref="(anonymousstruct)::(anonymous)::item_code" data-ref-filename="(anonymousstruct)..(anonymous)..item_code">item_code</a> =</td></tr>
<tr><th id="556">556</th><td>		<a class="ref fn" href="#517" title='htole32' data-ref="htole32" data-ref-filename="htole32">htole32</a>(<a class="enum" href="pdqreg.h.html#PDQI_SMT_USER" title='PDQI_SMT_USER' data-ref="PDQI_SMT_USER" data-ref-filename="PDQI_SMT_USER">PDQI_SMT_USER</a>);</td></tr>
<tr><th id="557">557</th><td>	    <a class="local col6 ref" href="#46filter_set" title='filter_set' data-ref="46filter_set" data-ref-filename="46filter_set">filter_set</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::filter_set_items" title='(anonymous struct)::filter_set_items' data-ref="(anonymous)::filter_set_items" data-ref-filename="(anonymous)..filter_set_items">filter_set_items</a>[<a class="local col7 ref" href="#47idx" title='idx' data-ref="47idx" data-ref-filename="47idx">idx</a>].<a class="ref field" href="pdqreg.h.html#(anonymousstruct)::(anonymous)::filter_state" title='(anonymous struct)::(anonymous struct)::filter_state' data-ref="(anonymousstruct)::(anonymous)::filter_state" data-ref-filename="(anonymousstruct)..(anonymous)..filter_state">filter_state</a> =</td></tr>
<tr><th id="558">558</th><td>		<a class="ref fn" href="#517" title='htole32' data-ref="htole32" data-ref-filename="htole32">htole32</a>((<a class="local col7 ref" href="#37pdq" title='pdq' data-ref="37pdq" data-ref-filename="37pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_flags" title='_pdq_t::pdq_flags' data-ref="_pdq_t::pdq_flags" data-ref-filename="_pdq_t..pdq_flags">pdq_flags</a> &amp; <a class="macro" href="pdqreg.h.html#461" title="0x0004" data-ref="_M/PDQ_PASS_SMT">PDQ_PASS_SMT</a>) ? <a class="enum" href="pdqreg.h.html#PDQ_FILTER_PASS" title='PDQ_FILTER_PASS' data-ref="PDQ_FILTER_PASS" data-ref-filename="PDQ_FILTER_PASS">PDQ_FILTER_PASS</a> : <a class="enum" href="pdqreg.h.html#PDQ_FILTER_BLOCK" title='PDQ_FILTER_BLOCK' data-ref="PDQ_FILTER_BLOCK" data-ref-filename="PDQ_FILTER_BLOCK">PDQ_FILTER_BLOCK</a>);</td></tr>
<tr><th id="559">559</th><td>	    <a class="local col7 ref" href="#47idx" title='idx' data-ref="47idx" data-ref-filename="47idx">idx</a>++;</td></tr>
<tr><th id="560">560</th><td>	    <a class="local col6 ref" href="#46filter_set" title='filter_set' data-ref="46filter_set" data-ref-filename="46filter_set">filter_set</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::filter_set_items" title='(anonymous struct)::filter_set_items' data-ref="(anonymous)::filter_set_items" data-ref-filename="(anonymous)..filter_set_items">filter_set_items</a>[<a class="local col7 ref" href="#47idx" title='idx' data-ref="47idx" data-ref-filename="47idx">idx</a>].<a class="ref field" href="pdqreg.h.html#(anonymousstruct)::(anonymous)::item_code" title='(anonymous struct)::(anonymous struct)::item_code' data-ref="(anonymousstruct)::(anonymous)::item_code" data-ref-filename="(anonymousstruct)..(anonymous)..item_code">item_code</a> =</td></tr>
<tr><th id="561">561</th><td>		<a class="ref fn" href="#517" title='htole32' data-ref="htole32" data-ref-filename="htole32">htole32</a>(<a class="enum" href="pdqreg.h.html#PDQI_EOL" title='PDQI_EOL' data-ref="PDQI_EOL" data-ref-filename="PDQI_EOL">PDQI_EOL</a>);</td></tr>
<tr><th id="562">562</th><td>	    <b>break</b>;</td></tr>
<tr><th id="563">563</th><td>	}</td></tr>
<tr><th id="564">564</th><td>	<b>case</b> <a class="enum" href="pdqreg.h.html#PDQC_ADDR_FILTER_SET" title='PDQC_ADDR_FILTER_SET' data-ref="PDQC_ADDR_FILTER_SET" data-ref-filename="PDQC_ADDR_FILTER_SET">PDQC_ADDR_FILTER_SET</a>: {</td></tr>
<tr><th id="565">565</th><td>	    <a class="typedef" href="pdqreg.h.html#pdq_cmd_addr_filter_set_t" title='pdq_cmd_addr_filter_set_t' data-type='struct pdq_cmd_addr_filter_set_t' data-ref="pdq_cmd_addr_filter_set_t" data-ref-filename="pdq_cmd_addr_filter_set_t">pdq_cmd_addr_filter_set_t</a> *<dfn class="local col8 decl" id="48addr_filter_set" title='addr_filter_set' data-type='pdq_cmd_addr_filter_set_t *' data-ref="48addr_filter_set" data-ref-filename="48addr_filter_set">addr_filter_set</dfn> = (<a class="typedef" href="pdqreg.h.html#pdq_cmd_addr_filter_set_t" title='pdq_cmd_addr_filter_set_t' data-type='struct pdq_cmd_addr_filter_set_t' data-ref="pdq_cmd_addr_filter_set_t" data-ref-filename="pdq_cmd_addr_filter_set_t">pdq_cmd_addr_filter_set_t</a> *) <a class="local col9 ref" href="#39ci" title='ci' data-ref="39ci" data-ref-filename="39ci">ci</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_request_bufstart" title='(anonymous struct)::ci_request_bufstart' data-ref="(anonymous)::ci_request_bufstart" data-ref-filename="(anonymous)..ci_request_bufstart">ci_request_bufstart</a>;</td></tr>
<tr><th id="566">566</th><td>	    <a class="typedef" href="pdqvar.h.html#pdq_lanaddr_t" title='pdq_lanaddr_t' data-type='struct _pdq_lanaddr_t' data-ref="pdq_lanaddr_t" data-ref-filename="pdq_lanaddr_t">pdq_lanaddr_t</a> *<dfn class="local col9 decl" id="49addr" title='addr' data-type='pdq_lanaddr_t *' data-ref="49addr" data-ref-filename="49addr">addr</dfn> = <a class="local col8 ref" href="#48addr_filter_set" title='addr_filter_set' data-ref="48addr_filter_set" data-ref-filename="48addr_filter_set">addr_filter_set</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::addr_filter_set_addresses" title='(anonymous struct)::addr_filter_set_addresses' data-ref="(anonymous)::addr_filter_set_addresses" data-ref-filename="(anonymous)..addr_filter_set_addresses">addr_filter_set_addresses</a>;</td></tr>
<tr><th id="567">567</th><td>	    <a class="local col9 ref" href="#49addr" title='addr' data-ref="49addr" data-ref-filename="49addr">addr</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_lanaddr_t::lanaddr_bytes" title='_pdq_lanaddr_t::lanaddr_bytes' data-ref="_pdq_lanaddr_t::lanaddr_bytes" data-ref-filename="_pdq_lanaddr_t..lanaddr_bytes">lanaddr_bytes</a>[<var>0</var>] = <var>0xFF</var>;</td></tr>
<tr><th id="568">568</th><td>	    <a class="local col9 ref" href="#49addr" title='addr' data-ref="49addr" data-ref-filename="49addr">addr</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_lanaddr_t::lanaddr_bytes" title='_pdq_lanaddr_t::lanaddr_bytes' data-ref="_pdq_lanaddr_t::lanaddr_bytes" data-ref-filename="_pdq_lanaddr_t..lanaddr_bytes">lanaddr_bytes</a>[<var>1</var>] = <var>0xFF</var>;</td></tr>
<tr><th id="569">569</th><td>	    <a class="local col9 ref" href="#49addr" title='addr' data-ref="49addr" data-ref-filename="49addr">addr</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_lanaddr_t::lanaddr_bytes" title='_pdq_lanaddr_t::lanaddr_bytes' data-ref="_pdq_lanaddr_t::lanaddr_bytes" data-ref-filename="_pdq_lanaddr_t..lanaddr_bytes">lanaddr_bytes</a>[<var>2</var>] = <var>0xFF</var>;</td></tr>
<tr><th id="570">570</th><td>	    <a class="local col9 ref" href="#49addr" title='addr' data-ref="49addr" data-ref-filename="49addr">addr</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_lanaddr_t::lanaddr_bytes" title='_pdq_lanaddr_t::lanaddr_bytes' data-ref="_pdq_lanaddr_t::lanaddr_bytes" data-ref-filename="_pdq_lanaddr_t..lanaddr_bytes">lanaddr_bytes</a>[<var>3</var>] = <var>0xFF</var>;</td></tr>
<tr><th id="571">571</th><td>	    <a class="local col9 ref" href="#49addr" title='addr' data-ref="49addr" data-ref-filename="49addr">addr</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_lanaddr_t::lanaddr_bytes" title='_pdq_lanaddr_t::lanaddr_bytes' data-ref="_pdq_lanaddr_t::lanaddr_bytes" data-ref-filename="_pdq_lanaddr_t..lanaddr_bytes">lanaddr_bytes</a>[<var>4</var>] = <var>0xFF</var>;</td></tr>
<tr><th id="572">572</th><td>	    <a class="local col9 ref" href="#49addr" title='addr' data-ref="49addr" data-ref-filename="49addr">addr</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_lanaddr_t::lanaddr_bytes" title='_pdq_lanaddr_t::lanaddr_bytes' data-ref="_pdq_lanaddr_t::lanaddr_bytes" data-ref-filename="_pdq_lanaddr_t..lanaddr_bytes">lanaddr_bytes</a>[<var>5</var>] = <var>0xFF</var>;</td></tr>
<tr><th id="573">573</th><td>	    <a class="local col9 ref" href="#49addr" title='addr' data-ref="49addr" data-ref-filename="49addr">addr</a>++;</td></tr>
<tr><th id="574">574</th><td>	    <a class="ref fn" href="pdqvar.h.html#pdq_os_addr_fill" title='pdq_os_addr_fill' data-ref="pdq_os_addr_fill" data-ref-filename="pdq_os_addr_fill">pdq_os_addr_fill</a>(<a class="local col7 ref" href="#37pdq" title='pdq' data-ref="37pdq" data-ref-filename="37pdq">pdq</a>, <a class="local col9 ref" href="#49addr" title='addr' data-ref="49addr" data-ref-filename="49addr">addr</a>, <var>61</var>);</td></tr>
<tr><th id="575">575</th><td>	    <b>break</b>;</td></tr>
<tr><th id="576">576</th><td>	}</td></tr>
<tr><th id="577">577</th><td>	<b>case</b> <a class="enum" href="pdqreg.h.html#PDQC_SNMP_SET" title='PDQC_SNMP_SET' data-ref="PDQC_SNMP_SET" data-ref-filename="PDQC_SNMP_SET">PDQC_SNMP_SET</a>: {</td></tr>
<tr><th id="578">578</th><td>	    <a class="typedef" href="pdqreg.h.html#pdq_cmd_snmp_set_t" title='pdq_cmd_snmp_set_t' data-type='struct pdq_cmd_snmp_set_t' data-ref="pdq_cmd_snmp_set_t" data-ref-filename="pdq_cmd_snmp_set_t">pdq_cmd_snmp_set_t</a> *<dfn class="local col0 decl" id="50snmp_set" title='snmp_set' data-type='pdq_cmd_snmp_set_t *' data-ref="50snmp_set" data-ref-filename="50snmp_set">snmp_set</dfn> = (<a class="typedef" href="pdqreg.h.html#pdq_cmd_snmp_set_t" title='pdq_cmd_snmp_set_t' data-type='struct pdq_cmd_snmp_set_t' data-ref="pdq_cmd_snmp_set_t" data-ref-filename="pdq_cmd_snmp_set_t">pdq_cmd_snmp_set_t</a> *) <a class="local col9 ref" href="#39ci" title='ci' data-ref="39ci" data-ref-filename="39ci">ci</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_request_bufstart" title='(anonymous struct)::ci_request_bufstart' data-ref="(anonymous)::ci_request_bufstart" data-ref-filename="(anonymous)..ci_request_bufstart">ci_request_bufstart</a>;</td></tr>
<tr><th id="579">579</th><td>	    <em>unsigned</em> <dfn class="local col1 decl" id="51idx" title='idx' data-type='unsigned int' data-ref="51idx" data-ref-filename="51idx">idx</dfn> = <var>0</var>;</td></tr>
<tr><th id="580">580</th><td>	    <a class="local col0 ref" href="#50snmp_set" title='snmp_set' data-ref="50snmp_set" data-ref-filename="50snmp_set">snmp_set</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::snmp_set_items" title='(anonymous struct)::snmp_set_items' data-ref="(anonymous)::snmp_set_items" data-ref-filename="(anonymous)..snmp_set_items">snmp_set_items</a>[<a class="local col1 ref" href="#51idx" title='idx' data-ref="51idx" data-ref-filename="51idx">idx</a>].<a class="ref field" href="pdqreg.h.html#(anonymousstruct)::(anonymous)::item_code" title='(anonymous struct)::(anonymous struct)::item_code' data-ref="(anonymousstruct)::(anonymous)::item_code" data-ref-filename="(anonymousstruct)..(anonymous)..item_code">item_code</a> = <a class="ref fn" href="#517" title='htole32' data-ref="htole32" data-ref-filename="htole32">htole32</a>(<a class="enum" href="pdqreg.h.html#PDQSNMP_FULL_DUPLEX_ENABLE" title='PDQSNMP_FULL_DUPLEX_ENABLE' data-ref="PDQSNMP_FULL_DUPLEX_ENABLE" data-ref-filename="PDQSNMP_FULL_DUPLEX_ENABLE">PDQSNMP_FULL_DUPLEX_ENABLE</a>);</td></tr>
<tr><th id="581">581</th><td>	    <a class="local col0 ref" href="#50snmp_set" title='snmp_set' data-ref="50snmp_set" data-ref-filename="50snmp_set">snmp_set</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::snmp_set_items" title='(anonymous struct)::snmp_set_items' data-ref="(anonymous)::snmp_set_items" data-ref-filename="(anonymous)..snmp_set_items">snmp_set_items</a>[<a class="local col1 ref" href="#51idx" title='idx' data-ref="51idx" data-ref-filename="51idx">idx</a>].<a class="ref field" href="pdqreg.h.html#(anonymousstruct)::(anonymous)::item_value" title='(anonymous struct)::(anonymous struct)::item_value' data-ref="(anonymousstruct)::(anonymous)::item_value" data-ref-filename="(anonymousstruct)..(anonymous)..item_value">item_value</a> = <a class="ref fn" href="#517" title='htole32' data-ref="htole32" data-ref-filename="htole32">htole32</a>(<a class="local col7 ref" href="#37pdq" title='pdq' data-ref="37pdq" data-ref-filename="37pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_flags" title='_pdq_t::pdq_flags' data-ref="_pdq_t::pdq_flags" data-ref-filename="_pdq_t..pdq_flags">pdq_flags</a> &amp; <a class="macro" href="pdqreg.h.html#465" title="0x0040" data-ref="_M/PDQ_WANT_FDX">PDQ_WANT_FDX</a> ? <var>1</var> : <var>2</var>);</td></tr>
<tr><th id="582">582</th><td>	    <a class="local col0 ref" href="#50snmp_set" title='snmp_set' data-ref="50snmp_set" data-ref-filename="50snmp_set">snmp_set</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::snmp_set_items" title='(anonymous struct)::snmp_set_items' data-ref="(anonymous)::snmp_set_items" data-ref-filename="(anonymous)..snmp_set_items">snmp_set_items</a>[<a class="local col1 ref" href="#51idx" title='idx' data-ref="51idx" data-ref-filename="51idx">idx</a>].<a class="ref field" href="pdqreg.h.html#(anonymousstruct)::(anonymous)::item_port" title='(anonymous struct)::(anonymous struct)::item_port' data-ref="(anonymousstruct)::(anonymous)::item_port" data-ref-filename="(anonymousstruct)..(anonymous)..item_port">item_port</a> = <var>0</var>;</td></tr>
<tr><th id="583">583</th><td>	    <a class="local col1 ref" href="#51idx" title='idx' data-ref="51idx" data-ref-filename="51idx">idx</a>++;</td></tr>
<tr><th id="584">584</th><td>	    <a class="local col0 ref" href="#50snmp_set" title='snmp_set' data-ref="50snmp_set" data-ref-filename="50snmp_set">snmp_set</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::snmp_set_items" title='(anonymous struct)::snmp_set_items' data-ref="(anonymous)::snmp_set_items" data-ref-filename="(anonymous)..snmp_set_items">snmp_set_items</a>[<a class="local col1 ref" href="#51idx" title='idx' data-ref="51idx" data-ref-filename="51idx">idx</a>].<a class="ref field" href="pdqreg.h.html#(anonymousstruct)::(anonymous)::item_code" title='(anonymous struct)::(anonymous struct)::item_code' data-ref="(anonymousstruct)::(anonymous)::item_code" data-ref-filename="(anonymousstruct)..(anonymous)..item_code">item_code</a> = <a class="ref fn" href="#517" title='htole32' data-ref="htole32" data-ref-filename="htole32">htole32</a>(<a class="enum" href="pdqreg.h.html#PDQSNMP_EOL" title='PDQSNMP_EOL' data-ref="PDQSNMP_EOL" data-ref-filename="PDQSNMP_EOL">PDQSNMP_EOL</a>);</td></tr>
<tr><th id="585">585</th><td>	    <b>break</b>;</td></tr>
<tr><th id="586">586</th><td>	}</td></tr>
<tr><th id="587">587</th><td>	<b>default</b>: {	<i>/* to make gcc happy */</i></td></tr>
<tr><th id="588">588</th><td>	    <b>break</b>;</td></tr>
<tr><th id="589">589</th><td>	}</td></tr>
<tr><th id="590">590</th><td>    }</td></tr>
<tr><th id="591">591</th><td></td></tr>
<tr><th id="592">592</th><td></td></tr>
<tr><th id="593">593</th><td>    <i>/*</i></td></tr>
<tr><th id="594">594</th><td><i>     * Sync the command request buffer and descriptor, then advance</i></td></tr>
<tr><th id="595">595</th><td><i>     * the request producer index.</i></td></tr>
<tr><th id="596">596</th><td><i>     */</i></td></tr>
<tr><th id="597">597</th><td>    <a class="macro" href="pdqvar.h.html#481" title="do { } while(0)" data-ref="_M/PDQ_OS_CMDRQST_PRESYNC">PDQ_OS_CMDRQST_PRESYNC</a>(pdq, cmdlen);</td></tr>
<tr><th id="598">598</th><td>    <a class="macro" href="pdqvar.h.html#479" title="do { } while(0)" data-ref="_M/PDQ_OS_DESC_PRESYNC">PDQ_OS_DESC_PRESYNC</a>(pdq, txd, <b>sizeof</b>(pdq_txdesc_t));</td></tr>
<tr><th id="599">599</th><td>    <a class="macro" href="pdqreg.h.html#419" title="((ci-&gt;ci_request_producer) = ((ci-&gt;ci_request_producer) + (1)) &amp; ((((sizeof(dbp-&gt;pdqdb_command_requests) / sizeof(dbp-&gt;pdqdb_command_requests[0]))) - 1)))" data-ref="_M/PDQ_ADVANCE">PDQ_ADVANCE</a>(<a class="local col9 ref" href="#39ci" title='ci' data-ref="39ci" data-ref-filename="39ci">ci</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_request_producer" title='(anonymous struct)::ci_request_producer' data-ref="(anonymous)::ci_request_producer" data-ref-filename="(anonymous)..ci_request_producer">ci_request_producer</a>, <var>1</var>, <a class="macro" href="pdqreg.h.html#52" title="(((sizeof(dbp-&gt;pdqdb_command_requests) / sizeof(dbp-&gt;pdqdb_command_requests[0]))) - 1)" data-ref="_M/PDQ_RING_MASK">PDQ_RING_MASK</a>(<a class="local col0 ref" href="#40dbp" title='dbp' data-ref="40dbp" data-ref-filename="40dbp">dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_command_requests" title='(anonymous struct)::pdqdb_command_requests' data-ref="(anonymous)::pdqdb_command_requests" data-ref-filename="(anonymous)..pdqdb_command_requests">pdqdb_command_requests</a>));</td></tr>
<tr><th id="600">600</th><td></td></tr>
<tr><th id="601">601</th><td>    <i>/*</i></td></tr>
<tr><th id="602">602</th><td><i>     * Sync the command response buffer and advance the response</i></td></tr>
<tr><th id="603">603</th><td><i>     * producer index (descriptor is already pre-initialized)</i></td></tr>
<tr><th id="604">604</th><td><i>     */</i></td></tr>
<tr><th id="605">605</th><td>    <a class="macro" href="pdqvar.h.html#483" title="do { } while(0)" data-ref="_M/PDQ_OS_CMDRSP_PRESYNC">PDQ_OS_CMDRSP_PRESYNC</a>(pdq, PDQ_SIZE_COMMAND_RESPONSE);</td></tr>
<tr><th id="606">606</th><td>    <a class="macro" href="pdqreg.h.html#419" title="((ci-&gt;ci_response_producer) = ((ci-&gt;ci_response_producer) + (1)) &amp; ((((sizeof(dbp-&gt;pdqdb_command_responses) / sizeof(dbp-&gt;pdqdb_command_responses[0]))) - 1)))" data-ref="_M/PDQ_ADVANCE">PDQ_ADVANCE</a>(<a class="local col9 ref" href="#39ci" title='ci' data-ref="39ci" data-ref-filename="39ci">ci</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_response_producer" title='(anonymous struct)::ci_response_producer' data-ref="(anonymous)::ci_response_producer" data-ref-filename="(anonymous)..ci_response_producer">ci_response_producer</a>, <var>1</var>, <a class="macro" href="pdqreg.h.html#52" title="(((sizeof(dbp-&gt;pdqdb_command_responses) / sizeof(dbp-&gt;pdqdb_command_responses[0]))) - 1)" data-ref="_M/PDQ_RING_MASK">PDQ_RING_MASK</a>(<a class="local col0 ref" href="#40dbp" title='dbp' data-ref="40dbp" data-ref-filename="40dbp">dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_command_responses" title='(anonymous struct)::pdqdb_command_responses' data-ref="(anonymous)::pdqdb_command_responses" data-ref-filename="(anonymous)..pdqdb_command_responses">pdqdb_command_responses</a>));</td></tr>
<tr><th id="607">607</th><td>    <i>/*</i></td></tr>
<tr><th id="608">608</th><td><i>     * At this point the command is done.  All that needs to be done is to</i></td></tr>
<tr><th id="609">609</th><td><i>     * produce it to the PDQ.</i></td></tr>
<tr><th id="610">610</th><td><i>     */</i></td></tr>
<tr><th id="611">611</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"PDQ Queue Command Request: %s queued\n"</q>,</td></tr>
<tr><th id="612">612</th><td>		pdq_cmd_info[op].cmd_name));</td></tr>
<tr><th id="613">613</th><td></td></tr>
<tr><th id="614">614</th><td>    <a class="local col9 ref" href="#39ci" title='ci' data-ref="39ci" data-ref-filename="39ci">ci</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_command_active" title='(anonymous struct)::ci_command_active' data-ref="(anonymous)::ci_command_active" data-ref-filename="(anonymous)..ci_command_active">ci_command_active</a>++;</td></tr>
<tr><th id="615">615</th><td>    <span class='error' title="implicit declaration of function &apos;PDQ_CSR_WRITE&apos; is invalid in C99">PDQ_CSR_WRITE</span>(csrs, <span class='error' title="use of undeclared identifier &apos;csr_cmd_response_producer&apos;">csr_cmd_response_producer</span>, ci-&gt;ci_response_producer | (ci-&gt;ci_response_completion &lt;&lt; <var>8</var>));</td></tr>
<tr><th id="616">616</th><td>    PDQ_CSR_WRITE(csrs, <span class='error' title="use of undeclared identifier &apos;csr_cmd_request_producer&apos;">csr_cmd_request_producer</span>, ci-&gt;ci_request_producer | (ci-&gt;ci_request_completion &lt;&lt; <var>8</var>));</td></tr>
<tr><th id="617">617</th><td>}</td></tr>
<tr><th id="618">618</th><td></td></tr>
<tr><th id="619">619</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="620">620</th><td><dfn class="tu decl def fn" id="pdq_process_command_responses" title='pdq_process_command_responses' data-type='void pdq_process_command_responses(pdq_t *const pdq)' data-ref="pdq_process_command_responses" data-ref-filename="pdq_process_command_responses">pdq_process_command_responses</dfn>(</td></tr>
<tr><th id="621">621</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_t" title='pdq_t' data-type='struct _pdq_t' data-ref="pdq_t" data-ref-filename="pdq_t">pdq_t</a> * <em>const</em> <dfn class="local col2 decl" id="52pdq" title='pdq' data-type='pdq_t *const' data-ref="52pdq" data-ref-filename="52pdq">pdq</dfn>)</td></tr>
<tr><th id="622">622</th><td>{</td></tr>
<tr><th id="623">623</th><td>    <em>const</em> <a class="typedef" href="pdqvar.h.html#pdq_csrs_t" title='pdq_csrs_t' data-type='struct _pdq_csrs_t' data-ref="pdq_csrs_t" data-ref-filename="pdq_csrs_t">pdq_csrs_t</a> * <em>const</em> <dfn class="local col3 decl" id="53csrs" title='csrs' data-type='const pdq_csrs_t *const' data-ref="53csrs" data-ref-filename="53csrs">csrs</dfn> = &amp;pdq-&gt;pdq_csrs;</td></tr>
<tr><th id="624">624</th><td>    <a class="typedef" href="pdqreg.h.html#pdq_command_info_t" title='pdq_command_info_t' data-type='struct pdq_command_info_t' data-ref="pdq_command_info_t" data-ref-filename="pdq_command_info_t">pdq_command_info_t</a> * <em>const</em> <dfn class="local col4 decl" id="54ci" title='ci' data-type='pdq_command_info_t *const' data-ref="54ci" data-ref-filename="54ci">ci</dfn> = &amp;<a class="local col2 ref" href="#52pdq" title='pdq' data-ref="52pdq" data-ref-filename="52pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_command_info" title='_pdq_t::pdq_command_info' data-ref="_pdq_t::pdq_command_info" data-ref-filename="_pdq_t..pdq_command_info">pdq_command_info</a>;</td></tr>
<tr><th id="625">625</th><td>    <em>volatile</em> <em>const</em> <a class="typedef" href="pdqreg.h.html#pdq_consumer_block_t" title='pdq_consumer_block_t' data-type='struct pdq_consumer_block_t' data-ref="pdq_consumer_block_t" data-ref-filename="pdq_consumer_block_t">pdq_consumer_block_t</a> * <em>const</em> <dfn class="local col5 decl" id="55cbp" title='cbp' data-type='const volatile pdq_consumer_block_t *const' data-ref="55cbp" data-ref-filename="55cbp">cbp</dfn> = <a class="local col2 ref" href="#52pdq" title='pdq' data-ref="52pdq" data-ref-filename="52pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_cbp" title='_pdq_t::pdq_cbp' data-ref="_pdq_t::pdq_cbp" data-ref-filename="_pdq_t..pdq_cbp">pdq_cbp</a>;</td></tr>
<tr><th id="626">626</th><td>    <a class="typedef" href="pdqreg.h.html#pdq_descriptor_block_t" title='pdq_descriptor_block_t' data-type='struct pdq_descriptor_block_t' data-ref="pdq_descriptor_block_t" data-ref-filename="pdq_descriptor_block_t">pdq_descriptor_block_t</a> * <em>const</em> <dfn class="local col6 decl" id="56dbp" title='dbp' data-type='pdq_descriptor_block_t *const' data-ref="56dbp" data-ref-filename="56dbp">dbp</dfn> = <a class="local col2 ref" href="#52pdq" title='pdq' data-ref="52pdq" data-ref-filename="52pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_dbp" title='_pdq_t::pdq_dbp' data-ref="_pdq_t::pdq_dbp" data-ref-filename="_pdq_t..pdq_dbp">pdq_dbp</a>;</td></tr>
<tr><th id="627">627</th><td>    <em>const</em> <a class="typedef" href="pdqreg.h.html#pdq_response_generic_t" title='pdq_response_generic_t' data-type='struct pdq_response_generic_t' data-ref="pdq_response_generic_t" data-ref-filename="pdq_response_generic_t">pdq_response_generic_t</a> *<dfn class="local col7 decl" id="57rspgen" title='rspgen' data-type='const pdq_response_generic_t *' data-ref="57rspgen" data-ref-filename="57rspgen">rspgen</dfn>;</td></tr>
<tr><th id="628">628</th><td>    <a class="typedef" href="pdqreg.h.html#pdq_cmd_code_t" title='pdq_cmd_code_t' data-type='enum pdq_cmd_code_t' data-ref="pdq_cmd_code_t" data-ref-filename="pdq_cmd_code_t">pdq_cmd_code_t</a> <dfn class="local col8 decl" id="58op" title='op' data-type='pdq_cmd_code_t' data-ref="58op" data-ref-filename="58op">op</dfn>;</td></tr>
<tr><th id="629">629</th><td>    <a class="typedef" href="pdqreg.h.html#pdq_response_code_t" title='pdq_response_code_t' data-type='enum pdq_response_code_t' data-ref="pdq_response_code_t" data-ref-filename="pdq_response_code_t">pdq_response_code_t</a> <dfn class="local col9 decl" id="59status" title='status' data-type='pdq_response_code_t' data-ref="59status" data-ref-filename="59status">status</dfn> <a class="macro" href="../../sys/cdefs.h.html#263" title="__attribute__((__unused__))" data-ref="_M/__unused">__unused</a>;</td></tr>
<tr><th id="630">630</th><td></td></tr>
<tr><th id="631">631</th><td>    <i>/*</i></td></tr>
<tr><th id="632">632</th><td><i>     * We have to process the command and response in tandem so</i></td></tr>
<tr><th id="633">633</th><td><i>     * just wait for the response to be consumed.  If it has been</i></td></tr>
<tr><th id="634">634</th><td><i>     * consumed then the command must have been as well.</i></td></tr>
<tr><th id="635">635</th><td><i>     */</i></td></tr>
<tr><th id="636">636</th><td></td></tr>
<tr><th id="637">637</th><td>    <b>if</b> (<span class='error' title="implicit declaration of function &apos;le32toh&apos; is invalid in C99"><a class="ref fn" href="#221" title='le32toh' data-ref="le32toh" data-ref-filename="le32toh">le32toh</a></span>(<a class="local col5 ref" href="#55cbp" title='cbp' data-ref="55cbp" data-ref-filename="55cbp">cbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqcb_command_response" title='(anonymous struct)::pdqcb_command_response' data-ref="(anonymous)::pdqcb_command_response" data-ref-filename="(anonymous)..pdqcb_command_response">pdqcb_command_response</a>) == <a class="local col4 ref" href="#54ci" title='ci' data-ref="54ci" data-ref-filename="54ci">ci</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_response_completion" title='(anonymous struct)::ci_response_completion' data-ref="(anonymous)::ci_response_completion" data-ref-filename="(anonymous)..ci_response_completion">ci_response_completion</a>)</td></tr>
<tr><th id="638">638</th><td>	<b>return</b>;</td></tr>
<tr><th id="639">639</th><td></td></tr>
<tr><th id="640">640</th><td>    <a class="macro" href="pdqreg.h.html#47" title="do { } while(0)" data-ref="_M/PDQ_ASSERT">PDQ_ASSERT</a>(le32toh(cbp-&gt;pdqcb_command_request) != ci-&gt;ci_request_completion);</td></tr>
<tr><th id="641">641</th><td></td></tr>
<tr><th id="642">642</th><td>    <a class="macro" href="pdqvar.h.html#484" title="do { } while(0)" data-ref="_M/PDQ_OS_CMDRSP_POSTSYNC">PDQ_OS_CMDRSP_POSTSYNC</a>(pdq, PDQ_SIZE_COMMAND_RESPONSE);</td></tr>
<tr><th id="643">643</th><td>    <a class="local col7 ref" href="#57rspgen" title='rspgen' data-ref="57rspgen" data-ref-filename="57rspgen">rspgen</a> = (<em>const</em> <a class="typedef" href="pdqreg.h.html#pdq_response_generic_t" title='pdq_response_generic_t' data-type='struct pdq_response_generic_t' data-ref="pdq_response_generic_t" data-ref-filename="pdq_response_generic_t">pdq_response_generic_t</a> *) <a class="local col4 ref" href="#54ci" title='ci' data-ref="54ci" data-ref-filename="54ci">ci</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_response_bufstart" title='(anonymous struct)::ci_response_bufstart' data-ref="(anonymous)::ci_response_bufstart" data-ref-filename="(anonymous)..ci_response_bufstart">ci_response_bufstart</a>;</td></tr>
<tr><th id="644">644</th><td>    <a class="local col8 ref" href="#58op" title='op' data-ref="58op" data-ref-filename="58op">op</a> = <a class="ref fn" href="#221" title='le32toh' data-ref="le32toh" data-ref-filename="le32toh">le32toh</a>(<a class="local col7 ref" href="#57rspgen" title='rspgen' data-ref="57rspgen" data-ref-filename="57rspgen">rspgen</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::generic_op" title='(anonymous struct)::generic_op' data-ref="(anonymous)::generic_op" data-ref-filename="(anonymous)..generic_op">generic_op</a>);</td></tr>
<tr><th id="645">645</th><td>    <a class="local col9 ref" href="#59status" title='status' data-ref="59status" data-ref-filename="59status">status</a> = <a class="ref fn" href="#221" title='le32toh' data-ref="le32toh" data-ref-filename="le32toh">le32toh</a>(<a class="local col7 ref" href="#57rspgen" title='rspgen' data-ref="57rspgen" data-ref-filename="57rspgen">rspgen</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::generic_status" title='(anonymous struct)::generic_status' data-ref="(anonymous)::generic_status" data-ref-filename="(anonymous)..generic_status">generic_status</a>);</td></tr>
<tr><th id="646">646</th><td>    <a class="macro" href="pdqreg.h.html#47" title="do { } while(0)" data-ref="_M/PDQ_ASSERT">PDQ_ASSERT</a>(op == ci-&gt;ci_queued_commands[ci-&gt;ci_request_completion]);</td></tr>
<tr><th id="647">647</th><td>    <a class="macro" href="pdqreg.h.html#47" title="do { } while(0)" data-ref="_M/PDQ_ASSERT">PDQ_ASSERT</a>(status == PDQR_SUCCESS);</td></tr>
<tr><th id="648">648</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"PDQ Process Command Response: %s completed (status=%d [0x%x])\n"</q>,</td></tr>
<tr><th id="649">649</th><td>		pdq_cmd_info[op].cmd_name,</td></tr>
<tr><th id="650">650</th><td>		htole32(status),</td></tr>
<tr><th id="651">651</th><td>		htole32(status)));</td></tr>
<tr><th id="652">652</th><td></td></tr>
<tr><th id="653">653</th><td>    <b>if</b> (<a class="local col8 ref" href="#58op" title='op' data-ref="58op" data-ref-filename="58op">op</a> == <a class="enum" href="pdqreg.h.html#PDQC_STATUS_CHARS_GET" title='PDQC_STATUS_CHARS_GET' data-ref="PDQC_STATUS_CHARS_GET" data-ref-filename="PDQC_STATUS_CHARS_GET">PDQC_STATUS_CHARS_GET</a> &amp;&amp; (<a class="local col2 ref" href="#52pdq" title='pdq' data-ref="52pdq" data-ref-filename="52pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_flags" title='_pdq_t::pdq_flags' data-ref="_pdq_t::pdq_flags" data-ref-filename="_pdq_t..pdq_flags">pdq_flags</a> &amp; <a class="macro" href="pdqreg.h.html#463" title="0x0010" data-ref="_M/PDQ_PRINTCHARS">PDQ_PRINTCHARS</a>)) {</td></tr>
<tr><th id="654">654</th><td>	<a class="local col2 ref" href="#52pdq" title='pdq' data-ref="52pdq" data-ref-filename="52pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_flags" title='_pdq_t::pdq_flags' data-ref="_pdq_t::pdq_flags" data-ref-filename="_pdq_t..pdq_flags">pdq_flags</a> &amp;= ~<a class="macro" href="pdqreg.h.html#463" title="0x0010" data-ref="_M/PDQ_PRINTCHARS">PDQ_PRINTCHARS</a>;</td></tr>
<tr><th id="655">655</th><td>	<a class="tu ref fn" href="#pdq_print_fddi_chars" title='pdq_print_fddi_chars' data-use='c' data-ref="pdq_print_fddi_chars" data-ref-filename="pdq_print_fddi_chars">pdq_print_fddi_chars</a>(<a class="local col2 ref" href="#52pdq" title='pdq' data-ref="52pdq" data-ref-filename="52pdq">pdq</a>, (<em>const</em> <a class="typedef" href="pdqreg.h.html#pdq_response_status_chars_get_t" title='pdq_response_status_chars_get_t' data-type='struct pdq_response_status_chars_get_t' data-ref="pdq_response_status_chars_get_t" data-ref-filename="pdq_response_status_chars_get_t">pdq_response_status_chars_get_t</a> *) <a class="local col7 ref" href="#57rspgen" title='rspgen' data-ref="57rspgen" data-ref-filename="57rspgen">rspgen</a>);</td></tr>
<tr><th id="656">656</th><td>    } <b>else</b> <b>if</b> (<a class="local col8 ref" href="#58op" title='op' data-ref="58op" data-ref-filename="58op">op</a> == <a class="enum" href="pdqreg.h.html#PDQC_DEC_EXT_MIB_GET" title='PDQC_DEC_EXT_MIB_GET' data-ref="PDQC_DEC_EXT_MIB_GET" data-ref-filename="PDQC_DEC_EXT_MIB_GET">PDQC_DEC_EXT_MIB_GET</a>) {</td></tr>
<tr><th id="657">657</th><td>	<a class="local col2 ref" href="#52pdq" title='pdq' data-ref="52pdq" data-ref-filename="52pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_flags" title='_pdq_t::pdq_flags' data-ref="_pdq_t::pdq_flags" data-ref-filename="_pdq_t..pdq_flags">pdq_flags</a> &amp;= ~<a class="macro" href="pdqreg.h.html#466" title="0x0080" data-ref="_M/PDQ_IS_FDX">PDQ_IS_FDX</a>;</td></tr>
<tr><th id="658">658</th><td>	<b>if</b> (<a class="ref fn" href="#221" title='le32toh' data-ref="le32toh" data-ref-filename="le32toh">le32toh</a>(((<em>const</em> <a class="typedef" href="pdqreg.h.html#pdq_response_dec_ext_mib_get_t" title='pdq_response_dec_ext_mib_get_t' data-type='struct pdq_response_dec_ext_mib_get_t' data-ref="pdq_response_dec_ext_mib_get_t" data-ref-filename="pdq_response_dec_ext_mib_get_t">pdq_response_dec_ext_mib_get_t</a> *)<a class="local col7 ref" href="#57rspgen" title='rspgen' data-ref="57rspgen" data-ref-filename="57rspgen">rspgen</a>)-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::dec_ext_mib_get" title='(anonymous struct)::dec_ext_mib_get' data-ref="(anonymous)::dec_ext_mib_get" data-ref-filename="(anonymous)..dec_ext_mib_get">dec_ext_mib_get</a>.<a class="ref field" href="pdqreg.h.html#(anonymousstruct)::(anonymous)::fdx_operational" title='(anonymous struct)::(anonymous struct)::fdx_operational' data-ref="(anonymousstruct)::(anonymous)::fdx_operational" data-ref-filename="(anonymousstruct)..(anonymous)..fdx_operational">fdx_operational</a>))</td></tr>
<tr><th id="659">659</th><td>	    <a class="local col2 ref" href="#52pdq" title='pdq' data-ref="52pdq" data-ref-filename="52pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_flags" title='_pdq_t::pdq_flags' data-ref="_pdq_t::pdq_flags" data-ref-filename="_pdq_t..pdq_flags">pdq_flags</a> |= <a class="macro" href="pdqreg.h.html#466" title="0x0080" data-ref="_M/PDQ_IS_FDX">PDQ_IS_FDX</a>;</td></tr>
<tr><th id="660">660</th><td>    }</td></tr>
<tr><th id="661">661</th><td></td></tr>
<tr><th id="662">662</th><td>    <a class="macro" href="pdqreg.h.html#419" title="((ci-&gt;ci_request_completion) = ((ci-&gt;ci_request_completion) + (1)) &amp; ((((sizeof(dbp-&gt;pdqdb_command_requests) / sizeof(dbp-&gt;pdqdb_command_requests[0]))) - 1)))" data-ref="_M/PDQ_ADVANCE">PDQ_ADVANCE</a>(<a class="local col4 ref" href="#54ci" title='ci' data-ref="54ci" data-ref-filename="54ci">ci</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_request_completion" title='(anonymous struct)::ci_request_completion' data-ref="(anonymous)::ci_request_completion" data-ref-filename="(anonymous)..ci_request_completion">ci_request_completion</a>, <var>1</var>, <a class="macro" href="pdqreg.h.html#52" title="(((sizeof(dbp-&gt;pdqdb_command_requests) / sizeof(dbp-&gt;pdqdb_command_requests[0]))) - 1)" data-ref="_M/PDQ_RING_MASK">PDQ_RING_MASK</a>(<a class="local col6 ref" href="#56dbp" title='dbp' data-ref="56dbp" data-ref-filename="56dbp">dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_command_requests" title='(anonymous struct)::pdqdb_command_requests' data-ref="(anonymous)::pdqdb_command_requests" data-ref-filename="(anonymous)..pdqdb_command_requests">pdqdb_command_requests</a>));</td></tr>
<tr><th id="663">663</th><td>    <a class="macro" href="pdqreg.h.html#419" title="((ci-&gt;ci_response_completion) = ((ci-&gt;ci_response_completion) + (1)) &amp; ((((sizeof(dbp-&gt;pdqdb_command_responses) / sizeof(dbp-&gt;pdqdb_command_responses[0]))) - 1)))" data-ref="_M/PDQ_ADVANCE">PDQ_ADVANCE</a>(<a class="local col4 ref" href="#54ci" title='ci' data-ref="54ci" data-ref-filename="54ci">ci</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_response_completion" title='(anonymous struct)::ci_response_completion' data-ref="(anonymous)::ci_response_completion" data-ref-filename="(anonymous)..ci_response_completion">ci_response_completion</a>, <var>1</var>, <a class="macro" href="pdqreg.h.html#52" title="(((sizeof(dbp-&gt;pdqdb_command_responses) / sizeof(dbp-&gt;pdqdb_command_responses[0]))) - 1)" data-ref="_M/PDQ_RING_MASK">PDQ_RING_MASK</a>(<a class="local col6 ref" href="#56dbp" title='dbp' data-ref="56dbp" data-ref-filename="56dbp">dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_command_responses" title='(anonymous struct)::pdqdb_command_responses' data-ref="(anonymous)::pdqdb_command_responses" data-ref-filename="(anonymous)..pdqdb_command_responses">pdqdb_command_responses</a>));</td></tr>
<tr><th id="664">664</th><td>    <a class="local col4 ref" href="#54ci" title='ci' data-ref="54ci" data-ref-filename="54ci">ci</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_command_active" title='(anonymous struct)::ci_command_active' data-ref="(anonymous)::ci_command_active" data-ref-filename="(anonymous)..ci_command_active">ci_command_active</a> = <var>0</var>;</td></tr>
<tr><th id="665">665</th><td></td></tr>
<tr><th id="666">666</th><td>    <b>if</b> (<a class="local col4 ref" href="#54ci" title='ci' data-ref="54ci" data-ref-filename="54ci">ci</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_pending_commands" title='(anonymous struct)::ci_pending_commands' data-ref="(anonymous)::ci_pending_commands" data-ref-filename="(anonymous)..ci_pending_commands">ci_pending_commands</a> != <var>0</var>) {</td></tr>
<tr><th id="667">667</th><td>	<a class="tu ref fn" href="#pdq_queue_commands" title='pdq_queue_commands' data-use='c' data-ref="pdq_queue_commands" data-ref-filename="pdq_queue_commands">pdq_queue_commands</a>(<a class="local col2 ref" href="#52pdq" title='pdq' data-ref="52pdq" data-ref-filename="52pdq">pdq</a>);</td></tr>
<tr><th id="668">668</th><td>    } <b>else</b> {</td></tr>
<tr><th id="669">669</th><td>	<span class='error' title="implicit declaration of function &apos;PDQ_CSR_WRITE&apos; is invalid in C99">PDQ_CSR_WRITE</span>(csrs, <span class='error' title="use of undeclared identifier &apos;csr_cmd_response_producer&apos;">csr_cmd_response_producer</span>,</td></tr>
<tr><th id="670">670</th><td>		      ci-&gt;ci_response_producer | (ci-&gt;ci_response_completion &lt;&lt; <var>8</var>));</td></tr>
<tr><th id="671">671</th><td>	PDQ_CSR_WRITE(csrs, <span class='error' title="use of undeclared identifier &apos;csr_cmd_request_producer&apos;">csr_cmd_request_producer</span>,</td></tr>
<tr><th id="672">672</th><td>		      ci-&gt;ci_request_producer | (ci-&gt;ci_request_completion &lt;&lt; <var>8</var>));</td></tr>
<tr><th id="673">673</th><td>    }</td></tr>
<tr><th id="674">674</th><td>}</td></tr>
<tr><th id="675">675</th><td></td></tr>
<tr><th id="676">676</th><td><i  data-doc="pdq_process_unsolicited_events">/*</i></td></tr>
<tr><th id="677">677</th><td><i  data-doc="pdq_process_unsolicited_events"> * This following routine processes unsolicited events.</i></td></tr>
<tr><th id="678">678</th><td><i  data-doc="pdq_process_unsolicited_events"> * In addition, it also fills the unsolicited queue with</i></td></tr>
<tr><th id="679">679</th><td><i  data-doc="pdq_process_unsolicited_events"> * event buffers so it can be used to initialize the queue</i></td></tr>
<tr><th id="680">680</th><td><i  data-doc="pdq_process_unsolicited_events"> * as well.</i></td></tr>
<tr><th id="681">681</th><td><i  data-doc="pdq_process_unsolicited_events"> */</i></td></tr>
<tr><th id="682">682</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="683">683</th><td><dfn class="tu decl def fn" id="pdq_process_unsolicited_events" title='pdq_process_unsolicited_events' data-type='void pdq_process_unsolicited_events(pdq_t * pdq)' data-ref="pdq_process_unsolicited_events" data-ref-filename="pdq_process_unsolicited_events">pdq_process_unsolicited_events</dfn>(</td></tr>
<tr><th id="684">684</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_t" title='pdq_t' data-type='struct _pdq_t' data-ref="pdq_t" data-ref-filename="pdq_t">pdq_t</a> *<dfn class="local col0 decl" id="60pdq" title='pdq' data-type='pdq_t *' data-ref="60pdq" data-ref-filename="60pdq">pdq</dfn>)</td></tr>
<tr><th id="685">685</th><td>{</td></tr>
<tr><th id="686">686</th><td>    <em>const</em> <a class="typedef" href="pdqvar.h.html#pdq_csrs_t" title='pdq_csrs_t' data-type='struct _pdq_csrs_t' data-ref="pdq_csrs_t" data-ref-filename="pdq_csrs_t">pdq_csrs_t</a> * <em>const</em> <dfn class="local col1 decl" id="61csrs" title='csrs' data-type='const pdq_csrs_t *const' data-ref="61csrs" data-ref-filename="61csrs">csrs</dfn> = &amp;pdq-&gt;pdq_csrs;</td></tr>
<tr><th id="687">687</th><td>    <a class="typedef" href="pdqreg.h.html#pdq_unsolicited_info_t" title='pdq_unsolicited_info_t' data-type='struct pdq_unsolicited_info_t' data-ref="pdq_unsolicited_info_t" data-ref-filename="pdq_unsolicited_info_t">pdq_unsolicited_info_t</a> *<dfn class="local col2 decl" id="62ui" title='ui' data-type='pdq_unsolicited_info_t *' data-ref="62ui" data-ref-filename="62ui">ui</dfn> = &amp;<a class="local col0 ref" href="#60pdq" title='pdq' data-ref="60pdq" data-ref-filename="60pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_unsolicited_info" title='_pdq_t::pdq_unsolicited_info' data-ref="_pdq_t::pdq_unsolicited_info" data-ref-filename="_pdq_t..pdq_unsolicited_info">pdq_unsolicited_info</a>;</td></tr>
<tr><th id="688">688</th><td>    <em>volatile</em> <em>const</em> <a class="typedef" href="pdqreg.h.html#pdq_consumer_block_t" title='pdq_consumer_block_t' data-type='struct pdq_consumer_block_t' data-ref="pdq_consumer_block_t" data-ref-filename="pdq_consumer_block_t">pdq_consumer_block_t</a> *<dfn class="local col3 decl" id="63cbp" title='cbp' data-type='const volatile pdq_consumer_block_t *' data-ref="63cbp" data-ref-filename="63cbp">cbp</dfn> = <a class="local col0 ref" href="#60pdq" title='pdq' data-ref="60pdq" data-ref-filename="60pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_cbp" title='_pdq_t::pdq_cbp' data-ref="_pdq_t::pdq_cbp" data-ref-filename="_pdq_t..pdq_cbp">pdq_cbp</a>;</td></tr>
<tr><th id="689">689</th><td>    <a class="typedef" href="pdqreg.h.html#pdq_descriptor_block_t" title='pdq_descriptor_block_t' data-type='struct pdq_descriptor_block_t' data-ref="pdq_descriptor_block_t" data-ref-filename="pdq_descriptor_block_t">pdq_descriptor_block_t</a> *<dfn class="local col4 decl" id="64dbp" title='dbp' data-type='pdq_descriptor_block_t *' data-ref="64dbp" data-ref-filename="64dbp">dbp</dfn> = <a class="local col0 ref" href="#60pdq" title='pdq' data-ref="60pdq" data-ref-filename="60pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_dbp" title='_pdq_t::pdq_dbp' data-ref="_pdq_t::pdq_dbp" data-ref-filename="_pdq_t..pdq_dbp">pdq_dbp</a>;</td></tr>
<tr><th id="690">690</th><td></td></tr>
<tr><th id="691">691</th><td>    <i>/*</i></td></tr>
<tr><th id="692">692</th><td><i>     * Process each unsolicited event (if any).</i></td></tr>
<tr><th id="693">693</th><td><i>     */</i></td></tr>
<tr><th id="694">694</th><td></td></tr>
<tr><th id="695">695</th><td>    <b>while</b> (<span class='error' title="implicit declaration of function &apos;le32toh&apos; is invalid in C99"><a class="ref fn" href="#221" title='le32toh' data-ref="le32toh" data-ref-filename="le32toh">le32toh</a></span>(<a class="local col3 ref" href="#63cbp" title='cbp' data-ref="63cbp" data-ref-filename="63cbp">cbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqcb_unsolicited_event" title='(anonymous struct)::pdqcb_unsolicited_event' data-ref="(anonymous)::pdqcb_unsolicited_event" data-ref-filename="(anonymous)..pdqcb_unsolicited_event">pdqcb_unsolicited_event</a>) != <a class="local col2 ref" href="#62ui" title='ui' data-ref="62ui" data-ref-filename="62ui">ui</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::ui_completion" title='(anonymous struct)::ui_completion' data-ref="(anonymous)::ui_completion" data-ref-filename="(anonymous)..ui_completion">ui_completion</a>) {</td></tr>
<tr><th id="696">696</th><td>	<em>const</em> <a class="typedef" href="pdqreg.h.html#pdq_unsolicited_event_t" title='pdq_unsolicited_event_t' data-type='struct _pdq_unsolicited_event_t' data-ref="pdq_unsolicited_event_t" data-ref-filename="pdq_unsolicited_event_t">pdq_unsolicited_event_t</a> *<dfn class="local col5 decl" id="65event" title='event' data-type='const pdq_unsolicited_event_t *' data-ref="65event" data-ref-filename="65event">event</dfn>;</td></tr>
<tr><th id="697">697</th><td>	<a class="typedef" href="pdqreg.h.html#pdq_entity_t" title='pdq_entity_t' data-type='enum pdq_entity_t' data-ref="pdq_entity_t" data-ref-filename="pdq_entity_t">pdq_entity_t</a> <dfn class="local col6 decl" id="66entity" title='entity' data-type='pdq_entity_t' data-ref="66entity" data-ref-filename="66entity">entity</dfn>;</td></tr>
<tr><th id="698">698</th><td>	<span class='error' title="use of undeclared identifier &apos;uint32_t&apos;">uint32_t</span> value;</td></tr>
<tr><th id="699">699</th><td>	event = &amp;ui-&gt;ui_events[ui-&gt;ui_completion &amp; (<a class="macro" href="pdqreg.h.html#391" title="(PDQ_OS_PAGESIZE / 512)" data-ref="_M/PDQ_NUM_UNSOLICITED_EVENTS">PDQ_NUM_UNSOLICITED_EVENTS</a>-<var>1</var>)];</td></tr>
<tr><th id="700">700</th><td>	<a class="macro" href="pdqvar.h.html#488" title="do { } while(0)" data-ref="_M/PDQ_OS_UNSOL_EVENT_POSTSYNC">PDQ_OS_UNSOL_EVENT_POSTSYNC</a>(pdq, event);</td></tr>
<tr><th id="701">701</th><td></td></tr>
<tr><th id="702">702</th><td>	<b>switch</b> (<a class="local col5 ref" href="#65event" title='event' data-ref="65event" data-ref-filename="65event">event</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_unsolicited_event_t::event_type" title='_pdq_unsolicited_event_t::event_type' data-ref="_pdq_unsolicited_event_t::event_type" data-ref-filename="_pdq_unsolicited_event_t..event_type">event_type</a>) {</td></tr>
<tr><th id="703">703</th><td>	    <b>case</b> <a class="enum" href="pdqreg.h.html#PDQ_UNSOLICITED_EVENT" title='PDQ_UNSOLICITED_EVENT' data-ref="PDQ_UNSOLICITED_EVENT" data-ref-filename="PDQ_UNSOLICITED_EVENT">PDQ_UNSOLICITED_EVENT</a>: {</td></tr>
<tr><th id="704">704</th><td>		<em>int</em> <dfn class="local col7 decl" id="67bad_event" title='bad_event' data-type='int' data-ref="67bad_event" data-ref-filename="67bad_event">bad_event</dfn> = <var>0</var>;</td></tr>
<tr><th id="705">705</th><td>		<a class="local col6 ref" href="#66entity" title='entity' data-ref="66entity" data-ref-filename="66entity">entity</a> = <a class="ref fn" href="#221" title='le32toh' data-ref="le32toh" data-ref-filename="le32toh">le32toh</a>(<a class="local col5 ref" href="#65event" title='event' data-ref="65event" data-ref-filename="65event">event</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_unsolicited_event_t::event_entity" title='_pdq_unsolicited_event_t::event_entity' data-ref="_pdq_unsolicited_event_t::event_entity" data-ref-filename="_pdq_unsolicited_event_t..event_entity">event_entity</a>);</td></tr>
<tr><th id="706">706</th><td>		<span class='error' title="use of undeclared identifier &apos;value&apos;">value</span> = le32toh(event-&gt;event_code.value);</td></tr>
<tr><th id="707">707</th><td>		<b>switch</b> (<a class="local col6 ref" href="#66entity" title='entity' data-ref="66entity" data-ref-filename="66entity">entity</a>) {</td></tr>
<tr><th id="708">708</th><td>		    <b>case</b> <a class="enum" href="pdqreg.h.html#PDQ_ENTITY_STATION" title='PDQ_ENTITY_STATION' data-ref="PDQ_ENTITY_STATION" data-ref-filename="PDQ_ENTITY_STATION">PDQ_ENTITY_STATION</a>: {</td></tr>
<tr><th id="709">709</th><td>			bad_event = <span class='error' title="use of undeclared identifier &apos;value&apos;">value</span> &gt;= PDQ_STATION_EVENT_MAX;</td></tr>
<tr><th id="710">710</th><td>			<b>break</b>;</td></tr>
<tr><th id="711">711</th><td>		    }</td></tr>
<tr><th id="712">712</th><td>		    <b>case</b> <a class="enum" href="pdqreg.h.html#PDQ_ENTITY_LINK" title='PDQ_ENTITY_LINK' data-ref="PDQ_ENTITY_LINK" data-ref-filename="PDQ_ENTITY_LINK">PDQ_ENTITY_LINK</a>: {</td></tr>
<tr><th id="713">713</th><td>			bad_event = <span class='error' title="use of undeclared identifier &apos;value&apos;">value</span> &gt;= PDQ_LINK_EVENT_MAX;</td></tr>
<tr><th id="714">714</th><td>			<b>break</b>;</td></tr>
<tr><th id="715">715</th><td>		    }</td></tr>
<tr><th id="716">716</th><td>		    <b>case</b> <a class="enum" href="pdqreg.h.html#PDQ_ENTITY_PHY_PORT" title='PDQ_ENTITY_PHY_PORT' data-ref="PDQ_ENTITY_PHY_PORT" data-ref-filename="PDQ_ENTITY_PHY_PORT">PDQ_ENTITY_PHY_PORT</a>: {</td></tr>
<tr><th id="717">717</th><td>			bad_event = <span class='error' title="use of undeclared identifier &apos;value&apos;">value</span> &gt;= PDQ_PHY_EVENT_MAX;</td></tr>
<tr><th id="718">718</th><td>			<b>break</b>;</td></tr>
<tr><th id="719">719</th><td>		    }</td></tr>
<tr><th id="720">720</th><td>		    <b>default</b>: {</td></tr>
<tr><th id="721">721</th><td>			<a class="local col7 ref" href="#67bad_event" title='bad_event' data-ref="67bad_event" data-ref-filename="67bad_event">bad_event</a> = <var>1</var>;</td></tr>
<tr><th id="722">722</th><td>			<b>break</b>;</td></tr>
<tr><th id="723">723</th><td>		    }</td></tr>
<tr><th id="724">724</th><td>		}</td></tr>
<tr><th id="725">725</th><td>		<b>if</b> (<a class="local col7 ref" href="#67bad_event" title='bad_event' data-ref="67bad_event" data-ref-filename="67bad_event">bad_event</a>) {</td></tr>
<tr><th id="726">726</th><td>		    <b>break</b>;</td></tr>
<tr><th id="727">727</th><td>		}</td></tr>
<tr><th id="728">728</th><td>		<span class='error' title="implicit declaration of function &apos;printf&apos; is invalid in C99">printf</span>(<span class='error' title="use of undeclared identifier &apos;PDQ_OS_PREFIX&apos;">PDQ_OS_PREFIX</span> <q>"Unsolicited Event: %s: %s"</q>,</td></tr>
<tr><th id="729">729</th><td>		       <span class='error' title="use of undeclared identifier &apos;PDQ_OS_PREFIX_ARGS&apos;">PDQ_OS_PREFIX_ARGS</span>,</td></tr>
<tr><th id="730">730</th><td>		       pdq_entities[entity],</td></tr>
<tr><th id="731">731</th><td>		       pdq_event_codes[entity][<span class='error' title="use of undeclared identifier &apos;value&apos;">value</span>]);</td></tr>
<tr><th id="732">732</th><td>		<b>if</b> (<a class="local col5 ref" href="#65event" title='event' data-ref="65event" data-ref-filename="65event">event</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_unsolicited_event_t::event_entity" title='_pdq_unsolicited_event_t::event_entity' data-ref="_pdq_unsolicited_event_t::event_entity" data-ref-filename="_pdq_unsolicited_event_t..event_entity">event_entity</a> == <a class="enum" href="pdqreg.h.html#PDQ_ENTITY_PHY_PORT" title='PDQ_ENTITY_PHY_PORT' data-ref="PDQ_ENTITY_PHY_PORT" data-ref-filename="PDQ_ENTITY_PHY_PORT">PDQ_ENTITY_PHY_PORT</a>)</td></tr>
<tr><th id="733">733</th><td>		    <a class="ref fn" href="#190" title='printf' data-ref="printf" data-ref-filename="printf">printf</a>(<q>"[%d]"</q>, <a class="ref fn" href="#221" title='le32toh' data-ref="le32toh" data-ref-filename="le32toh">le32toh</a>(<a class="local col5 ref" href="#65event" title='event' data-ref="65event" data-ref-filename="65event">event</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_unsolicited_event_t::event_index" title='_pdq_unsolicited_event_t::event_index' data-ref="_pdq_unsolicited_event_t::event_index" data-ref-filename="_pdq_unsolicited_event_t..event_index">event_index</a>));</td></tr>
<tr><th id="734">734</th><td>		<a class="ref fn" href="#190" title='printf' data-ref="printf" data-ref-filename="printf">printf</a>(<q>"\n"</q>);</td></tr>
<tr><th id="735">735</th><td>		<b>break</b>;</td></tr>
<tr><th id="736">736</th><td>	    }</td></tr>
<tr><th id="737">737</th><td>	    <b>case</b> <a class="enum" href="pdqreg.h.html#PDQ_UNSOLICITED_COUNTERS" title='PDQ_UNSOLICITED_COUNTERS' data-ref="PDQ_UNSOLICITED_COUNTERS" data-ref-filename="PDQ_UNSOLICITED_COUNTERS">PDQ_UNSOLICITED_COUNTERS</a>: {</td></tr>
<tr><th id="738">738</th><td>		<b>break</b>;</td></tr>
<tr><th id="739">739</th><td>	    }</td></tr>
<tr><th id="740">740</th><td>	}</td></tr>
<tr><th id="741">741</th><td>	<a class="macro" href="pdqvar.h.html#487" title="do { } while(0)" data-ref="_M/PDQ_OS_UNSOL_EVENT_PRESYNC">PDQ_OS_UNSOL_EVENT_PRESYNC</a>(pdq, event);</td></tr>
<tr><th id="742">742</th><td>	<a class="macro" href="pdqreg.h.html#419" title="((ui-&gt;ui_completion) = ((ui-&gt;ui_completion) + (1)) &amp; ((((sizeof(dbp-&gt;pdqdb_unsolicited_events) / sizeof(dbp-&gt;pdqdb_unsolicited_events[0]))) - 1)))" data-ref="_M/PDQ_ADVANCE">PDQ_ADVANCE</a>(<a class="local col2 ref" href="#62ui" title='ui' data-ref="62ui" data-ref-filename="62ui">ui</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::ui_completion" title='(anonymous struct)::ui_completion' data-ref="(anonymous)::ui_completion" data-ref-filename="(anonymous)..ui_completion">ui_completion</a>, <var>1</var>, <a class="macro" href="pdqreg.h.html#52" title="(((sizeof(dbp-&gt;pdqdb_unsolicited_events) / sizeof(dbp-&gt;pdqdb_unsolicited_events[0]))) - 1)" data-ref="_M/PDQ_RING_MASK">PDQ_RING_MASK</a>(<a class="local col4 ref" href="#64dbp" title='dbp' data-ref="64dbp" data-ref-filename="64dbp">dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_unsolicited_events" title='(anonymous struct)::pdqdb_unsolicited_events' data-ref="(anonymous)::pdqdb_unsolicited_events" data-ref-filename="(anonymous)..pdqdb_unsolicited_events">pdqdb_unsolicited_events</a>));</td></tr>
<tr><th id="743">743</th><td>	<a class="local col2 ref" href="#62ui" title='ui' data-ref="62ui" data-ref-filename="62ui">ui</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::ui_free" title='(anonymous struct)::ui_free' data-ref="(anonymous)::ui_free" data-ref-filename="(anonymous)..ui_free">ui_free</a>++;</td></tr>
<tr><th id="744">744</th><td>    }</td></tr>
<tr><th id="745">745</th><td></td></tr>
<tr><th id="746">746</th><td>    <i>/*</i></td></tr>
<tr><th id="747">747</th><td><i>     * Now give back the event buffers back to the PDQ.</i></td></tr>
<tr><th id="748">748</th><td><i>     */</i></td></tr>
<tr><th id="749">749</th><td>    <a class="macro" href="pdqreg.h.html#419" title="((ui-&gt;ui_producer) = ((ui-&gt;ui_producer) + (ui-&gt;ui_free)) &amp; ((((sizeof(dbp-&gt;pdqdb_unsolicited_events) / sizeof(dbp-&gt;pdqdb_unsolicited_events[0]))) - 1)))" data-ref="_M/PDQ_ADVANCE">PDQ_ADVANCE</a>(<a class="local col2 ref" href="#62ui" title='ui' data-ref="62ui" data-ref-filename="62ui">ui</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::ui_producer" title='(anonymous struct)::ui_producer' data-ref="(anonymous)::ui_producer" data-ref-filename="(anonymous)..ui_producer">ui_producer</a>, <a class="local col2 ref" href="#62ui" title='ui' data-ref="62ui" data-ref-filename="62ui">ui</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::ui_free" title='(anonymous struct)::ui_free' data-ref="(anonymous)::ui_free" data-ref-filename="(anonymous)..ui_free">ui_free</a>, <a class="macro" href="pdqreg.h.html#52" title="(((sizeof(dbp-&gt;pdqdb_unsolicited_events) / sizeof(dbp-&gt;pdqdb_unsolicited_events[0]))) - 1)" data-ref="_M/PDQ_RING_MASK">PDQ_RING_MASK</a>(<a class="local col4 ref" href="#64dbp" title='dbp' data-ref="64dbp" data-ref-filename="64dbp">dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_unsolicited_events" title='(anonymous struct)::pdqdb_unsolicited_events' data-ref="(anonymous)::pdqdb_unsolicited_events" data-ref-filename="(anonymous)..pdqdb_unsolicited_events">pdqdb_unsolicited_events</a>));</td></tr>
<tr><th id="750">750</th><td>    <a class="local col2 ref" href="#62ui" title='ui' data-ref="62ui" data-ref-filename="62ui">ui</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::ui_free" title='(anonymous struct)::ui_free' data-ref="(anonymous)::ui_free" data-ref-filename="(anonymous)..ui_free">ui_free</a> = <var>0</var>;</td></tr>
<tr><th id="751">751</th><td></td></tr>
<tr><th id="752">752</th><td>    <span class='error' title="implicit declaration of function &apos;PDQ_CSR_WRITE&apos; is invalid in C99">PDQ_CSR_WRITE</span>(csrs, <span class='error' title="use of undeclared identifier &apos;csr_unsolicited_producer&apos;">csr_unsolicited_producer</span>,</td></tr>
<tr><th id="753">753</th><td>		  ui-&gt;ui_producer | (ui-&gt;ui_completion &lt;&lt; <var>8</var>));</td></tr>
<tr><th id="754">754</th><td>}</td></tr>
<tr><th id="755">755</th><td></td></tr>
<tr><th id="756">756</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="757">757</th><td><dfn class="tu decl def fn" id="pdq_process_received_data" title='pdq_process_received_data' data-type='void pdq_process_received_data(pdq_t * pdq, pdq_rx_info_t * rx, pdq_rxdesc_t * receives, pdq_uint32_t completion_goal, pdq_uint32_t ring_mask)' data-ref="pdq_process_received_data" data-ref-filename="pdq_process_received_data">pdq_process_received_data</dfn>(</td></tr>
<tr><th id="758">758</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_t" title='pdq_t' data-type='struct _pdq_t' data-ref="pdq_t" data-ref-filename="pdq_t">pdq_t</a> *<dfn class="local col8 decl" id="68pdq" title='pdq' data-type='pdq_t *' data-ref="68pdq" data-ref-filename="68pdq">pdq</dfn>,</td></tr>
<tr><th id="759">759</th><td>    <a class="typedef" href="pdqreg.h.html#pdq_rx_info_t" title='pdq_rx_info_t' data-type='struct pdq_rx_info_t' data-ref="pdq_rx_info_t" data-ref-filename="pdq_rx_info_t">pdq_rx_info_t</a> *<dfn class="local col9 decl" id="69rx" title='rx' data-type='pdq_rx_info_t *' data-ref="69rx" data-ref-filename="69rx">rx</dfn>,</td></tr>
<tr><th id="760">760</th><td>    <a class="typedef" href="pdqreg.h.html#pdq_rxdesc_t" title='pdq_rxdesc_t' data-type='struct pdq_rxdesc_t' data-ref="pdq_rxdesc_t" data-ref-filename="pdq_rxdesc_t">pdq_rxdesc_t</a> *<dfn class="local col0 decl" id="70receives" title='receives' data-type='pdq_rxdesc_t *' data-ref="70receives" data-ref-filename="70receives">receives</dfn>,</td></tr>
<tr><th id="761">761</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_uint32_t" title='pdq_uint32_t' data-type='unsigned int' data-ref="pdq_uint32_t" data-ref-filename="pdq_uint32_t">pdq_uint32_t</a> <dfn class="local col1 decl" id="71completion_goal" title='completion_goal' data-type='pdq_uint32_t' data-ref="71completion_goal" data-ref-filename="71completion_goal">completion_goal</dfn>,</td></tr>
<tr><th id="762">762</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_uint32_t" title='pdq_uint32_t' data-type='unsigned int' data-ref="pdq_uint32_t" data-ref-filename="pdq_uint32_t">pdq_uint32_t</a> <dfn class="local col2 decl" id="72ring_mask" title='ring_mask' data-type='pdq_uint32_t' data-ref="72ring_mask" data-ref-filename="72ring_mask">ring_mask</dfn>)</td></tr>
<tr><th id="763">763</th><td>{</td></tr>
<tr><th id="764">764</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_uint32_t" title='pdq_uint32_t' data-type='unsigned int' data-ref="pdq_uint32_t" data-ref-filename="pdq_uint32_t">pdq_uint32_t</a> <dfn class="local col3 decl" id="73completion" title='completion' data-type='pdq_uint32_t' data-ref="73completion" data-ref-filename="73completion">completion</dfn> = <a class="local col9 ref" href="#69rx" title='rx' data-ref="69rx" data-ref-filename="69rx">rx</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::rx_completion" title='(anonymous struct)::rx_completion' data-ref="(anonymous)::rx_completion" data-ref-filename="(anonymous)..rx_completion">rx_completion</a>;</td></tr>
<tr><th id="765">765</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_uint32_t" title='pdq_uint32_t' data-type='unsigned int' data-ref="pdq_uint32_t" data-ref-filename="pdq_uint32_t">pdq_uint32_t</a> <dfn class="local col4 decl" id="74producer" title='producer' data-type='pdq_uint32_t' data-ref="74producer" data-ref-filename="74producer">producer</dfn> = <a class="local col9 ref" href="#69rx" title='rx' data-ref="69rx" data-ref-filename="69rx">rx</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::rx_producer" title='(anonymous struct)::rx_producer' data-ref="(anonymous)::rx_producer" data-ref-filename="(anonymous)..rx_producer">rx_producer</a>;</td></tr>
<tr><th id="766">766</th><td>    <span class='error' title="use of undeclared identifier &apos;PDQ_OS_DATABUF_T&apos;">PDQ_OS_DATABUF_T</span> **<span class='error' title="use of undeclared identifier &apos;buffers&apos;">buffers</span> = (<span class='error' title="use of undeclared identifier &apos;PDQ_OS_DATABUF_T&apos;">PDQ_OS_DATABUF_T</span> **<span class='error' title="expected expression">)</span> rx-&gt;rx_buffers;</td></tr>
<tr><th id="767">767</th><td>    <a class="typedef" href="pdqreg.h.html#pdq_rxdesc_t" title='pdq_rxdesc_t' data-type='struct pdq_rxdesc_t' data-ref="pdq_rxdesc_t" data-ref-filename="pdq_rxdesc_t">pdq_rxdesc_t</a> *<dfn class="local col5 decl" id="75rxd" title='rxd' data-type='pdq_rxdesc_t *' data-ref="75rxd" data-ref-filename="75rxd">rxd</dfn>;</td></tr>
<tr><th id="768">768</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_uint32_t" title='pdq_uint32_t' data-type='unsigned int' data-ref="pdq_uint32_t" data-ref-filename="pdq_uint32_t">pdq_uint32_t</a> <dfn class="local col6 decl" id="76idx" title='idx' data-type='pdq_uint32_t' data-ref="76idx" data-ref-filename="76idx">idx</dfn>;</td></tr>
<tr><th id="769">769</th><td></td></tr>
<tr><th id="770">770</th><td>    <b>while</b> (<a class="local col3 ref" href="#73completion" title='completion' data-ref="73completion" data-ref-filename="73completion">completion</a> != <a class="local col1 ref" href="#71completion_goal" title='completion_goal' data-ref="71completion_goal" data-ref-filename="71completion_goal">completion_goal</a>) {</td></tr>
<tr><th id="771">771</th><td>	<span class='error' title="use of undeclared identifier &apos;PDQ_OS_DATABUF_T&apos;">PDQ_OS_DATABUF_T</span> *<span class='error' title="use of undeclared identifier &apos;fpdu&apos;">fpdu</span>, *<span class='error' title="use of undeclared identifier &apos;lpdu&apos;">lpdu</span>, *<span class='error' title="use of undeclared identifier &apos;npdu&apos;">npdu</span>;</td></tr>
<tr><th id="772">772</th><td>	<a class="typedef" href="pdqvar.h.html#pdq_uint8_t" title='pdq_uint8_t' data-type='unsigned char' data-ref="pdq_uint8_t" data-ref-filename="pdq_uint8_t">pdq_uint8_t</a> *<dfn class="local col7 decl" id="77dataptr" title='dataptr' data-type='pdq_uint8_t *' data-ref="77dataptr" data-ref-filename="77dataptr">dataptr</dfn>;</td></tr>
<tr><th id="773">773</th><td>	<a class="typedef" href="pdqvar.h.html#pdq_uint32_t" title='pdq_uint32_t' data-type='unsigned int' data-ref="pdq_uint32_t" data-ref-filename="pdq_uint32_t">pdq_uint32_t</a> <dfn class="local col8 decl" id="78fc" title='fc' data-type='pdq_uint32_t' data-ref="78fc" data-ref-filename="78fc">fc</dfn>, <dfn class="local col9 decl" id="79datalen" title='datalen' data-type='pdq_uint32_t' data-ref="79datalen" data-ref-filename="79datalen">datalen</dfn>, <dfn class="local col0 decl" id="80pdulen" title='pdulen' data-type='pdq_uint32_t' data-ref="80pdulen" data-ref-filename="80pdulen">pdulen</dfn>, <dfn class="local col1 decl" id="81segcnt" title='segcnt' data-type='pdq_uint32_t' data-ref="81segcnt" data-ref-filename="81segcnt">segcnt</dfn>;</td></tr>
<tr><th id="774">774</th><td>	<a class="typedef" href="pdqvar.h.html#pdq_uint32_t" title='pdq_uint32_t' data-type='unsigned int' data-ref="pdq_uint32_t" data-ref-filename="pdq_uint32_t">pdq_uint32_t</a> <dfn class="local col2 decl" id="82status" title='status' data-type='pdq_uint32_t' data-ref="82status" data-ref-filename="82status">status</dfn>;</td></tr>
<tr><th id="775">775</th><td></td></tr>
<tr><th id="776">776</th><td>	<span class='error' title="use of undeclared identifier &apos;fpdu&apos;">fpdu</span> = <span class='error' title="use of undeclared identifier &apos;lpdu&apos;">lpdu</span> = <span class='error' title="use of undeclared identifier &apos;buffers&apos;">buffers</span>[completion];</td></tr>
<tr><th id="777">777</th><td>	<a class="macro" href="pdqreg.h.html#47" title="do { } while(0)" data-ref="_M/PDQ_ASSERT">PDQ_ASSERT</a>(fpdu != NULL);</td></tr>
<tr><th id="778">778</th><td>	<a class="macro" href="pdqvar.h.html#486" title="do { } while(0)" data-ref="_M/PDQ_OS_RXPDU_POSTSYNC">PDQ_OS_RXPDU_POSTSYNC</a>(pdq, fpdu, <var>0</var>, <b>sizeof</b>(u_int32_t));</td></tr>
<tr><th id="779">779</th><td>	dataptr = <span class='error' title="implicit declaration of function &apos;PDQ_OS_DATABUF_PTR&apos; is invalid in C99"><span class='error' title="this function declaration is not a prototype">PDQ_OS_DATABUF_PTR</span></span>(<span class='error' title="use of undeclared identifier &apos;fpdu&apos;">fpdu</span>);</td></tr>
<tr><th id="780">780</th><td>	<a class="local col2 ref" href="#82status" title='status' data-ref="82status" data-ref-filename="82status">status</a> = <span class='error' title="implicit declaration of function &apos;le32toh&apos; is invalid in C99"><a class="ref fn" href="#221" title='le32toh' data-ref="le32toh" data-ref-filename="le32toh">le32toh</a></span>(*(<a class="typedef" href="pdqvar.h.html#pdq_uint32_t" title='pdq_uint32_t' data-type='unsigned int' data-ref="pdq_uint32_t" data-ref-filename="pdq_uint32_t">pdq_uint32_t</a> *) <a class="local col7 ref" href="#77dataptr" title='dataptr' data-ref="77dataptr" data-ref-filename="77dataptr">dataptr</a>);</td></tr>
<tr><th id="781">781</th><td>	<b>if</b> (<a class="macro" href="pdqreg.h.html#289" title="(((status) &gt;&gt; 21) &amp; 0x0001)" data-ref="_M/PDQ_RXS_RCC_BADPDU">PDQ_RXS_RCC_BADPDU</a>(<a class="local col2 ref" href="#82status" title='status' data-ref="82status" data-ref-filename="82status">status</a>) == <var>0</var>) {</td></tr>
<tr><th id="782">782</th><td>	    <a class="local col9 ref" href="#79datalen" title='datalen' data-ref="79datalen" data-ref-filename="79datalen">datalen</a> = <a class="macro" href="pdqreg.h.html#284" title="(((status) &gt;&gt; 0) &amp; 0x1fff)" data-ref="_M/PDQ_RXS_LEN">PDQ_RXS_LEN</a>(<a class="local col2 ref" href="#82status" title='status' data-ref="82status" data-ref-filename="82status">status</a>);</td></tr>
<tr><th id="783">783</th><td>	    <a class="macro" href="pdqvar.h.html#486" title="do { } while(0)" data-ref="_M/PDQ_OS_RXPDU_POSTSYNC">PDQ_OS_RXPDU_POSTSYNC</a>(pdq, fpdu, <b>sizeof</b>(u_int32_t),</td></tr>
<tr><th id="784">784</th><td>				  PDQ_RX_FC_OFFSET + <var>1</var> - <b>sizeof</b>(u_int32_t));</td></tr>
<tr><th id="785">785</th><td>	    <a class="local col8 ref" href="#78fc" title='fc' data-ref="78fc" data-ref-filename="78fc">fc</a> = <a class="local col7 ref" href="#77dataptr" title='dataptr' data-ref="77dataptr" data-ref-filename="77dataptr">dataptr</a>[<a class="macro" href="pdqreg.h.html#405" title="(sizeof(pdq_uint32_t) + 3)" data-ref="_M/PDQ_RX_FC_OFFSET">PDQ_RX_FC_OFFSET</a>];</td></tr>
<tr><th id="786">786</th><td>	    <b>switch</b> (<a class="local col8 ref" href="#78fc" title='fc' data-ref="78fc" data-ref-filename="78fc">fc</a> &amp; (<a class="macro" href="pdqreg.h.html#65" title="0x80" data-ref="_M/PDQ_FDDIFC_C">PDQ_FDDIFC_C</a>|<a class="macro" href="pdqreg.h.html#66" title="0x40" data-ref="_M/PDQ_FDDIFC_L">PDQ_FDDIFC_L</a>|<a class="macro" href="pdqreg.h.html#67" title="0x30" data-ref="_M/PDQ_FDDIFC_F">PDQ_FDDIFC_F</a>)) {</td></tr>
<tr><th id="787">787</th><td>		<b>case</b> <a class="macro" href="pdqreg.h.html#60" title="0x50" data-ref="_M/PDQ_FDDI_LLC_ASYNC">PDQ_FDDI_LLC_ASYNC</a>:</td></tr>
<tr><th id="788">788</th><td>		<b>case</b> <a class="macro" href="pdqreg.h.html#61" title="0xD0" data-ref="_M/PDQ_FDDI_LLC_SYNC">PDQ_FDDI_LLC_SYNC</a>:</td></tr>
<tr><th id="789">789</th><td>		<b>case</b> <a class="macro" href="pdqreg.h.html#62" title="0x60" data-ref="_M/PDQ_FDDI_IMP_ASYNC">PDQ_FDDI_IMP_ASYNC</a>:</td></tr>
<tr><th id="790">790</th><td>		<b>case</b> <a class="macro" href="pdqreg.h.html#63" title="0xE0" data-ref="_M/PDQ_FDDI_IMP_SYNC">PDQ_FDDI_IMP_SYNC</a>: {</td></tr>
<tr><th id="791">791</th><td>		    <b>if</b> (<a class="local col9 ref" href="#79datalen" title='datalen' data-ref="79datalen" data-ref-filename="79datalen">datalen</a> &gt; <a class="macro" href="pdqreg.h.html#55" title="4495" data-ref="_M/PDQ_FDDI_MAX">PDQ_FDDI_MAX</a> || <a class="local col9 ref" href="#79datalen" title='datalen' data-ref="79datalen" data-ref-filename="79datalen">datalen</a> &lt; <a class="macro" href="pdqreg.h.html#56" title="20" data-ref="_M/PDQ_FDDI_LLC_MIN">PDQ_FDDI_LLC_MIN</a>) {</td></tr>
<tr><th id="792">792</th><td>			<a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"discard: bad length %d\n"</q>, datalen));</td></tr>
<tr><th id="793">793</th><td>			<b>goto</b> <a class="lbl" href="#83discard_frame" data-ref="83discard_frame" data-ref-filename="83discard_frame">discard_frame</a>;</td></tr>
<tr><th id="794">794</th><td>		    }</td></tr>
<tr><th id="795">795</th><td>		    <b>break</b>;</td></tr>
<tr><th id="796">796</th><td>		}</td></tr>
<tr><th id="797">797</th><td>		<b>case</b> <a class="macro" href="pdqreg.h.html#59" title="0x40" data-ref="_M/PDQ_FDDI_SMT">PDQ_FDDI_SMT</a>: {</td></tr>
<tr><th id="798">798</th><td>		    <b>if</b> (<a class="local col9 ref" href="#79datalen" title='datalen' data-ref="79datalen" data-ref-filename="79datalen">datalen</a> &gt; <a class="macro" href="pdqreg.h.html#55" title="4495" data-ref="_M/PDQ_FDDI_MAX">PDQ_FDDI_MAX</a> || <a class="local col9 ref" href="#79datalen" title='datalen' data-ref="79datalen" data-ref-filename="79datalen">datalen</a> &lt; <a class="macro" href="pdqreg.h.html#57" title="37" data-ref="_M/PDQ_FDDI_SMT_MIN">PDQ_FDDI_SMT_MIN</a>)</td></tr>
<tr><th id="799">799</th><td>			<b>goto</b> <a class="lbl" href="#83discard_frame" data-ref="83discard_frame" data-ref-filename="83discard_frame">discard_frame</a>;</td></tr>
<tr><th id="800">800</th><td>		    <b>break</b>;</td></tr>
<tr><th id="801">801</th><td>		}</td></tr>
<tr><th id="802">802</th><td>		<b>default</b>: {</td></tr>
<tr><th id="803">803</th><td>		    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"discard: bad fc 0x%x\n"</q>, fc));</td></tr>
<tr><th id="804">804</th><td>		    <b>goto</b> <a class="lbl" href="#83discard_frame" data-ref="83discard_frame" data-ref-filename="83discard_frame">discard_frame</a>;</td></tr>
<tr><th id="805">805</th><td>		}</td></tr>
<tr><th id="806">806</th><td>	    }</td></tr>
<tr><th id="807">807</th><td>	    <i>/*</i></td></tr>
<tr><th id="808">808</th><td><i>	     * Update the lengths of the data buffers now that we know</i></td></tr>
<tr><th id="809">809</th><td><i>	     * the real length.</i></td></tr>
<tr><th id="810">810</th><td><i>	     */</i></td></tr>
<tr><th id="811">811</th><td>	    <a class="local col0 ref" href="#80pdulen" title='pdulen' data-ref="80pdulen" data-ref-filename="80pdulen">pdulen</a> = <a class="local col9 ref" href="#79datalen" title='datalen' data-ref="79datalen" data-ref-filename="79datalen">datalen</a> + (<a class="macro" href="pdqreg.h.html#405" title="(sizeof(pdq_uint32_t) + 3)" data-ref="_M/PDQ_RX_FC_OFFSET">PDQ_RX_FC_OFFSET</a> - <a class="macro" href="pdqvar.h.html#496" title="(sizeof(pdq_uint32_t) + 3)" data-ref="_M/PDQ_OS_HDR_OFFSET">PDQ_OS_HDR_OFFSET</a>) - <var>4</var> <i>/* CRC */</i>;</td></tr>
<tr><th id="812">812</th><td>	    segcnt = (pdulen + <a class="macro" href="pdqvar.h.html#496" title="(sizeof(pdq_uint32_t) + 3)" data-ref="_M/PDQ_OS_HDR_OFFSET">PDQ_OS_HDR_OFFSET</a> + <span class='error' title="use of undeclared identifier &apos;PDQ_OS_DATABUF_SIZE&apos;">PDQ_OS_DATABUF_SIZE</span> - <var>1</var>) / <span class='error' title="use of undeclared identifier &apos;PDQ_OS_DATABUF_SIZE&apos;">PDQ_OS_DATABUF_SIZE</span>;</td></tr>
<tr><th id="813">813</th><td>	    <span class='error' title="implicit declaration of function &apos;PDQ_OS_DATABUF_ALLOC&apos; is invalid in C99"><span class='error' title="this function declaration is not a prototype">PDQ_OS_DATABUF_ALLOC</span></span>(pdq, <span class='error' title="use of undeclared identifier &apos;npdu&apos;">npdu</span>);</td></tr>
<tr><th id="814">814</th><td>	    <b>if</b> (<span class='error' title="use of undeclared identifier &apos;npdu&apos;">npdu</span> == <span class='error' title="use of undeclared identifier &apos;NULL&apos;">NULL</span>) {</td></tr>
<tr><th id="815">815</th><td>		<a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"discard: no databuf #0\n"</q>));</td></tr>
<tr><th id="816">816</th><td>		<b>goto</b> <a class="lbl" href="#83discard_frame" data-ref="83discard_frame" data-ref-filename="83discard_frame">discard_frame</a>;</td></tr>
<tr><th id="817">817</th><td>	    }</td></tr>
<tr><th id="818">818</th><td>	    <span class='error' title="use of undeclared identifier &apos;buffers&apos;">buffers</span>[completion] = <span class='error' title="use of undeclared identifier &apos;npdu&apos;">npdu</span>;</td></tr>
<tr><th id="819">819</th><td>	    <b>for</b> (<a class="local col6 ref" href="#76idx" title='idx' data-ref="76idx" data-ref-filename="76idx">idx</a> = <var>1</var>; <a class="local col6 ref" href="#76idx" title='idx' data-ref="76idx" data-ref-filename="76idx">idx</a> &lt; <a class="local col1 ref" href="#81segcnt" title='segcnt' data-ref="81segcnt" data-ref-filename="81segcnt">segcnt</a>; <a class="local col6 ref" href="#76idx" title='idx' data-ref="76idx" data-ref-filename="76idx">idx</a>++) {</td></tr>
<tr><th id="820">820</th><td>		PDQ_OS_DATABUF_ALLOC(pdq, <span class='error' title="use of undeclared identifier &apos;npdu&apos;">npdu</span>);</td></tr>
<tr><th id="821">821</th><td>		<b>if</b> (<span class='error' title="use of undeclared identifier &apos;npdu&apos;">npdu</span> == <span class='error' title="use of undeclared identifier &apos;NULL&apos;">NULL</span>) {</td></tr>
<tr><th id="822">822</th><td>		    <span class='error' title="implicit declaration of function &apos;PDQ_OS_DATABUF_NEXT_SET&apos; is invalid in C99"><span class='error' title="this function declaration is not a prototype">PDQ_OS_DATABUF_NEXT_SET</span></span>(<span class='error' title="use of undeclared identifier &apos;lpdu&apos;">lpdu</span>, <span class='error' title="use of undeclared identifier &apos;NULL&apos;">NULL</span>);</td></tr>
<tr><th id="823">823</th><td>		    <span class='error' title="implicit declaration of function &apos;PDQ_OS_DATABUF_FREE&apos; is invalid in C99">PDQ_OS_DATABUF_FREE</span>(pdq, <span class='error' title="use of undeclared identifier &apos;fpdu&apos;">fpdu</span>);</td></tr>
<tr><th id="824">824</th><td>		    <b>goto</b> <a class="lbl" href="#83discard_frame" data-ref="83discard_frame" data-ref-filename="83discard_frame">discard_frame</a>;</td></tr>
<tr><th id="825">825</th><td>		}</td></tr>
<tr><th id="826">826</th><td>		<span class='error' title="implicit declaration of function &apos;PDQ_OS_DATABUF_NEXT_SET&apos; is invalid in C99">PDQ_OS_DATABUF_NEXT_SET</span>(<span class='error' title="use of undeclared identifier &apos;lpdu&apos;">lpdu</span>, <span class='error' title="use of undeclared identifier &apos;buffers&apos;">buffers</span>[(completion + idx) &amp; ring_mask]);</td></tr>
<tr><th id="827">827</th><td>		<span class='error' title="use of undeclared identifier &apos;lpdu&apos;">lpdu</span> = <span class='error' title="implicit declaration of function &apos;PDQ_OS_DATABUF_NEXT&apos; is invalid in C99"><span class='error' title="this function declaration is not a prototype">PDQ_OS_DATABUF_NEXT</span></span>(<span class='error' title="use of undeclared identifier &apos;lpdu&apos;">lpdu</span>);</td></tr>
<tr><th id="828">828</th><td>		<span class='error' title="use of undeclared identifier &apos;buffers&apos;">buffers</span>[(completion + idx) &amp; ring_mask] = <span class='error' title="use of undeclared identifier &apos;npdu&apos;">npdu</span>;</td></tr>
<tr><th id="829">829</th><td>	    }</td></tr>
<tr><th id="830">830</th><td>	    <span class='error' title="implicit declaration of function &apos;PDQ_OS_DATABUF_NEXT_SET&apos; is invalid in C99">PDQ_OS_DATABUF_NEXT_SET</span>(<span class='error' title="use of undeclared identifier &apos;lpdu&apos;">lpdu</span>, <span class='error' title="use of undeclared identifier &apos;NULL&apos;">NULL</span>);</td></tr>
<tr><th id="831">831</th><td>	    <b>for</b> (idx = <var>0</var>; idx &lt; <a class="macro" href="pdqreg.h.html#406" title="((4495 + PDQ_OS_DATABUF_SIZE - 1) / PDQ_OS_DATABUF_SIZE)" data-ref="_M/PDQ_RX_SEGCNT">PDQ_RX_SEGCNT</a>; idx++) {</td></tr>
<tr><th id="832">832</th><td>		<span class='error' title="use of undeclared identifier &apos;buffers&apos;">buffers</span>[(producer + idx) &amp; ring_mask] =</td></tr>
<tr><th id="833">833</th><td>		    <span class='error' title="use of undeclared identifier &apos;buffers&apos;">buffers</span>[(completion + idx) &amp; ring_mask];</td></tr>
<tr><th id="834">834</th><td>		<span class='error' title="use of undeclared identifier &apos;buffers&apos;">buffers</span>[(completion + idx) &amp; ring_mask] = <span class='error' title="use of undeclared identifier &apos;NULL&apos;">NULL</span>;</td></tr>
<tr><th id="835">835</th><td>	    }</td></tr>
<tr><th id="836">836</th><td>	    <span class='error' title="implicit declaration of function &apos;PDQ_OS_DATABUF_ADJ&apos; is invalid in C99"><span class='error' title="this function declaration is not a prototype">PDQ_OS_DATABUF_ADJ</span></span>(<span class='error' title="use of undeclared identifier &apos;fpdu&apos;">fpdu</span>, <a class="macro" href="pdqvar.h.html#496" title="(sizeof(pdq_uint32_t) + 3)" data-ref="_M/PDQ_OS_HDR_OFFSET">PDQ_OS_HDR_OFFSET</a>);</td></tr>
<tr><th id="837">837</th><td>	    <b>if</b> (<a class="local col1 ref" href="#81segcnt" title='segcnt' data-ref="81segcnt" data-ref-filename="81segcnt">segcnt</a> == <var>1</var>) {</td></tr>
<tr><th id="838">838</th><td>		<span class='error' title="implicit declaration of function &apos;PDQ_OS_DATABUF_LEN_SET&apos; is invalid in C99"><span class='error' title="this function declaration is not a prototype">PDQ_OS_DATABUF_LEN_SET</span></span>(<span class='error' title="use of undeclared identifier &apos;fpdu&apos;">fpdu</span>, pdulen);</td></tr>
<tr><th id="839">839</th><td>	    } <b>else</b> {</td></tr>
<tr><th id="840">840</th><td>		<span class='error' title="implicit declaration of function &apos;PDQ_OS_DATABUF_LEN_SET&apos; is invalid in C99">PDQ_OS_DATABUF_LEN_SET</span>(<span class='error' title="use of undeclared identifier &apos;lpdu&apos;">lpdu</span>, pdulen + <a class="macro" href="pdqvar.h.html#496" title="(sizeof(pdq_uint32_t) + 3)" data-ref="_M/PDQ_OS_HDR_OFFSET">PDQ_OS_HDR_OFFSET</a> - (segcnt - <var>1</var>) * <span class='error' title="use of undeclared identifier &apos;PDQ_OS_DATABUF_SIZE&apos;">PDQ_OS_DATABUF_SIZE</span>);</td></tr>
<tr><th id="841">841</th><td>	    }</td></tr>
<tr><th id="842">842</th><td>	    <i>/*</i></td></tr>
<tr><th id="843">843</th><td><i>	     * Do not pass to protocol if packet was received promiscuously</i></td></tr>
<tr><th id="844">844</th><td><i>	     */</i></td></tr>
<tr><th id="845">845</th><td>	    pdq_os_receive_pdu(pdq, <span class='error' title="use of undeclared identifier &apos;fpdu&apos;">fpdu</span>, pdulen,</td></tr>
<tr><th id="846">846</th><td>			       <a class="macro" href="pdqreg.h.html#286" title="(((status) &gt;&gt; 15) &amp; 0x0003)" data-ref="_M/PDQ_RXS_RCC_DD">PDQ_RXS_RCC_DD</a>(status) &lt; <a class="macro" href="pdqreg.h.html#299" title="0x02" data-ref="_M/PDQ_RXS_RCC_DD_CAM_MATCH">PDQ_RXS_RCC_DD_CAM_MATCH</a>);</td></tr>
<tr><th id="847">847</th><td>	    rx-&gt;rx_free += <a class="macro" href="pdqreg.h.html#406" title="((4495 + PDQ_OS_DATABUF_SIZE - 1) / PDQ_OS_DATABUF_SIZE)" data-ref="_M/PDQ_RX_SEGCNT">PDQ_RX_SEGCNT</a>;</td></tr>
<tr><th id="848">848</th><td>	    <a class="macro" href="pdqreg.h.html#419" title="((producer) = ((producer) + (((4495 + PDQ_OS_DATABUF_SIZE - 1) / PDQ_OS_DATABUF_SIZE))) &amp; (ring_mask))" data-ref="_M/PDQ_ADVANCE">PDQ_ADVANCE</a>(producer, <a class="macro" href="pdqreg.h.html#406" title="((4495 + PDQ_OS_DATABUF_SIZE - 1) / PDQ_OS_DATABUF_SIZE)" data-ref="_M/PDQ_RX_SEGCNT">PDQ_RX_SEGCNT</a>, ring_mask);</td></tr>
<tr><th id="849">849</th><td>	    <a class="macro" href="pdqreg.h.html#419" title="((completion) = ((completion) + (((4495 + PDQ_OS_DATABUF_SIZE - 1) / PDQ_OS_DATABUF_SIZE))) &amp; (ring_mask))" data-ref="_M/PDQ_ADVANCE">PDQ_ADVANCE</a>(completion, <a class="macro" href="pdqreg.h.html#406" title="((4495 + PDQ_OS_DATABUF_SIZE - 1) / PDQ_OS_DATABUF_SIZE)" data-ref="_M/PDQ_RX_SEGCNT">PDQ_RX_SEGCNT</a>, ring_mask);</td></tr>
<tr><th id="850">850</th><td>	    <b>continue</b>;</td></tr>
<tr><th id="851">851</th><td>	} <b>else</b> {</td></tr>
<tr><th id="852">852</th><td>	    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"discard: bad pdu 0x%x(%d.%d.%d.%d.%d)\n"</q>, status.rxs_status,</td></tr>
<tr><th id="853">853</th><td>			PDQ_RXS_RCC_BADPDU(status), PDQ_RXS_RCC_BADCRC(status),</td></tr>
<tr><th id="854">854</th><td>			PDQ_RXS_RCC_REASON(status), PDQ_RXS_FSC(status),</td></tr>
<tr><th id="855">855</th><td>			PDQ_RXS_FSB_E(status)));</td></tr>
<tr><th id="856">856</th><td>	    <b>if</b> (<a class="macro" href="pdqreg.h.html#287" title="(((status) &gt;&gt; 17) &amp; 0x0007)" data-ref="_M/PDQ_RXS_RCC_REASON">PDQ_RXS_RCC_REASON</a>(<a class="local col2 ref" href="#82status" title='status' data-ref="82status" data-ref-filename="82status">status</a>) == <var>7</var>)</td></tr>
<tr><th id="857">857</th><td>		<b>goto</b> <a class="lbl" href="#83discard_frame" data-ref="83discard_frame" data-ref-filename="83discard_frame">discard_frame</a>;</td></tr>
<tr><th id="858">858</th><td>	    <b>if</b> (<a class="macro" href="pdqreg.h.html#287" title="(((status) &gt;&gt; 17) &amp; 0x0007)" data-ref="_M/PDQ_RXS_RCC_REASON">PDQ_RXS_RCC_REASON</a>(<a class="local col2 ref" href="#82status" title='status' data-ref="82status" data-ref-filename="82status">status</a>) != <var>0</var>) {</td></tr>
<tr><th id="859">859</th><td>		<i>/* hardware fault */</i></td></tr>
<tr><th id="860">860</th><td>		<b>if</b> (<a class="macro" href="pdqreg.h.html#288" title="(((status) &gt;&gt; 20) &amp; 0x0001)" data-ref="_M/PDQ_RXS_RCC_BADCRC">PDQ_RXS_RCC_BADCRC</a>(<a class="local col2 ref" href="#82status" title='status' data-ref="82status" data-ref-filename="82status">status</a>)) {</td></tr>
<tr><th id="861">861</th><td>		    <span class='error' title="implicit declaration of function &apos;printf&apos; is invalid in C99">printf</span>(<span class='error' title="use of undeclared identifier &apos;PDQ_OS_PREFIX&apos;">PDQ_OS_PREFIX</span> <q>" MAC CRC error (source=%x-%x-%x-%x-%x-%x)\n"</q>,</td></tr>
<tr><th id="862">862</th><td>			   <span class='error' title="use of undeclared identifier &apos;PDQ_OS_PREFIX_ARGS&apos;">PDQ_OS_PREFIX_ARGS</span>,</td></tr>
<tr><th id="863">863</th><td>			   dataptr[<a class="macro" href="pdqreg.h.html#405" title="(sizeof(pdq_uint32_t) + 3)" data-ref="_M/PDQ_RX_FC_OFFSET">PDQ_RX_FC_OFFSET</a>+<var>1</var>],</td></tr>
<tr><th id="864">864</th><td>			   dataptr[<a class="macro" href="pdqreg.h.html#405" title="(sizeof(pdq_uint32_t) + 3)" data-ref="_M/PDQ_RX_FC_OFFSET">PDQ_RX_FC_OFFSET</a>+<var>2</var>],</td></tr>
<tr><th id="865">865</th><td>			   dataptr[<a class="macro" href="pdqreg.h.html#405" title="(sizeof(pdq_uint32_t) + 3)" data-ref="_M/PDQ_RX_FC_OFFSET">PDQ_RX_FC_OFFSET</a>+<var>3</var>],</td></tr>
<tr><th id="866">866</th><td>			   dataptr[<a class="macro" href="pdqreg.h.html#405" title="(sizeof(pdq_uint32_t) + 3)" data-ref="_M/PDQ_RX_FC_OFFSET">PDQ_RX_FC_OFFSET</a>+<var>4</var>],</td></tr>
<tr><th id="867">867</th><td>			   dataptr[<a class="macro" href="pdqreg.h.html#405" title="(sizeof(pdq_uint32_t) + 3)" data-ref="_M/PDQ_RX_FC_OFFSET">PDQ_RX_FC_OFFSET</a>+<var>5</var>],</td></tr>
<tr><th id="868">868</th><td>			   dataptr[<a class="macro" href="pdqreg.h.html#405" title="(sizeof(pdq_uint32_t) + 3)" data-ref="_M/PDQ_RX_FC_OFFSET">PDQ_RX_FC_OFFSET</a>+<var>6</var>]);</td></tr>
<tr><th id="869">869</th><td>		    <i>/* rx-&gt;rx_badcrc++; */</i></td></tr>
<tr><th id="870">870</th><td>		} <b>else</b> <b>if</b> (<a class="macro" href="pdqreg.h.html#294" title="(((status) &gt;&gt; 27) &amp; 0x0007)" data-ref="_M/PDQ_RXS_FSC">PDQ_RXS_FSC</a>(<a class="local col2 ref" href="#82status" title='status' data-ref="82status" data-ref-filename="82status">status</a>) == <var>0</var> || <a class="macro" href="pdqreg.h.html#293" title="(((status) &gt;&gt; 26) &amp; 0x0001)" data-ref="_M/PDQ_RXS_FSB_E">PDQ_RXS_FSB_E</a>(<a class="local col2 ref" href="#82status" title='status' data-ref="82status" data-ref-filename="82status">status</a>) == <var>1</var>) {</td></tr>
<tr><th id="871">871</th><td>		    <i>/* rx-&gt;rx_frame_status_errors++; */</i></td></tr>
<tr><th id="872">872</th><td>		} <b>else</b> {</td></tr>
<tr><th id="873">873</th><td>		    <i>/* hardware fault */</i></td></tr>
<tr><th id="874">874</th><td>		}</td></tr>
<tr><th id="875">875</th><td>	    }</td></tr>
<tr><th id="876">876</th><td>	}</td></tr>
<tr><th id="877">877</th><td>      <dfn class="lbl" id="83discard_frame" data-ref="83discard_frame" data-ref-filename="83discard_frame">discard_frame</dfn>:</td></tr>
<tr><th id="878">878</th><td>	<i>/*</i></td></tr>
<tr><th id="879">879</th><td><i>	 * Discarded frames go right back on the queue; therefore</i></td></tr>
<tr><th id="880">880</th><td><i>	 * ring entries were freed.</i></td></tr>
<tr><th id="881">881</th><td><i>	 */</i></td></tr>
<tr><th id="882">882</th><td>	<b>for</b> (idx = <var>0</var>; idx &lt; <a class="macro" href="pdqreg.h.html#406" title="((4495 + PDQ_OS_DATABUF_SIZE - 1) / PDQ_OS_DATABUF_SIZE)" data-ref="_M/PDQ_RX_SEGCNT">PDQ_RX_SEGCNT</a>; idx++) {</td></tr>
<tr><th id="883">883</th><td>	    <span class='error' title="use of undeclared identifier &apos;buffers&apos;">buffers</span>[producer] = <span class='error' title="use of undeclared identifier &apos;buffers&apos;">buffers</span>[completion];</td></tr>
<tr><th id="884">884</th><td>	    <span class='error' title="use of undeclared identifier &apos;buffers&apos;">buffers</span>[completion] = <span class='error' title="use of undeclared identifier &apos;NULL&apos;">NULL</span>;</td></tr>
<tr><th id="885">885</th><td>	    rxd = &amp;receives[rx-&gt;rx_producer];</td></tr>
<tr><th id="886">886</th><td>	    <b>if</b> (idx == <var>0</var>) {</td></tr>
<tr><th id="887">887</th><td>		rxd-&gt;rxd_pa_hi = <span class='error' title="implicit declaration of function &apos;htole32&apos; is invalid in C99">htole32</span>(</td></tr>
<tr><th id="888">888</th><td>		    <a class="macro" href="pdqreg.h.html#280" title="0x80000000" data-ref="_M/PDQ_RXDESC_SOP">PDQ_RXDESC_SOP</a> |</td></tr>
<tr><th id="889">889</th><td>		    <a class="macro" href="pdqreg.h.html#278" title="(((((4495 + PDQ_OS_DATABUF_SIZE - 1) / PDQ_OS_DATABUF_SIZE) - 1) &amp; 0x000f) &lt;&lt; 16)" data-ref="_M/PDQ_RXDESC_SEG_CNT">PDQ_RXDESC_SEG_CNT</a>(<a class="macro" href="pdqreg.h.html#406" title="((4495 + PDQ_OS_DATABUF_SIZE - 1) / PDQ_OS_DATABUF_SIZE)" data-ref="_M/PDQ_RX_SEGCNT">PDQ_RX_SEGCNT</a> - <var>1</var>) |</td></tr>
<tr><th id="890">890</th><td>		    <a class="macro" href="pdqreg.h.html#279" title="((((PDQ_OS_DATABUF_SIZE) &amp; 0xc) &lt;&lt; 27) | (((PDQ_OS_DATABUF_SIZE) &amp; 0x1ff0) &lt;&lt; 16))" data-ref="_M/PDQ_RXDESC_SEG_LEN">PDQ_RXDESC_SEG_LEN</a>(<span class='error' title="use of undeclared identifier &apos;PDQ_OS_DATABUF_SIZE&apos;">PDQ_OS_DATABUF_SIZE</span>));</td></tr>
<tr><th id="891">891</th><td>	    } <b>else</b> {</td></tr>
<tr><th id="892">892</th><td>		rxd-&gt;rxd_pa_hi =</td></tr>
<tr><th id="893">893</th><td>		    <span class='error' title="implicit declaration of function &apos;htole32&apos; is invalid in C99">htole32</span>(<a class="macro" href="pdqreg.h.html#279" title="((((PDQ_OS_DATABUF_SIZE) &amp; 0xc) &lt;&lt; 27) | (((PDQ_OS_DATABUF_SIZE) &amp; 0x1ff0) &lt;&lt; 16))" data-ref="_M/PDQ_RXDESC_SEG_LEN">PDQ_RXDESC_SEG_LEN</a>(<span class='error' title="use of undeclared identifier &apos;PDQ_OS_DATABUF_SIZE&apos;">PDQ_OS_DATABUF_SIZE</span>));</td></tr>
<tr><th id="894">894</th><td>	    }</td></tr>
<tr><th id="895">895</th><td>	    rxd-&gt;rxd_pa_lo = <span class='error' title="implicit declaration of function &apos;htole32&apos; is invalid in C99">htole32</span>(<a class="macro" href="pdqvar.h.html#492" title="PDQ_OS_VA_TO_BUSPA(pdq, PDQ_OS_DATABUF_PTR(buffers[rx-&gt;rx_producer]))" data-ref="_M/PDQ_OS_DATABUF_BUSPA">PDQ_OS_DATABUF_BUSPA</a>(pdq, <span class='error' title="use of undeclared identifier &apos;buffers&apos;">buffers</span>[rx-&gt;rx_producer]));</td></tr>
<tr><th id="896">896</th><td>	    <a class="macro" href="pdqvar.h.html#485" title="do { } while(0)" data-ref="_M/PDQ_OS_RXPDU_PRESYNC">PDQ_OS_RXPDU_PRESYNC</a>(pdq, buffers[rx-&gt;rx_producer], <var>0</var>, PDQ_OS_DATABUF_SIZE);</td></tr>
<tr><th id="897">897</th><td>	    <a class="macro" href="pdqvar.h.html#479" title="do { } while(0)" data-ref="_M/PDQ_OS_DESC_PRESYNC">PDQ_OS_DESC_PRESYNC</a>(pdq, rxd, <b>sizeof</b>(*rxd));</td></tr>
<tr><th id="898">898</th><td>	    <a class="macro" href="pdqreg.h.html#419" title="((rx-&gt;rx_producer) = ((rx-&gt;rx_producer) + (1)) &amp; (ring_mask))" data-ref="_M/PDQ_ADVANCE">PDQ_ADVANCE</a>(rx-&gt;rx_producer, <var>1</var>, ring_mask);</td></tr>
<tr><th id="899">899</th><td>	    <a class="macro" href="pdqreg.h.html#419" title="((producer) = ((producer) + (1)) &amp; (ring_mask))" data-ref="_M/PDQ_ADVANCE">PDQ_ADVANCE</a>(producer, <var>1</var>, ring_mask);</td></tr>
<tr><th id="900">900</th><td>	    <a class="macro" href="pdqreg.h.html#419" title="((completion) = ((completion) + (1)) &amp; (ring_mask))" data-ref="_M/PDQ_ADVANCE">PDQ_ADVANCE</a>(completion, <var>1</var>, ring_mask);</td></tr>
<tr><th id="901">901</th><td>	}</td></tr>
<tr><th id="902">902</th><td>    }</td></tr>
<tr><th id="903">903</th><td>    <a class="local col9 ref" href="#69rx" title='rx' data-ref="69rx" data-ref-filename="69rx">rx</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::rx_completion" title='(anonymous struct)::rx_completion' data-ref="(anonymous)::rx_completion" data-ref-filename="(anonymous)..rx_completion">rx_completion</a> = <a class="local col3 ref" href="#73completion" title='completion' data-ref="73completion" data-ref-filename="73completion">completion</a>;</td></tr>
<tr><th id="904">904</th><td></td></tr>
<tr><th id="905">905</th><td>    <b>while</b> (rx-&gt;rx_free &gt; <a class="macro" href="pdqreg.h.html#406" title="((4495 + PDQ_OS_DATABUF_SIZE - 1) / PDQ_OS_DATABUF_SIZE)" data-ref="_M/PDQ_RX_SEGCNT">PDQ_RX_SEGCNT</a> &amp;&amp; rx-&gt;rx_free &gt; rx-&gt;rx_target) {</td></tr>
<tr><th id="906">906</th><td>	<span class='error' title="use of undeclared identifier &apos;PDQ_OS_DATABUF_T&apos;">PDQ_OS_DATABUF_T</span> *<span class='error' title="use of undeclared identifier &apos;pdu&apos;">pdu</span>;</td></tr>
<tr><th id="907">907</th><td>	<i>/*</i></td></tr>
<tr><th id="908">908</th><td><i>	 * Allocate the needed number of data buffers.</i></td></tr>
<tr><th id="909">909</th><td><i>	 * Try to obtain them from our free queue before</i></td></tr>
<tr><th id="910">910</th><td><i>	 * asking the system for more.</i></td></tr>
<tr><th id="911">911</th><td><i>	 */</i></td></tr>
<tr><th id="912">912</th><td>	<b>for</b> (idx = <var>0</var>; idx &lt; <a class="macro" href="pdqreg.h.html#406" title="((4495 + PDQ_OS_DATABUF_SIZE - 1) / PDQ_OS_DATABUF_SIZE)" data-ref="_M/PDQ_RX_SEGCNT">PDQ_RX_SEGCNT</a>; idx++) {</td></tr>
<tr><th id="913">913</th><td>	    <b>if</b> ((<span class='error' title="use of undeclared identifier &apos;pdu&apos;">pdu</span> = <span class='error' title="use of undeclared identifier &apos;buffers&apos;">buffers</span>[(rx-&gt;rx_producer + idx) &amp; ring_mask]) == <span class='error' title="use of undeclared identifier &apos;NULL&apos;">NULL</span>) {</td></tr>
<tr><th id="914">914</th><td>		<span class='error' title="implicit declaration of function &apos;PDQ_OS_DATABUF_ALLOC&apos; is invalid in C99">PDQ_OS_DATABUF_ALLOC</span>(pdq, <span class='error' title="use of undeclared identifier &apos;pdu&apos;">pdu</span>);</td></tr>
<tr><th id="915">915</th><td>		<b>if</b> (<span class='error' title="use of undeclared identifier &apos;pdu&apos;">pdu</span> == <span class='error' title="use of undeclared identifier &apos;NULL&apos;">NULL</span>)</td></tr>
<tr><th id="916">916</th><td>		    <b>break</b>;</td></tr>
<tr><th id="917">917</th><td>		<span class='error' title="use of undeclared identifier &apos;buffers&apos;">buffers</span>[(rx-&gt;rx_producer + idx) &amp; ring_mask] = <span class='error' title="use of undeclared identifier &apos;pdu&apos;">pdu</span>;</td></tr>
<tr><th id="918">918</th><td>	    }</td></tr>
<tr><th id="919">919</th><td>	    rxd = &amp;receives[(rx-&gt;rx_producer + idx) &amp; ring_mask];</td></tr>
<tr><th id="920">920</th><td>	    <b>if</b> (idx == <var>0</var>) {</td></tr>
<tr><th id="921">921</th><td>		rxd-&gt;rxd_pa_hi = <span class='error' title="implicit declaration of function &apos;htole32&apos; is invalid in C99">htole32</span>(</td></tr>
<tr><th id="922">922</th><td>		    <a class="macro" href="pdqreg.h.html#280" title="0x80000000" data-ref="_M/PDQ_RXDESC_SOP">PDQ_RXDESC_SOP</a>|</td></tr>
<tr><th id="923">923</th><td>		    <a class="macro" href="pdqreg.h.html#278" title="(((((4495 + PDQ_OS_DATABUF_SIZE - 1) / PDQ_OS_DATABUF_SIZE) - 1) &amp; 0x000f) &lt;&lt; 16)" data-ref="_M/PDQ_RXDESC_SEG_CNT">PDQ_RXDESC_SEG_CNT</a>(<a class="macro" href="pdqreg.h.html#406" title="((4495 + PDQ_OS_DATABUF_SIZE - 1) / PDQ_OS_DATABUF_SIZE)" data-ref="_M/PDQ_RX_SEGCNT">PDQ_RX_SEGCNT</a> - <var>1</var>)|</td></tr>
<tr><th id="924">924</th><td>		    <a class="macro" href="pdqreg.h.html#279" title="((((PDQ_OS_DATABUF_SIZE) &amp; 0xc) &lt;&lt; 27) | (((PDQ_OS_DATABUF_SIZE) &amp; 0x1ff0) &lt;&lt; 16))" data-ref="_M/PDQ_RXDESC_SEG_LEN">PDQ_RXDESC_SEG_LEN</a>(<span class='error' title="use of undeclared identifier &apos;PDQ_OS_DATABUF_SIZE&apos;">PDQ_OS_DATABUF_SIZE</span>));</td></tr>
<tr><th id="925">925</th><td>	    } <b>else</b> {</td></tr>
<tr><th id="926">926</th><td>		rxd-&gt;rxd_pa_hi =</td></tr>
<tr><th id="927">927</th><td>		    <span class='error' title="implicit declaration of function &apos;htole32&apos; is invalid in C99">htole32</span>(<a class="macro" href="pdqreg.h.html#279" title="((((PDQ_OS_DATABUF_SIZE) &amp; 0xc) &lt;&lt; 27) | (((PDQ_OS_DATABUF_SIZE) &amp; 0x1ff0) &lt;&lt; 16))" data-ref="_M/PDQ_RXDESC_SEG_LEN">PDQ_RXDESC_SEG_LEN</a>(<span class='error' title="use of undeclared identifier &apos;PDQ_OS_DATABUF_SIZE&apos;">PDQ_OS_DATABUF_SIZE</span>));</td></tr>
<tr><th id="928">928</th><td>	    }</td></tr>
<tr><th id="929">929</th><td>	    rxd-&gt;rxd_pa_lo = <span class='error' title="implicit declaration of function &apos;htole32&apos; is invalid in C99">htole32</span>(<a class="macro" href="pdqvar.h.html#492" title="PDQ_OS_VA_TO_BUSPA(pdq, PDQ_OS_DATABUF_PTR(pdu))" data-ref="_M/PDQ_OS_DATABUF_BUSPA">PDQ_OS_DATABUF_BUSPA</a>(pdq, <span class='error' title="use of undeclared identifier &apos;pdu&apos;">pdu</span>));</td></tr>
<tr><th id="930">930</th><td>	    <a class="macro" href="pdqvar.h.html#485" title="do { } while(0)" data-ref="_M/PDQ_OS_RXPDU_PRESYNC">PDQ_OS_RXPDU_PRESYNC</a>(pdq, pdu, <var>0</var>, PDQ_OS_DATABUF_SIZE);</td></tr>
<tr><th id="931">931</th><td>	    <a class="macro" href="pdqvar.h.html#479" title="do { } while(0)" data-ref="_M/PDQ_OS_DESC_PRESYNC">PDQ_OS_DESC_PRESYNC</a>(pdq, rxd, <b>sizeof</b>(*rxd));</td></tr>
<tr><th id="932">932</th><td>	}</td></tr>
<tr><th id="933">933</th><td>	<b>if</b> (idx &lt; <a class="macro" href="pdqreg.h.html#406" title="((4495 + PDQ_OS_DATABUF_SIZE - 1) / PDQ_OS_DATABUF_SIZE)" data-ref="_M/PDQ_RX_SEGCNT">PDQ_RX_SEGCNT</a>) {</td></tr>
<tr><th id="934">934</th><td>	    <i>/*</i></td></tr>
<tr><th id="935">935</th><td><i>	     * We didn't get all databufs required to complete a new</i></td></tr>
<tr><th id="936">936</th><td><i>	     * receive buffer.  Keep the ones we got and retry a bit</i></td></tr>
<tr><th id="937">937</th><td><i>	     * later for the rest.</i></td></tr>
<tr><th id="938">938</th><td><i>	     */</i></td></tr>
<tr><th id="939">939</th><td>	    <b>break</b>;</td></tr>
<tr><th id="940">940</th><td>	}</td></tr>
<tr><th id="941">941</th><td>	<a class="macro" href="pdqreg.h.html#419" title="((rx-&gt;rx_producer) = ((rx-&gt;rx_producer) + (((4495 + PDQ_OS_DATABUF_SIZE - 1) / PDQ_OS_DATABUF_SIZE))) &amp; (ring_mask))" data-ref="_M/PDQ_ADVANCE">PDQ_ADVANCE</a>(rx-&gt;rx_producer, <a class="macro" href="pdqreg.h.html#406" title="((4495 + PDQ_OS_DATABUF_SIZE - 1) / PDQ_OS_DATABUF_SIZE)" data-ref="_M/PDQ_RX_SEGCNT">PDQ_RX_SEGCNT</a>, ring_mask);</td></tr>
<tr><th id="942">942</th><td>	rx-&gt;rx_free -= <a class="macro" href="pdqreg.h.html#406" title="((4495 + PDQ_OS_DATABUF_SIZE - 1) / PDQ_OS_DATABUF_SIZE)" data-ref="_M/PDQ_RX_SEGCNT">PDQ_RX_SEGCNT</a>;</td></tr>
<tr><th id="943">943</th><td>    }</td></tr>
<tr><th id="944">944</th><td>}</td></tr>
<tr><th id="945">945</th><td></td></tr>
<tr><th id="946">946</th><td><em>static</em> <em>void</em> <a class="tu decl fn" href="#pdq_process_transmitted_data" title='pdq_process_transmitted_data' data-type='void pdq_process_transmitted_data(pdq_t * pdq)' data-ref="pdq_process_transmitted_data" data-ref-filename="pdq_process_transmitted_data">pdq_process_transmitted_data</a>(<a class="typedef" href="pdqvar.h.html#pdq_t" title='pdq_t' data-type='struct _pdq_t' data-ref="pdq_t" data-ref-filename="pdq_t">pdq_t</a> *<dfn class="local col4 decl" id="84pdq" title='pdq' data-type='pdq_t *' data-ref="84pdq" data-ref-filename="84pdq">pdq</dfn>);</td></tr>
<tr><th id="947">947</th><td></td></tr>
<tr><th id="948">948</th><td><a class="typedef" href="pdqvar.h.html#pdq_boolean_t" title='pdq_boolean_t' data-type='enum _pdq_boolean_t' data-ref="pdq_boolean_t" data-ref-filename="pdq_boolean_t">pdq_boolean_t</a></td></tr>
<tr><th id="949">949</th><td><dfn class="decl def fn" id="pdq_queue_transmit_data" title='pdq_queue_transmit_data' data-ref="pdq_queue_transmit_data" data-ref-filename="pdq_queue_transmit_data">pdq_queue_transmit_data</dfn>(</td></tr>
<tr><th id="950">950</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_t" title='pdq_t' data-type='struct _pdq_t' data-ref="pdq_t" data-ref-filename="pdq_t">pdq_t</a> *<dfn class="local col5 decl" id="85pdq" title='pdq' data-type='pdq_t *' data-ref="85pdq" data-ref-filename="85pdq">pdq</dfn>,</td></tr>
<tr><th id="951">951</th><td>    <span class='error' title="unknown type name &apos;PDQ_OS_DATABUF_T&apos;">PDQ_OS_DATABUF_T</span> *<dfn class="local col6 decl" id="86pdu" title='pdu' data-type='int *' data-ref="86pdu" data-ref-filename="86pdu">pdu</dfn>)</td></tr>
<tr><th id="952">952</th><td>{</td></tr>
<tr><th id="953">953</th><td>    <a class="typedef" href="pdqreg.h.html#pdq_tx_info_t" title='pdq_tx_info_t' data-type='struct pdq_tx_info_t' data-ref="pdq_tx_info_t" data-ref-filename="pdq_tx_info_t">pdq_tx_info_t</a> * <em>const</em> <dfn class="local col7 decl" id="87tx" title='tx' data-type='pdq_tx_info_t *const' data-ref="87tx" data-ref-filename="87tx">tx</dfn> = &amp;<a class="local col5 ref" href="#85pdq" title='pdq' data-ref="85pdq" data-ref-filename="85pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_tx_info" title='_pdq_t::pdq_tx_info' data-ref="_pdq_t::pdq_tx_info" data-ref-filename="_pdq_t..pdq_tx_info">pdq_tx_info</a>;</td></tr>
<tr><th id="954">954</th><td>    <a class="typedef" href="pdqreg.h.html#pdq_descriptor_block_t" title='pdq_descriptor_block_t' data-type='struct pdq_descriptor_block_t' data-ref="pdq_descriptor_block_t" data-ref-filename="pdq_descriptor_block_t">pdq_descriptor_block_t</a> * <em>const</em> <dfn class="local col8 decl" id="88dbp" title='dbp' data-type='pdq_descriptor_block_t *const' data-ref="88dbp" data-ref-filename="88dbp">dbp</dfn> = <a class="local col5 ref" href="#85pdq" title='pdq' data-ref="85pdq" data-ref-filename="85pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_dbp" title='_pdq_t::pdq_dbp' data-ref="_pdq_t::pdq_dbp" data-ref-filename="_pdq_t..pdq_dbp">pdq_dbp</a>;</td></tr>
<tr><th id="955">955</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_uint32_t" title='pdq_uint32_t' data-type='unsigned int' data-ref="pdq_uint32_t" data-ref-filename="pdq_uint32_t">pdq_uint32_t</a> <dfn class="local col9 decl" id="89producer" title='producer' data-type='pdq_uint32_t' data-ref="89producer" data-ref-filename="89producer">producer</dfn> = <a class="local col7 ref" href="#87tx" title='tx' data-ref="87tx" data-ref-filename="87tx">tx</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::tx_producer" title='(anonymous struct)::tx_producer' data-ref="(anonymous)::tx_producer" data-ref-filename="(anonymous)..tx_producer">tx_producer</a>;</td></tr>
<tr><th id="956">956</th><td>    <a class="typedef" href="pdqreg.h.html#pdq_txdesc_t" title='pdq_txdesc_t' data-type='struct pdq_txdesc_t' data-ref="pdq_txdesc_t" data-ref-filename="pdq_txdesc_t">pdq_txdesc_t</a> *<dfn class="local col0 decl" id="90eop" title='eop' data-type='pdq_txdesc_t *' data-ref="90eop" data-ref-filename="90eop">eop</dfn> = <span class='error' title="use of undeclared identifier &apos;NULL&apos;">NULL</span>;</td></tr>
<tr><th id="957">957</th><td>    <span class='error' title="use of undeclared identifier &apos;PDQ_OS_DATABUF_T&apos;">PDQ_OS_DATABUF_T</span> *<span class='error' title="use of undeclared identifier &apos;pdu0&apos;">pdu0</span>;</td></tr>
<tr><th id="958">958</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_uint32_t" title='pdq_uint32_t' data-type='unsigned int' data-ref="pdq_uint32_t" data-ref-filename="pdq_uint32_t">pdq_uint32_t</a> <dfn class="local col1 decl" id="91freecnt" title='freecnt' data-type='pdq_uint32_t' data-ref="91freecnt" data-ref-filename="91freecnt">freecnt</dfn>;</td></tr>
<tr><th id="959">959</th><td><u>#<span data-ppcond="959">if</span> defined(<span class="macro" data-ref="_M/PDQ_BUS_DMA">PDQ_BUS_DMA</span>)</u></td></tr>
<tr><th id="960">960</th><td>    bus_dmamap_t map;</td></tr>
<tr><th id="961">961</th><td><u>#<span data-ppcond="959">endif</span></u></td></tr>
<tr><th id="962">962</th><td></td></tr>
<tr><th id="963">963</th><td>  <dfn class="lbl" id="92again" data-ref="92again" data-ref-filename="92again">again</dfn>:</td></tr>
<tr><th id="964">964</th><td>    <b>if</b> (<a class="macro" href="pdqreg.h.html#405" title="(sizeof(pdq_uint32_t) + 3)" data-ref="_M/PDQ_RX_FC_OFFSET">PDQ_RX_FC_OFFSET</a> == <a class="macro" href="pdqvar.h.html#496" title="(sizeof(pdq_uint32_t) + 3)" data-ref="_M/PDQ_OS_HDR_OFFSET">PDQ_OS_HDR_OFFSET</a>) {</td></tr>
<tr><th id="965">965</th><td>	<a class="local col1 ref" href="#91freecnt" title='freecnt' data-ref="91freecnt" data-ref-filename="91freecnt">freecnt</a> = <a class="local col7 ref" href="#87tx" title='tx' data-ref="87tx" data-ref-filename="87tx">tx</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::tx_free" title='(anonymous struct)::tx_free' data-ref="(anonymous)::tx_free" data-ref-filename="(anonymous)..tx_free">tx_free</a> - <var>1</var>;</td></tr>
<tr><th id="966">966</th><td>    } <b>else</b> {</td></tr>
<tr><th id="967">967</th><td>	<a class="local col1 ref" href="#91freecnt" title='freecnt' data-ref="91freecnt" data-ref-filename="91freecnt">freecnt</a> = <a class="local col7 ref" href="#87tx" title='tx' data-ref="87tx" data-ref-filename="87tx">tx</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::tx_free" title='(anonymous struct)::tx_free' data-ref="(anonymous)::tx_free" data-ref-filename="(anonymous)..tx_free">tx_free</a>;</td></tr>
<tr><th id="968">968</th><td>    }</td></tr>
<tr><th id="969">969</th><td>    <i>/*</i></td></tr>
<tr><th id="970">970</th><td><i>     * Need 2 or more descriptors to be able to send.</i></td></tr>
<tr><th id="971">971</th><td><i>     */</i></td></tr>
<tr><th id="972">972</th><td>    <b>if</b> (<a class="local col1 ref" href="#91freecnt" title='freecnt' data-ref="91freecnt" data-ref-filename="91freecnt">freecnt</a> == <var>0</var>) {</td></tr>
<tr><th id="973">973</th><td>	<a class="local col5 ref" href="#85pdq" title='pdq' data-ref="85pdq" data-ref-filename="85pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_intrmask" title='_pdq_t::pdq_intrmask' data-ref="_pdq_t::pdq_intrmask" data-ref-filename="_pdq_t..pdq_intrmask">pdq_intrmask</a> |= <a class="macro" href="pdqreg.h.html#231" title="0x80000000ul" data-ref="_M/PDQ_HOST_INT_TX_ENABLE">PDQ_HOST_INT_TX_ENABLE</a>;</td></tr>
<tr><th id="974">974</th><td>	<span class='error' title="implicit declaration of function &apos;PDQ_CSR_WRITE&apos; is invalid in C99">PDQ_CSR_WRITE</span>(&amp;pdq-&gt;pdq_csrs, <span class='error' title="use of undeclared identifier &apos;csr_host_int_enable&apos;">csr_host_int_enable</span>, pdq-&gt;pdq_intrmask);</td></tr>
<tr><th id="975">975</th><td>	<b>return</b> <a class="enum" href="pdqvar.h.html#PDQ_FALSE" title='PDQ_FALSE' data-ref="PDQ_FALSE" data-ref-filename="PDQ_FALSE">PDQ_FALSE</a>;</td></tr>
<tr><th id="976">976</th><td>    }</td></tr>
<tr><th id="977">977</th><td></td></tr>
<tr><th id="978">978</th><td>    <b>if</b> (<a class="macro" href="pdqreg.h.html#405" title="(sizeof(pdq_uint32_t) + 3)" data-ref="_M/PDQ_RX_FC_OFFSET">PDQ_RX_FC_OFFSET</a> == <a class="macro" href="pdqvar.h.html#496" title="(sizeof(pdq_uint32_t) + 3)" data-ref="_M/PDQ_OS_HDR_OFFSET">PDQ_OS_HDR_OFFSET</a>) {</td></tr>
<tr><th id="979">979</th><td>	<a class="local col8 ref" href="#88dbp" title='dbp' data-ref="88dbp" data-ref-filename="88dbp">dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_transmits" title='(anonymous struct)::pdqdb_transmits' data-ref="(anonymous)::pdqdb_transmits" data-ref-filename="(anonymous)..pdqdb_transmits">pdqdb_transmits</a>[<a class="local col9 ref" href="#89producer" title='producer' data-ref="89producer" data-ref-filename="89producer">producer</a>] = <a class="local col7 ref" href="#87tx" title='tx' data-ref="87tx" data-ref-filename="87tx">tx</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::tx_hdrdesc" title='(anonymous struct)::tx_hdrdesc' data-ref="(anonymous)::tx_hdrdesc" data-ref-filename="(anonymous)..tx_hdrdesc">tx_hdrdesc</a>;</td></tr>
<tr><th id="980">980</th><td>	<a class="macro" href="pdqvar.h.html#479" title="do { } while(0)" data-ref="_M/PDQ_OS_DESC_PRESYNC">PDQ_OS_DESC_PRESYNC</a>(pdq, &amp;dbp-&gt;pdqdb_transmits[producer], <b>sizeof</b>(pdq_txdesc_t));</td></tr>
<tr><th id="981">981</th><td>	<a class="macro" href="pdqreg.h.html#419" title="((producer) = ((producer) + (1)) &amp; ((((sizeof(dbp-&gt;pdqdb_transmits) / sizeof(dbp-&gt;pdqdb_transmits[0]))) - 1)))" data-ref="_M/PDQ_ADVANCE">PDQ_ADVANCE</a>(<a class="local col9 ref" href="#89producer" title='producer' data-ref="89producer" data-ref-filename="89producer">producer</a>, <var>1</var>, <a class="macro" href="pdqreg.h.html#52" title="(((sizeof(dbp-&gt;pdqdb_transmits) / sizeof(dbp-&gt;pdqdb_transmits[0]))) - 1)" data-ref="_M/PDQ_RING_MASK">PDQ_RING_MASK</a>(<a class="local col8 ref" href="#88dbp" title='dbp' data-ref="88dbp" data-ref-filename="88dbp">dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_transmits" title='(anonymous struct)::pdqdb_transmits' data-ref="(anonymous)::pdqdb_transmits" data-ref-filename="(anonymous)..pdqdb_transmits">pdqdb_transmits</a>));</td></tr>
<tr><th id="982">982</th><td>    }</td></tr>
<tr><th id="983">983</th><td></td></tr>
<tr><th id="984">984</th><td><u>#<span data-ppcond="984">if</span> defined(<span class="macro" data-ref="_M/PDQ_BUS_DMA">PDQ_BUS_DMA</span>)</u></td></tr>
<tr><th id="985">985</th><td>    map = M_GETCTX(pdu, bus_dmamap_t);</td></tr>
<tr><th id="986">986</th><td>    <b>if</b> (freecnt &gt;= map-&gt;dm_nsegs) {</td></tr>
<tr><th id="987">987</th><td>	<em>int</em> idx;</td></tr>
<tr><th id="988">988</th><td>	<b>for</b> (idx = <var>0</var>; idx &lt; map-&gt;dm_nsegs; idx++) {</td></tr>
<tr><th id="989">989</th><td>	    <i>/*</i></td></tr>
<tr><th id="990">990</th><td><i>	     * Initialize the transmit descriptor</i></td></tr>
<tr><th id="991">991</th><td><i>	     */</i></td></tr>
<tr><th id="992">992</th><td>	    eop = &amp;dbp-&gt;pdqdb_transmits[producer];</td></tr>
<tr><th id="993">993</th><td>	    eop-&gt;txd_pa_hi =</td></tr>
<tr><th id="994">994</th><td>		htole32(PDQ_TXDESC_SEG_LEN(map-&gt;dm_segs[idx].ds_len));</td></tr>
<tr><th id="995">995</th><td>	    eop-&gt;txd_pa_lo = htole32(map-&gt;dm_segs[idx].ds_addr);</td></tr>
<tr><th id="996">996</th><td>	    PDQ_OS_DESC_PRESYNC(pdq, eop, <b>sizeof</b>(pdq_txdesc_t));</td></tr>
<tr><th id="997">997</th><td>	    freecnt--;</td></tr>
<tr><th id="998">998</th><td>	    PDQ_ADVANCE(producer, <var>1</var>, PDQ_RING_MASK(dbp-&gt;pdqdb_transmits));</td></tr>
<tr><th id="999">999</th><td>	}</td></tr>
<tr><th id="1000">1000</th><td>	pdu0 = NULL;</td></tr>
<tr><th id="1001">1001</th><td>    } <b>else</b> {</td></tr>
<tr><th id="1002">1002</th><td>	pdu0 = pdu;</td></tr>
<tr><th id="1003">1003</th><td>    }</td></tr>
<tr><th id="1004">1004</th><td><u>#<span data-ppcond="984">else</span></u></td></tr>
<tr><th id="1005">1005</th><td>    <b>for</b> (freecnt = tx-&gt;tx_free - <var>1</var>, <span class='error' title="use of undeclared identifier &apos;pdu0&apos;">pdu0</span> = pdu; <span class='error' title="use of undeclared identifier &apos;pdu0&apos;">pdu0</span> != <span class='error' title="use of undeclared identifier &apos;NULL&apos;">NULL</span> &amp;&amp; freecnt &gt; <var>0</var>;) {</td></tr>
<tr><th id="1006">1006</th><td>	pdq_uint32_t fraglen, datalen = <span class='error' title="implicit declaration of function &apos;PDQ_OS_DATABUF_LEN&apos; is invalid in C99"><span class='error' title="this function declaration is not a prototype">PDQ_OS_DATABUF_LEN</span></span>(<span class='error' title="use of undeclared identifier &apos;pdu0&apos;">pdu0</span>);</td></tr>
<tr><th id="1007">1007</th><td>	<em>const</em> pdq_uint8_t *dataptr = <span class='error' title="implicit declaration of function &apos;PDQ_OS_DATABUF_PTR&apos; is invalid in C99">PDQ_OS_DATABUF_PTR</span>(<span class='error' title="use of undeclared identifier &apos;pdu0&apos;">pdu0</span>);</td></tr>
<tr><th id="1008">1008</th><td></td></tr>
<tr><th id="1009">1009</th><td>	<i>/*</i></td></tr>
<tr><th id="1010">1010</th><td><i>	 * The first segment is limited to the space remaining in</i></td></tr>
<tr><th id="1011">1011</th><td><i>	 * page.  All segments after that can be up to a full page</i></td></tr>
<tr><th id="1012">1012</th><td><i>	 * in size.</i></td></tr>
<tr><th id="1013">1013</th><td><i>	 */</i></td></tr>
<tr><th id="1014">1014</th><td>	fraglen = <span class='error' title="use of undeclared identifier &apos;PDQ_OS_PAGESIZE&apos;">PDQ_OS_PAGESIZE</span> - ((dataptr - (pdq_uint8_t *) <span class='error' title="use of undeclared identifier &apos;NULL&apos;">NULL</span>) &amp; (<span class='error' title="use of undeclared identifier &apos;PDQ_OS_PAGESIZE&apos;">PDQ_OS_PAGESIZE</span>-<var>1</var>));</td></tr>
<tr><th id="1015">1015</th><td>	<b>while</b> (datalen &gt; <var>0</var> &amp;&amp; freecnt &gt; <var>0</var>) {</td></tr>
<tr><th id="1016">1016</th><td>	    pdq_uint32_t seglen = (fraglen &lt; datalen ? fraglen : datalen);</td></tr>
<tr><th id="1017">1017</th><td></td></tr>
<tr><th id="1018">1018</th><td>	    <i>/*</i></td></tr>
<tr><th id="1019">1019</th><td><i>	     * Initialize the transmit descriptor</i></td></tr>
<tr><th id="1020">1020</th><td><i>	     */</i></td></tr>
<tr><th id="1021">1021</th><td>	    eop = &amp;dbp-&gt;pdqdb_transmits[producer];</td></tr>
<tr><th id="1022">1022</th><td>	    eop-&gt;txd_pa_hi = <span class='error' title="implicit declaration of function &apos;htole32&apos; is invalid in C99">htole32</span>(<a class="macro" href="pdqreg.h.html#305" title="(((seglen) &amp; 0x1fff) &lt;&lt; 16)" data-ref="_M/PDQ_TXDESC_SEG_LEN">PDQ_TXDESC_SEG_LEN</a>(seglen));</td></tr>
<tr><th id="1023">1023</th><td>	    eop-&gt;txd_pa_lo = htole32(<span class='error' title="implicit declaration of function &apos;PDQ_OS_VA_TO_BUSPA&apos; is invalid in C99">PDQ_OS_VA_TO_BUSPA</span>(pdq, dataptr));</td></tr>
<tr><th id="1024">1024</th><td>	    <a class="macro" href="pdqvar.h.html#479" title="do { } while(0)" data-ref="_M/PDQ_OS_DESC_PRESYNC">PDQ_OS_DESC_PRESYNC</a>(pdq, eop, <b>sizeof</b>(pdq_txdesc_t));</td></tr>
<tr><th id="1025">1025</th><td>	    datalen -= seglen;</td></tr>
<tr><th id="1026">1026</th><td>	    dataptr += seglen;</td></tr>
<tr><th id="1027">1027</th><td>	    fraglen = <span class='error' title="use of undeclared identifier &apos;PDQ_OS_PAGESIZE&apos;">PDQ_OS_PAGESIZE</span>;</td></tr>
<tr><th id="1028">1028</th><td>	    freecnt--;</td></tr>
<tr><th id="1029">1029</th><td>	    <a class="macro" href="pdqreg.h.html#419" title="((producer) = ((producer) + (1)) &amp; ((((sizeof(dbp-&gt;pdqdb_transmits) / sizeof(dbp-&gt;pdqdb_transmits[0]))) - 1)))" data-ref="_M/PDQ_ADVANCE">PDQ_ADVANCE</a>(producer, <var>1</var>, <a class="macro" href="pdqreg.h.html#52" title="(((sizeof(dbp-&gt;pdqdb_transmits) / sizeof(dbp-&gt;pdqdb_transmits[0]))) - 1)" data-ref="_M/PDQ_RING_MASK">PDQ_RING_MASK</a>(dbp-&gt;pdqdb_transmits));</td></tr>
<tr><th id="1030">1030</th><td>	}</td></tr>
<tr><th id="1031">1031</th><td>	<span class='error' title="use of undeclared identifier &apos;pdu0&apos;">pdu0</span> = <span class='error' title="implicit declaration of function &apos;PDQ_OS_DATABUF_NEXT&apos; is invalid in C99">PDQ_OS_DATABUF_NEXT</span>(<span class='error' title="use of undeclared identifier &apos;pdu0&apos;">pdu0</span>);</td></tr>
<tr><th id="1032">1032</th><td>    }</td></tr>
<tr><th id="1033">1033</th><td><u>#<span data-ppcond="984">endif</span> /* defined(PDQ_BUS_DMA) */</u></td></tr>
<tr><th id="1034">1034</th><td>    <b>if</b> (<span class='error' title="use of undeclared identifier &apos;pdu0&apos;">pdu0</span> != <span class='error' title="use of undeclared identifier &apos;NULL&apos;">NULL</span>) {</td></tr>
<tr><th id="1035">1035</th><td>	<em>unsigned</em> <dfn class="local col3 decl" id="93completion" title='completion' data-type='unsigned int' data-ref="93completion" data-ref-filename="93completion">completion</dfn> = <a class="local col7 ref" href="#87tx" title='tx' data-ref="87tx" data-ref-filename="87tx">tx</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::tx_completion" title='(anonymous struct)::tx_completion' data-ref="(anonymous)::tx_completion" data-ref-filename="(anonymous)..tx_completion">tx_completion</a>;</td></tr>
<tr><th id="1036">1036</th><td>	<a class="macro" href="pdqreg.h.html#47" title="do { } while(0)" data-ref="_M/PDQ_ASSERT">PDQ_ASSERT</a>(freecnt == <var>0</var>);</td></tr>
<tr><th id="1037">1037</th><td>	<a class="macro" href="pdqvar.h.html#478" title="do { } while(0)" data-ref="_M/PDQ_OS_CONSUMER_POSTSYNC">PDQ_OS_CONSUMER_POSTSYNC</a>(pdq);</td></tr>
<tr><th id="1038">1038</th><td>	<a class="tu ref fn" href="#pdq_process_transmitted_data" title='pdq_process_transmitted_data' data-use='c' data-ref="pdq_process_transmitted_data" data-ref-filename="pdq_process_transmitted_data">pdq_process_transmitted_data</a>(<a class="local col5 ref" href="#85pdq" title='pdq' data-ref="85pdq" data-ref-filename="85pdq">pdq</a>);</td></tr>
<tr><th id="1039">1039</th><td>	<b>if</b> (<a class="local col3 ref" href="#93completion" title='completion' data-ref="93completion" data-ref-filename="93completion">completion</a> != <a class="local col7 ref" href="#87tx" title='tx' data-ref="87tx" data-ref-filename="87tx">tx</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::tx_completion" title='(anonymous struct)::tx_completion' data-ref="(anonymous)::tx_completion" data-ref-filename="(anonymous)..tx_completion">tx_completion</a>) {</td></tr>
<tr><th id="1040">1040</th><td>	    <a class="local col9 ref" href="#89producer" title='producer' data-ref="89producer" data-ref-filename="89producer">producer</a> = <a class="local col7 ref" href="#87tx" title='tx' data-ref="87tx" data-ref-filename="87tx">tx</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::tx_producer" title='(anonymous struct)::tx_producer' data-ref="(anonymous)::tx_producer" data-ref-filename="(anonymous)..tx_producer">tx_producer</a>;</td></tr>
<tr><th id="1041">1041</th><td>	    eop = <span class='error' title="use of undeclared identifier &apos;NULL&apos;">NULL</span>;</td></tr>
<tr><th id="1042">1042</th><td>	    <b>goto</b> <a class="lbl" href="#92again" data-ref="92again" data-ref-filename="92again">again</a>;</td></tr>
<tr><th id="1043">1043</th><td>	}</td></tr>
<tr><th id="1044">1044</th><td>	<i>/*</i></td></tr>
<tr><th id="1045">1045</th><td><i>	 * If we still have data to process then the ring was too full</i></td></tr>
<tr><th id="1046">1046</th><td><i>	 * to store the PDU.  Return FALSE so the caller will requeue</i></td></tr>
<tr><th id="1047">1047</th><td><i>	 * the PDU for later.</i></td></tr>
<tr><th id="1048">1048</th><td><i>	 */</i></td></tr>
<tr><th id="1049">1049</th><td>	<a class="local col5 ref" href="#85pdq" title='pdq' data-ref="85pdq" data-ref-filename="85pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_intrmask" title='_pdq_t::pdq_intrmask' data-ref="_pdq_t::pdq_intrmask" data-ref-filename="_pdq_t..pdq_intrmask">pdq_intrmask</a> |= <a class="macro" href="pdqreg.h.html#231" title="0x80000000ul" data-ref="_M/PDQ_HOST_INT_TX_ENABLE">PDQ_HOST_INT_TX_ENABLE</a>;</td></tr>
<tr><th id="1050">1050</th><td>	<span class='error' title="implicit declaration of function &apos;PDQ_CSR_WRITE&apos; is invalid in C99">PDQ_CSR_WRITE</span>(&amp;pdq-&gt;pdq_csrs, <span class='error' title="use of undeclared identifier &apos;csr_host_int_enable&apos;">csr_host_int_enable</span>, pdq-&gt;pdq_intrmask);</td></tr>
<tr><th id="1051">1051</th><td>	<b>return</b> <a class="enum" href="pdqvar.h.html#PDQ_FALSE" title='PDQ_FALSE' data-ref="PDQ_FALSE" data-ref-filename="PDQ_FALSE">PDQ_FALSE</a>;</td></tr>
<tr><th id="1052">1052</th><td>    }</td></tr>
<tr><th id="1053">1053</th><td>    <i>/*</i></td></tr>
<tr><th id="1054">1054</th><td><i>     * Everything went fine.  Finish it up.</i></td></tr>
<tr><th id="1055">1055</th><td><i>     */</i></td></tr>
<tr><th id="1056">1056</th><td>    <a class="local col7 ref" href="#87tx" title='tx' data-ref="87tx" data-ref-filename="87tx">tx</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::tx_descriptor_count" title='(anonymous struct)::tx_descriptor_count' data-ref="(anonymous)::tx_descriptor_count" data-ref-filename="(anonymous)..tx_descriptor_count">tx_descriptor_count</a>[<a class="local col7 ref" href="#87tx" title='tx' data-ref="87tx" data-ref-filename="87tx">tx</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::tx_producer" title='(anonymous struct)::tx_producer' data-ref="(anonymous)::tx_producer" data-ref-filename="(anonymous)..tx_producer">tx_producer</a>] = <a class="local col7 ref" href="#87tx" title='tx' data-ref="87tx" data-ref-filename="87tx">tx</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::tx_free" title='(anonymous struct)::tx_free' data-ref="(anonymous)::tx_free" data-ref-filename="(anonymous)..tx_free">tx_free</a> - <a class="local col1 ref" href="#91freecnt" title='freecnt' data-ref="91freecnt" data-ref-filename="91freecnt">freecnt</a>;</td></tr>
<tr><th id="1057">1057</th><td>    <b>if</b> (<a class="macro" href="pdqreg.h.html#405" title="(sizeof(pdq_uint32_t) + 3)" data-ref="_M/PDQ_RX_FC_OFFSET">PDQ_RX_FC_OFFSET</a> != <a class="macro" href="pdqvar.h.html#496" title="(sizeof(pdq_uint32_t) + 3)" data-ref="_M/PDQ_OS_HDR_OFFSET">PDQ_OS_HDR_OFFSET</a>) {</td></tr>
<tr><th id="1058">1058</th><td>	<a class="local col8 ref" href="#88dbp" title='dbp' data-ref="88dbp" data-ref-filename="88dbp">dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_transmits" title='(anonymous struct)::pdqdb_transmits' data-ref="(anonymous)::pdqdb_transmits" data-ref-filename="(anonymous)..pdqdb_transmits">pdqdb_transmits</a>[<a class="local col7 ref" href="#87tx" title='tx' data-ref="87tx" data-ref-filename="87tx">tx</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::tx_producer" title='(anonymous struct)::tx_producer' data-ref="(anonymous)::tx_producer" data-ref-filename="(anonymous)..tx_producer">tx_producer</a>].<a class="ref field" href="pdqreg.h.html#(anonymous)::txd_pa_hi" title='(anonymous struct)::txd_pa_hi' data-ref="(anonymous)::txd_pa_hi" data-ref-filename="(anonymous)..txd_pa_hi">txd_pa_hi</a> |=</td></tr>
<tr><th id="1059">1059</th><td>	    <span class='error' title="implicit declaration of function &apos;htole32&apos; is invalid in C99"><a class="ref fn" href="#517" title='htole32' data-ref="htole32" data-ref-filename="htole32">htole32</a></span>(<a class="macro" href="pdqreg.h.html#308" title="0x80000000" data-ref="_M/PDQ_TXDESC_SOP">PDQ_TXDESC_SOP</a>);</td></tr>
<tr><th id="1060">1060</th><td>	<a class="macro" href="pdqvar.h.html#479" title="do { } while(0)" data-ref="_M/PDQ_OS_DESC_PRESYNC">PDQ_OS_DESC_PRESYNC</a>(pdq, &amp;dbp-&gt;pdqdb_transmits[tx-&gt;tx_producer],</td></tr>
<tr><th id="1061">1061</th><td>	    <b>sizeof</b>(pdq_txdesc_t));</td></tr>
<tr><th id="1062">1062</th><td>    }</td></tr>
<tr><th id="1063">1063</th><td>    <a class="local col0 ref" href="#90eop" title='eop' data-ref="90eop" data-ref-filename="90eop">eop</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::txd_pa_hi" title='(anonymous struct)::txd_pa_hi' data-ref="(anonymous)::txd_pa_hi" data-ref-filename="(anonymous)..txd_pa_hi">txd_pa_hi</a> |= <span class='error' title="implicit declaration of function &apos;htole32&apos; is invalid in C99"><a class="ref fn" href="#517" title='htole32' data-ref="htole32" data-ref-filename="htole32">htole32</a></span>(<a class="macro" href="pdqreg.h.html#307" title="0x40000000" data-ref="_M/PDQ_TXDESC_EOP">PDQ_TXDESC_EOP</a>);</td></tr>
<tr><th id="1064">1064</th><td>    <a class="macro" href="pdqvar.h.html#479" title="do { } while(0)" data-ref="_M/PDQ_OS_DESC_PRESYNC">PDQ_OS_DESC_PRESYNC</a>(pdq, eop, <b>sizeof</b>(pdq_txdesc_t));</td></tr>
<tr><th id="1065">1065</th><td>    <a class="macro" href="pdqvar.h.html#459" title="do { PDQ_OS_DATABUF_NEXTPKT_SET(pdu, NULL); if ((&amp;tx-&gt;tx_txq)-&gt;q_tail == NULL) (&amp;tx-&gt;tx_txq)-&gt;q_head = (pdu); else PDQ_OS_DATABUF_NEXTPKT_SET(((PDQ_OS_DATABUF_T *)(&amp;tx-&gt;tx_txq)-&gt;q_tail), pdu); (&amp;tx-&gt;tx_txq)-&gt;q_tail = (pdu); } while (0)" data-ref="_M/PDQ_OS_DATABUF_ENQUEUE">PDQ_OS_DATABUF_ENQUEUE</a>(&amp;tx-&gt;tx_txq, pdu);</td></tr>
<tr><th id="1066">1066</th><td>    <a class="local col7 ref" href="#87tx" title='tx' data-ref="87tx" data-ref-filename="87tx">tx</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::tx_producer" title='(anonymous struct)::tx_producer' data-ref="(anonymous)::tx_producer" data-ref-filename="(anonymous)..tx_producer">tx_producer</a> = <a class="local col9 ref" href="#89producer" title='producer' data-ref="89producer" data-ref-filename="89producer">producer</a>;</td></tr>
<tr><th id="1067">1067</th><td>    <a class="local col7 ref" href="#87tx" title='tx' data-ref="87tx" data-ref-filename="87tx">tx</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::tx_free" title='(anonymous struct)::tx_free' data-ref="(anonymous)::tx_free" data-ref-filename="(anonymous)..tx_free">tx_free</a> = <a class="local col1 ref" href="#91freecnt" title='freecnt' data-ref="91freecnt" data-ref-filename="91freecnt">freecnt</a>;</td></tr>
<tr><th id="1068">1068</th><td>    <a class="macro" href="pdqreg.h.html#407" title="PDQ_CSR_WRITE(&amp;(pdq)-&gt;pdq_csrs, csr_type_2_producer, ((pdq)-&gt;pdq_rx_info.rx_producer &lt;&lt; 0) | ((pdq)-&gt;pdq_tx_info.tx_producer &lt;&lt; 8) | ((pdq)-&gt;pdq_rx_info.rx_completion &lt;&lt; 16) | ((pdq)-&gt;pdq_tx_info.tx_completion &lt;&lt; 24))" data-ref="_M/PDQ_DO_TYPE2_PRODUCER">PDQ_DO_TYPE2_PRODUCER</a>(pdq);</td></tr>
<tr><th id="1069">1069</th><td>    <b>return</b> <a class="enum" href="pdqvar.h.html#PDQ_TRUE" title='PDQ_TRUE' data-ref="PDQ_TRUE" data-ref-filename="PDQ_TRUE">PDQ_TRUE</a>;</td></tr>
<tr><th id="1070">1070</th><td>}</td></tr>
<tr><th id="1071">1071</th><td></td></tr>
<tr><th id="1072">1072</th><td><em>static</em> <em>void</em></td></tr>
<tr><th id="1073">1073</th><td><dfn class="tu decl def fn" id="pdq_process_transmitted_data" title='pdq_process_transmitted_data' data-type='void pdq_process_transmitted_data(pdq_t * pdq)' data-ref="pdq_process_transmitted_data" data-ref-filename="pdq_process_transmitted_data">pdq_process_transmitted_data</dfn>(</td></tr>
<tr><th id="1074">1074</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_t" title='pdq_t' data-type='struct _pdq_t' data-ref="pdq_t" data-ref-filename="pdq_t">pdq_t</a> *<dfn class="local col4 decl" id="94pdq" title='pdq' data-type='pdq_t *' data-ref="94pdq" data-ref-filename="94pdq">pdq</dfn>)</td></tr>
<tr><th id="1075">1075</th><td>{</td></tr>
<tr><th id="1076">1076</th><td>    <a class="typedef" href="pdqreg.h.html#pdq_tx_info_t" title='pdq_tx_info_t' data-type='struct pdq_tx_info_t' data-ref="pdq_tx_info_t" data-ref-filename="pdq_tx_info_t">pdq_tx_info_t</a> *<dfn class="local col5 decl" id="95tx" title='tx' data-type='pdq_tx_info_t *' data-ref="95tx" data-ref-filename="95tx">tx</dfn> = &amp;<a class="local col4 ref" href="#94pdq" title='pdq' data-ref="94pdq" data-ref-filename="94pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_tx_info" title='_pdq_t::pdq_tx_info' data-ref="_pdq_t::pdq_tx_info" data-ref-filename="_pdq_t..pdq_tx_info">pdq_tx_info</a>;</td></tr>
<tr><th id="1077">1077</th><td>    <em>volatile</em> <em>const</em> <a class="typedef" href="pdqreg.h.html#pdq_consumer_block_t" title='pdq_consumer_block_t' data-type='struct pdq_consumer_block_t' data-ref="pdq_consumer_block_t" data-ref-filename="pdq_consumer_block_t">pdq_consumer_block_t</a> *<dfn class="local col6 decl" id="96cbp" title='cbp' data-type='const volatile pdq_consumer_block_t *' data-ref="96cbp" data-ref-filename="96cbp">cbp</dfn> = <a class="local col4 ref" href="#94pdq" title='pdq' data-ref="94pdq" data-ref-filename="94pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_cbp" title='_pdq_t::pdq_cbp' data-ref="_pdq_t::pdq_cbp" data-ref-filename="_pdq_t..pdq_cbp">pdq_cbp</a>;</td></tr>
<tr><th id="1078">1078</th><td>    <a class="typedef" href="pdqreg.h.html#pdq_descriptor_block_t" title='pdq_descriptor_block_t' data-type='struct pdq_descriptor_block_t' data-ref="pdq_descriptor_block_t" data-ref-filename="pdq_descriptor_block_t">pdq_descriptor_block_t</a> *<dfn class="local col7 decl" id="97dbp" title='dbp' data-type='pdq_descriptor_block_t *' data-ref="97dbp" data-ref-filename="97dbp">dbp</dfn> = <a class="local col4 ref" href="#94pdq" title='pdq' data-ref="94pdq" data-ref-filename="94pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_dbp" title='_pdq_t::pdq_dbp' data-ref="_pdq_t::pdq_dbp" data-ref-filename="_pdq_t..pdq_dbp">pdq_dbp</a>;</td></tr>
<tr><th id="1079">1079</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_uint32_t" title='pdq_uint32_t' data-type='unsigned int' data-ref="pdq_uint32_t" data-ref-filename="pdq_uint32_t">pdq_uint32_t</a> <dfn class="local col8 decl" id="98completion" title='completion' data-type='pdq_uint32_t' data-ref="98completion" data-ref-filename="98completion">completion</dfn> = <a class="local col5 ref" href="#95tx" title='tx' data-ref="95tx" data-ref-filename="95tx">tx</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::tx_completion" title='(anonymous struct)::tx_completion' data-ref="(anonymous)::tx_completion" data-ref-filename="(anonymous)..tx_completion">tx_completion</a>;</td></tr>
<tr><th id="1080">1080</th><td>    <em>int</em> <dfn class="local col9 decl" id="99reclaimed" title='reclaimed' data-type='int' data-ref="99reclaimed" data-ref-filename="99reclaimed">reclaimed</dfn> = <var>0</var>;</td></tr>
<tr><th id="1081">1081</th><td></td></tr>
<tr><th id="1082">1082</th><td>    <b>while</b> (<a class="local col8 ref" href="#98completion" title='completion' data-ref="98completion" data-ref-filename="98completion">completion</a> != <span class='error' title="implicit declaration of function &apos;le16toh&apos; is invalid in C99"><span class='error' title="this function declaration is not a prototype"><a class="ref fn" href="#1082" title='le16toh' data-ref="le16toh" data-ref-filename="le16toh">le16toh</a></span></span>(<a class="local col6 ref" href="#96cbp" title='cbp' data-ref="96cbp" data-ref-filename="96cbp">cbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqcb_transmits" title='(anonymous struct)::pdqcb_transmits' data-ref="(anonymous)::pdqcb_transmits" data-ref-filename="(anonymous)..pdqcb_transmits">pdqcb_transmits</a>)) {</td></tr>
<tr><th id="1083">1083</th><td>	<span class='error' title="use of undeclared identifier &apos;PDQ_OS_DATABUF_T&apos;">PDQ_OS_DATABUF_T</span> *<span class='error' title="use of undeclared identifier &apos;pdu&apos;">pdu</span>;</td></tr>
<tr><th id="1084">1084</th><td>	<a class="typedef" href="pdqvar.h.html#pdq_uint32_t" title='pdq_uint32_t' data-type='unsigned int' data-ref="pdq_uint32_t" data-ref-filename="pdq_uint32_t">pdq_uint32_t</a> <dfn class="local col0 decl" id="100descriptor_count" title='descriptor_count' data-type='pdq_uint32_t' data-ref="100descriptor_count" data-ref-filename="100descriptor_count">descriptor_count</dfn> = <a class="local col5 ref" href="#95tx" title='tx' data-ref="95tx" data-ref-filename="95tx">tx</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::tx_descriptor_count" title='(anonymous struct)::tx_descriptor_count' data-ref="(anonymous)::tx_descriptor_count" data-ref-filename="(anonymous)..tx_descriptor_count">tx_descriptor_count</a>[<a class="local col8 ref" href="#98completion" title='completion' data-ref="98completion" data-ref-filename="98completion">completion</a>];</td></tr>
<tr><th id="1085">1085</th><td>	<a class="macro" href="pdqreg.h.html#47" title="do { } while(0)" data-ref="_M/PDQ_ASSERT">PDQ_ASSERT</a>(dbp-&gt;pdqdb_transmits[completion].txd_sop == <var>1</var>);</td></tr>
<tr><th id="1086">1086</th><td>	<a class="macro" href="pdqreg.h.html#47" title="do { } while(0)" data-ref="_M/PDQ_ASSERT">PDQ_ASSERT</a>(dbp-&gt;pdqdb_transmits[(completion + descriptor_count - <var>1</var>) &amp; PDQ_RING_MASK(dbp-&gt;pdqdb_transmits)].txd_eop == <var>1</var>);</td></tr>
<tr><th id="1087">1087</th><td>	<a class="macro" href="pdqvar.h.html#468" title="do { if (((pdu) = (PDQ_OS_DATABUF_T *) (&amp;tx-&gt;tx_txq)-&gt;q_head) != NULL) { if (((&amp;tx-&gt;tx_txq)-&gt;q_head = PDQ_OS_DATABUF_NEXTPKT(pdu)) == NULL) (&amp;tx-&gt;tx_txq)-&gt;q_tail = NULL; PDQ_OS_DATABUF_NEXTPKT_SET(pdu, NULL); } } while (0)" data-ref="_M/PDQ_OS_DATABUF_DEQUEUE">PDQ_OS_DATABUF_DEQUEUE</a>(&amp;tx-&gt;tx_txq, <span class='error' title="use of undeclared identifier &apos;pdu&apos;">pdu</span>);</td></tr>
<tr><th id="1088">1088</th><td>	pdq_os_transmit_done(pdq, <span class='error' title="use of undeclared identifier &apos;pdu&apos;">pdu</span>);</td></tr>
<tr><th id="1089">1089</th><td>	<a class="local col5 ref" href="#95tx" title='tx' data-ref="95tx" data-ref-filename="95tx">tx</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::tx_free" title='(anonymous struct)::tx_free' data-ref="(anonymous)::tx_free" data-ref-filename="(anonymous)..tx_free">tx_free</a> += <a class="local col0 ref" href="#100descriptor_count" title='descriptor_count' data-ref="100descriptor_count" data-ref-filename="100descriptor_count">descriptor_count</a>;</td></tr>
<tr><th id="1090">1090</th><td>	<a class="local col9 ref" href="#99reclaimed" title='reclaimed' data-ref="99reclaimed" data-ref-filename="99reclaimed">reclaimed</a> = <var>1</var>;</td></tr>
<tr><th id="1091">1091</th><td>	<a class="macro" href="pdqreg.h.html#419" title="((completion) = ((completion) + (descriptor_count)) &amp; ((((sizeof(dbp-&gt;pdqdb_transmits) / sizeof(dbp-&gt;pdqdb_transmits[0]))) - 1)))" data-ref="_M/PDQ_ADVANCE">PDQ_ADVANCE</a>(<a class="local col8 ref" href="#98completion" title='completion' data-ref="98completion" data-ref-filename="98completion">completion</a>, <a class="local col0 ref" href="#100descriptor_count" title='descriptor_count' data-ref="100descriptor_count" data-ref-filename="100descriptor_count">descriptor_count</a>, <a class="macro" href="pdqreg.h.html#52" title="(((sizeof(dbp-&gt;pdqdb_transmits) / sizeof(dbp-&gt;pdqdb_transmits[0]))) - 1)" data-ref="_M/PDQ_RING_MASK">PDQ_RING_MASK</a>(<a class="local col7 ref" href="#97dbp" title='dbp' data-ref="97dbp" data-ref-filename="97dbp">dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_transmits" title='(anonymous struct)::pdqdb_transmits' data-ref="(anonymous)::pdqdb_transmits" data-ref-filename="(anonymous)..pdqdb_transmits">pdqdb_transmits</a>));</td></tr>
<tr><th id="1092">1092</th><td>    }</td></tr>
<tr><th id="1093">1093</th><td>    <b>if</b> (<a class="local col5 ref" href="#95tx" title='tx' data-ref="95tx" data-ref-filename="95tx">tx</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::tx_completion" title='(anonymous struct)::tx_completion' data-ref="(anonymous)::tx_completion" data-ref-filename="(anonymous)..tx_completion">tx_completion</a> != <a class="local col8 ref" href="#98completion" title='completion' data-ref="98completion" data-ref-filename="98completion">completion</a>) {</td></tr>
<tr><th id="1094">1094</th><td>	<a class="local col5 ref" href="#95tx" title='tx' data-ref="95tx" data-ref-filename="95tx">tx</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::tx_completion" title='(anonymous struct)::tx_completion' data-ref="(anonymous)::tx_completion" data-ref-filename="(anonymous)..tx_completion">tx_completion</a> = <a class="local col8 ref" href="#98completion" title='completion' data-ref="98completion" data-ref-filename="98completion">completion</a>;</td></tr>
<tr><th id="1095">1095</th><td>	<a class="local col4 ref" href="#94pdq" title='pdq' data-ref="94pdq" data-ref-filename="94pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_intrmask" title='_pdq_t::pdq_intrmask' data-ref="_pdq_t::pdq_intrmask" data-ref-filename="_pdq_t..pdq_intrmask">pdq_intrmask</a> &amp;= ~<a class="macro" href="pdqreg.h.html#231" title="0x80000000ul" data-ref="_M/PDQ_HOST_INT_TX_ENABLE">PDQ_HOST_INT_TX_ENABLE</a>;</td></tr>
<tr><th id="1096">1096</th><td>	<span class='error' title="implicit declaration of function &apos;PDQ_CSR_WRITE&apos; is invalid in C99">PDQ_CSR_WRITE</span>(&amp;pdq-&gt;pdq_csrs, <span class='error' title="use of undeclared identifier &apos;csr_host_int_enable&apos;">csr_host_int_enable</span>, pdq-&gt;pdq_intrmask);</td></tr>
<tr><th id="1097">1097</th><td>	<a class="ref fn" href="pdqvar.h.html#pdq_os_restart_transmitter" title='pdq_os_restart_transmitter' data-ref="pdq_os_restart_transmitter" data-ref-filename="pdq_os_restart_transmitter">pdq_os_restart_transmitter</a>(<a class="local col4 ref" href="#94pdq" title='pdq' data-ref="94pdq" data-ref-filename="94pdq">pdq</a>);</td></tr>
<tr><th id="1098">1098</th><td>    }</td></tr>
<tr><th id="1099">1099</th><td>    <b>if</b> (reclaimed)</td></tr>
<tr><th id="1100">1100</th><td>	<a class="macro" href="pdqreg.h.html#407" title="PDQ_CSR_WRITE(&amp;(pdq)-&gt;pdq_csrs, csr_type_2_producer, ((pdq)-&gt;pdq_rx_info.rx_producer &lt;&lt; 0) | ((pdq)-&gt;pdq_tx_info.tx_producer &lt;&lt; 8) | ((pdq)-&gt;pdq_rx_info.rx_completion &lt;&lt; 16) | ((pdq)-&gt;pdq_tx_info.tx_completion &lt;&lt; 24))" data-ref="_M/PDQ_DO_TYPE2_PRODUCER">PDQ_DO_TYPE2_PRODUCER</a>(pdq);</td></tr>
<tr><th id="1101">1101</th><td>}</td></tr>
<tr><th id="1102">1102</th><td></td></tr>
<tr><th id="1103">1103</th><td><em>void</em></td></tr>
<tr><th id="1104">1104</th><td><dfn class="decl def fn" id="pdq_flush_transmitter" title='pdq_flush_transmitter' data-ref="pdq_flush_transmitter" data-ref-filename="pdq_flush_transmitter">pdq_flush_transmitter</dfn>(</td></tr>
<tr><th id="1105">1105</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_t" title='pdq_t' data-type='struct _pdq_t' data-ref="pdq_t" data-ref-filename="pdq_t">pdq_t</a> *<dfn class="local col1 decl" id="101pdq" title='pdq' data-type='pdq_t *' data-ref="101pdq" data-ref-filename="101pdq">pdq</dfn>)</td></tr>
<tr><th id="1106">1106</th><td>{</td></tr>
<tr><th id="1107">1107</th><td>    <em>volatile</em> <a class="typedef" href="pdqreg.h.html#pdq_consumer_block_t" title='pdq_consumer_block_t' data-type='struct pdq_consumer_block_t' data-ref="pdq_consumer_block_t" data-ref-filename="pdq_consumer_block_t">pdq_consumer_block_t</a> *<dfn class="local col2 decl" id="102cbp" title='cbp' data-type='volatile pdq_consumer_block_t *' data-ref="102cbp" data-ref-filename="102cbp">cbp</dfn> = <a class="local col1 ref" href="#101pdq" title='pdq' data-ref="101pdq" data-ref-filename="101pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_cbp" title='_pdq_t::pdq_cbp' data-ref="_pdq_t::pdq_cbp" data-ref-filename="_pdq_t..pdq_cbp">pdq_cbp</a>;</td></tr>
<tr><th id="1108">1108</th><td>    <a class="typedef" href="pdqreg.h.html#pdq_tx_info_t" title='pdq_tx_info_t' data-type='struct pdq_tx_info_t' data-ref="pdq_tx_info_t" data-ref-filename="pdq_tx_info_t">pdq_tx_info_t</a> *<dfn class="local col3 decl" id="103tx" title='tx' data-type='pdq_tx_info_t *' data-ref="103tx" data-ref-filename="103tx">tx</dfn> = &amp;<a class="local col1 ref" href="#101pdq" title='pdq' data-ref="101pdq" data-ref-filename="101pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_tx_info" title='_pdq_t::pdq_tx_info' data-ref="_pdq_t::pdq_tx_info" data-ref-filename="_pdq_t..pdq_tx_info">pdq_tx_info</a>;</td></tr>
<tr><th id="1109">1109</th><td></td></tr>
<tr><th id="1110">1110</th><td>    <b>for</b> (;;) {</td></tr>
<tr><th id="1111">1111</th><td>	<span class='error' title="use of undeclared identifier &apos;PDQ_OS_DATABUF_T&apos;">PDQ_OS_DATABUF_T</span> *<span class='error' title="use of undeclared identifier &apos;pdu&apos;">pdu</span>;</td></tr>
<tr><th id="1112">1112</th><td>	<a class="macro" href="pdqvar.h.html#468" title="do { if (((pdu) = (PDQ_OS_DATABUF_T *) (&amp;tx-&gt;tx_txq)-&gt;q_head) != NULL) { if (((&amp;tx-&gt;tx_txq)-&gt;q_head = PDQ_OS_DATABUF_NEXTPKT(pdu)) == NULL) (&amp;tx-&gt;tx_txq)-&gt;q_tail = NULL; PDQ_OS_DATABUF_NEXTPKT_SET(pdu, NULL); } } while (0)" data-ref="_M/PDQ_OS_DATABUF_DEQUEUE">PDQ_OS_DATABUF_DEQUEUE</a>(&amp;tx-&gt;tx_txq, <span class='error' title="use of undeclared identifier &apos;pdu&apos;">pdu</span>);</td></tr>
<tr><th id="1113">1113</th><td>	<b>if</b> (<span class='error' title="use of undeclared identifier &apos;pdu&apos;">pdu</span> == <span class='error' title="use of undeclared identifier &apos;NULL&apos;">NULL</span>)</td></tr>
<tr><th id="1114">1114</th><td>	    <b>break</b>;</td></tr>
<tr><th id="1115">1115</th><td>	<i>/*</i></td></tr>
<tr><th id="1116">1116</th><td><i>	 * Don't call transmit done since the packet never made it</i></td></tr>
<tr><th id="1117">1117</th><td><i>	 * out on the wire.</i></td></tr>
<tr><th id="1118">1118</th><td><i>	 */</i></td></tr>
<tr><th id="1119">1119</th><td>	<span class='error' title="implicit declaration of function &apos;PDQ_OS_DATABUF_FREE&apos; is invalid in C99">PDQ_OS_DATABUF_FREE</span>(pdq, <span class='error' title="use of undeclared identifier &apos;pdu&apos;">pdu</span>);</td></tr>
<tr><th id="1120">1120</th><td>    }</td></tr>
<tr><th id="1121">1121</th><td></td></tr>
<tr><th id="1122">1122</th><td>    <a class="local col3 ref" href="#103tx" title='tx' data-ref="103tx" data-ref-filename="103tx">tx</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::tx_free" title='(anonymous struct)::tx_free' data-ref="(anonymous)::tx_free" data-ref-filename="(anonymous)..tx_free">tx_free</a> = <a class="macro" href="pdqreg.h.html#52" title="(((sizeof(pdq-&gt;pdq_dbp-&gt;pdqdb_transmits) / sizeof(pdq-&gt;pdq_dbp-&gt;pdqdb_transmits[0]))) - 1)" data-ref="_M/PDQ_RING_MASK">PDQ_RING_MASK</a>(<a class="local col1 ref" href="#101pdq" title='pdq' data-ref="101pdq" data-ref-filename="101pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_dbp" title='_pdq_t::pdq_dbp' data-ref="_pdq_t::pdq_dbp" data-ref-filename="_pdq_t..pdq_dbp">pdq_dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_transmits" title='(anonymous struct)::pdqdb_transmits' data-ref="(anonymous)::pdqdb_transmits" data-ref-filename="(anonymous)..pdqdb_transmits">pdqdb_transmits</a>);</td></tr>
<tr><th id="1123">1123</th><td>    <a class="local col3 ref" href="#103tx" title='tx' data-ref="103tx" data-ref-filename="103tx">tx</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::tx_completion" title='(anonymous struct)::tx_completion' data-ref="(anonymous)::tx_completion" data-ref-filename="(anonymous)..tx_completion">tx_completion</a> = <a class="local col3 ref" href="#103tx" title='tx' data-ref="103tx" data-ref-filename="103tx">tx</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::tx_producer" title='(anonymous struct)::tx_producer' data-ref="(anonymous)::tx_producer" data-ref-filename="(anonymous)..tx_producer">tx_producer</a>;</td></tr>
<tr><th id="1124">1124</th><td>    <a class="local col2 ref" href="#102cbp" title='cbp' data-ref="102cbp" data-ref-filename="102cbp">cbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqcb_transmits" title='(anonymous struct)::pdqcb_transmits' data-ref="(anonymous)::pdqcb_transmits" data-ref-filename="(anonymous)..pdqcb_transmits">pdqcb_transmits</a> = <span class='error' title="implicit declaration of function &apos;htole16&apos; is invalid in C99"><span class='error' title="this function declaration is not a prototype"><a class="ref fn" href="#1124" title='htole16' data-ref="htole16" data-ref-filename="htole16">htole16</a></span></span>(<a class="local col3 ref" href="#103tx" title='tx' data-ref="103tx" data-ref-filename="103tx">tx</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::tx_completion" title='(anonymous struct)::tx_completion' data-ref="(anonymous)::tx_completion" data-ref-filename="(anonymous)..tx_completion">tx_completion</a>);</td></tr>
<tr><th id="1125">1125</th><td>    <a class="macro" href="pdqvar.h.html#477" title="do { } while(0)" data-ref="_M/PDQ_OS_CONSUMER_PRESYNC">PDQ_OS_CONSUMER_PRESYNC</a>(pdq);</td></tr>
<tr><th id="1126">1126</th><td></td></tr>
<tr><th id="1127">1127</th><td>    <a class="macro" href="pdqreg.h.html#407" title="PDQ_CSR_WRITE(&amp;(pdq)-&gt;pdq_csrs, csr_type_2_producer, ((pdq)-&gt;pdq_rx_info.rx_producer &lt;&lt; 0) | ((pdq)-&gt;pdq_tx_info.tx_producer &lt;&lt; 8) | ((pdq)-&gt;pdq_rx_info.rx_completion &lt;&lt; 16) | ((pdq)-&gt;pdq_tx_info.tx_completion &lt;&lt; 24))" data-ref="_M/PDQ_DO_TYPE2_PRODUCER">PDQ_DO_TYPE2_PRODUCER</a>(pdq);</td></tr>
<tr><th id="1128">1128</th><td>}</td></tr>
<tr><th id="1129">1129</th><td></td></tr>
<tr><th id="1130">1130</th><td><em>void</em></td></tr>
<tr><th id="1131">1131</th><td><dfn class="decl def fn" id="pdq_hwreset" title='pdq_hwreset' data-ref="pdq_hwreset" data-ref-filename="pdq_hwreset">pdq_hwreset</dfn>(</td></tr>
<tr><th id="1132">1132</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_t" title='pdq_t' data-type='struct _pdq_t' data-ref="pdq_t" data-ref-filename="pdq_t">pdq_t</a> *<dfn class="local col4 decl" id="104pdq" title='pdq' data-type='pdq_t *' data-ref="104pdq" data-ref-filename="104pdq">pdq</dfn>)</td></tr>
<tr><th id="1133">1133</th><td>{</td></tr>
<tr><th id="1134">1134</th><td>    <em>const</em> <a class="typedef" href="pdqvar.h.html#pdq_csrs_t" title='pdq_csrs_t' data-type='struct _pdq_csrs_t' data-ref="pdq_csrs_t" data-ref-filename="pdq_csrs_t">pdq_csrs_t</a> * <em>const</em> <dfn class="local col5 decl" id="105csrs" title='csrs' data-type='const pdq_csrs_t *const' data-ref="105csrs" data-ref-filename="105csrs">csrs</dfn> = &amp;pdq-&gt;pdq_csrs;</td></tr>
<tr><th id="1135">1135</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_state_t" title='pdq_state_t' data-type='enum _pdq_state_t' data-ref="pdq_state_t" data-ref-filename="pdq_state_t">pdq_state_t</a> <dfn class="local col6 decl" id="106state" title='state' data-type='pdq_state_t' data-ref="106state" data-ref-filename="106state">state</dfn>;</td></tr>
<tr><th id="1136">1136</th><td>    <em>int</em> <dfn class="local col7 decl" id="107cnt" title='cnt' data-type='int' data-ref="107cnt" data-ref-filename="107cnt">cnt</dfn>;</td></tr>
<tr><th id="1137">1137</th><td></td></tr>
<tr><th id="1138">1138</th><td>    state = <a class="macro" href="pdqreg.h.html#226" title="((pdq_state_t) (((PDQ_CSR_READ(csrs, csr_port_status)) &gt;&gt; 8) &amp; 0x07))" data-ref="_M/PDQ_PSTS_ADAPTER_STATE">PDQ_PSTS_ADAPTER_STATE</a>(<span class='error' title="implicit declaration of function &apos;PDQ_CSR_READ&apos; is invalid in C99">PDQ_CSR_READ</span>(csrs, <span class='error' title="use of undeclared identifier &apos;csr_port_status&apos;">csr_port_status</span>));</td></tr>
<tr><th id="1139">1139</th><td>    <b>if</b> (<a class="local col6 ref" href="#106state" title='state' data-ref="106state" data-ref-filename="106state">state</a> == <a class="enum" href="pdqvar.h.html#PDQS_DMA_UNAVAILABLE" title='PDQS_DMA_UNAVAILABLE' data-ref="PDQS_DMA_UNAVAILABLE" data-ref-filename="PDQS_DMA_UNAVAILABLE">PDQS_DMA_UNAVAILABLE</a>)</td></tr>
<tr><th id="1140">1140</th><td>	<b>return</b>;</td></tr>
<tr><th id="1141">1141</th><td>    <span class='error' title="implicit declaration of function &apos;PDQ_CSR_WRITE&apos; is invalid in C99">PDQ_CSR_WRITE</span>(csrs, <span class='error' title="use of undeclared identifier &apos;csr_port_data_a&apos;">csr_port_data_a</span>,</td></tr>
<tr><th id="1142">1142</th><td>		  (state == PDQS_HALTED &amp;&amp; pdq-&gt;pdq_type != PDQ_DEFTA) ? <var>0</var> : <a class="macro" href="pdqreg.h.html#172" title="0x0004" data-ref="_M/PDQ_PRESET_SKIP_SELFTEST">PDQ_PRESET_SKIP_SELFTEST</a>);</td></tr>
<tr><th id="1143">1143</th><td>    PDQ_CSR_WRITE(csrs, <span class='error' title="use of undeclared identifier &apos;csr_port_reset&apos;">csr_port_reset</span>, <var>1</var>);</td></tr>
<tr><th id="1144">1144</th><td>    <span class='error' title="implicit declaration of function &apos;PDQ_OS_USEC_DELAY&apos; is invalid in C99"><span class='error' title="this function declaration is not a prototype"><a class="ref fn" href="#1144" title='PDQ_OS_USEC_DELAY' data-ref="PDQ_OS_USEC_DELAY" data-ref-filename="PDQ_OS_USEC_DELAY">PDQ_OS_USEC_DELAY</a></span></span>(<var>100</var>);</td></tr>
<tr><th id="1145">1145</th><td>    PDQ_CSR_WRITE(csrs, <span class='error' title="use of undeclared identifier &apos;csr_port_reset&apos;">csr_port_reset</span>, <var>0</var>);</td></tr>
<tr><th id="1146">1146</th><td>    <b>for</b> (<a class="local col7 ref" href="#107cnt" title='cnt' data-ref="107cnt" data-ref-filename="107cnt">cnt</a> = <var>100000</var>;;<a class="local col7 ref" href="#107cnt" title='cnt' data-ref="107cnt" data-ref-filename="107cnt">cnt</a>--) {</td></tr>
<tr><th id="1147">1147</th><td>	<a class="ref fn" href="#1144" title='PDQ_OS_USEC_DELAY' data-ref="PDQ_OS_USEC_DELAY" data-ref-filename="PDQ_OS_USEC_DELAY">PDQ_OS_USEC_DELAY</a>(<var>1000</var>);</td></tr>
<tr><th id="1148">1148</th><td>	state = <a class="macro" href="pdqreg.h.html#226" title="((pdq_state_t) (((PDQ_CSR_READ(csrs, csr_port_status)) &gt;&gt; 8) &amp; 0x07))" data-ref="_M/PDQ_PSTS_ADAPTER_STATE">PDQ_PSTS_ADAPTER_STATE</a>(PDQ_CSR_READ(csrs, <span class='error' title="use of undeclared identifier &apos;csr_port_status&apos;">csr_port_status</span>));</td></tr>
<tr><th id="1149">1149</th><td>	<b>if</b> (<a class="local col6 ref" href="#106state" title='state' data-ref="106state" data-ref-filename="106state">state</a> == <a class="enum" href="pdqvar.h.html#PDQS_DMA_UNAVAILABLE" title='PDQS_DMA_UNAVAILABLE' data-ref="PDQS_DMA_UNAVAILABLE" data-ref-filename="PDQS_DMA_UNAVAILABLE">PDQS_DMA_UNAVAILABLE</a> || <a class="local col7 ref" href="#107cnt" title='cnt' data-ref="107cnt" data-ref-filename="107cnt">cnt</a> == <var>0</var>)</td></tr>
<tr><th id="1150">1150</th><td>	    <b>break</b>;</td></tr>
<tr><th id="1151">1151</th><td>    }</td></tr>
<tr><th id="1152">1152</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"PDQ Reset spun %d cycles\n"</q>, <var>100000</var> - cnt));</td></tr>
<tr><th id="1153">1153</th><td>    <a class="ref fn" href="#1144" title='PDQ_OS_USEC_DELAY' data-ref="PDQ_OS_USEC_DELAY" data-ref-filename="PDQ_OS_USEC_DELAY">PDQ_OS_USEC_DELAY</a>(<var>10000</var>);</td></tr>
<tr><th id="1154">1154</th><td>    state = <a class="macro" href="pdqreg.h.html#226" title="((pdq_state_t) (((PDQ_CSR_READ(csrs, csr_port_status)) &gt;&gt; 8) &amp; 0x07))" data-ref="_M/PDQ_PSTS_ADAPTER_STATE">PDQ_PSTS_ADAPTER_STATE</a>(PDQ_CSR_READ(csrs, <span class='error' title="use of undeclared identifier &apos;csr_port_status&apos;">csr_port_status</span>));</td></tr>
<tr><th id="1155">1155</th><td>    <a class="macro" href="pdqreg.h.html#47" title="do { } while(0)" data-ref="_M/PDQ_ASSERT">PDQ_ASSERT</a>(state == PDQS_DMA_UNAVAILABLE);</td></tr>
<tr><th id="1156">1156</th><td>    <a class="macro" href="pdqreg.h.html#47" title="do { } while(0)" data-ref="_M/PDQ_ASSERT">PDQ_ASSERT</a>(cnt &gt; <var>0</var>);</td></tr>
<tr><th id="1157">1157</th><td>}</td></tr>
<tr><th id="1158">1158</th><td></td></tr>
<tr><th id="1159">1159</th><td><i>/*</i></td></tr>
<tr><th id="1160">1160</th><td><i> * The following routine brings the PDQ from whatever state it is</i></td></tr>
<tr><th id="1161">1161</th><td><i> * in to DMA_UNAVAILABLE (ie. like a RESET but without doing a RESET).</i></td></tr>
<tr><th id="1162">1162</th><td><i> */</i></td></tr>
<tr><th id="1163">1163</th><td><a class="typedef" href="pdqvar.h.html#pdq_state_t" title='pdq_state_t' data-type='enum _pdq_state_t' data-ref="pdq_state_t" data-ref-filename="pdq_state_t">pdq_state_t</a></td></tr>
<tr><th id="1164">1164</th><td><dfn class="decl def fn" id="pdq_stop" title='pdq_stop' data-ref="pdq_stop" data-ref-filename="pdq_stop">pdq_stop</dfn>(</td></tr>
<tr><th id="1165">1165</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_t" title='pdq_t' data-type='struct _pdq_t' data-ref="pdq_t" data-ref-filename="pdq_t">pdq_t</a> *<dfn class="local col8 decl" id="108pdq" title='pdq' data-type='pdq_t *' data-ref="108pdq" data-ref-filename="108pdq">pdq</dfn>)</td></tr>
<tr><th id="1166">1166</th><td>{</td></tr>
<tr><th id="1167">1167</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_state_t" title='pdq_state_t' data-type='enum _pdq_state_t' data-ref="pdq_state_t" data-ref-filename="pdq_state_t">pdq_state_t</a> <dfn class="local col9 decl" id="109state" title='state' data-type='pdq_state_t' data-ref="109state" data-ref-filename="109state">state</dfn>;</td></tr>
<tr><th id="1168">1168</th><td>    <em>const</em> <a class="typedef" href="pdqvar.h.html#pdq_csrs_t" title='pdq_csrs_t' data-type='struct _pdq_csrs_t' data-ref="pdq_csrs_t" data-ref-filename="pdq_csrs_t">pdq_csrs_t</a> * <em>const</em> <dfn class="local col0 decl" id="110csrs" title='csrs' data-type='const pdq_csrs_t *const' data-ref="110csrs" data-ref-filename="110csrs">csrs</dfn> = &amp;pdq-&gt;pdq_csrs;</td></tr>
<tr><th id="1169">1169</th><td>    <em>int</em> <dfn class="local col1 decl" id="111cnt" title='cnt' data-type='int' data-ref="111cnt" data-ref-filename="111cnt">cnt</dfn>, <dfn class="local col2 decl" id="112pass" title='pass' data-type='int' data-ref="112pass" data-ref-filename="112pass">pass</dfn> = <var>0</var>, <dfn class="local col3 decl" id="113idx" title='idx' data-type='int' data-ref="113idx" data-ref-filename="113idx">idx</dfn>;</td></tr>
<tr><th id="1170">1170</th><td>    <span class='error' title="use of undeclared identifier &apos;PDQ_OS_DATABUF_T&apos;">PDQ_OS_DATABUF_T</span> **<span class='error' title="use of undeclared identifier &apos;buffers&apos;">buffers</span>;</td></tr>
<tr><th id="1171">1171</th><td></td></tr>
<tr><th id="1172">1172</th><td>  <dfn class="lbl" id="114restart" data-ref="114restart" data-ref-filename="114restart">restart</dfn>:</td></tr>
<tr><th id="1173">1173</th><td>    state = <a class="macro" href="pdqreg.h.html#226" title="((pdq_state_t) (((PDQ_CSR_READ(csrs, csr_port_status)) &gt;&gt; 8) &amp; 0x07))" data-ref="_M/PDQ_PSTS_ADAPTER_STATE">PDQ_PSTS_ADAPTER_STATE</a>(<span class='error' title="implicit declaration of function &apos;PDQ_CSR_READ&apos; is invalid in C99">PDQ_CSR_READ</span>(csrs, <span class='error' title="use of undeclared identifier &apos;csr_port_status&apos;">csr_port_status</span>));</td></tr>
<tr><th id="1174">1174</th><td>    <b>if</b> (<a class="local col9 ref" href="#109state" title='state' data-ref="109state" data-ref-filename="109state">state</a> != <a class="enum" href="pdqvar.h.html#PDQS_DMA_UNAVAILABLE" title='PDQS_DMA_UNAVAILABLE' data-ref="PDQS_DMA_UNAVAILABLE" data-ref-filename="PDQS_DMA_UNAVAILABLE">PDQS_DMA_UNAVAILABLE</a>) {</td></tr>
<tr><th id="1175">1175</th><td>	<a class="ref fn" href="#pdq_hwreset" title='pdq_hwreset' data-ref="pdq_hwreset" data-ref-filename="pdq_hwreset">pdq_hwreset</a>(<a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>);</td></tr>
<tr><th id="1176">1176</th><td>	state = <a class="macro" href="pdqreg.h.html#226" title="((pdq_state_t) (((PDQ_CSR_READ(csrs, csr_port_status)) &gt;&gt; 8) &amp; 0x07))" data-ref="_M/PDQ_PSTS_ADAPTER_STATE">PDQ_PSTS_ADAPTER_STATE</a>(PDQ_CSR_READ(csrs, <span class='error' title="use of undeclared identifier &apos;csr_port_status&apos;">csr_port_status</span>));</td></tr>
<tr><th id="1177">1177</th><td>	<a class="macro" href="pdqreg.h.html#47" title="do { } while(0)" data-ref="_M/PDQ_ASSERT">PDQ_ASSERT</a>(state == PDQS_DMA_UNAVAILABLE);</td></tr>
<tr><th id="1178">1178</th><td>    }</td></tr>
<tr><th id="1179">1179</th><td><u>#<span data-ppcond="1179">if</span> 0</u></td></tr>
<tr><th id="1180">1180</th><td>    <b>switch</b> (state) {</td></tr>
<tr><th id="1181">1181</th><td>	<b>case</b> PDQS_RING_MEMBER:</td></tr>
<tr><th id="1182">1182</th><td>	<b>case</b> PDQS_LINK_UNAVAILABLE:</td></tr>
<tr><th id="1183">1183</th><td>	<b>case</b> PDQS_LINK_AVAILABLE: {</td></tr>
<tr><th id="1184">1184</th><td>	    PDQ_CSR_WRITE(csrs, csr_port_data_a, PDQ_SUB_CMD_LINK_UNINIT);</td></tr>
<tr><th id="1185">1185</th><td>	    PDQ_CSR_WRITE(csrs, csr_port_data_b, <var>0</var>);</td></tr>
<tr><th id="1186">1186</th><td>	    pdq_do_port_control(csrs, PDQ_PCTL_SUB_CMD);</td></tr>
<tr><th id="1187">1187</th><td>	    state = PDQ_PSTS_ADAPTER_STATE(PDQ_CSR_READ(csrs, csr_port_status));</td></tr>
<tr><th id="1188">1188</th><td>	    PDQ_ASSERT(state == PDQS_DMA_AVAILABLE);</td></tr>
<tr><th id="1189">1189</th><td>	    <i>/* FALL THROUGH */</i></td></tr>
<tr><th id="1190">1190</th><td>	}</td></tr>
<tr><th id="1191">1191</th><td>	<b>case</b> PDQS_DMA_AVAILABLE: {</td></tr>
<tr><th id="1192">1192</th><td>	    PDQ_CSR_WRITE(csrs, csr_port_data_a, <var>0</var>);</td></tr>
<tr><th id="1193">1193</th><td>	    PDQ_CSR_WRITE(csrs, csr_port_data_b, <var>0</var>);</td></tr>
<tr><th id="1194">1194</th><td>	    pdq_do_port_control(csrs, PDQ_PCTL_DMA_UNINIT);</td></tr>
<tr><th id="1195">1195</th><td>	    state = PDQ_PSTS_ADAPTER_STATE(PDQ_CSR_READ(csrs, csr_port_status));</td></tr>
<tr><th id="1196">1196</th><td>	    PDQ_ASSERT(state == PDQS_DMA_UNAVAILABLE);</td></tr>
<tr><th id="1197">1197</th><td>	    <i>/* FALL THROUGH */</i></td></tr>
<tr><th id="1198">1198</th><td>	}</td></tr>
<tr><th id="1199">1199</th><td>	<b>case</b> PDQS_DMA_UNAVAILABLE: {</td></tr>
<tr><th id="1200">1200</th><td>	    <b>break</b>;</td></tr>
<tr><th id="1201">1201</th><td>	}</td></tr>
<tr><th id="1202">1202</th><td>    }</td></tr>
<tr><th id="1203">1203</th><td><u>#<span data-ppcond="1179">endif</span></u></td></tr>
<tr><th id="1204">1204</th><td>    <i>/*</i></td></tr>
<tr><th id="1205">1205</th><td><i>     * Now we should be in DMA_UNAVAILABLE.  So bring the PDQ into</i></td></tr>
<tr><th id="1206">1206</th><td><i>     * DMA_AVAILABLE.</i></td></tr>
<tr><th id="1207">1207</th><td><i>     */</i></td></tr>
<tr><th id="1208">1208</th><td></td></tr>
<tr><th id="1209">1209</th><td>    <i>/*</i></td></tr>
<tr><th id="1210">1210</th><td><i>     * Obtain the hardware address and firmware revisions</i></td></tr>
<tr><th id="1211">1211</th><td><i>     * (MLA = my long address which is FDDI speak for hardware address)</i></td></tr>
<tr><th id="1212">1212</th><td><i>     */</i></td></tr>
<tr><th id="1213">1213</th><td>    pdq_read_mla(&amp;pdq-&gt;pdq_csrs, &amp;pdq-&gt;pdq_hwaddr);</td></tr>
<tr><th id="1214">1214</th><td>    pdq_read_fwrev(&amp;pdq-&gt;pdq_csrs, &amp;pdq-&gt;pdq_fwrev);</td></tr>
<tr><th id="1215">1215</th><td>    pdq-&gt;pdq_chip_rev = pdq_read_chiprev(&amp;pdq-&gt;pdq_csrs);</td></tr>
<tr><th id="1216">1216</th><td></td></tr>
<tr><th id="1217">1217</th><td>    <b>if</b> (<a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_type" title='_pdq_t::pdq_type' data-ref="_pdq_t::pdq_type" data-ref-filename="_pdq_t..pdq_type">pdq_type</a> == <a class="enum" href="pdqvar.h.html#PDQ_DEFPA" title='PDQ_DEFPA' data-ref="PDQ_DEFPA" data-ref-filename="PDQ_DEFPA">PDQ_DEFPA</a>) {</td></tr>
<tr><th id="1218">1218</th><td>	<i>/*</i></td></tr>
<tr><th id="1219">1219</th><td><i>	 * Disable interrupts and DMA.</i></td></tr>
<tr><th id="1220">1220</th><td><i>	 */</i></td></tr>
<tr><th id="1221">1221</th><td>	<span class='error' title="implicit declaration of function &apos;PDQ_CSR_WRITE&apos; is invalid in C99">PDQ_CSR_WRITE</span>(&amp;pdq-&gt;pdq_pci_csrs, <span class='error' title="use of undeclared identifier &apos;csr_pfi_mode_control&apos;">csr_pfi_mode_control</span>, <var>0</var>);</td></tr>
<tr><th id="1222">1222</th><td>	PDQ_CSR_WRITE(&amp;pdq-&gt;pdq_pci_csrs, <span class='error' title="use of undeclared identifier &apos;csr_pfi_status&apos;">csr_pfi_status</span>, <var>0x10</var>);</td></tr>
<tr><th id="1223">1223</th><td>    }</td></tr>
<tr><th id="1224">1224</th><td></td></tr>
<tr><th id="1225">1225</th><td>    <i>/*</i></td></tr>
<tr><th id="1226">1226</th><td><i>     * Flush all the databuf queues.</i></td></tr>
<tr><th id="1227">1227</th><td><i>     */</i></td></tr>
<tr><th id="1228">1228</th><td>    <a class="tu ref fn" href="#pdq_flush_databuf_queue" title='pdq_flush_databuf_queue' data-use='c' data-ref="pdq_flush_databuf_queue" data-ref-filename="pdq_flush_databuf_queue">pdq_flush_databuf_queue</a>(<a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>, &amp;<a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_tx_info" title='_pdq_t::pdq_tx_info' data-ref="_pdq_t::pdq_tx_info" data-ref-filename="_pdq_t..pdq_tx_info">pdq_tx_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::tx_txq" title='(anonymous struct)::tx_txq' data-ref="(anonymous)::tx_txq" data-ref-filename="(anonymous)..tx_txq">tx_txq</a>);</td></tr>
<tr><th id="1229">1229</th><td>    <a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_flags" title='_pdq_t::pdq_flags' data-ref="_pdq_t::pdq_flags" data-ref-filename="_pdq_t..pdq_flags">pdq_flags</a> &amp;= ~(<a class="macro" href="pdqreg.h.html#464" title="0x0020" data-ref="_M/PDQ_TXOK">PDQ_TXOK</a>|<a class="macro" href="pdqreg.h.html#467" title="0x0100" data-ref="_M/PDQ_IS_ONRING">PDQ_IS_ONRING</a>|<a class="macro" href="pdqreg.h.html#466" title="0x0080" data-ref="_M/PDQ_IS_FDX">PDQ_IS_FDX</a>);</td></tr>
<tr><th id="1230">1230</th><td>    <span class='error' title="use of undeclared identifier &apos;buffers&apos;">buffers</span> = (<span class='error' title="use of undeclared identifier &apos;PDQ_OS_DATABUF_T&apos;">PDQ_OS_DATABUF_T</span> **<span class='error' title="expected expression">)</span> pdq-&gt;pdq_rx_info.rx_buffers;</td></tr>
<tr><th id="1231">1231</th><td>    <b>for</b> (<a class="local col3 ref" href="#113idx" title='idx' data-ref="113idx" data-ref-filename="113idx">idx</a> = <var>0</var>; <a class="local col3 ref" href="#113idx" title='idx' data-ref="113idx" data-ref-filename="113idx">idx</a> &lt; <a class="macro" href="pdqreg.h.html#50" title="((sizeof(pdq-&gt;pdq_dbp-&gt;pdqdb_receives) / sizeof(pdq-&gt;pdq_dbp-&gt;pdqdb_receives[0])))" data-ref="_M/PDQ_RING_SIZE">PDQ_RING_SIZE</a>(<a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_dbp" title='_pdq_t::pdq_dbp' data-ref="_pdq_t::pdq_dbp" data-ref-filename="_pdq_t..pdq_dbp">pdq_dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_receives" title='(anonymous struct)::pdqdb_receives' data-ref="(anonymous)::pdqdb_receives" data-ref-filename="(anonymous)..pdqdb_receives">pdqdb_receives</a>); <a class="local col3 ref" href="#113idx" title='idx' data-ref="113idx" data-ref-filename="113idx">idx</a>++) {</td></tr>
<tr><th id="1232">1232</th><td>	<b>if</b> (<span class='error' title="use of undeclared identifier &apos;buffers&apos;">buffers</span>[idx] != <span class='error' title="use of undeclared identifier &apos;NULL&apos;">NULL</span>) {</td></tr>
<tr><th id="1233">1233</th><td>	    <span class='error' title="implicit declaration of function &apos;PDQ_OS_DATABUF_FREE&apos; is invalid in C99">PDQ_OS_DATABUF_FREE</span>(pdq, <span class='error' title="use of undeclared identifier &apos;buffers&apos;">buffers</span>[idx]);</td></tr>
<tr><th id="1234">1234</th><td>	    <span class='error' title="use of undeclared identifier &apos;buffers&apos;">buffers</span>[idx] = <span class='error' title="use of undeclared identifier &apos;NULL&apos;">NULL</span>;</td></tr>
<tr><th id="1235">1235</th><td>	}</td></tr>
<tr><th id="1236">1236</th><td>    }</td></tr>
<tr><th id="1237">1237</th><td>    <a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_rx_info" title='_pdq_t::pdq_rx_info' data-ref="_pdq_t::pdq_rx_info" data-ref-filename="_pdq_t..pdq_rx_info">pdq_rx_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::rx_free" title='(anonymous struct)::rx_free' data-ref="(anonymous)::rx_free" data-ref-filename="(anonymous)..rx_free">rx_free</a> = <a class="macro" href="pdqreg.h.html#52" title="(((sizeof(pdq-&gt;pdq_dbp-&gt;pdqdb_receives) / sizeof(pdq-&gt;pdq_dbp-&gt;pdqdb_receives[0]))) - 1)" data-ref="_M/PDQ_RING_MASK">PDQ_RING_MASK</a>(<a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_dbp" title='_pdq_t::pdq_dbp' data-ref="_pdq_t::pdq_dbp" data-ref-filename="_pdq_t..pdq_dbp">pdq_dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_receives" title='(anonymous struct)::pdqdb_receives' data-ref="(anonymous)::pdqdb_receives" data-ref-filename="(anonymous)..pdqdb_receives">pdqdb_receives</a>);</td></tr>
<tr><th id="1238">1238</th><td>    <span class='error' title="use of undeclared identifier &apos;buffers&apos;">buffers</span> = (<span class='error' title="use of undeclared identifier &apos;PDQ_OS_DATABUF_T&apos;">PDQ_OS_DATABUF_T</span> **<span class='error' title="expected expression">)</span> pdq-&gt;pdq_host_smt_info.rx_buffers;</td></tr>
<tr><th id="1239">1239</th><td>    <b>for</b> (<a class="local col3 ref" href="#113idx" title='idx' data-ref="113idx" data-ref-filename="113idx">idx</a> = <var>0</var>; <a class="local col3 ref" href="#113idx" title='idx' data-ref="113idx" data-ref-filename="113idx">idx</a> &lt; <a class="macro" href="pdqreg.h.html#50" title="((sizeof(pdq-&gt;pdq_dbp-&gt;pdqdb_host_smt) / sizeof(pdq-&gt;pdq_dbp-&gt;pdqdb_host_smt[0])))" data-ref="_M/PDQ_RING_SIZE">PDQ_RING_SIZE</a>(<a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_dbp" title='_pdq_t::pdq_dbp' data-ref="_pdq_t::pdq_dbp" data-ref-filename="_pdq_t..pdq_dbp">pdq_dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_host_smt" title='(anonymous struct)::pdqdb_host_smt' data-ref="(anonymous)::pdqdb_host_smt" data-ref-filename="(anonymous)..pdqdb_host_smt">pdqdb_host_smt</a>); <a class="local col3 ref" href="#113idx" title='idx' data-ref="113idx" data-ref-filename="113idx">idx</a>++) {</td></tr>
<tr><th id="1240">1240</th><td>	<b>if</b> (<span class='error' title="use of undeclared identifier &apos;buffers&apos;">buffers</span>[idx] != <span class='error' title="use of undeclared identifier &apos;NULL&apos;">NULL</span>) {</td></tr>
<tr><th id="1241">1241</th><td>	    <span class='error' title="implicit declaration of function &apos;PDQ_OS_DATABUF_FREE&apos; is invalid in C99">PDQ_OS_DATABUF_FREE</span>(pdq, <span class='error' title="use of undeclared identifier &apos;buffers&apos;">buffers</span>[idx]);</td></tr>
<tr><th id="1242">1242</th><td>	    <span class='error' title="use of undeclared identifier &apos;buffers&apos;">buffers</span>[idx] = <span class='error' title="use of undeclared identifier &apos;NULL&apos;">NULL</span>;</td></tr>
<tr><th id="1243">1243</th><td>	}</td></tr>
<tr><th id="1244">1244</th><td>    }</td></tr>
<tr><th id="1245">1245</th><td>    <a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_host_smt_info" title='_pdq_t::pdq_host_smt_info' data-ref="_pdq_t::pdq_host_smt_info" data-ref-filename="_pdq_t..pdq_host_smt_info">pdq_host_smt_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::rx_free" title='(anonymous struct)::rx_free' data-ref="(anonymous)::rx_free" data-ref-filename="(anonymous)..rx_free">rx_free</a> = <a class="macro" href="pdqreg.h.html#52" title="(((sizeof(pdq-&gt;pdq_dbp-&gt;pdqdb_host_smt) / sizeof(pdq-&gt;pdq_dbp-&gt;pdqdb_host_smt[0]))) - 1)" data-ref="_M/PDQ_RING_MASK">PDQ_RING_MASK</a>(<a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_dbp" title='_pdq_t::pdq_dbp' data-ref="_pdq_t::pdq_dbp" data-ref-filename="_pdq_t..pdq_dbp">pdq_dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_host_smt" title='(anonymous struct)::pdqdb_host_smt' data-ref="(anonymous)::pdqdb_host_smt" data-ref-filename="(anonymous)..pdqdb_host_smt">pdqdb_host_smt</a>);</td></tr>
<tr><th id="1246">1246</th><td></td></tr>
<tr><th id="1247">1247</th><td>    <i>/*</i></td></tr>
<tr><th id="1248">1248</th><td><i>     * Reset the consumer indexes to 0.</i></td></tr>
<tr><th id="1249">1249</th><td><i>     */</i></td></tr>
<tr><th id="1250">1250</th><td>    <a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_cbp" title='_pdq_t::pdq_cbp' data-ref="_pdq_t::pdq_cbp" data-ref-filename="_pdq_t..pdq_cbp">pdq_cbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqcb_receives" title='(anonymous struct)::pdqcb_receives' data-ref="(anonymous)::pdqcb_receives" data-ref-filename="(anonymous)..pdqcb_receives">pdqcb_receives</a> = <var>0</var>;</td></tr>
<tr><th id="1251">1251</th><td>    <a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_cbp" title='_pdq_t::pdq_cbp' data-ref="_pdq_t::pdq_cbp" data-ref-filename="_pdq_t..pdq_cbp">pdq_cbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqcb_transmits" title='(anonymous struct)::pdqcb_transmits' data-ref="(anonymous)::pdqcb_transmits" data-ref-filename="(anonymous)..pdqcb_transmits">pdqcb_transmits</a> = <var>0</var>;</td></tr>
<tr><th id="1252">1252</th><td>    <a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_cbp" title='_pdq_t::pdq_cbp' data-ref="_pdq_t::pdq_cbp" data-ref-filename="_pdq_t..pdq_cbp">pdq_cbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqcb_host_smt" title='(anonymous struct)::pdqcb_host_smt' data-ref="(anonymous)::pdqcb_host_smt" data-ref-filename="(anonymous)..pdqcb_host_smt">pdqcb_host_smt</a> = <var>0</var>;</td></tr>
<tr><th id="1253">1253</th><td>    <a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_cbp" title='_pdq_t::pdq_cbp' data-ref="_pdq_t::pdq_cbp" data-ref-filename="_pdq_t..pdq_cbp">pdq_cbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqcb_unsolicited_event" title='(anonymous struct)::pdqcb_unsolicited_event' data-ref="(anonymous)::pdqcb_unsolicited_event" data-ref-filename="(anonymous)..pdqcb_unsolicited_event">pdqcb_unsolicited_event</a> = <var>0</var>;</td></tr>
<tr><th id="1254">1254</th><td>    <a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_cbp" title='_pdq_t::pdq_cbp' data-ref="_pdq_t::pdq_cbp" data-ref-filename="_pdq_t..pdq_cbp">pdq_cbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqcb_command_response" title='(anonymous struct)::pdqcb_command_response' data-ref="(anonymous)::pdqcb_command_response" data-ref-filename="(anonymous)..pdqcb_command_response">pdqcb_command_response</a> = <var>0</var>;</td></tr>
<tr><th id="1255">1255</th><td>    <a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_cbp" title='_pdq_t::pdq_cbp' data-ref="_pdq_t::pdq_cbp" data-ref-filename="_pdq_t..pdq_cbp">pdq_cbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqcb_command_request" title='(anonymous struct)::pdqcb_command_request' data-ref="(anonymous)::pdqcb_command_request" data-ref-filename="(anonymous)..pdqcb_command_request">pdqcb_command_request</a> = <var>0</var>;</td></tr>
<tr><th id="1256">1256</th><td>    <a class="macro" href="pdqvar.h.html#477" title="do { } while(0)" data-ref="_M/PDQ_OS_CONSUMER_PRESYNC">PDQ_OS_CONSUMER_PRESYNC</a>(pdq);</td></tr>
<tr><th id="1257">1257</th><td></td></tr>
<tr><th id="1258">1258</th><td>    <i>/*</i></td></tr>
<tr><th id="1259">1259</th><td><i>     * Reset the producer and completion indexes to 0.</i></td></tr>
<tr><th id="1260">1260</th><td><i>     */</i></td></tr>
<tr><th id="1261">1261</th><td>    <a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_command_info" title='_pdq_t::pdq_command_info' data-ref="_pdq_t::pdq_command_info" data-ref-filename="_pdq_t..pdq_command_info">pdq_command_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_request_producer" title='(anonymous struct)::ci_request_producer' data-ref="(anonymous)::ci_request_producer" data-ref-filename="(anonymous)..ci_request_producer">ci_request_producer</a> = <var>0</var>;</td></tr>
<tr><th id="1262">1262</th><td>    <a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_command_info" title='_pdq_t::pdq_command_info' data-ref="_pdq_t::pdq_command_info" data-ref-filename="_pdq_t..pdq_command_info">pdq_command_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_response_producer" title='(anonymous struct)::ci_response_producer' data-ref="(anonymous)::ci_response_producer" data-ref-filename="(anonymous)..ci_response_producer">ci_response_producer</a> = <var>0</var>;</td></tr>
<tr><th id="1263">1263</th><td>    <a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_command_info" title='_pdq_t::pdq_command_info' data-ref="_pdq_t::pdq_command_info" data-ref-filename="_pdq_t..pdq_command_info">pdq_command_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_request_completion" title='(anonymous struct)::ci_request_completion' data-ref="(anonymous)::ci_request_completion" data-ref-filename="(anonymous)..ci_request_completion">ci_request_completion</a> = <var>0</var>;</td></tr>
<tr><th id="1264">1264</th><td>    <a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_command_info" title='_pdq_t::pdq_command_info' data-ref="_pdq_t::pdq_command_info" data-ref-filename="_pdq_t..pdq_command_info">pdq_command_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_response_completion" title='(anonymous struct)::ci_response_completion' data-ref="(anonymous)::ci_response_completion" data-ref-filename="(anonymous)..ci_response_completion">ci_response_completion</a> = <var>0</var>;</td></tr>
<tr><th id="1265">1265</th><td>    <a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_unsolicited_info" title='_pdq_t::pdq_unsolicited_info' data-ref="_pdq_t::pdq_unsolicited_info" data-ref-filename="_pdq_t..pdq_unsolicited_info">pdq_unsolicited_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::ui_producer" title='(anonymous struct)::ui_producer' data-ref="(anonymous)::ui_producer" data-ref-filename="(anonymous)..ui_producer">ui_producer</a> = <var>0</var>;</td></tr>
<tr><th id="1266">1266</th><td>    <a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_unsolicited_info" title='_pdq_t::pdq_unsolicited_info' data-ref="_pdq_t::pdq_unsolicited_info" data-ref-filename="_pdq_t..pdq_unsolicited_info">pdq_unsolicited_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::ui_completion" title='(anonymous struct)::ui_completion' data-ref="(anonymous)::ui_completion" data-ref-filename="(anonymous)..ui_completion">ui_completion</a> = <var>0</var>;</td></tr>
<tr><th id="1267">1267</th><td>    <a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_rx_info" title='_pdq_t::pdq_rx_info' data-ref="_pdq_t::pdq_rx_info" data-ref-filename="_pdq_t..pdq_rx_info">pdq_rx_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::rx_producer" title='(anonymous struct)::rx_producer' data-ref="(anonymous)::rx_producer" data-ref-filename="(anonymous)..rx_producer">rx_producer</a> = <var>0</var>;</td></tr>
<tr><th id="1268">1268</th><td>    <a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_rx_info" title='_pdq_t::pdq_rx_info' data-ref="_pdq_t::pdq_rx_info" data-ref-filename="_pdq_t..pdq_rx_info">pdq_rx_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::rx_completion" title='(anonymous struct)::rx_completion' data-ref="(anonymous)::rx_completion" data-ref-filename="(anonymous)..rx_completion">rx_completion</a> = <var>0</var>;</td></tr>
<tr><th id="1269">1269</th><td>    <a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_tx_info" title='_pdq_t::pdq_tx_info' data-ref="_pdq_t::pdq_tx_info" data-ref-filename="_pdq_t..pdq_tx_info">pdq_tx_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::tx_producer" title='(anonymous struct)::tx_producer' data-ref="(anonymous)::tx_producer" data-ref-filename="(anonymous)..tx_producer">tx_producer</a> = <var>0</var>;</td></tr>
<tr><th id="1270">1270</th><td>    <a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_tx_info" title='_pdq_t::pdq_tx_info' data-ref="_pdq_t::pdq_tx_info" data-ref-filename="_pdq_t..pdq_tx_info">pdq_tx_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::tx_completion" title='(anonymous struct)::tx_completion' data-ref="(anonymous)::tx_completion" data-ref-filename="(anonymous)..tx_completion">tx_completion</a> = <var>0</var>;</td></tr>
<tr><th id="1271">1271</th><td>    <a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_host_smt_info" title='_pdq_t::pdq_host_smt_info' data-ref="_pdq_t::pdq_host_smt_info" data-ref-filename="_pdq_t..pdq_host_smt_info">pdq_host_smt_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::rx_producer" title='(anonymous struct)::rx_producer' data-ref="(anonymous)::rx_producer" data-ref-filename="(anonymous)..rx_producer">rx_producer</a> = <var>0</var>;</td></tr>
<tr><th id="1272">1272</th><td>    <a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_host_smt_info" title='_pdq_t::pdq_host_smt_info' data-ref="_pdq_t::pdq_host_smt_info" data-ref-filename="_pdq_t..pdq_host_smt_info">pdq_host_smt_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::rx_completion" title='(anonymous struct)::rx_completion' data-ref="(anonymous)::rx_completion" data-ref-filename="(anonymous)..rx_completion">rx_completion</a> = <var>0</var>;</td></tr>
<tr><th id="1273">1273</th><td></td></tr>
<tr><th id="1274">1274</th><td>    <a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_command_info" title='_pdq_t::pdq_command_info' data-ref="_pdq_t::pdq_command_info" data-ref-filename="_pdq_t..pdq_command_info">pdq_command_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_command_active" title='(anonymous struct)::ci_command_active' data-ref="(anonymous)::ci_command_active" data-ref-filename="(anonymous)..ci_command_active">ci_command_active</a> = <var>0</var>;</td></tr>
<tr><th id="1275">1275</th><td>    pdq-&gt;pdq_unsolicited_info.ui_free = <a class="macro" href="pdqreg.h.html#391" title="(PDQ_OS_PAGESIZE / 512)" data-ref="_M/PDQ_NUM_UNSOLICITED_EVENTS">PDQ_NUM_UNSOLICITED_EVENTS</a>;</td></tr>
<tr><th id="1276">1276</th><td>    <a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_tx_info" title='_pdq_t::pdq_tx_info' data-ref="_pdq_t::pdq_tx_info" data-ref-filename="_pdq_t..pdq_tx_info">pdq_tx_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::tx_free" title='(anonymous struct)::tx_free' data-ref="(anonymous)::tx_free" data-ref-filename="(anonymous)..tx_free">tx_free</a> = <a class="macro" href="pdqreg.h.html#52" title="(((sizeof(pdq-&gt;pdq_dbp-&gt;pdqdb_transmits) / sizeof(pdq-&gt;pdq_dbp-&gt;pdqdb_transmits[0]))) - 1)" data-ref="_M/PDQ_RING_MASK">PDQ_RING_MASK</a>(<a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_dbp" title='_pdq_t::pdq_dbp' data-ref="_pdq_t::pdq_dbp" data-ref-filename="_pdq_t..pdq_dbp">pdq_dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_transmits" title='(anonymous struct)::pdqdb_transmits' data-ref="(anonymous)::pdqdb_transmits" data-ref-filename="(anonymous)..pdqdb_transmits">pdqdb_transmits</a>);</td></tr>
<tr><th id="1277">1277</th><td></td></tr>
<tr><th id="1278">1278</th><td>    <i>/*</i></td></tr>
<tr><th id="1279">1279</th><td><i>     * Allow the DEFPA to do DMA.  Then program the physical</i></td></tr>
<tr><th id="1280">1280</th><td><i>     * addresses of the consumer and descriptor blocks.</i></td></tr>
<tr><th id="1281">1281</th><td><i>     */</i></td></tr>
<tr><th id="1282">1282</th><td>    <b>if</b> (<a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_type" title='_pdq_t::pdq_type' data-ref="_pdq_t::pdq_type" data-ref-filename="_pdq_t..pdq_type">pdq_type</a> == <a class="enum" href="pdqvar.h.html#PDQ_DEFPA" title='PDQ_DEFPA' data-ref="PDQ_DEFPA" data-ref-filename="PDQ_DEFPA">PDQ_DEFPA</a>) {</td></tr>
<tr><th id="1283">1283</th><td><u>#<span data-ppcond="1283">ifdef</span> <span class="macro" data-ref="_M/PDQTEST">PDQTEST</span></u></td></tr>
<tr><th id="1284">1284</th><td>	PDQ_CSR_WRITE(&amp;pdq-&gt;pdq_pci_csrs, csr_pfi_mode_control,</td></tr>
<tr><th id="1285">1285</th><td>		      PDQ_PFI_MODE_DMA_ENABLE);</td></tr>
<tr><th id="1286">1286</th><td><u>#<span data-ppcond="1283">else</span></u></td></tr>
<tr><th id="1287">1287</th><td>	<span class='error' title="implicit declaration of function &apos;PDQ_CSR_WRITE&apos; is invalid in C99">PDQ_CSR_WRITE</span>(&amp;pdq-&gt;pdq_pci_csrs, <span class='error' title="use of undeclared identifier &apos;csr_pfi_mode_control&apos;">csr_pfi_mode_control</span>,</td></tr>
<tr><th id="1288">1288</th><td>		      <a class="macro" href="pdqreg.h.html#111" title="0x01" data-ref="_M/PDQ_PFI_MODE_DMA_ENABLE">PDQ_PFI_MODE_DMA_ENABLE</a></td></tr>
<tr><th id="1289">1289</th><td>	    <i>/*|PDQ_PFI_MODE_PFI_PCI_INTR*/</i>|<a class="macro" href="pdqreg.h.html#113" title="0x04" data-ref="_M/PDQ_PFI_MODE_PDQ_PCI_INTR">PDQ_PFI_MODE_PDQ_PCI_INTR</a>);</td></tr>
<tr><th id="1290">1290</th><td><u>#<span data-ppcond="1283">endif</span></u></td></tr>
<tr><th id="1291">1291</th><td>    }</td></tr>
<tr><th id="1292">1292</th><td></td></tr>
<tr><th id="1293">1293</th><td>    <i>/*</i></td></tr>
<tr><th id="1294">1294</th><td><i>     * Make sure the unsolicited queue has events ...</i></td></tr>
<tr><th id="1295">1295</th><td><i>     */</i></td></tr>
<tr><th id="1296">1296</th><td>    <a class="tu ref fn" href="#pdq_process_unsolicited_events" title='pdq_process_unsolicited_events' data-use='c' data-ref="pdq_process_unsolicited_events" data-ref-filename="pdq_process_unsolicited_events">pdq_process_unsolicited_events</a>(<a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>);</td></tr>
<tr><th id="1297">1297</th><td></td></tr>
<tr><th id="1298">1298</th><td>    <b>if</b> ((pdq-&gt;pdq_type == PDQ_DEFEA &amp;&amp; pdq-&gt;pdq_chip_rev == PDQ_CHIP_REV_E)</td></tr>
<tr><th id="1299">1299</th><td>	    || pdq-&gt;pdq_type == PDQ_DEFTA)</td></tr>
<tr><th id="1300">1300</th><td>	<span class='error' title="implicit declaration of function &apos;PDQ_CSR_WRITE&apos; is invalid in C99">PDQ_CSR_WRITE</span>(csrs, <span class='error' title="use of undeclared identifier &apos;csr_port_data_b&apos;">csr_port_data_b</span>, PDQ_DMA_BURST_16LW);</td></tr>
<tr><th id="1301">1301</th><td>    <b>else</b></td></tr>
<tr><th id="1302">1302</th><td>	PDQ_CSR_WRITE(csrs, <span class='error' title="use of undeclared identifier &apos;csr_port_data_b&apos;">csr_port_data_b</span>, PDQ_DMA_BURST_8LW);</td></tr>
<tr><th id="1303">1303</th><td>    PDQ_CSR_WRITE(csrs, <span class='error' title="use of undeclared identifier &apos;csr_port_data_a&apos;">csr_port_data_a</span>, PDQ_SUB_CMD_DMA_BURST_SIZE_SET);</td></tr>
<tr><th id="1304">1304</th><td>    <a class="tu ref fn" href="#pdq_do_port_control" title='pdq_do_port_control' data-use='c' data-ref="pdq_do_port_control" data-ref-filename="pdq_do_port_control">pdq_do_port_control</a>(<a class="local col0 ref" href="#110csrs" title='csrs' data-ref="110csrs" data-ref-filename="110csrs">csrs</a>, <a class="macro" href="pdqreg.h.html#195" title="0x0001" data-ref="_M/PDQ_PCTL_SUB_CMD">PDQ_PCTL_SUB_CMD</a>);</td></tr>
<tr><th id="1305">1305</th><td></td></tr>
<tr><th id="1306">1306</th><td>    <i>/*</i></td></tr>
<tr><th id="1307">1307</th><td><i>     * Make sure there isn't stale information in the caches before</i></td></tr>
<tr><th id="1308">1308</th><td><i>     * tell the adapter about the blocks it's going to use.</i></td></tr>
<tr><th id="1309">1309</th><td><i>     */</i></td></tr>
<tr><th id="1310">1310</th><td>    <a class="macro" href="pdqvar.h.html#477" title="do { } while(0)" data-ref="_M/PDQ_OS_CONSUMER_PRESYNC">PDQ_OS_CONSUMER_PRESYNC</a>(pdq);</td></tr>
<tr><th id="1311">1311</th><td></td></tr>
<tr><th id="1312">1312</th><td>    PDQ_CSR_WRITE(csrs, <span class='error' title="use of undeclared identifier &apos;csr_port_data_b&apos;">csr_port_data_b</span>, <var>0</var>);</td></tr>
<tr><th id="1313">1313</th><td>    PDQ_CSR_WRITE(csrs, <span class='error' title="use of undeclared identifier &apos;csr_port_data_a&apos;">csr_port_data_a</span>, pdq-&gt;pdq_pa_consumer_block);</td></tr>
<tr><th id="1314">1314</th><td>    <a class="tu ref fn" href="#pdq_do_port_control" title='pdq_do_port_control' data-use='c' data-ref="pdq_do_port_control" data-ref-filename="pdq_do_port_control">pdq_do_port_control</a>(<a class="local col0 ref" href="#110csrs" title='csrs' data-ref="110csrs" data-ref-filename="110csrs">csrs</a>, <a class="macro" href="pdqreg.h.html#189" title="0x0040" data-ref="_M/PDQ_PCTL_CONSUMER_BLOCK">PDQ_PCTL_CONSUMER_BLOCK</a>);</td></tr>
<tr><th id="1315">1315</th><td></td></tr>
<tr><th id="1316">1316</th><td>    PDQ_CSR_WRITE(csrs, <span class='error' title="use of undeclared identifier &apos;csr_port_data_b&apos;">csr_port_data_b</span>, <var>0</var>);</td></tr>
<tr><th id="1317">1317</th><td>    PDQ_CSR_WRITE(csrs, <span class='error' title="use of undeclared identifier &apos;csr_port_data_a&apos;">csr_port_data_a</span>, pdq-&gt;pdq_pa_descriptor_block | <a class="macro" href="pdqreg.h.html#186" title="0x02" data-ref="_M/PDQ_DMA_INIT_LW_BSWAP_DATA">PDQ_DMA_INIT_LW_BSWAP_DATA</a>);</td></tr>
<tr><th id="1318">1318</th><td>    <a class="tu ref fn" href="#pdq_do_port_control" title='pdq_do_port_control' data-use='c' data-ref="pdq_do_port_control" data-ref-filename="pdq_do_port_control">pdq_do_port_control</a>(<a class="local col0 ref" href="#110csrs" title='csrs' data-ref="110csrs" data-ref-filename="110csrs">csrs</a>, <a class="macro" href="pdqreg.h.html#185" title="0x0100" data-ref="_M/PDQ_PCTL_DMA_INIT">PDQ_PCTL_DMA_INIT</a>);</td></tr>
<tr><th id="1319">1319</th><td></td></tr>
<tr><th id="1320">1320</th><td>    <b>for</b> (<a class="local col1 ref" href="#111cnt" title='cnt' data-ref="111cnt" data-ref-filename="111cnt">cnt</a> = <var>0</var>; <a class="local col1 ref" href="#111cnt" title='cnt' data-ref="111cnt" data-ref-filename="111cnt">cnt</a> &lt; <var>1000</var>; <a class="local col1 ref" href="#111cnt" title='cnt' data-ref="111cnt" data-ref-filename="111cnt">cnt</a>++) {</td></tr>
<tr><th id="1321">1321</th><td>	state = <a class="macro" href="pdqreg.h.html#226" title="((pdq_state_t) (((PDQ_CSR_READ(csrs, csr_port_status)) &gt;&gt; 8) &amp; 0x07))" data-ref="_M/PDQ_PSTS_ADAPTER_STATE">PDQ_PSTS_ADAPTER_STATE</a>(PDQ_CSR_READ(csrs, <span class='error' title="use of undeclared identifier &apos;csr_port_status&apos;">csr_port_status</span>));</td></tr>
<tr><th id="1322">1322</th><td>	<b>if</b> (<a class="local col9 ref" href="#109state" title='state' data-ref="109state" data-ref-filename="109state">state</a> == <a class="enum" href="pdqvar.h.html#PDQS_HALTED" title='PDQS_HALTED' data-ref="PDQS_HALTED" data-ref-filename="PDQS_HALTED">PDQS_HALTED</a>) {</td></tr>
<tr><th id="1323">1323</th><td>	    <b>if</b> (<a class="local col2 ref" href="#112pass" title='pass' data-ref="112pass" data-ref-filename="112pass">pass</a> &gt; <var>0</var>)</td></tr>
<tr><th id="1324">1324</th><td>		<b>return</b> <a class="enum" href="pdqvar.h.html#PDQS_HALTED" title='PDQS_HALTED' data-ref="PDQS_HALTED" data-ref-filename="PDQS_HALTED">PDQS_HALTED</a>;</td></tr>
<tr><th id="1325">1325</th><td>	    <a class="local col2 ref" href="#112pass" title='pass' data-ref="112pass" data-ref-filename="112pass">pass</a> = <var>1</var>;</td></tr>
<tr><th id="1326">1326</th><td>	    <b>goto</b> <a class="lbl" href="#114restart" data-ref="114restart" data-ref-filename="114restart">restart</a>;</td></tr>
<tr><th id="1327">1327</th><td>	}</td></tr>
<tr><th id="1328">1328</th><td>	<b>if</b> (<a class="local col9 ref" href="#109state" title='state' data-ref="109state" data-ref-filename="109state">state</a> == <a class="enum" href="pdqvar.h.html#PDQS_DMA_AVAILABLE" title='PDQS_DMA_AVAILABLE' data-ref="PDQS_DMA_AVAILABLE" data-ref-filename="PDQS_DMA_AVAILABLE">PDQS_DMA_AVAILABLE</a>) {</td></tr>
<tr><th id="1329">1329</th><td>	    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"Transition to DMA Available took %d spins\n"</q>, cnt));</td></tr>
<tr><th id="1330">1330</th><td>	    <b>break</b>;</td></tr>
<tr><th id="1331">1331</th><td>	}</td></tr>
<tr><th id="1332">1332</th><td>	<span class='error' title="implicit declaration of function &apos;PDQ_OS_USEC_DELAY&apos; is invalid in C99"><a class="ref fn" href="#1144" title='PDQ_OS_USEC_DELAY' data-ref="PDQ_OS_USEC_DELAY" data-ref-filename="PDQ_OS_USEC_DELAY">PDQ_OS_USEC_DELAY</a></span>(<var>1000</var>);</td></tr>
<tr><th id="1333">1333</th><td>    }</td></tr>
<tr><th id="1334">1334</th><td>    <a class="macro" href="pdqreg.h.html#47" title="do { } while(0)" data-ref="_M/PDQ_ASSERT">PDQ_ASSERT</a>(state == PDQS_DMA_AVAILABLE);</td></tr>
<tr><th id="1335">1335</th><td></td></tr>
<tr><th id="1336">1336</th><td>    PDQ_CSR_WRITE(csrs, <span class='error' title="use of undeclared identifier &apos;csr_host_int_type_0&apos;">csr_host_int_type_0</span>, <var>0xFF</var>);</td></tr>
<tr><th id="1337">1337</th><td>    <a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_intrmask" title='_pdq_t::pdq_intrmask' data-ref="_pdq_t::pdq_intrmask" data-ref-filename="_pdq_t..pdq_intrmask">pdq_intrmask</a> = <var>0</var>;</td></tr>
<tr><th id="1338">1338</th><td>      <i>/* PDQ_HOST_INT_STATE_CHANGE</i></td></tr>
<tr><th id="1339">1339</th><td><i>	|PDQ_HOST_INT_FATAL_ERROR|PDQ_HOST_INT_CMD_RSP_ENABLE</i></td></tr>
<tr><th id="1340">1340</th><td><i>	|PDQ_HOST_INT_UNSOL_ENABLE */</i>;</td></tr>
<tr><th id="1341">1341</th><td>    PDQ_CSR_WRITE(csrs, <span class='error' title="use of undeclared identifier &apos;csr_host_int_enable&apos;">csr_host_int_enable</span>, pdq-&gt;pdq_intrmask);</td></tr>
<tr><th id="1342">1342</th><td></td></tr>
<tr><th id="1343">1343</th><td>    <i>/*</i></td></tr>
<tr><th id="1344">1344</th><td><i>     * Any other command but START should be valid.</i></td></tr>
<tr><th id="1345">1345</th><td><i>     */</i></td></tr>
<tr><th id="1346">1346</th><td>    <a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_command_info" title='_pdq_t::pdq_command_info' data-ref="_pdq_t::pdq_command_info" data-ref-filename="_pdq_t..pdq_command_info">pdq_command_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_pending_commands" title='(anonymous struct)::ci_pending_commands' data-ref="(anonymous)::ci_pending_commands" data-ref-filename="(anonymous)..ci_pending_commands">ci_pending_commands</a> &amp;= ~(<a class="macro" href="pdqreg.h.html#53" title="(1L &lt;&lt; (pdq_uint32_t) (PDQC_START))" data-ref="_M/PDQ_BITMASK">PDQ_BITMASK</a>(<a class="enum" href="pdqreg.h.html#PDQC_START" title='PDQC_START' data-ref="PDQC_START" data-ref-filename="PDQC_START">PDQC_START</a>));</td></tr>
<tr><th id="1347">1347</th><td>    <b>if</b> (<a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_flags" title='_pdq_t::pdq_flags' data-ref="_pdq_t::pdq_flags" data-ref-filename="_pdq_t..pdq_flags">pdq_flags</a> &amp; <a class="macro" href="pdqreg.h.html#463" title="0x0010" data-ref="_M/PDQ_PRINTCHARS">PDQ_PRINTCHARS</a>)</td></tr>
<tr><th id="1348">1348</th><td>	<a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_command_info" title='_pdq_t::pdq_command_info' data-ref="_pdq_t::pdq_command_info" data-ref-filename="_pdq_t..pdq_command_info">pdq_command_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_pending_commands" title='(anonymous struct)::ci_pending_commands' data-ref="(anonymous)::ci_pending_commands" data-ref-filename="(anonymous)..ci_pending_commands">ci_pending_commands</a> |= <a class="macro" href="pdqreg.h.html#53" title="(1L &lt;&lt; (pdq_uint32_t) (PDQC_STATUS_CHARS_GET))" data-ref="_M/PDQ_BITMASK">PDQ_BITMASK</a>(<a class="enum" href="pdqreg.h.html#PDQC_STATUS_CHARS_GET" title='PDQC_STATUS_CHARS_GET' data-ref="PDQC_STATUS_CHARS_GET" data-ref-filename="PDQC_STATUS_CHARS_GET">PDQC_STATUS_CHARS_GET</a>);</td></tr>
<tr><th id="1349">1349</th><td>    <a class="tu ref fn" href="#pdq_queue_commands" title='pdq_queue_commands' data-use='c' data-ref="pdq_queue_commands" data-ref-filename="pdq_queue_commands">pdq_queue_commands</a>(<a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>);</td></tr>
<tr><th id="1350">1350</th><td></td></tr>
<tr><th id="1351">1351</th><td>    <b>if</b> (<a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_flags" title='_pdq_t::pdq_flags' data-ref="_pdq_t::pdq_flags" data-ref-filename="_pdq_t..pdq_flags">pdq_flags</a> &amp; <a class="macro" href="pdqreg.h.html#463" title="0x0010" data-ref="_M/PDQ_PRINTCHARS">PDQ_PRINTCHARS</a>) {</td></tr>
<tr><th id="1352">1352</th><td>	<i>/*</i></td></tr>
<tr><th id="1353">1353</th><td><i>	 * Now wait (up to 100ms) for the command(s) to finish.</i></td></tr>
<tr><th id="1354">1354</th><td><i>	 */</i></td></tr>
<tr><th id="1355">1355</th><td>	<b>for</b> (<a class="local col1 ref" href="#111cnt" title='cnt' data-ref="111cnt" data-ref-filename="111cnt">cnt</a> = <var>0</var>; <a class="local col1 ref" href="#111cnt" title='cnt' data-ref="111cnt" data-ref-filename="111cnt">cnt</a> &lt; <var>1000</var>; <a class="local col1 ref" href="#111cnt" title='cnt' data-ref="111cnt" data-ref-filename="111cnt">cnt</a>++) {</td></tr>
<tr><th id="1356">1356</th><td>	    <a class="macro" href="pdqvar.h.html#478" title="do { } while(0)" data-ref="_M/PDQ_OS_CONSUMER_POSTSYNC">PDQ_OS_CONSUMER_POSTSYNC</a>(pdq);</td></tr>
<tr><th id="1357">1357</th><td>	    <a class="tu ref fn" href="#pdq_process_command_responses" title='pdq_process_command_responses' data-use='c' data-ref="pdq_process_command_responses" data-ref-filename="pdq_process_command_responses">pdq_process_command_responses</a>(<a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>);</td></tr>
<tr><th id="1358">1358</th><td>	    <b>if</b> (<a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_command_info" title='_pdq_t::pdq_command_info' data-ref="_pdq_t::pdq_command_info" data-ref-filename="_pdq_t..pdq_command_info">pdq_command_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_response_producer" title='(anonymous struct)::ci_response_producer' data-ref="(anonymous)::ci_response_producer" data-ref-filename="(anonymous)..ci_response_producer">ci_response_producer</a> == <a class="local col8 ref" href="#108pdq" title='pdq' data-ref="108pdq" data-ref-filename="108pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_command_info" title='_pdq_t::pdq_command_info' data-ref="_pdq_t::pdq_command_info" data-ref-filename="_pdq_t..pdq_command_info">pdq_command_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_response_completion" title='(anonymous struct)::ci_response_completion' data-ref="(anonymous)::ci_response_completion" data-ref-filename="(anonymous)..ci_response_completion">ci_response_completion</a>)</td></tr>
<tr><th id="1359">1359</th><td>		<b>break</b>;</td></tr>
<tr><th id="1360">1360</th><td>	    <span class='error' title="implicit declaration of function &apos;PDQ_OS_USEC_DELAY&apos; is invalid in C99"><a class="ref fn" href="#1144" title='PDQ_OS_USEC_DELAY' data-ref="PDQ_OS_USEC_DELAY" data-ref-filename="PDQ_OS_USEC_DELAY">PDQ_OS_USEC_DELAY</a></span>(<var>1000</var>);</td></tr>
<tr><th id="1361">1361</th><td>	}</td></tr>
<tr><th id="1362">1362</th><td>	state = <a class="macro" href="pdqreg.h.html#226" title="((pdq_state_t) (((PDQ_CSR_READ(csrs, csr_port_status)) &gt;&gt; 8) &amp; 0x07))" data-ref="_M/PDQ_PSTS_ADAPTER_STATE">PDQ_PSTS_ADAPTER_STATE</a>(PDQ_CSR_READ(csrs, <span class='error' title="use of undeclared identifier &apos;csr_port_status&apos;">csr_port_status</span>));</td></tr>
<tr><th id="1363">1363</th><td>    }</td></tr>
<tr><th id="1364">1364</th><td></td></tr>
<tr><th id="1365">1365</th><td>    <b>return</b> <a class="local col9 ref" href="#109state" title='state' data-ref="109state" data-ref-filename="109state">state</a>;</td></tr>
<tr><th id="1366">1366</th><td>}</td></tr>
<tr><th id="1367">1367</th><td></td></tr>
<tr><th id="1368">1368</th><td><em>void</em></td></tr>
<tr><th id="1369">1369</th><td><dfn class="decl def fn" id="pdq_run" title='pdq_run' data-ref="pdq_run" data-ref-filename="pdq_run">pdq_run</dfn>(</td></tr>
<tr><th id="1370">1370</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_t" title='pdq_t' data-type='struct _pdq_t' data-ref="pdq_t" data-ref-filename="pdq_t">pdq_t</a> *<dfn class="local col5 decl" id="115pdq" title='pdq' data-type='pdq_t *' data-ref="115pdq" data-ref-filename="115pdq">pdq</dfn>)</td></tr>
<tr><th id="1371">1371</th><td>{</td></tr>
<tr><th id="1372">1372</th><td>    <em>const</em> <a class="typedef" href="pdqvar.h.html#pdq_csrs_t" title='pdq_csrs_t' data-type='struct _pdq_csrs_t' data-ref="pdq_csrs_t" data-ref-filename="pdq_csrs_t">pdq_csrs_t</a> * <em>const</em> <dfn class="local col6 decl" id="116csrs" title='csrs' data-type='const pdq_csrs_t *const' data-ref="116csrs" data-ref-filename="116csrs">csrs</dfn> = &amp;pdq-&gt;pdq_csrs;</td></tr>
<tr><th id="1373">1373</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_state_t" title='pdq_state_t' data-type='enum _pdq_state_t' data-ref="pdq_state_t" data-ref-filename="pdq_state_t">pdq_state_t</a> <dfn class="local col7 decl" id="117state" title='state' data-type='pdq_state_t' data-ref="117state" data-ref-filename="117state">state</dfn>;</td></tr>
<tr><th id="1374">1374</th><td></td></tr>
<tr><th id="1375">1375</th><td>    state = <a class="macro" href="pdqreg.h.html#226" title="((pdq_state_t) (((PDQ_CSR_READ(csrs, csr_port_status)) &gt;&gt; 8) &amp; 0x07))" data-ref="_M/PDQ_PSTS_ADAPTER_STATE">PDQ_PSTS_ADAPTER_STATE</a>(<span class='error' title="implicit declaration of function &apos;PDQ_CSR_READ&apos; is invalid in C99">PDQ_CSR_READ</span>(csrs, <span class='error' title="use of undeclared identifier &apos;csr_port_status&apos;">csr_port_status</span>));</td></tr>
<tr><th id="1376">1376</th><td>    <a class="macro" href="pdqreg.h.html#47" title="do { } while(0)" data-ref="_M/PDQ_ASSERT">PDQ_ASSERT</a>(state != PDQS_DMA_UNAVAILABLE);</td></tr>
<tr><th id="1377">1377</th><td>    <a class="macro" href="pdqreg.h.html#47" title="do { } while(0)" data-ref="_M/PDQ_ASSERT">PDQ_ASSERT</a>(state != PDQS_RESET);</td></tr>
<tr><th id="1378">1378</th><td>    <a class="macro" href="pdqreg.h.html#47" title="do { } while(0)" data-ref="_M/PDQ_ASSERT">PDQ_ASSERT</a>(state != PDQS_HALTED);</td></tr>
<tr><th id="1379">1379</th><td>    <a class="macro" href="pdqreg.h.html#47" title="do { } while(0)" data-ref="_M/PDQ_ASSERT">PDQ_ASSERT</a>(state != PDQS_UPGRADE);</td></tr>
<tr><th id="1380">1380</th><td>    <a class="macro" href="pdqreg.h.html#47" title="do { } while(0)" data-ref="_M/PDQ_ASSERT">PDQ_ASSERT</a>(state != PDQS_RING_MEMBER);</td></tr>
<tr><th id="1381">1381</th><td>    <b>switch</b> (<a class="local col7 ref" href="#117state" title='state' data-ref="117state" data-ref-filename="117state">state</a>) {</td></tr>
<tr><th id="1382">1382</th><td>	<b>case</b> <a class="enum" href="pdqvar.h.html#PDQS_DMA_AVAILABLE" title='PDQS_DMA_AVAILABLE' data-ref="PDQS_DMA_AVAILABLE" data-ref-filename="PDQS_DMA_AVAILABLE">PDQS_DMA_AVAILABLE</a>: {</td></tr>
<tr><th id="1383">1383</th><td>	    <i>/*</i></td></tr>
<tr><th id="1384">1384</th><td><i>	     * The PDQ after being reset screws up some of its state.</i></td></tr>
<tr><th id="1385">1385</th><td><i>	     * So we need to clear all the errors/interrupts so the real</i></td></tr>
<tr><th id="1386">1386</th><td><i>	     * ones will get through.</i></td></tr>
<tr><th id="1387">1387</th><td><i>	     */</i></td></tr>
<tr><th id="1388">1388</th><td>	    <span class='error' title="implicit declaration of function &apos;PDQ_CSR_WRITE&apos; is invalid in C99">PDQ_CSR_WRITE</span>(csrs, <span class='error' title="use of undeclared identifier &apos;csr_host_int_type_0&apos;">csr_host_int_type_0</span>, <var>0xFF</var>);</td></tr>
<tr><th id="1389">1389</th><td>	    <a class="local col5 ref" href="#115pdq" title='pdq' data-ref="115pdq" data-ref-filename="115pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_intrmask" title='_pdq_t::pdq_intrmask' data-ref="_pdq_t::pdq_intrmask" data-ref-filename="_pdq_t..pdq_intrmask">pdq_intrmask</a> = <a class="macro" href="pdqreg.h.html#241" title="0x10" data-ref="_M/PDQ_HOST_INT_STATE_CHANGE">PDQ_HOST_INT_STATE_CHANGE</a></td></tr>
<tr><th id="1390">1390</th><td>		|<a class="macro" href="pdqreg.h.html#242" title="0x08" data-ref="_M/PDQ_HOST_INT_XMT_DATA_FLUSH">PDQ_HOST_INT_XMT_DATA_FLUSH</a>|<a class="macro" href="pdqreg.h.html#246" title="0x07" data-ref="_M/PDQ_HOST_INT_FATAL_ERROR">PDQ_HOST_INT_FATAL_ERROR</a></td></tr>
<tr><th id="1391">1391</th><td>		|<a class="macro" href="pdqreg.h.html#235" title="0x08000000ul" data-ref="_M/PDQ_HOST_INT_CMD_RSP_ENABLE">PDQ_HOST_INT_CMD_RSP_ENABLE</a>|<a class="macro" href="pdqreg.h.html#233" title="0x20000000ul" data-ref="_M/PDQ_HOST_INT_UNSOL_ENABLE">PDQ_HOST_INT_UNSOL_ENABLE</a></td></tr>
<tr><th id="1392">1392</th><td>		|<a class="macro" href="pdqreg.h.html#232" title="0x40000000ul" data-ref="_M/PDQ_HOST_INT_RX_ENABLE">PDQ_HOST_INT_RX_ENABLE</a>|<a class="macro" href="pdqreg.h.html#234" title="0x10000000ul" data-ref="_M/PDQ_HOST_INT_HOST_SMT_ENABLE">PDQ_HOST_INT_HOST_SMT_ENABLE</a>;</td></tr>
<tr><th id="1393">1393</th><td>	    PDQ_CSR_WRITE(csrs, <span class='error' title="use of undeclared identifier &apos;csr_host_int_enable&apos;">csr_host_int_enable</span>, pdq-&gt;pdq_intrmask);</td></tr>
<tr><th id="1394">1394</th><td>	    <i>/*</i></td></tr>
<tr><th id="1395">1395</th><td><i>	     * Set the MAC and address filters and start up the PDQ.</i></td></tr>
<tr><th id="1396">1396</th><td><i>	     */</i></td></tr>
<tr><th id="1397">1397</th><td>	    <a class="tu ref fn" href="#pdq_process_unsolicited_events" title='pdq_process_unsolicited_events' data-use='c' data-ref="pdq_process_unsolicited_events" data-ref-filename="pdq_process_unsolicited_events">pdq_process_unsolicited_events</a>(<a class="local col5 ref" href="#115pdq" title='pdq' data-ref="115pdq" data-ref-filename="115pdq">pdq</a>);</td></tr>
<tr><th id="1398">1398</th><td>	    <a class="tu ref fn" href="#pdq_process_received_data" title='pdq_process_received_data' data-use='c' data-ref="pdq_process_received_data" data-ref-filename="pdq_process_received_data">pdq_process_received_data</a>(<a class="local col5 ref" href="#115pdq" title='pdq' data-ref="115pdq" data-ref-filename="115pdq">pdq</a>, &amp;<a class="local col5 ref" href="#115pdq" title='pdq' data-ref="115pdq" data-ref-filename="115pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_rx_info" title='_pdq_t::pdq_rx_info' data-ref="_pdq_t::pdq_rx_info" data-ref-filename="_pdq_t..pdq_rx_info">pdq_rx_info</a>,</td></tr>
<tr><th id="1399">1399</th><td>				      <a class="local col5 ref" href="#115pdq" title='pdq' data-ref="115pdq" data-ref-filename="115pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_dbp" title='_pdq_t::pdq_dbp' data-ref="_pdq_t::pdq_dbp" data-ref-filename="_pdq_t..pdq_dbp">pdq_dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_receives" title='(anonymous struct)::pdqdb_receives' data-ref="(anonymous)::pdqdb_receives" data-ref-filename="(anonymous)..pdqdb_receives">pdqdb_receives</a>,</td></tr>
<tr><th id="1400">1400</th><td>				      <span class='error' title="implicit declaration of function &apos;le16toh&apos; is invalid in C99"><a class="ref fn" href="#1082" title='le16toh' data-ref="le16toh" data-ref-filename="le16toh">le16toh</a></span>(<a class="local col5 ref" href="#115pdq" title='pdq' data-ref="115pdq" data-ref-filename="115pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_cbp" title='_pdq_t::pdq_cbp' data-ref="_pdq_t::pdq_cbp" data-ref-filename="_pdq_t..pdq_cbp">pdq_cbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqcb_receives" title='(anonymous struct)::pdqcb_receives' data-ref="(anonymous)::pdqcb_receives" data-ref-filename="(anonymous)..pdqcb_receives">pdqcb_receives</a>),</td></tr>
<tr><th id="1401">1401</th><td>				      <a class="macro" href="pdqreg.h.html#52" title="(((sizeof(pdq-&gt;pdq_dbp-&gt;pdqdb_receives) / sizeof(pdq-&gt;pdq_dbp-&gt;pdqdb_receives[0]))) - 1)" data-ref="_M/PDQ_RING_MASK">PDQ_RING_MASK</a>(<a class="local col5 ref" href="#115pdq" title='pdq' data-ref="115pdq" data-ref-filename="115pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_dbp" title='_pdq_t::pdq_dbp' data-ref="_pdq_t::pdq_dbp" data-ref-filename="_pdq_t..pdq_dbp">pdq_dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_receives" title='(anonymous struct)::pdqdb_receives' data-ref="(anonymous)::pdqdb_receives" data-ref-filename="(anonymous)..pdqdb_receives">pdqdb_receives</a>));</td></tr>
<tr><th id="1402">1402</th><td>	    <a class="macro" href="pdqreg.h.html#407" title="PDQ_CSR_WRITE(&amp;(pdq)-&gt;pdq_csrs, csr_type_2_producer, ((pdq)-&gt;pdq_rx_info.rx_producer &lt;&lt; 0) | ((pdq)-&gt;pdq_tx_info.tx_producer &lt;&lt; 8) | ((pdq)-&gt;pdq_rx_info.rx_completion &lt;&lt; 16) | ((pdq)-&gt;pdq_tx_info.tx_completion &lt;&lt; 24))" data-ref="_M/PDQ_DO_TYPE2_PRODUCER">PDQ_DO_TYPE2_PRODUCER</a>(pdq);</td></tr>
<tr><th id="1403">1403</th><td>	    <b>if</b> (<a class="local col5 ref" href="#115pdq" title='pdq' data-ref="115pdq" data-ref-filename="115pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_flags" title='_pdq_t::pdq_flags' data-ref="_pdq_t::pdq_flags" data-ref-filename="_pdq_t..pdq_flags">pdq_flags</a> &amp; <a class="macro" href="pdqreg.h.html#461" title="0x0004" data-ref="_M/PDQ_PASS_SMT">PDQ_PASS_SMT</a>) {</td></tr>
<tr><th id="1404">1404</th><td>		<a class="tu ref fn" href="#pdq_process_received_data" title='pdq_process_received_data' data-use='c' data-ref="pdq_process_received_data" data-ref-filename="pdq_process_received_data">pdq_process_received_data</a>(<a class="local col5 ref" href="#115pdq" title='pdq' data-ref="115pdq" data-ref-filename="115pdq">pdq</a>, &amp;<a class="local col5 ref" href="#115pdq" title='pdq' data-ref="115pdq" data-ref-filename="115pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_host_smt_info" title='_pdq_t::pdq_host_smt_info' data-ref="_pdq_t::pdq_host_smt_info" data-ref-filename="_pdq_t..pdq_host_smt_info">pdq_host_smt_info</a>,</td></tr>
<tr><th id="1405">1405</th><td>					  <a class="local col5 ref" href="#115pdq" title='pdq' data-ref="115pdq" data-ref-filename="115pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_dbp" title='_pdq_t::pdq_dbp' data-ref="_pdq_t::pdq_dbp" data-ref-filename="_pdq_t..pdq_dbp">pdq_dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_host_smt" title='(anonymous struct)::pdqdb_host_smt' data-ref="(anonymous)::pdqdb_host_smt" data-ref-filename="(anonymous)..pdqdb_host_smt">pdqdb_host_smt</a>,</td></tr>
<tr><th id="1406">1406</th><td>					  <span class='error' title="implicit declaration of function &apos;le32toh&apos; is invalid in C99"><a class="ref fn" href="#221" title='le32toh' data-ref="le32toh" data-ref-filename="le32toh">le32toh</a></span>(<a class="local col5 ref" href="#115pdq" title='pdq' data-ref="115pdq" data-ref-filename="115pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_cbp" title='_pdq_t::pdq_cbp' data-ref="_pdq_t::pdq_cbp" data-ref-filename="_pdq_t..pdq_cbp">pdq_cbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqcb_host_smt" title='(anonymous struct)::pdqcb_host_smt' data-ref="(anonymous)::pdqcb_host_smt" data-ref-filename="(anonymous)..pdqcb_host_smt">pdqcb_host_smt</a>),</td></tr>
<tr><th id="1407">1407</th><td>					  <a class="macro" href="pdqreg.h.html#52" title="(((sizeof(pdq-&gt;pdq_dbp-&gt;pdqdb_host_smt) / sizeof(pdq-&gt;pdq_dbp-&gt;pdqdb_host_smt[0]))) - 1)" data-ref="_M/PDQ_RING_MASK">PDQ_RING_MASK</a>(<a class="local col5 ref" href="#115pdq" title='pdq' data-ref="115pdq" data-ref-filename="115pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_dbp" title='_pdq_t::pdq_dbp' data-ref="_pdq_t::pdq_dbp" data-ref-filename="_pdq_t..pdq_dbp">pdq_dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_host_smt" title='(anonymous struct)::pdqdb_host_smt' data-ref="(anonymous)::pdqdb_host_smt" data-ref-filename="(anonymous)..pdqdb_host_smt">pdqdb_host_smt</a>));</td></tr>
<tr><th id="1408">1408</th><td>		PDQ_CSR_WRITE(csrs, <span class='error' title="use of undeclared identifier &apos;csr_host_smt_producer&apos;">csr_host_smt_producer</span>,</td></tr>
<tr><th id="1409">1409</th><td>			      pdq-&gt;pdq_host_smt_info.rx_producer</td></tr>
<tr><th id="1410">1410</th><td>			          | (pdq-&gt;pdq_host_smt_info.rx_completion &lt;&lt; <var>8</var>));</td></tr>
<tr><th id="1411">1411</th><td>	    }</td></tr>
<tr><th id="1412">1412</th><td>	    <a class="local col5 ref" href="#115pdq" title='pdq' data-ref="115pdq" data-ref-filename="115pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_command_info" title='_pdq_t::pdq_command_info' data-ref="_pdq_t::pdq_command_info" data-ref-filename="_pdq_t..pdq_command_info">pdq_command_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_pending_commands" title='(anonymous struct)::ci_pending_commands' data-ref="(anonymous)::ci_pending_commands" data-ref-filename="(anonymous)..ci_pending_commands">ci_pending_commands</a> = <a class="macro" href="pdqreg.h.html#53" title="(1L &lt;&lt; (pdq_uint32_t) (PDQC_FILTER_SET))" data-ref="_M/PDQ_BITMASK">PDQ_BITMASK</a>(<a class="enum" href="pdqreg.h.html#PDQC_FILTER_SET" title='PDQC_FILTER_SET' data-ref="PDQC_FILTER_SET" data-ref-filename="PDQC_FILTER_SET">PDQC_FILTER_SET</a>)</td></tr>
<tr><th id="1413">1413</th><td>		| <a class="macro" href="pdqreg.h.html#53" title="(1L &lt;&lt; (pdq_uint32_t) (PDQC_ADDR_FILTER_SET))" data-ref="_M/PDQ_BITMASK">PDQ_BITMASK</a>(<a class="enum" href="pdqreg.h.html#PDQC_ADDR_FILTER_SET" title='PDQC_ADDR_FILTER_SET' data-ref="PDQC_ADDR_FILTER_SET" data-ref-filename="PDQC_ADDR_FILTER_SET">PDQC_ADDR_FILTER_SET</a>)</td></tr>
<tr><th id="1414">1414</th><td>		| <a class="macro" href="pdqreg.h.html#53" title="(1L &lt;&lt; (pdq_uint32_t) (PDQC_SNMP_SET))" data-ref="_M/PDQ_BITMASK">PDQ_BITMASK</a>(<a class="enum" href="pdqreg.h.html#PDQC_SNMP_SET" title='PDQC_SNMP_SET' data-ref="PDQC_SNMP_SET" data-ref-filename="PDQC_SNMP_SET">PDQC_SNMP_SET</a>)</td></tr>
<tr><th id="1415">1415</th><td>		| <a class="macro" href="pdqreg.h.html#53" title="(1L &lt;&lt; (pdq_uint32_t) (PDQC_START))" data-ref="_M/PDQ_BITMASK">PDQ_BITMASK</a>(<a class="enum" href="pdqreg.h.html#PDQC_START" title='PDQC_START' data-ref="PDQC_START" data-ref-filename="PDQC_START">PDQC_START</a>);</td></tr>
<tr><th id="1416">1416</th><td>	    <b>if</b> (<a class="local col5 ref" href="#115pdq" title='pdq' data-ref="115pdq" data-ref-filename="115pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_flags" title='_pdq_t::pdq_flags' data-ref="_pdq_t::pdq_flags" data-ref-filename="_pdq_t..pdq_flags">pdq_flags</a> &amp; <a class="macro" href="pdqreg.h.html#463" title="0x0010" data-ref="_M/PDQ_PRINTCHARS">PDQ_PRINTCHARS</a>)</td></tr>
<tr><th id="1417">1417</th><td>		<a class="local col5 ref" href="#115pdq" title='pdq' data-ref="115pdq" data-ref-filename="115pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_command_info" title='_pdq_t::pdq_command_info' data-ref="_pdq_t::pdq_command_info" data-ref-filename="_pdq_t..pdq_command_info">pdq_command_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_pending_commands" title='(anonymous struct)::ci_pending_commands' data-ref="(anonymous)::ci_pending_commands" data-ref-filename="(anonymous)..ci_pending_commands">ci_pending_commands</a> |= <a class="macro" href="pdqreg.h.html#53" title="(1L &lt;&lt; (pdq_uint32_t) (PDQC_STATUS_CHARS_GET))" data-ref="_M/PDQ_BITMASK">PDQ_BITMASK</a>(<a class="enum" href="pdqreg.h.html#PDQC_STATUS_CHARS_GET" title='PDQC_STATUS_CHARS_GET' data-ref="PDQC_STATUS_CHARS_GET" data-ref-filename="PDQC_STATUS_CHARS_GET">PDQC_STATUS_CHARS_GET</a>);</td></tr>
<tr><th id="1418">1418</th><td>	    <a class="tu ref fn" href="#pdq_queue_commands" title='pdq_queue_commands' data-use='c' data-ref="pdq_queue_commands" data-ref-filename="pdq_queue_commands">pdq_queue_commands</a>(<a class="local col5 ref" href="#115pdq" title='pdq' data-ref="115pdq" data-ref-filename="115pdq">pdq</a>);</td></tr>
<tr><th id="1419">1419</th><td>	    <b>break</b>;</td></tr>
<tr><th id="1420">1420</th><td>	}</td></tr>
<tr><th id="1421">1421</th><td>	<b>case</b> <a class="enum" href="pdqvar.h.html#PDQS_LINK_UNAVAILABLE" title='PDQS_LINK_UNAVAILABLE' data-ref="PDQS_LINK_UNAVAILABLE" data-ref-filename="PDQS_LINK_UNAVAILABLE">PDQS_LINK_UNAVAILABLE</a>:</td></tr>
<tr><th id="1422">1422</th><td>	<b>case</b> <a class="enum" href="pdqvar.h.html#PDQS_LINK_AVAILABLE" title='PDQS_LINK_AVAILABLE' data-ref="PDQS_LINK_AVAILABLE" data-ref-filename="PDQS_LINK_AVAILABLE">PDQS_LINK_AVAILABLE</a>: {</td></tr>
<tr><th id="1423">1423</th><td>	    <a class="local col5 ref" href="#115pdq" title='pdq' data-ref="115pdq" data-ref-filename="115pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_command_info" title='_pdq_t::pdq_command_info' data-ref="_pdq_t::pdq_command_info" data-ref-filename="_pdq_t..pdq_command_info">pdq_command_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_pending_commands" title='(anonymous struct)::ci_pending_commands' data-ref="(anonymous)::ci_pending_commands" data-ref-filename="(anonymous)..ci_pending_commands">ci_pending_commands</a> = <a class="macro" href="pdqreg.h.html#53" title="(1L &lt;&lt; (pdq_uint32_t) (PDQC_FILTER_SET))" data-ref="_M/PDQ_BITMASK">PDQ_BITMASK</a>(<a class="enum" href="pdqreg.h.html#PDQC_FILTER_SET" title='PDQC_FILTER_SET' data-ref="PDQC_FILTER_SET" data-ref-filename="PDQC_FILTER_SET">PDQC_FILTER_SET</a>)</td></tr>
<tr><th id="1424">1424</th><td>		| <a class="macro" href="pdqreg.h.html#53" title="(1L &lt;&lt; (pdq_uint32_t) (PDQC_ADDR_FILTER_SET))" data-ref="_M/PDQ_BITMASK">PDQ_BITMASK</a>(<a class="enum" href="pdqreg.h.html#PDQC_ADDR_FILTER_SET" title='PDQC_ADDR_FILTER_SET' data-ref="PDQC_ADDR_FILTER_SET" data-ref-filename="PDQC_ADDR_FILTER_SET">PDQC_ADDR_FILTER_SET</a>)</td></tr>
<tr><th id="1425">1425</th><td>		| <a class="macro" href="pdqreg.h.html#53" title="(1L &lt;&lt; (pdq_uint32_t) (PDQC_SNMP_SET))" data-ref="_M/PDQ_BITMASK">PDQ_BITMASK</a>(<a class="enum" href="pdqreg.h.html#PDQC_SNMP_SET" title='PDQC_SNMP_SET' data-ref="PDQC_SNMP_SET" data-ref-filename="PDQC_SNMP_SET">PDQC_SNMP_SET</a>);</td></tr>
<tr><th id="1426">1426</th><td>	    <b>if</b> (<a class="local col5 ref" href="#115pdq" title='pdq' data-ref="115pdq" data-ref-filename="115pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_flags" title='_pdq_t::pdq_flags' data-ref="_pdq_t::pdq_flags" data-ref-filename="_pdq_t..pdq_flags">pdq_flags</a> &amp; <a class="macro" href="pdqreg.h.html#463" title="0x0010" data-ref="_M/PDQ_PRINTCHARS">PDQ_PRINTCHARS</a>)</td></tr>
<tr><th id="1427">1427</th><td>		<a class="local col5 ref" href="#115pdq" title='pdq' data-ref="115pdq" data-ref-filename="115pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_command_info" title='_pdq_t::pdq_command_info' data-ref="_pdq_t::pdq_command_info" data-ref-filename="_pdq_t..pdq_command_info">pdq_command_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_pending_commands" title='(anonymous struct)::ci_pending_commands' data-ref="(anonymous)::ci_pending_commands" data-ref-filename="(anonymous)..ci_pending_commands">ci_pending_commands</a> |= <a class="macro" href="pdqreg.h.html#53" title="(1L &lt;&lt; (pdq_uint32_t) (PDQC_STATUS_CHARS_GET))" data-ref="_M/PDQ_BITMASK">PDQ_BITMASK</a>(<a class="enum" href="pdqreg.h.html#PDQC_STATUS_CHARS_GET" title='PDQC_STATUS_CHARS_GET' data-ref="PDQC_STATUS_CHARS_GET" data-ref-filename="PDQC_STATUS_CHARS_GET">PDQC_STATUS_CHARS_GET</a>);</td></tr>
<tr><th id="1428">1428</th><td>	    <b>if</b> (<a class="local col5 ref" href="#115pdq" title='pdq' data-ref="115pdq" data-ref-filename="115pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_flags" title='_pdq_t::pdq_flags' data-ref="_pdq_t::pdq_flags" data-ref-filename="_pdq_t..pdq_flags">pdq_flags</a> &amp; <a class="macro" href="pdqreg.h.html#461" title="0x0004" data-ref="_M/PDQ_PASS_SMT">PDQ_PASS_SMT</a>) {</td></tr>
<tr><th id="1429">1429</th><td>		<a class="tu ref fn" href="#pdq_process_received_data" title='pdq_process_received_data' data-use='c' data-ref="pdq_process_received_data" data-ref-filename="pdq_process_received_data">pdq_process_received_data</a>(<a class="local col5 ref" href="#115pdq" title='pdq' data-ref="115pdq" data-ref-filename="115pdq">pdq</a>, &amp;<a class="local col5 ref" href="#115pdq" title='pdq' data-ref="115pdq" data-ref-filename="115pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_host_smt_info" title='_pdq_t::pdq_host_smt_info' data-ref="_pdq_t::pdq_host_smt_info" data-ref-filename="_pdq_t..pdq_host_smt_info">pdq_host_smt_info</a>,</td></tr>
<tr><th id="1430">1430</th><td>					  <a class="local col5 ref" href="#115pdq" title='pdq' data-ref="115pdq" data-ref-filename="115pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_dbp" title='_pdq_t::pdq_dbp' data-ref="_pdq_t::pdq_dbp" data-ref-filename="_pdq_t..pdq_dbp">pdq_dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_host_smt" title='(anonymous struct)::pdqdb_host_smt' data-ref="(anonymous)::pdqdb_host_smt" data-ref-filename="(anonymous)..pdqdb_host_smt">pdqdb_host_smt</a>,</td></tr>
<tr><th id="1431">1431</th><td>					  <span class='error' title="implicit declaration of function &apos;le32toh&apos; is invalid in C99"><a class="ref fn" href="#221" title='le32toh' data-ref="le32toh" data-ref-filename="le32toh">le32toh</a></span>(<a class="local col5 ref" href="#115pdq" title='pdq' data-ref="115pdq" data-ref-filename="115pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_cbp" title='_pdq_t::pdq_cbp' data-ref="_pdq_t::pdq_cbp" data-ref-filename="_pdq_t..pdq_cbp">pdq_cbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqcb_host_smt" title='(anonymous struct)::pdqcb_host_smt' data-ref="(anonymous)::pdqcb_host_smt" data-ref-filename="(anonymous)..pdqcb_host_smt">pdqcb_host_smt</a>),</td></tr>
<tr><th id="1432">1432</th><td>					  <a class="macro" href="pdqreg.h.html#52" title="(((sizeof(pdq-&gt;pdq_dbp-&gt;pdqdb_host_smt) / sizeof(pdq-&gt;pdq_dbp-&gt;pdqdb_host_smt[0]))) - 1)" data-ref="_M/PDQ_RING_MASK">PDQ_RING_MASK</a>(<a class="local col5 ref" href="#115pdq" title='pdq' data-ref="115pdq" data-ref-filename="115pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_dbp" title='_pdq_t::pdq_dbp' data-ref="_pdq_t::pdq_dbp" data-ref-filename="_pdq_t..pdq_dbp">pdq_dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_host_smt" title='(anonymous struct)::pdqdb_host_smt' data-ref="(anonymous)::pdqdb_host_smt" data-ref-filename="(anonymous)..pdqdb_host_smt">pdqdb_host_smt</a>));</td></tr>
<tr><th id="1433">1433</th><td>		<span class='error' title="implicit declaration of function &apos;PDQ_CSR_WRITE&apos; is invalid in C99">PDQ_CSR_WRITE</span>(csrs, <span class='error' title="use of undeclared identifier &apos;csr_host_smt_producer&apos;">csr_host_smt_producer</span>,</td></tr>
<tr><th id="1434">1434</th><td>			      pdq-&gt;pdq_host_smt_info.rx_producer</td></tr>
<tr><th id="1435">1435</th><td>			          | (pdq-&gt;pdq_host_smt_info.rx_completion &lt;&lt; <var>8</var>));</td></tr>
<tr><th id="1436">1436</th><td>	    }</td></tr>
<tr><th id="1437">1437</th><td>	    <a class="tu ref fn" href="#pdq_process_unsolicited_events" title='pdq_process_unsolicited_events' data-use='c' data-ref="pdq_process_unsolicited_events" data-ref-filename="pdq_process_unsolicited_events">pdq_process_unsolicited_events</a>(<a class="local col5 ref" href="#115pdq" title='pdq' data-ref="115pdq" data-ref-filename="115pdq">pdq</a>);</td></tr>
<tr><th id="1438">1438</th><td>	    <a class="tu ref fn" href="#pdq_queue_commands" title='pdq_queue_commands' data-use='c' data-ref="pdq_queue_commands" data-ref-filename="pdq_queue_commands">pdq_queue_commands</a>(<a class="local col5 ref" href="#115pdq" title='pdq' data-ref="115pdq" data-ref-filename="115pdq">pdq</a>);</td></tr>
<tr><th id="1439">1439</th><td>	    <b>break</b>;</td></tr>
<tr><th id="1440">1440</th><td>	}</td></tr>
<tr><th id="1441">1441</th><td>	<b>case</b> <a class="enum" href="pdqvar.h.html#PDQS_RING_MEMBER" title='PDQS_RING_MEMBER' data-ref="PDQS_RING_MEMBER" data-ref-filename="PDQS_RING_MEMBER">PDQS_RING_MEMBER</a>: {</td></tr>
<tr><th id="1442">1442</th><td>	}</td></tr>
<tr><th id="1443">1443</th><td>	<b>default</b>: {	<i>/* to make gcc happy */</i></td></tr>
<tr><th id="1444">1444</th><td>	    <b>break</b>;</td></tr>
<tr><th id="1445">1445</th><td>	}</td></tr>
<tr><th id="1446">1446</th><td>    }</td></tr>
<tr><th id="1447">1447</th><td>}</td></tr>
<tr><th id="1448">1448</th><td></td></tr>
<tr><th id="1449">1449</th><td><em>int</em></td></tr>
<tr><th id="1450">1450</th><td><dfn class="decl def fn" id="pdq_interrupt" title='pdq_interrupt' data-ref="pdq_interrupt" data-ref-filename="pdq_interrupt">pdq_interrupt</dfn>(</td></tr>
<tr><th id="1451">1451</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_t" title='pdq_t' data-type='struct _pdq_t' data-ref="pdq_t" data-ref-filename="pdq_t">pdq_t</a> *<dfn class="local col8 decl" id="118pdq" title='pdq' data-type='pdq_t *' data-ref="118pdq" data-ref-filename="118pdq">pdq</dfn>)</td></tr>
<tr><th id="1452">1452</th><td>{</td></tr>
<tr><th id="1453">1453</th><td>    <em>const</em> <a class="typedef" href="pdqvar.h.html#pdq_csrs_t" title='pdq_csrs_t' data-type='struct _pdq_csrs_t' data-ref="pdq_csrs_t" data-ref-filename="pdq_csrs_t">pdq_csrs_t</a> * <em>const</em> <dfn class="local col9 decl" id="119csrs" title='csrs' data-type='const pdq_csrs_t *const' data-ref="119csrs" data-ref-filename="119csrs">csrs</dfn> = &amp;pdq-&gt;pdq_csrs;</td></tr>
<tr><th id="1454">1454</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_uint32_t" title='pdq_uint32_t' data-type='unsigned int' data-ref="pdq_uint32_t" data-ref-filename="pdq_uint32_t">pdq_uint32_t</a> <dfn class="local col0 decl" id="120data" title='data' data-type='pdq_uint32_t' data-ref="120data" data-ref-filename="120data">data</dfn>;</td></tr>
<tr><th id="1455">1455</th><td>    <em>int</em> <dfn class="local col1 decl" id="121progress" title='progress' data-type='int' data-ref="121progress" data-ref-filename="121progress">progress</dfn> = <var>0</var>;</td></tr>
<tr><th id="1456">1456</th><td></td></tr>
<tr><th id="1457">1457</th><td>    <b>if</b> (pdq-&gt;pdq_type == PDQ_DEFPA)</td></tr>
<tr><th id="1458">1458</th><td>	<span class='error' title="implicit declaration of function &apos;PDQ_CSR_WRITE&apos; is invalid in C99">PDQ_CSR_WRITE</span>(&amp;pdq-&gt;pdq_pci_csrs, <span class='error' title="use of undeclared identifier &apos;csr_pfi_status&apos;">csr_pfi_status</span>, <var>0x18</var>);</td></tr>
<tr><th id="1459">1459</th><td></td></tr>
<tr><th id="1460">1460</th><td>    <b>while</b> ((data = <span class='error' title="implicit declaration of function &apos;PDQ_CSR_READ&apos; is invalid in C99">PDQ_CSR_READ</span>(csrs, <span class='error' title="use of undeclared identifier &apos;csr_port_status&apos;">csr_port_status</span>)) &amp; <a class="macro" href="pdqreg.h.html#225" title="0xFE000000ul" data-ref="_M/PDQ_PSTS_INTR_PENDING">PDQ_PSTS_INTR_PENDING</a>) {</td></tr>
<tr><th id="1461">1461</th><td>	progress = <var>1</var>;</td></tr>
<tr><th id="1462">1462</th><td>	<a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"PDQ Interrupt: Status = 0x%08x\n"</q>, data));</td></tr>
<tr><th id="1463">1463</th><td>	<a class="macro" href="pdqvar.h.html#478" title="do { } while(0)" data-ref="_M/PDQ_OS_CONSUMER_POSTSYNC">PDQ_OS_CONSUMER_POSTSYNC</a>(pdq);</td></tr>
<tr><th id="1464">1464</th><td>	<b>if</b> (data &amp; <a class="macro" href="pdqreg.h.html#218" title="0x80000000ul" data-ref="_M/PDQ_PSTS_RCV_DATA_PENDING">PDQ_PSTS_RCV_DATA_PENDING</a>) {</td></tr>
<tr><th id="1465">1465</th><td>	    pdq_process_received_data(pdq, &amp;pdq-&gt;pdq_rx_info,</td></tr>
<tr><th id="1466">1466</th><td>				      pdq-&gt;pdq_dbp-&gt;pdqdb_receives,</td></tr>
<tr><th id="1467">1467</th><td>				      <span class='error' title="implicit declaration of function &apos;le16toh&apos; is invalid in C99">le16toh</span>(pdq-&gt;pdq_cbp-&gt;pdqcb_receives),</td></tr>
<tr><th id="1468">1468</th><td>				      <a class="macro" href="pdqreg.h.html#52" title="(((sizeof(pdq-&gt;pdq_dbp-&gt;pdqdb_receives) / sizeof(pdq-&gt;pdq_dbp-&gt;pdqdb_receives[0]))) - 1)" data-ref="_M/PDQ_RING_MASK">PDQ_RING_MASK</a>(pdq-&gt;pdq_dbp-&gt;pdqdb_receives));</td></tr>
<tr><th id="1469">1469</th><td>	    <a class="macro" href="pdqreg.h.html#407" title="PDQ_CSR_WRITE(&amp;(pdq)-&gt;pdq_csrs, csr_type_2_producer, ((pdq)-&gt;pdq_rx_info.rx_producer &lt;&lt; 0) | ((pdq)-&gt;pdq_tx_info.tx_producer &lt;&lt; 8) | ((pdq)-&gt;pdq_rx_info.rx_completion &lt;&lt; 16) | ((pdq)-&gt;pdq_tx_info.tx_completion &lt;&lt; 24))" data-ref="_M/PDQ_DO_TYPE2_PRODUCER">PDQ_DO_TYPE2_PRODUCER</a>(pdq);</td></tr>
<tr><th id="1470">1470</th><td>	}</td></tr>
<tr><th id="1471">1471</th><td>	<b>if</b> (data &amp; <a class="macro" href="pdqreg.h.html#220" title="0x20000000ul" data-ref="_M/PDQ_PSTS_HOST_SMT_PENDING">PDQ_PSTS_HOST_SMT_PENDING</a>) {</td></tr>
<tr><th id="1472">1472</th><td>	    pdq_process_received_data(pdq, &amp;pdq-&gt;pdq_host_smt_info,</td></tr>
<tr><th id="1473">1473</th><td>				      pdq-&gt;pdq_dbp-&gt;pdqdb_host_smt,</td></tr>
<tr><th id="1474">1474</th><td>				      <span class='error' title="implicit declaration of function &apos;le32toh&apos; is invalid in C99">le32toh</span>(pdq-&gt;pdq_cbp-&gt;pdqcb_host_smt),</td></tr>
<tr><th id="1475">1475</th><td>				      <a class="macro" href="pdqreg.h.html#52" title="(((sizeof(pdq-&gt;pdq_dbp-&gt;pdqdb_host_smt) / sizeof(pdq-&gt;pdq_dbp-&gt;pdqdb_host_smt[0]))) - 1)" data-ref="_M/PDQ_RING_MASK">PDQ_RING_MASK</a>(pdq-&gt;pdq_dbp-&gt;pdqdb_host_smt));</td></tr>
<tr><th id="1476">1476</th><td>	    <a class="macro" href="pdqreg.h.html#414" title="PDQ_CSR_WRITE(&amp;(pdq)-&gt;pdq_csrs, csr_host_smt_producer, ((pdq)-&gt;pdq_host_smt_info.rx_producer &lt;&lt; 0) | ((pdq)-&gt;pdq_host_smt_info.rx_completion &lt;&lt; 8))" data-ref="_M/PDQ_DO_HOST_SMT_PRODUCER">PDQ_DO_HOST_SMT_PRODUCER</a>(pdq);</td></tr>
<tr><th id="1477">1477</th><td>	}</td></tr>
<tr><th id="1478">1478</th><td>	<i>/* if (data &amp; PDQ_PSTS_XMT_DATA_PENDING) */</i></td></tr>
<tr><th id="1479">1479</th><td>	    pdq_process_transmitted_data(pdq);</td></tr>
<tr><th id="1480">1480</th><td>	<b>if</b> (data &amp; <a class="macro" href="pdqreg.h.html#221" title="0x10000000ul" data-ref="_M/PDQ_PSTS_UNSOL_PENDING">PDQ_PSTS_UNSOL_PENDING</a>)</td></tr>
<tr><th id="1481">1481</th><td>	    pdq_process_unsolicited_events(pdq);</td></tr>
<tr><th id="1482">1482</th><td>	<b>if</b> (data &amp; <a class="macro" href="pdqreg.h.html#222" title="0x08000000ul" data-ref="_M/PDQ_PSTS_CMD_RSP_PENDING">PDQ_PSTS_CMD_RSP_PENDING</a>)</td></tr>
<tr><th id="1483">1483</th><td>	    pdq_process_command_responses(pdq);</td></tr>
<tr><th id="1484">1484</th><td>	<b>if</b> (data &amp; <a class="macro" href="pdqreg.h.html#224" title="0x02000000ul" data-ref="_M/PDQ_PSTS_TYPE_0_PENDING">PDQ_PSTS_TYPE_0_PENDING</a>) {</td></tr>
<tr><th id="1485">1485</th><td>	    data = PDQ_CSR_READ(csrs, <span class='error' title="use of undeclared identifier &apos;csr_host_int_type_0&apos;">csr_host_int_type_0</span>);</td></tr>
<tr><th id="1486">1486</th><td>	    <b>if</b> (data &amp; <a class="macro" href="pdqreg.h.html#241" title="0x10" data-ref="_M/PDQ_HOST_INT_STATE_CHANGE">PDQ_HOST_INT_STATE_CHANGE</a>) {</td></tr>
<tr><th id="1487">1487</th><td>		pdq_state_t state = <a class="macro" href="pdqreg.h.html#226" title="((pdq_state_t) (((PDQ_CSR_READ(csrs, csr_port_status)) &gt;&gt; 8) &amp; 0x07))" data-ref="_M/PDQ_PSTS_ADAPTER_STATE">PDQ_PSTS_ADAPTER_STATE</a>(PDQ_CSR_READ(csrs, <span class='error' title="use of undeclared identifier &apos;csr_port_status&apos;">csr_port_status</span>));</td></tr>
<tr><th id="1488">1488</th><td>		<span class='error' title="implicit declaration of function &apos;printf&apos; is invalid in C99">printf</span>(<span class='error' title="use of undeclared identifier &apos;PDQ_OS_PREFIX&apos;">PDQ_OS_PREFIX</span> <q>"%s"</q>, <span class='error' title="use of undeclared identifier &apos;PDQ_OS_PREFIX_ARGS&apos;">PDQ_OS_PREFIX_ARGS</span>, pdq_adapter_states[state]);</td></tr>
<tr><th id="1489">1489</th><td>		<b>if</b> (state == PDQS_LINK_UNAVAILABLE) {</td></tr>
<tr><th id="1490">1490</th><td>		    pdq-&gt;pdq_flags &amp;= ~(<a class="macro" href="pdqreg.h.html#464" title="0x0020" data-ref="_M/PDQ_TXOK">PDQ_TXOK</a>|<a class="macro" href="pdqreg.h.html#467" title="0x0100" data-ref="_M/PDQ_IS_ONRING">PDQ_IS_ONRING</a>|<a class="macro" href="pdqreg.h.html#466" title="0x0080" data-ref="_M/PDQ_IS_FDX">PDQ_IS_FDX</a>);</td></tr>
<tr><th id="1491">1491</th><td>		} <b>else</b> <b>if</b> (state == PDQS_LINK_AVAILABLE) {</td></tr>
<tr><th id="1492">1492</th><td>		    <b>if</b> (pdq-&gt;pdq_flags &amp; <a class="macro" href="pdqreg.h.html#465" title="0x0040" data-ref="_M/PDQ_WANT_FDX">PDQ_WANT_FDX</a>) {</td></tr>
<tr><th id="1493">1493</th><td>			pdq-&gt;pdq_command_info.ci_pending_commands |= <a class="macro" href="pdqreg.h.html#53" title="(1L &lt;&lt; (pdq_uint32_t) (PDQC_DEC_EXT_MIB_GET))" data-ref="_M/PDQ_BITMASK">PDQ_BITMASK</a>(PDQC_DEC_EXT_MIB_GET);</td></tr>
<tr><th id="1494">1494</th><td>			pdq_queue_commands(pdq);</td></tr>
<tr><th id="1495">1495</th><td>		    }</td></tr>
<tr><th id="1496">1496</th><td>		    pdq-&gt;pdq_flags |= <a class="macro" href="pdqreg.h.html#464" title="0x0020" data-ref="_M/PDQ_TXOK">PDQ_TXOK</a>|<a class="macro" href="pdqreg.h.html#467" title="0x0100" data-ref="_M/PDQ_IS_ONRING">PDQ_IS_ONRING</a>;</td></tr>
<tr><th id="1497">1497</th><td>		    pdq_os_restart_transmitter(pdq);</td></tr>
<tr><th id="1498">1498</th><td>		} <b>else</b> <b>if</b> (state == PDQS_HALTED) {</td></tr>
<tr><th id="1499">1499</th><td>		    pdq_response_error_log_get_t log_entry;</td></tr>
<tr><th id="1500">1500</th><td>		    pdq_halt_code_t halt_code = <a class="macro" href="pdqreg.h.html#227" title="((pdq_halt_code_t) ((PDQ_CSR_READ(csrs, csr_port_status)) &amp; 0xFF))" data-ref="_M/PDQ_PSTS_HALT_ID">PDQ_PSTS_HALT_ID</a>(PDQ_CSR_READ(csrs, <span class='error' title="use of undeclared identifier &apos;csr_port_status&apos;">csr_port_status</span>));</td></tr>
<tr><th id="1501">1501</th><td>		    printf(<q>": halt code = %d (%s)\n"</q>,</td></tr>
<tr><th id="1502">1502</th><td>			   halt_code, pdq_halt_codes[halt_code]);</td></tr>
<tr><th id="1503">1503</th><td>		    <b>if</b> (halt_code == PDQH_DMA_ERROR &amp;&amp; pdq-&gt;pdq_type == PDQ_DEFPA) {</td></tr>
<tr><th id="1504">1504</th><td>			<a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"\tPFI status = 0x%x, Host 0 Fatal Interrupt = 0x%x\n"</q>,</td></tr>
<tr><th id="1505">1505</th><td>			       PDQ_CSR_READ(&amp;pdq-&gt;pdq_pci_csrs, csr_pfi_status),</td></tr>
<tr><th id="1506">1506</th><td>			       data &amp; PDQ_HOST_INT_FATAL_ERROR));</td></tr>
<tr><th id="1507">1507</th><td>		    }</td></tr>
<tr><th id="1508">1508</th><td>		    <span class='error' title="implicit declaration of function &apos;PDQ_OS_MEMZERO&apos; is invalid in C99">PDQ_OS_MEMZERO</span>(&amp;log_entry, <b>sizeof</b>(log_entry));</td></tr>
<tr><th id="1509">1509</th><td>		    <b>if</b> (pdq_read_error_log(pdq, &amp;log_entry)) {</td></tr>
<tr><th id="1510">1510</th><td>			<a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"  Error log Entry:\n"</q>));</td></tr>
<tr><th id="1511">1511</th><td>			<a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"    CMD Status           = %d (0x%x)\n"</q>,</td></tr>
<tr><th id="1512">1512</th><td>				    log_entry.error_log_get_status,</td></tr>
<tr><th id="1513">1513</th><td>				    log_entry.error_log_get_status));</td></tr>
<tr><th id="1514">1514</th><td>			<a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"    Event Status         = %d (0x%x)\n"</q>,</td></tr>
<tr><th id="1515">1515</th><td>				    log_entry.error_log_get_event_status,</td></tr>
<tr><th id="1516">1516</th><td>				    log_entry.error_log_get_event_status));</td></tr>
<tr><th id="1517">1517</th><td>			<a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"    Caller Id            = %d (0x%x)\n"</q>,</td></tr>
<tr><th id="1518">1518</th><td>				    log_entry.error_log_get_caller_id,</td></tr>
<tr><th id="1519">1519</th><td>				    log_entry.error_log_get_caller_id));</td></tr>
<tr><th id="1520">1520</th><td>			<a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"    Write Count          = %d (0x%x)\n"</q>,</td></tr>
<tr><th id="1521">1521</th><td>				    log_entry.error_log_get_write_count,</td></tr>
<tr><th id="1522">1522</th><td>				    log_entry.error_log_get_write_count));</td></tr>
<tr><th id="1523">1523</th><td>			<a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"    FRU Implication Mask = %d (0x%x)\n"</q>,</td></tr>
<tr><th id="1524">1524</th><td>				    log_entry.error_log_get_fru_implication_mask,</td></tr>
<tr><th id="1525">1525</th><td>				    log_entry.error_log_get_fru_implication_mask));</td></tr>
<tr><th id="1526">1526</th><td>			<a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"    Test ID              = %d (0x%x)\n"</q>,</td></tr>
<tr><th id="1527">1527</th><td>				    log_entry.error_log_get_test_id,</td></tr>
<tr><th id="1528">1528</th><td>				    log_entry.error_log_get_test_id));</td></tr>
<tr><th id="1529">1529</th><td>		    }</td></tr>
<tr><th id="1530">1530</th><td>		    pdq_stop(pdq);</td></tr>
<tr><th id="1531">1531</th><td>		    <b>if</b> (pdq-&gt;pdq_flags &amp; <a class="macro" href="pdqreg.h.html#462" title="0x0008" data-ref="_M/PDQ_RUNNING">PDQ_RUNNING</a>)</td></tr>
<tr><th id="1532">1532</th><td>			pdq_run(pdq);</td></tr>
<tr><th id="1533">1533</th><td>		    <b>return</b> <var>1</var>;</td></tr>
<tr><th id="1534">1534</th><td>		}</td></tr>
<tr><th id="1535">1535</th><td>		printf(<q>"\n"</q>);</td></tr>
<tr><th id="1536">1536</th><td>		PDQ_CSR_WRITE(csrs, <span class='error' title="use of undeclared identifier &apos;csr_host_int_type_0&apos;">csr_host_int_type_0</span>, <a class="macro" href="pdqreg.h.html#241" title="0x10" data-ref="_M/PDQ_HOST_INT_STATE_CHANGE">PDQ_HOST_INT_STATE_CHANGE</a>);</td></tr>
<tr><th id="1537">1537</th><td>	    }</td></tr>
<tr><th id="1538">1538</th><td>	    <b>if</b> (data &amp; <a class="macro" href="pdqreg.h.html#246" title="0x07" data-ref="_M/PDQ_HOST_INT_FATAL_ERROR">PDQ_HOST_INT_FATAL_ERROR</a>) {</td></tr>
<tr><th id="1539">1539</th><td>		pdq_stop(pdq);</td></tr>
<tr><th id="1540">1540</th><td>		<b>if</b> (pdq-&gt;pdq_flags &amp; <a class="macro" href="pdqreg.h.html#462" title="0x0008" data-ref="_M/PDQ_RUNNING">PDQ_RUNNING</a>)</td></tr>
<tr><th id="1541">1541</th><td>		    pdq_run(pdq);</td></tr>
<tr><th id="1542">1542</th><td>		<b>return</b> <var>1</var>;</td></tr>
<tr><th id="1543">1543</th><td>	    }</td></tr>
<tr><th id="1544">1544</th><td>	    <b>if</b> (data &amp; <a class="macro" href="pdqreg.h.html#242" title="0x08" data-ref="_M/PDQ_HOST_INT_XMT_DATA_FLUSH">PDQ_HOST_INT_XMT_DATA_FLUSH</a>) {</td></tr>
<tr><th id="1545">1545</th><td>		<span class='error' title="implicit declaration of function &apos;printf&apos; is invalid in C99">printf</span>(<span class='error' title="use of undeclared identifier &apos;PDQ_OS_PREFIX&apos;">PDQ_OS_PREFIX</span> <q>"Flushing transmit queue\n"</q>, <span class='error' title="use of undeclared identifier &apos;PDQ_OS_PREFIX_ARGS&apos;">PDQ_OS_PREFIX_ARGS</span>);</td></tr>
<tr><th id="1546">1546</th><td>		pdq-&gt;pdq_flags &amp;= ~<a class="macro" href="pdqreg.h.html#464" title="0x0020" data-ref="_M/PDQ_TXOK">PDQ_TXOK</a>;</td></tr>
<tr><th id="1547">1547</th><td>		pdq_flush_transmitter(pdq);</td></tr>
<tr><th id="1548">1548</th><td>		pdq_do_port_control(csrs, <a class="macro" href="pdqreg.h.html#184" title="0x0200" data-ref="_M/PDQ_PCTL_XMT_DATA_FLUSH_DONE">PDQ_PCTL_XMT_DATA_FLUSH_DONE</a>);</td></tr>
<tr><th id="1549">1549</th><td>		PDQ_CSR_WRITE(csrs, <span class='error' title="use of undeclared identifier &apos;csr_host_int_type_0&apos;">csr_host_int_type_0</span>, <a class="macro" href="pdqreg.h.html#242" title="0x08" data-ref="_M/PDQ_HOST_INT_XMT_DATA_FLUSH">PDQ_HOST_INT_XMT_DATA_FLUSH</a>);</td></tr>
<tr><th id="1550">1550</th><td>	    }</td></tr>
<tr><th id="1551">1551</th><td>	}</td></tr>
<tr><th id="1552">1552</th><td>	<b>if</b> (pdq-&gt;pdq_type == PDQ_DEFPA)</td></tr>
<tr><th id="1553">1553</th><td>	    PDQ_CSR_WRITE(&amp;pdq-&gt;pdq_pci_csrs, <span class='error' title="use of undeclared identifier &apos;csr_pfi_status&apos;">csr_pfi_status</span>, <var>0x18</var>);</td></tr>
<tr><th id="1554">1554</th><td>    }</td></tr>
<tr><th id="1555">1555</th><td>    <b>return</b> <a class="local col1 ref" href="#121progress" title='progress' data-ref="121progress" data-ref-filename="121progress">progress</a>;</td></tr>
<tr><th id="1556">1556</th><td>}</td></tr>
<tr><th id="1557">1557</th><td></td></tr>
<tr><th id="1558">1558</th><td><a class="typedef" href="pdqvar.h.html#pdq_t" title='pdq_t' data-type='struct _pdq_t' data-ref="pdq_t" data-ref-filename="pdq_t">pdq_t</a> *</td></tr>
<tr><th id="1559">1559</th><td><dfn class="decl def fn" id="pdq_initialize" title='pdq_initialize' data-ref="pdq_initialize" data-ref-filename="pdq_initialize">pdq_initialize</dfn>(</td></tr>
<tr><th id="1560">1560</th><td>    <span class='error' title="unknown type name &apos;pdq_bus_t&apos;">pdq_bus_t</span> <dfn class="local col2 decl" id="122bus" title='bus' data-type='int' data-ref="122bus" data-ref-filename="122bus">bus</dfn>,</td></tr>
<tr><th id="1561">1561</th><td>    <span class='error' title="unknown type name &apos;pdq_bus_memaddr_t&apos;">pdq_bus_memaddr_t</span> <dfn class="local col3 decl" id="123csr_base" title='csr_base' data-type='int' data-ref="123csr_base" data-ref-filename="123csr_base">csr_base</dfn>,</td></tr>
<tr><th id="1562">1562</th><td>    <em>const</em> <em>char</em> *<dfn class="local col4 decl" id="124name" title='name' data-type='const char *' data-ref="124name" data-ref-filename="124name">name</dfn>,</td></tr>
<tr><th id="1563">1563</th><td>    <em>int</em> <dfn class="local col5 decl" id="125unit" title='unit' data-type='int' data-ref="125unit" data-ref-filename="125unit">unit</dfn>,</td></tr>
<tr><th id="1564">1564</th><td>    <em>void</em> *<dfn class="local col6 decl" id="126ctx" title='ctx' data-type='void *' data-ref="126ctx" data-ref-filename="126ctx">ctx</dfn>,</td></tr>
<tr><th id="1565">1565</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_type_t" title='pdq_type_t' data-type='enum _pdq_type_t' data-ref="pdq_type_t" data-ref-filename="pdq_type_t">pdq_type_t</a> <dfn class="local col7 decl" id="127type" title='type' data-type='pdq_type_t' data-ref="127type" data-ref-filename="127type">type</dfn>)</td></tr>
<tr><th id="1566">1566</th><td>{</td></tr>
<tr><th id="1567">1567</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_t" title='pdq_t' data-type='struct _pdq_t' data-ref="pdq_t" data-ref-filename="pdq_t">pdq_t</a> *<dfn class="local col8 decl" id="128pdq" title='pdq' data-type='pdq_t *' data-ref="128pdq" data-ref-filename="128pdq">pdq</dfn>;</td></tr>
<tr><th id="1568">1568</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_state_t" title='pdq_state_t' data-type='enum _pdq_state_t' data-ref="pdq_state_t" data-ref-filename="pdq_state_t">pdq_state_t</a> <dfn class="local col9 decl" id="129state" title='state' data-type='pdq_state_t' data-ref="129state" data-ref-filename="129state">state</dfn>;</td></tr>
<tr><th id="1569">1569</th><td>    <a class="typedef" href="pdqreg.h.html#pdq_descriptor_block_t" title='pdq_descriptor_block_t' data-type='struct pdq_descriptor_block_t' data-ref="pdq_descriptor_block_t" data-ref-filename="pdq_descriptor_block_t">pdq_descriptor_block_t</a> *<dfn class="local col0 decl" id="130dbp" title='dbp' data-type='pdq_descriptor_block_t *' data-ref="130dbp" data-ref-filename="130dbp">dbp</dfn>;</td></tr>
<tr><th id="1570">1570</th><td><u>#<span data-ppcond="1570">if</span> !defined(<span class="macro" data-ref="_M/PDQ_BUS_DMA">PDQ_BUS_DMA</span>)</u></td></tr>
<tr><th id="1571">1571</th><td>    <em>const</em> <a class="typedef" href="pdqvar.h.html#pdq_uint32_t" title='pdq_uint32_t' data-type='unsigned int' data-ref="pdq_uint32_t" data-ref-filename="pdq_uint32_t">pdq_uint32_t</a> <dfn class="local col1 decl" id="131contig_bytes" title='contig_bytes' data-type='const pdq_uint32_t' data-ref="131contig_bytes" data-ref-filename="131contig_bytes">contig_bytes</dfn> = (<b>sizeof</b>(pdq_descriptor_block_t) * <var>2</var>) - <span class='error' title="use of undeclared identifier &apos;PDQ_OS_PAGESIZE&apos;">PDQ_OS_PAGESIZE</span>;</td></tr>
<tr><th id="1572">1572</th><td>    <a class="typedef" href="pdqvar.h.html#pdq_uint8_t" title='pdq_uint8_t' data-type='unsigned char' data-ref="pdq_uint8_t" data-ref-filename="pdq_uint8_t">pdq_uint8_t</a> *<dfn class="local col2 decl" id="132p" title='p' data-type='pdq_uint8_t *' data-ref="132p" data-ref-filename="132p">p</dfn>;</td></tr>
<tr><th id="1573">1573</th><td><u>#<span data-ppcond="1570">endif</span></u></td></tr>
<tr><th id="1574">1574</th><td>    <em>int</em> <dfn class="local col3 decl" id="133idx" title='idx' data-type='int' data-ref="133idx" data-ref-filename="133idx">idx</dfn>;</td></tr>
<tr><th id="1575">1575</th><td></td></tr>
<tr><th id="1576">1576</th><td>    <a class="macro" href="pdqreg.h.html#47" title="do { } while(0)" data-ref="_M/PDQ_ASSERT">PDQ_ASSERT</a>(<b>sizeof</b>(pdq_descriptor_block_t) == <var>8192</var>);</td></tr>
<tr><th id="1577">1577</th><td>    <a class="macro" href="pdqreg.h.html#47" title="do { } while(0)" data-ref="_M/PDQ_ASSERT">PDQ_ASSERT</a>(<b>sizeof</b>(pdq_consumer_block_t) == <var>64</var>);</td></tr>
<tr><th id="1578">1578</th><td>    <a class="macro" href="pdqreg.h.html#47" title="do { } while(0)" data-ref="_M/PDQ_ASSERT">PDQ_ASSERT</a>(<b>sizeof</b>(pdq_response_filter_get_t) == PDQ_SIZE_RESPONSE_FILTER_GET);</td></tr>
<tr><th id="1579">1579</th><td>    <a class="macro" href="pdqreg.h.html#47" title="do { } while(0)" data-ref="_M/PDQ_ASSERT">PDQ_ASSERT</a>(<b>sizeof</b>(pdq_cmd_addr_filter_set_t) == PDQ_SIZE_CMD_ADDR_FILTER_SET);</td></tr>
<tr><th id="1580">1580</th><td>    <a class="macro" href="pdqreg.h.html#47" title="do { } while(0)" data-ref="_M/PDQ_ASSERT">PDQ_ASSERT</a>(<b>sizeof</b>(pdq_response_addr_filter_get_t) == PDQ_SIZE_RESPONSE_ADDR_FILTER_GET);</td></tr>
<tr><th id="1581">1581</th><td>    <a class="macro" href="pdqreg.h.html#47" title="do { } while(0)" data-ref="_M/PDQ_ASSERT">PDQ_ASSERT</a>(<b>sizeof</b>(pdq_response_status_chars_get_t) == PDQ_SIZE_RESPONSE_STATUS_CHARS_GET);</td></tr>
<tr><th id="1582">1582</th><td>    <a class="macro" href="pdqreg.h.html#47" title="do { } while(0)" data-ref="_M/PDQ_ASSERT">PDQ_ASSERT</a>(<b>sizeof</b>(pdq_response_fddi_mib_get_t) == PDQ_SIZE_RESPONSE_FDDI_MIB_GET);</td></tr>
<tr><th id="1583">1583</th><td>    <a class="macro" href="pdqreg.h.html#47" title="do { } while(0)" data-ref="_M/PDQ_ASSERT">PDQ_ASSERT</a>(<b>sizeof</b>(pdq_response_dec_ext_mib_get_t) == PDQ_SIZE_RESPONSE_DEC_EXT_MIB_GET);</td></tr>
<tr><th id="1584">1584</th><td>    <a class="macro" href="pdqreg.h.html#47" title="do { } while(0)" data-ref="_M/PDQ_ASSERT">PDQ_ASSERT</a>(<b>sizeof</b>(pdq_unsolicited_event_t) == <var>512</var>);</td></tr>
<tr><th id="1585">1585</th><td></td></tr>
<tr><th id="1586">1586</th><td>    <a class="local col8 ref" href="#128pdq" title='pdq' data-ref="128pdq" data-ref-filename="128pdq">pdq</a> = <span class='error' title="cast to &apos;pdq_t *&apos; (aka &apos;struct _pdq_t *&apos;) from smaller integer type &apos;int&apos;">(</span><a class="typedef" href="pdqvar.h.html#pdq_t" title='pdq_t' data-type='struct _pdq_t' data-ref="pdq_t" data-ref-filename="pdq_t">pdq_t</a> *) <span class='error' title="implicit declaration of function &apos;PDQ_OS_MEMALLOC&apos; is invalid in C99"><span class='error' title="this function declaration is not a prototype"><a class="ref fn" href="#1586" title='PDQ_OS_MEMALLOC' data-ref="PDQ_OS_MEMALLOC" data-ref-filename="PDQ_OS_MEMALLOC">PDQ_OS_MEMALLOC</a></span></span>(<b>sizeof</b>(<a class="typedef" href="pdqvar.h.html#pdq_t" title='pdq_t' data-type='struct _pdq_t' data-ref="pdq_t" data-ref-filename="pdq_t">pdq_t</a>));</td></tr>
<tr><th id="1587">1587</th><td>    <b>if</b> (pdq == <span class='error' title="use of undeclared identifier &apos;NULL&apos;">NULL</span>) {</td></tr>
<tr><th id="1588">1588</th><td>	<a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"malloc(%d) failed\n"</q>, <b>sizeof</b>(*pdq)));</td></tr>
<tr><th id="1589">1589</th><td>	<b>return</b> <span class='error' title="use of undeclared identifier &apos;NULL&apos;">NULL</span>;</td></tr>
<tr><th id="1590">1590</th><td>    }</td></tr>
<tr><th id="1591">1591</th><td>    <span class='error' title="implicit declaration of function &apos;PDQ_OS_MEMZERO&apos; is invalid in C99"><a class="ref fn" href="#529" title='PDQ_OS_MEMZERO' data-ref="PDQ_OS_MEMZERO" data-ref-filename="PDQ_OS_MEMZERO">PDQ_OS_MEMZERO</a></span>(<a class="local col8 ref" href="#128pdq" title='pdq' data-ref="128pdq" data-ref-filename="128pdq">pdq</a>, <b>sizeof</b>(<a class="typedef" href="pdqvar.h.html#pdq_t" title='pdq_t' data-type='struct _pdq_t' data-ref="pdq_t" data-ref-filename="pdq_t">pdq_t</a>));</td></tr>
<tr><th id="1592">1592</th><td>    <a class="local col8 ref" href="#128pdq" title='pdq' data-ref="128pdq" data-ref-filename="128pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_type" title='_pdq_t::pdq_type' data-ref="_pdq_t::pdq_type" data-ref-filename="_pdq_t..pdq_type">pdq_type</a> = <a class="local col7 ref" href="#127type" title='type' data-ref="127type" data-ref-filename="127type">type</a>;</td></tr>
<tr><th id="1593">1593</th><td>    <a class="local col8 ref" href="#128pdq" title='pdq' data-ref="128pdq" data-ref-filename="128pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_unit" title='_pdq_t::pdq_unit' data-ref="_pdq_t::pdq_unit" data-ref-filename="_pdq_t..pdq_unit">pdq_unit</a> = <a class="local col5 ref" href="#125unit" title='unit' data-ref="125unit" data-ref-filename="125unit">unit</a>;</td></tr>
<tr><th id="1594">1594</th><td>    <a class="local col8 ref" href="#128pdq" title='pdq' data-ref="128pdq" data-ref-filename="128pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_os_ctx" title='_pdq_t::pdq_os_ctx' data-ref="_pdq_t::pdq_os_ctx" data-ref-filename="_pdq_t..pdq_os_ctx">pdq_os_ctx</a> = (<em>void</em> *) <a class="local col6 ref" href="#126ctx" title='ctx' data-ref="126ctx" data-ref-filename="126ctx">ctx</a>;</td></tr>
<tr><th id="1595">1595</th><td>    <a class="local col8 ref" href="#128pdq" title='pdq' data-ref="128pdq" data-ref-filename="128pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_os_name" title='_pdq_t::pdq_os_name' data-ref="_pdq_t::pdq_os_name" data-ref-filename="_pdq_t..pdq_os_name">pdq_os_name</a> = <a class="local col4 ref" href="#124name" title='name' data-ref="124name" data-ref-filename="124name">name</a>;</td></tr>
<tr><th id="1596">1596</th><td>    <a class="local col8 ref" href="#128pdq" title='pdq' data-ref="128pdq" data-ref-filename="128pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_flags" title='_pdq_t::pdq_flags' data-ref="_pdq_t::pdq_flags" data-ref-filename="_pdq_t..pdq_flags">pdq_flags</a> = <a class="macro" href="pdqreg.h.html#463" title="0x0010" data-ref="_M/PDQ_PRINTCHARS">PDQ_PRINTCHARS</a>;</td></tr>
<tr><th id="1597">1597</th><td>    <i>/*</i></td></tr>
<tr><th id="1598">1598</th><td><i>     * Allocate the additional data structures required by</i></td></tr>
<tr><th id="1599">1599</th><td><i>     * the PDQ driver.  Allocate a contiguous region of memory</i></td></tr>
<tr><th id="1600">1600</th><td><i>     * for the descriptor block.  We need to allocated enough</i></td></tr>
<tr><th id="1601">1601</th><td><i>     * to guarantee that we will a get 8KB block of memory aligned</i></td></tr>
<tr><th id="1602">1602</th><td><i>     * on a 8KB boundary.  This turns to require that we allocate</i></td></tr>
<tr><th id="1603">1603</th><td><i>     * (N*2 - 1 page) pages of memory.  On machine with less than</i></td></tr>
<tr><th id="1604">1604</th><td><i>     * a 8KB page size, it mean we will allocate more memory than</i></td></tr>
<tr><th id="1605">1605</th><td><i>     * we need.  The extra will be used for the unsolicited event</i></td></tr>
<tr><th id="1606">1606</th><td><i>     * buffers (though on machines with 8KB pages we will to allocate</i></td></tr>
<tr><th id="1607">1607</th><td><i>     * them separately since there will be nothing left overs.)</i></td></tr>
<tr><th id="1608">1608</th><td><i>     */</i></td></tr>
<tr><th id="1609">1609</th><td><u>#<span data-ppcond="1609">if</span> defined(<span class="macro" data-ref="_M/PDQ_OS_MEMALLOC_CONTIG">PDQ_OS_MEMALLOC_CONTIG</span>)</u></td></tr>
<tr><th id="1610">1610</th><td>    p = (pdq_uint8_t *) PDQ_OS_MEMALLOC_CONTIG(contig_bytes);</td></tr>
<tr><th id="1611">1611</th><td>    <b>if</b> (p != NULL) {</td></tr>
<tr><th id="1612">1612</th><td>	pdq_physaddr_t physaddr = PDQ_OS_VA_TO_BUSPA(pdq, p);</td></tr>
<tr><th id="1613">1613</th><td>	<i>/*</i></td></tr>
<tr><th id="1614">1614</th><td><i>	 * Assert that we really got contiguous memory.  This isn't really</i></td></tr>
<tr><th id="1615">1615</th><td><i>	 * needed on systems that actually have physical contiguous allocation</i></td></tr>
<tr><th id="1616">1616</th><td><i>	 * routines, but on those systems that don't ...</i></td></tr>
<tr><th id="1617">1617</th><td><i>	 */</i></td></tr>
<tr><th id="1618">1618</th><td>	<b>for</b> (idx = PDQ_OS_PAGESIZE; idx &lt; <var>0x2000</var>; idx += PDQ_OS_PAGESIZE) {</td></tr>
<tr><th id="1619">1619</th><td>	    <b>if</b> (PDQ_OS_VA_TO_BUSPA(pdq, p + idx) - physaddr != idx)</td></tr>
<tr><th id="1620">1620</th><td>		<b>goto</b> cleanup_and_return;</td></tr>
<tr><th id="1621">1621</th><td>	}</td></tr>
<tr><th id="1622">1622</th><td>	<b>if</b> (physaddr &amp; <var>0x1FFF</var>) {</td></tr>
<tr><th id="1623">1623</th><td>	    pdq-&gt;pdq_unsolicited_info.ui_events = (pdq_unsolicited_event_t *) p;</td></tr>
<tr><th id="1624">1624</th><td>	    pdq-&gt;pdq_unsolicited_info.ui_pa_bufstart = physaddr;</td></tr>
<tr><th id="1625">1625</th><td>	    pdq-&gt;pdq_dbp = (pdq_descriptor_block_t *) &amp;p[<var>0x2000</var> - (physaddr &amp; <var>0x1FFF</var>)];</td></tr>
<tr><th id="1626">1626</th><td>	    pdq-&gt;pdq_pa_descriptor_block = physaddr &amp; ~<var>0x1FFFUL</var>;</td></tr>
<tr><th id="1627">1627</th><td>	} <b>else</b> {</td></tr>
<tr><th id="1628">1628</th><td>	    pdq-&gt;pdq_dbp = (pdq_descriptor_block_t *) p;</td></tr>
<tr><th id="1629">1629</th><td>	    pdq-&gt;pdq_pa_descriptor_block = physaddr;</td></tr>
<tr><th id="1630">1630</th><td>	    pdq-&gt;pdq_unsolicited_info.ui_events = (pdq_unsolicited_event_t *) &amp;p[<var>0x2000</var>];</td></tr>
<tr><th id="1631">1631</th><td>	    pdq-&gt;pdq_unsolicited_info.ui_pa_bufstart = physaddr + <var>0x2000</var>;</td></tr>
<tr><th id="1632">1632</th><td>	}</td></tr>
<tr><th id="1633">1633</th><td>    }</td></tr>
<tr><th id="1634">1634</th><td>    pdq-&gt;pdq_cbp = (<em>volatile</em> pdq_consumer_block_t *) &amp;pdq-&gt;pdq_dbp-&gt;pdqdb_consumer;</td></tr>
<tr><th id="1635">1635</th><td>    pdq-&gt;pdq_pa_consumer_block = PDQ_DB_BUSPA(pdq, pdq-&gt;pdq_cbp);</td></tr>
<tr><th id="1636">1636</th><td>    <b>if</b> (contig_bytes == <b>sizeof</b>(pdq_descriptor_block_t)) {</td></tr>
<tr><th id="1637">1637</th><td>	pdq-&gt;pdq_unsolicited_info.ui_events =</td></tr>
<tr><th id="1638">1638</th><td>	    (pdq_unsolicited_event_t *) PDQ_OS_MEMALLOC(</td></tr>
<tr><th id="1639">1639</th><td>		PDQ_NUM_UNSOLICITED_EVENTS * <b>sizeof</b>(pdq_unsolicited_event_t));</td></tr>
<tr><th id="1640">1640</th><td>    }</td></tr>
<tr><th id="1641">1641</th><td><u>#<span data-ppcond="1609">else</span></u></td></tr>
<tr><th id="1642">1642</th><td>    <b>if</b> (<a class="ref fn" href="pdqvar.h.html#pdq_os_memalloc_contig" title='pdq_os_memalloc_contig' data-ref="pdq_os_memalloc_contig" data-ref-filename="pdq_os_memalloc_contig">pdq_os_memalloc_contig</a>(<a class="local col8 ref" href="#128pdq" title='pdq' data-ref="128pdq" data-ref-filename="128pdq">pdq</a>))</td></tr>
<tr><th id="1643">1643</th><td>	<b>goto</b> <a class="lbl" href="#134cleanup_and_return" data-ref="134cleanup_and_return" data-ref-filename="134cleanup_and_return">cleanup_and_return</a>;</td></tr>
<tr><th id="1644">1644</th><td><u>#<span data-ppcond="1609">endif</span></u></td></tr>
<tr><th id="1645">1645</th><td></td></tr>
<tr><th id="1646">1646</th><td>    <i>/*</i></td></tr>
<tr><th id="1647">1647</th><td><i>     * Make sure everything got allocated.  If not, free what did</i></td></tr>
<tr><th id="1648">1648</th><td><i>     * get allocated and return.</i></td></tr>
<tr><th id="1649">1649</th><td><i>     */</i></td></tr>
<tr><th id="1650">1650</th><td>    <b>if</b> (pdq-&gt;pdq_dbp == <span class='error' title="use of undeclared identifier &apos;NULL&apos;">NULL</span> || pdq-&gt;pdq_unsolicited_info.ui_events == <span class='error' title="use of undeclared identifier &apos;NULL&apos;">NULL</span>) {</td></tr>
<tr><th id="1651">1651</th><td>      <dfn class="lbl" id="134cleanup_and_return" data-ref="134cleanup_and_return" data-ref-filename="134cleanup_and_return">cleanup_and_return</dfn>:</td></tr>
<tr><th id="1652">1652</th><td><u>#<span data-ppcond="1652">ifdef</span> <span class="macro" data-ref="_M/PDQ_OS_MEMFREE_CONTIG">PDQ_OS_MEMFREE_CONTIG</span></u></td></tr>
<tr><th id="1653">1653</th><td>	<b>if</b> (p <i>/* pdq-&gt;pdq_dbp */</i> != NULL)</td></tr>
<tr><th id="1654">1654</th><td>	    PDQ_OS_MEMFREE_CONTIG(p <i>/* pdq-&gt;pdq_dbp */</i>, contig_bytes);</td></tr>
<tr><th id="1655">1655</th><td>	<b>if</b> (contig_bytes == <b>sizeof</b>(pdq_descriptor_block_t) &amp;&amp; pdq-&gt;pdq_unsolicited_info.ui_events != NULL)</td></tr>
<tr><th id="1656">1656</th><td>	    PDQ_OS_MEMFREE(pdq-&gt;pdq_unsolicited_info.ui_events,</td></tr>
<tr><th id="1657">1657</th><td>			   PDQ_NUM_UNSOLICITED_EVENTS * <b>sizeof</b>(pdq_unsolicited_event_t));</td></tr>
<tr><th id="1658">1658</th><td><u>#<span data-ppcond="1652">endif</span></u></td></tr>
<tr><th id="1659">1659</th><td>	<span class='error' title="implicit declaration of function &apos;PDQ_OS_MEMFREE&apos; is invalid in C99"><span class='error' title="this function declaration is not a prototype"><a class="ref fn" href="#1659" title='PDQ_OS_MEMFREE' data-ref="PDQ_OS_MEMFREE" data-ref-filename="PDQ_OS_MEMFREE">PDQ_OS_MEMFREE</a></span></span>(<a class="local col8 ref" href="#128pdq" title='pdq' data-ref="128pdq" data-ref-filename="128pdq">pdq</a>, <b>sizeof</b>(<a class="typedef" href="pdqvar.h.html#pdq_t" title='pdq_t' data-type='struct _pdq_t' data-ref="pdq_t" data-ref-filename="pdq_t">pdq_t</a>));</td></tr>
<tr><th id="1660">1660</th><td>	<b>return</b> <span class='error' title="use of undeclared identifier &apos;NULL&apos;">NULL</span>;</td></tr>
<tr><th id="1661">1661</th><td>    }</td></tr>
<tr><th id="1662">1662</th><td>    <a class="local col0 ref" href="#130dbp" title='dbp' data-ref="130dbp" data-ref-filename="130dbp">dbp</a> = <a class="local col8 ref" href="#128pdq" title='pdq' data-ref="128pdq" data-ref-filename="128pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_dbp" title='_pdq_t::pdq_dbp' data-ref="_pdq_t::pdq_dbp" data-ref-filename="_pdq_t..pdq_dbp">pdq_dbp</a>;</td></tr>
<tr><th id="1663">1663</th><td></td></tr>
<tr><th id="1664">1664</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"\nPDQ Descriptor Block = "</q> PDQ_OS_PTR_FMT <q>" (PA = 0x%x)\n"</q>, dbp, pdq-&gt;pdq_pa_descriptor_block));</td></tr>
<tr><th id="1665">1665</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"    Receive Queue          = "</q> PDQ_OS_PTR_FMT <q>"\n"</q>, dbp-&gt;pdqdb_receives));</td></tr>
<tr><th id="1666">1666</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"    Transmit Queue         = "</q> PDQ_OS_PTR_FMT <q>"\n"</q>, dbp-&gt;pdqdb_transmits));</td></tr>
<tr><th id="1667">1667</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"    Host SMT Queue         = "</q> PDQ_OS_PTR_FMT <q>"\n"</q>, dbp-&gt;pdqdb_host_smt));</td></tr>
<tr><th id="1668">1668</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"    Command Response Queue = "</q> PDQ_OS_PTR_FMT <q>"\n"</q>, dbp-&gt;pdqdb_command_responses));</td></tr>
<tr><th id="1669">1669</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"    Command Request Queue  = "</q> PDQ_OS_PTR_FMT <q>"\n"</q>, dbp-&gt;pdqdb_command_requests));</td></tr>
<tr><th id="1670">1670</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"PDQ Consumer Block = "</q> PDQ_OS_PTR_FMT <q>"\n"</q>, pdq-&gt;pdq_cbp));</td></tr>
<tr><th id="1671">1671</th><td></td></tr>
<tr><th id="1672">1672</th><td>    <i>/*</i></td></tr>
<tr><th id="1673">1673</th><td><i>     * Zero out the descriptor block.  Not really required but</i></td></tr>
<tr><th id="1674">1674</th><td><i>     * it pays to be neat.  This will also zero out the consumer</i></td></tr>
<tr><th id="1675">1675</th><td><i>     * block, command pool, and buffer pointers for the receive</i></td></tr>
<tr><th id="1676">1676</th><td><i>     * host_smt rings.</i></td></tr>
<tr><th id="1677">1677</th><td><i>     */</i></td></tr>
<tr><th id="1678">1678</th><td>    <a class="ref fn" href="#529" title='PDQ_OS_MEMZERO' data-ref="PDQ_OS_MEMZERO" data-ref-filename="PDQ_OS_MEMZERO">PDQ_OS_MEMZERO</a>(<a class="local col0 ref" href="#130dbp" title='dbp' data-ref="130dbp" data-ref-filename="130dbp">dbp</a>, <b>sizeof</b>(*<a class="local col0 ref" href="#130dbp" title='dbp' data-ref="130dbp" data-ref-filename="130dbp">dbp</a>));</td></tr>
<tr><th id="1679">1679</th><td></td></tr>
<tr><th id="1680">1680</th><td>    <i>/*</i></td></tr>
<tr><th id="1681">1681</th><td><i>     * Initialize the CSR references.</i></td></tr>
<tr><th id="1682">1682</th><td><i>     * the DEFAA (FutureBus+) skips a longword between registers</i></td></tr>
<tr><th id="1683">1683</th><td><i>     */</i></td></tr>
<tr><th id="1684">1684</th><td>    pdq_init_csrs(&amp;pdq-&gt;pdq_csrs, bus, csr_base, pdq-&gt;pdq_type == PDQ_DEFAA ? <var>2</var> : <var>1</var>);</td></tr>
<tr><th id="1685">1685</th><td>    <b>if</b> (pdq-&gt;pdq_type == PDQ_DEFPA)</td></tr>
<tr><th id="1686">1686</th><td>	pdq_init_pci_csrs(&amp;pdq-&gt;pdq_pci_csrs, bus, csr_base, <var>1</var>);</td></tr>
<tr><th id="1687">1687</th><td></td></tr>
<tr><th id="1688">1688</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"PDQ CSRs: BASE = "</q> PDQ_OS_CSR_FMT <q>"\n"</q>, pdq-&gt;pdq_csrs.csr_base));</td></tr>
<tr><th id="1689">1689</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"    Port Reset                = "</q> PDQ_OS_CSR_FMT <q>" [0x%08x]\n"</q>,</td></tr>
<tr><th id="1690">1690</th><td>	   pdq-&gt;pdq_csrs.csr_port_reset, PDQ_CSR_READ(&amp;pdq-&gt;pdq_csrs, csr_port_reset)));</td></tr>
<tr><th id="1691">1691</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"    Host Data                 = "</q> PDQ_OS_CSR_FMT <q>" [0x%08x]\n"</q>,</td></tr>
<tr><th id="1692">1692</th><td>	   pdq-&gt;pdq_csrs.csr_host_data, PDQ_CSR_READ(&amp;pdq-&gt;pdq_csrs, csr_host_data)));</td></tr>
<tr><th id="1693">1693</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"    Port Control              = "</q> PDQ_OS_CSR_FMT <q>" [0x%08x]\n"</q>,</td></tr>
<tr><th id="1694">1694</th><td>	   pdq-&gt;pdq_csrs.csr_port_control, PDQ_CSR_READ(&amp;pdq-&gt;pdq_csrs, csr_port_control)));</td></tr>
<tr><th id="1695">1695</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"    Port Data A               = "</q> PDQ_OS_CSR_FMT <q>" [0x%08x]\n"</q>,</td></tr>
<tr><th id="1696">1696</th><td>	   pdq-&gt;pdq_csrs.csr_port_data_a, PDQ_CSR_READ(&amp;pdq-&gt;pdq_csrs, csr_port_data_a)));</td></tr>
<tr><th id="1697">1697</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"    Port Data B               = "</q> PDQ_OS_CSR_FMT <q>" [0x%08x]\n"</q>,</td></tr>
<tr><th id="1698">1698</th><td>	   pdq-&gt;pdq_csrs.csr_port_data_b, PDQ_CSR_READ(&amp;pdq-&gt;pdq_csrs, csr_port_data_b)));</td></tr>
<tr><th id="1699">1699</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"    Port Status               = "</q> PDQ_OS_CSR_FMT <q>" [0x%08x]\n"</q>,</td></tr>
<tr><th id="1700">1700</th><td>	   pdq-&gt;pdq_csrs.csr_port_status, PDQ_CSR_READ(&amp;pdq-&gt;pdq_csrs, csr_port_status)));</td></tr>
<tr><th id="1701">1701</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"    Host Int Type 0           = "</q> PDQ_OS_CSR_FMT <q>" [0x%08x]\n"</q>,</td></tr>
<tr><th id="1702">1702</th><td>	   pdq-&gt;pdq_csrs.csr_host_int_type_0, PDQ_CSR_READ(&amp;pdq-&gt;pdq_csrs, csr_host_int_type_0)));</td></tr>
<tr><th id="1703">1703</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"    Host Int Enable           = "</q> PDQ_OS_CSR_FMT <q>" [0x%08x]\n"</q>,</td></tr>
<tr><th id="1704">1704</th><td>	   pdq-&gt;pdq_csrs.csr_host_int_enable, PDQ_CSR_READ(&amp;pdq-&gt;pdq_csrs, csr_host_int_enable)));</td></tr>
<tr><th id="1705">1705</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"    Type 2 Producer           = "</q> PDQ_OS_CSR_FMT <q>" [0x%08x]\n"</q>,</td></tr>
<tr><th id="1706">1706</th><td>	   pdq-&gt;pdq_csrs.csr_type_2_producer, PDQ_CSR_READ(&amp;pdq-&gt;pdq_csrs, csr_type_2_producer)));</td></tr>
<tr><th id="1707">1707</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"    Command Response Producer = "</q> PDQ_OS_CSR_FMT <q>" [0x%08x]\n"</q>,</td></tr>
<tr><th id="1708">1708</th><td>	   pdq-&gt;pdq_csrs.csr_cmd_response_producer, PDQ_CSR_READ(&amp;pdq-&gt;pdq_csrs, csr_cmd_response_producer)));</td></tr>
<tr><th id="1709">1709</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"    Command Request Producer  = "</q> PDQ_OS_CSR_FMT <q>" [0x%08x]\n"</q>,</td></tr>
<tr><th id="1710">1710</th><td>	   pdq-&gt;pdq_csrs.csr_cmd_request_producer, PDQ_CSR_READ(&amp;pdq-&gt;pdq_csrs, csr_cmd_request_producer)));</td></tr>
<tr><th id="1711">1711</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"    Host SMT Producer         = "</q> PDQ_OS_CSR_FMT <q>" [0x%08x]\n"</q>,</td></tr>
<tr><th id="1712">1712</th><td>	   pdq-&gt;pdq_csrs.csr_host_smt_producer, PDQ_CSR_READ(&amp;pdq-&gt;pdq_csrs, csr_host_smt_producer)));</td></tr>
<tr><th id="1713">1713</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"    Unsolicited Producer      = "</q> PDQ_OS_CSR_FMT <q>" [0x%08x]\n"</q>,</td></tr>
<tr><th id="1714">1714</th><td>	   pdq-&gt;pdq_csrs.csr_unsolicited_producer, PDQ_CSR_READ(&amp;pdq-&gt;pdq_csrs, csr_unsolicited_producer)));</td></tr>
<tr><th id="1715">1715</th><td></td></tr>
<tr><th id="1716">1716</th><td>    <i>/*</i></td></tr>
<tr><th id="1717">1717</th><td><i>     * Initialize the command information block</i></td></tr>
<tr><th id="1718">1718</th><td><i>     */</i></td></tr>
<tr><th id="1719">1719</th><td>    <a class="local col8 ref" href="#128pdq" title='pdq' data-ref="128pdq" data-ref-filename="128pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_command_info" title='_pdq_t::pdq_command_info' data-ref="_pdq_t::pdq_command_info" data-ref-filename="_pdq_t..pdq_command_info">pdq_command_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_request_bufstart" title='(anonymous struct)::ci_request_bufstart' data-ref="(anonymous)::ci_request_bufstart" data-ref-filename="(anonymous)..ci_request_bufstart">ci_request_bufstart</a> = <a class="local col0 ref" href="#130dbp" title='dbp' data-ref="130dbp" data-ref-filename="130dbp">dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_cmd_request_buf" title='(anonymous struct)::pdqdb_cmd_request_buf' data-ref="(anonymous)::pdqdb_cmd_request_buf" data-ref-filename="(anonymous)..pdqdb_cmd_request_buf">pdqdb_cmd_request_buf</a>;</td></tr>
<tr><th id="1720">1720</th><td>    pdq-&gt;pdq_command_info.ci_pa_request_bufstart = <a class="macro" href="pdqreg.h.html#482" title="((pdq)-&gt;pdq_pa_descriptor_block + ((u_int8_t *) (pdq-&gt;pdq_command_info.ci_request_bufstart) - (u_int8_t *) (pdq)-&gt;pdq_dbp))" data-ref="_M/PDQ_DB_BUSPA">PDQ_DB_BUSPA</a>(pdq, pdq-&gt;pdq_command_info.ci_request_bufstart);</td></tr>
<tr><th id="1721">1721</th><td>    pdq-&gt;pdq_command_info.ci_pa_request_descriptors = <a class="macro" href="pdqreg.h.html#482" title="((pdq)-&gt;pdq_pa_descriptor_block + ((u_int8_t *) (dbp-&gt;pdqdb_command_requests) - (u_int8_t *) (pdq)-&gt;pdq_dbp))" data-ref="_M/PDQ_DB_BUSPA">PDQ_DB_BUSPA</a>(pdq, dbp-&gt;pdqdb_command_requests);</td></tr>
<tr><th id="1722">1722</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"PDQ Command Request Buffer = "</q> PDQ_OS_PTR_FMT <q>" (PA=0x%x)\n"</q>,</td></tr>
<tr><th id="1723">1723</th><td>		pdq-&gt;pdq_command_info.ci_request_bufstart,</td></tr>
<tr><th id="1724">1724</th><td>		pdq-&gt;pdq_command_info.ci_pa_request_bufstart));</td></tr>
<tr><th id="1725">1725</th><td>    <b>for</b> (<a class="local col3 ref" href="#133idx" title='idx' data-ref="133idx" data-ref-filename="133idx">idx</a> = <var>0</var>; <a class="local col3 ref" href="#133idx" title='idx' data-ref="133idx" data-ref-filename="133idx">idx</a> &lt; <b>sizeof</b>(<a class="local col0 ref" href="#130dbp" title='dbp' data-ref="130dbp" data-ref-filename="130dbp">dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_command_requests" title='(anonymous struct)::pdqdb_command_requests' data-ref="(anonymous)::pdqdb_command_requests" data-ref-filename="(anonymous)..pdqdb_command_requests">pdqdb_command_requests</a>)/<b>sizeof</b>(<a class="local col0 ref" href="#130dbp" title='dbp' data-ref="130dbp" data-ref-filename="130dbp">dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_command_requests" title='(anonymous struct)::pdqdb_command_requests' data-ref="(anonymous)::pdqdb_command_requests" data-ref-filename="(anonymous)..pdqdb_command_requests">pdqdb_command_requests</a>[<var>0</var>]); <a class="local col3 ref" href="#133idx" title='idx' data-ref="133idx" data-ref-filename="133idx">idx</a>++) {</td></tr>
<tr><th id="1726">1726</th><td>	<a class="typedef" href="pdqreg.h.html#pdq_txdesc_t" title='pdq_txdesc_t' data-type='struct pdq_txdesc_t' data-ref="pdq_txdesc_t" data-ref-filename="pdq_txdesc_t">pdq_txdesc_t</a> *<dfn class="local col5 decl" id="135txd" title='txd' data-type='pdq_txdesc_t *' data-ref="135txd" data-ref-filename="135txd">txd</dfn> = &amp;<a class="local col0 ref" href="#130dbp" title='dbp' data-ref="130dbp" data-ref-filename="130dbp">dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_command_requests" title='(anonymous struct)::pdqdb_command_requests' data-ref="(anonymous)::pdqdb_command_requests" data-ref-filename="(anonymous)..pdqdb_command_requests">pdqdb_command_requests</a>[<a class="local col3 ref" href="#133idx" title='idx' data-ref="133idx" data-ref-filename="133idx">idx</a>];</td></tr>
<tr><th id="1727">1727</th><td></td></tr>
<tr><th id="1728">1728</th><td>	<a class="local col5 ref" href="#135txd" title='txd' data-ref="135txd" data-ref-filename="135txd">txd</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::txd_pa_lo" title='(anonymous struct)::txd_pa_lo' data-ref="(anonymous)::txd_pa_lo" data-ref-filename="(anonymous)..txd_pa_lo">txd_pa_lo</a> = <span class='error' title="implicit declaration of function &apos;htole32&apos; is invalid in C99"><a class="ref fn" href="#517" title='htole32' data-ref="htole32" data-ref-filename="htole32">htole32</a></span>(<a class="local col8 ref" href="#128pdq" title='pdq' data-ref="128pdq" data-ref-filename="128pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_command_info" title='_pdq_t::pdq_command_info' data-ref="_pdq_t::pdq_command_info" data-ref-filename="_pdq_t..pdq_command_info">pdq_command_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_pa_request_bufstart" title='(anonymous struct)::ci_pa_request_bufstart' data-ref="(anonymous)::ci_pa_request_bufstart" data-ref-filename="(anonymous)..ci_pa_request_bufstart">ci_pa_request_bufstart</a>);</td></tr>
<tr><th id="1729">1729</th><td>	<a class="local col5 ref" href="#135txd" title='txd' data-ref="135txd" data-ref-filename="135txd">txd</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::txd_pa_hi" title='(anonymous struct)::txd_pa_hi' data-ref="(anonymous)::txd_pa_hi" data-ref-filename="(anonymous)..txd_pa_hi">txd_pa_hi</a> = <a class="ref fn" href="#517" title='htole32' data-ref="htole32" data-ref-filename="htole32">htole32</a>(<a class="macro" href="pdqreg.h.html#308" title="0x80000000" data-ref="_M/PDQ_TXDESC_SOP">PDQ_TXDESC_SOP</a> | <a class="macro" href="pdqreg.h.html#307" title="0x40000000" data-ref="_M/PDQ_TXDESC_EOP">PDQ_TXDESC_EOP</a>);</td></tr>
<tr><th id="1730">1730</th><td>    }</td></tr>
<tr><th id="1731">1731</th><td>    <a class="macro" href="pdqvar.h.html#479" title="do { } while(0)" data-ref="_M/PDQ_OS_DESC_PRESYNC">PDQ_OS_DESC_PRESYNC</a>(pdq, dbp-&gt;pdqdb_command_requests,</td></tr>
<tr><th id="1732">1732</th><td>			<b>sizeof</b>(dbp-&gt;pdqdb_command_requests));</td></tr>
<tr><th id="1733">1733</th><td></td></tr>
<tr><th id="1734">1734</th><td>    <a class="local col8 ref" href="#128pdq" title='pdq' data-ref="128pdq" data-ref-filename="128pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_command_info" title='_pdq_t::pdq_command_info' data-ref="_pdq_t::pdq_command_info" data-ref-filename="_pdq_t..pdq_command_info">pdq_command_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_response_bufstart" title='(anonymous struct)::ci_response_bufstart' data-ref="(anonymous)::ci_response_bufstart" data-ref-filename="(anonymous)..ci_response_bufstart">ci_response_bufstart</a> = <a class="local col0 ref" href="#130dbp" title='dbp' data-ref="130dbp" data-ref-filename="130dbp">dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_cmd_response_buf" title='(anonymous struct)::pdqdb_cmd_response_buf' data-ref="(anonymous)::pdqdb_cmd_response_buf" data-ref-filename="(anonymous)..pdqdb_cmd_response_buf">pdqdb_cmd_response_buf</a>;</td></tr>
<tr><th id="1735">1735</th><td>    pdq-&gt;pdq_command_info.ci_pa_response_bufstart = <a class="macro" href="pdqreg.h.html#482" title="((pdq)-&gt;pdq_pa_descriptor_block + ((u_int8_t *) (pdq-&gt;pdq_command_info.ci_response_bufstart) - (u_int8_t *) (pdq)-&gt;pdq_dbp))" data-ref="_M/PDQ_DB_BUSPA">PDQ_DB_BUSPA</a>(pdq, pdq-&gt;pdq_command_info.ci_response_bufstart);</td></tr>
<tr><th id="1736">1736</th><td>    pdq-&gt;pdq_command_info.ci_pa_response_descriptors = <a class="macro" href="pdqreg.h.html#482" title="((pdq)-&gt;pdq_pa_descriptor_block + ((u_int8_t *) (dbp-&gt;pdqdb_command_responses) - (u_int8_t *) (pdq)-&gt;pdq_dbp))" data-ref="_M/PDQ_DB_BUSPA">PDQ_DB_BUSPA</a>(pdq, dbp-&gt;pdqdb_command_responses);</td></tr>
<tr><th id="1737">1737</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"PDQ Command Response Buffer = "</q> PDQ_OS_PTR_FMT <q>" (PA=0x%x)\n"</q>,</td></tr>
<tr><th id="1738">1738</th><td>		pdq-&gt;pdq_command_info.ci_response_bufstart,</td></tr>
<tr><th id="1739">1739</th><td>		pdq-&gt;pdq_command_info.ci_pa_response_bufstart));</td></tr>
<tr><th id="1740">1740</th><td>    <b>for</b> (<a class="local col3 ref" href="#133idx" title='idx' data-ref="133idx" data-ref-filename="133idx">idx</a> = <var>0</var>; <a class="local col3 ref" href="#133idx" title='idx' data-ref="133idx" data-ref-filename="133idx">idx</a> &lt; <b>sizeof</b>(<a class="local col0 ref" href="#130dbp" title='dbp' data-ref="130dbp" data-ref-filename="130dbp">dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_command_responses" title='(anonymous struct)::pdqdb_command_responses' data-ref="(anonymous)::pdqdb_command_responses" data-ref-filename="(anonymous)..pdqdb_command_responses">pdqdb_command_responses</a>)/<b>sizeof</b>(<a class="local col0 ref" href="#130dbp" title='dbp' data-ref="130dbp" data-ref-filename="130dbp">dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_command_responses" title='(anonymous struct)::pdqdb_command_responses' data-ref="(anonymous)::pdqdb_command_responses" data-ref-filename="(anonymous)..pdqdb_command_responses">pdqdb_command_responses</a>[<var>0</var>]); <a class="local col3 ref" href="#133idx" title='idx' data-ref="133idx" data-ref-filename="133idx">idx</a>++) {</td></tr>
<tr><th id="1741">1741</th><td>	<a class="typedef" href="pdqreg.h.html#pdq_rxdesc_t" title='pdq_rxdesc_t' data-type='struct pdq_rxdesc_t' data-ref="pdq_rxdesc_t" data-ref-filename="pdq_rxdesc_t">pdq_rxdesc_t</a> *<dfn class="local col6 decl" id="136rxd" title='rxd' data-type='pdq_rxdesc_t *' data-ref="136rxd" data-ref-filename="136rxd">rxd</dfn> = &amp;<a class="local col0 ref" href="#130dbp" title='dbp' data-ref="130dbp" data-ref-filename="130dbp">dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_command_responses" title='(anonymous struct)::pdqdb_command_responses' data-ref="(anonymous)::pdqdb_command_responses" data-ref-filename="(anonymous)..pdqdb_command_responses">pdqdb_command_responses</a>[<a class="local col3 ref" href="#133idx" title='idx' data-ref="133idx" data-ref-filename="133idx">idx</a>];</td></tr>
<tr><th id="1742">1742</th><td></td></tr>
<tr><th id="1743">1743</th><td>	<a class="local col6 ref" href="#136rxd" title='rxd' data-ref="136rxd" data-ref-filename="136rxd">rxd</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::rxd_pa_hi" title='(anonymous struct)::rxd_pa_hi' data-ref="(anonymous)::rxd_pa_hi" data-ref-filename="(anonymous)..rxd_pa_hi">rxd_pa_hi</a> = <span class='error' title="implicit declaration of function &apos;htole32&apos; is invalid in C99"><a class="ref fn" href="#517" title='htole32' data-ref="htole32" data-ref-filename="htole32">htole32</a></span>(<a class="macro" href="pdqreg.h.html#280" title="0x80000000" data-ref="_M/PDQ_RXDESC_SOP">PDQ_RXDESC_SOP</a> |</td></tr>
<tr><th id="1744">1744</th><td>	    <a class="macro" href="pdqreg.h.html#279" title="((((512) &amp; 0xc) &lt;&lt; 27) | (((512) &amp; 0x1ff0) &lt;&lt; 16))" data-ref="_M/PDQ_RXDESC_SEG_LEN">PDQ_RXDESC_SEG_LEN</a>(<a class="macro" href="pdqreg.h.html#337" title="512" data-ref="_M/PDQ_SIZE_COMMAND_RESPONSE">PDQ_SIZE_COMMAND_RESPONSE</a>));</td></tr>
<tr><th id="1745">1745</th><td>	<a class="local col6 ref" href="#136rxd" title='rxd' data-ref="136rxd" data-ref-filename="136rxd">rxd</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::rxd_pa_lo" title='(anonymous struct)::rxd_pa_lo' data-ref="(anonymous)::rxd_pa_lo" data-ref-filename="(anonymous)..rxd_pa_lo">rxd_pa_lo</a> = <a class="ref fn" href="#517" title='htole32' data-ref="htole32" data-ref-filename="htole32">htole32</a>(<a class="local col8 ref" href="#128pdq" title='pdq' data-ref="128pdq" data-ref-filename="128pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_command_info" title='_pdq_t::pdq_command_info' data-ref="_pdq_t::pdq_command_info" data-ref-filename="_pdq_t..pdq_command_info">pdq_command_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::ci_pa_response_bufstart" title='(anonymous struct)::ci_pa_response_bufstart' data-ref="(anonymous)::ci_pa_response_bufstart" data-ref-filename="(anonymous)..ci_pa_response_bufstart">ci_pa_response_bufstart</a>);</td></tr>
<tr><th id="1746">1746</th><td>    }</td></tr>
<tr><th id="1747">1747</th><td>    <a class="macro" href="pdqvar.h.html#479" title="do { } while(0)" data-ref="_M/PDQ_OS_DESC_PRESYNC">PDQ_OS_DESC_PRESYNC</a>(pdq, dbp-&gt;pdqdb_command_responses,</td></tr>
<tr><th id="1748">1748</th><td>			<b>sizeof</b>(dbp-&gt;pdqdb_command_responses));</td></tr>
<tr><th id="1749">1749</th><td></td></tr>
<tr><th id="1750">1750</th><td>    <i>/*</i></td></tr>
<tr><th id="1751">1751</th><td><i>     * Initialize the unsolicited event information block</i></td></tr>
<tr><th id="1752">1752</th><td><i>     */</i></td></tr>
<tr><th id="1753">1753</th><td>    pdq-&gt;pdq_unsolicited_info.ui_free = <a class="macro" href="pdqreg.h.html#391" title="(PDQ_OS_PAGESIZE / 512)" data-ref="_M/PDQ_NUM_UNSOLICITED_EVENTS">PDQ_NUM_UNSOLICITED_EVENTS</a>;</td></tr>
<tr><th id="1754">1754</th><td>    pdq-&gt;pdq_unsolicited_info.ui_pa_descriptors = <a class="macro" href="pdqreg.h.html#482" title="((pdq)-&gt;pdq_pa_descriptor_block + ((u_int8_t *) (dbp-&gt;pdqdb_unsolicited_events) - (u_int8_t *) (pdq)-&gt;pdq_dbp))" data-ref="_M/PDQ_DB_BUSPA">PDQ_DB_BUSPA</a>(pdq, dbp-&gt;pdqdb_unsolicited_events);</td></tr>
<tr><th id="1755">1755</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"PDQ Unsolicit Event Buffer = "</q> PDQ_OS_PTR_FMT <q>" (PA=0x%x)\n"</q>,</td></tr>
<tr><th id="1756">1756</th><td>		pdq-&gt;pdq_unsolicited_info.ui_events,</td></tr>
<tr><th id="1757">1757</th><td>		pdq-&gt;pdq_unsolicited_info.ui_pa_bufstart));</td></tr>
<tr><th id="1758">1758</th><td>    <b>for</b> (<a class="local col3 ref" href="#133idx" title='idx' data-ref="133idx" data-ref-filename="133idx">idx</a> = <var>0</var>; <a class="local col3 ref" href="#133idx" title='idx' data-ref="133idx" data-ref-filename="133idx">idx</a> &lt; <b>sizeof</b>(<a class="local col0 ref" href="#130dbp" title='dbp' data-ref="130dbp" data-ref-filename="130dbp">dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_unsolicited_events" title='(anonymous struct)::pdqdb_unsolicited_events' data-ref="(anonymous)::pdqdb_unsolicited_events" data-ref-filename="(anonymous)..pdqdb_unsolicited_events">pdqdb_unsolicited_events</a>)/<b>sizeof</b>(<a class="local col0 ref" href="#130dbp" title='dbp' data-ref="130dbp" data-ref-filename="130dbp">dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_unsolicited_events" title='(anonymous struct)::pdqdb_unsolicited_events' data-ref="(anonymous)::pdqdb_unsolicited_events" data-ref-filename="(anonymous)..pdqdb_unsolicited_events">pdqdb_unsolicited_events</a>[<var>0</var>]); <a class="local col3 ref" href="#133idx" title='idx' data-ref="133idx" data-ref-filename="133idx">idx</a>++) {</td></tr>
<tr><th id="1759">1759</th><td>	<a class="typedef" href="pdqreg.h.html#pdq_rxdesc_t" title='pdq_rxdesc_t' data-type='struct pdq_rxdesc_t' data-ref="pdq_rxdesc_t" data-ref-filename="pdq_rxdesc_t">pdq_rxdesc_t</a> *<dfn class="local col7 decl" id="137rxd" title='rxd' data-type='pdq_rxdesc_t *' data-ref="137rxd" data-ref-filename="137rxd">rxd</dfn> = &amp;<a class="local col0 ref" href="#130dbp" title='dbp' data-ref="130dbp" data-ref-filename="130dbp">dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_unsolicited_events" title='(anonymous struct)::pdqdb_unsolicited_events' data-ref="(anonymous)::pdqdb_unsolicited_events" data-ref-filename="(anonymous)..pdqdb_unsolicited_events">pdqdb_unsolicited_events</a>[<a class="local col3 ref" href="#133idx" title='idx' data-ref="133idx" data-ref-filename="133idx">idx</a>];</td></tr>
<tr><th id="1760">1760</th><td>	<a class="typedef" href="pdqreg.h.html#pdq_unsolicited_event_t" title='pdq_unsolicited_event_t' data-type='struct _pdq_unsolicited_event_t' data-ref="pdq_unsolicited_event_t" data-ref-filename="pdq_unsolicited_event_t">pdq_unsolicited_event_t</a> *<dfn class="local col8 decl" id="138event" title='event' data-type='pdq_unsolicited_event_t *' data-ref="138event" data-ref-filename="138event">event</dfn> = &amp;pdq-&gt;pdq_unsolicited_info.ui_events[idx &amp; (<a class="macro" href="pdqreg.h.html#391" title="(PDQ_OS_PAGESIZE / 512)" data-ref="_M/PDQ_NUM_UNSOLICITED_EVENTS">PDQ_NUM_UNSOLICITED_EVENTS</a>-<var>1</var>)];</td></tr>
<tr><th id="1761">1761</th><td></td></tr>
<tr><th id="1762">1762</th><td>	<a class="local col7 ref" href="#137rxd" title='rxd' data-ref="137rxd" data-ref-filename="137rxd">rxd</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::rxd_pa_hi" title='(anonymous struct)::rxd_pa_hi' data-ref="(anonymous)::rxd_pa_hi" data-ref-filename="(anonymous)..rxd_pa_hi">rxd_pa_hi</a> = <span class='error' title="implicit declaration of function &apos;htole32&apos; is invalid in C99"><a class="ref fn" href="#517" title='htole32' data-ref="htole32" data-ref-filename="htole32">htole32</a></span>(<a class="macro" href="pdqreg.h.html#280" title="0x80000000" data-ref="_M/PDQ_RXDESC_SOP">PDQ_RXDESC_SOP</a> |</td></tr>
<tr><th id="1763">1763</th><td>		<a class="macro" href="pdqreg.h.html#279" title="((((sizeof(pdq_unsolicited_event_t)) &amp; 0xc) &lt;&lt; 27) | (((sizeof(pdq_unsolicited_event_t)) &amp; 0x1ff0) &lt;&lt; 16))" data-ref="_M/PDQ_RXDESC_SEG_LEN">PDQ_RXDESC_SEG_LEN</a>(<b>sizeof</b>(<a class="typedef" href="pdqreg.h.html#pdq_unsolicited_event_t" title='pdq_unsolicited_event_t' data-type='struct _pdq_unsolicited_event_t' data-ref="pdq_unsolicited_event_t" data-ref-filename="pdq_unsolicited_event_t">pdq_unsolicited_event_t</a>)));</td></tr>
<tr><th id="1764">1764</th><td>	<a class="local col7 ref" href="#137rxd" title='rxd' data-ref="137rxd" data-ref-filename="137rxd">rxd</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::rxd_pa_lo" title='(anonymous struct)::rxd_pa_lo' data-ref="(anonymous)::rxd_pa_lo" data-ref-filename="(anonymous)..rxd_pa_lo">rxd_pa_lo</a> = <a class="ref fn" href="#517" title='htole32' data-ref="htole32" data-ref-filename="htole32">htole32</a>(<a class="local col8 ref" href="#128pdq" title='pdq' data-ref="128pdq" data-ref-filename="128pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_unsolicited_info" title='_pdq_t::pdq_unsolicited_info' data-ref="_pdq_t::pdq_unsolicited_info" data-ref-filename="_pdq_t..pdq_unsolicited_info">pdq_unsolicited_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::ui_pa_bufstart" title='(anonymous struct)::ui_pa_bufstart' data-ref="(anonymous)::ui_pa_bufstart" data-ref-filename="(anonymous)..ui_pa_bufstart">ui_pa_bufstart</a> + (<em>const</em> <a class="typedef" href="pdqvar.h.html#pdq_uint8_t" title='pdq_uint8_t' data-type='unsigned char' data-ref="pdq_uint8_t" data-ref-filename="pdq_uint8_t">pdq_uint8_t</a> *) <a class="local col8 ref" href="#138event" title='event' data-ref="138event" data-ref-filename="138event">event</a></td></tr>
<tr><th id="1765">1765</th><td>	    - (<em>const</em> <a class="typedef" href="pdqvar.h.html#pdq_uint8_t" title='pdq_uint8_t' data-type='unsigned char' data-ref="pdq_uint8_t" data-ref-filename="pdq_uint8_t">pdq_uint8_t</a> *) <a class="local col8 ref" href="#128pdq" title='pdq' data-ref="128pdq" data-ref-filename="128pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_unsolicited_info" title='_pdq_t::pdq_unsolicited_info' data-ref="_pdq_t::pdq_unsolicited_info" data-ref-filename="_pdq_t..pdq_unsolicited_info">pdq_unsolicited_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::ui_events" title='(anonymous struct)::ui_events' data-ref="(anonymous)::ui_events" data-ref-filename="(anonymous)..ui_events">ui_events</a>);</td></tr>
<tr><th id="1766">1766</th><td>	<a class="macro" href="pdqvar.h.html#487" title="do { } while(0)" data-ref="_M/PDQ_OS_UNSOL_EVENT_PRESYNC">PDQ_OS_UNSOL_EVENT_PRESYNC</a>(pdq, event);</td></tr>
<tr><th id="1767">1767</th><td>    }</td></tr>
<tr><th id="1768">1768</th><td>    <a class="macro" href="pdqvar.h.html#479" title="do { } while(0)" data-ref="_M/PDQ_OS_DESC_PRESYNC">PDQ_OS_DESC_PRESYNC</a>(pdq, dbp-&gt;pdqdb_unsolicited_events,</td></tr>
<tr><th id="1769">1769</th><td>			<b>sizeof</b>(dbp-&gt;pdqdb_unsolicited_events));</td></tr>
<tr><th id="1770">1770</th><td></td></tr>
<tr><th id="1771">1771</th><td>    <i>/*</i></td></tr>
<tr><th id="1772">1772</th><td><i>     * Initialize the receive information blocks (normal and SMT).</i></td></tr>
<tr><th id="1773">1773</th><td><i>     */</i></td></tr>
<tr><th id="1774">1774</th><td>    <a class="local col8 ref" href="#128pdq" title='pdq' data-ref="128pdq" data-ref-filename="128pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_rx_info" title='_pdq_t::pdq_rx_info' data-ref="_pdq_t::pdq_rx_info" data-ref-filename="_pdq_t..pdq_rx_info">pdq_rx_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::rx_buffers" title='(anonymous struct)::rx_buffers' data-ref="(anonymous)::rx_buffers" data-ref-filename="(anonymous)..rx_buffers">rx_buffers</a> = <a class="local col8 ref" href="#128pdq" title='pdq' data-ref="128pdq" data-ref-filename="128pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_receive_buffers" title='_pdq_t::pdq_receive_buffers' data-ref="_pdq_t::pdq_receive_buffers" data-ref-filename="_pdq_t..pdq_receive_buffers">pdq_receive_buffers</a>;</td></tr>
<tr><th id="1775">1775</th><td>    <a class="local col8 ref" href="#128pdq" title='pdq' data-ref="128pdq" data-ref-filename="128pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_rx_info" title='_pdq_t::pdq_rx_info' data-ref="_pdq_t::pdq_rx_info" data-ref-filename="_pdq_t..pdq_rx_info">pdq_rx_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::rx_free" title='(anonymous struct)::rx_free' data-ref="(anonymous)::rx_free" data-ref-filename="(anonymous)..rx_free">rx_free</a> = <a class="macro" href="pdqreg.h.html#52" title="(((sizeof(dbp-&gt;pdqdb_receives) / sizeof(dbp-&gt;pdqdb_receives[0]))) - 1)" data-ref="_M/PDQ_RING_MASK">PDQ_RING_MASK</a>(<a class="local col0 ref" href="#130dbp" title='dbp' data-ref="130dbp" data-ref-filename="130dbp">dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_receives" title='(anonymous struct)::pdqdb_receives' data-ref="(anonymous)::pdqdb_receives" data-ref-filename="(anonymous)..pdqdb_receives">pdqdb_receives</a>);</td></tr>
<tr><th id="1776">1776</th><td>    pdq-&gt;pdq_rx_info.rx_target = pdq-&gt;pdq_rx_info.rx_free - <a class="macro" href="pdqreg.h.html#406" title="((4495 + PDQ_OS_DATABUF_SIZE - 1) / PDQ_OS_DATABUF_SIZE)" data-ref="_M/PDQ_RX_SEGCNT">PDQ_RX_SEGCNT</a> * <var>8</var>;</td></tr>
<tr><th id="1777">1777</th><td>    pdq-&gt;pdq_rx_info.rx_pa_descriptors = <a class="macro" href="pdqreg.h.html#482" title="((pdq)-&gt;pdq_pa_descriptor_block + ((u_int8_t *) (dbp-&gt;pdqdb_receives) - (u_int8_t *) (pdq)-&gt;pdq_dbp))" data-ref="_M/PDQ_DB_BUSPA">PDQ_DB_BUSPA</a>(pdq, dbp-&gt;pdqdb_receives);</td></tr>
<tr><th id="1778">1778</th><td></td></tr>
<tr><th id="1779">1779</th><td>    <a class="local col8 ref" href="#128pdq" title='pdq' data-ref="128pdq" data-ref-filename="128pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_host_smt_info" title='_pdq_t::pdq_host_smt_info' data-ref="_pdq_t::pdq_host_smt_info" data-ref-filename="_pdq_t..pdq_host_smt_info">pdq_host_smt_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::rx_buffers" title='(anonymous struct)::rx_buffers' data-ref="(anonymous)::rx_buffers" data-ref-filename="(anonymous)..rx_buffers">rx_buffers</a> = <a class="local col8 ref" href="#128pdq" title='pdq' data-ref="128pdq" data-ref-filename="128pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_host_smt_buffers" title='_pdq_t::pdq_host_smt_buffers' data-ref="_pdq_t::pdq_host_smt_buffers" data-ref-filename="_pdq_t..pdq_host_smt_buffers">pdq_host_smt_buffers</a>;</td></tr>
<tr><th id="1780">1780</th><td>    <a class="local col8 ref" href="#128pdq" title='pdq' data-ref="128pdq" data-ref-filename="128pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_host_smt_info" title='_pdq_t::pdq_host_smt_info' data-ref="_pdq_t::pdq_host_smt_info" data-ref-filename="_pdq_t..pdq_host_smt_info">pdq_host_smt_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::rx_free" title='(anonymous struct)::rx_free' data-ref="(anonymous)::rx_free" data-ref-filename="(anonymous)..rx_free">rx_free</a> = <a class="macro" href="pdqreg.h.html#52" title="(((sizeof(dbp-&gt;pdqdb_host_smt) / sizeof(dbp-&gt;pdqdb_host_smt[0]))) - 1)" data-ref="_M/PDQ_RING_MASK">PDQ_RING_MASK</a>(<a class="local col0 ref" href="#130dbp" title='dbp' data-ref="130dbp" data-ref-filename="130dbp">dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_host_smt" title='(anonymous struct)::pdqdb_host_smt' data-ref="(anonymous)::pdqdb_host_smt" data-ref-filename="(anonymous)..pdqdb_host_smt">pdqdb_host_smt</a>);</td></tr>
<tr><th id="1781">1781</th><td>    pdq-&gt;pdq_host_smt_info.rx_target = pdq-&gt;pdq_host_smt_info.rx_free - <a class="macro" href="pdqreg.h.html#406" title="((4495 + PDQ_OS_DATABUF_SIZE - 1) / PDQ_OS_DATABUF_SIZE)" data-ref="_M/PDQ_RX_SEGCNT">PDQ_RX_SEGCNT</a> * <var>3</var>;</td></tr>
<tr><th id="1782">1782</th><td>    pdq-&gt;pdq_host_smt_info.rx_pa_descriptors = <a class="macro" href="pdqreg.h.html#482" title="((pdq)-&gt;pdq_pa_descriptor_block + ((u_int8_t *) (dbp-&gt;pdqdb_host_smt) - (u_int8_t *) (pdq)-&gt;pdq_dbp))" data-ref="_M/PDQ_DB_BUSPA">PDQ_DB_BUSPA</a>(pdq, dbp-&gt;pdqdb_host_smt);</td></tr>
<tr><th id="1783">1783</th><td></td></tr>
<tr><th id="1784">1784</th><td>    <i>/*</i></td></tr>
<tr><th id="1785">1785</th><td><i>     * Initialize the transmit information block.</i></td></tr>
<tr><th id="1786">1786</th><td><i>     */</i></td></tr>
<tr><th id="1787">1787</th><td>    <a class="local col0 ref" href="#130dbp" title='dbp' data-ref="130dbp" data-ref-filename="130dbp">dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_tx_hdr" title='(anonymous struct)::pdqdb_tx_hdr' data-ref="(anonymous)::pdqdb_tx_hdr" data-ref-filename="(anonymous)..pdqdb_tx_hdr">pdqdb_tx_hdr</a>[<var>0</var>] = <a class="macro" href="pdqreg.h.html#70" title="0x20" data-ref="_M/PDQ_FDDI_PH0">PDQ_FDDI_PH0</a>;</td></tr>
<tr><th id="1788">1788</th><td>    <a class="local col0 ref" href="#130dbp" title='dbp' data-ref="130dbp" data-ref-filename="130dbp">dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_tx_hdr" title='(anonymous struct)::pdqdb_tx_hdr' data-ref="(anonymous)::pdqdb_tx_hdr" data-ref-filename="(anonymous)..pdqdb_tx_hdr">pdqdb_tx_hdr</a>[<var>1</var>] = <a class="macro" href="pdqreg.h.html#71" title="0x38" data-ref="_M/PDQ_FDDI_PH1">PDQ_FDDI_PH1</a>;</td></tr>
<tr><th id="1789">1789</th><td>    <a class="local col0 ref" href="#130dbp" title='dbp' data-ref="130dbp" data-ref-filename="130dbp">dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_tx_hdr" title='(anonymous struct)::pdqdb_tx_hdr' data-ref="(anonymous)::pdqdb_tx_hdr" data-ref-filename="(anonymous)..pdqdb_tx_hdr">pdqdb_tx_hdr</a>[<var>2</var>] = <a class="macro" href="pdqreg.h.html#72" title="0x00" data-ref="_M/PDQ_FDDI_PH2">PDQ_FDDI_PH2</a>;</td></tr>
<tr><th id="1790">1790</th><td>    <a class="local col8 ref" href="#128pdq" title='pdq' data-ref="128pdq" data-ref-filename="128pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_tx_info" title='_pdq_t::pdq_tx_info' data-ref="_pdq_t::pdq_tx_info" data-ref-filename="_pdq_t..pdq_tx_info">pdq_tx_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::tx_free" title='(anonymous struct)::tx_free' data-ref="(anonymous)::tx_free" data-ref-filename="(anonymous)..tx_free">tx_free</a> = <a class="macro" href="pdqreg.h.html#52" title="(((sizeof(dbp-&gt;pdqdb_transmits) / sizeof(dbp-&gt;pdqdb_transmits[0]))) - 1)" data-ref="_M/PDQ_RING_MASK">PDQ_RING_MASK</a>(<a class="local col0 ref" href="#130dbp" title='dbp' data-ref="130dbp" data-ref-filename="130dbp">dbp</a>-&gt;<a class="ref field" href="pdqreg.h.html#(anonymous)::pdqdb_transmits" title='(anonymous struct)::pdqdb_transmits' data-ref="(anonymous)::pdqdb_transmits" data-ref-filename="(anonymous)..pdqdb_transmits">pdqdb_transmits</a>);</td></tr>
<tr><th id="1791">1791</th><td>    <a class="local col8 ref" href="#128pdq" title='pdq' data-ref="128pdq" data-ref-filename="128pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_tx_info" title='_pdq_t::pdq_tx_info' data-ref="_pdq_t::pdq_tx_info" data-ref-filename="_pdq_t..pdq_tx_info">pdq_tx_info</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::tx_hdrdesc" title='(anonymous struct)::tx_hdrdesc' data-ref="(anonymous)::tx_hdrdesc" data-ref-filename="(anonymous)..tx_hdrdesc">tx_hdrdesc</a>.<a class="ref field" href="pdqreg.h.html#(anonymous)::txd_pa_hi" title='(anonymous struct)::txd_pa_hi' data-ref="(anonymous)::txd_pa_hi" data-ref-filename="(anonymous)..txd_pa_hi">txd_pa_hi</a> = <span class='error' title="implicit declaration of function &apos;htole32&apos; is invalid in C99"><a class="ref fn" href="#517" title='htole32' data-ref="htole32" data-ref-filename="htole32">htole32</a></span>(<a class="macro" href="pdqreg.h.html#308" title="0x80000000" data-ref="_M/PDQ_TXDESC_SOP">PDQ_TXDESC_SOP</a>|<a class="macro" href="pdqreg.h.html#305" title="(((3) &amp; 0x1fff) &lt;&lt; 16)" data-ref="_M/PDQ_TXDESC_SEG_LEN">PDQ_TXDESC_SEG_LEN</a>(<var>3</var>));</td></tr>
<tr><th id="1792">1792</th><td>    pdq-&gt;pdq_tx_info.tx_hdrdesc.txd_pa_lo = htole32(<a class="macro" href="pdqreg.h.html#482" title="((pdq)-&gt;pdq_pa_descriptor_block + ((u_int8_t *) (dbp-&gt;pdqdb_tx_hdr) - (u_int8_t *) (pdq)-&gt;pdq_dbp))" data-ref="_M/PDQ_DB_BUSPA">PDQ_DB_BUSPA</a>(pdq, dbp-&gt;pdqdb_tx_hdr));</td></tr>
<tr><th id="1793">1793</th><td>    pdq-&gt;pdq_tx_info.tx_pa_descriptors = <a class="macro" href="pdqreg.h.html#482" title="((pdq)-&gt;pdq_pa_descriptor_block + ((u_int8_t *) (dbp-&gt;pdqdb_transmits) - (u_int8_t *) (pdq)-&gt;pdq_dbp))" data-ref="_M/PDQ_DB_BUSPA">PDQ_DB_BUSPA</a>(pdq, dbp-&gt;pdqdb_transmits);</td></tr>
<tr><th id="1794">1794</th><td></td></tr>
<tr><th id="1795">1795</th><td>    state = <a class="macro" href="pdqreg.h.html#226" title="((pdq_state_t) (((PDQ_CSR_READ(&amp;pdq-&gt;pdq_csrs, csr_port_status)) &gt;&gt; 8) &amp; 0x07))" data-ref="_M/PDQ_PSTS_ADAPTER_STATE">PDQ_PSTS_ADAPTER_STATE</a>(<span class='error' title="implicit declaration of function &apos;PDQ_CSR_READ&apos; is invalid in C99">PDQ_CSR_READ</span>(&amp;pdq-&gt;pdq_csrs, <span class='error' title="use of undeclared identifier &apos;csr_port_status&apos;">csr_port_status</span>));</td></tr>
<tr><th id="1796">1796</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"PDQ Adapter State = %s\n"</q>, pdq_adapter_states[state]));</td></tr>
<tr><th id="1797">1797</th><td></td></tr>
<tr><th id="1798">1798</th><td>    <i>/*</i></td></tr>
<tr><th id="1799">1799</th><td><i>     * Stop the PDQ if it is running and put it into a known state.</i></td></tr>
<tr><th id="1800">1800</th><td><i>     */</i></td></tr>
<tr><th id="1801">1801</th><td>    <a class="local col9 ref" href="#129state" title='state' data-ref="129state" data-ref-filename="129state">state</a> = <a class="ref fn" href="#pdq_stop" title='pdq_stop' data-ref="pdq_stop" data-ref-filename="pdq_stop">pdq_stop</a>(<a class="local col8 ref" href="#128pdq" title='pdq' data-ref="128pdq" data-ref-filename="128pdq">pdq</a>);</td></tr>
<tr><th id="1802">1802</th><td></td></tr>
<tr><th id="1803">1803</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"PDQ Adapter State = %s\n"</q>, pdq_adapter_states[state]));</td></tr>
<tr><th id="1804">1804</th><td>    <a class="macro" href="pdqreg.h.html#47" title="do { } while(0)" data-ref="_M/PDQ_ASSERT">PDQ_ASSERT</a>(state == PDQS_DMA_AVAILABLE);</td></tr>
<tr><th id="1805">1805</th><td>    <i>/*</i></td></tr>
<tr><th id="1806">1806</th><td><i>     * If the adapter is not the state we expect, then the initialization</i></td></tr>
<tr><th id="1807">1807</th><td><i>     * failed.  Cleanup and exit.</i></td></tr>
<tr><th id="1808">1808</th><td><i>     */</i></td></tr>
<tr><th id="1809">1809</th><td><u>#<span data-ppcond="1809">if</span> defined(<span class="macro" data-ref="_M/PDQVERBOSE">PDQVERBOSE</span>)</u></td></tr>
<tr><th id="1810">1810</th><td>    <b>if</b> (state == PDQS_HALTED) {</td></tr>
<tr><th id="1811">1811</th><td>	pdq_halt_code_t halt_code = PDQ_PSTS_HALT_ID(PDQ_CSR_READ(&amp;pdq-&gt;pdq_csrs, csr_port_status));</td></tr>
<tr><th id="1812">1812</th><td>	printf(<q>"Halt code = %d (%s)\n"</q>, halt_code, pdq_halt_codes[halt_code]);</td></tr>
<tr><th id="1813">1813</th><td>	<b>if</b> (halt_code == PDQH_DMA_ERROR &amp;&amp; pdq-&gt;pdq_type == PDQ_DEFPA)</td></tr>
<tr><th id="1814">1814</th><td>	    PDQ_PRINTF((<q>"PFI status = 0x%x, Host 0 Fatal Interrupt = 0x%x\n"</q>,</td></tr>
<tr><th id="1815">1815</th><td>		       PDQ_CSR_READ(&amp;pdq-&gt;pdq_pci_csrs, csr_pfi_status),</td></tr>
<tr><th id="1816">1816</th><td>		       PDQ_CSR_READ(&amp;pdq-&gt;pdq_csrs, csr_host_int_type_0) &amp; PDQ_HOST_INT_FATAL_ERROR));</td></tr>
<tr><th id="1817">1817</th><td>    }</td></tr>
<tr><th id="1818">1818</th><td><u>#<span data-ppcond="1809">endif</span></u></td></tr>
<tr><th id="1819">1819</th><td>    <b>if</b> (<a class="local col9 ref" href="#129state" title='state' data-ref="129state" data-ref-filename="129state">state</a> == <a class="enum" href="pdqvar.h.html#PDQS_RESET" title='PDQS_RESET' data-ref="PDQS_RESET" data-ref-filename="PDQS_RESET">PDQS_RESET</a> || <a class="local col9 ref" href="#129state" title='state' data-ref="129state" data-ref-filename="129state">state</a> == <a class="enum" href="pdqvar.h.html#PDQS_HALTED" title='PDQS_HALTED' data-ref="PDQS_HALTED" data-ref-filename="PDQS_HALTED">PDQS_HALTED</a> || <a class="local col9 ref" href="#129state" title='state' data-ref="129state" data-ref-filename="129state">state</a> == <a class="enum" href="pdqvar.h.html#PDQS_UPGRADE" title='PDQS_UPGRADE' data-ref="PDQS_UPGRADE" data-ref-filename="PDQS_UPGRADE">PDQS_UPGRADE</a>)</td></tr>
<tr><th id="1820">1820</th><td>	<b>goto</b> <a class="lbl" href="#134cleanup_and_return" data-ref="134cleanup_and_return" data-ref-filename="134cleanup_and_return">cleanup_and_return</a>;</td></tr>
<tr><th id="1821">1821</th><td></td></tr>
<tr><th id="1822">1822</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"PDQ Hardware Address = %02x-%02x-%02x-%02x-%02x-%02x\n"</q>,</td></tr>
<tr><th id="1823">1823</th><td>	   pdq-&gt;pdq_hwaddr.lanaddr_bytes[<var>0</var>], pdq-&gt;pdq_hwaddr.lanaddr_bytes[<var>1</var>],</td></tr>
<tr><th id="1824">1824</th><td>	   pdq-&gt;pdq_hwaddr.lanaddr_bytes[<var>2</var>], pdq-&gt;pdq_hwaddr.lanaddr_bytes[<var>3</var>],</td></tr>
<tr><th id="1825">1825</th><td>	   pdq-&gt;pdq_hwaddr.lanaddr_bytes[<var>4</var>], pdq-&gt;pdq_hwaddr.lanaddr_bytes[<var>5</var>]));</td></tr>
<tr><th id="1826">1826</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"PDQ Firmware Revision = %c%c%c%c\n"</q>,</td></tr>
<tr><th id="1827">1827</th><td>	   pdq-&gt;pdq_fwrev.fwrev_bytes[<var>0</var>], pdq-&gt;pdq_fwrev.fwrev_bytes[<var>1</var>],</td></tr>
<tr><th id="1828">1828</th><td>	   pdq-&gt;pdq_fwrev.fwrev_bytes[<var>2</var>], pdq-&gt;pdq_fwrev.fwrev_bytes[<var>3</var>]));</td></tr>
<tr><th id="1829">1829</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"PDQ Chip Revision = "</q>));</td></tr>
<tr><th id="1830">1830</th><td>    <b>switch</b> (<a class="local col8 ref" href="#128pdq" title='pdq' data-ref="128pdq" data-ref-filename="128pdq">pdq</a>-&gt;<a class="ref field" href="pdqreg.h.html#_pdq_t::pdq_chip_rev" title='_pdq_t::pdq_chip_rev' data-ref="_pdq_t::pdq_chip_rev" data-ref-filename="_pdq_t..pdq_chip_rev">pdq_chip_rev</a>) {</td></tr>
<tr><th id="1831">1831</th><td>	<b>case</b> <a class="enum" href="pdqreg.h.html#PDQ_CHIP_REV_A_B_OR_C" title='PDQ_CHIP_REV_A_B_OR_C' data-ref="PDQ_CHIP_REV_A_B_OR_C" data-ref-filename="PDQ_CHIP_REV_A_B_OR_C">PDQ_CHIP_REV_A_B_OR_C</a>: <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"Rev C or below"</q>)); <b>break</b>;</td></tr>
<tr><th id="1832">1832</th><td>	<b>case</b> <a class="enum" href="pdqreg.h.html#PDQ_CHIP_REV_D" title='PDQ_CHIP_REV_D' data-ref="PDQ_CHIP_REV_D" data-ref-filename="PDQ_CHIP_REV_D">PDQ_CHIP_REV_D</a>: <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"Rev D"</q>)); <b>break</b>;</td></tr>
<tr><th id="1833">1833</th><td>	<b>case</b> <a class="enum" href="pdqreg.h.html#PDQ_CHIP_REV_E" title='PDQ_CHIP_REV_E' data-ref="PDQ_CHIP_REV_E" data-ref-filename="PDQ_CHIP_REV_E">PDQ_CHIP_REV_E</a>: <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"Rev E"</q>)); <b>break</b>;</td></tr>
<tr><th id="1834">1834</th><td>	<b>default</b>: <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"Unknown Rev %d"</q>, (<em>int</em>) pdq-&gt;pdq_chip_rev));</td></tr>
<tr><th id="1835">1835</th><td>    }</td></tr>
<tr><th id="1836">1836</th><td>    <a class="macro" href="#64" title="do { } while (0)" data-ref="_M/PDQ_PRINTF">PDQ_PRINTF</a>((<q>"\n"</q>));</td></tr>
<tr><th id="1837">1837</th><td></td></tr>
<tr><th id="1838">1838</th><td>    <b>return</b> <a class="local col8 ref" href="#128pdq" title='pdq' data-ref="128pdq" data-ref-filename="128pdq">pdq</a>;</td></tr>
<tr><th id="1839">1839</th><td>}</td></tr>
<tr><th id="1840">1840</th><td></td></tr>
</table><hr/><p id='footer'>
Generated on <em>2019-Jul-19</em> from project netbsd revision <em>f9da89e0d</em><br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 2.1
<br/>Generator usage only permitted with license.</p>
</div></body></html>
