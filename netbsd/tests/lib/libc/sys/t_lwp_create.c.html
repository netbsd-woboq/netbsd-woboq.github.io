<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>t_lwp_create.c source code [netbsd/tests/lib/libc/sys/t_lwp_create.c] - Woboq Code Browser</title>
<link rel="stylesheet" href="https://code.woboq.org/data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="https://code.woboq.org/data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="https://code.woboq.org/data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="https://code.woboq.org/data/jquery/jquery-ui.min.js"></script>
<script>var file = 'netbsd/tests/lib/libc/sys/t_lwp_create.c'; var root_path = '../../../../..'; var data_path = 'https://code.woboq.org/data'; var ecma_script_api_version = 2;</script>
<script src='https://code.woboq.org/data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='../../../..'>netbsd</a>/<a href='../../..'>tests</a>/<a href='../..'>lib</a>/<a href='..'>libc</a>/<a href='./'>sys</a>/<a href='t_lwp_create.c.html'>t_lwp_create.c</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>/* $NetBSD: t_lwp_create.c,v 1.2 2012/05/22 09:23:39 martin Exp $ */</i></td></tr>
<tr><th id="2">2</th><td></td></tr>
<tr><th id="3">3</th><td><i>/*-</i></td></tr>
<tr><th id="4">4</th><td><i> * Copyright (c) 2012 The NetBSD Foundation, Inc.</i></td></tr>
<tr><th id="5">5</th><td><i> * All rights reserved.</i></td></tr>
<tr><th id="6">6</th><td><i> *</i></td></tr>
<tr><th id="7">7</th><td><i> * Redistribution and use in source and binary forms, with or without</i></td></tr>
<tr><th id="8">8</th><td><i> * modification, are permitted provided that the following conditions</i></td></tr>
<tr><th id="9">9</th><td><i> * are met:</i></td></tr>
<tr><th id="10">10</th><td><i> * 1. Redistributions of source code must retain the above copyright</i></td></tr>
<tr><th id="11">11</th><td><i> *    notice, this list of conditions and the following disclaimer.</i></td></tr>
<tr><th id="12">12</th><td><i> * 2. Redistributions in binary form must reproduce the above copyright</i></td></tr>
<tr><th id="13">13</th><td><i> *    notice, this list of conditions and the following disclaimer in the</i></td></tr>
<tr><th id="14">14</th><td><i> *    documentation and/or other materials provided with the distribution.</i></td></tr>
<tr><th id="15">15</th><td><i> *</i></td></tr>
<tr><th id="16">16</th><td><i> * THIS SOFTWARE IS PROVIDED BY THE NETBSD FOUNDATION, INC. AND CONTRIBUTORS</i></td></tr>
<tr><th id="17">17</th><td><i> * ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED</i></td></tr>
<tr><th id="18">18</th><td><i> * TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR</i></td></tr>
<tr><th id="19">19</th><td><i> * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE FOUNDATION OR CONTRIBUTORS</i></td></tr>
<tr><th id="20">20</th><td><i> * BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR</i></td></tr>
<tr><th id="21">21</th><td><i> * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF</i></td></tr>
<tr><th id="22">22</th><td><i> * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS</i></td></tr>
<tr><th id="23">23</th><td><i> * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN</i></td></tr>
<tr><th id="24">24</th><td><i> * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)</i></td></tr>
<tr><th id="25">25</th><td><i> * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE</i></td></tr>
<tr><th id="26">26</th><td><i> * POSSIBILITY OF SUCH DAMAGE.</i></td></tr>
<tr><th id="27">27</th><td><i> */</i></td></tr>
<tr><th id="28">28</th><td></td></tr>
<tr><th id="29">29</th><td><i>/*</i></td></tr>
<tr><th id="30">30</th><td><i> * This code is partly based on code by Joel Sing &lt;joel at sing.id.au&gt;</i></td></tr>
<tr><th id="31">31</th><td><i> */</i></td></tr>
<tr><th id="32">32</th><td></td></tr>
<tr><th id="33">33</th><td><u>#include <a href="../../../../objdir.amd64/destdir.amd64/usr/include/atf-c.h.html">&lt;atf-c.h&gt;</a></u></td></tr>
<tr><th id="34">34</th><td><u>#include <a href="../../../../objdir.amd64/destdir.amd64/usr/include/lwp.h.html">&lt;lwp.h&gt;</a></u></td></tr>
<tr><th id="35">35</th><td><u>#include <a href="../../../../objdir.amd64/destdir.amd64/usr/include/stdio.h.html">&lt;stdio.h&gt;</a></u></td></tr>
<tr><th id="36">36</th><td><u>#include <a href="../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html">&lt;stdlib.h&gt;</a></u></td></tr>
<tr><th id="37">37</th><td><u>#include <a href="../../../../objdir.amd64/destdir.amd64/usr/include/ucontext.h.html">&lt;ucontext.h&gt;</a></u></td></tr>
<tr><th id="38">38</th><td><u>#include &lt;inttypes.h&gt;</u></td></tr>
<tr><th id="39">39</th><td><u>#include <a href="../../../../objdir.amd64/destdir.amd64/usr/include/errno.h.html">&lt;errno.h&gt;</a></u></td></tr>
<tr><th id="40">40</th><td></td></tr>
<tr><th id="41">41</th><td><u>#<span data-ppcond="41">ifdef</span> <span class="macro" data-ref="_M/__alpha__">__alpha__</span></u></td></tr>
<tr><th id="42">42</th><td><u>#include &lt;machine/alpha_cpu.h&gt;</u></td></tr>
<tr><th id="43">43</th><td><u>#<span data-ppcond="41">endif</span></u></td></tr>
<tr><th id="44">44</th><td><u>#<span data-ppcond="44">ifdef</span> <span class="macro" data-ref="_M/__amd64__">__amd64__</span></u></td></tr>
<tr><th id="45">45</th><td><u>#include <a href="../../../../objdir.amd64/destdir.amd64/usr/include/amd64/vmparam.h.html">&lt;machine/vmparam.h&gt;</a></u></td></tr>
<tr><th id="46">46</th><td><u>#include <a href="../../../../objdir.amd64/destdir.amd64/usr/include/amd64/psl.h.html">&lt;machine/psl.h&gt;</a></u></td></tr>
<tr><th id="47">47</th><td><u>#<span data-ppcond="44">endif</span></u></td></tr>
<tr><th id="48">48</th><td><u>#<span data-ppcond="48">ifdef</span> <span class="macro" data-ref="_M/__hppa__">__hppa__</span></u></td></tr>
<tr><th id="49">49</th><td><u>#include &lt;machine/psl.h&gt;</u></td></tr>
<tr><th id="50">50</th><td><u>#<span data-ppcond="48">endif</span></u></td></tr>
<tr><th id="51">51</th><td><u>#<span data-ppcond="51">ifdef</span> <span class="macro" data-ref="_M/__i386__">__i386__</span></u></td></tr>
<tr><th id="52">52</th><td><u>#include &lt;machine/segments.h&gt;</u></td></tr>
<tr><th id="53">53</th><td><u>#include &lt;machine/psl.h&gt;</u></td></tr>
<tr><th id="54">54</th><td><u>#<span data-ppcond="51">endif</span></u></td></tr>
<tr><th id="55">55</th><td><u>#<span data-ppcond="55">if</span> defined(<span class="macro" data-ref="_M/__m68k__">__m68k__</span>) || defined(<span class="macro" data-ref="_M/__sh3__">__sh3__</span>) || defined <span class="macro" data-ref="_M/__vax__">__vax__</span></u></td></tr>
<tr><th id="56">56</th><td><u>#include &lt;machine/psl.h&gt;</u></td></tr>
<tr><th id="57">57</th><td><u>#<span data-ppcond="55">endif</span></u></td></tr>
<tr><th id="58">58</th><td></td></tr>
<tr><th id="59">59</th><td><em>volatile</em> <a class="typedef" href="../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#lwpid_t" title='lwpid_t' data-type='int32_t' data-ref="lwpid_t" data-ref-filename="lwpid_t">lwpid_t</a> <dfn class="decl def" id="the_lwp_id" title='the_lwp_id' data-ref="the_lwp_id" data-ref-filename="the_lwp_id">the_lwp_id</dfn> = <var>0</var>;</td></tr>
<tr><th id="60">60</th><td></td></tr>
<tr><th id="61">61</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="lwp_main_func" title='lwp_main_func' data-type='void lwp_main_func(void * arg)' data-ref="lwp_main_func" data-ref-filename="lwp_main_func">lwp_main_func</dfn>(<em>void</em>* <dfn class="local col1 decl" id="1arg" title='arg' data-type='void *' data-ref="1arg" data-ref-filename="1arg">arg</dfn>)</td></tr>
<tr><th id="62">62</th><td>{</td></tr>
<tr><th id="63">63</th><td>	<a class="ref" href="#the_lwp_id" title='the_lwp_id' data-ref="the_lwp_id" data-ref-filename="the_lwp_id">the_lwp_id</a> = <a class="ref fn" href="../../../../objdir.amd64/destdir.amd64/usr/include/lwp.h.html#_lwp_self" title='_lwp_self' data-ref="_lwp_self" data-ref-filename="_lwp_self">_lwp_self</a>();</td></tr>
<tr><th id="64">64</th><td>	<a class="ref fn" href="../../../../objdir.amd64/destdir.amd64/usr/include/lwp.h.html#_lwp_exit" title='_lwp_exit' data-ref="_lwp_exit" data-ref-filename="_lwp_exit">_lwp_exit</a>();</td></tr>
<tr><th id="65">65</th><td>}</td></tr>
<tr><th id="66">66</th><td></td></tr>
<tr><th id="67">67</th><td><i>/*</i></td></tr>
<tr><th id="68">68</th><td><i> * Hard to document - see usage examples below.</i></td></tr>
<tr><th id="69">69</th><td><i> */</i></td></tr>
<tr><th id="70">70</th><td><u>#define <dfn class="macro" id="_M/INVALID_UCONTEXT" data-ref="_M/INVALID_UCONTEXT">INVALID_UCONTEXT</dfn>(ARCH,NAME,DESC)	\</u></td></tr>
<tr><th id="71">71</th><td><u>static void ARCH##_##NAME(<a class="typedef" href="../../../../objdir.amd64/destdir.amd64/usr/include/sys/ucontext.h.html#ucontext_t" title='ucontext_t' data-type='struct __ucontext' data-ref="ucontext_t" data-ref-filename="ucontext_t">ucontext_t</a> *);	\</u></td></tr>
<tr><th id="72">72</th><td><u>ATF_TC(lwp_create_##ARCH##_fail_##NAME);	\</u></td></tr>
<tr><th id="73">73</th><td><u>ATF_TC_HEAD(lwp_create_##ARCH##_fail_##NAME, <dfn class="local col9 decl" id="9tc" title='tc' data-type='atf_tc_t *' data-ref="9tc" data-ref-filename="9tc"><dfn class="local col5 decl" id="15tc" title='tc' data-type='atf_tc_t *' data-ref="15tc" data-ref-filename="15tc"><dfn class="local col1 decl" id="21tc" title='tc' data-type='atf_tc_t *' data-ref="21tc" data-ref-filename="21tc">tc</dfn></dfn></dfn>)	\</u></td></tr>
<tr><th id="74">74</th><td><u>{	\</u></td></tr>
<tr><th id="75">75</th><td><u>	<a class="ref fn" href="../../../../objdir.amd64/destdir.amd64/usr/include/atf-c/tc.h.html#atf_tc_set_md_var" title='atf_tc_set_md_var' data-ref="atf_tc_set_md_var" data-ref-filename="atf_tc_set_md_var">atf_tc_set_md_var</a>(<a class="local col9 ref" href="#122" title='tc' data-ref="9tc" data-ref-filename="9tc"><a class="local col5 ref" href="#135" title='tc' data-ref="15tc" data-ref-filename="15tc"><a class="local col1 ref" href="#141" title='tc' data-ref="21tc" data-ref-filename="21tc">tc</a></a></a>, "descr", "verify rejection of invalid ucontext " \</u></td></tr>
<tr><th id="76">76</th><td><u>		"on " #ARCH " due to " DESC);	\</u></td></tr>
<tr><th id="77">77</th><td><u>}	\</u></td></tr>
<tr><th id="78">78</th><td><u>	\</u></td></tr>
<tr><th id="79">79</th><td><u>ATF_TC_BODY(lwp_create_##ARCH##_fail_##NAME, <dfn class="local col0 decl" id="10tc" title='tc' data-type='const atf_tc_t *' data-ref="10tc" data-ref-filename="10tc"><dfn class="local col6 decl" id="16tc" title='tc' data-type='const atf_tc_t *' data-ref="16tc" data-ref-filename="16tc"><dfn class="local col2 decl" id="22tc" title='tc' data-type='const atf_tc_t *' data-ref="22tc" data-ref-filename="22tc">tc</dfn></dfn></dfn>)	\</u></td></tr>
<tr><th id="80">80</th><td><u>{	\</u></td></tr>
<tr><th id="81">81</th><td><u>	<a class="typedef" href="../../../../objdir.amd64/destdir.amd64/usr/include/sys/ucontext.h.html#ucontext_t" title='ucontext_t' data-type='struct __ucontext' data-ref="ucontext_t" data-ref-filename="ucontext_t">ucontext_t</a> <dfn class="local col1 decl" id="11uc" title='uc' data-type='ucontext_t' data-ref="11uc" data-ref-filename="11uc"><dfn class="local col7 decl" id="17uc" title='uc' data-type='ucontext_t' data-ref="17uc" data-ref-filename="17uc"><dfn class="local col3 decl" id="23uc" title='uc' data-type='ucontext_t' data-ref="23uc" data-ref-filename="23uc">uc</dfn></dfn></dfn>;		\</u></td></tr>
<tr><th id="82">82</th><td><u>	<a class="typedef" href="../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#lwpid_t" title='lwpid_t' data-type='int32_t' data-ref="lwpid_t" data-ref-filename="lwpid_t">lwpid_t</a> <dfn class="local col2 decl" id="12lid" title='lid' data-type='lwpid_t' data-ref="12lid" data-ref-filename="12lid"><dfn class="local col8 decl" id="18lid" title='lid' data-type='lwpid_t' data-ref="18lid" data-ref-filename="18lid"><dfn class="local col4 decl" id="24lid" title='lid' data-type='lwpid_t' data-ref="24lid" data-ref-filename="24lid">lid</dfn></dfn></dfn>;		\</u></td></tr>
<tr><th id="83">83</th><td><u>	int <dfn class="local col3 decl" id="13error" title='error' data-type='int' data-ref="13error" data-ref-filename="13error"><dfn class="local col9 decl" id="19error" title='error' data-type='int' data-ref="19error" data-ref-filename="19error"><dfn class="local col5 decl" id="25error" title='error' data-type='int' data-ref="25error" data-ref-filename="25error">error</dfn></dfn></dfn>;		\</u></td></tr>
<tr><th id="84">84</th><td><u>				\</u></td></tr>
<tr><th id="85">85</th><td><u>	<a class="ref fn" href="../../../../objdir.amd64/destdir.amd64/usr/include/ucontext.h.html#getcontext" title='getcontext' data-ref="getcontext" data-ref-filename="getcontext">getcontext</a>(&amp;<a class="local col1 ref" href="#122" title='uc' data-ref="11uc" data-ref-filename="11uc"><a class="local col7 ref" href="#135" title='uc' data-ref="17uc" data-ref-filename="17uc"><a class="local col3 ref" href="#141" title='uc' data-ref="23uc" data-ref-filename="23uc">uc</a></a></a>);	\</u></td></tr>
<tr><th id="86">86</th><td><u>	<a class="local col1 ref" href="#122" title='uc' data-ref="11uc" data-ref-filename="11uc"><a class="local col7 ref" href="#135" title='uc' data-ref="17uc" data-ref-filename="17uc"><a class="local col3 ref" href="#141" title='uc' data-ref="23uc" data-ref-filename="23uc">uc</a></a></a>.<a class="ref field" href="../../../../objdir.amd64/destdir.amd64/usr/include/sys/ucontext.h.html#__ucontext::uc_flags" title='__ucontext::uc_flags' data-ref="__ucontext::uc_flags" data-ref-filename="__ucontext..uc_flags">uc_flags</a> = _UC_CPU;	\</u></td></tr>
<tr><th id="87">87</th><td><u>	ARCH##_##NAME(&amp;<a class="local col1 ref" href="#122" title='uc' data-ref="11uc" data-ref-filename="11uc"><a class="local col7 ref" href="#135" title='uc' data-ref="17uc" data-ref-filename="17uc"><a class="local col3 ref" href="#141" title='uc' data-ref="23uc" data-ref-filename="23uc">uc</a></a></a>);	\</u></td></tr>
<tr><th id="88">88</th><td><u>				\</u></td></tr>
<tr><th id="89">89</th><td><u>	<a class="local col3 ref" href="#122" title='error' data-ref="13error" data-ref-filename="13error"><a class="local col9 ref" href="#135" title='error' data-ref="19error" data-ref-filename="19error"><a class="local col5 ref" href="#141" title='error' data-ref="25error" data-ref-filename="25error">error</a></a></a> = <a class="ref fn" href="../../../../objdir.amd64/destdir.amd64/usr/include/lwp.h.html#_lwp_create" title='_lwp_create' data-ref="_lwp_create" data-ref-filename="_lwp_create">_lwp_create</a>(&amp;<a class="local col1 ref" href="#122" title='uc' data-ref="11uc" data-ref-filename="11uc"><a class="local col7 ref" href="#135" title='uc' data-ref="17uc" data-ref-filename="17uc"><a class="local col3 ref" href="#141" title='uc' data-ref="23uc" data-ref-filename="23uc">uc</a></a></a>, 0, &amp;<a class="local col2 ref" href="#122" title='lid' data-ref="12lid" data-ref-filename="12lid"><a class="local col8 ref" href="#135" title='lid' data-ref="18lid" data-ref-filename="18lid"><a class="local col4 ref" href="#141" title='lid' data-ref="24lid" data-ref-filename="24lid">lid</a></a></a>);	\</u></td></tr>
<tr><th id="90">90</th><td><u>	ATF_REQUIRE(<a class="local col3 ref" href="#122" title='error' data-ref="13error" data-ref-filename="13error"><a class="local col9 ref" href="#135" title='error' data-ref="19error" data-ref-filename="19error"><a class="local col5 ref" href="#141" title='error' data-ref="25error" data-ref-filename="25error">error</a></a></a> != 0 &amp;&amp; errno == EINVAL);	\</u></td></tr>
<tr><th id="91">91</th><td><u>}	\</u></td></tr>
<tr><th id="92">92</th><td><u>static void ARCH##_##NAME(<a class="typedef" href="../../../../objdir.amd64/destdir.amd64/usr/include/sys/ucontext.h.html#ucontext_t" title='ucontext_t' data-type='struct __ucontext' data-ref="ucontext_t" data-ref-filename="ucontext_t">ucontext_t</a> *<dfn class="local col4 decl" id="14uc" title='uc' data-type='ucontext_t *' data-ref="14uc" data-ref-filename="14uc"><dfn class="local col0 decl" id="20uc" title='uc' data-type='ucontext_t *' data-ref="20uc" data-ref-filename="20uc"><dfn class="local col6 decl" id="26uc" title='uc' data-type='ucontext_t *' data-ref="26uc" data-ref-filename="26uc">uc</dfn></dfn></dfn>)	\</u></td></tr>
<tr><th id="93">93</th><td><u>{</u></td></tr>
<tr><th id="94">94</th><td></td></tr>
<tr><th id="95">95</th><td></td></tr>
<tr><th id="96">96</th><td><a class="macro" href="../../../../objdir.amd64/destdir.amd64/usr/include/atf-c/macros.h.html#57" title="static void atfu_lwp_create_works_head(atf_tc_t *); static void atfu_lwp_create_works_body(const atf_tc_t *); static atf_tc_t atfu_lwp_create_works_tc; static atf_tc_pack_t atfu_lwp_create_works_tc_pack = { .m_ident = &quot;lwp_create_works&quot;, .m_head = atfu_lwp_create_works_head, .m_body = atfu_lwp_create_works_body, .m_cleanup = ((void*)0), }" data-ref="_M/ATF_TC">ATF_TC</a>(lwp_create_works);</td></tr>
<tr><th id="97">97</th><td><a class="macro" href="../../../../objdir.amd64/destdir.amd64/usr/include/atf-c/macros.h.html#80" title="static void atfu_lwp_create_works_head(atf_tc_t *tc __attribute__((__unused__)))" data-ref="_M/ATF_TC_HEAD">ATF_TC_HEAD</a>(lwp_create_works, <dfn class="local col2 decl" id="2tc" title='tc' data-type='atf_tc_t *' data-ref="2tc" data-ref-filename="2tc">tc</dfn>)</td></tr>
<tr><th id="98">98</th><td>{</td></tr>
<tr><th id="99">99</th><td>	<a class="ref fn" href="../../../../objdir.amd64/destdir.amd64/usr/include/atf-c/tc.h.html#atf_tc_set_md_var" title='atf_tc_set_md_var' data-ref="atf_tc_set_md_var" data-ref-filename="atf_tc_set_md_var">atf_tc_set_md_var</a>(<a class="local col2 ref" href="#97" title='tc' data-ref="2tc" data-ref-filename="2tc">tc</a>, <q>"descr"</q>, <q>"Verify creation of a lwp and waiting"</q></td></tr>
<tr><th id="100">100</th><td>	    <q>" for it to finish"</q>);</td></tr>
<tr><th id="101">101</th><td>}</td></tr>
<tr><th id="102">102</th><td></td></tr>
<tr><th id="103">103</th><td><a class="macro" href="../../../../objdir.amd64/destdir.amd64/usr/include/atf-c/macros.h.html#88" title="static void atfu_lwp_create_works_body(const atf_tc_t *tc __attribute__((__unused__)))" data-ref="_M/ATF_TC_BODY">ATF_TC_BODY</a>(lwp_create_works, <dfn class="local col3 decl" id="3tc" title='tc' data-type='const atf_tc_t *' data-ref="3tc" data-ref-filename="3tc">tc</dfn>)</td></tr>
<tr><th id="104">104</th><td>{</td></tr>
<tr><th id="105">105</th><td>	<a class="typedef" href="../../../../objdir.amd64/destdir.amd64/usr/include/sys/ucontext.h.html#ucontext_t" title='ucontext_t' data-type='struct __ucontext' data-ref="ucontext_t" data-ref-filename="ucontext_t">ucontext_t</a> <dfn class="local col4 decl" id="4uc" title='uc' data-type='ucontext_t' data-ref="4uc" data-ref-filename="4uc">uc</dfn>;</td></tr>
<tr><th id="106">106</th><td>	<a class="typedef" href="../../../../objdir.amd64/destdir.amd64/usr/include/sys/types.h.html#lwpid_t" title='lwpid_t' data-type='int32_t' data-ref="lwpid_t" data-ref-filename="lwpid_t">lwpid_t</a> <dfn class="local col5 decl" id="5lid" title='lid' data-type='lwpid_t' data-ref="5lid" data-ref-filename="5lid">lid</dfn>;</td></tr>
<tr><th id="107">107</th><td>	<em>int</em> <dfn class="local col6 decl" id="6error" title='error' data-type='int' data-ref="6error" data-ref-filename="6error">error</dfn>;</td></tr>
<tr><th id="108">108</th><td>	<em>void</em> *<dfn class="local col7 decl" id="7stack" title='stack' data-type='void *' data-ref="7stack" data-ref-filename="7stack">stack</dfn>;</td></tr>
<tr><th id="109">109</th><td>	<em>static</em> <em>const</em> <span class='typedef' title='size_t' data-type='unsigned long' data-ref="size_t" data-ref-filename="size_t">size_t</span> <dfn class="local col8 decl" id="8ssize" title='ssize' data-type='const size_t' data-ref="8ssize" data-ref-filename="8ssize">ssize</dfn> = <var>16</var>*<var>1024</var>;</td></tr>
<tr><th id="110">110</th><td></td></tr>
<tr><th id="111">111</th><td>	<a class="local col7 ref" href="#7stack" title='stack' data-ref="7stack" data-ref-filename="7stack">stack</a> = <a class="ref fn" href="../../../../objdir.amd64/destdir.amd64/usr/include/stdlib.h.html#malloc" title='malloc' data-ref="malloc" data-ref-filename="malloc">malloc</a>(<a class="local col8 ref" href="#8ssize" title='ssize' data-ref="8ssize" data-ref-filename="8ssize">ssize</a>);</td></tr>
<tr><th id="112">112</th><td>	<a class="ref fn" href="../../../../objdir.amd64/destdir.amd64/usr/include/lwp.h.html#_lwp_makecontext" title='_lwp_makecontext' data-ref="_lwp_makecontext" data-ref-filename="_lwp_makecontext">_lwp_makecontext</a>(&amp;<a class="local col4 ref" href="#4uc" title='uc' data-ref="4uc" data-ref-filename="4uc">uc</a>, <a class="tu ref fn" href="#lwp_main_func" title='lwp_main_func' data-use='r' data-ref="lwp_main_func" data-ref-filename="lwp_main_func">lwp_main_func</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>, <a class="local col7 ref" href="#7stack" title='stack' data-ref="7stack" data-ref-filename="7stack">stack</a>, <a class="local col8 ref" href="#8ssize" title='ssize' data-ref="8ssize" data-ref-filename="8ssize">ssize</a>);</td></tr>
<tr><th id="113">113</th><td></td></tr>
<tr><th id="114">114</th><td>	<a class="local col6 ref" href="#6error" title='error' data-ref="6error" data-ref-filename="6error">error</a> = <a class="ref fn" href="../../../../objdir.amd64/destdir.amd64/usr/include/lwp.h.html#_lwp_create" title='_lwp_create' data-ref="_lwp_create" data-ref-filename="_lwp_create">_lwp_create</a>(&amp;<a class="local col4 ref" href="#4uc" title='uc' data-ref="4uc" data-ref-filename="4uc">uc</a>, <var>0</var>, &amp;<a class="local col5 ref" href="#5lid" title='lid' data-ref="5lid" data-ref-filename="5lid">lid</a>);</td></tr>
<tr><th id="115">115</th><td>	<a class="macro" href="../../../../objdir.amd64/destdir.amd64/usr/include/atf-c/macros.h.html#146" title="do { if (!(error == 0)) atf_tc_fail_requirement(&quot;/___NETBSD_SRC___/objdir.amd64/tests/lib/libc/sys/../../../../../tests/lib/libc/sys/t_lwp_create.c&quot;, 115, &quot;%s&quot;, &quot;error == 0&quot; &quot; not met&quot;); } while(0)" data-ref="_M/ATF_REQUIRE">ATF_REQUIRE</a>(<a class="local col6 ref" href="#6error" title='error' data-ref="6error" data-ref-filename="6error">error</a> == <var>0</var>);</td></tr>
<tr><th id="116">116</th><td></td></tr>
<tr><th id="117">117</th><td>	<a class="local col6 ref" href="#6error" title='error' data-ref="6error" data-ref-filename="6error">error</a> = <a class="ref fn" href="../../../../objdir.amd64/destdir.amd64/usr/include/lwp.h.html#_lwp_wait" title='_lwp_wait' data-ref="_lwp_wait" data-ref-filename="_lwp_wait">_lwp_wait</a>(<a class="local col5 ref" href="#5lid" title='lid' data-ref="5lid" data-ref-filename="5lid">lid</a>, <span class="macro" title="((void*)0)" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="118">118</th><td>	<a class="macro" href="../../../../objdir.amd64/destdir.amd64/usr/include/atf-c/macros.h.html#146" title="do { if (!(error == 0)) atf_tc_fail_requirement(&quot;/___NETBSD_SRC___/objdir.amd64/tests/lib/libc/sys/../../../../../tests/lib/libc/sys/t_lwp_create.c&quot;, 118, &quot;%s&quot;, &quot;error == 0&quot; &quot; not met&quot;); } while(0)" data-ref="_M/ATF_REQUIRE">ATF_REQUIRE</a>(<a class="local col6 ref" href="#6error" title='error' data-ref="6error" data-ref-filename="6error">error</a> == <var>0</var>);</td></tr>
<tr><th id="119">119</th><td>	<a class="macro" href="../../../../objdir.amd64/destdir.amd64/usr/include/atf-c/macros.h.html#146" title="do { if (!(lid == the_lwp_id)) atf_tc_fail_requirement(&quot;/___NETBSD_SRC___/objdir.amd64/tests/lib/libc/sys/../../../../../tests/lib/libc/sys/t_lwp_create.c&quot;, 119, &quot;%s&quot;, &quot;lid == the_lwp_id&quot; &quot; not met&quot;); } while(0)" data-ref="_M/ATF_REQUIRE">ATF_REQUIRE</a>(<a class="local col5 ref" href="#5lid" title='lid' data-ref="5lid" data-ref-filename="5lid">lid</a> == <a class="ref" href="#the_lwp_id" title='the_lwp_id' data-ref="the_lwp_id" data-ref-filename="the_lwp_id">the_lwp_id</a>);</td></tr>
<tr><th id="120">120</th><td>}</td></tr>
<tr><th id="121">121</th><td></td></tr>
<tr><th id="122">122</th><td><a class="macro" href="#70" title="static void generic_no_uc_cpu(ucontext_t *); static void atfu_lwp_create_generic_fail_no_uc_cpu_head(atf_tc_t *); static void atfu_lwp_create_generic_fail_no_uc_cpu_body(const atf_tc_t *); static atf_tc_t atfu_lwp_create_generic_fail_no_uc_cpu_tc; static atf_tc_pack_t atfu_lwp_create_generic_fail_no_uc_cpu_tc_pack = { .m_ident = &quot;lwp_create_generic_fail_no_uc_cpu&quot;, .m_head = atfu_lwp_create_generic_fail_no_uc_cpu_head, .m_body = atfu_lwp_create_generic_fail_no_uc_cpu_body, .m_cleanup = ((void*)0), }; static void atfu_lwp_create_generic_fail_no_uc_cpu_head(atf_tc_t *tc __attribute__((__unused__))) { atf_tc_set_md_var(tc, &quot;descr&quot;, &quot;verify rejection of invalid ucontext &quot; &quot;on &quot; &quot;generic&quot; &quot; due to &quot; &quot;not setting cpu registers&quot;); } static void atfu_lwp_create_generic_fail_no_uc_cpu_body(const atf_tc_t *tc __attribute__((__unused__))) { ucontext_t uc; lwpid_t lid; int error; getcontext(&amp;uc); uc.uc_flags = 0x04; generic_no_uc_cpu(&amp;uc); error = _lwp_create(&amp;uc, 0, &amp;lid); do { if (!(error != 0 &amp;&amp; (*__errno()) == 22)) atf_tc_fail_requirement(&quot;/___NETBSD_SRC___/objdir.amd64/tests/lib/libc/sys/../../../../../tests/lib/libc/sys/t_lwp_create.c&quot;, 122, &quot;%s&quot;, &quot;error != 0 &amp;&amp; errno == EINVAL&quot; &quot; not met&quot;); } while(0); } static void generic_no_uc_cpu(ucontext_t *uc) {" data-ref="_M/INVALID_UCONTEXT">INVALID_UCONTEXT</a>(generic, no_uc_cpu, <q>"not setting cpu registers"</q>)</td></tr>
<tr><th id="123">123</th><td>	<a class="local col4 ref" href="#122" title='uc' data-ref="14uc" data-ref-filename="14uc">uc</a>-&gt;<a class="ref field" href="../../../../objdir.amd64/destdir.amd64/usr/include/sys/ucontext.h.html#__ucontext::uc_flags" title='__ucontext::uc_flags' data-ref="__ucontext::uc_flags" data-ref-filename="__ucontext..uc_flags">uc_flags</a> &amp;= ~<a class="macro" href="../../../../objdir.amd64/destdir.amd64/usr/include/sys/ucontext.h.html#58" title="0x04" data-ref="_M/_UC_CPU">_UC_CPU</a>;</td></tr>
<tr><th id="124">124</th><td>}</td></tr>
<tr><th id="125">125</th><td></td></tr>
<tr><th id="126">126</th><td><u>#<span data-ppcond="126">ifdef</span> <span class="macro" data-ref="_M/__alpha__">__alpha__</span></u></td></tr>
<tr><th id="127">127</th><td>INVALID_UCONTEXT(alpha, pslset, <q>"trying to clear the USERMODE flag"</q>)</td></tr>
<tr><th id="128">128</th><td>	uc-&gt;uc_mcontext.__gregs[_REG_PS] &amp;= ~ALPHA_PSL_USERMODE;</td></tr>
<tr><th id="129">129</th><td>}</td></tr>
<tr><th id="130">130</th><td>INVALID_UCONTEXT(alpha, pslclr, <q>"trying to set a 'must be zero' flag"</q>)</td></tr>
<tr><th id="131">131</th><td>	uc-&gt;uc_mcontext.__gregs[_REG_PS] |= ALPHA_PSL_IPL_HIGH;</td></tr>
<tr><th id="132">132</th><td>}</td></tr>
<tr><th id="133">133</th><td><u>#<span data-ppcond="126">endif</span></u></td></tr>
<tr><th id="134">134</th><td><u>#<span data-ppcond="134">ifdef</span> <span class="macro" data-ref="_M/__amd64__">__amd64__</span></u></td></tr>
<tr><th id="135">135</th><td><a class="macro" href="#70" title="static void amd64_untouchable_rflags(ucontext_t *); static void atfu_lwp_create_amd64_fail_untouchable_rflags_head(atf_tc_t *); static void atfu_lwp_create_amd64_fail_untouchable_rflags_body(const atf_tc_t *); static atf_tc_t atfu_lwp_create_amd64_fail_untouchable_rflags_tc; static atf_tc_pack_t atfu_lwp_create_amd64_fail_untouchable_rflags_tc_pack = { .m_ident = &quot;lwp_create_amd64_fail_untouchable_rflags&quot;, .m_head = atfu_lwp_create_amd64_fail_untouchable_rflags_head, .m_body = atfu_lwp_create_amd64_fail_untouchable_rflags_body, .m_cleanup = ((void*)0), }; static void atfu_lwp_create_amd64_fail_untouchable_rflags_head(atf_tc_t *tc __attribute__((__unused__))) { atf_tc_set_md_var(tc, &quot;descr&quot;, &quot;verify rejection of invalid ucontext &quot; &quot;on &quot; &quot;amd64&quot; &quot; due to &quot; &quot;forbidden rflags changed&quot;); } static void atfu_lwp_create_amd64_fail_untouchable_rflags_body(const atf_tc_t *tc __attribute__((__unused__))) { ucontext_t uc; lwpid_t lid; int error; getcontext(&amp;uc); uc.uc_flags = 0x04; amd64_untouchable_rflags(&amp;uc); error = _lwp_create(&amp;uc, 0, &amp;lid); do { if (!(error != 0 &amp;&amp; (*__errno()) == 22)) atf_tc_fail_requirement(&quot;/___NETBSD_SRC___/objdir.amd64/tests/lib/libc/sys/../../../../../tests/lib/libc/sys/t_lwp_create.c&quot;, 135, &quot;%s&quot;, &quot;error != 0 &amp;&amp; errno == EINVAL&quot; &quot; not met&quot;); } while(0); } static void amd64_untouchable_rflags(ucontext_t *uc) {" data-ref="_M/INVALID_UCONTEXT">INVALID_UCONTEXT</a>(amd64, untouchable_rflags, <q>"forbidden rflags changed"</q>)</td></tr>
<tr><th id="136">136</th><td>	<a class="local col0 ref" href="#135" title='uc' data-ref="20uc" data-ref-filename="20uc">uc</a>-&gt;<a class="ref field" href="../../../../objdir.amd64/destdir.amd64/usr/include/sys/ucontext.h.html#__ucontext::uc_mcontext" title='__ucontext::uc_mcontext' data-ref="__ucontext::uc_mcontext" data-ref-filename="__ucontext..uc_mcontext">uc_mcontext</a>.<a class="ref field" href="../../../../objdir.amd64/destdir.amd64/usr/include/amd64/mcontext.h.html#(anonymous)::__gregs" title='(anonymous struct)::__gregs' data-ref="(anonymous)::__gregs" data-ref-filename="(anonymous)..__gregs">__gregs</a>[<a class="enum" href="../../../../objdir.amd64/destdir.amd64/usr/include/amd64/mcontext.h.html#43" title='_REG_RFLAGS' data-ref="_REG_RFLAGS" data-ref-filename="_REG_RFLAGS">_REG_RFLAGS</a>] |= <a class="macro" href="../../../../objdir.amd64/destdir.amd64/usr/include/x86/psl.h.html#62" title="0xffc08028" data-ref="_M/PSL_MBZ">PSL_MBZ</a>;</td></tr>
<tr><th id="137">137</th><td>}</td></tr>
<tr><th id="138">138</th><td><i>/*</i></td></tr>
<tr><th id="139">139</th><td><i> * XXX: add invalid GS/DS selector tests</i></td></tr>
<tr><th id="140">140</th><td><i> */</i></td></tr>
<tr><th id="141">141</th><td><a class="macro" href="#70" title="static void amd64_pc_too_high(ucontext_t *); static void atfu_lwp_create_amd64_fail_pc_too_high_head(atf_tc_t *); static void atfu_lwp_create_amd64_fail_pc_too_high_body(const atf_tc_t *); static atf_tc_t atfu_lwp_create_amd64_fail_pc_too_high_tc; static atf_tc_pack_t atfu_lwp_create_amd64_fail_pc_too_high_tc_pack = { .m_ident = &quot;lwp_create_amd64_fail_pc_too_high&quot;, .m_head = atfu_lwp_create_amd64_fail_pc_too_high_head, .m_body = atfu_lwp_create_amd64_fail_pc_too_high_body, .m_cleanup = ((void*)0), }; static void atfu_lwp_create_amd64_fail_pc_too_high_head(atf_tc_t *tc __attribute__((__unused__))) { atf_tc_set_md_var(tc, &quot;descr&quot;, &quot;verify rejection of invalid ucontext &quot; &quot;on &quot; &quot;amd64&quot; &quot; due to &quot; &quot;instruction pointer outside userland address space&quot;); } static void atfu_lwp_create_amd64_fail_pc_too_high_body(const atf_tc_t *tc __attribute__((__unused__))) { ucontext_t uc; lwpid_t lid; int error; getcontext(&amp;uc); uc.uc_flags = 0x04; amd64_pc_too_high(&amp;uc); error = _lwp_create(&amp;uc, 0, &amp;lid); do { if (!(error != 0 &amp;&amp; (*__errno()) == 22)) atf_tc_fail_requirement(&quot;/___NETBSD_SRC___/objdir.amd64/tests/lib/libc/sys/../../../../../tests/lib/libc/sys/t_lwp_create.c&quot;, 142, &quot;%s&quot;, &quot;error != 0 &amp;&amp; errno == EINVAL&quot; &quot; not met&quot;); } while(0); } static void amd64_pc_too_high(ucontext_t *uc) {" data-ref="_M/INVALID_UCONTEXT">INVALID_UCONTEXT</a>(amd64, pc_too_high,</td></tr>
<tr><th id="142">142</th><td>     <q>"instruction pointer outside userland address space"</q>)</td></tr>
<tr><th id="143">143</th><td>	<a class="local col6 ref" href="#141" title='uc' data-ref="26uc" data-ref-filename="26uc">uc</a>-&gt;<a class="ref field" href="../../../../objdir.amd64/destdir.amd64/usr/include/sys/ucontext.h.html#__ucontext::uc_mcontext" title='__ucontext::uc_mcontext' data-ref="__ucontext::uc_mcontext" data-ref-filename="__ucontext..uc_mcontext">uc_mcontext</a>.<a class="ref field" href="../../../../objdir.amd64/destdir.amd64/usr/include/amd64/mcontext.h.html#(anonymous)::__gregs" title='(anonymous struct)::__gregs' data-ref="(anonymous)::__gregs" data-ref-filename="(anonymous)..__gregs">__gregs</a>[<a class="enum" href="../../../../objdir.amd64/destdir.amd64/usr/include/amd64/mcontext.h.html#43" title='_REG_RIP' data-ref="_REG_RIP" data-ref-filename="_REG_RIP">_REG_RIP</a>] = <a class="macro" href="../../../../objdir.amd64/destdir.amd64/usr/include/amd64/vmparam.h.html#119" title="(0x00007f8000000000 - (1 &lt;&lt; 12))" data-ref="_M/VM_MAXUSER_ADDRESS">VM_MAXUSER_ADDRESS</a>;</td></tr>
<tr><th id="144">144</th><td>}</td></tr>
<tr><th id="145">145</th><td><u>#<span data-ppcond="134">endif</span></u></td></tr>
<tr><th id="146">146</th><td><u>#<span data-ppcond="146">ifdef</span> <span class="macro" data-ref="_M/__arm__">__arm__</span></u></td></tr>
<tr><th id="147">147</th><td>INVALID_UCONTEXT(arm, invalid_mode, <q>"psr or r15 set to non-user-mode"</q>)</td></tr>
<tr><th id="148">148</th><td>	uc-&gt;uc_mcontext.__gregs[_REG_PC] |= <var>0x1f</var> <i>/*PSR_SYS32_MODE*/</i>;</td></tr>
<tr><th id="149">149</th><td>	uc-&gt;uc_mcontext.__gregs[_REG_CPSR] |= <var>0x03</var> <i>/*R15_MODE_SVC*/</i>;</td></tr>
<tr><th id="150">150</th><td>}</td></tr>
<tr><th id="151">151</th><td><u>#<span data-ppcond="146">endif</span></u></td></tr>
<tr><th id="152">152</th><td><u>#<span data-ppcond="152">ifdef</span> <span class="macro" data-ref="_M/__hppa__">__hppa__</span></u></td></tr>
<tr><th id="153">153</th><td>INVALID_UCONTEXT(hppa, invalid_1, <q>"set illegal bits in psw"</q>)</td></tr>
<tr><th id="154">154</th><td>	uc-&gt;uc_mcontext.__gregs[_REG_PSW] |= PSW_MBZ;</td></tr>
<tr><th id="155">155</th><td>}</td></tr>
<tr><th id="156">156</th><td>INVALID_UCONTEXT(hppa, invalid_0, <q>"clear illegal bits in psw"</q>)</td></tr>
<tr><th id="157">157</th><td>	uc-&gt;uc_mcontext.__gregs[_REG_PSW] &amp;= ~PSW_MBS;</td></tr>
<tr><th id="158">158</th><td>}</td></tr>
<tr><th id="159">159</th><td><u>#<span data-ppcond="152">endif</span></u></td></tr>
<tr><th id="160">160</th><td><u>#<span data-ppcond="160">ifdef</span> <span class="macro" data-ref="_M/__i386__">__i386__</span></u></td></tr>
<tr><th id="161">161</th><td>INVALID_UCONTEXT(i386, untouchable_eflags, <q>"changing forbidden eflags"</q>)</td></tr>
<tr><th id="162">162</th><td>	uc-&gt;uc_mcontext.__gregs[_REG_EFL] |= PSL_IOPL;</td></tr>
<tr><th id="163">163</th><td>}</td></tr>
<tr><th id="164">164</th><td>INVALID_UCONTEXT(i386, priv_escalation, <q>"modifying priviledge level"</q>)</td></tr>
<tr><th id="165">165</th><td>	uc-&gt;uc_mcontext.__gregs[_REG_CS] &amp;= ~SEL_RPL;</td></tr>
<tr><th id="166">166</th><td>}</td></tr>
<tr><th id="167">167</th><td><u>#<span data-ppcond="160">endif</span></u></td></tr>
<tr><th id="168">168</th><td><u>#<span data-ppcond="168">ifdef</span> <span class="macro" data-ref="_M/__m68k__">__m68k__</span></u></td></tr>
<tr><th id="169">169</th><td>INVALID_UCONTEXT(m68k, invalid_ps_bits,</td></tr>
<tr><th id="170">170</th><td>    <q>"setting forbidden bits in the ps register"</q>)</td></tr>
<tr><th id="171">171</th><td>	uc-&gt;uc_mcontext.__gregs[_REG_PS] |= (PSL_MBZ|PSL_IPL|PSL_S);</td></tr>
<tr><th id="172">172</th><td>}</td></tr>
<tr><th id="173">173</th><td><u>#<span data-ppcond="168">endif</span></u></td></tr>
<tr><th id="174">174</th><td><u>#<span data-ppcond="174">ifdef</span> <span class="macro" data-ref="_M/__sh3__">__sh3__</span></u></td></tr>
<tr><th id="175">175</th><td>INVALID_UCONTEXT(sh3, modify_userstatic,</td></tr>
<tr><th id="176">176</th><td>    <q>"modifying illegal bits in the status register"</q>)</td></tr>
<tr><th id="177">177</th><td>	uc-&gt;uc_mcontext.__gregs[_REG_SR] |= PSL_MD;</td></tr>
<tr><th id="178">178</th><td>}</td></tr>
<tr><th id="179">179</th><td><u>#<span data-ppcond="174">endif</span></u></td></tr>
<tr><th id="180">180</th><td><u>#<span data-ppcond="180">ifdef</span> <span class="macro" data-ref="_M/__sparc__">__sparc__</span></u></td></tr>
<tr><th id="181">181</th><td>INVALID_UCONTEXT(sparc, pc_odd, <q>"mis-aligned instruction pointer"</q>)</td></tr>
<tr><th id="182">182</th><td>	uc-&gt;uc_mcontext.__gregs[_REG_PC] = <var>0x100002</var>;</td></tr>
<tr><th id="183">183</th><td>}</td></tr>
<tr><th id="184">184</th><td>INVALID_UCONTEXT(sparc, npc_odd, <q>"mis-aligned next instruction pointer"</q>)</td></tr>
<tr><th id="185">185</th><td>	uc-&gt;uc_mcontext.__gregs[_REG_nPC] = <var>0x100002</var>;</td></tr>
<tr><th id="186">186</th><td>}</td></tr>
<tr><th id="187">187</th><td>INVALID_UCONTEXT(sparc, pc_null, <q>"NULL instruction pointer"</q>)</td></tr>
<tr><th id="188">188</th><td>	uc-&gt;uc_mcontext.__gregs[_REG_PC] = <var>0</var>;</td></tr>
<tr><th id="189">189</th><td>}</td></tr>
<tr><th id="190">190</th><td>INVALID_UCONTEXT(sparc, npc_null, <q>"NULL next instruction pointer"</q>)</td></tr>
<tr><th id="191">191</th><td>	uc-&gt;uc_mcontext.__gregs[_REG_nPC] = <var>0</var>;</td></tr>
<tr><th id="192">192</th><td>}</td></tr>
<tr><th id="193">193</th><td><u>#<span data-ppcond="180">endif</span></u></td></tr>
<tr><th id="194">194</th><td><u>#<span data-ppcond="194">ifdef</span> <span class="macro" data-ref="_M/__vax__">__vax__</span></u></td></tr>
<tr><th id="195">195</th><td>INVALID_UCONTEXT(vax, psl_0, <q>"clearing forbidden bits in psl"</q>)</td></tr>
<tr><th id="196">196</th><td>	uc-&gt;uc_mcontext.__gregs[_REG_PSL] &amp;= ~(PSL_U | PSL_PREVU);</td></tr>
<tr><th id="197">197</th><td>}</td></tr>
<tr><th id="198">198</th><td>INVALID_UCONTEXT(vax, psl_1, <q>"setting forbidden bits in psl"</q>)</td></tr>
<tr><th id="199">199</th><td>	uc-&gt;uc_mcontext.__gregs[_REG_PSL] |= PSL_IPL | PSL_IS;</td></tr>
<tr><th id="200">200</th><td>}</td></tr>
<tr><th id="201">201</th><td>INVALID_UCONTEXT(vax, psl_cm, <q>"setting CM bit in psl"</q>)</td></tr>
<tr><th id="202">202</th><td>	uc-&gt;uc_mcontext.__gregs[_REG_PSL] |= PSL_CM;</td></tr>
<tr><th id="203">203</th><td>}</td></tr>
<tr><th id="204">204</th><td><u>#<span data-ppcond="194">endif</span></u></td></tr>
<tr><th id="205">205</th><td></td></tr>
<tr><th id="206">206</th><td><a class="macro" href="../../../../objdir.amd64/destdir.amd64/usr/include/atf-c/macros.h.html#104" title="static atf_error_t atfu_tp_add_tcs(atf_tp_t *); int atf_tp_main(int, char **, atf_error_t (*)(atf_tp_t *)); int main(int argc, char **argv) { return atf_tp_main(argc, argv, atfu_tp_add_tcs); } static atf_error_t atfu_tp_add_tcs(atf_tp_t *tp)" data-ref="_M/ATF_TP_ADD_TCS">ATF_TP_ADD_TCS</a>(<dfn class="local col7 decl" id="27tp" title='tp' data-type='atf_tp_t *' data-ref="27tp" data-ref-filename="27tp">tp</dfn>)</td></tr>
<tr><th id="207">207</th><td>{</td></tr>
<tr><th id="208">208</th><td>	<a class="macro" href="../../../../objdir.amd64/destdir.amd64/usr/include/atf-c/macros.h.html#117" title="do { atf_error_t atfu_err; char **atfu_config = atf_tp_get_config(tp); if (atfu_config == ((void*)0)) return atf_no_memory_error(); atfu_err = atf_tc_init_pack(&amp;atfu_lwp_create_works_tc, &amp;atfu_lwp_create_works_tc_pack, (const char *const *)atfu_config); atf_utils_free_charpp(atfu_config); if (atf_is_error(atfu_err)) return atfu_err; atfu_err = atf_tp_add_tc(tp, &amp;atfu_lwp_create_works_tc); if (atf_is_error(atfu_err)) return atfu_err; } while (0)" data-ref="_M/ATF_TP_ADD_TC">ATF_TP_ADD_TC</a>(<a class="local col7 ref" href="#206" title='tp' data-ref="27tp" data-ref-filename="27tp">tp</a>, lwp_create_works);</td></tr>
<tr><th id="209">209</th><td>	<a class="macro" href="../../../../objdir.amd64/destdir.amd64/usr/include/atf-c/macros.h.html#117" title="do { atf_error_t atfu_err; char **atfu_config = atf_tp_get_config(tp); if (atfu_config == ((void*)0)) return atf_no_memory_error(); atfu_err = atf_tc_init_pack(&amp;atfu_lwp_create_generic_fail_no_uc_cpu_tc, &amp;atfu_lwp_create_generic_fail_no_uc_cpu_tc_pack, (const char *const *)atfu_config); atf_utils_free_charpp(atfu_config); if (atf_is_error(atfu_err)) return atfu_err; atfu_err = atf_tp_add_tc(tp, &amp;atfu_lwp_create_generic_fail_no_uc_cpu_tc); if (atf_is_error(atfu_err)) return atfu_err; } while (0)" data-ref="_M/ATF_TP_ADD_TC">ATF_TP_ADD_TC</a>(<a class="local col7 ref" href="#206" title='tp' data-ref="27tp" data-ref-filename="27tp">tp</a>, lwp_create_generic_fail_no_uc_cpu);</td></tr>
<tr><th id="210">210</th><td><u>#<span data-ppcond="210">ifdef</span> <span class="macro" data-ref="_M/__alpha__">__alpha__</span></u></td></tr>
<tr><th id="211">211</th><td>	ATF_TP_ADD_TC(tp, lwp_create_alpha_fail_pslset);</td></tr>
<tr><th id="212">212</th><td>	ATF_TP_ADD_TC(tp, lwp_create_alpha_fail_pslclr);</td></tr>
<tr><th id="213">213</th><td><u>#<span data-ppcond="210">endif</span></u></td></tr>
<tr><th id="214">214</th><td><u>#<span data-ppcond="214">ifdef</span> <span class="macro" data-ref="_M/__amd64__">__amd64__</span></u></td></tr>
<tr><th id="215">215</th><td>	<a class="macro" href="../../../../objdir.amd64/destdir.amd64/usr/include/atf-c/macros.h.html#117" title="do { atf_error_t atfu_err; char **atfu_config = atf_tp_get_config(tp); if (atfu_config == ((void*)0)) return atf_no_memory_error(); atfu_err = atf_tc_init_pack(&amp;atfu_lwp_create_amd64_fail_untouchable_rflags_tc, &amp;atfu_lwp_create_amd64_fail_untouchable_rflags_tc_pack, (const char *const *)atfu_config); atf_utils_free_charpp(atfu_config); if (atf_is_error(atfu_err)) return atfu_err; atfu_err = atf_tp_add_tc(tp, &amp;atfu_lwp_create_amd64_fail_untouchable_rflags_tc); if (atf_is_error(atfu_err)) return atfu_err; } while (0)" data-ref="_M/ATF_TP_ADD_TC">ATF_TP_ADD_TC</a>(<a class="local col7 ref" href="#206" title='tp' data-ref="27tp" data-ref-filename="27tp">tp</a>, lwp_create_amd64_fail_untouchable_rflags);</td></tr>
<tr><th id="216">216</th><td>	<a class="macro" href="../../../../objdir.amd64/destdir.amd64/usr/include/atf-c/macros.h.html#117" title="do { atf_error_t atfu_err; char **atfu_config = atf_tp_get_config(tp); if (atfu_config == ((void*)0)) return atf_no_memory_error(); atfu_err = atf_tc_init_pack(&amp;atfu_lwp_create_amd64_fail_pc_too_high_tc, &amp;atfu_lwp_create_amd64_fail_pc_too_high_tc_pack, (const char *const *)atfu_config); atf_utils_free_charpp(atfu_config); if (atf_is_error(atfu_err)) return atfu_err; atfu_err = atf_tp_add_tc(tp, &amp;atfu_lwp_create_amd64_fail_pc_too_high_tc); if (atf_is_error(atfu_err)) return atfu_err; } while (0)" data-ref="_M/ATF_TP_ADD_TC">ATF_TP_ADD_TC</a>(<a class="local col7 ref" href="#206" title='tp' data-ref="27tp" data-ref-filename="27tp">tp</a>, lwp_create_amd64_fail_pc_too_high);</td></tr>
<tr><th id="217">217</th><td><u>#<span data-ppcond="214">endif</span></u></td></tr>
<tr><th id="218">218</th><td><u>#<span data-ppcond="218">ifdef</span> <span class="macro" data-ref="_M/__arm__">__arm__</span></u></td></tr>
<tr><th id="219">219</th><td>	ATF_TP_ADD_TC(tp, lwp_create_arm_fail_invalid_mode);</td></tr>
<tr><th id="220">220</th><td><u>#<span data-ppcond="218">endif</span></u></td></tr>
<tr><th id="221">221</th><td><u>#<span data-ppcond="221">ifdef</span> <span class="macro" data-ref="_M/__hppa__">__hppa__</span></u></td></tr>
<tr><th id="222">222</th><td>	ATF_TP_ADD_TC(tp, lwp_create_hppa_fail_invalid_1);</td></tr>
<tr><th id="223">223</th><td>	ATF_TP_ADD_TC(tp, lwp_create_hppa_fail_invalid_0);</td></tr>
<tr><th id="224">224</th><td><u>#<span data-ppcond="221">endif</span></u></td></tr>
<tr><th id="225">225</th><td><u>#<span data-ppcond="225">ifdef</span> <span class="macro" data-ref="_M/__i386__">__i386__</span></u></td></tr>
<tr><th id="226">226</th><td>	ATF_TP_ADD_TC(tp, lwp_create_i386_fail_untouchable_eflags);</td></tr>
<tr><th id="227">227</th><td>	ATF_TP_ADD_TC(tp, lwp_create_i386_fail_priv_escalation);</td></tr>
<tr><th id="228">228</th><td><u>#<span data-ppcond="225">endif</span></u></td></tr>
<tr><th id="229">229</th><td><u>#<span data-ppcond="229">ifdef</span> <span class="macro" data-ref="_M/__m68k__">__m68k__</span></u></td></tr>
<tr><th id="230">230</th><td>	ATF_TP_ADD_TC(tp, lwp_create_m68k_fail_invalid_ps_bits);</td></tr>
<tr><th id="231">231</th><td><u>#<span data-ppcond="229">endif</span></u></td></tr>
<tr><th id="232">232</th><td><u>#<span data-ppcond="232">ifdef</span> <span class="macro" data-ref="_M/__sh3__">__sh3__</span></u></td></tr>
<tr><th id="233">233</th><td>	ATF_TP_ADD_TC(tp, lwp_create_sh3_fail_modify_userstatic);</td></tr>
<tr><th id="234">234</th><td><u>#<span data-ppcond="232">endif</span></u></td></tr>
<tr><th id="235">235</th><td><u>#<span data-ppcond="235">ifdef</span> <span class="macro" data-ref="_M/__sparc__">__sparc__</span></u></td></tr>
<tr><th id="236">236</th><td>	ATF_TP_ADD_TC(tp, lwp_create_sparc_fail_pc_odd);</td></tr>
<tr><th id="237">237</th><td>	ATF_TP_ADD_TC(tp, lwp_create_sparc_fail_npc_odd);</td></tr>
<tr><th id="238">238</th><td>	ATF_TP_ADD_TC(tp, lwp_create_sparc_fail_pc_null);</td></tr>
<tr><th id="239">239</th><td>	ATF_TP_ADD_TC(tp, lwp_create_sparc_fail_npc_null);</td></tr>
<tr><th id="240">240</th><td><u>#<span data-ppcond="235">endif</span></u></td></tr>
<tr><th id="241">241</th><td><u>#<span data-ppcond="241">ifdef</span> <span class="macro" data-ref="_M/__vax__">__vax__</span></u></td></tr>
<tr><th id="242">242</th><td>	ATF_TP_ADD_TC(tp, lwp_create_vax_fail_psl_0);</td></tr>
<tr><th id="243">243</th><td>	ATF_TP_ADD_TC(tp, lwp_create_vax_fail_psl_1);</td></tr>
<tr><th id="244">244</th><td>	ATF_TP_ADD_TC(tp, lwp_create_vax_fail_psl_cm);</td></tr>
<tr><th id="245">245</th><td><u>#<span data-ppcond="241">endif</span></u></td></tr>
<tr><th id="246">246</th><td>	<b>return</b> <a class="ref fn" href="../../../../objdir.amd64/destdir.amd64/usr/include/atf-c/error.h.html#atf_no_error" title='atf_no_error' data-ref="atf_no_error" data-ref-filename="atf_no_error">atf_no_error</a>();</td></tr>
<tr><th id="247">247</th><td>}</td></tr>
<tr><th id="248">248</th><td></td></tr>
</table><hr/><p id='footer'>
Generated on <em>2019-Jul-19</em> from project netbsd revision <em>f9da89e0d</em><br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 2.1
<br/>Generator usage only permitted with license.</p>
</div></body></html>
